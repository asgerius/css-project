[{"tags": ["c#", "sql", "asp.net", "oledb", "oledbconnection"], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 11378299, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-s-rW5nAae4M/AAAAAAAAAAI/AAAAAAAAAH8/vEhSkInZykE/photo.jpg?sz=128", "display_name": "Kuba Do", "link": "https://stackoverflow.com/users/11378299/kuba-do"}, "is_accepted": true, "score": 0, "last_activity_date": 1565087604, "creation_date": 1565087604, "answer_id": 57374085, "question_id": 56979930, "link": "https://stackoverflow.com/questions/56979930/this-xlsx-connection-string-does-not-seem-to-work-even-with-multiple-modificati/57374085#57374085", "title": "This .XLSX connection string does not seem to work even with multiple modifications", "body": "<p>Hello my friend please take a look in to my connection string :</p>\n\n<p>mainFolder is a path to folder example : C:\\Users\\username\\Desktop\\Main\ncomboboxtext is full name of excel file example : SomeSample.xlsx</p>\n\n<pre><code> using (OleDbConnection connection =\n                         new OleDbConnection(@\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + mainFolder + \"\" + @\"\\\" + comboBox2.Text + \";Extended Properties=\\\"Excel 12.0;HDR=YES;\\\"\"))\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11767460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a1b29fdb44c2f9e8a08aa3a9eb4fc00?s=128&d=identicon&r=PG&f=1", "display_name": "masksoverflow", "link": "https://stackoverflow.com/users/11767460/masksoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57374085, "answer_count": 1, "score": 0, "last_activity_date": 1565087604, "creation_date": 1562802313, "question_id": 56979930, "link": "https://stackoverflow.com/questions/56979930/this-xlsx-connection-string-does-not-seem-to-work-even-with-multiple-modificati", "title": "This .XLSX connection string does not seem to work even with multiple modifications", "body": "<p>I know there are several resources out there on ACE OLEDB connection strings for .xlsx files. </p>\n\n<p>This is my current connection string:</p>\n\n<pre><code>@\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + uploadFilePath + \";Extended Properties=\\\"Excel 12.0 Xml;HDR=YES;IMEX=1\\\";\";\n</code></pre>\n\n<p>I tried </p>\n\n<pre><code>@\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + uploadFilePath + \";Extended Properties=\\\"Excel 8.0;HDR=YES;\\\"\";\n</code></pre>\n\n<p>Also tried </p>\n\n<pre><code>@\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" + uploadFilePath + \";Extended Properties=\"Excel 12.0 Xml;HDR=YES\";\n</code></pre>\n\n<p>I have tried several on connectionstrings.com and also from stackoverflow</p>\n\n<p>Usually my errors are </p>\n\n<pre><code>{\"External table is not in the expected format.\"}   \n</code></pre>\n\n<p>or </p>\n\n<pre><code>{\"Format of the initialization string does not conform to specification starting at index 118.\"}\n</code></pre>\n\n<p>What am I doing wrong? Any suggestions on the right connection string to use? .xls files are working just fine</p>\n"}, {"tags": ["c#", "openxml", "epplus"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7654866, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3ae85d62da857e0e050969446bbcfb0f?s=128&d=identicon&r=PG&f=1", "display_name": "Gilberto Langarica", "link": "https://stackoverflow.com/users/7654866/gilberto-langarica"}, "edited": false, "score": 0, "creation_date": 1562860798, "post_id": 56987853, "comment_id": 100520792, "body": "Thanks. I have seen this. I need the Uri to be dynamic depending the data I am loading"}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "reply_to_user": {"reputation": 75, "user_id": 7654866, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3ae85d62da857e0e050969446bbcfb0f?s=128&d=identicon&r=PG&f=1", "display_name": "Gilberto Langarica", "link": "https://stackoverflow.com/users/7654866/gilberto-langarica"}, "edited": false, "score": 0, "creation_date": 1562861417, "post_id": 56987853, "comment_id": 100521106, "body": "An Uri can take a string so you can make it as dynamic as need be."}], "tags": [], "owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "is_accepted": false, "score": 1, "last_activity_date": 1562843346, "creation_date": 1562843346, "answer_id": 56987853, "question_id": 56979882, "link": "https://stackoverflow.com/questions/56979882/epplus-create-hyperlink-for-column/56987853#56987853", "title": "EPPlus: Create hyperlink for column", "body": "<p>You need to format the Cell like this. Create a <code>Hyperlink</code> and set it with an <code>Uri</code></p>\n\n<pre><code>ws.Cells[5, 5].Style.Font.UnderLine = true;\nws.Cells[5, 5].Style.Font.Bold = true;\nws.Cells[5, 5].Style.Font.Color.SetColor(Color.Blue);\nws.Cells[5, 5].Hyperlink = new Uri(\"https://www.google.nl\");\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7654866, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3ae85d62da857e0e050969446bbcfb0f?s=128&d=identicon&r=PG&f=1", "display_name": "Gilberto Langarica", "link": "https://stackoverflow.com/users/7654866/gilberto-langarica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562843575, "creation_date": 1562801857, "last_edit_date": 1562843575, "question_id": 56979882, "link": "https://stackoverflow.com/questions/56979882/epplus-create-hyperlink-for-column", "title": "EPPlus: Create hyperlink for column", "body": "<p>I am unable to make a hyperlink in the excel template. I'd like to display the value in the cell like this <a href=\"http://www.diamondschool/\" rel=\"nofollow noreferrer\">http://www.diamondschool/</a>{personName}</p>\n\n<p>I have read the official documentation on github. No luck at all</p>\n\n<pre><code>public FileInfo GenerateTemplate(long shoolId)\n{\n    using (var excelPackage = new ExcelPackage(dataTemplate))\n    {\n        excelPackage.Workbook.Worksheets.Add(\"Sheet1\");\n\n        var ws = excelPackage.Workbook.Worksheets[1];\n\n        var dataTable = InitializeDataTable();\n        var templateData = GetTemplateData(schoolId);\n        PopulateData(templateData, dataTable);\n\n        ws.Cells[\"A2\"].LoadFromDataTable(dataTable, true);\n    }\n</code></pre>\n\n<p>// Since I am already loading the data from the data table I can't find a way to display the value as a hyperlink.\n//<a href=\"http://www.diamondschool/\" rel=\"nofollow noreferrer\">http://www.diamondschool/</a>{personName} so depending the value in the cell, display the personame as hyperlink to that address</p>\n\n<pre><code>            //Person name as HyperLink\n            var namedStyle = ws.Workbook.Styles.CreateNamedStyle(\"HyperLink\");\n            namedStyle.Style.Font.UnderLine = true;\n            namedStyle.Style.Font.Color.SetColor(Color.Blue);\n            ws.Cells[\"A2\"].Value\n            ws.Cells[\"A2\"].StyleName = \"HyperLink\";\n\n            excelPackage.Save();\n        }\n\n        return dataTemplate;\n    }\n\nprivate static DataTable InitializeDataTable()\n{\n    var dataTable = new DataTable();\n\n    dataTable.Columns.Add(\"Person Id\", typeof(string));\n    dataTable.Columns.Add(\"Person Name\", typeof(string));\n    return dataTable;\n}\n\n\nprivate static void PopulateData(IEnumerable&lt;DataTemplateRow&gt; data, DataTable dataTable)\n{\n    foreach (var item in data)\n    {\n        var dataRow = dataTable.NewRow();\n        dataRow[\"Person Id\"] = item.Id;\n        dataRow[\"Person Name\"] = item.Name;\n        dataTable.Rows.Add(dataRow);\n    }\n}\n\n\npublic IEnumerable&lt;DataTemplateRow&gt; GetTemplateData(long schoolId)\n{\n    var personData = _schoolService.GetData(schoolId);\n\n    var result = personData.Data.Select(result =&gt; new DataTemplateRow\n    {\n        PersonId = result.Id,\n        PersonName = result.Name\n    });\n\n    return result;\n}\n\n\npublic class DataTemplateRow\n{\n    public long Id { get; set; }\n    public class Name { get; set; }\n}\n</code></pre>\n\n<p>Since I am already loading the data from the data table I can't find a way to display the value as a hyperlink.\n<a href=\"http://www.diamondschool/\" rel=\"nofollow noreferrer\">http://www.diamondschool/</a>{personName} so depending the value in the cell, display the personame as hyperlink to that address</p>\n"}, {"tags": ["c#", "transactionscope"], "comments": [{"owner": {"reputation": 10923, "user_id": 371, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e74e7299da165db42a5a461e150b82ff?s=128&d=identicon&r=PG", "display_name": "Dave Anderson", "link": "https://stackoverflow.com/users/371/dave-anderson"}, "edited": false, "score": 0, "creation_date": 1562802550, "post_id": 56979834, "comment_id": 100495665, "body": "The commit and rollback functions are controlled by respective <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/data/transactions/implementing-a-resource-manager?view=netframework-4.8\" rel=\"nofollow noreferrer\">Resource Managers</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14634, "user_id": 64348, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/h3b3u.png?s=128&g=1", "display_name": "Kit", "link": "https://stackoverflow.com/users/64348/kit"}, "is_accepted": false, "score": 1, "last_activity_date": 1562803435, "last_edit_date": 1562803435, "creation_date": 1562803102, "answer_id": 56980026, "question_id": 56979834, "link": "https://stackoverflow.com/questions/56979834/is-transactionscope-in-net-applicable-to-only-specific-types-of-transactions/56980026#56980026", "title": "Is TransactionScope in .NET applicable to only specific types of transactions?", "body": "<p>A <code>TransactionScope</code> is capable of supporting a distributed transaction across many different types of systems, but it is not an automatic thing. This <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/data/transactions/enlisting-resources-as-participants-in-a-transaction\" rel=\"nofollow noreferrer\">documentation</a> provides a glimpse into that (it's worth checking out the whole of the document hierarchy on <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/data/transactions/\" rel=\"nofollow noreferrer\">Transaction Processing</a>.</p>\n\n<p>As mentioned by Dave Anderson in the comments, a Resource Manager controls what is done during commit and rollback, so the \"how is it done\" is governed individually by each resource manager. </p>\n\n<p>So, can other things participate in a transaction scope besides just SQL? Yes, they can. As long as a Resource Manager exists for each system (e.g. a messaging system), it can participate (<a href=\"https://docs.microsoft.com/en-us/dotnet/framework/data/transactions/enlisting-resources-as-participants-in-a-transaction\" rel=\"nofollow noreferrer\">enlist</a>).</p>\n\n<p>If you are working with something that can't enlist, you have to manually do a <a href=\"https://github.com/MicrosoftDocs/architecture-center/blob/master/docs/patterns/compensating-transaction.md\" rel=\"nofollow noreferrer\">compensating transaction</a> when you detect you need to rollback (usually when an exception occurs).</p>\n"}], "owner": {"reputation": 159, "user_id": 1380223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8530cb121feaeaa8a46773f758fc41ec?s=128&d=identicon&r=PG", "display_name": "rdhaundiyal", "link": "https://stackoverflow.com/users/1380223/rdhaundiyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562803435, "creation_date": 1562801496, "last_edit_date": 1562803361, "question_id": 56979834, "link": "https://stackoverflow.com/questions/56979834/is-transactionscope-in-net-applicable-to-only-specific-types-of-transactions", "title": "Is TransactionScope in .NET applicable to only specific types of transactions?", "body": "<p><code>TransactionScope</code> provides functionality to convert a set of operations into a transaction so that either all are completed successfully or none. My question is does transaction scope apply to certain types of operations (e.g. only SQL connnections, Azure, etc.)?</p>\n\n<p>For example, consider the code block below</p>\n\n<pre><code>using (TransactionScope scope = new TransactionScope())\n{\n    SaveToSQLserver(parameter);\n    SaveToSalesForce(parameter);\n    SaveToSAP(parameter);\n    SaveToAzure(parameter);\n    scope.Complete();\n}\n</code></pre>\n\n<p>Now suppose an error occurs at <code>SaveToSAP</code>, where it has already saved to Salesforce; how is the transaction going to rollback from Salesforce? And if everything is in memory, then how is it going to make sure that when it actually saves it will succeed?</p>\n"}, {"tags": ["c#", "xaml", "xamarin", "xamarin.forms", "xamarin.android"], "comments": [{"owner": {"reputation": 6432, "user_id": 33082, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Xil7X.jpg?s=128&g=1", "display_name": "Michael G", "link": "https://stackoverflow.com/users/33082/michael-g"}, "edited": false, "score": 0, "creation_date": 1562800267, "post_id": 56979670, "comment_id": 100495284, "body": "Where are you actually setting the view model properties? World.TrueDay and World.Player1.PlayerMoney aren&#39;t bound to a view, and they don&#39;t trigger any view model property setters."}, {"owner": {"reputation": 3, "user_id": 11766717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lEqjeL34M2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXH4foH1M8B6Qd_voKpv9xGxwMRw/photo.jpg?sz=128", "display_name": "jordan1300", "link": "https://stackoverflow.com/users/11766717/jordan1300"}, "reply_to_user": {"reputation": 6432, "user_id": 33082, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Xil7X.jpg?s=128&g=1", "display_name": "Michael G", "link": "https://stackoverflow.com/users/33082/michael-g"}, "edited": false, "score": 0, "creation_date": 1562800685, "post_id": 56979670, "comment_id": 100495370, "body": "I set the properties in my World class and initialize them in the App.xaml.cs. ```c#"}, {"owner": {"reputation": 6432, "user_id": 33082, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Xil7X.jpg?s=128&g=1", "display_name": "Michael G", "link": "https://stackoverflow.com/users/33082/michael-g"}, "edited": false, "score": 0, "creation_date": 1562800871, "post_id": 56979670, "comment_id": 100495395, "body": "Update the question to include where you&#39;re setting one of the bound properties"}, {"owner": {"reputation": 3, "user_id": 11766717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lEqjeL34M2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXH4foH1M8B6Qd_voKpv9xGxwMRw/photo.jpg?sz=128", "display_name": "jordan1300", "link": "https://stackoverflow.com/users/11766717/jordan1300"}, "reply_to_user": {"reputation": 6432, "user_id": 33082, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/Xil7X.jpg?s=128&g=1", "display_name": "Michael G", "link": "https://stackoverflow.com/users/33082/michael-g"}, "edited": false, "score": 0, "creation_date": 1562800915, "post_id": 56979670, "comment_id": 100495404, "body": "It&#39;s updated, thanks in advance"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1562801389, "post_id": 56979670, "comment_id": 100495486, "body": "<a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562813340, "post_id": 56979670, "comment_id": 100497579, "body": "changing the value of <code>World.Player1.PlayerMoney</code> is not going to cause the <code>PropertyChanged</code> event of the <code>Money</code> property in your VM to fire.  You could try manually calling <code>OnPropertyChanged(Money)</code> in <code>On1Turn</code> to force it.  This is just a really bizarre design"}, {"owner": {"reputation": 10280, "user_id": 10504796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqBUa.png?s=128&g=1", "display_name": "Junior Jiang", "link": "https://stackoverflow.com/users/10504796/junior-jiang"}, "edited": false, "score": 0, "creation_date": 1562813586, "post_id": 56979670, "comment_id": 100497620, "body": "@jordan1300 Not finding changing model code in <code>ToolbarItem_Clicked</code>.You should check that."}, {"owner": {"reputation": 3, "user_id": 11766717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lEqjeL34M2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXH4foH1M8B6Qd_voKpv9xGxwMRw/photo.jpg?sz=128", "display_name": "jordan1300", "link": "https://stackoverflow.com/users/11766717/jordan1300"}, "reply_to_user": {"reputation": 10280, "user_id": 10504796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqBUa.png?s=128&g=1", "display_name": "Junior Jiang", "link": "https://stackoverflow.com/users/10504796/junior-jiang"}, "edited": false, "score": 0, "creation_date": 1562983801, "post_id": 56979670, "comment_id": 100562929, "body": "@JuniorJiang-MSFT you were correct I was only updating my Model and not my ViewModel. I changed the code to update both during the On1Turn Method in my view model and connected that to the button via data bindings since I now know they are 100% working. Now when I click the button to add a turn they day goes up by one as it should however the money doesn&#39;t update. I put a break point and I know the value is updating but OnPropertyChanged is not firing. I updated the HomePageViewModel.cs to reflect the changes I&#39;ve made if you have any insight as to why."}, {"owner": {"reputation": 3, "user_id": 11766717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lEqjeL34M2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXH4foH1M8B6Qd_voKpv9xGxwMRw/photo.jpg?sz=128", "display_name": "jordan1300", "link": "https://stackoverflow.com/users/11766717/jordan1300"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562984323, "post_id": 56979670, "comment_id": 100562972, "body": "@Jason Yeah after reading your comment as well as others I realized I was never updating the ViewModel in the method just the model. I changed the code for the On1Turn method to update both the view model and the model. Now the days are working as expected but the money value still doesn&#39;t seem to want to update and I&#39;ve tried re writing the code and even giving it it&#39;s own variable rather than referencing the actual player money property in the VM but nothing has worked. I&#39;ve update my view model in my original question to reflect the changes I&#39;ve made if you&#39;d care to take a look."}, {"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562984715, "post_id": 56979670, "comment_id": 100563013, "body": "OnPropertyChanged(\u201cMoney\u201d);"}, {"owner": {"reputation": 3, "user_id": 11766717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lEqjeL34M2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXH4foH1M8B6Qd_voKpv9xGxwMRw/photo.jpg?sz=128", "display_name": "jordan1300", "link": "https://stackoverflow.com/users/11766717/jordan1300"}, "edited": false, "score": 0, "creation_date": 1562985093, "post_id": 56979670, "comment_id": 100563048, "body": "Holy.. Just realized I wasn&#39;t changing the proper value in the method, should have been changing the value of the Money property not the MoneyValue property. All is working as intended. Thanks All for the assistance!"}, {"owner": {"reputation": 3, "user_id": 11766717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lEqjeL34M2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXH4foH1M8B6Qd_voKpv9xGxwMRw/photo.jpg?sz=128", "display_name": "jordan1300", "link": "https://stackoverflow.com/users/11766717/jordan1300"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562985169, "post_id": 56979670, "comment_id": 100563059, "body": "@Jason Thanks a bunch for the help it&#39;s all working now!"}, {"owner": {"reputation": 10280, "user_id": 10504796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqBUa.png?s=128&g=1", "display_name": "Junior Jiang", "link": "https://stackoverflow.com/users/10504796/junior-jiang"}, "edited": false, "score": 0, "creation_date": 1563154069, "post_id": 56979670, "comment_id": 100593601, "body": "@jordan1300 Glad you have solved it ! That&#39;s a good news.If answer be helpful thanks for marking in advance."}], "answers": [{"tags": [], "owner": {"reputation": 10280, "user_id": 10504796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqBUa.png?s=128&g=1", "display_name": "Junior Jiang", "link": "https://stackoverflow.com/users/10504796/junior-jiang"}, "is_accepted": false, "score": 0, "last_activity_date": 1562834819, "last_edit_date": 1562834819, "creation_date": 1562814478, "answer_id": 56981110, "question_id": 56979670, "link": "https://stackoverflow.com/questions/56979670/databindings-not-updating-with-onpropertychanged/56981110#56981110", "title": "DataBindings not updating with OnPropertyChanged", "body": "<p>Not too understanding logic about project, but if want to change model data can do as follow</p>\n\n<p><strong>HomePage.xaml.cs</strong>:</p>\n\n<pre><code>namespace TestApp\n{\n    [XamlCompilation(XamlCompilationOptions.Compile)]\n    public partial class HomePage : ContentPage\n    {\n        HomePageViewModel homePageViewModel = new HomePageViewModel();\n        public HomePage()\n        {\n            InitializeComponent();\n\n            BindingContext = homePageViewModel ;\n        }\n\n        private void ToolbarItem_Clicked(object sender, EventArgs e)\n        {\n            homePageViewModel.CurrentDay = xxx ;\n\n            homePageViewModel.xxxxx = xxxx;\n            //Something like this can change model data\n        }\n    }\n}\n</code></pre>\n\n<p>Here is a <a href=\"https://stackoverflow.com/questions/52959818/data-binding-part-of-a-label-in-xamarin-forms/52960327#52960327\">sample</a> data binding discussion can be refer to.</p>\n"}], "owner": {"reputation": 3, "user_id": 11766717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lEqjeL34M2c/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXH4foH1M8B6Qd_voKpv9xGxwMRw/photo.jpg?sz=128", "display_name": "jordan1300", "link": "https://stackoverflow.com/users/11766717/jordan1300"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562983943, "creation_date": 1562799887, "last_edit_date": 1562983943, "question_id": 56979670, "link": "https://stackoverflow.com/questions/56979670/databindings-not-updating-with-onpropertychanged", "title": "DataBindings not updating with OnPropertyChanged", "body": "<p>Building my first app with Xamarian.Forms. I have my basic menu and home page built with some labels and a button so that I can bind some data and a method and to make sure the logic code for my game is working. I got my data bindings working as far as the labels go, they appear on screen. However I was unsure if my bindings weren't updating or if my command wasn't binding. So I commented out the ICommand, removed the binding and put the method to advance a turn into the code behind my xaml. Even after this, the data is not updating when the button is clicked which leads me to believe it is a problem with my OnPropertyChanged and the data bindings. I've searched the web and related questions, I've implemented a couple different ways of writing the gets and sets for the bindings, wrote my OnPropertyChanged function a few different ways and still nothing happens when the toolbar button on the home page is clicked.</p>\n\n<p>Here is my HomePageViewModel.cs containing INotifyPropertyChanged</p>\n\n<p>***Edited to reflect changes made since getting the day value to update:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Runtime.CompilerServices;\nusing System.Text;\nusing System.Windows.Input;\nusing Engine;\nusing Xamarin.Forms;\n\nnamespace TestApp\n{\n    public class HomePageViewModel : INotifyPropertyChanged\n    {\n        public static Player _player = World.Player1;\n\n        public string Day = World.TrueDay.ToString();\n\n        public string MoneyValue = Convert.ToInt32(Math.Floor(World.Player1.PlayerMoney)).ToString();\n\n        public string CurrentLocation = _player.CurrentLocation.Name;\n\n\n        public HomePageViewModel()\n        {\n            OnTurn = new Command(execute: On1Turn);\n        }\n\n        public ICommand OnTurn { get; private set; }\n\n        public string CurrentDay\n        {\n\n            get { return Day; }\n\n            set { Day = value; OnPropertyChanged(); }\n\n        }\n\n        public string Money\n        {\n\n            get { return MoneyValue; }\n\n            set { MoneyValue = value; OnPropertyChanged(); }\n        }\n\n        public string PlayerLocation\n        {\n\n            get { return CurrentLocation; }\n\n            set { CurrentLocation = value; OnPropertyChanged(); }\n        }\n\n        void On1Turn()\n        {\n\n            World.TrueDay = World.TrueDay + 1;\n\n            CurrentDay = World.TrueDay.ToString();\n\n            World.Player1.PlayerMoney = World.Player1.PlayerMoney + 1000;\n\n            MoneyValue = Convert.ToInt32(Math.Floor(World.Player1.PlayerMoney)).ToString();\n\n            OnPropertyChanged(Money);\n\n        }\n\n        public event PropertyChangedEventHandler PropertyChanged;\n        protected void OnPropertyChanged([CallerMemberName] string propertyName = null)\n        {\n            PropertyChangedEventHandler handler = PropertyChanged;\n            if (handler != null)\n            {\n                handler(this, new PropertyChangedEventArgs(propertyName));\n            }\n        }    \n    }\n}\n</code></pre>\n\n<p>Here is my HomePage.xaml:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;ContentPage xmlns=\"http://xamarin.com/schemas/2014/forms\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2009/xaml\"\n             xmlns:d=\"http://xamarin.com/schemas/2014/forms/design\"\n             xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n             xmlns:local1=\"clr-namespace:TestApp\"\n             mc:Ignorable=\"d\"\n             x:Class=\"TestApp.HomePage\"&gt;\n\n    &lt;ContentPage.BindingContext&gt;\n        &lt;local1:HomePageViewModel/&gt;\n    &lt;/ContentPage.BindingContext&gt;\n\n    &lt;ContentPage.ToolbarItems&gt;\n        &lt;ToolbarItem Text=\"+24hrs\" Clicked=\"ToolbarItem_Clicked\"  /&gt;\n    &lt;/ContentPage.ToolbarItems&gt;\n\n\n    &lt;StackLayout Padding=\"20\"&gt;\n\n        &lt;StackLayout Orientation=\"Horizontal\"&gt;\n            &lt;Label Text=\"Money:\" HorizontalOptions=\"Start\"/&gt;\n            &lt;Label x:Name=\"lblPlayerMoney\"  Text=\"{Binding Money, Mode=OneWay}\" HorizontalOptions=\"FillAndExpand\"/&gt;\n        &lt;/StackLayout&gt;\n\n        &lt;StackLayout Orientation=\"Horizontal\" VerticalOptions=\"EndAndExpand\" Margin=\"0,-40,0,0\"&gt;\n            &lt;Label Text=\"Current Location:\" HorizontalOptions=\"CenterAndExpand\"/&gt;\n            &lt;Label x:Name=\"lblPlayerLocation\" Text=\"{Binding PlayerLocation, Mode=OneWay}\"  HorizontalOptions=\"CenterAndExpand\"/&gt;\n        &lt;/StackLayout&gt;\n\n        &lt;StackLayout Orientation=\"Horizontal\" VerticalOptions=\"StartAndExpand\"&gt;\n            &lt;Label Text=\"Current Day:\" HorizontalOptions=\"CenterAndExpand\" Margin=\"30,0,0,0\"/&gt;\n            &lt;Label x:Name=\"lblCurrentDay\" Text=\"{Binding CurrentDay, Mode=OneWay}\" HorizontalOptions=\"CenterAndExpand\"/&gt;\n        &lt;/StackLayout&gt;\n\n    &lt;/StackLayout&gt;\n\n\n\n\n&lt;/ContentPage&gt;\n</code></pre>\n\n<p>And the HomePage.xaml.cs:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing Engine;\nusing Xamarin.Forms;\nusing Xamarin.Forms.Xaml;\n\nnamespace TestApp\n{\n    [XamlCompilation(XamlCompilationOptions.Compile)]\n    public partial class HomePage : ContentPage\n    {\n        public HomePage()\n        {\n            InitializeComponent();\n\n            //BindingContext = new HomePageViewModel();\n        }\n\n        private void ToolbarItem_Clicked(object sender, EventArgs e)\n        {\n            World.TrueDay = World.TrueDay + 1;\n\n            World.Player1.PlayerMoney = World.Player1.PlayerMoney + 1000;\n        }\n    }\n}\n</code></pre>\n\n<p>Any insight into the issue would be greatly appreciated as I'm new to Xamarian.Forms and the OnPropertyChanged feature in general. Thanks for the time!</p>\n\n<p>EDIT******</p>\n\n<p>Here is the World.cs were I set the properties if it helps</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Collections.Generic;\nusing System.Text;\n\nnamespace Engine\n{\n    public class World\n    {\n        public static decimal TrueDay = 1;\n        //public string LocationText = Player1.CurrentLocation.Name.ToString();\n\n        public static Player Player1;\n\n        public static readonly List&lt;Location&gt; Locations = new List&lt;Location&gt;();\n\n        public const int LOCATION_ID_OSHAWA = 1;\n        public const int LOCATION_ID_TORONTO = 2;\n\n        public static void GenerateWorld()\n        {\n            PopulateLocations();\n            Player1 = new Player(\"Jordan\", LocationByID(LOCATION_ID_OSHAWA), 5000);\n        }\n        private static void PopulateLocations()\n        {\n            Location oshawa = new Location(LOCATION_ID_OSHAWA, \"Oshawa\");\n            Location toronto = new Location(LOCATION_ID_TORONTO, \"Toronto\");\n\n            Locations.Add(oshawa);\n            Locations.Add(toronto);\n        }\n        public static Location LocationByID(int id)\n        {\n            foreach (Location location in Locations)\n            {\n                if (location.ID == id)\n                {\n                    return location;\n                }\n            }\n\n            return null;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "entity-framework", "entity-framework-6"], "comments": [{"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1562799829, "post_id": 56979651, "comment_id": 100495168, "body": "Does it work if you remove <code>this.Info = new HashSet&lt;OrderInfo&gt;();</code>? If it doesn&#39;t work when you remove it, let me know and I&#39;ll remove the duplicate."}, {"owner": {"reputation": 53, "user_id": 10023934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a6b034a24fcbed7ee462f98562d52f?s=128&d=identicon&r=PG&f=1", "display_name": "Sydney Park", "link": "https://stackoverflow.com/users/10023934/sydney-park"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1562861410, "post_id": 56979651, "comment_id": 100521103, "body": "@mjwills I tried adding the private variable behind the property like in the linked post, and null-checking before accessing it in order to do lazy initialization. It did not fix the problem."}], "owner": {"reputation": 53, "user_id": 10023934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a6b034a24fcbed7ee462f98562d52f?s=128&d=identicon&r=PG&f=1", "display_name": "Sydney Park", "link": "https://stackoverflow.com/users/10023934/sydney-park"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562889484, "creation_date": 1562799651, "last_edit_date": 1562861120, "question_id": 56979651, "link": "https://stackoverflow.com/questions/56979651/why-arent-my-navigation-properties-lazy-loading-after-ive-created-the-related", "title": "Why aren&#39;t my navigation properties lazy loading after I&#39;ve created the related entities?", "body": "<p>In Entity Framework, I have a class Order:</p>\n\n<pre><code>public class Order \n{\n    public Order() \n    {\n        this.Info = new HashSet&lt;OrderInfo&gt;();\n    }\n\n    [Required]\n    public int Id { get; set; }\n\n    [NotNull, MapTo(\"RecordId\")]\n    public virtual ICollection&lt;OrderInfo&gt; Info { get; set; }\n}\n</code></pre>\n\n<p>with a one-to-many relationship to the class OrderInfo:</p>\n\n<pre><code>public class OrderInfo\n{\n    public OrderInfo() { }\n\n    public int RecordId { get; set; }\n}\n</code></pre>\n\n<p>In my OrderInfo table, <code>RecordId</code> is the foreign key that corresponds to the Order's <code>Id</code> column (Order's primary key).</p>\n\n<p>I am creating an Order object, then creating an OrderInfo that will map to the order. Like so:</p>\n\n<pre><code>using (var context = new MyDbContextClass())\n{\n    // method that creates an Order, adds it to the context's change tracker\n    // and returns the order's Id\n    var orderId = await CreateOrder(); \n\n    // method that creates an OrderInfo with orderId as its RecordId\n    // and adds it to the context's change tracker\n    await CreateOrderInfo(orderId, \"Order info contents\");\n\n    // calls DbContext.SaveChanges()\n    await context.Commit();\n\n    var order = context.Order.Find(orderId);\n    var associatedOrderInfo = order.Info;\n\n    var queriedOrderInfo = context.OrderInfo.Where(info =&gt; info.RecordId == orderId);\n}\n</code></pre>\n\n<p><strong><code>associatedOrderInfo</code> is always empty, and <code>queriedOrderInfo</code> always has the expected values.</strong> Also, if I then open a new context and retrieve the order by Id again, its Info contains the expected values. </p>\n\n<p>I have confirmed the following:</p>\n\n<ul>\n<li><code>context.Configuration.ProxyCreationEnabled</code> is true (verified with debugger)</li>\n<li><code>context.Configuration.LazyLoadingEnabled</code> is true (verified with debugger)</li>\n<li>The navigation property is declared <code>public virtual</code></li>\n<li>The type referenced in the navigation property has a public, parameterless constructor.</li>\n</ul>\n\n<p>From my understanding of lazy loading, it queries the database for OrderInfo objects who have the order's Id as their RecordId. At this point, the data has been committed and my isolation level is read-committed. Therefore, the order should give me related OrderInfo objects the first time I ask, and not make me open a new context to find them. <strong>Why does it come back empty?</strong></p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>I have also attempted to force lazy initialization of the navigation properties as in <a href=\"https://stackoverflow.com/questions/20757594/ef-codefirst-should-i-initialize-navigation-properties\">this question</a>. Here is my order class:</p>\n\n<pre><code>public class Order \n{\n    public Order() \n    {\n    }\n\n    [Required]\n    public int Id { get; set; }\n\n    private ICollection&lt;OrderInfo&gt; _Info;\n\n    [NotNull, MapTo(\"RecordId\")]\n    public virtual ICollection&lt;OrderInfo&gt; Info\n    {\n        get\n        {\n            return this._Info ?? (this._Info= new HashSet&lt;OrderInfo&gt;());\n        }\n        set\n        {\n            this._Info = value;\n        }\n    }\n}\n\n</code></pre>\n\n<p>Even with this implementation of order, it comes back empty.</p>\n"}, {"tags": ["c#", "xpath", "xquery"], "comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1562799201, "post_id": 56979479, "comment_id": 100495047, "body": "short of one that you likely tried (wrapping in <code>&quot;&lt;root&gt;&quot;</code> + \u2026 + &quot;&lt;/root&gt;&quot; and loading string into XmlDocument) no..."}, {"owner": {"reputation": 50823, "user_id": 787016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EOk0j.png?s=128&g=1", "display_name": "Kirill Polishchuk", "link": "https://stackoverflow.com/users/787016/kirill-polishchuk"}, "edited": false, "score": 1, "creation_date": 1562802168, "post_id": 56979479, "comment_id": 100495607, "body": "Let&#39;s say you&#39;ve selected an <code>XmlElement el</code>. So now you can simply use <code>el.SelectSingleNode()</code> method."}, {"owner": {"reputation": 137664, "user_id": 252228, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ea75023c3c487f36257090d420b7c50?s=128&d=identicon&r=PG", "display_name": "Martin Honnen", "link": "https://stackoverflow.com/users/252228/martin-honnen"}, "edited": false, "score": 0, "creation_date": 1562844109, "post_id": 56979479, "comment_id": 100510579, "body": "As Kirill said, if you have an element node you can use its <code>SelectSingleNode</code> or <code>SelectNodes</code> methods, just make sure you use a relative XPath expression going downwards to the children e.g. <code>var nsManager = new XmlNamespaceManager(); nsManager.AddNamespace(&quot;star&quot;, &quot;http:&#47;&#47;www.starstandard.org&#47;STAR&#47;5&quot;); var dateEl = el.SelectSingleNode(&quot;star:EffectivePeriod&#47;star:StartDateTime&zwnj;&#8203;&quot;, nsManager);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11494, "user_id": 6429072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gh4b0.png?s=128&g=1", "display_name": "Ed Bangga", "link": "https://stackoverflow.com/users/6429072/ed-bangga"}, "is_accepted": false, "score": 0, "last_activity_date": 1562803825, "creation_date": 1562803825, "answer_id": 56980095, "question_id": 56979479, "link": "https://stackoverflow.com/questions/56979479/how-to-get-an-xmlelement-inside-xmlelement-innerxml/56980095#56980095", "title": "How to get an XmlElement inside XmlElement.InnerXml?", "body": "<p>you can get the first instance of this element.</p>\n\n<pre><code>//*[local-name()='EffectivePeriod'][1]/*[local-name()='StartDateTime']\n</code></pre>\n"}], "owner": {"reputation": 5739, "user_id": 1136267, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/YP5Fl.jpg?s=128&g=1", "display_name": "HerrimanCoder", "link": "https://stackoverflow.com/users/1136267/herrimancoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562803825, "creation_date": 1562798124, "question_id": 56979479, "link": "https://stackoverflow.com/questions/56979479/how-to-get-an-xmlelement-inside-xmlelement-innerxml", "title": "How to get an XmlElement inside XmlElement.InnerXml?", "body": "<p>I have an <code>XmlElement</code> whose <code>InnerXml</code> property value (a <code>string</code>) is:</p>\n\n<pre><code>&lt;star:Code name=\"SalesCode\" xmlns:star=\"http://www.starstandard.org/STAR/5\"&gt;ZQ82003&lt;/star:Code&gt;\n&lt;star:EffectivePeriod xmlns:star=\"http://www.starstandard.org/STAR/5\"&gt;\n   &lt;star:StartDateTime&gt;2017-12-30T00:00:00Z&lt;/star:StartDateTime&gt;\n   &lt;star:EndDateTime&gt;9999-12-31T00:00:00Z&lt;/star:EndDateTime&gt;\n&lt;/star:EffectivePeriod&gt;\n</code></pre>\n\n<p>From this, I need to find the <code>star:StartDateTime</code> element, and obtain it as a first-class <code>XmlElement</code> so that I can get the value (in this case <code>2017-12-30T00:00:00Z</code>) via <code>InnerText</code>. I can't figure out how to do this. It would be great if I could somehow call <code>SelectNodes()</code> against that \n<code>InnerXml</code> like this: </p>\n\n<pre><code>innerXml.SelectNodes(\"/star:EffectivePeriod/star:StartDateTime\")\n</code></pre>\n\n<p>I could do it that way within the full <code>XmlDocument</code>, but I got down to this particular <code>XmlElement</code> by looping, logic, and filters. So I cannot look within the entire scope of an <code>XmlDocument</code>; I need to search merely within this particular snippet of xml.</p>\n\n<p>How can this be done?</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 4184, "user_id": 7484766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b51b5dab8aebf8aa404ef48acee400c?s=128&d=identicon&r=PG", "display_name": "JohanP", "link": "https://stackoverflow.com/users/7484766/johanp"}, "edited": false, "score": 0, "creation_date": 1562801567, "post_id": 56979469, "comment_id": 100495512, "body": "Have you tried Utf8Parser  <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.buffers.text.utf8parser?view=netstandard-2.1\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/api/&hellip;</a>"}, {"owner": {"reputation": 4184, "user_id": 7484766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b51b5dab8aebf8aa404ef48acee400c?s=128&d=identicon&r=PG", "display_name": "JohanP", "link": "https://stackoverflow.com/users/7484766/johanp"}, "edited": false, "score": 0, "creation_date": 1562802395, "post_id": 56979469, "comment_id": 100495639, "body": "Oh yes, I hear you. I guess one option is renting a shared array from the arraypool, copy the sequence into that and then converting it. At least you won&#39;t allocate for the array."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562819982, "post_id": 56979469, "comment_id": 100498851, "body": "Can you just: <code>var originalString = Encoding.UTF8.GetString([ReadOnlySequence].ToArray());</code> or, for <code>C# &lt; 7.2</code>, <code>var seq = [ReadOnlySequence].GetPosition(0); var sOK = [ReadOnlySequence].TryGet(ref seq, out ReadOnlyMemory&lt;byte&gt; bytes); string originalString = Encoding.UTF8.GetString(bytes.ToArray());</code>."}, {"owner": {"reputation": 7644, "user_id": 78561, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1c5255f8496fcade0244f12cb6ca6405?s=128&d=identicon&r=PG", "display_name": "trampster", "link": "https://stackoverflow.com/users/78561/trampster"}, "reply_to_user": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 1, "creation_date": 1562887408, "post_id": 56979469, "comment_id": 100530500, "body": "@jimi Absolutely you can use the ToArray(), if you want to allocate a huge array. I can&#39;t take the performance hit of doing this. The whole point of ReadOnlySequence is to avoid memory allocations."}], "answers": [{"comments": [{"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 2, "creation_date": 1599721302, "post_id": 57070991, "comment_id": 112862071, "body": "This is a really really bad implementation, frankly; it stackallocs (a) unbounded sizes, (b) in a loop - either of (a) or (b) would be enough to raise a red flag - and it allocates lots of unnecessary intermediate arrays, with lots of extra copies (between the array and whatever <code>StringBuilder</code> chooses to do internally)"}], "tags": [], "owner": {"reputation": 2233, "user_id": 1781290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0bb02bb7314ccab5e650a22fc4281c?s=128&d=identicon&r=PG", "display_name": "user1781290", "link": "https://stackoverflow.com/users/1781290/user1781290"}, "is_accepted": true, "score": 1, "last_activity_date": 1563349852, "creation_date": 1563349852, "answer_id": 57070991, "question_id": 56979469, "link": "https://stackoverflow.com/questions/56979469/parse-utf8-string-from-readonlysequencebyte/57070991#57070991", "title": "Parse UTF8 string from ReadOnlySequence&lt;byte&gt;", "body": "<p>You could go with a <code>Decoder</code>. It would be something along the lines of this:</p>\n\n<pre><code>var decoder = Encoding.UTF8.GetDecoder();\nvar sb = new StringBuilder();\nvar processed = 0L;\nvar total = bytes.Length;\nforeach (var i in bytes)\n{\n    processed += i.Length;\n    var isLast = processed == total;\n    var span = i.Span;\n    var charCount = decoder.GetCharCount(span, isLast);\n    Span&lt;char&gt; buffer = stackalloc char[charCount];\n    decoder.GetChars(span, buffer, isLast);\n    sb.Append(buffer);\n}\n</code></pre>\n\n<p>From <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.text.encoding.getdecoder?view=netcore-3.0\" rel=\"nofollow noreferrer\">the docs:</a></p>\n\n<blockquote>\n  <p>The Decoder.GetChars method converts sequential blocks of bytes into sequential blocks of characters, in a manner similar to the GetChars method of this class. However, a Decoder maintains state information between calls so it correctly decodes byte sequences that span blocks. The Decoder also preserves trailing bytes at the end of data blocks and uses the trailing bytes in the next decoding operation. Therefore, GetDecoder and GetEncoder are useful for network transmission and file operations, because those operations often deal with blocks of data instead of a complete data stream.</p>\n</blockquote>\n\n<p>Of course the <code>StringBuilder</code> would introduce a new source for allocations, but  you can replace it with some other kind of buffer if that is a problem.</p>\n"}, {"comments": [{"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 1, "creation_date": 1599722321, "post_id": 62232559, "comment_id": 112862560, "body": "stackalloc of a potentially unbounded size is frankly a terrible idea"}, {"owner": {"reputation": 14818, "user_id": 887092, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f32f9cc44aa9f68786d2e2830f9a268e?s=128&d=identicon&r=PG", "display_name": "Todd", "link": "https://stackoverflow.com/users/887092/todd"}, "reply_to_user": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1599813536, "post_id": 62232559, "comment_id": 112896369, "body": "@marcgravell Agreed. There could be a maximum bounds check and fallback to a heapbased character array"}], "tags": [], "owner": {"reputation": 14818, "user_id": 887092, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f32f9cc44aa9f68786d2e2830f9a268e?s=128&d=identicon&r=PG", "display_name": "Todd", "link": "https://stackoverflow.com/users/887092/todd"}, "is_accepted": false, "score": 0, "last_activity_date": 1591450848, "creation_date": 1591450848, "answer_id": 62232559, "question_id": 56979469, "link": "https://stackoverflow.com/questions/56979469/parse-utf8-string-from-readonlysequencebyte/62232559#62232559", "title": "Parse UTF8 string from ReadOnlySequence&lt;byte&gt;", "body": "<p><em>Warning: <strong>Not tested</em></strong></p>\n\n<p>I made an improvement on the official answer:</p>\n\n<ul>\n<li>Packaged as an extension method</li>\n<li>Eliminates the need for a <code>StringBuilder</code>, by allocating an overestimate of the character array upfront</li>\n<li>Eliminates the need for the extra <code>GetCharCount</code> step, by using the single large array, summing the total characters found by <code>GetChars</code>, and shifting the target span slice</li>\n<li>Renaming a few variables. <code>preProcessedBytes</code> was particularly important to me, IMO they are not processed until after characters are derived.</li>\n<li>Using a stringLengthEstimate parameter so this can be used with protocols where the string length (in terms of character count) has been stored as a header before the UTF8 bytes</li>\n</ul>\n\n<p>Here is the source code:</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Parses UTF8 characters in the ReadOnlySequence\n/// &lt;/summary&gt;\n/// &lt;param name=\"slice\"&gt;Aligned slice of ReadOnlySequence that contains the UTF8 string bytes. Use slice before calling this function to ensure you have an aligned slice.&lt;/param&gt;\n/// &lt;param name=\"stringLengthEstimate\"&gt;The amount of characters in the final string. You should use a header before the string bytes for the best accuracy. If you are not sure -1 means that the most pessimistic estimate will be used: slice.Length&lt;/param&gt;\n/// &lt;returns&gt;a string parsed from the bytes in the ReadOnlySequence&lt;/returns&gt;\npublic static string ParseAsUTF8String(this ReadOnlySequence&lt;byte&gt; slice, int stringLengthEstimate = -1)\n{\n    if (stringLengthEstimate == -1)\n        stringLengthEstimate = (int)slice.Length; //overestimate\n    var decoder = Encoding.UTF8.GetDecoder();\n    var preProcessedBytes = 0;\n    var processedCharacters = 0;\n    Span&lt;char&gt; characterSpan = stackalloc char[stringLengthEstimate]; \n    foreach (var memory in slice)\n    {\n        preProcessedBytes += memory.Length;\n        var isLast = (preProcessedBytes == slice.Length);\n        var emptyCharSlice = characterSpan.Slice(processedCharacters, characterSpan.Length - processedCharacters);\n        var charCount = decoder.GetChars(memory.Span, emptyCharSlice, isLast);\n        processedCharacters += charCount;\n    }\n    var finalCharacters = characterSpan.Slice(0, processedCharacters);\n    return new string(finalCharacters);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1216, "user_id": 12509023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab00c6225f17bf3dd60aa0e7fe0328b?s=128&d=identicon&r=PG&f=1", "display_name": "ahsonkhan", "link": "https://stackoverflow.com/users/12509023/ahsonkhan"}, "edited": false, "score": 0, "creation_date": 1600443903, "post_id": 63824568, "comment_id": 113100102, "body": "What if <code>payload.Length</code> is &gt; 2 GB? Also, its useful to note that this will be <i>amortized</i> allocation free, and only for <code>payload.Length</code> &lt; 2 MB. Beyond that, the <code>ArrayPool</code> (at least the current implementation), allocates an array anyway."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 1216, "user_id": 12509023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab00c6225f17bf3dd60aa0e7fe0328b?s=128&d=identicon&r=PG&f=1", "display_name": "ahsonkhan", "link": "https://stackoverflow.com/users/12509023/ahsonkhan"}, "edited": false, "score": 1, "creation_date": 1600495712, "post_id": 63824568, "comment_id": 113112083, "body": "@ahsonkhan if the payload is over 2GiB then the string you need to create is likely over 4GiB (hard to know exact length, because of multi-byte UTF8 vs UTF16 with surrogate pairs, etc). So... Good luck with that! As for over the array pool size: &quot;option 2&quot;"}], "tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": false, "score": 4, "last_activity_date": 1599722553, "last_edit_date": 1599722553, "creation_date": 1599722119, "answer_id": 63824568, "question_id": 56979469, "link": "https://stackoverflow.com/questions/56979469/parse-utf8-string-from-readonlysequencebyte/63824568#63824568", "title": "Parse UTF8 string from ReadOnlySequence&lt;byte&gt;", "body": "<p>The first thing we should do here is test whether the sequence actually is a single span; if it is, we can <em>hugely</em> simplify and optimize.</p>\n<p>Once we know that we have a multi-segment (discontiguous) buffer, there are two ways we can go:</p>\n<ol>\n<li>linearize the segments into a contiguous buffer, probably leasing an oversized buffer from ArrayPool.Shared, and use UTF8.GetString on the correct portion of the leased buffer, or</li>\n<li>use the <code>GetDecoder()</code> API on the encoding, and use that to populate a new string, which on older frameworks means overwriting a newly allocated string, or in newer frameworks means using the <code>string.Create</code> API</li>\n</ol>\n<p>The first option is <em>massively simpler</em>, but involves a few memory-copy operations (but no additional allocations other than the string):</p>\n<pre class=\"lang-cs prettyprint-override\"><code>public static string GetString(in this ReadOnlySequence&lt;byte&gt; payload,\n    Encoding encoding = null)\n{\n    encoding ??= Encoding.UTF8;\n    return payload.IsSingleSegment ? encoding.GetString(payload.FirstSpan)\n        : GetStringSlow(payload, encoding);\n\n    static string GetStringSlow(in ReadOnlySequence&lt;byte&gt; payload, Encoding encoding)\n    {\n        // linearize\n        int length = checked((int)payload.Length);\n        var oversized = ArrayPool&lt;byte&gt;.Shared.Rent(length);\n        try\n        {\n            payload.CopyTo(oversized);\n            return encoding.GetString(oversized, 0, length);\n        }\n        finally\n        {\n            ArrayPool&lt;byte&gt;.Shared.Return(oversized);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7644, "user_id": 78561, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1c5255f8496fcade0244f12cb6ca6405?s=128&d=identicon&r=PG", "display_name": "trampster", "link": "https://stackoverflow.com/users/78561/trampster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2442, "favorite_count": 3, "accepted_answer_id": 57070991, "answer_count": 3, "score": 7, "last_activity_date": 1599722553, "creation_date": 1562798051, "last_edit_date": 1562799293, "question_id": 56979469, "link": "https://stackoverflow.com/questions/56979469/parse-utf8-string-from-readonlysequencebyte", "title": "Parse UTF8 string from ReadOnlySequence&lt;byte&gt;", "body": "<p>How can I parse a UTF8 string from a ReadOnlySequence </p>\n\n<p>ReadOnlySequence is made of parts, and seeing as UTF8 characters are variable length the break in the parts could be in the middle of a character .\nSo simply using Encoding.UTF8.GetString() on the parts and combining them in a StringBuilder will not work.</p>\n\n<p>Is it possible to parse a UTF8 string from a ReadOnlySequence without first combining them into an array. I would prefer to avoid a memory allocation here.</p>\n"}, {"tags": ["c#", "visual-studio-mac"], "comments": [{"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 1, "creation_date": 1562798075, "post_id": 56979393, "comment_id": 100494781, "body": "<code>making debugging a lot harder.</code> Are you saying it compiled and you were able to start debugging even though the <code>;</code> was missing?"}, {"owner": {"reputation": 31, "user_id": 11767305, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_ywzOdYV0_Y/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYcCEs4eqlXEHDDqdATLbsn-AnS3w/mo/photo.jpg?sz=128", "display_name": "Austin Mackrell", "link": "https://stackoverflow.com/users/11767305/austin-mackrell"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 1, "creation_date": 1562798174, "post_id": 56979393, "comment_id": 100494807, "body": "it would compile in the script, when I got to unity it would give me a compile error. Edit* I believe. I may be using the wrong terminology. I&#39;m fairly new to this, I save the project and it updates in unity and gives me the error. On my windows version it will prompt me to fix my errors with the red underline. Same as if you misspell a word in a word processor program."}], "answers": [{"tags": [], "owner": {"reputation": 598, "user_id": 8903213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10155717958227660/picture?type=large", "display_name": "Michael Economy", "link": "https://stackoverflow.com/users/8903213/michael-economy"}, "is_accepted": false, "score": 0, "last_activity_date": 1598913840, "creation_date": 1598913840, "answer_id": 63679112, "question_id": 56979393, "link": "https://stackoverflow.com/questions/56979393/visual-studio-2019-not-underlining-errors-on-mac/63679112#63679112", "title": "Visual Studio 2019 not underlining errors on Mac", "body": "<p>The setting is View -&gt; Inline Messages.  HOWEVER: This was set correctly and it still didn't work for me.  After a combination of fixing compile errors (letting it compile once) and then restarting VS, it is now working for me.</p>\n"}], "owner": {"reputation": 31, "user_id": 11767305, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_ywzOdYV0_Y/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYcCEs4eqlXEHDDqdATLbsn-AnS3w/mo/photo.jpg?sz=128", "display_name": "Austin Mackrell", "link": "https://stackoverflow.com/users/11767305/austin-mackrell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 750, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1598913840, "creation_date": 1562797435, "last_edit_date": 1562797727, "question_id": 56979393, "link": "https://stackoverflow.com/questions/56979393/visual-studio-2019-not-underlining-errors-on-mac", "title": "Visual Studio 2019 not underlining errors on Mac", "body": "<p>Visual Studio is not underlining errors. For example on my PC if type out:\nprivate int myInt </p>\n\n<p>it will put a little red underline after because i forgot ; </p>\n\n<p>on my mac it does nothing making debugging a lot harder. </p>\n\n<p>I did a few google searches but the only thing i find is to go to Tools \u2192 Options \u2192 Text Editor \u2192 C# \u2192 Advanced \u2192 Underline errors. Tools doesn't have an options tab on the Mac version, and when I found the Text Editor \u2192 C# under preferences, theres no Advanced option.</p>\n"}, {"tags": ["c#", "naudio"], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 980672, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/56f0523f2000cb2232e7dccb820d2950?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/980672/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1562888981, "creation_date": 1562888981, "answer_id": 56998627, "question_id": 56979362, "link": "https://stackoverflow.com/questions/56979362/how-to-resample-raw-audio-from-wasapicapture-to-g711-mulaw-with-naudio/56998627#56998627", "title": "How to resample raw audio from WasapiCapture to g711 mulaw with NAudio?", "body": "<p>After struggling with this library and hacking together several different <em>recommendations</em> from various sources, I ended up with something that finally worked, so hopefully this saves others a lot of headache.</p>\n\n<p>I essentially had to roll my own IWaveProvider and do various custom filters and whatnot until it worked.</p>\n\n<pre><code>public class MuLawResamplerProvider : IWaveProvider\n{\n    public WaveFormat WaveFormat =&gt; WaveFormat.CreateMuLawFormat(8000, 1);\n\n    private BufferedWaveProvider waveBuffer;\n\n    private IWaveProvider ieeeToPcm;\n\n    private byte[] sourceBuffer;\n\n    /// &lt;summary&gt;\n    /// Converts from 32-bit Ieee Floating-point format to MuLaw 8khz 8-bit 1 channel.\n    /// Used for WasapiCapture and WasapiLoopbackCapture.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"audio\"&gt;The raw audio stream.&lt;/param&gt;\n    /// &lt;param name=\"inputFormat\"&gt;The input format.&lt;/param&gt;\n    public MuLawResamplerProvider(byte[] stream, WaveFormat inputFormat)\n    {\n        // Root buffer provider.\n        waveBuffer = new BufferedWaveProvider(inputFormat);\n        waveBuffer.DiscardOnBufferOverflow = false;\n        waveBuffer.ReadFully = false;\n        waveBuffer.AddSamples(stream, 0, stream.Length);\n\n        var sampleStream = new WaveToSampleProvider(waveBuffer);\n\n        // Stereo to mono filter.\n        var monoStream = new StereoToMonoSampleProvider(sampleStream)\n        {\n            LeftVolume = 2.0f,\n            RightVolume = 2.0f\n        };\n\n        // Downsample to 8000 filter.\n        var resamplingProvider = new WdlResamplingSampleProvider(monoStream, 8000);\n\n        // Convert to 16-bit in order to use ACM or MuLaw tools.\n        ieeeToPcm = new SampleToWaveProvider16(resamplingProvider);\n\n        sourceBuffer = new byte[ieeeToPcm.WaveFormat.AverageBytesPerSecond];\n    }\n\n    /// &lt;summary&gt;\n    /// Reset the buffer to the starting position with a new stream.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"stream\"&gt;New stream to initialize.&lt;/param&gt;\n    public void Reset(byte[] stream)\n    {\n        waveBuffer.ClearBuffer();\n        waveBuffer.AddSamples(stream, 0, stream.Length);\n    }\n\n    /// &lt;summary&gt;\n    /// Converts the 16-bit ACM stream to 8-bit MuLaw on read.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"destinationBuffer\"&gt;The destination buffer to output into.&lt;/param&gt;\n    /// &lt;param name=\"offset\"&gt;The offset to store at.&lt;/param&gt;\n    /// &lt;param name=\"readingCount\"&gt;The requested size to read.&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public int Read(byte[] destinationBuffer, int offset, int readingCount)\n    {\n        // Source buffer has twice as many items as the output array.\n        var sizeOfPcmBuffer = readingCount * 2;\n        sourceBuffer = BufferHelpers.Ensure(sourceBuffer, sizeOfPcmBuffer);\n        var sourceBytesRead = ieeeToPcm.Read(sourceBuffer, 0, sizeOfPcmBuffer);\n        var samplesRead = sourceBytesRead / 2;\n\n        var outIndex = 0;\n        for (var n = 0; n &lt; sizeOfPcmBuffer; n += 2)\n        {\n            destinationBuffer[outIndex++] = MuLawEncoder.LinearToMuLawSample(BitConverter.ToInt16(sourceBuffer, offset + n));\n        }\n\n        return samplesRead;\n    }\n}\n</code></pre>\n\n<p>And then you can do something as simple as this with it</p>\n\n<pre><code>        var resampler = new MuLawResamplerProvider(deviceStream.ToArray(), ActiveWasapiCaptureDevice.WaveFormat);\n\n        // Write it out to a local file\n        string path = @\"C:\\Temp\\\" + Guid.NewGuid().ToString() + \".wav\";\n        WaveFileWriter.CreateWaveFile(path, resampler);\n        resampler.Reset(deviceStream.ToArray());\n\n        // Write it into memory for other uses\n        MemoryStream outputStream = new MemoryStream();\n        WaveFileWriter.WriteWavFileToStream(outputStream, resampler);\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 980672, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/56f0523f2000cb2232e7dccb820d2950?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/980672/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 56998627, "answer_count": 1, "score": 0, "last_activity_date": 1562888981, "creation_date": 1562797194, "question_id": 56979362, "link": "https://stackoverflow.com/questions/56979362/how-to-resample-raw-audio-from-wasapicapture-to-g711-mulaw-with-naudio", "title": "How to resample raw audio from WasapiCapture to g711 mulaw with NAudio?", "body": "<p>I'm trying to use NAudio to make a client to simulate a softphone to send telephony RTP packets in g.711 MuLaw format by capturing the local microphone/speaker devices, but this process is missing some steps that don't make sense with the outdated information available. MuLaw is incompatible with MediaFoundationResampler and WdlResampler, the ACM resampler garbles the audio quality completely, and the below code gets me to PCM but from there there's no information on how to go forward. Is there supposed to be a low-pass filter or something added here? Are you supposed to be converting the raw byte data from the WasapiCapture event to 16-bit according to a <a href=\"https://markheath.net/post/how-to-convert-byte-to-short-or-float\" rel=\"nofollow noreferrer\">2013 article</a> (which is incompatible with the MFR anyway)? </p>\n\n<p>I have no knowledge or experience working with audio, so this entire process is foreign to me and need some direction on where to proceed from here, as the <a href=\"https://stackoverflow.com/questions/54041389/how-to-convert-linear16-pcm-wav-to-g711-8-bit-8-khz-mulaw-wav-with-same-quality\">only closest answer</a> didn't actually post how they \"solved\" it.</p>\n\n<pre><code>private static IWaveIn ActiveMicrophone = new WasapiCapture(ActiveMicrophoneDevice);\nActiveMicrophone.DataAvailable += OnMicrophoneDataAvailableAsync;\n...\nprivate async void OnMicrophoneDataAvailableAsync(object sender, WaveInEventArgs e)\n{\n    MemoryStream micStream = new MemoryStream();\n    micStream.Write(e.Buffer, 0, e.BytesRecorded);\n    micStream.Position = 0;\n    var inputStream = new RawSourceWaveStream(micStream, ActiveMicrophone.WaveFormat);\n    WaveFormat outputFormat = new WaveFormat(8000, 8, 1);\n    using (var resampler = new MediaFoundationResampler(inputStream, outputFormat))\n    {\n        MemoryStream outputStream = new MemoryStream();\n        WaveFileWriter.WriteWavFileToStream(outputStream, resampler);\n        // Do something with outputStream?\n    }\n}\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 3, "creation_date": 1562797378, "post_id": 56979356, "comment_id": 100494585, "body": "Does it need to be thread safe? as this is obviously not"}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 3, "creation_date": 1562797439, "post_id": 56979356, "comment_id": 100494605, "body": "What\u2019s wrong with what you have? It makes the behavior crystal clear."}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 2, "creation_date": 1562797540, "post_id": 56979356, "comment_id": 100494632, "body": "<code>if (!_firstTime) { return false; } else { _firstTime = false; return true; }</code>"}, {"owner": {"reputation": 289, "user_id": 1541494, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/I3wYb.png?s=128&g=1", "display_name": "BartmanDilaw", "link": "https://stackoverflow.com/users/1541494/bartmandilaw"}, "reply_to_user": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 1, "creation_date": 1562797798, "post_id": 56979356, "comment_id": 100494709, "body": "@TheGeneral : not my point right now... but now understand why :)"}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 2, "creation_date": 1562798092, "post_id": 56979356, "comment_id": 100494785, "body": "Generally you ask these sort of questions on other Stack Exchange sites (because your current code works, there is no issue other than improving it).  There may be sites dedicated to code review but be sure you read the appropriate FAQ and reformat your question as necessary before posting"}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 3, "creation_date": 1562798454, "post_id": 56979356, "comment_id": 100494884, "body": "<a href=\"https://dotnetfiddle.net/4vM8mc\" rel=\"nofollow noreferrer\">dotnetfiddle.net/4vM8mc</a>"}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1562799096, "post_id": 56979356, "comment_id": 100495020, "body": "@Renat Given the popularity of your answer below, if you adapt it slightly as per my dotnetfiddle link I think it would make sense to undelete it."}], "answers": [{"tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": true, "score": 3, "last_activity_date": 1562798891, "last_edit_date": 1562798891, "creation_date": 1562798390, "answer_id": 56979512, "question_id": 56979356, "link": "https://stackoverflow.com/questions/56979356/a-static-property-which-returns-true-the-first-time-then-always-false-after-tha/56979512#56979512", "title": "A static property which returns true the first time, then always false after that", "body": "<p>You can return the result of an assignment in C#, which means you could do a comparison, and if <code>firstTime</code> is <code>true</code>, you can return the negative of assigning it to <code>false</code>:</p>\n\n<pre><code>private static bool firstTime = true;\npublic static bool FirstTime =&gt; firstTime ? !(firstTime = false) : firstTime;\n</code></pre>\n\n<p>But your way is easier to understand.</p>\n\n<p>Note: this is exactly as thread safe as your original code (which you said \"works\"), meaning it's not thread safe.</p>\n"}, {"tags": [], "owner": {"reputation": 5838, "user_id": 1075282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70efe94a6c2237ec96f429402a03a27d?s=128&d=identicon&r=PG", "display_name": "Renat", "link": "https://stackoverflow.com/users/1075282/renat"}, "is_accepted": false, "score": 0, "last_activity_date": 1562800896, "creation_date": 1562800896, "answer_id": 56979781, "question_id": 56979356, "link": "https://stackoverflow.com/questions/56979356/a-static-property-which-returns-true-the-first-time-then-always-false-after-tha/56979781#56979781", "title": "A static property which returns true the first time, then always false after that", "body": "<p>You may abuse that <code>&amp;&amp;</code> is a short circuit like below. But don't use it at work, as your first example is much more easier to read. And it isn't thread safe.</p>\n\n<pre><code>static bool _firstTime = true;\n\nprivate static bool FirstTime\n    =&gt; _firstTime &amp;&amp; !(_firstTime = false);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 2, "creation_date": 1562806347, "post_id": 56980151, "comment_id": 100496381, "body": "<a href=\"https://stackoverflow.com/a/5341252/34092\">stackoverflow.com/a/5341252/34092</a> and <a href=\"https://stackoverflow.com/questions/4187914/average-latency-of-atomics-cmpxchg-instructions-on-intel-cpus\" title=\"average latency of atomics cmpxchg instructions on intel cpus\">stackoverflow.com/questions/4187914/&hellip;</a> cover it a little."}, {"owner": {"reputation": 2114, "user_id": 5623232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d415f90d71b25875885b8cfb4ec008?s=128&d=identicon&r=PG", "display_name": "NPras", "link": "https://stackoverflow.com/users/5623232/npras"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1562807615, "post_id": 56980151, "comment_id": 100496596, "body": "&#39;tis a deep rabbit hole indeed. With the best answer being &quot;under ideal conditions, the best implementation puts them at equal&quot;, I guess."}], "tags": [], "owner": {"reputation": 2114, "user_id": 5623232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d415f90d71b25875885b8cfb4ec008?s=128&d=identicon&r=PG", "display_name": "NPras", "link": "https://stackoverflow.com/users/5623232/npras"}, "is_accepted": false, "score": 2, "last_activity_date": 1562804890, "last_edit_date": 1562804890, "creation_date": 1562804438, "answer_id": 56980151, "question_id": 56979356, "link": "https://stackoverflow.com/questions/56979356/a-static-property-which-returns-true-the-first-time-then-always-false-after-tha/56980151#56980151", "title": "A static property which returns true the first time, then always false after that", "body": "<p>If you want something thread-safe and compact, <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.threading.interlocked.exchange\" rel=\"nofollow noreferrer\"><code>Interlocked.Exchange()</code></a> fits the bill.  It will set your variable and return the old value (exactly what you did in your code) in a thread-safe manner.</p>\n\n<p>The only caveat is that your private field can't be a bool. But whatever happens behind a public property shouldn't matter externally anyway.</p>\n\n<pre><code>static int _isFirstTime = 1;\npublic static bool IsFirstTime =&gt; Interlocked.Exchange(ref _isFirstTime, 0) != 0;\n</code></pre>\n"}], "owner": {"reputation": 289, "user_id": 1541494, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/I3wYb.png?s=128&g=1", "display_name": "BartmanDilaw", "link": "https://stackoverflow.com/users/1541494/bartmandilaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 56979512, "answer_count": 3, "score": 1, "last_activity_date": 1562804890, "creation_date": 1562797153, "last_edit_date": 1562797617, "question_id": 56979356, "link": "https://stackoverflow.com/questions/56979356/a-static-property-which-returns-true-the-first-time-then-always-false-after-tha", "title": "A static property which returns true the first time, then always false after that", "body": "<p>I'm looking to write C# simple statement using static bool which return true the first time, then always false.</p>\n\n<pre><code>    static bool _firstTime = true;\n    static bool FirstTime\n    {\n            get\n            {\n                    bool old = _firstTime;\n                    _firstTime = false;\n                    return old;\n            }\n    }\n</code></pre>\n\n<p>This works, but i'm looking for something shorter without temporary variable (here \"old\").</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "entity-framework-6", "db-first"], "comments": [{"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562872492, "post_id": 56979306, "comment_id": 100525981, "body": "<i>I need to delete a role</i> -- Do you really mean a <code>Role</code> or a <code>Person_Role</code>?"}, {"owner": {"reputation": 3, "user_id": 11767264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc709d93bbc46e346af0aea265c9428?s=128&d=identicon&r=PG&f=1", "display_name": "Fudo", "link": "https://stackoverflow.com/users/11767264/fudo"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562911875, "post_id": 56979306, "comment_id": 100535298, "body": "Hi, a Person_Role not a Role, i typed wrongly"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11767264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc709d93bbc46e346af0aea265c9428?s=128&d=identicon&r=PG&f=1", "display_name": "Fudo", "link": "https://stackoverflow.com/users/11767264/fudo"}, "edited": false, "score": 0, "creation_date": 1562911920, "post_id": 56981204, "comment_id": 100535316, "body": "Hi, sortry i meant i want to delete a PERSON_ROLE not a role."}], "tags": [], "owner": {"reputation": 1, "user_id": 8200840, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tzL8M.jpg?s=128&g=1", "display_name": "EsH Harshana", "link": "https://stackoverflow.com/users/8200840/esh-harshana"}, "is_accepted": false, "score": 0, "last_activity_date": 1562815480, "creation_date": 1562815480, "answer_id": 56981204, "question_id": 56979306, "link": "https://stackoverflow.com/questions/56979306/ef-cannot-remove-object/56981204#56981204", "title": "EF Cannot remove object", "body": "<p>You can not delete data if which is referenced to another table as foreign key, but you done through</p>\n\n<p>Remove value from referenced table after then you can able to perform delete operation only</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11767264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc709d93bbc46e346af0aea265c9428?s=128&d=identicon&r=PG&f=1", "display_name": "Fudo", "link": "https://stackoverflow.com/users/11767264/fudo"}, "edited": false, "score": 0, "creation_date": 1562911906, "post_id": 56981596, "comment_id": 100535313, "body": "Hi, sorry i meant i want to delete a PERSON_ROLE not a role. The issue is in the first part of your code: DbContext.Persons_Roles.RemoveRange(personRoles); That&#39;s where i get the error."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "reply_to_user": {"reputation": 3, "user_id": 11767264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc709d93bbc46e346af0aea265c9428?s=128&d=identicon&r=PG&f=1", "display_name": "Fudo", "link": "https://stackoverflow.com/users/11767264/fudo"}, "edited": false, "score": 0, "creation_date": 1562925779, "post_id": 56981596, "comment_id": 100542207, "body": "@Fudo No, that&#39;s exactly what you should do, not <code>oP.Persons_Roles.Remove(oR);</code>. When you remove from <code>oP.Persons_Roles</code> EF will try to set a FK to null, whereas removing from <code>DbContext.Persons_Roles</code> will delete the record."}, {"owner": {"reputation": 3, "user_id": 11767264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc709d93bbc46e346af0aea265c9428?s=128&d=identicon&r=PG&f=1", "display_name": "Fudo", "link": "https://stackoverflow.com/users/11767264/fudo"}, "edited": false, "score": 0, "creation_date": 1562930434, "post_id": 56981596, "comment_id": 100544636, "body": "I now see what you mean. Thanks not it&#39;s ok !"}], "tags": [], "owner": {"reputation": 3921, "user_id": 7086678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg5hf.jpg?s=128&g=1", "display_name": "Farhad Zamani", "link": "https://stackoverflow.com/users/7086678/farhad-zamani"}, "is_accepted": true, "score": 2, "last_activity_date": 1562818912, "creation_date": 1562818912, "answer_id": 56981596, "question_id": 56979306, "link": "https://stackoverflow.com/questions/56979306/ef-cannot-remove-object/56981596#56981596", "title": "EF Cannot remove object", "body": "<p>If you want to delete a rule, you must first delete all the records that are refrenced to that rule.\nFor example, you must first clear all the records in the Person_Roles table and then delete the rule from Role Table</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var personRoles = DbContext.Persons_Roles.Where(p=&gt;p.ID_ROLE == 2).ToList();\nDbContext.Persons_Roles.RemoveRange(personRoles);\nvar role = DbContect.Roles.Single(a=&gt;a.ID==2);\nDbContext.Roles.Remove(role);\nDbContext.SaveChanges();\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11767264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc709d93bbc46e346af0aea265c9428?s=128&d=identicon&r=PG&f=1", "display_name": "Fudo", "link": "https://stackoverflow.com/users/11767264/fudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 56981596, "answer_count": 2, "score": 0, "last_activity_date": 1562818912, "creation_date": 1562796754, "last_edit_date": 1562817120, "question_id": 56979306, "link": "https://stackoverflow.com/questions/56979306/ef-cannot-remove-object", "title": "EF Cannot remove object", "body": "<p>In my model I have similar tables:</p>\n\n<ul>\n<li><p><code>Persons (ID-NAME)</code> e.g. (1-Paul - 2-Frank - 3-George)</p></li>\n<li><p><code>Roles (ID-NAME)</code> e.g. (1-Admin - 2-Developer - 3-Junior)</p></li>\n<li><p><code>Persons_Roles (ID_PERSON Not Null</code> - ID_ROLE Not Null e.g. (1-1 - 1-2 - 2-3 - 2-1 - 3-2)</p></li>\n</ul>\n\n<p>Table <code>Persons_Roles</code> has a foreign key on both <code>Persons</code> and <code>Roles</code> tables.</p>\n\n<p>I need to delete a role. I actually do</p>\n\n<pre><code>Persons oP = DbContext.Persons.Single(p=&gt;p.ID == 1);\nPersons_Roles oR = oP.Persons_Roles.Single(p=&gt;p.ID_ROLE == 2);\noP.Persons_Roles.Remove(oR);\nDbContext.SaveChanges();\n</code></pre>\n\n<p>But I get this error </p>\n\n<blockquote>\n  <p>The operation failed: The relationship could not be changed because one or more of the foreign-key properties is non-nullable. When a change is made to a relationship, the related foreign-key property is set to a null value. If the foreign-key does not support null values, a new relationship must be defined, the foreign-key property must be assigned another non-null value, or the unrelated object must be deleted.</p>\n</blockquote>\n\n<p>Why am I getting this error and what do I do to fix it?</p>\n"}, {"tags": ["c#", "css", "asp.net-core-mvc", "tag-helpers"], "comments": [{"owner": {"reputation": 36576, "user_id": 2341603, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZTHIr.jpg?s=128&g=1", "display_name": "Obsidian Age", "link": "https://stackoverflow.com/users/2341603/obsidian-age"}, "edited": false, "score": 0, "creation_date": 1562796450, "post_id": 56979226, "comment_id": 100494379, "body": "Shouldn&#39;t your <code>Foo</code> or <code>Bar</code> equal <code>bluetext</code>?"}, {"owner": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "edited": false, "score": 0, "creation_date": 1562803118, "post_id": 56979226, "comment_id": 100495767, "body": "What&#39;s wrong with adding <code>class=&quot;bluetext&quot;</code> on each label generated by the tag helper like <code>&lt;label asp-for=&quot;&quot; class=&quot;bluetext&quot; &#47;&gt;</code>?"}, {"owner": {"reputation": 590, "user_id": 3154478, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8061ae3b91623466de6bce489a422a23?s=128&d=identicon&r=PG&f=1", "display_name": "Mkalafut", "link": "https://stackoverflow.com/users/3154478/mkalafut"}, "reply_to_user": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "edited": false, "score": 0, "creation_date": 1562806085, "post_id": 56979226, "comment_id": 100496326, "body": "@DavidLiang Because one is dynamic from the model, the other is a label that will be on the form.  I want the text input by the user to be a different color.  For example, an actual form value will be Name &amp; Email.  So the labels will be &quot;Name&quot; and &quot;Email&quot; while the value will be entered by the user.  That value will be stored in the model and I want that to be blue on the next page, not the label denoting what field is being displayed."}, {"owner": {"reputation": 590, "user_id": 3154478, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8061ae3b91623466de6bce489a422a23?s=128&d=identicon&r=PG&f=1", "display_name": "Mkalafut", "link": "https://stackoverflow.com/users/3154478/mkalafut"}, "reply_to_user": {"reputation": 36576, "user_id": 2341603, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZTHIr.jpg?s=128&g=1", "display_name": "Obsidian Age", "link": "https://stackoverflow.com/users/2341603/obsidian-age"}, "edited": false, "score": 0, "creation_date": 1562806125, "post_id": 56979226, "comment_id": 100496330, "body": "@ObsidianAge Yes, later in the question I demonstrate how I attempted to use it as <code>&lt;label class=&quot;bluetext&quot;&gt;@Model.Foo&lt;&#47;label&gt;</code>"}, {"owner": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "edited": false, "score": 0, "creation_date": 1562806333, "post_id": 56979226, "comment_id": 100496376, "body": "@Mkalafut: I still don&#39;t get what you meant by that. <code>&lt;label asp-for=&quot;Foo&quot;&gt;&lt;&#47;label&gt;</code> will generate a label with the property&#39;s display name annotation.  <code>&lt;label&gt;@Model.Foo&lt;&#47;label&gt;</code> will generate a label with the property value. Your code shows labels only. I don&#39;t see any input controlls."}, {"owner": {"reputation": 590, "user_id": 3154478, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8061ae3b91623466de6bce489a422a23?s=128&d=identicon&r=PG&f=1", "display_name": "Mkalafut", "link": "https://stackoverflow.com/users/3154478/mkalafut"}, "reply_to_user": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "edited": false, "score": 0, "creation_date": 1562806471, "post_id": 56979226, "comment_id": 100496402, "body": "@DavidLiang You&#39;re correct.  We&#39;re saying the same thing.  When I apply the class, the text is still not blue.  <code>&lt;label class=&quot;bluetext&quot;&gt;@Model.Foo&lt;&#47;label&gt;</code> still displays the default standard text color."}, {"owner": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "edited": false, "score": 0, "creation_date": 1562806603, "post_id": 56979226, "comment_id": 100496430, "body": "@Mkalafut: that has nothing to do with tag helpers since the label <code>&lt;label class=&quot;bluetext&quot;&gt;@Model.Foo&lt;&#47;label&gt;</code> is not generated by that. There must be something with your CSS files. I bet some other styles override this .bluetext style. Check the orders of how you load those CSS files. At least show us the screenshot on the label with the developer tool turned on."}, {"owner": {"reputation": 590, "user_id": 3154478, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8061ae3b91623466de6bce489a422a23?s=128&d=identicon&r=PG&f=1", "display_name": "Mkalafut", "link": "https://stackoverflow.com/users/3154478/mkalafut"}, "reply_to_user": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "edited": false, "score": 0, "creation_date": 1562850903, "post_id": 56979226, "comment_id": 100514826, "body": "@DavidLiang Came in this morning after restarting my PC and now it&#39;s working.  This is embarrassing.  Must have been a cache issue or something.  Style applied as expected and I changed nothing."}], "answers": [{"comments": [{"owner": {"reputation": 590, "user_id": 3154478, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8061ae3b91623466de6bce489a422a23?s=128&d=identicon&r=PG&f=1", "display_name": "Mkalafut", "link": "https://stackoverflow.com/users/3154478/mkalafut"}, "edited": false, "score": 0, "creation_date": 1562850943, "post_id": 56980686, "comment_id": 100514850, "body": "Was probably a cache issue.  I came in this morning and did exactly what you proposed.  Loaded up the solution, immediately saw the blue text on the screen and the style applied to my label.  Thanks."}], "tags": [], "owner": {"reputation": 14390, "user_id": 10158551, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/45RCc.jpg?s=128&g=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/10158551/ryan"}, "is_accepted": true, "score": 1, "last_activity_date": 1562813431, "last_edit_date": 1562813431, "creation_date": 1562810344, "answer_id": 56980686, "question_id": 56979226, "link": "https://stackoverflow.com/questions/56979226/how-can-style-be-applied-to-tag-helpers-in-a-asp-net-core-razor-view/56980686#56980686", "title": "How can style be applied to tag helpers in a ASP.NET Core Razor view?", "body": "<p>You could press F12 to open DevTools and check whether the custom styles are applied successfully in the Sources Tab -> css folder -> site.css.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Szf1k.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Szf1k.png\" alt=\"enter image description here\"></a></p>\n\n<p>If not, clear cache and reload the page.</p>\n\n<p>Try to use <code>asp-append-version=\"true\"</code> in your reference. It will append a version as a query string parameter which changes when the file is modified.</p>\n\n<pre><code> &lt;link rel=\"stylesheet\" href=\"~/css/site.css\" asp-append-version=\"true\"/&gt;\n</code></pre>\n\n<p>You could also direcly add styles in Index.cshtml to make it</p>\n\n<pre><code>&lt;style&gt;\n   label.bluetext {\n      color:#3064b8;\n   }\n&lt;/style&gt;\n</code></pre>\n"}], "owner": {"reputation": 590, "user_id": 3154478, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8061ae3b91623466de6bce489a422a23?s=128&d=identicon&r=PG&f=1", "display_name": "Mkalafut", "link": "https://stackoverflow.com/users/3154478/mkalafut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1298, "favorite_count": 0, "accepted_answer_id": 56980686, "answer_count": 1, "score": 0, "last_activity_date": 1562813431, "creation_date": 1562796243, "question_id": 56979226, "link": "https://stackoverflow.com/questions/56979226/how-can-style-be-applied-to-tag-helpers-in-a-asp-net-core-razor-view", "title": "How can style be applied to tag helpers in a ASP.NET Core Razor view?", "body": "<p>In a standard ASP.NET Core application say I have the following:</p>\n\n<p>Model.cs</p>\n\n<pre><code>[Display(Name = \"Foo\")]\npublic string Foo { get;set; }\n\n[Display(Name = \"Bar\")]\npublic string Bar{ get;set; }\n</code></pre>\n\n<p>Index.cshtml</p>\n\n<pre><code>    &lt;div class=\"form-group\"&gt;\n        &lt;div class=\"form-row\"&gt;\n            &lt;div class=\"form-group col-sm-3\"&gt;\n                &lt;label asp-for=\"Foo\"&gt;&lt;/label&gt;&lt;br /&gt;\n                &lt;label&gt;@Model.Foo&lt;/label&gt;\n            &lt;/div&gt;\n\n            &lt;div class=\"form-group col-sm-3\"&gt;\n                &lt;label asp-for=\"Bar\"&gt;&lt;/label&gt;&lt;br /&gt;\n                &lt;label&gt;@Model.Bar&lt;/label&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>Within site.css I have tried both of the following</p>\n\n<pre><code>label.bluetext{\n    color: #3064b8; \n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>.bluetext{\n    color: #3064b8; \n}\n</code></pre>\n\n<p>while applying the style like so</p>\n\n<p><code>&lt;label class=\"bluetext\"&gt;@Model.Foo&lt;/label&gt;</code></p>\n\n<p>but I can't seem to get this to work with Razor tag helpers.</p>\n"}, {"tags": ["c#", "generics", "reflection"], "comments": [{"owner": {"reputation": 853, "user_id": 160419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979ee669cf5b9536d64d14f4577cf5b1?s=128&d=identicon&r=PG", "display_name": "dezfowler", "link": "https://stackoverflow.com/users/160419/dezfowler"}, "edited": false, "score": 0, "creation_date": 1562797387, "post_id": 56979213, "comment_id": 100494589, "body": "What&#39;s the reason for the use of generics, here?"}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 853, "user_id": 160419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979ee669cf5b9536d64d14f4577cf5b1?s=128&d=identicon&r=PG", "display_name": "dezfowler", "link": "https://stackoverflow.com/users/160419/dezfowler"}, "edited": false, "score": 0, "creation_date": 1562798035, "post_id": 56979213, "comment_id": 100494768, "body": "@dez I have a specific use case for them. I&#39;m not having any problem dealing with the generics and making the functional. I just don&#39;t like the messy syntax and am looking for a way to make it cleaner."}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1562799037, "post_id": 56979213, "comment_id": 100495009, "body": "It seems like in order to write this code you would have to already know that the method exists. Reflection is for discovering members at runtime. If you already know that there&#39;s an <code>UpdateData</code> method to discover, why use reflection to call it? I&#39;m not saying there&#39;s not a reason, just that it&#39;s not apparent from the question."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1562799232, "post_id": 56979213, "comment_id": 100495055, "body": "@ScottHannen yeah I wrote the <code>UpdateData</code> method. The reason I have to use reflections here is because the <code>dataType</code> is a <code>Type</code> instance that is dynamically chosen. It&#39;s not always the same, and C# doesn&#39;t seem to have support for generics from a <code>Type</code> instance without using reflection. So now I&#39;m trying to clean it up some so it&#39;s not such a chunky call by using a helper of some sort."}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1562799558, "post_id": 56979213, "comment_id": 100495120, "body": "Are you looking for this:  <code>public static class UpdateServiceExtensions     {         public static void UpdateData(this UpdateService updateService,              Type dataType,              Something editData,              Something metaData)         {             typeof(UpdateService).GetMethod(&quot;UpdateData&quot;)                 .MakeGenericMethod(dataType)                 .Invoke(updateService, new object[] { editData, metaData });         }     }</code>"}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1562799738, "post_id": 56979213, "comment_id": 100495149, "body": "@ScottHannen That works for this specific instance, but I was hoping there was some better way to get some more generic syntax that worked similar to the &lt;&gt; accessors. Using the above, I&#39;d need to write a new helper method for every call that involved a call to a method using a dynamic Type."}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1562800281, "post_id": 56979213, "comment_id": 100495289, "body": "I understand the problem somewhat now. Sometimes we have to write non-generic code that deals with <code>Type</code>, and connecting that back to generic code can be messy. Sometimes if I have to go non-generic part of the way I go non-generic all the way. How pervasive is the problem? Can you modify the target class? You could move the body of the methods into non-generic overloads with a <code>Type</code> argument, and then the generic overloads call the non-generic overloads using <code>typeof(T)</code>."}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1562801251, "post_id": 56979213, "comment_id": 100495459, "body": "A generic type parameter is a compile-time parameter. That is the whole point. It is not there to make your code look nicer. If the type is not known until run-time, you should not (and cannot) pass it as a compile-time."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1562801721, "post_id": 56979213, "comment_id": 100495540, "body": "@JohnWu Thats not entirely true though because you can call a generic with reflection using a Type instance which is determined at runtime, so it is possible. The compiler just doesn&#39;t have a proper way of dealing with that that I can find without some messy trash dot chaining and no proper way to pass the response as it now technically doesn&#39;t have a type."}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1562805285, "post_id": 56979213, "comment_id": 100496201, "body": "Perhaps I wasn\u2019t clear. You are passing run time parameters (enclosed in parentheses) and not generic type parameters (enclosed in angle brackets) in order to invoke a generic method via Reflection. The reason it isn\u2019t \u201cproper\u201d is because it is a workaround."}, {"owner": {"reputation": 853, "user_id": 160419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979ee669cf5b9536d64d14f4577cf5b1?s=128&d=identicon&r=PG", "display_name": "dezfowler", "link": "https://stackoverflow.com/users/160419/dezfowler"}, "edited": false, "score": 0, "creation_date": 1562831125, "post_id": 56979213, "comment_id": 100503223, "body": "How does <code>T</code> relate to <code>User</code>? Is <code>User</code> a base class and <code>T</code> is the actual type of <code>user</code> that you expect? I&#39;m guessing that what you&#39;re trying to do here is have some type specific logic which applies the JSON patch in the right way to each derived  <code>User</code> type, is that correct? Have you considered using a strategy pattern instead? Since you clearly have closed generic methods for a number of types you could also have a method which takes <code>dtoType</code> and returns one of those functions e.g. as a <code>Func&lt;User, JsonPatchDocument, Task&lt;User&gt;&gt;</code>. You could then just call that function."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 853, "user_id": 160419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979ee669cf5b9536d64d14f4577cf5b1?s=128&d=identicon&r=PG", "display_name": "dezfowler", "link": "https://stackoverflow.com/users/160419/dezfowler"}, "edited": false, "score": 0, "creation_date": 1562854188, "post_id": 56979213, "comment_id": 100516866, "body": "@dez T is a dto. From what I&#39;ve seen the dtos don&#39;t tend to have an inheritance structure to them, as they are standalone data containers that the mapper maps between. If I made User a base class, the other dtos would then have ALL of the properties of a User, should the dtos inherit from it, and I wouldn&#39;t be able to limit the input. Essentially, User is the EF Entity Model with all properties. Something like a UserAdminInput has just the fields that admins can edit, sanitizing the params.So a UserAdminInput would be the dynamically found dtoType. Hope that clears up the use case."}, {"owner": {"reputation": 853, "user_id": 160419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979ee669cf5b9536d64d14f4577cf5b1?s=128&d=identicon&r=PG", "display_name": "dezfowler", "link": "https://stackoverflow.com/users/160419/dezfowler"}, "edited": false, "score": 0, "creation_date": 1562866063, "post_id": 56979213, "comment_id": 100523204, "body": "Ah, I see, you&#39;re encoding field access permissions as different types. As you&#39;re using JSON Patch one option might be to instead encode the field access permissions as a list of paths the user is allowed to modify and then you pick the appropriate list of paths and strip any Operation instances from the JsonPatchDocument that don&#39;t match one of those paths."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 853, "user_id": 160419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979ee669cf5b9536d64d14f4577cf5b1?s=128&d=identicon&r=PG", "display_name": "dezfowler", "link": "https://stackoverflow.com/users/160419/dezfowler"}, "edited": false, "score": 0, "creation_date": 1562870098, "post_id": 56979213, "comment_id": 100524963, "body": "@dez Well, I&#39;m actually using this for all controller methods, not just patch. For creating a user, it pulls the role and then would use, say for an admin, the UserAdminInput DTO to sanitize out unwanted parameters. I did get it working, but I ended up mapping to the dynamic with the returned DTO type, then mapping back to the model type and passing that to the service. Should sanitize out everything as I need, I think. Haven&#39;t had a chance to test yet, but open to better ideas."}, {"owner": {"reputation": 853, "user_id": 160419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979ee669cf5b9536d64d14f4577cf5b1?s=128&d=identicon&r=PG", "display_name": "dezfowler", "link": "https://stackoverflow.com/users/160419/dezfowler"}, "edited": false, "score": 0, "creation_date": 1562933627, "post_id": 56979213, "comment_id": 100546154, "body": "You could still use a patch for a create. Just implement it as a patch of an empty object. Storing the access rules as data rather than a type also has the advantage that, in the future, you can change the rules without needing to recompile your application."}], "answers": [{"comments": [{"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1562801636, "post_id": 56979772, "comment_id": 100495525, "body": "This gets me back to the same spot trying to call UpdateData&lt;T&gt; because T is dynamic. I have code that fetches a Type instance based on a few factors and returns that, which I&#39;m then using to call a generic function. I have to call the function as a generic because a parameter requires a generic passed in as well, and I can&#39;t use a Type instance for that. I&#39;ll update with a more specific example. See OP."}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "reply_to_user": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1562802500, "post_id": 56979772, "comment_id": 100495655, "body": "Now that you&#39;ve added more code to the OP, I feel your pain. Once we have a <code>Type</code> instead of a generic argument, bridging that back to use generic code is messy. The reflection could be inevitable. While my answer might help in some cases, in your case I don&#39;t see any way around writing an extension that uses reflection."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1562802825, "post_id": 56979772, "comment_id": 100495710, "body": "I&#39;ve ended up needing to pass around things as dynamic and use duck typing too, since casting is a compile time thing. :/ My main issue here is that I&#39;m using dynamically chosen DTOs based on user role which fall through to a base DTO if no class exists for that user role. I&#39;m using it for sanitizing params (like an admin can edit all params on a user, but a user should only be able to edit their name). Rails and Elixir (not compiled of course) have sanitization of the json before it even gets parsed and mapped, but I see nothing like that for .NET Core, so I&#39;m building my own I guess."}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "edited": false, "score": 0, "creation_date": 1562961252, "post_id": 56979772, "comment_id": 100558733, "body": "I&#39;m accepting this as the answer to this particular question as it&#39;s likely the more typical route. In my case, I simply mapped to the DTO dynamically chosen to sanitize, then mapped back to the model EF entity and passed it to the service. This will work for everything accept for a PUT, where you&#39;ll need to pass the dynamic DTO, which I haven&#39;t found a better way than the OP to do or to just let your service accept a dynamic and duck type it."}], "tags": [], "owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "is_accepted": true, "score": 1, "last_activity_date": 1562801713, "last_edit_date": 1562801713, "creation_date": 1562800802, "answer_id": 56979772, "question_id": 56979213, "link": "https://stackoverflow.com/questions/56979213/helper-method-for-calling-generic-methods-with-reflection/56979772#56979772", "title": "Helper method for calling generic methods with reflection", "body": "<p>This answer does not use reflection, but <em>may</em> make your code easier to work with in <em>some</em> circumstances.</p>\n\n<p>We could have a class like this:</p>\n\n<pre><code>public class MyService\n{\n    public void UpdateData&lt;T&gt;(Something data, Something otherData)\n    {\n        // do stuff\n    }\n}\n</code></pre>\n\n<p>Later we find that we have to call it using a <code>Type</code> variable instead of a generic argument, which could mean using reflection. Sometimes it's easier to add a non-generic overload to the original class, and call it from the generic method:</p>\n\n<pre><code>public class MyService\n{\n    public void UpdateData(Type dataType, Something data, Something otherData)\n    {\n        // do stuff\n    }\n\n    public void UpdateData&lt;T&gt;(Something data, Something otherData)\n    {\n        UpdateData(typeof(T), data, otherData);\n    }\n}\n</code></pre>\n\n<p>We lose the ability to easily impose constraints on the <code>Type</code> argument like we could with the generic method. We can add validation if we need it.</p>\n\n<p>That gets you as close as possible to the code you're trying to write:</p>\n\n<pre><code>_myService.UpdateData(dataType, editData, metaData);\n</code></pre>\n\n<p>That's assuming that you find yourself still needing the generic methods at all. If you add non-generic overloads and discover that you're not calling the generic ones anymore, you can just delete them. </p>\n\n<p>A significant benefit of this over reflection is that you can identify where your code is called. A method that's only called using reflection will appear unused.</p>\n"}], "owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 56979772, "answer_count": 1, "score": -2, "last_activity_date": 1562802077, "creation_date": 1562796135, "last_edit_date": 1562802077, "question_id": 56979213, "link": "https://stackoverflow.com/questions/56979213/helper-method-for-calling-generic-methods-with-reflection", "title": "Helper method for calling generic methods with reflection", "body": "<p>Does anyone have a better way to do the following:</p>\n\n<pre><code>typeof(Service).GetMethod(\"UpdateData\")\n    .MakeGenericMethod(dataType)\n    .Invoke(_myService, new object[]{ editData, metaData });\n</code></pre>\n\n<p>I'd love to do something like:</p>\n\n<pre><code>_myService.UpdateData&lt;dataType&gt;(editData, metaData);\n</code></pre>\n\n<p>But the &lt;> accessor for generics will not take Type objects. I'm looking for a helper, utility, accessor, or something to make those generic method calls with reflection less cumbersome or at least centralized.</p>\n\n<p>More Specific Example</p>\n\n<pre><code>public class UserService : IUserService\n{\n  async Task&lt;User&gt; UpdateUser&lt;T&gt;(User user, JsonPatchDocument&lt;T&gt; patch){ //do code }\n}\n\nType dtoType = MagicService.getDynamicDtoType();\nType patchType = typeof(JsonPatchDocument&lt;&gt;).MakeGenericType(dtoType);\ndynamic patchDoc = _mapper.Map(patch, typeof(JsonPatchDocument&lt;User&gt;), patchType);\nUser updateUser = await (Task&lt;User&gt;)typeof(UserService).GetMethod(\"UpdateUser\").MakeGenericMethod(dtoType).Invoke(_userService, new object[]{user, patchDoc})\n</code></pre>\n\n<p>This actually ends up with two issues. One, the <code>dynamic patchDoc</code> isn't the right type to be used in <code>UpdateUser</code>, which I have a separate question in Stackoverflow about (but you can use duck typing here), and the messy calling of that generic method call with reflection. I'm trying to solve both, but for this question I want to clean up the call. If you have ideas on the other piece, which is really a separate issue:\n<a href=\"https://stackoverflow.com/questions/56979601/declaring-a-type-in-c-sharp-with-a-type-instance?noredirect=1#comment100495202_56979601\">Declaring a type in C# with a Type instance</a></p>\n"}, {"tags": ["c#", "generics", "methods", "delegates"], "comments": [{"owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "edited": false, "score": 0, "creation_date": 1562796095, "post_id": 56979143, "comment_id": 100494270, "body": "You&#39;re going to need to have overloads for both <code>Action</code> and <code>Func</code>, but you could implement a <code>Unit</code> type to be returned by the wrapper for <code>Action</code>s."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1562796890, "post_id": 56979143, "comment_id": 100494471, "body": "Any solution you come up with is going to be <i>radically</i> more complex, and perform <i>radically</i> worse, than what you have here.  Trying to generalize this is in no way going to simplify this.  Just support the two different delegates."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1562799646, "post_id": 56979143, "comment_id": 100495137, "body": "<i>&quot;I&#39;m trying to make a method that accepts another method, and returns the value that the inner method returns, <b>if that inner method isn&#39;t void</b>&quot;</i> -- I don&#39;t even know what that means. That is, if the inner method has a return type of <code>void</code>, then you <i>don&#39;t</i> want your method that returns a value? C# doesn&#39;t work that way. Methods always either return a value or they don&#39;t...you can&#39;t make them conditionally return a value depending on the arguments."}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1562800723, "post_id": 56979143, "comment_id": 100495373, "body": "You&#39;ve only got half your requirements here. For them to be complete, you&#39;ll have to specify what you expect your wrapper method to do if the inner method does indeed return <code>void</code>."}, {"owner": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1562805329, "post_id": 56979143, "comment_id": 100496207, "body": "You all raise good points.  I was struggling for close to an hour trying to figure out how to ask the right question, but @PeterDuniho&#39;s answer captured the gist of the problem."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "edited": false, "score": 0, "creation_date": 1562804828, "post_id": 56979696, "comment_id": 100496113, "body": "Thanks for your answer.  It seems odd to me that C# has to handle void methods separately from others, but this seems elegant enough."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "reply_to_user": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "edited": false, "score": 0, "creation_date": 1562805085, "post_id": 56979696, "comment_id": 100496174, "body": "For better or worse, C# follows the conventions set by C and similar languages, all of which treat a method with a return type different from one without. I suppose the C# designers could have deviated from that norm, which I suspect is based on the underlying architecture (for the x86-based processors, there&#39;s a distinction between returning a value or not), but that could&#39;ve caused more consternation from programmers trying to move from other languages. Indeed, I&#39;m not aware of any mainstream, statically-typed language that doesn&#39;t carry this distinction."}, {"owner": {"reputation": 14634, "user_id": 64348, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/h3b3u.png?s=128&g=1", "display_name": "Kit", "link": "https://stackoverflow.com/users/64348/kit"}, "edited": false, "score": 0, "creation_date": 1562810499, "post_id": 56979696, "comment_id": 100497076, "body": "@PeterDuniho Interestingly, there are a few actual uses. See <a href=\"https://stackoverflow.com/questions/5450748/what-is-system-void\">stackoverflow.com/questions/5450748/what-is-system-void</a>. I confess to never needing them though!"}], "tags": [], "owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "is_accepted": true, "score": 0, "last_activity_date": 1562805396, "last_edit_date": 1562805396, "creation_date": 1562800201, "answer_id": 56979696, "question_id": 56979143, "link": "https://stackoverflow.com/questions/56979143/how-do-i-make-a-generic-wrapper-method-that-returns-the-wrapped-methods-result/56979696#56979696", "title": "How do I make a generic wrapper method that returns the wrapped method&#39;s result, if it has one?", "body": "<p>As noted above, I don't entirely understand the wording of your question. However, the basic scenario seems plain: you want to generically decorate the behavior of unknown methods, handling both methods that return values and those which don't.</p>\n\n<p>Whenever I run into that type of scenario, I address it by writing one wrapper method that has return type <code>void</code>, and then adapting via a lambda a second wrapper method. For example:</p>\n\n<pre><code>T Wrapper&lt;T&gt;(Func&lt;T&gt; func)\n{\n    T result = default(T);\n    Wrapper(() =&gt; { result = func(); });\n    return result;\n}\n\nvoid Wrapper(Action action)\n{\n    Console.WriteLine(\"Wrap start\");\n    action();\n    Console.WriteLine(\"Wrap end\");\n}\n</code></pre>\n\n<p>This way I only have to write the wrapper logic once. There's some overhead with the <code>Func&lt;T&gt;</code> version having to create a new delegate instance and capture a local variable, but at least when I've had to do this sort of thing, the wrapper logic and wrapped logic is complex enough that the overhead of the lambda is inconsequential.</p>\n"}, {"comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1562808752, "post_id": 56980497, "comment_id": 100496783, "body": "It would help if you would explain in your answer why you see this as a preferable approach vs other similar alternatives, e.g. defining <code>void Wrapper(Action action) =&gt; Wrapper(() =&gt; { action(); return (object)null; });</code>. Also, I&#39;ll note that type inference should take care your call to <code>Wrapper&lt;Unit&gt;()</code>: <code>return Wrapper(() =&gt; { action(); return Unit.Default; });</code>"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1562810998, "post_id": 56980497, "comment_id": 100497154, "body": "I like the improvement, but I&#39;d still like to know how you see writing a whole new type as somehow better than just using <code>object</code> to call the <code>Func&lt;T&gt;</code> version of the wrapper."}, {"owner": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "edited": false, "score": 0, "creation_date": 1562815297, "post_id": 56980497, "comment_id": 100497916, "body": "I for one think it&#39;s fascinating.  Before this I had never heard of unit types, but I&#39;m interested in trying it out.  Can the same unit type be used anywhere (as in, I don&#39;t need to tweak it for my own implementations)?"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "reply_to_user": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "edited": false, "score": 0, "creation_date": 1562824751, "post_id": 56980497, "comment_id": 100500261, "body": "@TheGreatB3 - Yes, you can use it anywhere. It&#39;s just a value-type that can only ever be a single value. All voids just the same."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1562824806, "post_id": 56980497, "comment_id": 100500285, "body": "@PeterDuniho - Let me think about how best to express it. it&#39;s really just using the concept from functional programming, but that&#39;s a bit of a trite answer. I&#39;ll come back with something."}], "tags": [], "owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "is_accepted": false, "score": 0, "last_activity_date": 1562810888, "last_edit_date": 1562810888, "creation_date": 1562808197, "answer_id": 56980497, "question_id": 56979143, "link": "https://stackoverflow.com/questions/56979143/how-do-i-make-a-generic-wrapper-method-that-returns-the-wrapped-methods-result/56980497#56980497", "title": "How do I make a generic wrapper method that returns the wrapped method&#39;s result, if it has one?", "body": "<p>I would try to take away the fundamental language difference of a <code>void</code> returning method by actually giving the method something to return.</p>\n\n<p>By implementing a <code>Unit</code> type, that is just a single value <code>struct</code>, then you can transform <code>Action</code> into <code>Func&lt;Unit&gt;</code>. This is effectively just using the adapter pattern.</p>\n\n<p>Now you're just dealing with one kind of delegate in the form of <code>Func&lt;T&gt;</code>. You can then put all of the hard work into that single <code>Wrapper</code> method.</p>\n\n<p>Try this:</p>\n\n<pre><code>void Main()\n{\n    var result = Wrapper(DoSomething);\n}\n\nprivate void DoSomething()\n{\n    Console.WriteLine(\"Test.\");\n}\n\nT Wrapper&lt;T&gt;(Func&lt;T&gt; func)\n{\n    Console.WriteLine(\"Wrap start\");\n    var result = func();\n    Console.WriteLine(\"Wrap end\");\n    return result;\n}\n\nUnit Wrapper(Action action)\n{\n    return Wrapper(() =&gt; { action(); return Unit.Default; });\n}\n\n/// &lt;summary&gt;\n/// Represents a type with a single value. This type is often used to denote the successful completion of a void-returning method (C#) or a Sub procedure (Visual Basic).\n/// &lt;/summary&gt;\n[Serializable]\n[StructLayout(LayoutKind.Sequential, Size = 1)]\npublic struct Unit : IEquatable&lt;Unit&gt;\n{\n    public static Unit Default =&gt; default(Unit);\n    public bool Equals(Unit other) =&gt; true;\n    public override bool Equals(object obj) =&gt; obj is Unit;\n    public override int GetHashCode() =&gt; 0;\n    public override string ToString() =&gt; \"()\";\n    public static bool operator ==(Unit first, Unit second) =&gt; true;\n    public static bool operator !=(Unit first, Unit second) =&gt; false;\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10145075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a6d5023c391fb1f933adac6395e6462?s=128&d=identicon&r=PG", "display_name": "TheGreatB3", "link": "https://stackoverflow.com/users/10145075/thegreatb3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 56979696, "answer_count": 2, "score": 1, "last_activity_date": 1562810888, "creation_date": 1562795644, "question_id": 56979143, "link": "https://stackoverflow.com/questions/56979143/how-do-i-make-a-generic-wrapper-method-that-returns-the-wrapped-methods-result", "title": "How do I make a generic wrapper method that returns the wrapped method&#39;s result, if it has one?", "body": "<p>I'm trying to make a method that accepts another method, and returns the value that the inner method returns, if that inner method isn't void.  I'd like to do it without differentiating between <code>Func&lt;&gt;</code> and <code>Action&lt;&gt;</code>.</p>\n\n<p>Essentially, I want the wrapped method to behave the exact same way as the unwrapped method, plus some functionality provided by the wrapper.  The goal is simple enough, but it's hard to wrap my head around the implementation.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public int ReturnsInteger() {\n    Console.WriteLine(\"I return 42\");\n    return 42;\n}\n\npublic static T WrapperMethod(Func&lt;T&gt; someMethod) {\n    Console.WriteLine(\"Wrap start\");\n    var result = someMethod();\n    Console.WriteLine(\"Wrap end\");\n    return result;\n}\n\nprivate static void Main() {\n    var X = WrapperMethod(()=&gt;ReturnsInt());\n    Console.WriteLine(\"X = \" + X);\n    // Wrap start\n    // I return 42\n    // Wrap end\n    // X = 42\n}\n</code></pre>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public void ReturnsNothing() {\n    Console.WriteLine(\"I return nothing\");\n    return;\n}\n\npublic static T WrapperMethod(Action someMethod) {\n    Console.WriteLine(\"Wrap start\");\n    someMethod();\n    Console.WriteLine(\"Wrap end\");\n}\n\nprivate static void Main() {\n    WrapperMethod(()=&gt;ReturnsNothing());\n    // Wrap start\n    // I return nothing\n    // Wrap end\n}\n</code></pre>\n"}, {"tags": ["c#", "winforms", "flowlayoutpanel"], "comments": [{"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 1, "creation_date": 1562796651, "post_id": 56979131, "comment_id": 100494429, "body": "Have you actually set the Panels: <code>[Panel].Padding = new Padding(0), [Panel].Margin = new Padding(0)</code> when one is created? The same for the FLP? Can you show the code that builds the FLP and the Panels?"}, {"owner": {"reputation": 1, "user_id": 11767216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NgnpON7MHJc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyu5YUC1GM086Bkr61yk1EcM0Zqg/photo.jpg?sz=128", "display_name": "asd asd", "link": "https://stackoverflow.com/users/11767216/asd-asd"}, "reply_to_user": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562797367, "post_id": 56979131, "comment_id": 100494583, "body": "Yes all paddings and margins are set to 0 but this didn&#39;t fix the problem. However I decided to try and implement it without flowlayoutpanel as I saw that is some kind of bug related to the flowlayoutpanel&#39;s spacing of controls. I managed to do it with timer which synchronises the position of the panels with each other and so I will call it a day :) thanks for the suggestion though."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562797713, "post_id": 56979131, "comment_id": 100494684, "body": "The FLP has no such <i>bug</i>."}, {"owner": {"reputation": 1, "user_id": 11767216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NgnpON7MHJc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyu5YUC1GM086Bkr61yk1EcM0Zqg/photo.jpg?sz=128", "display_name": "asd asd", "link": "https://stackoverflow.com/users/11767216/asd-asd"}, "reply_to_user": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562797886, "post_id": 56979131, "comment_id": 100494731, "body": "I think it has I saw this thread: <a href=\"https://stackoverflow.com/questions/23448229/strange-empty-spaces-in-flowlayoutpanel\" title=\"strange empty spaces in flowlayoutpanel\">stackoverflow.com/questions/23448229/&hellip;</a>  and tried to do it with mine program but it either I didn&#39;t manage to implement it right for my case (most likely :) ) or else happend wrong, sorry for the bad formatting I&#39;m new to the site."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562798836, "post_id": 56979131, "comment_id": 100494962, "body": "It&#39;s a feature, more or less the same applies to the TableLayoutPanel (related to the row styles). See the notes and try the code here: <a href=\"https://stackoverflow.com/a/54565075/7444103\">Center multiple rows of controls in a FlowLayoutPanel</a>, setting both the FLP containers&#39; Padding/Margin and the child controls&#39;  to <code>0</code>. See what happens. (Spoiler alert: all controls will be positioned without any visible space between them)."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562799538, "post_id": 56979131, "comment_id": 100495118, "body": "<a href=\"https://stackoverflow.com/a/55225457/7444103\">Here</a> there&#39;s (more or less) the same code, but there&#39;s also a complete Form layout for testing it."}, {"owner": {"reputation": 1, "user_id": 11767216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NgnpON7MHJc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyu5YUC1GM086Bkr61yk1EcM0Zqg/photo.jpg?sz=128", "display_name": "asd asd", "link": "https://stackoverflow.com/users/11767216/asd-asd"}, "reply_to_user": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562800557, "post_id": 56979131, "comment_id": 100495353, "body": "I put all the child panels, buttons, labels and the FLP&#39;s padding and margins to zero when I uploaded the picture (the first one) and the problem was still present I tried many different things using FLP like manipulating the margins in a lot of different ways but alas nothing helped to get rid off that space between the categories. However I actually prefer the solution I made with the timer as it simplifies the things a lot. Thanks for the spared time"}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562801350, "post_id": 56979131, "comment_id": 100495476, "body": "No problem. If you&#39;re happy with it, then it&#39;s good."}], "owner": {"reputation": 1, "user_id": 11767216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NgnpON7MHJc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyu5YUC1GM086Bkr61yk1EcM0Zqg/photo.jpg?sz=128", "display_name": "asd asd", "link": "https://stackoverflow.com/users/11767216/asd-asd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562797503, "creation_date": 1562795588, "last_edit_date": 1562797503, "question_id": 56979131, "link": "https://stackoverflow.com/questions/56979131/flowlayoutpanel-creates-blank-space-between-controls-even-though-margin-and-padd", "title": "Flowlayoutpanel creates blank space between controls even though margin and paddings are set to 0", "body": "<p><a href=\"https://i.stack.imgur.com/KnpdP.png\" rel=\"nofollow noreferrer\">Image where the blank space is visible. The red is the background color of the flowlayoutpanel where all other panels which are inside it are gray.</a></p>\n\n<p>From the image could be seen how the flowlayoutpanel leaves blank space between the categories in my menu even though the margins of all panels are set to 0 including the flowlayoutpanel also all labels and buttons margins are set to 0</p>\n\n<p>Managed to fix my problem by implementing it without flowlayoutpanel by using timers :)</p>\n\n<p><a href=\"https://i.stack.imgur.com/qiqgK.png\" rel=\"nofollow noreferrer\">Fixed</a></p>\n\n<p>I'll leave the question open if somebody knows how to fix the flowlayoutpanel situation</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-core", "asp.net-core-mvc", "token"], "comments": [{"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562795722, "post_id": 56979104, "comment_id": 100494174, "body": "if you only want one token to use on behalf of all users of the website, you could grab the token and write it to a text file in your project, then read it back from the text file. And if you need to refresh the token, you can store a datetime in the text file of when the token was created so that you can check for a necessary refresh. Or you could store it in a database with a timestamp, or you could create a token for each user and store it in session on the webserver. There are many options available."}, {"owner": {"reputation": 7052, "user_id": 2084315, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/650350a4564c8b0eaeddbe972a48f076?s=128&d=identicon&r=PG&f=1", "display_name": "ps2goat", "link": "https://stackoverflow.com/users/2084315/ps2goat"}, "edited": false, "score": 0, "creation_date": 1562796176, "post_id": 56979104, "comment_id": 100494302, "body": "If using dependency injection, you can have a service that provides these values. Register it as a singleton and it will live for the life of the app and be able to take care of the refresh details on its own. However, this would occur once per app instance, so do you need a way to share this between instances? That would require a more complicated setup"}, {"owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562796253, "post_id": 56979104, "comment_id": 100494324, "body": "@RyanWilson It will not be a single token every time server issues a new token when you send a refresh request. I need a global variable which can be rewritable after every 20 min with a refreshed token."}, {"owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "reply_to_user": {"reputation": 7052, "user_id": 2084315, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/650350a4564c8b0eaeddbe972a48f076?s=128&d=identicon&r=PG&f=1", "display_name": "ps2goat", "link": "https://stackoverflow.com/users/2084315/ps2goat"}, "edited": false, "score": 0, "creation_date": 1562796489, "post_id": 56979104, "comment_id": 100494387, "body": "@ps2goat I really don&#39;t need to share this between instances. There will be one token and it will be refresh periodically. Multiple users can view this dashboard but I don&#39;t think each user will need its own token."}, {"owner": {"reputation": 841, "user_id": 2250803, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/40a938f48ab301a83fd05b59cbab05cd?s=128&d=identicon&r=PG", "display_name": "Tyddlywink", "link": "https://stackoverflow.com/users/2250803/tyddlywink"}, "edited": false, "score": 0, "creation_date": 1562803042, "post_id": 56979104, "comment_id": 100495752, "body": "Have you looked into memory caching?  <a href=\"https://docs.microsoft.com/en-us/aspnet/core/performance/caching/memory?view=aspnetcore-2.2\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/aspnet/core/performance/caching/&hellip;</a>"}, {"owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "reply_to_user": {"reputation": 841, "user_id": 2250803, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/40a938f48ab301a83fd05b59cbab05cd?s=128&d=identicon&r=PG", "display_name": "Tyddlywink", "link": "https://stackoverflow.com/users/2250803/tyddlywink"}, "edited": false, "score": 0, "creation_date": 1562808067, "post_id": 56979104, "comment_id": 100496659, "body": "@Tyddlywink seems promising I will try this tomorrow :)"}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562846519, "post_id": 56979104, "comment_id": 100511965, "body": "@JKLM I gave you options on how to store it &quot;globally&quot;. You can keep it in a database with a timestamp so you can know when to refresh, I think that would be my first option. As I said another would be to write the token with it&#39;s creation datetime into a text file which is accessible by the web app."}, {"owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562849565, "post_id": 56979104, "comment_id": 100513913, "body": "@RyanWilson I guess storing a token in the database is not really required in this case. Just the global variable which holds this token and after 20 min I can run scheduler which will run <code>refresh_token</code> request which will replace the variable with a refreshed token is sufficient."}], "owner": {"reputation": 1370, "user_id": 4682302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/4187c619fda650f970566c5f47f3fe75?s=128&d=identicon&r=PG&f=1", "display_name": "JKLM", "link": "https://stackoverflow.com/users/4682302/jklm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1603330385, "creation_date": 1562795407, "question_id": 56979104, "link": "https://stackoverflow.com/questions/56979104/how-do-i-store-and-access-token-globally-from-web-api", "title": "How do I store and access token globally from Web API?", "body": "<p>I'm working on a dashboard web application that uses the <code>grant_type=client_credentials</code> to get Bearer Tokens to gain access to its resources.</p>\n\n<p>The plan is to have the MVC controllers make calls to the API on behalf of the client browser.</p>\n\n<p>The ajax requests from the browser will hit the MVC controllers and then the API calls are made. Results are then fed back to the client as JSON and handles in react.</p>\n\n<p>The client should never communicate directly with the API and doesn't need to login to see the dashboard. </p>\n\n<p>When applications loads for the first time it requests server for a token using client credentials stored in <code>appsettings.json</code>. I'm able to get the token but I don't know where to store and access it globally. I need global access to this token so that after 20 min or so I can send <code>refresh_token</code> request to the server and use it in all subsequent calls to the API to get data.</p>\n\n<p>Can I store it in <code>HttpContext</code> and use it from there?</p>\n\n<p>Currently I'm requesting token as follows:</p>\n\n<pre><code>public class TokensController : ControllerBase\n    {\n        public IConfiguration Configuration { get; }\n\n        public TokensController(IConfiguration configuration)\n        {\n            Configuration = configuration;\n        }\n\n        // Get Token\n        public static async Task&lt;Token&gt; GetToken(Uri authenticationUrl, Dictionary&lt;string, string&gt; authenticationCredentials)\n        {\n            HttpClient client = new HttpClient();\n            FormUrlEncodedContent content = new FormUrlEncodedContent(authenticationCredentials);\n            HttpResponseMessage response = await client.PostAsync(authenticationUrl, content);\n\n            if (response.StatusCode != System.Net.HttpStatusCode.OK)\n            {\n                string message = String.Format(\"POST failed. Received HTTP {0}\", response.StatusCode);\n                throw new ApplicationException(message);\n            }\n\n            string responseString = await response.Content.ReadAsStringAsync();\n            Token token = JsonConvert.DeserializeObject&lt;Token&gt;(responseString);\n\n            return token;\n        }\n\n        public IActionResult GetAccessToken()\n        {\n\n            Dictionary&lt;string, string&gt; authenticationCredentials_np = Configuration.GetSection(\"SomeEnvironment:Credentials\").GetChildren().Select(x =&gt; new KeyValuePair&lt;string, string&gt;(x.Key, x.Value)).ToDictionary(x =&gt; x.Key, x =&gt; x.Value);\n            Token token_np = GetToken(new Uri(Configuration[\"SomeEnvironment:URL\"]), authenticationCredentials_np).Result;\n\n            return Ok(token_np);\n        }\n\n    }\n</code></pre>\n\n<p>Any suggestions/thoughts?</p>\n"}, {"tags": ["c#", "azure", "botframework", "direct-line-botframework"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 10723728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1Sr6.jpg?s=128&g=1", "display_name": "Endreo", "link": "https://stackoverflow.com/users/10723728/endreo"}, "is_accepted": true, "score": 0, "last_activity_date": 1563981165, "creation_date": 1563981165, "answer_id": 57186152, "question_id": 56979046, "link": "https://stackoverflow.com/questions/56979046/integrating-direct-line-speech-into-microsoft-virtual-assistant/57186152#57186152", "title": "Integrating direct line speech into Microsoft Virtual Assistant?", "body": "<p>For anyone else who might search this later, I found my primary issue is was that I was using a webchat implementation that isn't currently supported by the direct line speech preview.</p>\n\n<p>For integrating speech in webchat properly I was able to find a bunch of examples of web chat implementations from Microsoft <a href=\"https://github.com/microsoft/BotFramework-WebChat\" rel=\"nofollow noreferrer\">here</a>. Specifically, the two examples that I found most helpful was an implementation of speech <a href=\"https://github.com/microsoft/BotFramework-WebChat/tree/master/samples/06.d.speech-web-browser\" rel=\"nofollow noreferrer\">using a the built-in browser methods in this sample solution</a> and then <a href=\"https://github.com/microsoft/BotFramework-WebChat/tree/master/samples/06.c.cognitive-services-speech-services-js\" rel=\"nofollow noreferrer\">using Microsoft Cognitive Services in this solution</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 10723728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1Sr6.jpg?s=128&g=1", "display_name": "Endreo", "link": "https://stackoverflow.com/users/10723728/endreo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 57186152, "answer_count": 1, "score": 1, "last_activity_date": 1563981165, "creation_date": 1562795077, "question_id": 56979046, "link": "https://stackoverflow.com/questions/56979046/integrating-direct-line-speech-into-microsoft-virtual-assistant", "title": "Integrating direct line speech into Microsoft Virtual Assistant?", "body": "<p>I've been doing a POC for Microsoft Virtual Assistant using their template as a base in c# (found here: <a href=\"https://github.com/microsoft/botframework-solutions\" rel=\"nofollow noreferrer\">https://github.com/microsoft/botframework-solutions</a>). I've deployed my code to azure and added and deployed some skills and have been using the application in Bot Framework Emulator to test all successfully.</p>\n\n<p>Now, I want to add a scenario where the user can use the the Virtual Assistant hands-free, using voice. I've been reading that the Direct Line Speech is the way to go for this but have been having some double getting started. </p>\n\n<p>I've created a direct line speech channel in my azure webapp. Then I followed these guides:\n<a href=\"https://docs.microsoft.com/en-us/azure/bot-service/bot-service-channel-connect-directlinespeech?view=azure-bot-service-4.0\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/azure/bot-service/bot-service-channel-connect-directlinespeech?view=azure-bot-service-4.0</a>\n<a href=\"https://docs.microsoft.com/en-us/azure/bot-service/directline-speech-bot?view=azure-bot-service-4.0\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/azure/bot-service/directline-speech-bot?view=azure-bot-service-4.0</a></p>\n\n<p>I feel like some information is missing since the direct line speech secret isn't mentioned at all in the 'Use Direct Line Speech in your bot' guide.</p>\n\n<p>Anyone with any experience in this would be a major help, thank you very much.</p>\n"}, {"tags": ["c#", "android", "xamarin", "visual-studio-2017"], "answers": [{"comments": [{"owner": {"reputation": 1170, "user_id": 3149673, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XaiEV.jpg?s=128&g=1", "display_name": "Prescott Chartier", "link": "https://stackoverflow.com/users/3149673/prescott-chartier"}, "edited": false, "score": 0, "creation_date": 1562801617, "post_id": 56979586, "comment_id": 100495521, "body": "I converted your code from java to c# and added it to your answer.  This does work, even though I don&#39;t understand why this works in <code>OnResume</code> and not <code>OnStart</code>.  Sidenote:  I never saw any advantage to storing a value in an external file and then retreiving it for use later.  I guess I&#39;m a little old school.  Lol ..."}, {"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "reply_to_user": {"reputation": 1170, "user_id": 3149673, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XaiEV.jpg?s=128&g=1", "display_name": "Prescott Chartier", "link": "https://stackoverflow.com/users/3149673/prescott-chartier"}, "edited": false, "score": 0, "creation_date": 1562804845, "post_id": 56979586, "comment_id": 100496118, "body": "@PrescottChartier: I voted to reject your edit, but I do appreciate it. The author chose to provide a Java answer, rightly or wrongly, and it can stand on its own merits. In the meantime you can write your own answer and if you want credit Mehmed&#39;s answer."}, {"owner": {"reputation": 2530, "user_id": 876267, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0961701cb2a8116d88f10e04130b3e5b?s=128&d=identicon&r=PG", "display_name": "Mehmed", "link": "https://stackoverflow.com/users/876267/mehmed"}, "edited": false, "score": 0, "creation_date": 1562862574, "post_id": 56979586, "comment_id": 100521601, "body": "Sorry about providing solution in Java, but I know it can be ported to Xamarin. Besides it is a convention, I used dimensions file to provide sizes in dp and to get sizes in pixel using <code>getDimensionPixelSize()</code> to avoid manual calculation."}], "tags": [], "owner": {"reputation": 2530, "user_id": 876267, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0961701cb2a8116d88f10e04130b3e5b?s=128&d=identicon&r=PG", "display_name": "Mehmed", "link": "https://stackoverflow.com/users/876267/mehmed"}, "is_accepted": true, "score": 0, "last_activity_date": 1562799020, "creation_date": 1562799020, "answer_id": 56979586, "question_id": 56979006, "link": "https://stackoverflow.com/questions/56979006/dialog-fragment-width-and-height-ignored/56979586#56979586", "title": "Dialog Fragment width and height ignored", "body": "<p>It is better you define sizes in <code>dimens.xml</code> under <code>values</code> folder:</p>\n\n<pre><code>&lt;resources&gt;\n    ...\n    &lt;dimen name=\"dialog_min_width\"&gt;300dp&lt;/dimen&gt;\n    &lt;dimen name=\"dialog_min_height\"&gt;75dp&lt;/dimen&gt;\n    ...\n&lt;/resources&gt;\n</code></pre>\n\n<p>You can update <code>onResume()</code> method of your <code>DialogFragment</code> as follows and try:</p>\n\n<pre><code>public void onResume() {\n    int width = getResources().getDimensionPixelSize(R.dimen.dialog_min_width);\n    int height = getResources().getDimensionPixelSize(R.dimen.dialog_min_height);        \n    getDialog().getWindow().setLayout(width, height);\n    super.onResume();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1170, "user_id": 3149673, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XaiEV.jpg?s=128&g=1", "display_name": "Prescott Chartier", "link": "https://stackoverflow.com/users/3149673/prescott-chartier"}, "is_accepted": false, "score": 1, "last_activity_date": 1562808166, "creation_date": 1562808166, "answer_id": 56980494, "question_id": 56979006, "link": "https://stackoverflow.com/questions/56979006/dialog-fragment-width-and-height-ignored/56980494#56980494", "title": "Dialog Fragment width and height ignored", "body": "<p>The c# equivalent of Mehmed's code:</p>\n\n<pre><code>    public override void OnResume()\n    {\n        int width = 300; \n        int height = 75; \n        base.OnResume();\n    }\n</code></pre>\n\n<p>I have found that a lot of the code posted on Stack Overflow where Xamarin is concerned is java code, I use c# (Visual Studio 2017) and know absolutely nothing about java and find it difficult to convert to c#, frustratingly so.  When I see java code in an answer, I usually just skip right over it.  But seeing as how I asked the question and Mehmed was kind enough to provide a working solution, I felt compelled to post a c# conversion.  </p>\n\n<p>You'll note that I opted not to place the values in <code>dimens.xml</code>, I'm not a fan of storing values in an \"external to the code file\" and then retrieving them in code, tends to make debugging that much more difficult at times.  All that happens when you do that is the compiler replaces the line of code with the value in the generated obj file, sooooo .. why do that? </p>\n\n<p>Given that these values will never change, I saw no point in putting them in <code>dimens.xml</code>, by all means convince me otherwise!</p>\n"}], "owner": {"reputation": 1170, "user_id": 3149673, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XaiEV.jpg?s=128&g=1", "display_name": "Prescott Chartier", "link": "https://stackoverflow.com/users/3149673/prescott-chartier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 56979586, "answer_count": 2, "score": 0, "last_activity_date": 1562808166, "creation_date": 1562794738, "question_id": 56979006, "link": "https://stackoverflow.com/questions/56979006/dialog-fragment-width-and-height-ignored", "title": "Dialog Fragment width and height ignored", "body": "<p>How do I set the width and height of a dialog fragment?  Everything I've read says to override the OnStart method like this:</p>\n\n<pre><code>    public override void OnStart()\n    {\n        if (Dialog == null)\n        {\n            return;\n        }\n        int dialogWidth = 300;\n        int dialogHeight = 75;\n        Dialog.Window.SetLayout(dialogWidth, dialogHeight);\n    }\n</code></pre>\n\n<p>When I do this, the app crashes, I'm unable to trap the error as apparently it fails outside the code I'm writing.  Without this override the dialog appears and operates as expected.</p>\n\n<p>This is my layout:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"&gt;\n    android:minWidth=\"300dp\" \n    android:minHeight=\"75dp\"&gt;\n    &lt;TextView\n        android:text=\"Select section.\"\n        android:textAppearance=\"?android:attr/textAppearanceMedium\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"\n        android:textAlignment=\"center\" \n        android:textStyle=\"bold\"\n        android:id=\"@+id/textView2\" /&gt;\n    &lt;Spinner\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"\n        android:textAlignment=\"center\"\n        android:id=\"@+id/my_spinner\" /&gt;\n    &lt;Button\n        android:text=\"Ok\"\n        android:layout_width=\"200px\"\n        android:layout_gravity=\"center\"\n        android:layout_height=\"34.5dp\"\n        android:id=\"@+id/button_ok\" /&gt;\n&lt;/LinearLayout&gt;\n</code></pre>\n\n<p>Apparently the <code>android:minWidth</code> and <code>android:minHeight</code> settings are ignored as all I get is a tiny dialog.</p>\n"}, {"tags": ["c#", "generics"], "comments": [{"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1562794081, "post_id": 56978817, "comment_id": 100493701, "body": "If your method expects the type <code>K</code> to have <code>UserName</code> and <code>Password</code> properties, then there&#39;s little point in making this generic unless you can constrain <code>K</code> to an interface that has those properties."}], "answers": [{"comments": [{"owner": {"reputation": 22898, "user_id": 1915893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580b31b0be7173bbc477ca1d6967d87c?s=128&d=identicon&r=PG", "display_name": "Aluan Haddad", "link": "https://stackoverflow.com/users/1915893/aluan-haddad"}, "edited": false, "score": 0, "creation_date": 1562794249, "post_id": 56978876, "comment_id": 100493753, "body": "This is correct but you should elaborate the interface"}, {"owner": {"reputation": 76753, "user_id": 1026459, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/pv5mS.png?s=128&g=1", "display_name": "Travis J", "link": "https://stackoverflow.com/users/1026459/travis-j"}, "reply_to_user": {"reputation": 22898, "user_id": 1915893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580b31b0be7173bbc477ca1d6967d87c?s=128&d=identicon&r=PG", "display_name": "Aluan Haddad", "link": "https://stackoverflow.com/users/1915893/aluan-haddad"}, "edited": false, "score": 0, "creation_date": 1562794445, "post_id": 56978876, "comment_id": 100493811, "body": "@AluanHaddad - Based on the level of the question, I am assuming this user understands how to implement an interface. It will also vary greatly depending on their implementation environment."}, {"owner": {"reputation": 22898, "user_id": 1915893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580b31b0be7173bbc477ca1d6967d87c?s=128&d=identicon&r=PG", "display_name": "Aluan Haddad", "link": "https://stackoverflow.com/users/1915893/aluan-haddad"}, "edited": false, "score": 1, "creation_date": 1562794501, "post_id": 56978876, "comment_id": 100493832, "body": "I&#39;m not convinced of that. The use of generics is pretty weird in the OP"}, {"owner": {"reputation": 10525, "user_id": 1186050, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1aeaf46e73772e9f9c7784bf0ee0705c?s=128&d=identicon&r=PG", "display_name": "user1186050", "link": "https://stackoverflow.com/users/1186050/user1186050"}, "edited": false, "score": 0, "creation_date": 1562796144, "post_id": 56978876, "comment_id": 100494290, "body": "yes could you please include an example of the interface?"}, {"owner": {"reputation": 10525, "user_id": 1186050, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1aeaf46e73772e9f9c7784bf0ee0705c?s=128&d=identicon&r=PG", "display_name": "user1186050", "link": "https://stackoverflow.com/users/1186050/user1186050"}, "edited": false, "score": 0, "creation_date": 1562797246, "post_id": 56978876, "comment_id": 100494559, "body": "also IWebServiceAWI is going to be different webservices so how would I make it generic so I don&#39;t hard code &quot;IWebServiceAWI&quot;"}], "tags": [], "owner": {"reputation": 76753, "user_id": 1026459, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/pv5mS.png?s=128&g=1", "display_name": "Travis J", "link": "https://stackoverflow.com/users/1026459/travis-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1562794027, "creation_date": 1562794027, "answer_id": 56978876, "question_id": 56978817, "link": "https://stackoverflow.com/questions/56978817/how-to-pass-a-class-to-a-method-where-the-methods-parameter-is-a-generic/56978876#56978876", "title": "How to pass a class to a method where the methods parameter is a generic", "body": "<p>You could make interfaces for these, and then reference them in your method. There is no need to include the generic type for <code>newUser</code> if it isn't being used, just directly use that in the parameters. </p>\n\n<p>As for the WebServiceAWI, you would need to define that type using the <code>where</code> keyword.</p>\n\n<pre><code>public void TestTOSomething&lt;T&gt;(IUser newUser, string url) where T : IWebServiceAWI\n</code></pre>\n"}], "owner": {"reputation": 10525, "user_id": 1186050, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1aeaf46e73772e9f9c7784bf0ee0705c?s=128&d=identicon&r=PG", "display_name": "user1186050", "link": "https://stackoverflow.com/users/1186050/user1186050"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562798688, "creation_date": 1562793665, "last_edit_date": 1562798688, "question_id": 56978817, "link": "https://stackoverflow.com/questions/56978817/how-to-pass-a-class-to-a-method-where-the-methods-parameter-is-a-generic", "title": "How to pass a class to a method where the methods parameter is a generic", "body": "<p>This method below has been written 12 different times in my project using a different interface</p>\n\n<pre><code>ChannelFactory&lt;interface&gt;\n</code></pre>\n\n<p>and a different \"User\". </p>\n\n<pre><code>var user = new SomeWebServiceReference.User();\n</code></pre>\n\n<p>Examples below.</p>\n\n<p>So I'd like to make a single generic like class or a generic method in a class (not sure what I need) that passes in the \"WebServiceAWI\" interface and any of the other interfaces (ex. WebServiceBW, WebServiceAWA) and a \"User\" but I'm not sure how to do it.</p>\n\n<pre><code>    // file 1\n    public void TestSomething(string url)\n    { \n        BasicHttpBinding binding = new BasicHttpBinding(BasicHttpSecurityMode.Transport);\n        EndpointAddress endpoint = new EndpointAddress(url);\n\n        var channelFactory = new ChannelFactory&lt;WebServiceAWI&gt;(binding, endpoint);\n\n        var webservice = channelFactory.CreateChannel();\n\n        var user = new User(); // from ServiceReferenceARM \n        user.UserName = webservice.EncryptValue(\"someone\");\n        user.Password = webservice.EncryptValue(\"password\");\n\n        WebServiceResult result = webservice.AttorneysGet(user);\n    }\n\n    // file 2\n    public void TestSomething(string url)\n    { \n        BasicHttpBinding binding = new BasicHttpBinding(BasicHttpSecurityMode.Transport);\n        EndpointAddress endpoint = new EndpointAddress(url);\n\n        var channelFactory = new ChannelFactory&lt;WebServiceBW&gt;(binding, endpoint);\n\n        var webservice = channelFactory.CreateChannel();\n\n        var user = new User(); // from ServiceReferenceBW\n        user.UserName = webservice.EncryptValue(\"someone\");\n        user.Password = webservice.EncryptValue(\"password\");\n\n        WebServiceResult result = webservice.AttorneysGet(user);\n    }\n</code></pre>\n\n<p>I think I'm on the right track with the interface, but I'm not sure how to pass in a class that then acts like a generic.</p>\n\n<p>Here is what I have so far.</p>\n\n<p>Calling it like this</p>\n\n<pre><code>TestTOSomething&lt;WebServiceAWI, WebServicesTO.ServiceReferenceARM.User&gt;(new ServiceReferenceARM.User(), url);\n</code></pre>\n\n<p>and then implementing it like this but I know this is wrong.</p>\n\n<pre><code>    public void TestTOSomething&lt;T, K&gt;(K newUser, string url)\n    {\n\n        BasicHttpBinding binding = new BasicHttpBinding(BasicHttpSecurityMode.Transport);\n        EndpointAddress endpoint = new EndpointAddress(url);\n\n        var channelFactory = new ChannelFactory&lt;T&gt;(binding, endpoint);\n\n        var webservice = channelFactory.CreateChannel();\n\n        var user = newUser;\n        user.UserName = webservice.EncryptValue(\"someone\");\n        user.Password = webservice.EncryptValue(\"password\");\n\n        WebServiceResult result = webservice.AttorneysGet(user);\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net-core", "routing", "asp.net-web-api-routing"], "comments": [{"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 3, "creation_date": 1562794378, "post_id": 56978732, "comment_id": 100493795, "body": "Well, post the complete Startup code, preferably for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Be clear about version(s), starter template, etc."}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 10812109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e8fabf315de16aac4f4b810b093d5?s=128&d=identicon&r=PG&f=1", "display_name": "RedRose", "link": "https://stackoverflow.com/users/10812109/redrose"}, "edited": false, "score": 0, "creation_date": 1562795293, "post_id": 56978980, "comment_id": 100494053, "body": "Thanks! UseMvc() did the trick.  I thought the &quot;request execution pipeline&quot; is added by default and i was expecting it to resolve the routes. But again if you are using Asp.net core what else would you use ? why does it not &quot;UseMvc()&quot; by default?"}, {"owner": {"reputation": 19212, "user_id": 4275342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/KnE9R.png?s=128&g=1", "display_name": "Roman Marusyk", "link": "https://stackoverflow.com/users/4275342/roman-marusyk"}, "reply_to_user": {"reputation": 321, "user_id": 10812109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e8fabf315de16aac4f4b810b093d5?s=128&d=identicon&r=PG&f=1", "display_name": "RedRose", "link": "https://stackoverflow.com/users/10812109/redrose"}, "edited": false, "score": 1, "creation_date": 1562796754, "post_id": 56978980, "comment_id": 100494444, "body": "Glad to have been of help. Because sometimes you don&#39;t need a  default route"}], "tags": [], "owner": {"reputation": 19212, "user_id": 4275342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/KnE9R.png?s=128&g=1", "display_name": "Roman Marusyk", "link": "https://stackoverflow.com/users/4275342/roman-marusyk"}, "is_accepted": true, "score": 3, "last_activity_date": 1562794593, "creation_date": 1562794593, "answer_id": 56978980, "question_id": 56978732, "link": "https://stackoverflow.com/questions/56978732/attribute-routing-for-simple-ping-controller-with-get-not-working/56978980#56978980", "title": "Attribute routing for simple ping controller with Get() not working", "body": "<p>You need to add <code>UseMvc()</code> or <code>UseMvcWithDefaultRoute()</code> in startup to define routing.</p>\n\n<p><code>UseMvcWithDefaultRoute</code> adds a default route named 'default' to the request execution pipeline and equals to</p>\n\n<pre><code>app.UseMvc(routes =&gt;\n{\n    routes.MapRoute(\n        name: \"default\",\n        template: \"{controller=Home}/{action=Index}/{id?}\");\n}); \n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 10812109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e8fabf315de16aac4f4b810b093d5?s=128&d=identicon&r=PG&f=1", "display_name": "RedRose", "link": "https://stackoverflow.com/users/10812109/redrose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 0, "accepted_answer_id": 56978980, "answer_count": 1, "score": 0, "last_activity_date": 1562795006, "creation_date": 1562793281, "last_edit_date": 1562795006, "question_id": 56978732, "link": "https://stackoverflow.com/questions/56978732/attribute-routing-for-simple-ping-controller-with-get-not-working", "title": "Attribute routing for simple ping controller with Get() not working", "body": "<p>I have simple asp.net core web api with a nudge controller that returns true for Get request. The PingController.cs looks as follows:</p>\n\n<pre><code>[Route(\"api/[Controller]\")]\npublic class PingController : Controller\n{\n    [HttpGet]\n    public IActionResult Get()\n    {\n        return Ok(true);\n    }\n}\n</code></pre>\n\n<p>Why is navigating to the controller <code>(http://localhost:56103/api/Ping)</code> returning 404 ? </p>\n\n<p>I added route on top of the controller and the HttpMethod for specific action. What is it that I am missing or not understanding here ?</p>\n\n<p>When I add <code>app.UseMvcWithDefaultRoute()</code> in Startup.cs the controller works fine. (This is also confusing me.)\nStartup.cs looks like the following :</p>\n\n<pre><code>public class Startup\n{\n\n            public IConfiguration Configuration { get; set; }\n\n            public Startup()\n            {\n               Configuration = BuildConfiguration();\n            }\n\n            // This method gets called by the runtime. Use this method to add services to the container.\n            public IServiceProvider ConfigureServices(IServiceCollection services)\n            {\n                ...\n            }\n\n            // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.\n            public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n            {\n                if (env.IsDevelopment())\n                {\n                    app.UseDeveloperExceptionPage();\n                }\n                else\n                {\n                    // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.\n                    app.UseHsts();\n                }\n                ConfigureRoutes(app);\n            }\n\n            private static void ConfigureMvc(IServiceCollection services, Config config)\n            {\n                services.AddMvc()\n                    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2)// auto generated\n                    .AddJsonOptions(options =&gt; { options.SerializerSettings.Formatting = Formatting.Indented; })\n                    .AddControllersAsServices();\n\n            }\n\n            private static void ConfigureRoutes(IApplicationBuilder app)\n            {\n                //app.UseMvcWithDefaultRoute();\n            }\n        }\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 1, "creation_date": 1562793182, "post_id": 56978641, "comment_id": 100493405, "body": "To solve a big problem you need to <a href=\"https://ericlippert.com/2014/03/21/find-a-simpler-problem/\" rel=\"nofollow noreferrer\">split it into smaller problems</a>. Create one list. Post the code. Create a second list. <a href=\"https://stackoverflow.com/posts/56978641/edit\">Edit</a> your question to add that code. Then create a list containing those two lists. Post that code. Create one matrix. Post that code. Assign the first list elements to the diagonal of the first matrix. Post that code. Continue."}], "answers": [{"tags": [], "owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "is_accepted": false, "score": 0, "last_activity_date": 1562794405, "last_edit_date": 1562794405, "creation_date": 1562793310, "answer_id": 56978739, "question_id": 56978641, "link": "https://stackoverflow.com/questions/56978641/how-to-create-a-3d-list-in-c/56978739#56978739", "title": "How to create a 3D List in C#", "body": "<p>Create a regular <code>List&lt;int&gt;</code> for the first list.</p>\n\n<pre><code>List&lt;int&gt; list = new List&lt;int&gt;() { 2, 3, 5, 3 };\n</code></pre>\n\n<p>Then your 'matrix'(which really is a 2D array):</p>\n\n<pre><code>int[,] matrix = new int[4, 4];\n</code></pre>\n\n<p>Now, the diagonal means <code>column == row</code>, so using two loops you can enter the value only when that condition is met.</p>\n\n<pre><code>for (int row = 0; row &lt; list.Count; row++)\n{\n    for (int col = 0; col &lt; list.Count; col++)\n    {\n        if (col == row)\n            matrix[row, col] = list[row];\n        else\n            matrix[row, col] = 0;\n    }\n}\n</code></pre>\n\n<p>Confirmation:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ph0Dg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ph0Dg.png\" alt=\"enter image description here\"></a></p>\n\n<p>And do the same thing for the 2nd list. You could easily write a function that would do this.</p>\n\n<h2>EDIT</h2>\n\n<p>Here it is put into a function, and how to use it.</p>\n\n<pre><code>static int[,] CreateMatrix(List&lt;int&gt; list)\n{\n    int[,] matrix = new int[list.Count, list.Count];\n\n    for (int row = 0; row &lt; list.Count; row++)\n    {\n        for (int col = 0; col &lt; list.Count; col++)\n        {\n            if (col == row)\n                matrix[row, col] = list[row];\n            else\n                matrix[row, col] = 0;\n        }\n    }\n\n    return matrix;\n}\n</code></pre>\n\n<p>Calling:</p>\n\n<pre><code>var list1 = new List&lt;int&gt;() { 2, 3, 5, 3 };\nvar list2 = new List&lt;int&gt;() { 1, 3, 9, 2 };\n\nvar matrix1 = CreateMatrix(list1);\nvar matrix2 = CreateMatrix(list2);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11750091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb85644b51ba18164bc9c3acb7f6326c?s=128&d=identicon&r=PG&f=1", "display_name": "Roberto", "link": "https://stackoverflow.com/users/11750091/roberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562794405, "creation_date": 1562792764, "question_id": 56978641, "link": "https://stackoverflow.com/questions/56978641/how-to-create-a-3d-list-in-c", "title": "How to create a 3D List in C#", "body": "<p>I have a list which is made up of 2 lists with the following numbers:\nlist(1) = (2,3,5,3)\nlist(2) = (1,3,9,2).\nNow I have to create two matrix:\nThe first matrix 4x4 should have all the elements of list(1) on the diagonal, the rest of the numbers should be zero.</p>\n\n<p>The second matrix 4x4 should have all the elements of list(2) on the diagonal. The rest of the numbers should be zero.</p>\n\n<p>I want to do this with a for loop.\nCould you please help me? I don't know how to start, I'm new in C# and I can't find references in which it's clear how to work with 3D matrix as I did with Matlab.\nThanks a lot!</p>\n"}, {"tags": ["c#", "linq", "entity-framework-core"], "comments": [{"owner": {"reputation": 31334, "user_id": 74015, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4b7088749adc3ec3e51982d0a3bf1b34?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Axe", "link": "https://stackoverflow.com/users/74015/sam-axe"}, "edited": false, "score": 0, "creation_date": 1562792979, "post_id": 56978628, "comment_id": 100493323, "body": "I could be wrong, but <code>IQueryable</code> seems like the wrong return type because you are actually resolving your query before returning.   I would use the fluent LINQ extensions syntax to make this much more apparent."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "reply_to_user": {"reputation": 31334, "user_id": 74015, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/4b7088749adc3ec3e51982d0a3bf1b34?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Axe", "link": "https://stackoverflow.com/users/74015/sam-axe"}, "edited": false, "score": 1, "creation_date": 1562793154, "post_id": 56978628, "comment_id": 100493395, "body": "@SamAxe Not sure what you mean, but the query isn&#39;t <i>executed</i> before returning so <code>IQueryable</code> is a valid return type."}, {"owner": {"reputation": 76753, "user_id": 1026459, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/pv5mS.png?s=128&g=1", "display_name": "Travis J", "link": "https://stackoverflow.com/users/1026459/travis-j"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562793400, "post_id": 56978628, "comment_id": 100493474, "body": "@Gert is correct, DefaultIfEmpty returns an IQueryable, as does Select."}, {"owner": {"reputation": 2427, "user_id": 2025711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NHq9z.jpg?s=128&g=1", "display_name": "Rogala", "link": "https://stackoverflow.com/users/2025711/rogala"}, "edited": false, "score": 0, "creation_date": 1562970574, "post_id": 56978628, "comment_id": 100561209, "body": "What is the relationship between ServiceIntervals and Vehicles?"}, {"owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "edited": false, "score": 0, "creation_date": 1563024579, "post_id": 56978628, "comment_id": 100569808, "body": "Your could call it one-to-many (Vehicle --&lt; ServiceIntervals).  The tables are in different databases provided by different vendors."}, {"owner": {"reputation": 2427, "user_id": 2025711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NHq9z.jpg?s=128&g=1", "display_name": "Rogala", "link": "https://stackoverflow.com/users/2025711/rogala"}, "edited": false, "score": 0, "creation_date": 1563047454, "post_id": 56978628, "comment_id": 100575032, "body": "@craig see my answer below.  As long as the databases are on the same server, my answer will work."}], "answers": [{"tags": [], "owner": {"reputation": 307, "user_id": 7437221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3bfc3ea7296467a2f62e36ecc2a1d79?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Sailer", "link": "https://stackoverflow.com/users/7437221/sean-sailer"}, "is_accepted": false, "score": 3, "last_activity_date": 1562793463, "last_edit_date": 1562793463, "creation_date": 1562793142, "answer_id": 56978706, "question_id": 56978628, "link": "https://stackoverflow.com/questions/56978628/return-an-iqueryable-that-joins-two-tables/56978706#56978706", "title": "Return an IQueryable that joins two tables", "body": "<p>Doing <code>select new {}</code> in LINQ creates an anonymous type, which by definition is anonymous and can't be used as a return type. If you want to return this variable, you have to create a type for it.</p>\n\n<pre><code>public class VehicleServiceDTO\n{\n   public Vehicle Vehicle { get; set; }\n   public ServiceInterval Repair { get; set; }\n}\n\npublic IQueryable&lt;VehicleServiceDTO&gt; GetVehicles()\n{\n\n    return\n        from v in _context.Vehicles\n        join si in _context.ServiceIntervals on v.Id equals si.VehicleId into loj\n        from rs in loj.DefaultIfEmpty()\n        where\n            v.Schedule == true\n            &amp;&amp; v.Suspend == false\n        select new VehicleServiceDTO() { Vehicle = v, Repair = rs };\n\n}\n</code></pre>\n\n<p>You can change the types and variable names in the custom DTO class to match the type of <code>_context.ServiceIntervals</code> (I assumed it was called <code>ServiceInterval</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562872946, "post_id": 56980797, "comment_id": 100526148, "body": "Note that this must trigger client-side evaluation because you combine <code>IQueryable</code>s from different sources in one query. I&#39;d prefer to get the vehicles and service intervals in separate queries and combine them in code. EF core 3+ will abandon client-side evaluation."}, {"owner": {"reputation": 2427, "user_id": 2025711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NHq9z.jpg?s=128&g=1", "display_name": "Rogala", "link": "https://stackoverflow.com/users/2025711/rogala"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562884046, "post_id": 56980797, "comment_id": 100529885, "body": "@GertArnold I updated the code to throw an exception if client side evaluation occurs.  The code does not throw an exception.  I&#39;ll run a profiler to verify later."}, {"owner": {"reputation": 2427, "user_id": 2025711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NHq9z.jpg?s=128&g=1", "display_name": "Rogala", "link": "https://stackoverflow.com/users/2025711/rogala"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562885374, "post_id": 56980797, "comment_id": 100530140, "body": "@GertArnold I looked at the IntelliTrace events, and the query sent to the database is a left outer join that filters on schedule and suspended.  So client side evaluation is not occurring here. ~cheers"}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562943064, "post_id": 56980797, "comment_id": 100551507, "body": "Then you probably missed the last update of the question. OP added that <code>ServiceIntervals</code> is from a different data source."}, {"owner": {"reputation": 2427, "user_id": 2025711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NHq9z.jpg?s=128&g=1", "display_name": "Rogala", "link": "https://stackoverflow.com/users/2025711/rogala"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562976172, "post_id": 56980797, "comment_id": 100562058, "body": "@GertArnold I missed that portion, but I updated my answer.  The query is still sound and not executing client-side evaluation."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 1, "creation_date": 1563020174, "post_id": 56980797, "comment_id": 100568815, "body": "Good job! I must admit I&#39;d never expected EF to combine a <code>SqlQuery</code> result and a <code>DbSet</code> into one SQL statement. BTW, I think you don&#39;t even need the second context, or did you forget to modify some parts of the code?"}, {"owner": {"reputation": 2427, "user_id": 2025711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NHq9z.jpg?s=128&g=1", "display_name": "Rogala", "link": "https://stackoverflow.com/users/2025711/rogala"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1563021600, "post_id": 56980797, "comment_id": 100569111, "body": "I have the second context to load the data into the second database :D"}], "tags": [], "owner": {"reputation": 2427, "user_id": 2025711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NHq9z.jpg?s=128&g=1", "display_name": "Rogala", "link": "https://stackoverflow.com/users/2025711/rogala"}, "is_accepted": false, "score": 2, "last_activity_date": 1562976087, "last_edit_date": 1562976087, "creation_date": 1562811450, "answer_id": 56980797, "question_id": 56978628, "link": "https://stackoverflow.com/questions/56978628/return-an-iqueryable-that-joins-two-tables/56980797#56980797", "title": "Return an IQueryable that joins two tables", "body": "<p>I don't necessarily think you shouldn't use a navigation property here.  They are virtual and a query is generated base on the Linq statement.</p>\n\n<p>I also don't think a separate DTO model makes sense in this case.  I'm making an assumption, since you mentioned a navigation property, that you have a 1-many relationship.  My guess is that the vehicle should be scheduled with a collection of repairs.  If that is the case, then maybe a <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.groupjoin?view=netcore-2.2\" rel=\"nofollow noreferrer\">GroupJoin</a> would work.  It is supported by EF: <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/ef/language-reference/supported-and-unsupported-linq-methods-linq-to-entities\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/ef/language-reference/supported-and-unsupported-linq-methods-linq-to-entities</a></p>\n\n<p>I added a property to hold the repairs to the <strong>Vehicle</strong>:</p>\n\n<pre><code>public IEnumerable&lt;ServiceInterval&gt; RepairsToSchedule { get; set; }\n</code></pre>\n\n<p>Then the query ends up looking something like this:</p>\n\n<pre><code>public static IQueryable&lt;Vehicle&gt; GetVehicles()\n{\n    return _context.Vehicles\n        .Where(v =&gt; v.Schedule &amp;&amp; !v.Suspend)\n        .GroupJoin(_context.ServiceIntervals,\n            v =&gt; v.Id,\n            si =&gt; si.VehicleId,\n            (v, si) =&gt; SetServiceIntervals(v, si));\n}\n</code></pre>\n\n<p>I used the static method below to add the <strong>ServiceIntervals</strong> to the <strong>Vehicle</strong>:</p>\n\n<pre><code>private static Vehicle SetServiceIntervals(Vehicle v, IEnumerable&lt;ServiceInterval&gt; si)\n{\n    v.RepairsToSchedule = si;\n    return v;\n}\n</code></pre>\n\n<p>The entire source code is below:\n<strong>Edited: adjusted for two separate database (note, on same server)</strong></p>\n\n<pre><code>using Microsoft.EntityFrameworkCore;\nusing Microsoft.EntityFrameworkCore.Diagnostics;\nusing Newtonsoft.Json;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\n\nnamespace StackoverFlow\n{\n    class Program\n    {\n        private static FakeDatabaseContext _context = new FakeDatabaseContext();\n        private static FakeDatabaseContext2 _context2 = new FakeDatabaseContext2();\n\n        static void Main(string[] args)\n        {\n            CleanContext();\n            LoadContext();\n\n            foreach (var vehicle in GetVehicles())\n            {\n                Console.WriteLine(JsonConvert.SerializeObject(vehicle, Formatting.Indented));\n                Console.WriteLine();\n            }\n            Console.ReadKey();\n        }\n\n        public static IQueryable&lt;Vehicle&gt; GetVehicles()\n        {\n            return _context.Vehicles\n                .Where(v =&gt; v.Schedule &amp;&amp; !v.Suspend)\n                .GroupJoin(_context.ServiceIntervals(new DateTime(), new DateTime()),\n                    v =&gt; v.Id,\n                    si =&gt; si.VehicleId,\n                    (v, si) =&gt; SetServiceIntervals(v, si));\n        }\n\n        private static Vehicle SetServiceIntervals(Vehicle v, IEnumerable&lt;ServiceInterval&gt; si)\n        {\n            v.RepairsToSchedule = si;\n            return v;\n        }\n\n        #region EF Context\n        public class FakeDatabaseContext : DbContext\n        {\n            public DbSet&lt;Vehicle&gt; Vehicles { get; set; }\n            private DbSet&lt;ServiceInterval&gt; _serviceIntervals { get; set; }\n\n            public IQueryable&lt;ServiceInterval&gt; ServiceIntervals(DateTime startingDate, DateTime endingDate)\n            {\n                return _serviceIntervals.FromSql($@\"\n                    SELECT *\n                    FROM Stackoverflow2.dbo.ServiceIntervals\"\n                );\n            }\n\n            protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n            {\n                optionsBuilder.UseSqlServer(\n                    @\"Server=(localdb)\\mssqllocaldb;Database=Stackoverflow;Integrated Security=True\");\n                optionsBuilder\n                    .ConfigureWarnings(w =&gt; w.Throw(RelationalEventId.QueryClientEvaluationWarning));\n            }\n        }\n\n        // Used to load a seperate database\n        public class FakeDatabaseContext2 : DbContext\n        {\n            public DbSet&lt;ServiceInterval&gt; ServiceIntervals { get; set; }\n\n            protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n            {\n                optionsBuilder.UseSqlServer(\n                    @\"Server=(localdb)\\mssqllocaldb;Database=Stackoverflow2;Integrated Security=True\");\n                optionsBuilder\n                    .ConfigureWarnings(w =&gt; w.Throw(RelationalEventId.QueryClientEvaluationWarning));\n            }\n        }\n\n        public class Vehicle\n        {\n            public string Id { get; set; }\n            public bool Schedule { get; set; }\n            public bool Suspend { get; set; }\n            public IEnumerable&lt;ServiceInterval&gt; RepairsToSchedule { get; set; }\n        }\n\n        public class ServiceInterval\n        {\n            public string Id { get; set; }\n            public string VehicleId { get; set; }\n        }\n        #endregion EF Context\n\n        #region Seed methods\n        private static Random _random = new Random();\n        private static bool _randomBool =&gt; _random.Next() % 2 == 1;\n\n        private static void LoadContext()\n        {\n            var maxVehicles = 10;\n            for (int i = 1; i &lt; maxVehicles; i++)\n            {\n                _context.Vehicles.Add(new Vehicle { Id = i.ToString(), Schedule = _randomBool, Suspend = _randomBool });\n\n                for (int o = 1; o &lt; _random.Next(10); o++)\n                {\n                    _context2.ServiceIntervals.Add(new ServiceInterval { Id = ((maxVehicles * i) + o).ToString(), VehicleId = i.ToString() });\n                }\n            };\n\n            _context.SaveChanges();\n            _context2.SaveChanges();\n        }\n\n        private static void CleanContext()\n        {\n            _context.Vehicles.RemoveRange(_context.Vehicles.ToArray());\n            _context2.ServiceIntervals.RemoveRange(_context2.ServiceIntervals.ToArray());\n            _context.SaveChanges();\n            _context2.SaveChanges();\n        }\n        #endregion Seed methods\n    }\n}\n</code></pre>\n\n<p>IntelliTrace showed this query was executed:</p>\n\n<pre><code>SELECT [v].[Id], [v].[Schedule], [v].[Suspend], [si].[Id], [si].[VehicleId]\nFROM [Vehicles] AS [v]\nLEFT JOIN (\n\n                        SELECT *\n                        FROM Stackoverflow2.dbo.ServiceIntervals\n) AS [si] ON [v].[Id] = [si].[VehicleId]\nWHERE ([v].[Schedule] = 1) AND ([v].[Suspend] = 0)\nORDER BY [v].[Id]\n</code></pre>\n\n<p>I tested this a few times, and everything appears to be working fine. </p>\n\n<p>~Cheers</p>\n\n<p>Setup Project Notes:</p>\n\n<ol>\n<li>This is a .NET Core 2.1 Console Application</li>\n<li>Install-Package Microsoft.EntityFrameworkCore -Version 2.2.6</li>\n<li>Install-Package Microsoft.EntityFrameworkCore.Design -Version 2.2.6</li>\n<li>Install-Package Microsoft.EntityFrameworkCore.SqlServer -Version 2.2.6</li>\n<li>Install-Package Microsoft.EntityFrameworkCore.SqlServer.Design -Version 1.1.6</li>\n<li>Open cmd window and navigate to project folder</li>\n<li>Run in Console: dotnet ef migrations add InitialCreate</li>\n<li>Run in Console: dotnet ef database update</li>\n</ol>\n"}], "owner": {"reputation": 23753, "user_id": 134367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/PgGXL.png?s=128&g=1", "display_name": "craig", "link": "https://stackoverflow.com/users/134367/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1558, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563034026, "creation_date": 1562792718, "last_edit_date": 1563034026, "question_id": 56978628, "link": "https://stackoverflow.com/questions/56978628/return-an-iqueryable-that-joins-two-tables", "title": "Return an IQueryable that joins two tables", "body": "<p>This service method will return an <code>IQueryable&lt;Vehicle&gt;</code>:</p>\n\n<pre><code>public IQueryable&lt;Vehicle&gt; GetVehicles()\n{\n    return\n        from v in _context.Vehicles\n        where\n            v.Schedule == true\n            &amp;&amp; v.Suspend == false\n        select v;\n}\n</code></pre>\n\n<p>If I want to include another table in the query:</p>\n\n<pre><code>public IQueryable&lt;Vehicle&gt; GetVehicles()\n{\n\n    return\n        from v in _context.Vehicles\n        join si in _context.ServiceIntervals on v.Id equals si.VehicleId into loj\n        from rs in loj.DefaultIfEmpty()\n        where\n            v.Schedule == true\n            &amp;&amp; v.Suspend == false\n        select new { vehicle = v, repair = rs };\n\n}\n</code></pre>\n\n<p>What's the correct <code>IQueryable&lt;T&gt;</code> return type?  <code>IQueryable&lt;{vehicle,repair}&gt;</code> isn't correct.</p>\n\n<p>Is there a better way to compose the <code>select</code> statement?</p>\n\n<p>** Edit **</p>\n\n<p>I was hoping to keep this simple, but I think a clarification is useful.</p>\n\n<p><code>ServiceIntervals</code> is actually an <code>IQueryable&lt;T&gt;</code> that references a table-valued function from another SQL DB:</p>\n\n<pre><code>public IQueryable&lt;ServiceInterval&gt; ServiceIntervals(DateTime startingDate, DateTime endingDate) =&gt;\n    Query&lt;ServiceInterval&gt;().FromSql($@\"\n        SELECT *\n        FROM OtherDatabase.Dbo.ServiceIntervals({startingDate}, {endingDate})\"\n    );\n</code></pre>\n\n<p>The origin query actually includes dates:</p>\n\n<pre><code>...\n_context.ServiceIntervals(DateTime.Now.Date,DateTime.Now.Date)\n...\n</code></pre>\n\n<p>As such, I don't think <code>ServiceIntervals</code> can be exposed as a navigation property on the <code>Vehicle</code> entity.</p>\n"}, {"tags": ["c#", "algorithm", "recursion", "data-structures", "recursive-datastructures"], "comments": [{"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 2, "creation_date": 1562793646, "post_id": 56978618, "comment_id": 100493566, "body": "Your question is a bit hard to gasp... the first part seems to be a simple <b>yes or no</b> question (<i>&quot;Is this right?&quot;</i>) and the second part is primarily opinion based (<i>&quot;Is there a better algorithm to achieve this?&quot;</i>) without specifying the design goals of <i>&quot;better&quot;</i>. I think it doesn&#39;t really fit the format of stackoverflow. Please re-think what your actual question is."}, {"owner": {"reputation": 319, "user_id": 9057272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85a1722ab84bc22f61546357a10fb34?s=128&d=identicon&r=PG&f=1", "display_name": "user9057272", "link": "https://stackoverflow.com/users/9057272/user9057272"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1562855996, "post_id": 56978618, "comment_id": 100518017, "body": "I edited the question. I am just looking for the right and quickest logic or pseudo-code."}], "answers": [{"comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1562794005, "post_id": 56978818, "comment_id": 100493673, "body": "With N=2 does that apply?"}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "reply_to_user": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1562794326, "post_id": 56978818, "comment_id": 100493776, "body": "No: <code>N-1</code> = 1 then, so it&#39;s equivalent to what you&#39;re already doing."}], "tags": [], "owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "is_accepted": false, "score": 1, "last_activity_date": 1562793672, "creation_date": 1562793672, "answer_id": 56978818, "question_id": 56978618, "link": "https://stackoverflow.com/questions/56978618/minimum-sum-of-recursive-adding-of-elements-in-an-array-two-a-time/56978818#56978818", "title": "Minimum sum of recursive adding of elements in an array two a time", "body": "<p>No, that's the minimum for a polyphase merge: where <code>N</code> is the bandwidth (number of files you can merge simultaneously), then you want to merge the smallest (N-1) files at each step.  However, with this more general problem, you want to delay the larger files as long as possible -- you may want an early step or two to merge fewer than (N-1) files, somewhat like having a \"bye\" in an elimination tourney.  You want all the latter steps to involve the full (N-1) files.</p>\n\n<p>For instance, given N=4 and files <code>1, 6, 7, 8, 14, 22</code>:</p>\n\n<p>Early merge:</p>\n\n<pre><code>[22], 14, 22\n[58]\ntotal = 80\n</code></pre>\n\n<p>Late merge:</p>\n\n<pre><code>[14], 8, 14, 22\n[58]\ntotal = 72\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": true, "score": 2, "last_activity_date": 1562799833, "creation_date": 1562799833, "answer_id": 56979664, "question_id": 56978618, "link": "https://stackoverflow.com/questions/56978618/minimum-sum-of-recursive-adding-of-elements-in-an-array-two-a-time/56979664#56979664", "title": "Minimum sum of recursive adding of elements in an array two a time", "body": "<p>Once you have the sorted list, since you are only removing the two minimum items and replacing them with one, it makes more sense to do a sorted insert and place the new item in the correct place instead of re-sorting the entire list. However, this only saves a fractional amount of time - about 1% faster.</p>\n\n<p>My method <code>CostOfMerge</code> doesn't assume the input is a <code>List</code> but if it is, you can remove the conversion <code>ToList</code> step.</p>\n\n<pre><code>public static class IEnumerableExt {\n    public static int CostOfMerge(this IEnumerable&lt;int&gt; psrc) {\n        var src = psrc.ToList();\n        src.Sort();\n        while (src.Count &gt; 1) {\n            var sum = src[0]+src[1];\n            src.RemoveRange(0, 2);\n\n            var index = src.BinarySearch(sum);\n            if (index &lt; 0)\n                index = ~index;\n            src.Insert(index, sum);\n\n            total += sum;\n        }\n        return total;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 833, "user_id": 8359623, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VxGVH.jpg?s=128&g=1", "display_name": "Papai from BEKOAIL", "link": "https://stackoverflow.com/users/8359623/papai-from-bekoail"}, "is_accepted": false, "score": 1, "last_activity_date": 1562836138, "creation_date": 1562836138, "answer_id": 56985580, "question_id": 56978618, "link": "https://stackoverflow.com/questions/56978618/minimum-sum-of-recursive-adding-of-elements-in-an-array-two-a-time/56985580#56985580", "title": "Minimum sum of recursive adding of elements in an array two a time", "body": "<p>Here, you can apply the following logic to get the desired output.</p>\n\n<ol>\n<li>Get first two minimum values from list.</li>\n<li>Remove first two minimum values from list.</li>\n<li>Append the sum of first two minimum values in list</li>\n<li>And continue until the list become of size 1</li>\n<li>Return the only element from list. i.e, this will be your minimum time taken to process every item. </li>\n</ol>\n\n<p>You can follow my Java code out there, if you find helpful .. :) </p>\n\n<pre><code>public class MinimumSums {\n   private static Integer getFirstMinimum(ArrayList&lt;Integer&gt; list) {\n    Integer min = Integer.MAX_VALUE;\n\n    for(int i=0; i&lt;list.size(); i++) {\n        if(list.get(i) &lt;= min)\n            min = list.get(i);\n    }\n\n    return min;\n}\n\nprivate static Integer getSecondMinimum(ArrayList&lt;Integer&gt; list, Integer firstItem) {\n    Integer min = Integer.MAX_VALUE;\n\n    for(int i=0; i&lt;list.size(); i++) {\n        if(list.get(i) &lt;= min &amp;&amp; list.get(i)&gt; firstItem)\n            min = list.get(i);\n    }\n    return min;\n}\npublic static void main(String[] args) {\n    Integer[] processes = {5, 9, 3, 14, 12, 18};\n\n    ArrayList&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;();\n    ArrayList&lt;Integer&gt; temp = new ArrayList&lt;Integer&gt;();\n\n    list.addAll(Arrays.asList(processes));\n\n    while(list.size()!= 1) {\n        Integer firstMin = getFirstMinimum(list); // getting first min value\n        Integer secondMin = getSecondMinimum(list, firstMin); // getting second min\n\n        list.remove(firstMin);\n        list.remove(secondMin);\n\n        list.add(firstMin+secondMin);\n        temp.add(firstMin + secondMin);\n    }\n\n    System.out.println(temp); // prints all the minimum pairs.. \n    System.out.println(list.get(0)); // prints the output\n\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": [], "owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "is_accepted": false, "score": 2, "last_activity_date": 1562870547, "creation_date": 1562870547, "answer_id": 56995504, "question_id": 56978618, "link": "https://stackoverflow.com/questions/56978618/minimum-sum-of-recursive-adding-of-elements-in-an-array-two-a-time/56995504#56995504", "title": "Minimum sum of recursive adding of elements in an array two a time", "body": "<p>As already discussed in other answers, the best strategy will be to always work on the two items with minimal cost for each iteration. So the only remaining question is how to efficiently take the two smallest items each time.</p>\n\n<p>Since you asked for best performance, I shamelessly took the algorithm from NetMage and modified it to speed it up roughly 40% for my test case (thanks and +1 to <a href=\"https://stackoverflow.com/users/2557128/netmage\">NetMage</a>).</p>\n\n<p>The idea is to work mostly in place on a single array.\nEach iteration increase the starting index by 1 and move the elements within the array to make space for the sum from current iteration.</p>\n\n<pre><code>public static long CostOfMerge2(this IEnumerable&lt;int&gt; psrc)\n{\n    long total = 0;\n\n    var src = psrc.ToArray();\n    Array.Sort(src);\n\n    var i = 1;\n    int length = src.Length;\n    while (i &lt; length)\n    {\n        var sum = src[i - 1] + src[i];\n\n        total += sum;\n\n        // find insert position for sum\n        var index = Array.BinarySearch(src, i + 1, length - i - 1, sum);\n        if (index &lt; 0)\n            index = ~index;\n        --index;\n\n        // shift items that come before insert position one place to the left\n        if (i &lt; index)\n            Array.Copy(src, i + 1, src, i, index - i);\n\n        src[index] = sum;\n\n        ++i;\n    }\n\n    return total;\n}\n</code></pre>\n\n<p>I tested with the following calling code (switching between <code>CostOfMerge</code> and <code>CostOfMerge2</code>), with a few different values for random-seed, count of elements and max value of initial items.</p>\n\n<pre><code>static void Main(string[] args)\n{\n    var r = new Random(10);\n\n    var testcase = Enumerable.Range(0, 400000).Select(x =&gt; r.Next(1000)).ToList();\n    var sw = Stopwatch.StartNew();\n    long resultCost = testcase.CostOfMerge();\n    sw.Stop();\n    Console.WriteLine($\"Cost of Merge: {resultCost}\");\n    Console.WriteLine($\"Time of Merge: {sw.Elapsed}\");\n    Console.ReadLine();\n}\n</code></pre>\n\n<p>Result for shown configuration for NetMage CostOfMerge:</p>\n\n<pre><code>Cost of Merge: 3670570720\nTime of Merge: 00:00:15.4472251\n</code></pre>\n\n<p>My CostOfMerge2:</p>\n\n<pre><code>Cost of Merge: 3670570720\nTime of Merge: 00:00:08.7193612\n</code></pre>\n\n<p>Ofcourse the detailed numbers are hardware dependent and difference might be bigger or smaller depending on a load of stuff.</p>\n"}], "owner": {"reputation": 319, "user_id": 9057272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d85a1722ab84bc22f61546357a10fb34?s=128&d=identicon&r=PG&f=1", "display_name": "user9057272", "link": "https://stackoverflow.com/users/9057272/user9057272"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 951, "favorite_count": 0, "accepted_answer_id": 56979664, "answer_count": 4, "score": -2, "last_activity_date": 1562870547, "creation_date": 1562792669, "last_edit_date": 1562855829, "question_id": 56978618, "link": "https://stackoverflow.com/questions/56978618/minimum-sum-of-recursive-adding-of-elements-in-an-array-two-a-time", "title": "Minimum sum of recursive adding of elements in an array two a time", "body": "<p>I have an array of integers. Value of each element represents the time taken to process a file. The processing of files consists of merging two files at a time. What is the algorithm to find the minimum time that can be taken for processing all the files. E.g. - {3,5,9,12,14,18}.</p>\n\n<p>The time of processing can be calculated as - \nCase 1) - </p>\n\n<pre><code>a) [8],9,12,14,18\nb) [17],12,14,18\nc) [26],17,18\nd) 26,[35]\ne) 61\n</code></pre>\n\n<p>So total time for processing is 61 + 35 + 26 + 17 + 8 = 147</p>\n\n<p>Case 2) - </p>\n\n<pre><code>a) [21],5,9,12,14\nb) [17],[21],9,14\nc) [21],[17],[23]\nd) [40],[21]\ne) 61\n</code></pre>\n\n<p>This time the total time is 61 + 40 + 23 + 17 + 21 = 162</p>\n\n<p>Seems to me that continuously sorting the array and adding the least two elements is the best bet for the minimum as in Case 1. Is my logic right? If not what is the right and easiest way to achieve this with best performance?</p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 1, "creation_date": 1562792615, "post_id": 56978587, "comment_id": 100493196, "body": "What is stopping you from replacing <code>&quot;username&quot;</code> with <code>User.Identity.Name</code> in your code?  That&#39;s what you&#39;re doing in <a href=\"https://stackoverflow.com/questions/56878145/asp-net-ad-group-check-variable\">your previous question on this topic</a>.  So what&#39;s the issue?"}, {"owner": {"reputation": 83, "user_id": 9129050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3dff6fe5edfa82f660f5f03c22e639?s=128&d=identicon&r=PG&f=1", "display_name": "EbertB", "link": "https://stackoverflow.com/users/9129050/ebertb"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562794802, "post_id": 56978587, "comment_id": 100493921, "body": "When I try that it (take out the password and change the user) says: An invalid dn syntax has been specified. - I am assuming it wants that password."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562797576, "post_id": 56978587, "comment_id": 100494651, "body": "Well, yes, it needs a password for that user."}, {"owner": {"reputation": 43836, "user_id": 5947043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jUK37.png?s=128&g=1", "display_name": "ADyson", "link": "https://stackoverflow.com/users/5947043/adyson"}, "edited": false, "score": 1, "creation_date": 1562804196, "post_id": 56978587, "comment_id": 100495998, "body": "What are you trying to achieve? If you want to limit access to a controller method then use an [Authorize] attribute on the method."}], "owner": {"reputation": 83, "user_id": 9129050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b3dff6fe5edfa82f660f5f03c22e639?s=128&d=identicon&r=PG&f=1", "display_name": "EbertB", "link": "https://stackoverflow.com/users/9129050/ebertb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562792621, "creation_date": 1562792525, "last_edit_date": 1562792621, "question_id": 56978587, "link": "https://stackoverflow.com/questions/56978587/principalcontext-sending-windows-authentication", "title": "PrincipalContext sending windows authentication", "body": "<p>Is there a way to use the code below but instead of username and password send the windows authentication (User.Identity.Name) so only users with the correct domain admin rights can run this in the controller?</p>\n\n<pre><code>    PrincipalContext ctx = new PrincipalContext(ContextType.Domain, \"domain.local\", \"username\", \"password\");\n</code></pre>\n"}, {"tags": ["c#", "entity-framework", "dependency-injection", "autofac", "unit-of-work"], "comments": [{"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 1, "creation_date": 1562793125, "post_id": 56978578, "comment_id": 100493380, "body": "Both the problem and the solution are probably at startup where you&#39;r registering these dependencies. Can you show that?"}, {"owner": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "reply_to_user": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1562793697, "post_id": 56978578, "comment_id": 100493584, "body": "@ScottHannen I have updated my question with the startup. Actually I using Autofac module which I am registering in Startup. I have given the code of the module. Let me know if you need anything else. Thanks."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562796819, "post_id": 56978578, "comment_id": 100494456, "body": "<i>With each API call I&#39;ll get the client specific connection strings</i> How do you get these strings? How do you recognize from the request which string you should get? You may find what you need when looking for multi-tenancy patterns."}, {"owner": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1562833477, "post_id": 56978578, "comment_id": 100504417, "body": "@GertArnold In each API call I will get the client Id, using which I will call Membership repository to get the conn string and create the new db context."}], "answers": [{"comments": [{"owner": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "edited": false, "score": 0, "creation_date": 1562962219, "post_id": 57002514, "comment_id": 100559079, "body": "This approach will not work for my case because, at the time of Autofac registration in startup I will not have the clientId. I will receive clientId with each api call, and then I need to somehow tell autofac to override the initial dbcontext with the new dbcontext which I created using the clientId. But I&#39;m not able to figure out how to achieve that!"}, {"owner": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "edited": false, "score": 0, "creation_date": 1562962515, "post_id": 57002514, "comment_id": 100559160, "body": "My unit of work&#39;s responsibility is to provide repositories with a dbcontext and then saving the changes done on the dbcontext by the repositories."}, {"owner": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "reply_to_user": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "edited": false, "score": 0, "creation_date": 1562977582, "post_id": 57002514, "comment_id": 100562260, "body": "In this case you can change the <code>XXXClientContextProvider</code> and <code>IClientContext</code> implementations. In the <code>SetClientContext</code> you can alter an existing instance."}, {"owner": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "reply_to_user": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "edited": false, "score": 0, "creation_date": 1562977742, "post_id": 57002514, "comment_id": 100562287, "body": "Could you share how you retrieve the <code>clientId</code> ? Is it a parameter of every api call ? There is many way of having a good implementation of <code>XXXClientContextProvider</code>"}, {"owner": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "reply_to_user": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "edited": false, "score": 0, "creation_date": 1562978970, "post_id": 57002514, "comment_id": 100562465, "body": "Another solution would be not to inject the <code>IClientContext</code> which is kind of a data-like object but only the <code>IClientContextProvider</code>. I try to always avoid injecting data-like object (as opposed to service-like object) because they have different lifecycles and could be mutable"}, {"owner": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "edited": false, "score": 0, "creation_date": 1563014841, "post_id": 57002514, "comment_id": 100567627, "body": "Yes, I will get clientId with every api call as a parameter in the req body. Can you tell me from where I should call <code>SetClientContext</code>? If I have to call SetClientContext from API/Service then its the same what I am doing right now. And also while autofac registration you wrote <code>c.Resolve&lt;IClientContextProvider&gt;().GetClientContext()</code>, how will it resolve at startup? because we dont have any specific clientId at startup."}], "tags": [], "owner": {"reputation": 14047, "user_id": 814735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18289d1d90dd23a3c9f2f4c039b8bdae?s=128&d=identicon&r=PG", "display_name": "Cyril Durand", "link": "https://stackoverflow.com/users/814735/cyril-durand"}, "is_accepted": false, "score": 0, "last_activity_date": 1562917986, "creation_date": 1562917986, "answer_id": 57002514, "question_id": 56978578, "link": "https://stackoverflow.com/questions/56978578/how-to-inject-dynamic-dbcontext-object-into-repository-using-autofac/57002514#57002514", "title": "How to inject dynamic DbContext object into repository using Autofac", "body": "<p>Instead of </p>\n\n<pre><code>builder.Register(a =&gt; new ClientDbContext()).InstancePerLifetimeScope();\n</code></pre>\n\n<p>you could use </p>\n\n<pre><code>builder.Register(c =&gt; c.Resolve&lt;IUnitOfWork&gt;().ClientDbContext)\n       .InstancePerLifetimeScope(); \n</code></pre>\n\n<p>By the way I'm not sure what is the responsibility of your <code>IUnitOfWork</code>. Another way of doing this would be to have a class that would provide information about the current user : </p>\n\n<pre><code>public interface IClientContext \n{\n    public String ClientIdentifier { get; }\n}\n</code></pre>\n\n<p>Then a <code>DbContextFactory</code> that would create the <code>DbContext</code> based on the <code>IClientContext</code></p>\n\n<pre><code>public interface IDbContextFactory \n{\n    IDbContext CreateDbContext(); \n}\n\npublic class DbContextFactory \n{\n    public DbContextFactory(IClientContext clientContext) \n    {\n        this._clientContext = clientContext; \n    }\n\n    private readonly IClientContext _clientContext;\n\n    public IDbContext CreateDbContext()\n    {\n        // get the connectionstring from IClientContext and return the IDbContext\n    } \n}\n</code></pre>\n\n<p>The concrete implementation of <code>IClientContext</code> depends on the way you can get this information, it could be from current <code>HttpContext</code> or any other way it's up to you.\nIt seems that at some point you call <code>SetDbContext</code> you can keep this way by creating a <code>XXXClientContextProvider</code> where <code>XXX</code> is relative to the way you get this information.</p>\n\n<pre><code>public class XXXClientContextProvider \n{\n    private IClientContext _clientContext; \n\n    public IClientContext GetClientContext()\n    {\n        if(this._clientContext == null) \n        {\n           throw new Exception(\"client context is null. You should do X or Y\"); \n        }\n        return this._clientContext; \n    }\n    public void SetClientContext(String clientId) \n    {\n        if(this._clientContext != null) \n        {\n            throw new Exception(\"client context has already been set\"); \n        }\n        this._clientContext = new StaticClientContext(clientId);\n    }\n}\n</code></pre>\n\n<p>and then register everything like this : </p>\n\n<pre><code>builder.Register(c =&gt; c.Resolve&lt;IClientContextProvider&gt;().GetClientContext())\n       .As&lt;IClientContext&gt;()\n       .InstancePerLifetime(); \n\nbuilder.Register(c =&gt; c.Resolve&lt;IDbContextFactory&gt;().CreateDbContext())\n       .As&lt;IDbContext&gt;()\n       .InstancePerLifetime(); \n</code></pre>\n"}], "owner": {"reputation": 6106, "user_id": 4340692, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh3.googleusercontent.com/-Bv827U0Kfcg/AAAAAAAAAAI/AAAAAAAAADY/JMOvPZZLPCo/photo.jpg?sz=128", "display_name": "Utsav Dawn", "link": "https://stackoverflow.com/users/4340692/utsav-dawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 925, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562917986, "creation_date": 1562792456, "last_edit_date": 1562867569, "question_id": 56978578, "link": "https://stackoverflow.com/questions/56978578/how-to-inject-dynamic-dbcontext-object-into-repository-using-autofac", "title": "How to inject dynamic DbContext object into repository using Autofac", "body": "<p>I have an .net core web api application where I'm using entity framework core with service layer, unit of work and repository layer pattern. For DI I'm using Autofac. </p>\n\n<p>The application has <strong>multiple clients</strong> and <strong>each client has its own database</strong> and the schema for all these databases is same. <em>With each API call I'll get the client specific connection string, using which I have to create a DbContext and use it for all its operations.</em></p>\n\n<p>On Startup class I have registered my dbcontext ClientDbContext and all other classes. When the unit-of-work class is  called I am creating my new DbContext based on the connection string. I want the repository to use this instance, <strong>but the repository is still using the initial ClientDbContext instance which was created at startup</strong>.</p>\n\n<p><strong>How can I make the repository use the new DbContext instance?</strong></p>\n\n<p>Unit of Work:</p>\n\n<pre><code>public class UnitOfWork : IUnitOfWork\n{\n    public ClientDbContext ClientDbContext { get; private set; }        \n\n    public UnitOfWork ()\n    {            \n\n    }\n\n    public void SetDbContext(string connectionString)\n    {\n        if(ClientDbContext == null)\n        {\n            //creating new db context instance here\n            ClientDbContext = MembershipRepository.CreateDbContext(connectionString);\n        }                \n    }        \n    //property injection\n    public IGenericRepository&lt;SomeEntity, ClientDbContext&gt; SomeEntityGenericRepository { get; }\n}\n</code></pre>\n\n<p>Generic Repository:</p>\n\n<pre><code>public class GenericRepository&lt;TEntity, TDbContext&gt; : IGenericRepository&lt;TEntity, TDbContext&gt; where TEntity : class\nwhere TDbContext : DbContext\n{\n    private readonly TDbContext _context;\n    private readonly DbSet&lt;TEntity&gt; _dbset;\n    public GenericRepository(TDbContext context)\n    {\n        // need to get updated context here, but getting the initial one\n        _context = context;\n        _dbset = _context.Set&lt;TEntity&gt;();\n    }\n}\n</code></pre>\n\n<p>Autofac module called in Startup.cs:</p>\n\n<pre><code>builder.Register(a =&gt; new ClientDbContext()).InstancePerLifetimeScope();\n\nbuilder.RegisterGeneric(typeof(GenericRepository&lt;,&gt;)).As(typeof(IGenericRepository&lt;,&gt;)).InstancePerLifetimeScope();\n\n//Register Unit of Work here\nbuilder.RegisterType&lt;UnitOfWork&gt;().As&lt;IUnitOfWork&gt;().InstancePerLifetimeScope().PropertiesAutowired();                \n\n//Register Services here\nbuilder.RegisterType&lt;SomeService&gt;().As&lt;ISomeService&gt;().InstancePerLifetimeScope();\n</code></pre>\n\n<p>Can anyone please help me out on how to achieve the above requirement?</p>\n\n<p>Is there any way I can make Autofac use my new created dbcontext object?</p>\n"}, {"tags": ["c#", "for-loop", "repeat"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1562792387, "post_id": 56978507, "comment_id": 100493118, "body": "I can&#39;t really understand what the problem is. What&#39;s the exact error and which line throws it?"}, {"owner": {"reputation": 25, "user_id": 11307490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf12f44f3081afe667d3754962d09d?s=128&d=identicon&r=PG&f=1", "display_name": "MattDmc", "link": "https://stackoverflow.com/users/11307490/mattdmc"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1562792461, "post_id": 56978507, "comment_id": 100493142, "body": "It breaks in this line             var data2 = list2.Where(x =&gt; x.Id == list1[i].Id); Because list1.Count is 6, when i &lt; 6 it goes fine, but after running the foreach and returning the post to the web... the code breaks from nowhere in that line because i now is 6 and the list goes from 0 to 5"}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1562792462, "post_id": 56978507, "comment_id": 100493143, "body": "<code>i &lt;= list1.Count() - 1</code> is the same as <code>i &lt; list1.Count()</code>. Also use the <code>list1.Count</code> property instead of the <code>list1.Count()</code> extension method."}, {"owner": {"reputation": 25, "user_id": 11307490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf12f44f3081afe667d3754962d09d?s=128&d=identicon&r=PG&f=1", "display_name": "MattDmc", "link": "https://stackoverflow.com/users/11307490/mattdmc"}, "edited": false, "score": 0, "creation_date": 1562792618, "post_id": 56978507, "comment_id": 100493197, "body": "Ok, I&#39;ve changed all that, but the error stills"}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1562792649, "post_id": 56978507, "comment_id": 100493213, "body": "Oh. Delayed execution. Add a <code>.ToList()</code> to that <code>= data2;</code>."}, {"owner": {"reputation": 25, "user_id": 11307490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf12f44f3081afe667d3754962d09d?s=128&d=identicon&r=PG&f=1", "display_name": "MattDmc", "link": "https://stackoverflow.com/users/11307490/mattdmc"}, "edited": false, "score": 0, "creation_date": 1562792739, "post_id": 56978507, "comment_id": 100493249, "body": "Man! It works! Great, thanks!! Now I don&#39;t get it, what was happening?"}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 2, "creation_date": 1562792990, "post_id": 56978507, "comment_id": 100493328, "body": "Also, I would suggest adding <code>list2</code> stuff into a dictionary instead for speed. <code>var dict = GetData2FromDB().ToDictionary(x =&gt; x.Id);</code> then, in the loop: <code>list1[i].Details = dict[list1[i].Id];</code>. This is O(n). The list variant is O(n^2)."}, {"owner": {"reputation": 25, "user_id": 11307490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf12f44f3081afe667d3754962d09d?s=128&d=identicon&r=PG&f=1", "display_name": "MattDmc", "link": "https://stackoverflow.com/users/11307490/mattdmc"}, "edited": false, "score": 0, "creation_date": 1562793629, "post_id": 56978507, "comment_id": 100493560, "body": "Hi Olivier, the problem is that Details is waiting for IEnumerable&lt;list1&gt;  (or a list)"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11307490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf12f44f3081afe667d3754962d09d?s=128&d=identicon&r=PG&f=1", "display_name": "MattDmc", "link": "https://stackoverflow.com/users/11307490/mattdmc"}, "edited": false, "score": 0, "creation_date": 1562794159, "post_id": 56978708, "comment_id": 100493720, "body": "Yes this solved my problem! Thank you guys. Thanks for the info!"}], "tags": [], "owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "is_accepted": true, "score": 4, "last_activity_date": 1562794095, "last_edit_date": 1562794095, "creation_date": 1562793149, "answer_id": 56978708, "question_id": 56978507, "link": "https://stackoverflow.com/questions/56978507/for-loop-is-repeating-after-finish-and-returning-argumentoutofrangeexception/56978708#56978708", "title": "For loop is repeating after finish and returning ArgumentOutOfRangeException", "body": "<p>I suspect the problem is delayed execution / lazy evaluation <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.where\" rel=\"nofollow noreferrer\">caused by LINQ</a> (see <em>Remarks</em> section). When you do this:</p>\n\n<pre><code>var data2 = list2.Where(x =&gt; x.Id == list1[i].Id);\nlist1[i].Details = data2;\n</code></pre>\n\n<p>You've created an IEnumerable which knows to return elements from <code>list2</code> where the <code>x.Id == list1[i].Id</code>. But it has not yet actually executed that logic - it's just remembered \"how\" to do it, including which variables it needs to reference.</p>\n\n<p>It will execute later, when something actually tries to enumerate it. The problem is that later, the value of the <code>i</code> variable has changed to an out of range value (because <code>i</code> is incremented by the <code>for</code> loop until it's out of range).</p>\n\n<p>You can force the <code>IEnumerable</code> to execute immediately, by adding <code>.ToList()</code> to the end. This will enumerate it and put the contents into a list.</p>\n\n<p>For more explanation on lambdas capturing variables, see: <a href=\"https://blogs.msdn.microsoft.com/ericlippert/2009/11/12/closing-over-the-loop-variable-considered-harmful/\" rel=\"nofollow noreferrer\">https://blogs.msdn.microsoft.com/ericlippert/2009/11/12/closing-over-the-loop-variable-considered-harmful/</a></p>\n"}], "owner": {"reputation": 25, "user_id": 11307490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebf12f44f3081afe667d3754962d09d?s=128&d=identicon&r=PG&f=1", "display_name": "MattDmc", "link": "https://stackoverflow.com/users/11307490/mattdmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56978708, "answer_count": 1, "score": 2, "last_activity_date": 1562794095, "creation_date": 1562792123, "question_id": 56978507, "link": "https://stackoverflow.com/questions/56978507/for-loop-is-repeating-after-finish-and-returning-argumentoutofrangeexception", "title": "For loop is repeating after finish and returning ArgumentOutOfRangeException", "body": "<p>Im passing a foreach to a for to improve performance. However, I think my for is fine but, after its runs, I don't know why it repeat 1 more last time (even it's not corresponding to the sentence) and it throws error because the \"i\" doesn't exist in that list.</p>\n\n<p>I've searched and no one had this error so I'm curious. I mean the condition is fine and it works fine \"the first time\" but then, from nowhere it runs again and breaks. </p>\n\n<p>It could be possible because Im doing a ToList() for the list1? Because calling to the data base returns a IEnnumerable and I couldn't use it for For loop.</p>\n\n<pre><code>    var list1 = GetData1FromDB().ToList();\n        var list2 = GetData2FromDB();\n\n        for (int i = 0; i &lt;= list1.Count() - 1; i++)\n        {\n            var data2 = list2.Where(x =&gt; x.Id == list1[i].Id);\n            list1[i].Details = data2;\n            result.data1.Add(list1[i]);\n        }\n</code></pre>\n"}, {"tags": ["c#", "wpf", "mvvm", "fluentvalidation", "reactiveui"], "comments": [{"owner": {"reputation": 2281, "user_id": 3167364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bb4ab7fad5b0f64dd01f64235dbd6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Watson", "link": "https://stackoverflow.com/users/3167364/glenn-watson"}, "edited": false, "score": 0, "creation_date": 1562810339, "post_id": 56978297, "comment_id": 100497044, "body": "Have you checked out the ReactiveUI validation project. <a href=\"https://GitHub.com/ReactiveUI/ReactiveUI.validation\" rel=\"nofollow noreferrer\">GitHub.com/ReactiveUI/ReactiveUI.validation</a>"}, {"owner": {"reputation": 31, "user_id": 11766998, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zt1B4pEEsyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdGkbyqG7Ih4VkSzfcUdqFfTIDCXA/photo.jpg?sz=128", "display_name": "alpha07", "link": "https://stackoverflow.com/users/11766998/alpha07"}, "reply_to_user": {"reputation": 2281, "user_id": 3167364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bb4ab7fad5b0f64dd01f64235dbd6d6?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn Watson", "link": "https://stackoverflow.com/users/3167364/glenn-watson"}, "edited": false, "score": 1, "creation_date": 1562872188, "post_id": 56978297, "comment_id": 100525852, "body": "@GlennWatson hi. I did check it out, but regardless of the validation mechanism my question would be the same, how to trigger a user control validation error event on each control that failed validation.   The examples in ReactiveUI.validation that I saw populate a separate property that map to a different Control to display the validation issues to the user, which is indeed a valid workaround. But with this I can&#39;t leverage the automatic theming from MaterialDesignThemes to populate each validation error in its own Control Element."}, {"owner": {"reputation": 4549, "user_id": 105568, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f4da10bd4be2d0ca458f8786c79b9e84?s=128&d=identicon&r=PG", "display_name": "Skrymsli", "link": "https://stackoverflow.com/users/105568/skrymsli"}, "edited": false, "score": 0, "creation_date": 1589849208, "post_id": 56978297, "comment_id": 109450849, "body": "I&#39;m running into this same issue and I&#39;m wondering if you ever figured out a way to do it. It seems that validation can only occur via XAML binding, but reactiveui provides its own binding methods that don&#39;t seem to support it. Setting the validation on a separate control seems really hacky."}, {"owner": {"reputation": 31, "user_id": 11766998, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zt1B4pEEsyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdGkbyqG7Ih4VkSzfcUdqFfTIDCXA/photo.jpg?sz=128", "display_name": "alpha07", "link": "https://stackoverflow.com/users/11766998/alpha07"}, "edited": false, "score": 0, "creation_date": 1589937052, "post_id": 56978297, "comment_id": 109489372, "body": "Never did figure it out unfortunately. Ended up dropping this framework from my project. Insufficient documentation on many of the features."}], "owner": {"reputation": 31, "user_id": 11766998, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zt1B4pEEsyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdGkbyqG7Ih4VkSzfcUdqFfTIDCXA/photo.jpg?sz=128", "display_name": "alpha07", "link": "https://stackoverflow.com/users/11766998/alpha07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 2, "answer_count": 0, "score": 3, "last_activity_date": 1589923383, "creation_date": 1562791136, "last_edit_date": 1562791582, "question_id": 56978297, "link": "https://stackoverflow.com/questions/56978297/binding-options-with-reactiveui", "title": "Binding options with Reactiveui", "body": "<p>I'm trying to setup validation for some form fields and bind any errors to the UI elements provided by materialdesign-in-xaml.</p>\n\n<p>The question is how can I use reactive's Bind method to set the required parameters (not sure if parameters is the correct wording here) for this to work.</p>\n\n<p>I'm trying to do this:</p>\n\n<pre><code>&lt;TextBox x:Name=\"NewTransactionPriceTextBox\"\n         Margin=\"0,15,0,0\"\n         materialDesign:HintAssist.Hint=\"Transaction Price\" \n         HorizontalAlignment=\"Left\"\n         Text=\"{Binding NewTransactionPrice, UpdateSourceTrigger=PropertyChanged, NotifyOnValidationError=True, ValidatesOnDataErrors=True}\" /&gt;\n</code></pre>\n\n<p>But in code behind, like this:</p>\n\n<pre><code>this.Bind(ViewModel, vm =&gt; vm.NewTransactionPrice, \n             v =&gt; v.NewTransactionPriceTextBox.Text).DisposeWith(sub);\n</code></pre>\n\n<p>How can I pass <code>NotifyOnValidationError=True</code> and the rest using ReactiveUI Syntax?</p>\n"}, {"tags": ["c#", "unity3d", "networking", "photon"], "answers": [{"tags": [], "owner": {"reputation": 1552, "user_id": 1449056, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/caf116c439d0c1289dd347239a61fbf1?s=128&d=identicon&r=PG", "display_name": "JohnTube", "link": "https://stackoverflow.com/users/1449056/johntube"}, "is_accepted": true, "score": 1, "last_activity_date": 1562949398, "creation_date": 1562949398, "answer_id": 57010922, "question_id": 56978277, "link": "https://stackoverflow.com/questions/56978277/question-about-photonnetwork-currentroom-customproperties/57010922#57010922", "title": "Question about PhotonNetwork.CurrentRoom.CustomProperties", "body": "<p>Thank you for choosing Photon!</p>\n\n<p>To get a custom property, I recommend you use <code>TryGetValue</code> method as follows:</p>\n\n<pre><code>    hash = PhotonNetwork.CurrentRoom.CustomProperties;\n    object temp;\n    string key = rpk.activeGame;\n    if (hash.TryGetValue(key, out temp))\n    {\n        if (temp is bool)\n        {\n            bool activeGame = (bool)temp;\n        }\n        else\n        {\n            // unexpected custom property value type\n        }\n    } \n    else \n    {\n        // custom property not found\n    }\n</code></pre>\n\n<p>If the custom property is not available yet, wait for the callback <code>IInRoomCallbacks.OnRoomPropertiesUpdate(Hashtable propertiesThatChanged)</code> (<a href=\"https://doc-api.photonengine.com/en/pun/v2/interface_photon_1_1_realtime_1_1_i_in_room_callbacks.html#ace378cf7df21ab802b2a0d144264e6c5\" rel=\"nofollow noreferrer\">reference API</a>).</p>\n\n<p>Other notes and recommendations:</p>\n\n<pre><code>private void GameRoomSetup (string pOne, string pTwo, int pOneColor, int pTwoColor)\n</code></pre>\n\n<p>Not sure if it's supported or if it's a good idea to pass multiple parameters to a PUN RPC method.</p>\n\n<p>To debug log a <code>Dictionary</code> or a <code>Hashtable</code> you could make use of <code>SupportClass.DictionaryToString()</code> method.\nso instead of</p>\n\n<pre><code>Debug.Log(hash);\n</code></pre>\n\n<p>use</p>\n\n<pre><code>Debug.Log(SupportClass.DictionaryToString(hash));\n</code></pre>\n\n<p>Avoid calling expensive methods like <code>GameObject.Find</code>:</p>\n\n<pre><code>    GameObject gameMenu = GameObject.Find (\"GameMenu\");\n</code></pre>\n\n<p>Also here you have duplicate calls to <code>gameMenu.GetComponent&lt;SubMenu&gt;()</code>, at least call it once and cache the component result found if any.</p>\n\n<pre><code>    gameMenu.GetComponent&lt;SubMenu&gt; ().UpdatePlayers (pOne, pTwo, pOneColor, pTwoColor);\n    gameMenu.GetComponent&lt;SubMenu&gt; ().StartGameSetup ();\n</code></pre>\n\n<p>Comparing strings should not be done using <code>==</code> operator. At least use Equal method and proper StringComparison type. Read \"<a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/how-to/compare-strings\" rel=\"nofollow noreferrer\">How to compare strings in C#</a>\".</p>\n\n<pre><code>    // If you are a player, change the active buttons that are visible.\n    if (PhotonNetwork.NickName == pOne || PhotonNetwork.NickName == pTwo) \n    {\n        gameMenu.GetComponent&lt;GameButtonManager&gt; ().GameStart ();\n    }\n</code></pre>\n\n<p>Besides, why do you use the Nickname to check if it's player one or two? maybe use ActorNumber or a custom player index. Or use the player count if the room is for 2 players only.</p>\n"}], "owner": {"reputation": 47, "user_id": 4638120, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153058769539034/picture?type=large", "display_name": "Shawn Ray", "link": "https://stackoverflow.com/users/4638120/shawn-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1964, "favorite_count": 0, "accepted_answer_id": 57010922, "answer_count": 1, "score": 1, "last_activity_date": 1562961883, "creation_date": 1562791053, "last_edit_date": 1562961883, "question_id": 56978277, "link": "https://stackoverflow.com/questions/56978277/question-about-photonnetwork-currentroom-customproperties", "title": "Question about PhotonNetwork.CurrentRoom.CustomProperties", "body": "<p>When the game starts in multiplayer, the master client sends a PunRPC to have all clients run a function. This function tries to get the room properties to see if the game is active, if so it does something. For some reason a client gets a null reference error, but the master client does not. The strange thing is, a debug of the hash table for room properties is visible but I cannot get a specific item in it.</p>\n\n<p>Tried Debugging the hash table to make sure that the key was set when the code was run. It was. \"(System.String)ag=(System.Boolean)True ag=activeGame\" This shows in <code>Debug.Log(hash);</code> But <code>(bool)hash[rpk.activeGame]</code> gets a null reference error. But only on the client side not the master client. So the key also works.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// Call all the clients to set up the room settings in the sub menu.\n    [PunRPC]\n    private void GameRoomSetup (string pOne, string pTwo, int pOneColor, int pTwoColor)\n    {\n        GameObject gameMenu = GameObject.Find (\"GameMenu\");\n\n        gameMenu.GetComponent&lt;SubMenu&gt; ().UpdatePlayers (pOne, pTwo, pOneColor, pTwoColor);\n        gameMenu.GetComponent&lt;SubMenu&gt; ().StartGameSetup ();\n\n        // If you are a player, change the active buttons that are visible.\n        if (PhotonNetwork.NickName == pOne || PhotonNetwork.NickName == pTwo) \n        {\n            gameMenu.GetComponent&lt;GameButtonManager&gt; ().GameStart ();\n        }\n\n        hash = PhotonNetwork.CurrentRoom.CustomProperties;\n        Debug.Log(hash);\n        if ((bool)hash[rpk.activeGame]) // Error on this line on client but not on master client. Says null reference.\n        {\n            GameObject.Find (\"SoundManager\").GetComponent&lt;SoundManagerScript&gt; ().PlayBackgroundTwo ();\n            GameObject.Find (\"GameMenu\").GetComponent&lt;SubMenu&gt; ().ChangeSubMenuActive (false);\n        }\n    }\n</code></pre>\n\n<p>I'm trying to run my if statement as a client but I get an error.</p>\n"}, {"tags": ["c#", "sql", "checkbox", "datagridview"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1562791303, "post_id": 56978252, "comment_id": 100492692, "body": "Getting UI controls to &quot;fill itself in&quot; is called <i>data binding</i>.  Gobs written on the topic"}, {"owner": {"reputation": 7168, "user_id": 6842716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cxds5.png?s=128&g=1", "display_name": "JohnG", "link": "https://stackoverflow.com/users/6842716/johng"}, "edited": false, "score": 0, "creation_date": 1562808644, "post_id": 56978252, "comment_id": 100496765, "body": "try: <code>ckboxForeignCust.Checked = (bool)row.Cells[&quot;ForesignCust&quot;].Value;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11698631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b07ccf301ae55c4f8574be2df92f2b56?s=128&d=identicon&r=PG&f=1", "display_name": "sharknado", "link": "https://stackoverflow.com/users/11698631/sharknado"}, "edited": false, "score": 0, "creation_date": 1562791753, "post_id": 56978327, "comment_id": 100492881, "body": "Yeah i have a sql database that is feeding into the datagridview. The checkboxes show up in the datagridview but I want to bind this checkbox for updating the record if need be. When you type in a customer name right now every piece of information will populate into the text boxes but the checkboxes stay blank because i cant figure out how to bind them"}, {"owner": {"reputation": 50, "user_id": 10786509, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZTNclqqfX5Y/AAAAAAAAAAI/AAAAAAAAAII/Qog4F2_OYy4/photo.jpg?sz=128", "display_name": "Breno Almeida", "link": "https://stackoverflow.com/users/10786509/breno-almeida"}, "reply_to_user": {"reputation": 7, "user_id": 11698631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b07ccf301ae55c4f8574be2df92f2b56?s=128&d=identicon&r=PG&f=1", "display_name": "sharknado", "link": "https://stackoverflow.com/users/11698631/sharknado"}, "edited": false, "score": 0, "creation_date": 1562792605, "post_id": 56978327, "comment_id": 100493191, "body": "How you&#39;re feeding the datagridview? manually? if you are using the method above, .fill(datatable), you dont need to bind the checkbox.   If i get your problem, when you type any customer name, the grid will show all stored infos except the check boxes, right,?"}], "tags": [], "owner": {"reputation": 50, "user_id": 10786509, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZTNclqqfX5Y/AAAAAAAAAAI/AAAAAAAAAII/Qog4F2_OYy4/photo.jpg?sz=128", "display_name": "Breno Almeida", "link": "https://stackoverflow.com/users/10786509/breno-almeida"}, "is_accepted": false, "score": 0, "last_activity_date": 1562791229, "creation_date": 1562791229, "answer_id": 56978327, "question_id": 56978252, "link": "https://stackoverflow.com/questions/56978252/how-do-you-make-a-column-in-the-datagridview-that-is-a-checkbox-populate-a-check/56978327#56978327", "title": "How do you make a column in the datagridview that is a checkbox populate a checkbox on an update form?", "body": "<p>Are you using any sql? </p>\n\n<p>Checkbox columns are simple true or false, when you use DataReader.fill(datatable); and set datagrid.datasource = datatables; all boolean columns that you have inside your database, will turn into checkbox columns inside the datagridview. </p>\n"}], "owner": {"reputation": 7, "user_id": 11698631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b07ccf301ae55c4f8574be2df92f2b56?s=128&d=identicon&r=PG&f=1", "display_name": "sharknado", "link": "https://stackoverflow.com/users/11698631/sharknado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562795240, "creation_date": 1562790882, "last_edit_date": 1562795240, "question_id": 56978252, "link": "https://stackoverflow.com/questions/56978252/how-do-you-make-a-column-in-the-datagridview-that-is-a-checkbox-populate-a-check", "title": "How do you make a column in the datagridview that is a checkbox populate a checkbox on an update form?", "body": "<p>So one of my tables in the database I'm using has a few different checkbox columns that are information about the customer. Like one is if they are foreign or not or like a few yes or no questions. I made my form that has a bunch of text boxes that will populate themselves when you select a record. </p>\n\n<p>I need the checkboxes to also populate but I do not know the syntax</p>\n\n<p>I've tried looking up the solution but everything I found is about selecting a record by using a checkbox not getting a checkbox to fill itself in if it's checked or not on the table itself.</p>\n\n<p>The code I'm using for the <code>TextBox</code>es is a row index methods that use this to populate the normal textboxes</p>\n\n<pre><code>txtboxFirstName.Text = row.Cells[\"FirstName\"].Value.ToString();\ntxtboxLastName.Text = row.Cells[\"LastName\"].Value.ToString();\n</code></pre>\n\n<p>For the checkbox, I would imagine its something like\n<code>ckboxForeignCust.Checked = row.Cells[\"ForesignCust\"]</code> but I do not know how to finish that line of code.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c#", "asp.net-mvc", "drop-down-menu", "view"], "answers": [{"comments": [{"owner": {"reputation": 773, "user_id": 10660059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qhE72.jpg?s=128&g=1", "display_name": "Shervin Ivari", "link": "https://stackoverflow.com/users/10660059/shervin-ivari"}, "edited": false, "score": 0, "creation_date": 1562794866, "post_id": 56978743, "comment_id": 100493938, "body": "Thanks for your answer.i use the LINQ way. actually, i was looking for a way to define props while I&#39;m writing Html helper but as you say constructor of the select list won&#39;t work in that way.so this one you say is better than foreach and view models."}], "tags": [], "owner": {"reputation": 13274, "user_id": 920669, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/639ffd0669e8284dcfe77a883effe31d?s=128&d=identicon&r=PG", "display_name": "Corey", "link": "https://stackoverflow.com/users/920669/corey"}, "is_accepted": true, "score": 1, "last_activity_date": 1562793319, "creation_date": 1562793319, "answer_id": 56978743, "question_id": 56978231, "link": "https://stackoverflow.com/questions/56978231/asp-net-html-helper-dropdown-show-two-columns-value-in-option/56978743#56978743", "title": "Asp.net html helper dropdown show two columns value in option", "body": "<p>The <code>SelectList</code> constructor you're using takes the name of a property and uses reflection to locate the named member.  In your first example you are telling it to look for a property named <code>Stf_FirstNameStf_LastName</code> which I would guess does not exist.</p>\n\n<p>If you want the staff member's full name then you need to provide that as a property on the <code>Staffs</code> object.</p>\n\n<p>If you have control over whichever type the <code>Staffs</code> list contains then you can add a property like this:</p>\n\n<pre><code>public property string FullName =&gt; $\"{Stf_FirstName} {Stf_LastName}\";\n</code></pre>\n\n<p>Then you can call the <code>SelectList</code> constructor with <code>FullName</code> as the display property:</p>\n\n<pre><code>@Html.DropDownListFor(m =&gt; m.Staffs, new SelectList(Model.Staffs, \"Id\", \"FullName\"), \"\", new { @class = \"form-control\" })\n</code></pre>\n\n<p>If that isn't available to you then you can create the <code>SelectList</code> from a LINQ query like this in the top of your page code:</p>\n\n<pre><code>@{\n    var staffList = Model.Staffs.Select(s =&gt; new { Value = s.Id, Text = $\"{s.Stf_FirstName} {s.Stf_LastName}\" });\n    var staffSelect = new SelectList(staffList, \"Value\", \"Text\");\n}\n</code></pre>\n\n<p>Then create your dropdown lists using that pre-built <code>SelectList</code>:</p>\n\n<pre><code>@Html.DropDownListFor(m =&gt; m.Staffs, staffSelect, \"\", new { @class = \"form-control\" })\n</code></pre>\n\n<p>This way you're creating the list once instead of multiple times.  Reflection isn't cheap, so it's probably better to do it once anyway.</p>\n"}], "owner": {"reputation": 773, "user_id": 10660059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qhE72.jpg?s=128&g=1", "display_name": "Shervin Ivari", "link": "https://stackoverflow.com/users/10660059/shervin-ivari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 56978743, "answer_count": 1, "score": 0, "last_activity_date": 1589552709, "creation_date": 1562790785, "last_edit_date": 1589552709, "question_id": 56978231, "link": "https://stackoverflow.com/questions/56978231/asp-net-html-helper-dropdown-show-two-columns-value-in-option", "title": "Asp.net html helper dropdown show two columns value in option", "body": "<p>I have a list of staff I want to show them in the drop-down list by two properties.\nvalue equals id and the option text is staff name and staff last name.</p>\n\n<p>Plus I don't want to use for each.</p>\n\n<p>I want something like this but it doesn't work</p>\n\n<pre><code>@Html.DropDownListFor(m =&gt; m.Staffs, \n                      new SelectList(Model.Staffs, \"Id\", \"Stf_FirstName\"+\"Stf_LastName\"),\n                  \"\", new { @class = \"form-control \" })\n</code></pre>\n\n<p>This works but the only first name will display</p>\n\n<pre><code>@Html.DropDownListFor(m =&gt; m.Staffs, new SelectList(Model.Staffs, \"Id\", \"Stf_FirstName\"), \"\", new { @class = \"form-control \" })\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562790763, "post_id": 56978164, "comment_id": 100492479, "body": "(<a href=\"http://rion.io/2013/04/28/handling-larger-json-string-values-in-net-and-avoiding-exceptions/\" rel=\"nofollow noreferrer\">rion.io/2013/04/28/&hellip;</a>) or look into compressing your file into a .zip"}, {"owner": {"reputation": 19, "user_id": 6620288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7BcJVtyTCAk/AAAAAAAAAAI/AAAAAAAAAd8/Bdn6Y6E0Y-M/photo.jpg?sz=128", "display_name": "Leandro Guyss", "link": "https://stackoverflow.com/users/6620288/leandro-guyss"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562851620, "post_id": 56978164, "comment_id": 100515303, "body": "It&#39;s already compressed"}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562853996, "post_id": 56978164, "comment_id": 100516756, "body": "Maybe you need to increase the max json length property"}, {"owner": {"reputation": 19, "user_id": 6620288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7BcJVtyTCAk/AAAAAAAAAAI/AAAAAAAAAd8/Bdn6Y6E0Y-M/photo.jpg?sz=128", "display_name": "Leandro Guyss", "link": "https://stackoverflow.com/users/6620288/leandro-guyss"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562866699, "post_id": 56978164, "comment_id": 100523512, "body": "the thing is, I don&#39;t want to use buffering, like using byte[] or string, and the only way to do this is using stream, but I don&#39;t know how to use it"}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562867330, "post_id": 56978164, "comment_id": 100523817, "body": "So you don&#39;t want to use a byte array? Or you do? Because your post makes it sound like you want to use a byte array"}, {"owner": {"reputation": 19, "user_id": 6620288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7BcJVtyTCAk/AAAAAAAAAAI/AAAAAAAAAd8/Bdn6Y6E0Y-M/photo.jpg?sz=128", "display_name": "Leandro Guyss", "link": "https://stackoverflow.com/users/6620288/leandro-guyss"}, "reply_to_user": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562873515, "post_id": 56978164, "comment_id": 100526366, "body": "Yep, I don&#39;t want to use byte[]"}, {"owner": {"reputation": 7330, "user_id": 4830196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xcatD.jpg?s=128&g=1", "display_name": "Ryan Wilson", "link": "https://stackoverflow.com/users/4830196/ryan-wilson"}, "edited": false, "score": 0, "creation_date": 1562874342, "post_id": 56978164, "comment_id": 100526689, "body": "(<a href=\"https://stackoverflow.com/questions/5826649/returning-a-file-to-view-download-in-asp-net-mvc\" title=\"returning a file to view download in asp net mvc\">stackoverflow.com/questions/5826649/&hellip;</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6620288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7BcJVtyTCAk/AAAAAAAAAAI/AAAAAAAAAd8/Bdn6Y6E0Y-M/photo.jpg?sz=128", "display_name": "Leandro Guyss", "link": "https://stackoverflow.com/users/6620288/leandro-guyss"}, "edited": false, "score": 0, "creation_date": 1562851707, "post_id": 56981027, "comment_id": 100515348, "body": "I think multipart could resolve it, but I can&#39;t find anything about returning it in MVC"}, {"owner": {"reputation": 983, "user_id": 7855321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhRhK.png?s=128&g=1", "display_name": "Mahyar Mottaghi Zadeh", "link": "https://stackoverflow.com/users/7855321/mahyar-mottaghi-zadeh"}, "reply_to_user": {"reputation": 19, "user_id": 6620288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7BcJVtyTCAk/AAAAAAAAAAI/AAAAAAAAAd8/Bdn6Y6E0Y-M/photo.jpg?sz=128", "display_name": "Leandro Guyss", "link": "https://stackoverflow.com/users/6620288/leandro-guyss"}, "edited": false, "score": 0, "creation_date": 1562999313, "post_id": 56981027, "comment_id": 100564822, "body": "I dont have a clue about multiparting in downloading scenarios. But I think you have to change your mechanism to the safest solution."}], "tags": [], "owner": {"reputation": 983, "user_id": 7855321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FhRhK.png?s=128&g=1", "display_name": "Mahyar Mottaghi Zadeh", "link": "https://stackoverflow.com/users/7855321/mahyar-mottaghi-zadeh"}, "is_accepted": false, "score": 0, "last_activity_date": 1562813776, "creation_date": 1562813776, "answer_id": 56981027, "question_id": 56978164, "link": "https://stackoverflow.com/questions/56978164/return-data-and-file-from-mvc-action/56981027#56981027", "title": "Return Data and File from MVC Action", "body": "<p>Depending on your restrictions you can do something tricky, if you are able to upload a file on the host, you can return the URL pf uploaded file in your JSON result and then let the user to download it.</p>\n\n<p>In addition, you can find this link helpful <a href=\"https://stackoverflow.com/a/51526234/7855321\">https://stackoverflow.com/a/51526234/7855321</a>.</p>\n"}], "owner": {"reputation": 19, "user_id": 6620288, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7BcJVtyTCAk/AAAAAAAAAAI/AAAAAAAAAd8/Bdn6Y6E0Y-M/photo.jpg?sz=128", "display_name": "Leandro Guyss", "link": "https://stackoverflow.com/users/6620288/leandro-guyss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562873481, "creation_date": 1562790433, "last_edit_date": 1562873481, "question_id": 56978164, "link": "https://stackoverflow.com/questions/56978164/return-data-and-file-from-mvc-action", "title": "Return Data and File from MVC Action", "body": "<p>I have a MVC GET action that returns a json class model with a byte[] property, I use this to return a message and the file, but if the file is too big, I would get a OutOfMemoryException, is there any other way to return file and data that wouldn't use such memory?<br>\nI know I can create another action to return only the final file, but can I do it on the same request?\nEdit:\n<strong>I don't want to use byte[] or any method that will load the file into memory</strong></p>\n\n<pre><code> public ActionResult GetFile()\n {\n    // Here: currently logic to create the final file and the message\n\n    // Here: I want to add the final file to the result\n    // Here: I want to add my model data(json) to the result\n\n    // Here: currently returning json with a byte[] property to return the file\n    return Json(myModel, JsonRequestBehavior.AllowGet);\n }\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "azure", "azure-functions", "xss"], "comments": [{"owner": {"reputation": 308, "user_id": 3083907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PWX7.jpg?s=128&g=1", "display_name": "anthonygood", "link": "https://stackoverflow.com/users/3083907/anthonygood"}, "edited": false, "score": 0, "creation_date": 1562789871, "post_id": 56977987, "comment_id": 100492123, "body": "Can&#39;t you use a library to escape HTML characters?"}, {"owner": {"reputation": 16340, "user_id": 1569689, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/21d698866fd3dfd4c566b5688ee99166?s=128&d=identicon&r=PG", "display_name": "James Wood", "link": "https://stackoverflow.com/users/1569689/james-wood"}, "reply_to_user": {"reputation": 308, "user_id": 3083907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PWX7.jpg?s=128&g=1", "display_name": "anthonygood", "link": "https://stackoverflow.com/users/3083907/anthonygood"}, "edited": false, "score": 0, "creation_date": 1562789930, "post_id": 56977987, "comment_id": 100492147, "body": "@anthonygood that&#39;s basically what <code>AntiXssEncoder</code> is doing."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 1, "creation_date": 1562791283, "post_id": 56977987, "comment_id": 100492684, "body": "When applying the content to a web page, use <code>innerText</code> not <code>innerHtml</code> to prevent the content from being treated as HTML.  <code>innerText</code> will prevent XSS in <i>most</i> cases:  <a href=\"https://stackoverflow.com/questions/52707031/does-innertext-prevent-xss\" title=\"does innertext prevent xss\">stackoverflow.com/questions/52707031/does-innertext-prevent-&zwnj;&#8203;xss</a>"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562791363, "post_id": 56977987, "comment_id": 100492728, "body": "See <a href=\"https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/DOM_based_XSS_Prevention_Cheat_Sheet.md#rule-7---fixing-dom-cross-site-scripting-vulnerabilities\" rel=\"nofollow noreferrer\">github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/&hellip;</a>"}, {"owner": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "edited": false, "score": 0, "creation_date": 1562794482, "post_id": 56977987, "comment_id": 100493826, "body": "can&#39;t you escape everything when you render it on the site?"}, {"owner": {"reputation": 16340, "user_id": 1569689, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/21d698866fd3dfd4c566b5688ee99166?s=128&d=identicon&r=PG", "display_name": "James Wood", "link": "https://stackoverflow.com/users/1569689/james-wood"}, "reply_to_user": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "edited": false, "score": 0, "creation_date": 1562800646, "post_id": 56977987, "comment_id": 100495364, "body": "@steve sure, I&#39;m doing that also. This is a defense in depth to have multiple layers of protection."}, {"owner": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "edited": false, "score": 0, "creation_date": 1562854960, "post_id": 56977987, "comment_id": 100517359, "body": "@JamesWood asp.net will only reject if the query param contains anything suspicious. If the injection comes in in the body it will not complain cuz it will be doing url encode in razor."}, {"owner": {"reputation": 157, "user_id": 3214547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2278f206821c4befdc71f3357c07cb5?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Shinde", "link": "https://stackoverflow.com/users/3214547/rahul-shinde"}, "edited": false, "score": 0, "creation_date": 1615888209, "post_id": 56977987, "comment_id": 117824701, "body": "How did you use AntiXssEncoder when it is not available in .Net core"}, {"owner": {"reputation": 16340, "user_id": 1569689, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/21d698866fd3dfd4c566b5688ee99166?s=128&d=identicon&r=PG", "display_name": "James Wood", "link": "https://stackoverflow.com/users/1569689/james-wood"}, "reply_to_user": {"reputation": 157, "user_id": 3214547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2278f206821c4befdc71f3357c07cb5?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Shinde", "link": "https://stackoverflow.com/users/3214547/rahul-shinde"}, "edited": false, "score": 0, "creation_date": 1615890442, "post_id": 56977987, "comment_id": 117825764, "body": "@RahulShinde if I recall correctly, this was on Azure Functions Version 1 which used .NET Framework."}], "owner": {"reputation": 16340, "user_id": 1569689, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/21d698866fd3dfd4c566b5688ee99166?s=128&d=identicon&r=PG", "display_name": "James Wood", "link": "https://stackoverflow.com/users/1569689/james-wood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 280, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562789656, "creation_date": 1562789656, "question_id": 56977987, "link": "https://stackoverflow.com/questions/56977987/how-can-i-protect-my-azure-function-against-xss", "title": "How can I protect my Azure Function against XSS?", "body": "<p>I have an Azure Function that accepts JSON encoded data and saves it into a database. The content from the database is then used on a web site.</p>\n\n<p>The Azure Function accepts strings, for example; <code>&lt;script&gt;alert(\"hi\")&lt;/script&gt;</code>.</p>\n\n<p>When eventually shown on the web site this script in some circumstances will be executed.</p>\n\n<p>Whilst I will also be addressing the issues in the web site. Within the Azure Function I want to implement a positive XSS Prevention Model.</p>\n\n<p>For example ASP.NET will validate requests such as form submissions, and emit <code>HttpRequestValidationException: A potentially dangerous Request.Form value was detected from the client</code>.</p>\n\n<p>As far as I know Azure Functions do not have a similiar feature.</p>\n\n<p>It also seems that I can't co-opt the ASP.NET functionaility.</p>\n\n<p>The best option I have found so far is to use <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.web.security.antixss.antixssencoder.htmlencode?view=netframework-4.5.1#System_Web_Security_AntiXss_AntiXssEncoder_HtmlEncode_System_String_System_Boolean_\" rel=\"nofollow noreferrer\"><code>AntiXssEncoder.HtmlEncode</code></a>, to encode content and check if the encoded content is different.</p>\n\n<p>Is there another approach I should consider or is this the <em>solution</em>?</p>\n"}, {"tags": ["c#", "unity3d"], "answers": [{"comments": [{"owner": {"reputation": 229, "user_id": 9541768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/026e4d94930c7b28800b36b29d51ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "Taik", "link": "https://stackoverflow.com/users/9541768/taik"}, "edited": false, "score": 0, "creation_date": 1562856916, "post_id": 56979492, "comment_id": 100518587, "body": "Yes, but it detect the swipes only once, I want to detect swipe in each frame"}, {"owner": {"reputation": 2038, "user_id": 2929738, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/dabyK.jpg?s=128&g=1", "display_name": "akaBase", "link": "https://stackoverflow.com/users/2929738/akabase"}, "reply_to_user": {"reputation": 229, "user_id": 9541768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/026e4d94930c7b28800b36b29d51ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "Taik", "link": "https://stackoverflow.com/users/9541768/taik"}, "edited": false, "score": 0, "creation_date": 1562857205, "post_id": 56979492, "comment_id": 100518769, "body": "Removing the <code>_swipingDown</code> flag will cause it to check every frame not just when a swipe is started."}], "tags": [], "owner": {"reputation": 2038, "user_id": 2929738, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/dabyK.jpg?s=128&g=1", "display_name": "akaBase", "link": "https://stackoverflow.com/users/2929738/akabase"}, "is_accepted": false, "score": 0, "last_activity_date": 1562798261, "creation_date": 1562798261, "answer_id": 56979492, "question_id": 56977958, "link": "https://stackoverflow.com/questions/56977958/detect-swipe-even-the-finger-hasnt-been-released/56979492#56979492", "title": "Detect Swipe Even the Finger Hasn&#39;t been Released", "body": "<p>You need to add a couple of flags to know which swipe status you're in if your are in one.</p>\n\n<pre><code>private bool _swiping;\nprivate bool _swipingDown;\nprivate Vector3 _previousSwipePosition;\n\nprivate void Update()\n{\n    if (Input.GetMouseButtonDown(0))\n    {\n        _previousSwipePosition = Input.mousePosition;\n        _swiping = true;\n        Debug.log(\"Started Swipe\");\n    }\n    else if (Input.GetMouseButtonUp(0))\n    {\n        _swiping = false;\n        Debug.log(\"Finished Swipe\");\n    }\n\n    if (_swiping)\n    {\n        Vector3 newPosition = Input.mousePosition;\n        if (newPosition.y &lt; _previousSwipePosition.y)\n        {\n            if (!_swipingDown)\n            {\n                Debug.Log(\"Started Swipe Down\");\n                _swipingDown = true;\n            }\n        }\n        if (newPosition.y&gt; _previousSwipePosition.y)\n        {\n            if (_swipingDown)\n            {\n                Debug.Log(\"Started Swipe Up\");\n                _swipingDown = false;\n            }\n        }\n        _previousSwipePosition = newPosition;\n    }\n}\n</code></pre>\n\n<p>This will let you know when a Swipe is Started, Finished and Changes direction using flags.</p>\n\n<p><em>flags - booleans to signify something</em></p>\n"}], "owner": {"reputation": 229, "user_id": 9541768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/026e4d94930c7b28800b36b29d51ff7a?s=128&d=identicon&r=PG&f=1", "display_name": "Taik", "link": "https://stackoverflow.com/users/9541768/taik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562798261, "creation_date": 1562789513, "question_id": 56977958, "link": "https://stackoverflow.com/questions/56977958/detect-swipe-even-the-finger-hasnt-been-released", "title": "Detect Swipe Even the Finger Hasn&#39;t been Released", "body": "<p>I want to detect the mouse swipe up and swipe down, I tried the script below but it only works:</p>\n\n<p>1 - if the finger has been released between any two swipes.\n2 - if the finger hasn't been released, but only if the second swipe has exceed the original finger position (firstPressPos).</p>\n\n<p><strong>What I want exactly is:</strong></p>\n\n<p>For example, I put my finger on the screen and I swipe down, then after I swipe up (without releasing the finger between the two swipes), I want to detect the two swipes in the real time. </p>\n\n<p>How can I do that?</p>\n\n<p><strong>Script:</strong></p>\n\n<pre><code>if (Input.GetMouseButtonDown(0))\n    {\n        firstPressPos = new Vector3(Input.mousePosition.x, Input.mousePosition.y);\n    }\n\nif (Input.GetMouseButton(0))\n    {\n        secondPressPos = new Vector3(Input.mousePosition.x, Input.mousePosition.y);\n\n        currentSwipe = new Vector3(secondPressPos.x - firstPressPos.x, secondPressPos.y - firstPressPos.y);\n\n        currentSwipe.Normalize();\n\n        if (currentSwipe.y &gt; 0 &amp;&amp; currentSwipe.x &gt; -0.5f &amp;&amp; currentSwipe.x &lt; 0.5f)\n        {\n            //Swipe Up\n        }\n\n        if (currentSwipe.y &lt; 0 &amp;&amp; currentSwipe.x &gt; -0.5f &amp;&amp; currentSwipe.x &lt; 0.5f)\n        {\n            //Swipe Down\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", ".net", "webforms", "elmah"], "answers": [{"comments": [{"owner": {"reputation": 1064, "user_id": 1221989, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f2b4b0a167c23b526ff4728c693d6fd?s=128&d=identicon&r=PG", "display_name": "SP1", "link": "https://stackoverflow.com/users/1221989/sp1"}, "edited": false, "score": 0, "creation_date": 1562872909, "post_id": 56984902, "comment_id": 100526138, "body": "Awesome..Thank you so much for your help :)"}], "tags": [], "owner": {"reputation": 4296, "user_id": 758765, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/f3fed18422c9db37c455728ecf3f880c?s=128&d=identicon&r=PG", "display_name": "ThomasArdal", "link": "https://stackoverflow.com/users/758765/thomasardal"}, "is_accepted": true, "score": 1, "last_activity_date": 1562834021, "creation_date": 1562834021, "answer_id": 56984902, "question_id": 56977912, "link": "https://stackoverflow.com/questions/56977912/change-server-variable-values-that-are-logged-in-elmah/56984902#56984902", "title": "Change server variable values that are logged in Elmah", "body": "<p>I've written a blog post about exactly that: <a href=\"https://blog.elmah.io/enrich-elmah-errors-using-error-filtering-hook/\" rel=\"nofollow noreferrer\">Enrich ELMAH errors using error filtering hook</a>.</p>\n\n<p>To summarize, use ELMAH's error filtering to overwrite the message logged to ELMAH.</p>\n\n<p>In <code>Global.asax.cs</code> add the following code:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>void ErrorLog_Filtering(object sender, ExceptionFilterEventArgs args)\n{\n    var httpContext = args.Context as HttpContext;\n    if (httpContext != null)\n    {\n        var error = new Error(args.Exception, httpContext);\n        error.User = GetUserFromDatabase();\n        ErrorLog.GetDefault(httpContext).Log(error);\n        args.Dismiss();\n    }\n}\n</code></pre>\n\n<p>How you implement the line where you set the <code>User</code> property on <code>error</code> will be up to your application. But the code will let you set something like the user's name, username, or email.</p>\n"}], "owner": {"reputation": 1064, "user_id": 1221989, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6f2b4b0a167c23b526ff4728c693d6fd?s=128&d=identicon&r=PG", "display_name": "SP1", "link": "https://stackoverflow.com/users/1221989/sp1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 56984902, "answer_count": 1, "score": 0, "last_activity_date": 1582412313, "creation_date": 1562789235, "last_edit_date": 1582412313, "question_id": 56977912, "link": "https://stackoverflow.com/questions/56977912/change-server-variable-values-that-are-logged-in-elmah", "title": "Change server variable values that are logged in Elmah", "body": "<p>I configured Elmah in my application and when I looked at the error logs I saw that  in the User section Elmah logged an ID instead of the current logged in username a shown below.</p>\n\n<p>I was wondering if there is a place where I can change how the values of these server variables are set so I can put say an email or proper username in the Auth_User variable..Looking at Elmah documentation I was only able to figure out how to filter out Error logging but not actually how to update server variable values before logging.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q5Xta.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q5Xta.png\" alt=\"Elmah\"></a></p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 1, "creation_date": 1562789433, "post_id": 56977902, "comment_id": 100491953, "body": "If you\u2019re just looking for a quick solution, you could use LINQ for this: <code>arr.OrderBy(x =&gt; x &gt; 0).ToArray()</code>"}, {"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "reply_to_user": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1562790026, "post_id": 56977902, "comment_id": 100492189, "body": "@poke Actually you&#39;d want <code>x &gt;= 0</code> so that 0 isn&#39;t mixed in with the negatives."}, {"owner": {"reputation": 7, "user_id": 11757153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d881d073d5fed129b97b37cd53df993?s=128&d=identicon&r=PG&f=1", "display_name": "SirenC", "link": "https://stackoverflow.com/users/11757153/sirenc"}, "reply_to_user": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1562791353, "post_id": 56977902, "comment_id": 100492721, "body": "@poke Actually I&#39;m not expecting them in the order. I think the question is to keep the original sequence of the positive numbers. Because 4 appears before 6 in the previous array"}, {"owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1562791423, "post_id": 56977902, "comment_id": 100492757, "body": "@SirenC The LINQ solution does keep the original order and only sorts by whether a number is positive or negative."}, {"owner": {"reputation": 7, "user_id": 11757153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d881d073d5fed129b97b37cd53df993?s=128&d=identicon&r=PG&f=1", "display_name": "SirenC", "link": "https://stackoverflow.com/users/11757153/sirenc"}, "reply_to_user": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1562869089, "post_id": 56977902, "comment_id": 100524539, "body": "@Poke thanks for the hint, i do have a LINQ class tomorrow, i will try it~"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11757153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d881d073d5fed129b97b37cd53df993?s=128&d=identicon&r=PG&f=1", "display_name": "SirenC", "link": "https://stackoverflow.com/users/11757153/sirenc"}, "edited": false, "score": 0, "creation_date": 1562790730, "post_id": 56978206, "comment_id": 100492465, "body": "Actually I&#39;m not expecting them in the order. I think the question is to keep the original sequence of the positive numbers. Because 4 appears before 6"}], "tags": [], "owner": {"reputation": 7677, "user_id": 649922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6018c4ebb37ea82122c941aeaaab3b4b?s=128&d=identicon&r=PG", "display_name": "Ortiga", "link": "https://stackoverflow.com/users/649922/ortiga"}, "is_accepted": false, "score": -1, "last_activity_date": 1562790652, "creation_date": 1562790652, "answer_id": 56978206, "question_id": 56977902, "link": "https://stackoverflow.com/questions/56977902/move-negative-numbers-to-the-left-first-come-fist-list/56978206#56978206", "title": "Move Negative Numbers to the left, first come fist list", "body": "<p>Before the last iteration, the array is in this state:</p>\n\n<blockquote>\n  <p>{ -4, -7, -2, 4, 1, 6, -9} </p>\n</blockquote>\n\n<p>You algorithm then swaps -9 and 4:</p>\n\n<blockquote>\n  <p>{ -4, -7, -2, <strong>-9</strong>, 1, 6, <strong>4</strong>} </p>\n</blockquote>\n\n<p>Why would you expect 6 to be the last number in the array?</p>\n\n<p>If you want numbers to be ordered, C# provides an <code>.OrderBy</code> extension method, but that would also change the order of the negative numbers.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 11757153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d881d073d5fed129b97b37cd53df993?s=128&d=identicon&r=PG&f=1", "display_name": "SirenC", "link": "https://stackoverflow.com/users/11757153/sirenc"}, "edited": false, "score": 0, "creation_date": 1562869319, "post_id": 56978438, "comment_id": 100524653, "body": "Thanks! It does make it simple."}], "tags": [], "owner": {"reputation": 714, "user_id": 2929192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62523d07eaa4f1efae63ff8fe409419b?s=128&d=identicon&r=PG&f=1", "display_name": "tgralex", "link": "https://stackoverflow.com/users/2929192/tgralex"}, "is_accepted": false, "score": 0, "last_activity_date": 1562791743, "creation_date": 1562791743, "answer_id": 56978438, "question_id": 56977902, "link": "https://stackoverflow.com/questions/56977902/move-negative-numbers-to-the-left-first-come-fist-list/56978438#56978438", "title": "Move Negative Numbers to the left, first come fist list", "body": "<p>Wouldn't it be simpler to use LINQ?\nHere is the code which does what you need using LINQ:</p>\n\n<pre><code>var list = new[]{ 1, -4, -7, 4, -2, 6, -9 };\nvar newList = list.Where(x =&gt; x &lt; 0).Union(list.Where(x =&gt; x &gt;= 0)).ToList();\nConsole.WriteLine(string.Join(\", \", newList));\n</code></pre>\n\n<p>Output: </p>\n\n<pre><code>-4, -7, -2, -9, 1, 4, 6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1562793656, "last_edit_date": 1562793656, "creation_date": 1562792999, "answer_id": 56978685, "question_id": 56977902, "link": "https://stackoverflow.com/questions/56977902/move-negative-numbers-to-the-left-first-come-fist-list/56978685#56978685", "title": "Move Negative Numbers to the left, first come fist list", "body": "<p>It looks like the problem is that the code is always swapping a negative number with the number that's in the position where the negative number should go. This becomes a problem when there are a few positive numbers in a row, because the order is disturbed when a positive number in a low index is swapped with a negative number in a high index. This happens when <code>i</code> is <code>4</code> and <code>-2</code> is swapped with <code>1</code> (so at that moment the array looks like <code>{ -4, -7, -2, 4, 1, 6, -9 }</code>); and again when <code>i</code> is <code>6</code> and <code>-9</code> gets swapped with <code>4</code>, which leaves you with the result that prompted your question.</p>\n\n<p>To resolve this, you have to swap the negative number with the number before it in an inner loop, until the number before it is also negative, so that the numbers retain their relative positioning:</p>\n\n<pre><code>static void Rearrange(int[] arr)\n{\n    // Start at index 1 since the first item can't move left\n    for (int i = 1; i &lt; arr.Length; i++)\n    {\n        if (arr[i] &lt; 0)\n        {\n            // Walk backwards from the current index, swapping items as we\n            // go, until the item in the previous index is also negative\n            for (int j = i; j &gt; 0; j--)\n            {\n                // If previous item is negative, we can stop\n                if (arr[j - 1] &lt; 0) break;\n\n                // Otherwise, swap this item with the previous item\n                int temp = arr[j];\n                arr[j] = arr[j - 1];\n                arr[j - 1] = temp;\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11757153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d881d073d5fed129b97b37cd53df993?s=128&d=identicon&r=PG&f=1", "display_name": "SirenC", "link": "https://stackoverflow.com/users/11757153/sirenc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562793656, "creation_date": 1562789183, "last_edit_date": 1562790758, "question_id": 56977902, "link": "https://stackoverflow.com/questions/56977902/move-negative-numbers-to-the-left-first-come-fist-list", "title": "Move Negative Numbers to the left, first come fist list", "body": "<p>I'm trying to move negative numbers to the left.</p>\n\n<pre><code>using System;\n\nclass Class1\n{\n    static void rearrange(int[] arr, int n)\n    {\n\n        int j = 0, temp;\n        for (int i = 0; i &lt; n; i++)\n        {\n            if (arr[i] &lt; 0)\n            {\n                temp = arr[i];\n                arr[i] = arr[j];\n                arr[j] = temp;\n                j++;     \n            }\n        }\n    }\n\n    static void printArray(int[] arr, int n)\n    {\n        for (int i = 0; i &lt; n; i++)\n            Console.Write(arr[i] + \",\");\n    }\n\n//Call the Method\n    public static void Main()\n    {\n        int[] arr = { 1, -4, -7, 4, -2, 6, -9 };\n        int n = arr.Length;\n        rearrange(arr, n);\n        printArray(arr, n);\n    }\n}\n</code></pre>\n\n<p>The question expects the output  {  -4, -7,  -2,  -9, 1, 4, 6 }\nBut my output is {  -4, -7,  -2,  -9, 1, 6, 4 }, because the code is to switch -9 with 4. \nHow to adjust the code? </p>\n"}, {"tags": ["c#", "asp.net-mvc", "typescript", "kendo-contextmenu"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9778083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bnF1UrcVXi8/AAAAAAAAAAI/AAAAAAAAAAc/hh9TDTin0_k/photo.jpg?sz=128", "display_name": "Khushbu Patel", "link": "https://stackoverflow.com/users/9778083/khushbu-patel"}, "edited": false, "score": 0, "creation_date": 1562856200, "post_id": 56983317, "comment_id": 100518164, "body": "How can I add dynamic options here"}, {"owner": {"reputation": 1559, "user_id": 4944034, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZuhDy.jpg?s=128&g=1", "display_name": "Carsten Franke", "link": "https://stackoverflow.com/users/4944034/carsten-franke"}, "reply_to_user": {"reputation": 1, "user_id": 9778083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bnF1UrcVXi8/AAAAAAAAAAI/AAAAAAAAAAc/hh9TDTin0_k/photo.jpg?sz=128", "display_name": "Khushbu Patel", "link": "https://stackoverflow.com/users/9778083/khushbu-patel"}, "edited": false, "score": 0, "creation_date": 1562867484, "post_id": 56983317, "comment_id": 100523891, "body": "The <code>datasource</code> is a simple JavaScript array with objects in it. All you have to do, is to add or omit some entries depending on your conditions."}], "tags": [], "owner": {"reputation": 1559, "user_id": 4944034, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZuhDy.jpg?s=128&g=1", "display_name": "Carsten Franke", "link": "https://stackoverflow.com/users/4944034/carsten-franke"}, "is_accepted": false, "score": 0, "last_activity_date": 1562828189, "creation_date": 1562828189, "answer_id": 56983317, "question_id": 56977832, "link": "https://stackoverflow.com/questions/56977832/how-can-i-configure-dynamic-sub-menu-options-for-a-static-menu/56983317#56983317", "title": "How can I configure dynamic sub menu options for a static menu", "body": "<p>I've solved it by creating the datasource of the context menu completely dynamically. Whenever the <code>open</code>-event occurs (<a href=\"https://docs.telerik.com/kendo-ui/api/javascript/ui/menu/events/open\" rel=\"nofollow noreferrer\">https://docs.telerik.com/kendo-ui/api/javascript/ui/menu/events/open</a>), I set the datasource.</p>\n\n\n\n<pre><code>function contextMenuOpen(e) {\n    // Ugly check to test if the context menu has been opened - not sure if it is still required\n    if (e.item.length) {\n        this.setOptions({\n            dataSource: [\n                { text: \"@Html.Raw(Resources.BtnEdit)\", enabled: !someVar },\n                { text: \"@Html.Raw(Resources.BtnDownload)\" },\n                { text: \"@Html.Raw(Resources.BtnRename)\", enabled: !someVar },\n                { text: \"@Html.Raw(Resources.BtnDelete)\" },\n            ]\n        });\n    }\n}\n</code></pre>\n\n<p>This way you can combine your static content with the dynamic one.</p>\n"}], "owner": {"reputation": 1, "user_id": 9778083, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bnF1UrcVXi8/AAAAAAAAAAI/AAAAAAAAAAc/hh9TDTin0_k/photo.jpg?sz=128", "display_name": "Khushbu Patel", "link": "https://stackoverflow.com/users/9778083/khushbu-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562828189, "creation_date": 1562788835, "last_edit_date": 1562789058, "question_id": 56977832, "link": "https://stackoverflow.com/questions/56977832/how-can-i-configure-dynamic-sub-menu-options-for-a-static-menu", "title": "How can I configure dynamic sub menu options for a static menu", "body": "<p>I have a kendo context menu that is configured to be displayed whenever a right-click occurs on the items in the kendo listview. Within the context menu, I want some of the options to have submenu options which have to be loaded dynamically as they differ based on which item of the listview is clicked on. I have configured the ajax call that returns the required data.\nThe issue is, I am not able to figure out, how can I assign these options to the submenu, so that when the submenu is expanded the dynamic options are loaded.</p>\n\n<p>I have the kendo context menu created in the typescript file associated with the cshtml file. I tried adding the open event to the kendo context menu, inside which I created the datasoure, when the ajax call is completed and then I created the kendo context menu. Drawback- it replaces the old menu and does not serve the requirement of loading the submenu options.\nOther thing I tried was, adding the logic in the select event of the context menu that does something similar, but that did not do much</p>\n\n<p>Context menu code:</p>\n\n<pre><code>&lt;ul id=\"ContextMenu\" style=\"display:none\"&gt;\n  &lt;li&gt;&lt;i class=\"far fa-trash-alt fa-fw\"&gt;&lt;/i&gt; Delete&lt;/li&gt;\n  &lt;li&gt;&lt;i class=\"fas fa-minus fa-fw\"&gt;&lt;/i&gt;Stop&lt;/li&gt;\n  &lt;li class=\"inc\"&gt;\n    &lt;i class=\"fas fa-arrow-up fa-fw\"&gt;&lt;/i&gt;Increase\n    &lt;ul&gt;&lt;/ul&gt;\n  &lt;/li&gt;\n  &lt;li class=\"dec\"&gt;\n    &lt;i class=\"fas fa-arrow-down fa-fw\"&gt;&lt;/i&gt;Decrease\n    &lt;ul&gt;&lt;/ul&gt;\n  &lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n\n<p>Typescript file, kendo context menu creation:</p>\n\n<pre><code>$('#listView').on('mousedown', '.product', null, (e: JQueryEventObject) =&gt; {\n\n    $(\"#ContextMenu\").kendoContextMenu({\n        target: \"#listView\",\n        filter: \".item\",\n        select: (e: kendo.ui.ContextMenuSelectEvent) =&gt; {\n\n            if (e.item.textContent.trim() == \"Increase\") {\n                //Ajax call here \n                //If the ajax call succeeds \n                //I created the dynamic datasoure\n                var ds = [{\n                    text: \"Increase\",\n                    items: [{\n                        text: name\n                    }]\n                }];\n\n\n                $(\"#lvPrescribedContextMenu\").kendoContextMenu({\n                    target: \"#listView\",\n                    filter: \".item\",\n                    dataSource: ds\n                });\n</code></pre>\n\n<p>I will expect the context menu to load the static options when it opens and then when the option with submenu options is either hovered over or clicked \non, it should show the dynamic options.</p>\n"}, {"tags": ["c#", "windows-forms-designer"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1562790121, "post_id": 56977759, "comment_id": 100492228, "body": "<code>the second column always contains strings that can be converted to integers</code>  DGV columns are typed - use a column of integers <i>or</i> a Custom Sorter that used a Natural Sort.  Gobs of docs and posts on both topics"}], "answers": [{"tags": [], "owner": {"reputation": 2497, "user_id": 11604722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GA67aL2m6Yc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzsybeEEYKZhZwTKe-Q9-Y-M4e6A/mo/photo.jpg?sz=128", "display_name": "Joshua Robinson", "link": "https://stackoverflow.com/users/11604722/joshua-robinson"}, "is_accepted": true, "score": 2, "last_activity_date": 1562792227, "last_edit_date": 1562792227, "creation_date": 1562791470, "answer_id": 56978377, "question_id": 56977759, "link": "https://stackoverflow.com/questions/56977759/cant-sort-c-datagridview-column-as-integers/56978377#56978377", "title": "Can&#39;t sort C# DataGridView column as integers", "body": "<p>You never show where you're creating the <code>DataTable</code> that you're binding to (<code>dsComponentes.Tables[\"Queue\"]</code>), but when you add that column you should be able to indicate that it's an <code>int</code>.</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>var dataTable = new DataTable();\ndataTable.Columns.Add(\"ColumnName\", typeof(int));\n</code></pre>\n\n<p>This will cause the bound <code>DataGridView</code> to sort that column as integers.</p>\n\n<p>It looks like there is a <code>DataType</code> in the Columns Collection Editor as well, if you're using the designer to create your <code>DataSet</code>. You can set the type to <code>System.Int32</code> on that column and it will sort as you expect.</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>using System;\nusing System.Collections.Generic;\nusing System.Data;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace WindowsFormsApp1\n{\n   static class Program\n   {\n      /// &lt;summary&gt;\n      /// The main entry point for the application.\n      /// &lt;/summary&gt;\n      [STAThread]\n      static void Main()\n      {\n         Application.EnableVisualStyles();\n         Application.SetCompatibleTextRenderingDefault(false);\n\n         var frm = new Form()\n         {\n            Text = \"Data Grid View Form\",\n            Name = \"DataGridViewForm\",\n            Size = new System.Drawing.Size(400, 400)\n         };\n         var dataGridView1 = new DataGridView();\n\n         var dataTable = new DataTable();\n         dataGridView1.DataSource = dataTable;\n         dataGridView1.Dock = DockStyle.Fill;\n\n         dataTable.Columns.Add(\"Id\", typeof(int));\n         dataTable.Columns.Add(\"IdAsString\", typeof(string));\n         var r1 = dataTable.NewRow();\n         r1[\"Id\"] = 1;\n         r1[\"IdAsString\"] = \"1\";\n         dataTable.Rows.Add(r1);\n\n         var r2 = dataTable.NewRow();\n         r2[\"Id\"] = 11;\n         r2[\"IdAsString\"] = \"11\";\n         dataTable.Rows.Add(r2);\n\n         var r3 = dataTable.NewRow();\n         r3[\"Id\"] = 2;\n         r3[\"IdAsString\"] = \"2\";\n         dataTable.Rows.Add(r3);\n\n         var r4 = dataTable.NewRow();\n         r4[\"Id\"] = 22;\n         r4[\"IdAsString\"] = \"22\";\n         dataTable.Rows.Add(r4);\n\n         frm.Controls.Add(dataGridView1);\n\n         Application.Run(frm);\n      }\n   }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23543, "user_id": 2281790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/pP0ow.jpg?s=128&g=1", "display_name": "Harald Coppoolse", "link": "https://stackoverflow.com/users/2281790/harald-coppoolse"}, "is_accepted": false, "score": 1, "last_activity_date": 1562793868, "creation_date": 1562793868, "answer_id": 56978856, "question_id": 56977759, "link": "https://stackoverflow.com/questions/56977759/cant-sort-c-datagridview-column-as-integers/56978856#56978856", "title": "Can&#39;t sort C# DataGridView column as integers", "body": "<p>The easiest method would be to use a nuget package: <a href=\"https://github.com/waynebloss/BindingListView\" rel=\"nofollow noreferrer\">Equin ApplicationFramework BindingListView</a></p>\n\n<p>It is very similar to a standard .net BindingList, except that it contains functions to sort.</p>\n\n<ul>\n<li>Import the BindingListView nuget into your project</li>\n<li>Use Visual Studio designer to create your form</li>\n<li>Use the toolbox to add a BindingSource to your form</li>\n<li>Go to the properties of this BindingSource, select DataSource, Add Project Data Source, select Object and add the class of items that you want to show in your DataGridView</li>\n<li>Now use the toolbox to add your DataGridView</li>\n<li>In the properties of the DataGridView choose the BindingSource as the datasource.</li>\n</ul>\n\n<p>Now all public properties of your class will be shown as column in the DataGridView. Edit the columns accordingly: remove the columns that you won't use.</p>\n\n<p>In my example I will sort a sequence of Persons:</p>\n\n<pre><code>class Person\n{\n    public int Id {get; set;}\n    public string Name {get; set;}\n    public DateTime BirthDate {get; set;}\n}\n</code></pre>\n\n<p>Go to your Form1 class. We'll add a BindingListView from the nuget package as a member.\nIn the constructor we'll assign this to the bindingsource that is assigned to the DataGridView.</p>\n\n<pre><code>class Form\n{\n    // the BindingListView from the nuget package:\n    private readonly BindingListView&lt;Person&gt; sortableBindingListView;\n\n    // constructor\n    public Form1()\n    {\n        InitializeComponent();\n\n        // make sure there is a Components Container, that will dispose\n        // the components upon disposal of the form\n        if (this.components == null)\n        {\n            this.components = new System.ComponentModel.Container();\n        }\n\n        // construct the sortable BindingListView for Persons:\n        this.sortableBindingListView = new BindingListView&lt;Person&gt;(this.components);\n\n        // create some Persons:\n        var persons = new Person[]\n        {\n            new Person{Id = 1, Name = \"F\", BirthDate = new DateTime(2000, 1, 1)},\n            new Person{Id = 2, Name = \"A\", BirthDate = new DateTime(1998, 4, 7)},\n            new Person{Id = 3, Name = \"C\", BirthDate = new DateTime(2011, 3, 8)},\n            new Person{Id = 4, Name = \"Z\", BirthDate = new DateTime(1997, 2, 3)},\n            new Person{Id = 5, Name = \"K\", BirthDate = new DateTime(2003, 9, 5)},\n        };\n\n        // Assign the DataSources:\n        this.sortableBindingListView.DataSource = persons;\n        this.dataGridView1.DataSource = this.sortableBindingListView;\n    }\n}\n</code></pre>\n\n<p>This is enough to get your sorting working. You don't have to add anything extra. Upon clicking the columns the column is filtered.</p>\n\n<p>Some interesting functions:</p>\n\n<pre><code>private Person SelectedPerson\n{\n    get {return ((ObjectView&lt;Person&gt;)this.SortableBindingSource.Current)?.Object; }\n}\n\nprivate void DisplayPersons (IEnumerable&lt;Person&gt; personsToDisplay)\n{\n    this.SortableBindingSource.DataSource = personsToDisplay.ToList();\n    this.SortableBindingSource.Refresh(); // this will update the DataGridView\n}\n\nprivate IEnumerable&lt;Person&gt; DisplayedPersons\n{\n    get {return this.SortableBindingSource; }\n    // BindingListview&lt;T&gt; implements IEnumerable&lt;T&gt;\n}\n</code></pre>\n\n<p>This is all. You don't need to create special functions to sort on mouse clicks. The sorting will be done automatically inclusive deciding on the sort order and displaying the correct sorting glyphs. </p>\n\n<p>If you want to sort programmatically:</p>\n\n<pre><code>// sort columnPropertyA in descending order:\nthis.SortableBindingSource.Sort(this.columnPropertyA.ListsortDirection.Descending);\n</code></pre>\n\n<p>One of the nice things about the BindingListView is the filtering option:</p>\n\n<pre><code>// show only items where Name not null:\nthis.SortableBindingSource.ApplyFilter(person =&gt; person.Name != null);\n\n// remove the filter:\nthis.SortableBindingSource.RemoveFilter();\n</code></pre>\n\n<p>I'm not sure if a Refresh() is needed after applying or removing a filter.</p>\n"}], "owner": {"reputation": 1454, "user_id": 2414842, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/sjcCk.jpg?s=128&g=1", "display_name": "Fabiotk", "link": "https://stackoverflow.com/users/2414842/fabiotk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 56978377, "answer_count": 2, "score": -1, "last_activity_date": 1562793868, "creation_date": 1562788540, "question_id": 56977759, "link": "https://stackoverflow.com/questions/56977759/cant-sort-c-datagridview-column-as-integers", "title": "Can&#39;t sort C# DataGridView column as integers", "body": "<p>I have a <code>DataGridView gridFilas</code> in my windows form application with two columns and the second column always contains strings that can be converted to integers. When I click to sort it, it is sorted as strings resulting in something like:</p>\n\n<p><code>1, 11, 2, 22</code></p>\n\n<p>But I need it to be sorted as integers, like:</p>\n\n<p><code>1, 2, 11, 22</code></p>\n\n<p>I've already tried all the answers of <a href=\"https://stackoverflow.com/questions/18921470/sorting-numerically-in-a-datagridviewtextboxcolumn\">this question</a> but none worked, btw the accepted answer, it didn't worked because the <code>SortCompare</code> event wasn't being fired because of <a href=\"https://stackoverflow.com/a/1365573/2414842\">this</a>.</p>\n\n<p>So what I've tried so far is adding a <code>ColumnHeaderMouseClick</code> and sort it with:</p>\n\n<pre><code>private void gridFilas_ColumnHeaderMouseClick(object sender, DataGridViewCellMouseEventArgs e)\n{\n\n    // this for loop has been added in a vain hope of converting all elements to integer to see if it works...\n    for (int i = 0; i &lt; gridFilas.Rows.Count; i++)\n    {\n        string v = gridFilas.Rows[i].Cells[1].Value.ToString();\n        gridFilas.Rows[i].Cells[1].Value = Convert.ToInt32(v);\n    }\n\n    if (queuesSortedAscending)\n    {\n        gridFilas.Sort(gridFilas.Columns[\"Tamanho_Fila\"], System.ComponentModel.ListSortDirection.Descending);\n    }\n    else\n    {\n        gridFilas.Sort(gridFilas.Columns[\"Tamanho_Fila\"], System.ComponentModel.ListSortDirection.Ascending);\n    }\n    queuesSortedAscending = !queuesSortedAscending;\n\n}\n</code></pre>\n\n<p>The datasource is set on the creation (the constructor of the <code>Form</code>) with:</p>\n\n<pre><code>dsComponentes = new DataSet();\n// ... more code \ngridFilas.DataSource = dsComponentes.Tables[\"Queue\"];\n</code></pre>\n\n<p>Whenever I add a new line to the DataSource I assure it is parsed to int:</p>\n\n<pre><code>DataRow qlinha = dsComponentes.Tables[\"Queue\"].NewRow();\nqlinha[\"Nome_Fila\"] = process;\nqlinha[\"Tamanho_Fila\"] = Int32.Parse(status);\ndsComponentes.Tables[\"Queue\"].Rows.Add(qlinha);\n</code></pre>\n\n<p>I've also tried changing the data type of the column beforehand:</p>\n\n<pre><code>dsComponentes.Tables[\"Queue\"].Columns[\"Tamanho_Fila\"].DataType = typeof(int);\n</code></pre>\n\n<p>So, I don't know what else to do, I just need to order it as integers not strings. Any solution is welcome.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "asp.net-web-api"], "comments": [{"owner": {"reputation": 348, "user_id": 11605410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed2ff9abd025488a1f376f07da312a9?s=128&d=identicon&r=PG&f=1", "display_name": "TheMikeInNYC", "link": "https://stackoverflow.com/users/11605410/themikeinnyc"}, "edited": false, "score": 1, "creation_date": 1562865780, "post_id": 56977632, "comment_id": 100523077, "body": "i don&#39;t think full stops need to be encoded necessarily but it&#39;s the IIS server that might not handle the full stop the way you intend.  Check this <a href=\"https://stackoverflow.com/questions/20998816/dot-character-in-mvc-web-api-2-for-request-such-as-api-people-staff-45287\" title=\"dot character in mvc web api 2 for request such as api people staff 45287\">stackoverflow.com/questions/20998816/&hellip;</a>"}, {"owner": {"reputation": 2689, "user_id": 651887, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/7120869b34e0c739502318f4f862c26c?s=128&d=identicon&r=PG", "display_name": "rogue39nin", "link": "https://stackoverflow.com/users/651887/rogue39nin"}, "reply_to_user": {"reputation": 348, "user_id": 11605410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed2ff9abd025488a1f376f07da312a9?s=128&d=identicon&r=PG&f=1", "display_name": "TheMikeInNYC", "link": "https://stackoverflow.com/users/11605410/themikeinnyc"}, "edited": false, "score": 0, "creation_date": 1563040009, "post_id": 56977632, "comment_id": 100573334, "body": "@TheMikeInNYC That was the reason once I put it in my web config it worked but just to be safe i turned it into query string as they are considered safe as well its for a phone app thats only internall so didnt matter if was a segment or a query string."}], "owner": {"reputation": 2689, "user_id": 651887, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/7120869b34e0c739502318f4f862c26c?s=128&d=identicon&r=PG", "display_name": "rogue39nin", "link": "https://stackoverflow.com/users/651887/rogue39nin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562787830, "creation_date": 1562787830, "question_id": 56977632, "link": "https://stackoverflow.com/questions/56977632/product-code-causing-web-mvc-api-call-to-fail", "title": "Product code causing web mvc api call to fail", "body": "<p>I am using mvc5 web API to power a mobile app in xamrian, for the most part, the web API calls work 100% however today I came across a situation that where there was a full stop in the product code caused the call to the web API to fail.</p>\n\n<p>But today I had a product code like this TFNT1116.5  and the API call failed.</p>\n\n<pre><code>public async Task&lt;StockWarehouseInfoBins&gt; GetWarehouseBinsInformaiton(string ItemCode, string WarehouseName)\n{\n\n        List&lt;StockWarehouseInfoBins&gt; _result = new List&lt;StockWarehouseInfoBins&gt;();\n\n        var uri = new Uri(string.Format(BaseUrl + Constants.BinDetails + ItemCode.Trim(), string.Empty));\n\n        var response = await _client.GetAsync(uri);\n        if (response.IsSuccessStatusCode)\n        {\n            var byteArray = await response.Content.ReadAsByteArrayAsync();\n\n            var content = Encoding.UTF8.GetString(byteArray, 0, byteArray.Length);\n            _result = JsonConvert.DeserializeObject&lt;List&lt;StockWarehouseInfoBins&gt;&gt;(content);\n        }\n\n        return _result.FirstOrDefault();\n\n}\n</code></pre>\n\n<p>My Client is a singleton of an HTTP client class.</p>\n\n<pre><code>HttpClient _client;\n</code></pre>\n\n<p>I think the problem is to do with the full stop in the product code.</p>\n\n<p>This is the call that it gets to in my MVC controller.</p>\n\n<pre><code>[HttpGet]\n// GET: Warhouses/Details/5\npublic ActionResult BinDetails(string id)\n{\n\n   List&lt;StockWarehouseInfoBins&gt; result = new List&lt;StockWarehouseInfoBins&gt;();\n\n   result = database.GetWarehouseDetails(id);\n   return Json(result, JsonRequestBehavior.AllowGet);\n}\n</code></pre>\n\n<p>And this is my route information. When I test the call without product codes without full stops in them it works as expected and returns the correct JSON data.</p>\n\n<pre><code>public static void RegisterRoutes(RouteCollection routes)\n{\n        routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\n        routes.MapRoute(\n            name: \"Default\",\n            url: \"{controller}/{action}/{id}\",\n            defaults: new { controller = \"Home\", action = \"Index\", id = UrlParameter.Optional }\n        );\n    }\n</code></pre>\n\n<p>This is my class here.</p>\n\n<pre><code> public class StockWarehouseInfoBins\n {\n    public StockWarehouseInfoBins();\n    public long? BinItemID { get; set; }\n    public string BinName { get; set; }\n    public long? WarehouseItemID { get; set; }\n    public long? WarehouseID { get; set; }\n    public string WarehouseName { get; set; }\n    public decimal ConfirmedQtyInStock { get; set; }\n    public decimal QuantityReserved { get; set; }\n    public decimal QuantityAllocatedBOM { get; set; }\n    public decimal QuantityAllocatedSOP { get; set; }\n    public decimal QuantityAllocatedStock { get; set; }\n }\n</code></pre>\n\n<p>I am calling the above in a async method. Which bininfo is getting null when the full stop is encourted.</p>\n\n<pre><code> StockWarehouseInfoBins binInfo = new StockWarehouseInfoBins();\n binInfo = await restServices.GetWarehouseBinsInformaiton(lblstockCode.Text, SouceWarehouseName);\n</code></pre>\n\n<p>I presume I need to URL encode the API calls but is there a way to do this on the HTTP client so I don't need to change every call?  </p>\n"}, {"tags": ["c#", "asp.net", "hangfire"], "comments": [{"owner": {"reputation": 3891, "user_id": 9456781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zdM55.jpg?s=128&g=1", "display_name": "Tobias Tengler", "link": "https://stackoverflow.com/users/9456781/tobias-tengler"}, "edited": false, "score": 1, "creation_date": 1562788469, "post_id": 56977626, "comment_id": 100491602, "body": "This code is correct as it is, I don&#39;t think the issue is related to this snippet. Maybe check out <a href=\"https://docs.hangfire.io/en/latest/getting-started/aspnet-applications.html\" rel=\"nofollow noreferrer\">this</a> and make sure that you set it up the same way in your code."}, {"owner": {"reputation": 26197, "user_id": 201303, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/AQoqr.jpg?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/201303/julian"}, "edited": false, "score": 0, "creation_date": 1562791142, "post_id": 56977626, "comment_id": 100492621, "body": "What&#39;s the hangfire version?"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1562796146, "post_id": 56977626, "comment_id": 100494291, "body": "Since your posted code has invalid quote characters, please double-check and post the <i>exact</i> code you are using."}], "answers": [{"tags": [], "owner": {"reputation": 714, "user_id": 2929192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62523d07eaa4f1efae63ff8fe409419b?s=128&d=identicon&r=PG&f=1", "display_name": "tgralex", "link": "https://stackoverflow.com/users/2929192/tgralex"}, "is_accepted": false, "score": 0, "last_activity_date": 1562791989, "creation_date": 1562791989, "answer_id": 56978475, "question_id": 56977626, "link": "https://stackoverflow.com/questions/56977626/cannot-convert-lambda-expression-to-type-system-linq-expressions-expressionsys/56978475#56978475", "title": "Cannot convert lambda expression to type \u2018System.Linq.Expressions.Expression&lt;System.Action&gt;\u2019 because it is not a delegate type. error in hangfire", "body": "<p>Try replacing this:</p>\n\n<pre><code>RecurringJob.AddOrUpdate(() =&gt; Console.WriteLine(\u201cHello\u201d), Cron.Minutely());\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>var action = () =&gt; Console.WriteLine(\u201cHello\u201d), Cron.Minutely();\nRecurringJob.AddOrUpdate(action);\n</code></pre>\n\n<p>I've seen those problems when applying directly.</p>\n"}], "owner": {"reputation": 10, "user_id": 11083346, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Q_xASddpJ70/AAAAAAAAAAI/AAAAAAAAAAU/Gw7l0X4aXJw/photo.jpg?sz=128", "display_name": "Rahul Rathaur", "link": "https://stackoverflow.com/users/11083346/rahul-rathaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562791989, "creation_date": 1562787810, "last_edit_date": 1562790410, "question_id": 56977626, "link": "https://stackoverflow.com/questions/56977626/cannot-convert-lambda-expression-to-type-system-linq-expressions-expressionsys", "title": "Cannot convert lambda expression to type \u2018System.Linq.Expressions.Expression&lt;System.Action&gt;\u2019 because it is not a delegate type. error in hangfire", "body": "<pre><code>public void Configuration(IAppBuilder app)\n{\n    GlobalConfiguration.Configuration.UseSqlServerStorage(\u201csqlcn\u201d);\n\n    RecurringJob.AddOrUpdate(() =&gt; Console.WriteLine(\u201cHello\u201d), Cron.Minutely());\n\n    app.UseHangfireDashboard();\n    app.UseHangfireServer();\n}\n</code></pre>\n\n<p>In this code, I have this error:-\nCannot convert lambda expression to type <code>System.Linq.Expressions.Expression&lt;System.Action&gt;</code> because it is not a delegate type.\nPlease Help Me.!</p>\n"}, {"tags": ["c#", "wpf", "formatting", "richtextbox"], "answers": [{"comments": [{"owner": {"reputation": 172, "user_id": 6695444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OizpK.jpg?s=128&g=1", "display_name": "botiapa", "link": "https://stackoverflow.com/users/6695444/botiapa"}, "edited": false, "score": 0, "creation_date": 1562916874, "post_id": 56980398, "comment_id": 100537496, "body": "Thanks for the link and the info. I&#39;ve been working on this in the past day or so, and I just can&#39;t figure out how I should combine and split all the ranges. Should I like add all the bold ranges and italic ranges into a different list and use those or what? (Also I forgot to add that I also have to handle underline) And also can&#39;t I use the richtextbox&#39;s method that automatically generates the style depending on user input? (CTRL+B, CTRL+U etc.)"}, {"owner": {"reputation": 172, "user_id": 6695444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OizpK.jpg?s=128&g=1", "display_name": "botiapa", "link": "https://stackoverflow.com/users/6695444/botiapa"}, "edited": false, "score": 0, "creation_date": 1562968477, "post_id": 56980398, "comment_id": 100560803, "body": "I tried doing your first idea and it kinda worked, and I believe I might be able to get it working correctly. Thanks again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3188639"}, "reply_to_user": {"reputation": 172, "user_id": 6695444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OizpK.jpg?s=128&g=1", "display_name": "botiapa", "link": "https://stackoverflow.com/users/6695444/botiapa"}, "edited": false, "score": 0, "creation_date": 1562968679, "post_id": 56980398, "comment_id": 100560836, "body": "Great. The other one should also work and it might be a bit faster and use less memory."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3188639"}, "is_accepted": false, "score": 1, "last_activity_date": 1562967035, "last_edit_date": 1562967035, "creation_date": 1562807088, "answer_id": 56980398, "question_id": 56977585, "link": "https://stackoverflow.com/questions/56977585/how-to-format-a-richtextbox-with-existing-contents/56980398#56980398", "title": "How to format a RichTextBox with existing contents", "body": "<p>I don't think you can overlap Runs/Spans like this, you'll have to find all the breaking points in your text and format each text range separately. It's similar to HTML, where</p>\n\n<pre><code>&lt;bold&gt;some&lt;italic&gt; bold italic&lt;/bold&gt; and other &lt;/italic&gt; text.\n</code></pre>\n\n<p>is not valid. In your case, you'll have a bold from (5,10), bolditalic from (11, 15) etc.</p>\n\n<p>It's probably useful to find some kind of <code>Range</code> class with methods to combine ranges, split, find overlaps, etc. A while ago I started with <a href=\"https://www.codeproject.com/Articles/19028/Building-a-Generic-Range-class\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p>EDIT: I don't exactly have an idea how to implement all this (last time I did something similar was almost 10 years ago), but you can try something like this:</p>\n\n<ol>\n<li>Create a <code>List&lt;Range&lt;int&gt;&gt;</code>. Initially it contains a single Range(0, length of text).</li>\n<li>Load the first style, create a new Range with start/end offset. Overlap (or whatever method is appropriate) this range with the range in the list. This should give you 3 ranges, something like <code>(0, start of style), (start of style, end of style), (end of style, end of text)</code>. Remove old range from the list and add new ones.</li>\n<li>Load the next, find overlaps, with the ranges in the list, delete the ones that are overlapped and add new ranges.</li>\n<li>This should give you a list of nonoverlapping ranges.</li>\n<li>Now, for the styles. You can create a kind of stylesheet class. This class can use the <code>FontWeights, FontStyles</code> and other enums, defined in <code>System.Windows</code>. Modify a list, so that it contains, for example, <code>List&lt;Tuple&lt;int, Stylesheet&gt;&gt;</code>. To calculate overlaps just use the first param in the Tuple.</li>\n<li>Before you remove old ranges from the list, combine the styles.  </li>\n<li>This should give you a list of nonoverlapped regions, with the appropriate styles. Create <code>TextRange</code>s, apply styles</li>\n</ol>\n\n<p>Other idea that might work:</p>\n\n<ol>\n<li>Again, create a stylesheet. Initially it should be normal weighy, normal style, default font size etc.</li>\n<li>Find the next offset from the input (the first one that is larger than the current), create a <code>TextRange</code> and apply a style.</li>\n<li>Find the next offset from the input, modify current (and only) style and apply.</li>\n</ol>\n\n<p>If I remember correctly, inserting style definition in the text also counts as characters, so you might need to adjust offsets when you insert style tags in the final text. Also, I believe it is doable just using <code>TextBlock</code>.</p>\n\n<p>As I said, I don't know if this works like described, but this might give you and idea. </p>\n"}, {"tags": [], "owner": {"reputation": 172, "user_id": 6695444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OizpK.jpg?s=128&g=1", "display_name": "botiapa", "link": "https://stackoverflow.com/users/6695444/botiapa"}, "is_accepted": false, "score": 0, "last_activity_date": 1562965522, "creation_date": 1562965522, "answer_id": 57014040, "question_id": 56977585, "link": "https://stackoverflow.com/questions/56977585/how-to-format-a-richtextbox-with-existing-contents/57014040#57014040", "title": "How to format a RichTextBox with existing contents", "body": "<p>My current solution is that I go through every character one by one and scan through the ranges detecting if the current character is in any of them and then assigning a span to the character. This is <strong>not</strong> ideal at all, but it gets the job done. I'll try to implement an actual algorithm for this later. Until then, if you have <em>any</em> information that could help, please comment. </p>\n\n<p>If anyone needs sample code of my current implementation I'd happily share it with you. (Even though it's not really efficient at all)</p>\n"}], "owner": {"reputation": 172, "user_id": 6695444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OizpK.jpg?s=128&g=1", "display_name": "botiapa", "link": "https://stackoverflow.com/users/6695444/botiapa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1562967035, "creation_date": 1562787608, "last_edit_date": 1562794242, "question_id": 56977585, "link": "https://stackoverflow.com/questions/56977585/how-to-format-a-richtextbox-with-existing-contents", "title": "How to format a RichTextBox with existing contents", "body": "<p>I'm getting data from a web API that returns text, and formatting information. The formatting data only includes the type of formatting (bold, italic, etc.) and the range of that formatting. The main problem with this is, that two ranges can \"collide\" (for example the first 3 characters of a word are bold and italic but the last 3 characters are only italic). Example response </p>\n\n<pre><code>{\n  \"text\" : \"This is an example text\",\n  \"inlineStyles\" : [\n    {\n      \"offsetFromStart\" : 5,\n      \"length\" : 10,\n      \"type\" : \"bold\"\n    }\n    {\n      \"offsetFromStart\" : 10,\n      \"length\" : 10,\n      \"type\" : \"italic\"\n    }\n  ]\n}\n</code></pre>\n\n<p>I already tried doing this with a simple TextBlock and failed. And I also tried this with a RichTextBox but when I added a Span I couldn't insert it into its original position. I also tought about formatting each character with its own span or run but that would be very ugly and in general just a bad solution. (My main concern is speed..)</p>\n\n<pre><code>var tb = new RichTextBox();\nvar para = new Paragraph();\npara.Inlines.Add(\"This is an example text\") // Text parsed from the response\n\nvar startingPointer1 = para.ContentStart.GetPositionAtOffset(5);\nvar sp1 = new Span(startingPointer1, startingPointer1.GetPositionAtOffset(10));\nsp1.FontWeight = FontWeights.Bold;\n\nvar startingPointer2 = para.ContentStart.GetPositionAtOffset(10);\nvar sp2 = new Span(startingPointer2 , startingPointer2 .GetPositionAtOffset(10));\nsp2.FontStyle= FontStyles.Italic;\n\npara.Inlines.Add(sp1);\npara.Inlines.Add(sp2);\ntb.Document.Blocks.Add(para);\n</code></pre>\n\n<p>This code appends it to the end and when combining multiple inline elements like in my example it doesn't work at all (because of the first problem.)</p>\n\n<p>Example result: <a href=\"https://i.stack.imgur.com/Nbtfm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nbtfm.png\" alt=\"example image\"></a></p>\n"}, {"tags": ["c#", "microsoft-dynamics"], "comments": [{"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1562787378, "post_id": 56977490, "comment_id": 100491133, "body": "Are you trying to compile decompiled code?"}, {"owner": {"reputation": 101, "user_id": 9133143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543687cd7059fbb8688867c187ab74bb?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/9133143/josh"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1562787531, "post_id": 56977490, "comment_id": 100491196, "body": "I did decompile some code from an existing DLL but I was able to make this compile with a different version of this library."}, {"owner": {"reputation": 101, "user_id": 9133143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543687cd7059fbb8688867c187ab74bb?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/9133143/josh"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1562790597, "post_id": 56977490, "comment_id": 100492417, "body": "@CodeCaster I do not understand how this is a duplicate because the code worked before. Why would I need to change the code now to work? Thanks!"}, {"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 1, "creation_date": 1562791364, "post_id": 56977490, "comment_id": 100492729, "body": "Because the original code is <code>entity.LogicalName</code>, but you decompiled that and now are trying to compile <code>entity.get_LogicalName()</code>, which isn&#39;t valid C# for a property accessor. Change it to the former."}], "owner": {"reputation": 101, "user_id": 9133143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543687cd7059fbb8688867c187ab74bb?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/9133143/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 13, "favorite_count": 0, "closed_date": 1562787427, "answer_count": 0, "score": 0, "last_activity_date": 1562787446, "creation_date": 1562787224, "last_edit_date": 1562787446, "question_id": 56977490, "link": "https://stackoverflow.com/questions/56977490/rcannot-explicitly-call-operator-or-accessor-for-calls-from-included-library", "closed_reason": "Duplicate", "title": "rCannot Explicitly Call Operator or Accessor For Calls From Included Library", "body": "<p>I have imported the package \"Microsoft.Xrm.Sdk.2015 -Version 7.1.0.1085\" using Nuget and I have no errors or warnings that it is not installed. However, code that is referencing the package such as</p>\n\n<p><code>entity.get.LogicalName()</code> in the context of <code>if (entity.get_LogicalName() == \"account\" || entity.get_LogicalName() == \"contact\")</code> gets the error  \"cannot explicitly call operator or accessor.\"</p>\n\n<p>I know this code works because it is actively deployed. I have inherited it and have taken it from a code repo that did not have any resource libraries so they need to be downloaded again. </p>\n\n<p>Any help in resolving this is greatly appreciated. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "microsoft-teams"], "comments": [{"owner": {"reputation": 2590, "user_id": 6639020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-whhL_OMI28g/AAAAAAAAAAI/AAAAAAAAI2Q/lcFD5k2Trk4/photo.jpg?sz=128", "display_name": "Ragavan Rajan", "link": "https://stackoverflow.com/users/6639020/ragavan-rajan"}, "edited": false, "score": 0, "creation_date": 1562791145, "post_id": 56977475, "comment_id": 100492622, "body": "can you take a look at <code>call: updateMetadata</code> <a href=\"https://docs.microsoft.com/en-us/graph/api/call-updatemetadata?view=graph-rest-beta&amp;tabs=javascript\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/graph/api/&hellip;</a>"}, {"owner": {"reputation": 2590, "user_id": 6639020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-whhL_OMI28g/AAAAAAAAAAI/AAAAAAAAI2Q/lcFD5k2Trk4/photo.jpg?sz=128", "display_name": "Ragavan Rajan", "link": "https://stackoverflow.com/users/6639020/ragavan-rajan"}, "edited": false, "score": 0, "creation_date": 1562791198, "post_id": 56977475, "comment_id": 100492649, "body": "It also says <code>All the properties will be returned from an actual call.</code>"}], "owner": {"reputation": 243, "user_id": 2479684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8h5pC.jpg?s=128&g=1", "display_name": "raven-ai", "link": "https://stackoverflow.com/users/2479684/raven-ai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1562787148, "creation_date": 1562787148, "question_id": 56977475, "link": "https://stackoverflow.com/questions/56977475/how-to-acquire-call-information-from-teams-call-in-a-separate-application-in-rea", "title": "How to acquire call information from Teams call in a separate application in real time?", "body": "<p>We're trying to find a way to acquire information about a currently occurring call in Microsoft Teams - Phone number and direction of the call in particular - in a separate C# application. </p>\n\n<p>In other words while a Teams call is active the separate application, running on the user's machine, should be able to capture and log the remote party and direction of the call. </p>\n\n<p>There doesn't seem to be a straight forward way to do this in the Graph API that we've been able to find.</p>\n"}, {"tags": ["c#", "email", "datagridview", "cell", "rows"], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 7667946, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f9fc29466bc93772bc7e90fd2f6d4b1e?s=128&d=identicon&r=PG&f=1", "display_name": "kristech", "link": "https://stackoverflow.com/users/7667946/kristech"}, "is_accepted": false, "score": 0, "last_activity_date": 1562787822, "creation_date": 1562787822, "answer_id": 56977630, "question_id": 56977427, "link": "https://stackoverflow.com/questions/56977427/c-every-row-send-e-mail-to-rows-recipient/56977630#56977630", "title": "C# every row send e-mail to rows recipient", "body": "<p>You need to build the email body string then loop through the emails. I changed your code slightly to do this:</p>\n\n<pre><code>        private void btnSendMail_Click(object sender, EventArgs e)\n        {\n\n\n            DataTable dt = new DataTable();\n            dt.Columns.AddRange(new DataColumn[3] { new DataColumn(\"Id\", typeof(int)),new DataColumn(\"Name\", typeof(string)),\n                    new DataColumn(\"Debt\", typeof(string)),\n                    new DataColumn(\"Email\",typeof(string)) });\n\n            dt.Rows.Add(\"Vasia\", \"130\", \"vasia@mail.com\");\n            dt.Rows.Add(\"Liuda\", \"23\", \"liuda@test.com\");\n            dt.Rows.Add(\"Grisa\", \"2560\", \"grisa@test.com\");\n            GridView1.DataSource = dt;\n\n            string bodyText = BuildStringFromDT(dt);\n\n            foreach (DataRow row in dt.Rows)\n            {\n                string emailId = row[\"Email\"].ToString();\n                SendEmailUsingGmail(emailId, bodyText);\n            }\n\n            //write code to send mail\n\n        }\n        private string BuildStringFromDT(DataTable dt)\n        {\n            List&lt;string&gt; final = new List&lt;string&gt;();\n            foreach (DataRow row in dt.Rows)\n            {\n                List&lt;string&gt; temp = new List&lt;string&gt;();\n                foreach (DataColumn col in dt.Columns)\n                {\n                    temp.Add(row[col.ColumnName].ToString());\n                }\n                final.Add(string.Join(\"\\t\", temp));\n            }\n            return string.Join(\"\\r\\n\", final);\n        }\n        private void SendEmailUsingGmail(string toEmailAddress, string bodyText)\n        {\n            try\n            {\n                MailMessage mail = new MailMessage();\n                SmtpClient SmtpServer = new SmtpClient(\"xxx.xxx.xx\");\n\n                mail.From = new MailAddress(\"xxxxxa@xxxx.ru\");\n                mail.To.Add(toEmailAddress);\n                mail.Subject = \"tgggggg \";\n                mail.Body = bodyText;\n\n                SmtpServer.Port = 25;\n                SmtpServer.Credentials = new System.Net.NetworkCredential(\"xxxxx@xxx.ru\", \"xxxxx\");\n                //SmtpServer.EnableSsl = true;\n\n                SmtpServer.Send(mail);\n                MessageBox.Show(\"Informavimo lai\u0161kas i\u0161si\u0173stas Tiekimo skyriui bei Gamybai\");\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.ToString());\n            }\n        }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25947, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1562827133, "creation_date": 1562827133, "answer_id": 56983008, "question_id": 56977427, "link": "https://stackoverflow.com/questions/56977427/c-every-row-send-e-mail-to-rows-recipient/56983008#56983008", "title": "C# every row send e-mail to rows recipient", "body": "<p>Instead of using a plain text <code>Body</code> property in the code I'd recommend composing an HTML based message body where you can place tables correctly.  </p>\n\n<p>In case you are using <code>System.Net.Mail.MailMessage</code>, you can use:</p>\n\n<pre><code>mail.IsBodyHtml = true;\n</code></pre>\n\n<p>Note the <code>System.Web.Mail.MailMessage</code> is obsolete, but if using it: </p>\n\n<pre><code>mail.BodyFormat\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8614471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c1799285eaa4f68be0f9229a4edbd8?s=128&d=identicon&r=PG", "display_name": "\u0412\u0430\u0434\u0438\u043c", "link": "https://stackoverflow.com/users/8614471/%d0%92%d0%b0%d0%b4%d0%b8%d0%bc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562827133, "creation_date": 1562786911, "question_id": 56977427, "link": "https://stackoverflow.com/questions/56977427/c-every-row-send-e-mail-to-rows-recipient", "title": "C# every row send e-mail to rows recipient", "body": "<p>how to send every cells value from the datagridview rows ?\n<a href=\"https://i.stack.imgur.com/4e9Ls.png\" rel=\"nofollow noreferrer\">Example</a></p>\n\n<p>Example:\nvasia@mail.ru recipient get: \nVasia owed 100 EUR.\nliuda@mailru\nLiuda owed 23 EUR.</p>\n\n<p>my code sent to multi user: </p>\n\n<pre><code> private void btnSendMail_Click(object sender, EventArgs e)\n    {\n\n\n        DataTable dt = new DataTable();\n        dt.Columns.AddRange(new DataColumn[3] { new DataColumn(\"Id\", typeof(int)),new DataColumn(\"Name\", typeof(string)),\n                    new DataColumn(\"Debt\", typeof(string)),\n                    new DataColumn(\"Email\",typeof(string)) });\n\n        dt.Rows.Add(\"Vasia\", \"130\", \"vasia@mail.com\");\n        dt.Rows.Add(\"Liuda\", \"23\", \"liuda@test.com\");\n        dt.Rows.Add(\"Grisa\", \"2560\", \"grisa@test.com\");\n        GridView1.DataSource = dt;\n\n\n        for (int i = 0; i &lt; GridView1.Rows.Count; i++)\n        {\n            string emailId = dt.Rows[i][\"email\"].ToString();\n            SendEmailUsingGmail(emailId);\n        }\n\n        //write code to send mail\n\n    }\n    private void SendEmailUsingGmail(string toEmailAddress)\n    {\n        try\n        {\n            MailMessage mail = new MailMessage();\n            SmtpClient SmtpServer = new SmtpClient(\"xxx.xxx.xx\");\n\n            mail.From = new MailAddress(\"xxxxxa@xxxx.ru\");\n            mail.To.Add(toEmailAddress);\n            mail.Subject = \"tgggggg \";\n            mail.Body = \"A\u0161,  papild\u017eiau plan\u0105 \u0161iais produktais:  PRA\u0160AU PATIKRINKITE PLAN\u0104 !!!\";\n\n            SmtpServer.Port = 25;\n            SmtpServer.Credentials = new System.Net.NetworkCredential(\"xxxxx@xxx.ru\", \"xxxxx\");\n            //SmtpServer.EnableSsl = true;\n\n            SmtpServer.Send(mail);\n            MessageBox.Show(\"Informavimo lai\u0161kas i\u0161si\u0173stas Tiekimo skyriui bei Gamybai\");\n        }\n        catch (Exception ex)\n        {\n            MessageBox.Show(ex.ToString());\n        }\n    }\n</code></pre>\n\n<p>how to send in BODY every cells value from the datagridview rows to each email ???</p>\n"}, {"tags": ["c#", "visual-studio", "sdk", "environment-variables", "gacutil"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 10297199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gw69J.png?s=128&g=1", "display_name": "Andrew Schenck", "link": "https://stackoverflow.com/users/10297199/andrew-schenck"}, "is_accepted": true, "score": 1, "last_activity_date": 1562787740, "creation_date": 1562787740, "answer_id": 56977615, "question_id": 56977345, "link": "https://stackoverflow.com/questions/56977345/how-to-choose-which-gacutil-exe-path-to-set-in-my-environment-variables/56977615#56977615", "title": "How to choose which gacutil.exe path to set in my environment variables?", "body": "<p>It should be safe to use the latest version, and I would recommend using at least v10.0A (4.6.1) since that's what Navigator requires.  Just make sure you don't have paths to tools folders for several versions of .NET as that can lead to some problems during installations if there is a mismatch.</p>\n"}], "owner": {"reputation": 3, "user_id": 9777335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BEbbM.png?s=128&g=1", "display_name": "Bill Casey", "link": "https://stackoverflow.com/users/9777335/bill-casey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 56977615, "answer_count": 1, "score": 0, "last_activity_date": 1562787740, "creation_date": 1562786490, "question_id": 56977345, "link": "https://stackoverflow.com/questions/56977345/how-to-choose-which-gacutil-exe-path-to-set-in-my-environment-variables", "title": "How to choose which gacutil.exe path to set in my environment variables?", "body": "<p>I moved a project from .NET 3.5 to .NET 4.6.1. Now when I try to build (with the following as my post-build event command) I get the this error:</p>\n\n<blockquote>\n<pre><code>gacutil -if \"$(TargetPath)\"\n</code></pre>\n  \n  <p>The command \"gacutil -if \"[xyz.dll]\"\" exited with code 1</p>\n</blockquote>\n\n<p>I referenced this stack overflow answer: <a href=\"https://stackoverflow.com/questions/6656235/gacutil-postbuild-event-exists-with-code-1\">gacutil postbuild event exists with code 1</a></p>\n\n<p>The problem appears to be the fact that there is a new version of the GacUtil that needs to be used with .NET 4.0 projects and above.</p>\n\n<p>I determined that this is the path to my current gacutil. My Path environment variable is set to this:</p>\n\n<blockquote>\n  <p><code>C:\\&gt;where gacutil</code></p>\n  \n  <p>C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bin\\gacutil.exe</p>\n</blockquote>\n\n<p>After navigating to C:\\Program Files (x86)\\Microsoft SDKs\\Windows, I see that there are several different SDKs versions to choose from.</p>\n\n<ul>\n<li>v7.0A</li>\n<li>v7.1A</li>\n<li>v8.0</li>\n<li>V8.0A</li>\n<li>V8.1</li>\n<li>V8.1A</li>\n<li>V10.0A</li>\n</ul>\n\n<p>I assume I just choose the path to the gacutil in latest version? </p>\n\n<p>What the new Path environment variable would be:</p>\n\n<p><code>C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v10.0A\\bin\\NETFX 4.7.2 Tools</code></p>\n"}, {"tags": ["c#", ".net", "asp.net-web-api"], "answers": [{"comments": [{"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1562789806, "post_id": 56977977, "comment_id": 100492100, "body": "Yeah I was looking for a way to override the default one set by the global asax, I was hoping there was a default way to do this without coding a custom attribute, I don&#39;t see a way to do so, +1 for the attempt"}], "tags": [], "owner": {"reputation": 1036, "user_id": 11655094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FDZH9.jpg?s=128&g=1", "display_name": "Saeid Amini", "link": "https://stackoverflow.com/users/11655094/saeid-amini"}, "is_accepted": false, "score": 1, "last_activity_date": 1562789610, "creation_date": 1562789610, "answer_id": 56977977, "question_id": 56977285, "link": "https://stackoverflow.com/questions/56977285/override-authorization-role-for-controller/56977977#56977977", "title": "Override Authorization Role For controller", "body": "<p>If I understand correctly, you can do like below. This is not exactly you want, it needs to customize.</p>\n\n<pre><code>public class MyAuthorize : AuthorizeAttribute\n{\n    public override void OnAuthorization(HttpActionContext actionContext)\n    {\n        // ...\n        // if (HttpContext.Current.User == null || HttpContext.Current.User.Identity == null || !HttpContext.Current.User.Identity.IsAuthenticated)\n            // throw new Exception(\"Not logged in\");\n    }\n}\n\n[MyAuthorize]\npublic bool DoSomthing()\n{\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562789729, "creation_date": 1562786202, "last_edit_date": 1562789729, "question_id": 56977285, "link": "https://stackoverflow.com/questions/56977285/override-authorization-role-for-controller", "title": "Override Authorization Role For controller", "body": "<p>I have a Default Role for all controllers configured in my global.asax</p>\n\n<pre><code>protected override void Configure(HttpConfiguration config)\n{\n     //Note: Client Authentication Filter is just a fancy AuthorizeAttribute\n     config.Filters.Add(new ClientAuthenticationFilter(APIRoles.MYAPI));\n}\n</code></pre>\n\n<p>This adds a requirement for a role to all controllers.  I would like to override that role for a specific controller</p>\n\n<pre><code>public class MFAController : ApiController\n{\n    [HttpGet]\n    [Route(AuthAPIRoutes.GET_MFA_DEVICES)]\n    [Authorize(Roles = \"MyCustomRoles\")]\n    public MFAMethodDTO[] GetMultiFactorMethods()\n    {\n        return GlobalFactory&lt;IMFASecurityService&gt;.Instance.GetMultiFactorMethods();\n    }\n    //...\n}\n</code></pre>\n\n<p>However when I do this. I get an error because my role original role APIRoles.MYAPI is missing.  Is there a default way to override the AuthorizationAtrributes for controllers so they take precedence over the Global Filter?</p>\n"}, {"tags": ["c#", "asp.net", "integration-testing"], "comments": [{"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 1, "creation_date": 1562787509, "post_id": 56977273, "comment_id": 100491183, "body": "You can isolate the code that configures dependencies into its own class or classes that you call from startup. If that class needs runtime values like connection strings, etc. from configuration, write the class so that you must pass those values to it. Then, in your integration tests, use the exact same classes to register your dependencies, and resolve the class you want to test from the container. That way you ensure that the class you&#39;re testing is created exactly the same way as it would be in production."}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 1, "creation_date": 1562788648, "post_id": 56977273, "comment_id": 100491683, "body": "If you include the code that registers your dependencies I can provide an example. It might not be NUnit-specific, but it will be close enough for you to get the idea."}, {"owner": {"reputation": 348, "user_id": 11605410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed2ff9abd025488a1f376f07da312a9?s=128&d=identicon&r=PG&f=1", "display_name": "TheMikeInNYC", "link": "https://stackoverflow.com/users/11605410/themikeinnyc"}, "edited": false, "score": 0, "creation_date": 1562866392, "post_id": 56977273, "comment_id": 100523359, "body": "right.  You need to add an IOC container to your Integration Tests.  Usually, in unit tests, this isn&#39;t done."}, {"owner": {"reputation": 31, "user_id": 3491985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b173835ce160f50364f120a6fb2ae6?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil", "link": "https://stackoverflow.com/users/3491985/sahil"}, "edited": false, "score": 0, "creation_date": 1562878996, "post_id": 56977273, "comment_id": 100528465, "body": "Thanks Scott and TheMikeInNYC. I install IOC conatiner in integration tests project. Its working perfectly."}], "owner": {"reputation": 31, "user_id": 3491985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07b173835ce160f50364f120a6fb2ae6?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil", "link": "https://stackoverflow.com/users/3491985/sahil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562786898, "creation_date": 1562786155, "last_edit_date": 1562786898, "question_id": 56977273, "link": "https://stackoverflow.com/questions/56977273/how-to-resolve-dependency-in-integration-test-asp-net-mvc", "title": "How to resolve dependency in integration test Asp.Net MVC", "body": "<p>I don't have much experience with integration tests but I will try to explain what I am trying to do.</p>\n\n<p>I have created an endpoint which reads data from database.</p>\n\n<pre><code>public class ProductController : Controller\n{\n    private IProductService _productService;\n\n    public ProductController (IProductService productService)\n        {\n            _productService = productService;\n        }\n\n    [HttpGet]\n    public IEnumerable&lt;Product&gt; GetProducts()\n       {\n          return _productService.GetAllProducts();\n       }\n}\n\npublic class ProductService: IProductService\n{\n    private IProductRepository _productRepository;\n\n    public ProductService(IProductRepository productRepository)\n        {\n            _productRepository = productRepository;\n        }\n\n    public List&lt;Product&gt; GetAllProducts()\n        {\n            return _productRepository.GetProducts();\n        }\n }\n\npublic class ProductRepository: IProductRepository\n{\n   public List&lt;Product&gt; GetProducts()\n       {\n            //database call to get products;\n       }\n}\n</code></pre>\n\n<p>I have resolved dependencies for repository and other services using SimpleInjectorDependencyResolver.</p>\n\n<p>Now I have created an unit test project where I have mocked the response from service.</p>\n\n<pre><code>[TestFixture]\npublic class ProductControllerTests\n{\n    private Mock&lt;IProductService&gt; _productService;\n\n    private ProductController _productController;\n\n\n    [SetUp]\n    public void Setup()\n    {\n        _productService = new Mock&lt;IProductService&gt;();\n\n        _productController= new ProductController(_productService.Object);\n    }\n\n}\n</code></pre>\n\n<p>this works fine. I can return the Mock data.</p>\n\n<p>for integration tests I created a separate project in which I want to hit the repository and get the real data back, but how can I resolve the dependencies for IProductService in integration test so that I will hit the repository and I can get the real data from database back. How can use dependency injection in the integration test to resolve dependencies.</p>\n\n<pre><code>public class ProductControllerIntegrationTests\n{\n    private ProductService _productService;\n\n    private ProductController _productController;\n\n\n    [SetUp]\n    public void Setup()\n       {\n             // how to resolve the dependency for _productService\n             _productController= new ProductController(_productService);\n        }\n }\n</code></pre>\n"}, {"tags": ["c#", "asp.net-core", "session-variables"], "comments": [{"owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 1, "creation_date": 1562786394, "post_id": 56977237, "comment_id": 100490759, "body": "You probably can\u2019t do that without <i>a lot</i> of work. If you want to share data between the two applications, you probably build some new independent store, so that you don\u2019t have to bend an existing concept around into some direction it wasn\u2019t meant for."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "reply_to_user": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1562786564, "post_id": 56977237, "comment_id": 100490827, "body": "@poke I updated my question. You can see that the store exists."}, {"owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1562786661, "post_id": 56977237, "comment_id": 100490865, "body": "My point is that if you are using some concept that is designed for WebForms, then you will have a hard time making that work in ASP.NET Core. The same is true with the other direction. If you instead create something on your own, you can design it in a way that makes it easy to consume from both applications."}, {"owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "reply_to_user": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 1, "creation_date": 1562786875, "post_id": 56977237, "comment_id": 100490954, "body": "@poke I share those session variables with asp.net MVC 5 application, so I thought it might be possible with .Net Core also..."}], "answers": [{"tags": [], "owner": {"reputation": 3066, "user_id": 3878764, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/cYlMQ.png?s=128&g=1", "display_name": "John-Luke Laue", "link": "https://stackoverflow.com/users/3878764/john-luke-laue"}, "is_accepted": true, "score": 1, "last_activity_date": 1562787393, "creation_date": 1562787393, "answer_id": 56977532, "question_id": 56977237, "link": "https://stackoverflow.com/questions/56977237/how-can-my-net-core-application-use-session-variables-from-another-application/56977532#56977532", "title": "How can my .Net Core application use session variables from another application?", "body": "<p>This is not exactly your situation, but I was able to get a separate web application to access session data (stored in SQL Server) from my ASP.NET Core web app.</p>\n\n<p>In ASP.NET Core, when backed by SQL Server, the session is stored in a table with Column ID and Column Value.\nID is the session ID and the Value is the session data.</p>\n\n<p>The session id is stored as an encrypted value in a cookie called .AspNetCore.Session.\nIn my separate web app, I retrieved the value of this cookie, unprotected/unencrypted it, then leveraged some of the open-source asp.net core code (especially IDistributedCache) to load the session data using the unencrypted key. </p>\n\n<p>It was all pretty complicated, and I'm pretty scared about having to upgrade some of the code I extracted (although it wasn't too much code).</p>\n\n<p>So, it's a similar situation and it was doable. But only did it as a last resort and I would try to find a different solution if possible </p>\n\n<p>Maybe this gives you some ideas though...</p>\n"}], "owner": {"reputation": 4003, "user_id": 1029771, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/52e5ad1a87fa458ee7c35eaa3ec2f277?s=128&d=identicon&r=PG", "display_name": "David Shochet", "link": "https://stackoverflow.com/users/1029771/david-shochet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 56977532, "answer_count": 1, "score": 1, "last_activity_date": 1562787393, "creation_date": 1562786015, "last_edit_date": 1562786534, "question_id": 56977237, "link": "https://stackoverflow.com/questions/56977237/how-can-my-net-core-application-use-session-variables-from-another-application", "title": "How can my .Net Core application use session variables from another application?", "body": "<p>My .Net Core application needs to use session variables set in another application (a WebForms app). Here is how it is configured in that WebForms application:</p>\n\n<pre><code>    &lt;sessionState mode=\"SQLServer\" sqlConnectionString=\"data source=.;UID=SessionStateUser;Password=somepassword;Connect Timeout=15;\" timeout=\"20\" /&gt;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3fuZt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3fuZt.png\" alt=\"enter image description here\"></a></p>\n\n<p>What can I do to access session variables from my .Net Core application?</p>\n"}, {"tags": ["c#", "sql-server", "ado.net"], "comments": [{"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1562786192, "post_id": 56977214, "comment_id": 100490672, "body": "Perhaps you are connecting to the wrong database and as a result the result set is empty as the table <code>Customer</code> doesn&#39;t exist?"}, {"owner": {"reputation": 1, "user_id": 5443073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840a2601994077d7e37162baba8c7cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Alagappan Venkatachalam", "link": "https://stackoverflow.com/users/5443073/alagappan-venkatachalam"}, "reply_to_user": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1562786532, "post_id": 56977214, "comment_id": 100490813, "body": "No I am connecting the correct database, I could see the value for the column_name column. Only the definition column is coming as empty."}, {"owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "edited": false, "score": 0, "creation_date": 1562786588, "post_id": 56977214, "comment_id": 100490841, "body": "Please post the DDL of the Customer table a simple but complete listing of the ADO.NET code you are using."}, {"owner": {"reputation": 1, "user_id": 5443073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840a2601994077d7e37162baba8c7cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Alagappan Venkatachalam", "link": "https://stackoverflow.com/users/5443073/alagappan-venkatachalam"}, "reply_to_user": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "edited": false, "score": 0, "creation_date": 1562787274, "post_id": 56977214, "comment_id": 100491095, "body": "@DavidBrowne-Microsoft, added the detailed scripts and ado.net code"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5443073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840a2601994077d7e37162baba8c7cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Alagappan Venkatachalam", "link": "https://stackoverflow.com/users/5443073/alagappan-venkatachalam"}, "edited": false, "score": 0, "creation_date": 1562789021, "post_id": 56977808, "comment_id": 100491818, "body": "Every time I run, I am able to reproduce this. Not sure what a weird problem is this. I hard code some string instead of definition in sql statement and I get that back in datareader but when I put back definition field it always comes as empty :("}, {"owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "reply_to_user": {"reputation": 1, "user_id": 5443073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840a2601994077d7e37162baba8c7cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Alagappan Venkatachalam", "link": "https://stackoverflow.com/users/5443073/alagappan-venkatachalam"}, "edited": false, "score": 0, "creation_date": 1562789183, "post_id": 56977808, "comment_id": 100491868, "body": "I&#39;m not sure what that means."}, {"owner": {"reputation": 1, "user_id": 5443073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840a2601994077d7e37162baba8c7cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Alagappan Venkatachalam", "link": "https://stackoverflow.com/users/5443073/alagappan-venkatachalam"}, "edited": false, "score": 0, "creation_date": 1562790039, "post_id": 56977808, "comment_id": 100492192, "body": "I am using .net core 2.1. Can you try repo in core? I tried with Dapper also and returns null."}, {"owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "reply_to_user": {"reputation": 1, "user_id": 5443073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840a2601994077d7e37162baba8c7cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Alagappan Venkatachalam", "link": "https://stackoverflow.com/users/5443073/alagappan-venkatachalam"}, "edited": false, "score": 0, "creation_date": 1562790241, "post_id": 56977808, "comment_id": 100492284, "body": "Still no repro.  .NET 4.7, .NET core 2.1, .NET Core 2.2"}, {"owner": {"reputation": 1, "user_id": 5443073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840a2601994077d7e37162baba8c7cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Alagappan Venkatachalam", "link": "https://stackoverflow.com/users/5443073/alagappan-venkatachalam"}, "edited": false, "score": 1, "creation_date": 1562790489, "post_id": 56977808, "comment_id": 100492363, "body": "Thanks Davind!!!. I Found it, This is the problem with the application user I am trying to access the table. The DB user has the permission since it&#39;s using the NT authentication(owner)."}], "tags": [], "owner": {"reputation": 49085, "user_id": 7297700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7650f380e0e3b8415ba9afaadf70906?s=128&d=identicon&r=PG&f=1", "display_name": "David Browne - Microsoft", "link": "https://stackoverflow.com/users/7297700/david-browne-microsoft"}, "is_accepted": false, "score": 0, "last_activity_date": 1562788758, "creation_date": 1562788758, "answer_id": 56977808, "question_id": 56977214, "link": "https://stackoverflow.com/questions/56977214/definition-column-from-sys-check-constraints-is-coming-as-null-in-ado-net-datare/56977808#56977808", "title": "definition column from sys.check_constraints is coming as null in ado.net datareader when the field is not null when executed from sssms", "body": "<p>No repro for me.  Does this repro?</p>\n\n<pre><code>    using System;\n    using System.Collections.Generic;\n    using System.Data;\n    using System.Data.SqlClient;\n    using System.Linq;\n    using System.Text;\n    using System.Threading.Tasks;\n\n    namespace ConsoleApp18\n    {\n        class Program\n        {\n\n            static string ddl = @\"\n    GO\n\n    --if exists (select * from sys.tables where name = 'Customer')\n   -- begin\n    --    ALTER TABLE [dbo].[Customer] SET ( SYSTEM_VERSIONING = OFF)\n    --    DROP TABLE [dbo].[Customer]\n    --    DROP TABLE [dbo].[MSSQL_TemporalHistoryFor_601769201]\n    --end\n\n    go\n    /****** Object:  Table [dbo].[Customer]    Script Date: 7/10/2019 3:24:22 PM ******/\n    SET ANSI_NULLS ON\n    GO\n\n    SET QUOTED_IDENTIFIER ON\n    GO\n\n    CREATE TABLE [dbo].[Customer](\n        [Id] [bigint] IDENTITY(1,1) NOT NULL,\n        [CompanyId] [smallint] NOT NULL,\n        [Prefix] [varchar](4) NOT NULL,\n        [FirstName] [varchar](50) NOT NULL,\n        [LastName] [varchar](50) NOT NULL,\n        [MiddleName] [varchar](50) NULL,\n        [Suffix] [varchar](4) NULL,\n        [NickName] [varchar](10) NULL,\n        [ProfilePictureName] [varchar](50) NULL,\n        [Company] [varchar](100) NULL,\n        [DateOfBirth] [date] NOT NULL,\n        [DateOfDeath] [date] NULL,\n        [Gender] [char](1) NOT NULL,\n        [Type] [varchar](10) NOT NULL,\n        [IsActive] [char](1) NULL,\n        [CreatedBy] [varchar](50) NOT NULL,\n        [CreatedOn] [datetime2](7) NOT NULL,\n        [UpdatedBy] [varchar](50) NULL,\n        [UpdatedOn] [datetime2](7) NULL,\n        [Process] [varchar](100) NULL,\n        [MessageId] [varchar](50) NOT NULL,\n        [SysStartDate] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,\n        [SysEndDate] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,\n     CONSTRAINT [PK_CUSTOMER] PRIMARY KEY CLUSTERED \n    (\n        [Id] ASC,\n        [CompanyId] ASC\n    )WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],\n        PERIOD FOR SYSTEM_TIME ([SysStartDate], [SysEndDate])\n    ) ON [PRIMARY]\n    WITH\n    (\n    SYSTEM_VERSIONING = ON ( HISTORY_TABLE = [dbo].[MSSQL_TemporalHistoryFor_601769201] )\n    )\n    GO\n\n    ALTER TABLE [dbo].[Customer] ADD  DEFAULT ('Y') FOR [IsActive]\n    GO\n\n    ALTER TABLE [dbo].[Customer]  WITH CHECK ADD  CONSTRAINT [CUSTOMER_PREFIX_CHECK] CHECK  (([Prefix]='Dr' OR [Prefix]='Miss' OR [Prefix]='Ms' OR [Prefix]='Mrs' OR [Prefix]='Mr'))\n    GO\n\n    ALTER TABLE [dbo].[Customer] CHECK CONSTRAINT [CUSTOMER_PREFIX_CHECK]\n    GO\n\n    ALTER TABLE [dbo].[Customer]  WITH CHECK ADD  CONSTRAINT [CUSTOMER_SUFFIX_CHECK] CHECK  (([Suffix]='RN' OR [Suffix]='MD' OR [Suffix]='ESQ' OR [Suffix]='DO' OR [Suffix]='DDS' OR [Suffix]='DDM' OR [Suffix]='III' OR [Suffix]='II' OR [Suffix]='I' OR [Suffix]='Sr' OR [Suffix]='Jr'))\n    GO\n\n    ALTER TABLE [dbo].[Customer] CHECK CONSTRAINT [CUSTOMER_SUFFIX_CHECK]\n    GO\n\n    ALTER TABLE [dbo].[Customer]  WITH CHECK ADD  CONSTRAINT [CUSTOMER_TYPE_CHECK] CHECK  (([Type]='Customer' OR [Type]='VENDOR' OR [Type]='INSIDER' OR [Type]='ANALYST' OR [Type]='INVESTOR'))\n    GO\n\n    ALTER TABLE [dbo].[Customer] CHECK CONSTRAINT [CUSTOMER_TYPE_CHECK]\n    GO\n\n\n\n\n    CREATE OR ALTER PROCEDURE [dbo].[GetCheckConstraints_Dup](@tableName as varchar(200))\n    AS\n    BEGIN\n    select \n        col.[name] as column_name,\n        con.[definition] As [constraint_value]\n    from sys.check_constraints con\n        left outer join sys.objects t\n            on con.parent_object_id = t.object_id\n        left outer join sys.all_columns col\n            on con.parent_column_id = col.column_id\n            and con.parent_object_id = col.object_id\n    where t.[name]=@tableName and con.is_disabled=0\n    order by con.name;\n    End;\n\n    GO\n    \";\n            static IEnumerable&lt;string&gt; GetBatches(string script)\n            {\n                var rdr = new System.IO.StringReader(script);\n                var sb = new StringBuilder();\n                while (true)\n                {\n                    var l = rdr.ReadLine()?.Trim();\n                    if (l == null)\n                    {\n                        var batch = sb.ToString().Trim();\n                        if (batch.Length &gt; 0)\n                            yield return sb.ToString();\n                        break;\n                    }\n                    else if (l.Equals( \"GO\", StringComparison.OrdinalIgnoreCase))\n                    {\n\n                        var batch = sb.ToString().Trim();\n                        if (batch.Length &gt; 0)\n                            yield return sb.ToString();\n                        sb.Clear();\n                    }\n                    else\n                    {\n                        sb.AppendLine(l.Trim());\n                    }\n                }\n            }\n            static void Main(string[] args)\n            {\n                var constr = \"Server=localhost;database=tempdb;integrated security=true\";\n\n                using (var con = new SqlConnection(constr))\n                {\n                    con.Open();\n                    foreach (var batch in GetBatches(ddl))\n                    {\n\n                        var cmd = con.CreateCommand();\n                        cmd.CommandText = batch;\n                        cmd.ExecuteNonQuery();\n                    }\n\n                    var constraints = GetConstraints(\"Customer\", constr);\n                    foreach (var constraint in constraints)\n                    {\n                        Console.WriteLine($\"{constraint.FieldName} {constraint.ConstraintValue}\");\n                    }\n                }\n\n                Console.WriteLine(\"Hit any key to exit\");\n                Console.ReadKey();\n            }\n            public static List&lt;Constraints&gt; GetConstraints(string tableName, string connectionString)\n            {\n                var constraints = new List&lt;Constraints&gt;();\n                using (SqlConnection connection = new SqlConnection(connectionString))\n                {\n                    //SqlDataReader\n                    connection.Open();\n                    SqlCommand cmd = new SqlCommand(\"DBO.GetCheckConstraints_Dup\", connection);\n                    cmd.CommandType = CommandType.StoredProcedure;\n                    cmd.Parameters.Add(\"@tableName\", SqlDbType.VarChar).Value = tableName;\n\n                    using (SqlDataReader dataReader = cmd.ExecuteReader())\n                    {\n                        while (dataReader.Read())\n                        {\n\n                            constraints.Add(new Constraints() { FieldName = dataReader[\"column_name\"].ToString(), Constraint = \"Check\", ConstraintValue = dataReader[\"constraint_value\"].ToString() });\n\n                        }\n                    }\n                }\n\n                return constraints;\n            }\n\n            public class Constraints\n            {\n                public string FieldName { get; internal set; }\n                public string Constraint { get; internal set; }\n                public string ConstraintValue { get; internal set; }\n            }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5443073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/840a2601994077d7e37162baba8c7cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Alagappan Venkatachalam", "link": "https://stackoverflow.com/users/5443073/alagappan-venkatachalam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562790089, "creation_date": 1562785885, "last_edit_date": 1562790089, "question_id": 56977214, "link": "https://stackoverflow.com/questions/56977214/definition-column-from-sys-check-constraints-is-coming-as-null-in-ado-net-datare", "title": "definition column from sys.check_constraints is coming as null in ado.net datareader when the field is not null when executed from sssms", "body": "<p>I am trying to write a C# program (.Net core 2.1) to read all the check constraints for a given table from ms sql server database. I am using sys.check_constraints table to get this information, when I tried to read this using ado.net datareader the column 'definition' from this table is always coming as empty though it has value.</p>\n\n<p>SQL Script (DDL, Stored Proc to Get CheckConstraints, Exec state of Stored Proc)</p>\n\n<pre><code>GO\n\n/****** Object:  Table [dbo].[Customer]    Script Date: 7/10/2019 3:24:22 PM ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE TABLE [dbo].[Customer](\n    [Id] [bigint] IDENTITY(1,1) NOT NULL,\n    [CompanyId] [smallint] NOT NULL,\n    [Prefix] [varchar](4) NOT NULL,\n    [FirstName] [varchar](50) NOT NULL,\n    [LastName] [varchar](50) NOT NULL,\n    [MiddleName] [varchar](50) NULL,\n    [Suffix] [varchar](4) NULL,\n    [NickName] [varchar](10) NULL,\n    [ProfilePictureName] [varchar](50) NULL,\n    [Company] [varchar](100) NULL,\n    [DateOfBirth] [date] NOT NULL,\n    [DateOfDeath] [date] NULL,\n    [Gender] [char](1) NOT NULL,\n    [Type] [varchar](10) NOT NULL,\n    [IsActive] [char](1) NULL,\n    [CreatedBy] [varchar](50) NOT NULL,\n    [CreatedOn] [datetime2](7) NOT NULL,\n    [UpdatedBy] [varchar](50) NULL,\n    [UpdatedOn] [datetime2](7) NULL,\n    [Process] [varchar](100) NULL,\n    [MessageId] [varchar](50) NOT NULL,\n    [SysStartDate] [datetime2](2) GENERATED ALWAYS AS ROW START NOT NULL,\n    [SysEndDate] [datetime2](2) GENERATED ALWAYS AS ROW END NOT NULL,\n CONSTRAINT [PK_CUSTOMER] PRIMARY KEY CLUSTERED \n(\n    [Id] ASC,\n    [CompanyId] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY],\n    PERIOD FOR SYSTEM_TIME ([SysStartDate], [SysEndDate])\n) ON [PRIMARY]\nWITH\n(\nSYSTEM_VERSIONING = ON ( HISTORY_TABLE = [dbo].[MSSQL_TemporalHistoryFor_601769201] )\n)\nGO\n\nALTER TABLE [dbo].[Customer] ADD  DEFAULT ('Y') FOR [IsActive]\nGO\n\nALTER TABLE [dbo].[Customer]  WITH CHECK ADD  CONSTRAINT [CUSTOMER_PREFIX_CHECK] CHECK  (([Prefix]='Dr' OR [Prefix]='Miss' OR [Prefix]='Ms' OR [Prefix]='Mrs' OR [Prefix]='Mr'))\nGO\n\nALTER TABLE [dbo].[Customer] CHECK CONSTRAINT [CUSTOMER_PREFIX_CHECK]\nGO\n\nALTER TABLE [dbo].[Customer]  WITH CHECK ADD  CONSTRAINT [CUSTOMER_SUFFIX_CHECK] CHECK  (([Suffix]='RN' OR [Suffix]='MD' OR [Suffix]='ESQ' OR [Suffix]='DO' OR [Suffix]='DDS' OR [Suffix]='DDM' OR [Suffix]='III' OR [Suffix]='II' OR [Suffix]='I' OR [Suffix]='Sr' OR [Suffix]='Jr'))\nGO\n\nALTER TABLE [dbo].[Customer] CHECK CONSTRAINT [CUSTOMER_SUFFIX_CHECK]\nGO\n\nALTER TABLE [dbo].[Customer]  WITH CHECK ADD  CONSTRAINT [CUSTOMER_TYPE_CHECK] CHECK  (([Type]='Customer' OR [Type]='VENDOR' OR [Type]='INSIDER' OR [Type]='ANALYST' OR [Type]='INVESTOR'))\nGO\n\nALTER TABLE [dbo].[Customer] CHECK CONSTRAINT [CUSTOMER_TYPE_CHECK]\nGO\n\n\n\n\nCREATE PROCEDURE [dbo].[GetCheckConstraints_Dup](@tableName as varchar(200))\nAS\nBEGIN\nselect \n    col.[name] as column_name,\n    con.[definition] As [constraint_value]\nfrom sys.check_constraints con\n    left outer join sys.objects t\n        on con.parent_object_id = t.object_id\n    left outer join sys.all_columns col\n        on con.parent_column_id = col.column_id\n        and con.parent_object_id = col.object_id\nwhere t.[name]=@tableName and con.is_disabled=0\norder by con.name;\nEnd;\n\nGO\n\nexec GetCheckConstraints_Dup 'Customer'\n\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4RNSu.png\" rel=\"nofollow noreferrer\">SQL Server Result</a></p>\n\n<p>C#</p>\n\n<pre><code>        public static List&lt;Constraints&gt; GetConstraints(string tableName,string connectionString)\n        {\n            var constraints = new List&lt;Constraints&gt;();\n            using (SqlConnection connection = new SqlConnection(connectionString))\n            {\n                //SqlDataReader\n                connection.Open();\n                SqlCommand cmd = new SqlCommand(\"DBO.GetCheckConstraints_Dup\", connection);\n                cmd.CommandType = CommandType.StoredProcedure;\n                cmd.Parameters.Add(\"@tableName\", SqlDbType.VarChar).Value = tableName;\n\n                using (SqlDataReader dataReader = cmd.ExecuteReader())\n                {\n                    while (dataReader.Read())\n                    {\n                        constraints.Add(new Constraints() { FieldName = dataReader[\"column_name\"].ToString(), Constraint = ConstraintType.Check, ConstraintValue = dataReader[\"constraint_value\"].ToString() });\n\n                    }\n                }\n            }\n\n            return constraints;\n        }\n</code></pre>\n"}, {"tags": ["c#", "powerpoint", "powerpoint-automation", "powerpoint-interop"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1562786079, "post_id": 56977206, "comment_id": 100490617, "body": "Presumably you&#39;re instantiating new (or getting the existing) instance of PowerPoint.Application, there&#39;s only ever <i>one</i> of those running at a time (unlike Excel, for instance, which can have multiple Application instances). It seems reasonable to me that <code>Quit</code>ting the application class would cause the behavior you describe, though I haven&#39;t tested it."}, {"owner": {"reputation": 303, "user_id": 9594249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tvb108108", "link": "https://stackoverflow.com/users/9594249/tvb108108"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1562787514, "post_id": 56977206, "comment_id": 100491188, "body": "@DavidZemens: Totally agree with you, but the .Quit() code has been in the code base for some time and NOW all of a sudden is causing all power point application documents to be closed within 2 minutes. So it seems like something has changed elsewhere. Make sense?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562791418, "post_id": 56977206, "comment_id": 100492754, "body": "Yes, I understand what you&#39;re saying :) but not sure how to go about confirming your suspicions. Do you get the same problem if you simply do <code>_powerPoint = null</code> instead of <code>.Quit()</code>?"}, {"owner": {"reputation": 303, "user_id": 9594249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tvb108108", "link": "https://stackoverflow.com/users/9594249/tvb108108"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562794166, "post_id": 56977206, "comment_id": 100493725, "body": "@DavidZemens: :-)  I went back to the code and did: <code>_powerPoint = null</code> instead of  <code>.Quit()</code> and everything worked normally and all my power point files stayed opened.  In our code base now, we just removed the <code>_powerPoint = .Quit()</code> code and everything seems to be working fine. Still curious what changed and where!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562794613, "post_id": 56977206, "comment_id": 100493869, "body": "Wish I had that answer for ya. I&#39;ve done a <i>lot</i> of PPT development but not in C# and I can&#39;t figure out how to get the right assemblies referenced to test it on my end. If you can show some more code as a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (i.e., just show how you&#39;re instantiating the application, creating one or two empty/blank Presentations, etc., without all the internal workings of your actual program) I might be able to give a better guess at the problem."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1562799101, "post_id": 56977206, "comment_id": 100495022, "body": "Is there any chance you were previously running under multiple accounts?  An old hack to get multiple PowerPoint instances running at once was to run the second instance as a second, local user account."}, {"owner": {"reputation": 303, "user_id": 9594249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tvb108108", "link": "https://stackoverflow.com/users/9594249/tvb108108"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1562852873, "post_id": 56977206, "comment_id": 100516080, "body": "@DavidZemens: I can try to do that, not sure when though. Might can this weekend! But I wouldn&#39;t mind doing that so I can see if it does it on a small app and let you look at it! Thanks again for the discussion and such."}, {"owner": {"reputation": 303, "user_id": 9594249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tvb108108", "link": "https://stackoverflow.com/users/9594249/tvb108108"}, "reply_to_user": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 1, "creation_date": 1562852907, "post_id": 56977206, "comment_id": 100516106, "body": "@dbc: I wouldn&#39;t think the accounts would be the issue because this is happening at our place of work AND on the customer site. Interesting information though."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1562853559, "post_id": 56977206, "comment_id": 100516506, "body": "<a href=\"https://stackoverflow.com/questions/19663478/powerpoint-issue-when-quitting?rq=1\" title=\"powerpoint issue when quitting\">stackoverflow.com/questions/19663478/&hellip;</a>"}, {"owner": {"reputation": 303, "user_id": 9594249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tvb108108", "link": "https://stackoverflow.com/users/9594249/tvb108108"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562854282, "post_id": 56977206, "comment_id": 100516916, "body": "@DavidZemens: Welp, that appears to be EXACTLY our situation!  Wow, thank you. I&#39;ll pass this to my co-workers. This issue was brought up at our Monday Dev meeting!  Of course, still doesn&#39;t get our end result of why all of a sudden it is happening, but maybe that will come up in time if an issue is found somewhere else (with a OS update etc.) Thanks again, David."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1562859342, "post_id": 56977206, "comment_id": 100520013, "body": "There is (or was, maybe MS fixed it sometime in the last few years) a bug with Windows &quot;preview&quot; pane in File Explorer: if a Presentation is selected in Explorer and Preview Pane enabled, this actually <i>opens</i> PowerPoint silently, which can lead to some very unexpected (and difficult to troubleshoot) errors/problems, because this is not how Explorer works with any other Office applications. Just tossing that out there as another potential reason for quirky behavior."}], "owner": {"reputation": 303, "user_id": 9594249, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "tvb108108", "link": "https://stackoverflow.com/users/9594249/tvb108108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1562961209, "answer_count": 0, "score": 0, "last_activity_date": 1562791078, "creation_date": 1562785821, "last_edit_date": 1562791078, "question_id": 56977206, "link": "https://stackoverflow.com/questions/56977206/powerpoint-application-quit-is-causing-all-processes-to-be-closed", "closed_reason": "Duplicate", "title": "PowerPoint Application .Quit() is causing all processes to be closed", "body": "<p>We have some code where we are using Microsoft.Office.Interop.PowerPoint to export some dashboards. We are seeing issues where when we export the dashboard everything is working, but within 2 minutes or so ALL opened Power Points are automatically closed. It is like the main process on the OS for Power Point is killed. </p>\n\n<p>We just now started noticing it with our applications with code that has been running for awhile.</p>\n\n<p>Could a security patch or OS change possibly caused this?</p>\n\n<pre><code> _powerPoint.Quit();\n</code></pre>\n\n<p>If we comment out the above line of code, early test, have proved that the all the Power Point files stay open after that 2 minute time.</p>\n\n<p>Has anyone encountered this at all? Like earlier stated, I'm curious if an OS change has occurred with unintended consequences.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "multithreading", "winforms"], "comments": [{"owner": {"reputation": 1610, "user_id": 8451520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wc4e0.png?s=128&g=1", "display_name": "ivcubr", "link": "https://stackoverflow.com/users/8451520/ivcubr"}, "edited": false, "score": 0, "creation_date": 1562785711, "post_id": 56977117, "comment_id": 100490470, "body": "Are there any events you can subscribe to when it changes? Or possibly could use a timer and check for updates on an set interval. If you post code I may be better able to suggest a solution"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1562788189, "post_id": 56977117, "comment_id": 100491485, "body": "There are ways for the server to &quot;notify&quot; your code when the DB Data has changed using the SqlDependency Class. There is a somewhat simpler means using a DataAdapter."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6893105, "user_type": "registered", "profile_image": "https://graph.facebook.com/1388911077789253/picture?type=large", "display_name": "M.D.84", "link": "https://stackoverflow.com/users/6893105/m-d-84"}, "is_accepted": false, "score": 0, "last_activity_date": 1562786602, "creation_date": 1562786602, "answer_id": 56977371, "question_id": 56977117, "link": "https://stackoverflow.com/questions/56977117/how-to-refresh-my-datagridview-without-stopping-the-code-execution/56977371#56977371", "title": "how to refresh my DataGridVIew without stopping the code execution", "body": "<p>Easiest solution would be to use a timer (<a href=\"https://docs.microsoft.com/de-de/dotnet/api/system.timers.timer?view=netframework-4.8\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/de-de/dotnet/api/system.timers.timer?view=netframework-4.8</a>) that refreshes your datagridview.datasource. </p>\n\n<p>Be aware that this will replace all rows. If you want the user not to see that you could call .SuspendLayout(), do the refresh and then call .ResumeLayout.</p>\n\n<p>The better solution would:\n- use a BindingList as the datasource of the DataGridView\n- use a timer that gets only the updated objects from the database and replaces them in the BindingList\n- due to the BindingList the DataGridView will automatically know what objects have changed and will only redraw those lines </p>\n"}], "owner": {"reputation": 1, "user_id": 11510975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c303fe8ee8f98bb269354614f9312d6f?s=128&d=identicon&r=PG&f=1", "display_name": "you16", "link": "https://stackoverflow.com/users/11510975/you16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562786602, "creation_date": 1562785394, "question_id": 56977117, "link": "https://stackoverflow.com/questions/56977117/how-to-refresh-my-datagridview-without-stopping-the-code-execution", "title": "how to refresh my DataGridVIew without stopping the code execution", "body": "<p>I have a table BOOK that contains (id, name, price... ) I want to edit the price of a book and i want the new price to be shown on a data grid view automatically while the code is running how can i manage to do it using threads, i m not having problems fetching data from data base , i want the DataGridView to be refreshed automatically once i change the price of a book in SQL server and i want this to happen without stopping the code and run it again or with a refresh button i want to accomplish this using threads.</p>\n"}, {"tags": ["c#", "azure", "asp.net-core", "azure-active-directory", "azure-service-fabric"], "comments": [{"owner": {"reputation": 10811, "user_id": 5946937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a686518049226b2b0f0bbb1f334978e?s=128&d=identicon&r=PG&f=1", "display_name": "LoekD", "link": "https://stackoverflow.com/users/5946937/loekd"}, "edited": false, "score": 1, "creation_date": 1562824780, "post_id": 56977065, "comment_id": 100500273, "body": "Did you see this walkthrough on how to configure openid connect for aspnet core? <a href=\"https://github.com/Azure-Samples/active-directory-aspnetcore-webapp-openidconnect-v2/tree/master/1-WebApp-OIDC/1-1-MyOrg\" rel=\"nofollow noreferrer\">github.com/Azure-Samples/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5749, "user_id": 9541448, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3xscN.jpg?s=128&g=1", "display_name": "Marilee Turscak - MSFT", "link": "https://stackoverflow.com/users/9541448/marilee-turscak-msft"}, "is_accepted": false, "score": 1, "last_activity_date": 1563226957, "creation_date": 1563226957, "answer_id": 57047533, "question_id": 56977065, "link": "https://stackoverflow.com/questions/56977065/aad-callbackurl-generated-is-an-ip-address-and-does-not-match-reply-url-in-app-r/57047533#57047533", "title": "AAD CallbackUrl generated is an IP address and does not match reply Url in app registration when deployed to service fabric", "body": "<p>The link LoekD supplied should be useful to you. </p>\n\n<p>You just need to have the reply URL in your code matching what you have in your app registration. If it works locally but does not work with your published application then that means that you still have references to the local url somewhere. You need to use your published application URL in both the code and in the portal (myapp.azurewebsites.net).</p>\n"}], "owner": {"reputation": 11, "user_id": 11766574, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-C3sMWqqEetQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdtnIxhibd7VGd7bNG-ntLmLM-HHQ/photo.jpg?sz=128", "display_name": "Richjimdev", "link": "https://stackoverflow.com/users/11766574/richjimdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563226957, "creation_date": 1562785154, "question_id": 56977065, "link": "https://stackoverflow.com/questions/56977065/aad-callbackurl-generated-is-an-ip-address-and-does-not-match-reply-url-in-app-r", "title": "AAD CallbackUrl generated is an IP address and does not match reply Url in app registration when deployed to service fabric", "body": "<p>I'm setting up authentication using Azure Active Directory with an ASP.NET Core 2.2 web app service that is deployed to azure service fabric. I set it up using the template in visual studio and it works well when deployed locally. When I deployed it to azure however, I get the \"AADSTS50011: The reply url specified in the request does not match the reply urls configured for the application\" error and i noticed in the URL it lists the generated redirect URI as <a href=\"https://IP.ADDRESS:PORT#/signin-oidc\" rel=\"nofollow noreferrer\">https://IP.ADDRESS:PORT#/signin-oidc</a>. If I add this ip address in my app registration it wont give me the error but redirecting me to that address doesn't actually take me anywhere. What can I do to fix this?</p>\n\n<p>I thought it might be some reverse proxy issue and I tried some fixes to try and give me an absolute path to my service on the cluster eg: <a href=\"https://mycluster.azure-api.net/myapplication/myservice/signin-oidc\" rel=\"nofollow noreferrer\">https://mycluster.azure-api.net/myapplication/myservice/signin-oidc</a> but none of these worked</p>\n\n<p>Also the CallbackPath property needs to start with a \"/\" so I can't just add the full address there either, it throws an error.</p>\n\n<p>Some of my code in the startup.cs, a lot of this was auto-generated:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>        public void ConfigureServices(IServiceCollection services)\n        {\n            services.Configure&lt;CookiePolicyOptions&gt;(options =&gt;\n            {\n                // This lambda determines whether user consent for non-essential cookies is needed for a given request.\n                options.CheckConsentNeeded = context =&gt; true;\n                options.MinimumSameSitePolicy = SameSiteMode.None;\n            });\n\n            services.AddAuthentication(AzureADDefaults.AuthenticationScheme)\n                .AddAzureAD(options =&gt; BindAad(options))\n                .AddCookie();\n\n            services.AddMvc(options =&gt;\n            {\n                var policy = new AuthorizationPolicyBuilder()\n                    .RequireAuthenticatedUser()\n                    .Build();\n                options.Filters.Add(new AuthorizeFilter(policy));\n            })\n            .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);\n        }\n\n        private void BindAad(AzureADOptions options)\n        {\n            options.Instance = settings.GetSetting(\"AadInstance\");\n            options.Domain = settings.GetSetting(\"AadDomain\");\n            options.TenantId = settings.GetSetting(\"AadTenantId\");\n            options.ClientId = settings.GetSetting(\"AadClientId\");\n            options.CallbackPath = new PathString(\"/signin-oidc\");\n        }\n\n\n\n       public void Configure(IApplicationBuilder app, IHostingEnvironment env)\n        {\n            if (env.IsDevelopment())\n            {\n                app.UseDeveloperExceptionPage();\n            }\n            else\n            {\n                app.UseExceptionHandler(\"/Home/Error\");\n                app.UseHsts();\n            }\n\n            app.UseHttpsRedirection();\n            app.UseStaticFiles();\n            app.UseCookiePolicy();\n\n            app.UseAuthentication();\n\n            app.UseMvc(routes =&gt;\n            {\n                routes.MapRoute(\n                    name: \"default\",\n                    template: \"{controller=Home}/{action=Index}\");\n            });\n        }\n</code></pre>\n"}, {"tags": ["c#", "azure-functions"], "comments": [{"owner": {"reputation": 1968, "user_id": 2854993, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/903782651787352046ec13f62893eeb3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris B", "link": "https://stackoverflow.com/users/2854993/chris-b"}, "edited": false, "score": 0, "creation_date": 1562786168, "post_id": 56977048, "comment_id": 100490659, "body": "You would need to save an entry of the last successful execution in some sort of storage i.e.table storage. Then you could read table storage and order by Timestamp which would give you the last successful execution."}, {"owner": {"reputation": 50682, "user_id": 117700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1a350b4a18da2ffab7bde4bc753909bd?s=128&d=identicon&r=PG", "display_name": "Alex Gordon", "link": "https://stackoverflow.com/users/117700/alex-gordon"}, "edited": false, "score": 0, "creation_date": 1562793491, "post_id": 56977048, "comment_id": 100493507, "body": "store <i>every</i> response you get in table storage, build a project on top of that historical data with what ever you need to get out of the data."}], "answers": [{"tags": [], "owner": {"reputation": 1968, "user_id": 2854993, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/903782651787352046ec13f62893eeb3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris B", "link": "https://stackoverflow.com/users/2854993/chris-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1562788241, "last_edit_date": 1562788241, "creation_date": 1562787693, "answer_id": 56977606, "question_id": 56977048, "link": "https://stackoverflow.com/questions/56977048/how-to-use-azure-functions-to-fetch-only-new-data/56977606#56977606", "title": "How to use Azure Functions to fetch only new data", "body": "<p>I have put together a small little code example of saving your function executions. I have used a HTTP trigger as it made it easier to test but the logic for table storage would be the same in your Activity trigger.</p>\n\n<pre><code>public class FunctionExecution : TableEntity\n{\n    public string FunctionName { get; set; }\n}\n\npublic static class HttpTriggeredFunction\n{\n    [FunctionName(\"HttpTriggeredFunction\")]\n    public static async Task&lt;IActionResult&gt; Run(\n        [HttpTrigger(AuthorizationLevel.Function, \"get\", \"post\", Route = null)] HttpRequest req,\n        [Table(\"FunctionExecutions\", Connection = \"StorageConnectionString\")] CloudTable table,\n        ExecutionContext executionContext,\n        ILogger log)\n    {\n        log.LogInformation(\"C# HTTP trigger function processed a request.\");\n\n        // query table storage for all entries (you might want to restrict the query to the last day etc)\n        TableQuery&lt;FunctionExecution&gt; query = new TableQuery&lt;FunctionExecution&gt;();\n        TableQuerySegment&lt;FunctionExecution&gt; data = await table.ExecuteQuerySegmentedAsync(query, null);\n\n        // get the last function execution by ordering by Timestamp\n        FunctionExecution lastFunctionExecution = data.OrderByDescending(r =&gt; r.Timestamp).FirstOrDefault();\n\n        DateTimeOffset? begin = lastFunctionExecution?.Timestamp;\n        DateTime end = DateTime.UtcNow;\n\n        // call off to ThirdPartyClient\n\n        // log successful execution to table storage\n        TableOperation insertOperation = TableOperation.Insert(new FunctionExecution\n        {\n            PartitionKey = executionContext.InvocationId.ToString(), // using the InvocationId of the function so you can relate executions if needed\n            RowKey = Guid.NewGuid().ToString(), \n            Timestamp = DateTimeOffset.UtcNow, // set the Timestamp to now as the function has been successful\n            FunctionName = \"HttpTriggeredFunction\" // optional but you might want to save the function name in your case FunctionNames.GetInvoicesAsync\n        });\n\n        await table.ExecuteAsync(insertOperation);\n\n        return new OkObjectResult(null);\n    }\n}\n</code></pre>\n\n<p><strong>Edit</strong>: Had a thought - you might want to set the function name as the partition key to allow better partitioning (if needed):</p>\n\n<pre><code>TableOperation insertOperation = TableOperation.Insert(new FunctionExecution\n{\n    PartitionKey = \"HttpTriggeredFunction\", // a partition is a consecutive range of entities possessing the same partition key value\n    RowKey = Guid.NewGuid().ToString(), // row key must be unique within a partition\n    Timestamp = DateTimeOffset.UtcNow, // set the Timestamp to now as the function has been successful\n    InvocationId = executionContext.InvocationId.ToString() // optional - using the InvocationId of the function so you can relate executions if needed\n});\n</code></pre>\n\n<p>Hope this helps somewhat!</p>\n"}], "owner": {"reputation": 3, "user_id": 7242810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FYdjP.png?s=128&g=1", "display_name": "Garnovski", "link": "https://stackoverflow.com/users/7242810/garnovski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56977606, "answer_count": 1, "score": 0, "last_activity_date": 1562788241, "creation_date": 1562785066, "question_id": 56977048, "link": "https://stackoverflow.com/questions/56977048/how-to-use-azure-functions-to-fetch-only-new-data", "title": "How to use Azure Functions to fetch only new data", "body": "<p>I'm using Azure Functions to periodically fetch invoices from a third party using its API and I'm looking for the best way to fetch only the new invoices. </p>\n\n<p>Right now, my function fetches all invoices from the past day and my code makes sure that the rest of the processing has not been done yet before doing it. I'm 100% sure that there is a better way to do it. I'd like the solution to be robust, and this isn't. Is there a way to use checkpoints and know what was fetched or not?</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>        [FunctionName(FunctionNames.GetInvoicesAsync)]\n        public async static Task&lt;ReadOnlyCollection&lt;InvoiceContent&gt;&gt; GetInvoicesAsync([ActivityTrigger] string name)\n        {\n            var begin = DateTime.UtcNow.AddDays(-1);\n            var end = DateTime.UtcNow;\n\n            var thirdPartyClient = ClientHelper.GetThirdPartyClient();\n            return await thirdPartyClient.GetInvoicesAsync(begin, end);\n        }\n</code></pre>\n\n<p>I'd like the \"begin\" variable to be the last successful execution of the function, or something along those lines.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "iis", "memory"], "comments": [{"owner": {"reputation": 407, "user_id": 9641914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LzVgH.jpg?s=128&g=1", "display_name": "satsvelke", "link": "https://stackoverflow.com/users/9641914/satsvelke"}, "edited": false, "score": 0, "creation_date": 1562786163, "post_id": 56977035, "comment_id": 100490658, "body": "I guess this memory leak issue in your app"}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1562787169, "post_id": 56977035, "comment_id": 100491056, "body": "Not much we can do without error messages or some snippets of code that could be the suspects..."}, {"owner": {"reputation": 1129, "user_id": 1073351, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8d1da17c32728856fd0a9aaeab3b48be?s=128&d=identicon&r=PG", "display_name": "Mark McWhirter", "link": "https://stackoverflow.com/users/1073351/mark-mcwhirter"}, "edited": false, "score": 0, "creation_date": 1562788955, "post_id": 56977035, "comment_id": 100491794, "body": "A memory leak from an unmanaged component is a likely suspect.  What is the application stack?"}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 0, "creation_date": 1562791775, "post_id": 56977035, "comment_id": 100492891, "body": "<a href=\"https://support.microsoft.com/en-ca/help/919792/how-to-use-the-debug-diagnostics-tool-to-troubleshoot-a-process-that-h\" rel=\"nofollow noreferrer\">support.microsoft.com/en-ca/help/919792/&hellip;</a>"}, {"owner": {"reputation": 1406, "user_id": 4054808, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/191d4a84a9584ca8f2f0a2ed3fc0fb3c?s=128&d=identicon&r=PG&f=1", "display_name": "Richard   Housham", "link": "https://stackoverflow.com/users/4054808/richard-housham"}, "edited": false, "score": 0, "creation_date": 1562944728, "post_id": 56977035, "comment_id": 100552424, "body": "Check some of the IIS logs. See what pages are being hit, maybe there is one there that has some trouble."}], "owner": {"reputation": 8214, "user_id": 458700, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0aae22509915fa4da811f48e757f4860?s=128&d=identicon&r=PG&f=1", "display_name": "Amira Elsayed Ismail", "link": "https://stackoverflow.com/users/458700/amira-elsayed-ismail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1568057874, "creation_date": 1562785015, "last_edit_date": 1562791148, "question_id": 56977035, "link": "https://stackoverflow.com/questions/56977035/memory-exhausted-and-no-new-connections-came-from-application-iis", "title": "memory exhausted and no new connections came from application iis", "body": "<p>I have a serious problem in the server we are using.</p>\n\n<p>Every 10 or 15 days it suddenly hangs up and requests timeout and when we restart the server everything works perfectly. </p>\n\n<p>The IIS log gives this error:</p>\n\n<blockquote>\n  <p>memory exhausted and no new connections</p>\n</blockquote>\n\n<p>The server is GoDaddy server. </p>\n"}, {"tags": ["c#", "unity3d", "events", "action", "coroutine"], "comments": [{"owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 2, "creation_date": 1562786498, "post_id": 56977019, "comment_id": 100490801, "body": "I&#39;m having trouble seeing how <code>UpdateCoroutine2</code> gets called."}, {"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1562791080, "post_id": 56977019, "comment_id": 100492594, "body": "OK an event is like &quot;OnClick&quot;, as a short version an Action is something that gets called as a result of the click (there are other reasons), so this isnt what you need at all.. and how you&#39;re calling  UpdateCoroutine2 isnt included in the code provided.. did you put it in update?"}, {"owner": {"reputation": 13, "user_id": 11668365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a66b55bbf03eb58148809da3bbdf74d?s=128&d=identicon&r=PG&f=1", "display_name": "rashapou", "link": "https://stackoverflow.com/users/11668365/rashapou"}, "edited": false, "score": 0, "creation_date": 1562802983, "post_id": 56977019, "comment_id": 100495745, "body": "My attempts aren&#39;t in the listed code because they got very messy; I took them out and left the remainder of what I had. Yes, I put it in the Update function because I wasn&#39;t sure how to call something after the code is already running other than that. Well I did also try implementing <i>another</i> IEnumerator and calling <code>UpdateCoroutine2</code> when it reached a certain time but that also called it repeatedly for some reason. I&#39;ll try writing it up again how I had it in my last attempt but I don&#39;t know how I should try to change things."}, {"owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "edited": false, "score": 0, "creation_date": 1562864306, "post_id": 56977019, "comment_id": 100522402, "body": "It&#39;s calling repeatedly because it&#39;s in a <code>while</code> loop that repeats every fixed update for 3 seconds..."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11668365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a66b55bbf03eb58148809da3bbdf74d?s=128&d=identicon&r=PG&f=1", "display_name": "rashapou", "link": "https://stackoverflow.com/users/11668365/rashapou"}, "edited": false, "score": 0, "creation_date": 1562938440, "post_id": 56994080, "comment_id": 100548744, "body": "Thank you so much. That makes way more sense."}], "tags": [], "owner": {"reputation": 16662, "user_id": 1092820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc78da24118b403595f62fa7856e1b6c?s=128&d=identicon&r=PG", "display_name": "Ruzihm", "link": "https://stackoverflow.com/users/1092820/ruzihm"}, "is_accepted": true, "score": 1, "last_activity_date": 1562864208, "creation_date": 1562864208, "answer_id": 56994080, "question_id": 56977019, "link": "https://stackoverflow.com/questions/56977019/how-to-call-different-methods-only-once-at-different-times/56994080#56994080", "title": "How to call different methods only once, at different times?", "body": "<p>Using events here is really overcomplicating things for the thing you seem to want to do.</p>\n\n<p>I would use <a href=\"https://docs.unity3d.com/ScriptReference/WaitForSeconds.html\" rel=\"nofollow noreferrer\"><code>yield return new WaitForSeconds(seconds);</code></a> to time things:</p>\n\n<pre><code>using System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class CountdownTimer : MonoBehaviour\n{\n\n    public SkinnedMeshSpawn SkinnedMeshSpawn;\n\n    void Start()\n    { \n        StartCoroutine(FunctionCaller(3f,3f));\n    }\n\n    IEnumerator FunctionCaller(float pause1, float pause2)\n    {\n        SkinnedMeshSpawn.GetComponent&lt;SkinnedMeshSpawn&gt;().MoveCubes();\n\n        yield return new WaitForSeconds(pause1);\n\n        SkinnedMeshSpawn.GetComponent&lt;SkinnedMeshSpawn&gt;().LerpSine();\n\n        yield return new WaitForSeconds(pause2);\n\n        // Do whatever after pause 2\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11668365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a66b55bbf03eb58148809da3bbdf74d?s=128&d=identicon&r=PG&f=1", "display_name": "rashapou", "link": "https://stackoverflow.com/users/11668365/rashapou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 56994080, "answer_count": 1, "score": 0, "last_activity_date": 1562864208, "creation_date": 1562784933, "question_id": 56977019, "link": "https://stackoverflow.com/questions/56977019/how-to-call-different-methods-only-once-at-different-times", "title": "How to call different methods only once, at different times?", "body": "<p>I'm trying to use Actions and Events, Inumerators and Coroutines, but I'm getting so confused.</p>\n\n<p>The goal: Get MoveCubes() to run once for 3 seconds, and then get LerpSine() to run once for 3 seconds. </p>\n\n<p>The seconds are being tracked by <code>CountdownTimer.cs</code>. Then <code>SkinnedMeshSpawn.cs</code> interacts with it. </p>\n\n<p>CountdownTimer:</p>\n\n<pre><code>using System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class CountdownTimer : MonoBehaviour\n{\n    float currentTime = 0f;\n    float startingTime = 10f;\n    public static event Action RaiseReady;\n    public static event Action RaiseReady2;\n    public SkinnedMeshSpawn SkinnedMeshSpawn;\n\n    void Start()\n    {\n        currentTime = startingTime;     \n        StartCoroutine(UpdateCoroutine());\n    }\n\n    IEnumerator UpdateCoroutine()\n    {\n        while (true)\n        {\n            SkinnedMeshSpawn.GetComponent&lt;SkinnedMeshSpawn&gt;().MoveCubes();\n            currentTime -= 1 * Time.deltaTime; //does it each frame\n            int n = Convert.ToInt32(currentTime);\n\n            if (n == 7)\n            {\n                RaiseReady?.Invoke();\n                RaiseReady = null; // clean the event\n                yield break; // Kills the coroutine\n            }\n            yield return new WaitForFixedUpdate();\n        }\n    }\n\n    IEnumerator UpdateCoroutine2()\n    {\n        while (true)\n        {\n            SkinnedMeshSpawn.GetComponent&lt;SkinnedMeshSpawn&gt;().LerpSine();\n            currentTime -= 1 * Time.deltaTime; //does it each frame\n            int n = Convert.ToInt32(currentTime);\n\n            if (n == 4)\n            {\n                RaiseReady2?.Invoke();\n                RaiseReady2 = null; // clean the event\n                yield break; // Kills the coroutine\n\n            }\n            yield return new WaitForFixedUpdate();\n        }\n    }\n}\n</code></pre>\n\n<p>SkinnedMeshSpawn:</p>\n\n<pre><code>using UnityEngine;\n\n[RequireComponent(typeof(SkinnedMeshRenderer))]\npublic class SkinnedMeshSpawn : MonoBehaviour\n{\n    public GameObject CubePrefab;\n    public GameObject[] objects;\n    SkinnedMesh mesh;\n    public Rigidbody cubePrefabRb;\n\n    public Vector3[] verts;\n\n    int runOnce = 1;\n\n    void Awake()\n    {\n        mesh = GetComponent&lt;SkinnedMesh&gt;();\n        verts = new Vector3[mesh.vertexCount];\n    }\n    void Start()\n    {\n        verts = mesh.vertices;\n\n        CountdownTimer.RaiseReady += CountdownTimer_RaiseReady;\n        CountdownTimer.RaiseReady2 += CountdownTimer_RaiseReady2;\n\n        mesh.OnResultsReady += DrawVertices;\n    }\n    void CountdownTimer_RaiseReady()\n    {\n        Debug.Log(\"Done\");\n        CountdownTimer.RaiseReady -= CountdownTimer_RaiseReady; // Remove listener though the other class is already clearing it\n    }\n\n    private void CountdownTimer_RaiseReady2()\n    {\n        Debug.Log(\"Done2\");\n        CountdownTimer.RaiseReady2 -= CountdownTimer_RaiseReady; // Remove listener though the other class is already clearing it\n    }\n\n    void DrawVertices(SkinnedMesh mesh)\n    {\n        if (runOnce == 1)\n        {\n            for (int i = 0; i &lt; mesh.vertexCount; i++)\n            {\n                Vector3 position = verts[i];\n                var cubeClone = Instantiate(CubePrefab, position, transform.rotation);\n                cubeClone.tag = \"CubePFInst\";\n            }\n            runOnce = 0;\n        }\n    }\n\n\n    public void MoveCubes()\n    {\n        if (runOnce == 0)\n        {\n            objects = GameObject.FindGameObjectsWithTag(\"CubePFInst\");\n\n            for (int i = 0; i &lt; mesh.vertexCount; i++)\n            {\n                Vector3 position = verts[i];\n                cubePrefabRb = objects[i].GetComponent&lt;Rigidbody&gt;();\n                cubePrefabRb.MovePosition(Vector3.Lerp(position, position, Time.deltaTime * 6));\n            }\n        }\n    }\n\n    public void LerpSine()\n    {\n        Debug.Log(\"LerpSine\");\n    }\n}\n</code></pre>\n\n<p>The most I've been able to accomplish so far is getting the <code>UpdateCoroutine2</code> to be called and having <code>Done2</code> print to Log, but <code>LerpSine</code> gets printed repeatedly as if I'm starting the coroutine with every frame update. </p>\n\n<p>I would appreciate if someone could look over the code and give suggestions on how to achieve the goal stated above. Later on I wanted to implement a GameManager but this is already getting very complex.</p>\n"}, {"tags": ["c#", "visual-studio", ".net-core", "azure-functions", ".net-standard"], "answers": [{"tags": [], "owner": {"reputation": 8765, "user_id": 1945525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/E7uTt.jpg?s=128&g=1", "display_name": "rickvdbosch", "link": "https://stackoverflow.com/users/1945525/rickvdbosch"}, "is_accepted": true, "score": 0, "last_activity_date": 1562794499, "creation_date": 1562794499, "answer_id": 56978966, "question_id": 56977005, "link": "https://stackoverflow.com/questions/56977005/project-myazurefunc-is-not-compatible-with-netstandard2-0-netstandard-versio/56978966#56978966", "title": "Project MyAzureFunc is not compatible with netstandard2.0 &gt; (.NETStandard,Version=v2.0)", "body": "<p>You can create a .NET Core Unit Test project. In Visual Studio 2019, follow these steps to do so:</p>\n\n<ul>\n<li>On the startup screen, select <em>Create new project</em></li>\n<li>In the search box, type <em>test</em></li>\n<li>Select the desired project type: <em>MSTest, xUnit or NUnit Test Project (.NET Core)</em></li>\n<li>Click <em>Next</em> to continue creating the project</li>\n<li>Implement the desired unit tests \ud83d\ude01</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/gYLG0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gYLG0.png\" alt=\"Create a new Unit Test project\"></a></p>\n"}], "owner": {"reputation": 608, "user_id": 1582709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqPtO.jpg?s=128&g=1", "display_name": "Wouter van Koppen", "link": "https://stackoverflow.com/users/1582709/wouter-van-koppen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 56978966, "answer_count": 1, "score": 0, "last_activity_date": 1562794499, "creation_date": 1562784889, "question_id": 56977005, "link": "https://stackoverflow.com/questions/56977005/project-myazurefunc-is-not-compatible-with-netstandard2-0-netstandard-versio", "title": "Project MyAzureFunc is not compatible with netstandard2.0 &gt; (.NETStandard,Version=v2.0)", "body": "<p>I have an Azure Function App project in Visual Studio in .NET Core 2.2 which I would like to unit test. Therefore, I added a second project (Class Library) with some unit tests.\nHowever, I get the following compilation error:</p>\n\n<blockquote>\n  <p>Project MyAzureFunc is not compatible with netstandard2.0\n  (.NETStandard,Version=v2.0). Project MyAzureFunc supports:\n  netcoreapp2.2 (.NETCoreApp,Version=v2.2)</p>\n</blockquote>\n\n<p>For the Class Library / Unit tests I can only choose between .NET Standard (1.0 .. 2.0), not for .NET Core itself. </p>\n\n<p>Should I download an additional SDK for .NET Core to get it working?</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 1, "creation_date": 1562785031, "post_id": 56976997, "comment_id": 100490202, "body": "Do you mean <code>Environment.Exit(-1);</code>? There is no <code>ExitCode()</code> method."}, {"owner": {"reputation": 48, "user_id": 11410397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yn50I.jpg?s=128&g=1", "display_name": "NetPenguin21", "link": "https://stackoverflow.com/users/11410397/netpenguin21"}, "reply_to_user": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 1, "creation_date": 1562785136, "post_id": 56976997, "comment_id": 100490256, "body": "Yes thanks for pointing that out! I have edited the question."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1562785711, "post_id": 56976997, "comment_id": 100490471, "body": "Just don&#39;t replicate a bad practice, <a href=\"https://stackoverflow.com/q/3133199/17034\">look here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 48, "user_id": 11410397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yn50I.jpg?s=128&g=1", "display_name": "NetPenguin21", "link": "https://stackoverflow.com/users/11410397/netpenguin21"}, "edited": false, "score": 0, "creation_date": 1562785836, "post_id": 56977169, "comment_id": 100490527, "body": "So setting it is essentially waiting for something else to set an exit code and if not then whatever it is set to is returned?"}, {"owner": {"reputation": 94, "user_id": 8929281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gm0FP.png?s=128&g=1", "display_name": "DutchJelly", "link": "https://stackoverflow.com/users/8929281/dutchjelly"}, "reply_to_user": {"reputation": 48, "user_id": 11410397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yn50I.jpg?s=128&g=1", "display_name": "NetPenguin21", "link": "https://stackoverflow.com/users/11410397/netpenguin21"}, "edited": false, "score": 0, "creation_date": 1562786044, "post_id": 56977169, "comment_id": 100490609, "body": "Setting it is basically setting the exit code for the time being. When your program stops it&#39;ll send the most recent code you set the exit code to, to your operating system.  Environment.Exit(-1) does the same, but stops your program so -1 will be the most recent version of the exit code, which will be sent to your operating system."}, {"owner": {"reputation": 48, "user_id": 11410397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yn50I.jpg?s=128&g=1", "display_name": "NetPenguin21", "link": "https://stackoverflow.com/users/11410397/netpenguin21"}, "edited": false, "score": 0, "creation_date": 1562786171, "post_id": 56977169, "comment_id": 100490661, "body": "Thanks so it is just a matter of waiting for &quot;finishing up&quot; to occur versus hard stop. So is -1 just a choice of that developer or does this int have some kind of significance? (Significance in terms of all environments not just the meaning that developer put on it)"}], "tags": [], "owner": {"reputation": 94, "user_id": 8929281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gm0FP.png?s=128&g=1", "display_name": "DutchJelly", "link": "https://stackoverflow.com/users/8929281/dutchjelly"}, "is_accepted": true, "score": 2, "last_activity_date": 1562786348, "last_edit_date": 1562786348, "creation_date": 1562785648, "answer_id": 56977169, "question_id": 56976997, "link": "https://stackoverflow.com/questions/56976997/proper-usage-of-environment-exitcode-1/56977169#56977169", "title": "Proper usage of Environment.ExitCode = -1", "body": "<p><code>Environment.Exit(-1)</code> terminates the process and sends an exit code of -1 to the operating system. <code>Environment.ExitCode = -1</code> does not terminate the process, but sets the exit code to -1 for when the process terminates.</p>\n\n<p>I found this information <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.environment.exitcode?view=netframework-4.8\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.environment.exit?view=netframework-4.8\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>So here's an example of the difference in usage:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class ExitCodeUsage\n{\n   public static void Main()\n   {\n      string[] args = Environment.GetCommandLineArgs();\n      if (args.Length == 1) {\n         Environment.ExitCode = -1;  \n      }\n      else {\n         //Do stuff that requires the length of args to be not equal to 1.\n      }\n   }\n}\n</code></pre>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class ExitUsage\n{\n   public static void Main()\n   {\n      string[] args = Environment.GetCommandLineArgs();\n      if (args.Length == 1) {\n         Environment.Exit(-1);  \n      }\n\n      //Do stuff that requires the length of args to be not equal to 1.\n\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 11410397, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yn50I.jpg?s=128&g=1", "display_name": "NetPenguin21", "link": "https://stackoverflow.com/users/11410397/netpenguin21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 0, "accepted_answer_id": 56977169, "answer_count": 1, "score": 1, "last_activity_date": 1562786348, "creation_date": 1562784853, "last_edit_date": 1562785572, "question_id": 56976997, "link": "https://stackoverflow.com/questions/56976997/proper-usage-of-environment-exitcode-1", "title": "Proper usage of Environment.ExitCode = -1", "body": "<p>I am developing a .NET Console Application and keep seeing where another developer has used <code>Environment.ExitCode = -1;</code> in their catch statements. I have read the answer <a href=\"https://stackoverflow.com/a/155619/11410397\">here</a> and was satisfied to discover </p>\n\n<blockquote>\n  <p>You can set the exit code using properties: Environment.ExitCode = -1;. This will be used if nothing else sets the return code or uses one of the other options above).</p>\n</blockquote>\n\n<p>Again the link I have placed above is not the same question this is a question regarding method usage not about how to set the code.</p>\n\n<p>To my understanding this is stating that if no other exit code has been provided and no other exit method is given -1 is used. If I am wrong on that assumption it would be great to get clarification.</p>\n\n<p>Which leaves me with wondering if this would be the same as calling <code>Environment.Exit(-1);</code>? \nIn both cases the ExitCode is being set to -1 to be reported to the operating system. Is reporting it directly by calling <code>Environment.Exit(-1);</code> undermining the ability of <code>Environment.ExitCode = -1;</code>? </p>\n"}, {"tags": ["c#", ".net", "pinvoke", "gac", "global-assembly-cache"], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1562807837, "post_id": 56977898, "comment_id": 100496631, "body": "Thank you @Alex, your approach is valid but unfortunately I&#39;m not allowed to load the assemblies I&#39;m analyzing in order to inspect if they are in the GAC. I&#39;ve updated my question"}, {"owner": {"reputation": 2933, "user_id": 10958092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fce4f18ec300414a8eb0aeb185fa3dea?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/10958092/alex"}, "reply_to_user": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1562844378, "post_id": 56977898, "comment_id": 100510729, "body": "@Lindsey1986, what about loading an assembly into a separate domain with following unloading? Like <code>var domain = AppDomain.CreateDomain(string.Empty);</code>, <code>var assembly = domain.Load(assemblyFullName);</code> and then <code>AppDomain.Unload(domain);</code>?"}, {"owner": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1562863237, "post_id": 56977898, "comment_id": 100521886, "body": "Thank you @Alex again, loading assemblies is out of the question for me... Even in a different app domain"}], "tags": [], "owner": {"reputation": 2933, "user_id": 10958092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fce4f18ec300414a8eb0aeb185fa3dea?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/10958092/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1562790752, "last_edit_date": 1562790752, "creation_date": 1562789162, "answer_id": 56977898, "question_id": 56976990, "link": "https://stackoverflow.com/questions/56976990/detect-if-a-specific-version-of-an-assembly-is-in-the-gac/56977898#56977898", "title": "Detect if a specific version of an assembly is in the GAC", "body": "<pre><code>static class AssemblyHelper\n{\n    public static bool AssemblyIsInGAC(string assemblyFullName)\n    {\n        try\n        {\n            var assembly = Assembly.ReflectionOnlyLoad(assemblyFullName);\n            return assembly.FullName == assemblyFullName &amp;&amp; // makes \"mscorlib, Version=wrong version ...\" work properly\n                assembly.GlobalAssemblyCache;\n        }\n        catch(FileNotFoundException)\n        {\n            return false;\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Usage:</strong></p>\n\n<pre><code>static void Main()\n{\n    Demo(\"mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\");\n    Demo(\"mscorlib, Version=wrong version, Culture=neutral, PublicKeyToken=b77a5c561934e089\");\n    Demo(\"msshrtmi, Version=2.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\");\n    Demo(\"msshrtmi, Version=2.6.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\");\n    Demo(\"msshrtmi, Version=2.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\");\n    Demo(\"msshrtmi, Version=2.8.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35\");\n}\n\nstatic void Demo(string assemblyFullName) =&gt;\n    Console.WriteLine($\"{assemblyFullName} is in GAC: {AssemblyHelper.AssemblyIsInGAC(assemblyFullName)}\");\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 is in GAC: True\nmscorlib, Version=wrong version, Culture=neutral, PublicKeyToken=b77a5c561934e089 is in GAC: False\nmsshrtmi, Version=2.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 is in GAC: True\nmsshrtmi, Version=2.6.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 is in GAC: True\nmsshrtmi, Version=2.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 is in GAC: True\nmsshrtmi, Version=2.8.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 is in GAC: False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1562863190, "post_id": 56984272, "comment_id": 100521863, "body": "Thank you @Simon Mourier. This is the approach I described in my question, but as you see in your <code>finalName</code> you&#39;re matching using a partial name... I need to match an exact version of an assembly and its strong name"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "reply_to_user": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1562865105, "post_id": 56984272, "comment_id": 100522772, "body": "@Lindsey1986 - you can enumerate (and possible cache) c:\\Windows\\assembly\\GAC GAC_32 GAC_64 and GAC_MSIL. Would that approach be ok?"}, {"owner": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1562887361, "post_id": 56984272, "comment_id": 100530486, "body": "How can I map <code>mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</code> to a file in the file system, with the exact version &amp; public key, without loading each assembly into an AppDomain?"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "reply_to_user": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1562909176, "post_id": 56984272, "comment_id": 100534456, "body": "@Lindsey1986 - You could enumerate all files in the GACs, determine their full name, w/o loading them, and build a dictionary name -&gt; filepath. That would take a bit of time, but it can be cached"}], "tags": [], "owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "is_accepted": false, "score": 1, "last_activity_date": 1562831839, "creation_date": 1562831839, "answer_id": 56984272, "question_id": 56976990, "link": "https://stackoverflow.com/questions/56976990/detect-if-a-specific-version-of-an-assembly-is-in-the-gac/56984272#56984272", "title": "Detect if a specific version of an assembly is in the GAC", "body": "<p>I use this utility, as you see it's modified for mscorlib or special assemblies:</p>\n\n<pre><code>Console.WriteLine(GetAssemblyPath(\"System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"));\n// dumps C:\\Windows\\Microsoft.Net\\assembly\\GAC_MSIL\\System\\v4.0_4.0.0.0__b77a5c561934e089\\System.dll\n\n...\n\npublic static string GetAssemblyPath(string name, bool matchClrVersion = true, bool throwOnError = false)\n{\n    if (name == null)\n        throw new ArgumentNullException(nameof(name));\n\n    string finalName = name;\n    var aInfo = new ASSEMBLY_INFO();\n    aInfo.cchBuf = 1024;\n    aInfo.pszCurrentAssemblyPathBuf = new string('\\0', aInfo.cchBuf);\n\n    var hr = CreateAssemblyCache(out IAssemblyCache ac, 0);\n    if (hr &gt;= 0)\n    {\n        hr = ac.QueryAssemblyInfo(0, finalName, ref aInfo);\n        if (hr &lt; 0 &amp;&amp; matchClrVersion)\n        {\n            var asmName = new AssemblyName(name);\n            finalName = asmName.Name + \", Version=\" + Environment.Version.Major + \".\" + Environment.Version.Minor;\n            aInfo.pszCurrentAssemblyPathBuf = new string('\\0', aInfo.cchBuf);\n            hr = ac.QueryAssemblyInfo(0, finalName, ref aInfo);\n        }\n    }\n\n    if (hr &lt; 0)\n    {\n        if (throwOnError)\n            Marshal.ThrowExceptionForHR(hr);\n\n        return null;\n    }\n\n    return aInfo.pszCurrentAssemblyPathBuf;\n}\n\n[InterfaceType(ComInterfaceType.InterfaceIsIUnknown), Guid(\"e707dcde-d1cd-11d2-bab9-00c04f8eceae\")]\nprivate interface IAssemblyCache\n{\n    void UninstallAssembly(); // not fully defined\n\n    [PreserveSig]\n    int QueryAssemblyInfo(int flags, [MarshalAs(UnmanagedType.LPWStr)] string assemblyName, ref ASSEMBLY_INFO assemblyInfo);\n}\n\n[StructLayout(LayoutKind.Sequential)]\nprivate struct ASSEMBLY_INFO\n{\n    public int cbAssemblyInfo;\n    public int dwAssemblyFlags;\n    public long uliAssemblySizeInKB;\n    [MarshalAs(UnmanagedType.LPWStr)]\n    public string pszCurrentAssemblyPathBuf;\n    public int cchBuf;\n}\n\n[DllImport(\"fusion\")]\nprivate static extern int CreateAssemblyCache(out IAssemblyCache ppAsmCache, int reserved);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1563230126, "post_id": 57021421, "comment_id": 100623084, "body": "Thank you @Castorix! That seems to be exactly what I&#39;m looking for! I&#39;m not able to compile the sample code you referenced, though. I don&#39;t have the definition of <code>HRESULT</code>. What is it? <code>The type or namespace name &#39;HRESULT&#39; could not be found</code>"}, {"owner": {"reputation": 1239, "user_id": 4452971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/og0oX.png?s=128&g=1", "display_name": "Castorix", "link": "https://stackoverflow.com/users/4452971/castorix"}, "reply_to_user": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1563231078, "post_id": 57021421, "comment_id": 100623264, "body": "@Lindsey1986 Ah, sorry I forgot it : I just added it to declarations..."}, {"owner": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "edited": false, "score": 0, "creation_date": 1563234839, "post_id": 57021421, "comment_id": 100623958, "body": "Thank you @Castorix! That&#39;s exactly what I needed! :)"}], "tags": [], "owner": {"reputation": 1239, "user_id": 4452971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/og0oX.png?s=128&g=1", "display_name": "Castorix", "link": "https://stackoverflow.com/users/4452971/castorix"}, "is_accepted": true, "score": 1, "last_activity_date": 1563231029, "last_edit_date": 1563231029, "creation_date": 1563039070, "answer_id": 57021421, "question_id": 56976990, "link": "https://stackoverflow.com/questions/56976990/detect-if-a-specific-version-of-an-assembly-is-in-the-gac/57021421#57021421", "title": "Detect if a specific version of an assembly is in the GAC", "body": "<p>You can use <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winsxs/nf-winsxs-createassemblynameobject\" rel=\"nofollow noreferrer\">CreateAssemblyNameObject</a> and <a href=\"http://CreateAssemblyEnum\" rel=\"nofollow noreferrer\">CreateAssemblyEnum</a></p>\n\n<p>For example =></p>\n\n<pre><code>            IAssemblyEnum pAssemblyEnum = null;\n            IAssemblyName pAssemblyName = null;\n            HRESULT hr = HRESULT.E_FAIL;\n            string sAssemblyName = \"mscorlib\";\n            hr = CreateAssemblyNameObject(out pAssemblyName, sAssemblyName, 0, IntPtr.Zero);\n            if (hr == HRESULT.S_OK)\n            {\n                hr = CreateAssemblyEnum(out pAssemblyEnum, IntPtr.Zero, pAssemblyName, ASM_CACHE_FLAGS.ASM_CACHE_GAC,  IntPtr.Zero);\n                if (hr == HRESULT.S_OK)\n                {\n                    while (pAssemblyEnum.GetNextAssembly(IntPtr.Zero, out pAssemblyName, 0) == 0 &amp;&amp; pAssemblyName != null)\n                    {\n                        int nSize = 260;\n                        StringBuilder sbDisplayName = new StringBuilder(nSize);\n                        hr = pAssemblyName.GetDisplayName(sbDisplayName, ref nSize, ASM_DISPLAY_FLAGS.ASM_DISPLAYF_FULL);\n                        Console.WriteLine(\"Display Name: {0}\", sbDisplayName.ToString());\n                     }\n                    Marshal.ReleaseComObject(pAssemblyEnum);\n                }\n            }\n</code></pre>\n\n<p>I get (I have put the full name, you can reduce it to filter with a string as a function parameter) :</p>\n\n<pre><code>Display Name: mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=AMD64\nDisplay Name: mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=x86\nDisplay Name: mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=AMD64\nDisplay Name: mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=x86\n</code></pre>\n\n<p>with declarations =></p>\n\n<pre><code>    public enum HRESULT : int\n    {\n        S_OK = 0,\n        S_FALSE = 1,\n        E_NOINTERFACE = unchecked((int)0x80004002),\n        E_NOTIMPL = unchecked((int)0x80004001),\n        E_FAIL = unchecked((int)0x80004005),\n    }        \n\n    [Guid(\"21b8916c-f28e-11d2-a473-00c04f8ef448\")]\n    [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\n    public interface IAssemblyEnum\n    {\n        HRESULT GetNextAssembly(IntPtr pvReserved, out IAssemblyName ppName, int dwFlags);\n        HRESULT  Reset();\n        HRESULT  Clone(out IAssemblyEnum ppEnum);\n    }\n\n    public enum ASM_CACHE_FLAGS\n    {\n        ASM_CACHE_ZAP = 0x01,\n        ASM_CACHE_GAC = 0x02,\n        ASM_CACHE_DOWNLOAD = 0x04,\n        ASM_CACHE_ROOT = 0x08,\n        ASM_CACHE_ROOT_EX = 0x80\n    }\n\n    [DllImport(\"Fusion.dll\", SetLastError = true)]\n    public static extern HRESULT CreateAssemblyEnum(out IAssemblyEnum pEnum, IntPtr pUnkReserved, IAssemblyName pName, ASM_CACHE_FLAGS dwFlags, IntPtr pvReserved);\n\n    [Guid(\"CD193BC0-B4BC-11d2-9833-00C04FC31D2E\")]\n    [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]\n    public interface IAssemblyName\n    {\n        HRESULT SetProperty(int PropertyId, IntPtr pvProperty, int cbProperty);\n        HRESULT GetProperty(int PropertyId,  out IntPtr pvProperty, ref int pcbProperty);\n        HRESULT Finalize();\n        HRESULT GetDisplayName(StringBuilder szDisplayName,  ref int pccDisplayName, ASM_DISPLAY_FLAGS dwDisplayFlags);\n        HRESULT Reserved([In, MarshalAs(UnmanagedType.LPStruct)] Guid refIID, IntPtr pUnkReserved1, IntPtr pUnkReserved2, string szReserved, UInt64 llReserved,  IntPtr pvReserved, int cbReserved, out IntPtr ppReserved);\n        HRESULT GetName(ref  int lpcwBuffer, StringBuilder pwzName);\n        HRESULT GetVersion(out int pdwVersionHi, out int pdwVersionLow);\n        HRESULT IsEqual(IAssemblyName pName, int dwCmpFlags);\n        HRESULT Clone(out IAssemblyName pName);\n    }\n\n    public enum ASM_DISPLAY_FLAGS\n    {\n        ASM_DISPLAYF_VERSION = 0x1,\n        ASM_DISPLAYF_CULTURE = 0x2,\n        ASM_DISPLAYF_PUBLIC_KEY_TOKEN = 0x4,\n        ASM_DISPLAYF_PUBLIC_KEY = 0x8,\n        ASM_DISPLAYF_CUSTOM = 0x10,\n        ASM_DISPLAYF_PROCESSORARCHITECTURE = 0x20,\n        ASM_DISPLAYF_LANGUAGEID = 0x40,\n        ASM_DISPLAYF_RETARGET = 0x80,\n        ASM_DISPLAYF_CONFIG_MASK = 0x100,\n        ASM_DISPLAYF_MVID = 0x200,\n        ASM_DISPLAYF_CONTENT_TYPE = 0x400,\n        ASM_DISPLAYF_FULL = (((((ASM_DISPLAYF_VERSION | ASM_DISPLAYF_CULTURE) | ASM_DISPLAYF_PUBLIC_KEY_TOKEN) | ASM_DISPLAYF_RETARGET) | ASM_DISPLAYF_PROCESSORARCHITECTURE) | ASM_DISPLAYF_CONTENT_TYPE)\n    }        \n\n    [DllImport(\"Fusion.dll\", SetLastError = true, CharSet = CharSet.Unicode)]\n    public static extern HRESULT CreateAssemblyNameObject(out IAssemblyName ppAssemblyNameObj, [MarshalAs(UnmanagedType.LPWStr)] string szAssemblyName, CREATE_ASM_NAME_OBJ_FLAGS flags,  IntPtr pvReserved);\n\n    public enum CREATE_ASM_NAME_OBJ_FLAGS\n    {\n        CANOF_PARSE_DISPLAY_NAME = 0x1,\n        CANOF_SET_DEFAULT_VALUES = 0x2,\n        CANOF_VERIFY_FRIEND_ASSEMBLYNAME = 0x4,\n        CANOF_PARSE_FRIEND_DISPLAY_NAME = (CANOF_PARSE_DISPLAY_NAME | CANOF_VERIFY_FRIEND_ASSEMBLYNAME)\n    }\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 5650824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0c26590559847ea09afb709465a4b98?s=128&d=identicon&r=PG&f=1", "display_name": "Lindsey1986", "link": "https://stackoverflow.com/users/5650824/lindsey1986"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 57021421, "answer_count": 3, "score": 0, "last_activity_date": 1563235072, "creation_date": 1562784816, "last_edit_date": 1563235072, "question_id": 56976990, "link": "https://stackoverflow.com/questions/56976990/detect-if-a-specific-version-of-an-assembly-is-in-the-gac", "title": "Detect if a specific version of an assembly is in the GAC", "body": "<p>I have a list of <strong>assembly fully qualified names</strong>, and I check if some <code>assembly</code> is in the <code>GAC</code> where my app is running.</p>\n\n<p>For example, I'm looking to do something like:</p>\n\n<pre><code>var result = AssemblyIsInGAC(\"mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\");\n</code></pre>\n\n<p>I've tried using the <code>fusion</code> API (<code>CreateAssemblyCache</code> and <code>QueryAssemblyInfo</code>), as it is described in <a href=\"http://www.herlitz.nu/blogposts/programmatically-check-if-an-assembly-is-loaded-in-gac-with-c/\" rel=\"nofollow noreferrer\">this blog post</a>, but unfortunately it only works with <strong>partial names of assemblies</strong></p>\n\n<p>If I call <code>QueryAssemblyInfo(\"mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\")</code>, it gives me a <code>FileNotFound</code> exception if I call it <code>QueryAssemblyInfo(\"mscorlib\")</code> it returns the latest version of <code>mscorlib</code>, which is not always the version I'm looking for.</p>\n\n<p>Any ideas on how I can do this?</p>\n\n<p>UPDATE: <strong>I cannot load the assembly into my app</strong> so cannot use <code>Assembly.Load</code>, <code>Assembly.ReflectionOnlyLoad</code>, etc.</p>\n"}, {"tags": ["c#", "excel", "csv", "export-to-csv"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562785875, "post_id": 56976934, "comment_id": 100490546, "body": "I can&#39;t help much, but it might be useful in troubleshooting to determine if the file is not being saved correctly, or if it is not being re-opened correctly.  In other words, if you open the csv file in a text editor, are the seconds there?  In Excel itself, if you go through that process, the file is saved correctly, and the value is correct when re-opened (although it is formatted as <code>m&#47;d&#47;yyy hh:mm</code>)"}, {"owner": {"reputation": 94, "user_id": 8929281, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gm0FP.png?s=128&g=1", "display_name": "DutchJelly", "link": "https://stackoverflow.com/users/8929281/dutchjelly"}, "edited": false, "score": 0, "creation_date": 1562786721, "post_id": 56976934, "comment_id": 100490894, "body": "One thing that you could always do, but would be annoying, is to serialize the DateTime objects to strings manually and then saving it to a csv file. That way you have control over how it&#39;s serialized."}, {"owner": {"reputation": 1610, "user_id": 8451520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wc4e0.png?s=128&g=1", "display_name": "ivcubr", "link": "https://stackoverflow.com/users/8451520/ivcubr"}, "edited": false, "score": 1, "creation_date": 1562788506, "post_id": 56976934, "comment_id": 100491618, "body": "I tried it using the code you provided and it worked both ways. Can you post more detail with what your inputs and outputs are?"}, {"owner": {"reputation": 2573, "user_id": 1207289, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/000ce6bf0fc5388af955b7c43ff366fc?s=128&d=identicon&r=PG", "display_name": "user1207289", "link": "https://stackoverflow.com/users/1207289/user1207289"}, "edited": false, "score": 0, "creation_date": 1562799719, "post_id": 56976934, "comment_id": 100495146, "body": "few of my inputs are <code>7&#47;10&#47;2019  2:01:39 PM,   7&#47;10&#47;2019  1:12:00 PM,  7&#47;10&#47;2019  12:44:58 PM</code> and corresponding outputs in csv file are <code>7&#47;10&#47;2019  2:01:00 PM,   7&#47;10&#47;2019  1:12:00 PM,  7&#47;10&#47;2019  12:44:00 PM</code>"}, {"owner": {"reputation": 1610, "user_id": 8451520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wc4e0.png?s=128&g=1", "display_name": "ivcubr", "link": "https://stackoverflow.com/users/8451520/ivcubr"}, "edited": false, "score": 0, "creation_date": 1562848520, "post_id": 56976934, "comment_id": 100513273, "body": "@user1207289 I think I was able to reproduce the issue correctly and proposed a solution below"}, {"owner": {"reputation": 2573, "user_id": 1207289, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/000ce6bf0fc5388af955b7c43ff366fc?s=128&d=identicon&r=PG", "display_name": "user1207289", "link": "https://stackoverflow.com/users/1207289/user1207289"}, "reply_to_user": {"reputation": 1610, "user_id": 8451520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wc4e0.png?s=128&g=1", "display_name": "ivcubr", "link": "https://stackoverflow.com/users/8451520/ivcubr"}, "edited": false, "score": 0, "creation_date": 1562850588, "post_id": 56976934, "comment_id": 100514622, "body": "@ivcubr , yes , I was able to that. I just needed to add this  to the solution <code>worksheet.Columns[&quot;B&quot;].NumberFormat = &quot;mm&#47;dd&#47;yyyy hh:mm:ss&quot;;</code> . I&#39;ll upvote for your effort"}], "answers": [{"tags": [], "owner": {"reputation": 1610, "user_id": 8451520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wc4e0.png?s=128&g=1", "display_name": "ivcubr", "link": "https://stackoverflow.com/users/8451520/ivcubr"}, "is_accepted": false, "score": 2, "last_activity_date": 1562848485, "last_edit_date": 1592644375, "creation_date": 1562848485, "answer_id": 56989337, "question_id": 56976934, "link": "https://stackoverflow.com/questions/56976934/preserve-seconds-when-saving-excel-to-csv-txt/56989337#56989337", "title": "preserve seconds when saving excel to csv/txt", "body": "<p>I was able to reproduce the issue by following the steps outlined below. My proposed solution is at the end of the answer, but I am adding the steps I used to reproduce the issue for completeness. The examples I used are as follows:</p>\n<blockquote>\n<p>7/10/2019 2:01:39 PM</p>\n<p>7/10/2019 1:12:11 PM</p>\n<p>7/10/2019 12:44:58 PM</p>\n</blockquote>\n<ol>\n<li>Create new Excel document and add three example dates as shown below. This is using the default date format from pasting the examples provided in the comments above.</li>\n</ol>\n<p><a href=\"https://i.stack.imgur.com/Avv1g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Avv1g.png\" alt=\"Example Excel data\" /></a></p>\n<ol start=\"2\">\n<li>Run the following code to save as a CSV and text file</li>\n</ol>\n<hr />\n<pre><code>_Application excel = (_Application)Marshal.GetActiveObject(&quot;Excel.Application&quot;);\nexcel.ActiveWorkbook.SaveAs(&quot;test.csv&quot;, XlFileFormat.xlCSVWindows);\nexcel.ActiveWorkbook.SaveAs(&quot;test.txt&quot;, XlFileFormat.xlUnicodeText, XlSaveAsAccessMode.xlNoChange, XlSaveConflictResolution.xlLocalSessionChanges);\n</code></pre>\n<ol start=\"3\">\n<li>Output showing the result the OP was getting</li>\n</ol>\n<p><a href=\"https://i.stack.imgur.com/dlm0w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dlm0w.png\" alt=\"Output results\" /></a></p>\n<hr />\n<p>The solution I found was to update the formatting of the cells before exporting. For instance, if all the dates are in the first row, the following will change the formatting to display the date as desired.</p>\n<pre><code>Range range = excel.Cells[1,1];\nrange.EntireColumn.NumberFormat = &quot;MM/DD/YYYY hh:mm:ss&quot;;\n</code></pre>\n<p>The full solution . Note the call to <code>SaveAs</code> will save in the default folder which for me was my documents folder, not the executing directory.</p>\n<pre><code>_Application excel = (_Application)Marshal.GetActiveObject(&quot;Excel.Application&quot;);\n\nRange range = excel.Cells[1,1];\nrange.EntireColumn.NumberFormat = &quot;MM/DD/YYYY hh:mm:ss&quot;;\n\nexcel.ActiveWorkbook.SaveAs(&quot;test.csv&quot;, XlFileFormat.xlCSVWindows);\nexcel.ActiveWorkbook.SaveAs(&quot;test.txt&quot;, XlFileFormat.xlUnicodeText, XlSaveAsAccessMode.xlNoChange, XlSaveConflictResolution.xlLocalSessionChanges);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2573, "user_id": 1207289, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/000ce6bf0fc5388af955b7c43ff366fc?s=128&d=identicon&r=PG", "display_name": "user1207289", "link": "https://stackoverflow.com/users/1207289/user1207289"}, "is_accepted": true, "score": 0, "last_activity_date": 1562850841, "creation_date": 1562850841, "answer_id": 56990100, "question_id": 56976934, "link": "https://stackoverflow.com/questions/56976934/preserve-seconds-when-saving-excel-to-csv-txt/56990100#56990100", "title": "preserve seconds when saving excel to csv/txt", "body": "<p>I had  to format column before I save as csv. I just needed to add this </p>\n\n<p><code>worksheet.Columns[\"B\"].NumberFormat = \"mm/dd/yyyy hh:mm:ss\";</code></p>\n"}], "owner": {"reputation": 2573, "user_id": 1207289, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/000ce6bf0fc5388af955b7c43ff366fc?s=128&d=identicon&r=PG", "display_name": "user1207289", "link": "https://stackoverflow.com/users/1207289/user1207289"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "accepted_answer_id": 56990100, "answer_count": 2, "score": 0, "last_activity_date": 1562850841, "creation_date": 1562784589, "last_edit_date": 1562846659, "question_id": 56976934, "link": "https://stackoverflow.com/questions/56976934/preserve-seconds-when-saving-excel-to-csv-txt", "title": "preserve seconds when saving excel to csv/txt", "body": "<p>When I am saving an exported Excel file as a CSV or text file, the seconds are lost  in <code>DateTime</code> data . For example, if <code>7/10/2019  2:01:39 PM</code> is shown in Excel, and I save it as a CSV, when I open the CSV, I am  seeing <code>7/10/2019  2:01:00 PM</code>.</p>\n\n<p>I am using <code>Office.Interop.Excel</code> to save an opened Excel file to CSV. And then opening the CSV file. </p>\n\n<p>This behavior is same if I save Excel file as a txt and then open txt file.</p>\n\n<p>How can I preserve seconds when I save an excel file as csv or txt?</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>excel = System.Runtime.InteropServices.Marshal.GetActiveObject(\"Excel.Application\") as Excel.Application;\n\n//for csv save\nexcel.ActiveWorkbook.SaveAs(toFile, Excel.XlFileFormat.xlCSVWindows); \n\n//for txt save\nexcel.ActiveWorkbook.SaveAs(toFile, FileFormat: Excel.XlFileFormat.xlUnicodeText,\n    AccessMode: Excel.XlSaveAsAccessMode.xlNoChange,\n    ConflictResolution: Excel.XlSaveConflictResolution.xlLocalSessionChanges);\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml", "visual-studio-2019"], "comments": [{"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 1, "creation_date": 1562792715, "post_id": 56976916, "comment_id": 100493240, "body": "See here: <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/xaml-services/markup-extensions-for-xaml-overview?view=netframework-4.8#defining-the-support-type-for-a-custom-markup-extension\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/framework/xaml-services/&hellip;</a>"}, {"owner": {"reputation": 4421, "user_id": 774575, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/I2J58.png?s=128&g=1", "display_name": "mins", "link": "https://stackoverflow.com/users/774575/mins"}, "reply_to_user": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1562793387, "post_id": 56976916, "comment_id": 100493466, "body": "@Clemens: Makes sense, but I wouldn&#39;t have been able to find it myself. If you write an answer, I&#39;ll accept it. Thanks."}], "owner": {"reputation": 4421, "user_id": 774575, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/I2J58.png?s=128&g=1", "display_name": "mins", "link": "https://stackoverflow.com/users/774575/mins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562784523, "creation_date": 1562784523, "question_id": 56976916, "link": "https://stackoverflow.com/questions/56976916/markupextension-derived-class-name-using-a-partial-name-to-reference-it-later-i", "title": "MarkupExtension derived class name: Using a partial name to reference it later is valid. What&#39;s the point?", "body": "<p>Using VS 2019. I'm surprised the name of a markup extension can be abbreviated as visible in this code which compiles and runs correctly.</p>\n\n<p>In assembly <code>CustMarkExt</code>, I define the markup extension type as <code>MyExtension</code>:</p>\n\n<pre><code>using System.Windows.Markup;\nnamespace CustMarkExt {\n    public class MyExtension : MarkupExtension {\n        public override object ProvideValue (IServiceProvider serviceProvider) {\n            return \"42/42\";\n        }\n    }\n}\n</code></pre>\n\n<p>In assembly <code>TestMyExtension</code> I refer to it as <code>My</code> (instead of expected <code>MyExtension</code>):</p>\n\n<pre><code>&lt;Window x:Class=\"TestMyExtension.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n        xmlns:local=\"clr-namespace:TestMyExtension\"\n        xmlns:myex=\"clr-namespace:CustMarkExt;assembly=CustMarkExt\"\n        mc:Ignorable=\"d\"\n        Title=\"MainWindow\" Height=\"450\" Width=\"800\"&gt;\n    &lt;Grid&gt;\n        &lt;TextBlock Text=\"{myex:My}\" /&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>To run the code two references are to be added:</p>\n\n<ul>\n<li>add reference to <code>system.xaml</code> in the extension assembly</li>\n<li>add reference to the extension in the other assembly</li>\n</ul>\n\n<p>So what doesn't that mean? It doesn't seems to be a bug.</p>\n"}, {"tags": ["c#", "oop", "inheritance", "polymorphism", "overloading"], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 8777764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976b291d7a69fb514e2832a60fd40f1?s=128&d=identicon&r=PG&f=1", "display_name": "A.khaled", "link": "https://stackoverflow.com/users/8777764/a-khaled"}, "edited": false, "score": 0, "creation_date": 1562785486, "post_id": 56977077, "comment_id": 100490391, "body": "Thanks for your answer. But actually The list contains different Types of blocks so I guess it is impossible without editing the Block class."}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "reply_to_user": {"reputation": 355, "user_id": 8777764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976b291d7a69fb514e2832a60fd40f1?s=128&d=identicon&r=PG&f=1", "display_name": "A.khaled", "link": "https://stackoverflow.com/users/8777764/a-khaled"}, "edited": false, "score": 0, "creation_date": 1562786282, "post_id": 56977077, "comment_id": 100490710, "body": "In that case you could have a method or class that returns a <code>BlockWriter&lt;T&gt;</code> for a given type of block - for example, <code>GetBlockWriter(Block block)</code>. That method would contain unfortunate type checking, and you&#39;d probably want to return a default or <code>NullBlockWriter</code> if the type of <code>Block</code> is unsupported. But at least then the rest of your code would be polymorphic."}, {"owner": {"reputation": 10220, "user_id": 70104, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/859c44ae8a94cf8def8a9728369fcd2e?s=128&d=identicon&r=PG", "display_name": "Chris Dunaway", "link": "https://stackoverflow.com/users/70104/chris-dunaway"}, "edited": false, "score": 1, "creation_date": 1562788036, "post_id": 56977077, "comment_id": 100491410, "body": "Did you mean to use the same block writer in each of your <code>if</code> statements?  (i. e. all <code>TextBlock</code>)?"}], "tags": [], "owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "is_accepted": false, "score": 2, "last_activity_date": 1562788094, "last_edit_date": 1562788094, "creation_date": 1562785195, "answer_id": 56977077, "question_id": 56976871, "link": "https://stackoverflow.com/questions/56976871/can-a-subclass-be-downcast-while-sent-as-a-parameter-to-an-overloaded-function/56977077#56977077", "title": "Can A subclass be downcast while sent as a parameter to an overloaded function", "body": "<p>No. Given this:</p>\n\n<pre><code>public void WriteBlocks(List&lt;Block&gt; blocks)\n</code></pre>\n\n<p>the only thing the compiler knows about each item in the list is that it is a <code>Block</code>. That's all it should know. That's what makes polymorphism possible. There can be any number of classes that inherit from <code>Block</code>, but within this context those distinctions don't matter.</p>\n\n<p>But if all the compiler knows is that each item is a <code>Block</code>, it can't know whether any individual item might be a <code>TableBlock</code>, <code>TextBlock</code>, or some other inherited type. If, at compile time, it doesn't know what the runtime type will be, it can't know whether there even is an overload for that specific type.</p>\n\n<p>Suppose what you're trying to do could compile, because you have an overload for every type that inherited from <code>Block</code>. What would or should happen if you added a new type - <code>class PurpleBlock : Block</code> - and there was no overload for it? Should this no longer compile just because you added a new type?</p>\n\n<p>If the method that <em>calls</em> <code>WriteBlocks</code> knows what sort of <code>Block</code> is in the list, then it can supply that information:</p>\n\n<pre><code>public void WriteBlocks&lt;TBlock&gt;(List&lt;TBlock&gt; blocks) where TBlock : Block\n</code></pre>\n\n<p>Now you can call <code>WriteBlock&lt;TextBlock&gt;(listOfTextBlocks)</code> and the compiler will know that each item in the list is a <code>TextBlock</code>, not just a <code>Block</code>.</p>\n\n<p>It follows, then, that <code>BlockWriter</code> would have to be generic also so that you could have different implementations for different types of <code>Block</code>. It might make more sense to inject it. Either way, you're likely to perceive that you've \"moved\" the problem. If the class that calls <code>WriteBlocks</code> \"knows\" the type of the <code>Block</code>, then it might make more sense for that method to determine the type of <code>BlockWriter</code> to use. </p>\n\n<hr>\n\n<p>As mentioned in your comment, the list might include different types of <code>Block</code>, not just one. That requires either a method or a class that returns a specific <code>BlockWriter</code> depending on the type of <code>Block</code>. That means runtime type-checking, which isn't ideal, but it's not too bad if you keep it in one place. </p>\n\n<p>Here's a simple example:</p>\n\n<pre><code>public class BlockWriterFactory\n{\n    public BlockWriter GetBlockWriter(Block block)\n    {\n        if (block is TextBlock)\n            return new TextBlockWriter();\n\n        if (block is TableBlock)\n            return new TableBlockWriter();\n\n        if (block is ListBlock)\n            return new ListBlockWriter();\n\n        // this could be a \"null\" class or some fallback\n        // default implementation. You could also choose to\n        // throw an exception.\n        return new NullBlockWriter();\n    }\n}\n</code></pre>\n\n<p>(A <code>NullBlockWriter</code> would just be a class that does nothing when you call its <code>Write</code> method.)</p>\n\n<p>This sort of type-checking isn't ideal, but at least this keeps it isolated into one class. Now you can create (or inject) an instance of the factory, and call <code>GetBlockWriter</code>, and the rest of your code in that method still wouldn't \"know\" anything about the different types of <code>Block</code> or <code>BlockWriter</code>.</p>\n\n<pre><code>BlockWriter w = new BlockWriter();\n</code></pre>\n\n<p>would become</p>\n\n<pre><code>BlockWriter w = blockWriterFactory.GetBlockWriter(block);\n</code></pre>\n\n<p>...and then the rest would still be the same.</p>\n\n<p>That's the simplest possible factory example. There are other approaches to creating such a factory. You could store all of your implementations in a <code>Dictionary&lt;Type, BlockWriter&gt;</code> and attempt to retrieve an instance using <code>block.GetType()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 8777764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976b291d7a69fb514e2832a60fd40f1?s=128&d=identicon&r=PG&f=1", "display_name": "A.khaled", "link": "https://stackoverflow.com/users/8777764/a-khaled"}, "edited": false, "score": 0, "creation_date": 1562787263, "post_id": 56977238, "comment_id": 100491091, "body": "Thanks. It Actually Worked !!"}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 1, "creation_date": 1562787803, "post_id": 56977238, "comment_id": 100491317, "body": "Generally speaking I wouldn&#39;t use <code>dynamic</code> unless you&#39;re backed into a corner and have no other choice. It&#39;s often a sign that we&#39;re working against, not with, the compiler. It&#39;s also a bit similar to &quot;giving up&quot; and declaring things as <code>object</code>. Under 99% of normal circumstances when we&#39;re dealing with known types we shouldn&#39;t use <code>dynamic</code>."}, {"owner": {"reputation": 7658, "user_id": 3195477, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/PK4P1.jpg?s=128&g=1", "display_name": "StayOnTarget", "link": "https://stackoverflow.com/users/3195477/stayontarget"}, "reply_to_user": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 0, "creation_date": 1562790256, "post_id": 56977238, "comment_id": 100492289, "body": "@ScottHannen I agree, hence my comments about refactoring the class structure. In this case the OP mentioned that some classes are outside their control so perhaps it is a valid case for it."}], "tags": [], "owner": {"reputation": 7658, "user_id": 3195477, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/PK4P1.jpg?s=128&g=1", "display_name": "StayOnTarget", "link": "https://stackoverflow.com/users/3195477/stayontarget"}, "is_accepted": true, "score": 2, "last_activity_date": 1562790296, "last_edit_date": 1562790296, "creation_date": 1562786021, "answer_id": 56977238, "question_id": 56976871, "link": "https://stackoverflow.com/questions/56976871/can-a-subclass-be-downcast-while-sent-as-a-parameter-to-an-overloaded-function/56977238#56977238", "title": "Can A subclass be downcast while sent as a parameter to an overloaded function", "body": "<p>Yes, it is possible using the <code>dynamic</code> type which allows for this.</p>\n\n<p>If you use:</p>\n\n<pre><code>        foreach (var block in blocks)\n        {\n            w.WriteBlock(block as dynamic);\n        }\n</code></pre>\n\n<p>It should call the intended <code>WriteBlock</code> overload.</p>\n\n<p>This is described in greater length in another question: <a href=\"https://stackoverflow.com/a/40618674/3195477\">https://stackoverflow.com/a/40618674/3195477</a></p>\n\n<p>And also here: <a href=\"https://stackoverflow.com/questions/5835989/method-overloading-and-dynamic-keyword-in-c-sharp\">method overloading and dynamic keyword in C#</a>.</p>\n\n<hr>\n\n<p>Caveats:</p>\n\n<p>I am not sure if there is any runtime penalty associated with this type of <code>dynamic</code> \"cast\". </p>\n\n<p>Also whenever I see this pattern it makes me wonder if the class hierarchy could be improved. i.e., should whatever <code>WriteBlock</code> will do actually be moved inside the <code>Block</code> classes? That might be \"more polymorphic\". Also using <code>dynamic</code> could be a somewhat fragile approach, as you can add new <code>Block</code> derived types and forget to an an overloaded <code>WriteBlock</code> for them, which may cause an error. (This is more evidence that some of <code>WriteBlock</code> should be incorporated into the <code>Block</code> classes themselves).</p>\n\n<p>For instance, add a <code>virtual</code> <code>PrepareForWriting()</code> to the base <code>Block</code> class, which returns a <code>BlockWritable</code>. Then you only need one <code>WriteBlock(BlockWritable data)</code> to do the writing work. <code>BlockWritable</code> could be a string, Json, XML, etc. This assumes you are able to modify the <code>Block</code> classes (which it seems you cannot).</p>\n"}], "owner": {"reputation": 355, "user_id": 8777764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0976b291d7a69fb514e2832a60fd40f1?s=128&d=identicon&r=PG&f=1", "display_name": "A.khaled", "link": "https://stackoverflow.com/users/8777764/a-khaled"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 56977238, "answer_count": 2, "score": 3, "last_activity_date": 1562790296, "creation_date": 1562784308, "question_id": 56976871, "link": "https://stackoverflow.com/questions/56976871/can-a-subclass-be-downcast-while-sent-as-a-parameter-to-an-overloaded-function", "title": "Can A subclass be downcast while sent as a parameter to an overloaded function", "body": "<p>I have a superClass called Block and another 3 subclasses. the class I want to implement contains 3 overloaded functions each one takes an object of one of the subclasses as a parameter. When I use one of these function, I only have a Block object (An object from the superClass). My question is what is the cleanest way to choose which function to call.</p>\n\n<p>What I did until now is if conditions on the object type then casting it. but it seems unclean.</p>\n\n<p>Those are the overloaded functions.</p>\n\n<pre><code>        public void WriteBlock(TableBlock block) { }\n        public void WriteBlock(TextBlock block) { }\n        public void WriteBlock(ListBlock block) { }\n</code></pre>\n\n<p>And This is The function I want to implement.</p>\n\n<pre><code>        public void WriteBlocks(List&lt;Block&gt; blocks)\n        {\n            BlockWriter w = new BlockWriter();\n\n            foreach (var block in blocks)\n            {\n                w.WriteBlock(block);\n            }\n        }\n</code></pre>\n\n<p>Note that I have no access on the Blocks classes.</p>\n"}, {"tags": ["c#", "wpf", "data-binding", "code-behind", "ivalueconverter"], "answers": [{"tags": [], "owner": {"reputation": 77, "user_id": 11579674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZVPYC.png?s=128&g=1", "display_name": "Zacary C", "link": "https://stackoverflow.com/users/11579674/zacary-c"}, "is_accepted": true, "score": 0, "last_activity_date": 1562785861, "creation_date": 1562785861, "answer_id": 56977211, "question_id": 56976828, "link": "https://stackoverflow.com/questions/56976828/how-to-assign-displaymemberbinding-converter-in-the-c-code/56977211#56977211", "title": "How to assign DisplayMemberBinding converter in the c# code", "body": "<p>Alright, I figured it out. \nI was trying to just put </p>\n\n<pre><code>visibilityBinding.Converter = myConverterClass;\n</code></pre>\n\n<p>but in reality I needed to simply put</p>\n\n<pre><code>visibilityBinding.Converter = new myConverterClass();\n</code></pre>\n\n<p>I hope this can help someone in the future.</p>\n"}], "owner": {"reputation": 77, "user_id": 11579674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZVPYC.png?s=128&g=1", "display_name": "Zacary C", "link": "https://stackoverflow.com/users/11579674/zacary-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 56977211, "answer_count": 1, "score": 0, "last_activity_date": 1595358964, "creation_date": 1562784076, "last_edit_date": 1595358964, "question_id": 56976828, "link": "https://stackoverflow.com/questions/56976828/how-to-assign-displaymemberbinding-converter-in-the-c-code", "title": "How to assign DisplayMemberBinding converter in the c# code", "body": "<p>I have a <code>GridViewColumn</code> and I want to assign to its <code>DisplayMemberBinding</code> property a converter. I am able to do it in XAML, but I would like to add it from the code-behind for personals reasons. </p>\n\n<p>When I try to assign my converter in the code it says that I need a <code>IValueConverter</code> type, but it is an interface and not an object that I can create. I am able to take the converter from an other <code>GridViewColumn</code>, but I won't always have the converter that I want assigned to another one.</p>\n\n<pre><code>&lt;!-- XAML code that works and that I want to implement in the code-behind --&gt;\n&lt;GridViewColumn x:Name=\"intensityColumnStatus\" Header=\"Intensity\" DisplayMemberBinding=\"{Binding Intensity,Converter={StaticResource converter}}\" /&gt;\n\n// Code-behind that I can't get to work\nBinding visibilityBinding = new Binding(\"isPlaneComing\");\nvisibilityBinding.Converter = ???;\n</code></pre>\n\n<p>I know that I'm maybe missing some information, so if you need more, please just ask :)</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 1, "creation_date": 1562784328, "post_id": 56976812, "comment_id": 100489919, "body": "It shouldn&#39;t, see <a href=\"https://stackoverflow.com/questions/28224595/filesystemwatcher-locks-folder\" title=\"filesystemwatcher locks folder\">stackoverflow.com/questions/28224595/&hellip;</a>. Can you create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 79, "user_id": 8398997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ed6e5ebb7d3660c0c42491a11d311a?s=128&d=identicon&r=PG&f=1", "display_name": "ANaik", "link": "https://stackoverflow.com/users/8398997/anaik"}, "edited": false, "score": 0, "creation_date": 1562786108, "post_id": 56976812, "comment_id": 100490633, "body": "But Eric it is not specified for which kind of file changes you are adding filewatcher. You should use &#39;NotifyFilter&#39;. There are too many kind file attributes, which one you are planning target?"}, {"owner": {"reputation": 97, "user_id": 6517897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a38d15a72d96e5fe762b56f257f9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Eric P.", "link": "https://stackoverflow.com/users/6517897/eric-p"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1562787471, "post_id": 56976812, "comment_id": 100491166, "body": "@CodeCaster I read your link before, and it&#39;s not the same problem. On your link, it was caused by a second FileSystemWatcher. Mine is about the parents of the folder being watched. The two lines of code I wrote are enough to reproduce the problem, it is an actual minimal reproducible example."}, {"owner": {"reputation": 97, "user_id": 6517897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a38d15a72d96e5fe762b56f257f9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Eric P.", "link": "https://stackoverflow.com/users/6517897/eric-p"}, "reply_to_user": {"reputation": 79, "user_id": 8398997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ed6e5ebb7d3660c0c42491a11d311a?s=128&d=identicon&r=PG&f=1", "display_name": "ANaik", "link": "https://stackoverflow.com/users/8398997/anaik"}, "edited": false, "score": 0, "creation_date": 1562787516, "post_id": 56976812, "comment_id": 100491189, "body": "@ANaik of course in my code I fully configure it with NotifyFilters, events, etc...I kept it short to highlight the problem"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562788850, "post_id": 56976812, "comment_id": 100491763, "body": "@EricP. It&#39;s the same issue, the second watcher was looking at a subfolder and the OP was trying to rename the parent folder.  The issue in that question is not caused by having multiple watchers; it&#39;s caused by having <i>a</i> watcher watching a subfolder of a folder the user is trying to alter.  The accepted answer to that question isn&#39;t a good answer, though."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562789106, "post_id": 56976812, "comment_id": 100491849, "body": "<code>FileSystemWatcher</code> will get a lock on the parent folder structure, preventing deletions or renaming (which alters the tree structure) of any folder in the tree from root to the watched folder.  The only workaround is to not use a <code>FileSystemWatcher</code>: use a thread to check the folder for changes periodically."}, {"owner": {"reputation": 97, "user_id": 6517897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a38d15a72d96e5fe762b56f257f9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Eric P.", "link": "https://stackoverflow.com/users/6517897/eric-p"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562789145, "post_id": 56976812, "comment_id": 100491857, "body": "@Amy Right, but there is no solution on the post mentionned. The OP Marked his discovery related to the second FSW as solution, but it is of no help for me. The reason of my post is to know if there is a workaround or an alternative to this limitation."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562789173, "post_id": 56976812, "comment_id": 100491865, "body": "@EricP. I agree it isn&#39;t helpful; it is, however, the same issue."}, {"owner": {"reputation": 97, "user_id": 6517897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a38d15a72d96e5fe762b56f257f9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Eric P.", "link": "https://stackoverflow.com/users/6517897/eric-p"}, "edited": false, "score": 0, "creation_date": 1562789351, "post_id": 56976812, "comment_id": 100491922, "body": "What made me think there would be a solution is that FSW has an &#39;Error&#39; event, which should be triggered if the FSW is not able to monitor the folder anymore. To me that would happen if the parent&#39;d get deleted. Maybe someone knows a way to use the WINAPI to have the benefits of FSW without the drawbacks?"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 1, "creation_date": 1562789497, "post_id": 56976812, "comment_id": 100491983, "body": "@EricP. Internally, <code>FSW</code> has a private method <code>StartRaisingEvents</code> that has this line:  <code>directoryHandle = Microsoft.Win32.NativeMethods.CreateFile(directory, 1, 7, null, 3, 1107296256, new SafeFileHandle(IntPtr.Zero, ownsHandle: false));</code>  In Windows, file handles acquire a lock on the parent structure so the handle remains valid for the lifetime of the handle.  The issue isn&#39;t caused by <code>FSW</code> itself; it&#39;s caused by how the WINAPI works."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562789664, "post_id": 56976812, "comment_id": 100492044, "body": "@EricP. See <a href=\"https://github.com/microsoft/referencesource/blob/master/System/services/io/system/io/FileSystemWatcher.cs#L979\" rel=\"nofollow noreferrer\">github.com/microsoft/referencesource/blob/master/System/&hellip;</a>"}, {"owner": {"reputation": 97, "user_id": 6517897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a38d15a72d96e5fe762b56f257f9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Eric P.", "link": "https://stackoverflow.com/users/6517897/eric-p"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562790019, "post_id": 56976812, "comment_id": 100492186, "body": "@Amy Thank you very much."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562792673, "post_id": 56976812, "comment_id": 100493224, "body": "You&#39;re watching <code>@&quot;C:\\One\\Two\\Three&quot;</code>. Set the watcher to the upper-level directory, i.e., change it to <code>@&quot;C:\\One&quot;</code>. You won&#39;t lock its sub-directories (nor <code>@&quot;C:\\One&quot;</code>). Set <code>.IncludeSubdirectories = true</code> to receive notification on all the brach, or <code>.IncludeSubdirectories = false</code> to only be notified about <code>Two</code>. Include a <i>manual</i> filter if required."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562793262, "post_id": 56976812, "comment_id": 100493424, "body": "I can&#39;t see your code, but - if you haven&#39;t - call <code>fsw.EnableRaisingEvents = true;</code> after you have set everything else (including the handlers, of course), possibly in a <code>BeginInit()&#47;EndInit()</code> block."}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 8816314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n0YqT.jpg?s=128&g=1", "display_name": "Carlos Sanchez", "link": "https://stackoverflow.com/users/8816314/carlos-sanchez"}, "is_accepted": false, "score": 0, "last_activity_date": 1610503626, "creation_date": 1610503626, "answer_id": 65694700, "question_id": 56976812, "link": "https://stackoverflow.com/questions/56976812/filesystemwatcher-locks-parent-folder-is-there-a-fix-or-an-alternative/65694700#65694700", "title": "FileSystemWatcher locks parent folder, is there a fix or an alternative?", "body": "<p>@EricP gave the root cause: The FSW internally makes a call to CreateFileW to open a handle to the monitored directory Three, which tells Windows to prevent deleting the parent folders One and Two.</p>\n<p>But the CreateFileW call is made with read+write+delete sharing mode, meaning Windows should allow any other processes to delete the monitored folder Three.</p>\n<p>So there's no direct fix for your problem, but there is a workaround:</p>\n<p>Delete Three first, which should release the handle, then delete Two and/or One, which should be allowed.</p>\n<p>Here's a code sample reproing this without any FileSystemWatcher code, just direct Windows P/Invokes:</p>\n<pre class=\"lang-cs prettyprint-override\"><code>using Microsoft.Win32.SafeHandles;\nusing System;\nusing System.IO;\nusing System.Runtime.InteropServices;\n\nnamespace MyNamespace\n{\n    public static class MyClass\n    {\n\n        static void Main()\n        {\n            string path = @&quot;C:\\Users\\YOURUSERNAME\\Desktop\\parent\\child&quot;;\n\n            if (!Directory.Exists(path))\n            {\n                throw new Exception(&quot;Make sure to create the directories before testing.&quot;);\n            }\n\n            // This will lock the directory\n            SafeFileHandle _directoryHandle = CreateFile(\n                lpFileName: path,\n                dwDesiredAccess: 0x0001, //FILE_LIST_DIRECTORY\n                dwShareMode: FileShare.Read | FileShare.Delete | FileShare.Write,\n                dwCreationDisposition: FileMode.Open,\n                dwFlagsAndAttributes:\n                    0x02000000 /*FILE_FLAG_BACKUP_SEMANTICS*/ |\n                    0x40000000 /*FILE_FLAG_OVERLAPPED*/\n                );\n\n            Console.WriteLine(&quot;Try to manually delete the 'parent' directory using File Explorer. It should fail.&quot;);\n            Console.WriteLine(&quot;Now try to manually delete the 'child' directory, then the 'parent' directory, using File Explorer. It should succeed.&quot;);\n            Console.WriteLine(&quot;Press enter to exit.&quot;);\n            System.Diagnostics.Debugger.Break();\n\n            _directoryHandle.Dispose();\n        }\n\n        internal enum BOOL : int\n        {\n            FALSE = 0,\n            TRUE = 1,\n        }\n\n        [StructLayout(LayoutKind.Sequential)]\n        internal struct SECURITY_ATTRIBUTES\n        {\n            internal uint nLength;\n            internal IntPtr lpSecurityDescriptor;\n            internal BOOL bInheritHandle;\n        }\n\n        [DllImport(&quot;kernel32.dll&quot;, EntryPoint = &quot;CreateFileW&quot;, SetLastError = true, CharSet = CharSet.Unicode, BestFitMapping = false, ExactSpelling = true)]\n        private static extern unsafe SafeFileHandle CreateFilePrivate(\n            string lpFileName,\n            int dwDesiredAccess,\n            FileShare dwShareMode,\n            SECURITY_ATTRIBUTES* lpSecurityAttributes,\n            FileMode dwCreationDisposition,\n            int dwFlagsAndAttributes,\n            IntPtr hTemplateFile);\n\n        internal static unsafe SafeFileHandle CreateFile(\n            string lpFileName,\n            int dwDesiredAccess,\n            FileShare dwShareMode,\n            FileMode dwCreationDisposition,\n            int dwFlagsAndAttributes)\n        {\n            return CreateFilePrivate(lpFileName, dwDesiredAccess, dwShareMode, null, dwCreationDisposition, dwFlagsAndAttributes, IntPtr.Zero);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6517897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36a38d15a72d96e5fe762b56f257f9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Eric P.", "link": "https://stackoverflow.com/users/6517897/eric-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1610503626, "creation_date": 1562784011, "question_id": 56976812, "link": "https://stackoverflow.com/questions/56976812/filesystemwatcher-locks-parent-folder-is-there-a-fix-or-an-alternative", "title": "FileSystemWatcher locks parent folder, is there a fix or an alternative?", "body": "<p>Whether in .NET Core or .NET Framework, the use of a FileSystemWatcher on a folder makes it impossible to delete any parent folder with File Explorer.\nFile Explorer will ask you for admin rights. Launching File Explorer as admin doesn't fix the issue.</p>\n\n<p>The only way that I can make it work is to set the FileSystemWatcher to the root drive, and include subdirectories, which could lead to big performance issues, and a buffer overflow on the FSW.</p>\n\n<pre><code>FileSystemWatcher fsw = new FileSystemWatcher(@\"C:\\One\\Two\\Three\");\nfsw.EnableRaisingEvents = true;\n</code></pre>\n\n<p>You will not be able to delete folders 'One' or 'Two'.\nThe problem starts as soon as set 'EnableRaisingEvents' to true, but if you don't, you will not get any notification.</p>\n\n<p>Is there a way to overcome this problem, or an alternative to FileSystemWatcher?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1562784153, "post_id": 56976809, "comment_id": 100489840, "body": "With a 2 by 2 array you could just hard code the 4 possible results."}, {"owner": {"reputation": 11, "user_id": 11756974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNQ9ibkkDcA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resieV2COTmPIPcWnWe7MvLsgTs4g/photo.jpg?sz=128", "display_name": "Cube", "link": "https://stackoverflow.com/users/11756974/cube"}, "reply_to_user": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1562784265, "post_id": 56976809, "comment_id": 100489901, "body": "But what if the user enters a bunch of input like VHVHVHVHVHHHHVHVHVHVHVHHVHVHVHVVH..."}, {"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 1, "creation_date": 1562784399, "post_id": 56976809, "comment_id": 100489948, "body": "Your code already handles that by determining if there are an even or odd number of vertical and horizontal flips.  Then the result is either the same as the original; vertically flipped; horizontally flipped; or both.  You just hard code those 4 possible results instead of actually manipulating the array."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1562784946, "post_id": 56976809, "comment_id": 100490163, "body": "Code wise.... efficient would be a matrix multiplication. You can specify 1 multiplication function and use a flip-horizontal, flip-vertical ... or even more of those as multiplier...."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1562785050, "post_id": 56976809, "comment_id": 100490216, "body": "A very simple implementation can be found here: <a href=\"https://stackoverflow.com/questions/6311309/how-can-i-multiply-two-matrices-in-c\" title=\"how can i multiply two matrices in c\">stackoverflow.com/questions/6311309/&hellip;</a>"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1562785110, "post_id": 56976809, "comment_id": 100490248, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/6311309/how-can-i-multiply-two-matrices-in-c\">How can I multiply two matrices in C#?</a>"}], "owner": {"reputation": 11, "user_id": 11756974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FNQ9ibkkDcA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3resieV2COTmPIPcWnWe7MvLsgTs4g/photo.jpg?sz=128", "display_name": "Cube", "link": "https://stackoverflow.com/users/11756974/cube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562784003, "creation_date": 1562784003, "question_id": 56976809, "link": "https://stackoverflow.com/questions/56976809/efficient-way-to-flip-a-2d-array-horizontally-or-vertically", "title": "Efficient way to Flip a 2D Array Horizontally or Vertically", "body": "<p>The problem is to make a program the flips a 2D (2 by 2) array either horizontally(H) or vertically(V), depending on the input the user puts. For example, if the user puts \"HHHVVHVHV\", it means to flip 5 times horizontally, and 4 times vertically. The code I attached below works, but I am not sure if there is a built-in method in C# to flip arrays or an easier way to do it. </p>\n\n<pre><code>using System;\nusing System.Linq;\n\nnamespace _2019JuniorQ4\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            //Varables\n            int[,] grid = new int[2, 2] { { 1, 2 }, { 3, 4 } };\n            int[,] flippedGrid = new int[2, 2];\n            string input = \"\";\n            int h = 0;\n            int v = 0;\n            int flipHorizontal = 0;\n            int flipVertical = 0;\n            //Input\n            input = Console.ReadLine();\n            //Count number of times\n            for (int i=0; i&lt;input.Length; i++)\n            {\n                if (input[i] == Convert.ToChar(\"H\"))\n                {\n                    h++;\n                }\n                else if(input[i] == Convert.ToChar(\"V\"))\n                {\n                    v++;\n                }\n            }\n            //Process\n            flipHorizontal = h % 2;\n            flipVertical = v % 2;\n            //Vertical flip\n            if (flipVertical == 1)\n            {\n                for (int y = 0; y &lt; 2; y++)\n                {\n                    for (int x = 1; x &gt;= 0; x--)\n                    {\n                        flippedGrid[y, Math.Abs(x - 1)] = grid[y,x];\n                    }\n                }\n                grid = flippedGrid.Clone() as int[,];\n            }\n            //Horizontal Flip\n            if (flipHorizontal == 1)\n            {\n                for (int x = 0; x &lt; 2; x++)\n                {\n                    for (int y = 1; y &gt;= 0; y--)\n                    {\n                        flippedGrid[Math.Abs(y - 1), x] = grid[y,x];\n                    }\n                }\n                grid = flippedGrid.Clone() as int[,];\n            }\n            //Output\n            for (int x=0; x&lt;2; x++)\n            {\n                for (int y=0; y&lt;2; y++)\n                {\n                    Console.Write(grid[x,y]+\" \");\n                }\n                Console.WriteLine();\n            }           \n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "sqlite", "system.data.sqlite"], "comments": [{"owner": {"reputation": 1151, "user_id": 9748260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff9651774a7d2b50fe1d8d8ad30e57?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib Jundi", "link": "https://stackoverflow.com/users/9748260/sohaib-jundi"}, "edited": false, "score": 1, "creation_date": 1562784184, "post_id": 56976684, "comment_id": 100489860, "body": "BadImageFormatException is due to try to loading a non-compatible library, so I belive when you sat Platform to x64, the loaded library was x86. Keep in mind when importing libraries to match their platform. Any CPU is not specifically x86. To set it to x86, Project properties -&gt; Build -&gt; platform target = x86"}, {"owner": {"reputation": 71, "user_id": 8207505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b6ee4b8860a723918006a3f1cc54d96?s=128&d=identicon&r=PG&f=1", "display_name": "Scitosol", "link": "https://stackoverflow.com/users/8207505/scitosol"}, "reply_to_user": {"reputation": 1151, "user_id": 9748260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff9651774a7d2b50fe1d8d8ad30e57?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib Jundi", "link": "https://stackoverflow.com/users/9748260/sohaib-jundi"}, "edited": false, "score": 0, "creation_date": 1562785589, "post_id": 56976684, "comment_id": 100490431, "body": "Thanks for the response. I don&#39;t know what you mean by &quot;the loaded library was x86&quot;. Loaded in memory? Changing the platform was tried between runs of the application, not during. The platform target was definitely set to x64 when the run was made."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 8207505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b6ee4b8860a723918006a3f1cc54d96?s=128&d=identicon&r=PG&f=1", "display_name": "Scitosol", "link": "https://stackoverflow.com/users/8207505/scitosol"}, "edited": false, "score": 0, "creation_date": 1571159654, "post_id": 57047179, "comment_id": 103144675, "body": "Continuing the saga of my experiences with this assembly, you can also get this exception (&quot;Unable to find an entry point named &#39;sqlite3_open_interop&#39; in DLL &#39;SQLite.Interop.dll&#39;.&quot;) if SQLite.Interop.dll and System.Data.SQLite are not in the same output directory. I had the former in a subdirectory relative to the latter. If you see that the source of your exception is System.Data.SQLite, that may be the issue. The reason that SQLite.Interop.dll was in a subdirectory was that there are x86 and x64 versions, and I had thought I might need both. But now I will just go with the x86 version."}], "tags": [], "owner": {"reputation": 71, "user_id": 8207505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b6ee4b8860a723918006a3f1cc54d96?s=128&d=identicon&r=PG&f=1", "display_name": "Scitosol", "link": "https://stackoverflow.com/users/8207505/scitosol"}, "is_accepted": true, "score": 0, "last_activity_date": 1563224697, "creation_date": 1563224697, "answer_id": 57047179, "question_id": 56976684, "link": "https://stackoverflow.com/questions/56976684/unable-to-find-an-entry-point-named-sqlite3-open-interop-in-dll-sqlite-inter/57047179#57047179", "title": "&quot;Unable to find an entry point named &#39;sqlite3_open_interop&#39; in DLL &#39;SQLite.Interop.dll&#39;.&quot;", "body": "<p>It turned out the issue was that the assembly was being blocked or disrupted somehow by McAfee Host Intrusion Prevention. The Activity log had the following message:</p>\n\n<blockquote>\n  <p>Attack type: DISA McAfee - Prevent unexpected DLL files from Running\n  in User AppData and ProgramData folders (Sig Id = 7020)</p>\n</blockquote>\n\n<p>Which is odd because I don't think my program was executing in either such folder; in fact, there are no such folders, as I am looking at the matter. I was able to fix the issue by moving the program to My Documents. </p>\n\n<p>It's also notable that the exception made no hint of interference by a security scanner.</p>\n\n<p>Sigh. I don't know how generally useful this answer is, but I will leave it here. It might help someone. The admins can remove it if they deem appropriate.</p>\n"}], "owner": {"reputation": 71, "user_id": 8207505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b6ee4b8860a723918006a3f1cc54d96?s=128&d=identicon&r=PG&f=1", "display_name": "Scitosol", "link": "https://stackoverflow.com/users/8207505/scitosol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1117, "favorite_count": 0, "accepted_answer_id": 57047179, "answer_count": 1, "score": 0, "last_activity_date": 1563224697, "creation_date": 1562783508, "last_edit_date": 1562970958, "question_id": 56976684, "link": "https://stackoverflow.com/questions/56976684/unable-to-find-an-entry-point-named-sqlite3-open-interop-in-dll-sqlite-inter", "title": "&quot;Unable to find an entry point named &#39;sqlite3_open_interop&#39; in DLL &#39;SQLite.Interop.dll&#39;.&quot;", "body": "<p>I am using a C# application to try to connect to a SQLite database. The application uses the library System.Data.Sqlite, version 108. In Visual Studio 2017, my Solution Configuration is Debug, and my Solution Platform is Any CPU. Whenever I build and run the application, I get the following runtime exception: </p>\n\n<p><a href=\"https://i.stack.imgur.com/wjWUF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wjWUF.png\" alt=\"enter image description here\"></a></p>\n\n<p>The exception is unhandled, and the application terminates.</p>\n\n<p>There is, of course, a SQLite.Interop.dll file in my bin\\Debug directory. (If there wasn't, the exception would be different.) Specifically, there are two, each in their own subdirectories named x64 and x86. My assumption is that the file in the x86 directory is being used, since the Solution Platform is set to Any CPU. The version of the SQLite.Interop.dll assembly matches that of System.Data.SQLite.dll, being 1.0.108.0.</p>\n\n<p>When I use the following command to interrogate the assemblies: </p>\n\n<pre><code>dumpbin /exports SQLite.Interop.dll\n</code></pre>\n\n<p>I do find the following line in the output for the x64 version of the assembly: </p>\n\n<pre><code>175   AE 00040750 sqlite3_open_interop\n</code></pre>\n\n<p>but in the output for the x86 version I do not. Instead, I find this line:</p>\n\n<pre><code>175   26 00037F10 _sqlite3_open_interop@20\n</code></pre>\n\n<p>which is close, but not a match. So there is indeed no such method as sqlite3_open_interop exposed by the assembly.</p>\n\n<p>I have tried the obvious solution of changing the Solution Platform to x64, but that change leads to another exception (BadImageFormatException) which I don't much want to contend with.</p>\n\n<p>I have tried dropping the reference to System.Data.SQLite and using Nuget to add the most recent version, 1.0.111.0, then cleaning and rebuilding the solution, but all to no effect. The same issue recurs.</p>\n\n<p>Could anyone suggest a solution to this issue? SQLite is widely used, I believe, so I have to think there's a way to work through it.</p>\n\n<p>*Edit1: I tried this project on my home computer, and observed the same difference between the two SQLite.Interop.dll files. The x64 version had a sqlite3_open_interop, while the x86 version had a _sqlite3_open_interop@20. However, <strong>the problem did not occur there</strong>. So apparently this mangled name \"issue\" is a red herring. I am still very interested in solving this problem, and would appreciate the assistance of someone who works on System.Data.Sqlite!</p>\n"}, {"tags": ["c#", "xamarin"], "comments": [{"owner": {"reputation": 7909, "user_id": 202179, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xibo7.jpg?s=128&g=1", "display_name": "Ivan I\u010din", "link": "https://stackoverflow.com/users/202179/ivan-i%c4%8din"}, "edited": false, "score": 0, "creation_date": 1562800855, "post_id": 56976682, "comment_id": 100495390, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/55137449/xamarin-forms-generates-wrong-ressources\">Xamarin Forms generates wrong ressources</a>"}, {"owner": {"reputation": 7909, "user_id": 202179, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xibo7.jpg?s=128&g=1", "display_name": "Ivan I\u010din", "link": "https://stackoverflow.com/users/202179/ivan-i%c4%8din"}, "edited": false, "score": 0, "creation_date": 1562800887, "post_id": 56976682, "comment_id": 100495399, "body": "You could find this with the simple web search or search on the site. -1."}, {"owner": {"reputation": 10280, "user_id": 10504796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqBUa.png?s=128&g=1", "display_name": "Junior Jiang", "link": "https://stackoverflow.com/users/10504796/junior-jiang"}, "edited": false, "score": 0, "creation_date": 1562824587, "post_id": 56976682, "comment_id": 100500207, "body": "You can try clean project and rebuild it. And check whether used resource ID not exist in designer."}], "owner": {"reputation": 4595, "user_id": 1159763, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/0622d669c6102714da374348a24df617?s=128&d=identicon&r=PG", "display_name": "ekolis", "link": "https://stackoverflow.com/users/1159763/ekolis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562783504, "creation_date": 1562783504, "question_id": 56976682, "link": "https://stackoverflow.com/questions/56976682/xamarin-designer-creating-invalid-resource-designer-cs-code", "title": "Xamarin designer creating invalid Resource.designer.cs code", "body": "<p>I am winding up with code like this in my Resource.designer.cs</p>\n\n<pre><code>// aapt resource value: 0x7F010213\npublic const int bottomtab.navarea = 2130772499;\n</code></pre>\n\n<p>Which is of course invalid because C# identifiers can't contain periods. The app runs just fine but I have 60 of these errors cluttering up the error list, burying any real errors I might have. How do I tell Xamarin to use legitimate names for its variables in Resource.designer.cs?</p>\n"}, {"tags": ["c#", "wpf", "mvvm-light"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11508275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-no9ZKAeg5Jw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsuKKLKppp-jX0Y68cYlN-ozQ8ng/mo/photo.jpg?sz=128", "display_name": "Damian Hoop", "link": "https://stackoverflow.com/users/11508275/damian-hoop"}, "edited": false, "score": 0, "creation_date": 1562785510, "post_id": 56976880, "comment_id": 100490394, "body": "When I added RaisePropertyChanged(&quot;TotalPrice&quot;); to getter it evokes StackOverflowException. I added it below foreach loop.   Also I can&#39;t call RaisePropertyChanged(&quot;TotalPrice&quot;) when I am changing amount becouse I have used NumericUpDown control and it&#39;s does&#39;t support command event."}, {"owner": {"reputation": 13168, "user_id": 3141792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90e1dac53dada5d6fb65981fb6a10c0?s=128&d=identicon&r=PG&f=1", "display_name": "BionicCode", "link": "https://stackoverflow.com/users/3141792/bioniccode"}, "edited": false, "score": 0, "creation_date": 1562785790, "post_id": 56976880, "comment_id": 100490502, "body": "Yes this will trigger an infinite loop. <code>RaisePropertyChanged</code> will raise the event which triigers the binding to call the getter. The getter again raises <code>RaisePropertyChanged</code> which triggers the binding to call the getter and so on"}, {"owner": {"reputation": 89, "user_id": 11481474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1883991938372274/picture?type=large", "display_name": "Ben Walton", "link": "https://stackoverflow.com/users/11481474/ben-walton"}, "edited": false, "score": 0, "creation_date": 1562787704, "post_id": 56976880, "comment_id": 100491271, "body": "Do not add to the getter.  Add to you&#39;re viewmodel where you set the other properties, or the setters of the other properties (if they are within scope, same class ), Not sure why you down voted me this is the correct answer."}, {"owner": {"reputation": 89, "user_id": 11481474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1883991938372274/picture?type=large", "display_name": "Ben Walton", "link": "https://stackoverflow.com/users/11481474/ben-walton"}, "edited": false, "score": 0, "creation_date": 1562788265, "post_id": 56976880, "comment_id": 100491524, "body": "Basically what I&#39;m saying is there are other properties that TotalPrice depend on, so when those other properties change, you need to call RaisePropertyChanged(&quot;TotalPrice&quot;) to notify the UI to recall the getter and recalculate TotalPrice and re display it."}, {"owner": {"reputation": 13168, "user_id": 3141792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90e1dac53dada5d6fb65981fb6a10c0?s=128&d=identicon&r=PG&f=1", "display_name": "BionicCode", "link": "https://stackoverflow.com/users/3141792/bioniccode"}, "edited": false, "score": 0, "creation_date": 1562788332, "post_id": 56976880, "comment_id": 100491552, "body": "&quot;So anytime you change a component in the getter you also need to call RaisePropertyChanged(&quot;TotalPrice&quot;); to notify the View that Total Price has been updated.&quot;. This reads like: call <code>PropertyChanged</code> from the getter that does the calculations. I think instead of raising the event you should recalculate the new value of <code>TotalPrice</code> whem the <code>Products</code> collection chaged."}, {"owner": {"reputation": 13168, "user_id": 3141792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90e1dac53dada5d6fb65981fb6a10c0?s=128&d=identicon&r=PG&f=1", "display_name": "BionicCode", "link": "https://stackoverflow.com/users/3141792/bioniccode"}, "edited": false, "score": 0, "creation_date": 1562788497, "post_id": 56976880, "comment_id": 100491613, "body": "The point is, your implementation recalculates the <code>TotalPrice</code> everytime an item is added to <code>Products</code> (which is right) but also everytime the getter of <code>TotalPrice</code> is invoked. It will recalculate even when <code>Products</code> hasn&#39;t changed."}, {"owner": {"reputation": 13168, "user_id": 3141792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90e1dac53dada5d6fb65981fb6a10c0?s=128&d=identicon&r=PG&f=1", "display_name": "BionicCode", "link": "https://stackoverflow.com/users/3141792/bioniccode"}, "edited": false, "score": 0, "creation_date": 1562788532, "post_id": 56976880, "comment_id": 100491630, "body": "That&#39;s why you shouldn&#39;t do anything in the getter of a property in general."}], "tags": [], "owner": {"reputation": 89, "user_id": 11481474, "user_type": "registered", "profile_image": "https://graph.facebook.com/1883991938372274/picture?type=large", "display_name": "Ben Walton", "link": "https://stackoverflow.com/users/11481474/ben-walton"}, "is_accepted": false, "score": -1, "last_activity_date": 1562789028, "last_edit_date": 1562789028, "creation_date": 1562784353, "answer_id": 56976880, "question_id": 56976636, "link": "https://stackoverflow.com/questions/56976636/how-to-update-textblock-in-real-time/56976880#56976880", "title": "How to update textblock in real-time?", "body": "<p>It's not updating because you're only calling <code>RaisePropertyChanged(\"TotalPrice\");</code> in the setter.  Whereas in your getter is the calculation. So anytime you change the <code>Products</code> property or the content of the <code>Products</code> collection, you also need to call <code>RaisePropertyChanged(\"TotalPrice\");</code> to notify the View that <code>TotalPrice</code> has been updated. </p>\n\n<p>So if you change any of the item.amount or item.price or if you add or remove items from the Products list then you need to also call. <code>RaisePropertyChanged(\"TotalPrice\");</code></p>\n\n<p>Ex:</p>\n\n<pre><code>Products.Add(item);\nRaisePropertyChanged(\"TotalPrice\"); //This will tell you're View to check for the new value from TotalPrice\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13168, "user_id": 3141792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90e1dac53dada5d6fb65981fb6a10c0?s=128&d=identicon&r=PG&f=1", "display_name": "BionicCode", "link": "https://stackoverflow.com/users/3141792/bioniccode"}, "is_accepted": true, "score": 0, "last_activity_date": 1563225214, "last_edit_date": 1563225214, "creation_date": 1562786388, "answer_id": 56977327, "question_id": 56976636, "link": "https://stackoverflow.com/questions/56976636/how-to-update-textblock-in-real-time/56977327#56977327", "title": "How to update textblock in real-time?", "body": "<p>You shouldn't do calculations or any time consuming operations in the getter or setter of a property. This can drastically degrade performance. If the calculations or operation is time consuming, then you should execute it in a background thread and raise the <code>PropertyChanged</code>event once the <code>Task</code>has completed. This way the invocation of the getter or setter of a property won't freeze the UI.</p>\n\n<p>Explanation of the behavior you observed:<br>\nThe side effect of changing the property value in its own a <em>getter</em> instead of the setter is that the new value won't propagate to the binding targets. The getter is only invoked by a binding when the <code>PropertyChanged</code> event occurred. So doing the calculations in the getter doesn't trigger the binding to refresh. Now when reloading the page, all bindings will initialize the binding target and therefore invoke the property getter. </p>\n\n<p>You have to set the <code>TotalPrice</code> property (and not the backing field) in order to trigger a refresh of the binding target. But as you already experienced yourself, raising the <code>PropertyChanged</code> event of a property in the \nsame getter will lead to an infinite loop and therefore to a <code>StackOverflowException</code>.<br>\nAlso the calculation will be always executed whenever the property's getter is accessed - even when the <code>TotalPrice</code> hasn't changed.</p>\n\n<p>The value of <code>TotalPrice</code> depends on <code>Products</code> property. To minimize the occurrence of the calculation of <code>TotalPrice</code>, only calculate when <code>Products</code> has changed:</p>\n\n<p><strong>OrderViewModel.cs</strong> </p>\n\n<pre><code>public class OrderViewModel : ViewModelBase\n{\n  private decimal _totalPrice;\n  public decimal TotalPrice\n  {\n    get =&gt; this._totalPrice;\n    set\n    {\n      if (this._totalPrice == value)\n        return;\n      this._totalPrice = value;\n\n      RaisePropertyChanged();\n    }\n  }\n\n  private ObservableCollection&lt;Product&gt; _products;\n  public ObservableCollection&lt;Product&gt; Products\n  {\n    get =&gt; this._products;\n    set\n    {    \n      if (this.Products == value)\n        return;\n\n      if (this.Products != null)\n      {\n        this.Products.CollectionChanged -= OnCollectionChanged;\n        UnsubscribeFromItemsPropertyChanged(this.Products);\n      }\n\n      this._products = value;\n\n      this.Products.CollectionChanged += OnCollectionChanged;\n      if (this.Products.Any())\n      {\n        SubscribeToItemsPropertyChanged(this.Products);\n      }\n\n      RaisePropertyChanged();\n    }\n  }\n\n  private void OnCollectionChanged(object sender, NotifyCollectionChangedEventArgs e)\n  {\n    if (!e.Action.Equals(NotifyCollectionChangedAction.Move))\n    {\n      UnsubscribeFromItemsPropertyChanged(e.OldItems);\n      SubscribeToItemsPropertyChanged(e.NewItems);\n    }\n\n    CalculateTotalPrice();\n  }\n\n  private void ProductChanged(object sender, PropertyChangedEventArgs e) =&gt; CalculateTotalPrice();\n\n  private void SubscribeToItemsPropertyChanged(IList newItems) =&gt; newItems?.OfType&lt;INotifyPropertyChanged&gt;().ToList().ForEach((item =&gt; item.PropertyChanged += ProductChanged));\n\n  private void UnsubscribeFromItemsPropertyChanged(IEnumerable oldItems) =&gt; oldItems?.OfType&lt;INotifyPropertyChanged&gt;().ToList().ForEach((item =&gt; item.PropertyChanged -= ProductChanged));\n\n  private void CalculateTotalPrice() =&gt; this.TotalPrice = this.Products.Sum(item =&gt; item.total_price);\n\n  private void GetProducts()\n  {\n    using (var context = new mainEntities())\n    {\n      var result = context.product.Include(c =&gt; c.brand);\n      this.Products = new ObservableCollection&lt;Product&gt;(\n        result.Select(item =&gt; new Product(item.name, item.mass, item.ean, item.brand.name, item.price)));\n    }\n  }\n\n  public void ResetOrder()\n  {\n    this.Products\n      .ToList()\n      .ForEach(product =&gt; product.Reset());\n    this.TotalPrice = 0;\n  }\n\n  public OrderViewModel()\n  {\n    SetView(\"Dodaj zam\u00f3wienie\");\n    GetProducts();\n  }\n}\n</code></pre>\n\n<p>Also make sure that <code>Product</code> (the items in the <code>Products</code> collection) implements <code>INotifyPropertyChanged</code> too. This will ensure that <code>Products.CollectionChanged</code> event is raised when <code>Product</code> properties have changed.</p>\n\n<p>To fix the page switching behavior you have to modify the <code>MainViewModel</code> class:</p>\n\n<p><strong>MainViewModel.cs</strong> </p>\n\n<pre><code>public class MainViewModel : ViewModelBase\n{\n  // The page viewmodels  \n  private Dictionary&lt;string, ViewModelBase&gt; PageViewModels { get; set; }\n  public Stack&lt;string&gt; ViewsQueue;\n\n  public MainViewModel()\n  {\n    User = new User(1, \"login\", \"name\", \"surname\", 1, 1, 1);\n\n    this.PageViewModels = new Dictionary&lt;string, ViewModelBase&gt;()\n    {\n      {\"login\", new LoginViewModel()},\n      {\"menu\", new MenuViewModel()},\n      {\"order\", new OrderViewModel()},\n      {\"clients\", new ClientsViewModel(User)}\n    };\n\n    this.CurrentViewModel = this.PageViewModels[\"login\"];\n\n    this.ViewsQueue = new Stack&lt;string&gt;();\n    this.ViewsQueue.Push(\"login\");\n\n    Messenger.Default.Register&lt;NavigateTo&gt;(\n      this,\n      (message) =&gt;\n      {\n        try\n        {\n          ViewsQueue.Push(message.Name);\n          if (message.user != null) User = message.user;\n          SwitchView(message.Name);\n        }\n        catch (System.InvalidOperationException e)\n        {\n        }\n      });\n\n    Messenger.Default.Register&lt;GoBack&gt;(\n      this,\n      (message) =&gt;\n      {\n        try\n        {\n          ViewsQueue.Pop();\n          SwitchView(ViewsQueue.Peek());\n        }\n        catch (System.InvalidOperationException e)\n        {\n        }\n      });\n  }\n\n  public RelayCommand&lt;string&gt; GoTo =&gt; new RelayCommand&lt;string&gt;(\n    viewName =&gt;\n    {\n      ViewsQueue.Push(viewName);\n      SwitchView(viewName);\n    });\n\n\n  protected void SwitchView(string name)\n  {\n    if (this.PageViewModels.TryGetValue(name, out ViewModelBase nextPageViewModel))\n    {\n      if (nextPageViewModel is OrderViewModel orderViewModel)\n        orderViewModel.ResetOrder();\n\n      this.CurrentViewModel = nextPageViewModel;\n    }\n  }\n}\n</code></pre>\n\n<p><strong>Your modifified Product.cs</strong></p>\n\n<pre><code>public class Product : ViewModelBase\n{\n  public long id { get; set; }\n  public string name { get; set; }\n  public decimal mass { get; set; }\n  public long ean { get; set; }\n  public long brand_id { get; set; }\n  public string img_source { get; set; }\n  public string brand_name { get; set; }\n\n  private decimal _price;\n  public decimal price\n  {\n    get =&gt; this._price;\n    set\n    {\n      if (this._price == value)\n        return;\n\n      this._price = value;\n      OnPriceChanged();\n      RaisePropertyChanged();\n    }\n  }\n\n  private long _amount;\n  public long amount\n  {\n    get =&gt; this._amount;\n    set\n    {\n      if (this._amount == value)\n        return;\n\n      this._amount = value;\n      OnAmountChanged();\n      RaisePropertyChanged();\n    }\n  }\n\n  private decimal _total_price;\n  public decimal total_price\n  {\n    get =&gt; this._total_price;\n    set\n    {\n      if (this._total_price == value)\n        return;\n\n      this._total_price = value;\n      RaisePropertyChanged();\n    }\n  }\n\n  public Product(long id, string name, decimal mass, long ean, long brandId, decimal price, string imgSource)\n  {\n    this.id = id;\n    this.name = name;\n    this.mass = mass;\n    this.ean = ean;\n    this.brand_id = brandId;\n    this.price = price;\n    this.img_source = imgSource;\n  }\n\n  public Product(string name, decimal mass, long ean, string brandName, decimal price)\n  {\n    this.id = this.id;\n    this.name = name;\n    this.mass = mass;\n    this.ean = ean;\n    this.brand_name = brandName;\n    this.price = price;\n  }\n\n  public void Reset()\n  {\n    // Resetting the `amount` will trigger recalculation of `total_price`\n    this.amount = 0;\n  }\n\n  protected virtual void OnAmountChanged()\n  {\n    CalculateTotalPrice();\n  }\n\n  private void OnPriceChanged()\n  {\n    CalculateTotalPrice();\n  }\n\n  private void CalculateTotalPrice()\n  {\n    this.total_price = this.price * this.amount;\n  }\n}\n</code></pre>\n\n<p>The issue was that you have always created a new view model when switching to a page. Of course all previous page information gets lost. You have to reuse the same view model instance. To do this, just store them in a dedicated private property that you initialize once in the constructor.</p>\n"}], "owner": {"reputation": 5, "user_id": 11508275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-no9ZKAeg5Jw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcsuKKLKppp-jX0Y68cYlN-ozQ8ng/mo/photo.jpg?sz=128", "display_name": "Damian Hoop", "link": "https://stackoverflow.com/users/11508275/damian-hoop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 56977327, "answer_count": 2, "score": 0, "last_activity_date": 1563225214, "creation_date": 1562783296, "last_edit_date": 1562783602, "question_id": 56976636, "link": "https://stackoverflow.com/questions/56976636/how-to-update-textblock-in-real-time", "title": "How to update textblock in real-time?", "body": "<p>I'm working on project with MVVM Light framework.<br>\nI have MainViewModel which helps me to navigate between viewmodels. I have GoBack and GoTo methods. Their are changing CurrentViewModel.</p>\n\n<pre><code>private RelayCommand&lt;string&gt; _goTo;\npublic RelayCommand&lt;string&gt; GoTo\n        {\n            get\n            {\n                return _goTo\n                    ?? (_goTo = new RelayCommand&lt;string&gt;(view\n                     =&gt;\n                    {\n                        SwitchView(view);\n                    }));\n            }\n        }\n private void SwitchView(string name)\n        {\n            switch (name)\n            {\n                case \"login\":\n                    User = null;\n                    CurrentViewModel = new LoginViewModel();\n                    break;\n                case \"menu\":\n                    CurrentViewModel = new MenuViewModel();\n                    break;\n                case \"order\":\n                    CurrentViewModel = new OrderViewModel();\n                    break;\n            }\n</code></pre>\n\n<p>In MainWindow there is content control and data templates. </p>\n\n<pre><code>[...]\n &lt;DataTemplate DataType=\"{x:Type vm:LoginViewModel}\"&gt;\n            &lt;view:Login/&gt;\n        &lt;/DataTemplate&gt;\n        &lt;DataTemplate DataType=\"{x:Type vm:MenuViewModel}\"&gt;\n            &lt;view:Menu/&gt;\n        &lt;/DataTemplate&gt;\n[...]\n\n&lt;ContentControl VerticalAlignment=\"Top\" HorizontalAlignment=\"Stretch\" \n                            Content=\"{Binding CurrentViewModel}\" IsTabStop=\"false\"/&gt;\n</code></pre>\n\n<p>In my OrderView (it is UserControl) I have textblock which should shows TotalPrice of order.</p>\n\n<pre><code>&lt;TextBlock Text=\"{Binding AddOrderView.TotalPrice}\"  Padding=\"0 2 0 0\" FontSize=\"20\" FontWeight=\"Bold\" HorizontalAlignment=\"Right\"/&gt;\n</code></pre>\n\n<p>OrderViewModel has a property TotalPrice and it works well. When I am debugging I see that it has been changed, but in my View nothing happend. </p>\n\n<pre><code>        private decimal _totalPrice;\n        public decimal TotalPrice\n        {\n            get\n            {\n                _totalPrice = 0;\n                foreach (var item in Products)\n                {\n                    item.total_price = item.amount * item.price;\n                    _totalPrice += item.price * item.amount;\n                }\n                return _totalPrice;\n            }\n            set\n            {\n                if (_totalPrice == value)\n                    return;\n                _totalPrice = value;\n                RaisePropertyChanged(\"TotalPrice\");\n            }\n        }\n</code></pre>\n\n<p>OrderViewModel iherits from BaseViewModel and it implements INotifyPropertyChanged. </p>\n\n<p>Why is my textblock not updating/refreshing? How to do this?</p>\n\n<p>When I change view with back button and go again to OrderView I see changes! </p>\n\n<p>I spend few days to looking for solution and nothing helps me.</p>\n\n<p><a href=\"https://i.stack.imgur.com/K8lip.gif\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/K8lip.gif</a></p>\n\n<p>So it's look like when View is seting there is no way to change it without reload its. I don't know how it works exactly.</p>\n"}, {"tags": ["c#", "pdfsharp"], "comments": [{"owner": {"reputation": 18344, "user_id": 162529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWVD6.png?s=128&g=1", "display_name": "I liked the old Stack Overflow", "link": "https://stackoverflow.com/users/162529/i-liked-the-old-stack-overflow"}, "edited": false, "score": 0, "creation_date": 1562871323, "post_id": 56976628, "comment_id": 100525501, "body": "I don&#39;t know your sources, but your <code>img</code> object should be of class <code>Image</code> while the <code>ximg</code> object should remain class <code>XImage</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6402867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d073c4a45450cb8a05adb59ac51ef6e?s=128&d=identicon&r=PG&f=1", "display_name": "TexUser", "link": "https://stackoverflow.com/users/6402867/texuser"}, "edited": false, "score": 0, "creation_date": 1562864825, "post_id": 56982474, "comment_id": 100522662, "body": "This is helpful, thank you. It did fix the problem."}], "tags": [], "owner": {"reputation": 18344, "user_id": 162529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWVD6.png?s=128&g=1", "display_name": "I liked the old Stack Overflow", "link": "https://stackoverflow.com/users/162529/i-liked-the-old-stack-overflow"}, "is_accepted": true, "score": 0, "last_activity_date": 1562824749, "creation_date": 1562824749, "answer_id": 56982474, "question_id": 56976628, "link": "https://stackoverflow.com/questions/56976628/ximage-does-not-contain-a-definition-for-getframecount/56982474#56982474", "title": "&#39;XImage&#39; does not contain a definition for &#39;GetFrameCount&#39;", "body": "<p>If <code>XImage</code> does not have that method, use the <code>Image</code> class and convert to <code>XImage</code> later on.</p>\n"}], "owner": {"reputation": 13, "user_id": 6402867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d073c4a45450cb8a05adb59ac51ef6e?s=128&d=identicon&r=PG&f=1", "display_name": "TexUser", "link": "https://stackoverflow.com/users/6402867/texuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 56982474, "answer_count": 1, "score": 0, "last_activity_date": 1562825038, "creation_date": 1562783271, "last_edit_date": 1562825038, "question_id": 56976628, "link": "https://stackoverflow.com/questions/56976628/ximage-does-not-contain-a-definition-for-getframecount", "title": "&#39;XImage&#39; does not contain a definition for &#39;GetFrameCount&#39;", "body": "<p>I am attempting to create a multi-page TIFF to PDF converter. I have followed what appears to be good code from multiple sources on the Internet. I have PDFsharp-gdi installed, and I have included the proper libraries, I believe. </p>\n\n<p>The problem is that I am getting the error message: </p>\n\n<blockquote>\n  <p>Error  CS1061  'XImage' does not contain a definition for 'GetFrameCount' and no extension method 'GetFrameCount' accepting a first argument of type 'XImage' could be found (are you missing a using directive or an assembly reference?)</p>\n</blockquote>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n...\nusing System.IO;\nusing PdfSharp;\nusing PdfSharp.Pdf;\nusing PdfSharp.Pdf.IO;\nusing PdfSharp.Drawing;\n...\nfor (int i = 0; i &lt; prePdfFiles.Count; i++)\n{\n    PdfDocument doc = new PdfDocument();\n    XGraphics xgr;\n    XImage img = XImage.FromFile(destPath + prePdfFiles[i]);\n    int pagesCount = img.GetFrameCount(FrameDimension.Page);\n    for( int j = 0; j &lt; pagesCount; j++ )\n    {\n        img.SelectActiveFrame(FrameDimension.Page, j);\n        PdfPage currentPage = new PdfPage();\n        doc.Pages.Add(currentPage);\n        xgr = XGraphics.FromPdfPage(currentPage);\n        XImage ximg = XImage.FromGdiPlusImage(img);\n        xgr.DrawImage(ximg, 0, 0);\n    }\n    doc.Save(System.IO.Path.ChangeExtension(destPath + prePdfFiles[i], \".pdf\"));\n    doc.Close();\n}\n</code></pre>\n"}, {"tags": ["c#", "html", "css", ".net-core", "asp.net-core-mvc"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11736013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1a181d7ad4657472d78b80b421edec?s=128&d=identicon&r=PG&f=1", "display_name": "jerrythomas38", "link": "https://stackoverflow.com/users/11736013/jerrythomas38"}, "edited": false, "score": 0, "creation_date": 1562819934, "post_id": 56980297, "comment_id": 100498837, "body": "ok thanks, so you are basically saying I have to set all CSS style properties in TagBuilder, I can&#39;t mix them between Tagbuilder and min.css/sass  files, thanks"}, {"owner": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "reply_to_user": {"reputation": 1, "user_id": 11736013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1a181d7ad4657472d78b80b421edec?s=128&d=identicon&r=PG&f=1", "display_name": "jerrythomas38", "link": "https://stackoverflow.com/users/11736013/jerrythomas38"}, "edited": false, "score": 0, "creation_date": 1562827493, "post_id": 56980297, "comment_id": 100501480, "body": "No, you don&#39;t have to set ALL inline styles in TagBuilder (see my example#2). But in order to style the elements with css/sass files, don&#39;t you have to give them a class to start with?"}], "tags": [], "owner": {"reputation": 16037, "user_id": 2410655, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aBhdJ.jpg?s=128&g=1", "display_name": "David Liang", "link": "https://stackoverflow.com/users/2410655/david-liang"}, "is_accepted": true, "score": 1, "last_activity_date": 1562806172, "creation_date": 1562806172, "answer_id": 56980297, "question_id": 56976602, "link": "https://stackoverflow.com/questions/56976602/net-core-is-it-possible-to-merge-tagbuilder-style-attributes-with-css-files/56980297#56980297", "title": "Net Core: Is it Possible to Merge TagBuilder Style Attributes with CSS Files?", "body": "<p><code>TagBuilder</code> is here to help you <strong>build</strong> a HTML element a little bit easily without having to concatenate strings. Should you understand you're building an element from scratch. That means if you don't merge an attribute called \"background-color\" into the tag builder, it won't have an attribute called \"background-color\".</p>\n\n<p>The following code should also set the attribute \"background-color\":</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using Microsoft.AspNetCore.Mvc.Rendering;\nusing Microsoft.AspNetCore.Razor.TagHelpers;\n\nnamespace DL.SO.Framework.Mvc.TagHelpers\n{\n    public class TestTagHelper : TagHelper\n    {\n        public override void Process(TagHelperContext context, TagHelperOutput output)\n        {\n            int carouselWidth = 300;\n\n            TagBuilder div = new TagBuilder(\"div\");\n\n            div.MergeAttribute(\n                \"style\", \n                $\"width: { carouselWidth }px; height: { carouselWidth }px; background-color: green;\");\n\n            output.Content.SetHtmlContent(div);\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/JQeR2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JQeR2.png\" alt=\"enter image description here\"></a></p>\n\n<p><br></p>\n\n<p>Because your post is unclear, based on your \"code\", I think you should set the attribute <code>class</code> as well so that your style could be applied.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>int carouselWidth = 300;\n\nTagBuilder div = new TagBuilder(\"div\");\n\ndiv.MergeAttribute(\n    \"style\", \n    $\"width: { carouselWidth }px; height: { carouselWidth }px;\");\n\ndiv.MergeAttribute(\n    \"class\", \n    \"test\");\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/PMMKy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PMMKy.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11736013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1a181d7ad4657472d78b80b421edec?s=128&d=identicon&r=PG&f=1", "display_name": "jerrythomas38", "link": "https://stackoverflow.com/users/11736013/jerrythomas38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 56980297, "answer_count": 1, "score": 0, "last_activity_date": 1562806172, "creation_date": 1562783148, "last_edit_date": 1562791074, "question_id": 56976602, "link": "https://stackoverflow.com/questions/56976602/net-core-is-it-possible-to-merge-tagbuilder-style-attributes-with-css-files", "title": "Net Core: Is it Possible to Merge TagBuilder Style Attributes with CSS Files?", "body": "<p>Is it possible to merge style attributes from a Tagbuilder with style attributes coming from CSS/SCSS Files? It seems like Tag builder is totally removing my attributes in SCSS files.\nIn example below, its only following width from Tag builder and ignoring my other CSS files background color.</p>\n\n<pre><code>test.MergeAttribute(\n  \"style\", \"width: \" + CarouselWidth + @\"px;  \n  height:\" + CarouselWidth + \"px; height: 100%;\"\n);\n\n.test {\n  background-color:green\n}\n</code></pre>\n"}, {"tags": ["c#", "xaml", "xamarin"], "answers": [{"tags": [], "owner": {"reputation": 4595, "user_id": 1159763, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/0622d669c6102714da374348a24df617?s=128&d=identicon&r=PG", "display_name": "ekolis", "link": "https://stackoverflow.com/users/1159763/ekolis"}, "is_accepted": false, "score": 1, "last_activity_date": 1562783905, "creation_date": 1562783905, "answer_id": 56976793, "question_id": 56976599, "link": "https://stackoverflow.com/questions/56976599/invalidcastexception-when-binding-a-xamarin-listview-to-an-ienumerableperson/56976793#56976793", "title": "InvalidCastException when binding a Xamarin ListView to an IEnumerable&lt;Person&gt;", "body": "<p>I figured it out - looks like <code>&lt;Label Text=\"{Binding Name}\" /&gt;</code> is not valid as a DataTemplate; I changed the <code>Label</code> to a <code>TextCell</code> and everything works!</p>\n"}], "owner": {"reputation": 4595, "user_id": 1159763, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/0622d669c6102714da374348a24df617?s=128&d=identicon&r=PG", "display_name": "ekolis", "link": "https://stackoverflow.com/users/1159763/ekolis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562783905, "creation_date": 1562783139, "question_id": 56976599, "link": "https://stackoverflow.com/questions/56976599/invalidcastexception-when-binding-a-xamarin-listview-to-an-ienumerableperson", "title": "InvalidCastException when binding a Xamarin ListView to an IEnumerable&lt;Person&gt;", "body": "<p>I have this ListView in a Xamarin app:</p>\n\n<pre><code>&lt;ListView Grid.Row=\"1\" Grid.Column=\"0\" Grid.ColumnSpan=\"2\" ItemsSource=\"{x:Static local:Person.All}\" x:Name=\"list\"&gt;\n    &lt;ListView.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;Label Text=\"{Binding Name}\" /&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/ListView.ItemTemplate&gt;\n&lt;/ListView&gt;\n</code></pre>\n\n<p>And I'm trying to bind it to an <code>IEnumerable&lt;Person&gt;</code> by setting the <code>ItemsSource</code> property to the new enumerable. (Yes, I know I should create a viewmodel, but I hate MVVM with a passion!) But when there is data in the enumerable, I get this error:</p>\n\n<blockquote>\n  <p>System.InvalidCastException: Specified cast is not valid.</p>\n</blockquote>\n\n<p>This does not happen immediately after setting <code>ItemsSource</code>; I have a try/catch block containing the set operation, but no exception is caught. Rather it happens as soon as I get out of the method where I'm setting the <code>ItemsSource</code>. There is no stack trace associated with this error; that's all I get apart from some generic \"Unhandled Exception\" message.</p>\n\n<p>Here is the method where I am setting the <code>ItemsSource</code>:</p>\n\n<pre><code>private void BtnLogIn_Clicked(object sender, EventArgs e)\n{\n    try\n    {\n        // log in\n        var req = WebRequest.CreateHttp($\"http://{Configuration.Hostname}/api/login?systemID=1091&amp;login={txtLogin.Text}&amp;password={txtPassword.Text}\");\n        var resp = (HttpWebResponse)req.GetResponse();\n        var cookiesData = resp.Headers.Get(\"Set-Cookie\");\n        var regex = new Regex($@\"{CookieManager.LoginCookieID}=(.*); expires=.*\");\n        Login.CookieValue = regex.Match(cookiesData).Groups[1].Captures[0].Value;\n        list.ItemsSource = Person.All; // reload person list\n    }\n    catch (Exception ex)\n    {\n        DisplayAlert(\"Error\", ex.ToString(), \"OK\");\n    }\n}\n</code></pre>\n\n<p>(yes I know putting a password in a URL is a bad idea; this is just a proof of concept!)</p>\n\n<p>And here is the <code>Person</code> class:</p>\n\n<pre><code>public class Person\n{\n    public static IEnumerable&lt;Person&gt; All =&gt; GetWebData&lt;IEnumerable&lt;Person&gt;&gt;($\"http://{Configuration.Hostname}/api/people\", CookieManager.LoginCookieID, Login.CookieValue);\n\n    private static T GetWebData&lt;T&gt;(string url, string cookieKey, string cookieValue)\n    {\n        try\n        {\n            var web = WebRequest.CreateHttp(url);\n            web.Headers[\"Set-Cookie\"] = $\"{cookieKey}={cookieValue}\";\n            var stream = web.GetResponse().GetResponseStream();\n            var sr = new StreamReader(stream);\n            T data;\n            var json = sr.ReadToEnd();\n            sr.Close();\n            try\n            {\n                data = JsonConvert.DeserializeObject&lt;T&gt;(json);\n            }\n            catch\n            {\n                data = JsonConvert.DeserializeObject&lt;IEnumerable&lt;T&gt;&gt;(json).Single();\n            }\n            return data;\n        }\n        catch\n        {\n            // could not access data, maybe not logged in yet?\n            return default(T);\n        }\n    }\n\n    public string FirstName { get; set; }\n\n    public string LastName { get; set; }\n\n    public string Name =&gt; $\"{FirstName} {LastName}\";\n}\n</code></pre>\n"}, {"tags": ["c#", "unity3d", "arraylist"], "comments": [{"owner": {"reputation": 369, "user_id": 3973143, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23f1eeb9919581ad1401a8358a2250a5?s=128&d=identicon&r=PG&f=1", "display_name": "davedno", "link": "https://stackoverflow.com/users/3973143/davedno"}, "edited": false, "score": 0, "creation_date": 1562783232, "post_id": 56976579, "comment_id": 100489427, "body": "Have you tried re-instantiating your list in the RemoveObjectsFromList method?"}, {"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "reply_to_user": {"reputation": 369, "user_id": 3973143, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23f1eeb9919581ad1401a8358a2250a5?s=128&d=identicon&r=PG&f=1", "display_name": "davedno", "link": "https://stackoverflow.com/users/3973143/davedno"}, "edited": false, "score": 0, "creation_date": 1562783574, "post_id": 56976579, "comment_id": 100489575, "body": "You shouldnt need to do that @davedno ..  Clear would empty the list.. given that this didnt do what the OP wanted, would suggest that they wanted the objects removed too"}, {"owner": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "reply_to_user": {"reputation": 369, "user_id": 3973143, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23f1eeb9919581ad1401a8358a2250a5?s=128&d=identicon&r=PG&f=1", "display_name": "davedno", "link": "https://stackoverflow.com/users/3973143/davedno"}, "edited": false, "score": 0, "creation_date": 1562783900, "post_id": 56976579, "comment_id": 100489715, "body": "@davedno Like this &quot; ObjectList = new List&lt;GameObject&gt;(); &quot;  ?"}, {"owner": {"reputation": 369, "user_id": 3973143, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23f1eeb9919581ad1401a8358a2250a5?s=128&d=identicon&r=PG&f=1", "display_name": "davedno", "link": "https://stackoverflow.com/users/3973143/davedno"}, "reply_to_user": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1562784000, "post_id": 56976579, "comment_id": 100489765, "body": "@BugFinder Agreed, but OP has already tried those methods so I wanted to cover the bases. Thanks."}, {"owner": {"reputation": 2497, "user_id": 11604722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GA67aL2m6Yc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzsybeEEYKZhZwTKe-Q9-Y-M4e6A/mo/photo.jpg?sz=128", "display_name": "Joshua Robinson", "link": "https://stackoverflow.com/users/11604722/joshua-robinson"}, "edited": false, "score": 0, "creation_date": 1562784573, "post_id": 56976579, "comment_id": 100490008, "body": "<code>ObjectList</code> is of type <code>List</code> in your example. Is this a type you wrote, or is it a typo and it should be of type <code>List&lt;GameObject&gt;</code>? If so, <code>Clear</code> will remove the objects from the <code>List&lt;T&gt;</code>. What property are you looking at that indicates there is one item in the list?"}, {"owner": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "reply_to_user": {"reputation": 2497, "user_id": 11604722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GA67aL2m6Yc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzsybeEEYKZhZwTKe-Q9-Y-M4e6A/mo/photo.jpg?sz=128", "display_name": "Joshua Robinson", "link": "https://stackoverflow.com/users/11604722/joshua-robinson"}, "edited": false, "score": 0, "creation_date": 1562785215, "post_id": 56976579, "comment_id": 100490291, "body": "@JoshuaRobinson   I am looking at a List named &quot;ObjectList&quot; and the Gameobject named &quot;Object&quot; that is inside of ObjectList. I add the gameobject to the list in one function then in a separate function I am able to clear the list of that gameobject but the size of the list will not return to 0. It will still say the size is 1 and has a missing gameobject."}, {"owner": {"reputation": 2497, "user_id": 11604722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GA67aL2m6Yc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzsybeEEYKZhZwTKe-Q9-Y-M4e6A/mo/photo.jpg?sz=128", "display_name": "Joshua Robinson", "link": "https://stackoverflow.com/users/11604722/joshua-robinson"}, "edited": false, "score": 0, "creation_date": 1562785483, "post_id": 56976579, "comment_id": 100490390, "body": "@Medlin. Yeah, but in the code you posted you have <code>public List ObjectList = new List();</code>. There is not a non-generic <code>List</code> type in C# that I&#39;m aware of, so I&#39;m wondering if that should be <code>public List&lt;GameObject&gt; ObjectList = new List&lt;GameObject&gt;</code>. If not, and you have the code for <code>List</code>, post it so we can see the <code>Clear</code> method. If it is supposed to be <code>List&lt;GameObject&gt;</code>, what are you looking at that indicates there is an item in the list? <code>ObjectList.Count</code>? <code>ObjectList.Capacity</code>? Something else altogether?"}, {"owner": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "reply_to_user": {"reputation": 2497, "user_id": 11604722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GA67aL2m6Yc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzsybeEEYKZhZwTKe-Q9-Y-M4e6A/mo/photo.jpg?sz=128", "display_name": "Joshua Robinson", "link": "https://stackoverflow.com/users/11604722/joshua-robinson"}, "edited": false, "score": 0, "creation_date": 1562786171, "post_id": 56976579, "comment_id": 100490662, "body": "@JoshuaRobinson I apologize. I see what you mean and fixed that. The editor was not showing the list and gameobject correctly. Also, to answer your question in attempt #2 it receives the ObjectList.Count. The way I am visually seeing this is in Unity&#39;s Inspector."}, {"owner": {"reputation": 2497, "user_id": 11604722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GA67aL2m6Yc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzsybeEEYKZhZwTKe-Q9-Y-M4e6A/mo/photo.jpg?sz=128", "display_name": "Joshua Robinson", "link": "https://stackoverflow.com/users/11604722/joshua-robinson"}, "reply_to_user": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1562786900, "post_id": 56976579, "comment_id": 100490958, "body": "Well, using Attempt #2 will leave objects in the list as @BugFinder explained in their answer. <code>Clear</code> will remove all of the objects in the <code>List&lt;T&gt;</code> and the <code>Count</code> property will be 0 after calling it (though the <code>Capacity</code> property will be greater than 0). Unless Unity itself is somehow doing something to keep the objects in the <code>List&lt;T&gt;</code>, at which point I&#39;m afraid I can&#39;t help because I don&#39;t know anything about Unity :)."}, {"owner": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "reply_to_user": {"reputation": 2497, "user_id": 11604722, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GA67aL2m6Yc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdzsybeEEYKZhZwTKe-Q9-Y-M4e6A/mo/photo.jpg?sz=128", "display_name": "Joshua Robinson", "link": "https://stackoverflow.com/users/11604722/joshua-robinson"}, "edited": false, "score": 0, "creation_date": 1562787794, "post_id": 56976579, "comment_id": 100491315, "body": "@JoshuaRobinson I appreciate the help. Unfortunately, using the Clear method. still returns the count property as 1 instead of 0. Maybe an issue with Unity. Not for sure."}, {"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1562790223, "post_id": 56976579, "comment_id": 100492277, "body": "Clear would never leave it at 1.. something must be adding to it"}, {"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1562790846, "post_id": 56976579, "comment_id": 100492511, "body": "I cant recreate the behavior you are seeing without something else adding to it.  Clear sets the count to 0, every time.. My list of removing objects as well as the item in the list.. also does the same, results in 0"}, {"owner": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "reply_to_user": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1562791058, "post_id": 56976579, "comment_id": 100492586, "body": "@BugFinder I understand and was completely confused about this until I realized where I messed up. If you check the answer at the bottom it explains where I went wrong."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "edited": false, "score": 0, "creation_date": 1562784460, "post_id": 56976695, "comment_id": 100489971, "body": "So I tried your method which clears the objects out of the list but the Size of the list still remains at 1 and does not return to 0 showing Element 0 [Missing Gameobject]. When I try re-instantiating it as a new list unfortunately nothing happens."}, {"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "reply_to_user": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "edited": false, "score": 0, "creation_date": 1562790213, "post_id": 56976695, "comment_id": 100492273, "body": "how are you checking the size? theres a difference between size and count  are you sure something isnt adding to your list?"}], "tags": [], "owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "is_accepted": false, "score": 0, "last_activity_date": 1562783537, "creation_date": 1562783537, "answer_id": 56976695, "question_id": 56976579, "link": "https://stackoverflow.com/questions/56976579/how-to-remove-gameobjects-from-a-new-list-and-reset-list-size-back-to-0/56976695#56976695", "title": "How to remove gameobjects from a new List and reset list size back to 0?", "body": "<p>Lets look at your list removal code..</p>\n\n<pre><code>   for (int i = 0; i &lt; ObjectList.Count; ++i)\n    {\n        ObjectList.RemoveAt(i);\n    }\n</code></pre>\n\n<p>So</p>\n\n<p>a list with 3 items (cos Im a little lazy)</p>\n\n<p>i = 0, removes at 0.. so now you have 0 and 1..\ni++</p>\n\n<p>now you remove 1....  leaving 0...</p>\n\n<p>You need to remove in reverse..</p>\n\n<p>So for i=count-1 to 0.. if you needed say to remove gameobjects or whatever,</p>\n\n<p>or .clear ..</p>\n\n<p>However the fact you tried .Clear suggests maybe the \"objects\" need to be destroyed too?  </p>\n\n<p>such as</p>\n\n<pre><code>   for (int i = ObjectList.Count-1; i &gt;= 0; i--)\n    {\n        Destroy(ObjectList[i]);\n        ObjectList.RemoveAt(i);\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1562791132, "post_id": 56978249, "comment_id": 100492615, "body": "Wow... this has absolutely nothing then to do with your problem you asked about."}, {"owner": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "reply_to_user": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1562791675, "post_id": 56978249, "comment_id": 100492852, "body": "@BugFinder This will help anyone who may run into the same error but if you have a better title for this issue I can change it to best suit this problem."}, {"owner": {"reputation": 15949, "user_id": 687262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/x6GN0.png?s=128&g=1", "display_name": "BugFinder", "link": "https://stackoverflow.com/users/687262/bugfinder"}, "edited": false, "score": 0, "creation_date": 1562791740, "post_id": 56978249, "comment_id": 100492873, "body": "Id doubt they&#39;d find it.  Your problem was you had 2 lists and in one case were looking at the wrong one.."}], "tags": [], "owner": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "is_accepted": false, "score": -1, "last_activity_date": 1562790862, "creation_date": 1562790862, "answer_id": 56978249, "question_id": 56976579, "link": "https://stackoverflow.com/questions/56976579/how-to-remove-gameobjects-from-a-new-list-and-reset-list-size-back-to-0/56978249#56978249", "title": "How to remove gameobjects from a new List and reset list size back to 0?", "body": "<p>Thank you for the help but I found the answer which this may have helped everyone out if I would have mentioned it before. I was working with two separate scripts. Script1 as a main controller with all the gameobjects and lists which Script 1 called the functions from Script 2 that utilized the variables from script 1.  </p>\n\n<p>To be able to use variables in Script 1 across all scripts they needed to be <strong>Static</strong></p>\n\n<p><strong><em>Issue</em>:</strong></p>\n\n<p><strong>Incorrect:</strong>  public List&lt; GameObject > ObjectList = new List&lt; GameObject >();</p>\n\n<p><strong>Correct:</strong> public <strong>Static</strong> List&lt; GameObject > ObjectList = new List&lt; GameObject >();</p>\n\n<p>My apologies. </p>\n"}], "owner": {"reputation": 1, "user_id": 11096879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YfsHKMlXysY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzyunlOYUIa6qBjopDUeBp_yeV-g/mo/photo.jpg?sz=128", "display_name": "Medlin", "link": "https://stackoverflow.com/users/11096879/medlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 580, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562790862, "creation_date": 1562783041, "last_edit_date": 1562786333, "question_id": 56976579, "link": "https://stackoverflow.com/questions/56976579/how-to-remove-gameobjects-from-a-new-list-and-reset-list-size-back-to-0", "title": "How to remove gameobjects from a new List and reset list size back to 0?", "body": "<p>currently I am running into an issue where I add a gameobject to a new List &lt; Gameobject > () but when I clear the list I am unable to return the list size back to 0. I receive a Missing (Game Object) and the list size still \"1\".  </p>\n\n<p>I have tried the list.clear() method but receive size at 1 and Missing (Gameobject). I have also tried a forloop to get the count and then RemoveAt(i) Method but receive the same.</p>\n\n<p>I am using Unity's Inspector to visually see this issue. </p>\n\n<p>Example:</p>\n\n<pre><code>public GameObject Object;\n\npublic List&lt;GameObject&gt; ObjectList = new List&lt;GameObject&gt;();\n\npublic void AddObjectToList()\n{\n    ObjectList.Add(Object);\n}\n\npublic void RemoveObjectsFromList()\n{\n    //Attempt 1\n    ObjectList.Clear();\n\n    //Attempt 2\n    for (int i = 0; i &lt; ObjectList.Count; ++i)\n    {\n        ObjectList.RemoveAt(i);\n    }\n\n}\n</code></pre>\n\n<p>Expecting to clear Game Objects from list and return List size to 0.</p>\n"}, {"tags": ["c#", "uwp", "win-universal-app", "windows-10-universal", "desktop-bridge"], "answers": [{"comments": [{"owner": {"reputation": 23403, "user_id": 939213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85abdf3e1c88011c45e1a0cae01df78b?s=128&d=identicon&r=PG", "display_name": "ispiro", "link": "https://stackoverflow.com/users/939213/ispiro"}, "edited": false, "score": 0, "creation_date": 1562783757, "post_id": 56976608, "comment_id": 100489655, "body": "Thanks. So I understand that that file does <i>not</i> need to be on the user&#39;s machine (because an M machine won&#39;t have the T file). Correct?"}, {"owner": {"reputation": 12794, "user_id": 686985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE56D.jpg?s=128&g=1", "display_name": "Stefan Wick  MSFT", "link": "https://stackoverflow.com/users/686985/stefan-wick-msft"}, "reply_to_user": {"reputation": 23403, "user_id": 939213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85abdf3e1c88011c45e1a0cae01df78b?s=128&d=identicon&r=PG", "display_name": "ispiro", "link": "https://stackoverflow.com/users/939213/ispiro"}, "edited": false, "score": 0, "creation_date": 1562788530, "post_id": 56976608, "comment_id": 100491627, "body": "Correct, you don&#39;t need to distribute the windows.winmd file."}], "tags": [], "owner": {"reputation": 12794, "user_id": 686985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE56D.jpg?s=128&g=1", "display_name": "Stefan Wick  MSFT", "link": "https://stackoverflow.com/users/686985/stefan-wick-msft"}, "is_accepted": true, "score": 2, "last_activity_date": 1562783190, "creation_date": 1562783190, "answer_id": 56976608, "question_id": 56976364, "link": "https://stackoverflow.com/questions/56976364/references-to-winmd-files-do-the-files-need-to-exist-on-the-users-machines/56976608#56976608", "title": "References to winmd files - do the files need to exist on the users&#39; machines?", "body": "<p>If you are targetting version 'T' you need to have the Windows SDK for version 'T' installed. Then reference the windows.winmd for that version.</p>\n\n<p>Follow the adaptive coding guidelines to ensure your app works correctly on your minimum version 'M': <a href=\"https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/version-adaptive-code\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/version-adaptive-code</a> </p>\n\n<p>Needless to say you should also test your app on a device running OS version 'T', not only on your dev machine running OS version 'C'.  </p>\n\n<p>As an aside, from a forward looking perspective, you also might be interesting in learning about this preview: <a href=\"https://blogs.windows.com/windowsdeveloper/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/\" rel=\"nofollow noreferrer\">https://blogs.windows.com/windowsdeveloper/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/</a></p>\n"}], "owner": {"reputation": 23403, "user_id": 939213, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/85abdf3e1c88011c45e1a0cae01df78b?s=128&d=identicon&r=PG", "display_name": "ispiro", "link": "https://stackoverflow.com/users/939213/ispiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 56976608, "answer_count": 1, "score": 1, "last_activity_date": 1565547466, "creation_date": 1562782047, "last_edit_date": 1565547466, "question_id": 56976364, "link": "https://stackoverflow.com/questions/56976364/references-to-winmd-files-do-the-files-need-to-exist-on-the-users-machines", "title": "References to winmd files - do the files need to exist on the users&#39; machines?", "body": "<p>When creating Desktop-Bridge (\"Centennial\") apps, we sometimes need to reference winmd files manually by using \"browse\". If we're <strong>T</strong>argeting a certain version <strong>T</strong> of Windows 10, with <strong>M</strong>inimum version <strong>M</strong>, but we're developing it on a <strong>C</strong>omputer with version <strong>C</strong>. Which one of the winmd files should we target? <strong>T</strong>, <strong>M</strong>, or <strong>C</strong>? Does the file need to exist on the users' machines?</p>\n"}, {"tags": ["c#", "jquery", "asp.net", "asp.net-mvc", "jquery-ui"], "comments": [{"owner": {"reputation": 23103, "user_id": 463319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PV2Te.jpg?s=128&g=1", "display_name": "Twisty", "link": "https://stackoverflow.com/users/463319/twisty"}, "edited": false, "score": 0, "creation_date": 1562809377, "post_id": 56976260, "comment_id": 100496898, "body": "Consider adding <code>console.log(enableDays);</code> after it&#39;s been created and examine the output. Make sure you&#39;re getting the data you expect in HTML/JavaScript."}, {"owner": {"reputation": 23103, "user_id": 463319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PV2Te.jpg?s=128&g=1", "display_name": "Twisty", "link": "https://stackoverflow.com/users/463319/twisty"}, "edited": false, "score": 0, "creation_date": 1562809667, "post_id": 56976260, "comment_id": 100496953, "body": "Also I would return <code>return [true, &quot;&quot;, &quot;&quot;];</code> or <code>return [false, &quot;&quot;, &quot;&quot;];</code> as described in the API: <a href=\"https://api.jqueryui.com/datepicker/#option-beforeShowDay\" rel=\"nofollow noreferrer\">api.jqueryui.com/datepicker/#option-beforeShowDay</a> Index 0 and 1 are required, 2 is Optional."}, {"owner": {"reputation": 75, "user_id": 1940519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37219ed252cf227ad611089b6dc2b9f2?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/1940519/craig"}, "reply_to_user": {"reputation": 23103, "user_id": 463319, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PV2Te.jpg?s=128&g=1", "display_name": "Twisty", "link": "https://stackoverflow.com/users/463319/twisty"}, "edited": false, "score": 0, "creation_date": 1562844530, "post_id": 56976260, "comment_id": 100510808, "body": "@Twisty Thanks for the reply mate! I added console.log and got the following returned: Array(1) 0: &quot; 10-10-1990&amp;#39;,&amp;#39;07-01-2019&amp;#39;,&amp;#39;07-31-2019&amp;#39;,&amp;#&zwnj;&#8203;39;07-15-2019 &quot; length: 1. Can you see why this line of code is giving this output? My JavaScript knowledge isn&#39;t the best"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 1940519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37219ed252cf227ad611089b6dc2b9f2?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/1940519/craig"}, "edited": false, "score": 0, "creation_date": 1562784569, "post_id": 56976542, "comment_id": 100490007, "body": "Thanks for the reply. Although I think you misunderstood my question. I have no problem getting the date into the field from the Calendar UI, the problem I have is even though the Datepicker database holds 10 dates in the month of July 2019, they are not showing up in the calendar in the view."}], "tags": [], "owner": {"reputation": 11, "user_id": 11336388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bac85684f691f856992ee7e771ea7b7?s=128&d=identicon&r=PG&f=1", "display_name": "M1976", "link": "https://stackoverflow.com/users/11336388/m1976"}, "is_accepted": false, "score": 0, "last_activity_date": 1562782864, "creation_date": 1562782864, "answer_id": 56976542, "question_id": 56976260, "link": "https://stackoverflow.com/questions/56976260/populating-jquery-datepicker-with-specific-dates/56976542#56976542", "title": "Populating jQuery Datepicker with specific dates", "body": "<p>Try the solution here.</p>\n\n<p><a href=\"https://forum.jquery.com/topic/default-date-for-date-picker\" rel=\"nofollow noreferrer\">https://forum.jquery.com/topic/default-date-for-date-picker</a></p>\n\n<p>It looks like you need to use the setDate command. That may do what you need.</p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 1940519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37219ed252cf227ad611089b6dc2b9f2?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/1940519/craig"}, "is_accepted": false, "score": 0, "last_activity_date": 1562848417, "creation_date": 1562848417, "answer_id": 56989310, "question_id": 56976260, "link": "https://stackoverflow.com/questions/56976260/populating-jquery-datepicker-with-specific-dates/56989310#56989310", "title": "Populating jQuery Datepicker with specific dates", "body": "<p>So apparently, it's encoding it to prevent code injection as a defense against XSS. Since this is known to be just DateTime values, It can be overridden using @Html.Raw</p>\n\n<pre><code>var enableDays = ['@Html.Raw(string.Join(\"','\", Model.Select(d =&gt; \nd.DtmDate.ToString(\"MM-dd-yyyy\")))'];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11336388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bac85684f691f856992ee7e771ea7b7?s=128&d=identicon&r=PG&f=1", "display_name": "M1976", "link": "https://stackoverflow.com/users/11336388/m1976"}, "is_accepted": false, "score": 0, "last_activity_date": 1562857068, "creation_date": 1562857068, "answer_id": 56992151, "question_id": 56976260, "link": "https://stackoverflow.com/questions/56976260/populating-jquery-datepicker-with-specific-dates/56992151#56992151", "title": "Populating jQuery Datepicker with specific dates", "body": "<p>Ok, try this solution: </p>\n\n<p><a href=\"https://forum.jquery.com/topic/jquery-datepicker-pick-multiple-dates\" rel=\"nofollow noreferrer\">https://forum.jquery.com/topic/jquery-datepicker-pick-multiple-dates</a></p>\n\n<p>Based on that, you will either need a 3rd party plug-in, or you'll have to \"roll your own\".</p>\n"}], "owner": {"reputation": 75, "user_id": 1940519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37219ed252cf227ad611089b6dc2b9f2?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/1940519/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1562857068, "creation_date": 1562781651, "last_edit_date": 1562790545, "question_id": 56976260, "link": "https://stackoverflow.com/questions/56976260/populating-jquery-datepicker-with-specific-dates", "title": "Populating jQuery Datepicker with specific dates", "body": "<p>I am trying to make an asp.net mvc view for a user to use the jQuery UI Datepicker to select  only from a specific number of available dates like the picture below.</p>\n\n<p><img src=\"https://i.ibb.co/BypLpzq/ugh.jpg\" alt=\"a busy cat\"></p>\n\n<p>So far I have used the controller to pass in a List of Datepicker to the view, which includes all of the dates that the jQuery Calendar should show to the user. The problem is, the calendar remains blank for some reason i.e.  the dates from the database are not showing up in the calendar.</p>\n\n<p>My Datepicker Model:</p>\n\n<pre><code>namespace BookingSys.Models\n{\n  public class Datepicker\n  {\n    public DateTime Date { get; set; }\n    public int Id { get; set; }\n    public int LecturerId { get; set; }\n    public string Comment { get; set; }\n  }\n}\n</code></pre>\n\n<p>DbContext:</p>\n\n<pre><code>namespace BookingSys.Models\n{\n  public class BookingSysDb : DbContext\n  {\n    public DbSet&lt;Datepicker&gt; Dates { get; set; }\n  }\n}\n</code></pre>\n\n<p>My Booking Controller:</p>\n\n<pre><code>[HttpGet]\n    public ActionResult Booking()\n    {\n        var model = db.Dates.ToList();\n        return View(model);\n    }\n</code></pre>\n\n<p>My Schoool/Booking View :</p>\n\n<pre><code>@model List&lt;BookingSys.Models.Datepicker&gt;\n\n@{\nViewBag.Title = \"Booking\";\n}\n\n&lt;h2&gt;School Bookings&lt;/h2&gt;\n\n&lt;form asp-controller=\"School\" asp-action=\"Booking\" method=\"post\"&gt;\n&lt;input asp-for=\"School.Date\" id=\"txtDate\" /&gt;&lt;br /&gt;\n&lt;button&gt;Submit&lt;/button&gt;\n&lt;/form&gt;\n\n&lt;link href=\"~/Content/themes/base/jquery-ui.min.css\" rel=\"stylesheet\" /&gt;\n\n@section scripts {\n\n&lt;script src=\"~/Scripts/jquery-ui-1.12.1.min.js\"&gt;&lt;/script&gt;\n&lt;script&gt;\n            jQuery(function () {\n                var enableDays = [' @(string.Join(\"','\", Model.Select(d =&gt; \n               d.Date.ToString(\"dd-MM-yyyy\")))) ']; // **** I think this line of code may be causing the problem\n\n                function enableAllTheseDays(date) {\n                    var sdate = $.datepicker.formatDate('dd-mm-yy', date)\n                    console.log(sdate)\n                    if ($.inArray(sdate, enableDays) != -1) {\n                        return [true];\n                    }\n                    return [false];\n                }\n\n                $(\"#txtDate\").datepicker({\n                    dateFormat: \"dd/MM/yy\",\n                    beforeShowDay: enableAllTheseDays\n\n                });\n            });\n  &lt;/script&gt;\n\n  @Scripts.Render(\"~/bundles/jqueryval\")\n}\n\n&lt;style&gt;\n.my-class a {\n    background-color: #07ea69 !important;\n    background-image: none !important;\n    color: #ffffff !important;\n}\n&lt;/style&gt;\n</code></pre>\n\n<p>Can anyone tell me why my calendar is not showing the dates from the Datepicker database conext? Even though the Datepicker database holds 10 dates in the month of July 2019, they are not showing up in the calendar the view.</p>\n\n<p>Cheers</p>\n"}, {"tags": ["c#", "wpf", "listview", "listviewitem"], "comments": [{"owner": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 0, "creation_date": 1562781447, "post_id": 56976193, "comment_id": 100488602, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1462232/selected-item-loses-style-when-focus-moved-out-in-wpf-listbox\">Selected item loses style when focus moved out in WPF ListBox</a>"}, {"owner": {"reputation": 568, "user_id": 10266595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155668743473314/picture?type=large", "display_name": "David Andrew Thorpe", "link": "https://stackoverflow.com/users/10266595/david-andrew-thorpe"}, "reply_to_user": {"reputation": 3884, "user_id": 1701463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f8e27e87b40bc3c624c85816c6adc155?s=128&d=identicon&r=PG", "display_name": "MikeH", "link": "https://stackoverflow.com/users/1701463/mikeh"}, "edited": false, "score": 0, "creation_date": 1562781582, "post_id": 56976193, "comment_id": 100488656, "body": "I&#39;ve already seen that question and it hasn&#39;t helped me unfortunately. Also, that&#39;s a listbox, I&#39;m using a listview. @MikeH"}], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 10266595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155668743473314/picture?type=large", "display_name": "David Andrew Thorpe", "link": "https://stackoverflow.com/users/10266595/david-andrew-thorpe"}, "edited": false, "score": 0, "creation_date": 1562834260, "post_id": 56983148, "comment_id": 100504827, "body": "Hi thanks for the answer, but I paste it into my listview and nothing changes."}, {"owner": {"reputation": 319, "user_id": 11711668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e634b69b02f56dcca2506314b23ef98?s=128&d=identicon&r=PG&f=1", "display_name": "Aakanksha", "link": "https://stackoverflow.com/users/11711668/aakanksha"}, "reply_to_user": {"reputation": 568, "user_id": 10266595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155668743473314/picture?type=large", "display_name": "David Andrew Thorpe", "link": "https://stackoverflow.com/users/10266595/david-andrew-thorpe"}, "edited": false, "score": 0, "creation_date": 1562836947, "post_id": 56983148, "comment_id": 100506308, "body": "Instead of ListView can you try to use ListBox."}, {"owner": {"reputation": 568, "user_id": 10266595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155668743473314/picture?type=large", "display_name": "David Andrew Thorpe", "link": "https://stackoverflow.com/users/10266595/david-andrew-thorpe"}, "edited": false, "score": 0, "creation_date": 1562837428, "post_id": 56983148, "comment_id": 100506614, "body": "I&#39;d rather not. Why would that make a difference anyway?"}, {"owner": {"reputation": 319, "user_id": 11711668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e634b69b02f56dcca2506314b23ef98?s=128&d=identicon&r=PG&f=1", "display_name": "Aakanksha", "link": "https://stackoverflow.com/users/11711668/aakanksha"}, "reply_to_user": {"reputation": 568, "user_id": 10266595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155668743473314/picture?type=large", "display_name": "David Andrew Thorpe", "link": "https://stackoverflow.com/users/10266595/david-andrew-thorpe"}, "edited": false, "score": 0, "creation_date": 1562838167, "post_id": 56983148, "comment_id": 100507087, "body": "It works in the Listbox. Or just try to add the code in ListView Style"}], "tags": [], "owner": {"reputation": 319, "user_id": 11711668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e634b69b02f56dcca2506314b23ef98?s=128&d=identicon&r=PG&f=1", "display_name": "Aakanksha", "link": "https://stackoverflow.com/users/11711668/aakanksha"}, "is_accepted": false, "score": 0, "last_activity_date": 1562932650, "last_edit_date": 1562932650, "creation_date": 1562827586, "answer_id": 56983148, "question_id": 56976193, "link": "https://stackoverflow.com/questions/56976193/keeping-a-listviewitem-highlighted-when-control-loses-focus/56983148#56983148", "title": "Keeping a listviewitem highlighted when control loses focus", "body": "<p>The ListView will loose the focus when someother control has the focus. It cannot be avoided. \nBut you can change the color of the ListView selected item when it does not have focus\nYou need to set the color of the ListView selected item not focused.\nJust set the inactive selection color which will highlight the listview selected item when it looses focus.</p>\n\n<pre><code>&lt;ListView.Style&gt;\n    &lt;Style TargetType=\"{x:Type ListViewItem}\"&gt;\n       &lt;Style.Resources&gt;\n           &lt;SolidColorBrush x:Key=\"{x:Static SystemColors.InactiveSelectionHighlightBrushKey}\" Color=\"Red\"/&gt;\n       &lt;/Style.Resources&gt;\n    &lt;/Style&gt;\n&lt;/&lt;ListView.Style&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1115, "user_id": 658394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a41c63cc61fe7b04f22cd114c1c74436?s=128&d=identicon&r=PG", "display_name": "Lupu Silviu", "link": "https://stackoverflow.com/users/658394/lupu-silviu"}, "is_accepted": true, "score": 1, "last_activity_date": 1562918085, "creation_date": 1562918085, "answer_id": 57002540, "question_id": 56976193, "link": "https://stackoverflow.com/questions/56976193/keeping-a-listviewitem-highlighted-when-control-loses-focus/57002540#57002540", "title": "Keeping a listviewitem highlighted when control loses focus", "body": "<p>I hope I understand what you requested. My proposed solution is:\nResources:</p>\n\n<pre><code>  &lt;Style TargetType=\"ListViewItem\" x:Key=\"ItemStyle\"&gt;\n        &lt;Setter Property=\"Background\" Value=\"Red\"/&gt;\n\n        &lt;Style.Triggers&gt;\n            &lt;DataTrigger Binding=\"{Binding IsSelected, RelativeSource={RelativeSource Self}}\" Value=\"true\"&gt;\n                &lt;Setter Property=\"Background\" Value=\"Blue\"/&gt;\n                &lt;Setter Property=\"Template\"&gt;\n                    &lt;Setter.Value&gt;\n                        &lt;ControlTemplate TargetType=\"{x:Type ListViewItem}\"&gt;\n                            &lt;Border Name=\"Border\" \n                                    BorderBrush=\"{TemplateBinding BorderBrush}\" \n                                    BorderThickness=\"{TemplateBinding BorderThickness}\" \n                                    Background=\"{TemplateBinding Background}\"&gt;\n                                &lt;ContentPresenter Content=\"{TemplateBinding Content}\" \n                                                  ContentTemplate=\"{TemplateBinding ContentTemplate}\"\n                                                  Margin=\"{TemplateBinding Padding}\" /&gt;\n                            &lt;/Border&gt;\n                        &lt;/ControlTemplate&gt;\n                    &lt;/Setter.Value&gt;\n                &lt;/Setter&gt;\n            &lt;/DataTrigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n\n   &lt;DataTemplate x:Key=\"TabListViewItemTemplate\"&gt;\n        &lt;TextBlock Text=\"{Binding }\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"/&gt;\n    &lt;/DataTemplate&gt;\n</code></pre>\n\n<p>And the ListView:</p>\n\n<pre><code> &lt;ListView x:Name=\"lvTabs\" Width=\"100\" Height=\"200\"\n              HorizontalAlignment=\"Left\" VerticalAlignment=\"Top\"\n              ItemsSource=\"{Binding }\" ItemTemplate=\"{StaticResource TabListViewItemTemplate}\"\n              ItemContainerStyle=\"{StaticResource ItemStyle}\" &gt;\n\n        &lt;ListView.ItemsPanel&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;StackPanel Orientation=\"Horizontal\"&gt;&lt;/StackPanel&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/ListView.ItemsPanel&gt;\n    &lt;/ListView&gt;\n</code></pre>\n\n<p>I added an array of strings to test the solution.</p>\n\n<pre><code> this.DataContext = new string[] { \"Tab1\", \"Tab2\" };\n</code></pre>\n\n<p>It should work with any DataTemplate, as it changes the background only.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14798829, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gj9Tdd2dHgSxBAmTBdAL14feXV_TVZ9wScZvcDi=k-s128", "display_name": "Proxy Prochy", "link": "https://stackoverflow.com/users/14798829/proxy-prochy"}, "is_accepted": false, "score": 0, "last_activity_date": 1607578361, "creation_date": 1607578361, "answer_id": 65229022, "question_id": 56976193, "link": "https://stackoverflow.com/questions/56976193/keeping-a-listviewitem-highlighted-when-control-loses-focus/65229022#65229022", "title": "Keeping a listviewitem highlighted when control loses focus", "body": "<p>Based on MaterialDesign ^^ the key is to change IsSelected property instead of IsFocused</p>\n<pre><code>&lt;ListBox ScrollViewer.HorizontalScrollBarVisibility=&quot;Disabled&quot;&gt;\n                &lt;ListBox.ItemsPanel&gt;\n                    &lt;ItemsPanelTemplate&gt;\n                        &lt;WrapPanel IsItemsHost=&quot;True&quot; /&gt;\n                    &lt;/ItemsPanelTemplate&gt;\n                &lt;/ListBox.ItemsPanel&gt;\n                &lt;ListBox.ItemContainerStyle&gt;\n                    &lt;Style TargetType=&quot;ListBoxItem&quot; BasedOn=&quot;{StaticResource MaterialDesignListBoxItem}&quot;&gt;\n                        &lt;Setter Property=&quot;Foreground&quot; Value=&quot;#DDDDDD&quot;&gt;&lt;/Setter&gt;\n                        &lt;Setter Property=&quot;MinHeight&quot; Value=&quot;100&quot;&gt;&lt;/Setter&gt;\n                        &lt;Setter Property=&quot;MinWidth&quot; Value=&quot;160&quot;&gt;&lt;/Setter&gt;\n                        &lt;Setter Property=&quot;Padding&quot; Value=&quot; 15 0 0 0&quot;&gt;&lt;/Setter&gt;\n                        &lt;Setter Property=&quot;Background&quot; Value=&quot;#333&quot;&gt;&lt;/Setter&gt;\n                        &lt;Setter Property=&quot;FontSize&quot; Value=&quot;16&quot;&gt;&lt;/Setter&gt;\n                        &lt;Setter Property=&quot;BorderThickness&quot; Value=&quot;0&quot;&gt;&lt;/Setter&gt;\n                        &lt;Style.Triggers&gt;\n                            &lt;Trigger Property=&quot;IsSelected&quot; Value=&quot;True&quot;&gt;\n                                &lt;Setter Property=&quot;Background&quot; Value=&quot;#FFD610&quot;&gt;&lt;/Setter&gt;\n                                &lt;Setter Property=&quot;Foreground&quot; Value=&quot;White&quot;&gt;&lt;/Setter&gt;\n                                &lt;Setter Property=&quot;FontSize&quot; Value=&quot;18&quot;&gt;&lt;/Setter&gt;\n                            &lt;/Trigger&gt;\n                    &lt;/Style.Triggers&gt;\n                    &lt;/Style&gt;\n                &lt;/ListBox.ItemContainerStyle&gt;\n\n\n            &lt;ListBoxItem&gt;listbox item 1&lt;/ListBoxItem&gt;\n                &lt;ListBoxItem&gt;listbox item 2&lt;/ListBoxItem&gt;\n                &lt;ListBoxItem&gt;listbox item 3&lt;/ListBoxItem&gt;\n                &lt;ListBoxItem&gt;listbox item 4&lt;/ListBoxItem&gt;\n                &lt;ListBoxItem&gt;listbox item 5&lt;/ListBoxItem&gt;\n            &lt;/ListBox&gt;\n</code></pre>\n"}], "owner": {"reputation": 568, "user_id": 10266595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155668743473314/picture?type=large", "display_name": "David Andrew Thorpe", "link": "https://stackoverflow.com/users/10266595/david-andrew-thorpe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 57002540, "answer_count": 3, "score": 0, "last_activity_date": 1607578361, "creation_date": 1562781335, "question_id": 56976193, "link": "https://stackoverflow.com/questions/56976193/keeping-a-listviewitem-highlighted-when-control-loses-focus", "title": "Keeping a listviewitem highlighted when control loses focus", "body": "<p>I have created tab functionality from a listview. The problem I'm having is that the selected item loses focus when I click away from the control. I want the selected item to stay highlighted so the user knows which tab (listviewitem) they are currently on.</p>\n\n<p>Side note: I am using MaterialDesign for styling.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>&lt;ListView x:Name=\"lvTabs\"\n    ItemsSource=\"{Binding tabItems}\" ItemTemplate=\" \n    {StaticResource TabListViewItemTemplate}\"&gt;\n\n                &lt;ListView.ItemsPanel&gt;\n                    &lt;ItemsPanelTemplate&gt;\n                        &lt;StackPanel Orientation=\"Horizontal\"&gt;&lt;/StackPanel&gt;\n                    &lt;/ItemsPanelTemplate&gt;\n                &lt;/ListView.ItemsPanel&gt;\n            &lt;/ListView&gt;\n</code></pre>\n"}, {"tags": ["c#", "xamarin", "location", "maps"], "comments": [{"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562781787, "post_id": 56976185, "comment_id": 100488736, "body": "you need to add a map control to your app, not call the external map app.  Read the docs: <a href=\"https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/map\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interfac&zwnj;&#8203;e/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5498609"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562783116, "post_id": 56976185, "comment_id": 100489384, "body": "Hey, thx for answer, but here in docs there is usage of Google Maps API key, I don&#39;t have a key and I am wondering is it possible to do it without Google Maps API key?"}, {"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562783406, "post_id": 56976185, "comment_id": 100489515, "body": "Not on Android.  Is there a reason you can&#39;t get an API Key?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5498609"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562783489, "post_id": 56976185, "comment_id": 100489539, "body": "Well, can I get it for free or it requires fee?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5498609"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562791180, "post_id": 56976185, "comment_id": 100492636, "body": "Is it even possible add map in your app if you are not using Google Maps API?"}, {"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562791281, "post_id": 56976185, "comment_id": 100492683, "body": "Use a map that doesn&#39;t depend on the Google API.  Or just get a free Google API key.  It takes 5 minutes to do."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5498609"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562795016, "post_id": 56976185, "comment_id": 100493976, "body": "What map would that be? But what are limiations of free Google API key? How many users can use it?"}, {"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1562796124, "post_id": 56976185, "comment_id": 100494281, "body": "SO is not a free research service.  You can easily search for these answers yourself."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5498609"}, "is_accepted": true, "score": 0, "last_activity_date": 1563882855, "creation_date": 1563882855, "answer_id": 57163672, "question_id": 56976185, "link": "https://stackoverflow.com/questions/56976185/how-to-add-pins-to-map/57163672#57163672", "title": "How to add pins to map?", "body": "<p>thx all for feedback, using Google Maps API is easiest and best solution for this! :-)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5498609"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 57163672, "answer_count": 1, "score": 0, "last_activity_date": 1563882855, "creation_date": 1562781314, "last_edit_date": 1562781718, "question_id": 56976185, "link": "https://stackoverflow.com/questions/56976185/how-to-add-pins-to-map", "title": "How to add pins to map?", "body": "<p>So I am creating an app which will have map with pre added locations (pins) into it and when user comes near that location (s)he will get notification. My  problem is, how to add Pins into Xamarin Maps? I am not using Google Maps, I am trying to do with \"Xamarin Custom Map?\". </p>\n\n<p>I have opened map, but it is opening in Google Maps appliation. I looked for a way not to use Google Maps Api, but I didn't find a single solution how to do this without Google Maps, so is it even possible?</p>\n\n<pre><code>var locator = CrossGeolocator.Current;\nlocator.DesiredAccuracy = 20;\n\nvar position = await locator.GetPositionAsync(TimeSpan.FromSeconds(20), null, true);\n\nMap.OpenAsync(position.Latitude, position.Longitude);\n</code></pre>\n\n<p>This code here opens map application on my smartphone (in this case GoogleMaps), so I am wondering is it possible to add pins to it, or somehow open map inside of my app wihtout using Google Maps API?</p>\n"}, {"tags": ["c#", "linq", ".net-core"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562781271, "post_id": 56976107, "comment_id": 100488528, "body": "The string <code>&quot;The name of the shift&quot;</code> is not present anywhere in your code that I can see.  Why is that the expected output?"}, {"owner": {"reputation": 583, "user_id": 2720343, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cvJ2G.jpg?s=128&g=1", "display_name": "Dortimer", "link": "https://stackoverflow.com/users/2720343/dortimer"}, "edited": false, "score": 1, "creation_date": 1562781282, "post_id": 56976107, "comment_id": 100488536, "body": "Can you post the relevant class(es)?"}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 1, "creation_date": 1562781529, "post_id": 56976107, "comment_id": 100488634, "body": "Without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that clarifies your specific problem or additional details to highlight exactly what was done, it\u2019s hard to reproduce the problem, allowing a better understanding of what is being asked."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 11400933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IaMO3L-jajQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcJev3bF80lFjNfFQmPjNmBMn8ueA/mo/photo.jpg?sz=128", "display_name": "qpc4ever", "link": "https://stackoverflow.com/users/11400933/qpc4ever"}, "edited": false, "score": 0, "creation_date": 1562786503, "post_id": 56976685, "comment_id": 100490803, "body": "Thank you, but the issue I&#39;m having is more with the linq query than the view model. The shiftTarget var is getting the correct value. I can check it by passing shiftTarget in the return view parameter and using the TblShiftInfo model inside the view. But if I use the view model or even a view bag, instead of getting my expected data (ie the name of the shift) like I get when I pass shiftTarget in the return view parameter, I get TRAIntranet2019.Models.TblShiftInfo, which is just the model I am returning the data from in the linq query. ToString is the only difference between the two."}, {"owner": {"reputation": 61, "user_id": 11697412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Aj4r0.png?s=128&g=1", "display_name": "jctalavan", "link": "https://stackoverflow.com/users/11697412/jctalavan"}, "reply_to_user": {"reputation": 67, "user_id": 11400933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IaMO3L-jajQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcJev3bF80lFjNfFQmPjNmBMn8ueA/mo/photo.jpg?sz=128", "display_name": "qpc4ever", "link": "https://stackoverflow.com/users/11400933/qpc4ever"}, "edited": false, "score": 1, "creation_date": 1562825715, "post_id": 56976685, "comment_id": 100500623, "body": "mmmm I understand...  the problem is that the result of your linq query is an object of type Shift_Name (instead if could be a null too) and then you are calling ToString() on an object which by default gives you the namespace of that object.  That&#180;s the problem:  Shift_Name = shiftTarget.ToString()  Dont&#180;t use ToString() like this, you should call:  Shift_Name = shiftTarget;  And then you should use the properties or fields in the Shift_Name instance, like this:  &lt;p&gt;@ViewBag.TblShiftInfo.Shift_Name.PROPERTY&lt;/p&gt;"}, {"owner": {"reputation": 67, "user_id": 11400933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IaMO3L-jajQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcJev3bF80lFjNfFQmPjNmBMn8ueA/mo/photo.jpg?sz=128", "display_name": "qpc4ever", "link": "https://stackoverflow.com/users/11400933/qpc4ever"}, "edited": false, "score": 0, "creation_date": 1562849589, "post_id": 56976685, "comment_id": 100513935, "body": "Thanks again! The problem is that if I don&#39;t use ToString() I get &quot;cannot implicitly convert type &#39;TRAIntranet2019.Models.TblShiftInfo&#39; to &#39;string&#39;&quot; error on shiftTarget inside my new instance of TblShiftInfo. TblShiftInfo tblShiftInfo = new TblShiftInfo()             {                                 Shift_Name = shiftTarget             };"}, {"owner": {"reputation": 67, "user_id": 11400933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IaMO3L-jajQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcJev3bF80lFjNfFQmPjNmBMn8ueA/mo/photo.jpg?sz=128", "display_name": "qpc4ever", "link": "https://stackoverflow.com/users/11400933/qpc4ever"}, "edited": false, "score": 0, "creation_date": 1562850329, "post_id": 56976685, "comment_id": 100514449, "body": "Your answer worked out great with a viewbag, so thanks a million! but I still am having  the same issue when trying to use the view model."}], "tags": [], "owner": {"reputation": 61, "user_id": 11697412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Aj4r0.png?s=128&g=1", "display_name": "jctalavan", "link": "https://stackoverflow.com/users/11697412/jctalavan"}, "is_accepted": true, "score": 1, "last_activity_date": 1562783510, "creation_date": 1562783510, "answer_id": 56976685, "question_id": 56976107, "link": "https://stackoverflow.com/questions/56976107/trouble-with-getting-linq-values-to-display-correctly-in-view-using-view-model/56976685#56976685", "title": "Trouble with getting linq values to display correctly in view using view model", "body": "<p>I don\u00b4t understand the question but try to figure out...</p>\n\n<ul>\n<li>Using ViewModel:</li>\n</ul>\n\n<p>The action on the controller:</p>\n\n<pre><code>public IActionResult About()\n        {\n            TblShiftInfo tblShiftInfo = new TblShiftInfo()\n            {\n                Shift_Name = \"Shift Name Example\",\n                ShiftAvgTarget = 12345\n            };\n\n            LandingPageVM vm = new LandingPageVM()\n            {\n                TblShiftInfo = tblShiftInfo,\n            };\n\n            return View(vm);\n        }\n</code></pre>\n\n<p>The view:</p>\n\n<pre><code>@model MyWevApp2.Models.LandingPageVM\n\n&lt;h2&gt;Data in ViewModel&lt;/h2&gt;\n\n&lt;p&gt;@Model.TblShiftInfo.Shift_Name&lt;/p&gt;\n&lt;p&gt;@Model.TblShiftInfo.ShiftAvgTarget&lt;/p&gt;\n</code></pre>\n\n<ul>\n<li>Using ViewBag or ViewData.</li>\n</ul>\n\n<p>If you don\u00b4t want to use a ViewModel... you can use ViewBag or ViewData. For example:</p>\n\n<p>Controller:</p>\n\n<pre><code>public IActionResult Contact()\n{\n    TblShiftInfo tblShiftInfo = new TblShiftInfo()\n    {\n        Shift_Name = \"Shift Name Example\",\n        ShiftAvgTarget = 12345\n    };\n\n    ViewBag.TblShiftInfo = tblShiftInfo;\n\n        return View();\n    }\n</code></pre>\n\n<p>In the view, you can use the ViewBag:</p>\n\n<pre><code>&lt;p&gt;@ViewBag.TblShiftInfo.Shift_Name&lt;/p&gt;\n</code></pre>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 67, "user_id": 11400933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IaMO3L-jajQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcJev3bF80lFjNfFQmPjNmBMn8ueA/mo/photo.jpg?sz=128", "display_name": "qpc4ever", "link": "https://stackoverflow.com/users/11400933/qpc4ever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1562783550, "accepted_answer_id": 56976685, "answer_count": 1, "score": 0, "last_activity_date": 1562783510, "creation_date": 1562780990, "last_edit_date": 1562781495, "question_id": 56976107, "link": "https://stackoverflow.com/questions/56976107/trouble-with-getting-linq-values-to-display-correctly-in-view-using-view-model", "closed_reason": "Not suitable for this site", "title": "Trouble with getting linq values to display correctly in view using view model", "body": "<p>I am trying to display data retrieved from a linq query in a view via a view model. I have a variable set to the linq query and then I am referencing it in an instance of the table in the view model. If I forgo the view model and just return the variable in the return view, I get my desired data. When I try to use the view model, I am forced to call ToString when I reference the linq query variable and instead of my desired result data, I get this TRAIntranet2019.Models.TblShiftInfo which is the table I am querying. And I am changing the model reference at the top of my view for either the view model (when using the view model) or the regular model (when using just the linq variable). Shift target is the current example I'm working on.</p>\n\n<pre><code>private TRAKERContext db = new TRAKERContext();\n\n// GET: LandingPageVMs\npublic IActionResult Index()\n{\n\n    var shiftTarget = db.TblShiftInfo.FirstOrDefault();\n    //var rvuvalue = db.Tradetail.FirstOrDefault().ToString();\n\n\n\n    TblShiftByRadByDate tblShiftByRadByDate = new TblShiftByRadByDate()\n    {\n        //ShiftName = \"Late Night Shift\"\n    };\n\n    Tradetail tradetail = new Tradetail()\n    {\n        //Rvuvalue = (double)rvuvalue\n        //SignLastName = rvuvalue.ToString()\n    };\n\n    TblShiftInfo tblShiftInfo = new TblShiftInfo()\n    {\n        //ShiftAvgTarget = Convert.ToDouble(shiftTarget),\n        Shift_Name = shiftTarget.ToString()\n\n    };\n\n    RadidCrosswalk radidCrosswalk = new RadidCrosswalk()\n    {\n        RadFname = \"Jimmie\"\n    };\n\n    FacilityCrosswalk facilityCrosswalk = new FacilityCrosswalk()\n    {\n        FacilityName = \"TRA\"\n    };\n\n    LandingPageVM vm = new LandingPageVM()\n    {\n        TblShiftByRadByDate = tblShiftByRadByDate,\n        Tradetail = tradetail,\n        TblShiftInfo = tblShiftInfo,\n        RadidCrosswalk = radidCrosswalk,\n        FacilityCrosswalk = facilityCrosswalk\n\n    };\n\n    return View(vm);\n}\n</code></pre>\n\n<p>Expected output = \"The name of the shift\" </p>\n\n<p>actual output = \"TRAIntranet2019.Models.TblShiftInfo\"</p>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1562793908, "post_id": 56976103, "comment_id": 100493646, "body": "Try this:  <code>protected override void OnResize(EventArgs e) { if (this.WindowState != FormWindowState.Maximized) { base.OnResize(e); } else { this.WindowState = FormWindowState.Normal; } }</code>. You can keep the MaximizeBox and the standard FormBorderStyle."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1562795840, "post_id": 56976103, "comment_id": 100494200, "body": "<a href=\"https://stackoverflow.com/a/47994707/17034\">stackoverflow.com/a/47994707/17034</a>"}], "owner": {"reputation": 1, "user_id": 11766387, "user_type": "registered", "profile_image": "https://graph.facebook.com/2324629824281275/picture?type=large", "display_name": "Giordano Dorneles", "link": "https://stackoverflow.com/users/11766387/giordano-dorneles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1562782812, "answer_count": 0, "score": 0, "last_activity_date": 1562794708, "creation_date": 1562780970, "last_edit_date": 1562794708, "question_id": 56976103, "link": "https://stackoverflow.com/questions/56976103/how-to-lock-windows-up-keys-command-in-windows-forms", "closed_reason": "Duplicate", "title": "How to lock Windows + Up keys command in Windows Forms", "body": "<p>I have a problem in my project: when I press the <kbd>Win</kbd> + <kbd>Up</kbd> keys, my Form maximizes, so I want to block this command.<br>\nI was able to make the form continue in the same size, but when I press <kbd>Win</kbd> + <kbd>Up</kbd>, the Form goes to the upper left side.  </p>\n\n<p>I have managed to make the Form continue in the same size, but when I press <kbd>Win</kbd> + <kbd>Up</kbd>, the Form goes to the upper left side.  </p>\n\n<pre><code>if (e.KeyCode == (char) Keys.LWin + Keys.Up)\n{\n  this.CenterToScreen ();\n  this.StartPosition = FormStartPosition.CenterScreen;\n  this.WindowState = FormWindowState.Normal;\n}\n</code></pre>\n\n<p>Any solution ?</p>\n"}, {"tags": ["c#", "console-application"], "comments": [{"owner": {"reputation": 79, "user_id": 5962626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed79e173e64fd1c070213d2b6d51b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamedasiq", "link": "https://stackoverflow.com/users/5962626/mohamedasiq"}, "edited": false, "score": 0, "creation_date": 1562782562, "post_id": 56976075, "comment_id": 100489112, "body": "I think the question is clear now."}, {"owner": {"reputation": 79, "user_id": 5962626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed79e173e64fd1c070213d2b6d51b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamedasiq", "link": "https://stackoverflow.com/users/5962626/mohamedasiq"}, "edited": false, "score": 0, "creation_date": 1562782589, "post_id": 56976075, "comment_id": 100489127, "body": "Please let me know why the question has been marked as negative in comment box?"}, {"owner": {"reputation": 1151, "user_id": 9748260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff9651774a7d2b50fe1d8d8ad30e57?s=128&d=identicon&r=PG&f=1", "display_name": "Sohaib Jundi", "link": "https://stackoverflow.com/users/9748260/sohaib-jundi"}, "edited": false, "score": 0, "creation_date": 1562782676, "post_id": 56976075, "comment_id": 100489177, "body": "use String.Format"}], "owner": {"reputation": 79, "user_id": 5962626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bed79e173e64fd1c070213d2b6d51b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamedasiq", "link": "https://stackoverflow.com/users/5962626/mohamedasiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1562782873, "creation_date": 1562780856, "last_edit_date": 1562782873, "question_id": 56976075, "link": "https://stackoverflow.com/questions/56976075/how-to-get-the-below-output-with-the-given-input-in-console-application", "title": "How to get the Below output with the given Input in Console application", "body": "<p>I have an input as below in a excel. Consider the space between the values as next cell value.\n<a href=\"https://i.stack.imgur.com/mCuKg.png\" rel=\"nofollow noreferrer\">Actual Input</a></p>\n\n<p>My Output should be,</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ct0Re.png\" rel=\"nofollow noreferrer\">Expected Output</a></p>\n\n<p>The columns and rows are not fixed. Now i want to get the expected output as given. Please help me to achieve this.</p>\n\n<p>I have tried with Loop,\nI have got the output as,\n<a href=\"https://i.stack.imgur.com/zaUen.png\" rel=\"nofollow noreferrer\">Actual Output</a></p>\n\n<p>Here is the code that I have used to print the record.</p>\n\n<pre><code>    for(int Currow = 0 ; Currow &lt;dt.rows.count; curRow++)\n\n{\nfor(int CurCol = 0 ; CurCol&lt;dt.Columns.count; CurCol ++)\n{\nif(dt.Rows[Currow][CurCol].ToString().Trim() != \"\")\n   {\n   string Modified Value = dt.Rows[Currow][CurCol].ToString().Trim();\n   string NewValue = ModifiedValue.Replace(\"PersonName_\",\"\");\n   Console.WriteLine(NewValue + \" | \");\n   }\n}\nif(currow    %    2 == 1)\n    {\nif(!dt.Rows[Currow][CurCol].ToString().Contains != \"PersonName_\"))\n     {\nConsole.WriteLine();\n     }\n    }\n}\n</code></pre>\n\n<p>Expected Output:\n<a href=\"https://i.stack.imgur.com/AGF23.png\" rel=\"nofollow noreferrer\">Expected Result</a></p>\n\n<p>Actual result:\n<a href=\"https://i.stack.imgur.com/VynNB.png\" rel=\"nofollow noreferrer\">Actual Output</a></p>\n"}, {"tags": ["c#", "string-formatting", "string-interpolation", "c#-6.0"], "answers": [{"tags": [], "owner": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "is_accepted": false, "score": 0, "last_activity_date": 1562781480, "last_edit_date": 1562781480, "creation_date": 1562780874, "answer_id": 56976082, "question_id": 56976025, "link": "https://stackoverflow.com/questions/56976025/how-to-pass-a-dynamic-format-to-a-c-6-interpolated-string/56976082#56976082", "title": "How to pass a dynamic format to a C# 6 interpolated string", "body": "<p>You can't do that, but you can do this instead:</p>\n\n<pre><code>return $\"Your value is {value.ToString(customFormat)}\";\n</code></pre>\n"}], "owner": {"reputation": 6793, "user_id": 2188407, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/SHgoC.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2188407/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1562781257, "answer_count": 1, "score": 0, "last_activity_date": 1562781480, "creation_date": 1562780652, "question_id": 56976025, "link": "https://stackoverflow.com/questions/56976025/how-to-pass-a-dynamic-format-to-a-c-6-interpolated-string", "closed_reason": "Duplicate", "title": "How to pass a dynamic format to a C# 6 interpolated string", "body": "<p>I know I can use <code>$\"{value:format}\"</code> to use a specific format that is known at compile time (Like <code>$\"{value:D}\"</code>)</p>\n\n<p>But how can I do this using a dynamic format that is only known at runtime?</p>\n\n<p>I've tried this:</p>\n\n<pre><code>public string PrintFormat(decimal value, string customFormat)\n{\n    return $\"Your value is {value:customFormat}\";\n}\n</code></pre>\n\n<p>But using the above method, I expect that <code>PrintFormat(123.456m, \"D\") == \"123\"</code>.\nBut it always returns <code>\"customFormat\"</code> instead.</p>\n"}, {"tags": ["c#", "image", "uwp", "win2d"], "comments": [{"owner": {"reputation": 338, "user_id": 2237738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S1yiQ.jpg?s=128&g=1", "display_name": "nbura", "link": "https://stackoverflow.com/users/2237738/nbura"}, "edited": false, "score": 0, "creation_date": 1562782845, "post_id": 56976020, "comment_id": 100489272, "body": "Don&#39;t you need to convert from JPEG (compressed) format to raw byte array first?"}, {"owner": {"reputation": 1342, "user_id": 919700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8a56d6e5177348776169e5f3d9099232?s=128&d=identicon&r=PG", "display_name": "Cristiano Ghersi", "link": "https://stackoverflow.com/users/919700/cristiano-ghersi"}, "reply_to_user": {"reputation": 338, "user_id": 2237738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S1yiQ.jpg?s=128&g=1", "display_name": "nbura", "link": "https://stackoverflow.com/users/2237738/nbura"}, "edited": false, "score": 0, "creation_date": 1562783123, "post_id": 56976020, "comment_id": 100489387, "body": "Thanks @nbura, do you have a fast method to do this?"}, {"owner": {"reputation": 338, "user_id": 2237738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S1yiQ.jpg?s=128&g=1", "display_name": "nbura", "link": "https://stackoverflow.com/users/2237738/nbura"}, "edited": false, "score": 0, "creation_date": 1562783294, "post_id": 56976020, "comment_id": 100489460, "body": "Unfortunately I don&#39;t know a fast method, sorry about that. But why not save the images in a different format other than JPEG, if you want to avoid the time spent decompressing?"}, {"owner": {"reputation": 1342, "user_id": 919700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8a56d6e5177348776169e5f3d9099232?s=128&d=identicon&r=PG", "display_name": "Cristiano Ghersi", "link": "https://stackoverflow.com/users/919700/cristiano-ghersi"}, "reply_to_user": {"reputation": 338, "user_id": 2237738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S1yiQ.jpg?s=128&g=1", "display_name": "nbura", "link": "https://stackoverflow.com/users/2237738/nbura"}, "edited": false, "score": 1, "creation_date": 1562785029, "post_id": 56976020, "comment_id": 100490200, "body": "@nbura that made the trick! Would you like to put as answer so that I mark as accepted?"}, {"owner": {"reputation": 338, "user_id": 2237738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S1yiQ.jpg?s=128&g=1", "display_name": "nbura", "link": "https://stackoverflow.com/users/2237738/nbura"}, "edited": false, "score": 0, "creation_date": 1562786353, "post_id": 56976020, "comment_id": 100490742, "body": "Sure! Glad to hear it worked"}], "answers": [{"tags": [], "owner": {"reputation": 338, "user_id": 2237738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S1yiQ.jpg?s=128&g=1", "display_name": "nbura", "link": "https://stackoverflow.com/users/2237738/nbura"}, "is_accepted": true, "score": 1, "last_activity_date": 1562786339, "creation_date": 1562786339, "answer_id": 56977308, "question_id": 56976020, "link": "https://stackoverflow.com/questions/56976020/how-to-use-canvasbitmap-createfrombytes-with-a-byte-coming-from-a-jpg-image/56977308#56977308", "title": "How to use CanvasBitmap.CreateFromBytes with a byte[] coming from a jpg image", "body": "<p>You need to convert from JPEG (compressed) format to raw byte array first. You can't directly read a JPEG image off disk with <code>ReadBinaryFile()</code> and display it.</p>\n\n<p>I'm guessing that much of the performance issue is coming from the time it takes for <code>LoadAsync()</code> to decompress the JPEG. You could probably improve performance by saving in a different, uncompressed image format.</p>\n\n<hr>\n\n<p>Also, if you really do need to read JPEGs, or if it's still slow even with other image formats: There might be some way to make use of <code>LoadAsync()</code> to load multiple files in parallel. But I don't know how to do this, and it might not be that helpful if you're being bottlenecked by the file I/O anyways. Just a thought.</p>\n"}], "owner": {"reputation": 1342, "user_id": 919700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8a56d6e5177348776169e5f3d9099232?s=128&d=identicon&r=PG", "display_name": "Cristiano Ghersi", "link": "https://stackoverflow.com/users/919700/cristiano-ghersi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 56977308, "answer_count": 1, "score": 1, "last_activity_date": 1562786339, "creation_date": 1562780639, "last_edit_date": 1562781832, "question_id": 56976020, "link": "https://stackoverflow.com/questions/56976020/how-to-use-canvasbitmap-createfrombytes-with-a-byte-coming-from-a-jpg-image", "title": "How to use CanvasBitmap.CreateFromBytes with a byte[] coming from a jpg image", "body": "<p>I have a JPG image available as a byte[] in memory.</p>\n\n<p>I need to create a CanvasBitmap to draw this image that ultimately creates a CompositionDrawingSurface that I can assign to my SpriteVisual. And I need a super-fast method to do this!!</p>\n\n<p>I accomplished the task successfully using <code>CanvasBitmap.LoadAsync(ICanvasResourceCreator, IRandomAccessStream)</code>, but this approach takes too much (more than 10 milliseconds), while using <code>CanvasBitmap.CreateFromBytes(ICanvasResourceCreator, byte[], int, int, DirectXPixelFormat)</code> it just takes 1 millisecond, which is ok with my performance requirements.</p>\n\n<p>Unfortunately, using <code>CanvasBitmap.CreateFromBytes</code> the result is not the correct image, but rather a cloud of dots, which makes me thinking there is a problem in the encoding / decoding of the image.</p>\n\n<p>Here's the code I tried:</p>\n\n<pre><code>byte[] imgBytes = await ReadBinaryFile(path); // read the binary content of a JPG image, for the example purpose (in the real environment, the byte[] comes from in memory caches...)\n\nusing (CanvasBitmap canvasBitmap = CanvasBitmap.CreateFromBytes(s_canvasDevice, imgBytes, 600, 800, DirectXPixelFormat.B8G8R8A8UIntNormalized))\n{\n    // Draw the image to the surface\n    using (CanvasDrawingSession session = CanvasComposition.CreateDrawingSession(surface))\n    {\n        session.Clear(Color.FromArgb(0, 0, 0, 0));\n        session.DrawImage(canvasBitmap, new Rect(0, 0, 600, 800), new Rect(0, 0, 600, 800));\n    }\n}\n</code></pre>\n\n<p>What am I missing?\nHow can I treat the <code>byte[] imgBytes</code> so that it can be useful as input of <code>CanvasBitmap.CreateFromBytes</code>?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c#", "git", "ssh", "git-bash", "git-clone"], "owner": {"reputation": 11, "user_id": 11154491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ucXA.png?s=128&g=1", "display_name": "bear_shampoo", "link": "https://stackoverflow.com/users/11154491/bear-shampoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562780348, "creation_date": 1562780348, "question_id": 56975960, "link": "https://stackoverflow.com/questions/56975960/auto-git-clone-script-with-c-and-bit-bucket", "title": "Auto git clone script with C# and bit bucket", "body": "<p>I am trying to write a C# program that can clone many git repos from bitbucket auto-magic-ally. </p>\n\n<p>I am currently having trouble with the ssh connectivity portion of this code and keep getting the following error: </p>\n\n<pre><code>Cloning into 'reponame'...\ngit@bitbucket.org: Permission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\n</code></pre>\n\n<p>I am using <code>System.Diagnostics.Process</code> in C# to try and achieve this. I am not certain which shell to use out of the many installed with gitbash for windows. Below is the block of code that is giving me trouble. </p>\n\n<pre><code>/// &lt;summary&gt;\n/// Takes tokens and execute git cloning process for each token automatically..\n/// &lt;/summary&gt;\n/// &lt;param name=\"tokens\"&gt;&lt;/param&gt;\nprivate static void GitCloneProcessExecutor(string[] tokens)\n{\n    #region Creating a process for git cloning\n    foreach (string repoNameToken in tokens)\n    {\n        string workingDirectory = @\"C:\\path\\to\\working\\directory\";\n        string repoName = FormatTokens(repoNameToken);    //Reformats tokens from a csv and gets rid of the commas\n        var gitCloneCommand = $\"git clone git@bitbucket.org:username/{repoName}.git\";\n\n        var gitCloneProcess = new Process { EnableRaisingEvents = true };\n        var gitCloneProcessStartInfo = new ProcessStartInfo\n        {\n            WorkingDirectory = workingDirectory,\n            FileName = @\"C:\\Program Files\\Git\\bin\\bash.exe\",        \n            Verb = \"runas\",\n            UseShellExecute = false,\n            RedirectStandardInput = true,\n            RedirectStandardOutput = true,\n            CreateNoWindow = false,\n            WindowStyle = ProcessWindowStyle.Normal,\n        };\n        gitCloneProcess.StartInfo = gitCloneProcessStartInfo;\n        gitCloneProcess.Start();\n        using (var so = gitCloneProcess.StandardOutput)\n        {\n            using (var si = gitCloneProcess.StandardInput)\n            {\n                string newDirectory = \"GitRepositories\";\n                si.WriteLine($\"cd {BashFormatDirectory(workingDirectory)}\");    //Reformats working driectory from cmd readable format to bash friendly format.\n                si.WriteLine($\"mkdir {newDirectory}\");\n                si.WriteLine($\"cd {newDirectory}\");\n                si.WriteLine($\"{gitCloneCommand} -v --progress\");\n            }\n        }\n\n    }\n    #endregion\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml"], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 4690668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a561fc0eb3ae88d52202e2e24fc9d000?s=128&d=identicon&r=PG", "display_name": "Leonhard P.", "link": "https://stackoverflow.com/users/4690668/leonhard-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1562780839, "creation_date": 1562780839, "answer_id": 56976070, "question_id": 56975842, "link": "https://stackoverflow.com/questions/56975842/how-to-get-static-part-of-label-to-show-up-only-when-textbox-entered/56976070#56976070", "title": "How to get static part of label to show up only when textbox entered", "body": "<p>You could use an IValueConverter, with which you can convert a value to any kind of output and display that. In your example it would look like this:</p>\n\n<pre><code>public class UnitValueConverter : IValueConverter\n{\n    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n    {\n        string text = value as string;\n        string unit = parameter as string;\n\n        if (!string.IsNullOrWhiteSpace(text))\n        {\n            return $\"{text}{unit}\";\n        }\n        else\n        {\n            return text;\n        }\n    }\n\n    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)\n    {\n        throw new NotImplementedException();\n    }\n}\n</code></pre>\n\n<p>You can then use this IValueConverter in your XAML-Code like <a href=\"https://www.dotnetforall.com/wpf-using-ivalueconverter-code-example/\" rel=\"nofollow noreferrer\">this</a>. As the ConverterParameter you need to pass the unit string.</p>\n"}], "owner": {"reputation": 21, "user_id": 11755443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a46c59ebf986bfd5102b4237cf789b9?s=128&d=identicon&r=PG&f=1", "display_name": "donnybravo", "link": "https://stackoverflow.com/users/11755443/donnybravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1562781674, "creation_date": 1562779879, "question_id": 56975842, "link": "https://stackoverflow.com/questions/56975842/how-to-get-static-part-of-label-to-show-up-only-when-textbox-entered", "title": "How to get static part of label to show up only when textbox entered", "body": "<p>This is  a little bit hard to explain so bear with me. I have measurements that appear on the screen after the user inputs them into the textbox provided. Right now, I have it so the number only shows up as it's being entered, which is great. The only thing is, the unit (cm, mm..) stays on the canvas permanently and I want that to only show up when the numbers are entered as well. I hope that makes sense. </p>\n\n<p>The textbox code: </p>\n\n<pre><code>&lt;TreeViewItem Grid.Row=\"1\" FontSize=\"12\" Header=\"Width\"/&gt;\n&lt;TextBox Text=\"{Binding xcoord, UpdateSourceTrigger=PropertyChanged}\" Name=\"x\" Height=\"20\" Width=\"40\" Grid.Row=\"1\" Grid.Column=\"2\" /&gt;\n&lt;TreeViewItem Grid.Row=\"2\" FontSize=\"12\" Header=\"Height\"/&gt;\n&lt;TextBox Text=\"{Binding ycoord, UpdateSourceTrigger=PropertyChanged}\" Name=\"y\" Height=\"20\" Width=\"40\" Grid.Row=\"2\" Grid.Column=\"2\"/&gt;\n</code></pre>\n\n<p>The label code:</p>\n\n<pre><code>&lt;!--height label appears on screen when value is entered--&gt;\n&lt;Label Foreground=\"SteelBlue\" FontWeight=\"Bold\" HorizontalAlignment=\"Center\" VerticalContentAlignment=\"Center\" Height=\"40\" Background=\"Transparent\" x:Name=\"label2\"  FontSize=\"16\" Width=\"60\"  Content=\"{Binding Text, ElementName=y}\" ContentStringFormat=\" {0} mm\" Canvas.Left=\"527\" Canvas.Top=\"162\" RenderTransformOrigin=\"1.045,-0.141\" VerticalAlignment=\"Top\"&gt;&lt;/Label&gt;\n\n&lt;!--width label appears on screen when a value is entered--&gt;\n&lt;Label Foreground=\"SteelBlue\" FontWeight=\"Bold\" HorizontalAlignment=\"Center\" VerticalContentAlignment=\"Center\" Height=\"40\" Background=\"Transparent\" x:Name=\"label1\"  FontSize=\"16\" Width=\"160\"  Content=\"{Binding Text, ElementName=x}\" ContentStringFormat=\" {0} mm\" Canvas.Left=\"220\" Canvas.Top=\"382\" RenderTransformOrigin=\"1.045,-0.141\" VerticalAlignment=\"Top\"&gt;&lt;/Label&gt;\n</code></pre>\n"}, {"tags": ["c#", "performance", "uwp", "stream"], "comments": [{"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1562779967, "post_id": 56975806, "comment_id": 100488004, "body": "Why do you need it, and why do you need it to be so fast? Can you deal with an <code>IRandomAccessStream</code>? Then perhaps write your own wrapper around a byte array, implementing that interface."}, {"owner": {"reputation": 1342, "user_id": 919700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8a56d6e5177348776169e5f3d9099232?s=128&d=identicon&r=PG", "display_name": "Cristiano Ghersi", "link": "https://stackoverflow.com/users/919700/cristiano-ghersi"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1562780892, "post_id": 56975806, "comment_id": 100488394, "body": "I need an IRandomAccessStream to pass to CanvasBitmap.LoadAsync() to load an image into a SpriteVisual using Win2D api."}], "answers": [{"tags": [], "owner": {"reputation": 6904, "user_id": 9412162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KlpER.jpg?s=128&g=1", "display_name": "Richard Zhang - MSFT", "link": "https://stackoverflow.com/users/9412162/richard-zhang-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1562813698, "creation_date": 1562813698, "answer_id": 56981018, "question_id": 56975806, "link": "https://stackoverflow.com/questions/56975806/uwp-fastest-way-to-create-an-inmemoryrandomaccessstream-from-a-byte-array/56981018#56981018", "title": "UWP: Fastest way to create an InMemoryRandomAccessStream from a byte array", "body": "<blockquote>\n  <p>I need an IRandomAccessStream to pass to CanvasBitmap.LoadAsync() to load an image into a SpriteVisual using Win2D api.</p>\n</blockquote>\n\n<p>For your comment, Maybe the <code>IRandomAccessStream</code> is really what you needed, not <code>InMemoryRandomAccessStream</code>.</p>\n\n<p>Here is the other way to get the IAccessRandomStream from byte array:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>private IRandomAccessStream GetStreamAsync(byte[] bytes)\n{\n    var ms = new MemoryStream(bytes);\n    var stream = ms.AsRandomAccessStream();\n    stream.Seek(0);\n    return stream;\n}\n</code></pre>\n\n<p>This way is faster than the original method.</p>\n\n<p>However, the speed of image loading has many influencing factors, we can only try to improve it.</p>\n\n<p>I hope this can help you.</p>\n"}], "owner": {"reputation": 1342, "user_id": 919700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8a56d6e5177348776169e5f3d9099232?s=128&d=identicon&r=PG", "display_name": "Cristiano Ghersi", "link": "https://stackoverflow.com/users/919700/cristiano-ghersi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1562813698, "creation_date": 1562779713, "question_id": 56975806, "link": "https://stackoverflow.com/questions/56975806/uwp-fastest-way-to-create-an-inmemoryrandomaccessstream-from-a-byte-array", "title": "UWP: Fastest way to create an InMemoryRandomAccessStream from a byte array", "body": "<p>I need to create an InMemoryRandomAccessStream from a byte[] in the fastest way possible.</p>\n\n<p>I came out with this method</p>\n\n<pre><code>private static async Task&lt;InMemoryRandomAccessStream&gt; GetStreamAsync(byte[] bytes)\n{\n    InMemoryRandomAccessStream stream = new InMemoryRandomAccessStream();\n    await stream.WriteAsync(bytes.AsBuffer());\n    stream.Seek(0);\n    return stream;\n}\n</code></pre>\n\n<p>but unfortunately it takes like 8 milliseconds, and for our purpose it is way too much.</p>\n\n<p>Is there a faster (and maybe synchronous) way to achieve the same purpose?</p>\n\n<p>I am looking for a time around 1 millisecond or less.</p>\n\n<p>Thank you!!</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 3, "creation_date": 1562779760, "post_id": 56975794, "comment_id": 100487916, "body": "Have you been taught about the scope of variables? For example, if you declare <code>numberofhuts</code> inside of your method, then that variable will be recreated each time the method is called. If you want the value to persist, you need to store it elsewhere. By the way, what type of app is this? Web Forms? Win Forms? By the way, normal C# convention is to camelCase local variables, so that should be <code>numberOfHuts</code>. It makes the code more readable, which other developers working with your code will appreciate even if you don&#39;t."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562779879, "post_id": 56975794, "comment_id": 100487961, "body": "Every time this button code runs, it does three things: (1) allocate a spot to store a number, (2) increment that number, (3) set the label text to that number.  If you do #1 <i>every time</i>, how will the number ever change?"}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 369, "user_id": 3973143, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23f1eeb9919581ad1401a8358a2250a5?s=128&d=identicon&r=PG&f=1", "display_name": "davedno", "link": "https://stackoverflow.com/users/3973143/davedno"}, "edited": false, "score": 1, "creation_date": 1562780159, "post_id": 56975794, "comment_id": 100488087, "body": "@davedno C# does not have a concept of global variables, so suggesting that can be misleading. If you meant a <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/fields\" rel=\"nofollow noreferrer\">field</a>, then please say that instead. However, a field may not resolve this problem, because we don&#39;t know the lifecycle of the class this is in. That&#39;s why I would have held off before suggesting such an an approach. I suggest you remove your comment until we have additional information."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1562780455, "post_id": 56975794, "comment_id": 100488210, "body": "@mason Agreed, plus &quot;a part of your parameters&quot; doesn&#39;t make sense in this context. The method signature is that of an event handler, and can&#39;t be changed, and that wouldn&#39;t solve anything anyway."}, {"owner": {"reputation": 369, "user_id": 3973143, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23f1eeb9919581ad1401a8358a2250a5?s=128&d=identicon&r=PG&f=1", "display_name": "davedno", "link": "https://stackoverflow.com/users/3973143/davedno"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562781550, "post_id": 56975794, "comment_id": 100488642, "body": "@amy you know you can apply a number of custom parameters to an event handler....Right?"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "reply_to_user": {"reputation": 369, "user_id": 3973143, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23f1eeb9919581ad1401a8358a2250a5?s=128&d=identicon&r=PG&f=1", "display_name": "davedno", "link": "https://stackoverflow.com/users/3973143/davedno"}, "edited": false, "score": 0, "creation_date": 1562781647, "post_id": 56975794, "comment_id": 100488678, "body": "@davedno The event handler signature cannot be changed from the <code>EventHandler</code> delegate."}, {"owner": {"reputation": 369, "user_id": 3973143, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23f1eeb9919581ad1401a8358a2250a5?s=128&d=identicon&r=PG&f=1", "display_name": "davedno", "link": "https://stackoverflow.com/users/3973143/davedno"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1562781691, "post_id": 56975794, "comment_id": 100488693, "body": "@mason you&#39;re making a mountain out of a mole hill. The way the handler is currently constructed the label will always show &#39;1&#39;. If that variable is passed in a parameter to the event handler or it is a FIELD of the class, his problem would be solved and he would see his label increment on button click."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 369, "user_id": 3973143, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/23f1eeb9919581ad1401a8358a2250a5?s=128&d=identicon&r=PG&f=1", "display_name": "davedno", "link": "https://stackoverflow.com/users/3973143/davedno"}, "edited": false, "score": 0, "creation_date": 1562784107, "post_id": 56975794, "comment_id": 100489812, "body": "@davedno I am not making a mountain out of a mole hill. We do not know with certain what the lifecycle of the class is. If it is a field in a Web Forms page for example (and this code could easily be Web Forms) then that field will get reset every time the page loads, and thus you&#39;re back at the same problem. So it&#39;s not enough to just say &quot;make it a field&quot;. And &quot;make it a global variable&quot; has no meaning, since C# doesn&#39;t have a global variable concept."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "edited": false, "score": 0, "creation_date": 1562784167, "post_id": 56975794, "comment_id": 100489850, "body": "@HereticMonkey I have rolled back your edit. We do not know with certainty that this in Windows Forms, so it&#39;d be inappropriate for us to make that assumption on the asker&#39;s behalf. We need to await additional clarification."}, {"owner": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 1, "creation_date": 1562785474, "post_id": 56975794, "comment_id": 100490383, "body": "@mason Fair enough, although with Visual Studio Windows Application in the title, combined with <code>public void Button1_Click(object sender, EventArgs e)</code> strongly suggests Windows Forms (WPF &amp; UWP using <code>private void Button_Click(object sender, RoutedEventArgs e)</code> by default)."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "reply_to_user": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "edited": false, "score": 0, "creation_date": 1562786453, "post_id": 56975794, "comment_id": 100490785, "body": "@HereticMonkey That exact code would look perfectly at place in Web Forms as well. Visual Studio can be used to build Web Forms apps, and Web Forms only runs on Windows (if you discount Mono). So Web Forms would be a fair assumption here. It&#39;s <i>probably</i> Win Forms, but instead of assuming we should wait for the OP to respond."}], "answers": [{"comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1562780328, "post_id": 56975933, "comment_id": 100488158, "body": "You seem to be assuming this is Windows Forms...that&#39;s a dangerous assumption. I&#39;d wait until the question is clear before answering with a specific approach."}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1562780440, "post_id": 56975933, "comment_id": 100488205, "body": "@mason you are right, I should have mentioned what assumptions I made. I have tried to clarify this. Thanks."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562783087, "post_id": 56975933, "comment_id": 100489372, "body": "@Noceo If the assumption is that this is WinForms, the <code>MyForm</code> class should inherit from <code>Form</code> to avoid confusion."}, {"owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1562785310, "post_id": 56975933, "comment_id": 100490325, "body": "@Amy you are correct. It should also be a partial class. I have updated the sample."}], "tags": [], "owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "is_accepted": true, "score": 5, "last_activity_date": 1562785276, "last_edit_date": 1562785276, "creation_date": 1562780254, "answer_id": 56975933, "question_id": 56975794, "link": "https://stackoverflow.com/questions/56975794/visual-studio-windows-application-show-numbers-in-label/56975933#56975933", "title": "Visual Studio Windows Application - Show numbers in label", "body": "<p>Right now, you reset the variable <code>numberofhuts</code> to zero, every time you click the button (as others have pointed out). So you need to do one of the following two things:</p>\n\n<ol>\n<li>Move the variable to a broader scope (i.e. move it outside the button click.function)</li>\n<li>Use the label text as a starting point for your increment.</li>\n</ol>\n\n<p>The second approach is probably not the best, as this requires some sort of mechanism to ensure that the label text is always numeric. So you could do something like this:</p>\n\n<pre><code>public partial class MyForm : Form\n{\n    // Constructor (normally generated by Visual Studio)\n    public MyForm()\n    {\n        InitializeComponent();\n    }\n\n    // Create, and initialize the variable outside the method.\n    private int _numberOfHuts = 0;\n\n    // When clicking the button, the variable is incremented\n    // and the label is updated with the new value.\n    private void Button1_Click(object sender, EventArgs e) \n    {\n        _numberOfHuts++;\n        label1.Text = numberOfHuts.ToString();\n    }\n}\n</code></pre>\n\n<p>Also, you should consider your naming. Names like <code>Button1</code> and <code>Label1</code> are poor choices, because they in no way indicate what they objects function are. Instead use something like <code>IncrementHutCount</code> for the button and <code>NumberOfHuts</code> for the label.</p>\n\n<p><strong>Edit:</strong> \nNote that the scope change I made, might not be broad enough. I just made the assumption that you only have a single form, which lives for the entire life span of the program. If this is not the case, you need to move it somewhere else. </p>\n"}], "owner": {"reputation": 29, "user_id": 10597694, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A4T4J.jpg?s=128&g=1", "display_name": "Marko", "link": "https://stackoverflow.com/users/10597694/marko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 56975933, "answer_count": 1, "score": -2, "last_activity_date": 1562785276, "creation_date": 1562779641, "last_edit_date": 1562784040, "question_id": 56975794, "link": "https://stackoverflow.com/questions/56975794/visual-studio-windows-application-show-numbers-in-label", "title": "Visual Studio Windows Application - Show numbers in label", "body": "<p>I'm trying to make a simple incremental game.\nI have a <strong>button</strong> to \"build a hut\". Basically, add 1 to an int value every time it's pressed. I want to then show in a label how many huts were built. But the label1.Text only accepts string values.</p>\n\n<p>However, when I convert the integer .ToString, it doesn't work. It keeps the number at 1 and doesn't up it.</p>\n\n<pre><code>public void Button1_Click(object sender, EventArgs e)\n{\n    int numberofhuts = 0;\n    numberofhuts++;\n    label1.Text = numberofhuts;\n}\n</code></pre>\n\n<p>That's what it looks like. Any help would be super appreciated.</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-core"], "answers": [{"comments": [{"owner": {"reputation": 3901, "user_id": 5203853, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fc13d83da1b2b866c973e239ea3b38d3?s=128&d=identicon&r=PG&f=1", "display_name": "Tom el Safadi", "link": "https://stackoverflow.com/users/5203853/tom-el-safadi"}, "edited": false, "score": 0, "creation_date": 1562780657, "post_id": 56975981, "comment_id": 100488301, "body": "Thanks a lot for your response Chris! I saw that it was able to distinguish only if the Action that I call is unique in both controllers. However, when the same Action is specified in both Controllers, the selection of the appropriate Controller is kind of random.  I guess that I will have to add the Api keyword in my Controller names then."}], "tags": [], "owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "is_accepted": true, "score": 1, "last_activity_date": 1562780401, "creation_date": 1562780401, "answer_id": 56975981, "question_id": 56975742, "link": "https://stackoverflow.com/questions/56975742/asp-net-core-url-action-use-webapi-controller/56975981#56975981", "title": "Asp.Net Core Url.Action use WebApi Controller", "body": "<p>In a word: you can't. <code>Url.Action</code> has no capability to distinguish by namespace; you'll need unique controller names. This is part of the reason why it's typical to add <code>Api</code> in the an API controller's name, i.e. <code>AccountController</code> and <code>AccountApiController</code>.</p>\n\n<p>If you really want to use <code>AccountController</code> for both, your only real option is to use areas. You can create an <code>Api</code> area, rather than just a subfolder under <code>Controllers</code>, and then you can do:</p>\n\n<pre><code>@Url.Action(\"GetAll\", \"Account\", new { area = \"Api\" })\n</code></pre>\n"}], "owner": {"reputation": 3901, "user_id": 5203853, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fc13d83da1b2b866c973e239ea3b38d3?s=128&d=identicon&r=PG&f=1", "display_name": "Tom el Safadi", "link": "https://stackoverflow.com/users/5203853/tom-el-safadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 56975981, "answer_count": 1, "score": 0, "last_activity_date": 1562780401, "creation_date": 1562779397, "last_edit_date": 1562780259, "question_id": 56975742, "link": "https://stackoverflow.com/questions/56975742/asp-net-core-url-action-use-webapi-controller", "title": "Asp.Net Core Url.Action use WebApi Controller", "body": "<p>I have two types of controller in my application. One WebApi controller and one MVC controller. With the following structure of my project:</p>\n\n<pre><code>Project\n|-- Controllers\n|   |-- Api\n|   |   |-- AccountController\n|   |   |-- ...\n|   |-- AccountController\n|   |-- ...\n</code></pre>\n\n<p>As you can see, I have AccountController twice in two different namespaces though. The one in the folder Api is the WebApi controller and the one under Controllers is a MVC controller.</p>\n\n<p>I would like to use <code>@Url.Action(\"GetAll\", \"Account\")</code> inside my view to generate a link to my WebApi controller. How do I differentiate between the Api controller and the MVC controller. How can I tell it whether to use the Api or MVC controller?</p>\n"}, {"tags": ["c#", ".net", "user-interface", "razor", "model-view-controller"], "comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1562779037, "post_id": 56975622, "comment_id": 100487578, "body": "What is <code>Warehouse.Helpers.HtmlHelpers.DialogFormLink2</code>? Is that 3rd party code? Then you should mention what library it came from. Is it your own code? then you need to include the implementation here. What we really need is a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 123, "user_id": 2083386, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/54b06b385e5e07bc1f8fa733579afa73?s=128&d=identicon&r=PG", "display_name": "user2083386", "link": "https://stackoverflow.com/users/2083386/user2083386"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1562780279, "post_id": 56975622, "comment_id": 100488138, "body": "Yes it is our own code. It is just a model where there are properties."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1562780362, "post_id": 56975622, "comment_id": 100488174, "body": "That doesn&#39;t look like a model. That looks like it generates HTML. Again, you need to provide us with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 106, "user_id": 7691143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d2ed37e6bc571fd4d4085c695d4727?s=128&d=identicon&r=PG&f=1", "display_name": "Batgirl", "link": "https://stackoverflow.com/users/7691143/batgirl"}, "edited": false, "score": 0, "creation_date": 1562789929, "post_id": 56975622, "comment_id": 100492146, "body": "Here is a link to my post on a question regarding Bootstrap modal popup -  <a href=\"https://stackoverflow.com/questions/52501048/is-it-possible-to-call-a-modal-popup-javascript-in-mvc-controller-return/52501685#52501685\" title=\"is it possible to call a modal popup javascript in mvc controller return\">stackoverflow.com/questions/52501048/&hellip;</a> Please mark it as an answer if it resolves your problem. Thanks!"}], "owner": {"reputation": 123, "user_id": 2083386, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/54b06b385e5e07bc1f8fa733579afa73?s=128&d=identicon&r=PG", "display_name": "user2083386", "link": "https://stackoverflow.com/users/2083386/user2083386"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562778861, "creation_date": 1562778861, "question_id": 56975622, "link": "https://stackoverflow.com/questions/56975622/unable-to-display-modal-popup-in-the-same-page-mvc", "title": "Unable to display Modal popup in the same page MVC", "body": "<p>I have a requirement where I need to display a Modal popup. When the user clicks on the link inside a grid, then that has to open a modal popup with the respective values. But currently it is taking me to a new page instead of displaying it as a modal popup in the same page. Can someone have a look at this an tell me what is going wrong?</p>\n\n<p>Popup is being called here:</p>\n\n<pre><code>grid.AddColumn(\"ProductName\", \"Product\",\n             format: (item) =&gt;\n             {\n                 return Warehouse.Helpers.HtmlHelpers.DialogFormLink2(Html, item.ProductName, @Url.Content(\"~/Service/ProductCategory/ProductTransactionsPopupView?ProductID=\" + @item.ProductID + \"&amp;ProgramID=\" + Model.ProgramID + \"&amp;Status=\" + item.ProductStatus + \"&amp;ProductRequestID=\" + ViewBag.ProductRequestID), null, \"Product History\", \"dialog\", \"\", @Url.Action(\"ProductProfile\"));\n             });\n</code></pre>\n\n<p>Controller:</p>\n\n<pre><code> public ActionResult ProductTransactionsPopupView(int ProductID, string ProductStatus, int? ProductRequestID = null)\n        {\n            var Program = GetProgram();\n\n            var mdl = new ProductTransactionsViewModel { ProgramID = Program.ProgramID, ProductID = ProductID };\n\n            try\n            {\n                var ProductTransactionResponse = _ServiceProduct.GetProductTransactions(Program.ProgramID, User.Name, ProductID);\n\n                mdl.ProductID = ProductTransactionResponse.ProductId;\n                mdl.Transactions = ProductTransactionResponse.ProductTransactions.ToList();\n                mdl.ProductName = ProductTransactionResponse.Product != null ? ProductTransactionResponse.Product.ProductName : \"\";                \n                mdl.ProductStatus = ProductStatus;\n            }\n            catch (Exception ex)\n            {\n                mdl.ErrorMessage = \"An error occured.\";\n            }\n\n            ViewBag.ProductRequestID = ProductRequestID;\n\n            return View(\"ProductTransactions\", mdl);\n        }\n</code></pre>\n\n<p>Model View:</p>\n\n<pre><code>@model Warehouse.Product.ProductTransactionsViewModel\n@using Warehouse.Helpers;\n\n@{\n    ViewBag.Title = \"Product Transactions\";\n    ViewBag.ProgramID = Model.ProgramID;\n    ViewBag.ProductName = Model.ProductName;\n    ViewBag.ProductID = Model.ProductID;\n    Layout = \"~/Views/Shared/_PRPopupsLayout.cshtml\";\n\n    var PRID = (int?)ViewBag.ProductRequestID;\n}\n\n&lt;div class=\"DisplayMessage\"&gt;\n&lt;/div&gt;\n\n &lt;div class=\"popupContentContainer\"&gt;\n    @Html.Partial(\"_ProductTransactions\")\n&lt;/div&gt;\n&lt;div style=\"text-align:center\"&gt;\n    @if(Model.ProductStatus == \"Active\")\n    {\n    &lt;input type=\"button\" value=\"Generate Product Document\" id=\"ProductInquiry\" name=\"ProductInquiry\" class=\"grey button\" /&gt;\n    }\n    &lt;input type=\"button\" value=\"Exit\" id=\"exit\" name=\"exit\" class=\"grey button\" /&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["c#", "sql", "sql-server", "parameters", "parameter-passing"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 5, "creation_date": 1562778674, "post_id": 56975520, "comment_id": 100487387, "body": "SQL parameters aren&#39;t just inserted into the query like that - they&#39;re passed <i>as parameters</i> to the database. Regardless of what it looks like when debugging, what happens when you execute the query? That looks basically correct to me..."}, {"owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 1, "creation_date": 1562778825, "post_id": 56975520, "comment_id": 100487468, "body": "The code is behaving properly.   The only way to get it to behave the way you are expecting would be to use string replacement in your query, instead of parameters."}, {"owner": {"reputation": 2114, "user_id": 5623232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d415f90d71b25875885b8cfb4ec008?s=128&d=identicon&r=PG", "display_name": "NPras", "link": "https://stackoverflow.com/users/5623232/npras"}, "edited": false, "score": 0, "creation_date": 1562825245, "post_id": 56975520, "comment_id": 100500451, "body": "Yeah. It would also be wise to familiarise yourself with your DB&#39;s Profiler tool. You&#39;ll thank us once you start getting a bit more advanced and use an ORM framework where things become even less transparent."}, {"owner": {"reputation": 81, "user_id": 2994921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FDBzM.jpg?s=128&g=1", "display_name": "user2994921", "link": "https://stackoverflow.com/users/2994921/user2994921"}, "reply_to_user": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 0, "creation_date": 1563377462, "post_id": 56975520, "comment_id": 100681952, "body": "@TabAlleman thank you I replaced it in the query instead of parsing it as parameter and It&#39;s working."}, {"owner": {"reputation": 81, "user_id": 2994921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FDBzM.jpg?s=128&g=1", "display_name": "user2994921", "link": "https://stackoverflow.com/users/2994921/user2994921"}, "reply_to_user": {"reputation": 2114, "user_id": 5623232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d415f90d71b25875885b8cfb4ec008?s=128&d=identicon&r=PG", "display_name": "NPras", "link": "https://stackoverflow.com/users/5623232/npras"}, "edited": false, "score": 0, "creation_date": 1563377466, "post_id": 56975520, "comment_id": 100681954, "body": "@NPras yes thank you for the suggestion I did start using profiler tool and lot easier to debug sql queries."}], "answers": [{"tags": [], "owner": {"reputation": 13262, "user_id": 6219979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e768deedd6c0ed9a87a26eff0f4c6cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/6219979/serg"}, "is_accepted": false, "score": 1, "last_activity_date": 1562781007, "creation_date": 1562781007, "answer_id": 56976112, "question_id": 56975520, "link": "https://stackoverflow.com/questions/56975520/pass-a-string-parameter-to-command-text-with-quotes/56976112#56976112", "title": "Pass a string parameter to command text with quotes", "body": "<p>Try catch the parameterized query in the Profiler. Correct query will look something like</p>\n\n<pre><code>exec sp_executesql N' SET FMTONLY OFF; SET NO_BROWSETABLE ON;SELECT sp.*  FROM [serp_post] sp  LEFT JOIN [serp_m3_data] m3 ON m3.serp_post_id = sp.serp_post_id  WHERE sp.[serp_status_id]='CLEAR_DONE' AND sp.m3UpdateStatus &lt;&gt; '2' AND sp.process_type='POST' AND m3.EGTRCD = '40' AND m3.EPPYME = @paymentTerm',N'@paymentTerm varchar(10)',@paymentTerm='CH1'\n</code></pre>\n\n<p>As Jon Skeet said, SQL parameters aren't inserted into the query.</p>\n"}, {"tags": [], "owner": {"reputation": 43082, "user_id": 74195, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/2Il1P.jpg?s=128&g=1", "display_name": "DRapp", "link": "https://stackoverflow.com/users/74195/drapp"}, "is_accepted": false, "score": 0, "last_activity_date": 1562781689, "creation_date": 1562781689, "answer_id": 56976277, "question_id": 56975520, "link": "https://stackoverflow.com/questions/56975520/pass-a-string-parameter-to-command-text-with-quotes/56976277#56976277", "title": "Pass a string parameter to command text with quotes", "body": "<p>Aside from the comments that actually present the PARAMETERS are automatically handled during the post and not LITERAL in the query as to prevent sql-injection.</p>\n\n<p>As for the other answer about double-quotes, I have gotten into the habit of writing my sql in C# as sample below to help prevent accidental double-quotes in-use.</p>\n\n<pre><code>  SqlCommand cmd = new SqlCommand( \"\", conn);\n  cmd.CommandText = \n@\"SELECT \n      sp.*\n   FROM \n      [serp_post] sp \n         LEFT JOIN [serp_m3_data] m3 \n            ON m3.serp_post_id = sp.serp_post_id\n   WHERE \n          sp.[serp_status_id]='CLEAR_DONE' \n      AND sp.m3UpdateStatus &lt;&gt; '2' \n      AND sp.process_type='POST' \n      AND m3.EGTRCD = '40' \n      AND m3.EPPYME = @paymentTerm \";\n</code></pre>\n\n<p>Notice the fully readable query without scrolling or forgetting a close double-quote + on next line, etc...  Again, just a style thing on building sql commands.  The leading @ means the entire text until it's closing other double-quote.  Since SQL ignores enter keys in statements, they still work without issue and promote better readability.</p>\n"}], "owner": {"reputation": 81, "user_id": 2994921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FDBzM.jpg?s=128&g=1", "display_name": "user2994921", "link": "https://stackoverflow.com/users/2994921/user2994921"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562781689, "creation_date": 1562778437, "question_id": 56975520, "link": "https://stackoverflow.com/questions/56975520/pass-a-string-parameter-to-command-text-with-quotes", "title": "Pass a string parameter to command text with quotes", "body": "<p>I'm trying to pass a parameter to the query but with quotes as a string value.\nBut I can seem to get it working.\nWhat am I doing wrong here.</p>\n\n<pre><code>SqlConnection conn = new SqlConnection(SERP_FT_connection);\n        SqlCommand cmd = new SqlCommand(\"SELECT sp.* \"\n                                         + \" FROM [serp_post] sp \"\n                                         + \" LEFT JOIN [serp_m3_data] m3 ON m3.serp_post_id = sp.serp_post_id \"\n                                         + \" WHERE sp.[serp_status_id]='CLEAR_DONE' AND sp.m3UpdateStatus &lt;&gt; '2' AND sp.process_type='POST' AND m3.EGTRCD = '40' AND m3.EPPYME = @paymentTerm \", conn);\n\n        cmd.CommandType = CommandType.Text;\n        conn.Open();\n\n        SqlParameter param = new SqlParameter();\n        param.ParameterName = \"@paymentTerm\";\n        param.Value = paymentTerm; // when debugged here it shows as \"CH1\"\n        cmd.Parameters.Add(param);\n</code></pre>\n\n<p>Query looks like this when debugged,</p>\n\n<pre><code>SELECT sp.*  FROM [serp_post] sp  LEFT JOIN [serp_m3_data] m3 ON m3.serp_post_id = sp.serp_post_id  WHERE sp.[serp_status_id]='CLEAR_DONE' AND sp.m3UpdateStatus &lt;&gt; '2' AND sp.process_type='POST' AND m3.EGTRCD = '40' AND m3.EPPYME = @paymentTerm\n</code></pre>\n\n<p>Finally the query should look like this value passed with quotes</p>\n\n<pre><code>SELECT sp.*  FROM [serp_post] sp  LEFT JOIN [serp_m3_data] m3 ON m3.serp_post_id = sp.serp_post_id  WHERE sp.[serp_status_id]='CLEAR_DONE' AND sp.m3UpdateStatus &lt;&gt; '2' AND sp.process_type='POST' AND m3.EGTRCD = '40' AND m3.EPPYME = 'CH1'\n</code></pre>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 0, "creation_date": 1562778457, "post_id": 56975509, "comment_id": 100487287, "body": "Welcome to Stack Overflow. At the moment I don&#39;t understand your question. Could you try to clarify it, ideally showing how far you&#39;ve got and where you&#39;re stuck? See <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question</a> for some suggestions for improving your question."}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "edited": false, "score": 3, "creation_date": 1562780786, "post_id": 56975509, "comment_id": 100488356, "body": "We usually avoid writing code so that unrelated things are done inside one method. It makes that method unnecessarily complicated. If you want a method for depth, write that. If you want one for SC, write that. Then instead of having an argument that says what you want to do, you indicate what you want to do by calling that specific function."}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 9737991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3c2fdd69cec8158e863085ce8eef5b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zalhera", "link": "https://stackoverflow.com/users/9737991/zalhera"}, "is_accepted": false, "score": 0, "last_activity_date": 1562791316, "last_edit_date": 1562791316, "creation_date": 1562784445, "answer_id": 56976899, "question_id": 56975509, "link": "https://stackoverflow.com/questions/56975509/c-function-by-passing-parameters/56976899#56976899", "title": "C# function by passing parameters", "body": "<p>You got this error, because you're trying to multiply to objects of the type Result and not the double values itself.\nIf you want to use the * operator for objects of the type Result you have to overload the * operator in your class.</p>\n\n<pre><code>public class Result&lt;T&gt;\n{\n  public T Value { get; set; }\n\n  public static Result&lt;T&gt; operator * (Result&lt;T&gt; a, Result&lt;T&gt; b)\n  {\n    // Multiply Logic\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11194279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d6c2232c25331d9e08fe4c523263c2?s=128&d=identicon&r=PG&f=1", "display_name": "Shika", "link": "https://stackoverflow.com/users/11194279/shika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1562791316, "creation_date": 1562778370, "last_edit_date": 1562783442, "question_id": 56975509, "link": "https://stackoverflow.com/questions/56975509/c-function-by-passing-parameters", "title": "C# function by passing parameters", "body": "<p>Calculate a c# function by passing parameters </p>\n\n<p>My function is something like this:</p>\n\n<pre><code>Result&lt;double&gt; Evaluate(string var, Result&lt;double&gt; height, Result&lt;double&gt; perm)\n</code></pre>\n\n<p>Var can be anything user wants to enter. \nFor example, if the user enters Depth,\nthen the calculation would be like height * perm and return the var.\nIf user enters SC the calculation is height/ perm and result is stored in var and returns the result</p>\n\n<p>I tried something like this:</p>\n\n<pre><code>List&lt;double&gt; calvar = new List&lt;double&gt;\nSwitch(var){\n    Case \u201cdepth\u201d:\n        calvar = height * perm\n        return calvar\n}\n</code></pre>\n\n<p>I got an error saying * cannot be used for operators of type </p>\n"}, {"tags": ["java", "c#", "translate"], "comments": [{"owner": {"reputation": 2666, "user_id": 2478398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gKLfe.png?s=128&g=1", "display_name": "BeUndead", "link": "https://stackoverflow.com/users/2478398/beundead"}, "edited": false, "score": 0, "creation_date": 1562778610, "post_id": 56975471, "comment_id": 100487368, "body": "You&#39;re declaring everything (return value, variables within your method) as <code>Vec2D[]</code>.  This would be an <i>array</i> of <code>Vec2D</code> objects.  So when you try to return a <i>single</i> <code>Vec2D</code> (not single element in an array) that&#39;s a type mismatch.  Additionally, this is why <code>p1.getX</code> isn&#39;t an option as arrays do not have a <code>getX</code> field.  <code>p1[0].getX</code> <i>might</i> work, although at a guess (I don&#39;t know what class <code>Vec2D</code> is), <code>getX</code> would be a <i>method</i>, not a field, and so would be invoked <code>p1[0].getX()</code>.  But as a first pass, I&#39;d stop everything being arrays."}, {"owner": {"reputation": 33440, "user_id": 1831987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38b1c37530189ec4471a43a618e33f67?s=128&d=identicon&r=PG", "display_name": "VGR", "link": "https://stackoverflow.com/users/1831987/vgr"}, "edited": false, "score": 0, "creation_date": 1562778914, "post_id": 56975471, "comment_id": 100487521, "body": "What is the benefit of avoiding Java\u2019s <a href=\"https://docs.oracle.com/en/java/javase/12/docs/api/java.desktop/java/awt/Point.html\" rel=\"nofollow noreferrer\">Point</a> class, when you\u2019re just going to use it to set pixels in an image?  By using Point, the code will look nearly identical to the C# version, which will greatly reduce the likelihood of introducing bugs."}, {"owner": {"reputation": 13, "user_id": 11710797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d9d51013bac9dedaf0e35097497dfd?s=128&d=identicon&r=PG&f=1", "display_name": "Urlaka", "link": "https://stackoverflow.com/users/11710797/urlaka"}, "edited": false, "score": 0, "creation_date": 1562779032, "post_id": 56975471, "comment_id": 100487573, "body": "Well that makes sense. Im trying to identify points as a Vec2D array. This code uses a de-Casteljau algorithm to get new points. I use Vec2D array because i have written that class already and want to keep going with it and it also supports my drawing method"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11710797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d9d51013bac9dedaf0e35097497dfd?s=128&d=identicon&r=PG&f=1", "display_name": "Urlaka", "link": "https://stackoverflow.com/users/11710797/urlaka"}, "edited": false, "score": 0, "creation_date": 1562780456, "post_id": 56975582, "comment_id": 100488211, "body": "That makes sense a lot. I made a mistake: its getX() but that can be adjusted. 1 question remains: the c# code uses point list to represent the points. I want to use Vec2D[]. How can i handle that &quot;return points[i]&quot;?"}, {"owner": {"reputation": 13, "user_id": 11710797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d9d51013bac9dedaf0e35097497dfd?s=128&d=identicon&r=PG&f=1", "display_name": "Urlaka", "link": "https://stackoverflow.com/users/11710797/urlaka"}, "edited": false, "score": 0, "creation_date": 1562780969, "post_id": 56975582, "comment_id": 100488424, "body": "Or can i do just the same if i use an array list?"}, {"owner": {"reputation": 812, "user_id": 6288413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bLBoc.jpg?s=128&g=1", "display_name": "zmike", "link": "https://stackoverflow.com/users/6288413/zmike"}, "reply_to_user": {"reputation": 13, "user_id": 11710797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d9d51013bac9dedaf0e35097497dfd?s=128&d=identicon&r=PG&f=1", "display_name": "Urlaka", "link": "https://stackoverflow.com/users/11710797/urlaka"}, "edited": false, "score": 0, "creation_date": 1562781230, "post_id": 56975582, "comment_id": 100488514, "body": "@Urlaka You got it: you would use an <code>ArrayList</code> and then <code>return points.get(i);</code> instead of <code>return points[i];</code>"}], "tags": [], "owner": {"reputation": 812, "user_id": 6288413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bLBoc.jpg?s=128&g=1", "display_name": "zmike", "link": "https://stackoverflow.com/users/6288413/zmike"}, "is_accepted": true, "score": 0, "last_activity_date": 1562781164, "last_edit_date": 1562781164, "creation_date": 1562778717, "answer_id": 56975582, "question_id": 56975471, "link": "https://stackoverflow.com/questions/56975471/how-do-i-translate-this-c-code-into-java/56975582#56975582", "title": "How do i translate this c# code into java", "body": "<p>You are declaring <code>p1</code> and <code>p2</code> as <code>Vec2D</code> arrays and your method definition specifies a <code>Vec2D</code> array return type. However, inside your method you return a singlar <code>Vec2D</code> object.</p>\n\n<p>A potential solution:</p>\n\n<pre><code>public class SomeJavaClassName \n{ \n    ArrayList&lt;Vec2D&gt; points = new ArrayList&lt;String&gt;();\n\n    // Other methods, properties, variables, etc.,\n    // some of which would populate points\n\n    public Vec2D getCasteljauPoint(int r, int i, double t) { \n        // points[] is declared outside just like in the C# code\n        if(r == 0) return points.get(i);\n\n        Vec2D p1 = getCasteljauPoint(r - 1, i, t);\n        Vec2D p2 = getCasteljauPoint(r - 1, i + 1, t);\n\n        return new Vec2D(((1/2) * p1.getX + (1/2) * p2.getX), ((1/2)\n                            * p1.getY + (1/2) * p2.getY));\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11710797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d9d51013bac9dedaf0e35097497dfd?s=128&d=identicon&r=PG&f=1", "display_name": "Urlaka", "link": "https://stackoverflow.com/users/11710797/urlaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56975582, "answer_count": 1, "score": 0, "last_activity_date": 1562781164, "creation_date": 1562778250, "last_edit_date": 1562778582, "question_id": 56975471, "link": "https://stackoverflow.com/questions/56975471/how-do-i-translate-this-c-code-into-java", "title": "How do i translate this c# code into java", "body": "<p>I'm trying to test a De-Casteljau-subdivision code. However my example is in c# and i want to test it in java as I don't know c#.</p>\n\n<p>Especially the last return gives me issues as i cant get it right.\nI use Vec2D instead of point representing basic 2d vectors. In this case i represent the points with a Vec2D array. I have methods like \"getX\" to get the x part but if i just change it in the last line it fails.\nTo sum it up i exchanged \"Point\" with Vec2D[] and p1.X with p1.getX.</p>\n\n<pre><code>private void drawCasteljau(List&lt;point&gt; list)\n{\n    Point tmp;\n    for (double t = 0; t &amp; lt;= 1; t += 0.001) {\n        tmp = getCasteljauPoint(points.Count - 1, 0, t);\n        image.SetPixel(tmp.X, tmp.Y, color);\n    }\n}\n\nprivate Point getCasteljauPoint(int r, int i, double t)\n{\n    if (r == 0) return points[i];\n\n    Point p1 = getCasteljauPoint(r - 1, i, t);\n    Point p2 = getCasteljauPoint(r - 1, i + 1, t);\n\n    return new Point((int)((1 - t) * p1.X + t * p2.X), (int)((1\n                             - t) * p1.Y + t * p2.Y));\n}\n</code></pre>\n\n<p>My attempt:</p>\n\n<pre><code>public Vec2D[] getCasteljauPoint(int r, int i, double t) { \n    if(r == 0) return new Vec2D[i];\n\n    Vec2D[] p1 = getCasteljauPoint(r - 1, i, t);\n    Vec2D[] p2 = getCasteljauPoint(r - 1, i + 1, t);\n\n\n    return new Vec2D(((1/2) * p1.getX + (1/2) * p2.getX),  ((1/2)                        \n                        * p1.getY + (1/2) * p2.getY));\n}\n</code></pre>\n\n<p>I feel like there should be just minor changes to get it going but im stuck. Error message on last line says\n- getX cannot be resolved or is not a field\n- Type mismatch: cannot convert from Vec2D to Vec2D[]</p>\n"}, {"tags": ["c#", "machine-learning", "data-science", "ml.net"], "comments": [{"owner": {"reputation": 2479, "user_id": 839513, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Do1LF.jpg?s=128&g=1", "display_name": "baruchiro", "link": "https://stackoverflow.com/users/839513/baruchiro"}, "edited": false, "score": 0, "creation_date": 1562778366, "post_id": 56975461, "comment_id": 100487231, "body": "<a href=\"https://github.com/dotnet/docs/issues/13332\" rel=\"nofollow noreferrer\">Cross-reference to docs issue</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1339, "user_id": 1162129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0f9c939d49c3b55f1afa33e1f23070?s=128&d=identicon&r=PG&f=1", "display_name": "jakobandersen", "link": "https://stackoverflow.com/users/1162129/jakobandersen"}, "is_accepted": true, "score": 1, "last_activity_date": 1563382314, "creation_date": 1563382314, "answer_id": 57080808, "question_id": 56975461, "link": "https://stackoverflow.com/questions/56975461/ml-net-transform-data-without-fitting/57080808#57080808", "title": "ML.NET Transform data without fitting", "body": "<p>Calling Fit builds a chain of transformers from a chain of the estimators you setup using the convenience methods on the MLContext. Transformers do the actual work of transforming your data.</p>\n\n<p>You are correct that most of your Estimators do little work apart from returning their corresponding Transformer but when at some point turning this into a learning pipeline the similar structure will benefit you greatly.</p>\n"}], "owner": {"reputation": 2479, "user_id": 839513, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Do1LF.jpg?s=128&g=1", "display_name": "baruchiro", "link": "https://stackoverflow.com/users/839513/baruchiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 57080808, "answer_count": 1, "score": 1, "last_activity_date": 1563382314, "creation_date": 1562778223, "question_id": 56975461, "link": "https://stackoverflow.com/questions/56975461/ml-net-transform-data-without-fitting", "title": "ML.NET Transform data without fitting", "body": "<h2>Intro</h2>\n\n<p>Hi, I want to do some data preparation actions, and the put the <code>DataView</code> to another method, or use it in multiple places.</p>\n\n<p>So, I creating an <code>IEstimator&lt;ITransformer&gt;</code> object to hold the pipeline, for example:</p>\n\n<pre><code>var textEstimator = mlContext.Transforms.Text.NormalizeText(\"Description\")\n    .Append(mlContext.Transforms.Text.TokenizeIntoWords(\"Description\"))\n    .Append(mlContext.Transforms.Text.RemoveDefaultStopWords(\"Description\"))\n    .Append(mlContext.Transforms.Conversion.MapValueToKey(\"Description\"))\n    .Append(mlContext.Transforms.Text.ProduceNgrams(\"Description\"))\n    .Append(mlContext.Transforms.NormalizeLpNorm(\"Description\"));\n</code></pre>\n\n<p>(Copied from <a href=\"https://docs.microsoft.com/en-us/dotnet/machine-learning/how-to-guides/prepare-data-ml-net#work-with-text-data\" rel=\"nofollow noreferrer\">docs.microsoft</a>)</p>\n\n<p>But now, I want to get the <code>DataView</code>, and remember, this is <strong>not</strong> learning pipeline yet.</p>\n\n<hr>\n\n<h2>The question</h2>\n\n<p>So why I have to <code>Fit</code> the pipeline before <code>Tranform</code>?</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// Fit data to estimator\n// Fitting generates a transformer that applies the operations of defined by estimator\nITransformer textTransformer = textEstimator.Fit(data);\n\n// Transform data\nIDataView transformedData = textTransformer.Transform(data);\n</code></pre>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1562778325, "post_id": 56975459, "comment_id": 100487214, "body": "You can&#39;t. Why do you need the local IP? You can&#39;t do anything with it."}, {"owner": {"reputation": 844, "user_id": 910741, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/B7NLk.jpg?s=128&g=1", "display_name": "Bestter", "link": "https://stackoverflow.com/users/910741/bestter"}, "edited": false, "score": 0, "creation_date": 1562778348, "post_id": 56975459, "comment_id": 100487220, "body": "it will ALWAYS be the public IP address. You cannot have your own IP adresses, it will be transformed by the router."}, {"owner": {"reputation": 1, "user_id": 11766138, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJspkngycPU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVSMZCuaB8fBXMluHEi8UsYTy8gQ/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11766138/kiran"}, "edited": false, "score": 0, "creation_date": 1563330619, "post_id": 56975459, "comment_id": 100659924, "body": "Thank you for your reply. However, I want to check the client&#39;s unique ID to identify the machine. So I will check the IP and restrict the anonymous user. It will be also fine if I get any unique browser&#39;s ID"}], "owner": {"reputation": 1, "user_id": 11766138, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AJspkngycPU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcVSMZCuaB8fBXMluHEi8UsYTy8gQ/photo.jpg?sz=128", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11766138/kiran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "closed_date": 1562778363, "answer_count": 0, "score": 0, "last_activity_date": 1562778217, "creation_date": 1562778217, "question_id": 56975459, "link": "https://stackoverflow.com/questions/56975459/how-to-get-users-machines-ip-over-internet-sites", "closed_reason": "Duplicate", "title": "How to get user&#39;s machine&#39;s IP over Internet Sites", "body": "<p>I tried many codes, some of them work over local intranet but when I publish my app it returns public IP address instead of the local IP address. </p>\n\n<p>Also tried using almost all available server variables but didn't get the required result. </p>\n\n<p>How to get user's machine IP when they browse the website hosted in intranet or internet network</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c#", "asp.net-core", "routing", "asp.net-core-webapi"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 10812109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e8fabf315de16aac4f4b810b093d5?s=128&d=identicon&r=PG&f=1", "display_name": "RedRose", "link": "https://stackoverflow.com/users/10812109/redrose"}, "edited": false, "score": 0, "creation_date": 1562780847, "post_id": 56975875, "comment_id": 100488378, "body": "Thanks,  follow up question, if i am not wrong, when using web api , I did not have to specify the action when using conventional routing,  and the corresponding action was was inferred from the http method, is there something changed in asp net core ?"}, {"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "reply_to_user": {"reputation": 321, "user_id": 10812109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e8fabf315de16aac4f4b810b093d5?s=128&d=identicon&r=PG&f=1", "display_name": "RedRose", "link": "https://stackoverflow.com/users/10812109/redrose"}, "edited": false, "score": 1, "creation_date": 1562781050, "post_id": 56975875, "comment_id": 100488449, "body": "Technically, I suppose. In ASP.NET, MVC and Web Api were separate frameworks that looked and functioned similarly, but were still different, with different rules. In Core, it&#39;s all the same. MVC vs. API is just semantics describing the <i>purpose</i> of the controller, not the type."}, {"owner": {"reputation": 321, "user_id": 10812109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e8fabf315de16aac4f4b810b093d5?s=128&d=identicon&r=PG&f=1", "display_name": "RedRose", "link": "https://stackoverflow.com/users/10812109/redrose"}, "edited": false, "score": 0, "creation_date": 1562781180, "post_id": 56975875, "comment_id": 100488495, "body": "Thanks, but does this mean that if I add a IActionResult Post() do i have to create another  named  route  for that action ?"}, {"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "reply_to_user": {"reputation": 321, "user_id": 10812109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e8fabf315de16aac4f4b810b093d5?s=128&d=identicon&r=PG&f=1", "display_name": "RedRose", "link": "https://stackoverflow.com/users/10812109/redrose"}, "edited": false, "score": 1, "creation_date": 1562781421, "post_id": 56975875, "comment_id": 100488593, "body": "Yes and no. The route template I gave you will accept any action name; it just defaults to Get. However, that does mean you would specifically need to call <code>&#47;api&#47;nudge&#47;post</code>. Frankly, attribute routing just works better here. You can decorate one with <code>[HttpGet(\u201d\u201d)]</code> and the other with <code>[HttpPost(&quot;&quot;)]</code>, and you&#39;re done."}], "tags": [], "owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "is_accepted": true, "score": 1, "last_activity_date": 1562780022, "creation_date": 1562780022, "answer_id": 56975875, "question_id": 56975206, "link": "https://stackoverflow.com/questions/56975206/conventional-routing-not-working-for-simple-nudge-controller-with-only-get-met/56975875#56975875", "title": "Conventional routing not working for simple nudge controller with only Get() method", "body": "<p>The route template specifies no action. You're assuming <code>Get</code> should just magically be called, but ASP.NET Core has no way of knowing this and doesn't make assumptions like that. The following should fix it. It make <code>Get</code> the default action if no action segment is provided in the route.</p>\n\n<pre><code>app.UseMvc(routes =&gt;\n    routes.MapRoute(\n        name: \"nudgeRoute\",\n        template: \"api/{controller}/{action=Get}\"));\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 10812109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e8fabf315de16aac4f4b810b093d5?s=128&d=identicon&r=PG&f=1", "display_name": "RedRose", "link": "https://stackoverflow.com/users/10812109/redrose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56975875, "answer_count": 1, "score": -1, "last_activity_date": 1562780022, "creation_date": 1562777045, "question_id": 56975206, "link": "https://stackoverflow.com/questions/56975206/conventional-routing-not-working-for-simple-nudge-controller-with-only-get-met", "title": "Conventional routing not working for simple nudge controller with only Get() method", "body": "<p>I have simple asp net core web api with a nudge controller that returns true for Get request. \nThe NudgeController.cs looks as follows:</p>\n\n<pre><code>public class NudgeController : Controller\n{\n    public IActionResult Get()\n    {\n        return Ok(true);\n    }\n}\n</code></pre>\n\n<p>In StartUp.cs I have the following setup:</p>\n\n<pre><code>private static void ConfigureRoutes(IApplicationBuilder app)\n{\n    app.UseMvc(routes =&gt;\n            routes.MapRoute(\n                    name: \"nudgeRoute\",\n                    template: \"api/{controller}\"));                 \n}\n</code></pre>\n\n<p>ConfigureRoutes is called in <code>Configure(IApplicationBuilder app, IHostingEnvironment env)</code> method in StartUp.cs</p>\n\n<p>When running locally and when I navigate to <a href=\"http://localhost:56103/api/Nudge\" rel=\"nofollow noreferrer\">http://localhost:56103/api/Nudge</a>\nI get 404 error ?\nwhat is missing here ? and \nAre there any difference between WebApi and Asp.net core when setting up conventional routing ?</p>\n"}, {"tags": ["c#", "excel", "vba", "zipfile"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1562777288, "post_id": 56975033, "comment_id": 100486776, "body": "In &quot;xl_rels\\workbook.xml.rels&quot; there&#39;s an entry that refers to the vbaProject.bin. There are probably other conditions. What you need to do is manually Save As XLSX format, and then diff the XLSX vs XLSM"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1562823931, "post_id": 56975033, "comment_id": 100499971, "body": "Why are you trying to manipulate the file like this? Why don&#39;t you just open the workbook in Excel and use <code>SaveAs</code> to save the workbook in the xlsx format? This could be done eg. by VBA or C# using the Excel API. That would be the proper way to go without manipulating the file. Also this way it cannot accidentally be corrupted."}, {"owner": {"reputation": 1918, "user_id": 3515969, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a9205ca177b36ad3246659a3b6c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "IngoB", "link": "https://stackoverflow.com/users/3515969/ingob"}, "edited": false, "score": 1, "creation_date": 1562831058, "post_id": 56975033, "comment_id": 100503188, "body": "P\u1d07\u029c: Because I didn&#39;t know how to programmatically answer the &quot;functionality gets removed&quot; question. Using excel.DisplayAlerts = false; did the trick, so I am going the proper way now. Thank you!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562833968, "post_id": 56975033, "comment_id": 100504676, "body": "@IngoB Well, asking X while your actual issue is Y will (always) end up the wrong tree ;) To avoid this you might be interested in reading <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">What is the X/Y problem</a>."}, {"owner": {"reputation": 1918, "user_id": 3515969, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a9205ca177b36ad3246659a3b6c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "IngoB", "link": "https://stackoverflow.com/users/3515969/ingob"}, "edited": false, "score": 0, "creation_date": 1562846012, "post_id": 56975033, "comment_id": 100511682, "body": "P\u1d07\u029c: Right. But I found it cool to modify the Excel that way ;) and I learned a bit about what&#39;s possible."}], "owner": {"reputation": 1918, "user_id": 3515969, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a9205ca177b36ad3246659a3b6c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "IngoB", "link": "https://stackoverflow.com/users/3515969/ingob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562831288, "creation_date": 1562776297, "last_edit_date": 1562831288, "question_id": 56975033, "link": "https://stackoverflow.com/questions/56975033/removing-vbaproject-bin-in-xml-not-enough-to-save-as-xlsx", "title": "Removing vbaProject.bin in XML not enough to save as xlsx", "body": "<p>After exporting data into an Excel workbook with macros (xlsm), I run the macro and then remove the macro in order to be able to save the workbook as xlsx. For removing macros, I open the xlsm as zip archive (via C# ZipFile class), remove the entry \"xl/vbaProject.bin\" and remove a relation within \"xl/_rels/workbook.xml.rels\". Then I rename the file from xlsm to xlsx. That works fine so far but when I open the xlsx file in Excel, I get \"Excel cannot open the file because the file format or file extension is not valid. Verify that the file has not been corrupted and that the file extension matches the format of the file\", so there seems something to be missing in order to completely remove the vba code within the workbook. Can anyone help me here?</p>\n\n<pre><code>const string vbaProjectEntryName = \"xl/vbaProject.bin\"; // Contains the VBA code\nconst string relationsEntryName = \"xl/_rels/workbook.xml.rels\"; // Relation/Link to the vba project\n\nusing (var zip = ZipFile.Open(fileName, ZipArchiveMode.Update))\n{\n    var entry = zip.GetEntry(vbaProjectEntryName);\n    if (entry != null)\n    {\n        entry.Delete();\n\n        entry = zip.GetEntry(relationsEntryName);\n        if (entry != null)\n        {\n            var contents = string.Empty;\n            using (var streamReader = new StreamReader(entry.Open()))\n            {\n                contents = streamReader.ReadToEnd();\n            }\n\n            var relationText = \"&lt;Relationship Id=\\\"rId6\\\" Type=\\\"http://schemas.microsoft.com/office/2006/relationships/vbaProject\\\" Target=\\\"vbaProject.bin\\\"/&gt;\";\n            contents = contents.Replace(relationText, string.Empty);\n            entry.Delete();\n            entry = zip.CreateEntry(relationsEntryName);\n\n            using (var streamWriter = new StreamWriter(entry.Open()))\n            {\n                streamWriter.Write(contents);\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net-core", "nunit", "zeromq", "netmq"], "answers": [{"comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "reply_to_user": {"reputation": 2785, "user_id": 4353606, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh5.googleusercontent.com/-6mXGsWHRTVo/AAAAAAAAAAI/AAAAAAAAAXg/eoDQ9bZ3PtM/photo.jpg?sz=128", "display_name": "GTHvidsten", "link": "https://stackoverflow.com/users/4353606/gthvidsten"}, "edited": false, "score": 0, "creation_date": 1563406699, "post_id": 57066991, "comment_id": 100693543, "body": "See update - they are unit testing their framework. So while you should code in a smoke test and an integration don&#39;t bother double unit testing!! I&#39;m not going to go into the philosophy of unit testing vs integration testing but generally in unit testing you don&#39;t test external resources instead we mock/stub them, especially when its a 3rd party component that has its own regression testing suite."}, {"owner": {"reputation": 2785, "user_id": 4353606, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh5.googleusercontent.com/-6mXGsWHRTVo/AAAAAAAAAAI/AAAAAAAAAXg/eoDQ9bZ3PtM/photo.jpg?sz=128", "display_name": "GTHvidsten", "link": "https://stackoverflow.com/users/4353606/gthvidsten"}, "edited": false, "score": 0, "creation_date": 1563459504, "post_id": 57066991, "comment_id": 100714638, "body": "So a 500ms delay every time I do <code>NetMqTransport.Start()</code> should be enough to fix everything then? (I tried it and it seems to help, but would be nice to have a confirmation that it is correct... also, a <code>Thread.Sleep</code> feels a bit dirty. I tried with a ResetEvent, but this caused a deadlock somewhere.)"}, {"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "reply_to_user": {"reputation": 2785, "user_id": 4353606, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh5.googleusercontent.com/-6mXGsWHRTVo/AAAAAAAAAAI/AAAAAAAAAXg/eoDQ9bZ3PtM/photo.jpg?sz=128", "display_name": "GTHvidsten", "link": "https://stackoverflow.com/users/4353606/gthvidsten"}, "edited": false, "score": 0, "creation_date": 1563505181, "post_id": 57066991, "comment_id": 100730431, "body": "I&#39;m still wondering why they dont have any Unit Test for the <code>NetMqTransport</code>, I might add to your GitHub ticket to politely raise a bit more awareness."}, {"owner": {"reputation": 2785, "user_id": 4353606, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh5.googleusercontent.com/-6mXGsWHRTVo/AAAAAAAAAAI/AAAAAAAAAXg/eoDQ9bZ3PtM/photo.jpg?sz=128", "display_name": "GTHvidsten", "link": "https://stackoverflow.com/users/4353606/gthvidsten"}, "edited": false, "score": 0, "creation_date": 1563523307, "post_id": 57066991, "comment_id": 100735848, "body": "The <code>NetMqTransport.Start()</code> is a part of my code and not NetMQ (it can be found in <code>NetMQ.cs</code> in the Gist), which is probably why you can&#39;t find any Unit Tests for it :)"}], "tags": [], "owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "is_accepted": false, "score": 3, "last_activity_date": 1563431260, "last_edit_date": 1563431260, "creation_date": 1563322925, "answer_id": 57066991, "question_id": 56975021, "link": "https://stackoverflow.com/questions/56975021/why-doesnt-netmq-work-in-an-nunit-environment/57066991#57066991", "title": "Why doesn&#39;t NetMQ work in an NUnit environment", "body": "<p>I was able to reproduce it and found this thread <a href=\"https://github.com/zeromq/netmq/issues/482\" rel=\"nofollow noreferrer\">https://github.com/zeromq/netmq/issues/482</a> which indicates its a timing issue between starting the Publisher and time for the Subscriber to receive the message.</p>\n\n<pre><code>using NetMQ;\nusing NetMQ.Sockets;\nusing NUnit.Framework;\nusing System;\nusing System.Threading;\nusing System.Threading.Tasks;\n\nnamespace Tests\n{\n    class NetMqTransportTests\n    {\n        [Test]\n        public void TestMulticastNetMQ()\n        {\n            bool wasCalled = false;\n\n            var coreEventbus = \"tcp://localhost:12345\";\n\n            Task.Run(() =&gt;\n            {\n                using (var subSocket = new SubscriberSocket())\n                {\n                    subSocket.Connect(coreEventbus);\n                    subSocket.Subscribe(\"account\");\n\n                    while (true)\n                    {\n                        string messageTopicReceived = subSocket.ReceiveFrameString();\n                        string messageReceived = subSocket.ReceiveFrameString();\n\n                        Assert.IsTrue(messageReceived == \"testing\");\n                        wasCalled = true;\n                        break;\n                    }\n                }\n\n            });\n\n            Thread.Sleep(TimeSpan.FromSeconds(1));\n\n            using (var pubSocket = new PublisherSocket())\n            {\n                pubSocket.Bind(coreEventbus);\n\n                Thread.Sleep(500);\n                pubSocket.SendMoreFrame(\"account\").SendFrame(\"testing\");\n            }\n\n            Thread.Sleep(TimeSpan.FromSeconds(5));\n\n            Assert.IsTrue(wasCalled);\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Update:</strong></p>\n\n<p>Here are the Unit Tests that come with the NetMQ library: <a href=\"https://github.com/zeromq/netmq/blob/master/src/NetMQ.Tests/XPubSubTests.cs\" rel=\"nofollow noreferrer\">https://github.com/zeromq/netmq/blob/master/src/NetMQ.Tests/XPubSubTests.cs</a></p>\n\n<p>See how they break up instantiating <code>NetMqTransport</code> into using both XPublisherSocket and XPublisherSocket...</p>\n\n<p>Also notice as per the issue 482 they do a 500ms delay to let the subscriber connect before receiving the message, just like they were talking about in the issue:</p>\n\n<pre><code>[Fact]\npublic void TopicPubSub()\n{\n    using (var pub = new XPublisherSocket())\n    using (var sub = new XPublisherSocket())\n    {\n        var port = pub.BindRandomPort(\"tcp://127.0.0.1\");\n        sub.Connect(\"tcp://127.0.0.1:\" + port);\n        sub.SendFrame(new byte[] { 1, (byte)'A' });\n\n        // let the subscriber connect to the publisher before sending a message\n        Thread.Sleep(500);\n\n        var msg = pub.ReceiveFrameBytes();\n</code></pre>\n"}], "owner": {"reputation": 2785, "user_id": 4353606, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh5.googleusercontent.com/-6mXGsWHRTVo/AAAAAAAAAAI/AAAAAAAAAXg/eoDQ9bZ3PtM/photo.jpg?sz=128", "display_name": "GTHvidsten", "link": "https://stackoverflow.com/users/4353606/gthvidsten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1563431260, "creation_date": 1562776242, "question_id": 56975021, "link": "https://stackoverflow.com/questions/56975021/why-doesnt-netmq-work-in-an-nunit-environment", "title": "Why doesn&#39;t NetMQ work in an NUnit environment", "body": "<p>I've created a Gist with my NetMQ implementation as I feel it a bit much to paste here: <a href=\"https://gist.github.com/gthvidsten/e626d7e6c51012b1ba152d22e034d93d\" rel=\"nofollow noreferrer\">https://gist.github.com/gthvidsten/e626d7e6c51012b1ba152d22e034d93d</a></p>\n\n<p>If I do the following in a .Net Core console app, everything works fine and I receive the <code>MessageReceived</code> event:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>static void Main(string[] args)\n{\n    _transportWithHost = new NetMqTransport(\n        \"tcp://localhost:9990\",\n        \"tcp://localhost:9991\",\n        true);\n    _transportWithHost.Start();\n\n    Console.WriteLine(\"Press [Enter] to publish\");\n    Console.ReadLine();\n\n    _transportWithHost.MessageReceived += (sender, e) =&gt;\n    {\n        ; // Breakpoints here are hit\n    };\n    _transportWithHost.Publish(new byte[] { 1, 2, 3, 4 });\n\n    Console.WriteLine(\"Press [Enter] to exit\");\n    Console.ReadLine();\n}\n</code></pre>\n\n<p>However, if I try to do the same in an NUnit test environment, the <code>MessageReceived</code> event is never fired!</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>class NetMqTransportTests\n{\n    private NetMqTransport _transportWithHost;\n\n    [OneTimeSetUp]\n    public void Setup()\n    {\n        _transportWithHost = new NetMqTransport(\n            \"tcp://localhost:9990\",\n            \"tcp://localhost:9991\",\n            true);\n        _transportWithHost.Start();\n    }\n\n    [Test]\n    public void PublishTest()\n    {\n        ManualResetEvent mre = new ManualResetEvent(false);\n\n        _transportWithHost.MessageReceived += (sender, e) =&gt;\n        {\n            mre.Set();\n            // Breakpoints here are never hit as MessageReceived is never called\n        };\n\n        _transportWithHost.Publish(new byte[] { 1, 2, 3, 4 });\n\n        bool eventFired = mre.WaitOne(new TimeSpan(0, 0, 5));\n        Assert.True(eventFired);\n    }\n}\n</code></pre>\n\n<p>Why does the virtually identical code work in a console app, but not in an NUnit environment?</p>\n"}, {"tags": ["c#", "jquery", "error-handling"], "comments": [{"owner": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 0, "creation_date": 1562775769, "post_id": 56974861, "comment_id": 100486050, "body": "<code>indexOf</code> is a String/Array operator.  Parsing the json turns it into <b>not</b> a string.  Is the JSON response an array?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10682825"}, "reply_to_user": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 0, "creation_date": 1562775882, "post_id": 56974861, "comment_id": 100486096, "body": "Yes, its a list&lt;string&gt;. The PowerShellExecutoreGrd handles the error text into that list variable."}, {"owner": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 0, "creation_date": 1562775898, "post_id": 56974861, "comment_id": 100486105, "body": "<code>console.log(response)</code> and verify that it has a property of <code>message</code> on it, and that <code>response</code> is not a String"}, {"owner": {"reputation": 162920, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1562775944, "post_id": 56974861, "comment_id": 100486124, "body": "And you aren&#39;t parsing the json....you are trying to look for an object property in the response string and parse that. But the response string would have no such property. Add <code>dataType:&#39;json&#39;</code>, to request options and get rid of <code>$.parseJSON</code>. The whole response will be an object that way"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10682825"}, "reply_to_user": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 0, "creation_date": 1562776077, "post_id": 56974861, "comment_id": 100486183, "body": "@Taplar, message is created in the FillMembers function as a new variable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10682825"}, "reply_to_user": {"reputation": 162920, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1562776140, "post_id": 56974861, "comment_id": 100486221, "body": "@charlietfl, I tried response.message.indexOf(&quot;Error&quot;) still it gives -1 always."}, {"owner": {"reputation": 162920, "user_id": 1175966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3d9dfbd040f9cbc1a6b82f0da2b345?s=128&d=identicon&r=PG", "display_name": "charlietfl", "link": "https://stackoverflow.com/users/1175966/charlietfl"}, "edited": false, "score": 0, "creation_date": 1562776235, "post_id": 56974861, "comment_id": 100486269, "body": "So what does <code>response</code> actually look like?"}, {"owner": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 0, "creation_date": 1562776243, "post_id": 56974861, "comment_id": 100486272, "body": "FillMembers is on the server side.  I&#39;m suggesting you verify what <code>response</code> actually is.  You&#39;re assuming that response is an object with a property of message on it.  I&#39;m pointing out that that is an assumption.  Edit: And if all your assumptions are correct, the code would work and you wouldn&#39;t be asking a question here, :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10682825"}, "edited": false, "score": 0, "creation_date": 1562776365, "post_id": 56974861, "comment_id": 100486338, "body": "response is [object Object]."}, {"owner": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 0, "creation_date": 1562776392, "post_id": 56974861, "comment_id": 100486350, "body": "And what is <code>console.log(response.message)</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10682825"}, "edited": false, "score": 0, "creation_date": 1562776527, "post_id": 56974861, "comment_id": 100486411, "body": "The text that I am setting in items. &quot;Error: Attempted to divide by zero.&quot;"}, {"owner": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 1, "creation_date": 1562776551, "post_id": 56974861, "comment_id": 100486418, "body": "So that&#39;s not JSON.  <code>response.message.startsWith(&#39;Error: &#39;)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10682825"}, "edited": false, "score": 0, "creation_date": 1562776663, "post_id": 56974861, "comment_id": 100486470, "body": "But FillMembers returns the JSON Result?"}, {"owner": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 1, "creation_date": 1562776683, "post_id": 56974861, "comment_id": 100486477, "body": "That means nothing.  Your console log is telling you want it is.  The fact that <code>response</code> is already parsed into an object suggests that jQuery is auto parsing it for you already.  It will do that if the response returns a content type of application/json on it"}, {"owner": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 1, "creation_date": 1562776945, "post_id": 56974861, "comment_id": 100486593, "body": "^^^ you can check that by looking at the request in the developer tools network tab and looking at the content type header on the response"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10682825"}, "reply_to_user": {"reputation": 24196, "user_id": 1586174, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4aa4d9e7b30a8bddace165e4c33abd85?s=128&d=identicon&r=PG", "display_name": "Taplar", "link": "https://stackoverflow.com/users/1586174/taplar"}, "edited": false, "score": 0, "creation_date": 1562777643, "post_id": 56974861, "comment_id": 100486924, "body": "@Taplar, thank you so much for the info. Yes, looked at it and found out that datatype of response.message is undefined which is why even the indexOf was not working."}], "owner": {"user_type": "does_not_exist", "display_name": "user10682825"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562778228, "creation_date": 1562775523, "question_id": 56974861, "link": "https://stackoverflow.com/questions/56974861/look-up-for-a-text-in-json-result-in-jquery", "title": "Look up for a text in json result in jQuery", "body": "<p>Want to add condition if the response message in the json result has the text 'error' then do some operations.</p>\n\n<p>I have a function in my controller file that is used to fill the data however when there is an internal error like a user defined value that I want to consider as an error I am classifying it by concatenating the word error in the result and passing it as json result to use it in ajax call. I tried using indexOf in the message variable however everytime I am getting -1 whether the result received on ajax call has \"Error\" or not.</p>\n\n<p>This is my C# code for getting data and passing the json result.</p>\n\n<pre><code>public List&lt;string&gt; PowerShellExecutorGrd(string scriptPath, string arg)\n    {\n        var items = new List&lt;string&gt;();\n        using (var shell = PowerShell.Create())\n        {\n            shell.Commands.AddCommand(scriptPath).AddArgument(arg);\n            var results = shell.Invoke();\n            System.Diagnostics.Debug.WriteLine(shell.HadErrors.ToString());\n            if (shell.HadErrors == false) {\n                if (results.Any()) {\n                    foreach (var psObj in results)\n                        items.Add(Server.HtmlEncode(psObj.ToString().Trim('{', '}')));\n                }\n            } else\n            {\n                var errorMessage = new StringBuilder();\n                foreach (ErrorRecord err in shell.Streams.Error)\n                {\n                    errorMessage.AppendLine(err.ToString());\n                }\n                items.Add(\"Error : \" + errorMessage.ToString());\n            }\n        };\n        return items;\n    }\n\n\npublic JsonResult FillMembers(string GroupGUID)\n    {\n        var SDC = PowerShellExecutorGrd(AppDomain.CurrentDomain.BaseDirectory + \"Shell\\\\Get-ADGroupMembers.ps1\", GroupGUID);\n        return Json(new { message = SDC }, JsonRequestBehavior.AllowGet);\n    }\n</code></pre>\n\n<p>This is my ajax call :</p>\n\n<pre><code>$.ajax({\n                    type: \"POST\",\n                    url: \"/Group/FillMembers\",\n                    data: { GroupGUID: $(\"#ddlGroup option:selected\").val() },\n                    success: function (response) {\n                          if ($.parseJSON(response.message).indexOf(\"Error\") == -1) { alert(response.message); }\n                    }\n        }\n  });\n</code></pre>\n\n<p>Suppose my shell script has 1/0, the json result will have Divide by Zero error encountered, I am getting it in response.message however the indexOf() property is not seems to be working.</p>\n"}, {"tags": ["c#", "asp.net", "vb.net"], "comments": [{"owner": {"reputation": 434, "user_id": 899527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sccFA.jpg?s=128&g=1", "display_name": "Nouman", "link": "https://stackoverflow.com/users/899527/nouman"}, "edited": false, "score": 0, "creation_date": 1562775659, "post_id": 56974716, "comment_id": 100485999, "body": "Did you try some online code convertor like <a href=\"http://converter.telerik.com\" rel=\"nofollow noreferrer\">http://converter.telerik.com/</a> to see if the generated output is different from your VB.Net code"}, {"owner": {"reputation": 37, "user_id": 7195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f307ceb375e66bbf7129075d5054b9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/7195738/frank"}, "reply_to_user": {"reputation": 434, "user_id": 899527, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sccFA.jpg?s=128&g=1", "display_name": "Nouman", "link": "https://stackoverflow.com/users/899527/nouman"}, "edited": false, "score": 0, "creation_date": 1562777913, "post_id": 56974716, "comment_id": 100487048, "body": "Yes of course is the first step i&#39;ve done."}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1562778426, "post_id": 56974716, "comment_id": 100487269, "body": "Declare the delegate as <code>Sub</code>, not as <code>Function</code>. Because, if the event is fired, where should the function result be assigned to?"}, {"owner": {"reputation": 37, "user_id": 7195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f307ceb375e66bbf7129075d5054b9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/7195738/frank"}, "edited": false, "score": 0, "creation_date": 1562784069, "post_id": 56974716, "comment_id": 100489796, "body": "If i use SUB instead FUNCTION compiler tells thar RAISE is an event and i can&#39;t declare and i&#39;ve to use RaiseEvent in the following istructions.          Public Sub RaiseCallbackEvent(ByVal eventArgument As String)             If Raise IsNot Nothing Then callbackResult = Raise(eventArgument)         End Sub.  My goal is have multiple client callbacks. In this case i&#39;m trying with two simple buttons."}, {"owner": {"reputation": 11547, "user_id": 832052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/VA1xt.png?s=128&g=1", "display_name": "djv", "link": "https://stackoverflow.com/users/832052/djv"}, "edited": false, "score": 1, "creation_date": 1562790584, "post_id": 56974716, "comment_id": 100492407, "body": "Take a look at <a href=\"https://stackoverflow.com/q/7770582/832052\">this question</a> in which the OP asks if VB.NET has events which return values, and <a href=\"https://stackoverflow.com/a/7770758/832052\">this answer</a> stating &quot;that&#39;s not possible in VB.NET&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f307ceb375e66bbf7129075d5054b9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/7195738/frank"}, "edited": false, "score": 0, "creation_date": 1562777754, "post_id": 56974985, "comment_id": 100486976, "body": "If i use       AddHandler button1Callback.Raise, AddressOf button1Callback_Raise  Compiler &quot;says me&quot; Raise is not an event   because      Public Delegate Function OnRaiseCallbackEvent(ByVal eventArgument As String) As String      Public Raise As OnRaiseCallbackEvent  and if declare as Event receive  &quot;Events cannot be declared with a delegate type that has a return type&quot;"}], "tags": [], "owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "is_accepted": false, "score": 3, "last_activity_date": 1562776060, "creation_date": 1562776060, "answer_id": 56974985, "question_id": 56974716, "link": "https://stackoverflow.com/questions/56974716/convert-c-to-vb-net-event-with-a-delegate-type-that-has-a-return-type/56974985#56974985", "title": "Convert C# to VB.NET: Event with a delegate type that has a return type", "body": "<p>VB.NET uses <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/addhandler-statement\" rel=\"nofollow noreferrer\">AddHandler</a> for event registration, whereas C# uses the <code>+=</code> syntax.</p>\n\n<p>Try <code>AddHandler button1Callback.Raise, AddressOf button1Callback_Raise</code></p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 7195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f307ceb375e66bbf7129075d5054b9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/7195738/frank"}, "is_accepted": false, "score": 0, "last_activity_date": 1563870960, "creation_date": 1563870960, "answer_id": 57159985, "question_id": 56974716, "link": "https://stackoverflow.com/questions/56974716/convert-c-to-vb-net-event-with-a-delegate-type-that-has-a-return-type/57159985#57159985", "title": "Convert C# to VB.NET: Event with a delegate type that has a return type", "body": "<p><strong>Solved in this way:</strong></p>\n\n<p>following djv's suggestion (have events return a value like in C# is not possible in VB.NET)</p>\n\n<p>i've build a WebControl in C#, added control to probject\nand put in ASPX Page this tag</p>\n\n<pre><code>&lt;%@ Register Assembly=\"SmartOBJ.Web.UI.WebControls\" Namespace=\"SmartOBJ.Web.UI.WebControls\" TagPrefix=\"SmartOBJ\" %&gt;\n\n&lt;SmartOBJ:SampleControl ID=\"SampleControl1\" runat=\"server\" /&gt;\n</code></pre>\n\n<p>This the call on click in ASPX </p>\n\n<pre><code>..... other javascript code\nswitch (Type) {\n    case 'E':\n        delRECORD(ID_RECORDD.toString()+';E', '', callbackComplete); return false;break;\n    case 'SC':\n        delRECORD(ID_RECORDD.toString() + ';SC', '', callbackComplete); return false;break;\n    case 'SS':\n        mess = 'xxxx';break;}\n........\n</code></pre>\n\n<p>This c# file:</p>\n\n<pre><code>using System.IO;\nusing System.Reflection;\nusing System.Web.UI;\n\nusing System.Web.UI.WebControls;\nusing System.Text.RegularExpressions;\n\n[assembly: TagPrefix(\"SmartOBJ.Web.UI.WebControls\", \"SmartOBJ\")]\nnamespace SmartOBJ.Web.UI.WebControls\n{\n    [ToolboxData(\"&lt;{0}:SampleControl runat=server&gt;&lt;/{0}:SampleControl&gt;\")]\n    public class SampleControl : CompositeControl\n    {\n        #region members\n        private Button button1;\n        private ClientCallback delRECORD;\n        #endregion\n\n        protected override void OnPreRender(System.EventArgs e)\n        {\n            base.OnPreRender(e);\n\n            // Register client side script for the callbacks\n            string clientScript = GetResource(\"SmartOBJ.Web.UI.WebControls.Resources.SampleControlClientScript.js\");\n            clientScript = clientScript.Replace(\"{button1_callback_reference}\", GetCallbackReference(button1Callback));\n            clientScript = clientScript.Replace(\"{delRECORD_callback_reference}\", GetCallbackReference(delRECORD));\n            Page.ClientScript.RegisterClientScriptBlock(GetType(), \"client_script\", clientScript, true);\n        }\n\n        protected override void CreateChildControls()\n        {\n            // Create buttons\n            button1 = new Button\n                          {\n                              ID = \"Button1\",\n                              Text = \"Button 1\",\n                              Visible = false,\n                              OnClientClick = \"button1Clicked(ID_RECORD, '', callbackComplete);return false;\"\n\n                          };\n            Controls.Add(button1);\n\n\n            // Create callback controls\n            delRECORD = new ClientCallback { ID = \"delRECORD\" };\n            delRECORD.Raise += delRECORD_Raise;\n            Controls.Add(delRECORD);\n\n\n        }\n\n        protected override void RenderContents(HtmlTextWriter writer)\n        {\n            // Render buttons\n            button1.RenderControl(writer);\n\n            // Render result div\n            writer.AddAttribute(HtmlTextWriterAttribute.Id, \"result\");\n            writer.RenderBeginTag(HtmlTextWriterTag.Div);\n            writer.RenderEndTag();\n\n            // Render callback controls\n            delRECORD.RenderControl(writer);\n        }\n\n        /// Handles client callback events for delRECORD.\n        /// &lt;param name=\"eventArgument\"&gt;\n        private string delRECORD_Raise(string eventArgument)\n        {\n            ToolsDB mytool=new ToolsDB();\n            bool verify=false;\n            string msg=\"\";\n            string msg2 = \"\";\n\n            string[] parameters = Regex.Split(eventArgument, \";\"); \n\n            if  (parameters[1] == \"E\")\n                {\n                    msg = \"msg1\";\n                    msg2= \" msg2\"; \n                    verify=mytool.delRECORD(parameters[0],parameters[1]); // This part execute other code to manage DB and is defined in another class\n                }\n\n            if (parameters[1] == \"SC\")\n            {\n                msg = \" msg1\";\n                msg2 = \" msg2\";\n                verify = mytool.delRECORD(parameters[0], parameters[1]);\n            }\n\n\n            if (verify == true) \n                {return \"ALLISOK;\" + parameters[0] +\";Record with ID \" + parameters[0] + msg;}\n            else\n                { return \"NOTOK;\" + parameters[0] + \";Record with ID \" + parameters[0] + msg2; }        \n        }\n\n        private string button1Callback_Raise(string eventArgument)\n        {\n            return eventArgument.ToString() + \"_\" + \"Button 1 callback processed.\" ;\n        }\n\n\n        /// Helper to load embedded resource as a string.\n        private static string GetResource(string resourceName)\n        {\n            Assembly assembly = Assembly.GetExecutingAssembly();\n            string result = string.Empty;\n            Stream resourceStream = assembly.GetManifestResourceStream(resourceName);\n            if (resourceStream != null)\n            {\n                using (TextReader textReader = new StreamReader(resourceStream))\n                {\n                    result = textReader.ReadToEnd();\n                }\n            }\n            return result;\n        }\n\n        private string GetCallbackReference(Control control)\n        {\n            return Page.ClientScript.GetCallbackEventReference(control, \"arg\", \"callback\", \"context\");\n        }\n    }\n}\n</code></pre>\n\n<p>This resource file in js contains</p>\n\n<pre><code>function button1Clicked(arg, context, callback) {\n    {button1_callback_reference};\n}\n\n\nfunction delRECORD(arg, context, callback) {\n    {delRECORD_callback_reference};\n}\n\nfunction callbackComplete(result, context) {\n    var parameters = result.split(\";\");\n    if (parameters[0] == 'ALLISOK')\n        {\n        $table.bootstrapTable('remove', {\n            field: 'id',\n            values: [IDRow]\n        });\n        alert(parameters[2]);\n        $('#deletemovedir').modal('toggle');\n    }\n    else\n        {\n        alert(parameters[2]);\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7195738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f307ceb375e66bbf7129075d5054b9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank", "link": "https://stackoverflow.com/users/7195738/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563870960, "creation_date": 1562774988, "last_edit_date": 1562789187, "question_id": 56974716, "link": "https://stackoverflow.com/questions/56974716/convert-c-to-vb-net-event-with-a-delegate-type-that-has-a-return-type", "title": "Convert C# to VB.NET: Event with a delegate type that has a return type", "body": "<p>I'm trying to have Handle multiple client callbacks in ASP.NET, and i'm following this <a href=\"https://www.codeproject.com/Articles/32312/Handle-multiple-client-callbacks-in-ASP-NET\" rel=\"nofollow noreferrer\">article</a></p>\n\n<p>I've converted C# code to my environment VB.NET/ASP.NET.</p>\n\n<p>Namespace used is <strong>SmartSoft.Web.UI.WebControls</strong></p>\n\n<p>In Class called <strong>ClientCallback</strong> i've this piece of code</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Delegate Function OnRaiseCallbackEvent(ByVal eventArgument As String) As String\n\nPublic Event Raise As OnRaiseCallbackEvent\n</code></pre>\n\n<p>The compiler marks the event declaration with this error message:</p>\n\n<blockquote>\n  <p>Events cannot be declared with a delegate type that has a return type.</p>\n</blockquote>\n\n<p>I tried to follow solution <a href=\"https://stackoverflow.com/questions/43174571/convert-c-sharp-to-vb-net-event-with-a-delegate-type-that-has-a-return-type\">here</a> but if declare </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Raise As OnRaiseCallbackEvent\n</code></pre>\n\n<p>I receive another error in another class called <strong>SampleCompositeControl</strong></p>\n\n<p>where I've</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private button1 As Button\nPrivate button1Callback As ClientCallback\n\nProtected Overrides Sub OnPreRender(ByVal e As System.EventArgs)\n   ......\nEnd Sub\n\nProtected Overrides Sub CreateChildControls()\n    button1 = New Button With {.ID = \"Button1\",.Text = \"Button 1\",\n            .OnClientClick = \"button1Clicked('', '', callbackComplete);return false;\"}\n\n        Controls.Add(button1)\n        button1Callback = New ClientCallback With {\n            .ID = \"button1Callback\"}\n\n        button1Callback.Raise += AddressOf button1Callback_Raise\n        ..........\n    End Sub\n\n    Protected Overrides Sub RenderContents(ByVal writer As HtmlTextWriter)\n       ........\n    End Sub\n\n    Private Function button1Callback_Raise(ByVal eventArgument As String) As String\n        Return \"Button 1 callback processed.\"\n    End Function\n\n    Private Shared Function GetResource(ByVal resourceName As String) As String\n       ..........\n    End Function\n\n    Private Function GetCallbackReference(ByVal control As Control) As String\n        Return Page.ClientScript.GetCallbackEventReference(control, \"arg\", \"callback\", \"context\")\n    End Function\n</code></pre>\n\n<p>The compiler marks \n    button1Callback.Raise += AddressOf button1Callback_Raise</p>\n\n<p>with this error message:</p>\n\n<blockquote>\n  <p>'+' operator is not defined for types 'SmartSoft.Web.UI.WebControls.SmartSoft.Web.UI.WebControls.ClientCallback.OnRaiseCallbackEvent' and 'Void'.</p>\n</blockquote>\n\n<p>How can I properly translate the code from C# to VB.NET without losing functionality?</p>\n"}, {"tags": ["c#", "asp.net-mvc", "routing"], "comments": [{"owner": {"reputation": 1150, "user_id": 8239500, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h-2-AydwfhY/AAAAAAAAAAI/AAAAAAAAABg/d1aiu6eWtpQ/photo.jpg?sz=128", "display_name": "Mangesh Auti", "link": "https://stackoverflow.com/users/8239500/mangesh-auti"}, "edited": false, "score": 0, "creation_date": 1562775766, "post_id": 56974657, "comment_id": 100486048, "body": "where you define isType and categoryName ?? show model"}, {"owner": {"reputation": 377, "user_id": 11498997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X5h1W.jpg?s=128&g=1", "display_name": "Samuel Wakeman", "link": "https://stackoverflow.com/users/11498997/samuel-wakeman"}, "reply_to_user": {"reputation": 1150, "user_id": 8239500, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h-2-AydwfhY/AAAAAAAAAAI/AAAAAAAAABg/d1aiu6eWtpQ/photo.jpg?sz=128", "display_name": "Mangesh Auti", "link": "https://stackoverflow.com/users/8239500/mangesh-auti"}, "edited": false, "score": 0, "creation_date": 1562776423, "post_id": 56974657, "comment_id": 100486367, "body": "i linked it but I don&#39;t see the model definition is relevant."}, {"owner": {"reputation": 1150, "user_id": 8239500, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h-2-AydwfhY/AAAAAAAAAAI/AAAAAAAAABg/d1aiu6eWtpQ/photo.jpg?sz=128", "display_name": "Mangesh Auti", "link": "https://stackoverflow.com/users/8239500/mangesh-auti"}, "edited": false, "score": 0, "creation_date": 1562776537, "post_id": 56974657, "comment_id": 100486415, "body": "Check IsType value set properly or not"}, {"owner": {"reputation": 1150, "user_id": 8239500, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h-2-AydwfhY/AAAAAAAAAAI/AAAAAAAAABg/d1aiu6eWtpQ/photo.jpg?sz=128", "display_name": "Mangesh Auti", "link": "https://stackoverflow.com/users/8239500/mangesh-auti"}, "edited": false, "score": 0, "creation_date": 1562776743, "post_id": 56974657, "comment_id": 100486506, "body": "On view, your using item model, that item model IsType property is set or not ?"}, {"owner": {"reputation": 1150, "user_id": 8239500, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h-2-AydwfhY/AAAAAAAAAAI/AAAAAAAAABg/d1aiu6eWtpQ/photo.jpg?sz=128", "display_name": "Mangesh Auti", "link": "https://stackoverflow.com/users/8239500/mangesh-auti"}, "edited": false, "score": 0, "creation_date": 1562776906, "post_id": 56974657, "comment_id": 100486574, "body": "and one more thing, you don&#39;t need to write ProductController, you can just type Product in RedirecToAction method"}, {"owner": {"reputation": 1150, "user_id": 8239500, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h-2-AydwfhY/AAAAAAAAAAI/AAAAAAAAABg/d1aiu6eWtpQ/photo.jpg?sz=128", "display_name": "Mangesh Auti", "link": "https://stackoverflow.com/users/8239500/mangesh-auti"}, "reply_to_user": {"reputation": 377, "user_id": 11498997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X5h1W.jpg?s=128&g=1", "display_name": "Samuel Wakeman", "link": "https://stackoverflow.com/users/11498997/samuel-wakeman"}, "edited": false, "score": 0, "creation_date": 1562778839, "post_id": 56974657, "comment_id": 100487474, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/196272/discussion-between-mangesh-auti-and-samuel-wakeman\">continue this discussion in chat</a>."}], "owner": {"reputation": 377, "user_id": 11498997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X5h1W.jpg?s=128&g=1", "display_name": "Samuel Wakeman", "link": "https://stackoverflow.com/users/11498997/samuel-wakeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562776333, "creation_date": 1562774748, "last_edit_date": 1562776333, "question_id": 56974657, "link": "https://stackoverflow.com/questions/56974657/html-route-values-not-being-passed-to-the-url-controller", "title": "html route values not being passed to the url/controller", "body": "<p>the title pretty much says it all</p>\n\n<p>here is the controller action method</p>\n\n<pre><code>public async Task&lt;IActionResult&gt; Index(string Name, string isType)\n        {\n            if (isType != null)\n            {\n                RedirectToAction(\"Index\",\"ProductsController\", new { type=Name });\n            }\n\n            var categories = await _context.Categories.\n                Where(c =&gt; (c.ParentCategory == Name)).ToListAsync();\n\n\n            return View(categories);\n        }\n</code></pre>\n\n<p>here is the html trying to route to the controller</p>\n\n<pre><code>   @* @(\"~/img/\"+item.CategoryName+\".jpg\") *@\n            &lt;a asp-action=\"index\" asp-route-name=\"@item.CategoryName\" asp-route-isType=\"@item.IsType\"&gt;\n                &lt;text&gt;@item.CategoryName&lt;/text&gt;\n            &lt;/a&gt;|\n</code></pre>\n\n<p>model definition</p>\n\n<pre><code>public class Category\n    {\n        public int CategoryID { get; set; }\n\n        public string CategoryName { get; set; }\n\n        public string Imgfilepath { get; set; }\n\n        public string ParentCategory { get; set; }\n\n        public string IsType { get; set; } \n\n    }\n\n</code></pre>\n\n<p>the strange thing to me is that the item.CategoryName getts passed fine but the isType attribute does not appear to be passed as it is always null when i check in the debugger.</p>\n"}, {"tags": ["c#", "postgresql", "entity-framework", "asp.net-core", "database-migration"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6911764, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_yNwxyUoP4o/AAAAAAAAAAI/AAAAAAAAAEs/ohw4Vym8Kxw/photo.jpg?sz=128", "display_name": "Denis Efimcev", "link": "https://stackoverflow.com/users/6911764/denis-efimcev"}, "is_accepted": false, "score": 0, "last_activity_date": 1562926056, "creation_date": 1562926056, "answer_id": 57004809, "question_id": 56974556, "link": "https://stackoverflow.com/questions/56974556/how-to-work-with-ef-postgresql-if-it-throw-null-value-in-column-reportid-pima/57004809#57004809", "title": "How to work with EF PostgreSQL if it throw null value in column &quot;ReportId&quot; (Pimary key) violates not-null constraint", "body": "<p>In pgAdmin i found that there is one of old migration was used it making problem for creating new report. Don't forget to check which migration are applied to database.</p>\n"}], "owner": {"reputation": 1, "user_id": 6911764, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_yNwxyUoP4o/AAAAAAAAAAI/AAAAAAAAAEs/ohw4Vym8Kxw/photo.jpg?sz=128", "display_name": "Denis Efimcev", "link": "https://stackoverflow.com/users/6911764/denis-efimcev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 948, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562926056, "creation_date": 1562774348, "question_id": 56974556, "link": "https://stackoverflow.com/questions/56974556/how-to-work-with-ef-postgresql-if-it-throw-null-value-in-column-reportid-pima", "title": "How to work with EF PostgreSQL if it throw null value in column &quot;ReportId&quot; (Pimary key) violates not-null constraint", "body": "<p>I'm trying to change database from SQLite to PostgreSQL.\nBut i'am getting error about non null primary key while creating new record in db. Though with SQLite it works fine.</p>\n\n<p>I did remove and regenerate migration for new database.</p>\n\n<p>ASP.NET Core 2.1.1\nEF 2.1.1\nNpgsql.EntityFrameworkCore.PostgreSQL 2.1.1</p>\n\n<p>SQL in pgAdmin</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>\n-- DROP TABLE public.\"Reports\";\n\nCREATE TABLE public.\"Reports\"\n(\n    \"ReportId\" integer NOT NULL,\n    \"ObjectName\" text COLLATE pg_catalog.\"default\",\n    \"PartName\" text COLLATE pg_catalog.\"default\",\n    \"Description\" text COLLATE pg_catalog.\"default\",\n    \"Image\" bytea,\n    \"Date\" timestamp with time zone,\n    CONSTRAINT \"PK_Reports\" PRIMARY KEY (\"ReportId\")\n)\nWITH (\n    OIDS = FALSE\n)\nTABLESPACE pg_default;\n\nALTER TABLE public.\"Reports\"\n    OWNER to postgres;\n</code></pre>\n\n<pre class=\"lang-cs prettyprint-override\"><code>//Model\n public class Report\n    {\n        [Key]\n        public int ReportId { get; set; }\n        public string ObjectName { get; set; }\n        public string PartName { get; set; }\n        public string Description { get; set; }\n        public byte[] Image { get; set; }\n        public DateTimeOffset? Date { get; set; }\n    }\n\n//Migration\n  public partial class InitialCreate : Migration\n    {\n        protected override void Up(MigrationBuilder migrationBuilder)\n        {\n            migrationBuilder.CreateTable(\n                name: \"Reports\",\n                columns: table =&gt; new\n                {\n                    ReportId = table.Column&lt;int&gt;(nullable: false)\n                        .Annotation(\"Npgsql:ValueGenerationStrategy\", NpgsqlValueGenerationStrategy.SerialColumn),\n                    ObjectName = table.Column&lt;string&gt;(nullable: true),\n                    PartName = table.Column&lt;string&gt;(nullable: true),\n                    Description = table.Column&lt;string&gt;(nullable: true),\n                    Image = table.Column&lt;byte[]&gt;(nullable: true),\n                    Date = table.Column&lt;DateTimeOffset&gt;(nullable: true)\n                },\n                constraints: table =&gt;\n                {\n                    table.PrimaryKey(\"PK_Reports\", x =&gt; x.ReportId);\n                });\n        }\n\n        protected override void Down(MigrationBuilder migrationBuilder)\n        {\n            migrationBuilder.DropTable(\n                name: \"Reports\");\n        }\n    }\n//Snapshot\n   [DbContext(typeof(ReportDbContext))]\n    [Migration(\"20190710072320_InitialCreate\")]\n    partial class InitialCreate\n    {\n        protected override void BuildTargetModel(ModelBuilder modelBuilder)\n        {\n#pragma warning disable 612, 618\n            modelBuilder\n                .HasAnnotation(\"Npgsql:ValueGenerationStrategy\", NpgsqlValueGenerationStrategy.SerialColumn)\n                .HasAnnotation(\"ProductVersion\", \"2.1.11-servicing-32099\")\n                .HasAnnotation(\"Relational:MaxIdentifierLength\", 63);\n\n            modelBuilder.Entity(\"BridgesWebApp.Models.Report\", b =&gt;\n                {\n                    b.Property&lt;int&gt;(\"ReportId\")\n                        .ValueGeneratedOnAdd();\n\n                    b.Property&lt;DateTimeOffset?&gt;(\"Date\");\n\n                    b.Property&lt;string&gt;(\"Description\");\n\n                    b.Property&lt;byte[]&gt;(\"Image\");\n\n                    b.Property&lt;string&gt;(\"ObjectName\");\n\n                    b.Property&lt;string&gt;(\"PartName\");\n\n                    b.HasKey(\"ReportId\");\n\n                    b.ToTable(\"Reports\");\n                });\n#pragma warning restore 612, 618\n        }\n    }\n//Code in Db Repository\npublic async Task CreateReport(Report report)\n        {\n            context.Reports.Add(report);\n            await context.SaveChangesAsync();\n        }\n</code></pre>\n\n<p>As i expect it should just set and icrement ReportId with generated migrations. But it throw error logs with:</p>\n\n<pre><code>fail: Microsoft.EntityFrameworkCore.Database.Command[20102]\n      Failed executing DbCommand (59ms) [Parameters=[@p0='?' (DbType = DateTimeOffset), @p1='?', @p2='?' (DbType = Binary), @p3='?', @p4='?'], CommandType='Text', CommandTimeout='30']\n      INSERT INTO \"Reports\" (\"Date\", \"Description\", \"Image\", \"ObjectName\", \"PartName\")\n      VALUES (@p0, @p1, @p2, @p3, @p4)\n      RETURNING \"ReportId\";\nNpgsql.PostgresException (0x80004005): 23502: null value in column \"ReportId\" violates not-null constraint\n   at Npgsql.NpgsqlConnector.&lt;&gt;c__DisplayClass161_0.&lt;&lt;ReadMessage&gt;g__ReadMessageLong|0&gt;d.MoveNext()\n--- End of stack trace from previous location where exception was thrown ---\n   at Npgsql.NpgsqlConnector.&lt;&gt;c__DisplayClass161_0.&lt;&lt;ReadMessage&gt;g__ReadMessageLong|0&gt;d.MoveNext()\n--- End of stack trace from previous location where exception was thrown ---\n   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming)\n   at Npgsql.NpgsqlCommand.ExecuteDbDataReader(CommandBehavior behavior, Boolean async, CancellationToken cancellationToken)\n   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)\nfail: Microsoft.EntityFrameworkCore.Update[10000]\n      An exception occurred in the database while saving changes for context type 'BridgesWebApp.Data.ReportDbContext'.\n      Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---&gt; Npgsql.PostgresException: 23502: null value in column \"ReportId\" violates not-null constraint\n</code></pre>\n"}, {"tags": ["c#", "observable", "system.reactive"], "comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1562801543, "post_id": 56974522, "comment_id": 100495505, "body": "You really should avoid coding the way you are - try to avoid mixing Tasks and Rx. Did you try using my (almost) pure Rx solution? Also the use of <code>RefCount()</code> can lead to fragile observables - you need to ensure that you always have at least one subscriber at all times for it to be useful."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1562802141, "post_id": 56974522, "comment_id": 100495601, "body": "Your code, as presented here, has a race condition. Any changes after <code>watcher.GetInitialData()</code> but before <code>watcher.StartFileWatcher</code> are lost. You really need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to debug your code. Otherwise try my code on your previous question and see if that causes the error to go away. (And don&#39;t use <code>RefCount()</code>.)"}], "owner": {"reputation": 4583, "user_id": 1122909, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c22139e8de1ae8f4cb359dd5c55750d0?s=128&d=identicon&r=PG&f=1", "display_name": "NZJames", "link": "https://stackoverflow.com/users/1122909/nzjames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562774657, "creation_date": 1562774222, "last_edit_date": 1562774657, "question_id": 56974522, "link": "https://stackoverflow.com/questions/56974522/race-condition-with-rx-using-buffer-and-startwith", "title": "Race condition with RX using Buffer and StartWith", "body": "<p>I am trying to initially load the contents of a log file and tick this on an observable of <code>LogTailData[]</code> - so if the initial file contents are 20k lines, the first tick should be an array of length 20k.</p>\n\n<p>After this, I want to buffer updates to the file by using a filewatcher and ticking back when a new line is received, buffering them up using RX.</p>\n\n<p>I am using <code>StartWith()</code> to load the initial file contents, then the Buffered Observable should feed the updates. </p>\n\n<p>However the problem I am having is if the initial data is large (eg 20k lines), then a file update seems to get ticked first on the observable, before the large array supplied by <code>StartWith</code>.</p>\n\n<p>I'm wondering if the way <code>Buffer()</code> works means that if the timer elapses before the <code>initialFileLines</code> can be put on the observable, then you'll receive them out of order?</p>\n\n<p>I need to guarantee that the initial data ticks first, regardless of how large the data set is.</p>\n\n<p>My code</p>\n\n<pre><code>var initialFileLines = watcher.GetInitialData();\n\nnew TaskFactory().StartNew(() =&gt; watcher.StartFileWatcher(data =&gt; watcherSubject.OnNext(data), _cts.Token));\n\nStream = watcherSubject.Buffer(TimeSpan.FromMilliseconds(500), 100)\n    .StartWith(initialFileLines)\n    .Replay()\n    .RefCount();\n</code></pre>\n"}, {"tags": ["c#", "lambda", "expression", "func"], "comments": [{"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 1, "creation_date": 1562774400, "post_id": 56974484, "comment_id": 100485315, "body": "It is a compiler trick. The compiler parses the lambda and converts it into an expression. It cannot do that with a delegate."}, {"owner": {"reputation": 853, "user_id": 160419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979ee669cf5b9536d64d14f4577cf5b1?s=128&d=identicon&r=PG", "display_name": "dezfowler", "link": "https://stackoverflow.com/users/160419/dezfowler"}, "edited": false, "score": 0, "creation_date": 1562774413, "post_id": 56974484, "comment_id": 100485329, "body": "Answered over here: <a href=\"https://stackoverflow.com/questions/767733\">stackoverflow.com/questions/767733</a>"}, {"owner": {"reputation": 4713, "user_id": 6357360, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/aed7990245e27bcf868d514f3ad014ff?s=128&d=identicon&r=PG&f=1", "display_name": "meJustAndrew", "link": "https://stackoverflow.com/users/6357360/mejustandrew"}, "reply_to_user": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1562774648, "post_id": 56974484, "comment_id": 100485446, "body": "@LasseV&#229;gs&#230;therKarlsen by now, I like your comment the most, I think it clears things up in a simple manner."}], "answers": [{"tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": true, "score": 0, "last_activity_date": 1562774411, "creation_date": 1562774411, "answer_id": 56974572, "question_id": 56974484, "link": "https://stackoverflow.com/questions/56974484/why-can-not-be-func-casted-to-expression-but-lambda-can/56974572#56974572", "title": "Why can not be Func casted to Expression, but lambda can", "body": "<p>A <code>Func&lt;int&gt;</code> is a delegate instance - an instance of an object; it no longer has any semantic state other than \"this target object reference, this method handle\".</p>\n\n<p>An <em>expression tree</em> is something <strong>much richer</strong>; it is a complex graph of the <em>intent</em> of code - essentially an AST. You can compile an expression to a delegate instance, but you cannot reverse a delegate to an expression tree.</p>\n\n<p>When you do:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>Expression&lt;Func&lt;int&gt;&gt; func = () =&gt; 2;\n</code></pre>\n\n<p>you are creating a complex tree; essentially:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var func = Expression.Lambda&lt;Func&lt;int&gt;&gt;(Expression.Constant(2, typeof(int)),\n    Array.Empty&lt;ParameterExpression&gt;());\n</code></pre>\n\n<p>(but much more complex in the general case, obviously)</p>\n"}], "owner": {"reputation": 4713, "user_id": 6357360, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/aed7990245e27bcf868d514f3ad014ff?s=128&d=identicon&r=PG&f=1", "display_name": "meJustAndrew", "link": "https://stackoverflow.com/users/6357360/mejustandrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1562774430, "accepted_answer_id": 56974572, "answer_count": 1, "score": 0, "last_activity_date": 1562774411, "creation_date": 1562774105, "question_id": 56974484, "link": "https://stackoverflow.com/questions/56974484/why-can-not-be-func-casted-to-expression-but-lambda-can", "closed_reason": "Duplicate", "title": "Why can not be Func casted to Expression, but lambda can", "body": "<p>In the example below, the same lambda can be hold as an <code>Expression</code> in <code>test</code> but it fails to compile when it comes form a <code>Func</code>:</p>\n\n<pre><code>Func&lt;int&gt; func = () =&gt; 2;\nExpression test1 = (Expression&lt;Func&lt;int&gt;&gt;)(() =&gt; 2);\nExpression test2 = (Expression&lt;Func&lt;int&gt;&gt;)(func); //does not compile\n</code></pre>\n\n<p>Why a lambda can be converted to an <code>Expression</code> directly, but not when it is represented as a <code>Func</code>?</p>\n"}, {"tags": ["c#", "azure", "asp.net-core", "azure-authentication"], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 7667946, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f9fc29466bc93772bc7e90fd2f6d4b1e?s=128&d=identicon&r=PG&f=1", "display_name": "kristech", "link": "https://stackoverflow.com/users/7667946/kristech"}, "is_accepted": false, "score": 0, "last_activity_date": 1562775630, "creation_date": 1562775630, "answer_id": 56974882, "question_id": 56974456, "link": "https://stackoverflow.com/questions/56974456/azure-ad-authentication-redirect-loop-cookie-error-when-using-two-apps/56974882#56974882", "title": "Azure AD authentication redirect loop (cookie error) when using two apps", "body": "<p>This would be a matter of registering both apps separately in the Azure AD Portal. This will give you a different client ID. Use the different client ID for each app.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rCcLi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rCcLi.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 537, "user_id": 3230946, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dd45e83b9c306129540c39aa8923d04?s=128&d=identicon&r=PG&f=1", "display_name": "MatiasK", "link": "https://stackoverflow.com/users/3230946/matiask"}, "is_accepted": true, "score": 0, "last_activity_date": 1563367245, "creation_date": 1563367245, "answer_id": 57076091, "question_id": 56974456, "link": "https://stackoverflow.com/questions/56974456/azure-ad-authentication-redirect-loop-cookie-error-when-using-two-apps/57076091#57076091", "title": "Azure AD authentication redirect loop (cookie error) when using two apps", "body": "<p>I solved the cookie mix up by adding</p>\n\n<pre><code>builder.UsePathBase( \"/portal\" );\n</code></pre>\n\n<p>to the portal branch of the pipeline</p>\n\n<pre><code>private void HandlePortalRequest( IApplicationBuilder builder )\n{            \n    builder.UsePathBase( \"/portal\" ); // the fix!\n\n    builder.UseAuthentication();\n\n    builder.UseMvc( routes =&gt;\n    {\n        routes.MapRoute(\n            name: \"default\",\n            template: \"{controller=Portal}/{action=Index}/{id?}\" );\n    } );\n}\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 3230946, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dd45e83b9c306129540c39aa8923d04?s=128&d=identicon&r=PG&f=1", "display_name": "MatiasK", "link": "https://stackoverflow.com/users/3230946/matiask"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 57076091, "answer_count": 2, "score": 0, "last_activity_date": 1563367245, "creation_date": 1562774007, "question_id": 56974456, "link": "https://stackoverflow.com/questions/56974456/azure-ad-authentication-redirect-loop-cookie-error-when-using-two-apps", "title": "Azure AD authentication redirect loop (cookie error) when using two apps", "body": "<p>I have two asp.net core web applications (using the same application registration id) protected with Azure AD. If I log in to one, the authentication flow breaks for the other, but not the other way around.</p>\n\n<p>I think it has something to do with the authentication cookies and that the Admin app picks upp the one created for the Portal app. If this assumption is correct, how do I make sure the apps don't use each others cookies?</p>\n\n<p><strong>Setup</strong></p>\n\n<ul>\n<li>App 1, a Portal with a forked pipeline\n\n<ul>\n<li><a href=\"http://localhost:5001/\" rel=\"nofollow noreferrer\">http://localhost:5001/</a> (no auth, just an info page)</li>\n<li><a href=\"http://localhost:5001/portal\" rel=\"nofollow noreferrer\">http://localhost:5001/portal</a> (aad auth)</li>\n</ul></li>\n<li>App 2, an Admin page\n\n<ul>\n<li><a href=\"https://localhost:6001/admin\" rel=\"nofollow noreferrer\">https://localhost:6001/admin</a> (aad auth)</li>\n</ul></li>\n</ul>\n\n<p><strong>Test cases</strong></p>\n\n<pre><code>OK : Load Admin and log in\nOK : Load Portal and log in\nNOK: Load the Portal and log in, navigate to Admin (auth loop)         \nNOK: Load Admin and log in,\n        navigate to Portal (credentials not requested, reusing the cookie i guess), \n        reload Admin (auth loop)\n</code></pre>\n\n<p>The Admin app reports the following error and creates an authentication redirect loop.\n    <em>Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: Cookies was not authenticated. Failure message: Unprotect ticket failed</em></p>\n\n<p><strong>Startup.cs for the Portal app</strong></p>\n\n<pre><code>public class Startup\n{\n    public Startup( IConfiguration configuration )\n    {\n        Configuration = configuration;\n    }\n\n    public IConfiguration Configuration { get; }\n\n    public void ConfigureServices( IServiceCollection services )\n    {\n        services.AddAuthentication( o =&gt;\n            {\n                o.DefaultScheme = CookieAuthenticationDefaults.AuthenticationScheme;\n                o.DefaultChallengeScheme = OpenIdConnectDefaults.AuthenticationScheme;\n            }\n        ).AddOpenIdConnect( o =&gt;\n            {\n                o.SignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;\n\n                o.ClientId = \"same-for-both-apps\";\n                o.CallbackPath = \"/portal/signin-oidc\";\n                o.Authority = \"https://login.windows.net/common\";\n                o.TokenValidationParameters = new TokenValidationParameters\n                {\n                    RoleClaimType = ClaimTypes.Role,\n                    ValidateIssuer = false,\n                };\n            }\n        ).AddCookie( options =&gt;\n            { options.AccessDeniedPath = new PathString( \"/Account/AccessDenied\" ); } );\n\n        services.AddMvc( o =&gt;\n            {\n                o.Filters.Add( new AuthorizeFilter(\n                                    new AuthorizationPolicyBuilder()\n                                    .RequireAuthenticatedUser()\n                                    .Build() ) );\n\n            }\n        ).SetCompatibilityVersion( CompatibilityVersion.Version_2_2 );\n    }\n\n    public void Configure( IApplicationBuilder app, IHostingEnvironment env )\n    {\n        app.MapWhen( IsTargetingPortal, HandlePortalRequest );\n\n        app.Run( async ctx =&gt;\n        {\n            await ctx.Response.WriteAsync( \"Default: info page\" );\n        } );\n    }\n\n    bool IsTargetingPortal( HttpContext ctx )\n    {\n        return ctx.Request.Path == \"/portal/signin-oidc\" ||\n               ctx.Request.Path == \"/portal\" ||\n               ctx.Request.Host.Host.StartsWith( \"portal.\" );\n    }\n\n    void HandlePortalRequest( IApplicationBuilder builder )\n    {\n        builder.UseAuthentication();\n        builder.UseMvc( routes =&gt;\n        {\n            routes.MapRoute(\n                name: \"default\",\n                template: \"{controller=Home}/{action=Index}/{id?}\" );\n        } );\n    }\n}\n</code></pre>\n\n<p><strong>Startup.cs for the Admin app</strong></p>\n\n<pre><code>public class Startup\n{\n\n    public Startup( IConfiguration configuration )\n    {\n        Configuration = configuration;\n    }\n\n    public IConfiguration Configuration { get; }\n\n    public void ConfigureServices( IServiceCollection services )\n    {\n        services.AddAuthentication( o =&gt;\n            {\n                o.DefaultScheme = CookieAuthenticationDefaults.AuthenticationScheme;\n                o.DefaultChallengeScheme = OpenIdConnectDefaults.AuthenticationScheme;\n            } \n        ).AddOpenIdConnect( o =&gt;\n            {\n                o.SignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;\n\n                o.ClientId = \"same-for-both-apps\";                    \n                o.Authority = \"https://login.windows.net/common\";\n                o.TokenValidationParameters = new TokenValidationParameters\n                {\n                    RoleClaimType = ClaimTypes.Role,\n                    ValidateIssuer = false,\n                };\n            } \n        ).AddCookie( options =&gt; \n            { options.AccessDeniedPath = new PathString( \"/Account/AccessDenied\" ); } );\n\n        services.AddMvc( o =&gt;\n            {\n                o.Filters.Add( new AuthorizeFilter( \n                                    new AuthorizationPolicyBuilder()\n                                    .RequireAuthenticatedUser()\n                                    .Build() ) );\n\n            } \n        ).SetCompatibilityVersion( CompatibilityVersion.Version_2_2 );\n    }\n\n    public void Configure( IApplicationBuilder app, IHostingEnvironment env )\n    {\n        app.UsePathBase( \"/admin\" );\n\n        if( env.IsDevelopment() )\n        {\n            app.UseDeveloperExceptionPage();\n        }\n        else\n        {\n            app.UseExceptionHandler( \"/Error\" );\n            app.UseHsts();\n        }\n\n        app.UseAuthentication();\n        app.UseMvc();\n    }\n}\n</code></pre>\n"}]