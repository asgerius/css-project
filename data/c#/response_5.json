[{"tags": ["c#", "multithreading", "visual-studio", "visual-studio-2012", "breakpoints"], "answers": [{"comments": [{"owner": {"reputation": 856, "user_id": 4250150, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-KLzePzmbqTs/AAAAAAAAAAI/AAAAAAAAAD8/henWhVuLqE4/photo.jpg?sz=128", "display_name": "sudo rm -rf slash", "link": "https://stackoverflow.com/users/4250150/sudo-rm-rf-slash"}, "edited": false, "score": 0, "creation_date": 1557395405, "post_id": 28790478, "comment_id": 98754034, "body": "In fact it is possible to break in a single thread. Windows calls this &quot;SuspendThread&quot;, Visual Studio calls it &quot;freeze/thaw&quot;ing, and you&#39;ve called it halting... Open debug &gt; windows &gt; threads and play around.  Also see <a href=\"https://stackoverflow.com/a/6513021/4250150\">stackoverflow.com/a/6513021/4250150</a>"}], "tags": [], "owner": {"reputation": 305, "user_id": 1397153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11b911e84c5712e7f7e0548d5be3b32f?s=128&d=identicon&r=PG", "display_name": "Newell Clark", "link": "https://stackoverflow.com/users/1397153/newell-clark"}, "is_accepted": true, "score": 3, "last_activity_date": 1425188006, "creation_date": 1425188006, "answer_id": 28790478, "question_id": 28466835, "link": "https://stackoverflow.com/questions/28466835/keep-secondary-threads-running-while-debugging-with-visual-studio/28790478#28790478", "title": "Keep Secondary Threads Running While Debugging With Visual Studio", "body": "<p>Okay, it seems that whenever you hit a break-point in a process, <em>all</em> threads in that process halt, and there doesn't seem to be any way of overriding that behavior. \nThe only way to do what I'm trying to do is to create a second <code>Process</code>, and have that <code>Process</code> be responsible for sending the virtual key-presses to Visual Studio, via an external API call. </p>\n\n<p>Obviously you'll have to have some way of communicating between the main process and the key-pressing process. I looked around and I found that <a href=\"https://msdn.microsoft.com/en-us/library/vstudio/bb546102(v=vs.100).aspx\" rel=\"nofollow\">Anonymous Pipes</a> are probably the best method for communicating between two processes running on the same machine. </p>\n"}, {"tags": [], "owner": {"reputation": 9478, "user_id": 452845, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/4gZfv.jpg?s=128&g=1", "display_name": "Eric Ouellet", "link": "https://stackoverflow.com/users/452845/eric-ouellet"}, "is_accepted": false, "score": 0, "last_activity_date": 1617820899, "creation_date": 1617820899, "answer_id": 66992280, "question_id": 28466835, "link": "https://stackoverflow.com/questions/28466835/keep-secondary-threads-running-while-debugging-with-visual-studio/66992280#66992280", "title": "Keep Secondary Threads Running While Debugging With Visual Studio", "body": "<p>I know it's an old reference and my answer arrive a lot too late but just to let you know... I think it still apply: <a href=\"https://docs.microsoft.com/en-us/archive/blogs/jmstall/you-cant-debug-yourself\" rel=\"nofollow noreferrer\">You can't debug yourself</a></p>\n"}], "owner": {"reputation": 305, "user_id": 1397153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11b911e84c5712e7f7e0548d5be3b32f?s=128&d=identicon&r=PG", "display_name": "Newell Clark", "link": "https://stackoverflow.com/users/1397153/newell-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1742, "favorite_count": 2, "accepted_answer_id": 28790478, "answer_count": 2, "score": 8, "last_activity_date": 1617820899, "creation_date": 1423698550, "last_edit_date": 1423701494, "question_id": 28466835, "link": "https://stackoverflow.com/questions/28466835/keep-secondary-threads-running-while-debugging-with-visual-studio", "title": "Keep Secondary Threads Running While Debugging With Visual Studio", "body": "<p>I'm making an application that will send step-over key-presses to Visual Studio to enable it to take screenshots of part of its own code being executed line-by-line. </p>\n\n<p>But it seems when you hit a break-point in your code, ALL threads stop, even ones that haven't hit a break-point. Is there any way around this? Is there some way to get Visual Studio to keep other threads running when I hit a break-point? Or do I have to resort to starting a separate process?</p>\n\n<p><strong>EDIT:</strong> To clarify, when the breakpoint is hit, I need to have execution stop <em>only</em> on the thread that hit the breakpoint. I am <em>not</em> looking to have the breakpoint only activate when hit by a certain thread. In other words, I need to have part of my program keep executing while one thread is stopped at a breakpoint in the debugger.</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3383479"}, "edited": false, "score": 0, "creation_date": 1423698412, "post_id": 28466793, "comment_id": 45259150, "body": "Could you paste the full path too?"}, {"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1423698517, "post_id": 28466793, "comment_id": 45259185, "body": "the <code>File</code> class doesn&#39;t work with virtual paths."}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 0, "creation_date": 1423698572, "post_id": 28466793, "comment_id": 45259195, "body": "Your path here will always be the bit after the <code>:</code> and will be output directly to the browser with the <code>~</code> prefix. That will not work."}, {"owner": {"reputation": 66, "user_id": 3609885, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dbb1e26833d631601f4a85227a880756?s=128&d=identicon&r=PG&f=1", "display_name": "user3609885", "link": "https://stackoverflow.com/users/3609885/user3609885"}, "edited": false, "score": 0, "creation_date": 1423698574, "post_id": 28466793, "comment_id": 45259197, "body": "In the path string is that: &quot;~/Content/Images/image_preview.jpg&quot;"}, {"owner": {"reputation": 2556, "user_id": 1078115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1367de9b160ef7aa9b2a183ed1a931bb?s=128&d=identicon&r=PG", "display_name": "Marko", "link": "https://stackoverflow.com/users/1078115/marko"}, "edited": false, "score": 0, "creation_date": 1423698792, "post_id": 28466793, "comment_id": 45259263, "body": "You need to use the html helper &lt;img src=&quot;@Url.Content(&#39;&#39;)&quot;&gt; since &quot;~/Content&quot; is not a valid url path for the image."}], "answers": [{"comments": [{"owner": {"reputation": 66, "user_id": 3609885, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dbb1e26833d631601f4a85227a880756?s=128&d=identicon&r=PG&f=1", "display_name": "user3609885", "link": "https://stackoverflow.com/users/3609885/user3609885"}, "edited": false, "score": 0, "creation_date": 1423700106, "post_id": 28466902, "comment_id": 45259710, "body": "I do what you wrote, now i see image &quot;image_preview.jpg&quot; :) but path all time has &quot;image_preview.jpg&quot; string instead &quot;ProductId.jpg&quot; for example &quot;1.jpg&quot;"}], "tags": [], "owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "is_accepted": true, "score": 0, "last_activity_date": 1423698847, "creation_date": 1423698847, "answer_id": 28466902, "question_id": 28466793, "link": "https://stackoverflow.com/questions/28466793/how-to-paste-path-from-string-to-src-img-mark-in-asp-net-mvc-5/28466902#28466902", "title": "How to paste path from string to src img mark in asp.net mvc 5", "body": "<p>You need to map your paths to a real file before using the <code>File.Exists</code> function. Use the <a href=\"https://msdn.microsoft.com/en-us/library/system.web.mvc.urlhelper.content%28v=vs.118%29.aspx\" rel=\"nofollow\"><code>Url.Content()</code></a> function to convert the path with <code>~</code> prefix to an actual location on the system.</p>\n\n<pre><code>@foreach (var element in Model) {\n    string testPath = Url.Content(\"~/Content/Images/\" + element.ProductId + \".jpg\"));  \n    string path = File.Exists(testPath) ? testPath : Url.Content(\"~/Content/Images/image_preview.jpg\");\n\n    &lt;img src=\"@path\" class=\"pull-left img-thumbnail\" height=\"100\" width=\"100\" /&gt; }\n</code></pre>\n"}], "owner": {"reputation": 66, "user_id": 3609885, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/dbb1e26833d631601f4a85227a880756?s=128&d=identicon&r=PG&f=1", "display_name": "user3609885", "link": "https://stackoverflow.com/users/3609885/user3609885"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 28466902, "answer_count": 1, "score": -2, "last_activity_date": 1423698847, "creation_date": 1423698338, "question_id": 28466793, "link": "https://stackoverflow.com/questions/28466793/how-to-paste-path-from-string-to-src-img-mark-in-asp-net-mvc-5", "title": "How to paste path from string to src img mark in asp.net mvc 5", "body": "<p>I paste here a snippet of .cshtml code:</p>\n\n<pre><code>@foreach (var element in Model){  \nstring path = File.Exists(\"~/Content/Images/\" + element.ProductId + \".jpg\") ? (\"~/Content/Images/\" + element.ProductId + \".jpg\") : (\"~/Content/Images/image_preview.jpg\");\n\n    &lt;img src=@path class=\"pull-left img-thumbnail\" height=\"100\" width=\"100\" /&gt; }\n</code></pre>\n\n<p>I don't know why it dosen't work. In path is correct string, but image isn't displayed.</p>\n"}, {"tags": ["c#", "wpf", "xaml", "data-binding", "treeview"], "answers": [{"comments": [{"owner": {"reputation": 1375, "user_id": 1307149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/53a9cb83624414e7b2dbc360201c4568?s=128&d=identicon&r=PG", "display_name": "user1307149", "link": "https://stackoverflow.com/users/1307149/user1307149"}, "edited": false, "score": 0, "creation_date": 1423707817, "post_id": 28467654, "comment_id": 45261803, "body": "This almost has it, it shows all three levels, but the 2nd level string &quot;Name is missing&quot;?  The first level textblock is bound to a property called Name, the second level textblock should be bound to another property called name, and the third level should be bound to a textblock called ItemName.    The second level items are in the treeview, but the names are not displaying."}, {"owner": {"reputation": 1725, "user_id": 1043629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f352b06c3c95c9c7ca7609bd83d1664d?s=128&d=identicon&r=PG", "display_name": "nmaait", "link": "https://stackoverflow.com/users/1043629/nmaait"}, "reply_to_user": {"reputation": 1375, "user_id": 1307149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/53a9cb83624414e7b2dbc360201c4568?s=128&d=identicon&r=PG", "display_name": "user1307149", "link": "https://stackoverflow.com/users/1307149/user1307149"}, "edited": false, "score": 1, "creation_date": 1423708084, "post_id": 28467654, "comment_id": 45261872, "body": "So which items aren&#39;t displaying their <code>Name</code>?"}, {"owner": {"reputation": 1375, "user_id": 1307149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/53a9cb83624414e7b2dbc360201c4568?s=128&d=identicon&r=PG", "display_name": "user1307149", "link": "https://stackoverflow.com/users/1307149/user1307149"}, "edited": false, "score": 0, "creation_date": 1423708127, "post_id": 28467654, "comment_id": 45261882, "body": "I updated the question with a image at the bottom that shows the second level string Name missing.  I should be the name property from Children."}, {"owner": {"reputation": 1375, "user_id": 1307149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/53a9cb83624414e7b2dbc360201c4568?s=128&d=identicon&r=PG", "display_name": "user1307149", "link": "https://stackoverflow.com/users/1307149/user1307149"}, "edited": false, "score": 0, "creation_date": 1423708369, "post_id": 28467654, "comment_id": 45261941, "body": "Updated again with second image, Highlighted the item in the Treeview where string is missing.  When I expand the second level its shows correctly using your answer.  Upvoted your answer."}, {"owner": {"reputation": 1725, "user_id": 1043629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f352b06c3c95c9c7ca7609bd83d1664d?s=128&d=identicon&r=PG", "display_name": "nmaait", "link": "https://stackoverflow.com/users/1043629/nmaait"}, "reply_to_user": {"reputation": 1375, "user_id": 1307149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/53a9cb83624414e7b2dbc360201c4568?s=128&d=identicon&r=PG", "display_name": "user1307149", "link": "https://stackoverflow.com/users/1307149/user1307149"}, "edited": false, "score": 1, "creation_date": 1423708580, "post_id": 28467654, "comment_id": 45261992, "body": "Sounds to me like the binding to the Children object is correct so the issue has to be specifically with the <code>Name</code> property. Can you debug and confirm that <code>Name</code> has a value?"}, {"owner": {"reputation": 1375, "user_id": 1307149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/53a9cb83624414e7b2dbc360201c4568?s=128&d=identicon&r=PG", "display_name": "user1307149", "link": "https://stackoverflow.com/users/1307149/user1307149"}, "edited": false, "score": 0, "creation_date": 1423709499, "post_id": 28467654, "comment_id": 45262215, "body": "Yes it does, it is just not being bound to by a textblock."}], "tags": [], "owner": {"reputation": 1725, "user_id": 1043629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f352b06c3c95c9c7ca7609bd83d1664d?s=128&d=identicon&r=PG", "display_name": "nmaait", "link": "https://stackoverflow.com/users/1043629/nmaait"}, "is_accepted": true, "score": 1, "last_activity_date": 1423709991, "last_edit_date": 1423709991, "creation_date": 1423703938, "answer_id": 28467654, "question_id": 28466776, "link": "https://stackoverflow.com/questions/28466776/having-trouble-binding-to-a-treeview-in-wpf/28467654#28467654", "title": "Having trouble binding to a treeview in WPF", "body": "<p>The binding won't find <code>Children</code> because it is looking for it on a <code>PropertyInfo</code> object. <code>Children</code> and <code>TreeNodes</code> are siblings in the tree, there is no Child/Parent relationship between the two so the <code>HierarchicalDataTemplate</code> is broken when it tries to find the <code>Children</code> object that belongs to <code>PropertyInfo</code> object.</p>\n\n<p>If your object hierarchy is correct then you'll need a <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.data.compositecollection%28v=vs.110%29.aspx\" rel=\"nofollow\">CompositeCollection</a> that can combine the TreeNodes and Children objects into a single collection.</p>\n\n<pre><code>    private CompositeCollection _treeNodeChildCollections;\n    public CompositeCollection TreeNodeChildCollections\n    {\n        get\n        {\n            if (_treeNodeChildCollections == null)\n            {\n                _treeNodeChildCollections = new CompositeCollection();\n                var cc1 = new CollectionContainer();\n                cc1.Collection = Children;\n                var cc2 = new CollectionContainer();\n                cc2.Collection = TreeNodes;\n\n                _treeNodeChildCollections.Add(cc1);\n                _treeNodeChildCollections.Add(cc2);\n            }\n\n            return _treeNodeChildCollections;\n        }\n    }\n</code></pre>\n\n<p>Then bind to that in the xaml.</p>\n\n<pre><code>    &lt;TreeView ItemsSource=\"{Binding TreeViewItems}\"&gt;\n        &lt;TreeView.ItemTemplate&gt;\n            &lt;HierarchicalDataTemplate ItemsSource=\"{Binding TreeNodeChildCollections}\"&gt;\n                &lt;TextBlock Text=\"{Binding Name}\" /&gt;\n                &lt;HierarchicalDataTemplate.ItemTemplate&gt;\n                    &lt;HierarchicalDataTemplate ItemsSource=\"{Binding DataPackets}\"&gt;\n                        &lt;TextBlock Text=\"{Binding Name}\"/&gt;\n                        &lt;HierarchicalDataTemplate.ItemTemplate&gt;\n                            &lt;DataTemplate&gt;\n                                &lt;TextBlock Text=\"{Binding ItemName}\"/&gt;\n                            &lt;/DataTemplate&gt;\n                        &lt;/HierarchicalDataTemplate.ItemTemplate&gt;\n                    &lt;/HierarchicalDataTemplate&gt;\n                &lt;/HierarchicalDataTemplate.ItemTemplate&gt;\n            &lt;/HierarchicalDataTemplate&gt;\n        &lt;/TreeView.ItemTemplate&gt;\n    &lt;/TreeView&gt;\n</code></pre>\n"}], "owner": {"reputation": 1375, "user_id": 1307149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/53a9cb83624414e7b2dbc360201c4568?s=128&d=identicon&r=PG", "display_name": "user1307149", "link": "https://stackoverflow.com/users/1307149/user1307149"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "accepted_answer_id": 28467654, "answer_count": 1, "score": 0, "last_activity_date": 1423709991, "creation_date": 1423698216, "last_edit_date": 1592644375, "question_id": 28466776, "link": "https://stackoverflow.com/questions/28466776/having-trouble-binding-to-a-treeview-in-wpf", "title": "Having trouble binding to a treeview in WPF", "body": "<p>I am trying to make a treeview that represents data from a file. The file data has data packets organized into three different sections: Header Info, Operation Header, and Operation Data. The packets in Header Info and Operation Header are one level deep, while the packets in Operation Data are grouped into lists so I thought it'd be easier to organize by making it go an extra level. That way you could pop open Data, see the lists, and pop those open to see individual data packets.</p>\n<p>This is my xaml:</p>\n<pre><code>&lt;TreeView ItemsSource=&quot;{Binding TreeViewItems}&quot;&gt;\n            &lt;TreeView.ItemTemplate&gt;\n                &lt;HierarchicalDataTemplate ItemsSource=&quot;{Binding TreeNodes}&quot;&gt;\n                    &lt;TextBlock Text=&quot;{Binding Name}&quot; /&gt;\n\n                    &lt;HierarchicalDataTemplate.ItemTemplate&gt;\n                        &lt;HierarchicalDataTemplate ItemsSource=&quot;{Binding Children}&quot;&gt;\n                            &lt;TextBlock Text=&quot;{Binding Name}&quot; /&gt;\n                            \n                                    &lt;HierarchicalDataTemplate.ItemTemplate&gt;\n                                        &lt;HierarchicalDataTemplate&gt;\n                                            &lt;TextBlock Text=&quot;{Binding DataPackets.ItemName}&quot;/&gt;                                                 \n                                        &lt;/HierarchicalDataTemplate&gt;\n                                    &lt;/HierarchicalDataTemplate.ItemTemplate&gt;\n\n                        &lt;/HierarchicalDataTemplate&gt;\n                    &lt;/HierarchicalDataTemplate.ItemTemplate&gt;\n\n                &lt;/HierarchicalDataTemplate&gt;\n            &lt;/TreeView.ItemTemplate&gt;\n        &lt;/TreeView&gt;\n</code></pre>\n<p>And here is the code we are trying to bind to the hierarchical datatemplates:</p>\n<pre><code>                var childData = new Children();\n\n                result.OperationData.ToList().ForEach(x =&gt; childData.DataPackets.Add(x));\n\n                \n                if (result.HeaderInfo.Any())\n                {\n                    TreeViewItems.Add(new TreePair() { TreeNodes = result.HeaderInfoProperties.ToList(), Name = &quot;Header Info&quot; });\n                }\n                TreeViewItems.Add(new TreePair() { TreeNodes = result.OperationHeaderProperties.ToList(), Name = &quot;Operation Header&quot; });\n                TreeViewItems.Add(new TreePair() { TreeNodes = result.OperationDataProperties.ToList(), Children = new List&lt;Children&gt; {childData}, Name = &quot;Operation Data&quot; });\n</code></pre>\n<p>and the classes</p>\n<pre><code>public class TreePair\n    {\n        \n\n        public TreePair()\n        {               \n            TreeNodes = new List&lt;PropertyInfo&gt;();\n            Children = new List&lt;Children&gt;();\n        }\n\n        public List&lt;Children&gt; Children { get; set; }\n\n        public List&lt;PropertyInfo&gt; TreeNodes { get; set; }\n\n        public string Name { get; set; }\n    }\n\n    public class Children\n    {\n        public Children()\n        {\n            DataPackets = new List&lt;DataPacketBase&gt;();\n        }\n\n        public string Name { get; set; }\n\n        public List&lt;DataPacketBase&gt; DataPackets { get; set; }\n    }\n</code></pre>\n<p>I have the data packets for Header info and operation header showing up, as well as the list names for Operation data but none of the child packets show up. They exist in the Children.DataPackets object.</p>\n<p>This is throwing in the output window:\nBindingExpression path error: 'Children' property not found on 'object'</p>\n<p>The second TextBlock is correct, but the Children ItemSource Is not being found, but the list is being filled with items.</p>\n<p><img src=\"https://i.stack.imgur.com/ePLf3.png\" alt=\"enter image description here\" /></p>\n<p>Children Name property Missing From Second Level</p>\n<p><img src=\"https://i.stack.imgur.com/ynVNW.png\" alt=\"enter image description here\" /></p>\n"}, {"tags": ["c#", "inheritance", "interface", "mvvm-light", "observablecollection"], "comments": [{"owner": {"reputation": 26629, "user_id": 206394, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/67b588ca896693bf58fa04dc13917d1d?s=128&d=identicon&r=PG", "display_name": "Dan Bryant", "link": "https://stackoverflow.com/users/206394/dan-bryant"}, "edited": false, "score": 2, "creation_date": 1423699100, "post_id": 28466709, "comment_id": 45259375, "body": "You can create a wrapper implementing IList that routes calls to the underlying collection.  This could also take care of partially emulating indexing (assuming Xamarin uses this) with ElementAt.  This breaks down if the consuming implementation tries to do insertion, though, since you cannot perform random-access insertion; you would need to reconstruct the entire Collection in that case by removing everything, then adding it back again."}], "answers": [{"tags": [], "owner": {"reputation": 59791, "user_id": 467473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af668442ab8ce6408bd051b350d89c01?s=128&d=identicon&r=PG", "display_name": "Nicholas Carey", "link": "https://stackoverflow.com/users/467473/nicholas-carey"}, "is_accepted": true, "score": 4, "last_activity_date": 1423701446, "last_edit_date": 1423701446, "creation_date": 1423701093, "answer_id": 28467234, "question_id": 28466709, "link": "https://stackoverflow.com/questions/28466709/make-icollection-work-as-ilist/28467234#28467234", "title": "Make ICollection work as IList", "body": "<p>Since there is no guarantee that an arbitrary <code>ICollection&lt;T&gt;</code> is also an <code>IList&lt;T&gt;</code>, the easiest way is to use the <a href=\"http://sourcemaking.com/design_patterns/adapter\" rel=\"nofollow\">Adapter Pattern</a>: Write a thin shim that provides the interface that you need (<code>IList&lt;T&gt;</code>).</p>\n\n<p><code>IList&lt;T&gt;</code> is a pretty simple interface and you should be able to do something along these lines (see example below), though one might note that <code>IList&lt;T&gt;</code> provides certain features that are simply not compatible with arbitrary <code>ICollection&lt;T&gt;</code> implementations. Depending on what specific <code>IList&lt;T&gt;</code> features the consumer(s) use, you may throw <code>NotSupportedException</code>s.</p>\n\n<p>One might also note that you could get a little smarter in your adapter and use <em>reflection</em> to interrogate the backing store for its actual capabilities &mdash; my example below does a simple version, trying to cast the backing store to <code>IList&lt;T&gt;</code> and using that knowledge where it can.</p>\n\n<pre><code>class ListAdapter&lt;T&gt; : IList&lt;T&gt;\n{\n    private readonly ICollection&lt;T&gt; backingStore;\n    private readonly IList&lt;T&gt; list;\n\n    public ListAdapter( ICollection&lt;T&gt; collection )\n    {\n        if ( collection == null ) throw new ArgumentNullException(\"collection\");\n        this.backingStore = collection ;\n        this.list = collection as IList&lt;T&gt; ;\n\n    }\n\n    public int IndexOf( T item )\n    {\n        if ( list == null ) throw new NotSupportedException() ;\n        return list.IndexOf(item) ;\n    }\n\n    public void Insert( int index , T item )\n    {\n        if ( list == null ) throw new NotSupportedException() ;\n        list.Insert(index,item);\n    }\n\n    public void RemoveAt( int index )\n    {\n        if ( list == null ) throw new NotSupportedException() ;\n        list.RemoveAt(index) ;\n    }\n\n    public T this[int index]\n    {\n        get\n        {\n            if ( list == null ) throw new NotSupportedException() ;\n            return list[index] ;\n        }\n        set\n        {\n            if ( list == null ) throw new NotSupportedException() ;\n            list[index] = value ;\n        }\n    }\n\n    public void Add( T item )\n    {\n        backingStore.Add(item) ;\n    }\n\n    public void Clear()\n    {\n        backingStore.Clear() ;\n    }\n\n    public bool Contains( T item )\n    {\n        return backingStore.Contains(item) ;\n    }\n\n    public void CopyTo( T[] array , int arrayIndex )\n    {\n        backingStore.CopyTo( array , arrayIndex ) ;\n    }\n\n    public int Count\n    {\n        get { return backingStore.Count ; }\n    }\n\n    public bool IsReadOnly\n    {\n        get\n        {\n            if ( list == null ) throw new NotSupportedException() ;\n            return list.IsReadOnly ;\n        }\n    }\n\n    public bool Remove( T item )\n    {\n        return backingStore.Remove(item) ;\n    }\n\n    public IEnumerator&lt;T&gt; GetEnumerator()\n    {\n        return backingStore.GetEnumerator() ;\n    }\n\n    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()\n    {\n        return ((System.Collections.IEnumerable)backingStore).GetEnumerator() ;\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 1367121, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/4a2c2d99085817b290619200cd1bf818?s=128&d=identicon&r=PG", "display_name": "Matthew Yang", "link": "https://stackoverflow.com/users/1367121/matthew-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 28467234, "answer_count": 1, "score": 0, "last_activity_date": 1423701446, "creation_date": 1423697908, "question_id": 28466709, "link": "https://stackoverflow.com/questions/28466709/make-icollection-work-as-ilist", "title": "Make ICollection work as IList", "body": "<p>I am trying to use MvvmLight to do ViewModel binding in Xamarin Android</p>\n\n<p>MvvmLight accepts IList as a parameter for data-binding, but all the viewmodels are using ICollection (The app was initially windows only and currently migrating to Android, we cannot change the ICollection to IList)</p>\n\n<p>I know IList extends ICollection, so..I guess this is more of a pattern-ish thing, what is the best way that we make those ICollection work as IList?</p>\n\n<p>Casting is the obvious solution, but not all ICollection implements IList so we are trying to avoid that</p>\n\n<p>We also cannot make a copy of the original collection because we need two-way binding</p>\n"}, {"tags": ["c#", "android", "xamarin", "xamarin.android", "mvvmcross"], "comments": [{"owner": {"reputation": 65706, "user_id": 373321, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4b5c15250cb89971e0642129fae0473f?s=128&d=identicon&r=PG", "display_name": "Stuart", "link": "https://stackoverflow.com/users/373321/stuart"}, "edited": false, "score": 0, "creation_date": 1423756051, "post_id": 28466708, "comment_id": 45285664, "body": "where&#39;s the actual binding? I can&#39;t see it in the question currently. Is there a simple project that repros it anywhere? Is there any clue on what &quot;sometimes&quot; means - any pattern you&#39;ve managed to spot?"}, {"owner": {"reputation": 894, "user_id": 1571994, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b77eacadc2cd5a8037d9e0632829547e?s=128&d=identicon&r=PG", "display_name": "BayssMekanique", "link": "https://stackoverflow.com/users/1571994/bayssmekanique"}, "reply_to_user": {"reputation": 65706, "user_id": 373321, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/4b5c15250cb89971e0642129fae0473f?s=128&d=identicon&r=PG", "display_name": "Stuart", "link": "https://stackoverflow.com/users/373321/stuart"}, "edited": false, "score": 0, "creation_date": 1423769857, "post_id": 28466708, "comment_id": 45294327, "body": "@Stuart I&#39;ve updated the question with some additional deatail, the view being inflated, and the trace line from VS."}], "owner": {"reputation": 894, "user_id": 1571994, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b77eacadc2cd5a8037d9e0632829547e?s=128&d=identicon&r=PG", "display_name": "BayssMekanique", "link": "https://stackoverflow.com/users/1571994/bayssmekanique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 661, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423770318, "creation_date": 1423697906, "last_edit_date": 1423770318, "question_id": 28466708, "link": "https://stackoverflow.com/questions/28466708/android-fragment-dispose-causes-crash-sometimes", "title": "Android Fragment Dispose causes crash (sometimes)", "body": "<p>I have a an MvxDialogFragment (Mvvmcross) which when closed, sometimes causes a Fatal Error.</p>\n\n<p>The class:</p>\n\n<pre><code>namespace Keiser.IPS.Screen.Droid.Views\n{\n    using Android.App;\n    using Android.Content;\n    using Android.OS;\n    using Android.Widget;\n    using Cirrious.MvvmCross.Binding.Droid.BindingContext;\n    using Cirrious.MvvmCross.Binding.Droid.Views;\n    using Cirrious.MvvmCross.Droid.Fragging.Fragments;\n    using Keiser.IPS.Screen.Core.ViewModels;\n    using System;\n\n    public class SettingsView : MvxDialogFragment\n    {\n        protected Android.Views.View InflatedView;\n\n        public bool IsOpen { get; protected set; }\n\n        public override Dialog OnCreateDialog(Bundle savedState)\n        {\n            base.EnsureBindingContextSet(savedState);\n            IsOpen = true;\n\n            SettingsViewModel.SystemSettingsEvent += GoToSystemSettings;\n            SettingsViewModel.OnUpdateEvent += DoingUpdate;\n\n            InflatedView = this.BindingInflate(Resource.Layout.SettingsView, null);\n            CheckDemoSection();\n            CheckLicenseSection();\n            CheckUpdateSection();\n\n            MvxSpinner languageSpinner = InflatedView.FindViewById&lt;MvxSpinner&gt;(Resource.Id.LanguageSpinner);\n            languageSpinner.Focusable = true;\n            languageSpinner.FocusableInTouchMode = true;\n\n            AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(Activity, Resource.Style.Theme_Dialog);\n            alertDialogBuilder.SetTitle(SettingsViewModel.GetText(\"GeneralSettings\"));\n            alertDialogBuilder.SetView(InflatedView);\n            alertDialogBuilder.SetNegativeButton(SettingsViewModel.GetText(\"Cancel\"), delegate { Cancel(); });\n            alertDialogBuilder.SetPositiveButton(SettingsViewModel.GetText(\"Save\"), delegate { Save(); });\n            return alertDialogBuilder.Create();\n        }\n\n        protected SettingsViewModel SettingsViewModel { get { return ViewModel as SettingsViewModel; } }\n\n        protected void Save()\n        {\n            SettingsViewModel.SaveSettings();\n            IsOpen = false;\n        }\n\n        protected void Cancel()\n        {\n            IsOpen = false;\n        }\n\n        public override void OnCancel(IDialogInterface dialog)\n        {\n            base.OnCancel(dialog);\n            Cancel();\n        }\n\n        protected void CheckLicenseSection()\n        {\n            if (!SettingsViewModel.ShowLicenseSection)\n                InflatedView.FindViewById&lt;LinearLayout&gt;(Resource.Id.SettingsContainer).RemoveView(InflatedView.FindViewById&lt;LinearLayout&gt;(Resource.Id.LicenseContainer));\n        }\n\n        protected void CheckDemoSection()\n        {\n            if (!SettingsViewModel.ShowDemoSection)\n                InflatedView.FindViewById&lt;LinearLayout&gt;(Resource.Id.SettingsContainer).RemoveView(InflatedView.FindViewById&lt;TextView&gt;(Resource.Id.DemoModeLabel));\n            else\n                InflatedView.FindViewById&lt;TextView&gt;(Resource.Id.DemoModeLabel).Text += \": \" + SettingsViewModel.GetText(\"On\");\n        }\n\n        protected void CheckUpdateSection()\n        {\n            if (!SettingsViewModel.SoftwareManagerService.SoftwareManager.UpdateAvailable)\n                InflatedView.FindViewById&lt;LinearLayout&gt;(Resource.Id.SettingsContainer).RemoveView(InflatedView.FindViewById&lt;LinearLayout&gt;(Resource.Id.UpdateContainer));\n        }\n\n        protected void GoToSystemSettings(object s, EventArgs e)\n        {\n            StartActivityForResult(new Intent(Android.Provider.Settings.ActionSettings, null), 0);\n        }\n\n        protected void DoingUpdate(object s, EventArgs e)\n        {\n            new AlertDialog.Builder(Activity).SetMessage(SettingsViewModel.GetText(\"UpdatingMessage\")).Show();\n        }\n\n    }\n}\n</code></pre>\n\n<p>View being infalted:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:local=\"http://schemas.android.com/apk/res-auto\"\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"&gt;\n    &lt;LinearLayout\n        android:orientation=\"vertical\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"match_parent\"\n        android:paddingBottom=\"5dp\"\n        android:id=\"@+id/SettingsContainer\"&gt;\n        &lt;TextView\n            local:MvxLang=\"Text Language\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\" /&gt;\n        &lt;Mvx.MvxSpinner\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"?android:attr/listPreferredItemHeight\"\n            local:MvxBind=\"ItemsSource Languages; SelectedItem Language\"\n            android:id=\"@+id/LanguageSpinner\" /&gt;\n        &lt;TextView\n            local:MvxLang=\"Text Theme\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\" /&gt;\n        &lt;Mvx.MvxSpinner\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"?android:attr/listPreferredItemHeight\"\n            local:MvxBind=\"ItemsSource Themes; SelectedItem Theme\"\n            android:id=\"@+id/ThemeSpinner\" /&gt;\n        &lt;TextView\n            local:MvxLang=\"Text Legend\"\n            android:layout_width=\"fill_parent\"\n            android:layout_height=\"wrap_content\" /&gt;\n        &lt;Switch\n            local:MvxBind=\"Checked Legend\"\n            android:layout_width=\"wrap_content\"\n            android:layout_height=\"wrap_content\"\n            android:layout_marginTop=\"6dp\"\n            android:layout_marginBottom=\"11dp\"\n            local:MvxLang=\"TextOn On; TextOff Off\" /&gt;\n        &lt;TextView\n            local:MvxLang=\"Text DemoMode\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:paddingTop=\"20dp\"\n            android:id=\"@+id/DemoModeLabel\" /&gt;\n        &lt;TextView\n            local:MvxBind=\"Text SoftwareCode\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:paddingTop=\"20dp\"\n            android:id=\"@+id/CodeLabel\" /&gt;\n        &lt;TextView\n            local:MvxBind=\"Text SoftwareVersion\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:paddingTop=\"20dp\"\n            android:id=\"@+id/VersionLabel\" /&gt;\n        &lt;LinearLayout\n            android:orientation=\"vertical\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:paddingTop=\"20dp\"\n            android:id=\"@+id/LicenseContainer\"&gt;\n            &lt;TextView\n                local:MvxLang=\"Text LicenseKey\"\n                android:layout_width=\"match_parent\"\n                android:layout_height=\"wrap_content\"\n                android:id=\"@+id/LicenseKeyLabel\" /&gt;\n            &lt;EditText\n                local:MvxBind=\"Text LicenseKey; TextColor LicenseKeyColor\"\n                android:layout_width=\"match_parent\"\n                android:layout_height=\"wrap_content\"\n                android:maxLines=\"1\" /&gt;\n        &lt;/LinearLayout&gt;\n        &lt;LinearLayout\n            android:orientation=\"vertical\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:paddingTop=\"10dp\"\n            android:id=\"@+id/SystemSettingsContainer\"&gt;\n            &lt;Button\n                local:MvxLang=\"Text SystemSettings\"\n                local:MvxBind=\"Click GoToSystemSettings\"\n                android:layout_width=\"match_parent\"\n                android:layout_height=\"wrap_content\" /&gt;\n        &lt;/LinearLayout&gt;\n        &lt;LinearLayout\n            android:orientation=\"vertical\"\n            android:layout_width=\"match_parent\"\n            android:layout_height=\"wrap_content\"\n            android:paddingTop=\"10dp\"\n            android:id=\"@+id/UpdateContainer\"&gt;\n            &lt;Button\n                local:MvxLang=\"Text Update\"\n                local:MvxBind=\"Click DoUpdateCommand; Enabled CanDoUpdate\"\n                android:layout_width=\"match_parent\"\n                android:layout_height=\"wrap_content\" /&gt;\n        &lt;/LinearLayout&gt;\n    &lt;/LinearLayout&gt;\n&lt;/LinearLayout&gt;\n</code></pre>\n\n<p>And the stack trace:</p>\n\n<pre><code>02-12 07:14:52.504: E/mono-rt(21076): [ERROR] FATAL UNHANDLED EXCEPTION: System.ArgumentException: 'jobject' must not be IntPtr.Zero.\n02-12 07:14:52.504: E/mono-rt(21076): Parameter name: jobject\n02-12 07:14:52.504: E/mono-rt(21076):   at Android.Runtime.JNIEnv.CallVoidMethod (IntPtr jobject, IntPtr jmethod, Android.Runtime.JValue[] parms) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Android.Views.View.SetOnClickListener (IOnClickListener l) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Android.Views.View+&lt;&gt;c__AnonStorey7.&lt;&gt;m__0 (IOnClickListener __v) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Java.Interop.EventHelper.RemoveEventHandler[IOnClickListener,IOnClickListenerImplementor] (System.WeakReference&amp; implementor, System.Func`2 empty, System.Action`1 unsetListener, System.Action`1 remove) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Android.Views.View.remove_Click (System.EventHandler value) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.MvvmCross.Binding.Droid.Target.MvxViewClickBinding.Dispose (Boolean isDisposing) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.MvvmCross.Binding.Bindings.MvxBinding.Dispose () [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.MvvmCross.Binding.Bindings.MvxFullBinding.ClearTargetBinding () [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.MvvmCross.Binding.Bindings.MvxFullBinding.Dispose (Boolean isDisposing) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.MvvmCross.Binding.Bindings.MvxBinding.Dispose () [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.MvvmCross.Binding.BindingContext.MvxBindingContext.ClearAllViewBindings () [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.MvvmCross.Binding.BindingContext.MvxBindingContext.ClearAllBindings () [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.MvvmCross.Droid.Fragging.Fragments.MvxBindingFragmentAdapter.HandleDestroyViewCalled (System.Object sender, System.EventArgs e) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.CrossCore.Core.MvxDelegateExtensionMethods.Raise (System.EventHandler eventHandler, System.Object sender) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Cirrious.MvvmCross.Droid.Fragging.Fragments.EventSource.MvxEventSourceDialogFragment.OnDestroyView () [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Keiser.IPS.Screen.Droid.Views.SettingsView.OnDestroyView () [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at Android.Support.V4.App.Fragment.n_OnDestroyView (IntPtr jnienv, IntPtr native__this) [0x00000] in &lt;filename unknown&gt;:0 \n02-12 07:14:52.504: E/mono-rt(21076):   at (wrapper dynamic-method) object:4bb261f4-79d8-4e2d-80ec-785ea7b637ce (intptr,intptr)\n</code></pre>\n\n<p>It appears to me that an event handler is being removed from by the <code>MvxViewClickBinding.Dispose</code> method and that at some point in that process, the object is disappearing?  There is a check at the <code>MvxViewClickBinding.  Dispose</code> method to check if the object being touched still exists, so that leads me to think that somewhere lower down in the Android stack it is disappearing.</p>\n\n<p>I've been fighting this for weeks, so if you have a suggestion, please let me know!</p>\n\n<hr>\n\n<h2>Edit 1</h2>\n\n<p>I've added the view which is being inflated during the <code>OnCreateDialog</code> method.</p>\n\n<p>What I mean by sometimes is that 9 out of 10 times the dialog closes without issue, but occasionally it will cause the app to crash.  I have seen it crash using both of the on screen buttons, as well as using an off dialog click or back button.</p>\n\n<p>Here's the trace from within VS 2013:</p>\n\n<pre><code>02-13 03:22:37.084 W/InputEventReceiver(11572): Attempted to finish an input event but the input event receiver has already been disposed.\nAn unhandled exception occured.\n</code></pre>\n\n<p>I can cause it every time if I trigger a GC immediately after the <code>OnDestroy</code> or <code>OnClose</code> methods.</p>\n\n<p>It looks like the <code>MvxViewClickBinding.Dispose</code> method is pretty straight forward, so I'm not certain that this is an Mvx error.  It seems like something in the Android V4 Support library.</p>\n\n<p>Here is the trace.txt file from the device: <a href=\"https://gist.github.com/bayssmekanique/af33048a94350a819f13\" rel=\"nofollow\">https://gist.github.com/bayssmekanique/af33048a94350a819f13</a></p>\n"}, {"tags": ["c#", "dependency-injection", "asp.net-mvc-5", "asp.net-mvc-routing", "unity-container"], "comments": [{"owner": {"reputation": 10823, "user_id": 1567352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bdfeb44480b0de2237a5fe8001b8233b?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Green", "link": "https://stackoverflow.com/users/1567352/brendan-green"}, "edited": false, "score": 0, "creation_date": 1423715473, "post_id": 28466703, "comment_id": 45263706, "body": "Don&#39;t you need to (or, have you) set the <code>DependencyResolver</code>? e.g. <code>DependencyResolver.SetResolver(new UnityDependencyResolver(container));</code>"}, {"owner": {"reputation": 11561, "user_id": 613605, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/998f50cbd33e0f514d679aa82f34f61d?s=128&d=identicon&r=PG", "display_name": "J86", "link": "https://stackoverflow.com/users/613605/j86"}, "reply_to_user": {"reputation": 10823, "user_id": 1567352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bdfeb44480b0de2237a5fe8001b8233b?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Green", "link": "https://stackoverflow.com/users/1567352/brendan-green"}, "edited": false, "score": 0, "creation_date": 1423732488, "post_id": 28466703, "comment_id": 45270686, "body": "That is already done in <code>UnityMvcActivator.cs</code> in this line <code>DependencyResolver.SetResolver(new UnityDependencyResolver(container));</code>"}, {"owner": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "edited": false, "score": 1, "creation_date": 1423739405, "post_id": 28466703, "comment_id": 45274986, "body": "Getting a 404 sounds more like you have a routing problem than a problem with DI."}, {"owner": {"reputation": 11561, "user_id": 613605, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/998f50cbd33e0f514d679aa82f34f61d?s=128&d=identicon&r=PG", "display_name": "J86", "link": "https://stackoverflow.com/users/613605/j86"}, "edited": false, "score": 0, "creation_date": 1423739883, "post_id": 28466703, "comment_id": 45275274, "body": "Added Routing code, I thought so too, but can&#39;t figure out anything wrong with the route!"}], "answers": [{"comments": [{"owner": {"reputation": 11561, "user_id": 613605, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/998f50cbd33e0f514d679aa82f34f61d?s=128&d=identicon&r=PG", "display_name": "J86", "link": "https://stackoverflow.com/users/613605/j86"}, "edited": false, "score": 0, "creation_date": 1423778772, "post_id": 28480893, "comment_id": 45299053, "body": "I actually meant to write that, but missed it due to copy / pasting the default. Thanks NightOwl :)"}], "tags": [], "owner": {"reputation": 50853, "user_id": 181087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85700c2c160866ef6924fc491a3ce574?s=128&d=identicon&r=PG", "display_name": "NightOwl888", "link": "https://stackoverflow.com/users/181087/nightowl888"}, "is_accepted": true, "score": 1, "last_activity_date": 1517352652, "last_edit_date": 1517352652, "creation_date": 1423753617, "answer_id": 28480893, "question_id": 28466703, "link": "https://stackoverflow.com/questions/28466703/accountcontroller-in-mvc-5-and-unity-ioc/28480893#28480893", "title": "AccountController in MVC 5 and Unity IoC", "body": "<p>As I suspected, the problem is with your routes.</p>\n\n<p>Think of routes like a switch case statement in c#. The issue you have is that whenever the first route encounters <em>any</em> 3 segment route, it will <em>always</em> match. Therefore, any normal <code>/controller/action/id</code> will never hit your default route. </p>\n\n<p>There needs to be either 1 or more constraints and/or 1 or more explicit segments in the route in order to ensure it <em>doesn't</em> match at some point, or you have basically made an unreachable execution path.</p>\n\n<p>Here is an example with an explicit segment.</p>\n\n<pre><code>routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\nroutes.MapRoute(\n    name: \"Artist\",\n    url: \"Artist/{urlfriendly}/{action}\",\n    defaults: new { controller = \"Artist\", action = \"Index\" }\n);\n\nroutes.MapRoute(\n    name: \"Default\",\n    url: \"{controller}/{action}/{id}\",\n    defaults: new { controller = \"Home\", action = \"Index\", id = UrlParameter.Optional }\n);\n</code></pre>\n"}], "owner": {"reputation": 11561, "user_id": 613605, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/998f50cbd33e0f514d679aa82f34f61d?s=128&d=identicon&r=PG", "display_name": "J86", "link": "https://stackoverflow.com/users/613605/j86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 0, "accepted_answer_id": 28480893, "answer_count": 1, "score": 3, "last_activity_date": 1517352652, "creation_date": 1423697892, "last_edit_date": 1517352590, "question_id": 28466703, "link": "https://stackoverflow.com/questions/28466703/accountcontroller-in-mvc-5-and-unity-ioc", "title": "AccountController in MVC 5 and Unity IoC", "body": "<p>I have created a new ASP.NET MVC 5 project with Individual User Authentication in place. I have then gone ahead and installed Unity IoC as a package and configured that by doing the following inside <code>UnityConfig.cs</code>:</p>\n\n<pre><code>public static void RegisterTypes(IUnityContainer container)\n{\n    container.RegisterTypes(AllClasses.FromLoadedAssemblies(), WithMappings.FromMatchingInterface, WithName.Default);\n    container.RegisterType&lt;AccountController&gt;(new InjectionConstructor());\n}\n</code></pre>\n\n<p>From stuff I read through  Google, this should take care of the fact that Unity would pick the constructor with most parameters. My <code>AccountController.cs</code> has the following two constructors.</p>\n\n<pre><code>private ApplicationSignInManager _signInManager;\nprivate ApplicationUserManager _userManager;\n\npublic AccountController()\n{\n}\n\npublic AccountController(ApplicationUserManager userManager, ApplicationSignInManager signInManager )\n{\n    UserManager = userManager;\n    SignInManager = signInManager;\n}\n</code></pre>\n\n<p>But still I am experiencing problems. When I navigate to <code>http://localhost:xxxx/account/login</code> I get a <strong>404 Error</strong>!</p>\n\n<p>Here is my <code>RouteConfig.cs</code></p>\n\n<pre><code>routes.IgnoreRoute(\"{resource}.axd/{*pathInfo}\");\n\nroutes.MapRoute(\n    name: \"Artist\",\n    url: \"{controller}/{urlfriendly}/{action}\",\n    defaults: new { controller = \"Artist\", action = \"Index\" }\n);\n\nroutes.MapRoute(\n    name: \"Default\",\n    url: \"{controller}/{action}/{id}\",\n    defaults: new { controller = \"Home\", action = \"Index\", id = UrlParameter.Optional }\n);\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "partial-views", "asp.net-mvc-partialview"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1423697828, "post_id": 28466651, "comment_id": 45258938, "body": "Derive all relevant models from a base model that only has the <code>PersonID</code> property and declare that base model for the partial view."}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 1, "creation_date": 1423697882, "post_id": 28466651, "comment_id": 45258961, "body": "Or make the entities implement the same interface."}, {"owner": {"reputation": 707, "user_id": 1697145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZsuvT.jpg?s=128&g=1", "display_name": "Tiedt Tech", "link": "https://stackoverflow.com/users/1697145/tiedt-tech"}, "edited": false, "score": 0, "creation_date": 1423698067, "post_id": 28466651, "comment_id": 45259023, "body": "would not be ugly interface with one property?"}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 2, "creation_date": 1423698263, "post_id": 28466651, "comment_id": 45259093, "body": "It&#39;s just an option, either way works well. I usually use inheritance on my entities as they usually have an <code>ID</code> property as a primary key. Also, an interface with only one property isn&#39;t ugly really. I have seen and used interfaces with no properties before."}], "answers": [{"tags": [], "owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "is_accepted": true, "score": 2, "last_activity_date": 1423698201, "creation_date": 1423698201, "answer_id": 28466774, "question_id": 28466651, "link": "https://stackoverflow.com/questions/28466651/html-partial-use-generic-class-for-the-same-property-in-different-classes/28466774#28466774", "title": "@HTML.Partial use generic class for the same property in different classes", "body": "<p>You can do this one of two ways (there are probably more ways, but these are likely the most common)</p>\n\n<hr>\n\n<p><strong>Option 1 - Interfaces</strong></p>\n\n<p>First create an interface class, for example:</p>\n\n<pre><code>public interface IPerson\n{\n    int PersonID { get; set; }\n}\n</code></pre>\n\n<p>Now for each entity that has a person ID, make it implement that interface:</p>\n\n<pre><code>public class SomeEntity : IPerson\n{\n    public int PersonID { get; set; }\n\n    //snip\n}\n</code></pre>\n\n<p>Now a view might look like this:</p>\n\n<pre><code>@model YourNamespace.IPerson\n\nThe person ID is @Model.PersonID\n</code></pre>\n\n<hr>\n\n<p><strong>Option 2 - Inheritance</strong></p>\n\n<p>Your base class:</p>\n\n<pre><code>public abstract class PersonBase\n{\n    public int PersonID { get; set; }\n}\n</code></pre>\n\n<p>And the entities inherit from the base like this:</p>\n\n<pre><code>public class SomeEntity : PersonBase\n{\n    //snip\n}\n</code></pre>\n\n<p>And your view is almost exactly the same:</p>\n\n<pre><code>@model YourNamespace.PersonBase\n\nThe person ID is @Model.PersonID\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 1697145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZsuvT.jpg?s=128&g=1", "display_name": "Tiedt Tech", "link": "https://stackoverflow.com/users/1697145/tiedt-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 28466774, "answer_count": 1, "score": 1, "last_activity_date": 1423698201, "creation_date": 1423697543, "question_id": 28466651, "link": "https://stackoverflow.com/questions/28466651/html-partial-use-generic-class-for-the-same-property-in-different-classes", "title": "@HTML.Partial use generic class for the same property in different classes", "body": "<p>I have in my project several classes that have the same property. Example: PersonID.</p>\n\n<p>This property is linked to Person table, I create a select box with two buttons. Instead of doing this to the views that have PersonID:</p>\n\n<pre><code>&lt;div class=\"col-md-12\"&gt;\n    @Html.LabelFor(m =&gt; m.PersonID) @Html.ValidationMessageFor(m =&gt; m.PersonID)\n    &lt;div class=\"input-group\"&gt;\n        @Html.DropDownList(\"PersonID\", (SelectList)ViewBag.ListPerson, String.Empty, new { @class = \"form-control\" })\n        &lt;span class=\"input-group-btn\"&gt;\n            &lt;button class=\"btn btn-default\"&gt;&lt;span class=\"glyphicon glyphicon-search\"&gt;&lt;/span&gt;&lt;/button&gt;\n        &lt;/span&gt;\n        &lt;span class=\"input-group-btn\"&gt;\n            &lt;button id=\"selectItem\" class=\"btn btn-warning\"&gt;&lt;span class=\"glyphicon glyphicon-check\"&gt;&lt;/span&gt;&lt;/button&gt;\n        &lt;/span&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>   </p>\n\n<p>Wanted to use the Partial:</p>\n\n<pre><code>@Html.Partial(\"~/Views/Frame/Person.cshtml\", Model) \n</code></pre>\n\n<h3>Question</h3>\n\n<p>How do I in Partial have a model, and use the model of View calling the Partial, which can be of different classes and the same property PersonID, and without having to make more of a Partial with the same HTML, , or not want to use <code>@model Project.Models.User</code>, and use a generic. </p>\n\n<h3>Partial</h3>\n\n<pre><code>@model Project.Models.User\n\n&lt;div class=\"col-md-12\"&gt;\n  @Html.LabelFor(m =&gt; m.PersonID) @Html.ValidationMessageFor(m =&gt; m.PersonID)\n  &lt;div class=\"input-group\"&gt;\n      @Html.DropDownList(\"PersonID\", (SelectList)ViewBag.ListPerson, String.Empty, new { @class = \"form-control\" })\n      &lt;span class=\"input-group-btn\"&gt;\n          &lt;button class=\"btn btn-default\"&gt;&lt;span class=\"glyphicon glyphicon-search\"&gt;&lt;/span&gt;&lt;/button&gt;\n      &lt;/span&gt;\n      &lt;span class=\"input-group-btn\"&gt;\n          &lt;button id=\"selectItem\" class=\"btn btn-warning\"&gt;&lt;span class=\"glyphicon glyphicon-check\"&gt;&lt;/span&gt;&lt;/button&gt;\n      &lt;/span&gt;\n  &lt;/div&gt;\n&lt;/div&gt;  \n</code></pre>\n"}, {"tags": ["c#", "algorithm", "int"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 2070595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/63fd19e56523f74f24a0fe238ffe41dc?s=128&d=identicon&r=PG", "display_name": "Danilo Bambi", "link": "https://stackoverflow.com/users/2070595/danilo-bambi"}, "edited": false, "score": 0, "creation_date": 1423698807, "post_id": 28466670, "comment_id": 45259267, "body": "Yes, I was thinking of something like that but since I&#39;m a little rusty in terms of array and loops, it was taking me more time than it should. I&#39;ll give it a read to that tutorial. Thank you so much!!!"}], "tags": [], "owner": {"reputation": 12849, "user_id": 1218281, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2a7d7e9fa2049d4dbf9a508e5eccdb0a?s=128&d=identicon&r=PG", "display_name": "Cyral", "link": "https://stackoverflow.com/users/1218281/cyral"}, "is_accepted": true, "score": 1, "last_activity_date": 1423697676, "creation_date": 1423697676, "answer_id": 28466670, "question_id": 28466645, "link": "https://stackoverflow.com/questions/28466645/get-single-digits-from-a-larger-number/28466670#28466670", "title": "Get single digits from a larger number", "body": "<p>You can simply loop through each character of the TextBox string and input it into an <code>int</code> array. Using an array is a much better approach than using individual variables.</p>\n\n<pre><code>string text = \"123456789\"; //Set to TextBox text\nint[] numbers = new int[text.Length]; //Create array of ints\nfor (int i = 0; i &lt; text.Length; i++)\n{\n    //Parse each character to an integer\n    numbers[i] = Int32.Parse(text[i].ToString());\n}\n</code></pre>\n\n<p>You may want to look at <a href=\"http://www.tutorialspoint.com/csharp/csharp_arrays.htm\" rel=\"nofollow\">this</a> array tutorial and loops if you are unfamiliar.</p>\n\n<p>With this code, you can now retrieve each number with:</p>\n\n<pre><code>int firstNumber = numbers[0];\nint secondNumber = numbers[1];\netc, etc\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21983, "user_id": 1283124, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/giogV.png?s=128&g=1", "display_name": "Ilya Ivanov", "link": "https://stackoverflow.com/users/1283124/ilya-ivanov"}, "edited": false, "score": 0, "creation_date": 1423698083, "post_id": 28466688, "comment_id": 45259029, "body": "You can always print numbers with <code>Console.WriteLine(string.Join(Environment.NewLine, nums));</code>"}, {"owner": {"reputation": 12849, "user_id": 1218281, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2a7d7e9fa2049d4dbf9a508e5eccdb0a?s=128&d=identicon&r=PG", "display_name": "Cyral", "link": "https://stackoverflow.com/users/1218281/cyral"}, "edited": false, "score": 0, "creation_date": 1423698120, "post_id": 28466688, "comment_id": 45259042, "body": "@AD.Net I retracted my vote, but you may want to add some additional information. OP does not seem familiar with arrays and may not know how this code works or how to access each element in <code>nums</code>."}, {"owner": {"reputation": 93, "user_id": 2070595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/63fd19e56523f74f24a0fe238ffe41dc?s=128&d=identicon&r=PG", "display_name": "Danilo Bambi", "link": "https://stackoverflow.com/users/2070595/danilo-bambi"}, "edited": false, "score": 0, "creation_date": 1423699177, "post_id": 28466688, "comment_id": 45259405, "body": "Thanks for the answer! I wasn&#39;t looking for the actual code since I always try to figure these things out by myself, but this was taking me too much time. I&#39;m a bit worn out in terms of arrays, but this was a really helpful reminder. I can&#39;t vote up since I don&#39;t have enough reputation, but I really appreciate the help from you guys!"}], "tags": [], "owner": {"reputation": 13022, "user_id": 693272, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/49ffa5199ff39ecaddefe2c34e6a9478?s=128&d=identicon&r=PG&f=1", "display_name": "AD.Net", "link": "https://stackoverflow.com/users/693272/ad-net"}, "is_accepted": false, "score": 0, "last_activity_date": 1423697772, "creation_date": 1423697772, "answer_id": 28466688, "question_id": 28466645, "link": "https://stackoverflow.com/questions/28466645/get-single-digits-from-a-larger-number/28466688#28466688", "title": "Get single digits from a larger number", "body": "<pre><code>string input = \"123456789\"; \n\nvar nums = \n(from i in input\nselect int.Parse(i.ToString())).ToList();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 2070595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/63fd19e56523f74f24a0fe238ffe41dc?s=128&d=identicon&r=PG", "display_name": "Danilo Bambi", "link": "https://stackoverflow.com/users/2070595/danilo-bambi"}, "edited": false, "score": 0, "creation_date": 1423699436, "post_id": 28466926, "comment_id": 45259486, "body": "Thanks! the second one seems more suitable for what I need. I appreciate the time you took to, not only answer my question, but also to give me three ways to do what I need. Thank you! And sorry if the question was too obvious, is the price I pay for being a newbie."}], "tags": [], "owner": {"reputation": 59791, "user_id": 467473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af668442ab8ce6408bd051b350d89c01?s=128&d=identicon&r=PG", "display_name": "Nicholas Carey", "link": "https://stackoverflow.com/users/467473/nicholas-carey"}, "is_accepted": false, "score": 0, "last_activity_date": 1423698953, "creation_date": 1423698953, "answer_id": 28466926, "question_id": 28466645, "link": "https://stackoverflow.com/questions/28466645/get-single-digits-from-a-larger-number/28466926#28466926", "title": "Get single digits from a larger number", "body": "<p>Well...a <code>TextBox</code> contains <em>text</em>: it has a <code>Text</code> property that returns a string representing the text box's content. C# strings are <code>IEnumerable&lt;char&gt;</code>: it should be pretty trivial to enumerate the characters in the string. Given <code>char c</code>, you can get its integer value as a decimal digit by evaluating <code>c-'0'</code>. If the result is within the domain 0&mdash;10, you've got a decimal digit.</p>\n\n<p>You could say something like this:</p>\n\n<pre><code>public static IEnumerable&lt;int&gt; TextDigits( this TextBox instance )\n{\n  foreach( char c in instance.Text )\n  {\n    int d = c - '0' ;'\n    if ( d &gt;= 0 &amp;&amp; d &lt;= 9 ) yield return value ;\n  }\n}\n</code></pre>\n\n<p>Or something like this:</p>\n\n<pre><code>public static IEnumerable&lt;int&gt; TextDigits( this TextBox instance )\n{\n  int value = int.Parse(instance.Text) ;\n  if ( value == 0 ) { yield return 0 ; }\n  while ( value != 0 )\n  {\n    int d = value % 10 ;\n    value /= 10 ;\n    yield return d ;\n  }\n}\n</code></pre>\n\n<p>Or you could say something like</p>\n\n<pre><code>TextBox tb ;\nint[] digits = tb\n               .Select( c =&gt; c - '0' )\n               .Where( c =&gt; c &gt;= 0 &amp;&amp; c &lt;= 9 )\n               .ToArray()\n               ;\n</code></pre>\n\n<p>There is...as they say...more than 1 way to get there from here.</p>\n"}], "owner": {"reputation": 93, "user_id": 2070595, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/63fd19e56523f74f24a0fe238ffe41dc?s=128&d=identicon&r=PG", "display_name": "Danilo Bambi", "link": "https://stackoverflow.com/users/2070595/danilo-bambi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2520, "favorite_count": 1, "accepted_answer_id": 28466670, "answer_count": 3, "score": -1, "last_activity_date": 1423698953, "creation_date": 1423697502, "last_edit_date": 1423697910, "question_id": 28466645, "link": "https://stackoverflow.com/questions/28466645/get-single-digits-from-a-larger-number", "title": "Get single digits from a larger number", "body": "<p>I have a question and I don't seem to get it right, is there a way to get single numbers from a larger one written on a textbox?\nFor example, I enter the number <code>123456789</code> in a textbox and I want to get all of those digits contained on that large number on 9 different, let's say ints, like this:</p>\n\n<pre><code>int firstNumber;\nint secondNumber;\nint thirdNumber;\nint fourthNumber;\nint fifthNumber;\nint sixNumber;\nint seventhNumber;\nint eighthNumber;\nint ninethNumber;   \n</code></pre>\n\n<p>is there a TextBox property to do it or do I have to write the algorithm for it?</p>\n"}, {"tags": ["c#", "powershell", "azure", "azure-storage", "hmac"], "answers": [{"comments": [{"owner": {"reputation": 2006, "user_id": 183223, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/83b6f829ab44f499ed67ad3d917b2ece?s=128&d=identicon&r=PG", "display_name": "Progger", "link": "https://stackoverflow.com/users/183223/progger"}, "edited": false, "score": 0, "creation_date": 1423755939, "post_id": 28468003, "comment_id": 45285571, "body": "This worked perfectly. I wanted to stab my eyes out yesterday. thank you!"}], "tags": [], "owner": {"reputation": 98670, "user_id": 188096, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hqrh.png?s=128&g=1", "display_name": "Gaurav Mantri", "link": "https://stackoverflow.com/users/188096/gaurav-mantri"}, "is_accepted": true, "score": 3, "last_activity_date": 1423710240, "last_edit_date": 1423710240, "creation_date": 1423706317, "answer_id": 28468003, "question_id": 28466625, "link": "https://stackoverflow.com/questions/28466625/authentication-failure-when-trying-to-list-shares-in-azure-files-service-using-p/28468003#28468003", "title": "Authentication Failure when trying to list shares in Azure Files service using PowerShell", "body": "<p>There were a few things I discovered:</p>\n\n<ul>\n<li><p><strong>Date/Time in UTC</strong></p>\n\n<p>$xmsdate = get-date<br>\n$xmsdate = $xmsdate.addhours(6)<br>\n$xmsdate = $xmsdate.toString('r')</p></li>\n</ul>\n\n<p>Since the date/time must be in UTC, a better way to do it would be like this:</p>\n\n<pre><code>$xmsdate = get-date\n$xmsdate = $xmsdate.ToUniversalTime()\n$xmsdate = $xmsdate.toString('r')\n</code></pre>\n\n<ul>\n<li><strong>\"\\n\" causes problem</strong></li>\n</ul>\n\n<p>Instead of using <code>\\n</code> for new line character, use \"$([char]10\" or \"`n\" (<a href=\"https://twitter.com/gmantri/status/565694148637097984\" rel=\"nofollow\">https://twitter.com/gmantri/status/565694148637097984</a>)</p>\n\n<pre><code>$newLine = $([char]10);\n$message = \"GET\" + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + \"x-ms-date:\" + $xmsdate + $newLine + \"x-ms-version:2014-02-14\" + $newLine + \"/\" + $accountname + \"/\" + $newLine + \"comp:list\";\n</code></pre>\n\n<ul>\n<li><p><strong>Use <code>Convert.FromBase64String</code> to convert account key into byte array</strong></p>\n\n<p>$hmacsha = New-Object System.Security.Cryptography.HMACSHA256;</p>\n\n<p>$hmacsha.key = [Convert]::FromBase64String($accesskey);</p></li>\n<li><p><strong>Query string parameters must be the same in both URL and signature calculation</strong>: In your case, you were including <code>timeout</code> parameter in signature calculation but it was not provided in the URL query string.</p></li>\n</ul>\n\n<p>Based on these, please try the script below:</p>\n\n<pre><code>$accountname = \"accountname\"\n$xmsdate = get-date\n$xmsdate = $xmsdate.ToUniversalTime()\n$xmsdate = $xmsdate.toString('r')\n$accesskey = 'accountkey'\n$newLine = $([char]10);\n$message = \"GET\" + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + $newLine + \"x-ms-date:\" + $xmsdate + $newLine + \"x-ms-version:2014-02-14\" + $newLine + \"/\" + $accountname + \"/\" + $newLine + \"comp:list\";\n$hmacsha = New-Object System.Security.Cryptography.HMACSHA256\n$hmacsha.key = [Convert]::FromBase64String($accesskey)\n$signature = $hmacsha.ComputeHash([Text.Encoding]::UTF8.GetBytes($message))\n$signature = [Convert]::ToBase64String($signature)\n$headers = New-Object \"System.Collections.Generic.Dictionary[[String],[String]]\"\n$headers.Add(\"x-ms-version\", \"2014-02-14\")\n$headers.Add(\"x-ms-date\", $xmsdate)\n$headers.Add(\"Authorization\", \"SharedKey \" + $accountname + \":\" + $signature)\n$uri = \"http://\" + $accountname + \".file.core.windows.net/?comp=list\"\ninvoke-restmethod -Uri $uri -Headers $headers\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22414, "user_id": 236131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e923fb41169d1fbc616d82896e547ad1?s=128&d=identicon&r=PG", "display_name": "ravikanth", "link": "https://stackoverflow.com/users/236131/ravikanth"}, "is_accepted": false, "score": 2, "last_activity_date": 1423709048, "creation_date": 1423709048, "answer_id": 28468389, "question_id": 28466625, "link": "https://stackoverflow.com/questions/28466625/authentication-failure-when-trying-to-list-shares-in-azure-files-service-using-p/28468389#28468389", "title": "Authentication Failure when trying to list shares in Azure Files service using PowerShell", "body": "<p>Newline character in PowerShell is `n and not \\n. :)</p>\n\n<pre><code>$message = \"GET`n`n`n`n`n`n`n`n`n`n`n`nx-ms-date:\" + $xmsdate + \"`nx-ms-version:2014-02-14`n/\" + $accountname + \"/ comp:list`nrestype:share`ntimeout:20\"\n</code></pre>\n"}], "owner": {"reputation": 2006, "user_id": 183223, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/83b6f829ab44f499ed67ad3d917b2ece?s=128&d=identicon&r=PG", "display_name": "Progger", "link": "https://stackoverflow.com/users/183223/progger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 28468003, "answer_count": 2, "score": 1, "last_activity_date": 1423710240, "creation_date": 1423697407, "question_id": 28466625, "link": "https://stackoverflow.com/questions/28466625/authentication-failure-when-trying-to-list-shares-in-azure-files-service-using-p", "title": "Authentication Failure when trying to list shares in Azure Files service using PowerShell", "body": "<p>I am trying to authenticate to Azure Files Preview using PowerShell by hitting the REST API with Invoke-RestMethod. I am doing my best to follow the instructions provided here: <a href=\"https://msdn.microsoft.com/en-us/library/azure/dd179428.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/azure/dd179428.aspx</a> </p>\n\n<p>This is my script:</p>\n\n<pre><code>$accountname = \"testaccount\"\n$xmsdate = get-date\n$xmsdate = $xmsdate.addhours(6)\n$xmsdate = $xmsdate.toString('r')\n$accesskey = 'lfksZQh0nasdfasd0KeMI+1alslv8ukK39Rsoelsldiq1r+zed9r4bH5uRyba+/QCwwvdGotw=='\n$message = \"GET\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nx-ms-date:\" + $xmsdate + \"\\nx-ms-version:2014-02-14\\n/\" + $accountname + \"/ comp:list\\nrestype:share\\ntimeout:20\"\n\n$hmacsha = New-Object System.Security.Cryptography.HMACSHA256\n$hmacsha.key = [Text.Encoding]::ASCII.GetBytes($accesskey)\n$signature = $hmacsha.ComputeHash([Text.Encoding]::ASCII.GetBytes($message))\n$signature = [Convert]::ToBase64String($signature)\n$headers = New-Object \"System.Collections.Generic.Dictionary[[String],[String]]\"\n$headers.Add(\"x-ms-version\", '2014-02-14')\n$headers.Add(\"x-ms-date\", $xmsdate)\n$headers.Add(\"Authorization\", \"SharedKey \" + $accountname + \":\" + $signature)\n$uri = \"http://\" + $accountname + \".file.core.windows.net/?comp=list\"\ninvoke-restmethod -Uri $uri -Headers $headers\n</code></pre>\n\n<p>The error I get is \"The MAC signature found in the HTTP request ... is not the same as any\ncomputed signature. Server used following string to sign: 'GET x-ms-date:Wed, 11 Feb 2015 23:25:06 GMT x-ms-version:2014-02-14 /testaccount/ comp:list\" </p>\n\n<p>I found the code which encrypts the message from here: <a href=\"https://gist.github.com/jokecamp/2c1a67b8f277797ecdb3\" rel=\"nofollow\">https://gist.github.com/jokecamp/2c1a67b8f277797ecdb3</a></p>\n"}, {"tags": ["c#", "oop", "architecture"], "comments": [{"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 0, "creation_date": 1423696696, "post_id": 28466433, "comment_id": 45258508, "body": "There&#39;s already a pattern for this: Model-View-ViewModel (MVVM). If you can use WPF, its <i>already</i> set up to use it."}, {"owner": {"reputation": 2573, "user_id": 263535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YreuO.png?s=128&g=1", "display_name": "Pieter Witvoet", "link": "https://stackoverflow.com/users/263535/pieter-witvoet"}, "edited": false, "score": 0, "creation_date": 1423697724, "post_id": 28466433, "comment_id": 45258900, "body": "To expand on what BradleyDotNET said: WPF contains a so-called &#39;data binding&#39; system. GUI elements can be given an object to observe. They&#39;ll read specific properties from that object and they&#39;ll refresh themselves when that object raises certain events (property-changed, collection-changed). Your GUI obviously needs to know something about what it&#39;s displaying, but not the other way around - the underlying objects don&#39;t need to know who or what is reacting to their events. You could swap or remove the GUI and the rest of your code would still work."}, {"owner": {"reputation": 375, "user_id": 1997732, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/404bf4f935286b6be33c6a5fa393721d?s=128&d=identicon&r=PG", "display_name": "Yuri Makassiouk", "link": "https://stackoverflow.com/users/1997732/yuri-makassiouk"}, "edited": false, "score": 0, "creation_date": 1423698768, "post_id": 28466433, "comment_id": 45259255, "body": "Pieter, absolutely, yes - GUI should know the objects it&#39;s playing with, but business objects should be possible to reuse with another presentation layer - that&#39;s the goal. Unfortunately, switching to WPF isn&#39;t an option at this time. Besides, I would suspect &quot;observing objects&quot; would come with an overhead. In my case the points of contact are quite few.. so I&#39;m sitting here wondering how to build something in this spirit, but with plain old winforms at the frontend and at a low cost."}], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 1997732, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/404bf4f935286b6be33c6a5fa393721d?s=128&d=identicon&r=PG", "display_name": "Yuri Makassiouk", "link": "https://stackoverflow.com/users/1997732/yuri-makassiouk"}, "is_accepted": false, "score": 1, "last_activity_date": 1423788884, "creation_date": 1423788884, "answer_id": 28490780, "question_id": 28466433, "link": "https://stackoverflow.com/questions/28466433/application-design-how-to-have-gui-respond-to-changes-in-data/28490780#28490780", "title": "Application design: how to have GUI respond to changes in data", "body": "<p>After reading M.Fowler's article here: <a href=\"http://martinfowler.com/eaaDev/SeparatedPresentation.html\" rel=\"nofollow\">http://martinfowler.com/eaaDev/SeparatedPresentation.html</a> </p>\n\n<p>and also a couple of texts on implementing the Observer pattern here\n<a href=\"http://www.codeproject.com/Tips/769084/Observer-Pattern-Csharp\" rel=\"nofollow\">http://www.codeproject.com/Tips/769084/Observer-Pattern-Csharp</a>\nand here\n<a href=\"http://www.codeproject.com/Articles/88278/Observer-in-NET-with-IObserver-T\" rel=\"nofollow\">http://www.codeproject.com/Articles/88278/Observer-in-NET-with-IObserver-T</a></p>\n\n<p>I ended up implementing a simplistic observer pattern with my data model as the subject (implemented in a base class) and the form as observer. </p>\n\n<p>To my personal taste it sort of makes the data object a bit more than a POCO than I wanted it to be, but hey, if it's good enough for Martin Fowler...</p>\n"}], "owner": {"reputation": 375, "user_id": 1997732, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/404bf4f935286b6be33c6a5fa393721d?s=128&d=identicon&r=PG", "display_name": "Yuri Makassiouk", "link": "https://stackoverflow.com/users/1997732/yuri-makassiouk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423788884, "creation_date": 1423696569, "question_id": 28466433, "link": "https://stackoverflow.com/questions/28466433/application-design-how-to-have-gui-respond-to-changes-in-data", "title": "Application design: how to have GUI respond to changes in data", "body": "<p>This is more of a design pattern question, so there will be no code and lots of words, please bear with me. I am writing a business application (in C#, using WinForms). There is a POCO-style object representing the set of data that user is currently working on - a \"document\" with all pertinent data. </p>\n\n<p>Business operations are implemented in application layer in a set of managers each responsible for its own aspect of the application.\nOne of the aspects is recalculation of certain summaries which are being persisted in object's data. The managers know which operations over the data may require recalculations and invoke them in appropriate times.</p>\n\n<p>GUI (WinForms) part is responsible for translating user's interactions into calls to the application layer. Let's say, you click on Add button, the click event locates the ObjectListManager class and calls manager.AddObject(...). Since ObjectListManager knows that this would require an update to the summary, it makes sure it is recalculated (by calling some other managers internally). </p>\n\n<p>What I would like to know is this. I need my GUI to refresh the summaries on the form. My first impulse is to set up a delegate placeholder (where?!), register a GUI-level method as a delegate for that callback and have this method called by the application layer. But I am not sure this does not contradict the abstraction of the business operations that I want to maintain keeping them agnostic of the GUI layer. \nOn the other hand, an alternative is to build this into the response to user interactions on the GUI level, i.e. the click on Add button should know that after a call to manager.AddObject(), it should query recalculated data and present it in the GUI. </p>\n\n<p>I lack some experience/knowledge and cannot figure out how to design this properly. \nThe long version of the answer is probably to finish reading the \"gang of four\" book, but if somebody can come up with good practical advice now, it would be much appreciated. </p>\n"}, {"tags": ["c#", "sql", "random", "entityspaces"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1423696708, "post_id": 28466428, "comment_id": 45258516, "body": "What language are you using? Please add a tag for the language."}, {"owner": {"reputation": 175, "user_id": 4522234, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/35cca317bcf652b12e18188bc2a00620?s=128&d=identicon&r=PG", "display_name": "Michael H", "link": "https://stackoverflow.com/users/4522234/michael-h"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1423697354, "post_id": 28466428, "comment_id": 45258760, "body": "Whoops, sorry about that. Added the C# tag."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 4522234, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/35cca317bcf652b12e18188bc2a00620?s=128&d=identicon&r=PG", "display_name": "Michael H", "link": "https://stackoverflow.com/users/4522234/michael-h"}, "edited": false, "score": 0, "creation_date": 1423775814, "post_id": 28466756, "comment_id": 45297594, "body": "Alright, so I added what I&#39;ve done so far to the original item above. Thank you for the indexer suggestion."}], "tags": [], "owner": {"reputation": 2425, "user_id": 3317709, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/11e9b6aa6a1698138be2a620ce1153e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi M Patel", "link": "https://stackoverflow.com/users/3317709/ravi-m-patel"}, "is_accepted": false, "score": 0, "last_activity_date": 1423829407, "last_edit_date": 1423829407, "creation_date": 1423698100, "answer_id": 28466756, "question_id": 28466428, "link": "https://stackoverflow.com/questions/28466428/need-to-pick-a-random-record-from-query-results/28466756#28466756", "title": "Need to pick a random record from query results", "body": "<h2>Update</h2>\n\n<p>I couldn't fully understand what you're trying to achieve in your updated code, however, here is my best guess of how it should be written, try it:</p>\n\n<pre><code>Random r = new Random();\nint winner = r.Next(0, erc.Count()-1);\nEmployeeRecognition er = erc[winner];\n</code></pre>\n\n<hr>\n\n<p>From the name <code>EmployeeRecognitionCollection</code>, it appears that it is a collection. If it is possible to debug, what you need to find out using quickwatch is that if it supports indexers. i.e is it ok to do erc[i]. If it is, then using Random on the indexer is fairly simple.</p>\n\n<p>If it doesn't support indexer, you may want to find out if it gives Count property. That way you can get enumerator, advance it i number of times, where i is a random number between 0 and Count-1. To advance you need to call </p>\n\n<p><code>erc.GetEnumerator().MoveNext()</code></p>\n"}], "owner": {"reputation": 175, "user_id": 4522234, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/35cca317bcf652b12e18188bc2a00620?s=128&d=identicon&r=PG", "display_name": "Michael H", "link": "https://stackoverflow.com/users/4522234/michael-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423829407, "creation_date": 1423696542, "last_edit_date": 1423775772, "question_id": 28466428, "link": "https://stackoverflow.com/questions/28466428/need-to-pick-a-random-record-from-query-results", "title": "Need to pick a random record from query results", "body": "<p>So I need to be able to pick a random record from a set of records that my query returns. I'm having an issue figuring out how to do this because I'm not sure what container the results are given to me in. I'm also using EntitySpaces for database persistence, so most of the DB interactivity comes from there.</p>\n\n<p>I've pasted the method that is supposed to do this below, with pseudocode where I'm having an issue.</p>\n\n<pre><code>    protected void btnChoose_Click(object sender, EventArgs e)\n{\n\n    DateTime? dateFrom = null;\n    DateTime? dateTo = null;\n\n    if (!string.IsNullOrWhiteSpace(dtDateTo.Text))\n    {\n        dateFrom = dtDateFrom.Text.ToDateTime().Value;\n    }\n    if (!string.IsNullOrWhiteSpace(dtDateTo.Text))\n    {\n        dateTo = dtDateTo.Text.ToDateTime().Value.EndOfDay();\n    }\n\n    EmployeeRecognitionCollection erc = EmployeeRecognitionCollection.GetAllCards(dateFrom, dateTo, null, null);\n\n    --&gt; I need to figure out what 'erc' actually is so I can figure out how to use Random() appropriately \n\n    --&gt; I've already verified that erc ends up containing the records that match the criteria in the query (in this case it's just a date range)\n\n}\n</code></pre>\n\n<p>I'd greatly appreciate any help. I'm not even sure what to Google at this point because of our use of EntitySpaces and how that seems to make virtually every normal solution not work.</p>\n\n<p>Thank you.</p>\n\n<p>UPDATE:</p>\n\n<p>So here's what I've come up with so far. Now the issue is that the <code>if</code> statements are evaluating as false when I know there should be values that correspond to these in the collection.</p>\n\n<pre><code>    EmployeeRecognitionCollection erc = EmployeeRecognitionCollection.GetAllCards(dateFrom, dateTo, null, null);\n\n    int minRecords = 0;\n    int maxRecords = 0;\n\n    if (erc[0].ToInteger().HasValue)\n    {\n        minRecords = erc[0].ToInteger().Value;\n    }\n    if (erc[erc.Count() - 1].ToInteger().HasValue)\n    {\n        maxRecords = erc[erc.Count() -1].ToInteger().Value;\n    }\n\n    Random r = new Random();\n    int winner = r.Next(minRecords, maxRecords);\n\n    EmployeeRecognition er = erc[winner];\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c#", "asp.net", "linq", "entity-framework", "ef-code-first"], "answers": [{"comments": [{"owner": {"reputation": 78, "user_id": 2218390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f4ceef9aa5b6b971e43685d0ee4021?s=128&d=identicon&r=PG", "display_name": "mrburnttoast79", "link": "https://stackoverflow.com/users/2218390/mrburnttoast79"}, "edited": false, "score": 0, "creation_date": 1423849268, "post_id": 28473267, "comment_id": 45330130, "body": "Thanks that worked. I knew it had to be something simple like that."}], "tags": [], "owner": {"reputation": 21093, "user_id": 150342, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15059b386eb3a25b97852a9a6e2d20ac?s=128&d=identicon&r=PG", "display_name": "Colin", "link": "https://stackoverflow.com/users/150342/colin"}, "is_accepted": true, "score": 2, "last_activity_date": 1423731894, "creation_date": 1423731894, "answer_id": 28473267, "question_id": 28466424, "link": "https://stackoverflow.com/questions/28466424/how-can-i-solve-this-system-data-entity-dynamicproxies-error/28473267#28473267", "title": "How can I solve this &quot;System.Data.Entity.DynamicProxies&quot; error", "body": "<p>It's a while since I used ASP.NET WebForms, but I think your problem is here:</p>\n\n<pre><code>ql.DataValueField = Convert.ToString(choice.ChoiceId);\nql.DataTextField = choice.ChoiceText;\n</code></pre>\n\n<p>I think that <code>Convert.ToString(choice.ChoiceId)</code> is telling the control to use a property named \"4\".</p>\n\n<p>Try this:</p>\n\n<pre><code>ql.DataValueField = \"ChoiceId\";\nql.DataTextField = \"ChoiceText\";\n</code></pre>\n\n<p>i.e. you need to specify the name of the property to use, not the value</p>\n"}], "owner": {"reputation": 78, "user_id": 2218390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4f4ceef9aa5b6b971e43685d0ee4021?s=128&d=identicon&r=PG", "display_name": "mrburnttoast79", "link": "https://stackoverflow.com/users/2218390/mrburnttoast79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19915, "favorite_count": 2, "accepted_answer_id": 28473267, "answer_count": 1, "score": 4, "last_activity_date": 1423731894, "creation_date": 1423696529, "question_id": 28466424, "link": "https://stackoverflow.com/questions/28466424/how-can-i-solve-this-system-data-entity-dynamicproxies-error", "title": "How can I solve this &quot;System.Data.Entity.DynamicProxies&quot; error", "body": "<p>I am new to Linq and EF Code First and came across an issue that I just can't figure out.  I am developing a proof of concept examination program using ASP.Net Web Forms, EF Code First and Linq.  The ideas is that I generate the page's server controls dynamically based on the database.  I've built this same application before without EF but was hoping to learn that on this project.  I can get the correct results if I use a literal but am receiving an error while databinding a RadioButtonList.</p>\n\n<pre><code>DataBinding: 'System.Data.Entity.DynamicProxies.Choice_EA448AD48C19F54FBB6BF09B7A03BA899DBE75EC189635A8982E7C3B1D8F4ABD' does not contain a property with the name '4'.\n\nLine 34:                 content.Controls.Add(ql);\nLine 35:                 ql.DataSource = choices;\nLine 36:                 ql.DataBind();            \nLine 37:         }\n</code></pre>\n\n<p>The property with the name of '4' is just a value from my database.  I'm not sure if this problem is related to Lazy Loading or just lack of knowledge in proper Linq but I would really appreciate it if someone can point me in the right direction.  </p>\n\n<p>Here are my three Class files I am using and the C# page that I am trying to build.  Keep in mind I plan to separate the data access into another class but was just trying to get a demo working for myself.\nExam.cs</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.ComponentModel.DataAnnotations;\n\n/// &lt;summary&gt;\n/// Summary description for Exam\n/// &lt;/summary&gt;\npublic class Exam\n{    \n    public int ExamId { get; set; }\n\n    public string Title { get; set; }\n\n    public string Description { get; set; }\n\n    public bool Status { get; set; }\n\n    public DateTime DateCreated { get; set; }\n\n    public string CreatedBy { get; set; }\n\n    public virtual ICollection&lt;Question&gt; Questions { get; set; }\n}\n</code></pre>\n\n<p>Question.cs</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\n\n/// &lt;summary&gt;\n/// Summary description for Question\n/// &lt;/summary&gt;\npublic class Question\n{\n    public int QuestionId { get; set; }\n\n    public string QuestionText { get; set; }\n\n    public int Order { get; set; }\n\n    public DateTime DateCreated { get; set; }\n\n    public bool Status { get; set; }\n\n    public string CreatedBy { get; set; }\n\n    public string QuestionType { get; set; }\n\n    public int ExamId { get; set; }\n\n    public virtual Exam Exam { get; set; }\n\n    public virtual ICollection&lt;Choice&gt; Choices { get; set; }\n}\n</code></pre>\n\n<p>Choice.cs</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\n\n/// &lt;summary&gt;\n/// Summary description for Choice\n/// &lt;/summary&gt;\npublic class Choice\n{\n    public int ChoiceId { get; set; }\n\n    public string ChoiceText { get; set; }\n\n    public int Order { get; set; }\n\n    public bool Status { get; set; }\n\n    public bool Correct { get; set; }\n\n    public DateTime DateCreated { get; set; }\n\n    public string CreatedBy { get; set; }\n\n    public int QuestionId { get; set; }\n\n    public virtual Question Question { get; set; }\n}\n</code></pre>\n\n<p>Testing.aspx.cs</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\n\npublic partial class Testing : System.Web.UI.Page\n{\n\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        ExamsContext db = new ExamsContext();\n\n        var questions = (from c in db.Exams\n                     from q in c.Questions\n                     where c.ExamId == 1\n                     select q).ToList();\n        ContentPlaceHolder content = (ContentPlaceHolder)this.Master.FindControl(\"MainContent\");\n        foreach (var question in questions)\n        {\n            Literal questionLabel = new Literal();\n            questionLabel.Text = Convert.ToString(question.QuestionId) + \".&amp;nbsp;\" + question.QuestionText + \"&lt;br/&gt;\";\n            content.Controls.Add(questionLabel);\n\n            var choices = (from c in question.Choices select c).ToList();\n\n            RadioButtonList ql = new RadioButtonList();   \n                foreach (var choice in choices)\n                {\n                    ql.DataValueField = Convert.ToString(choice.ChoiceId);\n                    ql.DataTextField = choice.ChoiceText;\n                }\n                content.Controls.Add(ql);\n                ql.DataSource = choices;\n                ql.DataBind();            \n        }        \n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "email", "text", "input"], "comments": [{"owner": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 1, "creation_date": 1423696540, "post_id": 28466393, "comment_id": 45258443, "body": "And what is the exact problem with what you tried?"}, {"owner": {"reputation": 1173, "user_id": 4557002, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/718279ee9730b6ba946d206b7280940d?s=128&d=identicon&r=PG&f=1", "display_name": "ddeamaral", "link": "https://stackoverflow.com/users/4557002/ddeamaral"}, "reply_to_user": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 0, "creation_date": 1423696678, "post_id": 28466393, "comment_id": 45258504, "body": "I can&#39;t figure out how to import text from an email. Say the email in my browser window says hello, and I want my application to somehow take the word hello and send it to a database."}, {"owner": {"reputation": 6610, "user_id": 2403810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c63a4cc13b434306ccc00ba2cd64d6?s=128&d=identicon&r=PG&f=1", "display_name": "tinstaafl", "link": "https://stackoverflow.com/users/2403810/tinstaafl"}, "edited": false, "score": 1, "creation_date": 1423699057, "post_id": 28466393, "comment_id": 45259358, "body": "Are you using a browser control to get the email? Or are you receiving the email separately?"}, {"owner": {"reputation": 1173, "user_id": 4557002, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/718279ee9730b6ba946d206b7280940d?s=128&d=identicon&r=PG&f=1", "display_name": "ddeamaral", "link": "https://stackoverflow.com/users/4557002/ddeamaral"}, "edited": false, "score": 0, "creation_date": 1423700497, "post_id": 28466393, "comment_id": 45259829, "body": "The email is in my Gmail account, I want to be able to pull the text from the email and load it into my form in my application."}, {"owner": {"reputation": 1682, "user_id": 2544158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osuok.jpg?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/2544158/reticulated-spline"}, "edited": false, "score": 2, "creation_date": 1423701403, "post_id": 28466393, "comment_id": 45260080, "body": "If you want to get email from your Gmail account, your best bet is to use the <a href=\"https://developers.google.com/gmail/api/\" rel=\"nofollow noreferrer\">Gmail API</a>."}], "owner": {"reputation": 1173, "user_id": 4557002, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/718279ee9730b6ba946d206b7280940d?s=128&d=identicon&r=PG&f=1", "display_name": "ddeamaral", "link": "https://stackoverflow.com/users/4557002/ddeamaral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423696403, "creation_date": 1423696403, "question_id": 28466393, "link": "https://stackoverflow.com/questions/28466393/retrieving-text-from-an-email-in-a-windows-form-application-not-asp-net", "title": "Retrieving text from an email in a windows form application NOT asp.net", "body": "<p>I'm currently looking for a way to start an application that would take an email text, it would essentially have a link that would allow the email user to click a link and it gets submitted to the database. Of my choice. Or I would want a Windows Form Application that accesses an email that then takes the text of the email and sends it to the database. </p>\n"}, {"tags": ["c#", "multithreading", "collections", "concurrency"], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 4194749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Txpg.png?s=128&g=1", "display_name": "JakubJ", "link": "https://stackoverflow.com/users/4194749/jakubj"}, "edited": false, "score": 0, "creation_date": 1423729191, "post_id": 28467999, "comment_id": 45268984, "body": "That is very well explained, I did not know that there is something like &quot;Interlocked. &quot; before. I will definitely use it and implement it the way you suggested. Thank you for your time and help, I really appreciate it."}], "tags": [], "owner": {"reputation": 79883, "user_id": 205608, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/61eE0.png?s=128&g=1", "display_name": "O. Jones", "link": "https://stackoverflow.com/users/205608/o-jones"}, "is_accepted": true, "score": 1, "last_activity_date": 1423706310, "creation_date": 1423706310, "answer_id": 28467999, "question_id": 28466385, "link": "https://stackoverflow.com/questions/28466385/concurrent-collection-vs-locking-list/28467999#28467999", "title": "Concurrent Collection vs locking list", "body": "<p>Queues, Stacks, and Bags have the benefit that you don't need to know which object you're getting until you get it. In your case you do know which object you want to manipulate.</p>\n\n<p>It sounds like you have a sort of hybrid model, where you have a processing regime that grabs 'unfinished' objects from a collection, 'finishes' them, then puts them into a 'finished' collection. (It seems you're using lists.)  You also have a user interface that allows a user to choose any given object from the 'unfinished' collection and take it out of that collection.</p>\n\n<p>The way your processing regime <em>should</em> work is this:  The code processing objects should </p>\n\n<ul>\n<li>Remove an object to be processed from the 'unfinished' collection.</li>\n<li>Process the object.</li>\n<li>Place it into the 'finished' collection.</li>\n<li>Repeat.</li>\n</ul>\n\n<p>That is, an object that's currently being processed should never appear in the 'unfinished' collection, because it's removed prior to processing.</p>\n\n<p>Now, if you want to display the items in your 'unfinished' collection to your user, you'll need to iterate through them. You'll also need to give them some sort of key, so when the user clicks on one of them you'll be able to tell which one.</p>\n\n<p>A good way to do this is a serial number, which you increment using <code>Interlocked.Increment(ref staticSerialNumber)</code>. </p>\n\n<p>Then you can use a <code>ConcurrentDictionary&lt;int&gt;&lt;yourObject&gt;</code> collection for your 'unfinished' collection.</p>\n\n<p>To insert a new object into it is easy:</p>\n\n<pre><code>Interlocked.Increment(ref staticSerialNumber);\ndict.GetOrAdd(staticSerialNumber, newObject);\n</code></pre>\n\n<p>To get a list of objects in it is easy. Use the <code>dict.GetEnumerator()</code> method.</p>\n\n<p>To take an item from the dictionary, you can use the enumerator to find the first item, then use <code>TryRemove(key)</code> to do that.</p>\n\n<p>In short, a ConcurrentDictionary is probably a good choice for your application.</p>\n"}], "owner": {"reputation": 235, "user_id": 4194749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Txpg.png?s=128&g=1", "display_name": "JakubJ", "link": "https://stackoverflow.com/users/4194749/jakubj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2055, "favorite_count": 0, "accepted_answer_id": 28467999, "answer_count": 1, "score": 1, "last_activity_date": 1424088568, "creation_date": 1423696360, "last_edit_date": 1424088568, "question_id": 28466385, "link": "https://stackoverflow.com/questions/28466385/concurrent-collection-vs-locking-list", "title": "Concurrent Collection vs locking list", "body": "<p>Im trying to learn how to work with threads and Im stuck with Concurrent Collections.</p>\n\n<p>I have application, in which I have list <code>unfinishedOBjectsList&lt;MyObject&gt;</code> of objects and a method, that do some changes on specific object (something like DoChange(MyObject object) ). After that, that object is taken from first list and inserted in <code>finishedObjectsList&lt;MyObject&gt;</code>.</p>\n\n<p>Now, I wanted to run the method using threads, which was working fine - each thread did some changes (changes are minor, so I added ThreadSleep() to simulate some longer processing of object) on specific object it found in unfinishedOBjectsList, removed it from unfinishedOBjectsList and put it in second list.</p>\n\n<p>Next step I wanted to implement was that there would be another method (handled by user using button for example), which would allow user to pick any object from the first list and remove it manualy. The \"problem\" I wanted to simulate was, that if the object is being \"processed\" by thread, user should not be able to remove it from list.</p>\n\n<p>I tried ConcurrentQueue - but the problem is, that using Queue, I can not remove specific object (using something like Remove(MyObject) as I can do with list). After that, I tried ConcurrentBag and BlockingCollection, but the problem was the same - I was able to remove the next object in collection, but not for example object in the middle of the collection.</p>\n\n<p>I have thought about using Dictionary, but I cant see reason why I should use dictionary with Key,Value parameters, while I only need to store the object.</p>\n\n<p>My question is - should I even use ConcurrentCollections for this case? Or should I simply lock the list and leave it as it is? What is the right approach when dealing with multiple-access lists?</p>\n\n<p>Thank You</p>\n"}, {"tags": ["c#", "excel", "range", "named"], "comments": [{"owner": {"reputation": 503, "user_id": 4550525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/885ff1c9622eca427de2a90164bb8f5d?s=128&d=identicon&r=PG&f=1", "display_name": "Keylee", "link": "https://stackoverflow.com/users/4550525/keylee"}, "reply_to_user": {"reputation": 60839, "user_id": 301857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4KmT.jpg?s=128&g=1", "display_name": "Grant Winney", "link": "https://stackoverflow.com/users/301857/grant-winney"}, "edited": false, "score": 0, "creation_date": 1423696449, "post_id": 28466314, "comment_id": 45258407, "body": "See revised post above for naming. As for performance, it is just that the operation takes a long time to complete over a large selection of cells."}], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 4550525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/885ff1c9622eca427de2a90164bb8f5d?s=128&d=identicon&r=PG&f=1", "display_name": "Keylee", "link": "https://stackoverflow.com/users/4550525/keylee"}, "edited": false, "score": 0, "creation_date": 1423703495, "post_id": 28467298, "comment_id": 45260629, "body": "My intention was if the name is null, assign a name. If it already has a name, leave it as is. By your explain action above, I may end up overwriting an already named cell. Please clarify, as I am confused."}, {"owner": {"reputation": 2425, "user_id": 3317709, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/11e9b6aa6a1698138be2a620ce1153e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi M Patel", "link": "https://stackoverflow.com/users/3317709/ravi-m-patel"}, "reply_to_user": {"reputation": 503, "user_id": 4550525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/885ff1c9622eca427de2a90164bb8f5d?s=128&d=identicon&r=PG&f=1", "display_name": "Keylee", "link": "https://stackoverflow.com/users/4550525/keylee"}, "edited": false, "score": 0, "creation_date": 1423724880, "post_id": 28467298, "comment_id": 45266964, "body": "The interop doesn&#39;t allow to check if cell.Name is null. It raise an error. So you are left with only two options as I explained : 1. Iterate through <code>Globals.ThisWorkbook.Names</code> collection and check if your cell already has a name. 2. The previous method involves a lot of coding and processing time, so simply overwrite it. Overwriting is not going to cause you any harm and is simpler (coding wise) and less expensive (compared to method 1) processing time wise."}, {"owner": {"reputation": 503, "user_id": 4550525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/885ff1c9622eca427de2a90164bb8f5d?s=128&d=identicon&r=PG&f=1", "display_name": "Keylee", "link": "https://stackoverflow.com/users/4550525/keylee"}, "edited": false, "score": 0, "creation_date": 1423801299, "post_id": 28467298, "comment_id": 45305468, "body": "I have decided to loop through the names and check if the cell adress match. Long winded process but worked better than try-catch."}], "tags": [], "owner": {"reputation": 2425, "user_id": 3317709, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/11e9b6aa6a1698138be2a620ce1153e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi M Patel", "link": "https://stackoverflow.com/users/3317709/ravi-m-patel"}, "is_accepted": true, "score": 0, "last_activity_date": 1423701497, "creation_date": 1423701497, "answer_id": 28467298, "question_id": 28466314, "link": "https://stackoverflow.com/questions/28466314/c-excel-check-cell-contains-a-name-in-vsto/28467298#28467298", "title": "C# Excel Check cell contains a name in VSTO", "body": "<p>You are getting an error because cell.Name itself raises exception, let alone cell.Name.Name.</p>\n\n<p><code>Globals.ThisWorkbook.Names.Item(1)</code> gives you first of the names defined in your workbook. It gives values like <code>=Sheet1!$E$10:$F$12</code> and <code>=Sheet1!$C$5</code> to indicate what that named range refers to.</p>\n\n<p><code>Globals.ThisWorkbook.Names.Item(1).Name</code> shall give you actual name of the range. e.g. <code>Temp</code> in your case. That is one way to check.</p>\n\n<p>Other way, in your code you are checking if the Name is null and if it is you are assigning it again. There is no harm in running this code multiple number of times:</p>\n\n<pre><code>Globals.ThisWorkbook.Names.Add(\"Temp\", cell);\n</code></pre>\n\n<p>You can skip the check and run this statement instead. If the name is already there, it'll overwrite. Big deal!!!</p>\n"}], "owner": {"reputation": 503, "user_id": 4550525, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/885ff1c9622eca427de2a90164bb8f5d?s=128&d=identicon&r=PG&f=1", "display_name": "Keylee", "link": "https://stackoverflow.com/users/4550525/keylee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 28467298, "answer_count": 1, "score": 1, "last_activity_date": 1423701497, "creation_date": 1423695994, "last_edit_date": 1423697149, "question_id": 28466314, "link": "https://stackoverflow.com/questions/28466314/c-excel-check-cell-contains-a-name-in-vsto", "title": "C# Excel Check cell contains a name in VSTO", "body": "<p>I am trying to check if a cell contains name or is a named range, if not, I will assign a name. Here is my code: </p>\n\n<pre><code>if (cell.Name.Name == null) \n{ \n    Globals.ThisWorkbook.Names.Add(\"Temp\", cell);\n}\nelse\n{\n    // Move on\n}\n</code></pre>\n\n<p>However, the above code will throw a <code>COMException</code>. Instead, I tried to get around it by doing this: </p>\n\n<pre><code>try\n{\n    if (cell.Name.Name == null) { }\n}\ncatch (COMException)\n{\n    Globals.ThisWorkbook.Names.Add(\"Temp\", cell);\n}\n</code></pre>\n\n<p>The second code snippet worked but my spreadsheet is taking a serious performance hit. The operation went from ~80 ms to 1700 ms. This may not seem much but I am looping over a range selection. </p>\n\n<p>The error message was: </p>\n\n<pre><code>System.Runtime.InteropServices.COMException was unhandled by user code\n  HResult=-2146827284\n  Message=Exception from HRESULT: 0x800A03EC\n  Source=\"\"\n  ErrorCode=-2146827284\n  StackTrace:\n       at System.RuntimeType.ForwardCallToInvokeMember(String memberName, BindingFlags flags, Object target, Int32[] aWrapperTypes, MessageData&amp; msgData)\n       at Microsoft.Office.Interop.Excel.Range.get_Name()\n       at ExcelTemplate1.Sheet1.button2_Click(Object sender, EventArgs e) in c:\\Users\\User\\Desktop\\ExcelTemplate1\\ExcelTemplate1\\Sheet1.cs:line 116\n       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\n       at System.Windows.Forms.Button.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n  InnerException: \n</code></pre>\n\n<p>Question is, is there a better way to check for cell named range? </p>\n"}, {"tags": ["c#", "model-view-controller", "razorgenerator"], "comments": [{"owner": {"reputation": 3437, "user_id": 1454888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IBah1.jpg?s=128&g=1", "display_name": "Augusto Barreto", "link": "https://stackoverflow.com/users/1454888/augusto-barreto"}, "edited": false, "score": 1, "creation_date": 1424124489, "post_id": 28466275, "comment_id": 45415488, "body": "The error states &#39;ViewHelpers&#39; with an S at the end. Are you sure you didn&#39;t wrote @ViewHelpers.test(this.Html)?"}], "answers": [{"tags": [], "owner": {"reputation": 38985, "user_id": 56621, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c9f0a88b23e72c4c297f2d563fa90c6?s=128&d=identicon&r=PG", "display_name": "Alex from Jitbit", "link": "https://stackoverflow.com/users/56621/alex-from-jitbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1424169526, "last_edit_date": 1424169526, "creation_date": 1424122675, "answer_id": 28550789, "question_id": 28466275, "link": "https://stackoverflow.com/questions/28466275/razorgenerator-cant-see-custom-cshtml-helper/28550789#28550789", "title": "RazorGenerator can&#39;t see custom cshtml helper", "body": "<p>Look at the actual cs-file generated in the obj\\CodeGen folder for the helpers. It might be the class-name issue, so add this to the top of your helper cshtml-file:</p>\n\n<pre><code>@* GeneratePrettyNames : true *@\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 448, "user_id": 4556938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-TkWsrOFg3VQ/AAAAAAAAAAI/AAAAAAAAEas/OYvCNXxaUJA/photo.jpg?sz=128", "display_name": "Krzysztof", "link": "https://stackoverflow.com/users/4556938/krzysztof"}, "is_accepted": false, "score": 0, "last_activity_date": 1424947586, "creation_date": 1424947586, "answer_id": 28740356, "question_id": 28466275, "link": "https://stackoverflow.com/questions/28466275/razorgenerator-cant-see-custom-cshtml-helper/28740356#28740356", "title": "RazorGenerator can&#39;t see custom cshtml helper", "body": "<p>It turns out that I needed to compile the helper itself to make it working.</p>\n\n<p>That didn't get me far though: RazorGenerator couldn't \"see\" Mvc namespace references. I've read that RG is not compatible with MVC version 5.0 or higher (or is it?).</p>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 1817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7709b1b445d488d89261e7fb99d18b8?s=128&d=identicon&r=PG", "display_name": "Sean Clifford", "link": "https://stackoverflow.com/users/1817/sean-clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1443998966, "creation_date": 1443998966, "answer_id": 32939181, "question_id": 28466275, "link": "https://stackoverflow.com/questions/28466275/razorgenerator-cant-see-custom-cshtml-helper/32939181#32939181", "title": "RazorGenerator can&#39;t see custom cshtml helper", "body": "<p>I had the same problem with RazorGenerator when I updated to MVC 5.</p>\n\n<p>According to <a href=\"https://razorgenerator.codeplex.com/discussions/459467\" rel=\"nofollow\">this discussion on RazorGenerator's codeplex</a>, it seems that the RazorGenerator.MsBuild package sometimes has a problem resolving the correct version of Razor to use, so ends up missing the namespaces defined in the web.config.</p>\n\n<p>To force it to use the correct version of Razor (and hopefully pick up your namespaces), create a file called <code>razorgenerator.directives</code> in the project folder containing the text: <code>RazorVersion: 3</code></p>\n"}, {"comments": [{"owner": {"reputation": 1642, "user_id": 908326, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/944897d101051800856cb621250610d9?s=128&d=identicon&r=PG", "display_name": "youen", "link": "https://stackoverflow.com/users/908326/youen"}, "edited": false, "score": 3, "creation_date": 1449664705, "post_id": 34091357, "comment_id": 56104263, "body": "In my case, I also had to change the &quot;Build Action&quot; of the generated helper cs file to &quot;Compile&quot; (it was set to &quot;Content&quot;)"}, {"owner": {"reputation": 18280, "user_id": 350384, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hyOvH.jpg?s=128&g=1", "display_name": "Mariusz Pawelski", "link": "https://stackoverflow.com/users/350384/mariusz-pawelski"}, "reply_to_user": {"reputation": 1642, "user_id": 908326, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/944897d101051800856cb621250610d9?s=128&d=identicon&r=PG", "display_name": "youen", "link": "https://stackoverflow.com/users/908326/youen"}, "edited": false, "score": 0, "creation_date": 1449690233, "post_id": 34091357, "comment_id": 56121482, "body": "@youen, I use RazorGenerator.MsBuild not VS plugin for generating code so I didn&#39;t had this problem. :) I did as described <a href=\"http://stacktoheap.com/blog/2013/01/19/precompiling-razor-views-in-asp-dot-net-mvc-3/\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 18280, "user_id": 350384, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/hyOvH.jpg?s=128&g=1", "display_name": "Mariusz Pawelski", "link": "https://stackoverflow.com/users/350384/mariusz-pawelski"}, "is_accepted": true, "score": 12, "last_activity_date": 1449256349, "last_edit_date": 1449256349, "creation_date": 1449241731, "answer_id": 34091357, "question_id": 28466275, "link": "https://stackoverflow.com/questions/28466275/razorgenerator-cant-see-custom-cshtml-helper/34091357#34091357", "title": "RazorGenerator can&#39;t see custom cshtml helper", "body": "<h2>Solution:</h2>\n\n<p>You need to put this comment at the beginning of a helper you have in <code>App_Code</code>:</p>\n\n<pre><code>@*\n    Generator: MvcHelper\n    GeneratePrettyNames : true\n*@\n</code></pre>\n\n<p>Then in <code>web.config</code> where you have configuration for razor pages you need to add namespace that RazorGenerator generated for those helpers:</p>\n\n<pre><code>&lt;system.web.webPages.razor&gt;\n    &lt;host factoryType=\"System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n    &lt;pages pageBaseType=\"System.Web.Mvc.WebViewPage\"&gt;\n        &lt;namespaces&gt;                \n            &lt;add namespace=\"YourWebAppNamespace.App_Code\" /&gt;\n        &lt;/namespaces&gt;\n    &lt;/pages&gt;\n&lt;/system.web.webPages.razor&gt;\n</code></pre>\n\n<p>Change <code>YourWebAppNamespace</code> to you default project namespace (it's probably your project name):</p>\n\n<p><a href=\"https://i.stack.imgur.com/eZZGj.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/eZZGj.png\" alt=\"Default namespace for project in Visual Studio\"></a></p>\n\n<hr>\n\n<h2>Explanation:</h2>\n\n<p>RazorGenerator treated you helpers like normal razor view so the generated code looked like this:</p>\n\n<pre><code>    [System.CodeDom.Compiler.GeneratedCodeAttribute(\"RazorGenerator\", \"2.0.0.0\")]\n    [System.Web.WebPages.PageVirtualPathAttribute(\"~/App_Code/TestHelper.cshtml\")]\n    public partial class _App_Code_TestHelper_cshtml : Komplett.Chrome.Web.Features.Shared.BaseView&lt;dynamic&gt;\n    {\n\n#line 3 \"..\\..\\App_Code\\TestHelper.cshtml\"\npublic System.Web.WebPages.HelperResult HelperName(string name) {\n</code></pre>\n\n<p>You need to add these directive comments to tell razor generator to create class with \"normal\" name (the same as helper file name, you do this with <code>GeneratePrettyNames</code> directive) and with static public function so it could be used in other views (done by <code>Generator: MvcHelper</code> directive).\nWith those directive comments RazorGenerator generate C# file like this:</p>\n\n<pre><code>    [System.CodeDom.Compiler.GeneratedCodeAttribute(\"RazorGenerator\", \"2.0.0.0\")]\n    public class TestHelper : System.Web.WebPages.HelperPage\n    {\n\n#line 6 \"..\\..\\App_Code\\TestHelper.cshtml\"\npublic static System.Web.WebPages.HelperResult HelperName(string name) {\n</code></pre>\n\n<p>You now just need to add namespace to <code>web.config</code> so C# generated code for other views would have using statement with namespace of this generated helper.</p>\n"}, {"comments": [{"owner": {"reputation": 2250, "user_id": 3990817, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pbgfv.jpg?s=128&g=1", "display_name": "MrMister", "link": "https://stackoverflow.com/users/3990817/mrmister"}, "edited": false, "score": 0, "creation_date": 1598955980, "post_id": 39938375, "comment_id": 112617616, "body": "I also needed to append <code>RazorVersion: 3</code>, or the project didn&#39;t compile at first attempt (strangely, it would compile on subsequent attempts)"}], "tags": [], "owner": {"reputation": 16463, "user_id": 39605, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fb41d4ad46ba219e5e22ac5315abe5bb?s=128&d=identicon&r=PG", "display_name": "Brian Surowiec", "link": "https://stackoverflow.com/users/39605/brian-surowiec"}, "is_accepted": false, "score": 0, "last_activity_date": 1475968555, "creation_date": 1475968555, "answer_id": 39938375, "question_id": 28466275, "link": "https://stackoverflow.com/questions/28466275/razorgenerator-cant-see-custom-cshtml-helper/39938375#39938375", "title": "RazorGenerator can&#39;t see custom cshtml helper", "body": "<p>I'm using <code>RazorGenerator.MsBuild</code> to compile my views and <code>RazorGenerator.Mvc</code> to load them. The easiest <code>App_Code</code> fix for me was to add the following to the top of my helper files</p>\n\n<pre><code>@*\nGenerator: MvcHelper\nGeneratePrettyNames: true\nNamespace: My.Projects.Namespace\n*@\n</code></pre>\n\n<p>With this there's no web.config changes or anything else that needed to be made.</p>\n"}], "owner": {"reputation": 448, "user_id": 4556938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-TkWsrOFg3VQ/AAAAAAAAAAI/AAAAAAAAEas/OYvCNXxaUJA/photo.jpg?sz=128", "display_name": "Krzysztof", "link": "https://stackoverflow.com/users/4556938/krzysztof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3468, "favorite_count": 3, "accepted_answer_id": 34091357, "answer_count": 5, "score": 17, "last_activity_date": 1475968555, "creation_date": 1423695774, "question_id": 28466275, "link": "https://stackoverflow.com/questions/28466275/razorgenerator-cant-see-custom-cshtml-helper", "title": "RazorGenerator can&#39;t see custom cshtml helper", "body": "<p>I'm having a problem with RazorGenerator: it can't compile views that uses my custom helper:</p>\n\n<p>App_Code/ViewHelper.cshtml </p>\n\n<pre><code>@helper test(System.Web.Mvc.HtmlHelper html)\n{\n    &lt;h4&gt;Test&lt;/h4&gt;    \n}\n</code></pre>\n\n<p>Views/Test.cshtml</p>\n\n<pre><code>(...)\n@ViewHelper.test(this.Html)\n(...)\n</code></pre>\n\n<p>When I try to compile my project I get this error for Test.cshtml:</p>\n\n<blockquote>\n  <p>The name 'ViewHelpers' does not exist in the current context  </p>\n</blockquote>\n\n<p>I tried adding various namespaces to my Views/web.config file:</p>\n\n<pre><code>  &lt;system.web.webPages.razor&gt;\n    &lt;host factoryType=\"System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.2.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" /&gt;\n    &lt;pages pageBaseType=\"System.Web.Mvc.WebViewPage\"&gt;\n      &lt;namespaces&gt;\n        &lt;add namespace=\"System.Web.Mvc\" /&gt;\n        &lt;add namespace=\"System.Web.Mvc.Ajax\" /&gt;\n        &lt;add namespace=\"System.Web.Mvc.Html\" /&gt;\n        &lt;add namespace=\"System.Web.Routing\" /&gt;\n        &lt;add namespace=\"System.Web.Optimization\" /&gt;\n        &lt;add namespace=\"MyProject\" /&gt;\n        &lt;add namespace=\"Kendo.Mvc.UI\" /&gt;\n        &lt;add namespace=\"MvcSiteMapProvider.Web.Html\" /&gt;\n        &lt;add namespace=\"MvcSiteMapProvider.Web.Html.Models\" /&gt;\n      &lt;/namespaces&gt;\n    &lt;/pages&gt;\n  &lt;/system.web.webPages.razor&gt;\n</code></pre>\n\n<p>but with no success...</p>\n\n<p>Am I missing some namespace that should be included in this file? If not, is there any other way to make RazorGenerator compile the view? Also, does cshtml helpers even exist in a namespace?</p>\n"}, {"tags": ["c#", "asp.net", "wcf", "kendo-ui"], "answers": [{"tags": [], "owner": {"reputation": 4153, "user_id": 2701144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4rsA.jpg?s=128&g=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/2701144/brett"}, "is_accepted": false, "score": 0, "last_activity_date": 1423697915, "creation_date": 1423697915, "answer_id": 28466711, "question_id": 28466260, "link": "https://stackoverflow.com/questions/28466260/how-to-pass-parameters-in-kendo-web-method-data-source-in-asp-net/28466711#28466711", "title": "How to pass parameters in kendo web method data source in asp.net?", "body": "<p>You are defining the data parameter in the wrong location of the Kendo UI DataSource definition. <a href=\"http://docs.telerik.com/kendo-ui/api/javascript/data/datasource#configuration-transport.read.data\" rel=\"nofollow\">Reference</a>. This is how it should be set up:</p>\n\n<pre><code>dataSource: {\n  type: 'json',\n  transport: {\n    read: {\n      type: 'POST',\n      url: 'Default.aspx/FetchCounts',\n      contentType: 'application/json; charset=utf-8',\n      datatype: 'json',\n      data: function () {\n        return { \n          month: month \n        };\n      }\n    }\n  },\n  serverFiltering: false,\n  serverSorting: false,\n  schema: {\n    //...\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 4528988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/3cfaffa844f1ed409b26eb9fe9c3ac26?s=128&d=identicon&r=PG&f=1", "display_name": "nrvbha", "link": "https://stackoverflow.com/users/4528988/nrvbha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1027, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423698134, "creation_date": 1423695737, "last_edit_date": 1423698134, "question_id": 28466260, "link": "https://stackoverflow.com/questions/28466260/how-to-pass-parameters-in-kendo-web-method-data-source-in-asp-net", "title": "How to pass parameters in kendo web method data source in asp.net?", "body": "<p>I have an asp.net application. I am using kendo bullet charts. It is developed in .net framework 2.0 so wcf service is not working. That is why I am using web methods for binding of remote data.</p>\n\n<p>I want to pass value of a c# variable in kendo web method data source url but it is not working.</p>\n\n<p>Here is my code,</p>\n\n<pre><code>var month = \"&lt;%= month %&gt;\";\n\ndataSource: {\n  type: \"json\",\n  transport: {\n    read: {\n      type: \"POST\",\n      url: \"Default.aspx/FetchCounts\",\n      contentType: 'application/json; charset=utf-8',\n      datatype: \"json\"\n    }\n  },\n  serverFiltering: false,\n  serverSorting: false,\n  schema: {\n    //data: \"d\",\n    data: month,\n    model: {\n      fields: {\n        current: { type: \"string\" },\n        target: { type: \"string\" }\n      }\n    }\n  }\n},\n</code></pre>\n\n<p>which is not working.</p>\n\n<p>I do not know how to make it work.</p>\n"}, {"tags": ["c#", "unity3d", "textures", "webcam"], "answers": [{"comments": [{"owner": {"reputation": 152, "user_id": 4174363, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8d4b5fdf18384ef02b59589a5bdc34e9?s=128&d=identicon&r=PG&f=1", "display_name": "Alessio Marzoli", "link": "https://stackoverflow.com/users/4174363/alessio-marzoli"}, "edited": false, "score": 0, "creation_date": 1423816227, "post_id": 28480572, "comment_id": 45310486, "body": "Thank you @Dover8 , i tried to use these properties in my code, but with no results! I set the the witdth and height to 512, after the instantiation of WebCamTexture, but not when it was running.  Can you show me a small example ? Thank you."}], "tags": [], "owner": {"reputation": 566, "user_id": 2831015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbeaec9baca5ec4ee8b9f0f241c7f09?s=128&d=identicon&r=PG", "display_name": "Dover8", "link": "https://stackoverflow.com/users/2831015/dover8"}, "is_accepted": false, "score": 1, "last_activity_date": 1423752787, "creation_date": 1423752787, "answer_id": 28480572, "question_id": 28466221, "link": "https://stackoverflow.com/questions/28466221/how-to-modify-the-size-of-a-webcamtexture/28480572#28480572", "title": "How to modify the size of a WebCamTexture?", "body": "<p>You can use the requested height and requested width to adjust the size of texture you want from the camera. However you need to do this while the camera is not running, and you will get back the closest supported size by the device itself.</p>\n\n<p><a href=\"http://docs.unity3d.com/ScriptReference/WebCamTexture-requestedWidth.html\" rel=\"nofollow\">WebCamTexture.requestedWidth</a></p>\n\n<p><a href=\"http://docs.unity3d.com/ScriptReference/WebCamTexture-requestedHeight.html\" rel=\"nofollow\">WebCamTexture.requestedHeight</a></p>\n"}, {"comments": [{"owner": {"reputation": 478, "user_id": 4415144, "user_type": "registered", "profile_image": "https://graph.facebook.com/524916680/picture?type=large", "display_name": "Chris", "link": "https://stackoverflow.com/users/4415144/chris"}, "edited": false, "score": 0, "creation_date": 1462308035, "post_id": 37013936, "comment_id": 61580107, "body": "in other words Unity will select a lower resolution WebCamTexture if you hit the preset size 352.... 640... and so on..."}], "tags": [], "owner": {"reputation": 478, "user_id": 4415144, "user_type": "registered", "profile_image": "https://graph.facebook.com/524916680/picture?type=large", "display_name": "Chris", "link": "https://stackoverflow.com/users/4415144/chris"}, "is_accepted": false, "score": 2, "last_activity_date": 1462307930, "creation_date": 1462307930, "answer_id": 37013936, "question_id": 28466221, "link": "https://stackoverflow.com/questions/28466221/how-to-modify-the-size-of-a-webcamtexture/37013936#37013936", "title": "How to modify the size of a WebCamTexture?", "body": "<p>webCamTexture.requestedWidth and webCamTexture.requestedHeight returns the width/height that you originally tried to initialize the WebCamTexture with. they don't reflex the real width / height. Nor, does the webCamTexture.width/webCamTexture.height at all times. The problem is that the size of the webCamTexture is determined after some time in some instances due to the diffirent hardware and resolutions of the device camera, which is not the same aspect as the screen of the device, often. </p>\n\n<p>What you CAN do is to get the pixels (webCamTexture.GetPixels()) 1 time and then after a frame you can use webCamTexture.width/.height to return the captured size of the texture.</p>\n\n<p>An example of such code from the plugin CameraCaptureKit (<a href=\"https://www.assetstore.unity3d.com/en/#!/content/56673\" rel=\"nofollow\">https://www.assetstore.unity3d.com/en/#!/content/56673</a>) which has a function to do what you describe.</p>\n\n<pre><code>// ANDREAS added this: In some cases we apparently don't get correct width and height until we have tried to read pixels\n    // from the buffer.\n    void TryDummySnapshot( ) {\n        if(!gotAspect) {\n            if( webCamTexture.width&gt;16 ) {\n                if( Application.platform == RuntimePlatform.IPhonePlayer ) {\n                    if(verbose)Debug.Log(\"Already got width height of WebCamTexture.\");\n                } else { \n                    if(verbose)Debug.Log(\"Already got width height of WebCamTexture. - taking a snapshot no matter what.\");\n                    var tmpImg = new Texture2D( webCamTexture.width, webCamTexture.height, TextureFormat.RGB24, false );\n                    Color32[] c = webCamTexture.GetPixels32();\n                    tmpImg.SetPixels32(c);\n                    tmpImg.Apply();\n                    Texture2D.Destroy(tmpImg);\n                }\n                gotAspect = true;\n            } else {\n                if(verbose)Debug.Log (\"Taking dummy snapshot\");\n                var tmpImg = new Texture2D( webCamTexture.width, webCamTexture.height, TextureFormat.RGB24, false );\n                Color32[] c = webCamTexture.GetPixels32();\n                tmpImg.SetPixels32(c);\n                tmpImg.Apply();\n                Texture2D.Destroy(tmpImg);\n            }\n        }\n    }\n</code></pre>\n\n<p>Getting back on the point of your question, when I Follow the iOS code you should be able to set a smaller texture size of WebCamTexture by setting the \"requestedWidth/requstedHeight\" to something smaller, Unity will then( at least on iOS) try and select a camera resolution which is closest to your requsted texturesize. </p>\n\n<p>That happens in CameraCapture.mm</p>\n\n<pre><code>- (NSString*)pickPresetFromWidth:(int)w height:(int)h\n{\nstatic NSString* preset[] =\n{\n    AVCaptureSessionPreset352x288,\n    AVCaptureSessionPreset640x480,\n    AVCaptureSessionPreset1280x720,\n    AVCaptureSessionPreset1920x1080,\n};\nstatic int presetW[] = { 352, 640, 1280, 1920 };\n\n//[AVCamViewController setFlashMode:AVCaptureFlashModeAuto forDevice:[[self videoDeviceInput] device]];\n\n\n#define countof(arr) sizeof(arr)/sizeof(arr[0])\n\nstatic_assert(countof(presetW) == countof(preset), \"preset and preset width arrrays have different elem count\");\n\nint ret = -1, curW = -10000;\nfor(int i = 0, n = countof(presetW) ; i &lt; n ; ++i)\n{\n    if( ::abs(w - presetW[i]) &lt; ::abs(w - curW) &amp;&amp; [self.captureSession canSetSessionPreset:preset[i]] )\n    {\n        ret = i;\n        curW = presetW[i];\n    }\n}\n\nNSAssert(ret != -1, @\"Cannot pick capture preset\");\nreturn ret != -1 ? preset[ret] : AVCaptureSessionPresetHigh;\n\n#undef countof\n }\n</code></pre>\n"}], "owner": {"reputation": 152, "user_id": 4174363, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8d4b5fdf18384ef02b59589a5bdc34e9?s=128&d=identicon&r=PG&f=1", "display_name": "Alessio Marzoli", "link": "https://stackoverflow.com/users/4174363/alessio-marzoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6357, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1462307930, "creation_date": 1423695576, "last_edit_date": 1423831502, "question_id": 28466221, "link": "https://stackoverflow.com/questions/28466221/how-to-modify-the-size-of-a-webcamtexture", "title": "How to modify the size of a WebCamTexture?", "body": "<p>I get the texture from my webcamtexture in Unity, but it's too high for my project. \nI don't need it 1280x720 , but i would decrease is size. \nHow can i change it parameters in Unity ? \nThank you. Thank you in advice. </p>\n"}, {"tags": ["c#", "nativewindow"], "comments": [{"owner": {"reputation": 21426, "user_id": 6276, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/k3Sqp.png?s=128&g=1", "display_name": "Phil Wright", "link": "https://stackoverflow.com/users/6276/phil-wright"}, "edited": false, "score": 0, "creation_date": 1423695352, "post_id": 28466137, "comment_id": 45257966, "body": "Your questions essentially asks someone to give you the whole implementation which is too much of an ask when you can discover most of what you need in a simple google search."}, {"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1423695537, "post_id": 28466137, "comment_id": 45258055, "body": "How about first writing some code and than asking <i>&quot;I did this but have a problem at this&quot;</i> ?"}], "answers": [{"tags": [], "owner": {"reputation": 2152, "user_id": 3478155, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/24c1f942cac00e4715ebcbfc2a6291b4?s=128&d=identicon&r=PG&f=1", "display_name": "ilw", "link": "https://stackoverflow.com/users/3478155/ilw"}, "is_accepted": true, "score": 0, "last_activity_date": 1423696435, "last_edit_date": 1495539808, "creation_date": 1423696435, "answer_id": 28466404, "question_id": 28466137, "link": "https://stackoverflow.com/questions/28466137/commandline-utility-which-show-osd/28466404#28466404", "title": "Commandline utility, which show OSD", "body": "<p>Ok I googled , and find this helpful topics:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/70272/single-form-hide-on-startup\">Single Form Hide on Startup</a></p>\n\n<p><a href=\"http://www.howtogeek.com/howto/programming/get-command-line-arguments-in-a-windows-forms-application/\" rel=\"nofollow noreferrer\">http://www.howtogeek.com/howto/programming/get-command-line-arguments-in-a-windows-forms-application/</a></p>\n"}], "owner": {"reputation": 2152, "user_id": 3478155, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/24c1f942cac00e4715ebcbfc2a6291b4?s=128&d=identicon&r=PG&f=1", "display_name": "ilw", "link": "https://stackoverflow.com/users/3478155/ilw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 28466404, "answer_count": 1, "score": -2, "last_activity_date": 1423696435, "creation_date": 1423695226, "question_id": 28466137, "link": "https://stackoverflow.com/questions/28466137/commandline-utility-which-show-osd", "title": "Commandline utility, which show OSD", "body": "<p>I'm newbe in c#.</p>\n\n<p>I coding command line utility, which show OSD (floating text on the screen) only.\nWhat the best practice for that ?</p>\n\n<p>What project better use for me: console application or windows form or other....\nAnd.... if console application - how hide console ?</p>\n\n<p>If windows form - how hide form (maybe set transparent , I don't know) </p>\n\n<p>Please explain this nuances and give advices if possible... </p>\n\n<p>I'm using visual c# 2010</p>\n\n<p>Thanks </p>\n"}, {"tags": ["c#", ".net", "security", "rsa"], "comments": [{"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1423697659, "post_id": 28466041, "comment_id": 45258875, "body": "It is like you drive a car and you park it against a telephone pole to end your trip.  If you bought the car then nobody cares too much about that.  If you borrowed it from your friend then he&#39;s going to say something."}, {"owner": {"reputation": 8796, "user_id": 94508, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pQYOS.jpg?s=128&g=1", "display_name": "ChrisP", "link": "https://stackoverflow.com/users/94508/chrisp"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1423699611, "post_id": 28466041, "comment_id": 45259545, "body": "Both answers below pointed to the problem being related to the .Dispose() method being called inside the using{} block. This MSDN documentation (<a href=\"https://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>) indicates in the Important Note that a using{} block should be used w/ RSACryptoServiceProvider. Therefore, I experimented and found that if the key file is loaded each time the RSACryptoServiceProvider is invoked then the using{} statement works properly (see Edit in question)."}], "answers": [{"tags": [], "owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "is_accepted": false, "score": 4, "last_activity_date": 1423695087, "creation_date": 1423695087, "answer_id": 28466106, "question_id": 28466041, "link": "https://stackoverflow.com/questions/28466041/why-does-net-rsacryptoserviceprovider-throw-a-safe-handle-has-been-closed-exc/28466106#28466106", "title": "Why does .NET RSACryptoServiceProvider throw a &quot;Safe handle has been closed&quot; exception?", "body": "<p>Since you have <code>using (RSACryptoServiceProvider RSA = ...</code> it's disposing of the object when the <code>using</code> scope ends.</p>\n\n<p>The solution would be to remove the <code>using</code> so the object can be used on subsequent attempts, or recreate the object every time it needs to be used.</p>\n"}, {"tags": [], "owner": {"reputation": 90360, "user_id": 61164, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/782a1ccf1b45f8dbb5116f950d61f661?s=128&d=identicon&r=PG", "display_name": "Erik Funkenbusch", "link": "https://stackoverflow.com/users/61164/erik-funkenbusch"}, "is_accepted": false, "score": 2, "last_activity_date": 1423695372, "creation_date": 1423695372, "answer_id": 28466170, "question_id": 28466041, "link": "https://stackoverflow.com/questions/28466041/why-does-net-rsacryptoserviceprovider-throw-a-safe-handle-has-been-closed-exc/28466170#28466170", "title": "Why does .NET RSACryptoServiceProvider throw a &quot;Safe handle has been closed&quot; exception?", "body": "<p>The problem is that you're reusing the CompanyAuthentication.publicKey, even though you've disposed of it the first time you call (wrapping it in a using block causes the <code>.Dispose()</code> method to be called on it).  </p>\n\n<p>I don't think you want to be disposing of this object if you intend to keep using it.  Since this appears to be a static variable, you probably don't want to dispose it until you shutdown your app.</p>\n"}], "owner": {"reputation": 8796, "user_id": 94508, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pQYOS.jpg?s=128&g=1", "display_name": "ChrisP", "link": "https://stackoverflow.com/users/94508/chrisp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2069, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1423699704, "creation_date": 1423694836, "last_edit_date": 1423699704, "question_id": 28466041, "link": "https://stackoverflow.com/questions/28466041/why-does-net-rsacryptoserviceprovider-throw-a-safe-handle-has-been-closed-exc", "title": "Why does .NET RSACryptoServiceProvider throw a &quot;Safe handle has been closed&quot; exception?", "body": "<p>The following method is used to verify data against a public key using \"SHA1\". The first time the method is called is works correctly. However, when the method is called the second and subsequent times the following line</p>\n\n<pre><code>isVerified = RSA.VerifyData(tokenData, CryptoConfig.MapNameToOID(hashType), signature);\n</code></pre>\n\n<p>causes this exception</p>\n\n<pre><code>{\"Safe handle has been closed\"} System.Exception {System.ObjectDisposedException}\n</code></pre>\n\n<p>Thoughts on what I might be doing incorrectly?</p>\n\n<pre><code>internal static bool VerifyTokenData(byte[] tokenData, byte[] signature, string hashType)\n{\n  try\n  {\n    bool isVerified = false;\n\n    using (RSACryptoServiceProvider RSA = (RSACryptoServiceProvider)CompanyAuthentication.publicKey)\n    {\n      isVerified = RSA.VerifyData(tokenData, CryptoConfig.MapNameToOID(hashType), signature);\n    }\n\n    return isVerified;\n  }\n  catch (CryptographicException cryptoExc)\n  {\n    throw new InvalidOperationException(\"Exception verifying token data\", cryptoExc);\n  }\n  catch (Exception exc)\n  {\n    throw new InvalidOperationException(\"Exception verifying token data\", exc);\n  }\n}\n</code></pre>\n\n<p>The public key used is loaded into a class variable using</p>\n\n<pre><code>internal static void LoadKeys()\n{\n  try\n  {\n    X509Certificate2 certificate = new X509Certificate2();\n    lock (CompanyAuthentication.thisLock)\n    {\n      certificate.Import(System.Configuration.ConfigurationManager.AppSettings[\"companyKeyFilePath\"].ToString(), System.Configuration.ConfigurationManager.AppSettings[\"companyKeyFilePassword\"].ToString(), X509KeyStorageFlags.UserKeySet);\n      CompanyAuthentication.publicKey = certificate.PublicKey.Key;\n      CompanyAuthentication.privateKey = certificate.PrivateKey;\n    }\n  }\n  catch (CryptographicException cryptoExc)\n  {\n    throw new InvalidOperationException(\"Exception creating public/private keys\", cryptoExc);\n  }\n  catch (Exception exc)\n  {\n    throw new InvalidOperationException(\"Exception creating public/private keys\", exc);\n  }\n}\n</code></pre>\n\n<p>EDIT:\nHere's the revised code that functions properly. It loads the key file each time rather than once in the class constructor.</p>\n\n<pre><code>    SalesNetAuthentication.LoadKeys();\n    using (RSACryptoServiceProvider RSA = (RSACryptoServiceProvider)SalesNetAuthentication.publicKey)\n    {\n      isVerified = RSA.VerifyData(tokenData, CryptoConfig.MapNameToOID(hashType), signature);\n    }\n</code></pre>\n"}, {"tags": ["c#", "replace"], "comments": [{"owner": {"reputation": 3273, "user_id": 4355338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rc5kr.jpg?s=128&g=1", "display_name": "Sievajet", "link": "https://stackoverflow.com/users/4355338/sievajet"}, "edited": false, "score": 0, "creation_date": 1423695105, "post_id": 28466037, "comment_id": 45257845, "body": "Even the title doesnt make sense with the code you&#39;ve posted"}], "answers": [{"tags": [], "owner": {"reputation": 21426, "user_id": 6276, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/k3Sqp.png?s=128&g=1", "display_name": "Phil Wright", "link": "https://stackoverflow.com/users/6276/phil-wright"}, "is_accepted": false, "score": 1, "last_activity_date": 1423695214, "creation_date": 1423695214, "answer_id": 28466132, "question_id": 28466037, "link": "https://stackoverflow.com/questions/28466037/using-contains-or-indexof-with-counter-in-c/28466132#28466132", "title": "Using Contains or IndexOf with counter in C#", "body": "<p>The problem is your replace statement will replace ALL instances of \"CreateObject\" in the string, it does not stop after replacing the first instance. Get rid of the replace line and instead search for the index of the first instance using .IndexOf and then replace it manually.</p>\n"}, {"comments": [{"owner": {"reputation": 342, "user_id": 4424019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5e685ce41fce0c69079ce47c618b0a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tom S", "link": "https://stackoverflow.com/users/4424019/tom-s"}, "edited": false, "score": 0, "creation_date": 1423695557, "post_id": 28466180, "comment_id": 45258060, "body": "Thanks. what does &quot;m=&gt;&quot; mean? Match?"}, {"owner": {"reputation": 637210, "user_id": 69083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db0cdfd3fe268e270ec481a73046c2f?s=128&d=identicon&r=PG", "display_name": "Guffa", "link": "https://stackoverflow.com/users/69083/guffa"}, "reply_to_user": {"reputation": 342, "user_id": 4424019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5e685ce41fce0c69079ce47c618b0a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tom S", "link": "https://stackoverflow.com/users/4424019/tom-s"}, "edited": false, "score": 0, "creation_date": 1423695750, "post_id": 28466180, "comment_id": 45258149, "body": "@Tom: It&#39;s a lambda expression, a short way of writing a function. The <code>m</code> would be the parameter in the function, which is the <code>Match</code> object that the <code>Replace</code> method calls the function with."}], "tags": [], "owner": {"reputation": 637210, "user_id": 69083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1db0cdfd3fe268e270ec481a73046c2f?s=128&d=identicon&r=PG", "display_name": "Guffa", "link": "https://stackoverflow.com/users/69083/guffa"}, "is_accepted": true, "score": 1, "last_activity_date": 1423695418, "creation_date": 1423695418, "answer_id": 28466180, "question_id": 28466037, "link": "https://stackoverflow.com/questions/28466037/using-contains-or-indexof-with-counter-in-c/28466180#28466180", "title": "Using Contains or IndexOf with counter in C#", "body": "<p>The expression <code>\"Object\" + ObjN++</code> will be evaluated once before the <code>Replace</code> method is called, not for each replacement. Having the loop doesn't help, as the <code>Replace</code> method will replace all instances, not just the first.</p>\n\n<p>If you use <code>Regex.Replace</code> you can specify a function to create the value:</p>\n\n<pre><code>int cnt = 0;\neditor.Rtf = Regex.Replace(editor.Rtf, \"CreateObject\", m =&gt; \"Object\" + (cnt++));\n</code></pre>\n"}], "owner": {"reputation": 342, "user_id": 4424019, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f5e685ce41fce0c69079ce47c618b0a3?s=128&d=identicon&r=PG&f=1", "display_name": "Tom S", "link": "https://stackoverflow.com/users/4424019/tom-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 28466180, "answer_count": 2, "score": 0, "last_activity_date": 1423695418, "creation_date": 1423694821, "last_edit_date": 1423695415, "question_id": 28466037, "link": "https://stackoverflow.com/questions/28466037/using-contains-or-indexof-with-counter-in-c", "title": "Using Contains or IndexOf with counter in C#", "body": "<p>I'm trying to use a counter with Replace but no success.</p>\n\n<pre><code>int ObjN = 0;\nwhile (editor.Rtf.Contains(\"CreateObject\") == true) \n{\n editor.Rtf = editor.Rtf.Replace(\"CreateObject\", \"Object\" + ObjN++);\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>Object0\nObject0\nObject0\n</code></pre>\n\n<p>I expected </p>\n\n<pre><code>Object0\nObject1\nObject2\n</code></pre>\n\n<p>instead.  How can I get that output?</p>\n"}, {"tags": ["c#", "gridview", "windows-store-apps", "winrt-xaml"], "answers": [{"comments": [{"owner": {"reputation": 8525, "user_id": 352867, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/78d828e68904cbb305e8990a062f1d61?s=128&d=identicon&r=PG", "display_name": "roryok", "link": "https://stackoverflow.com/users/352867/roryok"}, "edited": false, "score": 0, "creation_date": 1424081573, "post_id": 28519250, "comment_id": 45391971, "body": "I&#39;m trying to align the columns. I&#39;ll try stretching the textblocks. Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3346310"}, "is_accepted": false, "score": 1, "last_activity_date": 1423941332, "creation_date": 1423941332, "answer_id": 28519250, "question_id": 28466005, "link": "https://stackoverflow.com/questions/28466005/fixed-width-columns-inside-a-xaml-gridview/28519250#28519250", "title": "Fixed width columns inside a XAML GridView", "body": "<p>I am not quite sure i do understand your problem,\nare you trying to align content of columns? \nif so try stretching textboxes\nare you trying to align header <code>Grid</code> with <code>GridView</code> content?\nif so try adding header data into <code>GridView</code> along with GridView data</p>\n"}], "owner": {"reputation": 8525, "user_id": 352867, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/78d828e68904cbb305e8990a062f1d61?s=128&d=identicon&r=PG", "display_name": "roryok", "link": "https://stackoverflow.com/users/352867/roryok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423941332, "creation_date": 1423694671, "question_id": 28466005, "link": "https://stackoverflow.com/questions/28466005/fixed-width-columns-inside-a-xaml-gridview", "title": "Fixed width columns inside a XAML GridView", "body": "<p>I have a XAML GridView, each row of which contains a Grid. I'm trying to align all the columns together like I would in a HTML table but I'm not having any luck. Here's my XAML</p>\n\n<pre><code>&lt;Grid Grid.Row=\"1\" Grid.ColumnSpan=\"2\" Margin=\"20,0,20,0\" Background=\"BlueViolet\"&gt;\n    &lt;Grid.ColumnDefinitions&gt;\n        &lt;ColumnDefinition Width=\"8*\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n        &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n    &lt;/Grid.ColumnDefinitions&gt;\n    &lt;TextBlock Grid.Column=\"0\" Text=\"Name\" Margin=\"5\" /&gt;\n    &lt;TextBlock Grid.Column=\"1\" Text=\"WordCount\" Margin=\"5\" /&gt;\n    &lt;TextBlock Grid.Column=\"2\" Text=\"Created\" Margin=\"5\" /&gt;\n    &lt;TextBlock Grid.Column=\"3\" Text=\"Updated\" Margin=\"5\" /&gt;\n    &lt;TextBlock Grid.Column=\"4\" Text=\"Version\" Margin=\"5\" /&gt;\n&lt;/Grid&gt;\n\n&lt;GridView Grid.Row=\"2\" Grid.ColumnSpan=\"2\" x:Name=\"Files_Grid\" Margin=\"20,0,20,20\" ItemsSource=\"{Binding ElementName=App_Frame, Path=DataContext.FilesCollection}\" \n            ScrollViewer.VerticalScrollMode=\"Enabled\" ScrollViewer.VerticalScrollBarVisibility=\"Visible\" VerticalContentAlignment=\"Stretch\" VerticalAlignment=\"Stretch\"&gt;\n    &lt;GridView.ItemTemplate&gt;\n        &lt;DataTemplate&gt;\n            &lt;Grid Tapped=\"Files_Grid_Row_Tapped\" RightTapped=\"Files_Grid_Row_RightTapped\" Tag=\"{Binding GUID}\" Width=\"Auto\" VerticalAlignment=\"Stretch\"&gt;\n                &lt;Grid.ColumnDefinitions&gt;\n                    &lt;ColumnDefinition Width=\"8*\"&gt;&lt;/ColumnDefinition&gt;\n                    &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n                    &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n                    &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n                    &lt;ColumnDefinition Width=\"1*\"&gt;&lt;/ColumnDefinition&gt;\n                &lt;/Grid.ColumnDefinitions&gt;\n                &lt;StackPanel Grid.Column=\"0\" Visibility=\"{Binding Name_Edit_Visibility}\" Margin=\"5\" Orientation=\"Horizontal\"&gt;\n                    &lt;TextBox Text=\"{Binding Name, Mode=TwoWay}\"&gt;&lt;/TextBox&gt;\n                    &lt;Button Tapped=\"Files_Grid_Row_Edit_Name_OK_Tapped\"&gt;OK&lt;/Button&gt;\n                    &lt;Button Tapped=\"Files_Grid_Row_Edit_Name_Cancel_Tapped\"&gt;Cancel&lt;/Button&gt;\n                &lt;/StackPanel&gt;\n                &lt;TextBlock Grid.Column=\"0\" Text=\"{Binding LatestVersion.Name}\" Margin=\"5\"&gt;&lt;/TextBlock&gt;\n                &lt;TextBlock Grid.Column=\"1\" Text=\"{Binding LatestVersion.WordCount}\" HorizontalAlignment=\"Right\" Margin=\"5\"&gt;&lt;/TextBlock&gt;\n                &lt;TextBlock Grid.Column=\"2\" Text=\"{Binding Created}\" Margin=\"5\" HorizontalAlignment=\"Right\"&gt;&lt;/TextBlock&gt;\n                &lt;TextBlock Grid.Column=\"3\" Text=\"{Binding LatestVersion.Updated}\" Margin=\"5\" HorizontalAlignment=\"Right\"&gt;&lt;/TextBlock&gt;\n                &lt;TextBlock Grid.Column=\"4\" Text=\"{Binding LatestVersion.VersionNumber}\" Margin=\"5\" HorizontalAlignment=\"Right\"&gt;&lt;/TextBlock&gt;\n            &lt;/Grid&gt;\n        &lt;/DataTemplate&gt;\n    &lt;/GridView.ItemTemplate&gt;\n    &lt;GridView.ItemsPanel&gt;\n        &lt;ItemsPanelTemplate&gt;\n            &lt;VirtualizingStackPanel HorizontalAlignment=\"Left\" VerticalAlignment=\"Stretch\" /&gt;\n        &lt;/ItemsPanelTemplate&gt;\n    &lt;/GridView.ItemsPanel&gt;\n    &lt;GridView.ItemContainerStyle&gt;\n        &lt;Style TargetType=\"GridViewItem\"&gt;\n            &lt;Setter Property=\"HorizontalContentAlignment\"  Value=\"Stretch\" /&gt;\n            &lt;Setter Property=\"VerticalContentAlignment\"  Value=\"Stretch\" /&gt;\n            &lt;Setter Property=\"VerticalAlignment\" Value=\"Stretch\" /&gt;\n        &lt;/Style&gt;\n    &lt;/GridView.ItemContainerStyle&gt;\n&lt;/GridView&gt;\n</code></pre>\n\n<p>As you can see I've tried setting VerticalAlignment and VerticalContentAlignment to stretch just about everywhere I can think of, but each row of the resulting gridview has slightly different column widths. </p>\n\n<p>How to I make each GridView row have the same width columns, without actually setting a fixed width? </p>\n"}, {"tags": ["c#", "asp.net-mvc", "linq", "asp.net-mvc-4", "razor"], "comments": [{"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1423694653, "post_id": 28465943, "comment_id": 45257667, "body": "I don&#39;t understand this --&gt; &#39;I want to get the TotalScore value from one of them from each 5 objects are having the same value for TotalScore for each ID.&#39;"}, {"owner": {"reputation": 2939, "user_id": 475820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef025a16736eda12bdb52a82229aaad?s=128&d=identicon&r=PG&f=1", "display_name": "TLS", "link": "https://stackoverflow.com/users/475820/tls"}, "edited": false, "score": 0, "creation_date": 1423694742, "post_id": 28465943, "comment_id": 45257703, "body": "So... you want to go from a collection of 50 objects to a collection of 10 objects, assuming that there are 10 sets of 5 objects with the same ID? Is the TotalScore in each set of 5 different or the same?  Please show an example data set to help us understand."}, {"owner": {"reputation": 7259, "user_id": 362479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/p91ff.jpg?s=128&g=1", "display_name": "Laziale", "link": "https://stackoverflow.com/users/362479/laziale"}, "reply_to_user": {"reputation": 2939, "user_id": 475820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef025a16736eda12bdb52a82229aaad?s=128&d=identicon&r=PG&f=1", "display_name": "TLS", "link": "https://stackoverflow.com/users/475820/tls"}, "edited": false, "score": 0, "creation_date": 1423695011, "post_id": 28465943, "comment_id": 45257800, "body": "@TLS yes like each 5 objects are having same id and same totalscore. I want to get the totalscore based on the competitor id thx"}, {"owner": {"reputation": 2345, "user_id": 537674, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9226af0c8c932d394a55932c9ef69234?s=128&d=identicon&r=PG&f=1", "display_name": "nik0lai", "link": "https://stackoverflow.com/users/537674/nik0lai"}, "edited": false, "score": 0, "creation_date": 1423733791, "post_id": 28465943, "comment_id": 45271486, "body": "I&#39;m also confused, do you want the Sum(TotalScore), or a collection of TotalScore for each competitor?"}], "answers": [{"tags": [], "owner": {"reputation": 2939, "user_id": 475820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef025a16736eda12bdb52a82229aaad?s=128&d=identicon&r=PG&f=1", "display_name": "TLS", "link": "https://stackoverflow.com/users/475820/tls"}, "is_accepted": false, "score": 0, "last_activity_date": 1423695274, "last_edit_date": 1423695274, "creation_date": 1423694972, "answer_id": 28466083, "question_id": 28465943, "link": "https://stackoverflow.com/questions/28465943/mvc-razor-linq-statement-which-is-including-firstordefault-and-where-clause/28466083#28466083", "title": "mvc razor linq statement which is including firstordefault and where clause", "body": "<p>If I'm understanding the question correctly, I think what you want is <code>Distinct</code> instead of the <code>Where</code> and the <code>Select</code> and no <code>FirstOrDefault</code> on the end.</p>\n\n<pre><code>@Model.OrdinalDataList.Distinct().Select(x =&gt; x.TotalScore)\n</code></pre>\n\n<p>NOTE:  untested!</p>\n\n<p>If that doesn't work because there are more properties in the objects, then you might need to do a <code>Select</code> before the <code>Distinct</code> to get a projection of just the <code>ID</code> and <code>TotalScore</code> properties and then do the final <code>Select</code> to get just the <code>TotalScore</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "is_accepted": false, "score": 0, "last_activity_date": 1423695581, "creation_date": 1423695581, "answer_id": 28466222, "question_id": 28465943, "link": "https://stackoverflow.com/questions/28465943/mvc-razor-linq-statement-which-is-including-firstordefault-and-where-clause/28466222#28466222", "title": "mvc razor linq statement which is including firstordefault and where clause", "body": "<p>I'm confused as to why you have the same data in your list 5 times, but this should get the TotalScore of the first item in the list with the matching competitor ID:</p>\n\n<pre><code>var score = @Model.OrdinalDataList.FirstOrDefault(s =&gt; s.CompetitorId == c.Id).TotalScore;\n</code></pre>\n"}], "owner": {"reputation": 7259, "user_id": 362479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/p91ff.jpg?s=128&g=1", "display_name": "Laziale", "link": "https://stackoverflow.com/users/362479/laziale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2077, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1423695581, "creation_date": 1423694368, "last_edit_date": 1423695074, "question_id": 28465943, "link": "https://stackoverflow.com/questions/28465943/mvc-razor-linq-statement-which-is-including-firstordefault-and-where-clause", "title": "mvc razor linq statement which is including firstordefault and where clause", "body": "<p>I would like to know if its possible to fix this statement:</p>\n\n<pre><code>@Model.OrdinalDataList.Where(s =&gt;s.CompetitorId == c.Id).Select(x =&gt; x.TotalScore).FirstOrDefault()\n</code></pre>\n\n<p>For example, I have a list of 50 objects, and each 5 objects have the same ID. </p>\n\n<p>I want to get the TotalScore value from one of them from each 5 objects that have the same value for TotalScore for each ID.</p>\n\n<p>Using FirstOrDefault gives me the first value in the collection no matter what the ID of the competitor is.</p>\n\n<p>So my question is, what am I missing here to make this statement work correctly.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "asp.net-mvc-3"], "answers": [{"tags": [], "owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "is_accepted": false, "score": 0, "last_activity_date": 1423694513, "creation_date": 1423694513, "answer_id": 28465977, "question_id": 28465924, "link": "https://stackoverflow.com/questions/28465924/mvc-radio-button-selected-one/28465977#28465977", "title": "MVC Radio button selected one", "body": "<p>You're using malformed HTML. The proper way to mark something as checked would be</p>\n\n<pre><code>{ @checked = \"checked\" }\n</code></pre>\n\n<p>and don't include the checked attribute at all for the unchecked radio buttons.</p>\n"}, {"comments": [{"owner": {"reputation": 226, "user_id": 2675770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e629ae017fd738a704009766f5a454b?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2675770/kevin"}, "edited": false, "score": 0, "creation_date": 1496673450, "post_id": 28465979, "comment_id": 75743922, "body": "How does one dynamically add the checked attribute to the appropriate RadioButton? Assuming that the list of options is built dynamically."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "reply_to_user": {"reputation": 226, "user_id": 2675770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e629ae017fd738a704009766f5a454b?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2675770/kevin"}, "edited": false, "score": 0, "creation_date": 1496700063, "post_id": 28465979, "comment_id": 75757590, "body": "@Kevin, You need to ask a new question withe the relevant details"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "is_accepted": true, "score": 2, "last_activity_date": 1423694527, "creation_date": 1423694527, "answer_id": 28465979, "question_id": 28465924, "link": "https://stackoverflow.com/questions/28465924/mvc-radio-button-selected-one/28465979#28465979", "title": "MVC Radio button selected one", "body": "<p>Do not set the <code>checked</code> attribute. <code>@checked = \"true\"</code> and <code>@checked = \"false\"</code> (and <code>checked</code> or <code>checked=\"checked\"</code> or <code>checked=\"anything\"</code>) all set the <code>checked</code> attribute. As the DOM is read, the first one is checked, then the second, and finally the last one is checked.</p>\n\n<p>If the value of propery is <code>IsSatisFied</code> is <code>Satisfaction.Maybe</code> then the second radio button will be selected (that's how model binding works)</p>\n"}, {"tags": [], "owner": {"reputation": 25185, "user_id": 1185053, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/58c51dfdd3eab064c2c29c7c0d1e4c6b?s=128&d=identicon&r=PG&f=1", "display_name": "dav_i", "link": "https://stackoverflow.com/users/1185053/dav-i"}, "is_accepted": false, "score": 0, "last_activity_date": 1423695353, "last_edit_date": 1592644375, "creation_date": 1423694581, "answer_id": 28465992, "question_id": 28465924, "link": "https://stackoverflow.com/questions/28465924/mvc-radio-button-selected-one/28465992#28465992", "title": "MVC Radio button selected one", "body": "<p>The <a href=\"http://www.w3.org/TR/html5/forms.html#radio-button-state-(type=radio)\" rel=\"nofollow noreferrer\">HTML specification</a> says:</p>\n<blockquote>\n<p>When any of the following phenomena occur, <strong>if the element's checkedness state is true after the occurrence, the checkedness state of all the other elements in the same radio button group must be set to false</strong>:</p>\n<ul>\n<li><strong>The element's checkedness state is set to true (for whatever reason).</strong></li>\n<li>The element's name attribute is set, changed, or removed.</li>\n<li>The element's form owner changes.</li>\n</ul>\n</blockquote>\n<p>So as the HTML is parsed going down the page, if multiple radios are <code>checked</code> then the last one will always be selected. As such, you only want to set one checked attribute by setting <code>checked=&quot;checked&quot;</code>:</p>\n<pre><code>@Html.RadioButtonFor(\n    model =&gt; model.IsSatisFied, \n    Satisfaction.Not, \n    new { @checked = &quot;checked&quot; }) \n@Html.RadioButtonFor(model =&gt; model.IsSatisFied, Satisfaction.Maybe)  \n@Html.RadioButtonFor(model =&gt; model.IsSatisFied, Satisfaction.Yes)  \n</code></pre>\n"}], "owner": {"reputation": 45983, "user_id": 177883, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1e1f4dbb6e64ed8de79766168a3db197?s=128&d=identicon&r=PG", "display_name": "DarthVader", "link": "https://stackoverflow.com/users/177883/darthvader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5357, "favorite_count": 0, "accepted_answer_id": 28465979, "answer_count": 3, "score": 2, "last_activity_date": 1423695353, "creation_date": 1423694303, "question_id": 28465924, "link": "https://stackoverflow.com/questions/28465924/mvc-radio-button-selected-one", "title": "MVC Radio button selected one", "body": "<p>I have radio button as below for some reason even though the first one is checked, always the last one shows up checked on the form page. Why ? How can i fix this?</p>\n\n<pre><code>@Html.RadioButtonFor(model =&gt; model.IsSatisFied, Satisfaction.Not, new { @checked = \"true\" }) \n@Html.RadioButtonFor(model =&gt; model.IsSatisFied, Satisfaction.Maybe, new { @checked = \"false\" })  \n@Html.RadioButtonFor(model =&gt; model.IsSatisFied, Satisfaction.Yes, new { @checked = \"false\" })  \n</code></pre>\n"}, {"tags": ["c#", "active-directory", "ldap"], "comments": [{"owner": {"reputation": 5294, "user_id": 30384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7167f7b050a615573feb2555e3346e5f?s=128&d=identicon&r=PG", "display_name": "sfuqua", "link": "https://stackoverflow.com/users/30384/sfuqua"}, "edited": false, "score": 0, "creation_date": 1423694565, "post_id": 28465764, "comment_id": 45257617, "body": "&quot;... this doesn&#39;t work on our domain.&quot; Can you explain that? Are you saying that you can&#39;t query the LDAP / ADS server without username and password?"}], "answers": [{"comments": [{"owner": {"reputation": 81865, "user_id": 160173, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcf9850250d6a24e379401d22d530a09?s=128&d=identicon&r=PG", "display_name": "David Murdoch", "link": "https://stackoverflow.com/users/160173/david-murdoch"}, "edited": false, "score": 0, "creation_date": 1423760848, "post_id": 28469603, "comment_id": 45289007, "body": "Oddly enough, this morning when I came in to the office and ran the code (without changing it) it just worked. A chaos monkey must have been rustling around in our network yesterday. Curiously, our domain is actually <code>server.sci.com</code>, which works, as does the <code>USERDNSDOMAIN</code> value of just <code>sci.com</code>."}, {"owner": {"reputation": 81865, "user_id": 160173, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcf9850250d6a24e379401d22d530a09?s=128&d=identicon&r=PG", "display_name": "David Murdoch", "link": "https://stackoverflow.com/users/160173/david-murdoch"}, "edited": false, "score": 0, "creation_date": 1423782337, "post_id": 28469603, "comment_id": 45300495, "body": "And 5 hours later this solution errors out with &quot;A local error occurred&quot;. I have no clue what is going on."}, {"owner": {"reputation": 62786, "user_id": 608772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35cf71263d56e83098663925b4915349?s=128&d=identicon&r=PG", "display_name": "JPBlanc", "link": "https://stackoverflow.com/users/608772/jpblanc"}, "reply_to_user": {"reputation": 81865, "user_id": 160173, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcf9850250d6a24e379401d22d530a09?s=128&d=identicon&r=PG", "display_name": "David Murdoch", "link": "https://stackoverflow.com/users/160173/david-murdoch"}, "edited": false, "score": 0, "creation_date": 1423807720, "post_id": 28469603, "comment_id": 45307304, "body": "You don&#39;t give any clue, first can you log the exception. Second without clues, statisticaly your problem comes from your DNS resolution (80% of the AD authentication problem comes from that)"}], "tags": [], "owner": {"reputation": 62786, "user_id": 608772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35cf71263d56e83098663925b4915349?s=128&d=identicon&r=PG", "display_name": "JPBlanc", "link": "https://stackoverflow.com/users/608772/jpblanc"}, "is_accepted": true, "score": 2, "last_activity_date": 1423717049, "creation_date": 1423717049, "answer_id": 28469603, "question_id": 28465764, "link": "https://stackoverflow.com/questions/28465764/using-new-principalcontextcontexttype-domain-domain-name-com-without-havi/28469603#28469603", "title": "Using `new PrincipalContext(ContextType.Domain, &quot;domain.name.com&quot;)` without having to provide the username and password", "body": "<p><em>\"You've seen many examples online using the constructor without specifying credentials\"</em> This should work on your machine as far as your computer belongs to the domain and the user is logged in.</p>\n\n<p>For me the error can come from the fact that when you use :</p>\n\n<pre><code>var pc = new PrincipalContext(ContextType.Domain, domain);\n</code></pre>\n\n<p><code>domain</code> is supposed to be the domain name, given by the environnement variable <code>USERDNSDOMAIN</code> if the user is logged into the domain, and not <em>\"The name of the domain server, e.g., server.domain.com\"</em> as you write into the comment.</p>\n"}], "owner": {"reputation": 81865, "user_id": 160173, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcf9850250d6a24e379401d22d530a09?s=128&d=identicon&r=PG", "display_name": "David Murdoch", "link": "https://stackoverflow.com/users/160173/david-murdoch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19687, "favorite_count": 0, "accepted_answer_id": 28469603, "answer_count": 1, "score": 2, "last_activity_date": 1563262113, "creation_date": 1423693641, "question_id": 28465764, "link": "https://stackoverflow.com/questions/28465764/using-new-principalcontextcontexttype-domain-domain-name-com-without-havi", "title": "Using `new PrincipalContext(ContextType.Domain, &quot;domain.name.com&quot;)` without having to provide the username and password", "body": "<p>I've built an application that will be deployed with ClickOnce that, upon startup, will need to check the currently logged in user's Identity/Name, and compare it to the Active Directory Groups on our domain in order to set up appropriate permissions in the application.</p>\n\n<p>I can do this by \"hard coding\" a username and password into the application, and passing these credentials into the <code>PrincipalContext</code> constructor, i.e.,</p>\n\n<pre><code>var pc = new PrincipalContext(ContextType.Domain, \"domain.name.com\", username, password);\n</code></pre>\n\n<p>The problem is that I don't want to have to store the username and password in the application (and I don't want to have to prompt the user for their username and password, either).</p>\n\n<p>I've seen many examples online using the constructor without specifying credentials, but this doesn't work on our domain.</p>\n\n<p><strong>Is there a setting/permission in the Domain or \"Domain Users\" Group properties that I can configure to get this to work?</strong></p>\n\n<p>My current code is as follows (note that :</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Gets a list of all Active Directory Groups the specified username is a member of.\n/// &lt;/summary&gt;\n/// &lt;param name=\"userName\"&gt;The username of the user in DOMAIN\\Username format&lt;/param&gt;\n/// &lt;param name=\"domain\"&gt;The name of the domain server, e.g., server.domain.com (not DOMAIN or DOMAIN.COM or SERVER)&lt;/param&gt;\n/// &lt;returns&gt;&lt;/returns&gt;\npublic static List&lt;string&gt; GetUserGroups(string userName, string domain)\n{\n    if (userName.IsNullOrWhiteSpace()) return null;\n\n    var pc = new PrincipalContext(ContextType.Domain, domain);\n    var userPc = UserPrincipal.FindByIdentity(pc, userName);\n\n    if (userPc == null) return null;\n\n    var src = userPc.GetGroups(pc);\n    var result = new List&lt;string&gt;();\n    src.ToList().ForEach(sr =&gt; result.Add(sr.SamAccountName));\n    return result;\n}\n</code></pre>\n\n<p>And I'm essentially calling is like this:</p>\n\n<pre><code>var userGroups = GetUserGroups(WindowsIdentity.GetCurrent.Name, \"server.domain.com\");\n</code></pre>\n"}, {"tags": ["c#", "jqgrid-asp.net"], "answers": [{"comments": [{"owner": {"reputation": 2333, "user_id": 1426542, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/HT6sS.png?s=128&g=1", "display_name": "smr5", "link": "https://stackoverflow.com/users/1426542/smr5"}, "edited": false, "score": 0, "creation_date": 1423696790, "post_id": 28466371, "comment_id": 45258545, "body": "That&#39;s it. the path for the <code>JavaScript</code> file was incorrect. Thank you."}], "tags": [], "owner": {"reputation": 8053, "user_id": 292502, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/PVqCK.jpg?s=128&g=1", "display_name": "Csaba Toth", "link": "https://stackoverflow.com/users/292502/csaba-toth"}, "is_accepted": true, "score": 1, "last_activity_date": 1423696300, "creation_date": 1423696300, "answer_id": 28466371, "question_id": 28465757, "link": "https://stackoverflow.com/questions/28465757/jqgrid-in-asp-net-not-displaying-data-not-visible/28466371#28466371", "title": "JQGrid in asp.net not displaying data (not visible)", "body": "<p>My two cents.</p>\n\n<ol>\n<li><p>Make sure that the grid locale js file is in the right place and served well to your browser. See the related line:\n<code>&lt;script src=\"/js/trirand/i18n/grid.locale-en.js\" type=\"text/javascript\"&gt;&lt;/script&gt;</code>\nOpen up your developer console with F12, refresh the page and look for the downloaded files and error messages on the console which can tell if this doesn't go well.</p></li>\n<li><p>Double check that the data you serve matches the column configuration. Pay special attention to camel casing. .NET properties start with uppercase, they are camel cased, but JSON data often starts with lowercase. That also depends on if you use any transformations (like NewtonSoft and stuff). I don't know what's in your <code>voiceportal.dbo.clients_v</code> table, please specify your schema. In your ASPX code <code>Addressbookid</code> and <code>Clientno</code> are not camel cased. Shouldn't they be <code>AddressbookId</code> and <code>ClientNo</code>? Depends on your schema and what actually comes through the wire.</p></li>\n</ol>\n"}], "owner": {"reputation": 2333, "user_id": 1426542, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/HT6sS.png?s=128&g=1", "display_name": "smr5", "link": "https://stackoverflow.com/users/1426542/smr5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 28466371, "answer_count": 1, "score": 0, "last_activity_date": 1423696300, "creation_date": 1423693594, "last_edit_date": 1592644375, "question_id": 28465757, "link": "https://stackoverflow.com/questions/28465757/jqgrid-in-asp-net-not-displaying-data-not-visible", "title": "JQGrid in asp.net not displaying data (not visible)", "body": "<p>I'm following <a href=\"http://www.trirand.net/examples/grid/editing_data/edit_add_delete/default.aspx\" rel=\"nofollow noreferrer\">this</a> example and I'm having some hard time displaying data in a gridview. When the page is loaded it gets to <code>GetData</code> and returns values.</p>\n<p>If in the immediate windows after I fill datatable and see the count <code>?dtResult.Rows.Count</code> I get <code>1001</code>. So I know I have data.\nHowever, when the I debug the app I just get the three buttons. What am I missing here?</p>\n<p>Here's the <code>aspx</code> code:</p>\n<pre><code>&lt;%@ Page Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;test.aspx.cs&quot; Inherits=&quot;TestApp.test&quot; %&gt;\n&lt;%@ Register Assembly=&quot;Trirand.Web&quot; TagPrefix=&quot;trirand&quot; Namespace=&quot;Trirand.Web.UI.WebControls&quot; %&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en-us&quot;&gt;\n&lt;head id=&quot;Head1&quot; runat=&quot;server&quot;&gt;\n&lt;meta charset=&quot;utf-8&quot;&gt;\n&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;screen&quot; href=&quot;http://ajax.aspnetcdn.com/ajax/jquery.ui/1.10.3/themes/redmond/jquery-ui.css&quot; /&gt;\n&lt;!-- The jQuery UI theme extension jqGrid needs --&gt;\n&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; media=&quot;screen&quot; href=&quot;/themes/ui.jqgrid.css&quot; /&gt;\n&lt;!-- jQuery runtime minified --&gt;\n&lt;script src=&quot;http://ajax.microsoft.com/ajax/jquery/jquery-2.0.3.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;\n&lt;!-- The localization file we need, English in this case --&gt;\n&lt;script src=&quot;/js/trirand/i18n/grid.locale-en.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;\n&lt;!-- The jqGrid client-side javascript --&gt;\n&lt;script src=&quot;/js/trirand/jquery.jqGrid.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;    \n\n&lt;style type=&quot;text/css&quot;&gt;\n    body, html { font-size: 80%; }    \n&lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form id=&quot;form1&quot; runat=&quot;server&quot;&gt;\n&lt;div&gt;       \n   &lt;div id=&quot;message&quot;&gt;\n   \n   &lt;script type=&quot;text/javascript&quot;&gt;\n\n       function addRow() {\n           var grid = jQuery(&quot;#&lt;%= JQGrid1.ClientID %&gt;&quot;);\n           grid.editGridRow(&quot;new&quot;, grid.addDialogOptions);\n       }\n\n       function editRow() {\n           var grid = jQuery(&quot;#&lt;%= JQGrid1.ClientID %&gt;&quot;);\n           var rowKey = grid.getGridParam(&quot;selrow&quot;);\n           var editOptions = grid.getGridParam('editDialogOptions');\n           if (rowKey) {\n               grid.editGridRow(rowKey, editOptions);\n           }\n           else {\n               alert(&quot;No rows are selected&quot;);\n           }\n       }\n\n       function delRow() {\n           var grid = jQuery(&quot;#&lt;%= JQGrid1.ClientID %&gt;&quot;);\n           var rowKey = grid.getGridParam(&quot;selrow&quot;);\n           if (rowKey) {\n               grid.delGridRow(rowKey, grid.delDialogOptions);\n           }\n           else {\n               alert(&quot;No rows are selected&quot;);\n           }\n       }\n   &lt;/script&gt;\n   \n   &lt;input type=&quot;button&quot; onclick=&quot;addRow()&quot; value=&quot;Add&quot; /&gt;\n   &lt;input type=&quot;button&quot; onclick=&quot;editRow()&quot; value=&quot;Edit&quot; /&gt;\n   &lt;input type=&quot;button&quot; onclick=&quot;delRow()&quot; value=&quot;Delete&quot; /&gt;\n  \n    &lt;trirand:jqgrid runat=&quot;server&quot; ID=&quot;JQGrid1&quot;\n        OnRowDeleting=&quot;JQGrid1_RowDeleting&quot;\n        OnRowAdding=&quot;JQGrid1_RowAdding&quot;\n        OnRowEditing=&quot;JQGrid1_RowEditing&quot;&gt;         \n        &lt;Columns&gt;\n            &lt;trirand:JQGridColumn DataField=&quot;Addressbookid&quot; Editable=&quot;false&quot; PrimaryKey=&quot;true&quot; /&gt;\n            &lt;trirand:JQGridColumn DataField=&quot;ClientName&quot; Editable=&quot;true&quot; /&gt;\n            &lt;trirand:JQGridColumn DataField=&quot;Clientno&quot; Editable=&quot;true&quot; /&gt;\n            &lt;trirand:JQGridColumn DataField=&quot;IndustryName&quot; Editable=&quot;true&quot; /&gt;             \n        &lt;/Columns&gt;\n        &lt;ToolBarSettings ShowEditButton=&quot;true&quot; ShowAddButton=&quot;true&quot; ShowDeleteButton=&quot;true&quot; /&gt;\n        &lt;EditDialogSettings CloseAfterEditing=&quot;true&quot; Caption=&quot;The Edit Dialog&quot;  /&gt;\n        &lt;AddDialogSettings CloseAfterAdding=&quot;true&quot; /&gt;              \n\n    &lt;/trirand:jqgrid&gt;\n\n   &lt;/div&gt;\n   &lt;br /&gt;&lt;br /&gt;\n  \n   \n&lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n\n<p>Here's the codebehind:</p>\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing System.Data.SqlClient;\nusing System.Data;\nusing System.Configuration;\n\nnamespace TestApp\n{\npublic partial class test : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        JQGrid1.DataSource = GetData();\n        JQGrid1.DataBind();\n    }\n   \n\n    protected DataTable GetData()\n    {\n        if (Session[&quot;EditDialogData&quot;] == null)\n        {\n            // Create a new Sql Connection and set connection string accordingly\n            SqlConnection sqlConnection = new SqlConnection();\n            sqlConnection.ConnectionString = ConfigurationManager.ConnectionStrings[&quot;Sandbox&quot;].ConnectionString;\n            sqlConnection.Open();\n\n            string sqlStatement = &quot;Select * from voiceportal.dbo.clients_v&quot;;\n\n            // Create a SqlDataAdapter to get the results as DataTable\n            SqlDataAdapter sqlDataAdapter = new SqlDataAdapter(sqlStatement, sqlConnection);\n\n            // Create a new DataTable\n            DataTable dtResult = new DataTable();\n\n            // Fill the DataTable with the result of the SQL statement\n            sqlDataAdapter.Fill(dtResult);\n\n            Session[&quot;EditDialogData&quot;] = dtResult;\n\n            return dtResult;\n        }\n        else\n        {\n            return Session[&quot;EditDialogData&quot;] as DataTable;\n        }\n    }\n}\n</code></pre>\n<p>}</p>\n<p>Any suggestions on how I can fix this?</p>\n<p>Thanks</p>\n"}, {"tags": ["c#", "sql-server", "entity-framework", "unit-testing", "ef-code-first"], "comments": [{"owner": {"reputation": 10823, "user_id": 1567352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bdfeb44480b0de2237a5fe8001b8233b?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Green", "link": "https://stackoverflow.com/users/1567352/brendan-green"}, "edited": false, "score": 0, "creation_date": 1423695166, "post_id": 28465672, "comment_id": 45257878, "body": "See <a href=\"http://stackoverflow.com/questions/9907905/entity-framework-code-first-how-to-seed-a-database-for-unit-testing\" title=\"entity framework code first how to seed a database for unit testing\">stackoverflow.com/questions/9907905/&hellip;</a>.  In short - create an initializer that drops and recreates your compact database, and then seed it.  Initialize the context at the start of your unit test, and it will be recreated each time the tests are run.  However, if you are wanting to hit a database, this is more of an integration test than a unit test."}], "answers": [{"comments": [{"owner": {"reputation": 3776, "user_id": 1085263, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3ca95a9b72b845c43890568d10638e80?s=128&d=identicon&r=PG", "display_name": "Quoter", "link": "https://stackoverflow.com/users/1085263/quoter"}, "edited": false, "score": 0, "creation_date": 1423695586, "post_id": 28466117, "comment_id": 45258074, "body": "If I mock the data, how can I pass the mocked data to my repository? See my updated answer in a minute or 1 for the repository code."}, {"owner": {"reputation": 10823, "user_id": 1567352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bdfeb44480b0de2237a5fe8001b8233b?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Green", "link": "https://stackoverflow.com/users/1567352/brendan-green"}, "edited": false, "score": 0, "creation_date": 1423696223, "post_id": 28466117, "comment_id": 45258324, "body": "Your mocked repository will return the data that you set up for the given test.  See something like: <a href=\"https://github.com/Moq/moq4/wiki/Quickstart\" rel=\"nofollow noreferrer\">github.com/Moq/moq4/wiki/Quickstart</a>.  That is, you configure the mock so that a call to <code>GetPersons</code> will operate against your test data."}, {"owner": {"reputation": 3776, "user_id": 1085263, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3ca95a9b72b845c43890568d10638e80?s=128&d=identicon&r=PG", "display_name": "Quoter", "link": "https://stackoverflow.com/users/1085263/quoter"}, "edited": false, "score": 0, "creation_date": 1423765806, "post_id": 28466117, "comment_id": 45291985, "body": "@Tim Jarvis, I&#39;m manly stuck with creating the database in memory, and I came across this blog post: <a href=\"https://msdn.microsoft.com/en-US/data/dn314431#doubles\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-US/data/dn314431#doubles</a>. They created an interface for their dbcontext to fill up the in-memory database. Is this a good post to use it as a reference?"}, {"owner": {"reputation": 17011, "user_id": 10387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09737bf87363b2c20da627b4a5072554?s=128&d=identicon&r=PG", "display_name": "Tim Jarvis", "link": "https://stackoverflow.com/users/10387/tim-jarvis"}, "reply_to_user": {"reputation": 3776, "user_id": 1085263, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3ca95a9b72b845c43890568d10638e80?s=128&d=identicon&r=PG", "display_name": "Quoter", "link": "https://stackoverflow.com/users/1085263/quoter"}, "edited": false, "score": 0, "creation_date": 1423787945, "post_id": 28466117, "comment_id": 45302351, "body": "@Quoter Well to be honest if you find yourself trying to put your dbContext in memory, I&#39;d question your test. I honestly think its a bad idea...in fact in this case you would be executing your Linq against Linq to objects and not Linq to EF - they behave differently - as far as I am concerned this makes the test potentially invalid."}, {"owner": {"reputation": 17011, "user_id": 10387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09737bf87363b2c20da627b4a5072554?s=128&d=identicon&r=PG", "display_name": "Tim Jarvis", "link": "https://stackoverflow.com/users/10387/tim-jarvis"}, "reply_to_user": {"reputation": 3776, "user_id": 1085263, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3ca95a9b72b845c43890568d10638e80?s=128&d=identicon&r=PG", "display_name": "Quoter", "link": "https://stackoverflow.com/users/1085263/quoter"}, "edited": false, "score": 0, "creation_date": 1423788603, "post_id": 28466117, "comment_id": 45302526, "body": "@Quoter having said all that my understanding is that EF 7.0 will provide support for In Memory data. - I think you can download the beta. So if you really insist on doing this...its probably possible with the next version."}, {"owner": {"reputation": 3776, "user_id": 1085263, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3ca95a9b72b845c43890568d10638e80?s=128&d=identicon&r=PG", "display_name": "Quoter", "link": "https://stackoverflow.com/users/1085263/quoter"}, "edited": false, "score": 0, "creation_date": 1423822116, "post_id": 28466117, "comment_id": 45313597, "body": "@Tim Javis, how do people unit test their database access logic? And did you see the link I pasted? Otherwise a blogpost would be really helpful. Words in a comment alone won&#39;t help me understand how to test the database access logic, like filtering data."}, {"owner": {"reputation": 17011, "user_id": 10387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09737bf87363b2c20da627b4a5072554?s=128&d=identicon&r=PG", "display_name": "Tim Jarvis", "link": "https://stackoverflow.com/users/10387/tim-jarvis"}, "reply_to_user": {"reputation": 3776, "user_id": 1085263, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3ca95a9b72b845c43890568d10638e80?s=128&d=identicon&r=PG", "display_name": "Quoter", "link": "https://stackoverflow.com/users/1085263/quoter"}, "edited": false, "score": 0, "creation_date": 1423875560, "post_id": 28466117, "comment_id": 45341282, "body": "@Quoter As a mentioned in my answer, people test their db access logic using Integration tests. (Unit tests over the service layer). There is no trick to it. They are just slower than Unit Tests. My point was simply don&#39;t substitute your database in an Integration test, because its not a valid test, the different db will behave differently, sometimes very subtly."}], "tags": [], "owner": {"reputation": 17011, "user_id": 10387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09737bf87363b2c20da627b4a5072554?s=128&d=identicon&r=PG", "display_name": "Tim Jarvis", "link": "https://stackoverflow.com/users/10387/tim-jarvis"}, "is_accepted": true, "score": 2, "last_activity_date": 1423696977, "last_edit_date": 1423696977, "creation_date": 1423695150, "answer_id": 28466117, "question_id": 28465672, "link": "https://stackoverflow.com/questions/28465672/how-to-unit-test-database-access-logic/28466117#28466117", "title": "How to unit test database access logic?", "body": "<p>ok, so switching to a different database for testing is (imo) a bad idea.</p>\n\n<p>Here is some terminology for you, that might help you to organize your tests better.</p>\n\n<p>A Unit test is for testing your business functionality, generally you would just mock your data for this, as you want to test what happens to your inputs (data) within your domain classes, not where they came from.</p>\n\n<p>An Integration test is for testing how your business domain layer interacts with your service layer (your data layer is a service layer), I would also regard testing the correctness of a query as an integration test for purposes of running them.</p>\n\n<p>So in your case, don't confuse things and potentially add unexpected behavior caused by differences in how the 2 databases work. If you are testing your business functionality mock your data for that. Its faster for a start, and you will be testing, just what you want to be testing.</p>\n\n<p>With your integration testing, you are testing that your interaction with the service layer is correct, in this case your test is not really testing that the business logic works, that should be covered in the unit tests; Test that your queries return the correct data for its predicates, and that any data that is to be persisted is persisted correctly. Also that any transactions in play are working as you expect. End to end testing of a scenario is also a valid integration test.</p>\n\n<p>You absolutely need to be doing this on the same database platform as your production, don't expect SQL Compact and SQL Server to behave the same way.</p>\n\n<p>Edit...For the comment.</p>\n\n<p>So the normal way that you would Mock your repository call is to use dependency injection, you don't have to do it this way, but its easier and pretty much best practice.</p>\n\n<p>The idea is that in your domain class that uses your data, you would first get your repository, or query class from the DI container that was either injected into the constructor or pulled from the DI container</p>\n\n<pre><code>// in your domain class you would have something like...\n    var repo = container.Get&lt;IRepository&gt;();\n    var myList = repo.GetMyObjects(predcate);\n</code></pre>\n\n<p>So with Moq your could now simply mock that call</p>\n\n<pre><code>//Where you do your container registration..\nvar repo = Mock&lt;IRepository&gt;\nrepo.Setup( o =&gt; o.GetMyObject(predecate)).Returns( (predecate) =&gt; &lt;your dummy list&gt;));\ncontainer.Register(repo.Object);\n// Then later on your business domain object gets the dummy repo instead.\n</code></pre>\n\n<p>Note this is pseudo code, will be slightly different per DI and Mocking frameworks used.</p>\n"}], "owner": {"reputation": 3776, "user_id": 1085263, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/3ca95a9b72b845c43890568d10638e80?s=128&d=identicon&r=PG", "display_name": "Quoter", "link": "https://stackoverflow.com/users/1085263/quoter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 28466117, "answer_count": 1, "score": 0, "last_activity_date": 1423696977, "creation_date": 1423693200, "last_edit_date": 1423695856, "question_id": 28465672, "link": "https://stackoverflow.com/questions/28465672/how-to-unit-test-database-access-logic", "title": "How to unit test database access logic?", "body": "<p>I have a project based on <code>EF Code First</code> using <code>MSSQL server</code>. In one of my repositories I'm dynamically building a query using <code>PredicateBuilder</code>. To test all possible outcome manually every time something changes in the code, is very time consuming. </p>\n\n<p>For that reason, I'd like to automate this by unit testing it. I was thinking about using <code>sql compact</code> for unit test and <code>MSSQL server</code> for production. But how would one enable migrations for <code>sql compact</code> server?</p>\n\n<p>This is dbContext class:</p>\n\n<pre><code>public partial class ApplicationDbContext :\n        IdentityDbContext&lt;ApplicationUser, ApplicationRole, int, ApplicationUserLogin, ApplicationUserRole, ApplicationUserClaim&gt;\n{\n    public ApplicationDbContext() : base(\"name=DefaultConnection\") { }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        Database.SetInitializer(new MigrateDatabaseToLatestVersion&lt;ApplicationDbContext, Configuration&gt;());\n        base.OnModelCreating(modelBuilder);\n     }\n}\n</code></pre>\n\n<p>Repository:</p>\n\n<pre><code>public class FilterRepository : IFilterRepository\n{\n    private ApplicationDbContext _dbContext;\n\n    public FilterRepository(ApplicationDbContext dbContext)\n    {\n        _dbContext = dbContext;\n        DbInterception.Add(new CommandInterceptor());\n    }\n\n    public IEnumerable&lt;Person&gt; GetPersons(Filter filter)\n    {\n        try\n        {\n            var persons = PredicateBuilder.False&lt;Person&gt;();\n\n            _dbContext.Configuration.AutoDetectChangesEnabled = false;\n\n            var result = _dbContext.Persons\n                            .AsNoTracking() \n                            .Where(persons)\n                            .OrderBy(x =&gt; x.Name)\n                            .Skip(filter.Skip)\n                            .Take(10)\n                            .ToList();\n\n            _dbContext.Configuration.AutoDetectChangesEnabled = true;\n\n            return result;\n        }\n        catch (Exception ex)\n        {\n\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "entity-framework-core"], "comments": [{"owner": {"reputation": 70250, "user_id": 189950, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1c322903e59543003a482710cc4b5cda?s=128&d=identicon&r=PG", "display_name": "Kirk Woll", "link": "https://stackoverflow.com/users/189950/kirk-woll"}, "edited": false, "score": 0, "creation_date": 1423754307, "post_id": 28465631, "comment_id": 45284522, "body": "Yeah, I don&#39;t understand why this was closed, particularly for that reason. The edit since I first saw your question has included the details I felt required.  Also upvoted and voted to re-open."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 1, "creation_date": 1423845243, "post_id": 28465631, "comment_id": 45327548, "body": "The reason I voted to close was you didn&#39;t include a full stack trace, which is necessary to find out where the code is that was applying the migrations. Luckily Brice was on the team that wrote the thing so he had prior knowledge of where this was occurring. But in the future, if you get an exception, you should include the exception message and stack trace, and the line of code that caused the exception, and you should include it at the beginning without needing someone to ask you for it."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1423854024, "post_id": 28465631, "comment_id": 45332669, "body": "@AidanRyan What you call &quot;spelunking around&quot; the rest of us tend to call problem solving. Including a full stacktrace would have almost immediately led us to the <code>Database.AsMigrationsEnabled().ApplyMigrations();</code> line. You are very lucky that a Microsoft employee happened to see your issue, but you can&#39;t count on that. Please include a full stacktrace, error message, and relevant code next time"}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1423854733, "post_id": 28465631, "comment_id": 45333052, "body": "@AidanRyan No. It doesn&#39;t look like a full stack trace. And now that I see in your comment on Brice&#39;s answer that you don&#39;t have that line (<code>Database.AsMigrationsEnabled().ApplyMigrations();</code>), so now it becomes even more critical that you include the full stack trace."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1423855256, "post_id": 28465631, "comment_id": 45333329, "body": "@AidanRyan I voted to close because there was not and is not enough information to properly diagnose the problem. Closing it is not an insult, it&#39;s a signal to you that more information is needed in the question. Myself and four others felt there wasn&#39;t enough information to close it. It was not a knee-jerk reaction, and we&#39;re trying to help you, not harm you or prevent you from solving your problem. Since you say that you have provided a complete stack trace, you should look for an inner exception and check your startup code for anything migration related. Doing a Control-F may help too."}], "answers": [{"comments": [{"owner": {"reputation": 10791, "user_id": 1042, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f01d06e6dcd2be5ea4519f97703797d8?s=128&d=identicon&r=PG", "display_name": "Aidan Ryan", "link": "https://stackoverflow.com/users/1042/aidan-ryan"}, "edited": false, "score": 2, "creation_date": 1423854048, "post_id": 28504178, "comment_id": 45332685, "body": "Hi Brice, thanks for helping out. I actually created this project from scratch and there is no call to ApplyMigrations. I am using EntityFramework.SqlServer 7.0.0-beta2."}], "tags": [], "owner": {"reputation": 23568, "user_id": 475031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0acdc3c6c824b2a2d798ea94e49a5e5?s=128&d=identicon&r=PG", "display_name": "bricelam", "link": "https://stackoverflow.com/users/475031/bricelam"}, "is_accepted": false, "score": 2, "last_activity_date": 1423844890, "creation_date": 1423844890, "answer_id": 28504178, "question_id": 28465631, "link": "https://stackoverflow.com/questions/28465631/in-an-asp-net-vnext-site-why-does-a-migrations-related-exception-appear-at-star/28504178#28504178", "title": "In an ASP.Net vNext site, why does a migrations-related exception appear at startup?", "body": "<p>If you created your project using the ASP.NET 5 Starter Web template, ASP.NET Identity has included a temporary workaround to create their database automatically using Migrations in the <code>ApplicationDbContext</code> constructor:</p>\n\n<pre><code>private static bool _created = false;\n\npublic ApplicationDbContext()\n{            \n    // Create the database and schema if it doesn't exist\n    // This is a temporary workaround to create database until Entity Framework database migrations \n    // are supported in ASP.NET 5\n    if (!_created)\n    {\n        Database.AsMigrationsEnabled().ApplyMigrations();\n        _created = true;\n    }\n}\n</code></pre>\n\n<p>To disable Migrations, remove their workaround. :)</p>\n\n<p>Otherwise, in EF7, we'll never run Migrations or any other database creation logic unless your application (or the starter template) calls methods to do so.</p>\n"}, {"comments": [{"owner": {"reputation": 23568, "user_id": 475031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0acdc3c6c824b2a2d798ea94e49a5e5?s=128&d=identicon&r=PG", "display_name": "bricelam", "link": "https://stackoverflow.com/users/475031/bricelam"}, "edited": false, "score": 0, "creation_date": 1423933946, "post_id": 28510690, "comment_id": 45353185, "body": "Ah, good find. I believe I may have inadvertently fixed that issue in the nightly builds recently. I&#39;ll be sure to double check."}], "tags": [], "owner": {"reputation": 10791, "user_id": 1042, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f01d06e6dcd2be5ea4519f97703797d8?s=128&d=identicon&r=PG", "display_name": "Aidan Ryan", "link": "https://stackoverflow.com/users/1042/aidan-ryan"}, "is_accepted": true, "score": 3, "last_activity_date": 1423871324, "creation_date": 1423871324, "answer_id": 28510690, "question_id": 28465631, "link": "https://stackoverflow.com/questions/28465631/in-an-asp-net-vnext-site-why-does-a-migrations-related-exception-appear-at-star/28510690#28510690", "title": "In an ASP.Net vNext site, why does a migrations-related exception appear at startup?", "body": "<p>It turns out the culprit was <code>IApplicationBuilder.UseDatabaseErrorPage</code>. An upstream SQL error at startup was causing the <code>Microsoft.AspNet.Diagnostics.Entity</code> Database Error Page to render. The Database Error Page always queries the database's migrations to check if any migrations are pending, triggering the migrations system to attempt the query that produces the exception in my question.</p>\n"}], "owner": {"reputation": 10791, "user_id": 1042, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f01d06e6dcd2be5ea4519f97703797d8?s=128&d=identicon&r=PG", "display_name": "Aidan Ryan", "link": "https://stackoverflow.com/users/1042/aidan-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "accepted_answer_id": 28510690, "answer_count": 2, "score": 1, "last_activity_date": 1423871324, "creation_date": 1423693078, "last_edit_date": 1423871084, "question_id": 28465631, "link": "https://stackoverflow.com/questions/28465631/in-an-asp-net-vnext-site-why-does-a-migrations-related-exception-appear-at-star", "title": "In an ASP.Net vNext site, why does a migrations-related exception appear at startup?", "body": "<p>I have no migrations defined but I am still seeing an exception about the <code>__MigrationHistory</code> table at startup, after a lengthy timeout.</p>\n\n<p>My initialization code looks like this:</p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n  services.AddMvc();\n\n  services.AddEntityFramework()\n    .AddSqlServer()\n    .AddDbContext&lt;DiContext&gt;(options =&gt; options.UseSqlServer(Configuration.Get(\"ConnectionString\")));\n}\n\npublic void Configure(IApplicationBuilder app)\n{\n  var loggerFactory = (ILoggerFactory)app.ApplicationServices.GetService(typeof(ILoggerFactory));\n  loggerFactory.AddProvider(\n      new DiagnosticsLoggerProvider(\n        new SourceSwitch(\"SourceSwitch\", \"Information\"),\n        new ConsoleTraceListener()));\n\n  Trace.WriteLine(\"Configure.\");\n\n  app.UseDefaultFiles();\n  app.UseStaticFiles();\n  app.UseErrorPage();\n  app.UseDatabaseErrorPage();\n  app.UseMvc(routes =&gt;\n  {\n    routes.MapRoute(\n      name: \"default\",\n      template: \"{controller}/{action}/{id?}\",\n      defaults: new { controller = \"Home\", action = \"Index\" });\n    });\n}\n</code></pre>\n\n<p>The exception:</p>\n\n<pre><code>Microsoft.Data.Entity.Query.EntityQueryExecutor Error: 0 : An exception occurred in the data store while iterating the results of a query.\nSystem.Data.SqlClient.SqlException (0x80131904): Invalid object name '__MigrationHistory'.\n   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)\n   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)\n   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)\n   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean&amp; dataReady)\n   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()\n   at System.Data.SqlClient.SqlDataReader.get_MetaData()\n   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)\n   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task&amp; task, Boolean asyncWrite, SqlDataReader ds)\n   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task&amp; task, Boolean asyncWrite)\n   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)\n   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)\n   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)\n   at System.Data.Common.DbCommand.ExecuteReader()\n   at Microsoft.Data.Entity.Relational.Query.QueryingEnumerable`1.Enumerator.MoveNext()\n   at System.Linq.Enumerable.&lt;SelectManyIterator&gt;d__8`2.MoveNext()\n   at System.Linq.Enumerable.WhereSelectEnumerableIterator`2.MoveNext()\n   at Microsoft.Data.Entity.Query.LinqOperatorProvider.&lt;_TrackEntities&gt;d__1`2.MoveNext()\n   at Microsoft.Data.Entity.Query.EntityQueryExecutor.EnumerableExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()\n</code></pre>\n"}, {"tags": ["c#", "entity-framework"], "comments": [{"owner": {"reputation": 5482, "user_id": 913903, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/ec26e377fb68cc34d9365b164c31c3ac?s=128&d=identicon&r=PG", "display_name": "Ahmed ilyas", "link": "https://stackoverflow.com/users/913903/ahmed-ilyas"}, "edited": false, "score": 2, "creation_date": 1423692430, "post_id": 28465439, "comment_id": 45256574, "body": "post your web/app.config connectionstrings!"}, {"owner": {"reputation": 87, "user_id": 1949644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeeafa835e7904845a287557eb8e5a47?s=128&d=identicon&r=PG", "display_name": "Donald Leclerc", "link": "https://stackoverflow.com/users/1949644/donald-leclerc"}, "reply_to_user": {"reputation": 5482, "user_id": 913903, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/ec26e377fb68cc34d9365b164c31c3ac?s=128&d=identicon&r=PG", "display_name": "Ahmed ilyas", "link": "https://stackoverflow.com/users/913903/ahmed-ilyas"}, "edited": false, "score": 0, "creation_date": 1423692937, "post_id": 28465439, "comment_id": 45256850, "body": "@Ahmed &lt;add name=&quot;MillCAT&quot; connectionString=&quot;Data Source=(localdb)\\Projects;Initial Catalog=MillCAT;Integrated Security=True&quot; providerName=&quot;System.Data.SqlClient&quot; /&gt;"}], "owner": {"reputation": 87, "user_id": 1949644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeeafa835e7904845a287557eb8e5a47?s=128&d=identicon&r=PG", "display_name": "Donald Leclerc", "link": "https://stackoverflow.com/users/1949644/donald-leclerc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 395, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423692335, "creation_date": 1423692335, "question_id": 28465439, "link": "https://stackoverflow.com/questions/28465439/cant-assign-objectcontext-objectmaterialized-event-in-dbcontext-constructor", "title": "Can&#39;t assign ObjectContext.ObjectMaterialized event in DbContext Constructor", "body": "<p>I have this constructor on a Code First DbContext:</p>\n\n<pre><code>    public MillCATContext() : base(\"Name=MillCAT\") {\n\n      ((IObjectContextAdapter)this).ObjectContext.ObjectMaterialized +=\n              (sender, e) =&gt; DateTimeKindAttribute.Apply(e.Entity);\n\n      Configuration.LazyLoadingEnabled = false;\n      Configuration.ProxyCreationEnabled = false;\n\n    }\n</code></pre>\n\n<p>The problem occurs only in design time when I tried to open a VS2012 user control that has the creation of the context in a protected field in it.</p>\n\n<p>I get the error</p>\n\n<blockquote>\n  <p>\"No connection string named 'MillCAT' could by found in the\n  application config file.\"</p>\n</blockquote>\n\n<p>So, where can I assigned this event to avoid this problem.</p>\n\n<p>By the way I can run the project without any problem.  </p>\n\n<p>Just to let you know, the DbContext (MillCATContext) is in project A, the POCO model in Project B, and the user control in winform project C.  My connection string is defined in app.config of project A and C.</p>\n"}, {"tags": ["c#", "linq", "list", "linq-to-objects"], "comments": [{"owner": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "edited": false, "score": 5, "creation_date": 1423692448, "post_id": 28465409, "comment_id": 45256585, "body": "You can try something like list.OrderBy(item =&gt; item.Score).Skip(1).Take(list.Count - 2).Sum(item =&gt; item.Score);  For reference, I hate myself now, and this is probably the most unoptimized piece of garbage."}, {"owner": {"reputation": 7613, "user_id": 1364007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d106de3dec9586b56ed7f110497689e?s=128&d=identicon&r=PG", "display_name": "Wai Ha Lee", "link": "https://stackoverflow.com/users/1364007/wai-ha-lee"}, "edited": false, "score": 0, "creation_date": 1423692501, "post_id": 28465409, "comment_id": 45256615, "body": "You can definitely do it with an accumulator with <i>one</i> evaluation of the enumerable. (I mean using Aggregate)."}, {"owner": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 3, "creation_date": 1423692817, "post_id": 28465409, "comment_id": 45256782, "body": "Why do you want a single statement? Wouldn&#39;t a simple <code>list.Sum(item =&gt; item.Score) - list.Max() - list.Min()</code> be more readable? I doubt iterating the list three times will be the bottleneck of your application."}, {"owner": {"reputation": 7613, "user_id": 1364007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d106de3dec9586b56ed7f110497689e?s=128&d=identicon&r=PG", "display_name": "Wai Ha Lee", "link": "https://stackoverflow.com/users/1364007/wai-ha-lee"}, "edited": false, "score": 0, "creation_date": 1423699240, "post_id": 28465409, "comment_id": 45259430, "body": "... See my answer below for an answer which only enumerates the whole Enumerable once with O(1) memory."}], "answers": [{"tags": [], "owner": {"reputation": 2336, "user_id": 3021830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mMOGr.png?s=128&g=1", "display_name": "user3021830", "link": "https://stackoverflow.com/users/3021830/user3021830"}, "is_accepted": false, "score": -2, "last_activity_date": 1423693023, "last_edit_date": 1423693023, "creation_date": 1423692348, "answer_id": 28465443, "question_id": 28465409, "link": "https://stackoverflow.com/questions/28465409/calculate-sum-of-list-properties-excluding-min-and-max-value-with-linq/28465443#28465443", "title": "calculate sum of list properties excluding min and max value with linq", "body": "<p>You should pre-process list before sum to exclude min and max.</p>\n"}, {"comments": [{"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 2, "creation_date": 1423692545, "post_id": 28465476, "comment_id": 45256635, "body": "This begs the questions of whether or not he wants to exclude all instances or a single instance of the min/max score."}, {"owner": {"reputation": 7259, "user_id": 362479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/p91ff.jpg?s=128&g=1", "display_name": "Laziale", "link": "https://stackoverflow.com/users/362479/laziale"}, "edited": false, "score": 0, "creation_date": 1423692616, "post_id": 28465476, "comment_id": 45256673, "body": "what if I have two or  three scores which are min or max value, will that exclude all three or only one? I need only one to be removed. Thanks for your help @Tim"}, {"owner": {"reputation": 408521, "user_id": 284240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/01d6005ebf89c14de87a62add488aaad?s=128&d=identicon&r=PG", "display_name": "Tim Schmelter", "link": "https://stackoverflow.com/users/284240/tim-schmelter"}, "reply_to_user": {"reputation": 7259, "user_id": 362479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/p91ff.jpg?s=128&g=1", "display_name": "Laziale", "link": "https://stackoverflow.com/users/362479/laziale"}, "edited": false, "score": 0, "creation_date": 1423692679, "post_id": 28465476, "comment_id": 45256701, "body": "@Laziale: the above approach exclude all min- and max-values. This is as i have understood your requirement."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 1, "creation_date": 1423847653, "post_id": 28465476, "comment_id": 45329149, "body": "This O(n) is nice, agreed with @AlexeiLevenkov. However, why not just make the third line <code>decimal? total = list.Sum(o =&gt; o.Score) - (min + max);</code>? Then it does exactly what OP wants."}], "tags": [], "owner": {"reputation": 408521, "user_id": 284240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/01d6005ebf89c14de87a62add488aaad?s=128&d=identicon&r=PG", "display_name": "Tim Schmelter", "link": "https://stackoverflow.com/users/284240/tim-schmelter"}, "is_accepted": false, "score": 0, "last_activity_date": 1423692490, "creation_date": 1423692490, "answer_id": 28465476, "question_id": 28465409, "link": "https://stackoverflow.com/questions/28465409/calculate-sum-of-list-properties-excluding-min-and-max-value-with-linq/28465476#28465476", "title": "calculate sum of list properties excluding min and max value with linq", "body": "<p>If you want to exclude <em>all</em> min- and max-values, pre-calculate both values and then use <code>\u00c8numerable.Where</code> to exclude them:</p>\n\n<pre><code>decimal? min = list.Min(item =&gt; item.Score);\ndecimal? max = list.Max(item =&gt; item.Score);\ndecimal? total = list\n    .Where(item=&gt; item.Score != min &amp;&amp; item.Score != max)\n    .Sum(item =&gt;  item.Score);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67884, "user_id": 2149718, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/71OOq.jpg?s=128&g=1", "display_name": "Giorgos Betsos", "link": "https://stackoverflow.com/users/2149718/giorgos-betsos"}, "is_accepted": false, "score": 5, "last_activity_date": 1423692523, "creation_date": 1423692523, "answer_id": 28465485, "question_id": 28465409, "link": "https://stackoverflow.com/questions/28465409/calculate-sum-of-list-properties-excluding-min-and-max-value-with-linq/28465485#28465485", "title": "calculate sum of list properties excluding min and max value with linq", "body": "<p>You can try ordering the list first, then skip first item (minimum) and take all but the last (maximum) from the rest:</p>\n\n<pre><code>decimal? total = list.OrderBy(x =&gt; x.Score)\n                     .Skip(1)\n                     .Take(list.Count - 2)\n                     .Sum(x =&gt; x.Score);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10220, "user_id": 2720372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/olQxk.jpg?s=128&g=1", "display_name": "w.b", "link": "https://stackoverflow.com/users/2720372/w-b"}, "is_accepted": true, "score": 10, "last_activity_date": 1423692962, "last_edit_date": 1423692962, "creation_date": 1423692561, "answer_id": 28465498, "question_id": 28465409, "link": "https://stackoverflow.com/questions/28465409/calculate-sum-of-list-properties-excluding-min-and-max-value-with-linq/28465498#28465498", "title": "calculate sum of list properties excluding min and max value with linq", "body": "<pre><code>list.OrderBy(item =&gt; item.Score)\n    .Skip(1)\n    .Reverse()\n    .Skip(1)\n    .Sum(item =&gt; item.Score);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1423701809, "post_id": 28466955, "comment_id": 45260174, "body": "You can swap out the invocations to <code>First</code> with <code>int.MaxValue</code> and <code>int.MinValue</code> as priming values to avoid accessing the <code>IEnumerable</code> more than once here. Also, if the OP is concerned about performance it&#39;s cheaper here to use a mutable struct as an accumulator, and if he&#39;s  <i>really</i> concerned about performance, it&#39;s cheaper to do all of this in a simple <code>foreach</code> loop. I agree with the spirit of this though, the accepted answer, while somewhat elegant and fine for small collections being called infrequently, is horrendous in terms of space and time complexity."}, {"owner": {"reputation": 7613, "user_id": 1364007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d106de3dec9586b56ed7f110497689e?s=128&d=identicon&r=PG", "display_name": "Wai Ha Lee", "link": "https://stackoverflow.com/users/1364007/wai-ha-lee"}, "reply_to_user": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1423723178, "post_id": 28466955, "comment_id": 45266231, "body": "You&#39;re absolutely right about the struct. I couldn&#39;t think of any existing <code>struct</code> in the BCL which fitted the bill. Even worse, you&#39;ll get an <code>InvalidOperationException</code> if using my method with no values. Worse still, I originally called it <code>AverageExcludingMinAndMax</code> when it returned the sum. I&#39;ve updated my answer accordingly to handle the zero-value case and seed with <code>int.MinValue</code> and <code>int.MaxValue</code>."}], "tags": [], "owner": {"reputation": 7613, "user_id": 1364007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d106de3dec9586b56ed7f110497689e?s=128&d=identicon&r=PG", "display_name": "Wai Ha Lee", "link": "https://stackoverflow.com/users/1364007/wai-ha-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1423727269, "last_edit_date": 1423727269, "creation_date": 1423699151, "answer_id": 28466955, "question_id": 28465409, "link": "https://stackoverflow.com/questions/28465409/calculate-sum-of-list-properties-excluding-min-and-max-value-with-linq/28466955#28466955", "title": "calculate sum of list properties excluding min and max value with linq", "body": "<p>This is not the nicest code imaginable, but it does have the benefits of</p>\n\n<ul>\n<li>only enumerating through the entire collection <strong>once</strong> (though it does get the first value three times).</li>\n<li>Not require any much more memory than that to hold the IEnumerator and two <code>Tuple&lt;int, int, long, long&gt;</code> objects (which you'd not have if using <code>OrderBy</code>, <code>ToList</code> and sorting, etc.). This lets it work with arbitrarily large IEnumerable collections.</li>\n<li>A single Linq expression (which is what you wanted).</li>\n<li>Handles the edge cases (<code>values.Count() &lt; 2</code>) properly:\n<ul>\n<li>when there's no values, using <code>Min()</code> and <code>Max()</code> on an IEnumerable will throw an <code>InvalidOperationException</code></li>\n<li>when there's one value, na\u00efve implementations will do something like <code>Sum() - Min() - Max()</code> on the IEnumerable which returns the single value, negated.</li>\n</ul></li>\n</ul>\n\n<p>I know you've already accepted an answer, but here it is: I'm using a single call to <a href=\"http://msdn.microsoft.com/en-us/library/vstudio/bb548744\" rel=\"nofollow\">Enumerable.Aggregate</a>.</p>\n\n<pre><code>public static long SumExcludingMinAndMax(IEnumerable&lt;int&gt; values)\n{\n    // first parameter: seed (Tuple&lt;running minimum, running maximum, count, running total&gt;)\n    // second parameter: func to generate accumulate\n    // third parameter: func to select final result\n    var result = values.Aggregate(\n            Tuple.Create&lt;int, int, long, long&gt;(int.MaxValue, int.MinValue, 0, 0),\n            (accumulate, value) =&gt; Tuple.Create&lt;int, int, long, long&gt;(Math.Min(accumulate.Item1, value), Math.Max(accumulate.Item2, value), accumulate.Item3 + 1, accumulate.Item4 + value),\n            accumulate =&gt; accumulate.Item3 &lt; 2 ? 0 : accumulate.Item4 - accumulate.Item1 - accumulate.Item2);\n\n    return result;\n}\n</code></pre>\n"}], "owner": {"reputation": 7259, "user_id": 362479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/p91ff.jpg?s=128&g=1", "display_name": "Laziale", "link": "https://stackoverflow.com/users/362479/laziale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1898, "favorite_count": 0, "accepted_answer_id": 28465498, "answer_count": 5, "score": 0, "last_activity_date": 1423727269, "creation_date": 1423692204, "last_edit_date": 1423693139, "question_id": 28465409, "link": "https://stackoverflow.com/questions/28465409/calculate-sum-of-list-properties-excluding-min-and-max-value-with-linq", "title": "calculate sum of list properties excluding min and max value with linq", "body": "<p>This is what I have so far: </p>\n\n<pre><code>decimal? total = list.Sum(item =&gt; item.Score);\n</code></pre>\n\n<p>What I would like to do is to exclude the min and max value in the list and then get the total value. </p>\n\n<p>Is it possible to do all that in one linq statement?</p>\n"}, {"tags": ["c#", "regex", "wpf", "character", "special-characters"], "comments": [{"owner": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "edited": false, "score": 3, "creation_date": 1423693233, "post_id": 28465399, "comment_id": 45257010, "body": "I have read your question twice and I still don&#39;t get what you want to do. Maybe just replace everything that&#39;s not alphanumeric <code>[^a-zA-Z0-9]+</code>?"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "edited": false, "score": 0, "creation_date": 1423693359, "post_id": 28465399, "comment_id": 45257077, "body": "@HamZa I read it as &quot;is there any chance that substring I have will eventually (when added more characters) satisfy given regex&quot;."}, {"owner": {"reputation": 655, "user_id": 2438103, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57ed0c317447c57adb4b7aa7e56e991?s=128&d=identicon&r=PG", "display_name": "Louis", "link": "https://stackoverflow.com/users/2438103/louis"}, "edited": false, "score": 0, "creation_date": 1423693441, "post_id": 28465399, "comment_id": 45257128, "body": "Yes, I am looking for a partial match. If expression expects &quot;abc&quot;, I want a method that tells me that with &quot;a&quot; I am on the right track, but not with &quot;1&quot;"}, {"owner": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "reply_to_user": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1423693464, "post_id": 28465399, "comment_id": 45257135, "body": "@AlexeiLevenkov The answer would be obviously &quot;no&quot; unless you make the regex optional. Which defeats the whole point of using it in the first place."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1423693467, "post_id": 28465399, "comment_id": 45257139, "body": "Louis - are there any restrictions on regular expression (like &quot;always in a form of ....&quot;) or you want that to check for partial patch against generic regex?"}, {"owner": {"reputation": 655, "user_id": 2438103, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57ed0c317447c57adb4b7aa7e56e991?s=128&d=identicon&r=PG", "display_name": "Louis", "link": "https://stackoverflow.com/users/2438103/louis"}, "reply_to_user": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1423693585, "post_id": 28465399, "comment_id": 45257203, "body": "@AlexeiLevenkov, I would like to keep generic if possible as I didn&#39;t write the regular expressions myself."}, {"owner": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "edited": false, "score": 0, "creation_date": 1423693609, "post_id": 28465399, "comment_id": 45257214, "body": "@Louis You&#39;re overcomplicating things a lot. Just tell the user which characters are allowed and that&#39;s it. Especially if you aren&#39;t proficient in regex."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "edited": false, "score": 0, "creation_date": 1423693688, "post_id": 28465399, "comment_id": 45257248, "body": "@HamZa Why &quot;no&quot;? Trivial approach like have string that matches and try replacing all sub-strings with one to test and check if it is still matching sounds fair to me... &quot;abcd&quot; and new char &quot;%&quot; - none of &quot;%bcd&quot;, &quot;a%cd&quot;, &quot;ab%d&quot;, &quot;abc%&quot; match - so typing any other characters next to &quot;%&quot; unlikely to produce match."}, {"owner": {"reputation": 655, "user_id": 2438103, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57ed0c317447c57adb4b7aa7e56e991?s=128&d=identicon&r=PG", "display_name": "Louis", "link": "https://stackoverflow.com/users/2438103/louis"}, "reply_to_user": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "edited": false, "score": 0, "creation_date": 1423693784, "post_id": 28465399, "comment_id": 45257291, "body": "@HamZa I realise this is a rather complex case where a generic approach may not be feasible. I would have thought that Regex would allow such a test however, as it can break down matching portions of a given string. This is one step further."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "edited": false, "score": 0, "creation_date": 1423693803, "post_id": 28465399, "comment_id": 45257297, "body": "@HamZa - totally agree on &quot;over-complicating&quot; statement - list of characters would be so much simpler to understand/code."}, {"owner": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "reply_to_user": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1423693805, "post_id": 28465399, "comment_id": 45257298, "body": "@AlexeiLevenkov See the quantifier <code>{4}</code>, it will fail in the cases you provided. But I get the gist. I forgot that this regex isn&#39;t anchored. Basically expecting some magic code to work for any generic regex is a bit optimistic IMHO."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "edited": false, "score": 2, "creation_date": 1423694030, "post_id": 28465399, "comment_id": 45257388, "body": "@HamZa but  &quot;ab%d&quot; wil fail due to wrong char, not length - but getting generic enough filler string probably is way too complex (completely correct one)... Anyway I don&#39;t believe there is any sane way to get partial match for generic regex - parsing/reconstructing may be something to look into for entertainment purposes (but not really useful for real code)"}, {"owner": {"reputation": 655, "user_id": 2438103, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57ed0c317447c57adb4b7aa7e56e991?s=128&d=identicon&r=PG", "display_name": "Louis", "link": "https://stackoverflow.com/users/2438103/louis"}, "edited": false, "score": 0, "creation_date": 1423694397, "post_id": 28465399, "comment_id": 45257534, "body": "thanks all for your inputs. BTW, I am already providing feedback to user when their input is invalid. I just did not foresee this limitation when I started to dynamically adjust the keys. I will revisit the design with that in mind now."}, {"owner": {"reputation": 13500, "user_id": 1401975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1LLiP.png?s=128&g=1", "display_name": "HamZa", "link": "https://stackoverflow.com/users/1401975/hamza"}, "edited": false, "score": 0, "creation_date": 1423694681, "post_id": 28465399, "comment_id": 45257676, "body": "@Louis For the sample example you provided, you could add another regex (check). The regex could look like <code>[^a-zA-Z0-9]</code>, this will match any non-alphanumeric character. I&#39;m guessing that .NET could return the offset. With the offset and captured invalid character, you could probably work something out. Now you will need to find the &quot;inversion&quot; of all your regexes and apply such logic..."}, {"owner": {"reputation": 46944, "user_id": 3764814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d02a4923abd2ca6d7593f031e4222c2?s=128&d=identicon&r=PG", "display_name": "Lucas Trzesniewski", "link": "https://stackoverflow.com/users/3764814/lucas-trzesniewski"}, "reply_to_user": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 1, "creation_date": 1423695367, "post_id": 28465399, "comment_id": 45257972, "body": "@Alexei there is a sane way actually - see my answer ;)"}], "answers": [{"comments": [{"owner": {"reputation": 655, "user_id": 2438103, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57ed0c317447c57adb4b7aa7e56e991?s=128&d=identicon&r=PG", "display_name": "Louis", "link": "https://stackoverflow.com/users/2438103/louis"}, "edited": false, "score": 0, "creation_date": 1423750335, "post_id": 28465975, "comment_id": 45281626, "body": "Thanks for your detailed answer Lucas. I will look into it later. For now, since I have a fairly small list of regular expressions to support, I will probably create a physical file that will map which keys are enabled based on each expression. This should be dynamic enough for the time being...."}], "tags": [], "owner": {"reputation": 46944, "user_id": 3764814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d02a4923abd2ca6d7593f031e4222c2?s=128&d=identicon&r=PG", "display_name": "Lucas Trzesniewski", "link": "https://stackoverflow.com/users/3764814/lucas-trzesniewski"}, "is_accepted": false, "score": 5, "last_activity_date": 1423729416, "last_edit_date": 1592644375, "creation_date": 1423694509, "answer_id": 28465975, "question_id": 28465399, "link": "https://stackoverflow.com/questions/28465399/partial-match-with-regular-expression/28465975#28465975", "title": "Partial match with Regular Expression", "body": "<p>Sure, you can, but not using the built-in regex engine unfortunately. You can use <a href=\"http://www.pcre.org/\" rel=\"nofollow noreferrer\">PCRE</a> instead, which provides the partial matching feature you're asking for.</p>\n<p>From the PCRE docs:</p>\n<blockquote>\n<p>In normal use of PCRE, if the subject string that is passed to a matching function matches as far as it goes, but is too short to match the entire pattern, <code>PCRE_ERROR_NOMATCH</code> is returned. There are circumstances where it might be helpful to distinguish this case from other cases in which there is no match.</p>\n<p>Consider, for example, an application where a human is required to type in data for a field with specific formatting requirements. An example might be a date in the form <code>ddmmmyy</code>, defined by this pattern:</p>\n<pre><code> ^\\d?\\d(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)\\d\\d$\n</code></pre>\n<p>If the application sees the user's keystrokes one by one, and can check that what has been typed so far is potentially valid, it is able to raise an error as soon as a mistake is made, by beeping and not reflecting the character that has been typed, for example. This immediate feedback is likely to be a better user interface than a check that is delayed until the entire string has been entered. Partial matching can also be useful when the subject string is very long and is not all available at once.</p>\n<p>PCRE supports partial matching by means of the <code>PCRE_PARTIAL_SOFT</code> and <code>PCRE_PARTIAL_HARD</code> options, which can be set when calling any of the matching functions. For backwards compatibility, <code>PCRE_PARTIAL</code> is a synonym for <code>PCRE_PARTIAL_SOFT</code>. The essential difference between the two options is whether or not a partial match is preferred to an alternative complete match, though the details differ between the two types of matching function. If both options are set, <code>PCRE_PARTIAL_HARD</code> takes precedence.</p>\n</blockquote>\n<hr />\n<p>But PCRE is a C library... So I've built a <a href=\"http://www.nuget.org/packages/PCRE.NET/\" rel=\"nofollow noreferrer\">PCRE wrapper for .NET</a>.</p>\n<p>Usage example from <a href=\"https://github.com/ltrzesniewski/pcre-net\" rel=\"nofollow noreferrer\">the readme</a>:</p>\n<pre><code>var regex = new PcreRegex(@&quot;(?&lt;=abc)123&quot;);\nvar match = regex.Match(&quot;xyzabc12&quot;, PcreMatchOptions.PartialSoft);\n// result: match.IsPartialMatch == true\n</code></pre>\n<p>A little caution though: the wrapper is currently at v0.3, using PCRE v8.36 but PCRE v10.0 was released recently (with a new API), so expect some breaking changes <em>in the API</em> of v0.4 of PCRE.NET. The behavior should stay the same though.</p>\n<p>And also, you should be aware of <a href=\"https://stackoverflow.com/a/26504537/3764814\">the differences</a> between .NET and PCRE regex flavors. This should not be a problem for most cases though.</p>\n"}], "owner": {"reputation": 655, "user_id": 2438103, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f57ed0c317447c57adb4b7aa7e56e991?s=128&d=identicon&r=PG", "display_name": "Louis", "link": "https://stackoverflow.com/users/2438103/louis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1192, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1423729416, "creation_date": 1423692147, "last_edit_date": 1423692750, "question_id": 28465399, "link": "https://stackoverflow.com/questions/28465399/partial-match-with-regular-expression", "title": "Partial match with Regular Expression", "body": "<p>Is there a way to determine that a single char is valid when a regular expression expects a specific number of that char?</p>\n\n<p>I have a WPF custom keyboard and would like to adjust each key's availability based on a regular expression.\nThis will work well when the expression is fairly simple and does not expect specific order of the chars or a specific length to satisfy the pattern.</p>\n\n<p>However, when the pattern becomes more complex and specific, testing a single char against it will always fail.</p>\n\n<p>For instance, given the regular expression <code>[a-zA-Z0-9]{4}</code></p>\n\n<p>These values will succeed:</p>\n\n<ul>\n<li>ABCD </li>\n<li>abcd </li>\n<li>1234 </li>\n<li>A23e</li>\n</ul>\n\n<p>The expression clearly expects alphanumerical chars only.\nI would like a method that given the expression will reject special char, say \"%\", but accept \"a\" as \"a\" is acceptable in <code>[a-zA-Z0-9]</code>. The only issue is the specific length that will not be satisfied.</p>\n\n<p>I am currently using <a href=\"https://msdn.microsoft.com/en-us/library/3y21t6y4%28v=vs.110%29.aspx\" rel=\"nofollow\">Regex.IsMatch</a>. I guess I am looking for a partial match testing method.</p>\n"}, {"tags": ["c#", "mysql", "asp.net", "asp.net-mvc", "entity-framework"], "comments": [{"owner": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1423692015, "post_id": 28465321, "comment_id": 45256353, "body": "So your question is <i>&quot;How to use ASP.NET Membership with MySQL&quot;</i>?"}, {"owner": {"reputation": 913, "user_id": 1974352, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc15579b5fd614b83ae57539ee6c14fb?s=128&d=identicon&r=PG", "display_name": "Daniel Rusznyak", "link": "https://stackoverflow.com/users/1974352/daniel-rusznyak"}, "reply_to_user": {"reputation": 131158, "user_id": 266143, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/487f6927f37c3005e5b918d131892715?s=128&d=identicon&r=PG", "display_name": "CodeCaster", "link": "https://stackoverflow.com/users/266143/codecaster"}, "edited": false, "score": 0, "creation_date": 1423692071, "post_id": 28465321, "comment_id": 45256370, "body": "How to use ASP.NET Membership with MySQL as well as how to migrate users from a MySQL database to another MySQL database with ASP.NET Membership"}, {"owner": {"reputation": 4800, "user_id": 2419089, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/LZxQP.jpg?s=128&g=1", "display_name": "Ryan Mann", "link": "https://stackoverflow.com/users/2419089/ryan-mann"}, "edited": false, "score": 0, "creation_date": 1423692318, "post_id": 28465321, "comment_id": 45256503, "body": "If possible, I would recommend choosing Microsoft Sql Server and using the Database Project type built into visual studio for your database.  It is 100% easier to manage a database doing so, and supports database publishing.  You can use EF&#39;s database first approach, or instead go with PetaPoco and it&#39;s T4 Templates to generate your data layer.  In my experience, anytime one is to use .Net for something internal (not a distributed product, and is an asp.net based website, always choose MS Sql, due to it&#39;s integration with visual studio, saves a TON of time)."}], "owner": {"reputation": 913, "user_id": 1974352, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/dc15579b5fd614b83ae57539ee6c14fb?s=128&d=identicon&r=PG", "display_name": "Daniel Rusznyak", "link": "https://stackoverflow.com/users/1974352/daniel-rusznyak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 541, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423691818, "creation_date": 1423691818, "question_id": 28465321, "link": "https://stackoverflow.com/questions/28465321/asp-net-entity-framework-mysql-migration", "title": "ASP.NET Entity Framework MySql migration", "body": "<p>I have this relatively big database for my website, currently in a MySQL database. As the site has been based on \"one size fits all\" solutions so far, the recent explosive growth of the website forced me to start developing a more fitting, more optimized and less fragmented platform.</p>\n\n<p>Currently working on the back-end, for which an ASP.NET API suits me the best. I've decided to go with MySQL and use the Entity Framework to set things up. While it wasn't too much of an issue, I want to migrate all the data into a new, cleaner and better set up database. The issue is the users themselves - while I think ASP's Membership might be the best solution for me, I'm not sure how to migrate all my users' needed data to the new database, or even if Memberships are actually the best way to go about this. And this is what I need help in - could someone help me how to set up the API for this?</p>\n\n<p>Edit: I've designed the new database inside Visual Studio with the EF Designer, but considering all the material I find, I suppose that's an issue? >_></p>\n"}, {"tags": ["c#", "outlook-redemption"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 3715395, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d3f67e051c05734b902142e94e511581?s=128&d=identicon&r=PG&f=1", "display_name": "BadShift", "link": "https://stackoverflow.com/users/3715395/badshift"}, "edited": false, "score": 0, "creation_date": 1423835262, "post_id": 28466165, "comment_id": 45321271, "body": "After talking with the IT department, there was indeed a network problem on our side. Since this problem has been fixed, I had no other bug report from the users. I think we can safely assume that this was the root cause of the problem. Thank you."}], "tags": [], "owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "is_accepted": true, "score": 1, "last_activity_date": 1423695350, "creation_date": 1423695350, "answer_id": 28466165, "question_id": 28465274, "link": "https://stackoverflow.com/questions/28465274/com-exception-creating-redemption-safepostitem-c/28466165#28466165", "title": "Com exception creating Redemption SafePostItem C#", "body": "<blockquote>\n  <p>The dll is stored on a network path</p>\n</blockquote>\n\n<p>Yes, funny things can happen when you do that.  Like that Windows error 999, getting a page-fault when the operating system tries to load code from the DLL but the network connection went down.  And yes, \"happens once, not if they try again\" is also strongly correlated to a flaky network connection.</p>\n\n<p>There is not anything you can do about a poor network connection, it is not a programming problem.  Other than pointing the LAN administrator or your users to this post.  And <em>strongly</em> recommending them to copy the DLL to a local drive.  The quick fix, getting a bad network repaired usually takes a while.</p>\n"}], "owner": {"reputation": 7, "user_id": 3715395, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d3f67e051c05734b902142e94e511581?s=128&d=identicon&r=PG&f=1", "display_name": "BadShift", "link": "https://stackoverflow.com/users/3715395/badshift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 28466165, "answer_count": 1, "score": 0, "last_activity_date": 1423695350, "creation_date": 1423691664, "question_id": 28465274, "link": "https://stackoverflow.com/questions/28465274/com-exception-creating-redemption-safepostitem-c", "title": "Com exception creating Redemption SafePostItem C#", "body": "<p>I am using Redemption 4.4 dll and I came across a very strange bug. The biggest problem is that I am not able to reproduce it, but I keep getting bug report from other employees. </p>\n\n<p>The error they get is : \nThe recovery of the COM class factory for component with CLSID { 11E2BC0C - 5D4F - 4E0C - B438-501FFE05A382 } failed due to the following error: Error 800703e7 during a paging operation . (Exception from HRESULT: 0x800703e7 ) .</p>\n\n<p>The line that throws the error is : \n    <code>Redemption.SafePostItem postItem = new Redemption.SafePostItem();</code></p>\n\n<p>The dll is stored on a network path and we are using regsvr32.exe to register it.\n    <code>regsvr32.exe -s [NetworkPath]</code></p>\n\n<p>We are using an x86 version of the dll, of outlook 2010 and I am compiling my code in x86. </p>\n\n<p>The users can run this code multiple times without problem, then it happens once and if they try again the bug is gone without changing anything. </p>\n\n<p>I know this is not much to go with but its all I got for now. If I find a way to reproduce it, I will update this post.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c#", "asp.net-mvc-3", "debugging"], "answers": [{"comments": [{"owner": {"reputation": 4151, "user_id": 302613, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b7d545f423f184a84d87ec9151f04eb9?s=128&d=identicon&r=PG", "display_name": "ErocM", "link": "https://stackoverflow.com/users/302613/erocm"}, "edited": false, "score": 0, "creation_date": 1423692207, "post_id": 28465291, "comment_id": 45256439, "body": "Ha... I didn&#39;t even notice that. Ty! Any ideas on debugging a web form in mvc?"}, {"owner": {"reputation": 90360, "user_id": 61164, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/782a1ccf1b45f8dbb5116f950d61f661?s=128&d=identicon&r=PG", "display_name": "Erik Funkenbusch", "link": "https://stackoverflow.com/users/61164/erik-funkenbusch"}, "reply_to_user": {"reputation": 4151, "user_id": 302613, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b7d545f423f184a84d87ec9151f04eb9?s=128&d=identicon&r=PG", "display_name": "ErocM", "link": "https://stackoverflow.com/users/302613/erocm"}, "edited": false, "score": 1, "creation_date": 1423692397, "post_id": 28465291, "comment_id": 45256549, "body": "@ErocM - You need to set the cursor directly on the object you want to debug, then hit F9.  For instance, if you want to debug this situation, you would put the cursor on the .Partial part, and press F9.  If you don&#39;t do that, it won&#39;t get the right context."}, {"owner": {"reputation": 6206, "user_id": 1750282, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/de6f3eebd350eab64f9728c30ede43ef?s=128&d=identicon&r=PG", "display_name": "Randy Hall", "link": "https://stackoverflow.com/users/1750282/randy-hall"}, "edited": false, "score": 0, "creation_date": 1574453445, "post_id": 28465291, "comment_id": 104252585, "body": "Similar issue, but just trying to pass a string from a dynamic object. Just had to cast to string first."}], "tags": [], "owner": {"reputation": 90360, "user_id": 61164, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/782a1ccf1b45f8dbb5116f950d61f661?s=128&d=identicon&r=PG", "display_name": "Erik Funkenbusch", "link": "https://stackoverflow.com/users/61164/erik-funkenbusch"}, "is_accepted": true, "score": 46, "last_activity_date": 1423691714, "creation_date": 1423691714, "answer_id": 28465291, "question_id": 28465114, "link": "https://stackoverflow.com/questions/28465114/system-web-mvc-htmlhelper-has-no-applicable-method-named-partial/28465291#28465291", "title": "&#39;System.Web.Mvc.HtmlHelper&#39; has no applicable method named &#39;Partial&#39;", "body": "<p>Your problem is that you don't define a model at the top of your view.  Because of this, the default type is of type <code>dynamic</code>.</p>\n\n<p>Normally, this isn't a problem, but you have this:</p>\n\n<pre><code>@Html.Partial(\"BillingInfo\", Model)\n</code></pre>\n\n<p>This is, in effect, passing a dynamic type to your <code>Html.Partial()</code>, which is what is throwing the error.</p>\n\n<p>This is a pointless call anyways, just remove the Model part of it and it should work.  Passing the Model is the default operation anyways, so you are not trying to do anything that wouldn't be the default.</p>\n"}], "owner": {"reputation": 4151, "user_id": 302613, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b7d545f423f184a84d87ec9151f04eb9?s=128&d=identicon&r=PG", "display_name": "ErocM", "link": "https://stackoverflow.com/users/302613/erocm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19493, "favorite_count": 0, "accepted_answer_id": 28465291, "answer_count": 1, "score": 24, "last_activity_date": 1546910709, "creation_date": 1423691090, "last_edit_date": 1495541408, "question_id": 28465114, "link": "https://stackoverflow.com/questions/28465114/system-web-mvc-htmlhelper-has-no-applicable-method-named-partial", "title": "&#39;System.Web.Mvc.HtmlHelper&#39; has no applicable method named &#39;Partial&#39;", "body": "<p>I am getting this error:</p>\n\n<blockquote>\n  <p>error CS1973: 'System.Web.Mvc.HtmlHelper' has no applicable\n  method named 'Partial' but appears to have an extension method by that\n  name. Extension methods cannot be dynamically dispatched. Consider\n  casting the dynamic arguments or calling the extension method without\n  the extension method syntax.\"}</p>\n</blockquote>\n\n<p>From what I read here <a href=\"https://stackoverflow.com/questions/4155392/razor-view-engine-an-expression-tree-may-not-contain-a-dynamic-operation\">Razor View Engine : An expression tree may not contain a dynamic operation</a> is that it is due to using viewbag(?) which I am really using Session.</p>\n\n<p>This is my web form:</p>\n\n<pre><code>@using SuburbanCustPortal.MiscClasses\n\n@{\n    ViewBag.Title = \"Account Screen\";\n }\n\n&lt;h2&gt;AccountScreen&lt;/h2&gt;\n\n&lt;div class=\"leftdiv\"&gt;\n  &lt;fieldset&gt;\n    &lt;legend&gt;Customer Info&lt;/legend&gt;\n    @Html.Partial(\"CustomerInfo\")\n  &lt;/fieldset&gt;\n\n  &lt;fieldset&gt;\n    &lt;legend&gt;Delivery Address&lt;/legend&gt;\n    @Html.Partial(\"DeliveryAddress\")\n  &lt;/fieldset&gt;\n\n  &lt;fieldset&gt;\n    &lt;legend&gt;Delivery Info&lt;/legend&gt;\n    @Html.Partial(\"DeliveryInfo\")\n  &lt;/fieldset&gt;\n&lt;/div&gt;\n\n&lt;div class=\"rightdiv\"&gt;\n  &lt;fieldset&gt; \n    &lt;legend&gt;Balance&lt;/legend&gt;\n      @Html.Partial(\"AccountBalance\")\n  &lt;/fieldset&gt;\n\n             @if (SessionHelper.ShowPaymentOptions || SessionHelper.ShowHistory)\n             {\n               &lt;fieldset&gt;\n                 &lt;legend&gt;Account Options&lt;/legend&gt;\n                 &lt;br/&gt;\n\n                 @using (Html.BeginForm(\"AccountScreenButton\", \"Customer\", FormMethod.Post))\n                 {\n                   &lt;div class=\"sidebysidebuttons\"&gt;\n                     &lt;div class=\"box\"&gt;\n                       @if (SessionHelper.ShowHistory &amp;&amp; SessionHelper.ShowAccountScreenPaymentButton)\n                       {\n                         &lt;button class=\"sidebysidebutton1\" name=\"options\" value=\"payment\"&gt;Make a Payment&lt;/button&gt;\n                         &lt;button class=\"sidebysidebutton2\" name=\"options\" value=\"activity\"&gt;Display Activity&lt;/button&gt;\n                       }\n                       else\n                       {\n                         if (SessionHelper.ShowAccountScreenPaymentButton)\n                         {\n                           &lt;button class=\"leftpaddedsinglebutton\" name=\"options\" value=\"payment\"&gt;Make a Payment&lt;/button&gt;\n                         }\n\n                         if (SessionHelper.ShowHistory)\n                         {\n                           &lt;button class=\"leftpaddedsinglebutton\" name=\"options\" value=\"activity\"&gt;Display Activity&lt;/button&gt;\n                         }\n                       }\n                     &lt;/div&gt;\n                   &lt;/div&gt;\n                 }    \n               &lt;/fieldset&gt;\n             }\n\n  &lt;fieldset&gt; \n      &lt;legend&gt;Billing Info&lt;/legend&gt;\n        @Html.Partial(\"BillingInfo\", Model)\n    &lt;/fieldset&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>This is part of my SessionHelper to give you an idea:</p>\n\n<pre><code>public static CustomerData CustomerSessionData\n{\n  get\n  {\n    try\n    {\n      return (CustomerData) HttpContext.Current.Session[\"CustomerSessionData\"];\n    }\n    catch (Exception)\n    {\n      return null;\n    }\n  }\n  set { HttpContext.Current.Session[\"CustomerSessionData\"] = value; }\n}\n\n    public static bool ShowPaymentTab\n    {\n      get { return HttpContext.Current.Session[\"ShowPaymentTab\"].ToBool(); }\n      set { HttpContext.Current.Session[\"ShowPaymentTab\"] = value; }\n    }\n</code></pre>\n\n<p>I'm not sure were the issue is in the form since when I put a break point in the form, it does not stop there.</p>\n\n<p>I have two questions:</p>\n\n<ol>\n<li>How do I debug where the issue is on the form?</li>\n<li>Can I not use a class as a session and reference it in the form? I'm assuming that is where the issue is at.</li>\n</ol>\n"}, {"tags": ["c#", ".net", "entity-framework", "entity-framework-6"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1423691619, "post_id": 28465107, "comment_id": 45256153, "body": "Create separate entity classes that map to the data model then create mappings back and forth to your client classes.  Attributes are a compile-time construct and can&#39;t be added at runtime."}, {"owner": {"reputation": 15622, "user_id": 38368, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/9825eee1aeea415663794aecf29232bc?s=128&d=identicon&r=PG", "display_name": "Danny Varod", "link": "https://stackoverflow.com/users/38368/danny-varod"}, "edited": false, "score": 1, "creation_date": 1423691803, "post_id": 28465107, "comment_id": 45256246, "body": "You could use the fluent code-first API to define everything instead of decorating the model with attributes."}], "answers": [{"tags": [], "owner": {"reputation": 5294, "user_id": 30384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7167f7b050a615573feb2555e3346e5f?s=128&d=identicon&r=PG", "display_name": "sfuqua", "link": "https://stackoverflow.com/users/30384/sfuqua"}, "is_accepted": false, "score": 1, "last_activity_date": 1423691774, "creation_date": 1423691774, "answer_id": 28465304, "question_id": 28465107, "link": "https://stackoverflow.com/questions/28465107/add-entity-framework-data-annotation-to-another-projects-class/28465304#28465304", "title": "Add Entity Framework Data Annotation to Another Project&#39;s Class", "body": "<p>This is a good argument for using custom Data Transfer Objects that are independent of the table-like entities. Although it can feel like overkill to have nearly duplicate classes - one as DTOs and one as EF Entities - there is another long-range benefit: the two sets of classes can vary independently. Let's say that you change the table table structure, but the client doesn't need to know about this change. Update the EF Entity but you leave the DTO alone, though you may have to update how you map from EF to DTO.</p>\n\n<p>Speaking of mapping: EmitMapper can be a great help in transferring between the two types of objects. </p>\n"}, {"tags": [], "owner": {"reputation": 5430, "user_id": 3294832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUCr2.jpg?s=128&g=1", "display_name": "Ric .Net", "link": "https://stackoverflow.com/users/3294832/ric-net"}, "is_accepted": false, "score": 1, "last_activity_date": 1423691878, "creation_date": 1423691878, "answer_id": 28465336, "question_id": 28465107, "link": "https://stackoverflow.com/questions/28465107/add-entity-framework-data-annotation-to-another-projects-class/28465336#28465336", "title": "Add Entity Framework Data Annotation to Another Project&#39;s Class", "body": "<p>You need to split your data access models from the rest of the application using <a href=\"http://en.wikipedia.org/wiki/Data_transfer_object\" rel=\"nofollow\">Data Transfer Objects</a>. </p>\n\n<p>This will give a lot of benefits. At first it will look if your duplicating all the code of the model. But when your application grows, you will find that need the data in a view which is formatted in another way than how it was or is stored the database. Validation attributes can be added in a very specific way just the way you need it.</p>\n\n<p>Mapping in between them can be done various ways. By hand or by using a tool like <a href=\"https://automapper.codeplex.com/\" rel=\"nofollow\">AutoMapper</a></p>\n"}, {"tags": [], "owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "is_accepted": true, "score": 2, "last_activity_date": 1423692747, "creation_date": 1423692747, "answer_id": 28465552, "question_id": 28465107, "link": "https://stackoverflow.com/questions/28465107/add-entity-framework-data-annotation-to-another-projects-class/28465552#28465552", "title": "Add Entity Framework Data Annotation to Another Project&#39;s Class", "body": "<p>You can have the POCOs in your <code>Models</code> project, keep them totally ignorant of Entity Framework, and do the mappings in a separate project or in the <code>RestApi</code> project itself.</p>\n\n<p>You can do this by the fluent mapping API, for instance in the <code>OnModelCreating</code> override of the context that you create in the EF-aware project:</p>\n\n<pre><code>modelBuilder.Entity&lt;Order&gt;().HasKey(o =&gt; o.OrderID);\nmodelBuilder.Entity&lt;Order&gt;().Ignore(o =&gt; o.OrderTotal);\n</code></pre>\n\n<p>etc.</p>\n"}], "owner": {"reputation": 9316, "user_id": 2045257, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6b15ff327055fa7f5127b2b5c39e7b22?s=128&d=identicon&r=PG", "display_name": "Pharylon", "link": "https://stackoverflow.com/users/2045257/pharylon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 28465552, "answer_count": 3, "score": 1, "last_activity_date": 1423692747, "creation_date": 1423691071, "last_edit_date": 1423691482, "question_id": 28465107, "link": "https://stackoverflow.com/questions/28465107/add-entity-framework-data-annotation-to-another-projects-class", "title": "Add Entity Framework Data Annotation to Another Project&#39;s Class", "body": "<p>Let's say I have a set of classes that I want to share across multiple projects. For instance, I could use them in a REST service and also in a client that consumes that service.</p>\n\n<p>So I create the following projects:</p>\n\n<ul>\n<li>MyOrders.Models</li>\n<li>MyOrders.RestApi</li>\n<li>MyOrders.Client</li>\n</ul>\n\n<p>Both the RestApi and Client projects have dependencies on the Models project.</p>\n\n<p>The RestApi is using Entity Framework (code first) so normally you'd decorate the model's properties with things like <code>[NotMapped]</code> and <code>[Key]</code>. However, I <em>don't</em> want the Client solution to have any dependency on Entity Framework. None. So I can't decorate the models' properties with EF-specific attributes.</p>\n\n<p>So my question is, is there some way to correctly set the models' EF-specific attributes from the RestApi project instead, maybe in the Context's constructor or something?</p>\n"}, {"tags": ["c#", ".net", "global-variables"], "comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 1, "creation_date": 1423691258, "post_id": 28465045, "comment_id": 45255951, "body": "<code>File.WriteAllLines(&quot;C:&#47;Users&#47;Chris&#47;Documents&#47;Visual Studio 2013&#47;Projects&#47;ConsoleApplication38&#47;Employees.txt&quot;, employees);</code> You know if you want to use the proper path separator you can use double backslashes <code>&quot;C:\\\\Users\\\\Chris\\\\&quot;</code> or a string literal <code>@&quot;C:\\Users\\Chris\\&quot;</code>?"}, {"owner": {"reputation": 6603, "user_id": 166286, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/3866da6aadf3d166b7bd06f34e966395?s=128&d=identicon&r=PG", "display_name": "AZ.", "link": "https://stackoverflow.com/users/166286/az"}, "edited": false, "score": 2, "creation_date": 1423691697, "post_id": 28465045, "comment_id": 45256186, "body": "It&#39;s recommended to follow a coding standard even you&#39;re just learning it. Please change all your method name to start with a capital character, like NameCheck() and PayRoll. See <a href=\"https://msdn.microsoft.com/en-us/library/ff926074.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ff926074.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 1, "creation_date": 1423692387, "post_id": 28465129, "comment_id": 45256543, "body": "You probably want <code>GlobalVariables</code> itself to be static as well."}], "tags": [], "owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "is_accepted": false, "score": 8, "last_activity_date": 1423701011, "last_edit_date": 1495542391, "creation_date": 1423691140, "answer_id": 28465129, "question_id": 28465045, "link": "https://stackoverflow.com/questions/28465045/where-can-i-use-a-global-variable-in-my-c-program/28465129#28465129", "title": "Where can i use a global variable in my c# program?", "body": "<p>C# doesn't have a specific concept of global variables, but you can achieve the effect with a public static property or field, which you then access through the class. For example:</p>\n\n<pre><code>public class GlobalVariables\n{\n    public static double TaxRate {get; set;}\n}\n</code></pre>\n\n<p>Accessed at <code>GlobalVariabels.TaxRate</code>.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/yzh058ae.aspx\" rel=\"nofollow noreferrer\">public</a> allows us to access the variable from outside the class. <a href=\"https://msdn.microsoft.com/en-us/library/98f28cdx.aspx\" rel=\"nofollow noreferrer\">static</a> means we don't need an instance of the <code>GlobalVariables</code> class to access it (though you do need to go through the class name outside the context of the class.</p>\n\n<p>And as <a href=\"https://stackoverflow.com/users/21418/preston-guillot\">Preston</a> points out, you can make your GlobalVariables class static, because there's not really any reason to instantiate an instance of it (though it's not necessary).</p>\n"}, {"comments": [{"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 3, "creation_date": 1423692357, "post_id": 28465194, "comment_id": 45256523, "body": "How does this answer the question?"}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 1, "creation_date": 1423693549, "post_id": 28465194, "comment_id": 45257185, "body": "Note: C++ is &quot;object oriented&quot; .. and most definitely has globals."}, {"owner": {"reputation": 2336, "user_id": 3021830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mMOGr.png?s=128&g=1", "display_name": "user3021830", "link": "https://stackoverflow.com/users/3021830/user3021830"}, "edited": false, "score": 0, "creation_date": 1423693744, "post_id": 28465194, "comment_id": 45257272, "body": "Yes, you are definetely right. All I tried to say is that C# has this kind of accessibilty. Never thought of C++ on this problem."}], "tags": [], "owner": {"reputation": 2336, "user_id": 3021830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mMOGr.png?s=128&g=1", "display_name": "user3021830", "link": "https://stackoverflow.com/users/3021830/user3021830"}, "is_accepted": false, "score": -2, "last_activity_date": 1423691360, "creation_date": 1423691360, "answer_id": 28465194, "question_id": 28465045, "link": "https://stackoverflow.com/questions/28465045/where-can-i-use-a-global-variable-in-my-c-program/28465194#28465194", "title": "Where can i use a global variable in my c# program?", "body": "<p>C# is an Object Oriented Programming Language, which means you can access everything via an object which is an implementation of a class. So every variable (member in this situation) is visible if the both class and the member are accessible which can be done by declaring them as <strong>public</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 4979, "user_id": 2676531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc88aa76113d738e11685389a1409a26?s=128&d=identicon&r=PG", "display_name": "Celeo", "link": "https://stackoverflow.com/users/2676531/celeo"}, "is_accepted": false, "score": 0, "last_activity_date": 1423691533, "last_edit_date": 1495535406, "creation_date": 1423691533, "answer_id": 28465244, "question_id": 28465045, "link": "https://stackoverflow.com/questions/28465045/where-can-i-use-a-global-variable-in-my-c-program/28465244#28465244", "title": "Where can i use a global variable in my c# program?", "body": "<p>For your \"global variable,\" (quotations because see <a href=\"https://stackoverflow.com/questions/14368129/c-sharp-global-variables\">here</a>) look for something that you can move out of your method.</p>\n\n<p>Your best option is the variable that isn't changing between calls to your <code>nameCheck</code> method - <code>string[] employees = { \"Emp1\", \"Emp2\", \"Emp3\", \"Emp4\" };</code>.</p>\n\n<p>Since you didn't post code that shows using multiple classes, moving <code>employees</code> outside the method is your best bet. If you have already learned multiple classes in class, then go with what you learned there for organizing your code. Take a peek at <a href=\"https://msdn.microsoft.com/en-us/library/98f28cdx.aspx\" rel=\"nofollow noreferrer\">static</a> as well.</p>\n"}, {"tags": [], "owner": {"reputation": 413, "user_id": 2156339, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcf04bc7296d409402591c3d9be729b6?s=128&d=identicon&r=PG", "display_name": "Nitin Aggarwal", "link": "https://stackoverflow.com/users/2156339/nitin-aggarwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1423692555, "creation_date": 1423692555, "answer_id": 28465493, "question_id": 28465045, "link": "https://stackoverflow.com/questions/28465045/where-can-i-use-a-global-variable-in-my-c-program/28465493#28465493", "title": "Where can i use a global variable in my c# program?", "body": "<p>You can also use like</p>\n\n<pre><code>    static double payRoll(double hours, double wage)\n    {\n        return hours * wage;\n    }\n</code></pre>\n\n<p>also</p>\n\n<pre><code>int hours = Convert.ToInt32(Console.ReadLine()); //why this is an Int should be double\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2556, "user_id": 1078115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1367de9b160ef7aa9b2a183ed1a931bb?s=128&d=identicon&r=PG", "display_name": "Marko", "link": "https://stackoverflow.com/users/1078115/marko"}, "is_accepted": false, "score": 0, "last_activity_date": 1423693729, "creation_date": 1423693729, "answer_id": 28465785, "question_id": 28465045, "link": "https://stackoverflow.com/questions/28465045/where-can-i-use-a-global-variable-in-my-c-program/28465785#28465785", "title": "Where can i use a global variable in my c# program?", "body": "<p>I have made changes to your logic, first it reads the file once, check if the file exists otherwise it creates it. Added comments and fixed the structure, removed unnecessary variables, and took previous answers into account to help you out.</p>\n\n<pre><code>namespace Temp1\n{\n    using System;\n    using System.IO;\n\n    public class GlobalVariables\n    {\n        /// &lt;summary&gt;\n        /// Wage per hour\n        /// &lt;/summary&gt;\n        public static double WagePerHour = 7.5;\n    } \n\n    public class Program\n    {\n        private static void LoadEmployees()\n        {\n            // Get the name of the employee\n            Console.WriteLine(\"Name of employee: \");\n            string employee = Console.ReadLine();\n\n            // Get the file path\n            string filePath = string.Format(\n                @\"{0}\\{1}\",\n                Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location),\n                \"Employees.txt\");\n\n            // Check if the file does not exist and create it\n            if (!File.Exists(filePath))\n            {\n                // Generate sample employees\n                string[] employees = { \"Emp1\", \"Emp2\", \"Emp3\", \"Emp4\" };\n\n                // Write all the lines in the file\n                File.WriteAllLines(filePath, employees);\n            }\n\n            // Read all the lines from the file\n            string[] currentEmployees = File.ReadAllLines(filePath);\n\n            // Check the employee name\n            NameCheck(currentEmployees, employee);\n        }\n\n        /// &lt;summary&gt;\n        /// Do the name check recursively so you don\u2019t keep loading the file all the time\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"names\"&gt;Array of all the employee names&lt;/param&gt;\n        /// &lt;param name=\"nameToFind\"&gt;Name to find&lt;/param&gt;\n        /// &lt;param name=\"currentPosition\"&gt;Current position in the array&lt;/param&gt;\n        public static void NameCheck(string[] names, string nameToFind, int currentPosition = 0)\n        {\n            if (currentPosition == nameToFind.Length - 1)\n            {\n                Console.WriteLine(\"That name is not in the employee database, try again:\");\n            }\n            else if (string.Compare(names[currentPosition], nameToFind, StringComparison.InvariantCulture) != 0)\n            {\n                currentPosition++;\n                NameCheck(names, nameToFind, currentPosition);\n            }\n        }\n\n        /// &lt;summary&gt;\n        /// Calculate pay roll\n        /// &lt;/summary&gt;\n        /// &lt;param name=\"hours\"&gt;&lt;/param&gt;\n        /// &lt;param name=\"wage\"&gt;&lt;/param&gt;\n        /// &lt;returns&gt;&lt;/returns&gt;\n        private static double PayRoll(double hours, double wage)\n        {\n            return hours * wage;\n        }\n\n        /// &lt;summary&gt;\n        /// \n        /// &lt;/summary&gt;\n        /// &lt;param name=\"args\"&gt;&lt;/param&gt;\n        private static void Main(string[] args)\n        {\n            Console.WriteLine(\"                                   PAYROLL\");\n            Console.WriteLine(\"--------------------------------------------------------------------------------\");\n\n            // Load employees and check if the employee is in the list\n            LoadEmployees();\n\n            // Get the number of hours worked\n            Console.WriteLine(\"Number of hours worked this week: \");\n            double hours = Convert.ToDouble(Console.ReadLine());\n\n            // Get the current pay\n            double pay = PayRoll(hours, GlobalVariables.WagePerHour);\n\n            Console.WriteLine(\"Pay before tax for this employee is \u00a3\" + pay);\n            Console.ReadLine();\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4556751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ee303e3dfd605caa2987b3af3c002c?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Sawyer", "link": "https://stackoverflow.com/users/4556751/chris-sawyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3287, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1488601757, "creation_date": 1423690853, "last_edit_date": 1488601757, "question_id": 28465045, "link": "https://stackoverflow.com/questions/28465045/where-can-i-use-a-global-variable-in-my-c-program", "title": "Where can i use a global variable in my c# program?", "body": "<p>My tutor set me the task of making a C# program that</p>\n\n<ul>\n<li>demonstrates recursion (I think I've done that)</li>\n<li>uses a global variable</li>\n<li>can be used by a business</li>\n</ul>\n\n<p>This is what I've come up with. It only has to be a small program, but I don't know where I can use a global variable. I was thinking something to do with subtracting tax, but every time I get started I forget what my idea was.</p>\n\n<pre><code>static void nameCheck()\n{\n    Console.WriteLine(\"Name of employee: \");\n    string employee = Console.ReadLine();\n\n    string[] employees = { \"Emp1\", \"Emp2\", \"Emp3\", \"Emp4\" };\n\n    File.WriteAllLines(\"C:/Users/Chris/Documents/Visual Studio 2013/Projects/ConsoleApplication38/Employees.txt\", employees);\n\n    string[] lines = File.ReadAllLines(\"C:/Users/Chris/Documents/Visual Studio 2013/Projects/ConsoleApplication38/Employees.txt\");\n\n    int match = 0;\n    foreach (string line in lines)\n    {\n        if (employee != line)\n        {\n            match = match + 1;\n            if (match &gt; 3)\n            {\n                Console.WriteLine(\"That name is not in the employee database, try again:\");\n                nameCheck();\n            }\n        }\n    }\n}\nstatic double payRoll(double hours, double wage)\n{\n    double pay = hours * wage;\n    return pay;\n}\nstatic void Main(string[] args)\n{\n    Console.WriteLine(\"                                   PAYROLL\");\n    Console.WriteLine(\"--------------------------------------------------------------------------------\");\n\n    nameCheck();\n\n    Console.WriteLine(\"Number of hours worked this week: \");\n    int hours = Convert.ToInt32(Console.ReadLine());\n\n    const double wage = 7.50;\n    double pay = payRoll(hours, wage);\n\n    Console.WriteLine(\"Pay before tax for this employee is \u00a3\" + pay);\n    Console.ReadLine();\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "wpf"], "comments": [{"owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 0, "creation_date": 1423692677, "post_id": 28465012, "comment_id": 45256699, "body": "Does this happen if you call Show() instead of ShowDialog()?"}, {"owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 0, "creation_date": 1423693381, "post_id": 28465012, "comment_id": 45257091, "body": "I have Windows 8 64-bit .NET 4.5.2, VS2013 update 4 and that code ran fine for me.  I set the Winforms app to x86 and it still worked.  To be specific: I created a new Winforms app, new WPF app, added references from Winforms to WPF app + PresentationBase and others.  New button, click event pointed to your OpenWpfWindow function.  Run app, click button, WPF window appears.  It took about 5 seconds to appear."}, {"owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 1, "creation_date": 1423693568, "post_id": 28465012, "comment_id": 45257193, "body": "There is a chain of posts on the MSDN forums that seem to imply that showing the window could fill the message queue.  Follow the trail of links starting here: <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/6e94283a-76be-42b3-98e6-a8e18c4e43de/invisible-wpf-dialog-filling-up-windows-message-queue?forum=wpf\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/vstudio/en-US/&hellip;</a>"}, {"owner": {"reputation": 79, "user_id": 4215097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/790db651ee8881654d062d19f2482633?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Christilaw", "link": "https://stackoverflow.com/users/4215097/ryan-christilaw"}, "reply_to_user": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 0, "creation_date": 1423694230, "post_id": 28465012, "comment_id": 45257463, "body": "-When I call show, the same behaviour exists.  -This works fine in Windows 8.1 with 4.5.2 installed, It is just windows 7"}, {"owner": {"reputation": 79, "user_id": 4215097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/790db651ee8881654d062d19f2482633?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Christilaw", "link": "https://stackoverflow.com/users/4215097/ryan-christilaw"}, "reply_to_user": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 0, "creation_date": 1423694535, "post_id": 28465012, "comment_id": 45257600, "body": "I have seen this thread but will look further into it. I have tried the FrameDispatcher unsuccessfully but maybe there was something I was missing."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1423695752, "post_id": 28465012, "comment_id": 45258150, "body": "Your program has called PostMessage() <i>ten thousand</i> times.  Sure, takes a while.  After which the operating system decided there was no longer any point in allowing it to call that function again.  You exceeded the quota on the message queue, the internal data structure that stores messages.  It acts like a buffer, the basic way you for example can type keystrokes even if the app is unresponsive and they don&#39;t get lost.  Nobody can tell why it isn&#39;t responsive from a screenshot."}, {"owner": {"reputation": 79, "user_id": 4215097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/790db651ee8881654d062d19f2482633?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Christilaw", "link": "https://stackoverflow.com/users/4215097/ryan-christilaw"}, "edited": false, "score": 0, "creation_date": 1423696135, "post_id": 28465012, "comment_id": 45258286, "body": "All thia program is is a button that calls this method. My reason for posting here is to see if there are any solutions to why it is calling post message 10000 times, how did you find this and what would you like me to provide if this isn&#39;t enough. Please expand on your criticism if you are going to comment"}, {"owner": {"reputation": 1989, "user_id": 276500, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d1366b45f8499de563eddd9a259067c8?s=128&d=identicon&r=PG", "display_name": "johnildergleidisson", "link": "https://stackoverflow.com/users/276500/johnildergleidisson"}, "edited": false, "score": 1, "creation_date": 1423700053, "post_id": 28465012, "comment_id": 45259690, "body": "If you can reproduce this in a very simple app as you&#39;re claiming, in different Windows 7 machines, I&#39;d suggest you to submit a bug <a href=\"https://connect.microsoft.com/VisualStudio\" rel=\"nofollow noreferrer\">here</a>. They&#39;re probably gonna be able to help you better there. And then post it back here once you found a solution to help others in case no acceptable answer is posted :-)"}, {"owner": {"reputation": 3618, "user_id": 2394945, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/g5WxC.png?s=128&g=1", "display_name": "Moby Disk", "link": "https://stackoverflow.com/users/2394945/moby-disk"}, "edited": false, "score": 0, "creation_date": 1423749789, "post_id": 28465012, "comment_id": 45281257, "body": "What is in the WPFWindow class?  You didn&#39;t mean Microsoft.VisualStudio.TestTools.UITesting.WpfControls.WpfWi&zwnj;&#8203;ndow right?  I assumed WpfWindow is just some random System.Windows.Window."}, {"owner": {"reputation": 79, "user_id": 4215097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/790db651ee8881654d062d19f2482633?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Christilaw", "link": "https://stackoverflow.com/users/4215097/ryan-christilaw"}, "edited": false, "score": 0, "creation_date": 1423752664, "post_id": 28465012, "comment_id": 45283351, "body": "It is just a WPF control that extends Window and contains one checkbox UI element"}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 4215097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/790db651ee8881654d062d19f2482633?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Christilaw", "link": "https://stackoverflow.com/users/4215097/ryan-christilaw"}, "is_accepted": true, "score": 2, "last_activity_date": 1432580157, "creation_date": 1432580157, "answer_id": 30444449, "question_id": 28465012, "link": "https://stackoverflow.com/questions/28465012/opening-a-wpf-window-from-a-winforms-application-net-4-5-2-win-7-32-bit/30444449#30444449", "title": "Opening a WPF Window from a WinForms application (.Net 4.5.2/Win 7/ 32 Bit)", "body": "<p>This issue turned out to be an issue in .NET 4.5.2 (in Windows 7) regarding the initialization of touch devices and there is a hotfix solution from Microsoft.</p>\n\n<p>The WPF application starts the Windows Touch Input Service (wisptis.exe), even when no touch devices are present, resulting in a delay, meanwhile the message queue is flooded and the WPF Window creation fails.</p>\n\n<p>The hotfix can be found here: \n<a href=\"https://support.microsoft.com/en-us/kb/3026376/\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/3026376/</a></p>\n"}], "owner": {"reputation": 79, "user_id": 4215097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/790db651ee8881654d062d19f2482633?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Christilaw", "link": "https://stackoverflow.com/users/4215097/ryan-christilaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 1, "accepted_answer_id": 30444449, "answer_count": 1, "score": 3, "last_activity_date": 1432580157, "creation_date": 1423690759, "question_id": 28465012, "link": "https://stackoverflow.com/questions/28465012/opening-a-wpf-window-from-a-winforms-application-net-4-5-2-win-7-32-bit", "title": "Opening a WPF Window from a WinForms application (.Net 4.5.2/Win 7/ 32 Bit)", "body": "<p>I have recently come across an issue on Windows 7 32-bit OS with .Net 4.5.2 installed. I have an application that is Winforms and opens a modal WPF Window. However, since we installed .Net Framework 4.5.2, these windows do not open properly, once the window .ShowDialog() is called it takes about 15-20 seconds (mouse turns to a pointer for several seconds and the winforms window becomes unresponsive) and then we receive the following exception:</p>\n\n<p><img src=\"https://i.stack.imgur.com/qo9Mf.png\" alt=\"enter image description here\">\nSystem.ComponentModel.Win32Exception (0x80004005): Not enough quota is available to process this command</p>\n\n<p>The weird thing is once this exception is thrown and I choose to \"continue\", the next time I attempt to open the window, it opens instantly and no exception is thrown.</p>\n\n<p>The following is a simplified version of what I am using to open the window. (When I run this code, the application does not throw the exception but it does hang for the 15-20 seconds)</p>\n\n<pre><code>    private void OpenWpfWindow(object sender, EventArgs e)\n    {\n        WPFWindow testWindow = new WPFWindow();\n\n        testWindow.Visibility = System.Windows.Visibility.Visible;\n        testWindow.WindowStartupLocation = System.Windows.WindowStartupLocation.CenterOwner;\n\n        System.Windows.Interop.WindowInteropHelper helper = new System.Windows.Interop.WindowInteropHelper(testWindow);\n        helper.Owner = System.Windows.Forms.Application.OpenForms[0].Handle;\n\n        testWindow.ShowDialog();\n    }\n</code></pre>\n\n<p>We do not experience this issue with Windows 7 and With .Net 4.5 installed</p>\n"}, {"tags": ["c#", "mysql", "datetime"], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 1622194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c8a4618068dc0986d946f0f16ffb101?s=128&d=identicon&r=PG", "display_name": "Bikal Bhattarai", "link": "https://stackoverflow.com/users/1622194/bikal-bhattarai"}, "is_accepted": true, "score": 0, "last_activity_date": 1423694197, "creation_date": 1423694197, "answer_id": 28465895, "question_id": 28464985, "link": "https://stackoverflow.com/questions/28464985/how-to-convert-string-to-mysql-datetime-format/28465895#28465895", "title": "How to convert string to mysql datetime format?", "body": "<p>First change your string to DateTime</p>\n\n<pre><code>var latesttime = @\"2/11/2015 8:04:06 PM\";\nDateTime dateValue = DateTime.Parse(latesttime);\n</code></pre>\n\n<p>Now you can simply do,</p>\n\n<pre><code>var sqlDateFormat= dateValue.ToString(\"yyyy-MM-dd HH:mm\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 90882, "user_id": 447156, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8348bcf40f55bc5818651824369caff1?s=128&d=identicon&r=PG", "display_name": "Soner G&#246;n&#252;l", "link": "https://stackoverflow.com/users/447156/soner-g%c3%b6n%c3%bcl"}, "reply_to_user": {"reputation": 31, "user_id": 4004914, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4652427d0466716edcda525b02924b75?s=128&d=identicon&r=PG&f=1", "display_name": "raja king", "link": "https://stackoverflow.com/users/4004914/raja-king"}, "edited": false, "score": 0, "creation_date": 1423905332, "post_id": 28474927, "comment_id": 45346109, "body": "@rajaking Glad to help."}], "tags": [], "owner": {"reputation": 90882, "user_id": 447156, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8348bcf40f55bc5818651824369caff1?s=128&d=identicon&r=PG", "display_name": "Soner G&#246;n&#252;l", "link": "https://stackoverflow.com/users/447156/soner-g%c3%b6n%c3%bcl"}, "is_accepted": false, "score": 0, "last_activity_date": 1423736600, "creation_date": 1423736600, "answer_id": 28474927, "question_id": 28464985, "link": "https://stackoverflow.com/questions/28464985/how-to-convert-string-to-mysql-datetime-format/28474927#28474927", "title": "How to convert string to mysql datetime format?", "body": "<p>I know it is a little bit too late, but I want to point some other points also..</p>\n\n<p>First of all, you <em>can't</em> have a <code>string</code> as;</p>\n\n<pre><code>string latesttime = \"2\\/11\\/2015 8:04:06 PM\";\n</code></pre>\n\n<p>because since it is a <a href=\"https://msdn.microsoft.com/en-us/library/aa691090(v=vs.71).aspx\" rel=\"nofollow\">regular string literal</a>, you need to escape your <code>\\</code> character since it is an <a href=\"https://msdn.microsoft.com/en-us/library/h21280bw.aspx\" rel=\"nofollow\">escape sequence</a> character. You might wanna escape it as <code>\"2\\\\/11\\\\/2015 8:04:06 PM\"</code> or use <em>verbatim string literal</em> as <code>@\"2\\/11\\/2015 8:04:06 PM\"</code></p>\n\n<p>I don't think your <code>Convert.ToDateTime()</code> <em>ever</em> work with that string because none <code>CultureInfo</code> have <code>d\\\\/MM\\\\/yyyy h:mm:ss tt</code> format as a <a href=\"https://msdn.microsoft.com/en-us/library/az4se3k1(v=vs.110).aspx\" rel=\"nofollow\">standard date and time format</a>.</p>\n\n<p>Instead of that, you can use custom date and time parsing with <a href=\"https://msdn.microsoft.com/en-us/library/system.datetime.tryparseexact.aspx\" rel=\"nofollow\"><code>DateTime.TryParseExact</code> method</a> like;</p>\n\n<pre><code>string s = @\"2\\/11\\/2015 8:04:06 PM\";\nDateTime dt;\nif(DateTime.TryParseExact(s, @\"d\\\\/MM\\\\/yyyy h:mm:ss tt\", \n                          CultureInfo.InvariantCulture,\n                          DateTimeStyles.None,out dt))\n{\n    Console.WriteLine(dt);\n}\n</code></pre>\n\n<p>Since <code>\\</code> is an escape character in custom date and time parsing, you need to escape with double slash as <code>\\\\</code>.</p>\n\n<p>There is no <code>SimpleDateFormat</code> class in .NET Framework. I think you are mixing it Java's <a href=\"http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html\" rel=\"nofollow\"><code>SimpleDateFormat</code> class</a>.</p>\n\n<p>In .NET Framework, <em>usually</em> <a href=\"https://msdn.microsoft.com/en-us/library/k494fzbf(v=vs.110).aspx\" rel=\"nofollow\"><code>DateTime.ToString</code> method</a> is used when you try to get string representation of your <code>DateTime</code>. After you parsing, you can do these;</p>\n\n<pre><code>dt.ToString(\"dd/MM/yyyy hh:mm:ss tt\", CultureInfo.InvariantCulture);\n// Result will be 02/11/2015 08:04:06 PM\n\ndt.ToString(\"yyyy-MM-dd HH:mm:ss\");\n// Result will be 2015-11-02 20:04:06\n</code></pre>\n\n<p>I used <code>InvariantCulture</code> as an <code>IFormatProvider</code> in first example because <a href=\"https://msdn.microsoft.com/en-us/library/8kb3ddd4(v=vs.110).aspx#dateSeparator\" rel=\"nofollow\">The <code>\"/\"</code> custom format specifier</a> has a special meaning as <em>replace me with current culture or supplied culture date separator</em>. That's why it might generate different results in different cultures.</p>\n"}], "owner": {"reputation": 31, "user_id": 4004914, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4652427d0466716edcda525b02924b75?s=128&d=identicon&r=PG&f=1", "display_name": "raja king", "link": "https://stackoverflow.com/users/4004914/raja-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1521, "favorite_count": 0, "accepted_answer_id": 28465895, "answer_count": 2, "score": 0, "last_activity_date": 1423743698, "creation_date": 1423690628, "last_edit_date": 1423743698, "question_id": 28464985, "link": "https://stackoverflow.com/questions/28464985/how-to-convert-string-to-mysql-datetime-format", "title": "How to convert string to mysql datetime format?", "body": "<p>I am facing a difficulty in converting a string based datetime format to mysql date time format.</p>\n\n<p>I tried the following</p>\n\n<pre><code>str latesttime =  \"2\\/11\\/2015 8:04:06 PM\";\nstring formatForMySql = Convert.ToDateTime(latestscreentime);\n</code></pre>\n\n<p>Not converted. also tried with parse \nAnd also</p>\n\n<pre><code>SimpleDateFormat from = new SimpleDateFormat(\"dd/MM/yyyy hh:mm:ss tt\");\nSimpleDateFormat to = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\nDate date = from.parse(latestscreentime);       // 01/02/2014\nString mysqlString = to.format(date); \n</code></pre>\n\n<p>here error is  </p>\n\n<blockquote>\n  <p>'SimpleDateFormat' could not be found (are you missing a using\n  directive or an assembly reference?)</p>\n</blockquote>\n\n<p>But I download the <code>vjslib.dll</code> and add <code>using SimpleDateFormat;</code> </p>\n\n<p>So could any one help me in solving this error?</p>\n"}, {"tags": ["c#", ".net", "sql-server", "entity-framework", "entity-framework-6"], "answers": [{"comments": [{"owner": {"reputation": 8001, "user_id": 291372, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b5c1a712772e2552bebc14a89bf9aeb1?s=128&d=identicon&r=PG", "display_name": "Alex G.P.", "link": "https://stackoverflow.com/users/291372/alex-g-p"}, "edited": false, "score": 0, "creation_date": 1423691389, "post_id": 28465149, "comment_id": 45256034, "body": "Thanks! I thought that during build all app.configs merged or each app.config embedded into parent&#39;s assembly."}], "tags": [], "owner": {"reputation": 5430, "user_id": 3294832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUCr2.jpg?s=128&g=1", "display_name": "Ric .Net", "link": "https://stackoverflow.com/users/3294832/ric-net"}, "is_accepted": true, "score": 1, "last_activity_date": 1423691215, "creation_date": 1423691215, "answer_id": 28465149, "question_id": 28464916, "link": "https://stackoverflow.com/questions/28464916/database-description-in-app-config-organization/28465149#28465149", "title": "Database description in app.config organization", "body": "<p>By default you must have a single config file per <code>AppDomain</code>. So you need to add all entity framework specific parts of the config from your <code>Project.Entities</code> including the connectionstring to your App.Config of the <code>Project.UI</code> assembly.</p>\n\n<p>Actually all settings that you need within your <code>AppDomain</code> must be in this config file.</p>\n\n<p>This isn't WPF specific, it works for all CLR runned executable, services, websites, etc.</p>\n\n<p>A detailed descibtion can found be <a href=\"http://blogs.msdn.com/b/suzcook/archive/2003/06/02/app-config-files.aspx\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 8001, "user_id": 291372, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b5c1a712772e2552bebc14a89bf9aeb1?s=128&d=identicon&r=PG", "display_name": "Alex G.P.", "link": "https://stackoverflow.com/users/291372/alex-g-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 28465149, "answer_count": 1, "score": 0, "last_activity_date": 1423691215, "creation_date": 1423690324, "question_id": 28464916, "link": "https://stackoverflow.com/questions/28464916/database-description-in-app-config-organization", "title": "Database description in app.config organization", "body": "<p>I have project which consist of couple of assemblies.</p>\n\n<ul>\n<li><p><code>Project.Entities</code> is class library with entities and database descriptions (I am using EF6 + SqlServer Compact Edition 4)</p></li>\n<li><p><code>Project.Core</code> is also class library and contains entire business logic (depends upon <code>Project.Entities</code>)</p></li>\n<li><p><code>Project.UI</code> is WPF application which contains UI declaration and couple of translators from entities (declared in <code>Project.Entities</code>) to WPF-suitable view models.</p></li>\n</ul>\n\n<p>Now I faced following issue: I want to keep entire information about database in app.config which presented in <code>Project.Entities</code>. But upon start I got an error that connection string not found or provider not found end blah-blah-blah. Finally only one way can solve it - move all sections (<code>entityFramework</code>, <code>connectionStrings</code>, <code>system.data</code>) to <code>app.config</code> of <code>Project.UI</code>.</p>\n\n<p>UPD: My <code>packages.config</code> for <code>Project.Entities</code> is:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;packages&gt;\n  &lt;package id=\"EntityFramework\" version=\"6.1.2\" targetFramework=\"net40\" /&gt;\n  &lt;package id=\"EntityFramework.SqlServerCompact\" version=\"6.1.2\" targetFramework=\"net40\" /&gt;\n  &lt;package id=\"Microsoft.SqlServer.Compact\" version=\"4.0.8876.1\" targetFramework=\"net40\" /&gt;\n&lt;/packages&gt;\n</code></pre>\n\n<p>Should I also add the same packages to UI project to start it? Or I can keep all database-related features in Entities assembly?</p>\n\n<p>I am not sure whther it is correct or not, I an very new in WPF.</p>\n"}, {"tags": ["c#", ".net", "operator-overloading"], "comments": [{"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 1, "creation_date": 1423690261, "post_id": 28464878, "comment_id": 45255431, "body": "It&#39;s an operator overload: <a href=\"https://msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx</a>"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 1, "creation_date": 1423690281, "post_id": 28464878, "comment_id": 45255437, "body": "It&#39;s the addition operator. It allows you to &quot;add&quot; two <code>MyObjects</code>."}, {"owner": {"reputation": 11439, "user_id": 598637, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f555e133e57968e30c2ca0e040e96b25?s=128&d=identicon&r=PG", "display_name": "Codeman", "link": "https://stackoverflow.com/users/598637/codeman"}, "edited": false, "score": 0, "creation_date": 1423690521, "post_id": 28464878, "comment_id": 45255562, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/7899339/operator-overloading-in-c-sharp\">Operator overloading in C#</a>"}, {"owner": {"reputation": 656, "user_id": 892381, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/98c63fb3d396b783e54b405f520de25b?s=128&d=identicon&r=PG", "display_name": "user892381", "link": "https://stackoverflow.com/users/892381/user892381"}, "edited": false, "score": 0, "creation_date": 1423753514, "post_id": 28464878, "comment_id": 45283951, "body": "Thanks I actually figured it out after I asked the question. I just have never seen it used before so it threw me off and the overload in this code base was insane."}, {"owner": {"reputation": 168160, "user_id": 19679, "user_type": "moderator", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/52a2ffb44b1c11ab9001cb67e0a0021c?s=128&d=identicon&r=PG", "display_name": "Brad Larson", "link": "https://stackoverflow.com/users/19679/brad-larson"}, "edited": false, "score": 0, "creation_date": 1423760110, "post_id": 28464878, "comment_id": 45288469, "body": "If you want to have an extended discussion about site moderation policies, please take that up on Meta or a chatroom. I&#39;ve cleaned up the comments to focus on the question asked."}], "answers": [{"tags": [], "owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "is_accepted": false, "score": 8, "last_activity_date": 1423690296, "creation_date": 1423690296, "answer_id": 28464909, "question_id": 28464878, "link": "https://stackoverflow.com/questions/28464878/what-does-operator-in-method-definition-do/28464909#28464909", "title": "What does operator + in method definition do?", "body": "<p>It overrides the <code>+</code> operator for that class, allowing code like this to compile and run:</p>\n\n<pre><code>MyObject op1 = new MyObject();\nMyObject op2 = new MyObject();\nMyFunction result = op1 + op2;\n</code></pre>\n\n<p>Doing the <code>+</code> operation invokes the method you posted. For more on operator overloading, see <a href=\"https://msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx\" rel=\"noreferrer\">MSDN</a></p>\n"}, {"tags": [], "owner": {"reputation": 6227, "user_id": 897994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/026eee59a7e86ac799e55c29f845b40d?s=128&d=identicon&r=PG", "display_name": "RJ Lohan", "link": "https://stackoverflow.com/users/897994/rj-lohan"}, "is_accepted": false, "score": 1, "last_activity_date": 1423690297, "creation_date": 1423690297, "answer_id": 28464910, "question_id": 28464878, "link": "https://stackoverflow.com/questions/28464878/what-does-operator-in-method-definition-do/28464910#28464910", "title": "What does operator + in method definition do?", "body": "<p>It's called operator overloading, and allows you to define a behaviour for operators like '+', '-', '==', etc.</p>\n\n<p>See here for more information: <a href=\"https://msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 0, "creation_date": 1461188988, "post_id": 28464939, "comment_id": 61091803, "body": "<code>vector1 + vector2</code> &gt; <code>Vector.Add(vector1, vector2)</code>"}, {"owner": {"reputation": 11439, "user_id": 598637, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f555e133e57968e30c2ca0e040e96b25?s=128&d=identicon&r=PG", "display_name": "Codeman", "link": "https://stackoverflow.com/users/598637/codeman"}, "reply_to_user": {"reputation": 3381, "user_id": 3964654, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ITt1C.jpg?s=128&g=1", "display_name": "wingerse", "link": "https://stackoverflow.com/users/3964654/wingerse"}, "edited": false, "score": 0, "creation_date": 1461194022, "post_id": 28464939, "comment_id": 61093618, "body": "@EmperorAiman Generally, operator overloading should be avoided unless you are writing some really core framework stuff IMO.  Do what you want, but it&#39;s just a method under the hood and you can avoid confusion if you just use a method signature"}], "tags": [], "owner": {"reputation": 11439, "user_id": 598637, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f555e133e57968e30c2ca0e040e96b25?s=128&d=identicon&r=PG", "display_name": "Codeman", "link": "https://stackoverflow.com/users/598637/codeman"}, "is_accepted": true, "score": 8, "last_activity_date": 1423690426, "creation_date": 1423690426, "answer_id": 28464939, "question_id": 28464878, "link": "https://stackoverflow.com/questions/28464878/what-does-operator-in-method-definition-do/28464939#28464939", "title": "What does operator + in method definition do?", "body": "<p>It is called an <a href=\"https://msdn.microsoft.com/en-us/library/aa288467%28v=vs.71%29.aspx\">operator overload</a>.</p>\n\n<p>It allows you to use primitive operators such as <code>+</code>, <code>-</code>, <code>%</code>, etc. to apply to objects you define.</p>\n\n<p>An example where it might be useful is if you have two Lists and you want to add one to the end of the other.  Another example used by MSDN is if you have complex numbers with two vectors.</p>\n\n<p>These days it is generally more appropriate just to define a method that takes in the number of operands you want to apply and use that method, rather than make your code more difficult to read and debug by overriding an operator that is used for other things.</p>\n\n<p><strong>tl;dr; use methods instead of operator overloading unless you have a damn good reason.</strong></p>\n"}], "owner": {"reputation": 656, "user_id": 892381, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/98c63fb3d396b783e54b405f520de25b?s=128&d=identicon&r=PG", "display_name": "user892381", "link": "https://stackoverflow.com/users/892381/user892381"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 28464939, "answer_count": 3, "score": 1, "last_activity_date": 1423690661, "creation_date": 1423690186, "last_edit_date": 1423690661, "question_id": 28464878, "link": "https://stackoverflow.com/questions/28464878/what-does-operator-in-method-definition-do", "title": "What does operator + in method definition do?", "body": "<p>So I have never seen this before and I'm trying to figure out what it does:</p>\n\n<pre><code>public static MyFunction operator +(MyObject first, MyObject second)\n</code></pre>\n"}, {"tags": ["c#", "msbuild", "assemblyinfo"], "comments": [{"owner": {"reputation": 684, "user_id": 4534262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94daeebeb9889bb4614963266ce719b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikerboker", "link": "https://stackoverflow.com/users/4534262/nikerboker"}, "edited": false, "score": 0, "creation_date": 1423722914, "post_id": 28464859, "comment_id": 45266121, "body": "I your goal is to prevent extra touching the AssembyInfo file, you may improve its generation: build a temporary file, compare its content with existing AssembyInfo and replace the existing only if the contents differs."}, {"owner": {"reputation": 684, "user_id": 4534262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94daeebeb9889bb4614963266ce719b4?s=128&d=identicon&r=PG&f=1", "display_name": "Nikerboker", "link": "https://stackoverflow.com/users/4534262/nikerboker"}, "edited": false, "score": 0, "creation_date": 1423723176, "post_id": 28464859, "comment_id": 45266229, "body": "&lt;CoreCompileDependsOn&gt; is an example of &quot;dependency injection&quot;. As far as I know, this technique is obsolete in 4.0, where BeforeTargets and AfterTargets are introduced. (But this is not the answer.)"}], "owner": {"reputation": 25, "user_id": 335678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57ce22532f0be24bdeedd16442aa600c?s=128&d=identicon&r=PG", "display_name": "Dan Fergus", "link": "https://stackoverflow.com/users/335678/dan-fergus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1423690116, "creation_date": 1423690116, "question_id": 28464859, "link": "https://stackoverflow.com/questions/28464859/needing-to-update-assemblyinfo-after-msbuild-checks-if-a-build-is-required", "title": "Needing to update AssemblyInfo after msbuild checks if a build is required", "body": "<p>I want to only update the AssemblyInfo file if msbuild is going to build the target.  I started with BeforeBuild but that occurs way before msbuild checks if the build needs done or not.  If done too early it always forces the build since AssemblyInfo is newer that the targets.</p>\n\n<p>After some research I tried this where my target is called UpdateConfig.</p>\n\n<pre><code>&lt;PropertyGroup&gt;\n    &lt;CoreCompileDependsOn&gt;\n        $(CoreCompileDependsOn);\n        UpdateConfig;\n    &lt;/CoreCompileDependsOn&gt;\n&lt;/PropertyGroup&gt;\n</code></pre>\n\n<p>however that also does the file update too soon.  As you can see from the log snippet, my target is called and then the CoreCompile target is run where it sees the new assemblyInfo file and starts a build. </p>\n\n<pre><code>&lt;target name=\"UpdateConfig\" startTime=\"02/11/2015 10:28:05\" elapsedTime=\"00:00:00\" elapsedSeconds=\"0\" success=\"true\"&gt;\n    &lt;task name=\"Exec\" file=\"E:\\SourceCode\\Framework.Compiler.csproj\" startTime=\"02/11/2015 10:28:05\" elapsedTime=\"00:00:00\" elapsedSeconds=\"0\" success=\"true\"&gt;\n        &lt;message level=\"high\"&gt;&lt;![CDATA[powershell -executionpolicy Unrestricted -command \"&amp;amp; { &amp;amp;'UpdateAssemblyNuSpec.ps1' 'E:\\SourceCode\\Framework.Compiler.csproj' 'E:\\SourceCode\\Framework\\' '50' }\"]]&gt;&lt;/message&gt;\n    &lt;/task&gt;\n&lt;/target&gt;\n&lt;target name=\"CoreCompile\" startTime=\"02/11/2015 10:28:05\" elapsedTime=\"00:00:01\" elapsedSeconds=\"1\" success=\"true\"&gt;\n    &lt;message level=\"low\"&gt;&lt;![CDATA[Building target \"CoreCompile\" completely.]]&gt;&lt;/message&gt;\n    &lt;message level=\"low\"&gt;&lt;![CDATA[Input file \"Properties\\AssemblyInfo.cs\" is newer than output file \"obj\\Release\\Framework.Compiler.pdb\".]]&gt;&lt;/message&gt;\n    &lt;message level=\"low\"&gt;&lt;![CDATA[Using \"Csc\" task from assembly \"Microsoft.Build.Tasks.v4.0, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\".]]&gt;&lt;/message&gt;\n</code></pre>\n\n<p><strong>I want my target called here</strong></p>\n\n<pre><code>    &lt;task name=\"Csc\" file=\"E:\\SourceCode\\Framework.Compiler.csproj\" startTime=\"02/11/2015 10:28:05\" elapsedTime=\"00:00:01\" elapsedSeconds=\"1\" success=\"true\"&gt;\n    &lt;message level=\"high\"&gt;&lt;![CDATA[C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\Csc.exe /noconfig /nowarn:1701,1702 /nostdlib+ /errorreport:prompt /warn:4 /define:TRACE /highentropyva- /reference:C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\mscorlib.dll /reference:\"C:\\Program Files (x86)\\Reference Assemblies\\Microsoft\\Framework\\v3.5\\System.Core.dll\" /reference:C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\System.dll /debug:pdbonly /filealign:512 /optimize+ /out:obj\\Release\\Framework.Compiler.dll /resource:obj\\Release\\Framework.Compiler.g.resources /resource:obj\\Release\\Framework.Compiler.Properties.Resources.resources /target:library /utf8output  Properties\\AssemblyInfo.cs ]]&gt;&lt;/message&gt;\n</code></pre>\n\n<p>I'm trying to figure out which DependOn or which target I can hook my target into to have it happen as above, after the check and before the compiler.</p>\n\n<p>I tried the MSBuildExtenstion Pack, which is where I got the CoreCompileDependsOn trick, but it too does the update before the check and forces a build because AssemblyInfo.cs is newer than the previous build.</p>\n\n<p>Another way to handle it would be to call the same method to check if a build will occur (the same way CodeCompile does) before invoked my target.  That would keep it in msbuild but I don't know if I can access that method (if it exists)</p>\n\n<p>A third option is to change the AssemblyFileVerison in the just built assembly using;</p>\n\n<pre><code>&lt;PropertyGroup&gt;\n    &lt;TargetsTriggeredByCompilation&gt;\n        $(TargetsTriggeredByCompilation);\n        UpdateFileVersionInAssembly;\n    &lt;/TargetsTriggeredByCompilation&gt;\n&lt;/PropertyGroup&gt;\n</code></pre>\n\n<p>It's looking like I may have to go this last route if I can't find a way to hook into the correct place in the build.</p>\n\n<p>Any ideas or tricks to get into the build where I want would be appreciated.</p>\n\n<p>Dan</p>\n"}, {"tags": ["c#", "linq-to-sql"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 1, "creation_date": 1423690294, "post_id": 28464858, "comment_id": 45255444, "body": "I would throw it away and create a new one."}, {"owner": {"reputation": 4482, "user_id": 295265, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/867f5708b7a424718f569f7ddc70c7b8?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/295265/kevin"}, "reply_to_user": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1423690464, "post_id": 28464858, "comment_id": 45255532, "body": "@Blorgbeard Yeah, that seems the best way to deal with this.  I looked at some other solutions to this question on Google and almost all of them say what you say.  I was hoping there was a neat &quot;ClearContext(datacontext)&quot; command.  Ah well, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 4482, "user_id": 295265, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/867f5708b7a424718f569f7ddc70c7b8?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/295265/kevin"}, "is_accepted": true, "score": 0, "last_activity_date": 1423696937, "creation_date": 1423696937, "answer_id": 28466527, "question_id": 28464858, "link": "https://stackoverflow.com/questions/28464858/clearing-data-context-on-error/28466527#28466527", "title": "Clearing data context on error?", "body": "<p>I figured it out.  Basically, all I had to do was remove the offending data from the data context by using the <code>DeleteOnSubmit()</code> method of the context.  All I had to do was supply which data object in the context I wanted to delete:</p>\n\n<p><code>dataContext.DeleteOnSubmit(offendingData);</code></p>\n"}], "owner": {"reputation": 4482, "user_id": 295265, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/867f5708b7a424718f569f7ddc70c7b8?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/295265/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 28466527, "answer_count": 1, "score": 0, "last_activity_date": 1423696937, "creation_date": 1423690112, "question_id": 28464858, "link": "https://stackoverflow.com/questions/28464858/clearing-data-context-on-error", "title": "Clearing data context on error?", "body": "<p>I'm working on a program that uses Linq-to-SQL.  There is a method in the program that bombs out because it's attempting to write a record with a duplicate key.  I've added a try/catch on the <code>context.SubmitChanges()</code> and I'm logging the error so I can check it out later.  My problem, though, is that since the insert didn't happen, the data context still has the 'bad' data in it.  Is there a way I can clear the context?</p>\n"}, {"tags": ["c#", "arrays", "list"], "comments": [{"owner": {"reputation": 7076, "user_id": 93922, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c80e295c8f9d603d771873e1997e3f85?s=128&d=identicon&r=PG", "display_name": "Tetsujin no Oni", "link": "https://stackoverflow.com/users/93922/tetsujin-no-oni"}, "edited": false, "score": 0, "creation_date": 1423690156, "post_id": 28464802, "comment_id": 45255377, "body": "why not split on curView, then split on your delimiter? (only taking the 0th element of the split result)"}, {"owner": {"reputation": 394243, "user_id": 50079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ud1xq.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/50079/jon"}, "reply_to_user": {"reputation": 7076, "user_id": 93922, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c80e295c8f9d603d771873e1997e3f85?s=128&d=identicon&r=PG", "display_name": "Tetsujin no Oni", "link": "https://stackoverflow.com/users/93922/tetsujin-no-oni"}, "edited": false, "score": 1, "creation_date": 1423690507, "post_id": 28464802, "comment_id": 45255553, "body": "@TetsujinnoOni: Because what happens if <code>curView</code> was just <code>&quot;1&quot;</code>?"}, {"owner": {"reputation": 7076, "user_id": 93922, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c80e295c8f9d603d771873e1997e3f85?s=128&d=identicon&r=PG", "display_name": "Tetsujin no Oni", "link": "https://stackoverflow.com/users/93922/tetsujin-no-oni"}, "edited": false, "score": 1, "creation_date": 1423690583, "post_id": 28464802, "comment_id": 45255587, "body": "I&#39;m accepting OP&#39;s example as contextual and sufficient to identify likely ranges. My FIRST instinct would be to not store a list of ints as a pipe delimited list, after all...."}, {"owner": {"reputation": 394243, "user_id": 50079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ud1xq.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/50079/jon"}, "reply_to_user": {"reputation": 7076, "user_id": 93922, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c80e295c8f9d603d771873e1997e3f85?s=128&d=identicon&r=PG", "display_name": "Tetsujin no Oni", "link": "https://stackoverflow.com/users/93922/tetsujin-no-oni"}, "edited": false, "score": 0, "creation_date": 1423690741, "post_id": 28464802, "comment_id": 45255675, "body": "@TetsujinnoOni: Mine too. But why make unforced assumptions?"}, {"owner": {"reputation": 595, "user_id": 3066592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9F1pe.png?s=128&g=1", "display_name": "PKD", "link": "https://stackoverflow.com/users/3066592/pkd"}, "edited": false, "score": 0, "creation_date": 1423690964, "post_id": 28464802, "comment_id": 45255801, "body": "I&#39;m entirely open to other methodology. I must admit I&#39;m not sure how to store/access lists in/from sessions."}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1423692277, "post_id": 28464802, "comment_id": 45256481, "body": "There is any possibility that the breadcrumb doesn&#39;t contain the curView?"}], "answers": [{"comments": [{"owner": {"reputation": 394243, "user_id": 50079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ud1xq.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/50079/jon"}, "edited": false, "score": 0, "creation_date": 1423690469, "post_id": 28464877, "comment_id": 45255534, "body": "It seems there is at least one person here who really dislikes regexes. I wonder why."}, {"owner": {"reputation": 2336, "user_id": 3021830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mMOGr.png?s=128&g=1", "display_name": "user3021830", "link": "https://stackoverflow.com/users/3021830/user3021830"}, "edited": false, "score": 0, "creation_date": 1423691739, "post_id": 28464877, "comment_id": 45256209, "body": "I havent&#39;t tried @Jon&#39;s code, but RegEx comes before code search. Harder to write but faster and keep the performance up even with bigger data."}, {"owner": {"reputation": 595, "user_id": 3066592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9F1pe.png?s=128&g=1", "display_name": "PKD", "link": "https://stackoverflow.com/users/3066592/pkd"}, "edited": false, "score": 0, "creation_date": 1423783324, "post_id": 28464877, "comment_id": 45300873, "body": "I&#39;m not sure why there was a downvote on it. I like the approach, because I&#39;m a fan of regex, but in the end I wound up going with lists in sessions. Actually, I went with a list of tuples."}], "tags": [], "owner": {"reputation": 394243, "user_id": 50079, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ud1xq.png?s=128&g=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/50079/jon"}, "is_accepted": false, "score": 1, "last_activity_date": 1423690186, "creation_date": 1423690186, "answer_id": 28464877, "question_id": 28464802, "link": "https://stackoverflow.com/questions/28464802/how-to-quickly-cut-up-and-reassemble-a-c-list/28464877#28464877", "title": "How to quickly cut up and reassemble a C# List?", "body": "<p>I almost regret this, but frankly I'd just go for a regular expression:</p>\n\n<pre><code>var result = Regex.Replace(input, \"(?&lt;=(\\\\||^)\" + current + \")(?=\\\\||$).*\", \"\");\n</code></pre>\n\n<p>This does not directly tell you if the current view existed in the input, but even though this is also possible with the regex in this particular instance another, dead simple test exists:</p>\n\n<pre><code>var viewExists = result.Length != current.Length;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 595, "user_id": 3066592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9F1pe.png?s=128&g=1", "display_name": "PKD", "link": "https://stackoverflow.com/users/3066592/pkd"}, "edited": false, "score": 0, "creation_date": 1423691522, "post_id": 28464881, "comment_id": 45256102, "body": "I really like this approach, but the <code>&#47;&#47;remove everything after that item in the array</code> is also a sticking point for me. How do I go about cutting out everything after curView from the list?"}, {"owner": {"reputation": 595, "user_id": 3066592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9F1pe.png?s=128&g=1", "display_name": "PKD", "link": "https://stackoverflow.com/users/3066592/pkd"}, "edited": false, "score": 0, "creation_date": 1423692648, "post_id": 28464881, "comment_id": 45256684, "body": "Actually, I&#39;ve answered that sub-question myself. I set up a new list, and iterate through the existing one, filling the new list up to and including the current view, at which point I stop making the new list, and set the session equal to that list."}, {"owner": {"reputation": 595, "user_id": 3066592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9F1pe.png?s=128&g=1", "display_name": "PKD", "link": "https://stackoverflow.com/users/3066592/pkd"}, "edited": false, "score": 0, "creation_date": 1423694415, "post_id": 28464881, "comment_id": 45257541, "body": "Using the approach of putting my list directly into the session, and skipping the whole &quot;delimited string&quot; thing was just the ticket. I figured out the rebuilding of the list up to the current item, and moved on from there. Thanks a lot!"}], "tags": [], "owner": {"reputation": 10460, "user_id": 11963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a2b408873aaec8d40698ad8117af75a?s=128&d=identicon&r=PG", "display_name": "hangy", "link": "https://stackoverflow.com/users/11963/hangy"}, "is_accepted": true, "score": 2, "last_activity_date": 1423690195, "last_edit_date": 1495540171, "creation_date": 1423690195, "answer_id": 28464881, "question_id": 28464802, "link": "https://stackoverflow.com/questions/28464802/how-to-quickly-cut-up-and-reassemble-a-c-list/28464881#28464881", "title": "How to quickly cut up and reassemble a C# List?", "body": "<p>You could just store a <code>List&lt;string&gt;</code> in the <code>Session</code> <a href=\"https://stackoverflow.com/a/1259942/11963\" title=\"Store List to session\">directly</a>. This saves you from having to split/concat the string manually. I know this does not answer the question directly, but I believe it is a superior solution to that.</p>\n\n<pre><code>var curView = \"1002\";\n\nvar crumb = Session[\"breadCrumb\"] as List&lt;string&gt;;\nif (crumb != null) {\n    var viewExists = crumb.Any(c =&gt; c.Value == curView);\n\n    if (viewExists) {\n        // remove everything after that item in the array.            \n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 595, "user_id": 3066592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9F1pe.png?s=128&g=1", "display_name": "PKD", "link": "https://stackoverflow.com/users/3066592/pkd"}, "edited": false, "score": 0, "creation_date": 1423690539, "post_id": 28464885, "comment_id": 45255568, "body": "In this instance, <code>c.Value</code> was just me psuedo-coding. :)"}, {"owner": {"reputation": 145, "user_id": 4001925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a547795a7a06e2c0045b2c28b4fd538?s=128&d=identicon&r=PG&f=1", "display_name": "jdnew18", "link": "https://stackoverflow.com/users/4001925/jdnew18"}, "edited": false, "score": 1, "creation_date": 1423777623, "post_id": 28464885, "comment_id": 45298501, "body": "Goodness, Mr.Whitaker&#39;s answer really would be incredibly fast: No .Split(&#39;|) and no .ToList() would really speed things up. Still, your answer is quite useful for demonstrating where .TakeWhile() can be used (at least I found it useful!)."}], "tags": [], "owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "is_accepted": false, "score": 3, "last_activity_date": 1423779643, "last_edit_date": 1495542035, "creation_date": 1423690210, "answer_id": 28464885, "question_id": 28464802, "link": "https://stackoverflow.com/questions/28464802/how-to-quickly-cut-up-and-reassemble-a-c-list/28464885#28464885", "title": "How to quickly cut up and reassemble a C# List?", "body": "<p>You could use <a href=\"https://msdn.microsoft.com/en-us/library/vstudio/bb534804(v=vs.100).aspx\" rel=\"nofollow noreferrer\">TakeWhile</a> to get back only the items from the splitted list that precede the currentView.</p>\n\n<pre><code>var curView = \"1002\";\nif (Session[\"breadCrumb\"] != null) \n{\n    var crumb = Session[\"breadCrumb\"].ToString().Split('|').ToList();\n    var viewExists = crumb.TakeWhile(c =&gt; c != curView).ToList();\n    viewExists.Add(curView);\n    string result = string.Join(\"|\",viewExists);\n}\n</code></pre>\n\n<p>While this approach works I think that also the previous answer (now wrongly deleted from Mr. Andrew Whitaker) was correct. Using IndexOf should be faster with less splitting, looping, joining strings. I suggest Mr Whitaker to undelete its answer.</p>\n\n<p><strong>EDIT</strong><br>\n<strong>This is from the deleted answer from <a href=\"https://stackoverflow.com/users/497356/andrew-whitaker\">Mr.Whitaker</a>.</strong><br>\nI will repost here because I think that its approach is simpler and should give better perfomances, so future readers could see also this option.</p>\n\n<pre><code>var crumb = Session[\"breadCrumb\"].ToString()\nint index = crumb.IndexOf(curView);\nif (index &gt;= 0)\n{\n    Session[\"breadCrumb\"] = crumb.Substring(0, index + curView.Length);\n}\n</code></pre>\n\n<p>If Andrew decide to undelete its answer I will be glad to remove this part. Just let me know.</p>\n"}], "owner": {"reputation": 595, "user_id": 3066592, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9F1pe.png?s=128&g=1", "display_name": "PKD", "link": "https://stackoverflow.com/users/3066592/pkd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "accepted_answer_id": 28464881, "answer_count": 3, "score": 0, "last_activity_date": 1423779643, "creation_date": 1423689876, "question_id": 28464802, "link": "https://stackoverflow.com/questions/28464802/how-to-quickly-cut-up-and-reassemble-a-c-list", "title": "How to quickly cut up and reassemble a C# List?", "body": "<p>The setup:\nI have a session variable that carries a list of IDs, pipe-delimited. The IDs are related to views in my site, and related to a breadcrumb builder.</p>\n\n<pre><code>Session[\"breadCrumb\"] = \"1001|1002|1003|1004\";\n</code></pre>\n\n<p>If I'm on the view that corresponds to 1002, I'd like to cut everything AFTER that id out of the session variable.</p>\n\n<p>I'd thought to use something like:</p>\n\n<pre><code>var curView = \"1002\";\n\nif (Session[\"breadCrumb\"] != null) {\n    var crumb = Session[\"breadCrumb\"].ToString().Split('|').ToList();\n    var viewExists = crumb.Any(c =&gt; c.Value == curView);\n\n    if (viewExists) {\n        //remove everything after that item in the array.\n    }\n\n}\n</code></pre>\n\n<p>But I'm wide open to methodologies.</p>\n"}, {"tags": ["c#", "android", "visual-studio-2012", "xamarin", "android-gridview"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 4259340, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/68a36dfd5cc593a9467b331a27d61437?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin F", "link": "https://stackoverflow.com/users/4259340/kevin-f"}, "edited": false, "score": 0, "creation_date": 1423747073, "post_id": 28469437, "comment_id": 45279466, "body": "Hi, thanks for response. I have a question: Need create a .axml from one cell and the .axml from the gridview?"}, {"owner": {"reputation": 1482, "user_id": 33483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/955323838b1c111c5e9b1936dc44d9fd?s=128&d=identicon&r=PG", "display_name": "Tom Opgenorth", "link": "https://stackoverflow.com/users/33483/tom-opgenorth"}, "reply_to_user": {"reputation": 149, "user_id": 4259340, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/68a36dfd5cc593a9467b331a27d61437?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin F", "link": "https://stackoverflow.com/users/4259340/kevin-f"}, "edited": false, "score": 0, "creation_date": 1423765274, "post_id": 28469437, "comment_id": 45291688, "body": "Just one .AXML will do, for the row. You could probably use a LinearLayout to hold your ImageView and TextView."}, {"owner": {"reputation": 149, "user_id": 4259340, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/68a36dfd5cc593a9467b331a27d61437?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin F", "link": "https://stackoverflow.com/users/4259340/kevin-f"}, "edited": false, "score": 0, "creation_date": 1424717759, "post_id": 28469437, "comment_id": 45655193, "body": "Can you help me with other problem in the custom gridview? Thanks"}], "tags": [], "owner": {"reputation": 1482, "user_id": 33483, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/955323838b1c111c5e9b1936dc44d9fd?s=128&d=identicon&r=PG", "display_name": "Tom Opgenorth", "link": "https://stackoverflow.com/users/33483/tom-opgenorth"}, "is_accepted": true, "score": 3, "last_activity_date": 1424807008, "last_edit_date": 1424807008, "creation_date": 1423716111, "answer_id": 28469437, "question_id": 28464775, "link": "https://stackoverflow.com/questions/28464775/xamarin-create-a-custom-grid-view/28469437#28469437", "title": "Xamarin: Create a custom grid View", "body": "<p>Create a new layout that has the ImageView &amp; TextView. Then, in the <code>GetView</code> method of the <code>ImageAdapter</code> class, inflate that layout and populate it, for example:</p>\n\n<pre><code>public override View GetView (int position, View convertView, ViewGroup parent)\n{\n    View view;\n\n    if (convertView == null) \n    {  \n        view = LayoutInflater.From(parent.Context).Inflate(Resource.Layout.my_grid_row, parent, false);\n    }\n    else\n    {\n        view = convertView;\n    }\n\n\n    var imageView = view.FindViewById&lt;ImageView&gt;(Resource.Id.my_image_view);\n    imageView.SetImageResource (thumbIds[position]);\n\n    var textView = view.FindViewById&lt;TextView&gt;(Resource.Id.my_text_view);\n    textView.Text = \"Text to Display\";\n\n    return view;\n}\n</code></pre>\n\n<p><strong>Edit:</strong> (Add to Code \"(\" and \";\")</p>\n\n<p><strong>Update:</strong> Here is a sample layout file, <code>my_grid_row.axml</code>, that is inflated by the <code>GetView</code> method:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;LinearLayout\n    android:orientation=\"vertical\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"&gt;\n    &lt;ImageView\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"250dp\"\n        android:scaleType=\"centerCrop\"\n        android:id=\"@+id/my_image_vieww\" /&gt;\n    &lt;TextView\n        android:textAppearance=\"?android:attr/textAppearanceLarge\"\n        android:layout_width=\"match_parent\"\n        android:layout_height=\"wrap_content\"\n        android:id=\"@+id/my_text_view\" /&gt;\n&lt;/LinearLayout&gt;\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4259340, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/68a36dfd5cc593a9467b331a27d61437?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin F", "link": "https://stackoverflow.com/users/4259340/kevin-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8418, "favorite_count": 1, "accepted_answer_id": 28469437, "answer_count": 1, "score": 2, "last_activity_date": 1424807008, "creation_date": 1423689766, "question_id": 28464775, "link": "https://stackoverflow.com/questions/28464775/xamarin-create-a-custom-grid-view", "title": "Xamarin: Create a custom grid View", "body": "<p>I need create a custom GridView in Android Application (Dev. on VS2012 with Xamarin plugin). \nI need on each cell  a image and label text. </p>\n\n<p>This example work perfectly, but has not a text label.\n<a href=\"http://developer.xamarin.com/guides/android/user_interface/grid_view/\" rel=\"nofollow\">http://developer.xamarin.com/guides/android/user_interface/grid_view/</a></p>\n\n<p>I need anything how this:\n<a href=\"http://1.bp.blogspot.com/-nCDvyS6U0ns/UfCu2GxB-3I/AAAAAAAAAvQ/muREYvnb7m4/s1600/Screenshot_2013-07-25-10-10-14.png\" rel=\"nofollow\">Custom Grid View {Image+Text}</a></p>\n\n<p>but I only found Java Examples.\nPlease Help me</p>\n\n<p>PD: Sorry by Image, but I can't upload images (I need more reputation).</p>\n"}, {"tags": ["c#", "generics", "data-binding"], "answers": [{"tags": [], "owner": {"reputation": 4767, "user_id": 3911233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72dcd131c52bf8f025d147620b6d59f9?s=128&d=identicon&r=PG&f=1", "display_name": "steve16351", "link": "https://stackoverflow.com/users/3911233/steve16351"}, "is_accepted": false, "score": 0, "last_activity_date": 1423780047, "last_edit_date": 1423780047, "creation_date": 1423779556, "answer_id": 28488946, "question_id": 28464746, "link": "https://stackoverflow.com/questions/28464746/c-generic-type-cannot-bind-to-the-property-or-column/28488946#28488946", "title": "C# Generic type; Cannot bind to the property or column", "body": "<p>I think you can only bind to properties of a custom object, not fields. This seems a bit overkill but if there's an easier way I'm sure someone will correct me..</p>\n\n<p>Assuming you don't want to change your fields to properties, and you really want to use binding, you could generate a kind of DTO to bind to instead. For example, here is how you would bind, so use proxyType instead of your actual type.</p>\n\n<pre><code>ComponentControl&lt;int&gt; component = new ComponentControl&lt;int&gt;() { A = \"A\", B = 1, C = 2 };\nType type = component.GetType();            \ndynamic proxyType = DynamicProxyGenerator.GetInstanceFor&lt;ComponentControl&lt;int&gt;&gt;(component);            \n\nforeach (var f in type.GetFields().Where(f =&gt; f.IsPublic))\n{\n    TextBox control = new TextBox();\n    Binding binding = new Binding(\"Text\", proxyType, f.Name, false, DataSourceUpdateMode.OnPropertyChanged);\n\n    control.DataBindings.Add(binding);\n}\n</code></pre>\n\n<p>And here is the code for <code>DynamicProxyGenerator</code> which generates that..</p>\n\n<pre><code>public static class DynamicProxyGenerator\n{\n    public static object GetInstanceFor&lt;T&gt;(T toBind)\n    {\n        Type typeOfT = typeof(T);\n\n        AssemblyName assName = new AssemblyName(\"testAssembly\");\n        var assBuilder = AppDomain.CurrentDomain.DefineDynamicAssembly(assName, AssemblyBuilderAccess.RunAndSave);            \n        var moduleBuilder = assBuilder.DefineDynamicModule(\"dynamicModule\", \"dynamicBinder.dll\");\n        var typeBuilder = moduleBuilder.DefineType(typeOfT.Name + \"Proxy\", TypeAttributes.Public | TypeAttributes.Class);            \n        FieldBuilder bindingSourceField = typeBuilder.DefineField(\"BindingSource\", typeOfT, FieldAttributes.Public);            \n\n        foreach (FieldInfo toCopyField in typeOfT.GetFields()) \n        {\n            PropertyBuilder propBuilder = typeBuilder.DefineProperty(toCopyField.Name, System.Reflection.PropertyAttributes.None, toCopyField.FieldType, null);                             \n\n            MethodBuilder getter = typeBuilder.DefineMethod(\"get_\" + toCopyField.Name,  MethodAttributes.Public, toCopyField.FieldType, Type.EmptyTypes);                \n            ILGenerator getIL = getter.GetILGenerator();\n            getIL.Emit(OpCodes.Ldarg_0);\n            getIL.Emit(OpCodes.Ldfld, bindingSourceField);\n            getIL.Emit(OpCodes.Ldfld, toCopyField);\n            getIL.Emit(OpCodes.Ret);\n            propBuilder.SetGetMethod(getter);\n\n            MethodBuilder setter = typeBuilder.DefineMethod(\"set_\" + toCopyField.Name,  MethodAttributes.Public, null, new Type[] { toCopyField.FieldType });\n            ILGenerator setIL = setter.GetILGenerator();\n            setIL.Emit(OpCodes.Ldarg_0);\n            setIL.Emit(OpCodes.Ldfld, bindingSourceField);\n            setIL.Emit(OpCodes.Ldarg_1);                \n            setIL.Emit(OpCodes.Stfld, toCopyField);\n            setIL.Emit(OpCodes.Ret);\n            propBuilder.SetSetMethod(setter);                \n        }\n\n        Type constructedType = typeBuilder.CreateType();\n        dynamic instance = Activator.CreateInstance(constructedType);\n        instance.BindingSource = toBind;\n\n        return instance;\n    }\n}  \n</code></pre>\n\n<p>So what this does is create a new type on the fly that would look like this, which you can use as the binding source to act as a go between for the control and your object.</p>\n\n<pre><code>public class ComponentControlProxy\n{\n    public ComponentControl&lt;int&gt; BindingSource;\n\n    public string A \n    {\n        get \n        {\n            return BindingSource.A;\n        }\n        set \n        {\n            BindingSource.A = value;\n        }\n    }\n\n    .. etc\n}\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 1853307, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fbf32c0a0e8777e8bac2d8655d534294?s=128&d=identicon&r=PG", "display_name": "R4VANG3R", "link": "https://stackoverflow.com/users/1853307/r4vang3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423780047, "creation_date": 1423689656, "question_id": 28464746, "link": "https://stackoverflow.com/questions/28464746/c-generic-type-cannot-bind-to-the-property-or-column", "title": "C# Generic type; Cannot bind to the property or column", "body": "<p>So I have this Generic typed class that uses System.Reflection to get all public variables from a Class and render those as Controls.</p>\n\n<p>However I need to be able to use these variables as DataBindings for the Controls so when the controls receive input, that input saves to the corresponding variables.</p>\n\n<p>This is what I have so far but I'm getting a 'Cannot bind to the property or column' error.</p>\n\n<p>The Class:</p>\n\n<pre><code>public class ComponentControl&lt;T&gt; where T : Component\n{\n   private T component;\n\n   public ComponentControl(T component)\n   {\n      this.component = component;\n   }\n}\n</code></pre>\n\n<p>The part that wont work:</p>\n\n<pre><code>foreach (var f in type.GetFields().Where(f =&gt; f.IsPublic))\n{\n   TextBox control = new TextBox();\n   Binding binding = new Binding(\"Text\", component, f.Name, false, DataSourceUpdateMode.OnPropertyChanged);\n   control.DataBindings.Add(binding);\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "image", "xaml"], "comments": [{"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1423691627, "post_id": 28464714, "comment_id": 45256156, "body": "Why don&#39;t you just bind to two view model properties? You would create the Image controls in XAML as the Button&#39;s Content and bind their Source property to the view model properties (or properties of your MainWindow class if you prefer that). Having controls as resources is a bad idea anyway."}, {"owner": {"reputation": 13888, "user_id": 469319, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HfDJ2.png?s=128&g=1", "display_name": "RLH", "link": "https://stackoverflow.com/users/469319/rlh"}, "reply_to_user": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1423691784, "post_id": 28464714, "comment_id": 45256235, "body": "@Clemens  I&#39;ll look into that.  This is my first attempt at WPF.  That approach might work.  How do I do that?"}], "answers": [{"tags": [], "owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1423692917, "last_edit_date": 1423692917, "creation_date": 1423692572, "answer_id": 28465501, "question_id": 28464714, "link": "https://stackoverflow.com/questions/28464714/how-do-you-set-a-xaml-defined-window-resource-image-programmatically/28465501#28465501", "title": "How do you set a Xaml defined, Window.Resource Image programmatically?", "body": "<p>Instead of using Image controls as resources, you could declare and bind to two properties in your MainWindow class.</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        UpdateImage = ImageHelpers.ConvertBitmapToImageSource(...);\n        DeleteImage = ImageHelpers.ConvertBitmapToImageSource(...);\n\n        InitializeComponent();\n    }\n\n    public ImageSource UpdateImage { get; set; }\n    public ImageSource DeleteImage { get; set; }\n}\n</code></pre>\n\n<p>You would bind to these properties by assigning a Name to the Window</p>\n\n<pre><code>&lt;Window ... x:Name=\"window\"&gt;\n</code></pre>\n\n<p>and declare an ElementName binding:</p>\n\n<pre><code>&lt;Button ...&gt;\n    &lt;Button.Content&gt;\n        &lt;Image Source=\"{Binding UpdateImage, ElementName=window}\"/&gt;\n    &lt;/Button.Content&gt;\n&lt;/Button&gt;\n</code></pre>\n\n<hr>\n\n<p>And to answer your question, your problem is that you assign a new Image instance to the <code>iUpdate</code> field right after assigning it to the resource instance. Your code should have looked like this:</p>\n\n<pre><code>iUpdate = (Image)Resources[\"iUpdate\"];\niUpdate.Source = ImageHelpers.ConvertBitmapToImageSource(...);\n</code></pre>\n"}], "owner": {"reputation": 13888, "user_id": 469319, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HfDJ2.png?s=128&g=1", "display_name": "RLH", "link": "https://stackoverflow.com/users/469319/rlh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 28465501, "answer_count": 1, "score": 0, "last_activity_date": 1423692917, "creation_date": 1423689579, "last_edit_date": 1423690569, "question_id": 28464714, "link": "https://stackoverflow.com/questions/28464714/how-do-you-set-a-xaml-defined-window-resource-image-programmatically", "title": "How do you set a Xaml defined, Window.Resource Image programmatically?", "body": "<p>I have a xaml file that has a series of resources that I use in my window.  Specifically, I have two <code>Image</code> objects.  Instead of encoding a URI location, I need to set these images in the constructor of my Window.  How can I do this?</p>\n\n<p>I've searched and searched, and I've tried to set the image <code>.Source</code> property.  Nothing has worked.  For reference, here is how these images are declared in my xaml file:</p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;Image x:Key=\"iUpdate\" /&gt;\n    &lt;Image x:Key=\"iDelete\" /&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>And here is how they are used for a button's content:</p>\n\n<pre><code>                &lt;DataTemplate&gt;\n                    &lt;DockPanel&gt;\n                        &lt;Button Name=\"UpdateChange\" Content=\"{StaticResource iUpdate}\" Width=\"24\" /&gt;\n                        &lt;Button Name=\"DeleteChange\" Content=\"{StaticResource iDelete}\" Width=\"24\" /&gt;\n                        &lt;Label Content=\"{Binding name}\" /&gt;\n                    &lt;/DockPanel&gt;\n                &lt;/DataTemplate&gt;\n</code></pre>\n\n<p>Here is my failed attempt at setting the image's source.</p>\n\n<pre><code>        //In my constructor...\n        // iUpdate is a property on the Window\n        iUpdate = (Image)FindResource(\"iUpdate\");\n                    iUpdate = new Image();\n        iUpdate.Source = ImageHelpers.ConvertBitmapToImageSource(Common.LoadImage(\"edit.ico\"));\n</code></pre>\n\n<p>FYI, I can't set the source in my xaml file because the call to <code>Common.LoadImage(...)</code> is a special call that resolves the location of the file.  This could vary significantly from user-to-user, which is why the helper-method exists in the first place.</p>\n"}, {"tags": ["c#", "windows-phone-8.1"], "answers": [{"tags": [], "owner": {"reputation": 14835, "user_id": 2059028, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/2fbf62caebe159d87e6c8a415c2f281f?s=128&d=identicon&r=PG", "display_name": "Igor Ralic", "link": "https://stackoverflow.com/users/2059028/igor-ralic"}, "is_accepted": true, "score": 3, "last_activity_date": 1423693877, "creation_date": 1423693877, "answer_id": 28465821, "question_id": 28464712, "link": "https://stackoverflow.com/questions/28464712/how-do-i-change-the-icon-of-an-app-bar-button-toggle-in-c-code/28465821#28465821", "title": "How do I change the icon of an app bar button toggle in c# code", "body": "<p>Set it to SymbolIcon - Play for play symbol:</p>\n\n<pre><code>btn.Icon = new SymbolIcon(Symbol.Play);\n</code></pre>\n\n<p>and Pause for pause symbol:</p>\n\n<pre><code>btn.Icon = new SymbolIcon(Symbol.Pause);\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 4171690, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/5a9e816dd302e6dd8d5a66b4062d4a00?s=128&d=identicon&r=PG&f=1", "display_name": "Mavese", "link": "https://stackoverflow.com/users/4171690/mavese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "accepted_answer_id": 28465821, "answer_count": 1, "score": 0, "last_activity_date": 1423693877, "creation_date": 1423689574, "question_id": 28464712, "link": "https://stackoverflow.com/questions/28464712/how-do-i-change-the-icon-of-an-app-bar-button-toggle-in-c-code", "title": "How do I change the icon of an app bar button toggle in c# code", "body": "<p>I want to change the icon of an app bar button toggle once it is checked then again when it is unchecked. I am sure the .icon property is used but I don't know what to set it to. I want to change it from a play to a pause button each time it is clicked.</p>\n\n<pre><code>    private void abtnTimer_Clicked(object sender, RoutedEventArgs e)\n            {\n               AppBarToggleButton btn = sender as AppBarToggleButton;\n                if (btn.IsChecked == true)\n                {\n                    btn.Icon = //not sure what this should be\n                    string s = DateTime.Now.ToString();\n                    localSettings.Values[\"Timer\"] = s;\n                }\n                else\n                {\n                    btn.Icon = //turn the icon into a play icon\n                    DateTime dte = Convert.ToDateTime(localSettings.Values[\"Timer\"]);\n                    TimeSpan t;\n                    t = DateTime.Now.Subtract(dte);\n                    txtblkHoursData.Text = t.ToString();\n                }\n            }\n</code></pre>\n"}, {"tags": ["c#", "c++", ".net", "winapi", "windows-services"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423693079, "post_id": 28464698, "comment_id": 45256922, "body": "Services run in session 0 which is a non interactive session"}, {"owner": {"reputation": 4487, "user_id": 1071834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dabd6a9127b355f6faad878258e4adac?s=128&d=identicon&r=PG", "display_name": "dodexahedron", "link": "https://stackoverflow.com/users/1071834/dodexahedron"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423693214, "post_id": 28464698, "comment_id": 45256999, "body": "This isn&#39;t an interactive application and is launched with CREATE_NO_WINDOW.  Besides, as I mentioned, it works fine when I call a win32 application.  The problem only occurs when the child application is .Net."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423693593, "post_id": 28464698, "comment_id": 45257206, "body": "Likely to be a session 0 issue. Some more debugging needed."}, {"owner": {"reputation": 4487, "user_id": 1071834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dabd6a9127b355f6faad878258e4adac?s=128&d=identicon&r=PG", "display_name": "dodexahedron", "link": "https://stackoverflow.com/users/1071834/dodexahedron"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423694001, "post_id": 28464698, "comment_id": 45257376, "body": "Can you elaborate a bit?  I&#39;m not even sure what can be &quot;debugged&quot; in this situation. The .Net application fails to run at all. I can&#39;t even get it to write to a test output file.  I&#39;ll agree it&#39;s likely a session 0-related issue, since that&#39;s the most glaring difference between the two methods of execution (console vs service). But I already know/suspect that. I just don&#39;t know how to proceed."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423694504, "post_id": 28464698, "comment_id": 45257581, "body": "Create a do nothing app and see if that works. Then make more complex."}, {"owner": {"reputation": 4487, "user_id": 1071834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dabd6a9127b355f6faad878258e4adac?s=128&d=identicon&r=PG", "display_name": "dodexahedron", "link": "https://stackoverflow.com/users/1071834/dodexahedron"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1423694695, "post_id": 28464698, "comment_id": 45257688, "body": "I&#39;ve already done this with a hello world application.  But, on your suggestion, I just gave it a shot with an application with an empty main().  Same behavior."}], "owner": {"reputation": 4487, "user_id": 1071834, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/dabd6a9127b355f6faad878258e4adac?s=128&d=identicon&r=PG", "display_name": "dodexahedron", "link": "https://stackoverflow.com/users/1071834/dodexahedron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1423694787, "creation_date": 1423689522, "last_edit_date": 1423694787, "question_id": 28464698, "link": "https://stackoverflow.com/questions/28464698/redirect-console-from-net-application-to-c-application-launched-by-a-service", "title": "Redirect console from .Net application to C++ application launched by a service", "body": "<p>I have a win32 application (call it wrapper) which, as part of its duties, launches another application (.net - call it child) and captures its output by redirecting the stdout of child to its own stdout.</p>\n\n<p>This works fine from the console.</p>\n\n<p>However, if wrapper is launched periodically by a .net windows service, wrapper runs just fine but child fails to run.  There is no .Net stack trace in the windows event viewer and the process exit code returned from child is 0xC06D007E, which equates to \"Unknown Software Exception.\"</p>\n\n<p>If I replace child with a win32 application, it launches, but there seems to be an encoding mismatch because the output gets turned into a bunch of missing glyphs.  But at least the application runs and returns exit code 0 in that case.</p>\n\n<p>So I have two problems, here:</p>\n\n<ol>\n<li>Why can't I launch child (.net) from wrapper (win32), when called from a service (.net)?</li>\n<li>If child is a win32 application, why is the character encoding messed up when wrapper is called through the service but not when called directly on the console?</li>\n</ol>\n\n<p>Here's a link to the wrapper application source code:\n<a href=\"http://pastebin.com/akgaR090\" rel=\"nofollow\">http://pastebin.com/akgaR090</a></p>\n\n<p>The source code of child is irrelevant, as a hello world application is sufficient to demonstrate the behavior.</p>\n\n<p>The .net service is calling the wrapper application with this code:\n<a href=\"http://pastebin.com/k0DYMB1f\" rel=\"nofollow\">http://pastebin.com/k0DYMB1f</a></p>\n\n<p>Child source code sufficient to replicate the issue:</p>\n\n<pre><code>public class Child\n{\n    public int Main(string[] args)\n    {\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "entity-framework", "lambda", "entity-framework-5"], "comments": [{"owner": {"reputation": 145, "user_id": 4001925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a547795a7a06e2c0045b2c28b4fd538?s=128&d=identicon&r=PG&f=1", "display_name": "jdnew18", "link": "https://stackoverflow.com/users/4001925/jdnew18"}, "edited": false, "score": 1, "creation_date": 1423689612, "post_id": 28464637, "comment_id": 45255083, "body": "This is an awfully similar question: <a href=\"http://stackoverflow.com/questions/470440/how-to-select-only-the-records-with-the-highest-date-in-linq\" title=\"how to select only the records with the highest date in linq\">stackoverflow.com/questions/470440/&hellip;</a>"}, {"owner": {"reputation": 35505, "user_id": 1394631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ajAkr.jpg?s=128&g=1", "display_name": "octavioccl", "link": "https://stackoverflow.com/users/1394631/octavioccl"}, "edited": false, "score": 0, "creation_date": 1423691647, "post_id": 28464637, "comment_id": 45256164, "body": "Is the <code>InsuranceDate</code> a <code>DateTime</code> or <code>int</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 5012, "user_id": 3845456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEWf8.jpg?s=128&g=1", "display_name": "DrewJordan", "link": "https://stackoverflow.com/users/3845456/drewjordan"}, "is_accepted": false, "score": 0, "last_activity_date": 1423693145, "creation_date": 1423693145, "answer_id": 28465651, "question_id": 28464637, "link": "https://stackoverflow.com/questions/28464637/entity-framework-how-to-select-first-row-each-idnumber-by-one-query-using-lamb/28465651#28465651", "title": "Entity Framework - how to select first row each IDNumber by one query Using lambda", "body": "<p>You can try something like this: <code>var result = Orders.OrderByDescending(o =&gt; o.InsuranceDate).FirstOrDefault(x =&gt; x.IdNumber == userID);</code> where userID is the user's ID that you want to match. </p>\n"}, {"tags": [], "owner": {"reputation": 35505, "user_id": 1394631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ajAkr.jpg?s=128&g=1", "display_name": "octavioccl", "link": "https://stackoverflow.com/users/1394631/octavioccl"}, "is_accepted": true, "score": 2, "last_activity_date": 1423694801, "last_edit_date": 1423694801, "creation_date": 1423694247, "answer_id": 28465903, "question_id": 28464637, "link": "https://stackoverflow.com/questions/28464637/entity-framework-how-to-select-first-row-each-idnumber-by-one-query-using-lamb/28465903#28465903", "title": "Entity Framework - how to select first row each IDNumber by one query Using lambda", "body": "<p>Try with this solution:</p>\n\n<pre><code>  var r = db.Orders.GroupBy(o =&gt; o.IdNumber).Select(g =&gt; g.OrderByDescending(o =&gt; o.InsuranceDate).FirstOrDefault());\n</code></pre>\n\n<p>First, you need to group your orders by the user id. Then, sort in descending order each group and select only the first. This way you will get the last order of each user.</p>\n"}], "owner": {"reputation": 1264, "user_id": 1804706, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e40ba0ca6c4eb88a45679f390093a50c?s=128&d=identicon&r=PG", "display_name": "Daniel Ezra", "link": "https://stackoverflow.com/users/1804706/daniel-ezra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2618, "favorite_count": 1, "accepted_answer_id": 28465903, "answer_count": 2, "score": 2, "last_activity_date": 1424966759, "creation_date": 1423689303, "last_edit_date": 1424966759, "question_id": 28464637, "link": "https://stackoverflow.com/questions/28464637/entity-framework-how-to-select-first-row-each-idnumber-by-one-query-using-lamb", "title": "Entity Framework - how to select first row each IDNumber by one query Using lambda", "body": "<p>I have orders table with <code>IdNumber</code> that is the ID of the user, I need to get the last order of each user (the <code>InsuranceDate</code> is the date).</p>\n\n<p>The problem is how to get the last order if one user can have many orders. how to do it with one query without huge foreach after the entity query ?</p>\n\n<pre><code>public class Order\n{\n    [Key]\n    public int OrderID { get; set; }        \n    public string IdNumber { get; set; }\n    public int Price { get; set; }\n    public Datetime InsuranceDate { get; set; }\n}\n</code></pre>\n"}, {"tags": ["c#", "jquery", "ajax", "json", "asp.net-mvc"], "comments": [{"owner": {"reputation": 97691, "user_id": 15861, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/275af4aa6765c449ed7d1b4862583bcc?s=128&d=identicon&r=PG", "display_name": "BFree", "link": "https://stackoverflow.com/users/15861/bfree"}, "edited": false, "score": 1, "creation_date": 1423689812, "post_id": 28464627, "comment_id": 45255187, "body": "Are you sure your javascript is getting the values you&#39;re expecting? Log out the <code>comments</code> and <code>commentCriterions</code> array before sending it across the wire and see if they have the data in them."}, {"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1423690486, "post_id": 28464627, "comment_id": 45255541, "body": "Remove the quotes around the argument names in the ajax call: i.e. data: { comments: comments, commentCriterions: commentCriterions, ...etc... }"}, {"owner": {"reputation": 59, "user_id": 3038467, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a41068b531419e4bbe7a8611cd2006f?s=128&d=identicon&r=PG", "display_name": "Michael Carreon", "link": "https://stackoverflow.com/users/3038467/michael-carreon"}, "edited": false, "score": 0, "creation_date": 1423691359, "post_id": 28464627, "comment_id": 45256012, "body": "To BFree - Yes, I used console.log() to test that the values were being set correctly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 1, "creation_date": 1423691789, "post_id": 28464627, "comment_id": 45256238, "body": "You need to set <code>contentType: &quot;application&#47;json; charset=utf-8&quot;,</code> in the ajax options."}, {"owner": {"reputation": 59, "user_id": 3038467, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a41068b531419e4bbe7a8611cd2006f?s=128&d=identicon&r=PG", "display_name": "Michael Carreon", "link": "https://stackoverflow.com/users/3038467/michael-carreon"}, "edited": false, "score": 0, "creation_date": 1423695076, "post_id": 28464627, "comment_id": 45257833, "body": "After adding <code>contentType: &quot;application&#47;json; charset=utf-8&quot;,</code> between traditonal and data, I get a 500 internal server error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 1, "creation_date": 1423696844, "post_id": 28464627, "comment_id": 45258569, "body": "You also need to stringify the data. e.g. <code>var data = { comments: comments, commentCriterions: commentCriterions, ..};</code> then <code>data: JSON.stringify(data),</code>"}, {"owner": {"reputation": 59, "user_id": 3038467, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a41068b531419e4bbe7a8611cd2006f?s=128&d=identicon&r=PG", "display_name": "Michael Carreon", "link": "https://stackoverflow.com/users/3038467/michael-carreon"}, "edited": false, "score": 0, "creation_date": 1423697423, "post_id": 28464627, "comment_id": 45258777, "body": "Thank you! It worked perfectly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1423699783, "post_id": 28464627, "comment_id": 45259620, "body": "Note also you can also use the <code>.map</code> function to generate your arrays - e.g. <code>var comments = $(someSelector).map(function () { return $(this).val(); }).get();</code> I&#39;ll post answer shortly."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "is_accepted": true, "score": 1, "last_activity_date": 1423700385, "creation_date": 1423700385, "answer_id": 28467138, "question_id": 28464627, "link": "https://stackoverflow.com/questions/28464627/how-to-use-ajax-jquery-to-send-arrays-to-the-controller-mvc/28467138#28467138", "title": "How to use Ajax (Jquery) to send arrays to the Controller (MVC)", "body": "<p>When posting arrays using <code>traditional: true,</code> you need to stringify your data and include <code>contentType: \"application/json; charset=utf-8\",</code></p>\n\n<pre><code>var data = { comments: comments, commentCriterions: commentCriterions, observationId: observationId, reviewingId: @reviewingId };\n$.ajax({\n  url: '@Url.Action(\"SaveComment\")'; // always use @Url.Action!\n  method: \"post\",\n  dataType: 'json',\n  traditonal: true,\n  contentType: \"application/json; charset=utf-8\", // add this\n  data: JSON.stringify(data), // change this\n  success: function (status) {\n    if (status == \"False\") {\n      alert(\"The ID number of the person currently being reviewed has changed, please refresh the page and try again. Any changes to this observation will not be saved.\")\n    }\n  }\n})\n</code></pre>\n\n<p>Side notes</p>\n\n<ol>\n<li>You can use the jQuery <code>.map()</code> function to easily generate your\narrays, for example <code>var comments = $(someSelector).map(function ()\n{ return $(this).val(); }).get();</code></li>\n<li>Consider returning <code>null</code> rather than <code>return Json(false);</code>. Then\nits just <code>if(!success) { alert(..); }</code></li>\n</ol>\n"}], "owner": {"reputation": 59, "user_id": 3038467, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8a41068b531419e4bbe7a8611cd2006f?s=128&d=identicon&r=PG", "display_name": "Michael Carreon", "link": "https://stackoverflow.com/users/3038467/michael-carreon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1970, "favorite_count": 0, "accepted_answer_id": 28467138, "answer_count": 1, "score": 1, "last_activity_date": 1423700385, "creation_date": 1423689283, "last_edit_date": 1423696688, "question_id": 28464627, "link": "https://stackoverflow.com/questions/28464627/how-to-use-ajax-jquery-to-send-arrays-to-the-controller-mvc", "title": "How to use Ajax (Jquery) to send arrays to the Controller (MVC)", "body": "<p>I've seen a variety of ways people do it, but It's still failing to set the values for the arrays \"comments\" and \"commentCriterions\" in the controller. Any help would be much appreciated.</p>\n\n<p>Edit: I managed to use JSON.stringify</p>\n\n<pre><code>data: {\n            'comments': JSON.stringify(comments),\n</code></pre>\n\n<p>The array is set, but set incorrectly</p>\n\n<pre><code> comments[0] = \"[\\\"zxczxczx\\\",\\\"Another boring comment\\\",\\\"Why is this broken?!\\\",\\\"GASP!\\\"]\"\n</code></pre>\n\n<p>JQuery</p>\n\n<pre><code>function saveComment(popupId) {\n    var textArea = popupId.find('@commentClass');\n    var comments = [];\n    var commentCriterions = [];\n    for (var i = 0; i &lt; textArea.length; i++) {\n        comments[i] = textArea.val();\n        commentCriterions[i] = textArea.attr(\"data-criterionid\");\n    }\n\n    $.ajax({\n        url: \"SaveComment\",\n        method: \"post\",\n        dataType: 'json',\n        traditonal: true,\n        data: {\n            'comments': comments,\n            'commentCriterions': commentCriterions,\n            'observationId': observationId,\n            'reviewingId': '@reviewingId'\n        },\n        success: function (status) {\n            if (status == \"False\") {\n                alert(\"The ID number of the person currently being reviewed has changed, please refresh the page and try again. Any changes to this observation will not be saved.\")\n            }\n        },\n    })\n}\n</code></pre>\n\n<p>Controller</p>\n\n<pre><code>public bool SaveComment(string[] comments, string[] commentCriterions, string observationId, string reviewingId)\n    {\n        int breakPoint = 0;\n        return true;\n    }\n</code></pre>\n\n<p>After messing with the function this is what the ajax call looks like, resulting in a 500 (Internal Server Error) after setting contentType in ajax.</p>\n\n<pre><code>    $.ajax({\n        type: \"POST\",\n        url: \"SaveComment\",\n        dataType: \"json\",\n        data: {\n            'comments': JSON.stringify(comments),\n            'commentCriterions': JSON.stringify(commentCriterions),\n            'observationId': JSON.stringify(observationId),\n            'reviewingId': JSON.stringify('986509040'),\n        },\n        contentType: 'application/json; charset=utf-8',\n        traditonal: true,\n        success: function (status) {\n            if (status == \"False\") {\n                alert(\"The ID number of the person currently being reviewed has changed, please refresh the page and try again. Any changes to this observation will not be saved.\")\n            }\n        },\n    })\n</code></pre>\n"}, {"tags": ["c#", "winapp"], "comments": [{"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 2, "creation_date": 1423689182, "post_id": 28464580, "comment_id": 45254846, "body": "Where is your timer?"}, {"owner": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 0, "creation_date": 1423689332, "post_id": 28464580, "comment_id": 45254935, "body": "Shouldn&#39;t you use a simple GIF instead of 80 different PNGs?"}, {"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1423689379, "post_id": 28464580, "comment_id": 45254960, "body": "Maybe he wants quality colors.."}, {"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1423689438, "post_id": 28464580, "comment_id": 45254991, "body": "You need a Timer and need to code its Tick event.. The button will do nothing but start the Timer (and maybe prepare an ImageList)"}, {"owner": {"reputation": 169, "user_id": 4425165, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29769d5d2f952524087bf2609b2f85dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jermain Defo", "link": "https://stackoverflow.com/users/4425165/jermain-defo"}, "reply_to_user": {"reputation": 8323, "user_id": 2316200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83dc15723047a4717a5c77b3c55bb112?s=128&d=identicon&r=PG", "display_name": "Pierre-Luc Pineault", "link": "https://stackoverflow.com/users/2316200/pierre-luc-pineault"}, "edited": false, "score": 0, "creation_date": 1423689869, "post_id": 28464580, "comment_id": 45255224, "body": "@Pierre-LucPineault PNG would be much preferred considering it&#39;s quality is brill"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 4425165, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29769d5d2f952524087bf2609b2f85dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jermain Defo", "link": "https://stackoverflow.com/users/4425165/jermain-defo"}, "edited": false, "score": 0, "creation_date": 1423689829, "post_id": 28464675, "comment_id": 45255199, "body": "Is there a way of setting a time span?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 169, "user_id": 4425165, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29769d5d2f952524087bf2609b2f85dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jermain Defo", "link": "https://stackoverflow.com/users/4425165/jermain-defo"}, "edited": false, "score": 0, "creation_date": 1423689887, "post_id": 28464675, "comment_id": 45255237, "body": "@JermainDefo Yes, of course there is.  <code>timeToWait</code> in this example is a variable specifying the amount of time to wait.  Set it to whatever you want."}, {"owner": {"reputation": 169, "user_id": 4425165, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29769d5d2f952524087bf2609b2f85dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jermain Defo", "link": "https://stackoverflow.com/users/4425165/jermain-defo"}, "edited": false, "score": 0, "creation_date": 1423690017, "post_id": 28464675, "comment_id": 45255299, "body": "Wow! I didn&#39;t think it would be that easy! So the await Task.Delay is the timer itself? In other words, this will be the solution?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 169, "user_id": 4425165, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29769d5d2f952524087bf2609b2f85dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jermain Defo", "link": "https://stackoverflow.com/users/4425165/jermain-defo"}, "edited": false, "score": 0, "creation_date": 1423690068, "post_id": 28464675, "comment_id": 45255328, "body": "@JermainDefo <code>Task.Delay</code> uses a timer internally to create a <code>Task</code> that  will be completed after the specified delay.  You don&#39;t need to interact with that timer directly."}, {"owner": {"reputation": 169, "user_id": 4425165, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29769d5d2f952524087bf2609b2f85dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jermain Defo", "link": "https://stackoverflow.com/users/4425165/jermain-defo"}, "edited": false, "score": 0, "creation_date": 1423690254, "post_id": 28464675, "comment_id": 45255426, "body": "The GetImages isn&#39;t recognised. I have an error stating &quot;The name GetImages does not exist in the current context&quot; do you have any idea why?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 169, "user_id": 4425165, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29769d5d2f952524087bf2609b2f85dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jermain Defo", "link": "https://stackoverflow.com/users/4425165/jermain-defo"}, "edited": false, "score": 0, "creation_date": 1423690310, "post_id": 28464675, "comment_id": 45255453, "body": "@JermainDefo Because you haven&#39;t written it yet.  You&#39;ll need to write the method to get all of the images in a given path."}, {"owner": {"reputation": 169, "user_id": 4425165, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29769d5d2f952524087bf2609b2f85dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jermain Defo", "link": "https://stackoverflow.com/users/4425165/jermain-defo"}, "edited": false, "score": 0, "creation_date": 1423690680, "post_id": 28464675, "comment_id": 45255643, "body": "Since the images are named like Image1, Image2, Image3 etc.. Would it not be possible to declare the file path with the image such as &quot;Assets/Images/Image&quot; &amp;&amp; number (where the number variable is added by a 1 everytime it comes across a photo) so if 3 was stored in number it would come out as &quot;Assets/Images/Image3&quot;, if this is possible to do wouldnt it be better so its in a chronological order?"}], "tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": false, "score": 2, "last_activity_date": 1423689457, "creation_date": 1423689457, "answer_id": 28464675, "question_id": 28464580, "link": "https://stackoverflow.com/questions/28464580/foreach-loop-with-images/28464675#28464675", "title": "Foreach loop with images", "body": "<p>Just <code>await Task.Delay</code> to asynchronously wait for a set span of time:</p>\n\n<pre><code>private async void SubmitButton_Click(object sender, RoutedEventArgs e)\n{\n    if (LevelUp)\n    {\n        string imagePath = \"Assets/Star/\";\n        foreach (Image image in GetImages(imagePath))\n        {\n            ShowImage(image);\n            await Task.Delay(timeToWait);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 4425165, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/29769d5d2f952524087bf2609b2f85dd?s=128&d=identicon&r=PG&f=1", "display_name": "Jermain Defo", "link": "https://stackoverflow.com/users/4425165/jermain-defo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423689777, "creation_date": 1423689130, "last_edit_date": 1423689777, "question_id": 28464580, "link": "https://stackoverflow.com/questions/28464580/foreach-loop-with-images", "title": "Foreach loop with images", "body": "<p>I have an 80 PNG image sequence in which I am trying to create an animation for my windows app. The file path is Assets/Star/ and I am trying to figure out how I would make a foreach loop for each image in the folder, so it would set the image object as Image1 then after a certain amount of ticks with the timer it would change it to Image2 and so on, here is what I have so far: </p>\n\n<pre><code>private void SubmitButton_Click(object sender, RoutedEventArgs e)\n   {\n      if(LevelUp == true)\n        {\n            string ImagePath = \"Assets/Star/\";\n            foreach (Image item in ImagePath)\n            {\n\n            }\n        }\n   }\n</code></pre>\n\n<p>However I dont think im approaching it correctly, does anyone know how i should approach this?</p>\n"}, {"tags": ["c#", "live-tile", "win-phone-silverlight-8.1"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4556636, "user_type": "registered", "profile_image": "https://graph.facebook.com/1390810241229824/picture?type=large", "display_name": "Oki Wan BenObi", "link": "https://stackoverflow.com/users/4556636/oki-wan-benobi"}, "is_accepted": false, "score": 1, "last_activity_date": 1423693133, "creation_date": 1423693133, "answer_id": 28465645, "question_id": 28464571, "link": "https://stackoverflow.com/questions/28464571/wp-8-1-update-square-and-wide-tile-how/28465645#28465645", "title": "WP 8.1 Update Square AND Wide Tile - How?", "body": "<p>Solved it. According to MSDN, we have to merge the two xml, so that they appear under the same \"visual\" tag.</p>\n\n<p>I did it like this:</p>\n\n<pre><code>        string xml=\"&lt;tile&gt;\\n\";\n        xml += \"&lt;visual version=\\\"2\\\"&gt;\\n\";\n        xml += \"  &lt;binding template=\\\"TileSquare150x150Text01\\\" fallback=\\\"TileSquareText01\\\"&gt;\\n\";\n        xml += \"      &lt;text id=\\\"1\\\"&gt;Row 0&lt;/text&gt;\\n\";\n        xml += \"      &lt;text id=\\\"2\\\"&gt;Row 1&lt;/text&gt;\\n\";\n        xml += \"      &lt;text id=\\\"3\\\"&gt;Row 2&lt;/text&gt;\\n\";\n        xml += \"      &lt;text id=\\\"4\\\"&gt;Row 3&lt;/text&gt;\\n\";\n        xml += \"  &lt;/binding&gt;\\n\";\n        xml += \"  &lt;binding template=\\\"TileWide310x150Text01\\\" fallback=\\\"TileWideText01\\\"&gt;\\n\";\n        xml += \"      &lt;text id=\\\"1\\\"&gt;Wide Row 0&lt;/text&gt;\\n\";\n        xml += \"      &lt;text id=\\\"2\\\"&gt;Wide Row 1&lt;/text&gt;\\n\";\n        xml += \"      &lt;text id=\\\"3\\\"&gt;Wide Row 2&lt;/text&gt;\\n\";\n        xml += \"      &lt;text id=\\\"4\\\"&gt;Wide Row 3&lt;/text&gt;\\n\";\n        xml += \"  &lt;/binding&gt;\\n\";\n        xml+=\"&lt;/visual&gt;\\n\";\n        xml +=\"&lt;/tile&gt;\";\n        XmlDocument txml = new XmlDocument();\n        txml.LoadXml(xml);\n        TileNotification tNotification = new TileNotification(txml);\n\n        TileUpdateManager.CreateTileUpdaterForApplication().Clear();\n        TileUpdateManager.CreateTileUpdaterForApplication().Update(tNotification);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4556636, "user_type": "registered", "profile_image": "https://graph.facebook.com/1390810241229824/picture?type=large", "display_name": "Oki Wan BenObi", "link": "https://stackoverflow.com/users/4556636/oki-wan-benobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423693133, "creation_date": 1423689098, "question_id": 28464571, "link": "https://stackoverflow.com/questions/28464571/wp-8-1-update-square-and-wide-tile-how", "title": "WP 8.1 Update Square AND Wide Tile - How?", "body": "<p>How do I update both, the square and the wide tile per code at once?\nOr how can I determine, wich tile type is \"loaded\" on the start screen?</p>\n\n<p>I have this code:</p>\n\n<pre><code>private void JamesBond()\n{\n        var tileXML = TileUpdateManager.GetTemplateContent(TileTemplateType.TileSquare150x150Text01);\n        var tileText = tileXML.GetElementsByTagName(\"text\");\n        (tileText[0] as XmlElement).InnerText = \"First text\";\n        (tileText[1] as XmlElement).InnerText = \"Second text\";\n        (tileText[2] as XmlElement).InnerText = \"Third text\";\n        (tileText[3] as XmlElement).InnerText = \"Last text\";\n        var tileNotification = new TileNotification(tileXML);\n\n        var tileXMLw = TileUpdateManager.GetTemplateContent(TileTemplateType.TileWide310x150Text01);\n        var tileTextw = tileXMLw.GetElementsByTagName(\"text\");\n        (tileTextw[0] as XmlElement).InnerText = \"Wide First text\";\n        (tileTextw[1] as XmlElement).InnerText = \"Wide Second text\";\n        (tileTextw[2] as XmlElement).InnerText = \"Wide Third text\";\n        (tileTextw[3] as XmlElement).InnerText = \"Wide Last text\";\n        var tileNotificationW = new TileNotification(tileXMLw);\n\n        TileUpdateManager.CreateTileUpdaterForApplication().Clear();\n        TileUpdateManager.CreateTileUpdaterForApplication().Update(tileNotification);\n        TileUpdateManager.CreateTileUpdaterForApplication().Update(tileNotificationW);\n    }\n}\n</code></pre>\n\n<p>...and what it does is, it updates the wide tile. But if it is the square tile, then it updates it.....sometimes. And most of the time, it's empty. So, somehow it works. But not right....</p>\n\n<p>Can anyone help me here?</p>\n\n<p>PS: I also tried to get the TileUpdater instance and do that all in the same instance..that's even worse, it only shows the wide tile...</p>\n\n<p>Thanks in advance.</p>\n\n<p>Regards,\nben0bi</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-identity"], "comments": [{"owner": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423689126, "post_id": 28464514, "comment_id": 45254817, "body": "Are you using Forms Authentication or Windows Authentication?"}, {"owner": {"reputation": 2832, "user_id": 1506065, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kPcUB.jpg?s=128&g=1", "display_name": "prospector", "link": "https://stackoverflow.com/users/1506065/prospector"}, "reply_to_user": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423689569, "post_id": 28464514, "comment_id": 45255058, "body": "@Claies I&#39;m not sure, because neither is in my web.config."}, {"owner": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423689894, "post_id": 28464514, "comment_id": 45255243, "body": "then you are probably using forms authentication.  the <code>HttpContext.CurrentUser.Identity</code> is derived from a cookie which is set in the client after successful login, containing the authentication ticket.  If the cookie isn&#39;t available or has expired, then <code>Identity</code> will be null.  Therefore, I would check to see if the users have cookies disabled."}, {"owner": {"reputation": 2832, "user_id": 1506065, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kPcUB.jpg?s=128&g=1", "display_name": "prospector", "link": "https://stackoverflow.com/users/1506065/prospector"}, "reply_to_user": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423689942, "post_id": 28464514, "comment_id": 45255268, "body": "@Claies they don&#39;t have cookies disabled, because it happens from my computer when I try to sign in their account."}, {"owner": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423690099, "post_id": 28464514, "comment_id": 45255349, "body": "hmm, well then I would start off with trying to log what you have in the <code>HttpContext.Current.User.Identity.GetUserId()</code> call, what user that value gets from the <code>FindById()</code> method, and compare it to what is in your database."}, {"owner": {"reputation": 2832, "user_id": 1506065, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kPcUB.jpg?s=128&g=1", "display_name": "prospector", "link": "https://stackoverflow.com/users/1506065/prospector"}, "reply_to_user": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423690110, "post_id": 28464514, "comment_id": 45255357, "body": "I&#39;m on a cloud based web host, do you think <code>&lt;sessionState mode=&quot;InProc&quot; customProvider=&quot;DefaultSessionProvider&quot;&gt;</code> could be the cause?"}, {"owner": {"reputation": 2832, "user_id": 1506065, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kPcUB.jpg?s=128&g=1", "display_name": "prospector", "link": "https://stackoverflow.com/users/1506065/prospector"}, "reply_to_user": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423690144, "post_id": 28464514, "comment_id": 45255374, "body": "because I want to add that this only happens on the live server and never in the development environment, which is why this is so weird and unexpected."}, {"owner": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423690358, "post_id": 28464514, "comment_id": 45255480, "body": "if your application is distributed across multiple servers (web garden) then InProc sessionState could certainly cause this kind of behavior."}, {"owner": {"reputation": 2832, "user_id": 1506065, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kPcUB.jpg?s=128&g=1", "display_name": "prospector", "link": "https://stackoverflow.com/users/1506065/prospector"}, "reply_to_user": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423690489, "post_id": 28464514, "comment_id": 45255544, "body": "1 server in the cloud hosting two websites, only 1 site is using any authentication."}, {"owner": {"reputation": 21426, "user_id": 2495283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ef72b32709062aa479476844515073?s=128&d=identicon&r=PG", "display_name": "Claies", "link": "https://stackoverflow.com/users/2495283/claies"}, "edited": false, "score": 0, "creation_date": 1423690589, "post_id": 28464514, "comment_id": 45255590, "body": "I still think you should log those variables and do some manual comparisons, especially if it only happens to certain users and is not specific to the machine they are using."}, {"owner": {"reputation": 1012, "user_id": 3155085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a309c64617b83ad73550334969cda0ed?s=128&d=identicon&r=PG&f=1", "display_name": "Suhas Joshi", "link": "https://stackoverflow.com/users/3155085/suhas-joshi"}, "edited": false, "score": 0, "creation_date": 1423778348, "post_id": 28464514, "comment_id": 45298838, "body": "Is the IdentityHelper.SignIn method calling Signin as expected. The only reason I see here is that the auth cookie is not set in the response and in that case the redirect to &#39;Profile&#39; page is not authenticated."}], "answers": [{"tags": [], "owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "is_accepted": false, "score": 1, "last_activity_date": 1423694863, "creation_date": 1423694863, "answer_id": 28466049, "question_id": 28464514, "link": "https://stackoverflow.com/questions/28464514/identity-2-0-users-are-getting-redirected-back-to-login/28466049#28466049", "title": "Identity 2.0 Users are getting redirected back to Login", "body": "<p>Try using <code>User.Identity</code> rather than <code>HttpContext.Current.User.Identity</code>. I've seen some cases where the context (which is based on ASP.NET's session) gets out of sync with Identity's tokens. </p>\n"}, {"tags": [], "owner": {"reputation": 2832, "user_id": 1506065, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kPcUB.jpg?s=128&g=1", "display_name": "prospector", "link": "https://stackoverflow.com/users/1506065/prospector"}, "is_accepted": true, "score": 1, "last_activity_date": 1423789775, "creation_date": 1423789775, "answer_id": 28490926, "question_id": 28464514, "link": "https://stackoverflow.com/questions/28464514/identity-2-0-users-are-getting-redirected-back-to-login/28490926#28490926", "title": "Identity 2.0 Users are getting redirected back to Login", "body": "<p>OK guys, here is the answer.</p>\n\n<p>Change the session state from InProc, in my case to SQLServer, it's been 22 hours since a login redirect, which hasn't happened before, so I think it's safe to say the problem is solved and that was the answer.</p>\n"}], "owner": {"reputation": 2832, "user_id": 1506065, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/kPcUB.jpg?s=128&g=1", "display_name": "prospector", "link": "https://stackoverflow.com/users/1506065/prospector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 28490926, "answer_count": 2, "score": 0, "last_activity_date": 1423789775, "creation_date": 1423688898, "last_edit_date": 1423704180, "question_id": 28464514, "link": "https://stackoverflow.com/questions/28464514/identity-2-0-users-are-getting-redirected-back-to-login", "title": "Identity 2.0 Users are getting redirected back to Login", "body": "<p>Here is my login code, the problem happens to users redirected to \"Profile\" after logging in.</p>\n\n<pre><code> protected void UserLogin_Click(object sender, EventArgs e)\n        {\n            if (IsValid)\n            {\n\n                var manager = new IdentityModels.UserManager();\n\n                IdentityModels.User user = manager.Find(Username.Text, Password.Text);\n\n                if (user != null)\n                {\n                    if (isUserActive(user.PatientId)==\"isNotActive\")\n                    {\n                        lblError.Text =\n                            \"you are no longer active. Please contact your local clinic to find out why.\";\n                        return;\n\n                    }\n                    if (isUserActive(user.PatientId) == \"clinicNotActive\")\n                    {\n                        lblError.Text =\n                            \"Your clinic is no longer active. Please contact your local clinic to find out why.\";\n                        return;\n\n                    }\n                    IdentityModels.IdentityHelper.SignIn(manager, user, RememberMe.Checked);\n\n                    if (manager.IsInRole(user.Id,\"Administrator\") || manager.IsInRole(user.Id,\"Staff\") || manager.IsInRole(user.Id,\"Physician\"))\n                    {\n                        Response.Redirect(\"Dashboard\");\n                    }\n\n\n                    if (Request.QueryString[\"Profile\"] != null)\n                    {\n                        IdentityModels.IdentityHelper.RedirectToReturnUrl(Request.QueryString[\"Profile\"], Response);\n                    }\n                    else\n                    {\n                        Response.Redirect(\"Profile\");\n                    }\n\n\n                }\n                else\n                {\n                    ModelState.AddModelError(\"\", \"Invalid username or password\");\n                    lblError.Text = \"Invalid username or password\";\n                }\n            }\n        }\n</code></pre>\n\n<p>here is my page load code on the Profile page:</p>\n\n<pre><code> var manager = new IdentityModels.UserManager();\n            IdentityModels.User user = manager.FindById(HttpContext.Current.User.Identity.GetUserId());\n\n        if (user == null)\n        {\n\n             var ex = new Exception(\"patient was null, BUT TRIED SIGNING IN NOW\" + UserAccess.GetUserId().ToString());\n                Elmah.ErrorSignal.FromCurrentContext().Raise(ex);\n\n            Response.Redirect(\"Login\");\n        }\n</code></pre>\n\n<p>Elmah logs show the exception \"patient was null, BUT TRIED SIGNING IN NOW 0\".</p>\n\n<p>So if my users are signing in successfully, which they must be because they are hitting the profile page, then why do some of them hit this error. Why is the user null?</p>\n\n<p>I just can't figure it out, why it effects some but not all. When I republish the website all users can then login for a few minutes, sometimes a few hours, then it starts again.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "twitter-bootstrap", "bootstrap-file-upload"], "comments": [{"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1423691430, "post_id": 28464507, "comment_id": 45256056, "body": "You don&#39;t want to return the actual file, you want to return a path to the image file."}, {"owner": {"reputation": 10525, "user_id": 1186050, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1aeaf46e73772e9f9c7784bf0ee0705c?s=128&d=identicon&r=PG", "display_name": "user1186050", "link": "https://stackoverflow.com/users/1186050/user1186050"}, "reply_to_user": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1423691702, "post_id": 28464507, "comment_id": 45256190, "body": "I&#39;m not storing the image on local storage, I&#39;m storing it in my db in a varbinary(max) datatype that gets returned as a byte[]"}, {"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1423691751, "post_id": 28464507, "comment_id": 45256218, "body": "<a href=\"http://stackoverflow.com/questions/880515/display-image-from-database-in-asp-mvc\" title=\"display image from database in asp mvc\">stackoverflow.com/questions/880515/&hellip;</a>"}, {"owner": {"reputation": 10525, "user_id": 1186050, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1aeaf46e73772e9f9c7784bf0ee0705c?s=128&d=identicon&r=PG", "display_name": "user1186050", "link": "https://stackoverflow.com/users/1186050/user1186050"}, "reply_to_user": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1423694460, "post_id": 28464507, "comment_id": 45257562, "body": "Hi Dleh, I looked at your link but most of the responses show a img tag being used to display the data. My tag isn&#39;t a img tag, it is a bootstrap plug in that is attached to a textbox"}, {"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1423694500, "post_id": 28464507, "comment_id": 45257578, "body": "If you want to show an image on a web page, you need an image tag."}, {"owner": {"reputation": 10525, "user_id": 1186050, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1aeaf46e73772e9f9c7784bf0ee0705c?s=128&d=identicon&r=PG", "display_name": "user1186050", "link": "https://stackoverflow.com/users/1186050/user1186050"}, "reply_to_user": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1423695374, "post_id": 28464507, "comment_id": 45257974, "body": "ok, so my question if you look at it again is how to make that happen with the bootstrap plugin I&#39;m using. It creates an image tag using javascript, you don&#39;t manually add it"}, {"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1423695467, "post_id": 28464507, "comment_id": 45258025, "body": "Then you need to provide the URL of the image to that text box in some way, you can&#39;t send the bytes."}, {"owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "edited": false, "score": 0, "creation_date": 1423695490, "post_id": 28464507, "comment_id": 45258033, "body": "You&#39;ll need to post info about how this text box works if you need help doing that"}], "answers": [{"tags": [], "owner": {"reputation": 21874, "user_id": 526704, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/UJEcq.jpg?s=128&g=1", "display_name": "DLeh", "link": "https://stackoverflow.com/users/526704/dleh"}, "is_accepted": false, "score": 0, "last_activity_date": 1423701758, "last_edit_date": 1423701758, "creation_date": 1423701442, "answer_id": 28467292, "question_id": 28464507, "link": "https://stackoverflow.com/questions/28464507/httppostedfilebase-not-showing-image-with-bootstrap-file-upload-plugin/28467292#28467292", "title": "HttpPostedFileBase not showing image with bootstrap file upload plugin", "body": "<p>You cannot show an image in an <code>&lt;input type=\"file\" /&gt;</code>, you must use a <code>&lt;img&gt;</code> tag. When you do <code>@Html.TextBoxFor(x =&gt; x, new { type=\"file\" })</code>, the rendered output will be an <code>&lt;input type=\"file\" /&gt;</code>, nothing special.</p>\n\n<p>If you need to show the existing image, you should do it something like this:</p>\n\n<pre><code>&lt;div class=\"panel-body\"&gt;\n    &lt;!-- show the current StudentImage in the database --&gt;\n    &lt;img src=\"@Url.Action(\"GetStudentImage\", new { studentID= Model.StudentImageID })\" /&gt;\n\n    &lt;!-- for adding a new StudentImage --&gt;\n    @Html.TextBoxFor(model =&gt; model.StudentImage, new { @type = \"file\", @id = \"input-20\" })\n&lt;/div&gt;\n</code></pre>\n\n<p>Your action in the controller would look like this, based on the links I posted in the comments:</p>\n\n<pre><code>public ActionResult GetStudentImage(int studentImageID)\n{\n    Student student = studentRepository.Find(studentID);\n    return File(student.StudentImage.Image, \"image/jpg\");\n}\n</code></pre>\n"}], "owner": {"reputation": 10525, "user_id": 1186050, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/1aeaf46e73772e9f9c7784bf0ee0705c?s=128&d=identicon&r=PG", "display_name": "user1186050", "link": "https://stackoverflow.com/users/1186050/user1186050"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1423701758, "creation_date": 1423688872, "last_edit_date": 1423691620, "question_id": 28464507, "link": "https://stackoverflow.com/questions/28464507/httppostedfilebase-not-showing-image-with-bootstrap-file-upload-plugin", "title": "HttpPostedFileBase not showing image with bootstrap file upload plugin", "body": "<p>I have a view model that has a HttpPostedFileBase property called 'StudentImage'. When the user logs in I want to fetch a byte array (my image from DB) and display it? I can fetch the byte[] from the database, and I can set the byte[] back to my HttpPostedFileBase Image by setting a memory stream that inherits from httppostedfilebase. But no image shows up on my form</p>\n\n<p>Here is my view model</p>\n\n<pre><code>public class EditStudentViewModel\n{\n    ...other code here\n\n    public HttpPostedFileBase StudentImage { get; set; }\n}\n</code></pre>\n\n<p>Here is my controller where I fetch the byte array and I want to set the byte[] to 'StudentImage', which is a HttpPostedFileBase</p>\n\n<pre><code>public ActionResult Edit()\n    {\n        var years = Enumerable.Range(DateTime.Now.Year - 100, 100).Reverse();\n        string userId = User.Identity.GetUserId();\n\n        Student student = studentRepository.Find(userId);\n        // student.StudentImage =&gt; this is a byte array that I need to get\n        // into the HttpPostedFileBase named StudentImage into \n        // 'EditStudentViewModel'\n\n        var studentViewModel = new EditStudentViewModel\n        {\n            ...other properties set here\n            StudentImage = new MemoryFile(new MemoryStream(student.StudentImage.Image));\n        };\n</code></pre>\n\n<p>I created a new class called MemoryFile and inherited HttpPostedBaseFIle like so</p>\n\n<pre><code>class MemoryFile : HttpPostedFileBase\n    {\n        Stream stream;\n\n        public MemoryFile(Stream stream)\n        {\n            this.stream = stream;\n        }\n\n        public override Stream InputStream\n        {\n            get { return stream; }\n        }\n    }\n</code></pre>\n\n<p>it seems to set the values correctly, but when I view the form on the screen I don't see the image! It doesn't set it with the Bootstrap File Plugin I'm using that can be found here <a href=\"http://plugins.krajee.com/file-input\" rel=\"nofollow\">BootStrap File Upload Plugin</a></p>\n\n<p>Here is my javascript for the file uplaod plugin</p>\n\n<pre><code>$(\"#input-20\").fileinput({\n'type': 'POST',\n'cache': false,\n'browseClass': 'btn btn-primary btn-block',\n'showCaption': false,\n'showRemove': false,\n'showUpload': false,\n'uploadAsync': false,\n'maxFileCount': 1,\n'allowedFileExtensions': ['jpg', 'png', 'gif'],\n'allowedFileTypes': ['image'],\n\n//'uploadUrl': '@Url.Action(\"Edit\", \"Student\")'\n</code></pre>\n\n<p>});</p>\n\n<p>Here is my HTML tag</p>\n\n<pre><code>&lt;div class=\"panel-body\"&gt;\n                @Html.TextBoxFor(model =&gt; model.StudentImage, new { @type = \"file\", @id = \"input-20\" })\n            &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "web-services", "wcf", "iis"], "comments": [{"owner": {"reputation": 2873, "user_id": 2789978, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b5ec692bf03786cc14d3f242dfa1bd17?s=128&d=identicon&r=PG&f=1", "display_name": "TejSoft", "link": "https://stackoverflow.com/users/2789978/tejsoft"}, "edited": false, "score": 0, "creation_date": 1423695874, "post_id": 28464422, "comment_id": 45258192, "body": "Have you checked the event logs in the win server? Can you find any errors logged? Also first check the service locally within the server before trying to access remotely."}], "owner": {"reputation": 229, "user_id": 1748374, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e62ac732168c982ae41981c33164114?s=128&d=identicon&r=PG", "display_name": "MVC_Future_Guru", "link": "https://stackoverflow.com/users/1748374/mvc-future-guru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1423688557, "creation_date": 1423688557, "question_id": 28464422, "link": "https://stackoverflow.com/questions/28464422/how-to-resolve-webservice-issue-in-iis-8-5", "title": "How to resolve webservice issue in iis 8.5", "body": "<p>I have a website set up in iis 7.0 on my local win 7 machine.  Within this are several webservices - they all can be accessed fine, and I can test this access by going to a browser and checking at <a href=\"http://localhost/test/service.svc\" rel=\"nofollow\">http://localhost/test/service.svc</a>.  This works fine.  I'm not trying to recreate this environment on VM with win server 2012 R2, and iis 8.5.  I've set up everything identically, except then navigating to the url above returns on the 1k tb inside the actual service.src as if I opened it in notepad.  If I try to add a reference to this service in VS, I get a better error and one that is related to the mime type for svc.  Here's an example.</p>\n\n<p>Cannot add duplicate collection entry of type 'mimeMap' with unique key attribute 'file Extension' set to '.svc'.</p>\n\n<p>Based on this issue, I then found a reference to needing to add something along the lines of  to my config file which I do.  </p>\n\n<p>Now here's the interesting part.  If I remove any references to the svc mime type in iis in both the server and the site, I receive a 404 not found error when trying to run a service.  If I use the example above to add this with the config file, I receive a duplicate.  If I take out the above example, and enter the mime type in either the server or the site, I then get a duplicate as well.  I also found mention to this, and it seems there is some work around involving             before the config inclusion as referenced above.  </p>\n\n<p>What's driving me the most crazy is that non of this is an issue on my local iis 7 machine.  Does anyone have any suggestions, I'm floundering.</p>\n"}, {"tags": ["c#", "windows-runtime", "windows-store-apps", "windows-phone-8.1", "pinvoke"], "answers": [{"comments": [{"owner": {"reputation": 5895, "user_id": 397368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MmrBt.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/397368/ben"}, "edited": false, "score": 0, "creation_date": 1423719434, "post_id": 28465357, "comment_id": 45264865, "body": "Thank you!  I would never have tried this on my own.  I&#39;ve seen this page before, but disregarded it as it explicitly states it only applies to Phone 8 and Phone 8.1 Silverlight.  Someone ought to update that!"}], "tags": [], "owner": {"reputation": 21144, "user_id": 4068779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0Hsj.png?s=128&g=1", "display_name": "Rob Caplan - MSFT", "link": "https://stackoverflow.com/users/4068779/rob-caplan-msft"}, "is_accepted": true, "score": 11, "last_activity_date": 1423691955, "creation_date": 1423691955, "answer_id": 28465357, "question_id": 28464217, "link": "https://stackoverflow.com/questions/28464217/how-to-p-invoke-into-kernel32-dll-on-winrt-8-1/28465357#28465357", "title": "How to P/Invoke into kernel32.dll on WinRT 8.1", "body": "<p>You'll need different pinvoke signatures for the Windows Phone and the Windows Store versions. For the phone reference GetNativeSystemInfo from api-ms-win-core-sysinfo-l1-2-0.dll </p>\n\n<pre><code>#if WINDOWS_PHONE_APP\n     [DllImport(\"api-ms-win-core-sysinfo-l1-2-0.dll\", CharSet = CharSet.Unicode, ExactSpelling = false, PreserveSig = true)]\n     private static extern void GetNativeSystemInfo(ref SYSTEM_INFO lpSysInfo);\n#else\n     [DllImport(\"kernel32.dll\", CharSet = CharSet.Unicode, ExactSpelling = false, PreserveSig = true)]\n     private static extern void GetNativeSystemInfo(ref SYSTEM_INFO lpSysInfo);\n#endif\n</code></pre>\n\n<p>See <a href=\"https://msdn.microsoft.com/library/windows/apps/jj662956(v=vs.105).aspx#BKMK_ListofsupportedWin32APIs\">Supported Win32 APIs for Windows Phone 8</a> for a list (targetted for SL, but also valid for your Runtime app). The right reference will be automatically referenced if you call the function natively, but the tooling isn't there to do so for pinvoke. In general wrapping the function in a native Windows Runtime Component is easier than p-invoke, unless you only have a few, simple p-invokes.</p>\n"}], "owner": {"reputation": 5895, "user_id": 397368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MmrBt.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/397368/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1830, "favorite_count": 2, "accepted_answer_id": 28465357, "answer_count": 1, "score": 5, "last_activity_date": 1423691955, "creation_date": 1423687757, "question_id": 28464217, "link": "https://stackoverflow.com/questions/28464217/how-to-p-invoke-into-kernel32-dll-on-winrt-8-1", "title": "How to P/Invoke into kernel32.dll on WinRT 8.1", "body": "<p>I'm trying to use a native API method (<code>GetNativeSystemInfo</code>) that is marked as supported for both phone and desktop Store apps on Windows 8.1.  In the documentation, it is listed as living in kernel32.dll.  Great!  So my first attempt at P/Invoke looked like this:</p>\n\n<pre><code>[DllImport(\"kernel32.dll\", CharSet = CharSet.Unicode, ExactSpelling = false, PreserveSig = true)]\nprivate static extern void GetNativeSystemInfo(ref SYSTEM_INFO lpSysInfo);\n</code></pre>\n\n<p>Unfortunately this fails to run on actual devices - kernel32 is not found!  As it happens, there <em>is</em> <code>kernelBase.dll</code>, and thus my second attempt:</p>\n\n<pre><code>[DllImport(\"kernelBase.dll\", CharSet = CharSet.Unicode, ExactSpelling = false, PreserveSig = true)]\nprivate static extern void GetNativeSystemInfo(ref SYSTEM_INFO lpSysInfo);\n</code></pre>\n\n<p>While this runs fine on my phone, it causes the app to fail certification; the method name and \"kernelBase.dll\" don't seem to be whitelisted.</p>\n\n<p>Is this an oversight of WACK, or a bug that renders this API unusable in Store apps?  My goal is to get information about the running processor (architecture, type, etc), and I'd prefer not to drop in to C++ for something this simple.  If this API is not usable in practice, is there another way to get this info?</p>\n"}, {"tags": ["javascript", "c#", "jquery", "ajax", "http"], "comments": [{"owner": {"reputation": 10655, "user_id": 1415038, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8304345aa24122753794500b0e3920fb?s=128&d=identicon&r=PG&f=1", "display_name": "woz", "link": "https://stackoverflow.com/users/1415038/woz"}, "edited": false, "score": 0, "creation_date": 1423687954, "post_id": 28464207, "comment_id": 45254246, "body": "Maybe I&#39;m missing something, but why not use forms authentication?"}, {"owner": {"reputation": 231, "user_id": 1519322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd02d278f0ee403f45b1ae16c19eaf71?s=128&d=identicon&r=PG", "display_name": "Elie Zeitouni", "link": "https://stackoverflow.com/users/1519322/elie-zeitouni"}, "reply_to_user": {"reputation": 10655, "user_id": 1415038, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8304345aa24122753794500b0e3920fb?s=128&d=identicon&r=PG&f=1", "display_name": "woz", "link": "https://stackoverflow.com/users/1415038/woz"}, "edited": false, "score": 0, "creation_date": 1423688386, "post_id": 28464207, "comment_id": 45254460, "body": "This is going to be a Phonegap Mobile app, so we need to use Token Authentication"}, {"owner": {"reputation": 376, "user_id": 3301676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PMoiq.jpg?s=128&g=1", "display_name": "MagyaDEV", "link": "https://stackoverflow.com/users/3301676/magyadev"}, "edited": false, "score": 0, "creation_date": 1423689253, "post_id": 28464207, "comment_id": 45254881, "body": "Maybe try to uppercase first letter in &quot;bearer&quot; (RFC6750: credentials = &quot;Bearer&quot; 1*SP b64token)"}, {"owner": {"reputation": 231, "user_id": 1519322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd02d278f0ee403f45b1ae16c19eaf71?s=128&d=identicon&r=PG", "display_name": "Elie Zeitouni", "link": "https://stackoverflow.com/users/1519322/elie-zeitouni"}, "edited": false, "score": 0, "creation_date": 1423690104, "post_id": 28464207, "comment_id": 45255353, "body": "Just tried uppercase and lowercase. Also just realized I had a typo with &#39;Basic&#39; instead of &#39;Bearer&#39; but it didn&#39;t change anything"}, {"owner": {"reputation": 376, "user_id": 3301676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PMoiq.jpg?s=128&g=1", "display_name": "MagyaDEV", "link": "https://stackoverflow.com/users/3301676/magyadev"}, "edited": false, "score": 0, "creation_date": 1423690119, "post_id": 28464207, "comment_id": 45255362, "body": "On second screen shot I see you use Bearer authentication, but in the code here is Basic Auth. Make sure you use proper syntax for bearer auth,  not &quot;Basic Bearer b64Token&quot;.  instead of request.setRequestHeader() u can always use header property to send:   headers: {         &quot;Authorization&quot;: &quot;Bearer &quot; + bearerToken     }"}, {"owner": {"reputation": 231, "user_id": 1519322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd02d278f0ee403f45b1ae16c19eaf71?s=128&d=identicon&r=PG", "display_name": "Elie Zeitouni", "link": "https://stackoverflow.com/users/1519322/elie-zeitouni"}, "reply_to_user": {"reputation": 376, "user_id": 3301676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PMoiq.jpg?s=128&g=1", "display_name": "MagyaDEV", "link": "https://stackoverflow.com/users/3301676/magyadev"}, "edited": false, "score": 0, "creation_date": 1423690848, "post_id": 28464207, "comment_id": 45255736, "body": "@MagyaDEV , just fixed the basic and changed it to &#39;bearer&#39; but it isn&#39;t changing the problem. What seems to be happening is jQuery won&#39;t add the authorization header, and I&#39;ve tried both ways - the way you mentioned and the way above. Oddly enough, when I try to specify content-type, the header also adds that to the list of Access-Control-Request-Headers"}], "owner": {"reputation": 231, "user_id": 1519322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cd02d278f0ee403f45b1ae16c19eaf71?s=128&d=identicon&r=PG", "display_name": "Elie Zeitouni", "link": "https://stackoverflow.com/users/1519322/elie-zeitouni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1150, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1423693625, "creation_date": 1423687726, "last_edit_date": 1423693625, "question_id": 28464207, "link": "https://stackoverflow.com/questions/28464207/jquery-ajax-call-sending-as-options-and-missing-authorization-header", "title": "jQuery AJAX call sending as OPTIONS and missing Authorization header", "body": "<p>I'm starting to get stumped on this. I'm developing a C#.NET Web API service and frontend application to use it. I've been having a lot of difficulty using a token to authenticate my requests and jQuery seems to be having trouble. I can get a token just fine, but jQuery won't add it to an Authorization header in further requests.</p>\n\n<p>My setup is an index.html page with several jQuery Mobile pages inside it. It starts on a '#login' page, which sends a request to my /Token URI with a username, password, and grant type. This is successful and the return is the token. The page changes to '#home' and a test ajax call is sent to /api/values to grab value. The problem is that instead of adding a header called 'Authorization', jQuery adds an 'Access-Control-Request-Headers' with the value 'accept, authorization' instead. At first I thought it was a CORS issue, but the request works fine when I use Advanced Rest Client in Chrome to send the request.</p>\n\n<p>AJAX Call from '#Home'</p>\n\n<pre><code>$.ajax({\n        url: 'http://slalomtest2.azurewebsites.net/api/values/',\n        type: 'GET',\n        async: true,\n        dataType:\"json\",\n        beforeSend: function(request){\n            request.withCredentials = true;\n            request.setRequestHeader(\"Authorization\", \"Basic \" + Token);\n        },\n        success: function(result){\n            console.log(result);\n        },\n        error: function(request, error){\n            $.mobile.changePage(\"#login\");\n        }\n    });\n</code></pre>\n\n<p><a href=\"http://i103.photobucket.com/albums/m145/Mandalore65/Capture.png\" rel=\"nofollow\">The bad request the AJAX sends</a></p>\n\n<p><a href=\"http://i103.photobucket.com/albums/m145/Mandalore65/Capture2.png\" rel=\"nofollow\">This is what it looks like from Advanced Rest Client in the same browser</a></p>\n\n<p>Thanks in advance for the help, I've been banging my head against the wall all day.</p>\n"}, {"tags": ["c#", "linq", "nhibernate", "linq-to-sql", "expression-trees"], "answers": [{"comments": [{"owner": {"reputation": 201, "user_id": 1756892, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/deaa6201d7a3d37172cb2fe6121385e7?s=128&d=identicon&r=PG", "display_name": "Marc Chu", "link": "https://stackoverflow.com/users/1756892/marc-chu"}, "edited": false, "score": 0, "creation_date": 1423758505, "post_id": 28464324, "comment_id": 45287370, "body": "Works like a charm!  Thanks so much.  As an aside: for one of the expressions, the property for the MasterDocument is nested several properties down (e.g. doc.PropA..PropB.MasterDocument), and in that case, the possibility exists that PropA is null.  Normally, we return true if PropA is null, and I thought I would have to work that into the expression somehow.  But actually, it turns out not to be necessary.  It works without the check, even though I might expect a NullReferenceException.  Any explanation for that?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 201, "user_id": 1756892, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/deaa6201d7a3d37172cb2fe6121385e7?s=128&d=identicon&r=PG", "display_name": "Marc Chu", "link": "https://stackoverflow.com/users/1756892/marc-chu"}, "edited": false, "score": 0, "creation_date": 1423761773, "post_id": 28464324, "comment_id": 45289610, "body": "@MarcChu SQL handles null values differently.  It simply propogates null when you try to perform an operation on a null value instead of crashing.  When you try to get the <code>PropB</code> value of a <code>null</code> value it just returns <code>null</code>, instead of throwing.  Had the code been executed as C# code, and not translated into SQL, you&#39;d have had to deal with <code>null</code> explicitly."}], "tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": true, "score": 1, "last_activity_date": 1423688143, "creation_date": 1423688143, "answer_id": 28464324, "question_id": 28464180, "link": "https://stackoverflow.com/questions/28464180/nhibernate-expression-trees-and-eliminating-repetition/28464324#28464324", "title": "NHibernate, expression trees, and eliminating repetition", "body": "<p>What you can do is use a <code>Compose</code> method that can compose one expression with another:</p>\n\n<pre><code>public static Expression&lt;Func&lt;TFirstParam, TResult&gt;&gt;\n    Compose&lt;TFirstParam, TIntermediate, TResult&gt;(\n    this Expression&lt;Func&lt;TFirstParam, TIntermediate&gt;&gt; first,\n    Expression&lt;Func&lt;TIntermediate, TResult&gt;&gt; second)\n{\n    var param = Expression.Parameter(typeof(TFirstParam), \"param\");\n\n    var newFirst = first.Body.Replace(first.Parameters[0], param);\n    var newSecond = second.Body.Replace(second.Parameters[0], newFirst);\n\n    return Expression.Lambda&lt;Func&lt;TFirstParam, TResult&gt;&gt;(newSecond, param);\n}\n</code></pre>\n\n<p>Which uses the following method to replace all instances of one expression with another:</p>\n\n<pre><code>public static Expression Replace(this Expression expression,\n    Expression searchEx, Expression replaceEx)\n{\n    return new ReplaceVisitor(searchEx, replaceEx).Visit(expression);\n}\ninternal class ReplaceVisitor : ExpressionVisitor\n{\n    private readonly Expression from, to;\n    public ReplaceVisitor(Expression from, Expression to)\n    {\n        this.from = from;\n        this.to = to;\n    }\n    public override Expression Visit(Expression node)\n    {\n        return node == from ? to : base.Visit(node);\n    }\n}\n</code></pre>\n\n<p>Now you can write:</p>\n\n<pre><code>public static class ExpressionFactory \n{\n    public static Expression&lt;Func&lt;T, bool&gt;&gt; Get&lt;T&gt;(\n         Expression&lt;Func&lt;T, MasterDocument&gt;&gt; mdSource, SecurityKey key) \n    {\n        return mdSource.Compose(document =&gt; \n            document.Compartments.Where(c =&gt; c.AssociatedCompartment.Type != ProgramTypes.AccessGroup)\n                    .All(c =&gt; key.Compartments.Contains(c.AssociatedCompartment.ID))\n                    &amp;&amp; (\n                      doc.MasterDocument.NeedToKnowAccessList.Count() == 0\n                    || doc.MasterDocument.NeedToKnowAccessList.Any(p =&gt; p.PersonID == key.PersonID)\n                    || doc.MasterDocument.NeedToKnowAccessList.Any(p =&gt; key.AccessGroups.Contains(p.CompartmentID))\n                       );\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 201, "user_id": 1756892, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/deaa6201d7a3d37172cb2fe6121385e7?s=128&d=identicon&r=PG", "display_name": "Marc Chu", "link": "https://stackoverflow.com/users/1756892/marc-chu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "accepted_answer_id": 28464324, "answer_count": 1, "score": 0, "last_activity_date": 1423688143, "creation_date": 1423687649, "question_id": 28464180, "link": "https://stackoverflow.com/questions/28464180/nhibernate-expression-trees-and-eliminating-repetition", "title": "NHibernate, expression trees, and eliminating repetition", "body": "<p>We have implemented a security layer around our NHibernate persistence layer in a way that hopes to prevent a user from even receiving an object back from the database if he shouldn't have access to it.  That security layer looks like this:</p>\n\n<pre><code>public static IQueryable&lt;T&gt; Secure&lt;T&gt;(this Queryable&lt;T&gt; query){\n    //if T does not implement ISecurable, then return query\n    //else\n        return query.Where(expressionFactory.GetExpression(securityKey));\n}\n</code></pre>\n\n<p>We essentially restrict access to our ISession by wrapping it with a decorator that calls ISession.Query().Secure().</p>\n\n<p>So we have numerous types that return an <code>Expression&lt;Func&lt;T, bool&gt;&gt;</code>, such that we can pass it to Where():</p>\n\n<pre><code>public class DocumentSecurityExpressionFactory : ISecurityExpressionFactory&lt;Document&gt; {\n    public Expression&lt;Func&lt;Document, bool&gt;&gt; GetExpression(SecurityKey key) {\n        return doc =&gt; doc.MasterDocument.Compartments.Where(c =&gt; c.AssociatedCompartment.Type != ProgramTypes.AccessGroup) //Look at non-access group compartments for access\n                        .All(c =&gt; key.Compartments.Contains(c.AssociatedCompartment.ID))\n                    &amp;&amp; (\n            //person has to be either NTK \n                        doc.MasterDocument.NeedToKnowAccessList.Count() == 0\n                        || doc.MasterDocument.NeedToKnowAccessList.Any(p =&gt; p.PersonID == key.PersonID)\n                        || doc.MasterDocument.NeedToKnowAccessList.Any(p =&gt; key.AccessGroups.Contains(p.CompartmentID))\n                        );\n    }\n}\n\npublic class DocumentSummarySecurityExpressionFactory : ISecurityExpressionFactory&lt;DocumentSummary&gt; {\n    public Expression&lt;Func&lt;DocumentSummary, bool&gt;&gt; GetExpression(SecurityKey key) {\n        return doc =&gt; doc.MasterDocument.Compartments.Where(c =&gt; c.AssociatedCompartment.Type != ProgramTypes.AccessGroup)\n                        .All(c =&gt; key.Compartments.Contains(c.AssociatedCompartment.ID))\n                        &amp;&amp; (\n                          doc.MasterDocument.NeedToKnowAccessList.Count() == 0\n                        || doc.MasterDocument.NeedToKnowAccessList.Any(p =&gt; p.PersonID == key.PersonID)\n                        || doc.MasterDocument.NeedToKnowAccessList.Any(p =&gt; key.AccessGroups.Contains(p.CompartmentID))\n                           );\n    }\n}\n\npublic class LatestDocumentVersionSecurityExpressionFactory : ISecurityExpressionFactory&lt;LatestDocumentVersion&gt; {\n    public Expression&lt;Func&lt;LatestDocumentVersion, bool&gt;&gt; GetExpression(SecurityKey key) {\n        return version =&gt; version.BaseDocument.MasterDocument.Compartments.Where(c =&gt; c.AssociatedCompartment.Type != ProgramTypes.AccessGroup)\n                            .All(c =&gt; key.Compartments.Contains(c.AssociatedCompartment.ID))\n                            &amp;&amp; (\n                                version.BaseDocument.MasterDocument.NeedToKnowAccessList.Count() == 0\n                                || version.BaseDocument.MasterDocument.NeedToKnowAccessList.Any(p =&gt; p.PersonID == key.PersonID)\n                                || version.BaseDocument.MasterDocument.NeedToKnowAccessList.Any(p =&gt; key.AccessGroups.Contains(p.CompartmentID))\n                            );\n    }\n}\n</code></pre>\n\n<p>And there are actually several more for different types that look just like this.</p>\n\n<p>The problem here should be clear:  each of our entities that does this is essentially the same.  They each have a reference to a MasterDocument object, on which all the logic is done.  Repeating this code totally sucks (and it all sits in one file so they can all change together if they ever do).  </p>\n\n<p>I feel like I <em>should</em> be able to just tell a method how to get the MasterDocument from type T, and then have a generalized method that builds the expression.  Something like this:</p>\n\n<pre><code>public static class ExpressionFactory {\n    public static Expression&lt;Func&lt;T, bool&gt;&gt; Get&lt;T&gt;(Expression&lt;Func&lt;T, MasterDocument&gt;&gt; mdSource, SecurityKey key) {\n        return t =&gt; {\n             var md = mdSource.Compile()(t);\n             return md.Compartments.Where(c =&gt; c.AssociatedCompartment)...\n        };\n    }\n}\n</code></pre>\n\n<p>And call it like so:</p>\n\n<pre><code>public class DocumentSecurityExpressionFactory : ISecurityExpressionFactory&lt;Document&gt; {\n    public Expression&lt;Func&lt;Document, bool&gt;&gt; GetExpression(SecurityKey key) {\n        return ExpressionFactory.Get&lt;Document&gt;(doc =&gt; doc.MasterDocument, key);\n    }\n}\n</code></pre>\n\n<p>Now, I understand why this code doesn't work.  What I can't figure out is how to build up this expression tree correctly in order to vastly simplify our code.  I imagine I could pass in the <code>Expression&lt;Func&lt;T, MasterDocument&gt;&gt; mdSource</code> like that and then use the Expression API to build it out with MemberAccessExpressions and such, but I'm anticipating the mess that would look like, and I'm not sure what would be the lesser evil.</p>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["c#", "naudio"], "comments": [{"owner": {"reputation": 5023, "user_id": 10156, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d997169a951f335eecd6bf66921e80aa?s=128&d=identicon&r=PG", "display_name": "Steve Mitcham", "link": "https://stackoverflow.com/users/10156/steve-mitcham"}, "edited": false, "score": 1, "creation_date": 1423687761, "post_id": 28464111, "comment_id": 45254122, "body": "SO is a site to come to with a specific problem that needs fixing.  Simply giving a vague description of a task and asking people to write code is not going to get a good answer, and is likely to get your question closed.  Showing some code examples and research of things you&#39;ve tried will improve your chances of getting an answer."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4556515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4215a6f484198bc28c630001783e3815?s=128&d=identicon&r=PG&f=1", "display_name": "Rain Oat", "link": "https://stackoverflow.com/users/4556515/rain-oat"}, "edited": false, "score": 0, "creation_date": 1423823115, "post_id": 28495685, "comment_id": 45314241, "body": "Thank you very much for your answer! I have looked very closely at both &#39;OffsetSampleProvider&#39; and &#39;BufferedWaveProvider&#39; for inspiration. I would like to further inquire why I cannot use &#39;float[] copyBuffer = buffer&#39;, then inserting the copyBuffer back after I created a buffer of zeroes."}], "tags": [], "owner": {"reputation": 45124, "user_id": 7532, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/db4b131b1b1519a5a22f84b1e8737f9b?s=128&d=identicon&r=PG", "display_name": "Mark Heath", "link": "https://stackoverflow.com/users/7532/mark-heath"}, "is_accepted": false, "score": 0, "last_activity_date": 1423817574, "creation_date": 1423817574, "answer_id": 28495685, "question_id": 28464111, "link": "https://stackoverflow.com/questions/28464111/inserting-adjustable-delay-on-each-input-source/28495685#28495685", "title": "Inserting adjustable delay on each Input Source", "body": "<p>You should implement this by creating your own custom <code>ISampleProvider</code> that wraps each input to your mixer (Decorator pattern). Then have a method that tells it to insert n samples of silence. Then in the <code>Read</code> method of your SampleProvider if silence is required, then put up to the desired number of silent samples into the read buffer. And when the pause finishes, start returning samples from the source provider again.</p>\n\n<p>You can have a look at the source code to the <code>OffsetSampleProvider</code> for inspiration, which allows you to add a specified number of silence samples at the start of your stream.</p>\n"}], "owner": {"reputation": 11, "user_id": 4556515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4215a6f484198bc28c630001783e3815?s=128&d=identicon&r=PG&f=1", "display_name": "Rain Oat", "link": "https://stackoverflow.com/users/4556515/rain-oat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1423823876, "creation_date": 1423687406, "last_edit_date": 1423823876, "question_id": 28464111, "link": "https://stackoverflow.com/questions/28464111/inserting-adjustable-delay-on-each-input-source", "title": "Inserting adjustable delay on each Input Source", "body": "<p>I'm currently using Naudio to create a mixer with multiple inputs and multiple outputs. </p>\n\n<p>For each input, while the audio is playing, I would like to be able to add a sample sized delay whenever I choose to.\nThe effect will be similar to pausing for, say 100 samples, and then playing again. \nFor example, a mixingSampleProvider is currently playing audio to output Channel 5, using multiplexingSampleProvider. On a certain button click, i would like to delay mixingSampleProvider by 200 samples, before it continues playing from the point it paused for a moment.</p>\n\n<p>I would like to know if it's possible to do so, and what options can be looked at to achieve this effect.</p>\n\n<p>Edit: \nThe specific problem which requires fixing, would be the knowledge gap I have in inserting Zeros to the buffer, while pushing all the rest of the samples back, while audio is playing. Here, I'm not looking for code to be written, but am looking for resources to attempt to create a new class to solve this issue. Or whether it is even possible at all.</p>\n\n<p>Edit 2: Code I have tried (failed)</p>\n\n<pre><code> public int Read(float[] buffer, int offset, int count)\n    {\n        int sampleRead = source.Read(buffer,offset,count);\n        int delaySamples = Math.Min(count, DelayBySamples - delayPos);\n        float[] copyBuffer = buffer;\n\n        for (int n = 0; n &lt; delaySamples;n++ )\n        {\n            buffer[offset + n] = 0;\n        }\n        for (int n = 0; n &lt; sampleRead;n++ )\n        {\n            buffer[offset + delaySamples + n] = copyBuffer[offset+n];\n        }\n\n\n        delayPos += delaySamples;\n        sampleRead += delaySamples;\n\n\n        return sampleRead;\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "file-upload"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1423687325, "post_id": 28464057, "comment_id": 45253853, "body": "The browser does not support that."}, {"owner": {"reputation": 1981, "user_id": 113374, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7WZv6.jpg?s=128&g=1", "display_name": "NextInLine", "link": "https://stackoverflow.com/users/113374/nextinline"}, "edited": false, "score": 0, "creation_date": 1423687468, "post_id": 28464057, "comment_id": 45253935, "body": "What you describe is considered a security risk and therefore modern browsers do not support it."}, {"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1423688126, "post_id": 28464057, "comment_id": 45254333, "body": "Is this a public website, or is it an internal business application where you can expect all users to be on the company&#39;s network?"}, {"owner": {"reputation": 471, "user_id": 352916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ggp03.jpg?s=128&g=1", "display_name": "Phil Sattele", "link": "https://stackoverflow.com/users/352916/phil-sattele"}, "edited": false, "score": 0, "creation_date": 1423688738, "post_id": 28464057, "comment_id": 45254628, "body": "It&#39;s a public web site. Users have an account they log into to access it."}], "owner": {"reputation": 471, "user_id": 352916, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ggp03.jpg?s=128&g=1", "display_name": "Phil Sattele", "link": "https://stackoverflow.com/users/352916/phil-sattele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423687192, "creation_date": 1423687192, "question_id": 28464057, "link": "https://stackoverflow.com/questions/28464057/upload-multiple-files-without-having-to-select-every-time", "title": "Upload multiple files without having to select every time", "body": "<p>With HTML5 and ASP.NET 4.5, I created a page that will allow the user to upload multiple files. The ASPX code looks like:</p>\n\n<pre><code>&lt;asp:FileUpload runat=\"server\" ID=\"UploadImages\" AllowMultiple=\"true\"  /&gt;\n&lt;asp:Button runat=\"server\" ID=\"uploadedFile\" Text=\"Upload\" OnClick=\"uploadFile_Click\" /&gt;\n&lt;asp:Label ID=\"listofuploadedfiles\" runat=\"server\" /&gt;`\n</code></pre>\n\n<p>c# code:</p>\n\n<pre><code>    protected void uploadFile_Click(object sender, EventArgs e)\n    {\n\n        if (UploadImages.HasFiles)\n        {\n            foreach (HttpPostedFile uploadedFile in UploadImages.PostedFiles)\n            {                  \n                string fileName = Path.GetFileName(uploadedFile.FileName);\n                uploadedFile.SaveAs(\"C:\\\\Users\\\\username\\\\Desktop\\\\Uploaded\\\\\" + fileName);\n                listofuploadedfiles.Text += String.Format(\"{0}&lt;br /&gt;\", uploadedFile.FileName);\n            }\n        }\n    }\n</code></pre>\n\n<p>The user selects the files using the FileUpload control and clicks the Upload button and it works great.</p>\n\n<p>My question is: Is is possible to upload files using this method without the user selecting the files? I'd like to have the app always point to a directory on the users hard drive and default to uploading the files in that directory. \nThe user would see the contents of that directory in a list box and click the upload button or some variation to that. \nI don't see any way to add files to the FileUpload control in code. </p>\n"}, {"tags": ["c#", "google-prediction"], "answers": [{"comments": [{"owner": {"reputation": 16163, "user_id": 25702, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/37edf2567185071646d62ba28b868fab?s=128&d=identicon&r=PG", "display_name": "David Gardiner", "link": "https://stackoverflow.com/users/25702/david-gardiner"}, "edited": false, "score": 0, "creation_date": 1424317017, "post_id": 28507322, "comment_id": 45502691, "body": "Did you create a new login to answer your own question?"}, {"owner": {"reputation": 11, "user_id": 3737846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fe3ba612dc8b2e233d5b0124d4686e3?s=128&d=identicon&r=PG&f=1", "display_name": "SaulN", "link": "https://stackoverflow.com/users/3737846/sauln"}, "reply_to_user": {"reputation": 16163, "user_id": 25702, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/37edf2567185071646d62ba28b868fab?s=128&d=identicon&r=PG", "display_name": "David Gardiner", "link": "https://stackoverflow.com/users/25702/david-gardiner"}, "edited": false, "score": 0, "creation_date": 1424369875, "post_id": 28507322, "comment_id": 45531065, "body": "David, I don&#39;t know how I got two logins.  That certainly wasn&#39;t my intent.  It took a fair amount of experimentation and work to get the code to function.  My purpose is to give others a starting position that really works."}, {"owner": {"reputation": 16163, "user_id": 25702, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/37edf2567185071646d62ba28b868fab?s=128&d=identicon&r=PG", "display_name": "David Gardiner", "link": "https://stackoverflow.com/users/25702/david-gardiner"}, "edited": false, "score": 0, "creation_date": 1424388179, "post_id": 28507322, "comment_id": 45540835, "body": "That&#39;s ok. I reformatted your question to make it look more like regular C# and less like JavaScript, which might have confused some readers."}], "tags": [], "owner": {"reputation": 11, "user_id": 3737846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fe3ba612dc8b2e233d5b0124d4686e3?s=128&d=identicon&r=PG&f=1", "display_name": "SaulN", "link": "https://stackoverflow.com/users/3737846/sauln"}, "is_accepted": false, "score": 0, "last_activity_date": 1423855917, "creation_date": 1423855917, "answer_id": 28507322, "question_id": 28464022, "link": "https://stackoverflow.com/questions/28464022/insufficient-permissions-error/28507322#28507322", "title": "Insufficient Permissions error", "body": "<p>I got this to work by making a number of changes.  From the Google Developers Console I got the following information (I chose to make the Project Name and the Product Name the same.  They can be different.):</p>\n\n<pre><code>    API:                Prediction API v1.6\n    Project Name:       Aggregate Volumes MTFE\n    Project ID:         golden-sentry-848\n    Project No:         1043149216958\n    Product Name:       Aggregate Volumes MTFE\n    Predictive Model:   mtfe\n</code></pre>\n\n<p>The API version is very important.  The installed package and the using statements both have to agree.  The package download is</p>\n\n<pre><code>Install-Package Google.Apis.Prediction.v1_6\n</code></pre>\n\n<p>and the required using statements are:</p>\n\n<pre><code>using Google.Apis.Auth.OAuth2;\nusing Google.Apis.Prediction.v1_6;\nusing Google.Apis.Prediction.v1_6.Data;\nusing Google.Apis.Services;\n</code></pre>\n\n<p>There are some naming problems that caused me some confusion.  When you initialize the Prediction Services, ApplicationName is the Product Name you specified in Google Developers Console.  The parameter required in service.Trainedmodels.List is the Project No. assigned when you created the project in Google Developers Console.  Here's the code:</p>\n\n<pre><code>    public async Task \n    Run() {\n        UserCredential credential;\n        using (var stream = new FileStream(\"Aggregate Volumes MTFE Client Secret.json\", FileMode.Open, FileAccess.Read)) {\n            credential = await GoogleWebAuthorizationBroker.AuthorizeAsync(\n                GoogleClientSecrets.Load(stream).Secrets,\n                new[] {PredictionService.Scope.Prediction},\n                \"user\", CancellationToken.None );\n            }\n\n        var service =\n            new PredictionService(\n                new BaseClientService.Initializer() {\n                    HttpClientInitializer = credential,\n                    ApplicationName = \"Aggregate Volumes MTFE\"\n                    }\n                );\n\n        try {\n            var pre = service.Trainedmodels.List(\"1043149216958\");\n            var response = pre.Execute();\n            }\n        catch (Exception e) { \n            Console.WriteLine(\"An error occurred: \" + e.Message); \n            }\n        }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4548379, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YKcDSAgPWP0/AAAAAAAAAAI/AAAAAAAAACc/fFljmYe61AE/photo.jpg?sz=128", "display_name": "Rugallach", "link": "https://stackoverflow.com/users/4548379/rugallach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 751, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1424316506, "creation_date": 1423687051, "last_edit_date": 1424316506, "question_id": 28464022, "link": "https://stackoverflow.com/questions/28464022/insufficient-permissions-error", "title": "Insufficient Permissions error", "body": "<p>I'm trying to write a console app to use Google Prediction.  I can't figure out what I'm doing wrong.  I keep getting \"Insufficient Permissions\". How can I fix this.  How can one see what request is actually being generated? </p>\n\n<pre><code>    //Desired Request:  GET https://www.googleapis.com/prediction/v1.6/projects/1043149216958/trainedmodels/list?               \n    //                      pageToken=%22%22&amp;maxResults=5&amp;key={YOUR_API_KEY}\n\n    public async Task Run() \n    {\n        UserCredential credential;\n        using (var stream = new FileStream(\"Aggreate Volume 1 Client Secret.json\", FileMode.Open, FileAccess.Read)) \n        {\n            credential = await GoogleWebAuthorizationBroker.AuthorizeAsync(\n                GoogleClientSecrets.Load(stream).Secrets,\n                new[] {PredictionService.Scope.DevstorageFullControl}, \n                \"user\", CancellationToken.None );\n        }\n\n        var service =\n            new PredictionService(\n                new BaseClientService.Initializer() {\n                    HttpClientInitializer = credential,\n                    ApplicationName = \"Aggregate Volume 2\"\n                    }\n                );\n\n        try \n        {\n            var response = service.Trainedmodels.List().Execute();\n        }\n        catch (Exception e) \n        { \n            Console.WriteLine(\"An error occurred: \" + e.Message); \n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "sql", "sql-server", "stored-procedures", "dapper"], "comments": [{"owner": {"reputation": 49599, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1423687341, "post_id": 28464011, "comment_id": 45253871, "body": "You need to show us how you are invoking the stored procedure, and how you are mapping its returns to your Person class properties."}], "answers": [{"tags": [], "owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "is_accepted": true, "score": 2, "last_activity_date": 1423687465, "last_edit_date": 1495542440, "creation_date": 1423687465, "answer_id": 28464130, "question_id": 28464011, "link": "https://stackoverflow.com/questions/28464011/map-stored-procedure-result-to-object-inside-an-object/28464130#28464130", "title": "Map Stored procedure result to object inside an object", "body": "<p>Use the QueryMultiple, and write 2 SELECT statements in ONE stored procedure.</p>\n\n<p>Here are some helper links.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/6317937/dapper-net-and-stored-proc-with-multiple-result-sets/6338193#6338193\">Dapper.NET and stored proc with multiple result sets</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/19337468/multiple-sql-statements-in-one-roundtrip-using-dapper-net\">Multiple SQL statements in one roundtrip using Dapper.NET</a></p>\n"}], "owner": {"reputation": 3774, "user_id": 899039, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2b696efaf61f5517565b32b0c3d69ed?s=128&d=identicon&r=PG", "display_name": "Timsen", "link": "https://stackoverflow.com/users/899039/timsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1505, "favorite_count": 0, "accepted_answer_id": 28464130, "answer_count": 1, "score": 1, "last_activity_date": 1423687475, "creation_date": 1423687020, "last_edit_date": 1423687475, "question_id": 28464011, "link": "https://stackoverflow.com/questions/28464011/map-stored-procedure-result-to-object-inside-an-object", "title": "Map Stored procedure result to object inside an object", "body": "<p>If i have a Person class which have Dog class property  :</p>\n\n<pre><code>public class Person{\n public string Name {get;set;}\n public Dog Doggie {get;set;}\n}\n</code></pre>\n\n<p>On a single SP call i want to populate both dog object and person object, but i cant figure out how to do that. </p>\n\n<pre><code>CREATE PROCEDURE Test\n AS\nBEGIN\n    SET NOCOUNT ON;\n\n    -- Insert statements for procedure here\n      SELECT \n        Name                = p.Person_Name,\n        Doggie.Name (This fails) = d.Dog_Name\n\n      FROM My fancy join......\nEND\nGO\n\n\n\n  public Person GetByUid(Guid uid)\n    {\n        Person personToReturn;\n\n        using (var connection = this.connectionFactory.GetOpenConnection())\n        {\n            try\n            {\n                personToReturn= connection.Query&lt;Person&gt;(\"ProcedureName\",\n                    new {  personUid = uid },\n                    commandType: CommandType.StoredProcedure).Single();\n            }\n            catch ()\n            {\n                return null;\n            }\n\n        }\n\n    return personToReturn;\n}\n</code></pre>\n\n<p>Is it possible? </p>\n"}, {"tags": ["c#", "asp.net", "checkboxlist"], "answers": [{"comments": [{"owner": {"reputation": 577, "user_id": 1148077, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9a1e52724d3e05dad2d928ad8dbe477e?s=128&d=identicon&r=PG", "display_name": "techora", "link": "https://stackoverflow.com/users/1148077/techora"}, "edited": false, "score": 0, "creation_date": 1423688887, "post_id": 28464142, "comment_id": 45254695, "body": "This didn&#39;t work for me at first but then I changed it to &quot;FindByValue&quot; instead of &quot;FindItemByValue&quot; and it worked. Thank you."}], "tags": [], "owner": {"reputation": 5865, "user_id": 2557138, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zwSr0.png?s=128&g=1", "display_name": "Rick S", "link": "https://stackoverflow.com/users/2557138/rick-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1423689397, "last_edit_date": 1423689397, "creation_date": 1423687513, "answer_id": 28464142, "question_id": 28463950, "link": "https://stackoverflow.com/questions/28463950/disable-specific-items-in-a-checkboxlist/28464142#28464142", "title": "Disable specific items in a CheckboxList", "body": "<p>Haven't tried it but this may work:</p>\n\n<pre><code>customerList.Items.Add(new ListItem(displayName, displayValue)); // DISABLED\nListItem li = customerList.Items.FindByValue(displayValue);\nli.Enabled = false;\n</code></pre>\n\n<p>UPDATED to use FindByValue</p>\n"}, {"tags": [], "owner": {"reputation": 771, "user_id": 3244406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b7a06b3ba682fa6bcb57badeb0583b?s=128&d=identicon&r=PG&f=1", "display_name": "JamesCarters", "link": "https://stackoverflow.com/users/3244406/jamescarters"}, "is_accepted": true, "score": 8, "last_activity_date": 1423688956, "last_edit_date": 1423688956, "creation_date": 1423687967, "answer_id": 28464268, "question_id": 28463950, "link": "https://stackoverflow.com/questions/28463950/disable-specific-items-in-a-checkboxlist/28464268#28464268", "title": "Disable specific items in a CheckboxList", "body": "<pre><code>if (node.SelectSingleNode(\"Status\") == \"Inactive\")\n   {\n     customerList.Items.Add(new ListItem{Name=displayName, Value= displayValue, Enabled= false}); // DISABLED\n   }\nelse\n   {\n     customerList.Items.Add(new ListItem(displayName, displayValue));  // ENABLED\n   }`\n</code></pre>\n"}], "owner": {"reputation": 577, "user_id": 1148077, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9a1e52724d3e05dad2d928ad8dbe477e?s=128&d=identicon&r=PG", "display_name": "techora", "link": "https://stackoverflow.com/users/1148077/techora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7433, "favorite_count": 1, "accepted_answer_id": 28464268, "answer_count": 2, "score": 4, "last_activity_date": 1423689397, "creation_date": 1423686820, "last_edit_date": 1423687481, "question_id": 28463950, "link": "https://stackoverflow.com/questions/28463950/disable-specific-items-in-a-checkboxlist", "title": "Disable specific items in a CheckboxList", "body": "<p>I am running through a set of data, which will populate a CheckBoxList. I want to display all the items in the list but certain ones will be disabled as they don't qualify (their status equals Inactive). How do I set an item to disabled (Enabled = false) in the code behind like this?</p>\n\n<pre><code>if (node.SelectSingleNode(\"Status\") == \"Inactive\")\n   {\n     customerList.Items.Add(new ListItem(displayName, displayValue)); // DISABLED\n   }\nelse\n   {\n     customerList.Items.Add(new ListItem(displayName, displayValue));  // ENABLED\n   }\n</code></pre>\n"}, {"tags": ["c#", ".net", "download", "webclient", "webclient-download"], "comments": [{"owner": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "edited": false, "score": 2, "creation_date": 1423686557, "post_id": 28463861, "comment_id": 45253446, "body": "Under what context does this code run? If it&#39;s on the UI thread, <code>while (Client.IsBusy)</code> will block."}, {"owner": {"reputation": 21, "user_id": 4556538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c54dbcc9e7748168b2c943e54e0960e?s=128&d=identicon&r=PG&f=1", "display_name": "Aurionin", "link": "https://stackoverflow.com/users/4556538/aurionin"}, "reply_to_user": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "edited": false, "score": 0, "creation_date": 1423686732, "post_id": 28463861, "comment_id": 45253543, "body": "I have no idea how to do anything relating to threading, so there&#39;s no mention of it in my code. Whatever it does by default is what thread is being used."}, {"owner": {"reputation": 6250, "user_id": 2359643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/05ea83110037dc15d8d22e722fd184f4?s=128&d=identicon&r=PG", "display_name": "JNYRanger", "link": "https://stackoverflow.com/users/2359643/jnyranger"}, "reply_to_user": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "edited": false, "score": 0, "creation_date": 1423689997, "post_id": 28463861, "comment_id": 45255290, "body": "@wgraham DownloadFileAsync will run on a thread within the threadpool, not on the UI thread, so it&#39;s OK.  DownloadFileAsync also prints <a href=\"https://msdn.microsoft.com/en-us/library/hyb3xww8(v=vs.110).aspx\" rel=\"nofollow noreferrer\">network tracing information</a> info so you might want to look to see what&#39;s going on in the background."}, {"owner": {"reputation": 135642, "user_id": 1870803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jYakG.jpg?s=128&g=1", "display_name": "Yuval Itzchakov", "link": "https://stackoverflow.com/users/1870803/yuval-itzchakov"}, "reply_to_user": {"reputation": 6250, "user_id": 2359643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/05ea83110037dc15d8d22e722fd184f4?s=128&d=identicon&r=PG", "display_name": "JNYRanger", "link": "https://stackoverflow.com/users/2359643/jnyranger"}, "edited": false, "score": 1, "creation_date": 1423690406, "post_id": 28463861, "comment_id": 45255505, "body": "@JNYRanger - It&#39;s trying to update a UI element, it has to be invoked on the UI thread."}, {"owner": {"reputation": 6250, "user_id": 2359643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/05ea83110037dc15d8d22e722fd184f4?s=128&d=identicon&r=PG", "display_name": "JNYRanger", "link": "https://stackoverflow.com/users/2359643/jnyranger"}, "reply_to_user": {"reputation": 135642, "user_id": 1870803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jYakG.jpg?s=128&g=1", "display_name": "Yuval Itzchakov", "link": "https://stackoverflow.com/users/1870803/yuval-itzchakov"}, "edited": false, "score": 0, "creation_date": 1423690510, "post_id": 28463861, "comment_id": 45255555, "body": "@YuvalItzchakov I know.  <code>DownloadFileAsync</code> runs on the threadpool.  The event delegate runs on the UI thread.  These are the defaults, and  based on what OP stated he hasn&#39;t modified them.  I was not providing an answer to why it isn&#39;t working, just a suggestion to take a look at the tracing to see what&#39;s happening behind the scenes."}, {"owner": {"reputation": 135642, "user_id": 1870803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jYakG.jpg?s=128&g=1", "display_name": "Yuval Itzchakov", "link": "https://stackoverflow.com/users/1870803/yuval-itzchakov"}, "edited": false, "score": 2, "creation_date": 1423690571, "post_id": 28463861, "comment_id": 45255579, "body": "He&#39;s locking the thread with his while loop"}, {"owner": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "reply_to_user": {"reputation": 6250, "user_id": 2359643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/05ea83110037dc15d8d22e722fd184f4?s=128&d=identicon&r=PG", "display_name": "JNYRanger", "link": "https://stackoverflow.com/users/2359643/jnyranger"}, "edited": false, "score": 0, "creation_date": 1423691541, "post_id": 28463861, "comment_id": 45256115, "body": "@JNYRanger, @YuvalItzchakov is absolutely right. While the work that <code>DownloadFileAsync</code> is done on the thread pool (unless a different task scheduler is used), he&#39;s still waiting for it to finish in the UI thread."}], "answers": [{"tags": [], "owner": {"reputation": 135642, "user_id": 1870803, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jYakG.jpg?s=128&g=1", "display_name": "Yuval Itzchakov", "link": "https://stackoverflow.com/users/1870803/yuval-itzchakov"}, "is_accepted": false, "score": 3, "last_activity_date": 1423690335, "creation_date": 1423690335, "answer_id": 28464922, "question_id": 28463861, "link": "https://stackoverflow.com/questions/28463861/webclient-downloadprogresschanged-doesnt-fire/28464922#28464922", "title": "WebClient.DownloadProgressChanged doesn&#39;t fire", "body": "<p>This:</p>\n\n<pre><code>while (Client.IsBusy) { }\n</code></pre>\n\n<p>Ties up the UI message loop. It keeps it consumed and doesn't allow any other messages to be processed. Meanwhile, the event is being queued on the UI thread, which is blocked.</p>\n\n<p>If you comment that line and the download completes, you'll see you textbox update properly.</p>\n\n<p>You should re-think what you're trying to do. If <code>Client</code>, consider moving the while loop to a <a href=\"https://msdn.microsoft.com/en-us/library/h339syd0%28v=vs.110%29.aspx\" rel=\"nofollow\"><em>background thread</em></a></p>\n"}], "owner": {"reputation": 21, "user_id": 4556538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c54dbcc9e7748168b2c943e54e0960e?s=128&d=identicon&r=PG&f=1", "display_name": "Aurionin", "link": "https://stackoverflow.com/users/4556538/aurionin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1423735264, "creation_date": 1423686491, "last_edit_date": 1423735264, "question_id": 28463861, "link": "https://stackoverflow.com/questions/28463861/webclient-downloadprogresschanged-doesnt-fire", "title": "WebClient.DownloadProgressChanged doesn&#39;t fire", "body": "<p>Doing some programming in Visual Studio with C# and I'm trying to download a file and link the progress to a <code>ProgressBar</code>. It worked perfectly fine when I did it in Visual Basic, but when I tried to do it in C#, the <code>Client.DownloadProgressChanged</code> event just doesn't fire.</p>\n\n<pre><code>System.Net.WebClient Client = new System.Net.WebClient();\nClient.DownloadProgressChanged += Client_DownloadProgressChanged;\nClient.DownloadFileAsync(new Uri(url), filepath + filename);\nwhile (Client.IsBusy) { }\n</code></pre>\n\n<p>The only thing in <code>Client_DownloadProgressChanged</code> is some code that changes the value of a <code>TextBox</code> to \"Test1\" which I did just to see if it runs.</p>\n"}, {"tags": ["c#", ".net", "dll"], "comments": [{"owner": {"reputation": 11220, "user_id": 2609288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3634e5c231c72e362f00ae39b637734f?s=128&d=identicon&r=PG", "display_name": "Baldrick", "link": "https://stackoverflow.com/users/2609288/baldrick"}, "edited": false, "score": 0, "creation_date": 1423686072, "post_id": 28463650, "comment_id": 45253186, "body": "Did you build the code yourself, or try to run a pre-built executable?"}, {"owner": {"reputation": 536, "user_id": 1902468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9ca3e16ee56737d2a0d76e238eaee34?s=128&d=identicon&r=PG&f=1", "display_name": "Aba", "link": "https://stackoverflow.com/users/1902468/aba"}, "reply_to_user": {"reputation": 11220, "user_id": 2609288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3634e5c231c72e362f00ae39b637734f?s=128&d=identicon&r=PG", "display_name": "Baldrick", "link": "https://stackoverflow.com/users/2609288/baldrick"}, "edited": false, "score": 0, "creation_date": 1423693932, "post_id": 28463650, "comment_id": 45257348, "body": "@Baldrick I&#39;m building the code myself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2930590"}, "edited": false, "score": 1, "creation_date": 1423742360, "post_id": 28463650, "comment_id": 45276717, "body": "Maybe this link can help:&quot;  <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/6e45ae65-7be0-4c9e-8989-df413028639d/compobjdll-is-too-old-for-the-ole2dll-initialized\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/vstudio/en-US/&hellip;</a>"}, {"owner": {"reputation": 536, "user_id": 1902468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9ca3e16ee56737d2a0d76e238eaee34?s=128&d=identicon&r=PG&f=1", "display_name": "Aba", "link": "https://stackoverflow.com/users/1902468/aba"}, "edited": false, "score": 0, "creation_date": 1423754439, "post_id": 28463650, "comment_id": 45284598, "body": "@Neill Verreynne Yes that link did help. if fact I saw it already but misunderstood which like of code need to be fixed, so thank you for bringing it to my attention again. Alas, the code still doesn&#39;t work, no errors it just doesn&#39;t work, I&#39;m convinced after searching hi and low and testing different sets of code there isn&#39;t a strait foreword (read easy and cheep) way to accomplish an auto-dialer in win8 :("}], "owner": {"reputation": 536, "user_id": 1902468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d9ca3e16ee56737d2a0d76e238eaee34?s=128&d=identicon&r=PG&f=1", "display_name": "Aba", "link": "https://stackoverflow.com/users/1902468/aba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1423685693, "creation_date": 1423685693, "question_id": 28463650, "link": "https://stackoverflow.com/questions/28463650/error-compobj-dll-is-too-old-for-the-ole2-dll-initialized-exception-from-hresu", "title": "Error: compobj.dll is too old for the ole2.dll initialized (Exception from HRESULT:0x8004000E(OLE_E_WRONGCOMPOBJ))", "body": "<p>I am trying to write a simple dialer to broadcast events for a local women's group (so no money for commercial app) and downloaded <a href=\"http://www.codeproject.com/Articles/10994/TAPI-Application-development-using-C-NET\" rel=\"nofollow\">http://www.codeproject.com/Articles/10994/TAPI-Application-development-using-C-NET</a> I am getting the following error:</p>\n\n<p>compobj.dll is too old for the ole2.dll initialized (Exception from HRESULT:0x8004000E(OLE_E_WRONGCOMPOBJ)) </p>\n\n<p>I have 2 copies of each dll on my machine and they are all from 8/21/2013.</p>\n\n<p>I am running Microsoft Windows 8.1 (64-bit) and using VS Express 2013 for Win. Desktop</p>\n"}, {"tags": ["javascript", "c#", "asp.net", "sql-server", "json"], "comments": [{"owner": {"reputation": 511, "user_id": 3684165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924fac79a635e4a368c4a40bd5c95977?s=128&d=identicon&r=PG&f=1", "display_name": "lujcon", "link": "https://stackoverflow.com/users/3684165/lujcon"}, "edited": false, "score": 1, "creation_date": 1423686213, "post_id": 28463622, "comment_id": 45253264, "body": "Why are you returning string? Can be easier if you&#39;ll return rows."}, {"owner": {"reputation": 2710, "user_id": 2082141, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7c5044d4e71d5bb18a4a67152046bfa3?s=128&d=identicon&r=PG", "display_name": "Dustin Poissant", "link": "https://stackoverflow.com/users/2082141/dustin-poissant"}, "edited": false, "score": 0, "creation_date": 1423686307, "post_id": 28463622, "comment_id": 45253319, "body": "It is possible that your Ajax call is returning before your document is ready. make sure that you call that ajax function inside <code>$(document).ready(&#47;*here8&#47;);</code> to ensure your <code>#jsonData</code> is available when you try to display it."}, {"owner": {"reputation": 167, "user_id": 1135567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7fd985934008e66542d067f19c5c9fc9?s=128&d=identicon&r=PG&f=1", "display_name": "btalbot", "link": "https://stackoverflow.com/users/1135567/btalbot"}, "reply_to_user": {"reputation": 511, "user_id": 3684165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924fac79a635e4a368c4a40bd5c95977?s=128&d=identicon&r=PG&f=1", "display_name": "lujcon", "link": "https://stackoverflow.com/users/3684165/lujcon"}, "edited": false, "score": 0, "creation_date": 1423686402, "post_id": 28463622, "comment_id": 45253364, "body": "Can you give me an example @lujcon ?"}], "answers": [{"tags": [], "owner": {"reputation": 824, "user_id": 4547921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3193d2112b1a382aa03cbc747d7dba2e?s=128&d=identicon&r=PG&f=1", "display_name": "jpriebe", "link": "https://stackoverflow.com/users/4547921/jpriebe"}, "is_accepted": false, "score": 1, "last_activity_date": 1423686196, "creation_date": 1423686196, "answer_id": 28463773, "question_id": 28463622, "link": "https://stackoverflow.com/questions/28463622/why-cant-i-use-my-json-data/28463773#28463773", "title": "Why can&#39;t I use my JSON data?", "body": "<p>You need to use <code>parseJSON</code>, as such:</p>\n\n<pre><code>myThing = {\"d\":\"[{\\\"DrawID\\\":925,\\\"xCoord\\\":466,\\\"yCoord\\\":201},{\\\"DrawID\\\":924,\\\"xCoord\\\":385,\\\"yCoord\\\":318},{\\\"DrawID\\\":923,\\\"xCoord\\\":768,\\\"yCoord\\\":159},{\\\"DrawID\\\":922,\\\"xCoord\\\":543,\\\"yCoord\\\":214},{\\\"DrawID\\\":921,\\\"xCoord\\\":329,\\\"yCoord\\\":172}]\"};\n\nmyJSON = $.parseJSON(myThing.d);\nalert (myJSON[0].DrawID); //etc\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 1135567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7fd985934008e66542d067f19c5c9fc9?s=128&d=identicon&r=PG&f=1", "display_name": "btalbot", "link": "https://stackoverflow.com/users/1135567/btalbot"}, "edited": false, "score": 1, "creation_date": 1423688308, "post_id": 28463860, "comment_id": 45254420, "body": "This, along with the C# answer by @lujcon answer solved my problem. I&#39;ve created a community wiki answer combining his and your answers. Thank you. Upvoted."}], "tags": [], "owner": {"reputation": 2124, "user_id": 504661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nh1h1.jpg?s=128&g=1", "display_name": "Justin Russo", "link": "https://stackoverflow.com/users/504661/justin-russo"}, "is_accepted": true, "score": 2, "last_activity_date": 1423686490, "creation_date": 1423686490, "answer_id": 28463860, "question_id": 28463622, "link": "https://stackoverflow.com/questions/28463622/why-cant-i-use-my-json-data/28463860#28463860", "title": "Why can&#39;t I use my JSON data?", "body": "<p>In your success function, you do not stringify or json.Parse the 'data' variable, but rather the data.d variable.  'd' is the member of the json return that you need to parse.  </p>\n\n<p>So, change, <code>var text = JSON.stringify(data);</code> to <code>var text = JSON.stringify(data.d);</code> and you should be golden.</p>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 1135567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7fd985934008e66542d067f19c5c9fc9?s=128&d=identicon&r=PG&f=1", "display_name": "btalbot", "link": "https://stackoverflow.com/users/1135567/btalbot"}, "edited": false, "score": 0, "creation_date": 1423687531, "post_id": 28463937, "comment_id": 45253967, "body": "This has actually formatted the JSON correctly back to my Javascript, but I still can&#39;t do anything with the data -- I can&#39;t extract something like alert(text.d[0].xCoord);"}, {"owner": {"reputation": 511, "user_id": 3684165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924fac79a635e4a368c4a40bd5c95977?s=128&d=identicon&r=PG&f=1", "display_name": "lujcon", "link": "https://stackoverflow.com/users/3684165/lujcon"}, "reply_to_user": {"reputation": 167, "user_id": 1135567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7fd985934008e66542d067f19c5c9fc9?s=128&d=identicon&r=PG&f=1", "display_name": "btalbot", "link": "https://stackoverflow.com/users/1135567/btalbot"}, "edited": false, "score": 0, "creation_date": 1423687654, "post_id": 28463937, "comment_id": 45254047, "body": "?? What data are you getting back??"}, {"owner": {"reputation": 167, "user_id": 1135567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7fd985934008e66542d067f19c5c9fc9?s=128&d=identicon&r=PG&f=1", "display_name": "btalbot", "link": "https://stackoverflow.com/users/1135567/btalbot"}, "edited": false, "score": 0, "creation_date": 1423687671, "post_id": 28463937, "comment_id": 45254056, "body": "I don&#39;t know who downvoted this, but it doesn&#39;t deserve it. It has actually helped make the JSON return so I can correctly turn it into a Javascript variable. I am almost there."}, {"owner": {"reputation": 167, "user_id": 1135567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7fd985934008e66542d067f19c5c9fc9?s=128&d=identicon&r=PG&f=1", "display_name": "btalbot", "link": "https://stackoverflow.com/users/1135567/btalbot"}, "edited": false, "score": 0, "creation_date": 1423688327, "post_id": 28463937, "comment_id": 45254432, "body": "Problem solved thanks to this answer and @JustinRusso. I have made a community Wiki answer and upvoted yours."}, {"owner": {"reputation": 511, "user_id": 3684165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924fac79a635e4a368c4a40bd5c95977?s=128&d=identicon&r=PG&f=1", "display_name": "lujcon", "link": "https://stackoverflow.com/users/3684165/lujcon"}, "reply_to_user": {"reputation": 167, "user_id": 1135567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7fd985934008e66542d067f19c5c9fc9?s=128&d=identicon&r=PG&f=1", "display_name": "btalbot", "link": "https://stackoverflow.com/users/1135567/btalbot"}, "edited": false, "score": 0, "creation_date": 1423688784, "post_id": 28463937, "comment_id": 45254647, "body": "I&#39;ve just modified my answer - but looks that I&#39;m wrong with the javascript part... MS serialization surprises me all the time ;)"}], "tags": [], "owner": {"reputation": 511, "user_id": 3684165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/924fac79a635e4a368c4a40bd5c95977?s=128&d=identicon&r=PG&f=1", "display_name": "lujcon", "link": "https://stackoverflow.com/users/3684165/lujcon"}, "is_accepted": false, "score": 0, "last_activity_date": 1423689077, "last_edit_date": 1423689077, "creation_date": 1423686768, "answer_id": 28463937, "question_id": 28463622, "link": "https://stackoverflow.com/questions/28463622/why-cant-i-use-my-json-data/28463937#28463937", "title": "Why can&#39;t I use my JSON data?", "body": "<pre><code>[WebMethod]\n[ScriptMethod]\npublic static Dictionary&lt;string, object&gt;[] GetCoords()\n{\n    DataTable dt = new DataTable();\n    using (SqlConnection con = new SqlConnection(connectionString))\n    {\n        using (SqlCommand cmd = new SqlCommand(\"SELECT TOP 10 * FROM DRAW ORDER BY DrawID DESC;\", con))\n        {\n            con.Open();\n            SqlDataAdapter da = new SqlDataAdapter(cmd);\n            da.Fill(dt);\n            JavaScriptSerializer serializer = new JavaScriptSerializer();\n            List&lt;Dictionary&lt;string, object&gt;&gt; rows = new List&lt;Dictionary&lt;string, object&gt;&gt;();\n            Dictionary&lt;string, object&gt; row;\n            foreach (DataRow dr in dt.Rows)\n            {\n                row = new Dictionary&lt;string, object&gt;();\n                foreach (DataColumn col in dt.Columns)\n                {\n                    row.Add(col.ColumnName, dr[col]);\n                }\n                rows.Add(row);\n            }\n            System.Diagnostics.Debug.WriteLine(serializer.Serialize(rows));\n            return rows.ToArray();                \n        }\n    }\n}\n</code></pre>\n\n<p>Java script:</p>\n\n<pre><code>         $.ajax({\n            type: 'POST',\n            cache: false,\n            url: 'Default.aspx/GetCoords',\n            data: \"{}\",\n            contentType: 'application/json; charset=utf-8',\n            dataType: 'json',\n            success: function (data) {\n\n                $.each(data, function(index, value) {\n                    var x = value.xCoord;\n                    /// do something with it ;)\n                });\n                var text = JSON.stringify(data);\n                $(\"#jsonData\").html(text);\n                alert(text);\n            },\n            error: function (xhr, ajaxOptions, thrownError) {\n                alert(xhr.status);\n                alert(thrownError);\n            }\n        });\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167, "user_id": 1135567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7fd985934008e66542d067f19c5c9fc9?s=128&d=identicon&r=PG&f=1", "display_name": "btalbot", "link": "https://stackoverflow.com/users/1135567/btalbot"}, "is_accepted": false, "score": 0, "last_activity_date": 1423688479, "creation_date": 1423688479, "answer_id": 28464414, "question_id": 28463622, "link": "https://stackoverflow.com/questions/28463622/why-cant-i-use-my-json-data/28464414#28464414", "title": "Why can&#39;t I use my JSON data?", "body": "<p>I had to return rows in my C# code as @lujcon said: </p>\n\n<pre><code>[WebMethod]\n[ScriptMethod]\npublic static List&lt;Dictionary&lt;string, object&gt;&gt; GetCoords()\n{\n    DataTable dt = new DataTable();\n    using (SqlConnection con = new SqlConnection(connectionString))\n    {\n        using (SqlCommand cmd = new SqlCommand(\"SELECT TOP 10 * FROM DRAW ORDER BY DrawID DESC;\", con))\n        {\n            con.Open();\n            SqlDataAdapter da = new SqlDataAdapter(cmd);\n            da.Fill(dt);\n            JavaScriptSerializer serializer = new JavaScriptSerializer();\n            List&lt;Dictionary&lt;string, object&gt;&gt; rows = new List&lt;Dictionary&lt;string, object&gt;&gt;();\n            Dictionary&lt;string, object&gt; row;\n            foreach (DataRow dr in dt.Rows)\n            {\n                row = new Dictionary&lt;string, object&gt;();\n                foreach (DataColumn col in dt.Columns)\n                {\n                    row.Add(col.ColumnName, dr[col]);\n                }\n                rows.Add(row);\n            }\n            System.Diagnostics.Debug.WriteLine(serializer.Serialize(rows));\n            return rows;                \n        }\n    }\n}\n</code></pre>\n\n<p>Then I had to change my <code>var text = JSON.stringify(data);</code> to var text = <code>JSON.stringify(data.d);</code> as @JustinRusso said. Works now. Thanks, everyone.</p>\n"}], "owner": {"reputation": 167, "user_id": 1135567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7fd985934008e66542d067f19c5c9fc9?s=128&d=identicon&r=PG&f=1", "display_name": "btalbot", "link": "https://stackoverflow.com/users/1135567/btalbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 28463860, "answer_count": 4, "score": 0, "last_activity_date": 1423689077, "creation_date": 1423685617, "question_id": 28463622, "link": "https://stackoverflow.com/questions/28463622/why-cant-i-use-my-json-data", "title": "Why can&#39;t I use my JSON data?", "body": "<p>I am trying to read some JSON data from an AJAX function. Here is the AJAX I am using: </p>\n\n<pre><code>             $.ajax({\n                type: 'POST',\n                cache: false,\n                url: 'Default.aspx/GetCoords',\n                data: \"{}\",\n                contentType: 'application/json; charset=utf-8',\n                dataType: 'json',\n                success: function (data) {\n                    var text = JSON.stringify(data);\n                    $(\"#jsonData\").html(text);\n                    alert(text);\n                },\n                error: function (xhr, ajaxOptions, thrownError) {\n                    alert(xhr.status);\n                    alert(thrownError);\n                }\n            });\n</code></pre>\n\n<p>I also have use JSON.parse in place of stringify, and objects return undefined or not at all. This comes from a C# function which looks like this: </p>\n\n<pre><code>    [WebMethod]\n    [ScriptMethod]\n    public static string GetCoords()\n    {\n        DataTable dt = new DataTable();\n        using (SqlConnection con = new SqlConnection(connectionString))\n        {\n            using (SqlCommand cmd = new SqlCommand(\"SELECT TOP 10 * FROM DRAW ORDER BY DrawID DESC;\", con))\n            {\n                con.Open();\n                SqlDataAdapter da = new SqlDataAdapter(cmd);\n                da.Fill(dt);\n                JavaScriptSerializer serializer = new JavaScriptSerializer();\n                List&lt;Dictionary&lt;string, object&gt;&gt; rows = new List&lt;Dictionary&lt;string, object&gt;&gt;();\n                Dictionary&lt;string, object&gt; row;\n                foreach (DataRow dr in dt.Rows)\n                {\n                    row = new Dictionary&lt;string, object&gt;();\n                    foreach (DataColumn col in dt.Columns)\n                    {\n                        row.Add(col.ColumnName, dr[col]);\n                    }\n                    rows.Add(row);\n                }\n                System.Diagnostics.Debug.WriteLine(serializer.Serialize(rows));\n                return serializer.Serialize(rows);                \n            }\n        }\n    }\n</code></pre>\n\n<p>It is returning JSON data: Here is what it looks like on the Debugger Console and when I call the function in a paragraph tag: </p>\n\n<pre><code>[{\"DrawID\":925,\"xCoord\":466,\"yCoord\":201},{\"DrawID\":924,\"xCoord\":385,\"yCoord\":318},{\"DrawID\":923,\"xCoord\":768,\"yCoord\":159},{\"DrawID\":922,\"xCoord\":543,\"yCoord\":214},{\"DrawID\":921,\"xCoord\":329,\"yCoord\":172}]\n</code></pre>\n\n<p>However, when I send it to the paragraph tag in JQuery or call it in an HTML paragraph, here is what it looks like: </p>\n\n<pre><code>{\"d\":\"[{\\\"DrawID\\\":925,\\\"xCoord\\\":466,\\\"yCoord\\\":201},{\\\"DrawID\\\":924,\\\"xCoord\\\":385,\\\"yCoord\\\":318},{\\\"DrawID\\\":923,\\\"xCoord\\\":768,\\\"yCoord\\\":159},{\\\"DrawID\\\":922,\\\"xCoord\\\":543,\\\"yCoord\\\":214},{\\\"DrawID\\\":921,\\\"xCoord\\\":329,\\\"yCoord\\\":172}]\"}\n</code></pre>\n\n<p>I have two questions: \n(1) Why am I not able to use this data to insert the xCoords and yCoords into a canvas? I have tried many formats: (data.d[0].xCoord, d[0].xCoord, text.d[0].xCoord, text[0].xCoord, and so on).\n(2) Is the second format above going to be a problem in trying to extract that data for painting on the canvas (it's the backslashes that I am wondering about)?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "xml", "asp.net-web-api", "deserialization"], "answers": [{"comments": [{"owner": {"reputation": 4910, "user_id": 896697, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54961255558784dffca95db840c2c6d2?s=128&d=identicon&r=PG", "display_name": "Jochen van Wylick", "link": "https://stackoverflow.com/users/896697/jochen-van-wylick"}, "edited": false, "score": 1, "creation_date": 1423685959, "post_id": 28463690, "comment_id": 45253121, "body": "Also - I think the datacontract with name goes over the Geo inside the result. A shortcut for this kind of stuff is to use a tool that generates the XSD from the XML and then classes from the XSD for you. XSD.exe does this for you."}, {"owner": {"reputation": 3828, "user_id": 162607, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d183c684b6ecb523155506e16c35b41c?s=128&d=identicon&r=PG", "display_name": "IbrarMumtaz", "link": "https://stackoverflow.com/users/162607/ibrarmumtaz"}, "edited": false, "score": 0, "creation_date": 1423686504, "post_id": 28463690, "comment_id": 45253420, "body": "Thanks, made some changes but right now its not throwing exceptions but now Geo is Null. I hope this is not an ordering thing. As its a public free to use API so hopefully someone will know how to get it to work properly."}, {"owner": {"reputation": 5023, "user_id": 10156, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d997169a951f335eecd6bf66921e80aa?s=128&d=identicon&r=PG", "display_name": "Steve Mitcham", "link": "https://stackoverflow.com/users/10156/steve-mitcham"}, "edited": false, "score": 0, "creation_date": 1423688826, "post_id": 28463690, "comment_id": 45254664, "body": "I don&#39;t have access to that web site, but I loaded this into a memory stream and passed it through a <code>DataContractSerializer</code> and it deserialized correctly. So maybe it&#39;s something in the way the deserializer is configured in the <code>HttpClient</code>?"}], "tags": [], "owner": {"reputation": 2009, "user_id": 1353677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GxDPi.jpg?s=128&g=1", "display_name": "nXu", "link": "https://stackoverflow.com/users/1353677/nxu"}, "is_accepted": false, "score": 2, "last_activity_date": 1423685845, "creation_date": 1423685845, "answer_id": 28463690, "question_id": 28463605, "link": "https://stackoverflow.com/questions/28463605/deserialize-xml-rest-webapi-call/28463690#28463690", "title": "Deserialize XML Rest WebApi Call?", "body": "<p><code>public string Geo</code> is supposed to be <code>public Geo Geo</code>, isn't it?</p>\n"}, {"comments": [{"owner": {"reputation": 3828, "user_id": 162607, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d183c684b6ecb523155506e16c35b41c?s=128&d=identicon&r=PG", "display_name": "IbrarMumtaz", "link": "https://stackoverflow.com/users/162607/ibrarmumtaz"}, "edited": false, "score": 0, "creation_date": 1423691387, "post_id": 28464882, "comment_id": 45256031, "body": "See thing is, its a public API, so i don&#39;t know the explicit order so defining one in code is pure guess work. As in doing so, the properties are simply set to null."}, {"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "reply_to_user": {"reputation": 3828, "user_id": 162607, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d183c684b6ecb523155506e16c35b41c?s=128&d=identicon&r=PG", "display_name": "IbrarMumtaz", "link": "https://stackoverflow.com/users/162607/ibrarmumtaz"}, "edited": false, "score": 2, "creation_date": 1423691510, "post_id": 28464882, "comment_id": 45256095, "body": "A public API <i>better</i> publish a schema definition."}], "tags": [], "owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "is_accepted": false, "score": 3, "last_activity_date": 1423691360, "last_edit_date": 1423691360, "creation_date": 1423690197, "answer_id": 28464882, "question_id": 28463605, "link": "https://stackoverflow.com/questions/28463605/deserialize-xml-rest-webapi-call/28464882#28464882", "title": "Deserialize XML Rest WebApi Call?", "body": "<p>This <em>is</em> an ordering thing, but it's one you can work around with your definition of <code>Result</code>. <code>DataContractSerializer</code>, unless told otherwise, expects elements to be in alphabetical order, not the order defined in the class. But, you can use the <code>Order</code> property of <code>DataMember</code> to explicitly tell it in what order to expect and emit elements.</p>\n\n<p>Changing your definition of <code>Result</code> to</p>\n\n<pre><code>[DataContract(Name = \"result\", Namespace = \"\")]\npublic class Result\n{\n    [DataMember(Name = \"postcode\", Order = 1)]\n    public string Postcode { get; set; }\n\n    [DataMember(Name = \"geo\", Order = 2)]\n    public Geo Geo { get; set; }\n}\n</code></pre>\n\n<p>should fix your issue. You can refer to <a href=\"https://msdn.microsoft.com/en-us/library/ms729813%28v=vs.110%29.aspx\" rel=\"nofollow\">MSDN</a> for a more complete description of ordering semantics in data contracts.</p>\n\n<p>As per @LouieBacaj's answer, you will also need to add the empty namespace to your <code>Geo</code> class to correctly deserialze the nested element:</p>\n\n<pre><code>[DataContract(Name = \"geo\", Namespace = \"\")]\npublic class Geo\n{\n    [DataMember(Name = \"lat\")]\n    public string Lat { get; set; }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1423691022, "post_id": 28465022, "comment_id": 45255825, "body": "The namespace of <code>Geo</code> doesn&#39;t matter here because it&#39;s not the root element of the document, nor does the ordering of <code>lat</code> (at least, not yet) since it&#39;s the only element he&#39;s deserializing."}, {"owner": {"reputation": 1319, "user_id": 1052079, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qwn5R.jpg?s=128&g=1", "display_name": "Louie Bacaj", "link": "https://stackoverflow.com/users/1052079/louie-bacaj"}, "reply_to_user": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1423691070, "post_id": 28465022, "comment_id": 45255845, "body": "If you take them out it wont work... try it... at least the namespacing needs to be provided for sure because of the way that xml is formatted..."}, {"owner": {"reputation": 3828, "user_id": 162607, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d183c684b6ecb523155506e16c35b41c?s=128&d=identicon&r=PG", "display_name": "IbrarMumtaz", "link": "https://stackoverflow.com/users/162607/ibrarmumtaz"}, "edited": false, "score": 0, "creation_date": 1423691142, "post_id": 28465022, "comment_id": 45255880, "body": "Well i added in the NS and I got:  Error in line 1 position 9. Expecting element &#39;result&#39; from namespace &#39;<a href=\"http://schemas.datacontract.org/2004/07/RiskChecker.Lib\" rel=\"nofollow noreferrer\">schemas.datacontract.org/2004/07/RiskChecker.Lib</a>&#39;.. Encountered &#39;Element&#39;  with name &#39;result&#39;, namespace &#39;&#39;.   Which make sense, as the elements are being received from the WebService without a namespace. So the Namespace can be omitted."}, {"owner": {"reputation": 1319, "user_id": 1052079, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qwn5R.jpg?s=128&g=1", "display_name": "Louie Bacaj", "link": "https://stackoverflow.com/users/1052079/louie-bacaj"}, "edited": false, "score": 0, "creation_date": 1423691150, "post_id": 28465022, "comment_id": 45255885, "body": "I just tried it myself and definitely fails on the namespacing missing on GEO"}, {"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1423691174, "post_id": 28465022, "comment_id": 45255906, "body": "I derped my last comment, I didn&#39;t realize I had added the empty namespace too."}, {"owner": {"reputation": 2009, "user_id": 1353677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GxDPi.jpg?s=128&g=1", "display_name": "nXu", "link": "https://stackoverflow.com/users/1353677/nxu"}, "edited": false, "score": 0, "creation_date": 1423691305, "post_id": 28465022, "comment_id": 45255977, "body": "It&#39;s a shame that you have to define the order of the XML elements to correctly parse them... This works though, correct answer"}, {"owner": {"reputation": 3828, "user_id": 162607, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d183c684b6ecb523155506e16c35b41c?s=128&d=identicon&r=PG", "display_name": "IbrarMumtaz", "link": "https://stackoverflow.com/users/162607/ibrarmumtaz"}, "edited": false, "score": 0, "creation_date": 1423691546, "post_id": 28465022, "comment_id": 45256119, "body": "Thanks, that works now. Was the simplest thing ever!"}], "tags": [], "owner": {"reputation": 1319, "user_id": 1052079, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qwn5R.jpg?s=128&g=1", "display_name": "Louie Bacaj", "link": "https://stackoverflow.com/users/1052079/louie-bacaj"}, "is_accepted": true, "score": 5, "last_activity_date": 1423690792, "creation_date": 1423690792, "answer_id": 28465022, "question_id": 28463605, "link": "https://stackoverflow.com/questions/28463605/deserialize-xml-rest-webapi-call/28465022#28465022", "title": "Deserialize XML Rest WebApi Call?", "body": "<p>There are two problems that I see. One is with the ordering and another is with namespace.</p>\n\n<p>You need to specify the order on all of your properties and objects but you also need to specify the namespace on all of them.</p>\n\n<pre><code>    [DataContract(Name = \"result\", Namespace = \"\")]\n    public class Result\n    {\n        [DataMember(Name = \"postcode\", Order = 1)]\n        public string Postcode { get; set; }\n\n        [DataMember(Name = \"geo\", Order = 2)]\n        public Geo Geo { get; set; }\n    }\n</code></pre>\n\n<p>Likewise on your GEO object you have to specify both for the mapping to work on the HttpClient.</p>\n\n<pre><code>    [DataContract(Name = \"geo\", Namespace = \"\")]\n    public class Geo\n    {\n        [DataMember(Name = \"lat\", Order = 1)]\n        public string Lat { get; set; }\n    }\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 3828, "user_id": 162607, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d183c684b6ecb523155506e16c35b41c?s=128&d=identicon&r=PG", "display_name": "IbrarMumtaz", "link": "https://stackoverflow.com/users/162607/ibrarmumtaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2370, "favorite_count": 0, "accepted_answer_id": 28465022, "answer_count": 3, "score": 2, "last_activity_date": 1423691360, "creation_date": 1423685570, "last_edit_date": 1423687195, "question_id": 28463605, "link": "https://stackoverflow.com/questions/28463605/deserialize-xml-rest-webapi-call", "title": "Deserialize XML Rest WebApi Call?", "body": "<p>I have been following some online examples and for some reason I cannot successfully deserialize the following XML document:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;result&gt;\n    &lt;postcode&gt;BD1 1LT&lt;/postcode&gt;\n    &lt;geo&gt;\n        &lt;lat&gt;53.793063240118215&lt;/lat&gt;\n        &lt;lng&gt;-1.7540318423563699&lt;/lng&gt;\n        &lt;easting&gt;416300.0&lt;/easting&gt;\n        &lt;northing&gt;433000.0&lt;/northing&gt;\n        &lt;geohash&gt;http://geohash.org/gcwf00dz21g1&lt;/geohash&gt;\n    &lt;/geo&gt;\n    &lt;administrative&gt;\n        &lt;council&gt;\n            &lt;title&gt;Bradford&lt;/title&gt;\n            &lt;uri&gt;http://statistics.data.gov.uk/id/statistical-geography/E08000032&lt;/uri&gt;\n            &lt;code&gt;E08000032&lt;/code&gt;\n        &lt;/council&gt;\n        &lt;ward&gt;\n            &lt;title&gt;City&lt;/title&gt;\n            &lt;uri&gt;http://statistics.data.gov.uk/id/statistical-geography/E05001347&lt;/uri&gt;\n            &lt;code&gt;E05001347&lt;/code&gt;\n        &lt;/ward&gt;\n        &lt;constituency&gt;\n            &lt;title&gt;Bradford West&lt;/title&gt;\n            &lt;uri&gt;http://statistics.data.gov.uk/id/statistical-geography/E14000589&lt;/uri&gt;\n            &lt;code&gt;E14000589&lt;/code&gt;\n        &lt;/constituency&gt;\n    &lt;/administrative&gt;\n&lt;/result&gt;\n</code></pre>\n\n<p>I've tried all sorts of combinations:</p>\n\n<pre><code>[DataContract(Name = \"result\", Namespace = \"\")]\npublic class Result\n{\n    [DataMember(Name = \"postcode\")]\n    public string Postcode { get; set; }\n    [DataMember(Name = \"geo\")]\n    public Geo Geo { get; set; } \n}\n\n[DataContract(Name = \"geo\")]\npublic class Geo\n{\n    [DataMember(Name = \"lat\")]\n    public string Lat { get; set; } \n}\n</code></pre>\n\n<p>But all I can get is the post code and nothing else. <em>Above</em> <em>is what I have</em> <em>working atm</em>.</p>\n\n<p>Below is what I have put together following some examples:</p>\n\n<pre><code>    [Test]\n    public void TestRestCall()\n    {\n        var url = \"http://uk-postcodes.com/postcode/\";\n        var urlParameters = \"bd11lt.xml\";\n        var client = new HttpClient();\n        client.BaseAddress = new Uri(url);\n\n        // Add an Accept header for JSON format.\n        client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(\"application/xml\"));\n\n        // List data response.\n        HttpResponseMessage response = client.GetAsync(urlParameters).Result;  // Blocking call!\n        if (response.IsSuccessStatusCode)\n        {\n            // Parse the response body. Blocking!\n            var dataObjects = response.Content.ReadAsAsync&lt;Result&gt;().Result;\n            //Console.WriteLine(\"{0}\", dataObjects.Geo.);\n        }\n        else\n        {\n            Console.WriteLine(\"{0} ({1})\", (int)response.StatusCode, response.ReasonPhrase);\n        } \n    }\n</code></pre>\n\n<p><strong><em>UPDATE:</em></strong></p>\n\n<p>The Geo property is null and that's as far as I can get with this.</p>\n"}, {"tags": ["c#", "wpf", "xaml", "listview", "collectionviewsource"], "answers": [{"tags": [], "owner": {"reputation": 4984, "user_id": 3258812, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/K7rJi.jpg?s=128&g=1", "display_name": "Ayyappan Subramanian", "link": "https://stackoverflow.com/users/3258812/ayyappan-subramanian"}, "is_accepted": true, "score": 2, "last_activity_date": 1423685898, "creation_date": 1423685898, "answer_id": 28463704, "question_id": 28463577, "link": "https://stackoverflow.com/questions/28463577/adding-records-to-a-collectionviewsource-resource-not-showing-up-in-a-bound-lis/28463704#28463704", "title": "Adding records to a CollectionViewSource resource, not showing up in a bound ListView", "body": "<p>Use ObservableCollection Instead of List, Because it will notify the UI about the source change. <a href=\"https://msdn.microsoft.com/en-us/library/ms668604(v=vs.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms668604(v=vs.110).aspx</a></p>\n\n<pre><code> myCacheSrc = (CollectionViewSource)FindResource(\"myCacheSrc\");\n        myCacheSrc.Source = new ObservableCollection&lt;MyEFPOCO&gt;();\n</code></pre>\n"}], "owner": {"reputation": 13888, "user_id": 469319, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HfDJ2.png?s=128&g=1", "display_name": "RLH", "link": "https://stackoverflow.com/users/469319/rlh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 1, "accepted_answer_id": 28463704, "answer_count": 1, "score": 0, "last_activity_date": 1423685898, "creation_date": 1423685481, "question_id": 28463577, "link": "https://stackoverflow.com/questions/28463577/adding-records-to-a-collectionviewsource-resource-not-showing-up-in-a-bound-lis", "title": "Adding records to a CollectionViewSource resource, not showing up in a bound ListView", "body": "<p>First, this is my first attempt at using WPF.  I'll try to spare as much information as possible, since this data-entry form is a little less than typical.  However, if more information is needed, please ask.</p>\n\n<p>I have a WPF window with a series of <code>CollectionViewSource</code> objects in my <code>Window.Resources</code> collection.  These are initialized in my window's constructor.</p>\n\n<p>One of these collections is an <code>IList&lt;T&gt;</code> where <code>T</code> is of a POCO type used with Entity Framework.</p>\n\n<p>My form has a section of user-input controls.  When the user hits the <code>Save</code> button, I need to create an entity and add it to my <code>IList</code> collection.</p>\n\n<p>So far, I've had no trouble.  I can create the entity, and I can add it to the collection without any issue.  However, the problem is that I have a <code>ListView</code> control that is bound to this collection.  I can, and have verified, that I can load records to this list <em>when the Window initializes in the constructor</em>.  However, when I click my <code>Save</code> button, the collection gets updated, but the UI does not refresh the operation.</p>\n\n<p>For reference, here is the pertinent code below.</p>\n\n<p><strong>SetResource() - Called in the constructor of my Window</strong></p>\n\n<pre><code>    private void SetResources()\n    {\n        ... other objects...\n\n        //myCacheSrc is property defined in my Window.cs file.\n        myCacheSrc = (CollectionViewSource)FindResource(\"myCacheSrc\");\n        myCacheSrc.Source = new List&lt;MyEFPOCO&gt;();\n\n        ... more initializations of other objects.\n    }\n</code></pre>\n\n<p><strong>Contents of my Save button click event</strong></p>\n\n<pre><code>    private void Save_Click(object sender, RoutedEventArgs e)\n    {\n        var cache = myCacheSrc.Source as List&lt;MyEFPOCO&gt;;\n        if (cache != null &amp;&amp; !CurrentRecord.Equals(origCurrentRecord))\n        {\n            cache.Add(CurrentRecord);\n        }\n    }\n</code></pre>\n\n<p>It is worth mentioning, I've stepped through the above block of code.  It is executing on the save event, and the <code>CurrentRecord</code> property does contain a valid entity.</p>\n\n<p>Here is a my Window constructor.  Notice that there is a test insert operation.  This works!  Note, it's not much different than the code in my button event.  Why would this work, and not the button event?</p>\n\n<p><strong>Window Constructor</strong></p>\n\n<pre><code>    public MyWindow()\n    {\n        InitializeComponent();\n        SetResources();\n\n        //TEST\n        var cache = myCacheSrc.Source as List&lt;MyEFPOCO&gt;;\n        if (cache != null)\n        {\n            cache.Add(new MyEFPOCO\n                { \n                    userEntryType = \"TEST\",\n                    numberValue= 1234567\n                });\n        }\n    }\n</code></pre>\n\n<p><strong>MyWindow.xaml - Declaration of the ListView in question</strong></p>\n\n<pre><code>        &lt;ListView Name=\"CachedChangesList\" ItemsSource=\"{Binding Source={StaticResource myCacheSrc}}\"&gt;\n            &lt;ListView.ItemTemplate&gt;\n                &lt;DataTemplate&gt;\n                    &lt;DockPanel&gt;\n                        &lt;Button Name=\"UpdateChange\" Content=\"{StaticResource iUpdate}\" Width=\"20\" /&gt;\n                        &lt;Button Name=\"DeleteChange\" Content=\"{StaticResource iDelete}\" Width=\"20\" /&gt;\n                        &lt;Label Content=\"{Binding userEntryType}\" /&gt;\n                        &lt;Label Content=\"{Binding numberValue}\" /&gt;\n                    &lt;/DockPanel&gt;\n                &lt;/DataTemplate&gt;\n            &lt;/ListView.ItemTemplate&gt;\n        &lt;/ListView&gt;\n</code></pre>\n"}, {"tags": ["c#", "datatable", "delete-row", "import-from-excel"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1423685396, "post_id": 28463495, "comment_id": 45252827, "body": "Do you want to delete the rows form the source workbook or just not show them in the datatable?  How are you reading from excel?"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1423685548, "post_id": 28463495, "comment_id": 45252909, "body": "can you not implement the <code>Select()</code> Method of the DataTable to filter down and perhaps populate a DataTable from there..? also <code>IN SQL Server</code> Your syntax is incorrect.. it&#39;s <code>DELETE [FROM TABLE NAME] WHERE Clause</code>"}, {"owner": {"reputation": 35, "user_id": 2133951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d9334dc3d443533c0ab82cb4122bfa?s=128&d=identicon&r=PG", "display_name": "stphnlwlsh", "link": "https://stackoverflow.com/users/2133951/stphnlwlsh"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1423686873, "post_id": 28463495, "comment_id": 45253614, "body": "@DStanley really I just want them to not be in the datatable."}], "answers": [{"tags": [], "owner": {"reputation": 5012, "user_id": 3845456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEWf8.jpg?s=128&g=1", "display_name": "DrewJordan", "link": "https://stackoverflow.com/users/3845456/drewjordan"}, "is_accepted": true, "score": 4, "last_activity_date": 1423686814, "creation_date": 1423686814, "answer_id": 28463947, "question_id": 28463495, "link": "https://stackoverflow.com/questions/28463495/delete-rows-from-datatable-at-once-without-loop-where-a-column-has-null-value/28463947#28463947", "title": "Delete rows from DataTable at once without loop where a column has Null value", "body": "<p>How about creating a new, clean DataTable from your first one? </p>\n\n<pre><code>DataTable t = new DataTable(); //actually your existing one with bad records\nDataTable newTable = t.Select().Where(x =&gt; !x.IsNull(0)).CopyToDataTable();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2124, "user_id": 504661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nh1h1.jpg?s=128&g=1", "display_name": "Justin Russo", "link": "https://stackoverflow.com/users/504661/justin-russo"}, "is_accepted": false, "score": 0, "last_activity_date": 1423686901, "creation_date": 1423686901, "answer_id": 28463981, "question_id": 28463495, "link": "https://stackoverflow.com/questions/28463495/delete-rows-from-datatable-at-once-without-loop-where-a-column-has-null-value/28463981#28463981", "title": "Delete rows from DataTable at once without loop where a column has Null value", "body": "<p>Just use Linq...</p>\n\n<pre><code>var newData = (from d in DataTable //this would be your datatable. \n              where d.columnA != NULL\n              select d.*).CopyToDataTable&lt;DataRow&gt;();\n</code></pre>\n\n<p>Then just use your newData variable, which holds your newly populated datatable.  </p>\n"}], "owner": {"reputation": 35, "user_id": 2133951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d9334dc3d443533c0ab82cb4122bfa?s=128&d=identicon&r=PG", "display_name": "stphnlwlsh", "link": "https://stackoverflow.com/users/2133951/stphnlwlsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2233, "favorite_count": 0, "accepted_answer_id": 28463947, "answer_count": 2, "score": 1, "last_activity_date": 1481950700, "creation_date": 1423685204, "last_edit_date": 1481950700, "question_id": 28463495, "link": "https://stackoverflow.com/questions/28463495/delete-rows-from-datatable-at-once-without-loop-where-a-column-has-null-value", "title": "Delete rows from DataTable at once without loop where a column has Null value", "body": "<p>I'm populating a DataTable object from an Excel worksheet.  I'm not counting on the user entering data correctly, and I'd like to delete rows that have a null value in column A.  I've searched around quite a bit, and it looks like everyone is doing this with a for loop.  Here's the problem: 757,000 rows.  If data is not formatted properly that DataTable gets filled up with Excel's max of 1048575.  I don't need to check each value individually.  In SQL server you can write:</p>\n\n<p><code>DELETE table\n WHERE columnA IS NULL</code></p>\n\n<p>I considered excluding nulls on the DataTable fill, but I couldn't get this to work reliably as I don't know the name of column A until it's in the DataTable and sometimes the column name has a <code>\\n</code> character in the middle which throws syntax errors.</p>\n\n<p>How can I accomplish the same sort of thing without a loop?</p>\n"}, {"tags": ["c#", "wpf", "validation"], "comments": [{"owner": {"reputation": 2844, "user_id": 4518652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4659c2d7bcc959da83e923c47e5ec0f?s=128&d=identicon&r=PG&f=1", "display_name": "Vinkal", "link": "https://stackoverflow.com/users/4518652/vinkal"}, "edited": false, "score": 0, "creation_date": 1423686600, "post_id": 28463443, "comment_id": 45253474, "body": "Share more code here."}], "answers": [{"tags": [], "owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "is_accepted": false, "score": 0, "last_activity_date": 1423688180, "creation_date": 1423688180, "answer_id": 28464341, "question_id": 28463443, "link": "https://stackoverflow.com/questions/28463443/hide-wpf-validation-error-when-window-is-first-loaded/28464341#28464341", "title": "Hide WPF validation error when window is first loaded", "body": "<p>save a flag for once you have any value</p>\n\n<pre><code>class ValidationTest : ValidationRule\n{\n    private int result;\n    private bool hadValue = false;\n    public override ValidationResult Validate(object value, CultureInfo cultureInfo)\n    {\n        if (hadValue  &amp;&amp; (value == null || string.IsNullOrEmpty(value.ToString())))\n        {\n            return new ValidationResult(false, \"Value cannot be empty.\");\n        }\n        if (value.ToString().Length &gt; 4)\n        {\n            hadValue = true;\n            return new ValidationResult(false, \"Name cannot be more than 20 characters long.\");\n        }\n        hadValue = true;\n        return ValidationResult.ValidResult;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7573, "user_id": 1601882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f4e8acebc2b429de1f513f4d03ba07b?s=128&d=identicon&r=PG", "display_name": "Andy Braham", "link": "https://stackoverflow.com/users/1601882/andy-braham"}, "is_accepted": false, "score": 1, "last_activity_date": 1508409342, "last_edit_date": 1508409342, "creation_date": 1508408344, "answer_id": 46827677, "question_id": 28463443, "link": "https://stackoverflow.com/questions/28463443/hide-wpf-validation-error-when-window-is-first-loaded/46827677#46827677", "title": "Hide WPF validation error when window is first loaded", "body": "<p>I know I am a little late to the party but I came across this question while I was looking to do the same thing. The only thing that I didn't like about using a flag to control when the Validation is performed is that you needed to set the <code>DoValidation</code> flag at some point in your code and I wanted it to be a little more \"Automated\".</p>\n\n<p>I found quite a few examples online but they all seemed to use the Boolean flag method. I found <a href=\"https://code.msdn.microsoft.com/windowsdesktop/Validation-in-MVVM-using-12dafef3\" rel=\"nofollow noreferrer\">this MSDN Article</a> and used it as a base then adjusted the code.</p>\n\n<p>I came up with a solution that seems to work really well. Basically in a nutshell what I did was instead of having one variable to keep track of when the validation should be performed I created another <code>Dictionary</code> to keep track of:</p>\n\n<ol>\n<li>When the Validation should be performed.</li>\n<li>Store the state of the Validation (Valid, Invalid).</li>\n</ol>\n\n<p>I only wanted the validation to be performed after the first update, so the first order of business is to decide if the Validation should be performed. The first run of the Validation stores the parameter in the <code>Dictionary</code>, then next time around if the parameter is present it performs the validation and stores a true/false (Invalid/Valid) result. This is also a handy way of telling both if the Model has been Validated and if it is valid, so I also added a parameter/flag to simply return if there are any results and the state of the validation. This is especially useful for binding the command enable/disable.</p>\n\n<p>Here is how I accomplished this:</p>\n\n<h2>Base PropertyValidation Model:</h2>\n\n<pre><code>public abstract class PropertyValidation : INotifyPropertyChanged, IDataErrorInfo\n{\n   #region Fields\n\n   private readonly Dictionary&lt;string, object&gt; _values = new Dictionary&lt;string, object&gt;();\n\n   /// &lt;summary&gt;\n   /// This holds the list of validation results and controls when the validation should be \n   /// performed and if the validation is valid.\n   /// &lt;/summary&gt;\n   private Dictionary&lt;string, bool&gt; _validationResults { get; set; } = new Dictionary&lt;string, bool&gt;();\n\n   #endregion\n\n   #region Protected\n\n   /// &lt;summary&gt;\n   /// Sets the value of a property.\n   /// &lt;/summary&gt;\n   /// &lt;typeparam name=\"T\"&gt;The type of the property value.&lt;/typeparam&gt;\n   /// &lt;param name=\"propertySelector\"&gt;Expression tree contains the property definition.&lt;/param&gt;\n   /// &lt;param name=\"value\"&gt;The property value.&lt;/param&gt;\n   protected void SetValue&lt;T&gt;(Expression&lt;Func&lt;T&gt;&gt; propertySelector, T value)\n   {\n      string propertyName = GetPropertyName(propertySelector);\n\n      SetValue&lt;T&gt;(propertyName, value);\n   }\n\n   /// &lt;summary&gt;\n   /// Sets the value of a property.\n   /// &lt;/summary&gt;\n   /// &lt;typeparam name=\"T\"&gt;The type of the property value.&lt;/typeparam&gt;\n   /// &lt;param name=\"propertyName\"&gt;The name of the property.&lt;/param&gt;\n   /// &lt;param name=\"value\"&gt;The property value.&lt;/param&gt;\n   protected void SetValue&lt;T&gt;(string propertyName, T value)\n   {\n      if (string.IsNullOrEmpty(propertyName))\n      {\n         throw new ArgumentException(\"Invalid property name\", propertyName);\n      }\n\n      _values[propertyName] = value;\n      OnPropertyChanged(propertyName);\n   }\n\n   /// &lt;summary&gt;\n   /// Gets the value of a property.\n   /// &lt;/summary&gt;\n   /// &lt;typeparam name=\"T\"&gt;The type of the property value.&lt;/typeparam&gt;\n   /// &lt;param name=\"propertySelector\"&gt;Expression tree contains the property definition.&lt;/param&gt;\n   /// &lt;returns&gt;The value of the property or default value if not exist.&lt;/returns&gt;\n   protected T GetValue&lt;T&gt;(Expression&lt;Func&lt;T&gt;&gt; propertySelector)\n   {\n      string propertyName = GetPropertyName(propertySelector);\n\n      return GetValue&lt;T&gt;(propertyName);\n   }\n\n   /// &lt;summary&gt;\n   /// Gets the value of a property.\n   /// &lt;/summary&gt;\n   /// &lt;typeparam name=\"T\"&gt;The type of the property value.&lt;/typeparam&gt;\n   /// &lt;param name=\"propertyName\"&gt;The name of the property.&lt;/param&gt;\n   /// &lt;returns&gt;The value of the property or default value if not exist.&lt;/returns&gt;\n   protected T GetValue&lt;T&gt;(string propertyName)\n   {\n      if (string.IsNullOrEmpty(propertyName))\n      {\n         throw new ArgumentException(\"Invalid property name\", propertyName);\n      }\n\n      object value;\n      if (!_values.TryGetValue(propertyName, out value))\n      {\n         value = default(T);\n         _values.Add(propertyName, value);\n      }\n\n      return (T)value;\n   }\n\n   /// &lt;summary&gt;\n   /// Validates current instance properties using Data Annotations.\n   /// &lt;/summary&gt;\n   /// &lt;param name=\"propertyName\"&gt;This instance property to validate.&lt;/param&gt;\n   /// &lt;returns&gt;Relevant error string on validation failure or &lt;see cref=\"System.String.Empty\"/&gt; on validation success.&lt;/returns&gt;\n   protected virtual string OnValidate(string propertyName)\n   {\n      string error = string.Empty;\n\n      if (string.IsNullOrEmpty(propertyName))\n      {\n         throw new ArgumentException(\"Invalid property name\", propertyName);\n      }\n\n      //Check if the Field has been added, this keeps track of when the validation\n      //is performed.\n      if (_validationResults.Any(x =&gt; x.Key == propertyName))\n      {\n         var value = GetValue(propertyName);\n         var results = new List&lt;System.ComponentModel.DataAnnotations.ValidationResult&gt;(1);\n         var result = Validator.TryValidateProperty(\n               value,\n               new ValidationContext(this, null, null)\n               {\n                  MemberName = propertyName\n               },\n               results);\n\n         if (!result)\n         {\n            var validationResult = results.First();\n            error = validationResult.ErrorMessage;\n\n            //Store a true result in the validation to set the error.\n            _validationResults[propertyName] = true;\n         }\n         else\n         {\n            //If the Validation has been run and not invalid make sure the \n            //paramter in the list is cleared, otherwise validation would \n            //always return invalid once it is invalidated.\n            _validationResults[propertyName] = false;\n         }\n      }\n      else\n      {\n         //This is the first run of the Validation, simply store the paramter\n         //in the validation list and wait until next time to validate.\n         _validationResults.Add(propertyName, true);\n      }\n\n      //Notify that things have changed\n      OnPropertyChanged(\"IsValid\");\n\n      //Return the actual result\n      return error;\n   }\n\n   #endregion\n\n   #region Public\n\n   /// &lt;summary&gt;\n   /// This returns if the Validation is Valid or not\n   /// &lt;/summary&gt;\n   /// &lt;returns&gt;True if the Validation has been perfomed and if there are not \n   /// true values. Will return false until the validation has been done once.&lt;/returns&gt;\n   public bool IsValid {\n      get { return (!_validationResults.Any(x =&gt; x.Value) &amp;&amp; (_validationResults.Count &gt; 0)); }\n   }\n\n   /// &lt;summary&gt;\n   /// Clears/Reset the Validation\n   /// &lt;/summary&gt;\n   public void ClearValidation()\n   {\n      _validationResults.Clear();\n   }\n\n   #endregion\n\n   #region Change Notification\n\n   /// &lt;summary&gt;\n   /// Raised when a property on this object has a new value.\n   /// &lt;/summary&gt;\n   public event PropertyChangedEventHandler PropertyChanged;\n\n   /// &lt;summary&gt;\n   /// Raises this object's PropertyChanged event.\n   /// &lt;/summary&gt;\n   /// &lt;param name=\"propertyName\"&gt;The property that has a new value.&lt;/param&gt;\n   protected void OnPropertyChanged([CallerMemberName] string propertyName = null)\n   {\n      this.VerifyPropertyName(propertyName);\n\n      PropertyChangedEventHandler handler = this.PropertyChanged;\n      if (handler != null)\n      {\n         var e = new PropertyChangedEventArgs(propertyName);\n         handler(this, e);\n      }\n   }\n\n   protected void OnPropertyChanged&lt;T&gt;(Expression&lt;Func&lt;T&gt;&gt; propertySelector)\n   {\n      var propertyChanged = PropertyChanged;\n      if (propertyChanged != null)\n      {\n         string propertyName = GetPropertyName(propertySelector);\n         propertyChanged(this, new PropertyChangedEventArgs(propertyName));\n      }\n   }\n\n   #endregion // IOnPropertyChanged Members\n\n   #region Data Validation\n\n   string IDataErrorInfo.Error {\n      get {\n         throw new NotSupportedException(\"IDataErrorInfo.Error is not supported, use IDataErrorInfo.this[propertyName] instead.\");\n      }\n   }\n\n   string IDataErrorInfo.this[string propertyName] {\n      get {\n         return OnValidate(propertyName);\n      }\n   }\n\n   #endregion\n\n   #region Privates\n\n   private string GetPropertyName(LambdaExpression expression)\n   {\n      var memberExpression = expression.Body as MemberExpression;\n      if (memberExpression == null)\n      {\n         throw new InvalidOperationException();\n      }\n\n      return memberExpression.Member.Name;\n   }\n\n   private object GetValue(string propertyName)\n   {\n      object value;\n      if (!_values.TryGetValue(propertyName, out value))\n      {\n         var propertyDescriptor = TypeDescriptor.GetProperties(GetType()).Find(propertyName, false);\n         if (propertyDescriptor == null)\n         {\n            throw new ArgumentException(\"Invalid property name\", propertyName);\n         }\n\n         value = propertyDescriptor.GetValue(this);\n         _values.Add(propertyName, value);\n      }\n\n      return value;\n   }\n\n   #endregion\n\n   #region Debugging\n\n   /// &lt;summary&gt;\n   /// Warns the developer if this object does not have\n   /// a public property with the specified name. This \n   /// method does not exist in a Release build.\n   /// &lt;/summary&gt;\n   [Conditional(\"DEBUG\")]\n   [DebuggerStepThrough]\n   public void VerifyPropertyName(string propertyName)\n   {\n      // Verify that the property name matches a real,  \n      // public, instance property on this object.\n      if (TypeDescriptor.GetProperties(this)[propertyName] == null)\n      {\n         string msg = \"Invalid property name: \" + propertyName;\n\n         if (this.ThrowOnInvalidPropertyName)\n            throw new Exception(msg);\n         else\n            Debug.Fail(msg);\n      }\n   }\n\n   /// &lt;summary&gt;\n   /// Returns whether an exception is thrown, or if a Debug.Fail() is used\n   /// when an invalid property name is passed to the VerifyPropertyName method.\n   /// The default value is false, but subclasses used by unit tests might \n   /// override this property's getter to return true.\n   /// &lt;/summary&gt;\n   protected virtual bool ThrowOnInvalidPropertyName { get; private set; }\n\n   #endregion // Debugging Aides\n}\n</code></pre>\n\n<h2>Model:</h2>\n\n<pre><code>public class MyModel : PropertyValidation\n{\n   [Required(ErrorMessage = \"Name must be specified\")]\n   [MaxLength(50, ErrorMessage = \"Name too long, Name cannot contain more than 50 characters\")]\n   public string Name {\n      get { return GetValue(() =&gt; Name); }\n      set { SetValue(() =&gt; Name, value); }\n   }\n\n   [Required(ErrorMessage = \"Description must be specified\")]\n   [MaxLength(150, ErrorMessage = \"Description too long, Description cannot contain more than 150 characters\")]\n   public string Description {\n      get { return GetValue(() =&gt; Description); }\n      set { SetValue(() =&gt; Description, value); }\n   }\n}\n</code></pre>\n\n<h2>Error Template:</h2>\n\n<pre><code>&lt;ControlTemplate x:Key=\"ValidationErrorTemplate\"&gt;\n   &lt;DockPanel LastChildFill=\"true\"&gt;\n      &lt;Border Background=\"Red\" DockPanel.Dock=\"right\" \n                           Margin=\"-20,0,0,0\" Width=\"10\" Height=\"10\" CornerRadius=\"10\"\n                           ToolTip=\"{Binding ElementName=customAdorner, Path=AdornedElement.(Validation.Errors)[0].ErrorContent}\"&gt;\n         &lt;TextBlock Text=\"!\" VerticalAlignment=\"center\" HorizontalAlignment=\"center\" FontWeight=\"Bold\" Foreground=\"white\"/&gt;\n      &lt;/Border&gt;\n      &lt;AdornedElementPlaceholder Name=\"customAdorner\" VerticalAlignment=\"Center\" &gt;\n         &lt;Border BorderBrush=\"red\" BorderThickness=\"1\" &gt;\n            &lt;Border.Effect&gt;\n               &lt;BlurEffect Radius=\"5\" /&gt;\n            &lt;/Border.Effect&gt;\n         &lt;/Border&gt;\n      &lt;/AdornedElementPlaceholder&gt;\n\n   &lt;/DockPanel&gt;\n&lt;/ControlTemplate&gt;\n</code></pre>\n\n<h2>Data Template/Form:</h2>\n\n<pre><code>&lt;DataTemplate x:Key=\"MyModelDetailsTemplate\" DataType=\"{x:Type data:MyModel}\" &gt;\n\n   &lt;StackPanel Grid.IsSharedSizeScope=\"True\"&gt;\n\n      &lt;Grid&gt;\n         &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"auto\" SharedSizeGroup=\"Labels\" /&gt;\n            &lt;ColumnDefinition Width=\"*\" /&gt;\n         &lt;/Grid.ColumnDefinitions&gt;\n\n         &lt;Label Grid.Column=\"0\"&gt;Name&lt;/Label&gt;\n         &lt;TextBox x:Name=\"Name\" \n                  Grid.Column=\"1\" \n                  MinWidth=\"150\"\n                  Validation.ErrorTemplate=\"{StaticResource ValidationErrorTemplate}\"\n                  Text=\"{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}\" /&gt;\n      &lt;/Grid&gt;\n      &lt;Grid&gt;\n         &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"auto\" SharedSizeGroup=\"Labels\" /&gt;\n            &lt;ColumnDefinition Width=\"*\" /&gt;\n         &lt;/Grid.ColumnDefinitions&gt;\n\n         &lt;Label Grid.Column=\"0\"&gt;Description&lt;/Label&gt;\n         &lt;TextBox Grid.Column=\"1\" \n                   Validation.ErrorTemplate=\"{StaticResource ValidationErrorTemplate}\"\n                  Text=\"{Binding Description, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, NotifyOnValidationError=True}\" AcceptsReturn=\"True\" VerticalAlignment=\"Stretch\" /&gt;\n\n      &lt;/Grid&gt;\n   &lt;/StackPanel&gt;\n\n&lt;/DataTemplate&gt;\n</code></pre>\n\n<h2>RelayCommand (For Completeness)</h2>\n\n<pre><code>public class RelayCommand : ICommand\n{\n   private Action&lt;object&gt; execute;\n\n   private Predicate&lt;object&gt; canExecute;\n\n   private event EventHandler CanExecuteChangedInternal;\n\n   public RelayCommand(Action&lt;object&gt; execute) : this(execute, DefaultCanExecute)\n   {\n   }\n\n   public RelayCommand(Action&lt;object&gt; execute, Predicate&lt;object&gt; canExecute)\n   {\n      if (execute == null)\n      {\n         throw new ArgumentNullException(\"execute\");\n      }\n\n      if (canExecute == null)\n      {\n         throw new ArgumentNullException(\"canExecute\");\n      }\n\n      this.execute = execute;\n      this.canExecute = canExecute;\n   }\n\n   public event EventHandler CanExecuteChanged {\n      add {\n         CommandManager.RequerySuggested += value;\n         this.CanExecuteChangedInternal += value;\n      }\n\n      remove {\n         CommandManager.RequerySuggested -= value;\n         this.CanExecuteChangedInternal -= value;\n      }\n   }\n\n   public bool CanExecute(object parameter)\n   {\n      return this.canExecute != null &amp;&amp; this.canExecute(parameter);\n   }\n\n   public void Execute(object parameter)\n   {\n      this.execute(parameter);\n   }\n\n   public void OnCanExecuteChanged()\n   {\n      EventHandler handler = this.CanExecuteChangedInternal;\n      if (handler != null)\n      {\n         //DispatcherHelper.BeginInvokeOnUIThread(() =&gt; handler.Invoke(this, EventArgs.Empty));\n         handler.Invoke(this, EventArgs.Empty);\n      }\n   }\n\n   public void Destroy()\n   {\n      this.canExecute = _ =&gt; false;\n      this.execute = _ =&gt; { return; };\n   }\n\n   private static bool DefaultCanExecute(object parameter)\n   {\n      return true;\n   }\n}\n</code></pre>\n\n<h2>ViewModel:</h2>\n\n<p>** Note the PropertyValidation here is not required, A separate INotifyPropertyChanged base could be used instead, I only used it for the OnPropertyChanged Notification and to keep things simple **</p>\n\n<pre><code>public class PageHomeVM : PropertyValidation\n{\n   private ICommand saveCommand;\n   public ICommand SaveCommand {\n      get {\n         return saveCommand;\n      }\n      set {\n         saveCommand = value;\n         OnPropertyChanged();\n      }\n   }\n\n   public MyModel MyModel { get; set; } = new MyModel();\n\n   public PageHomeVM()\n   {\n      SaveCommand = new RelayCommand(SaveRecord, p =&gt; MyModel.IsValid);\n      MyModel.ClearValidation();\n   }\n\n   public void SaveRecord(object p)\n   {\n      //Perform the save....\n   }\n}\n</code></pre>\n\n<h2>View:</h2>\n\n<pre><code>&lt;pages:BasePage.DataContext&gt;\n   &lt;ViewModels:PageHomeVM/&gt;\n&lt;/pages:BasePage.DataContext&gt;\n\n&lt;StackPanel&gt;\n   &lt;Label Content=\"MyModel Details\"/&gt;\n\n   &lt;ContentPresenter ContentTemplate=\"{StaticResource MyModelDetailsTemplate}\" Content=\"{Binding MyModel}\" /&gt;\n\n   &lt;Button x:Name=\"btnSave\" \n            Command=\"{Binding SaveCommand}\"\n            Width=\"75\"\n            HorizontalAlignment=\"Right\"&gt;Save&lt;/Button&gt;\n\n&lt;/StackPanel&gt;\n</code></pre>\n\n<p>I hope this helps...</p>\n"}], "owner": {"reputation": 57, "user_id": 2840120, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/98fab87b874c86743955d184373980de?s=128&d=identicon&r=PG&f=1", "display_name": "user2840120", "link": "https://stackoverflow.com/users/2840120/user2840120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2148, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1508409342, "creation_date": 1423685035, "last_edit_date": 1423690823, "question_id": 28463443, "link": "https://stackoverflow.com/questions/28463443/hide-wpf-validation-error-when-window-is-first-loaded", "title": "Hide WPF validation error when window is first loaded", "body": "<p>When i first load the window, the button is visible and there isn't an error in the validation (no red line round textbox). </p>\n\n<p><img src=\"https://i.imgur.com/pga6Hjv.png\" alt=\"what window looks like when first loaded\"></p>\n\n<p>When typing values into the textbox, the validation rules work as they should.</p>\n\n<p>I would like, if possible, to have the button hidden at the start, and for the validation rules to start when the I start typing text into the box.</p>\n\n<p>Here is the code that i have so far. The xaml:</p>\n\n<pre><code> &lt;TextBox x:Name=\"txtName\" HorizontalAlignment=\"Left\" Height=\"23\" Margin=\"156,119,0,0\" TextWrapping=\"Wrap\" VerticalAlignment=\"Top\" Width=\"120\" Validation.ErrorTemplate=\"{StaticResource ValidationErrorTemplate}\"&gt;\n        &lt;TextBox.Text&gt;\n            &lt;Binding Path=\"Name\" UpdateSourceTrigger=\"PropertyChanged\" NotifyOnSourceUpdated=\"True\"&gt;\n                &lt;Binding.ValidationRules&gt;\n                    &lt;local:ValidationTest/&gt;\n                &lt;/Binding.ValidationRules&gt;\n            &lt;/Binding&gt;\n        &lt;/TextBox.Text&gt;\n    &lt;/TextBox&gt;\n\n\n    &lt;Button x:Name=\"btn1\" Content=\"Button\" HorizontalAlignment=\"Left\" Margin=\"85,221,0,0\" VerticalAlignment=\"Top\" Width=\"75\" Click=\"Button_Click\"&gt;\n        &lt;Button.Style&gt;\n            &lt;Style TargetType=\"Button\"&gt;\n                &lt;Setter Property=\"Visibility\" Value=\"Hidden\"/&gt;\n                &lt;Style.Triggers&gt;\n                    &lt;MultiDataTrigger&gt;\n                        &lt;MultiDataTrigger.Conditions&gt;\n                            &lt;Condition Binding=\"{Binding Path=(Validation.HasError), ElementName=txtName}\" Value=\"False\"/&gt;\n                        &lt;/MultiDataTrigger.Conditions&gt;\n                        &lt;Setter Property=\"Visibility\" Value=\"Visible\"&gt;&lt;/Setter&gt;\n                    &lt;/MultiDataTrigger&gt;\n                &lt;/Style.Triggers&gt;\n            &lt;/Style&gt;\n        &lt;/Button.Style&gt;\n    &lt;/Button&gt;\n</code></pre>\n\n<p>My validation logic:</p>\n\n<pre><code>class ValidationTest : ValidationRule\n{\n    private int result;\n    public override ValidationResult Validate(object value, CultureInfo cultureInfo)\n    {\n        if (value == null || string.IsNullOrEmpty(value.ToString()))\n        {\n            return new ValidationResult(false, \"Value cannot be empty.\");\n        }\n        if (value.ToString().Length &gt; 4)\n        {\n            return new ValidationResult(false, \"Name cannot be more than 20 characters long.\");\n        }\n        return ValidationResult.ValidResult;\n    }\n}\n</code></pre>\n\n<p>The error template i am using:</p>\n\n<pre><code>    &lt;Window.Resources&gt;\n    &lt;Style TargetType=\"TextBox\"&gt;\n        &lt;Style.Triggers&gt;\n            &lt;Trigger Property=\"Validation.HasError\" Value=\"true\"&gt;\n                &lt;Setter Property=\"ToolTip\"\n                    Value=\"{Binding RelativeSource={x:Static RelativeSource.Self},\n                    Path=(Validation.Errors)[0].ErrorContent}\"/&gt;\n            &lt;/Trigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n    &lt;ControlTemplate x:Key=\"ValidationErrorTemplate\"&gt;\n        &lt;DockPanel&gt;\n            &lt;Border BorderBrush=\"Red\" BorderThickness=\"1.5\"&gt;\n                &lt;AdornedElementPlaceholder x:Name=\"ErrorAdorner\"&gt;&lt;/AdornedElementPlaceholder&gt;\n            &lt;/Border&gt;\n        &lt;/DockPanel&gt;\n    &lt;/ControlTemplate&gt;\n&lt;/Window.Resources&gt;\n</code></pre>\n\n<p>I have tried to update the binding when the window loads by using <code>txtName.GetBindingExpression(TextBox.TextProperty).UpdateSource();</code>, but that shows the validation error (red line around textbox). However, the button is hidden, so is there any way of hiding the validation error until the user types text into the textbox?</p>\n\n<p><img src=\"https://i.imgur.com/H3Hnuwp.png\" alt=\"what i get when i update the binding when the windows loads\"></p>\n\n<p>Am i approaching this in the right way?</p>\n"}, {"tags": ["c#", "mongodb", "mongodb-.net-driver", "bson"], "comments": [{"owner": {"reputation": 10774, "user_id": 25333, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1a3fe0ef24651f2c23d52b6f1ecd9fbf?s=128&d=identicon&r=PG", "display_name": "Craig Wilson", "link": "https://stackoverflow.com/users/25333/craig-wilson"}, "edited": false, "score": 0, "creation_date": 1423699967, "post_id": 28463384, "comment_id": 45259667, "body": "Interesting. Probably just a use case never encountered. Please file a bug at jira.mongodb.com under the CSHARP project."}, {"owner": {"reputation": 42063, "user_id": 257786, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b7e9590ef59453c3ff92b59b5960490?s=128&d=identicon&r=PG", "display_name": "mnemosyn", "link": "https://stackoverflow.com/users/257786/mnemosyn"}, "edited": false, "score": 0, "creation_date": 1423700073, "post_id": 28463384, "comment_id": 45259701, "body": "I have used a generic type base class in production, never had a problem. Just threw the OP&#39;s example in, works fine. Are you maybe mixing up old and new documents in the same collection, such that you&#39;re trying, at some point, to read and <code>int</code> from a database document that has a <code>NewIdType</code>-id?"}, {"owner": {"reputation": 8923, "user_id": 117503, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5fe30ba7e599fa152ae11dd29897627b?s=128&d=identicon&r=PG", "display_name": "trh178", "link": "https://stackoverflow.com/users/117503/trh178"}, "reply_to_user": {"reputation": 42063, "user_id": 257786, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b7e9590ef59453c3ff92b59b5960490?s=128&d=identicon&r=PG", "display_name": "mnemosyn", "link": "https://stackoverflow.com/users/257786/mnemosyn"}, "edited": false, "score": 0, "creation_date": 1423853157, "post_id": 28463384, "comment_id": 45332180, "body": "So, this problem is finally resolved, and @mnemosyn is correct, everything works fine.  The problem was in the call to <code>MongoCollection(TDefaultDocument).FindOneByIdAs</code>.  Since I am no longer only finding Guids, I needed to change it to use FindOneAs, and use a Query."}, {"owner": {"reputation": 8923, "user_id": 117503, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5fe30ba7e599fa152ae11dd29897627b?s=128&d=identicon&r=PG", "display_name": "trh178", "link": "https://stackoverflow.com/users/117503/trh178"}, "reply_to_user": {"reputation": 42063, "user_id": 257786, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b7e9590ef59453c3ff92b59b5960490?s=128&d=identicon&r=PG", "display_name": "mnemosyn", "link": "https://stackoverflow.com/users/257786/mnemosyn"}, "edited": false, "score": 0, "creation_date": 1423853245, "post_id": 28463384, "comment_id": 45332226, "body": "Just on the administrative front: What should I do with this question?  Technically there is nothing wrong, but it was @mnemosyn comment (about everything working fine for him) that led me to STOP investigating that path, and start checking out where I was using it.  May still be useful for someone?"}, {"owner": {"reputation": 42063, "user_id": 257786, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5b7e9590ef59453c3ff92b59b5960490?s=128&d=identicon&r=PG", "display_name": "mnemosyn", "link": "https://stackoverflow.com/users/257786/mnemosyn"}, "edited": false, "score": 0, "creation_date": 1423853735, "post_id": 28463384, "comment_id": 45332487, "body": "I&#39;d suggest you post an answer to your own question where you briefly describe the solution, that should help for future reference."}], "answers": [{"tags": [], "owner": {"reputation": 8923, "user_id": 117503, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5fe30ba7e599fa152ae11dd29897627b?s=128&d=identicon&r=PG", "display_name": "trh178", "link": "https://stackoverflow.com/users/117503/trh178"}, "is_accepted": false, "score": 1, "last_activity_date": 1423854734, "creation_date": 1423854734, "answer_id": 28506995, "question_id": 28463384, "link": "https://stackoverflow.com/questions/28463384/c-mongodb-driver-can-i-use-generic-type-for-bsonid/28506995#28506995", "title": "C# MongoDB Driver: Can I use generic type for BsonId?", "body": "<p>I have solved the problem. The refactored class from the problem statement works fine.</p>\n\n<p>The problem was not with the generic type as as a BsonId, or with the serialization of the new class, but with existing method calls.</p>\n\n<p>A series of tests used the method <code>MongoCollection(TDefaultDocument).FindOneByIdAs</code>. When the refactor was complete, this code still built, but since we were no longer finding only Guids, it threw the exception described in the problem statement. </p>\n\n<p>I changed the tests to use <code>MongoCollection(TDefaultDocument).FindOneAs</code>, using a new Query to check the UID, and everything works as expected now.</p>\n"}], "owner": {"reputation": 8923, "user_id": 117503, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5fe30ba7e599fa152ae11dd29897627b?s=128&d=identicon&r=PG", "display_name": "trh178", "link": "https://stackoverflow.com/users/117503/trh178"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 959, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1423854734, "creation_date": 1423684836, "question_id": 28463384, "link": "https://stackoverflow.com/questions/28463384/c-mongodb-driver-can-i-use-generic-type-for-bsonid", "title": "C# MongoDB Driver: Can I use generic type for BsonId?", "body": "<p>I had a class like this:</p>\n\n<pre><code>public class MyClass\n{\n    [BsonId]\n    public Guid MyId { get; private set; }\n    // some other properties...\n\n    [BsonConstructor]\n    public MyClass(Guid id)\n    {\n        MyId = id;\n        // set some other properties...\n    }\n}\n</code></pre>\n\n<p>This recently refactored some things.  The code above has a series of tests covering it, which all passed before the refactor.  Now I have a class like this:</p>\n\n<pre><code>public class MyClass&lt;T&gt;\n{\n    [BsonId]\n    public T MyId { get; private set; }\n    // some other properties...\n\n    [BsonConstructor]\n    public MyClass(T id)\n    {\n        MyId = id;\n        // set some other properties...\n    }\n}\n</code></pre>\n\n<p>The hope was that the old code can work the same as it did before, using <code>MyClass&lt;Guid&gt;</code> and serializing so that each document would have an _id like a Guid, and that the new code could use a new object,\nlike <code>MyClass&lt;NewIdType&gt;</code> and serialize to a compound key like _id: { guid, integer }.  The new id class looks like:</p>\n\n<pre><code>public class NewIdType\n{\n    public Guid NewId { get; set; }\n    public int NewIdRank { get; set; }\n}\n</code></pre>\n\n<p>I don't know enough about how serialization works.  I have seen many examples (none exactly like this...) and been through the <a href=\"http://docs.mongodb.org/ecosystem/tutorial/serialize-documents-with-the-csharp-driver/\" rel=\"nofollow\">Serialization Tutorial</a>, with no success.</p>\n\n<p>For what its worth, the old set of tests will pass with <code>MyClass&lt;Guid&gt;</code>, so it seems I am allowed to have a BsonId with a generic type.  But the test fail for <code>MyClass&lt;NewIdType&gt;</code> with an exception\nof \"NewIdType cannot be mapped to BsonValue\".  </p>\n\n<p>Am I missing something simple, or am I just not allowed to have a BsonId of a generic type like this?</p>\n"}, {"tags": ["c#", "visual-studio-2010", "emgucv"], "answers": [{"tags": [], "owner": {"reputation": 876, "user_id": 2694600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1159282db2099a32934d1a742d4b1ece?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier", "link": "https://stackoverflow.com/users/2694600/olivier"}, "is_accepted": false, "score": 1, "last_activity_date": 1423764842, "creation_date": 1423764842, "answer_id": 28484800, "question_id": 28463326, "link": "https://stackoverflow.com/questions/28463326/emgucv-cv-cvinvoke-exception/28484800#28484800", "title": "EmguCV.CV.CvInvoke exception", "body": "<p>You don't have to install EmguCV or OpenCV on the targeted computers, but you need to add the OpenCV dlls in your project.</p>\n\n<ol>\n<li>Right-click on your project name in the Solution Explorer</li>\n<li>Choose Add -> Existing Items</li>\n<li>Browse to your emgufolder/bin/x86, and select all the relevant OpenCV dlls (if you're not sure which dll you need, add them all and try removing one at a time)</li>\n<li>In the Solution Explorer, select all the OpenCV dlls, and in the Properties Explorer choose <code>Content</code> as a <code>Build Action</code>, and <code>Copy Always</code> as <code>Copy to Output Directory</code>.</li>\n</ol>\n\n<p>This is my setup to deploy applications using EmguCV.</p>\n"}], "owner": {"reputation": 69, "user_id": 4543219, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d209258639d3071bd356c33860bff71b?s=128&d=identicon&r=PG&f=1", "display_name": "am0r", "link": "https://stackoverflow.com/users/4543219/am0r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538559648, "creation_date": 1423684660, "last_edit_date": 1592644375, "question_id": 28463326, "link": "https://stackoverflow.com/questions/28463326/emgucv-cv-cvinvoke-exception", "title": "EmguCV.CV.CvInvoke exception", "body": "<p>Good day! I am having a problem in decoding a QR Code using ZXing and Emgu CV demo particularly in the Emgu CV invoke exception issue. I can perfectly run the program with the use of my computer(the terminal in which I tested it) but after transferring the program to another computer. I get this exception.</p>\n<p><a href=\"http://i61.tinypic.com/4grexc.png\" rel=\"nofollow noreferrer\">http://i61.tinypic.com/4grexc.png</a></p>\n<p>I searched the web for solutions but I can't seem to find a fitting solution.</p>\n<p>Here's what I've tried so far:</p>\n<blockquote>\n<p>(1) Replace the DLLs with fresh ones from which the project contains and is referenced to.</p>\n<p>(2) Double check the assembly version (x86) for the new terminal also.</p>\n</blockquote>\n<p>What I would like to know too:</p>\n<blockquote>\n<p>Should I install, download a new copy of Emgu CV libraries for the new terminal and every terminal if I were to distribute copies?</p>\n</blockquote>\n<p>Your ideas are very much appreciated!</p>\n"}, {"tags": ["c#", "entity-framework", "unit-testing"], "comments": [{"owner": {"reputation": 4910, "user_id": 896697, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54961255558784dffca95db840c2c6d2?s=128&d=identicon&r=PG", "display_name": "Jochen van Wylick", "link": "https://stackoverflow.com/users/896697/jochen-van-wylick"}, "edited": false, "score": 1, "creation_date": 1423685137, "post_id": 28463241, "comment_id": 45252695, "body": "I&#39;ve been working with EF for years and I think never had to work with the entity states. The way to add things to a parent in EF? Get the entity - add a child - SaveChanges(). The way to delete it ? Get it, remove the child - SaveChanges(). Let EF do the entity state tracking for you. But in case you work with detached entities - this might be of interest to you: <a href=\"https://www.nuget.org/packages/GraphDiff/\" rel=\"nofollow noreferrer\">nuget.org/packages/GraphDiff</a> - if you have a parent with children posted back from a site - it will compare against the database and add/remove/modify the children in the collection."}, {"owner": {"reputation": 21, "user_id": 2388291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5427558165048a92590657d068d3da?s=128&d=identicon&r=PG", "display_name": "user2388291", "link": "https://stackoverflow.com/users/2388291/user2388291"}, "reply_to_user": {"reputation": 4910, "user_id": 896697, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54961255558784dffca95db840c2c6d2?s=128&d=identicon&r=PG", "display_name": "Jochen van Wylick", "link": "https://stackoverflow.com/users/896697/jochen-van-wylick"}, "edited": false, "score": 0, "creation_date": 1423696294, "post_id": 28463241, "comment_id": 45258352, "body": "Spike - are you talking about adding a child to a parent using dbcontext,OrderItem.Add?   When I try that and comment out the Added state line, it throws a exception saying that Primary Key violation, It&#39;s trying to add an Order object."}], "owner": {"reputation": 21, "user_id": 2388291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b5427558165048a92590657d068d3da?s=128&d=identicon&r=PG", "display_name": "user2388291", "link": "https://stackoverflow.com/users/2388291/user2388291"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423684347, "creation_date": 1423684347, "question_id": 28463241, "link": "https://stackoverflow.com/questions/28463241/ef5-how-to-update-parent-by-adding-a-new-child", "title": "EF5 how to update parent by adding a new child", "body": "<p>Within a unit test, I'm trying to test updates/deletes/insertion of order items to an order.  It's a 1 to N relationship between an order and orderitems.</p>\n\n<p>I keep receiving the DBUpdateConcurrencyException when I try to add a new child to an existing parent within the controller's update code.   </p>\n\n<p>This is the exception: <em>Store update, insert, or delete statement affected an unexpected number of rows (0). Entities may have been modified or deleted since entities were loaded. Refresh ObjectStateManager entries.</em></p>\n\n<p>My questions are:\na) What is the correct way to add new items to an existing parent?\na) What is the correct way to delete items to an existing parent?\nb) If not, from the exception message, how does one update the Objectstatemanager entries?   </p>\n\n<p>Model Code:</p>\n\n<pre><code>public class Order\n{\n    [Key]\n    public int OrderID { get; set; }\n    ...\n    public virtual ICollection&lt;OrderItem&gt; lstOrderItems { get; set; }\n\n    public Order()\n    {\n        OrderID = 0;\n        ...\n        lstOrderItems = new List&lt;OrderItem&gt;();\n    }\n}\n\npublic class OrderItem\n{\n    [Key, Column(Order = 0)]\n    public int? OrderID { get; set; }\n\n    [Key, Column(Order = 1)]\n    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]\n    public int OrderItemID { get; set; }\n\n    [ForeignKey(\"OrderID\")]\n    public virtual Order Orders { get; set; }\n\n    public OrderItem()\n    {\n        OrderID = 0;\n        OrderItemID = 0;\n        Orders = new Order();\n    }\n}\n</code></pre>\n\n<p>Unit Test that populates the order and order items.<br>\n<strong>Note:</strong> I previous added the items to this order successfully without an exception.  This unit test test adding a new orderitem (the 4th item) to this order, and it's where I get the exception.</p>\n\n<pre><code>     Order oOrder = new Order();\n        oOrder.OrderID = TEST_ORDERID;\n\n\n        OrderItem oItems = new OrderItem();\n\n        #region Add items\n        oItems.OrderID = 1;\n        oItems.OrderItemID = 1;\n        oItems.Orders = oOrder;\n\n        oOrder.lstOrderItems.Add(oItems);\n\n        oItems = new OrderItem();\n        oItems.OrderID = 1;\n        oItems.OrderItemID = 2;\n        oItems.Orders = oOrder;           \n\n        oOrder.lstOrderItems.Add(oItems);\n\n        oItems = new OrderItem();\n        oItems.OrderID = 1;\n        oItems.OrderItemID = 3;\n        oItems.Orders = oOrder;\n\n        oOrder.lstOrderItems.Add(oItems);\n\n        / *** This is the new item ***/\n        oItems = new OrderItem();\n        oItems.OrderID = 0;\n        oItems.OrderItemID = 1000;     // Constant that identifies this is a new orderitem\n        oItems.Orders = oOrder;\n\n        oOrder.lstOrderItems.Add(oItems);\n</code></pre>\n\n<p>Controller code that generates the exceptions:</p>\n\n<pre><code>public void Update(Order o)\n    {\n        OrderContext _context = new OrderContext();  // Where OrderContext is derived from DBContext\n        try\n        {\n            bool bAdded = false;\n\n            foreach (var i in o.lstOrderItems)\n            {\n                i.OrderID = o.OrderID;\n            }\n\n            foreach (var i in o.lstOrderItems)\n            {\n                if (i.OrderItemID == 1000)\n                {\n                    if (i.Qty &gt; 0)\n                    {\n                        _context.Entry(i).State = System.Data.EntityState.Added;\n                        i.OrderItemID = 0;  // Not sure if I have to reset this back to 0\n                    }\n                    else\n                    {\n                        _context.Entry(i).State = System.Data.EntityState.Deleted;\n                    }\n                }\n                else\n                {\n\n                    if (i.OrderItemID != -1000)\n                    {\n                        if (i.Qty &gt; 0)\n                        {\n                            _context.Entry(i).State = System.Data.EntityState.Modified;\n                        }\n                        else\n                        {\n                            _context.Entry(i).State = System.Data.EntityState.Deleted;\n                        }\n                    }\n                    else\n                    {\n                        _context.Entry(i).State = System.Data.EntityState.Deleted;\n                    }\n                }\n            }\n\n            _context.Entry(o).State = System.Data.EntityState.Modified; \n\n            _context.SaveChanges();\n        }\n        catch (DbUpdateConcurrencyException ex)\n        {\n            var objContext = ((IObjectContextAdapter)_context).ObjectContext;\n            objContext.Refresh(System.Data.Objects.RefreshMode.ClientWins, _context.Orders);\n\n            objContext.SaveChanges();    // WHen this line executes, it generates a OptimisticConcurrencyException.\n        }\n        catch (Exception e)\n        {\n            throw;\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "linq"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1423684430, "post_id": 28463220, "comment_id": 45252304, "body": "The code, as you currently have it, is executing the query twice; one to see if it has any items, and once to actually get the first time.  You probably don&#39;t want to do that."}, {"owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 2, "creation_date": 1423684475, "post_id": 28463220, "comment_id": 45252335, "body": "Do not throw <code>NullReferenceException</code> instead throw <code>InvalidArgumentException</code>"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1423684531, "post_id": 28463220, "comment_id": 45252365, "body": "<code>query.First()</code> will <i>already</i> throw an exception if the query is empty - why not just use that?"}, {"owner": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 1, "creation_date": 1423684621, "post_id": 28463220, "comment_id": 45252408, "body": "Additionally, uif you expect one and only one result, use <code>Single()</code> rather than <code>First()</code>"}, {"owner": {"reputation": 277, "user_id": 3989196, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ca5e973362a399c5220e63709530a6b3?s=128&d=identicon&r=PG&f=1", "display_name": "rungus2", "link": "https://stackoverflow.com/users/3989196/rungus2"}, "edited": false, "score": 0, "creation_date": 1423684625, "post_id": 28463220, "comment_id": 45252411, "body": "I want to return onlt first element from query when it is not empty. Exception should be thrown when it is empty"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 3, "creation_date": 1423684727, "post_id": 28463220, "comment_id": 45252462, "body": "@rungus2 Which is <i>exactly</i> the behavior of <code>First</code>."}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 3989196, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ca5e973362a399c5220e63709530a6b3?s=128&d=identicon&r=PG&f=1", "display_name": "rungus2", "link": "https://stackoverflow.com/users/3989196/rungus2"}, "edited": false, "score": 0, "creation_date": 1423684850, "post_id": 28463294, "comment_id": 45252535, "body": "Seems to be fine now ;)"}], "tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": false, "score": 8, "last_activity_date": 1423684533, "creation_date": 1423684533, "answer_id": 28463294, "question_id": 28463220, "link": "https://stackoverflow.com/questions/28463220/c-linq-query-as-a-function-parameter/28463294#28463294", "title": "C# Linq query as a function parameter", "body": "<p>Don't call <code>Any</code>, just call <code>First</code>.  It will throw an exception if the query has no items, which is exactly what you want.  There's no need to create another operator as <code>First</code> already has the appropriate semantics.</p>\n\n<p>In addition to just being easier, it results in the database query being executed just once, rather than twice.</p>\n"}, {"tags": [], "owner": {"reputation": 2556, "user_id": 1078115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1367de9b160ef7aa9b2a183ed1a931bb?s=128&d=identicon&r=PG", "display_name": "Marko", "link": "https://stackoverflow.com/users/1078115/marko"}, "is_accepted": false, "score": 1, "last_activity_date": 1423685061, "creation_date": 1423685061, "answer_id": 28463450, "question_id": 28463220, "link": "https://stackoverflow.com/questions/28463220/c-linq-query-as-a-function-parameter/28463450#28463450", "title": "C# Linq query as a function parameter", "body": "<p>Simplified code below. Also i do hope you have some password hashing and not just plain text.</p>\n\n<pre><code>public class LinqDataBaseConnector : IDataBaseConnector\n{\n    #region Private Variables\n    public LinqDatabaseDataContext dataContext;\n    #endregion\n\n    public User getUser(string login, string password)\n    {   \n        return this.dataContext.Users.First(x =&gt; x.username == login &amp;&amp; x.password == password);\n    }\n\n    public HardwareConfiguration getHardwareConfiguration(int id)\n    {   \n        return this.dataContext.HardwareConfigurations.First(x =&gt; x.ID == id);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2556, "user_id": 1078115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1367de9b160ef7aa9b2a183ed1a931bb?s=128&d=identicon&r=PG", "display_name": "Marko", "link": "https://stackoverflow.com/users/1078115/marko"}, "edited": false, "score": 0, "creation_date": 1423691079, "post_id": 28464862, "comment_id": 45255848, "body": "As stated above no reason to throw an exception since First will throw if there is no results to the query its adding extra code the framework will already do."}], "tags": [], "owner": {"reputation": 29, "user_id": 4555584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26ed9687328de033ad958cf58c704cd?s=128&d=identicon&r=PG&f=1", "display_name": "John HardCash", "link": "https://stackoverflow.com/users/4555584/john-hardcash"}, "is_accepted": false, "score": 0, "last_activity_date": 1423690126, "creation_date": 1423690126, "answer_id": 28464862, "question_id": 28463220, "link": "https://stackoverflow.com/questions/28463220/c-linq-query-as-a-function-parameter/28464862#28464862", "title": "C# Linq query as a function parameter", "body": "<p>Why not</p>\n\n<pre><code>    var query = (from c in dataContext.Users\n                 where c.username == login &amp;&amp; c.password == password\n                 select c).FirstOrDefault();\n\n    if (query!=null)\n    {\n        return query;\n    }\n    else\n    {\n        throw new NullReferenceException(\"Empty query!\");\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7480, "user_id": 3330348, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/q5U6s.jpg?s=128&g=1", "display_name": "PiotrWolkowski", "link": "https://stackoverflow.com/users/3330348/piotrwolkowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1423746578, "last_edit_date": 1423746578, "creation_date": 1423706745, "answer_id": 28468055, "question_id": 28463220, "link": "https://stackoverflow.com/questions/28463220/c-linq-query-as-a-function-parameter/28468055#28468055", "title": "C# Linq query as a function parameter", "body": "<p>Is there any reason why you cannot implement it as an extension method:</p>\n\n<pre><code>public static class Extensions\n{\n    public static T GetFirstOrException&lt;T&gt;(this IEnumerable&lt;T&gt; myList)\n    {\n        if (myList.Any())\n        {\n            return myList.First();\n        }\n        else\n        {\n            throw new NullReferenceException(\"Empty query!\");\n        }\n    }\n}\n</code></pre>\n\n<p>In both cases you can then use the extension method:</p>\n\n<pre><code>public User getUser(string login, string password)\n{\n    var query = (from c in dataContext.Users\n                 where c.username == login &amp;&amp; c.password == password\n                 select c);\n\n    return query.GetFirstOrException();\n}\n\npublic HardwareConfiguration getHardwareConfiguration(int id)\n{\n    var query = (from c in dataContext.HardwareConfigurations\n                 where c.ID == id\n                 select c);\n\n    return query.GetFirstOrException();\n}\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 3989196, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ca5e973362a399c5220e63709530a6b3?s=128&d=identicon&r=PG&f=1", "display_name": "rungus2", "link": "https://stackoverflow.com/users/3989196/rungus2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1423746578, "creation_date": 1423684286, "last_edit_date": 1423684931, "question_id": 28463220, "link": "https://stackoverflow.com/questions/28463220/c-linq-query-as-a-function-parameter", "title": "C# Linq query as a function parameter", "body": "<p>I am using linq to get some data from my database. When query is empty I want to throw an exception.   </p>\n\n<pre><code>public class LinqDataBaseConnector : IDataBaseConnector\n{\n    public LinqDatabaseDataContext dataContext;\n\n    public User getUser(string login, string password)\n    {\n        var query = (from c in dataContext.Users\n                     where c.username == login &amp;&amp; c.password == password\n                     select c);\n\n        if (query.Any())\n        {\n            return query.First();\n        }\n        else\n        {\n            throw new NullReferenceException(\"Empty query!\");\n        }\n    }\n\n    public HardwareConfiguration getHardwareConfiguration(int id)\n    {\n        var query = (from c in dataContext.HardwareConfigurations\n                     where c.ID == id\n                     select c);\n\n        if (query.Any())\n        {\n            return query.First();\n        }\n        else\n        {\n            throw new NullReferenceException(\"Empty query!\");\n        }\n    }\n}\n</code></pre>\n\n<p>How to extract this if/else to ONE private method. Do I need to implement <code>IQueryable&lt;T&gt;</code> interface ?</p>\n"}, {"tags": ["c#", "timer", "eventhandler"], "comments": [{"owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 2, "creation_date": 1423684264, "post_id": 28463201, "comment_id": 45252217, "body": "You never started/enabled your timer. Do <code>Time.Start();</code>"}, {"owner": {"reputation": 73, "user_id": 4072061, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0bb103cbc0a735d959b60c4e6da8b16?s=128&d=identicon&r=PG&f=1", "display_name": "electroball09", "link": "https://stackoverflow.com/users/4072061/electroball09"}, "reply_to_user": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 0, "creation_date": 1423684622, "post_id": 28463201, "comment_id": 45252409, "body": "Oops I actually did have it started, just didn&#39;t put it in the question"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1423685226, "post_id": 28463201, "comment_id": 45252736, "body": "Are you sure you are calling <code>InputAReceived</code> somewhere?"}, {"owner": {"reputation": 73, "user_id": 4072061, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0bb103cbc0a735d959b60c4e6da8b16?s=128&d=identicon&r=PG&f=1", "display_name": "electroball09", "link": "https://stackoverflow.com/users/4072061/electroball09"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1423685384, "post_id": 28463201, "comment_id": 45252817, "body": "@roryap Yeah, because the first time it gets called, it sends the message, but after that, it won&#39;t because the timer is still going."}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1423685438, "post_id": 28463201, "comment_id": 45252847, "body": "&quot;sends the message&quot; -- you mean <code>Console.WriteLine(&quot;Time_Tick&quot;);</code>?  &quot;but after that, it won&#39;t because the timer is still going.&quot; -- what does that mean?"}, {"owner": {"reputation": 73, "user_id": 4072061, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0bb103cbc0a735d959b60c4e6da8b16?s=128&d=identicon&r=PG&f=1", "display_name": "electroball09", "link": "https://stackoverflow.com/users/4072061/electroball09"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1423685801, "post_id": 28463201, "comment_id": 45253039, "body": "@roryap When the InputAReceived() is called, if the timer is not running, then it first sends the response back through the network, and then starts the timer.  When the timer ticks, it does the Console.WriteLine(&quot;Time_Tick&quot;).  Apparently, the problem was caused by using System.Windows.Forms.Timer instead of System.Timers.Timer (see the answer below)."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 4072061, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0bb103cbc0a735d959b60c4e6da8b16?s=128&d=identicon&r=PG&f=1", "display_name": "electroball09", "link": "https://stackoverflow.com/users/4072061/electroball09"}, "edited": false, "score": 0, "creation_date": 1423685653, "post_id": 28463519, "comment_id": 45252958, "body": "Wow, that actually fixed it, huh.  I guess I should start using things for what they&#39;re made for :P Thanks a ton."}], "tags": [], "owner": {"reputation": 8041, "user_id": 1771817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/zeTmI.jpg?s=128&g=1", "display_name": "adv12", "link": "https://stackoverflow.com/users/1771817/adv12"}, "is_accepted": true, "score": 4, "last_activity_date": 1423685275, "creation_date": 1423685275, "answer_id": 28463519, "question_id": 28463201, "link": "https://stackoverflow.com/questions/28463201/c-system-windows-forms-timer-eventhandler-not-being-called/28463519#28463519", "title": "C# System.Windows.Forms.Timer EventHandler not being called", "body": "<p>One problem with your code is that it is using the <code>System.Windows.Forms.Timer</code> class from a background thread and not associated with a window.  This violates the instructions given in the <a href=\"https://msdn.microsoft.com/en-us/library/System.Windows.Forms.Timer%28v=vs.110%29.aspx\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p>This timer is optimized for use in Windows Forms applications and must be used in a window.</p>\n</blockquote>\n\n<p>For timers not related to GUI objects, use <code>System.Timers.Timer</code>.  </p>\n\n<p>This may or may not be the cause of the problems you're having, but it's one thing you'll need to address for your code to work correctly.</p>\n"}], "owner": {"reputation": 73, "user_id": 4072061, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c0bb103cbc0a735d959b60c4e6da8b16?s=128&d=identicon&r=PG&f=1", "display_name": "electroball09", "link": "https://stackoverflow.com/users/4072061/electroball09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 900, "favorite_count": 0, "accepted_answer_id": 28463519, "answer_count": 1, "score": 1, "last_activity_date": 1423685275, "creation_date": 1423684212, "last_edit_date": 1423684543, "question_id": 28463201, "link": "https://stackoverflow.com/questions/28463201/c-system-windows-forms-timer-eventhandler-not-being-called", "title": "C# System.Windows.Forms.Timer EventHandler not being called", "body": "<p>Part of my program receives input over a network connection, and sends a message back.  I want to limit the number of times a certain input can trigger a message, so the program can't be overloaded.</p>\n\n<p>I have a background worker that waits for the input, and then when it receives the certain input, it calls into a static class that will determine if it has been enough time since the last input.  I'm using a</p>\n\n<pre><code>System.Windows.Forms.Timer\n</code></pre>\n\n<p>To do this.  It looks like this (everything is public so I can debug):</p>\n\n<pre><code>public static class InputResponse\n{\n    public static System.Windows.Forms.Timer Time = new System.Windows.Forms.Timer();\n\n    public static void CreateTimer()//set all the properties of the timer\n    {\n        Time.Interval = 3000;\n        Time.Tick += new EventHandler(Time_Tick);\n    }\n\n    public static void InputAReceived()\n    {\n        if (Time.Enabled) //if the timer is running, do nothing\n            return;\n        else\n        {\n        //send response here\n            Time.Start();\n        }\n    }\n\n    public static void Time_Tick(object sender, EventArgs e)\n    {\n        Console.WriteLine(\"Time_Tick\");\n        Time.Stop();\n    }\n}\n</code></pre>\n\n<p>The problem is, the Time_Tick method never gets called from the timer.  I can use Invoke() to trigger the method like so, </p>\n\n<pre><code>    EventHandler testHandler = new EventHandler(InputResponse.Time_Tick);\n    testHandler.Invoke(sender, e);//triggered by a button\n</code></pre>\n\n<p>which writes to the console like it should, but just waiting for the timer doesn't work.  It will send the response once, and then won't send it again, since the timer never gets stopped.</p>\n\n<p>The ridiculous thing is I have it working almost exactly the same in another class.  The only difference is that the timer is constantly running.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c#", "selenium-webdriver"], "comments": [{"owner": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "edited": false, "score": 0, "creation_date": 1423684432, "post_id": 28463157, "comment_id": 45252307, "body": "Can you shove the build number (assuming that&#39;s what this is) in the .config file post-build and pull it from there in the code? Not that this is a great approach, but..."}, {"owner": {"reputation": 3321, "user_id": 2546966, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/B2oWe.jpg?s=128&g=1", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/2546966/vivek-singh"}, "edited": false, "score": 0, "creation_date": 1423684719, "post_id": 28463157, "comment_id": 45252457, "body": "Your code doesn&#39;t seems to verify that. It is looking for count==0."}, {"owner": {"reputation": 11, "user_id": 4071884, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cp_SriZNBLU/AAAAAAAAAAI/AAAAAAAAAFE/Eyawa7nr7yE/photo.jpg?sz=128", "display_name": "Dinesh babu", "link": "https://stackoverflow.com/users/4071884/dinesh-babu"}, "edited": false, "score": 0, "creation_date": 1423684741, "post_id": 28463157, "comment_id": 45252467, "body": "I dont think so, because that image represents a color, so we use 3 colors for identification. So each will get a random number everytime."}, {"owner": {"reputation": 11, "user_id": 4071884, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cp_SriZNBLU/AAAAAAAAAAI/AAAAAAAAAFE/Eyawa7nr7yE/photo.jpg?sz=128", "display_name": "Dinesh babu", "link": "https://stackoverflow.com/users/4071884/dinesh-babu"}, "edited": false, "score": 0, "creation_date": 1423684808, "post_id": 28463157, "comment_id": 45252509, "body": "no, it is. if the count of that element is equal to zero then it fails."}, {"owner": {"reputation": 3321, "user_id": 2546966, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/B2oWe.jpg?s=128&g=1", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/2546966/vivek-singh"}, "edited": false, "score": 0, "creation_date": 1423685661, "post_id": 28463157, "comment_id": 45252964, "body": "using css as <code>src*=&#39;&#47;Content&#47;Images&#47;connected-large.png&#39;</code> wont help?"}, {"owner": {"reputation": 11, "user_id": 4071884, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cp_SriZNBLU/AAAAAAAAAAI/AAAAAAAAAFE/Eyawa7nr7yE/photo.jpg?sz=128", "display_name": "Dinesh babu", "link": "https://stackoverflow.com/users/4071884/dinesh-babu"}, "edited": false, "score": 0, "creation_date": 1423757006, "post_id": 28463157, "comment_id": 45286311, "body": "Its working Mr.Vivek. Thanks a lot..."}, {"owner": {"reputation": 3321, "user_id": 2546966, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/B2oWe.jpg?s=128&g=1", "display_name": "Vivek Singh", "link": "https://stackoverflow.com/users/2546966/vivek-singh"}, "edited": false, "score": 0, "creation_date": 1423767924, "post_id": 28463157, "comment_id": 45293181, "body": "Happy to help buddy..."}], "answers": [{"tags": [], "owner": {"reputation": 13168, "user_id": 2897008, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/IW7dt.png?s=128&g=1", "display_name": "vins", "link": "https://stackoverflow.com/users/2897008/vins"}, "is_accepted": false, "score": 0, "last_activity_date": 1423692335, "creation_date": 1423692335, "answer_id": 28465440, "question_id": 28463157, "link": "https://stackoverflow.com/questions/28463157/i-am-trying-to-locate-an-element-with-a-dynamically-generated-number-at-the-end/28465440#28465440", "title": "I am trying to locate an element with a dynamically generated number at the end after each build", "body": "<p>You can use XPath - contains / starts-with.</p>\n\n<pre><code>//img[contains(@src,'/Content/Images/connected-large.png?v=')]\n\nif (driver.FindElements(By.xpath(\"//img[contains(@src,'/Content/Images/connected-large.png?v=')]\")).Count == 0)\n{\nWriteFail(\"Message\");\nAssert.Fail();\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4071884, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Cp_SriZNBLU/AAAAAAAAAAI/AAAAAAAAAFE/Eyawa7nr7yE/photo.jpg?sz=128", "display_name": "Dinesh babu", "link": "https://stackoverflow.com/users/4071884/dinesh-babu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423692335, "creation_date": 1423684032, "last_edit_date": 1423685427, "question_id": 28463157, "link": "https://stackoverflow.com/questions/28463157/i-am-trying-to-locate-an-element-with-a-dynamically-generated-number-at-the-end", "title": "I am trying to locate an element with a dynamically generated number at the end after each build", "body": "<p>I want to verify an image. It is given as </p>\n\n<pre><code>src=\"/Content/Images/connected-large.png?v=34r23\".\n</code></pre>\n\n<p>In the above <code>src</code>, the last 5 alpha numeric characters will dynamically change after each build.</p>\n\n<pre><code>if (driver.FindElements(By.CssSelector(\"[src='/Content/Images/connected-large.png?v=34r23']\")).Count == 0)\n{\n    WriteFail(\"Message\");\n    Assert.Fail();\n}\n</code></pre>\n\n<p>I tried the above to verify but due that dynamic generated alpha numeric characters, after every new build I am changing that.</p>\n\n<p>Any suggestions would be appreciated.</p>\n\n<p>Thanks in Advance.</p>\n"}, {"tags": ["c#", "asp.net", ".net", "api"], "comments": [{"owner": {"reputation": 229, "user_id": 2364679, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f92f4738676da8af318bf99cb71f3ad7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Saylor", "link": "https://stackoverflow.com/users/2364679/ron-saylor"}, "edited": false, "score": 0, "creation_date": 1423684577, "post_id": 28463142, "comment_id": 45252390, "body": "Have you tried using the <code>[HttpDelete]</code> attribute above your <code>DeleteServiceRequest</code> method?"}, {"owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "reply_to_user": {"reputation": 229, "user_id": 2364679, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f92f4738676da8af318bf99cb71f3ad7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Saylor", "link": "https://stackoverflow.com/users/2364679/ron-saylor"}, "edited": false, "score": 0, "creation_date": 1423684721, "post_id": 28463142, "comment_id": 45252459, "body": "@RonSaylor I have, and it does not affect. However, oddly enough, if I change Route(&quot;{id}:int&quot;) to Route(&quot;{id}&quot;) it works fine.... I&#39;m editing the post to include this."}], "answers": [{"tags": [], "owner": {"reputation": 5747, "user_id": 631599, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5fc6b2cf893347e70c0a965f39a67209?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/631599/matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1423688053, "creation_date": 1423688053, "answer_id": 28464303, "question_id": 28463142, "link": "https://stackoverflow.com/questions/28463142/api-supports-delete-on-one-model-but-not-another/28464303#28464303", "title": "API Supports DELETE on one model, but not another", "body": "<p>The route attribute syntax is wrong, it should be:</p>\n\n<pre><code>[Route(\"{id:int}\"), ResponseType(typeof(ServiceRequest))]\n</code></pre>\n\n<p>The route constraints should be inside the <code>{}</code></p>\n"}], "owner": {"reputation": 5036, "user_id": 1223595, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/770fb9d9d0c71f2c21de84c60653c230?s=128&d=identicon&r=PG", "display_name": "steventnorris", "link": "https://stackoverflow.com/users/1223595/steventnorris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 28464303, "answer_count": 1, "score": 0, "last_activity_date": 1436105555, "creation_date": 1423683980, "last_edit_date": 1436105555, "question_id": 28463142, "link": "https://stackoverflow.com/questions/28463142/api-supports-delete-on-one-model-but-not-another", "title": "API Supports DELETE on one model, but not another", "body": "<p>I have scaffolded DELETE methods for two objects. Currently, the users object can accept a DELETE request and works fine, but the requests object gives me the below message:</p>\n\n<pre><code>{\n\"Message\": \"The requested resource does not support http method 'DELETE'.\"\n}\n</code></pre>\n\n<p>The User code and call is:</p>\n\n<pre><code>// DELETE: api/Users/5\n        [Route(\"{id}\"), ResponseType(typeof(User))]\n        public IHttpActionResult DeleteUser(string id)\n        {\n            User user = db.Users.Find(id);\n            if (user == null)\n            {\n                return NotFound();\n            }\n\n            db.Users.Remove(user);\n            db.SaveChanges();\n\n            return Ok(user);\n        }\n\nhttp://localhost:8080/api/users/2\ncontent-type: application/json\nDELETE\n</code></pre>\n\n<p>The request code and call is below:</p>\n\n<pre><code>// DELETE: api/ServiceRequests/5\n        [Route(\"{id}:int\"), ResponseType(typeof(ServiceRequest))]\n        public IHttpActionResult DeleteServiceRequest(int id)\n        {\n            ServiceRequest serviceRequest = db.ServiceRequests.Find(id);\n            if (serviceRequest == null)\n            {\n                return NotFound();\n            }\n\n            db.ServiceRequests.Remove(serviceRequest);\n            db.SaveChanges();\n\n            return Ok(serviceRequest);\n        }\n\n\nhttp://localhost:8080/api/servicerequests/2\ncontent-type: application/json\nDELETE\n</code></pre>\n\n<p>Oddly enough, if I change the <code>Route(\"{id}:int\")</code> to <code>Route(\"{id}\")</code>, it functions fine, but eliminates my integer constraint.</p>\n\n<p>How do I allow access to DELETE for the service requests?</p>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 3, "creation_date": 1423683710, "post_id": 28463061, "comment_id": 45251927, "body": "<a href=\"http://mattgemmell.com/what-have-you-tried/\" rel=\"nofollow noreferrer\">mattgemmell.com/what-have-you-tried</a>"}, {"owner": {"reputation": 61, "user_id": 4556383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NNNGL.jpg?s=128&g=1", "display_name": "ChandraKanth Narumanchi", "link": "https://stackoverflow.com/users/4556383/chandrakanth-narumanchi"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1423684204, "post_id": 28463061, "comment_id": 45252190, "body": "I&#39;m confused... i tried to bind the dataset to grid and then struck with the button field..."}], "answers": [{"comments": [{"owner": {"reputation": 5430, "user_id": 3294832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUCr2.jpg?s=128&g=1", "display_name": "Ric .Net", "link": "https://stackoverflow.com/users/3294832/ric-net"}, "edited": false, "score": 0, "creation_date": 1423816410, "post_id": 28463385, "comment_id": 45310579, "body": "@ChandraKanth Did this help you? And if, consider accepting this as an answer"}], "tags": [], "owner": {"reputation": 5430, "user_id": 3294832, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KUCr2.jpg?s=128&g=1", "display_name": "Ric .Net", "link": "https://stackoverflow.com/users/3294832/ric-net"}, "is_accepted": false, "score": 0, "last_activity_date": 1423684840, "creation_date": 1423684840, "answer_id": 28463385, "question_id": 28463061, "link": "https://stackoverflow.com/questions/28463061/button-column-in-the-middle-of-the-text-columns-of-datagridview-of-win-forms/28463385#28463385", "title": "Button column in the middle of the text columns of datagridview of win forms", "body": "<p>In the designer you can edit the columns by pressing the little Arrow in the right upper corner.</p>\n\n<p>There add your button column and set the <code>DataPropertyName</code> to the name of the property you are trying to bind to. Leave the <code>UseColumnTextForButtonValue</code> on <code>False</code>.</p>\n\n<p>See screenshot:</p>\n\n<p><img src=\"https://i.stack.imgur.com/vmjCI.png\" alt=\"screenshot\"></p>\n\n<p>Good luck</p>\n"}], "owner": {"reputation": 61, "user_id": 4556383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NNNGL.jpg?s=128&g=1", "display_name": "ChandraKanth Narumanchi", "link": "https://stackoverflow.com/users/4556383/chandrakanth-narumanchi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423684840, "creation_date": 1423683676, "question_id": 28463061, "link": "https://stackoverflow.com/questions/28463061/button-column-in-the-middle-of-the-text-columns-of-datagridview-of-win-forms", "title": "Button column in the middle of the text columns of datagridview of win forms", "body": "<p>I have a datagridview with 5 columns. 4 columns are generated from dataset and 5th is the edit column. In the 4th column I need to generate the buttons with text values of the dataset. Can anyone help me in this regard</p>\n"}, {"tags": ["c#", "unit-testing", "autofixture"], "answers": [{"comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1423821934, "post_id": 28475970, "comment_id": 45313493, "body": "+1 FWIW, we&#39;re considering (re)moving the seed overloads in AutoFixture version 4 <a href=\"https://github.com/AutoFixture/AutoFixture/issues/151\" rel=\"nofollow noreferrer\">github.com/AutoFixture/AutoFixture/issues/151</a>"}], "tags": [], "owner": {"reputation": 47337, "user_id": 26396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1ad202622fb9b5ed28dde7b4cf255ab?s=128&d=identicon&r=PG", "display_name": "Enrico Campidoglio", "link": "https://stackoverflow.com/users/26396/enrico-campidoglio"}, "is_accepted": true, "score": 14, "last_activity_date": 1425911119, "last_edit_date": 1425911119, "creation_date": 1423739533, "answer_id": 28475970, "question_id": 28462933, "link": "https://stackoverflow.com/questions/28462933/what-does-createmany-with-seed-do/28475970#28475970", "title": "What does CreateMany with seed do?", "body": "<h3>tl;dr</h3>\n\n<p>As a general rule, AutoFixture <a href=\"https://github.com/AutoFixture/AutoFixture/blob/master/Src/AutoFixture/SpecimenFactory.cs#L254-257\" rel=\"noreferrer\"><em>does not guarantee</em></a> how seed values are going to be used during the creation process, if at all. This characteristic stems from the way AutoFixture <a href=\"https://github.com/AutoFixture/AutoFixture/wiki/Internal-Architecture\" rel=\"noreferrer\">is designed</a>.</p>\n\n<h3>Background</h3>\n\n<p>Every time AutoFixture is asked to create an object of a certain <code>Type</code>, the request is routed through <a href=\"https://github.com/AutoFixture/AutoFixture/wiki/Internal-Architecture#fixture-high-level-layout\" rel=\"noreferrer\">a pipeline of objects called \"<em>builders</em>\"</a>. Each builder is responsible for handling a certain kind of <em>request</em> (whether it be a request for a <em>concrete type</em>, an <em>interface</em>, a <em>property</em>, a <em>field</em> etc). If a builder encounters a request it can handle, it's going to return a value for it and the pipeline restarts with the next request.</p>\n\n<p>Given the above, if you want to create an object based on a <em>seed</em>, all AutoFixture can do is make sure that the seed value you provide is <a href=\"https://github.com/AutoFixture/AutoFixture/blob/master/Src/AutoFixture/Kernel/SeededRequest.cs\" rel=\"noreferrer\">embedded in the request</a> that is sent through the pipeline. Then it's up to the builders to decide what to do with that value.</p>\n\n<h3>Solution</h3>\n\n<p>AutoFixture currently comes with a <em>single builder</em> that takes into account seed values and that's <a href=\"https://github.com/AutoFixture/AutoFixture/blob/master/Src/AutoFixture/StringSeedRelay.cs#L7-L8\" rel=\"noreferrer\">the one for strings</a>.</p>\n\n<p>However, you can tell AutoFixture how it should use seed values when creating objects of <em>any type</em> by customizing a <code>Fixture</code> specifically for that type with <a href=\"https://github.com/AutoFixture/AutoFixture/blob/master/Src/AutoFixture/Dsl/NodeComposer.cs#L41-L55\" rel=\"noreferrer\">the <code>FromSeed</code> method</a>:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>var fixture = new Fixture();\nfixture.Customize&lt;Foo&gt;(c =&gt;\n    c.FromSeed(seed =&gt;\n        {\n            // return an instance of Foo\n            // that uses the seed value in some way\n        }));\n</code></pre>\n\n<p>The <em>factory function</em> you provide to <code>FromSeed</code> will be invoked every time AutoFixture has to create an instance of <code>Foo</code> and it will be passed the seed value from the <code>Fixture</code>. For example, given this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>fixture.CreateMany&lt;Foo&gt;(seed: new Foo { Bar = \"baz\" });\n</code></pre>\n\n<p>the <code>seed</code> parameter of the factory function will receive the <code>Foo</code> seed object that has the <code>Bar</code> property set to <code>\"baz\"</code>.</p>\n"}], "owner": {"reputation": 31899, "user_id": 356790, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/416ebf098d30fc7ae56660acd386329d?s=128&d=identicon&r=PG", "display_name": "SFun28", "link": "https://stackoverflow.com/users/356790/sfun28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2340, "favorite_count": 0, "accepted_answer_id": 28475970, "answer_count": 1, "score": 8, "last_activity_date": 1451191918, "creation_date": 1423683174, "last_edit_date": 1451191918, "question_id": 28462933, "link": "https://stackoverflow.com/questions/28462933/what-does-createmany-with-seed-do", "title": "What does CreateMany with seed do?", "body": "<p>What does the <code>CreateMany</code> overload with the <code>T seed</code> parameter actually do?  I've tried to seed, but the seed seems to have no effect on the created objects.  For example, I was expecting that if my seed had a property of type <code>string</code>, that either: </p>\n\n<ul>\n<li><p>the string value would be used to populate that property in all newly created objects</p></li>\n<li><p>or the string value would be used as a prefix when setting that property in all newly created objects</p></li>\n</ul>\n"}, {"tags": ["c#", "datagridview"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 2, "creation_date": 1423683307, "post_id": 28462924, "comment_id": 45251682, "body": "why not change your query to Select <code>DISTINCT</code> also where is the 2nd table that you are selecting from..? if this is all stored in a single table then <code>Distinct</code> can return what you need like this  <code>SqlCommand cmd = new SqlCommand(&quot;SELECT Distinct BookingId, Date, PatientId, Firstname, Surname FROM Bookings, Patients&quot;, connection);</code> also you can do a sub select or use a Where Clause.. many options here"}, {"owner": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "edited": false, "score": 1, "creation_date": 1423683313, "post_id": 28462924, "comment_id": 45251686, "body": "Seems like your SQL isn&#39;t quite what you want. Perhaps you&#39;re looking for an <code>INNER JOIN</code> on <code>Bookings.PatientId</code> to <code>Patients.PatientId</code> (assuming your schema supports this)?"}, {"owner": {"reputation": 15204, "user_id": 27457, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0d105cc3c2a6124c8f8242681a394c70?s=128&d=identicon&r=PG", "display_name": "AJ.", "link": "https://stackoverflow.com/users/27457/aj"}, "edited": false, "score": 0, "creation_date": 1423683361, "post_id": 28462924, "comment_id": 45251711, "body": "What do you mean by &quot;duplicate&quot; rows?  I don&#39;t see any duplicates in your screenshots if all values are being compared."}, {"owner": {"reputation": 79, "user_id": 4317416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aec2f3b86c46d064938666487054579?s=128&d=identicon&r=PG&f=1", "display_name": "10AlexD10", "link": "https://stackoverflow.com/users/4317416/10alexd10"}, "reply_to_user": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "edited": false, "score": 0, "creation_date": 1423683390, "post_id": 28462924, "comment_id": 45251730, "body": "@wgraham I&#39;ll give that a try"}, {"owner": {"reputation": 79, "user_id": 4317416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aec2f3b86c46d064938666487054579?s=128&d=identicon&r=PG&f=1", "display_name": "10AlexD10", "link": "https://stackoverflow.com/users/4317416/10alexd10"}, "reply_to_user": {"reputation": 15204, "user_id": 27457, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/0d105cc3c2a6124c8f8242681a394c70?s=128&d=identicon&r=PG", "display_name": "AJ.", "link": "https://stackoverflow.com/users/27457/aj"}, "edited": false, "score": 0, "creation_date": 1423683521, "post_id": 28462924, "comment_id": 45251808, "body": "@AJ some of these records don&#39;t even exist in my tables for example I dont have bookingId 2 with PatientId 2 if that makes sense"}, {"owner": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "edited": false, "score": 0, "creation_date": 1423683557, "post_id": 28462924, "comment_id": 45251834, "body": "@10gez10 right, but that&#39;s because you&#39;re saying &quot;Give me all rows from Bookings. For each one, give me all patients.&quot; What you <i>probably</i> wanted was &quot;give me all Bookings and <i>the patient associated with it</i>.&quot;"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1423683931, "post_id": 28462924, "comment_id": 45252050, "body": "@10gez10  <code>some of these records don&#39;t even exist in my tables</code> sounds like you need to make sure that you are looking at the correct table how is it that you can display data but yet you say the data does not exist..? how is this possible based on the query you are showing.. is there a different query and or storeprocedure being called someone where you&#39;re not aware of.. have you used the debugger to identify where this is properly being <code>called &#47; loaded</code>"}, {"owner": {"reputation": 79, "user_id": 4317416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aec2f3b86c46d064938666487054579?s=128&d=identicon&r=PG&f=1", "display_name": "10AlexD10", "link": "https://stackoverflow.com/users/4317416/10alexd10"}, "edited": false, "score": 0, "creation_date": 1423684288, "post_id": 28462924, "comment_id": 45252225, "body": "@wgrahm exactly what I was after, the only down side is in bookings I don&#39;t have the exact columns as patients whether this is required for inner join I&#39;m not sure though I do have constraint link between them that being booking takes data from patient"}, {"owner": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "edited": false, "score": 0, "creation_date": 1423684489, "post_id": 28462924, "comment_id": 45252350, "body": "@10gez10 without knowing more about your schema I can only offer somewhat-generic advice."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 4317416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aec2f3b86c46d064938666487054579?s=128&d=identicon&r=PG&f=1", "display_name": "10AlexD10", "link": "https://stackoverflow.com/users/4317416/10alexd10"}, "edited": false, "score": 0, "creation_date": 1423685059, "post_id": 28463133, "comment_id": 45252651, "body": "Wgraham had the notion and R.shilling you gave me the simple answer, regardless thank you all for your help"}], "tags": [], "owner": {"reputation": 69, "user_id": 1427103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b325d1ae1032c59634df5fd9bfa8ec8?s=128&d=identicon&r=PG", "display_name": "R. Shilling", "link": "https://stackoverflow.com/users/1427103/r-shilling"}, "is_accepted": false, "score": -1, "last_activity_date": 1423683942, "creation_date": 1423683942, "answer_id": 28463133, "question_id": 28462924, "link": "https://stackoverflow.com/questions/28462924/c-remove-duplicated-rows-in-data-grid-view/28463133#28463133", "title": "c# remove duplicated rows in data grid view", "body": "<p>I would gues you need to change your SQL to:</p>\n\n<pre><code>SELECT BookingId, Date, PatientId, Firstname, Surname \nFROM Bookings \nINNER JOIN Patients ON Patients.PatientId = Bookings.PatientId;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1373, "user_id": 2406472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Spx0M.jpg?s=128&g=1", "display_name": "wgraham", "link": "https://stackoverflow.com/users/2406472/wgraham"}, "is_accepted": true, "score": 0, "last_activity_date": 1423683961, "creation_date": 1423683961, "answer_id": 28463136, "question_id": 28462924, "link": "https://stackoverflow.com/questions/28462924/c-remove-duplicated-rows-in-data-grid-view/28463136#28463136", "title": "c# remove duplicated rows in data grid view", "body": "<p>(converted from a comment)</p>\n\n<p>What your query is currently producing is a <a href=\"http://en.wikipedia.org/wiki/Join_%28SQL%29#Cross_join\" rel=\"nofollow\"><em>cross join</em></a>. Essentially, this means that you will get each row from <code>Bookings</code> combined with each row from <code>Patients</code>.</p>\n\n<p>What you probably want is an <a href=\"http://en.wikipedia.org/wiki/Join_%28SQL%29#Inner_join\" rel=\"nofollow\"><em>inner join</em></a>. An inner join allows you to specify a predicate for the records joined from the \"right\" table (in this case, <code>Patients</code>), so for each <code>Booking</code> you can get the <code>Patient</code> associated with it based on the foreign key.</p>\n\n<p>Note: you can accomplish the same result with a cross join through a <code>WHERE</code> clause but it has been deprecated and, depending on the RDBMS, you may see varying performance.</p>\n"}], "owner": {"reputation": 79, "user_id": 4317416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2aec2f3b86c46d064938666487054579?s=128&d=identicon&r=PG&f=1", "display_name": "10AlexD10", "link": "https://stackoverflow.com/users/4317416/10alexd10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 0, "accepted_answer_id": 28463136, "answer_count": 2, "score": 0, "last_activity_date": 1423685293, "creation_date": 1423683139, "last_edit_date": 1423683208, "question_id": 28462924, "link": "https://stackoverflow.com/questions/28462924/c-remove-duplicated-rows-in-data-grid-view", "title": "c# remove duplicated rows in data grid view", "body": "<p>I'm trying to display data from two separate tables into a data grid view, I'm aware that it may not be designed for this purpose though I'm sure there is a way to stop it producing multiple duplicate rows as shown below;</p>\n\n<p><img src=\"https://i.stack.imgur.com/xlfeH.jpg\" alt=\"enter image description here\"></p>\n\n<p>Here is the code for fetching the data (I do intend to include a filter or specific search query later on as commented in the code, this being today's day);</p>\n\n<pre><code>private void FillPatients()\n{\n    SqlConnection connection = new SqlConnection();\n\n    //DateTime timeNow = DateTime.Now;\n    //string format = \"MMM ddd d HH:mm yyyy\";\n\n    try\n    {\n        connection.ConnectionString = connectionPath;\n        connection.Open();\n\n        SqlCommand cmd = new SqlCommand(\"SELECT BookingId, Date, PatientId, Firstname, Surname FROM Bookings, Patients\", connection);\n        //cmd.Parameters.AddWithValue(\"@Date\", timeNow.ToString(format));\n        SqlDataAdapter dap = new SqlDataAdapter(cmd);\n        DataTable dt = new DataTable();\n        dap.Fill(dt);\n\n        BindingSource bs = new BindingSource();\n        bs.DataSource = dt;\n        dgv.DataSource = bs;\n        dap.Update(dt);\n\n        DialogResult dlgResult;\n        dlgResult = MessageBox.Show(\n                \"Patients loaded\",\n                \"Patients\",\n                MessageBoxButtons.OK,\n                MessageBoxIcon.Information,\n                MessageBoxDefaultButton.Button1);\n\n    }\n    catch (SqlException sql)\n    {\n        MessageBox.Show(sql.Message);\n    }\n    finally\n    {\n        connection.Close();\n        connection.Dispose();\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "mongodb", "asp.net-mvc-5"], "comments": [{"owner": {"reputation": 6291, "user_id": 1243156, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kCOsg.jpg?s=128&g=1", "display_name": "Matt Bodily", "link": "https://stackoverflow.com/users/1243156/matt-bodily"}, "edited": false, "score": 0, "creation_date": 1423683277, "post_id": 28462879, "comment_id": 45251661, "body": "there are several ways to do it.  see my answer here <a href=\"http://stackoverflow.com/questions/18539149/how-to-create-select-list-for-country-and-states-province-in-mvc/18539308#18539308\" title=\"how to create select list for country and states province in mvc\">stackoverflow.com/questions/18539149/&hellip;</a> for one way"}, {"owner": {"reputation": 2834, "user_id": 1455713, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUPor.jpg?s=128&g=1", "display_name": "Brian Noah", "link": "https://stackoverflow.com/users/1455713/brian-noah"}, "edited": false, "score": 1, "creation_date": 1423695192, "post_id": 28462879, "comment_id": 45257894, "body": "Could you post the code that you are using that tries to access the departments?"}], "answers": [{"tags": [], "owner": {"reputation": 4679, "user_id": 337085, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/2daee1581901ea06dbb80d2c04c1a182?s=128&d=identicon&r=PG&f=1", "display_name": "Roman Pushkin", "link": "https://stackoverflow.com/users/337085/roman-pushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1423683744, "creation_date": 1423683744, "answer_id": 28463077, "question_id": 28462879, "link": "https://stackoverflow.com/questions/28462879/populating-a-dropdownlist-in-asp-net-mvc-5-from-another-model/28463077#28463077", "title": "Populating a dropdownlist in ASP.NET MVC 5 from another model", "body": "<p>Looks like your problem is not about dropdownlist, but about populating a list from MongoDB. Try to make DepartmentName virtual:</p>\n\n<pre><code>public virtual List&lt;Department&gt; DepartmentName { get; set; }\n</code></pre>\n\n<p>Btw, it comes to mind that this property should be named \"Departments\" instead of \"DepartmentName\".</p>\n\n<p>PS Show us more code if it won't help.</p>\n"}], "owner": {"reputation": 1, "user_id": 2395645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d2f828929068e28510b8ef8f79ed863?s=128&d=identicon&r=PG", "display_name": "user2395645", "link": "https://stackoverflow.com/users/2395645/user2395645"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 704, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1423683904, "creation_date": 1423682983, "last_edit_date": 1423683904, "question_id": 28462879, "link": "https://stackoverflow.com/questions/28462879/populating-a-dropdownlist-in-asp-net-mvc-5-from-another-model", "title": "Populating a dropdownlist in ASP.NET MVC 5 from another model", "body": "<p>I am trying to populate a dropdownlist that will contain department names.  This dropdownlist will be in located in a view that is part of creating a new user.  I have two separate models as follows:</p>\n\n<pre><code>public class User : MongoEntity\n{\n    public User()\n    {\n        DepartmentName = new List&lt;Department&gt;();\n    }\n\n    public string FullName { get; set; }\n    public string LoginName { get; set; }\n    public string Title { get; set; }\n    public List&lt;Department&gt; DepartmentName { get; set; }\n    public string TelephoneNumber { get; set; }\n    public string Email { get; set; }\n}\n\npublic class Department : MongoEntity\n{\n    public string DepartmentName { get; set; }\n    public string DepartmentLocation { get; set; }\n}\n</code></pre>\n\n<p>I have been unable to pull the values from the Department Model into the CreateUser view.  </p>\n\n<p>I am using MongoDB for this project.  Any help/feedback would be greatly appreciated.</p>\n"}, {"tags": ["c#", "winforms", "textbox"], "comments": [{"owner": {"reputation": 204249, "user_id": 961113, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ja1ty.png?s=128&g=1", "display_name": "Habib", "link": "https://stackoverflow.com/users/961113/habib"}, "edited": false, "score": 0, "creation_date": 1423682904, "post_id": 28462833, "comment_id": 45251415, "body": "<code>File.WriteAllText(&quot;filePath&quot;, textBoxPath.Text);</code> ?"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1423683199, "post_id": 28462833, "comment_id": 45251601, "body": "sounds like a possible <code>duplicate</code> <a href=\"http://stackoverflow.com/questions/7325766/xmlreader-and-nodetypes\" title=\"xmlreader and nodetypes\">stackoverflow.com/questions/7325766/xmlreader-and-nodetypes</a>"}], "answers": [{"tags": [], "owner": {"reputation": 729, "user_id": 1758142, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/087d5392c25711573eb218471eac3204?s=128&d=identicon&r=PG", "display_name": "pascx64", "link": "https://stackoverflow.com/users/1758142/pascx64"}, "is_accepted": true, "score": 2, "last_activity_date": 1423683728, "creation_date": 1423683728, "answer_id": 28463074, "question_id": 28462833, "link": "https://stackoverflow.com/questions/28462833/c-winform-how-to-write-current-text-in-a-text-box-to-a-new-file/28463074#28463074", "title": "C# WinForm, how to write current text in a text box to a new file", "body": "<p>You can show a \"Save file\" dialog with <code>SaveFileDialog</code> :</p>\n\n<pre><code>var saveFileDialog = new SaveFileDialog();\nif(saveFileDialog.ShowDialog() == DialogResult.OK)\n    // save to saveFileDialog.FileName\n</code></pre>\n\n<p>To write the text in your <code>TextBox</code> :</p>\n\n<p><code>File.WriteAllText( saveFileDialog.FileName, textbox.Text );</code></p>\n"}], "owner": {"reputation": 1, "user_id": 4549994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bdc0383ca34f3145db5fd983b37bb68?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/4549994/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 0, "closed_date": 1423690070, "accepted_answer_id": 28463074, "answer_count": 1, "score": -2, "last_activity_date": 1423683728, "creation_date": 1423682816, "last_edit_date": 1423683317, "question_id": 28462833, "link": "https://stackoverflow.com/questions/28462833/c-winform-how-to-write-current-text-in-a-text-box-to-a-new-file", "closed_reason": "Not suitable for this site", "title": "C# WinForm, how to write current text in a text box to a new file", "body": "<p>So I'm working on this application that reads an XML file and writes it to a textbox and so far so good.</p>\n\n<p>However I would like to have a button that when clicked opens a \"save as\" dialog window, lets the user create a new .txt file and then reads the content of the textbox and saves it.</p>\n"}, {"tags": ["c#", ".net", "wcf", "rest"], "answers": [{"tags": [], "owner": {"reputation": 2298, "user_id": 4466773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7276cf7cf2c635257b6533574125a08?s=128&d=identicon&r=PG&f=1", "display_name": "Parthasarathy", "link": "https://stackoverflow.com/users/4466773/parthasarathy"}, "is_accepted": true, "score": 0, "last_activity_date": 1423683229, "creation_date": 1423683229, "answer_id": 28462945, "question_id": 28462790, "link": "https://stackoverflow.com/questions/28462790/wcf-rest-service-and-client/28462945#28462945", "title": "Wcf REST Service and Client", "body": "<p>From the code that you have posted, the service web.config does not have an endpoint with BasicHttpBinding. To consume the service through a proxy, I believe you need to add an endpoint with BasicHttpBinding as the per the client web.config in your question. It does expose a REST endpoint. To invoke the REST service, you can invoke using the url like below.</p>\n\n<pre><code>http://localhost:55008/RestServiceImpl.svc/images\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 2930996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8206c11b8da9b3dcbfd9a739685e513?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat_RJT", "link": "https://stackoverflow.com/users/2930996/rajat-rjt"}, "is_accepted": false, "score": 0, "last_activity_date": 1424236398, "creation_date": 1424236398, "answer_id": 28576434, "question_id": 28462790, "link": "https://stackoverflow.com/questions/28462790/wcf-rest-service-and-client/28576434#28576434", "title": "Wcf REST Service and Client", "body": "<p>Try adding Web Reference of REST Service instead of Service Reference in your client code. </p>\n"}], "owner": {"reputation": 33, "user_id": 4556271, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1867de25962689f95f0e4f940399ac8f?s=128&d=identicon&r=PG&f=1", "display_name": "\u0141ukasz Golec", "link": "https://stackoverflow.com/users/4556271/%c5%81ukasz-golec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 28462945, "answer_count": 2, "score": -1, "last_activity_date": 1424236398, "creation_date": 1423682697, "question_id": 28462790, "link": "https://stackoverflow.com/questions/28462790/wcf-rest-service-and-client", "title": "Wcf REST Service and Client", "body": "<p>Hello I was searching for long time, but every answers didn`t resolved my problem. I have REST Service</p>\n\n<pre><code>namespace WcfService1\n{\n\n[ServiceContract]\npublic interface IRestServiceImpl\n{\n    [OperationContract]\n    [WebInvoke(Method = \"GET\",\n        ResponseFormat = WebMessageFormat.Xml,\n        BodyStyle = WebMessageBodyStyle.Wrapped,\n        UriTemplate = \"images\")]\n    List&lt;MyImage&gt; getImages();        \n}\n[DataContract]\npublic class MyImage\n{\n    public MyImage(string name, Image img)\n    {\n        Name = name;\n        Img = img;\n    }\n    [DataMember]\n    public string Name\n    {\n        get;\n        set;\n    }\n    [DataMember]\n    public Image Img\n    {\n        get;\n        set;\n    }\n}\n}\n</code></pre>\n\n<p>Here is implementation:</p>\n\n<pre><code>namespace WcfService1\n{\n\npublic class RestServiceImpl : IRestServiceImpl\n{\n    public List&lt;MyImage&gt; getImages()\n    {\n        List&lt;MyImage&gt; images = new List&lt;MyImage&gt;();\n        string[] files = Directory.GetFiles(AppDomain.CurrentDomain.BaseDirectory, \"*.jpg\");\n\n        foreach (string file in files)\n        {\n            Image im = Image.FromFile(file);\n            images.Add(new MyImage(file, im));\n        }\n        return images;\n    }\n}\n}\n</code></pre>\n\n<p>Web.Config:</p>\n\n<pre><code>    &lt;?xml version=\"1.0\"?&gt;\n     &lt;configuration&gt;\n      &lt;system.web&gt;\n       &lt;compilation debug=\"true\" targetFramework=\"4.0\" /&gt;\n      &lt;/system.web&gt;\n      &lt;system.serviceModel&gt;\n       &lt;services&gt;\n        &lt;service name=\"WcfService1.RestServiceImpl\" behaviorConfiguration=\"ServiceBehaviour\"&gt;\n         &lt;endpoint address=\"\" binding=\"webHttpBinding\" contract=\"WcfService1.IRestServiceImpl\" behaviorConfiguration=\"web\"&gt;        \n         &lt;/endpoint&gt;\n        &lt;/service&gt;\n       &lt;/services&gt;\n       &lt;behaviors&gt;\n        &lt;serviceBehaviors&gt;\n         &lt;behavior name=\"ServiceBehaviour\"&gt;\n           &lt;serviceMetadata httpGetEnabled=\"true\"/&gt;\n           &lt;serviceDebug includeExceptionDetailInFaults=\"false\"/&gt;\n         &lt;/behavior&gt;\n        &lt;/serviceBehaviors&gt;\n        &lt;endpointBehaviors&gt;\n        &lt;behavior name=\"web\"&gt;\n         &lt;webHttp/&gt;\n        &lt;/behavior&gt;\n       &lt;/endpointBehaviors&gt;\n      &lt;/behaviors&gt;\n      &lt;serviceHostingEnvironment multipleSiteBindingsEnabled=\"true\" /&gt;\n     &lt;/system.serviceModel&gt;\n     &lt;system.webServer&gt;\n      &lt;modules runAllManagedModulesForAllRequests=\"true\"/&gt;\n     &lt;/system.webServer&gt;\n    &lt;/configuration&gt;\n</code></pre>\n\n<p>Next I created Client App and added Service Reference and choose reference from localhost declared upper</p>\n\n<p>There is code of client</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public MainWindow()\n    {\n        InitializeComponent();\n\n        ServiceReference1.RestServiceImplClient service = new ServiceReference1.RestServiceImplClient();\n\n        ServiceReference1.MyImage[] images = service.getImages();\n        service.Close();\n        List&lt;ServiceReference1.MyImage&gt; files = images.Select(im =&gt; new ServiceReference1.MyImage() { Img = im.Img, Name = im.Name }).ToList();\n\n        listViewImages.ItemsSource = files;\n\n    }\n}\n</code></pre>\n\n<p>On this line:</p>\n\n<pre><code>ServiceReference1.MyImage[] images = service.getImages();\n</code></pre>\n\n<p>I have exception:</p>\n\n<blockquote>\n  <p>There was no endpoint listening at <a href=\"http://localhost:55008/RestServiceImpl.svc\" rel=\"nofollow\">http://localhost:55008/RestServiceImpl.svc</a> that could accept the message. This is often caused by an incorrect address or SOAP action. See InnerException, if present, for more details.</p>\n</blockquote>\n\n<p>When I looked into InnerException I have:</p>\n\n<blockquote>\n  <p>The remote server returned an error: (404) Not Found.</p>\n</blockquote>\n\n<p>Here is my app.config file for Client:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n &lt;system.serviceModel&gt;\n  &lt;client&gt;\n   &lt;endpoint address=\"http://localhost:55008/RestServiceImpl.svc\" binding=\"basicHttpBinding\" contract=\"ServiceReference1.IRestServiceImpl\"&gt;\n   &lt;/endpoint&gt;\n  &lt;/client&gt;\n  &lt;behaviors&gt;\n   &lt;serviceBehaviors&gt;\n    &lt;behavior name=\"ServiceBehaviour\"&gt;\n     &lt;serviceMetadata httpGetEnabled=\"true\"/&gt;\n     &lt;serviceDebug includeExceptionDetailInFaults=\"false\"/&gt;\n    &lt;/behavior&gt;\n   &lt;/serviceBehaviors&gt;\n  &lt;/behaviors&gt;\n &lt;/system.serviceModel&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>I know that the topic is very popular, but all the answers couldn`t help me.</p>\n"}, {"tags": ["c#", "design-patterns", "composite"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1423682759, "post_id": 28462754, "comment_id": 45251328, "body": "Technically you could make it be <code>null</code> through some evil reflection shenanigans, but somehow I doubt that that&#39;s why that check is there.  It&#39;s probably just a mistake, as you mentioned."}, {"owner": {"reputation": 1141, "user_id": 4031869, "user_type": "registered", "profile_image": "https://graph.facebook.com/601937077/picture?type=large", "display_name": "Matt Clark", "link": "https://stackoverflow.com/users/4031869/matt-clark"}, "edited": false, "score": 0, "creation_date": 1423683551, "post_id": 28462754, "comment_id": 45251830, "body": "Resharper be like &quot;YOU SHOULD CHECK FOR NULL MMKKK&quot; so then the author is all like &quot;k, hit alt+enter, fix it for me.&quot;  In reality though, making the _holder assignment to begin with doesn&#39;t make too much sense, could just use &quot;this&quot;"}, {"owner": {"reputation": 157, "user_id": 3336406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/14417a2fe54b3a1018a1d1cad00d4698?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/3336406/eugene"}, "reply_to_user": {"reputation": 1141, "user_id": 4031869, "user_type": "registered", "profile_image": "https://graph.facebook.com/601937077/picture?type=large", "display_name": "Matt Clark", "link": "https://stackoverflow.com/users/4031869/matt-clark"}, "edited": false, "score": 0, "creation_date": 1423683807, "post_id": 28462754, "comment_id": 45251978, "body": "@MattClark Clark, I suppose they make use of _holder assigning to this at the beginning because of the recursive look in all the components inside the composite, that can also be composites. It means, that if we do find a Component, that is not a Composite and the only item in the hierarchy (i mean it should be a leaf), the holder should be assigned to null. I am not sure about my assumption anyway :)"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 3336406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/14417a2fe54b3a1018a1d1cad00d4698?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/3336406/eugene"}, "edited": false, "score": 0, "creation_date": 1423683230, "post_id": 28462885, "comment_id": 45251625, "body": "Firstly, I was wondering if _holder could be changed in Find method during recursion, as not all of the components are the actual composites, but as _holder is still assigned right in the start of Find method, makes no sense for my assumption."}, {"owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "reply_to_user": {"reputation": 157, "user_id": 3336406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/14417a2fe54b3a1018a1d1cad00d4698?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/3336406/eugene"}, "edited": false, "score": 0, "creation_date": 1423683655, "post_id": 28462885, "comment_id": 45251895, "body": "_holder cannot just become null because of the find operation."}], "tags": [], "owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "is_accepted": true, "score": 1, "last_activity_date": 1423683003, "creation_date": 1423683003, "answer_id": 28462885, "question_id": 28462754, "link": "https://stackoverflow.com/questions/28462754/understanding-composite-pattern-via-c-removet-item-function-implementation/28462885#28462885", "title": "Understanding Composite Pattern via C#, Remove(T item) function implementation", "body": "<p>The check is meant for p and not this because this cannot be null.</p>\n\n<pre><code>_holder = this;\n    IComponent&lt;T&gt; p = _holder.Find(item);\n    if (_holder != null)\n</code></pre>\n\n<p>this cannot be null\nso _holder cannot be null either\nbut the find can return null\nand it is very logical to check the result of find before doing a remove.</p>\n\n<p>Another possibility is that </p>\n\n<pre><code>_holder as Composite&lt;T&gt; is null ?\n</code></pre>\n\n<p>so </p>\n\n<pre><code>if (_holder as Composite&lt;T&gt;==null) \n</code></pre>\n\n<p>is also a valid check.</p>\n"}, {"tags": [], "owner": {"reputation": 59217, "user_id": 156695, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3390f053c9414f150c48f700afaa3e7a?s=128&d=identicon&r=PG", "display_name": "Tigran", "link": "https://stackoverflow.com/users/156695/tigran"}, "is_accepted": false, "score": 1, "last_activity_date": 1423683101, "creation_date": 1423683101, "answer_id": 28462911, "question_id": 28462754, "link": "https://stackoverflow.com/questions/28462754/understanding-composite-pattern-via-c-removet-item-function-implementation/28462911#28462911", "title": "Understanding Composite Pattern via C#, Remove(T item) function implementation", "body": "<p>Most probably this is a mistake, also because of </p>\n\n<pre><code>     IComponent&lt;T&gt; p = _holder.Find(item); //THIS LINE !\n    if (_holder != null)\n    {\n        (_holder as Composite&lt;T&gt;)._items.Remove(p);\n        return _holder;\n    }\n</code></pre>\n\n<p>If we somehow concerned about <code>_holder</code> become a <code>null</code> (reflection, multithreading...)  why we don't check for that on the line before ? What does guarantee me that on that line <code>_holder</code> is <em>not</em> a <code>null</code>, if we assume that it can become such in this case somehow ? </p>\n\n<p>So, most probably, an error.</p>\n"}], "owner": {"reputation": 157, "user_id": 3336406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/14417a2fe54b3a1018a1d1cad00d4698?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/3336406/eugene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 28462885, "answer_count": 2, "score": 0, "last_activity_date": 1423683101, "creation_date": 1423682599, "question_id": 28462754, "link": "https://stackoverflow.com/questions/28462754/understanding-composite-pattern-via-c-removet-item-function-implementation", "title": "Understanding Composite Pattern via C#, Remove(T item) function implementation", "body": "<p>I am working on the <strong>Composite Pattern</strong>, using the examples from C# 3.0 Design Patterns by Judith Bishop (Page 55).</p>\n\n<p>The question I am stacking on concerns the function from <strong>Composite class:\npublic IComponent Remove(T item)</strong> \nWhat is the sense of making the following IF statement </p>\n\n<pre><code> if (_holder != null)\n            {\n                (_holder as Composite&lt;T&gt;)._items.Remove(p);\n                return _holder;\n            }\n</code></pre>\n\n<p>in</p>\n\n<pre><code>public IComponent&lt;T&gt; Remove(T item)\n    {\n        _holder = this;\n        IComponent&lt;T&gt; p = _holder.Find(item);\n        if (_holder != null)\n        {\n            (_holder as Composite&lt;T&gt;)._items.Remove(p);\n            return _holder;\n        }\n        else\n        {\n            return this;\n        }\n    }\n\n    //Recursively looks for an item\n    //Returns its reference or else null\n    public IComponent&lt;T&gt; Find(T item)\n    {\n        _holder = this;\n        if(Item.Equals(item))\n        {\n            return this;\n        }\n        IComponent&lt;T&gt; found = null;\n        foreach(IComponent&lt;T&gt; comp in _items)\n        {\n            found = comp.Find(item);\n            if(found != null)\n            {\n                break;\n            }\n        }\n        return found;\n    }\n</code></pre>\n\n<p>As far as I am concerned, _holder variable is always assigned in both <strong>Remove</strong> and <strong>Find</strong> functions and therefore cannot be null. \nDo they mean <strong>p</strong> referece to be checked for null instead?</p>\n\n<p><strong>Interface IComponent</strong></p>\n\n<pre><code> public interface IComponent&lt;T&gt;\n{\n    void Add(IComponent&lt;T&gt; component);\n    IComponent&lt;T&gt; Remove(T s);\n    IComponent&lt;T&gt; Find(T s);\n    string Display(int depth);\n    T Item { get; set; }\n}\n</code></pre>\n\n<p><strong>Component class implementation:</strong></p>\n\n<pre><code>    class Component&lt;T&gt; : IComponent&lt;T&gt;\n{\n    public T Item { get; set; }\n\n    public Component(T item)\n    {\n        Item = item;\n    }\n\n    public void Add(IComponent&lt;T&gt; item)\n    {\n        Console.WriteLine(\"Cannot add to Single item!\");\n    }\n\n    public IComponent&lt;T&gt; Remove(T item)\n    {\n        Console.WriteLine(\"Cannot remove directly the Single item\");\n        return this;\n    }\n\n    public IComponent&lt;T&gt; Find(T item)\n    {\n        if (Item.Equals(item))\n        {\n            return this;\n        }\n        return null;\n    }\n\n    public string Display(int depth)\n    {\n        return string.Format(\"-{0}---{1}\", depth, Item);\n    }\n}\n</code></pre>\n\n<p><strong>Composite class implementation:</strong></p>\n\n<pre><code>public class Composite&lt;T&gt; : IComponent&lt;T&gt;\n{\n    public T Item { get; set; }\n    private List&lt;IComponent&lt;T&gt;&gt; _items = new List&lt;IComponent&lt;T&gt;&gt;();\n    private IComponent&lt;T&gt; _holder;\n\n    public Composite(T item)\n    {\n        Item = item;\n    }\n\n    public void Add(IComponent&lt;T&gt; item)\n    {\n        _items.Add(item);\n    }\n\n    //Finds the item from a particular point in the structure\n    //and returns the composite from which it was removed\n    //If not found, return the point as given\n    public IComponent&lt;T&gt; Remove(T item)\n    {\n        _holder = this;\n        IComponent&lt;T&gt; p = _holder.Find(item);\n        if (_holder != null)\n        {\n            (_holder as Composite&lt;T&gt;)._items.Remove(p);\n            return _holder;\n        }\n        else\n        {\n            return this;\n        }\n    }\n\n    //Recursively looks for an item\n    //Returns its reference or else null\n    public IComponent&lt;T&gt; Find(T item)\n    {\n        _holder = this;\n        if(Item.Equals(item))\n        {\n            return this;\n        }\n        IComponent&lt;T&gt; found = null;\n        foreach(IComponent&lt;T&gt; comp in _items)\n        {\n            found = comp.Find(item);\n            if(found != null)\n            {\n                break;\n            }\n        }\n        return found;\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "xml", "wpf", "datagrid"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1423682549, "post_id": 28462672, "comment_id": 45251185, "body": "sounds to me at first glance as well as reading what you were describing, to be a <code>BINDING</code> Issue"}, {"owner": {"reputation": 41499, "user_id": 643085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svAcm.png?s=128&g=1", "display_name": "Federico Berasategui", "link": "https://stackoverflow.com/users/643085/federico-berasategui"}, "edited": false, "score": 0, "creation_date": 1423683424, "post_id": 28462672, "comment_id": 45251754, "body": "<i>Everytime I see/hear anyone talking about WPF UIs and using the word &quot;dynamic&quot;, I immediately recognize they&#39;re doing everything wrong.</i> Delete all that horrendous code and use proper DataBinding and an ItemsControl for whatever you&#39;re trying to do."}], "owner": {"reputation": 155, "user_id": 4536612, "user_type": "registered", "accept_rate": 24, "profile_image": "https://i.stack.imgur.com/FMS8a.jpg?s=128&g=1", "display_name": "Vasiliy Terkin", "link": "https://stackoverflow.com/users/4536612/vasiliy-terkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423682339, "creation_date": 1423682339, "last_edit_date": 1495542035, "question_id": 28462672, "link": "https://stackoverflow.com/questions/28462672/dynamic-adding-new-datagrids", "title": "Dynamic adding new DataGrids", "body": "<p>I have DataGrid on TabItem, identified in XAML file.</p>\n\n<pre><code>&lt;TabItem Header=\"\u041d\u043e\u0432\u0430\u044f \u0432\u043a\u043b\u0430\u0434\u043a\u0430\"&gt;\n      &lt;TabItem.DataContext&gt;\n            &lt;XmlDataProvider x:Name=\"XMLData\" Source=\"/database/stroyka1.bas\" XPath=\"JobArray/job\"/&gt;\n      &lt;/TabItem.DataContext&gt;\n            &lt;DataGrid \n             Name=\"JobsDataGrid\" \n             ItemsSource=\"{Binding}\"\n             AutoGenerateColumns=\"false\" Height=\"Auto\" Width=\"Auto\"\n             IsReadOnly=\"False\" CanUserAddRows=\"True\"&gt;\n                  &lt;DataGrid.Columns&gt;\n                      &lt;DataGridTextColumn Header=\"ID\" Binding=\"{Binding XPath=id, Mode=TwoWay}\" /&gt;\n                      &lt;DataGridTextColumn Header=\"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435\" Binding=\"{Binding XPath=name, Mode=TwoWay}\" /&gt;\n                      &lt;DataGridTextColumn Header=\"\u0426\u0435\u043d\u0430 \u0437\u0430 \u0435\u0434\u0438\u043d\u0438\u0446\u0443\" Binding=\"{Binding XPath=price, Mode=TwoWay}\"/&gt;\n                       &lt;DataGridTextColumn Header=\"\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f\" Binding=\"{Binding XPath=measure, Mode=TwoWay}\"/&gt;\n                        &lt;/DataGrid.Columns&gt;\n             &lt;/DataGrid&gt;\n      &lt;/TabItem&gt;    \n</code></pre>\n\n<p>This works perfectly, and i find method to <a href=\"https://stackoverflow.com/questions/28363243/how-add-row-to-datagrid\">add new rows</a> in this DataGrid. But i need in more tabs with DataGrids simultaneously. I tried to create new DataGrid in new TabItem, but i saw empty rows. \nMy code:</p>\n\n<pre><code>private void OpenBaseMenuItem_OnClick(object sender, RoutedEventArgs e)\n    {\n        var curTabOpFDial = new OpenFileDialog();  //open new XML-file\n        curTabOpFDial.ShowDialog();\n        var tempTabItem = new TabItem();       //create new TabItem in TabControl\n        tempTabItem.Header = curTabOpFDial.SafeFileName;        //rename name of Tab\n\n        var curTabDG = new DataGrid();       //create new DataGrid\n\n        var curTabXmlDP = new XmlDataProvider();   //new XMLDataProvider\n\n        var curTabUri = new Uri(curTabOpFDial.FileName); //edit xmldataprovider properties\n        curTabXmlDP.Source = curTabUri;\n        curTabXmlDP.XPath = \"JobArray/job\";\n\n        tempTabItem.DataContext = curTabXmlDP;    //create new link with TabItem and XMLDataProvider\n\n        DataGridTextColumn curTabDGTC = new DataGridTextColumn();   //creating 1 column for example\n        curTabDGTC.Header = \"ID\";\n        curTabDGTC.Binding = new Binding(){Source = curTabXmlDP, XPath = \"id\", Mode=BindingMode.TwoWay}; \n\n        curTabDG.Columns.Add(curTabDGTC);\n        tempTabItem.Content = curTabDG;\n        GeneralTabControl.Items.Add(tempTabItem);\n\n\n    }\n</code></pre>\n\n<p>As you can see - i tried to just move all of the XAML, but it don't works :(</p>\n"}, {"tags": ["c#", "excel", "reflection", "late-binding"], "comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 1, "creation_date": 1423683748, "post_id": 28462657, "comment_id": 45251947, "body": "Try using <code>Path.Combine(filepath,&quot;.xls&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 3223834, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/502c348ed533506bf88fcc4f9f0388bb?s=128&d=identicon&r=PG&f=1", "display_name": "user3223834", "link": "https://stackoverflow.com/users/3223834/user3223834"}, "edited": false, "score": 0, "creation_date": 1423749033, "post_id": 28464968, "comment_id": 45280794, "body": "Thanks @ReinerSchaack I thought the same at some point but I believe there is reason for that (may be not a good one), there are so many apps that use this library that I&#39;ll need to try to test on all of them first."}, {"owner": {"reputation": 59, "user_id": 3223834, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/502c348ed533506bf88fcc4f9f0388bb?s=128&d=identicon&r=PG&f=1", "display_name": "user3223834", "link": "https://stackoverflow.com/users/3223834/user3223834"}, "edited": false, "score": 0, "creation_date": 1423751322, "post_id": 28464968, "comment_id": 45282362, "body": "Ok, I believe is because if someone write the file name with an extension different than .xls (such as .xslx) it will have a compatibility issue. But that can be handled, so I&#39;ll do as you suggested. Thank you @Rainer"}], "tags": [], "owner": {"reputation": 1458, "user_id": 4547223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ylCvJ.jpg?s=128&g=1", "display_name": "Rainer Schaack", "link": "https://stackoverflow.com/users/4547223/rainer-schaack"}, "is_accepted": true, "score": 0, "last_activity_date": 1423690558, "creation_date": 1423690558, "answer_id": 28464968, "question_id": 28462657, "link": "https://stackoverflow.com/questions/28462657/how-allow-for-in-an-excel-file-name-when-saving-as-using-late-binding/28464968#28464968", "title": "How allow for &#39;.&#39; in an Excel file name when &#39;saving as&#39; using late binding?", "body": "<p>Why do you remove .xls from your filepath with</p>\n\n<pre><code>filepath.Remove(filepath.LastIndexOf(\".\"))\n</code></pre>\n\n<p>I just tested this myself, if I use just <code>filepath</code> as in</p>\n\n<pre><code>workbook.GetType().InvokeMember(\"SaveAs\", BindingFlags.InvokeMethod, \nnull, workbook, new Object[] { filepath, 56 });\n</code></pre>\n\n<p>it works for me</p>\n"}], "owner": {"reputation": 59, "user_id": 3223834, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/502c348ed533506bf88fcc4f9f0388bb?s=128&d=identicon&r=PG&f=1", "display_name": "user3223834", "link": "https://stackoverflow.com/users/3223834/user3223834"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 28464968, "answer_count": 1, "score": 0, "last_activity_date": 1423690558, "creation_date": 1423682303, "last_edit_date": 1423683647, "question_id": 28462657, "link": "https://stackoverflow.com/questions/28462657/how-allow-for-in-an-excel-file-name-when-saving-as-using-late-binding", "title": "How allow for &#39;.&#39; in an Excel file name when &#39;saving as&#39; using late binding?", "body": "<p>I just came up with  this issue, we have a library that uses Reflection to manipulate Excel files. When a user is trying to save a file that has a <code>.</code> in the file name (eg: <code>01.02.xls</code>) it won't include .xls in the saved file (result: <code>01.02</code>).</p>\n\n<p><code>workbook.GetType().InvokeMember(\"SaveAs\", BindingFlags.InvokeMethod, null, workbook, new Object[] { filepath.Remove(filepath.LastIndexOf(\".\")), 56 });</code></p>\n\n<p>Is there an option that allows <code>.</code> inside the file name?</p>\n"}, {"tags": ["c#", "android", ".net"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1423682378, "post_id": 28462643, "comment_id": 45251071, "body": "the error message tells you exactly what the problem is .. do you know the difference between <code>string and byte[]</code> or even string and this symbol <code>[]</code> one is an array of something the other is not.. also you have the source code at your finger tips.. so <code>Use the DEBUGGER!!</code>"}, {"owner": {"reputation": 14440, "user_id": 1862812, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/rO3KD.jpg?s=128&g=1", "display_name": "Nikolay Kostov", "link": "https://stackoverflow.com/users/1862812/nikolay-kostov"}, "edited": false, "score": 0, "creation_date": 1423682381, "post_id": 28462643, "comment_id": 45251073, "body": "Where is your exception? Is it here: <code>(byte[])Request.Params[&quot;IMAGE&quot;];</code>? If so check this: <a href=\"http://stackoverflow.com/questions/472906/converting-a-string-to-byte-array-without-using-an-encoding-byte-by-byte\" title=\"converting a string to byte array without using an encoding byte by byte\">stackoverflow.com/questions/472906/&hellip;</a>"}, {"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1423682463, "post_id": 28462643, "comment_id": 45251126, "body": "You write the image to body (<code>addBinaryBody</code>) and try to read from url  (<code>Request.Params</code>) (BTW: <a href=\"http://www.telerik.com/fiddler\" rel=\"nofollow noreferrer\">Fiddler</a> is a very good tool when developing web apps )"}, {"owner": {"reputation": 6823, "user_id": 2382728, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/ILv9S.jpg?s=128&g=1", "display_name": "Philip Stuyck", "link": "https://stackoverflow.com/users/2382728/philip-stuyck"}, "edited": false, "score": 1, "creation_date": 1423682745, "post_id": 28462643, "comment_id": 45251316, "body": "This is actually already been answered here :  <a href=\"http://stackoverflow.com/questions/472906/converting-a-string-to-byte-array-without-using-an-encoding-byte-by-byte\" title=\"converting a string to byte array without using an encoding byte by byte\">stackoverflow.com/questions/472906/&hellip;</a>"}, {"owner": {"reputation": 5718, "user_id": 1094001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OlYQ0.jpg?s=128&g=1", "display_name": "Mert", "link": "https://stackoverflow.com/users/1094001/mert"}, "edited": false, "score": 0, "creation_date": 1423683795, "post_id": 28462643, "comment_id": 45251973, "body": "Philip I tried your solution but I think It cant convert to Image, as you see at top I can get &quot;GetBytes 1&quot; , &quot;GetBytes 2&quot;, &quot;HERE&quot; but no log after that &quot;Parameter is not valid.&quot; exception."}, {"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1423684501, "post_id": 28462643, "comment_id": 45252358, "body": "Mert, have you read my comment? Your problem is not related with string/byte[] conversion. You can not get your image like <code>Request.Params[&quot;IMAGE&quot;]</code>"}, {"owner": {"reputation": 5718, "user_id": 1094001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OlYQ0.jpg?s=128&g=1", "display_name": "Mert", "link": "https://stackoverflow.com/users/1094001/mert"}, "edited": false, "score": 0, "creation_date": 1423684644, "post_id": 28462643, "comment_id": 45252419, "body": "why is that? when I write bytes to text file all is there."}, {"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1423684770, "post_id": 28462643, "comment_id": 45252490, "body": "Mert Please read some docs about HTTP protocol. It has a <i>header</i> and a <i>body</i> or <i>content</i>.  You have different methods to read/write different parts of an HTTP request/response."}, {"owner": {"reputation": 5718, "user_id": 1094001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OlYQ0.jpg?s=128&g=1", "display_name": "Mert", "link": "https://stackoverflow.com/users/1094001/mert"}, "edited": false, "score": 0, "creation_date": 1423684833, "post_id": 28462643, "comment_id": 45252525, "body": "what do you suggest about sending image to .net web app?"}, {"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 1, "creation_date": 1423684910, "post_id": 28462643, "comment_id": 45252566, "body": "Mert at first glance, it seems your sending code is OK(I am not an Android developer). just forget <code>Request.Params</code> and search how you can read the <b>content</b> of the request."}, {"owner": {"reputation": 5718, "user_id": 1094001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OlYQ0.jpg?s=128&g=1", "display_name": "Mert", "link": "https://stackoverflow.com/users/1094001/mert"}, "edited": false, "score": 0, "creation_date": 1423686480, "post_id": 28462643, "comment_id": 45253408, "body": "EZI, I followed your guidance and looked for another way around to send the image and found, thanks for your contribution."}], "answers": [{"tags": [], "owner": {"reputation": 5718, "user_id": 1094001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OlYQ0.jpg?s=128&g=1", "display_name": "Mert", "link": "https://stackoverflow.com/users/1094001/mert"}, "is_accepted": true, "score": 0, "last_activity_date": 1423686828, "last_edit_date": 1423686828, "creation_date": 1423686403, "answer_id": 28463830, "question_id": 28462643, "link": "https://stackoverflow.com/questions/28462643/cannot-convert-type-string-to-byte/28463830#28463830", "title": "Cannot convert type &#39;string&#39; to &#39;byte[]&#39;", "body": "<p>This is how I could sloved the issue, If someone else also need;</p>\n\n<p>ANDRIOD</p>\n\n<pre><code>            File photo = new File(Environment.getExternalStorageDirectory(), \"photo.jpg\");\n\n            BitmapFactory.Options options = new BitmapFactory.Options();\n            options.inPreferredConfig = Bitmap.Config.ARGB_8888;\n            Bitmap bitmap = BitmapFactory.decodeFile(photo.getAbsolutePath(), options);\n            //selected_photo.setImageBitmap(bitmap);\n\n               HttpClient httpClient = new DefaultHttpClient();\n               HttpPost post = new HttpPost(urls[0]);\n\n                MultipartEntityBuilder entityBuilder = MultipartEntityBuilder.create();\n                entityBuilder.setMode(HttpMultipartMode.BROWSER_COMPATIBLE);\n\n                try{\n                    ByteArrayOutputStream bos = new ByteArrayOutputStream();\n                    bitmap.compress(CompressFormat.JPEG, 75, bos);\n                    byte[] data = bos.toByteArray();\n                    ByteArrayBody bab = new ByteArrayBody(data, \"forest.jpg\");\n                    entityBuilder.addPart(\"IMAGE\", bab);\n                }\n                catch(Exception e){\n                    //Log.v(\"Exception in Image\", \"\"+e);\n                }\n\n                HttpEntity entity = entityBuilder.build();\n                post.setEntity(entity);   \n                HttpResponse response = null;\n                try {\n                    response = httpClient.execute(post);\n                } catch (ClientProtocolException e) {\n                    // TODO Auto-generated catch block\n                    e.printStackTrace();\n                } catch (IOException e) {\n                    // TODO Auto-generated catch block\n                    e.printStackTrace();\n                }\n                BufferedReader reader = null;\n                try {\n                    reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent(), \"UTF-8\"));\n                } catch (UnsupportedEncodingException e1) {\n                    // TODO Auto-generated catch block\n                    e1.printStackTrace();\n                } catch (IllegalStateException e1) {\n                    // TODO Auto-generated catch block\n                    e1.printStackTrace();\n                } catch (IOException e1) {\n                    // TODO Auto-generated catch block\n                    e1.printStackTrace();\n                }\n                String sResponse;\n                StringBuilder s = new StringBuilder();\n                try {\n                    while ((sResponse = reader.readLine()) != null) {\n                        s = s.append(sResponse);\n                    }\n                } catch (IOException e) {\n                    // TODO Auto-generated catch block\n                    e.printStackTrace();\n                }\n</code></pre>\n\n<p>.NET</p>\n\n<pre><code>        HttpFileCollection files = Request.Files;\n\n        HttpPostedFile file = files[0];\n        int filelength = file.ContentLength;\n        byte[] input = new byte[filelength];\n        file.InputStream.Read(input, 0, filelength);\n        file.SaveAs(@\"C:/doka/output.jpg\");\n</code></pre>\n"}], "owner": {"reputation": 5718, "user_id": 1094001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OlYQ0.jpg?s=128&g=1", "display_name": "Mert", "link": "https://stackoverflow.com/users/1094001/mert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 28463830, "answer_count": 1, "score": -1, "last_activity_date": 1423686828, "creation_date": 1423682262, "last_edit_date": 1423683693, "question_id": 28462643, "link": "https://stackoverflow.com/questions/28462643/cannot-convert-type-string-to-byte", "title": "Cannot convert type &#39;string&#39; to &#39;byte[]&#39;", "body": "<p>I am trying to send from android and get from .net page, I can get string parameter but I have difficult time getting byte array.</p>\n\n<p>ANDROID</p>\n\n<pre><code>            HttpClient client = new DefaultHttpClient();\n\n            HttpPost post = new HttpPost(urls[0]);\n\n            MultipartEntityBuilder entityBuilder = MultipartEntityBuilder.create();\n            entityBuilder.setMode(HttpMultipartMode.BROWSER_COMPATIBLE);\n\n            entityBuilder.addTextBody(\"X\", \"Y\");\n\n            File photo= new File(Environment.getExternalStorageDirectory(), \"photo.jpg\");\n\n            if(photo != null)\n            {\n                entityBuilder.addBinaryBody(\"IMAGE\", photo);\n            }\n\n            HttpEntity entity = entityBuilder.build();\n            post.setEntity(entity);\n            HttpResponse response = client.execute(post);\n            HttpEntity httpEntity = response.getEntity();\n            String result = EntityUtils.toString(httpEntity);\n</code></pre>\n\n<p>.NET</p>\n\n<pre><code>        byte[] bitmap = (byte[])Request.Params[\"IMAGE\"];\n\n        using (System.Drawing.Image image = System.Drawing.Image.FromStream(new MemoryStream(bitmap)))\n        {\n            image.Save(@\"C:/output.jpg\", ImageFormat.Jpeg);\n        }\n</code></pre>\n\n<p>TRY 1</p>\n\n<pre><code>        byte[] bitmap = GetBytes(Request.Form[\"IMAGE\"]);\n\n        Log(\"HERE\");\n\n        using (System.Drawing.Image image = System.Drawing.Image.FromStream(new MemoryStream(bitmap)))\n        {\n            Log(\"Save 1\");\n            image.Save(@\"C:/doka/output.jpg\", ImageFormat.Jpeg);  // Or Png\n            Log(\"Save 2\");\n        }\n    }\n\n    static byte[] GetBytes(string str)\n    {\n        Log(\"GetBytes 1\");\n\n        byte[] bytes = new byte[str.Length * sizeof(char)];\n        System.Buffer.BlockCopy(str.ToCharArray(), 0, bytes, 0, bytes.Length);\n        Log(\"GetBytes 2\");\n\n        return bytes;\n    }\n</code></pre>\n"}, {"tags": ["c#", "html", "css", "model-view-controller", "formatting"], "comments": [{"owner": {"reputation": 5962, "user_id": 1210520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8eb2dc57160dab46084a9f30f18a1a?s=128&d=identicon&r=PG", "display_name": "Steve Czetty", "link": "https://stackoverflow.com/users/1210520/steve-czetty"}, "edited": false, "score": 1, "creation_date": 1423682544, "post_id": 28462588, "comment_id": 45251179, "body": "It looks like you&#39;re missing a link to your css"}, {"owner": {"reputation": 370, "user_id": 3990513, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1334874792/picture?type=large", "display_name": "Eli Hellmer", "link": "https://stackoverflow.com/users/3990513/eli-hellmer"}, "reply_to_user": {"reputation": 5962, "user_id": 1210520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8eb2dc57160dab46084a9f30f18a1a?s=128&d=identicon&r=PG", "display_name": "Steve Czetty", "link": "https://stackoverflow.com/users/1210520/steve-czetty"}, "edited": false, "score": 0, "creation_date": 1423682756, "post_id": 28462588, "comment_id": 45251325, "body": "Thanks @SteveCzetty , simple fix I overlooked."}], "answers": [{"tags": [], "owner": {"reputation": 2643, "user_id": 1585362, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ee74d28f8fcc51040680c406135802c2?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/1585362/jack"}, "is_accepted": true, "score": 1, "last_activity_date": 1423682816, "creation_date": 1423682816, "answer_id": 28462834, "question_id": 28462588, "link": "https://stackoverflow.com/questions/28462588/losing-all-formatting-when-using-layout-null/28462834#28462834", "title": "Losing all formatting when using Layout = null?", "body": "<p>If your Layout page holds all of your css references, your content page will only have css if you reference the layout page.</p>\n"}], "owner": {"reputation": 370, "user_id": 3990513, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1334874792/picture?type=large", "display_name": "Eli Hellmer", "link": "https://stackoverflow.com/users/3990513/eli-hellmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 28462834, "answer_count": 1, "score": 0, "last_activity_date": 1423682816, "creation_date": 1423682125, "last_edit_date": 1423682507, "question_id": 28462588, "link": "https://stackoverflow.com/questions/28462588/losing-all-formatting-when-using-layout-null", "title": "Losing all formatting when using Layout = null?", "body": "<p>I am pulling out my hair trying to figure out what is going on here. I have a view with some very simple html/css code:</p>\n\n<pre><code>@model MyViewmodel\n@{\n    Layout = null;\n\n}\n&lt;html&gt;\n\n&lt;body&gt;  \n@if (ViewBag.LabelSize == \"Small\")\n        {\n\n            &lt;div class=\"row\"&gt;\n                &lt;div class=\"col-md-2\"&gt;\n                    &lt;h6&gt;&lt;b&gt;Owner&lt;/b&gt;: @Model.ownerLabel&lt;/h6&gt;\n\n                &lt;/div&gt;\n                &lt;div class=\"col-md-2\"&gt;\n                    &lt;h6&gt;&lt;b&gt;Model&lt;/b&gt;: @Model.modelNum&lt;/h6&gt;\n\n                &lt;/div&gt;\n                &lt;div class=\"col-md-8\"&gt;\n                    &lt;img src=\"data:image;base64,@System.Convert.ToBase64String(@Model.BarcodeImage)\" /&gt;\n\n                &lt;/div&gt;\n\n            &lt;/div&gt;\n            &lt;div class=\"row\"&gt;\n                &lt;div class=\"col-md-2\"&gt;\n                    &lt;h6&gt;&lt;b&gt;Serial&lt;/b&gt;: @Model.serialNum&lt;/h6&gt;\n                    &lt;h6&gt;&lt;b&gt;Project&lt;/b&gt;: @Model.project&lt;/h6&gt;\n\n                &lt;/div&gt;\n                &lt;div class=\"col-md-10\"&gt;&lt;/div&gt;\n\n            &lt;/div&gt;\n            &lt;div class=\"row\"&gt;\n                &lt;div class=\"col-md-2\"&gt;\n                    &lt;h6&gt;&lt;b&gt;Recieved&lt;/b&gt;: @Model.newDate&lt;/h6&gt;\n\n                &lt;/div&gt;\n                &lt;div class=\"col-md-10\"&gt;&lt;/div&gt;\n\n            &lt;/div&gt;\n\n\n        }\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>I am creating a \"printable\" page for a barcode label. The page just needs to be completely white except for the label details. So that is my reason for Layout = null. </p>\n\n<p>My problem is that when I set the layout to null, it display my model data, but it ignores my div tags and columns. I even checked in debug mode, it literally skips the row and container tags, all while hitting the Model information. If I delete the layout = null, and just use my regular layout, it organizes my data exactly how i want. What is going on here? I thought the if statement was causing it, but apparently not.</p>\n\n<p>Does setting the Layout = null; completely remove even the views formatting?</p>\n"}, {"tags": ["c#", "authentication", "asp.net-web-api"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1423682309, "post_id": 28462533, "comment_id": 45251019, "body": "anythings possible-- what have you tried..? did you try a simple google search.. here is an example if you know <code>Angular.js</code> <a href=\"http://www.codeproject.com/Articles/784106/AngularJS-Token-Authentication-using-ASP-NET-Web-A\" rel=\"nofollow noreferrer\">codeproject.com/Articles/784106/&hellip;</a>"}, {"owner": {"reputation": 139, "user_id": 1703588, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PyWIO.jpg?s=128&g=1", "display_name": "Gowrish", "link": "https://stackoverflow.com/users/1703588/gowrish"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1423707459, "post_id": 28462533, "comment_id": 45261701, "body": "i tried but i dont know how to validate a bearer token since WebAPI is a stateless how do we can validate a bearer token? we need to store each users token somewhere in API right? Is that a correct way?"}, {"owner": {"reputation": 10823, "user_id": 1567352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/bdfeb44480b0de2237a5fe8001b8233b?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan Green", "link": "https://stackoverflow.com/users/1567352/brendan-green"}, "edited": false, "score": 0, "creation_date": 1423715780, "post_id": 28462533, "comment_id": 45263798, "body": "The bearer token should be validated by WebAPI by way of the <code>[Authorize]</code> attribute.  The token is encrypted and isn&#39;t persisted to storage by the WebAPI if that is what you were meaning..."}, {"owner": {"reputation": 139, "user_id": 1703588, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PyWIO.jpg?s=128&g=1", "display_name": "Gowrish", "link": "https://stackoverflow.com/users/1703588/gowrish"}, "edited": false, "score": 0, "creation_date": 1423721711, "post_id": 28462533, "comment_id": 45265642, "body": "Assume, inorder to make the unique token for each time the user log in i would create a token based on date time so inorder to validate the token wont we need to store the generated token somewhere, so that we can validate the forthcoming request tokens against stored tokens?"}], "owner": {"reputation": 139, "user_id": 1703588, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PyWIO.jpg?s=128&g=1", "display_name": "Gowrish", "link": "https://stackoverflow.com/users/1703588/gowrish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 721, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1423712615, "creation_date": 1423681928, "last_edit_date": 1423707167, "question_id": 28462533, "link": "https://stackoverflow.com/questions/28462533/bearer-token-authentication-with-web-api-1", "title": "bearer token authentication with web api 1", "body": "<p>I'm working on implementing token based authentication in ASP.NET WebAPI.\nIs it possible to implement bearer token authentication in WebAPI 1.2?</p>\n\n<p><strong>update:</strong></p>\n\n<p>The problem is all the examples i see is based on WebAPI 2 and OWIN. WebAPI 2 came up with a dedicated authenticate attribute, but i am looking for WebAPI 1.2 it only having authorize attribute. We need to override the onAuthorize method and implement the token validation logic. but i dont know how to implement bearer token and set expiry time for that token. more over how to generate a new token if  a token is expired. somewhere do i need to store the generated token inorder to validate?</p>\n\n<pre><code>public class APIAuthentication : AuthorizationFilterAttribute\n{\n    private const string BasicAuthResponseHeader = \"WWW-Authenticate\";\n    private const string BasicAuthResponseHeaderValue = \"Basic\";\n\n    public override void OnAuthorization(HttpActionContext actionContext)\n    {\n        //logics for perform bearer token auth.\n        //if auth failed we ill be return 401 and auth type in header\n        HandleUnAuthorized(actionContext);\n    }\n\n    private void HandleUnAuthorized(HttpActionContext actionContext)\n    {\n        actionContext.Response = actionContext.ControllerContext.Request.CreateResponse(HttpStatusCode.Unauthorized);\n        actionContext.Response.Headers.Add(BasicAuthResponseHeader, BasicAuthResponseHeaderValue);\n    }\n}\n</code></pre>\n\n<p>Thanks,\nGowrish.</p>\n"}, {"tags": ["c#", "office-interop"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 2630543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2ffb0d1024f2a093d8ee9e96d758177?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/2630543/jeremy"}, "edited": false, "score": 0, "creation_date": 1423689927, "post_id": 28463052, "comment_id": 45255257, "body": "<i>facepalm</i>  I got so fixed on getting SaveAs to work, I didn&#39;t think about the obvious solution.  Thanks!  :)"}], "tags": [], "owner": {"reputation": 679, "user_id": 342468, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/494e5ac11f11979969009aeabb9568ce?s=128&d=identicon&r=PG", "display_name": "Alex T", "link": "https://stackoverflow.com/users/342468/alex-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1423683625, "creation_date": 1423683625, "answer_id": 28463052, "question_id": 28462526, "link": "https://stackoverflow.com/questions/28462526/word-interop-12-saveas-new-filename-without-dialog/28463052#28463052", "title": "Word Interop 12: SaveAs new filename without dialog", "body": "<p>Why not create a copy of the document before you open it?</p>\n\n<p>For example, lets say you're going to modify c:\\docs\\myfile.docx using your script, and you want to save the modified version as c:\\newdocs\\newfile.docx.</p>\n\n<p>Before opening Word in your script, do a File.Move(\"c:\\docs\\myfile.docx\", \"c:\\newdocs\\newfile.docx\"); and then open the target file, make your changes, and do a document.Save();</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 2630543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2ffb0d1024f2a093d8ee9e96d758177?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/2630543/jeremy"}, "edited": false, "score": 0, "creation_date": 1423688447, "post_id": 28464021, "comment_id": 45254496, "body": "SaveAs2() isn&#39;t available, only SaveAs() and SaveAsQuickStyleSet().  Is that because I am using an older Interop interface?  (12)"}], "tags": [], "owner": {"reputation": 25947, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1423687050, "creation_date": 1423687050, "answer_id": 28464021, "question_id": 28462526, "link": "https://stackoverflow.com/questions/28462526/word-interop-12-saveas-new-filename-without-dialog/28464021#28464021", "title": "Word Interop 12: SaveAs new filename without dialog", "body": "<p>Try to specify the filename and fileformat for the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836084(v=office.15).aspx\" rel=\"nofollow\">SaveAs2</a> method of the Document class.</p>\n"}], "owner": {"reputation": 85, "user_id": 2630543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2ffb0d1024f2a093d8ee9e96d758177?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/2630543/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1635, "favorite_count": 0, "accepted_answer_id": 28463052, "answer_count": 2, "score": 0, "last_activity_date": 1423687050, "creation_date": 1423681891, "last_edit_date": 1423682389, "question_id": 28462526, "link": "https://stackoverflow.com/questions/28462526/word-interop-12-saveas-new-filename-without-dialog", "title": "Word Interop 12: SaveAs new filename without dialog", "body": "<p>I am writing a Windows Explorer extension that opens an existing .docx file, edits a few things, and saves it to a different path and name.  It successfully opens the file, but when it hits the <code>document.SaveAs()</code> command it just opens the Save As dialog with the original filename and path, rather than saving to the new path.</p>\n\n<p>Here is the code section that handles the doc.</p>\n\n<pre><code>var application = new Microsoft.Office.Interop.Word.Application();\napplication.Visible = true;\n\nvar document = application.Documents.Open(\n    FileName: reviewRecordTemplatePath,\n    AddToRecentFiles: false,\n    Visible: true);\n\n// Do stuff...\n\ndocument.SaveAs(FileName: reviewRecordPath);\n</code></pre>\n"}, {"tags": ["c#", "xmlserializer"], "comments": [{"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1423682095, "post_id": 28462449, "comment_id": 45250907, "body": "I would use Linq2Xml for this."}, {"owner": {"reputation": 1523, "user_id": 2127492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f800566c6fb1137bad486a572ef986?s=128&d=identicon&r=PG", "display_name": "jrbeverly", "link": "https://stackoverflow.com/users/2127492/jrbeverly"}, "edited": false, "score": 0, "creation_date": 1423682181, "post_id": 28462449, "comment_id": 45250955, "body": "I would consider looking at <a href=\"https://msdn.microsoft.com/en-us/library/e5aakyae.aspx#Y114\" rel=\"nofollow noreferrer\">this</a>, the example may be what you are looking for"}, {"owner": {"reputation": 2329, "user_id": 62837, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/f97d27a8512fa0c79c5bcb45b68361c9?s=128&d=identicon&r=PG", "display_name": "Svein Fidjest&#248;l", "link": "https://stackoverflow.com/users/62837/svein-fidjest%c3%b8l"}, "edited": false, "score": 0, "creation_date": 1423682241, "post_id": 28462449, "comment_id": 45250983, "body": "This question should help you out: <a href=\"http://stackoverflow.com/questions/5940835/creating-xmlserializer-that-serializes-deserializes-derived-types-correctly\">Creating XmlSerializer that serializes/deserializes derived types correctly</a> - more specifically, this answer: <a href=\"http://stackoverflow.com/a/6334117/62837\">stackoverflow.com/a/6334117/62837</a>"}], "answers": [{"comments": [{"owner": {"reputation": 898, "user_id": 1411099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3367cdc6e469cb056cc6721d96307017?s=128&d=identicon&r=PG", "display_name": "Jordan Crittenden", "link": "https://stackoverflow.com/users/1411099/jordan-crittenden"}, "edited": false, "score": 0, "creation_date": 1423759753, "post_id": 28463044, "comment_id": 45288232, "body": "As I said in my comment below, there are many possible types, so this solution, although valid, is not ideal."}], "tags": [], "owner": {"reputation": 2023, "user_id": 4220169, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b71b07b928c4eddd58f75cf9465d3376?s=128&d=identicon&r=PG", "display_name": "David P", "link": "https://stackoverflow.com/users/4220169/david-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1423683601, "creation_date": 1423683601, "answer_id": 28463044, "question_id": 28462449, "link": "https://stackoverflow.com/questions/28462449/serializing-an-array-of-multiple-types-using-xmlserializer/28463044#28463044", "title": "Serializing an array of multiple types using XmlSerializer", "body": "<p>In your c# class, just make sure you always return an empty array of any possible types that might be returned:</p>\n\n<pre><code>    [Serializable]\npublic class create\n{\n    public create()\n    {\n        vendor = new Vendor[0];\n        customer = new Customer[0];\n        asset = new Asset[0];\n    }\n    Vendor[] vendor { get; set; }\n    Customer[] customer { get; set; }\n    Asset[] asset { get; set; }\n}\n[Serializable]\npublic class Vendor\n{\n    public string vendorid { get; set; }\n    public string name { get; set; }\n    public string vcf_bill_siteid3 { get; set; }\n}\n[Serializable]\npublic class Customer\n{\n    public string CUSTOMERID { get; set; }\n    public string NAME { get; set; }\n}\n[Serializable]\npublic class Asset\n{\n    public string createdAt { get; set; }\n    public string createdBy { get; set; }\n    public string serial_number { get; set; }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 898, "user_id": 1411099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3367cdc6e469cb056cc6721d96307017?s=128&d=identicon&r=PG", "display_name": "Jordan Crittenden", "link": "https://stackoverflow.com/users/1411099/jordan-crittenden"}, "edited": false, "score": 0, "creation_date": 1423759634, "post_id": 28473000, "comment_id": 45288141, "body": "This may be my only option. I wish there was a more convenient way because there are many possible types. I&#39;m specifically trying to generate xml to talk to an API as documented here: <a href=\"https://developer.intacct.com/wiki/create\" rel=\"nofollow noreferrer\">developer.intacct.com/wiki/create</a>. The valid object types are here: <a href=\"https://developer.intacct.com/wiki/functions-object\" rel=\"nofollow noreferrer\">developer.intacct.com/wiki/functions-object</a> - as you can see, there are hundreds."}, {"owner": {"reputation": 898, "user_id": 1411099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3367cdc6e469cb056cc6721d96307017?s=128&d=identicon&r=PG", "display_name": "Jordan Crittenden", "link": "https://stackoverflow.com/users/1411099/jordan-crittenden"}, "edited": false, "score": 0, "creation_date": 1423858258, "post_id": 28473000, "comment_id": 45334833, "body": "If this is what&#39;s necessary, I might just write my own serializer using Reflection. So far, I&#39;m pretty unimpressed with XmlSerializer. However, I&#39;ll mark your answer as accepted."}], "tags": [], "owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "is_accepted": false, "score": 3, "last_activity_date": 1423811037, "last_edit_date": 1423811037, "creation_date": 1423730977, "answer_id": 28473000, "question_id": 28462449, "link": "https://stackoverflow.com/questions/28462449/serializing-an-array-of-multiple-types-using-xmlserializer/28473000#28473000", "title": "Serializing an array of multiple types using XmlSerializer", "body": "<p>Assuming all possible types in the array are known at compile time, you can apply multiple <a href=\"https://msdn.microsoft.com/en-us/library/3z6zh05s%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>[XmlArrayItem(String, Type)]</code></a> attributes to the array for each known type that could appear in the array.  The <code>Type</code> argument is a specific derived type that could appear in the array while the <code>String</code> argument is the element name to associate with that type.  Also apply the <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayattribute%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>[XmlArray(String)]</code></a> attribute to the overall array property to specify the name of the array and that it is to be serialized in two levels rather than one.</p>\n\n<p>E.g.:</p>\n\n<pre><code>public class Document\n{\n    [XmlArray(\"create\")]\n    [XmlArrayItem(\"vendor\", typeof(Vendor))]\n    [XmlArrayItem(\"customer\", typeof(Customer))]\n    [XmlArrayItem(\"asset\", typeof(Asset))]\n    public CreateBase [] Create { get; set; }\n}\n</code></pre>\n\n<p>Where</p>\n\n<pre><code>public abstract class CreateBase\n{\n}\n\npublic class Vendor : CreateBase\n{\n    public string vendorid { get; set; }\n    public string name { get; set; }\n    public string vcf_bill_siteid3 { get; set; }\n}\n\npublic class Customer : CreateBase\n{\n    public string CUSTOMERID { get; set; }\n    public string NAME { get; set; }\n}\n\npublic class Asset : CreateBase\n{\n    public string createdAt { get; set; }\n    public string createdBy { get; set; }\n    public string serial_number { get; set; }\n}\n</code></pre>\n\n<p>(Using an abstract base type is just my preference.  You could use <code>object</code> as you base type: <code>public object [] Create { get; set; }</code>)</p>\n\n<p><strong>Update</strong></p>\n\n<p>Serializing polymorphic collections containing derived types not known at compile time is difficult with <code>XmlSerializer</code> because it works through dynamic code generation.  I.e. when you create an <code>XmlSerializer</code> for the first time it uses reflection to write c# code to serialize and deserialize all statically discoverable referenced types, then compiles and loads that code into a dynamic DLL to do the actual work.  No code gets created for types that cannot be discovered statically, so (de)serialization will fail for them.</p>\n\n<p>You have two options to work around this limitation:</p>\n\n<ol>\n<li><p>Discover all derived types in the list at runtime, then construct an <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlattributeoverrides%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>XmlAttributeOverrides</code></a>, <a href=\"https://msdn.microsoft.com/en-us/library/6c5dw5z7%28v=vs.110%29.aspx\" rel=\"nofollow\">add <code>XmlAttributes</code></a> for the polymorphic array property, then fill in the <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlattributes.xmlarrayitems%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>XmlArrayItems</code></a> for the array property with the discovered subtypes.  Then pass the <code>XmlAttributeOverrides</code> to the appropriate <a href=\"https://msdn.microsoft.com/en-us/library/bfaxz1a0%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>XmlSerializer constructor</code></a>.</p>\n\n<p>Note - you <em>must</em> cache and reuse the <code>XmlSerializer</code> in an appropriate hash table or you will have an enormous resource leak.  See <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer%28v=vs.110%29.aspx\" rel=\"nofollow\">here</a>.</p>\n\n<p>For an example of how this might be done, see here: <a href=\"https://stackoverflow.com/questions/28054335/force-xml-serialization-of-xmldefaultvalue-values\">Force XML serialization of XmlDefaultValue values</a>.</p></li>\n<li><p>Discover all derived types in the list at runtime, then store then in a custom <code>List&lt;T&gt;</code> subclass that implements <a href=\"https://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable%28v=vs.110%29.aspx\" rel=\"nofollow\"><code>IXmlSerializable</code></a>.  </p></li>\n</ol>\n\n<p>Due to the nuisance of having to cache the <code>XmlSerializer</code>, I lean towards the second approach.</p>\n\n<p>To discover all derived types:</p>\n\n<pre><code>public static class TypeExtensions\n{\n    public static IEnumerable&lt;Type&gt; DerivedTypes(this IEnumerable&lt;Type&gt; baseTypes)\n    {\n        var assemblies = baseTypes.SelectMany(t =&gt; t.Assembly.GetReferencingAssembliesAndSelf()).Distinct();\n        return assemblies\n            .SelectMany(a =&gt; a.GetTypes())\n            .Where(t =&gt; baseTypes.Any(baseType =&gt; baseType.IsAssignableFrom(t)))\n            .Distinct();\n    }\n}\n\npublic static class AssemblyExtensions\n{\n    public static IEnumerable&lt;Assembly&gt; GetAllAssemblies()\n    {\n        // Adapted from \n        // https://stackoverflow.com/questions/851248/c-sharp-reflection-get-all-active-assemblies-in-a-solution\n        return Assembly.GetEntryAssembly().GetAllReferencedAssemblies();\n    }\n\n    public static IEnumerable&lt;Assembly&gt; GetAllReferencedAssemblies(this Assembly root)\n    {\n        // WARNING: Assembly.GetAllReferencedAssemblies() will optimize away any reference if there\n        // is not an explicit use of a type in that assembly from the referring assembly --\n        // And simply adding an attribute like [XmlInclude(typeof(T))] seems not to do\n        // the trick.  See\n        // https://social.msdn.microsoft.com/Forums/vstudio/en-US/17f89058-5780-48c5-a43a-dbb4edab43ed/getreferencedassemblies-not-returning-complete-list?forum=netfxbcl\n        // Thus if you are using this to, say, discover all derived types of a base type, the assembly\n        // of the derived types MUST contain at least one type that is referenced explicitly from the \n        // root assembly, directly or indirectly.\n\n        var list = new HashSet&lt;string&gt;();\n        var stack = new Stack&lt;Assembly&gt;();\n\n        stack.Push(root);\n\n        do\n        {\n            var asm = stack.Pop();\n\n            yield return asm;\n\n            foreach (var reference in asm.GetReferencedAssemblies())\n                if (!list.Contains(reference.FullName))\n                {\n                    stack.Push(Assembly.Load(reference));\n                    list.Add(reference.FullName);\n                }\n\n        }\n        while (stack.Count &gt; 0);\n    }\n\n    public static IEnumerable&lt;Assembly&gt; GetReferencingAssemblies(this Assembly target)\n    {\n        if (target == null)\n            throw new ArgumentNullException();\n        // Assemblies can have circular references:\n        // http://stackoverflow.com/questions/1316518/how-did-microsoft-create-assemblies-that-have-circular-references\n        // So a naive algorithm isn't going to work.\n\n        var done = new HashSet&lt;Assembly&gt;();\n\n        var root = Assembly.GetEntryAssembly();\n        var allAssemblies = root.GetAllReferencedAssemblies().ToList();\n\n        foreach (var assembly in GetAllAssemblies())\n        {\n            if (target == assembly)\n                continue;\n            if (done.Contains(assembly))\n                continue;\n            var refersTo = (assembly == root ? allAssemblies : assembly.GetAllReferencedAssemblies()).Contains(target);\n            done.Add(assembly);\n            if (refersTo)\n                yield return assembly;\n        }\n    }\n\n    public static IEnumerable&lt;Assembly&gt; GetReferencingAssembliesAndSelf(this Assembly target)\n    {\n        return new[] { target }.Concat(target.GetReferencingAssemblies());\n    }\n}\n</code></pre>\n\n<p>Then, the polymorphic list that discovers its own types:</p>\n\n<pre><code>public class XmlPolymorphicList&lt;T&gt; : List&lt;T&gt;, IXmlSerializable where T : class\n{\n    static XmlPolymorphicList()\n    {\n        // Make sure the scope of objects to find isn't *EVERYTHING*\n        if (typeof(T) == typeof(object))\n        {\n            throw new InvalidOperationException(\"Cannot create a XmlPolymorphicList&lt;object&gt;\");\n        }\n    }\n\n    internal sealed class DerivedTypeDictionary\n    {\n        Dictionary&lt;Type, string&gt; derivedTypeNames;\n        Dictionary&lt;string, Type&gt; derivedTypes;\n\n        DerivedTypeDictionary()\n        {\n            derivedTypeNames = typeof(T).DerivedTypes().ToDictionary(t =&gt; t, t =&gt; t.DefaultXmlElementName());\n            derivedTypes = derivedTypeNames.ToDictionary(p =&gt; p.Value, p =&gt; p.Key); // Will throw an exception if names are not unique\n        }\n\n        public static DerivedTypeDictionary Instance { get { return Singleton&lt;DerivedTypeDictionary&gt;.Instance; } }\n\n        public string GetName(Type type)\n        {\n            return derivedTypeNames[type];\n        }\n\n        public Type GetType(string name)\n        {\n            return derivedTypes[name];\n        }\n    }\n\n    public XmlPolymorphicList()\n        : base()\n    {\n    }\n\n    public XmlPolymorphicList(IEnumerable&lt;T&gt; items)\n        : base(items)\n    {\n    }\n\n    #region IXmlSerializable Members\n\n    XmlSchema IXmlSerializable.GetSchema()\n    {\n        return null;\n    }\n\n    void IXmlSerializable.ReadXml(XmlReader reader)\n    {\n        reader.ReadStartElement();\n        while (reader.NodeType == XmlNodeType.Element)\n        {\n            var name = reader.Name;\n            var type = DerivedTypeDictionary.Instance.GetType(name);\n            var item = (T)(new XmlSerializer(type).Deserialize(reader));\n            if (item != null)\n                Add(item);\n        }\n    }\n\n    void IXmlSerializable.WriteXml(XmlWriter writer)\n    {\n        foreach (var item in this)\n        {\n            new XmlSerializer(item.GetType()).Serialize(writer, item);\n        }\n    }\n\n    #endregion\n}\n\npublic static class XmlSerializationHelper\n{\n    public static string DefaultXmlElementName(this Type type)\n    {\n        var xmlType = type.GetCustomAttribute&lt;XmlTypeAttribute&gt;();\n        if (xmlType != null &amp;&amp; !string.IsNullOrEmpty(xmlType.TypeName))\n            return xmlType.TypeName;\n        return type.Name;\n    }\n}\n\npublic class Singleton&lt;T&gt; where T : class\n{\n    // Explicit static constructor to tell C# compiler\n    // not to mark type as beforefieldinit\n    static Singleton()\n    {\n    }\n\n    /// &lt;summary&gt;\n    /// Private nested class which acts as singleton class instantiator. This class should not be accessible outside &lt;see cref=\"Singleton&lt;T&gt;\"/&gt;\n    /// &lt;/summary&gt;\n    class Nested\n    {\n        /// &lt;summary&gt;\n        /// Explicit static constructor to tell C# compiler not to mark type as beforefieldinit\n        /// &lt;/summary&gt;\n        static Nested()\n        {\n        }\n\n        /// &lt;summary&gt;\n        /// Static instance variable\n        /// &lt;/summary&gt;\n        internal static readonly T instance = (T)Activator.CreateInstance(typeof(T), true);\n    }\n\n    public static T Instance { get { return Nested.instance; } }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 898, "user_id": 1411099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3367cdc6e469cb056cc6721d96307017?s=128&d=identicon&r=PG", "display_name": "Jordan Crittenden", "link": "https://stackoverflow.com/users/1411099/jordan-crittenden"}, "is_accepted": true, "score": -2, "last_activity_date": 1424293753, "creation_date": 1424293753, "answer_id": 28593951, "question_id": 28462449, "link": "https://stackoverflow.com/questions/28462449/serializing-an-array-of-multiple-types-using-xmlserializer/28593951#28593951", "title": "Serializing an array of multiple types using XmlSerializer", "body": "<p>I ended up abandoning XmlSerializer and using Json.NET to serialize the object to json and then convert to XML.</p>\n"}], "owner": {"reputation": 898, "user_id": 1411099, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3367cdc6e469cb056cc6721d96307017?s=128&d=identicon&r=PG", "display_name": "Jordan Crittenden", "link": "https://stackoverflow.com/users/1411099/jordan-crittenden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5538, "favorite_count": 1, "accepted_answer_id": 28593951, "answer_count": 3, "score": 0, "last_activity_date": 1424293753, "creation_date": 1423681623, "question_id": 28462449, "link": "https://stackoverflow.com/questions/28462449/serializing-an-array-of-multiple-types-using-xmlserializer", "title": "Serializing an array of multiple types using XmlSerializer", "body": "<p>I'm trying to use XMLSerializer to generate XML such as the following, where the contents of <code>&lt;create&gt;</code> is an array, but the elements can be of differing types (in this case <code>&lt;vendor&gt;</code>, <code>&lt;customer&gt;</code>, and <code>&lt;asset&gt;</code>). Is this possible?</p>\n\n<pre><code>...\n    &lt;create&gt;\n        &lt;vendor&gt; \n            &lt;vendorid&gt;Unit - A-1212&lt;/vendorid&gt;\n            &lt;name&gt;this is the name8&lt;/name&gt;\n            &lt;vcf_bill_siteid3&gt;FOOBAR8&lt;/vcf_bill_siteid3&gt;\n        &lt;/vendor&gt;             \n        &lt;customer&gt;\n            &lt;CUSTOMERID&gt;XML121&lt;/CUSTOMERID&gt;\n            &lt;NAME&gt;XML Customer 111&lt;/NAME&gt;\n        &lt;/customer&gt;             \n        &lt;asset&gt;  \n            &lt;createdAt&gt;San Jose&lt;/createdAt&gt;\n            &lt;createdBy&gt;Kevin&lt;/createdBy&gt;\n            &lt;serial_number&gt;123456789&lt;/serial_number&gt;\n        &lt;/asset&gt; \n    &lt;/create&gt;\n....\n</code></pre>\n"}, {"tags": ["c#", "windows-phone-8.1"], "answers": [{"comments": [{"owner": {"reputation": 8900, "user_id": 20580, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d03771294e0769ff29e3c3d55fdf84d5?s=128&d=identicon&r=PG", "display_name": "Hinek", "link": "https://stackoverflow.com/users/20580/hinek"}, "edited": false, "score": 0, "creation_date": 1423994275, "post_id": 28487107, "comment_id": 45365746, "body": "It works, thanks. But I had to add &quot;Pictures Library&quot; to the Capabilities, first."}, {"owner": {"reputation": 8900, "user_id": 20580, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d03771294e0769ff29e3c3d55fdf84d5?s=128&d=identicon&r=PG", "display_name": "Hinek", "link": "https://stackoverflow.com/users/20580/hinek"}, "edited": false, "score": 0, "creation_date": 1423994600, "post_id": 28487107, "comment_id": 45365825, "body": "I just found out, since <code>Image.Source</code> can accept an <code>BitmapImage</code> OR an <code>Uri</code>, I can use <code>new Uri(((StorageFile)contact.Thumbnail).Path)</code> just as fine, without creating the <code>BitmapImage</code> ..."}], "tags": [], "owner": {"reputation": 271, "user_id": 4488319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wmqKk.png?s=128&g=1", "display_name": "Abdulwahab Suleiman - MSFT", "link": "https://stackoverflow.com/users/4488319/abdulwahab-suleiman-msft"}, "is_accepted": true, "score": 2, "last_activity_date": 1423772828, "last_edit_date": 1423772828, "creation_date": 1423772734, "answer_id": 28487107, "question_id": 28462442, "link": "https://stackoverflow.com/questions/28462442/irandomaccessstreamreference-to-image-source/28487107#28487107", "title": "IRandomAccessStreamReference to image source", "body": "<p>This seems to be the way I was able to get it to work. Get the path to the file and return a BitmapImage. You can bind to the BitmapImage as your image source.</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>BitmapImage bmp = new BitmapImage(new Uri(((StorageFile)contact.Thumbnail).Path));\n</code></pre>\n\n<p>Let me know if this helps.</p>\n"}], "owner": {"reputation": 8900, "user_id": 20580, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d03771294e0769ff29e3c3d55fdf84d5?s=128&d=identicon&r=PG", "display_name": "Hinek", "link": "https://stackoverflow.com/users/20580/hinek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 28487107, "answer_count": 1, "score": 0, "last_activity_date": 1423772828, "creation_date": 1423681591, "question_id": 28462442, "link": "https://stackoverflow.com/questions/28462442/irandomaccessstreamreference-to-image-source", "title": "IRandomAccessStreamReference to image source", "body": "<p>Basically I want to display the thumbnail of a contact.</p>\n\n<p>So I build a ValueConverter, that should convert the Contact.Thumbnail property (type is <code>IRandomAccessStreamReference</code>) to the source of an Image.</p>\n\n<p>I can load a <code>BitmapImage</code> from an url or a <code>RandomAccessStream</code>, but how do I get from <code>IRandomAccessStreamReference</code> to an <code>RandomAccessStream</code>? Or am I already starting with the wrong approach?</p>\n"}, {"tags": ["c#", "winforms", "postgresql"], "comments": [{"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1423681538, "post_id": 28462381, "comment_id": 45250589, "body": "If you are developing for yourself, you can use whatever capitalization you like.  But when you show your code to the world, asking for help, you really should use proper, commonly accepted, standard capitalization.  The same applies to code formatting."}, {"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1423681560, "post_id": 28462381, "comment_id": 45250600, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/1t3y8s4s.aspx</a>"}, {"owner": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "edited": false, "score": 0, "creation_date": 1423681881, "post_id": 28462381, "comment_id": 45250791, "body": "You are looking for <a href=\"https://msdn.microsoft.com/en-us/library/system.dbnull%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\">System.DbNull</a> to compare in your if-statements."}, {"owner": {"reputation": 183, "user_id": 3752770, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1f8f17a7747781bc189b8aa07b89847d?s=128&d=identicon&r=PG&f=1", "display_name": "Evanark", "link": "https://stackoverflow.com/users/3752770/evanark"}, "reply_to_user": {"reputation": 16152, "user_id": 205233, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fd3b79356ba4ea1f7e8d6be783446e59?s=128&d=identicon&r=PG&f=1", "display_name": "Filburt", "link": "https://stackoverflow.com/users/205233/filburt"}, "edited": false, "score": 0, "creation_date": 1423682982, "post_id": 28462381, "comment_id": 45251469, "body": "@Filburt thank you that works."}, {"owner": {"reputation": 183, "user_id": 3752770, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1f8f17a7747781bc189b8aa07b89847d?s=128&d=identicon&r=PG&f=1", "display_name": "Evanark", "link": "https://stackoverflow.com/users/3752770/evanark"}, "reply_to_user": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1423683073, "post_id": 28462381, "comment_id": 45251528, "body": "@Mike Nakis I am still a beginner, what would be a best practice to formatting? I want to learn everything I can."}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1423683335, "post_id": 28462381, "comment_id": 45251697, "body": "well, <code>AudioBoard</code> looks like a class name, but judging by the usage, it is not.  So, it should probably begin with a lower-case letter, like <code>lblAudioBoardNumber</code>.  Or perhaps it is a property (with getter and setter,) in which case its capitalization is okay, but then you should have included its definition in the snippet to make that evident.  Anyway, never mind, it is not a very big deal."}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1423683718, "post_id": 28462381, "comment_id": 45251933, "body": "As for the formatting, I fixed it for you. Just make sure that the indentation is proper. I also removed all the unnecessary curly brackets, not because there is a standard about them, but because I think that brevity matters here on stackoverflow."}, {"owner": {"reputation": 183, "user_id": 3752770, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1f8f17a7747781bc189b8aa07b89847d?s=128&d=identicon&r=PG&f=1", "display_name": "Evanark", "link": "https://stackoverflow.com/users/3752770/evanark"}, "edited": false, "score": 0, "creation_date": 1423683863, "post_id": 28462381, "comment_id": 45252011, "body": "Thanks! I will use these practices in future programs!"}], "owner": {"reputation": 183, "user_id": 3752770, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1f8f17a7747781bc189b8aa07b89847d?s=128&d=identicon&r=PG&f=1", "display_name": "Evanark", "link": "https://stackoverflow.com/users/3752770/evanark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423683657, "creation_date": 1423681351, "last_edit_date": 1423683657, "question_id": 28462381, "link": "https://stackoverflow.com/questions/28462381/how-to-handle-an-empty-integer-in-postgresql-and-convert-it-to-a-sting-in-c-win", "title": "How to handle an empty integer in PostgreSQL and convert it to a sting in C# winforms", "body": "<p>I am writing a program to retrieve serial numbers for installed circuit boards for a given part number. The problem is the serial numbers are integers in postgreSQL and some of the fields are empty. My question is how do I handle those empty integers and convert them to strings? If the value is null I want to display a not install message for my label controls.\nHere is my code:</p>\n\n<pre><code>NpgsqlCommand cmd = new NpgsqlCommand(\"select id, audio_board_serial_number,\n    processor_board_serial_number, football_board_serial_number,\n    thumbwheel_board_serial_number \" +\n    \"from master_product where product_serial_number = :ProductSerialNumber;\", conn);\ncmd.Parameters.Add(new NpgsqlParameter(\"ProductSerialNumber\",\n    clsIdStorage.ProductSerialNumber));\nNpgsqlDataReader dr = cmd.ExecuteReader();\nif (dr.Read())\n{\n    AudioBoard = dr.GetInt32(1);\n    ProcessorBoard = dr.GetInt32(2);\n    FootballBoard = dr.GetInt32(3);\n    ThumbwheelBoard = dr.GetInt32(4);\n    if (AudioBoard == null)\n        lblAudioBoardNumber.Text = \"Not Installed\";\n    else\n        lblAudioBoardNumber.Text = AudioBoard.ToString();\n    if (ProcessorBoard == null)\n        lblProcessorBoardNumber.Text = \"Not Installed\";\n    else\n        lblProcessorBoardNumber.Text = ProcessorBoard.ToString();\n    if (FootballBoard == null)\n        lblFootBallBoardNumber.Text = \"Not Installed\";\n    else\n        lblFootBallBoardNumber.Text = FootballBoard.ToString();\n    if (ThumbwheelBoard == null)\n        lblThumbwheelBoardNumber.Text = \"Not Installed\";\n    else\n        lblThumbwheelBoardNumber.Text = ThumbwheelBoard.ToString();\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c#", "wpf", "backgroundworker"], "comments": [{"owner": {"reputation": 11751, "user_id": 473194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/15tk9.png?s=128&g=1", "display_name": "Colin Smith", "link": "https://stackoverflow.com/users/473194/colin-smith"}, "edited": false, "score": 1, "creation_date": 1423682980, "post_id": 28462372, "comment_id": 45251465, "body": "At a guess, it might be your RunJob that is being called multiple times.....and it is &quot;reusing&quot; the workerforRun member variable without checking if the previous BackgroundWorker has completed yet....thus when the previous one is garbage collected it appears to raise a completed event before your new BackgorundWorker has started...so the completed event you are seeing is for the previous one?.... Do a assert(sender == workerforRun) in your workerforRun_RunWorkerCompleted to confirm this.  Also check  RunWorkerCompletedEventArgs.Result to see if it says cancelled/exception."}, {"owner": {"reputation": 3273, "user_id": 4355338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rc5kr.jpg?s=128&g=1", "display_name": "Sievajet", "link": "https://stackoverflow.com/users/4355338/sievajet"}, "edited": false, "score": 0, "creation_date": 1423693320, "post_id": 28462372, "comment_id": 45257059, "body": "Post the code where you call this runjob when you check the checkboxes. This helps to solve your problem"}, {"owner": {"reputation": 1246, "user_id": 1852526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e66cfb9b607ef879597a01bd2ab71bd6?s=128&d=identicon&r=PG", "display_name": "nikhil", "link": "https://stackoverflow.com/users/1852526/nikhil"}, "edited": false, "score": 0, "creation_date": 1423694530, "post_id": 28462372, "comment_id": 45257596, "body": "Thanks Colin Smith and Sievajet you are right I was calling the RunJob from cs file as well which is preventing the execution of do work. Thanks again i will work on that."}, {"owner": {"reputation": 3273, "user_id": 4355338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rc5kr.jpg?s=128&g=1", "display_name": "Sievajet", "link": "https://stackoverflow.com/users/4355338/sievajet"}, "edited": false, "score": 0, "creation_date": 1424020617, "post_id": 28462372, "comment_id": 45372730, "body": "I would suggest a solution with only one worker otherwise you&#39;ll need to look into synchronization"}], "owner": {"reputation": 1246, "user_id": 1852526, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e66cfb9b607ef879597a01bd2ab71bd6?s=128&d=identicon&r=PG", "display_name": "nikhil", "link": "https://stackoverflow.com/users/1852526/nikhil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 965, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1556162868, "creation_date": 1423681320, "question_id": 28462372, "link": "https://stackoverflow.com/questions/28462372/background-worker-runworker-completed-event-is-executed-even-before-do-work-even", "title": "background worker RunWorker Completed event is executed even before do work event", "body": "<p>I have WPF application where in the Ui I have a header check box and when it is checked all the body checkboxes are checked. When any checkbox is checked, Im doing some work that I need by calling the Background worker which works perfect. If I select any checkboxes individually without checking header then Background worker works fine.</p>\n\n<p>Problem is when I check the header all the body checkboxes are checked and in this case the Background worker 'Run Worker completed' event is being executed even before 'do work' is executed which is breaking my code. Please help. Here is my code. RunJob is from command for button in front end. </p>\n\n<pre><code>public void RunJob(object obj)\n        {\n            obforSave = obj;\n            workerforRun = new BackgroundWorker();\n            workerforRun.WorkerReportsProgress = true;\n            workerforRun.DoWork += workerforRun_DoWork;\n            workerforRun.ProgressChanged += workerforRun_ProgressChanged;\n            workerforRun.RunWorkerCompleted += workerforRun_RunWorkerCompleted;\n            if (!workerforRun.IsBusy)\n            {\n                workerforRun.RunWorkerAsync();\n            }\n        }\n\n        //Special case header is checked Runwroker completed is executing before do work.\n        void workerforRun_DoWork(object sender, DoWorkEventArgs e)\n        {\n            IsValidationsComplete = false;\n            int count = 0;\n            //var obj = e.Argument;\n            if (IsRunJobAlreadyExecuted == false)\n            {\n                ResultExtract = JobEntities.Any(s =&gt; s.ExtractIsSelected != null &amp;&amp; (bool)s.ExtractIsSelected);\n                var resultTransform = JobEntities.Any(x =&gt; x.TransformIsSelected != null &amp;&amp; (bool)x.TransformIsSelected);\n                var resultLoad = JobEntities.Any(b =&gt; b.LoadIsSelected != null &amp;&amp; (bool)b.LoadIsSelected);\n                //Check if any of the entities are either Extracted, Transformed or Loaded.\n                if (ResultExtract || resultTransform || resultLoad)\n                {\n                    SaveJobConfigurationChanges(obforSave);\n                    var jobEngine = new JobEngine();\n                    var jobId = JobEntities[0].JobId;\n                    jobEngine.ProcessJob(jobId);\n                    MessageBox.Show(\"Job Execution Complete\", \"Run Job\");\n                    AllResults = GetJobConfigurationResults();\n                    foreach (var item in AllResults)\n                    {\n                        if (item.ExtractIsSelected == true &amp;&amp; item.ExtractStatus == \"Completed Successfully\")\n                        {\n                            count += Convert.ToInt32(item.ExtractRowsSelected);\n                        }\n                        if (item.TransformIsSelected == true &amp;&amp; item.TransformStatus == \"Completed Successfully\")\n                        {\n                            count += Convert.ToInt32(item.TransformRowsSelected);\n                        }\n                        if (item.LoadIsSelected == true &amp;&amp; item.LoadStatus == \"Completed Successfully\")\n                        {\n                            count += Convert.ToInt32(item.LoadRowsSelected);\n                        }\n                    }\n\n                    workerforRun.ReportProgress(count);\n                    //MessageBox.Show(count.ToString());\n                }\n                else\n                {\n                    //When No Entity is Selected and the Run Button is pressed.\n                    MessageBox.Show(\"Select an Entity First\");\n\n                }\n            }\n            IsRunJobAlreadyExecuted = false;\n        }\n\n\n        void workerforRun_ProgressChanged(object sender, ProgressChangedEventArgs e)\n        {\n            progress = e.ProgressPercentage;\n        }\n\n        void workerforRun_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)\n        {\n            Dispatcher.CurrentDispatcher.BeginInvoke(new Action(() =&gt;\n            {\n                /*When Header is checked and when the Run is clicked, you want to Uncheck the header back after completion.\n            This property is set in the CS file.*/\n                AllResults = GetJobConfigurationResults();\n                foreach (var item in AllResults)\n                {\n                    item.ExtractIsSelected = false;\n                    item.TransformIsSelected = false;\n                    item.LoadIsSelected = false;\n                }\n                SaveTaskSelection();\n                JobEntitiesCollectionViewSource.Source = AllResults;\n                JobEntitiesCollectionViewSource.View.Refresh();\n                ExecuteFilteredEntitiesStoredProcedure();\n                IsValidateEnabled = AllResults.Any(p =&gt; p.ExtractStatus == \"Completed Successfully\");\n            }), DispatcherPriority.Background, null);\n            MessageBox.Show(progress.ToString());\n            IsValidationsComplete = true;\n        }\n\n\nCS file:\n\n    public IEnumerable&lt;T&gt; FindVisualChildren&lt;T&gt;(DependencyObject depObj) where T : DependencyObject\n        {\n            if (depObj != null)\n            {\n                for (int i = 0; i &lt; VisualTreeHelper.GetChildrenCount(depObj); i++)\n                {\n                    var child = VisualTreeHelper.GetChild(depObj, i);\n                    // If there is a child found and if the child is of the T type. \n                    //Dont remove null check . If no check i\n                    if (child != null &amp;&amp; child is T)\n                    {\n                        yield return (T)child;\n                    }\n                    foreach (T childOfChild in FindVisualChildren&lt;T&gt;(child))\n                    {\n                        yield return childOfChild;\n                    }\n                }\n            }\n        }\n\nprivate IEnumerable&lt;CheckBox&gt; GetAllCheckBoxs()\n        {\n            var allCheckBoxes = FindVisualChildren&lt;CheckBox&gt;(UserControlJob);\n            return allCheckBoxes;\n        }\n\nprivate void ChkHeaderExtract_OnChecked(object sender, RoutedEventArgs e)\n        {\n                var extractCheckBoxes = GetAllCheckBoxs();\n                var i = 0;\n                foreach (var chk in extractCheckBoxes)\n                {\n                    if (i%3 == 0) // Since I have many sets of checkboxes and I want only the first set of checkboxes checked when header is clicked Im doing this.\n                    {\n                        chk.IsChecked = true;\n                    }\n                    i++;\n                }\n\n            }\n</code></pre>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 1, "creation_date": 1423683595, "post_id": 28462362, "comment_id": 45251864, "body": "You do realize that &quot;bar&quot; would also match &quot;foobar&quot;.  You probably want <code>\\b</code> before colName in the regular expression to avoid that situation."}, {"owner": {"reputation": 8200, "user_id": 3120446, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/heCaC.jpg?s=128&g=1", "display_name": "dx_over_dt", "link": "https://stackoverflow.com/users/3120446/dx-over-dt"}, "reply_to_user": {"reputation": 29989, "user_id": 302918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bcc0c35cdf5199daf005566c2a921a0d?s=128&d=identicon&r=PG", "display_name": "juharr", "link": "https://stackoverflow.com/users/302918/juharr"}, "edited": false, "score": 0, "creation_date": 1423684553, "post_id": 28462362, "comment_id": 45252377, "body": "Good point!  Thanks!"}], "owner": {"reputation": 8200, "user_id": 3120446, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/heCaC.jpg?s=128&g=1", "display_name": "dx_over_dt", "link": "https://stackoverflow.com/users/3120446/dx-over-dt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1423681275, "creation_date": 1423681275, "question_id": 28462362, "link": "https://stackoverflow.com/questions/28462362/use-regex-to-toggle-asc-desc-without-using-matchevaluator", "title": "Use regex to toggle &quot;asc&quot; &lt;--&gt; &quot;desc&quot; without using MatchEvaluator", "body": "<p>I have a string of column sort orders, e.g. <code>string sortOrders = \"foo asc, bar desc, hi desc\";</code>.</p>\n\n<p>I want to take in an input column name, and if it's already in our sort order string, toggle the direction of the sort.  This is easy enough with </p>\n\n<pre><code>string sortOrders = \"foo asc, bar desc, hi desc\";\nstring colName = \"bar\";\nRegex.Replace(sortOrders, \n              colName + \" (desc|asc)\", \n              m =&gt; colName + \" \" + (m.Groups[1].Value == \"desc\" ? \"asc\" : \"desc\"));\n\n// result: \"foo asc, bar asc, hi desc\"\n</code></pre>\n\n<p>Is there a simpler version that doesn't use a <code>MatchEvaluator</code>?</p>\n"}, {"tags": ["c#", "asp.net-mvc", "asynchronous"], "comments": [{"owner": {"reputation": 11176, "user_id": 4251546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee0787c93711e13244a8547e1316cc?s=128&d=identicon&r=PG", "display_name": "Vsevolod Goloviznin", "link": "https://stackoverflow.com/users/4251546/vsevolod-goloviznin"}, "edited": false, "score": 0, "creation_date": 1423681634, "post_id": 28462360, "comment_id": 45250646, "body": "Of course it&#39;s waiting for the result of the operation. You should study how async works and what it&#39;s used for."}, {"owner": {"reputation": 470, "user_id": 1389863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rrnEM.jpg?s=128&g=1", "display_name": "TimAlonso", "link": "https://stackoverflow.com/users/1389863/timalonso"}, "reply_to_user": {"reputation": 11176, "user_id": 4251546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adee0787c93711e13244a8547e1316cc?s=128&d=identicon&r=PG", "display_name": "Vsevolod Goloviznin", "link": "https://stackoverflow.com/users/4251546/vsevolod-goloviznin"}, "edited": false, "score": 0, "creation_date": 1423689226, "post_id": 28462360, "comment_id": 45254865, "body": "@VsevolodGoloviznin Hi, I&#39;m aware that it&#39;s waiting for the result to return from the task but I&#39;ve successfully subscribed the user (this can be confirmed by checking the CMS where the user data is stored) which meant the task is completed and the result has returned right? Am I missing something else?"}], "answers": [{"tags": [], "owner": {"reputation": 15222, "user_id": 1017868, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/EHwne.png?s=128&g=1", "display_name": "MikeSW", "link": "https://stackoverflow.com/users/1017868/mikesw"}, "is_accepted": false, "score": 1, "last_activity_date": 1423681630, "creation_date": 1423681630, "answer_id": 28462452, "question_id": 28462360, "link": "https://stackoverflow.com/questions/28462360/asp-net-mvc-why-is-the-await-keyword-blocking-my-method-despite-having-the-task/28462452#28462452", "title": "ASP.NET MVC: Why is the await keyword blocking my method despite having the task completed?", "body": "<p>Await doesn't block your method, but the action won't complete until you get the result from the remote server i.e until the task finishes. The point of await is to free CPU threads while waiting on I/O operations.</p>\n\n<p>So, while you're awaiting the thread which handles your request is free to handle other requests. await is a backend optimization, for the UI client nothing changes.</p>\n"}, {"tags": [], "owner": {"reputation": 470, "user_id": 1389863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rrnEM.jpg?s=128&g=1", "display_name": "TimAlonso", "link": "https://stackoverflow.com/users/1389863/timalonso"}, "is_accepted": true, "score": 1, "last_activity_date": 1423751955, "creation_date": 1423751955, "answer_id": 28480268, "question_id": 28462360, "link": "https://stackoverflow.com/questions/28462360/asp-net-mvc-why-is-the-await-keyword-blocking-my-method-despite-having-the-task/28480268#28480268", "title": "ASP.NET MVC: Why is the await keyword blocking my method despite having the task completed?", "body": "<p>The reason why it seems that my contact form in the UI is stuck is because the method Subscribe is called in a method that doesn't utilize the async/await keywords.</p>\n\n<pre><code>public string Test(User user)\n{\n    if (user == null) throw new ArgumentNullException(\"user\");\n    Subscribe(user);\n\n    // Rest of the method...\n}\n</code></pre>\n\n<p>The await waits for the Subscribe task to finish and continues. When the method continue's it will do so in a context.</p>\n\n<p>Just as described in this post <a href=\"http://blog.stephencleary.com/2012/07/dont-block-on-async-code.html\" rel=\"nofollow\">here</a>:</p>\n\n<blockquote>\n  <p>In the first case, this context is a UI context (which applies to any\n  UI except Console applications). In the second case, this context is\n  an ASP.NET request context.</p>\n  \n  <p>One other important point: an ASP.NET request context is not tied to a\n  specific thread (like the UI context is), but it does only allow one\n  thread in at a time. This interesting aspect is not officially\n  documented anywhere AFAIK, but it is mentioned in my MSDN article\n  about SynchronizationContext.</p>\n</blockquote>\n\n<p>So the Test method in this instance is using the RequestContext, calls the Subscribe method. The await starts in the UI context and while waiting it continues back to the RequestContext which it can't access because the Test method is currently using it. It ends in a deadlock. That's why the UI is stuck in loading.</p>\n"}], "owner": {"reputation": 470, "user_id": 1389863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rrnEM.jpg?s=128&g=1", "display_name": "TimAlonso", "link": "https://stackoverflow.com/users/1389863/timalonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 673, "favorite_count": 0, "accepted_answer_id": 28480268, "answer_count": 2, "score": 0, "last_activity_date": 1423751955, "creation_date": 1423681257, "question_id": 28462360, "link": "https://stackoverflow.com/questions/28462360/asp-net-mvc-why-is-the-await-keyword-blocking-my-method-despite-having-the-task", "title": "ASP.NET MVC: Why is the await keyword blocking my method despite having the task completed?", "body": "<p>We've got an ASP.NET MVC application that has a form for visiters to subscribe their details for a newsletter.</p>\n\n<p>The method responsible for subscribing users is defined below. We also have a custom web API that we're contacting through this method.</p>\n\n<pre><code>public async Task&lt;string&gt; Subscribe(User user)\n{\n    if (user== null) throw new ArgumentNullException(\"user\");\n    var request = new RestRequest(\"subscribe\", Method.POST) \n    {\n        RequestFormat = DataFormat.Json\n    };\n    request.AddBody(user);\n\n    // Service Url is defined further up the code.\n    var client = new RestClient(serviceUrl);\n    var response = await client.ExecuteTaskAsync&lt;User&gt;(request);\n\n    return response.Data.Id;\n}\n</code></pre>\n\n<p>The code itself works as it returns the appropriate ID from the request and I have confirmed this. The issue is that on the website it's still loading as if the submit button from our newsletter is still processing.</p>\n\n<p>I've got a sneaky suspicion that await is still waiting and therefore hasn't completed it's run but it's confusing me how the results have returned in our CMS but the website is still loading.</p>\n\n<p>Does anyone have any idea?</p>\n"}, {"tags": ["c#", "asp.net-web-api", "ninject"], "comments": [{"owner": {"reputation": 31485, "user_id": 809357, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fe164036841e4bc8029ea2f842a5e5d7?s=128&d=identicon&r=PG", "display_name": "trailmax", "link": "https://stackoverflow.com/users/809357/trailmax"}, "edited": false, "score": 1, "creation_date": 1423682126, "post_id": 28462233, "comment_id": 45250925, "body": "Should you not have re-binding <code>IUser</code> <b>before</b> you resolve <code>DAL.MyDal</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "is_accepted": false, "score": 1, "last_activity_date": 1423682162, "creation_date": 1423682162, "answer_id": 28462605, "question_id": 28462233, "link": "https://stackoverflow.com/questions/28462233/dependency-injection-in-unit-tests-how-do-i-inject-into-my-injected-class/28462605#28462605", "title": "Dependency injection in unit tests, how do I inject into my injected class?", "body": "<p>\"Flip\" these 2 lines.</p>\n\n<pre><code>db = kernel.Get&lt;DAL.MyDAL&gt;();\nkernel.Bind&lt;DAL.IUser&gt;().To&lt;Test.User&gt;().InSingletonScope();\n</code></pre>\n\n<p>Aka:</p>\n\n<pre><code>kernel.Bind&lt;DAL.IUser&gt;().To&lt;Test.User&gt;().InSingletonScope();\ndb = kernel.Get&lt;DAL.MyDAL&gt;();\n</code></pre>\n\n<p>You have to \"define\" things before you invoke.</p>\n"}, {"tags": [], "owner": {"reputation": 7881, "user_id": 102526, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8f496f855a9dc1e3513eb0527b38808b?s=128&d=identicon&r=PG", "display_name": "Biff MaGriff", "link": "https://stackoverflow.com/users/102526/biff-magriff"}, "is_accepted": true, "score": 0, "last_activity_date": 1423691899, "last_edit_date": 1423691899, "creation_date": 1423682573, "answer_id": 28462744, "question_id": 28462233, "link": "https://stackoverflow.com/questions/28462233/dependency-injection-in-unit-tests-how-do-i-inject-into-my-injected-class/28462744#28462744", "title": "Dependency injection in unit tests, how do I inject into my injected class?", "body": "<p>OK, I figured it out. Thanks to this <a href=\"https://github.com/lukewickstead/DOT-NET-on-Linux/blob/master/CheatSheets/Ninject.cs\" rel=\"nofollow\">Cheat Sheet</a></p>\n\n<p>Basically I need to specifically inject my value into my class.</p>\n\n<pre><code>public DAL.IDAL db { private get; set; }\n\n[TestInitialize]\npublic void InitializeTests()\n{\n    var kernel = new Ninject.StandardKernel();\n    db = kernel.Get&lt;DAL.MyDAL&gt;(new PropertyValue(\"user\", new Test.User());\n}\n</code></pre>\n"}], "owner": {"reputation": 7881, "user_id": 102526, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8f496f855a9dc1e3513eb0527b38808b?s=128&d=identicon&r=PG", "display_name": "Biff MaGriff", "link": "https://stackoverflow.com/users/102526/biff-magriff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 28462744, "answer_count": 2, "score": 0, "last_activity_date": 1423691899, "creation_date": 1423680922, "question_id": 28462233, "link": "https://stackoverflow.com/questions/28462233/dependency-injection-in-unit-tests-how-do-i-inject-into-my-injected-class", "title": "Dependency injection in unit tests, how do I inject into my injected class?", "body": "<p>I have a Web API project where I bind to all my classes.</p>\n\n<pre><code>//NinjectWebCommon.cs\nprivate static void RegisterServices(IKernel kernel)\n{\n    kernel.Bind&lt;DAL.IDAL&gt;().To&lt;DAL.MyDAL&gt;();\n    kernel.Bind&lt;BUS.IService&gt;().To&lt;BUS.MyService&gt;();\n    kernel.Bind&lt;DAL.IUser&gt;().To&lt;API.User&gt;().InSingletonScope();\n}    \n</code></pre>\n\n<p>This works fine.</p>\n\n<p>I tried to set up my Unit Tests for my DAL using the following.</p>\n\n<pre><code>//Test1.cs\npublic DAL.IDAL db { private get; set; }\n\n[TestInitialize]\npublic void InitializeTests()\n{\n    var kernel = new Ninject.StandardKernel();\n    db = kernel.Get&lt;DAL.MyDAL&gt;();\n    kernel.Bind&lt;DAL.IUser&gt;().To&lt;Test.User&gt;().InSingletonScope();;\n}\n</code></pre>\n\n<p>I get the error</p>\n\n<blockquote>\n  <p>Error activating IUser<br>\n  No matching bindings are available and the type is not self-bindable.<br>\n  Activation Path:<br>\n  &nbsp;&nbsp;2) Injection of dependency IUser into property user of type MyDAL<br>\n  &nbsp;&nbsp;1) Request for MyDAL </p>\n</blockquote>\n\n<p>I have IUser in the MyDAL class. I'm not sure exactly what is going on here.</p>\n\n<pre><code>//MyDAL.cs\npublic class MyDAL\n{\n    [Inject]\n    public IUser user { get; set; }\n\n    //other functions\n    //...\n}\n</code></pre>\n"}, {"tags": ["c#", "loops", "datatable"], "comments": [{"owner": {"reputation": 14506, "user_id": 2345956, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hTXGP.jpg?s=128&g=1", "display_name": "EZI", "link": "https://stackoverflow.com/users/2345956/ezi"}, "edited": false, "score": 0, "creation_date": 1423681199, "post_id": 28462222, "comment_id": 45250409, "body": "<a href=\"http://www.elevenwinds.com/linq-distinctby-with-lambda-expression-parameter\" rel=\"nofollow noreferrer\">elevenwinds.com/&hellip;</a>"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1423681605, "post_id": 28462222, "comment_id": 45250626, "body": "what if you changed the inner loop <code>foreach (DataRow myRow in dt.Rows) </code> to a <code>for loop</code> so declare something like a column count  <code>int iColCount = distinctTbl.Columns.Count;</code> then iterate over the column(s) for each row.. if not then declare a var intCnt = 0; outside of the inner foreach loop and then check if <code>myRow[intCnt][&quot;Email] == (string)dr[&quot;Email&quot;]</code> then add the necessary items"}], "answers": [{"comments": [{"owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1423687608, "post_id": 28462557, "comment_id": 45254015, "body": "I opted to use the Linq query, but this seems to work fine too!  Thanks for the suggestion."}, {"owner": {"reputation": 6610, "user_id": 2403810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c63a4cc13b434306ccc00ba2cd64d6?s=128&d=identicon&r=PG&f=1", "display_name": "tinstaafl", "link": "https://stackoverflow.com/users/2403810/tinstaafl"}, "reply_to_user": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1423690739, "post_id": 28462557, "comment_id": 45255674, "body": "@ElementalPete - One thing to keep in mind.  Since your data size is quite small, efficiency probably isn&#39;t an overriding concern.  However, if the data size gets to be really large, keep in mind the LINQ query iterates over the data twice and can present a performance hit on large data sets."}], "tags": [], "owner": {"reputation": 6610, "user_id": 2403810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84c63a4cc13b434306ccc00ba2cd64d6?s=128&d=identicon&r=PG&f=1", "display_name": "tinstaafl", "link": "https://stackoverflow.com/users/2403810/tinstaafl"}, "is_accepted": false, "score": 2, "last_activity_date": 1423682010, "creation_date": 1423682010, "answer_id": 28462557, "question_id": 28462222, "link": "https://stackoverflow.com/questions/28462222/nested-foreach-loops-returns-only-distinct/28462557#28462557", "title": "nested foreach loops returns only distinct", "body": "<p>One quick and easy solution is to use a <code>Dictionary&lt;string,List&lt;int&gt;&gt;</code> instead of a list:</p>\n\n<pre><code>    Dictionary&lt;string, List&lt;int&gt;&gt; idNums = new Dictionary&lt;string, List&lt;int&gt;&gt;();\n    foreach (DataRow myRow in dt.Rows)\n    {\n        string email = myRow[\"Email\"].ToString()\n        if (idNums.ContainsKey(email))\n        {\n            idNums[email].Add((int)myRow[\"CustomerID\"]);\n        }\n        else\n        {\n            idNums.Add(email, new List&lt;int&gt; { (int)myRow[\"CustomerID\"] });\n        }\n    }\n</code></pre>\n\n<p>Now idNums will contain the list of id's associated with each email.</p>\n"}, {"comments": [{"owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1423687476, "post_id": 28462602, "comment_id": 45253938, "body": "I like it!  I was trying Linq initially but couldn&#39;t figure out the syntax of grouping everything this way.  This works like a charm, thanks!"}, {"owner": {"reputation": 2899, "user_id": 1175868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f82b0891113774659654fabe71bed8ba?s=128&d=identicon&r=PG", "display_name": "Oblivious Sage", "link": "https://stackoverflow.com/users/1175868/oblivious-sage"}, "reply_to_user": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1423688706, "post_id": 28462602, "comment_id": 45254615, "body": "@ElementalPete The <code>GroupBy</code> method can be a little tricky at first because it doesn&#39;t just return a normal <code>IEnumerable</code> or a single element the way most Linq methods do. I feel like they also need a lot more <code>ToDictionary</code> overloads for convenience but in this case one of the existing ones worked fine."}], "tags": [], "owner": {"reputation": 2899, "user_id": 1175868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f82b0891113774659654fabe71bed8ba?s=128&d=identicon&r=PG", "display_name": "Oblivious Sage", "link": "https://stackoverflow.com/users/1175868/oblivious-sage"}, "is_accepted": true, "score": 2, "last_activity_date": 1423682155, "creation_date": 1423682155, "answer_id": 28462602, "question_id": 28462222, "link": "https://stackoverflow.com/questions/28462222/nested-foreach-loops-returns-only-distinct/28462602#28462602", "title": "nested foreach loops returns only distinct", "body": "<p><strong>Ditch the <code>foreach</code> loops.</strong></p>\n\n<p>You can use Linq to get the information you're looking for more easily.</p>\n\n<pre><code>Dictionary&lt;string, List&lt;int&gt;&gt; emailIDs =\n    dt.Rows.OfType&lt;DataRow&gt;()\n           .GroupBy(row =&gt; (string)row[\"Email\"])\n           .ToDictionary(grp =&gt; grp.Key,\n                         grp =&gt; grp.Select(row =&gt; (int)row[\"CustomerID\"]).ToList());\n</code></pre>\n"}], "owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "accepted_answer_id": 28462602, "answer_count": 2, "score": 0, "last_activity_date": 1423682155, "creation_date": 1423680899, "question_id": 28462222, "link": "https://stackoverflow.com/questions/28462222/nested-foreach-loops-returns-only-distinct", "title": "nested foreach loops returns only distinct", "body": "<p>I have a database where each email address should belong to a unique customer, but I have many duplicates.  I used a sql query to list customer ID, email address pairs for each occurrence where there is more than one customer ID mapped to a single email address.  The result looks something like this (addresses changed to protect the innocent)</p>\n\n<pre><code>Customer ID   Email\n101233        bob@myaddress.com\n108993        bob@myaddress.com\n113224        bob@myaddress.com\n89223         mary@otherdomain.com\n188223        mary@otherdomain.com\n</code></pre>\n\n<p>In c#, I populate this into a DataTable called dt with 722 rows.  I use this to make a second DataTable called distinctTbl with 344 rows containing only the distinct email addresses using this:</p>\n\n<pre><code>DataTable distinctTbl = dt.AsDataView().ToTable(true, \"Email\");\n</code></pre>\n\n<p>I am trying to use nested loops to make a list of integers (Customer ID) for each email address:</p>\n\n<pre><code>foreach (DataRow dr in distinctTbl.Rows)\n{\n    // for each email address:\n    List&lt;int&gt; idNums = new List&lt;int&gt;();\n\n    foreach (DataRow myRow in dt.Rows) \n    {\n        // for every customerID / email pair in the original table\n        if (myRow[\"Email\"] == dr[\"Email\"])\n        {\n            idNums.Add((int)myRow[\"CustomerID\"]);\n        }\n    }\n\n    // Do something with the List&lt;int&gt; before exiting outside loop\n}\n</code></pre>\n\n<p>When I run this code, each List of integers contains exactly one value.  The value is correct, but there should be a minimum of two for each email address.  I have done enough debugging to figure out that it always correctly identifies the first one, but skips any subsequent matches.  I'm sure I'm missing something obvious, but does somebody see what is happening?</p>\n"}, {"tags": ["c#", "wpf", "contextmenu", "scrollviewer"], "answers": [{"tags": [], "owner": {"reputation": 1714, "user_id": 3029887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0a6HZ.jpg?s=128&g=1", "display_name": "AzzamAziz", "link": "https://stackoverflow.com/users/3029887/azzamaziz"}, "is_accepted": false, "score": 0, "last_activity_date": 1423682392, "last_edit_date": 1495542817, "creation_date": 1423682392, "answer_id": 28462688, "question_id": 28462210, "link": "https://stackoverflow.com/questions/28462210/wpf-context-menu-auto-scroll/28462688#28462688", "title": "WPF context menu auto scroll", "body": "<p>You can check the VerticalOffset. The VerticalOffset property is between 0 and ScrollableHeight. Read more about it <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.verticaloffset%28v=vs.110%29.aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>private void OnScrollChanged(object sender, ScrollChangedEventArgs e)\n{\n   var scrollViewer = (ScrollViewer)sender;\n   if (scrollViewer.VerticalOffset == 0)\n          MessageBox.Show(\"This is the start.\");\n   else if (scrollViewer.VerticalOffset == scrollViewer.ScrollableHeight)\n          MessageBox.Show(\"This is the end\"); \n}\n</code></pre>\n\n<p>Similar solution <a href=\"https://stackoverflow.com/questions/10793717/how-to-find-that-scrollviewer-is-scrolled-to-the-end-in-wpf\">here</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 4556241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a9a716d679fb66c9c4311814429e4f?s=128&d=identicon&r=PG&f=1", "display_name": "Vadim Maslov", "link": "https://stackoverflow.com/users/4556241/vadim-maslov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1099, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1423682392, "creation_date": 1423680842, "question_id": 28462210, "link": "https://stackoverflow.com/questions/28462210/wpf-context-menu-auto-scroll", "title": "WPF context menu auto scroll", "body": "<p>I have a context menu in WPF with, say, 40 menu items. I limited the height of the context menu to, say \"130\" so that only five item appear at a time. It perfectly automatically assigned scrollviewer which a user can use to scroll the items. In the mean time, I need to capture ScrollChanged event so that I could remember the last scroll position and assign it later. ScrollViewer in</p>\n\n<p></p>\n\n<p></p>\n\n<p>does not have anything I could use for that purpose</p>\n"}, {"tags": ["c#", "ftp", "wav"], "comments": [{"owner": {"reputation": 1682, "user_id": 2544158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osuok.jpg?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/2544158/reticulated-spline"}, "edited": false, "score": 0, "creation_date": 1423680770, "post_id": 28462110, "comment_id": 45250133, "body": "You probably shouldn&#39;t include your real credentials in the code."}, {"owner": {"reputation": 4489, "user_id": 266553, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/oTUw0.jpg?s=128&g=1", "display_name": "KenD", "link": "https://stackoverflow.com/users/266553/kend"}, "edited": false, "score": 2, "creation_date": 1423680852, "post_id": 28462110, "comment_id": 45250184, "body": "Does <a href=\"http://stackoverflow.com/questions/12650013/c-sharp-file-is-corrupt-after-uploaded-to-server\" title=\"c sharp file is corrupt after uploaded to server\">stackoverflow.com/questions/12650013/&hellip;</a> help?"}, {"owner": {"reputation": 3509, "user_id": 3632857, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MFj6J.jpg?s=128&g=1", "display_name": "ConductedClever", "link": "https://stackoverflow.com/users/3632857/conductedclever"}, "reply_to_user": {"reputation": 1682, "user_id": 2544158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osuok.jpg?s=128&g=1", "display_name": "Reticulated Spline", "link": "https://stackoverflow.com/users/2544158/reticulated-spline"}, "edited": false, "score": 1, "creation_date": 1423680945, "post_id": 28462110, "comment_id": 45250237, "body": "thanks @ReticulatedSpline."}, {"owner": {"reputation": 3509, "user_id": 3632857, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MFj6J.jpg?s=128&g=1", "display_name": "ConductedClever", "link": "https://stackoverflow.com/users/3632857/conductedclever"}, "reply_to_user": {"reputation": 4489, "user_id": 266553, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/oTUw0.jpg?s=128&g=1", "display_name": "KenD", "link": "https://stackoverflow.com/users/266553/kend"}, "edited": false, "score": 2, "creation_date": 1423682418, "post_id": 28462110, "comment_id": 45251096, "body": "@KenD , it was useful. it worked exactly as i wished. thanks."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1559200864, "post_id": 28462110, "comment_id": 99348805, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12650013/c-sharp-file-is-corrupt-after-uploaded-to-server\">C# - File is corrupt after uploaded to server</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3509, "user_id": 3632857, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MFj6J.jpg?s=128&g=1", "display_name": "ConductedClever", "link": "https://stackoverflow.com/users/3632857/conductedclever"}, "edited": false, "score": 0, "creation_date": 1423681314, "post_id": 28462208, "comment_id": 45250470, "body": "i checked that. it was not useful!"}, {"owner": {"reputation": 60462, "user_id": 3636601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69a1b4f750ece89db0e49c94519f1a7d?s=128&d=identicon&r=PG&f=1", "display_name": "Jens", "link": "https://stackoverflow.com/users/3636601/jens"}, "reply_to_user": {"reputation": 3509, "user_id": 3632857, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MFj6J.jpg?s=128&g=1", "display_name": "ConductedClever", "link": "https://stackoverflow.com/users/3632857/conductedclever"}, "edited": false, "score": 0, "creation_date": 1423681351, "post_id": 28462208, "comment_id": 45250493, "body": "@ConductedClever Why not?"}, {"owner": {"reputation": 3509, "user_id": 3632857, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MFj6J.jpg?s=128&g=1", "display_name": "ConductedClever", "link": "https://stackoverflow.com/users/3632857/conductedclever"}, "edited": false, "score": 2, "creation_date": 1423681494, "post_id": 28462208, "comment_id": 45250559, "body": "the sound is still very noisy. if you want i give you the sound!"}], "tags": [], "owner": {"reputation": 60462, "user_id": 3636601, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/69a1b4f750ece89db0e49c94519f1a7d?s=128&d=identicon&r=PG&f=1", "display_name": "Jens", "link": "https://stackoverflow.com/users/3636601/jens"}, "is_accepted": false, "score": 3, "last_activity_date": 1423680838, "creation_date": 1423680838, "answer_id": 28462208, "question_id": 28462110, "link": "https://stackoverflow.com/questions/28462110/file-corrupts-afters-uploading-using-ftp-protocol/28462208#28462208", "title": "File corrupts afters uploading using FTP protocol", "body": "<p>You have to set your Ftp request to binary <code>request.UseBinary</code> to <code>true</code>.</p>\n\n<pre><code>request.UseBinary = true;\n</code></pre>\n"}], "owner": {"reputation": 3509, "user_id": 3632857, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/MFj6J.jpg?s=128&g=1", "display_name": "ConductedClever", "link": "https://stackoverflow.com/users/3632857/conductedclever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1559200843, "creation_date": 1423680541, "last_edit_date": 1559200843, "question_id": 28462110, "link": "https://stackoverflow.com/questions/28462110/file-corrupts-afters-uploading-using-ftp-protocol", "title": "File corrupts afters uploading using FTP protocol", "body": "<p>I am trying to upload some <code>*.wav</code> files to a host using FTP protocol. The thing is that, after uploading, the file is very damaged! The size of file is the same as the file on local and I can hear something in the corrupted file but noise is added too much to the WAV file.</p>\n\n<p>This is the code I use to upload my files to server:</p>\n\n<pre><code>    public void UploadViaFtp(Object fn)\n    {\n        string filename = (string)fn;\n        // Get the object used to communicate with the server.\n        FtpWebRequest request = (FtpWebRequest)WebRequest.Create(\"ftp://ftp.****.com/htdocs/uploads/\" + filename + \".wav\");\n        request.Method = WebRequestMethods.Ftp.UploadFile;\n\n        // This example assumes the FTP site uses anonymous logon.\n        request.Credentials = new NetworkCredential(\"****\", \"****\");\n\n        // Copy the contents of the file to the request stream.\n        StreamReader sourceStream = new StreamReader(filename + \".wav\");\n        byte[] fileContents = Encoding.Default.GetBytes(sourceStream.ReadToEnd());\n        sourceStream.Close();\n        request.ContentLength = fileContents.Length;\n\n        Stream requestStream = request.GetRequestStream();\n        requestStream.Write(fileContents, 0, fileContents.Length);\n        requestStream.Close();\n\n        FtpWebResponse response = (FtpWebResponse)request.GetResponse();\n\n        this.Dispatcher.Invoke((Action)(() =&gt; box.Text += \"\\nFile \\\"\" + filename + \"\\\" Uploaded Successfully!!!\"));\n\n        response.Close();\n    }\n</code></pre>\n\n<p>This is the code that records sound files for me:</p>\n\n<pre><code>    [DllImport(\"winmm.dll\", EntryPoint = \"mciSendStringA\", CharSet = CharSet.Ansi, SetLastError = true, ExactSpelling = true)]\n    private static extern int mciSendString(string lpstrCommand, string lpstrReturnString, int uReturnLength, int hwndCallback);\n\n    struct RecUploadStruct\n    {\n        public DateTime timeForNaming;\n    }\n\n    public void RecUpload(Object param)\n    {\n        RecUploadStruct iParam = (RecUploadStruct)param;\n\n        mciSendString(\"open new Type waveaudio Alias recsound\", \"\", 0, 0);\n        mciSendString(\"record recsound\", \"\", 0, 0);\n        Console.WriteLine(\"recording, press Enter to stop and save ...\");\n\n        Thread.Sleep(1000);\n\n        string name = iParam.timeForNaming.Day.ToString() + iParam.timeForNaming.Hour.ToString() + iParam.timeForNaming.Minute.ToString() + iParam.timeForNaming.Second.ToString();\n\n        mciSendString(\"save recsound \" + name + \".wav\", \"\", 0, 0);\n        mciSendString(\"close recsound \", \"\", 0, 0);\n\n        Thread uploader = new Thread(UploadViaFtp);\n\n        uploader.Start(name);\n    }\n</code></pre>\n\n<p>and this is some file before uploading:</p>\n\n<p><a href=\"http://parma.fagig.com/uploads/11184020-b.wav\" rel=\"nofollow noreferrer\">before</a></p>\n\n<p>and this is the file after uploading:</p>\n\n<p><a href=\"http://parma.fagig.com/uploads/11184020.wav\" rel=\"nofollow noreferrer\">after</a></p>\n"}]