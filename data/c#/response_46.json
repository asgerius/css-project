[{"tags": ["c#", "visual-studio-lightswitch", "lightswitch-2013"], "comments": [{"owner": {"reputation": 1241, "user_id": 2876977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ud3MR.gif?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/2876977/kris"}, "edited": false, "score": 0, "creation_date": 1448513863, "post_id": 33928426, "comment_id": 55622349, "body": "Is it a Desktop or Html application?"}], "answers": [{"comments": [{"owner": {"reputation": 963, "user_id": 912589, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/706df2e5ee3963a3aa80d79e735550c8?s=128&d=identicon&r=PG", "display_name": "Zulu Z", "link": "https://stackoverflow.com/users/912589/zulu-z"}, "edited": false, "score": 0, "creation_date": 1448759232, "post_id": 33949696, "comment_id": 55712925, "body": "thanks, is that javascript code hidden somewhere? search for delete method doesn&#39;t fine it. how about intellitrace? will it work with this?"}, {"owner": {"reputation": 1241, "user_id": 2876977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ud3MR.gif?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/2876977/kris"}, "reply_to_user": {"reputation": 963, "user_id": 912589, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/706df2e5ee3963a3aa80d79e735550c8?s=128&d=identicon&r=PG", "display_name": "Zulu Z", "link": "https://stackoverflow.com/users/912589/zulu-z"}, "edited": false, "score": 0, "creation_date": 1448852623, "post_id": 33949696, "comment_id": 55737539, "body": "The JavaScript isn&#39;t hidden.  There should be an filename.lsml.js file associated with every filename.lsml file.  IntelliTrace does work with LightSwitch."}], "tags": [], "owner": {"reputation": 1241, "user_id": 2876977, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ud3MR.gif?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/2876977/kris"}, "is_accepted": true, "score": 1, "last_activity_date": 1448593519, "creation_date": 1448593519, "answer_id": 33949696, "question_id": 33928426, "link": "https://stackoverflow.com/questions/33928426/how-to-debug-delete-button-action-in-lightswitch/33949696#33949696", "title": "how to debug delete button action in Lightswitch?", "body": "<p>Lightswitch HTML uses JavaScript for the code behind, not C#.  An example of a typical LS delete command: </p>\n\n<pre><code>screen.Items.deleteSelected();\n</code></pre>\n\n<p>Debugging can be a bitch at times, often i find i have to place breakpoints <em>AFTER</em> running the application.  Alternatively, you could use a crude debugging method and insert a bunch of alert() methods in the JavaScript.  It's not pretty, but it's effective.</p>\n\n<p><em>Note: The delete code could be calling a WebAPI web service, or running SQL against a database.  In both these scenarios you will need to separately debug these.</em></p>\n"}], "owner": {"reputation": 963, "user_id": 912589, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/706df2e5ee3963a3aa80d79e735550c8?s=128&d=identicon&r=PG", "display_name": "Zulu Z", "link": "https://stackoverflow.com/users/912589/zulu-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 33949696, "answer_count": 1, "score": 0, "last_activity_date": 1448593519, "creation_date": 1448495438, "question_id": 33928426, "link": "https://stackoverflow.com/questions/33928426/how-to-debug-delete-button-action-in-lightswitch", "title": "how to debug delete button action in Lightswitch?", "body": "<p>I am supposed to find a bug  in Lightswitch C# application written in VS2012\nwhich causes application to hung when delete button is clicked. I am new to LS\nand have problem figuring out how to find the internal code is executed when that\nbutton is selected. Even when I try to override action of this button debugger doesn't stop there. Debugging just my code is turned off, on screen data binding I see some name I cannot find in the code. Anybody here has some experience with lightswitch to point me to right direction?  thanks</p>\n"}, {"tags": ["c#", "solid-principles"], "comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1448496112, "post_id": 33928344, "comment_id": 55618009, "body": "Your question is not very clear. Can you explain exactly what is the problem? You mentioned a base class, what do you mean?"}, {"owner": {"reputation": 31, "user_id": 5606276, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_5CRH_0uNkw/AAAAAAAAAAI/AAAAAAAAAKY/PmdB5fCksYQ/photo.jpg?sz=128", "display_name": "Sabahuddin Ansari", "link": "https://stackoverflow.com/users/5606276/sabahuddin-ansari"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1448538739, "post_id": 33928344, "comment_id": 55635267, "body": "thanks for your response, I have modified the question"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1448538909, "post_id": 33928344, "comment_id": 55635367, "body": "The question is still not clear. What is the expected result? a <code>List&lt;Product&gt;</code>?"}, {"owner": {"reputation": 127, "user_id": 5516658, "user_type": "registered", "profile_image": "https://graph.facebook.com/700007703467603/picture?type=large", "display_name": "Paulo Lima", "link": "https://stackoverflow.com/users/5516658/paulo-lima"}, "edited": false, "score": 0, "creation_date": 1448539566, "post_id": 33928344, "comment_id": 55635786, "body": "I think i get it, he has 2 lists of diferent types, and he wants to join them on another list (List&lt;Products&gt;) with wich type (Item1 and Item2). Is that it?"}, {"owner": {"reputation": 31, "user_id": 5606276, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_5CRH_0uNkw/AAAAAAAAAAI/AAAAAAAAAKY/PmdB5fCksYQ/photo.jpg?sz=128", "display_name": "Sabahuddin Ansari", "link": "https://stackoverflow.com/users/5606276/sabahuddin-ansari"}, "edited": false, "score": 0, "creation_date": 1448575198, "post_id": 33928344, "comment_id": 55654018, "body": "hey guys thanks for your quick response and sorry, I cannot describe exact output, I want like this........   var list1 = new List&lt;Item1&gt;();  and var list2 = new List&lt;Item2&gt;();  and I want to these two list in product class like this var p1 = list1.Select(s=&gt; new Product{Id=s.Id}),p1 = list2.Select(s=&gt; new Product{Id=s.Id}); and merge to in a single list var finalProduct = p1.Concat(p2).Tolist(); after that I can call finalProduct anywhere in the project but I want this using SOLID design. whatever extra clasess take, doesn&#39;t matter but return type should be product class list. thanks"}, {"owner": {"reputation": 6798, "user_id": 4174897, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/gS0gI.jpg?s=128&g=1", "display_name": "Kyll", "link": "https://stackoverflow.com/users/4174897/kyll"}, "edited": false, "score": 3, "creation_date": 1449833778, "post_id": 33928344, "comment_id": 56188968, "body": "Please <a href=\"https://stackoverflow.com/posts/33928344/edit\">edit</a> your post to include any additional information you have to your question. Avoid adding this in the comments, as they are harder to read and can be deleted easier. The edit button for your post is just below the post&#39;s tags. Make sure, however, not to invalidate existing answers by your edit!"}, {"owner": {"reputation": 1107, "user_id": 427140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e9bf3faffb22ac0e74ff571e0e2c2d4?s=128&d=identicon&r=PG&f=1", "display_name": "Kerri Brown", "link": "https://stackoverflow.com/users/427140/kerri-brown"}, "edited": false, "score": 1, "creation_date": 1512721813, "post_id": 33928344, "comment_id": 82380512, "body": "What&#39;s the difference between the Item1 and Item2 classes?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5606276, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_5CRH_0uNkw/AAAAAAAAAAI/AAAAAAAAAKY/PmdB5fCksYQ/photo.jpg?sz=128", "display_name": "Sabahuddin Ansari", "link": "https://stackoverflow.com/users/5606276/sabahuddin-ansari"}, "edited": false, "score": 0, "creation_date": 1448575214, "post_id": 33941078, "comment_id": 55654023, "body": "hey guys thanks for your quick response and sorry, I cannot describe exact output, I want like this........   var list1 = new List&lt;Item1&gt;();  and var list2 = new List&lt;Item2&gt;();  and I want to these two list in product class like this var p1 = list1.Select(s=&gt; new Product{Id=s.Id}),p1 = list2.Select(s=&gt; new Product{Id=s.Id}); and merge to in a single list var finalProduct = p1.Concat(p2).Tolist(); after that I can call finalProduct anywhere in the project but I want this using SOLID design. whatever extra clasess take, doesn&#39;t matter but return type should be product class list. thanks"}, {"owner": {"reputation": 8780, "user_id": 1450855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kp4T0.gif?s=128&g=1", "display_name": "Georg Patscheider", "link": "https://stackoverflow.com/users/1450855/georg-patscheider"}, "reply_to_user": {"reputation": 31, "user_id": 5606276, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_5CRH_0uNkw/AAAAAAAAAAI/AAAAAAAAAKY/PmdB5fCksYQ/photo.jpg?sz=128", "display_name": "Sabahuddin Ansari", "link": "https://stackoverflow.com/users/5606276/sabahuddin-ansari"}, "edited": false, "score": 0, "creation_date": 1448614565, "post_id": 33941078, "comment_id": 55665015, "body": "You could define an interface on Product, Item1, Item2 that contains the properties that are common with Product, e.g. <code>interface IProductLike { Guid Id { get; set; } string Name { get; set; }}</code> and then map Item1 and Item2 to Product like you outlined above. The interface helps with consistency. But there is the danger that you will start mixing concerns in the Product class, e.g. if you have to attribute the properties differently for your OR Mapper, for WCF and to display them. Therefore a common design principle is to separate frontend and backend into different classes."}], "tags": [], "owner": {"reputation": 8780, "user_id": 1450855, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kp4T0.gif?s=128&g=1", "display_name": "Georg Patscheider", "link": "https://stackoverflow.com/users/1450855/georg-patscheider"}, "is_accepted": false, "score": 0, "last_activity_date": 1448832828, "last_edit_date": 1448832828, "creation_date": 1448548051, "answer_id": 33941078, "question_id": 33928344, "link": "https://stackoverflow.com/questions/33928344/add-multiple-classes-data-in-single-class-using-solid-design-pattern/33941078#33941078", "title": "Add multiple classes data in single class using SOLID design pattern", "body": "<p>Use a ViewModel to handle your display concerns. This respects the single responsibility principle. The responsibilities of the ViewModel are displaying data and validating <code>&lt;form&gt;</code> inputs filled in by the user (if any). The data to be displayed can be aggregated from many sources.</p>\n\n<p>Use a mapping between your persisted entities/ domain entities/ data transfer objects and your ViewModel. Define a mapping from each source class to your ViewModel. Using a library such as <a href=\"http://automapper.org/\" rel=\"nofollow\">AutoMapper</a> for this is highly recommended.</p>\n\n<p>For Example:</p>\n\n<pre><code>public class ProductDetailsViewModel {\n    // Display attribute as an example of a view concern\n    [Display(Name = \"ProductDetails_Name\", ResourceType = typeof(Resources))]\n    public string Name {get; set;}\n}\n\npublic class ProductListViewModel {\n    public IEnumerable&lt;ProductDetailsViewModel&gt; ProductDetails {get; set;}\n}\n\n\n// Example of mapping by hand:\nvar item1 = new Item1();\nvar item2 = new Item2();\nvar vm1 = new ProductDetailsViewModel { Name = item1.Name };\nvar vm2 = new ProductDetailsViewModel { Name = item2.Name };\nvar productList = new ProductListViewModel {ProductDetails = new [] {vm1, vm2}}; \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3625, "user_id": 705561, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33bd97a9ad37e8a056f4007039149553?s=128&d=identicon&r=PG", "display_name": "Eon", "link": "https://stackoverflow.com/users/705561/eon"}, "edited": false, "score": 0, "creation_date": 1448550846, "post_id": 33941679, "comment_id": 55642906, "body": "Oh Right, if your items aren&#39;t intended to be collections, simply remove the <code>List&lt;..&gt;</code> and replace it with <code>Item1</code> and <code>Item2</code>. Use the <code>ProductFull</code> as your model instead."}, {"owner": {"reputation": 31, "user_id": 5606276, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_5CRH_0uNkw/AAAAAAAAAAI/AAAAAAAAAKY/PmdB5fCksYQ/photo.jpg?sz=128", "display_name": "Sabahuddin Ansari", "link": "https://stackoverflow.com/users/5606276/sabahuddin-ansari"}, "edited": false, "score": 0, "creation_date": 1448575228, "post_id": 33941679, "comment_id": 55654030, "body": "hey guys thanks for your quick response and sorry, I cannot describe exact output, I want like this........   var list1 = new List&lt;Item1&gt;();  and var list2 = new List&lt;Item2&gt;();  and I want to these two list in product class like this var p1 = list1.Select(s=&gt; new Product{Id=s.Id}),p1 = list2.Select(s=&gt; new Product{Id=s.Id}); and merge to in a single list var finalProduct = p1.Concat(p2).Tolist(); after that I can call finalProduct anywhere in the project but I want this using SOLID design. whatever extra clasess take, doesn&#39;t matter but return type should be product class list. thanks"}], "tags": [], "owner": {"reputation": 3625, "user_id": 705561, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33bd97a9ad37e8a056f4007039149553?s=128&d=identicon&r=PG", "display_name": "Eon", "link": "https://stackoverflow.com/users/705561/eon"}, "is_accepted": false, "score": 0, "last_activity_date": 1448549983, "creation_date": 1448549983, "answer_id": 33941679, "question_id": 33928344, "link": "https://stackoverflow.com/questions/33928344/add-multiple-classes-data-in-single-class-using-solid-design-pattern/33941679#33941679", "title": "Add multiple classes data in single class using SOLID design pattern", "body": "<p>Assuming you want to override the values of product as well as have a list of children Items, I would suggest that you declare values you intend to override as virtual, and make another class available that can also take a list of items as required, while inheriting from the parent product table.</p>\n\n<pre><code>    public class Product\n    {\n        public virtual Guid Id { get; set; }\n        public virtual string Name { get; set; }\n        public virtual string Type { get; set; }\n    }\n\n    public class ProductFull : Product\n    {\n        public override Guid Id { get; set; }\n        public override string Name { get; set; }\n        public override string Type { get; set; }\n\n        public List&lt;Item1&gt; Item1s { get; set; }\n\n        public List&lt;Item2&gt; Item2s { get; set; }\n    }\n\n    public class Item1\n    {\n        public Guid Id { get; set; }\n        public string Name { get; set; }\n    }\n\n    public class Item2\n    {\n        public Guid Id { get; set; }\n        public string Name { get; set; }\n    }\n</code></pre>\n\n<p>From MSDN:</p>\n\n<p>Virtual properties behave like abstract methods, except for the differences in declaration and invocation syntax.\nIt is an error to use the virtual modifier on a static property.\nA virtual inherited property can be overridden in a derived class by including a property declaration that uses the override modifier.</p>\n"}], "owner": {"reputation": 31, "user_id": 5606276, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_5CRH_0uNkw/AAAAAAAAAAI/AAAAAAAAAKY/PmdB5fCksYQ/photo.jpg?sz=128", "display_name": "Sabahuddin Ansari", "link": "https://stackoverflow.com/users/5606276/sabahuddin-ansari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 459, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1448833599, "creation_date": 1448494918, "last_edit_date": 1448833599, "question_id": 33928344, "link": "https://stackoverflow.com/questions/33928344/add-multiple-classes-data-in-single-class-using-solid-design-pattern", "title": "Add multiple classes data in single class using SOLID design pattern", "body": "<p>I have <code>Product</code>, <code>Item1</code> and <code>Item2</code> classes.The goal is to consolidate all of the Items in product class into a single list so that they can be sorted and\ndisplayed on the client's website.I want this in C# using SOLID principle</p>\n\n<pre><code>public class Product\n    {\n        public Guid Id { get; set; }\n        public string Name { get; set; }\n        public string Type { get; set; }\n    }\nand here are list of datas are in this class\n-- var list1 = new List&lt;Item1&gt;();\npublic class Item1\n    {\n        public Guid Id { get; set; }\n        public string Name { get; set; }\n    }\n-- var list2 = new List&lt;Item2&gt;();\npublic class Item2\n    {\n        public Guid Id { get; set; }\n        public string Name { get; set; }\n    }\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "azure", "azure-web-roles"], "comments": [{"owner": {"reputation": 3503, "user_id": 2945345, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "trees_are_great", "link": "https://stackoverflow.com/users/2945345/trees-are-great"}, "edited": false, "score": 0, "creation_date": 1448889209, "post_id": 33928342, "comment_id": 55754415, "body": "This might help: <a href=\"http://blogs.msdn.com/b/webdev/archive/2013/11/05/remote-debugging-a-window-azure-web-site-with-visual-studio-2013.aspx\" rel=\"nofollow noreferrer\">blogs.msdn.com/b/webdev/archive/2013/11/05/&hellip;</a>"}, {"owner": {"reputation": 1072, "user_id": 5369571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/641e8e142fc580ce45a87b3f522da18d?s=128&d=identicon&r=PG&f=1", "display_name": "HBomb", "link": "https://stackoverflow.com/users/5369571/hbomb"}, "edited": false, "score": 0, "creation_date": 1449095804, "post_id": 33928342, "comment_id": 55863104, "body": "Wait... to be clear, when you are inspecting the HttpContext.Current.Response object, and that shows 200 OK... is that on the windows 10 machine? If so, it must be related to the networking on the local machine and is not related to your code... like a firewall traffic or port rule specific to that machine."}], "answers": [{"tags": [], "owner": {"reputation": 551, "user_id": 64317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a27a0c8c28e0298ac173ac716a0f87a?s=128&d=identicon&r=PG", "display_name": "Andr&#233; Boonzaaijer", "link": "https://stackoverflow.com/users/64317/andr%c3%a9-boonzaaijer"}, "is_accepted": false, "score": 1, "last_activity_date": 1449127636, "creation_date": 1449127636, "answer_id": 34060099, "question_id": 33928342, "link": "https://stackoverflow.com/questions/33928342/azure-local-web-role-the-page-cannot-be-displayed-because-an-internal-server-er/34060099#34060099", "title": "Azure Local Web Role &quot;The page cannot be displayed because an internal server error has occurred.&quot;", "body": "<p>I had the same issue after updating to Azure 2.7 from 2.5. The solution I found here worked for me: <a href=\"http://www.thedailyparker.com/post/2014/06/07/aa5142ff-846a-4764-9a22-a390c79a2578\" rel=\"nofollow\">http://www.thedailyparker.com/post/2014/06/07/aa5142ff-846a-4764-9a22-a390c79a2578</a> </p>\n\n<p>They stated that after hours of debugging they found a misconfig in the azure diagnostics trace listener. Removing the section did the trick for me (although my version seemed to be configured correctly). Maybe my emulator wasn't updated correctly or something. </p>\n"}], "owner": {"reputation": 9729, "user_id": 94958, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e32c3a3986d42596677fffe2f24fd3a8?s=128&d=identicon&r=PG", "display_name": "Micah", "link": "https://stackoverflow.com/users/94958/micah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1449127636, "creation_date": 1448494908, "question_id": 33928342, "link": "https://stackoverflow.com/questions/33928342/azure-local-web-role-the-page-cannot-be-displayed-because-an-internal-server-er", "title": "Azure Local Web Role &quot;The page cannot be displayed because an internal server error has occurred.&quot;", "body": "<p>I have this Azure Web 2.3 project working on a Windows 7 machine, but for some reason on a totally new Windows 10 machine when I run the azure project, i get a blank white screen that 500s with the phrase:</p>\n\n<p><code>The page cannot be displayed because an internal server error has occurred.</code></p>\n\n<p>This is the response for all MVC3 endpoints and for all static html files in the web project.</p>\n\n<p>Other facts:</p>\n\n<ul>\n<li>the WebRole.cs <code>OnStart()</code> gets called</li>\n<li>the Global.asax.cs <code>Application_Start()</code> gets called</li>\n<li>the Global.asax.cs <code>Application_Error()</code> gets called when the site first boots up due to not having a controller mapped to <code>/</code>-- so it handles at least this request,,, a bit</li>\n<li>the Global.asax.cs <code>BeginRequest()</code> and <code>EndRequest</code> functions gets called. For all requests when i inspect <code>HttpContext.Current.Response</code> it says that the response is a 200 OK, although in chrome i'm getting a 500 server error...</li>\n<li>i've checked the local azure compute emulator and it says that i'm using the correct host and port (which makes sense, given that the app is def semi-handling requests as described above)</li>\n</ul>\n\n<p>Totally lost on this one. Windows 10 thing?</p>\n"}, {"tags": ["c#", "entity-framework", "linq"], "answers": [{"tags": [], "owner": {"reputation": 348, "user_id": 4406940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920f870bf0b7382a0d8f208e0fab5688?s=128&d=identicon&r=PG&f=1", "display_name": "Eckd", "link": "https://stackoverflow.com/users/4406940/eckd"}, "is_accepted": false, "score": 0, "last_activity_date": 1448495406, "creation_date": 1448495406, "answer_id": 33928421, "question_id": 33928336, "link": "https://stackoverflow.com/questions/33928336/entity-framework-unable-to-complete-delete/33928421#33928421", "title": "Entity Framework unable to complete delete", "body": "<p>Can you move delete invoice to be after loop?\ne.g.:</p>\n\n<pre><code>var costs = db.Costs.Where(i =&gt; i.InvoiceId == id);\n\nforeach (var cost in costs)\n{\n    //Delete all related costs.\n    db.Costs.Remove(cost);\n}\ndb.Invoices.Remove(invoiceToDelete);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "edited": false, "score": 0, "creation_date": 1448495713, "post_id": 33928457, "comment_id": 55617905, "body": "Agreed, except I&#39;d keep this within the entity framework so a dropped db will rebuild it back with the cascade.  See this SO: <a href=\"http://stackoverflow.com/questions/17487577/entity-framework-ef-code-first-cascade-delete-for-one-to-zero-or-one-relations\" title=\"entity framework ef code first cascade delete for one to zero or one relations\">stackoverflow.com/questions/17487577/&hellip;</a>"}, {"owner": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "reply_to_user": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "edited": false, "score": 0, "creation_date": 1448495822, "post_id": 33928457, "comment_id": 55617938, "body": "Very true, either way will accomplish the same thing. It all depends on if you need all interactions with the database to have the cascade or not."}, {"owner": {"reputation": 523, "user_id": 2596756, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/x7W4s.png?s=128&g=1", "display_name": "KidBatman", "link": "https://stackoverflow.com/users/2596756/kidbatman"}, "reply_to_user": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "edited": false, "score": 0, "creation_date": 1448498902, "post_id": 33928457, "comment_id": 55618664, "body": "@MutantNinjaCodeMonkey I am using a code first from an existing database implementation. Is it best practice to setup the cascade in the manner described in the SO post you linked or is Matt&#39;s SQL essentially doing the same thing and maybe a cleaner approach?"}, {"owner": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "reply_to_user": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "edited": false, "score": 0, "creation_date": 1448499137, "post_id": 33928457, "comment_id": 55618707, "body": "Adding the mapping that is mentioned in @MutantNinjaCodeMonkey&#39;s link will be the route to go if you do not want the cascade with other interactions with the same database. If you set it in the database using the FK constraint then it will always cascade not just in your current application, but every application (or direct SQL) that uses it. The short answer would be that the situation dictates which route to choose but either one will accomplish what you are wanting to do."}, {"owner": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "edited": false, "score": 0, "creation_date": 1448499358, "post_id": 33928457, "comment_id": 55618768, "body": "There is another item to consider since you are using Code First from DB. If you already had the FK set up to cascade on delete then when you generated your Code First model the mapping in your context would had auto generated. So, you could think about adding the cascade to both the DB and your EF context."}, {"owner": {"reputation": 523, "user_id": 2596756, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/x7W4s.png?s=128&g=1", "display_name": "KidBatman", "link": "https://stackoverflow.com/users/2596756/kidbatman"}, "edited": false, "score": 0, "creation_date": 1448526814, "post_id": 33928457, "comment_id": 55627585, "body": "Added the <code>Cascade</code> to my <code>FK</code>, but now i&#39;m getting a totally different error. &quot;Store update, insert, or delete statement affected an unexpected number of rows (0). Entities may have been modified or deleted since entities were loaded. See nfor information on understanding and handling optimistic concurrency exceptions.&quot; Possibly a race condition? I&#39;m considering using <code>context.Database.SqlCommand</code> and just write a SQL statement to delete the desired costs."}, {"owner": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "edited": false, "score": 0, "creation_date": 1448541950, "post_id": 33928457, "comment_id": 55637202, "body": "You are getting this because of the code first database seed. If you want to do away with this error add this line of code to your <code>OnModelCreating</code> Method in your context. <code>Database.SetInitilizer&lt;TContext&gt;(null);</code> Make sure you replace the <code>TContext</code> with the name of your context class. The documentation for this method is here. <a href=\"https://msdn.microsoft.com/en-us/library/gg679461(v=vs.113).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/gg679461(v=vs.113).aspx</a> (This method is to seed how your model manages your database. Since you are using Code First from DB you want to make the seed null.)"}], "tags": [], "owner": {"reputation": 4497, "user_id": 2856868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YYZQQ.jpg?s=128&g=1", "display_name": "Matt Rowland", "link": "https://stackoverflow.com/users/2856868/matt-rowland"}, "is_accepted": false, "score": 1, "last_activity_date": 1448496205, "last_edit_date": 1448496205, "creation_date": 1448495602, "answer_id": 33928457, "question_id": 33928336, "link": "https://stackoverflow.com/questions/33928336/entity-framework-unable-to-complete-delete/33928457#33928457", "title": "Entity Framework unable to complete delete", "body": "<p>The best way to complete this would be to add a cascade on delete in your database. You most likely have a simple foreign key constraint. You will need to drop that constraint and add it again with a cascade on delete.</p>\n\n<p>The statements to complete this will look something like the following:</p>\n\n<pre><code>ALTER TABLE dbo.Costs\n   DROP CONSTRAINT FK_Invoices_Costs --name of constraint\n\nALTER TABLE dbo.Costs\n   ADD CONSTRAINT FK_Invoices_Costs_Cascade\n   FOREIGN KEY (InvoiceId) REFERENCES dbo.Invoices(InvoiceId) ON DELETE CASCADE\n</code></pre>\n\n<p>Once you have this setup; all the costs with the InvoiceId of the invoice that you delete with EF will then also be deleted.</p>\n"}, {"tags": [], "owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "is_accepted": false, "score": 0, "last_activity_date": 1448496379, "creation_date": 1448496379, "answer_id": 33928580, "question_id": 33928336, "link": "https://stackoverflow.com/questions/33928336/entity-framework-unable-to-complete-delete/33928580#33928580", "title": "Entity Framework unable to complete delete", "body": "<p>If your model is set up correctly so that it knows you have a foreign key constraint, I believe all you really need to do is make sure EF has all the relevant info before you delete it, like so:</p>\n\n<pre><code>Invoice invoiceToDelete = db.Invoices.Include(i=&gt;i.Costs).First(i =&gt; i.Id == id);\ndb.Invoices.Remove(invoiceToDelete);\ndb.SaveChanges();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 523, "user_id": 2596756, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/x7W4s.png?s=128&g=1", "display_name": "KidBatman", "link": "https://stackoverflow.com/users/2596756/kidbatman"}, "is_accepted": true, "score": -1, "last_activity_date": 1448767338, "creation_date": 1448767338, "answer_id": 33979072, "question_id": 33928336, "link": "https://stackoverflow.com/questions/33928336/entity-framework-unable-to-complete-delete/33979072#33979072", "title": "Entity Framework unable to complete delete", "body": "<p>Unfortunately, none of the suggestions worked for my situation. My work around was to make the changes using two different <code>DbContext</code> instances to make the changes to both <code>Invoices</code> &amp; <code>Costs</code>, respectively.</p>\n\n<pre><code>using (var ctx = new MyDbContext())\n{\n      //Delete Invoice\n      ctx.SaveChanges();\n}\n\nusing (var ctx = new MyDbContext())\n{\n      //Delete related costs\n      ctx.SaveChanges();\n}\n</code></pre>\n\n<p>Many thanks to Matt Rowland. His answer was probably the more appropriate solution, but unfortunately for whatever reason I could not get to work for my particular instance. The <code>sln</code> that i'm working on was originally developed by consultants and they may not have been adhering to <code>EF</code> standard practices.</p>\n"}], "owner": {"reputation": 523, "user_id": 2596756, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/x7W4s.png?s=128&g=1", "display_name": "KidBatman", "link": "https://stackoverflow.com/users/2596756/kidbatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 33979072, "answer_count": 4, "score": 1, "last_activity_date": 1448767338, "creation_date": 1448494883, "question_id": 33928336, "link": "https://stackoverflow.com/questions/33928336/entity-framework-unable-to-complete-delete", "title": "Entity Framework unable to complete delete", "body": "<p>I am trying to delete an <code>Invoice</code> along with any related <code>Costs</code>. An <code>Invoice</code> to <code>Costs</code> is a 1 to many relationship.</p>\n\n<p>My Snipp:</p>\n\n<pre><code>Invoice invoiceToDelete = db.Invoices.First(i =&gt; i.Id == id);\ndb.Invoices.Remove(invoiceToDelete);\n\nvar costs = db.Costs.Where(i =&gt; i.InvoiceId == id);\n\nforeach (var cost in costs)\n{\n    //Delete all related costs.\n    db.Costs.Remove(cost);\n}\n\n//Tried using this as well to try and delete all related costs\n//db.Costs.RemoveRange(db.Costs.Where(x =&gt; x.InvoiceId == id));\n\ndb.SaveChanges();\n</code></pre>\n\n<p>If an <code>Invoice</code> has no related <code>Costs</code>, the code executes fine and the <code>Invoice</code> is removed from the table.</p>\n\n<p>When an <code>Invoice</code> has related <code>Costs</code>, however, it throws the following error:</p>\n\n<p><code>The DELETE statement conflicted with the REFERENCE constraint \"FK_Costs_Invoices\". The conflict occurred in database \"MyDB\", table \"dbo.Costs\", column 'InvoiceId'.\nThe statement has been terminated.</code></p>\n\n<p>Writing a delete SQL statement in SSMS, i'm able to delete from the <code>Costs</code> table according to the foreign key of <code>InvoiceId</code>.</p>\n"}, {"tags": ["c#", "entity-framework"], "comments": [{"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1448495994, "post_id": 33928287, "comment_id": 55617977, "body": "first, graph is an unusual term, and you&#39;re using it when describing conceptually different things: i.e. object, model, or type. second, entities are models that are initiated (the instance of) by the ef context; with the exception being the case of insertion. <code>db.Entry(form)</code> needs to be attached (Added State) before it can be modified. You need to satisfy any foreign key constraints in that operation."}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1448496747, "post_id": 33928287, "comment_id": 55618163, "body": "what is <code>FormAsAServiceDbContext</code>, it seems like a completely leaky abstraction."}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1448497946, "post_id": 33928287, "comment_id": 55618442, "body": "oh.. nevermind, I see you&#39;re attempting to modify an existing Form.. still, you should be querying the context for the form instance, and <b>putting</b> the elements into the entities collection..  at any rate, your issue is purely ajax posting and mvc framework serialization here. The JSON you referenced, you&#39;ve verified that is what is being posted from web developer tools?"}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 1, "creation_date": 1448499547, "post_id": 33928287, "comment_id": 55618817, "body": "the most relevant information you&#39;ve provided on your issue is &quot;form.elements.toList[0].attributes is always empty, even if ... attributes passed&quot; ... It is generally a serialization setting determining &#39;depth&#39; or recursion. Still, I&#39;m not sure that modifying the state of <code>Form</code> type instances will necessarily propagate or reflect state changes of <code>DbSet&lt;AttributeComponent&gt;</code> (presuming that&#39;s the repository and Entity Type name) even the attributes were serialized.."}, {"owner": {"reputation": 1199, "user_id": 1366179, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/BvTkP.jpg?s=128&g=1", "display_name": "Brett Caswell", "link": "https://stackoverflow.com/users/1366179/brett-caswell"}, "edited": false, "score": 0, "creation_date": 1448500422, "post_id": 33928287, "comment_id": 55619048, "body": "the default level of &#39;depth&#39; in MVC is 100, so that&#39;s unlikely the issue.. unless you&#39;ve set it to 1 somewhere.. update your question, and include the actual .NET classes/model/entities.. in particular <code>Form</code> and <code>Attribute</code>.. also, feel free to remove out-of-context information like the REACT markup, and just provide 1 JSON snippet.. there&#39;s a bit TMI in that regard... EF also seems a bit out-of-context to your issue as well, but your methodology and implementation could very well provide concerning results even after addressing the serialization issue."}], "answers": [{"tags": [], "owner": {"reputation": 343, "user_id": 2360233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/09b9711c2e9212648bb21de3bd185778?s=128&d=identicon&r=PG&f=1", "display_name": "trebi", "link": "https://stackoverflow.com/users/2360233/trebi"}, "is_accepted": true, "score": 0, "last_activity_date": 1448525685, "creation_date": 1448525685, "answer_id": 33933505, "question_id": 33928287, "link": "https://stackoverflow.com/questions/33928287/c-entityframework-update-add-delete-arbitrarily-complex-entity-graph/33933505#33933505", "title": "C# EntityFramework: Update / Add / Delete arbitrarily complex entity graph", "body": "<p><strong>@Brett Caswell</strong> you are completely right with </p>\n\n<blockquote>\n  <p>the most relevant information you've provided on your issue is\n  \"form.elements.toList[0].attributes is always empty, even if ...\n  attributes passed\"</p>\n</blockquote>\n\n<p>Long description, simple problem. Name of collection <code>attributes</code> does not corresponded exactly to property in model object, so once I have changed it, mapping started to works (to any depth), so now I just need to iterate over them and set state to <em>Added</em> or <em>Modified</em>, depending on whether ID is 0 or not.</p>\n"}], "owner": {"reputation": 343, "user_id": 2360233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/09b9711c2e9212648bb21de3bd185778?s=128&d=identicon&r=PG&f=1", "display_name": "trebi", "link": "https://stackoverflow.com/users/2360233/trebi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "accepted_answer_id": 33933505, "answer_count": 1, "score": 0, "last_activity_date": 1448525685, "creation_date": 1448494568, "question_id": 33928287, "link": "https://stackoverflow.com/questions/33928287/c-entityframework-update-add-delete-arbitrarily-complex-entity-graph", "title": "C# EntityFramework: Update / Add / Delete arbitrarily complex entity graph", "body": "<p>I am trying to develop application using REACT.JS on frontend and C# EntityFramework based REST API on backend.</p>\n\n<p>Suppose I have entity relationships like this:</p>\n\n<pre><code>Form ONE-TO-MANY Element\nElement ONE-TO_MANY Attribute\n</code></pre>\n\n<p>What I am trying to do is a simple controller, that could simply add/update/delete such Form with all related entities.</p>\n\n<p>I have created an application in REACT with following structure:</p>\n\n<pre><code>&lt;SyncComponent&gt;\n    &lt;FormComponent&gt;\n        &lt;ElementsList&gt;\n            &lt;ElementComponent&gt;\n                &lt;AttributesList&gt;\n                    &lt;AttributeComponent&gt;\n</code></pre>\n\n<p><code>&lt;SyncComponent&gt;</code>, that is meant to perform AJAX request to resver, will obtain full JSON representation of the Form, that might look like this:</p>\n\n<ul>\n<li><p>New <code>Form</code> Created:</p>\n\n<pre><code>{\"name\":\"MyNewForm\", \"elements\":[{\"name\":\"MyNewElement\",\"attributes\":[{\"name\":\"MyNewAttribute\",\"value\":\"MyValue\"}]}]}\n</code></pre></li>\n<li><p>New <code>Element</code> added to existing <code>Form</code>:</p>\n\n<pre><code>{\"id\": 1, \"name\":\"MyExistingForm\", \"elements\":[{\"name\":\"MyNewElement\",\"attributes\":[{\"name\":\"MyNewAttribute\",\"value\":\"MyValue\"}]}]}\n</code></pre></li>\n<li><p>Updated attribute in existing <code>Element</code> and added new <code>Element</code> to <code>Form</code>: </p>\n\n<pre><code>{  \n    \"id\":123,\n    \"name\":\"MyExistingForm\",\n    \"elements\":[  \n        {  \n            \"id\":321\n            \"name\":\"MyExistingElement\",\n            \"attributes\":[  \n                {\n                    \"id\":456 \n                    \"name\":\"MyExisitngAttribute\",\n                    \"value\":\"MyUpdatedValue\"\n                },\n                {\n                    \"name\":\"MyNewAttribute\",\n                    \"value\":\"MyNewValue\"\n                }\n            ]\n        },\n        {  \n            \"name\":\"MyNewElement\",\n            \"attributes\":[  \n                {  \n                    \"name\":\"MyNewAttribute\",\n                    \"value\":\"MyNewValue\"\n                }\n            ]\n        }\n    ]\n}\n</code></pre></li>\n</ul>\n\n<p>... so basically an tree with arbitrary distibuted CREATE and UPDATE tasks (DELETE tasks will invoke, if elemnt is missing in JSON, but its present in database/object representation constructed form database). I know that I need to send whole big object only when a small change occured, but I find still much better than sending a separate request on each entity change. Firstly, I see my approach way simpler to implement on client side, secondly, I will end up with one request instead of dozen and finally, application is meant to allow user to make multiple changes Form and when done, hit \"Save\" button to update state. This way, I couldn't end up in inconsistent state, eg. when some of the AJAX for certain requests will fail, some not etc.</p>\n\n<p>To sync this JSON on server side, I have auto-generated MVC API Controller.</p>\n\n<p><strong>The problem I am stucked on is that EntityFramework could not properly parse given JSON to graph of objects to arbitrary depth.</strong> It works good to depth 1, but not deeper.</p>\n\n<p>Explanation by example: \nwhen invking <code>PutForm()</code> function (look at code below), <code>form</code> attribute oviously contains instance of <code>Form</code>, <code>form.elements</code> contains collection of passed <code>Element</code>'s, but <code>form.elements.toList[0].attributes</code> is always empty, even if in JSON there are some <code>attribute</code>s passed. </p>\n\n<pre><code>namespace MyApp.Controllers\n{\n    public class FormController : ApiController\n    {\n        private FormAsAServiceDbContext db = new FormAsAServiceDbContext();\n\n        // ...\n\n        // PUT: api/Form/5\n        [ResponseType(typeof(void))]\n        public async Task&lt;IHttpActionResult&gt; PutForm(int id, Form form)\n        {\n            if (!ModelState.IsValid)\n            {\n                return BadRequest(ModelState);\n            }\n\n            if (id != form.Id)\n            {\n                return BadRequest();\n            }\n\n            db.Entry(form).State = System.Data.Entity.EntityState.Modified;\n\n            try\n            {\n                await db.SaveChangesAsync();\n            }\n            catch (DbUpdateConcurrencyException)\n            {\n                if (!FormExists(id))\n                {\n                    return NotFound();\n                }\n                else\n                {\n                    throw;\n                }\n            }\n\n            return StatusCode(HttpStatusCode.NoContent);\n        }\n\n        // ...\n    }\n}\n</code></pre>\n\n<p>How do I enforce EntityFramework to construct full objects graph properly from JSON, co I could perform atomic update/creation/removal of this arbitrarily complex graph of entities?</p>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1448494721, "post_id": 33928268, "comment_id": 55617614, "body": "Use <code>PickImage[0].Groups[1].Value</code>"}, {"owner": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "edited": false, "score": 1, "creation_date": 1448494890, "post_id": 33928268, "comment_id": 55617663, "body": "I was going to change &quot;patter&quot; to &quot;pattern&quot; in the title, but there already is a post with that same title."}, {"owner": {"reputation": 46944, "user_id": 3764814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d02a4923abd2ca6d7593f031e4222c2?s=128&d=identicon&r=PG", "display_name": "Lucas Trzesniewski", "link": "https://stackoverflow.com/users/3764814/lucas-trzesniewski"}, "reply_to_user": {"reputation": 525, "user_id": 875317, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/tQ8Th.jpg?s=128&g=1", "display_name": "B. Clay Shannon", "link": "https://stackoverflow.com/users/875317/b-clay-shannon"}, "edited": false, "score": 2, "creation_date": 1448495021, "post_id": 33928268, "comment_id": 55617703, "body": "@B.ClayShannon then you could try to find a better title - I just did that."}], "answers": [{"tags": [], "owner": {"reputation": 46944, "user_id": 3764814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d02a4923abd2ca6d7593f031e4222c2?s=128&d=identicon&r=PG", "display_name": "Lucas Trzesniewski", "link": "https://stackoverflow.com/users/3764814/lucas-trzesniewski"}, "is_accepted": true, "score": 0, "last_activity_date": 1448494849, "creation_date": 1448494849, "answer_id": 33928332, "question_id": 33928268, "link": "https://stackoverflow.com/questions/33928268/how-to-get-the-value-of-a-regex-capture-group/33928332#33928332", "title": "How to get the value of a regex capture group?", "body": "<p>This is what you need:</p>\n\n<pre><code>string sString = @\"docs/horaires/1/images/1\";\nvar pickImage = Regex.Match(sString, @\"/horaires/(.*?)/images/\");\n\nif (pickImage.Success)\n    Console.WriteLine(pickImage.Groups[1].Value);\n</code></pre>\n\n<p>In your original code, <code>PickImage[0]</code> is a <code>Match</code> object, and <code>Value</code> will return the <em>full</em> match. You want the first captured group, so use <code>match.Groups[1].Value</code>. Note that <code>Groups[0]</code> always contains the full match.</p>\n\n<p>No need to use <code>Matches</code> is you want a single result, use <code>Match</code> instead.</p>\n"}], "owner": {"reputation": 87, "user_id": 4496821, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/35735db76adbd0194f86ebc67ef4cde8?s=128&d=identicon&r=PG&f=1", "display_name": "Maria", "link": "https://stackoverflow.com/users/4496821/maria"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1448533152, "accepted_answer_id": 33928332, "answer_count": 1, "score": -1, "last_activity_date": 1448494995, "creation_date": 1448494455, "last_edit_date": 1448494995, "question_id": 33928268, "link": "https://stackoverflow.com/questions/33928268/how-to-get-the-value-of-a-regex-capture-group", "closed_reason": "Duplicate", "title": "How to get the value of a regex capture group?", "body": "<p>First of all sorry about the tittle. Didn't know how to explain it.\nThis is my code:</p>\n\n<pre><code>string sString = @\"docs/horaires/1/images/1\"\nvar PickImage = Regex.Matches(sString, \"/horaires/(.*?)/images/\");\nConsole.WriteLine(PickImage[0].Value);\n</code></pre>\n\n<p>This will print <code>/horaires/1/images/</code> instead of <code>1</code>. I tried all the <code>RegexOptions</code> but didn't find the solution in there.\nWhat am I doing wrong here?</p>\n"}, {"tags": ["c#", "list"], "comments": [{"owner": {"reputation": 14571, "user_id": 1669996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/89e5a1861e6429b8f5d3cc45900b98ae?s=128&d=identicon&r=PG", "display_name": "casillas", "link": "https://stackoverflow.com/users/1669996/casillas"}, "reply_to_user": {"reputation": 898, "user_id": 4640779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd496e6287388d475c0c5e78ed68fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Matyas", "link": "https://stackoverflow.com/users/4640779/matyas"}, "edited": false, "score": 0, "creation_date": 1448493885, "post_id": 33928138, "comment_id": 55617330, "body": "How could I cope with an algorithm to solve this chain list items?"}, {"owner": {"reputation": 7329, "user_id": 1506710, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/zxQSI.jpg?s=128&g=1", "display_name": "Dhanuka777", "link": "https://stackoverflow.com/users/1506710/dhanuka777"}, "edited": false, "score": 0, "creation_date": 1448494118, "post_id": 33928138, "comment_id": 55617401, "body": "Can&#39;t you use variables rather that strings and add them to the table. You only need two variables as start1 and end1. Where second item in the collection has a start value as End 1 (I would go with End1 + 1). Likewise if you change End2 (6000 in the example), it will affect to change row 3 start value which would be End2+1. Is this what you need?"}, {"owner": {"reputation": 898, "user_id": 4640779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd496e6287388d475c0c5e78ed68fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Matyas", "link": "https://stackoverflow.com/users/4640779/matyas"}, "edited": false, "score": 0, "creation_date": 1448494159, "post_id": 33928138, "comment_id": 55617420, "body": "Why don&#39;t you store just the &quot;bounds&quot;? If you&#39;d store just 1000, 4000, 6000, 8000 (for example in <code>List&lt;int&gt;</code>), there would be no need to adjust the neighbours."}, {"owner": {"reputation": 14571, "user_id": 1669996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/89e5a1861e6429b8f5d3cc45900b98ae?s=128&d=identicon&r=PG", "display_name": "casillas", "link": "https://stackoverflow.com/users/1669996/casillas"}, "edited": false, "score": 0, "creation_date": 1448494175, "post_id": 33928138, "comment_id": 55617431, "body": "Could you please illustrate your comment as an answer to see clear picture?"}, {"owner": {"reputation": 14571, "user_id": 1669996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/89e5a1861e6429b8f5d3cc45900b98ae?s=128&d=identicon&r=PG", "display_name": "casillas", "link": "https://stackoverflow.com/users/1669996/casillas"}, "edited": false, "score": 0, "creation_date": 1448494233, "post_id": 33928138, "comment_id": 55617450, "body": "How could you store the bounds?"}, {"owner": {"reputation": 898, "user_id": 4640779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd496e6287388d475c0c5e78ed68fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Matyas", "link": "https://stackoverflow.com/users/4640779/matyas"}, "edited": false, "score": 1, "creation_date": 1448494590, "post_id": 33928138, "comment_id": 55617583, "body": "@texas in the same way as you store the <code>TableItem</code>s. The <code>End</code> seems redundant to me, if it is the same as the <code>Start</code> of the next item."}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "edited": false, "score": 0, "creation_date": 1448494667, "post_id": 33928138, "comment_id": 55617597, "body": "<code>End</code> is relevant if there is only one item in the collection."}, {"owner": {"reputation": 14571, "user_id": 1669996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/89e5a1861e6429b8f5d3cc45900b98ae?s=128&d=identicon&r=PG", "display_name": "casillas", "link": "https://stackoverflow.com/users/1669996/casillas"}, "edited": false, "score": 0, "creation_date": 1448494677, "post_id": 33928138, "comment_id": 55617601, "body": "If you do not mind, you please provide as answer."}, {"owner": {"reputation": 898, "user_id": 4640779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd496e6287388d475c0c5e78ed68fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Matyas", "link": "https://stackoverflow.com/users/4640779/matyas"}, "reply_to_user": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "edited": false, "score": 1, "creation_date": 1448494874, "post_id": 33928138, "comment_id": 55617658, "body": "@MutantNinjaCodeMonkey not really. You could have 2 items (1000, 4000) in the collection. One for start, one for the end, so you have one &quot;interval&quot; (1000 to 4000) if you add another item (e.g. 6000), you will have 3 bounds, thus 2 intervals: (1000 to 4000 and 4000 to 6000)"}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 898, "user_id": 4640779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cd496e6287388d475c0c5e78ed68fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Matyas", "link": "https://stackoverflow.com/users/4640779/matyas"}, "edited": false, "score": 0, "creation_date": 1448495052, "post_id": 33928138, "comment_id": 55617713, "body": "@Matyas  Yeah that would work. Collection would always have to have a capping value like that.  Honestly, there are a few other areas where this particular question is going to break that your solution also solves (such as  inserting a nonsequential element in the middle.. just need to sort) +1 to you!"}], "answers": [{"tags": [], "owner": {"reputation": 39443, "user_id": 129164, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec326c009186734854c600265b69a6ce?s=128&d=identicon&r=PG", "display_name": "devuxer", "link": "https://stackoverflow.com/users/129164/devuxer"}, "is_accepted": true, "score": 1, "last_activity_date": 1448495400, "last_edit_date": 1448495400, "creation_date": 1448494887, "answer_id": 33928339, "question_id": 33928138, "link": "https://stackoverflow.com/questions/33928138/user-interaction-with-chain-list-items/33928339#33928339", "title": "User Interaction with chain List Items", "body": "<pre><code>void Main()\n{\n    var rangeManager = new RangeManager();\n    rangeManager.SetRange(3, 6000, 9000);\n    rangeManager.GetRange(3).Dump();\n    rangeManager.SetRange(1, 500, 4000);\n    rangeManager.GetRange(1).Dump();\n}\n\npublic class RangeManager\n{\n    private List&lt;int&gt; _values;\n\n    public RangeManager()\n    {\n        _values = new List&lt;int&gt; { 0, 1000, 4000, 6000, 8000 };\n    }\n\n    public Range GetRange(int index)\n    {\n        // TODO check for index out of range\n        return new Range(_values[index], _values[index + 1]);\n    }\n\n    public void SetRange(int index, int start, int finish)\n    {\n        // TODO check for index out of range\n        // TODO make sure start less than finish\n        // TODO make sure start greater than previous value\n        // TODO make sure finish less than next + 1 value\n        _values[index] = start;\n        _values[index + 1] = finish;\n    }\n}\n\npublic class Range\n{\n    public int Start { get; private set; }\n    public int Finish { get; private set; }\n\n    public Range(int start, int finish)\n    {\n        Start = start;\n        Finish = finish;\n    }\n}\n</code></pre>\n\n<p>To understand what's going on here, start with the <code>Range</code> class. It is simply a holder for <code>Start</code> and <code>Finish</code>.</p>\n\n<p>Next, look at the <code>RangeManager</code> class. It encapsulates the management of your chained ranges. It holds the values (range endpoints) in a list on integers (rather than a list of <code>Range</code> objects). This is a better way to store the data, because you no longer need to update neighboring objects when updating a range. Also, note that it's better to use integers than strings. The <code>RangeManager</code> class also has methods to help you manipulate and output your ranges.</p>\n\n<p>Finally, look at the <code>Main</code> method. This shows an example of how to use the <code>RangeManager</code> and allows you to test whether it is working properly.</p>\n"}], "owner": {"reputation": 14571, "user_id": 1669996, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/89e5a1861e6429b8f5d3cc45900b98ae?s=128&d=identicon&r=PG", "display_name": "casillas", "link": "https://stackoverflow.com/users/1669996/casillas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 33928339, "answer_count": 1, "score": -2, "last_activity_date": 1448495400, "creation_date": 1448493701, "last_edit_date": 1448494477, "question_id": 33928138, "link": "https://stackoverflow.com/questions/33928138/user-interaction-with-chain-list-items", "title": "User Interaction with chain List Items", "body": "<p>I have the following List items and try to find out an algorithm which takes care of user interaction. </p>\n\n<pre><code>tableItems.Add (new TableItem() {Start=1000, End=4000});\ntableItems.Add (new TableItem() {Start=4000, End=6000});\ntableItems.Add (new TableItem() {Start=6000, End=8000});\n</code></pre>\n\n<p>For example in the list, if user changes the first item \"End\" value that affects also second list item's \"Start\" value. That has to match.  It is like a chain. Also, if user wants to change second item \"Start\" value, then the first item \"End\" value has to match as well. </p>\n\n<p>What is effective way of solving this chain problem?</p>\n"}, {"tags": ["c#", ".net", "multithreading", "asynchronous", "async-await"], "comments": [{"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1448495669, "post_id": 33928122, "comment_id": 55617889, "body": "You don&#39;t appear to create a new <code>client</code> for each call. You know that <code>System.Net.Http.HttpClient</code> is not thread-safe for instance calls? A new instance should be created for (and disposed after) each call."}, {"owner": {"reputation": 76348, "user_id": 392044, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4df33f9e8a81cc9d8046f057dbb4debc?s=128&d=identicon&r=PG", "display_name": "Mike Christensen", "link": "https://stackoverflow.com/users/392044/mike-christensen"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1448496149, "post_id": 33928122, "comment_id": 55618018, "body": "The <code>QueryAvailability</code> method is actually in a class that creates the <code>HttpClient</code>, which is a private member of that instance.  I didn&#39;t know it was not thread-safe though, I could definitely create it before each call.  I&#39;ll look into that more, thanks!"}, {"owner": {"reputation": 76348, "user_id": 392044, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4df33f9e8a81cc9d8046f057dbb4debc?s=128&d=identicon&r=PG", "display_name": "Mike Christensen", "link": "https://stackoverflow.com/users/392044/mike-christensen"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 1, "creation_date": 1448496456, "post_id": 33928122, "comment_id": 55618095, "body": "Hmm, I did a bit of research and it seems what I&#39;m doing is thread safe.  See <a href=\"http://stackoverflow.com/questions/11178220/is-httpclient-safe-to-use-concurrently\">here</a> and <a href=\"http://www.tomdupont.net/2014/11/net-45-httpclient-is-thread-safe.html\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 76348, "user_id": 392044, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4df33f9e8a81cc9d8046f057dbb4debc?s=128&d=identicon&r=PG", "display_name": "Mike Christensen", "link": "https://stackoverflow.com/users/392044/mike-christensen"}, "edited": false, "score": 0, "creation_date": 1448494125, "post_id": 33928158, "comment_id": 55617406, "body": "This looks promising too, and looks like it works well with <code>async</code> methods (eg, I can <code>await</code> on block completion)..  I&#39;m gonna give this a shot."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 76348, "user_id": 392044, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4df33f9e8a81cc9d8046f057dbb4debc?s=128&d=identicon&r=PG", "display_name": "Mike Christensen", "link": "https://stackoverflow.com/users/392044/mike-christensen"}, "edited": false, "score": 0, "creation_date": 1448494193, "post_id": 33928158, "comment_id": 55617438, "body": "@MikeChristensen it is. It&#39;s one of the few libraries in .Net that were specifically written with async-await in mind."}, {"owner": {"reputation": 76348, "user_id": 392044, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4df33f9e8a81cc9d8046f057dbb4debc?s=128&d=identicon&r=PG", "display_name": "Mike Christensen", "link": "https://stackoverflow.com/users/392044/mike-christensen"}, "edited": false, "score": 2, "creation_date": 1448495510, "post_id": 33928158, "comment_id": 55617833, "body": "Works flawlessly!  I&#39;m now a fan.  Accepting."}], "tags": [], "owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "is_accepted": true, "score": 22, "last_activity_date": 1598044881, "last_edit_date": 1598044881, "creation_date": 1448493819, "answer_id": 33928158, "question_id": 33928122, "link": "https://stackoverflow.com/questions/33928122/how-to-correctly-queue-up-tasks-to-run-in-c/33928158#33928158", "title": "How to correctly queue up tasks to run in C#", "body": "<p>As I always recommend.. what you need is TPL Dataflow (to install: <code>Install-Package System.Threading.Tasks.Dataflow</code>).</p>\n<p>You create an <code>ActionBlock</code> with an action to perform on each item. Set <code>MaxDegreeOfParallelism</code> for throttling. Start posting into it and await its completion:</p>\n<pre><code>var block = new ActionBlock&lt;QueryAvailabilityMultidayRequest&gt;(async service =&gt; \n{\n    var availabilityResponse = await client.QueryAvailability(service);\n    // ...\n},\nnew ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 4 });\n\nforeach (var service in RunData.Demand)\n{\n    block.Post(service);\n}\n\nblock.Complete();\nawait block.Completion;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13828, "user_id": 4588915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CTCr8.png?s=128&g=1", "display_name": "Jakub Lortz", "link": "https://stackoverflow.com/users/4588915/jakub-lortz"}, "is_accepted": false, "score": 3, "last_activity_date": 1448499044, "creation_date": 1448499044, "answer_id": 33928931, "question_id": 33928122, "link": "https://stackoverflow.com/questions/33928122/how-to-correctly-queue-up-tasks-to-run-in-c/33928931#33928931", "title": "How to correctly queue up tasks to run in C#", "body": "<p>You're using async HTTP calls, so limiting the number of threads will not help (nor will <code>ParallelOptions.MaxDegreeOfParallelism</code> in <code>Parallel.ForEach</code> as one of the answers suggests). Even a single thread can initiate all requests and process the results as they arrive.</p>\n\n<p>One way to solve it is to use TPL Dataflow.</p>\n\n<p>Another nice solution is to divide the source <code>IEnumerable</code> into partitions and process items in each partition sequentially as described in <a href=\"http://blogs.msdn.com/b/pfxteam/archive/2012/03/05/10278165.aspx\" rel=\"nofollow\">this blog post</a>:</p>\n\n<pre><code>public static Task ForEachAsync&lt;T&gt;(this IEnumerable&lt;T&gt; source, int dop, Func&lt;T, Task&gt; body)\n{\n    return Task.WhenAll(\n        from partition in Partitioner.Create(source).GetPartitions(dop)\n        select Task.Run(async delegate\n        {\n            using (partition)\n                while (partition.MoveNext())\n                    await body(partition.Current);\n        }));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 644, "user_id": 5698997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AjI24.png?s=128&g=1", "display_name": "Snak", "link": "https://stackoverflow.com/users/5698997/snak"}, "edited": false, "score": 1, "creation_date": 1568381682, "post_id": 33947553, "comment_id": 102266802, "body": "Creating unnecessary lists on every iteration of the foreach loop. A ManualResetEvent or a SempahoreSlim for throttling would involve much less allocations and better performance than counting the non completed task on every iteration."}, {"owner": {"reputation": 6697, "user_id": 452519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ax838.jpg?s=128&g=1", "display_name": "Andrew Hanlon", "link": "https://stackoverflow.com/users/452519/andrew-hanlon"}, "reply_to_user": {"reputation": 644, "user_id": 5698997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AjI24.png?s=128&g=1", "display_name": "Snak", "link": "https://stackoverflow.com/users/5698997/snak"}, "edited": false, "score": 1, "creation_date": 1568384132, "post_id": 33947553, "comment_id": 102268137, "body": "Thanks @Snak - you are absolutely correct, and actually today I use a much different helper method without any specific task tracking. But reader be warned, a naive approach using a simple <code>SemaphoreSlim</code> is prone to deadlocks - it takes a lot of care to ensure that task exceptions propagate correctly for an early exit!"}], "tags": [], "owner": {"reputation": 6697, "user_id": 452519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ax838.jpg?s=128&g=1", "display_name": "Andrew Hanlon", "link": "https://stackoverflow.com/users/452519/andrew-hanlon"}, "is_accepted": false, "score": 2, "last_activity_date": 1448629927, "last_edit_date": 1448629927, "creation_date": 1448574990, "answer_id": 33947553, "question_id": 33928122, "link": "https://stackoverflow.com/questions/33928122/how-to-correctly-queue-up-tasks-to-run-in-c/33947553#33947553", "title": "How to correctly queue up tasks to run in C#", "body": "<p>While the Dataflow library is great, I think it's a bit heavy when not using block composition. I would tend to use something like the extension method below. </p>\n\n<p>Also, unlike the Partitioner method, this runs the async methods on the calling context - the caveat being that if your code is not truly async, or takes a 'fast path', then it will effectively run synchronously since no threads are explicitly created.  </p>\n\n<pre><code>public static async Task RunParallelAsync&lt;T&gt;(this IEnumerable&lt;T&gt; items, Func&lt;T, Task&gt; asyncAction, int maxParallel)\n{\n    var tasks = new List&lt;Task&gt;();\n\n    foreach (var item in items)\n    {\n        tasks.Add(asyncAction(item));\n\n        if (tasks.Count &lt; maxParallel)\n                continue; \n\n        var notCompleted = tasks.Where(t =&gt; !t.IsCompleted).ToList();\n\n        if (notCompleted.Count &gt;= maxParallel)\n            await Task.WhenAny(notCompleted);\n    }\n\n    await Task.WhenAll(tasks);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5694, "user_id": 199364, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/75807746d41c9905452d252595f7b89d?s=128&d=identicon&r=PG", "display_name": "ToolmakerSteve", "link": "https://stackoverflow.com/users/199364/toolmakersteve"}, "edited": false, "score": 1, "creation_date": 1520189668, "post_id": 47275758, "comment_id": 85203509, "body": "If I understand correctly, depending on how one is using this, might work fine with <code>sem.Wait()</code> rather than <code>await sem.WaitASync()</code>. Doing so would block the calling thread, so shouldn&#39;t be done on the UI thread, but on any other thread, it might be the easiest way to manage the work to be done. Specifically, if one of the 4 sems is available, it will proceed immediately. If not, it waits until one is available."}], "tags": [], "owner": {"reputation": 563, "user_id": 1721571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e880cf263879585eb37a57638589973?s=128&d=identicon&r=PG", "display_name": "SeanOB", "link": "https://stackoverflow.com/users/1721571/seanob"}, "is_accepted": false, "score": 6, "last_activity_date": 1520726371, "last_edit_date": 1520726371, "creation_date": 1510619231, "answer_id": 47275758, "question_id": 33928122, "link": "https://stackoverflow.com/questions/33928122/how-to-correctly-queue-up-tasks-to-run-in-c/47275758#47275758", "title": "How to correctly queue up tasks to run in C#", "body": "<p>Old question, but I would like to propose an alternative lightweight solution using the <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/threading/semaphore-and-semaphoreslim\" rel=\"nofollow noreferrer\">SemaphoreSlim</a> class. Just reference System.Threading.</p>\n\n<pre><code>SemaphoreSlim sem = new SemaphoreSlim(4,4);\n\nforeach (var service in RunData.Demand)\n{\n\n    await sem.WaitAsync();\n    Task t = Task.Run(async () =&gt; \n    {\n        var availabilityResponse = await client.QueryAvailability(serviceCopy));    \n        // do your other stuff here with the result of QueryAvailability\n    }\n    t.ContinueWith(sem.Release());\n}\n</code></pre>\n\n<p>The semaphore acts as a locking mechanism. You can only enter the semaphore by calling Wait (WaitAsync) which subtracts one from the count. Calling release adds one to the count. </p>\n"}], "owner": {"reputation": 76348, "user_id": 392044, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4df33f9e8a81cc9d8046f057dbb4debc?s=128&d=identicon&r=PG", "display_name": "Mike Christensen", "link": "https://stackoverflow.com/users/392044/mike-christensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13871, "favorite_count": 6, "accepted_answer_id": 33928158, "answer_count": 4, "score": 22, "last_activity_date": 1598044881, "creation_date": 1448493573, "question_id": 33928122, "link": "https://stackoverflow.com/questions/33928122/how-to-correctly-queue-up-tasks-to-run-in-c", "title": "How to correctly queue up tasks to run in C#", "body": "<p>I have an enumeration of items (<code>RunData.Demand</code>), each representing some work involving calling an API over HTTP.  It works great if I just <code>foreach</code> through it all and call the API during each iteration.  However, each iteration takes a second or two so I'd like to run 2-3 threads and divide up the work between them.  Here's what I'm doing:</p>\n\n<pre><code>ThreadPool.SetMaxThreads(2, 5); // Trying to limit the amount of threads\nvar tasks = RunData.Demand\n   .Select(service =&gt; Task.Run(async delegate\n   {\n      var availabilityResponse = await client.QueryAvailability(service);\n      // Do some other stuff, not really important\n   }));\n\nawait Task.WhenAll(tasks);\n</code></pre>\n\n<p>The <code>client.QueryAvailability</code> call basically calls an API using the <code>HttpClient</code> class:</p>\n\n<pre><code>public async Task&lt;QueryAvailabilityResponse&gt; QueryAvailability(QueryAvailabilityMultidayRequest request)\n{\n   var response = await client.PostAsJsonAsync(\"api/queryavailabilitymultiday\", request);\n\n   if (response.IsSuccessStatusCode)\n   {\n      return await response.Content.ReadAsAsync&lt;QueryAvailabilityResponse&gt;();\n   }\n\n   throw new HttpException((int) response.StatusCode, response.ReasonPhrase);\n}\n</code></pre>\n\n<p>This works great for a while, but eventually things start timing out.  If I set the HttpClient Timeout to an hour, then I start getting weird internal server errors.</p>\n\n<p>What I started doing was setting a Stopwatch within the <code>QueryAvailability</code> method to see what was going on.</p>\n\n<p>What's happening is all 1200 items in RunData.Demand are being created at once and all 1200 <code>await client.PostAsJsonAsync</code> methods are being called.  It appears it then uses the 2 threads to slowly check back on the tasks, so towards the end I have tasks that have been waiting for 9 or 10 minutes.</p>\n\n<p>Here's the behavior I would like:</p>\n\n<p>I'd like to create the 1,200 tasks, then run them 3-4 at a time as threads become available.  I do <em>not</em> want to queue up 1,200 HTTP calls immediately.</p>\n\n<p>Is there a good way to go about doing this?</p>\n"}, {"tags": ["c#", "modulus", "overflowexception"], "comments": [{"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1448494195, "post_id": 33928048, "comment_id": 55617439, "body": "Note that in Java, the result is <code>0</code> by specifications and in C the operation invokes undefined behavior."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1448494157, "post_id": 33928126, "comment_id": 55617419, "body": "Mathematically <code>int.MinValue % -1</code> would be 0, or -1 (or possible 1).  This does not exceed the valid range for a 16-bit signed integer."}, {"owner": {"reputation": 4445, "user_id": 560903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66cec4f7bd065097137c2001c96b866?s=128&d=identicon&r=PG", "display_name": "keithmo", "link": "https://stackoverflow.com/users/560903/keithmo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1448494271, "post_id": 33928126, "comment_id": 55617468, "body": "But it&#39;s typically computed by first dividing then finding the remainder."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448494785, "post_id": 33928126, "comment_id": 55617634, "body": "Agree, but does the language specification require that order?"}, {"owner": {"reputation": 4445, "user_id": 560903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66cec4f7bd065097137c2001c96b866?s=128&d=identicon&r=PG", "display_name": "keithmo", "link": "https://stackoverflow.com/users/560903/keithmo"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448494901, "post_id": 33928126, "comment_id": 55617667, "body": "That I don&#39;t know. I&#39;m a little surprised that C# doesn&#39;t handle it properly."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448495020, "post_id": 33928126, "comment_id": 55617702, "body": "I suspect C# inherited C&#39;s specification: If <code>a&#47;b</code> is not representable, then <code>a%b</code> is also undefined even if <code>a%b</code> is representable."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448495308, "post_id": 33928126, "comment_id": 55617781, "body": "@chux I suspect they specified like this for performances reasons because on x86 and x64 the remainder can be obtained from the integer division processor instruction that computes in the same time the division and the remainder."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1448495309, "post_id": 33928126, "comment_id": 55617782, "body": "It makes sense to define the tautology <code>a == a&#47;b + a%b</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1448495644, "post_id": 33928126, "comment_id": 55617883, "body": "<a href=\"http://stackoverflow.com/questions/31775042/why-does-the-c-sharp-specification-leave-int-minvalue-1-implementation-defi?lq=1\" title=\"why does the c sharp specification leave int minvalue 1 implementation defi\">stackoverflow.com/questions/31775042/&hellip;</a> goes into details"}, {"owner": {"reputation": 573, "user_id": 484074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b06679721476b15b47f16b4ba76df8?s=128&d=identicon&r=PG", "display_name": "Dirk Strauss", "link": "https://stackoverflow.com/users/484074/dirk-strauss"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448528482, "post_id": 33928126, "comment_id": 55628588, "body": "@chux thank you for the answers. I was looking at this from a mathematical point of view and couldn&#39;t understand why C# treated it differently. Thank you for the link."}, {"owner": {"reputation": 573, "user_id": 484074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b06679721476b15b47f16b4ba76df8?s=128&d=identicon&r=PG", "display_name": "Dirk Strauss", "link": "https://stackoverflow.com/users/484074/dirk-strauss"}, "edited": false, "score": 0, "creation_date": 1448528500, "post_id": 33928126, "comment_id": 55628600, "body": "@keithmo your answer above rocks, thanks mate!"}, {"owner": {"reputation": 19714, "user_id": 340819, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b3de81e79b2ad88d9a0d8d0a011a7f00?s=128&d=identicon&r=PG", "display_name": "Hammerite", "link": "https://stackoverflow.com/users/340819/hammerite"}, "edited": false, "score": 0, "creation_date": 1467367086, "post_id": 33928126, "comment_id": 63714597, "body": "This is at best an incomplete answer. It discusses only why integer division might not work, while ignoring how and why that might impact the remainder operation. The question asked relates specifically to the remainder operation."}], "tags": [], "owner": {"reputation": 4445, "user_id": 560903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66cec4f7bd065097137c2001c96b866?s=128&d=identicon&r=PG", "display_name": "keithmo", "link": "https://stackoverflow.com/users/560903/keithmo"}, "is_accepted": true, "score": 6, "last_activity_date": 1448493604, "creation_date": 1448493604, "answer_id": 33928126, "question_id": 33928048, "link": "https://stackoverflow.com/questions/33928048/why-does-int-minvalue-1-cause-and-overflowexception/33928126#33928126", "title": "Why does int.MinValue % -1 cause and OverflowException", "body": "<p>In two's complement arithmetic, data types have a range from (-2**n) to (2**n - 1) (where 'n' is 1 less than the number of bits in the data type).</p>\n\n<p>For example, a 16-bit signed integer has a valid range from -32768 (-2**15) to 32767 (2**15 - 1).</p>\n\n<p>-32768 / -1 = +32768 which exceeds the valid range for a 16-bit signed integer.</p>\n"}], "owner": {"reputation": 573, "user_id": 484074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b06679721476b15b47f16b4ba76df8?s=128&d=identicon&r=PG", "display_name": "Dirk Strauss", "link": "https://stackoverflow.com/users/484074/dirk-strauss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "closed_date": 1448528549, "accepted_answer_id": 33928126, "answer_count": 1, "score": 5, "last_activity_date": 1448495075, "creation_date": 1448493144, "last_edit_date": 1448493696, "question_id": 33928048, "link": "https://stackoverflow.com/questions/33928048/why-does-int-minvalue-1-cause-and-overflowexception", "closed_reason": "Duplicate", "title": "Why does int.MinValue % -1 cause and OverflowException", "body": "<p>In 7.8.3. of the C# Specification regarding the Remainder operator it states the following:</p>\n\n<blockquote>\n  <p>If the left operand is the smallest int or long value and the right\n  operand is -1, a System.OverflowException is thrown.</p>\n</blockquote>\n\n<p>Therefore <code>int.MinValue % -1</code> would result in an OverflowException. I am trying to understand why?</p>\n"}, {"tags": ["c#", "asp.net-mvc", "stream", ".net-4.5"], "comments": [{"owner": {"reputation": 6266, "user_id": 5497207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e185da0f69447ef588089e15e15198?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz Ozgul", "link": "https://stackoverflow.com/users/5497207/oguz-ozgul"}, "edited": false, "score": 0, "creation_date": 1448495357, "post_id": 33928035, "comment_id": 55617794, "body": "you probably don&#39;t want to do this in the RequestEnd event. Are you sure no one calls Request.Form or Request.Files etc during the processing of this request? Because in either case, all the content will already be read when EndRequest is fired. Reading the input stream by small buffers was already available in earlier versions of .net. It just depends on during which phase of execution you are accessing the stream."}, {"owner": {"reputation": 3379, "user_id": 734742, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c9e13d3116ccc004df1053850295ecaa?s=128&d=identicon&r=PG", "display_name": "jsgoupil", "link": "https://stackoverflow.com/users/734742/jsgoupil"}, "reply_to_user": {"reputation": 6266, "user_id": 5497207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e185da0f69447ef588089e15e15198?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz Ozgul", "link": "https://stackoverflow.com/users/5497207/oguz-ozgul"}, "edited": false, "score": 0, "creation_date": 1448498478, "post_id": 33928035, "comment_id": 55618578, "body": "@OguzOzgul Thanks for the feedback. Now that .NET 4.5 will use the buffered stream, do you have an idea of how and when would you read the request stream?"}, {"owner": {"reputation": 6266, "user_id": 5497207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e185da0f69447ef588089e15e15198?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz Ozgul", "link": "https://stackoverflow.com/users/5497207/oguz-ozgul"}, "edited": false, "score": 0, "creation_date": 1448517211, "post_id": 33928035, "comment_id": 55623380, "body": "Yes. You can read the stream with GetBufferedInputStream in PreRequestHandlerExecute event handler. This event handler is invoked just before ASP.NET starts executing an event handler (a page, a custom handler, a web service etc..) and we can expect the request to be not read fully at this point If no other http module have read it already. Using this particular event handler ensures that the request is authenticated, the session is available, and the actual handler is known (Which are probably needed for logging)"}], "owner": {"reputation": 3379, "user_id": 734742, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c9e13d3116ccc004df1053850295ecaa?s=128&d=identicon&r=PG", "display_name": "jsgoupil", "link": "https://stackoverflow.com/users/734742/jsgoupil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 709, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1448498663, "creation_date": 1448493029, "last_edit_date": 1448498663, "question_id": 33928035, "link": "https://stackoverflow.com/questions/33928035/request-getbufferedinputstream-is-not-seek-enabled", "title": "request.GetBufferedInputStream is not seek enabled", "body": "<p>Before .NET 4.5, I was using request.InputStream to read the data and save it to a database. However, now instead of using the \"Classic\" input stream reading mechanism, it uses the Buffered Input Stream.</p>\n\n<p>In a module, when I try to read the stream, I have to check for the mode. But I can't read the BufferedInputStream because it's already read and it's not seekable.</p>\n\n<p>Basically I have this in a module</p>\n\n<pre><code>public void Init(HttpApplication context)\n{\n    context.EndRequest += EndRequest;\n}\n\nprivate void EndRequest(object sender, EventArgs e)\n{\n    var application = (HttpApplication)sender;\n    var request = application.Request;\n\n    Stream requestInputStream = null;\n    if (application.Request.ReadEntityBodyMode == ReadEntityBodyMode.Buffered)\n    {\n        // This is not readable...\n        requestInputStream = request.GetBufferedInputStream();\n    }\n    else\n    {\n        requestInputStream = request.InputStream;\n    }\n}\n</code></pre>\n\n<p>My only trick I have found now, is to access the request.InputStream in a <code>BeginRequest</code> then save the stream at that point. However, my stream will stay in classic mode forever; I believe this is defeating the purpose of this .NET 4.5 buffered input stream.</p>\n\n<p>Is there a better way to read this BufferedInputStream now?</p>\n\n<p>(Full Code Open Source: <a href=\"https://github.com/jsgoupil/request-logger-module/blob/a3f989e329275f222f54b04d319dcbb36944e948/src/RequestLoggerModule/RequestLoggerModule.cs\" rel=\"nofollow\">RequestLoggerModule.cs</a>)</p>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 25448, "user_id": 563532, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2773fec98b1630ec087b575482dc08a?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/563532/rob"}, "edited": false, "score": 4, "creation_date": 1448492850, "post_id": 33927978, "comment_id": 55616972, "body": "Please elaborate about &#39;not working properly&#39;. What do you expect it to do, and what is it doing?"}, {"owner": {"reputation": 5868, "user_id": 21418, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fddc11973b05ae9b9d69503bedf3da19?s=128&d=identicon&r=PG", "display_name": "Preston Guillot", "link": "https://stackoverflow.com/users/21418/preston-guillot"}, "edited": false, "score": 0, "creation_date": 1448492876, "post_id": 33927978, "comment_id": 55616986, "body": "What do you expect this to be doing that it&#39;s not?"}, {"owner": {"reputation": 3026, "user_id": 2228526, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ea52ba604d39a8304f23d7943b945b7c?s=128&d=identicon&r=PG", "display_name": "JD Davis", "link": "https://stackoverflow.com/users/2228526/jd-davis"}, "edited": false, "score": 2, "creation_date": 1448492923, "post_id": 33927978, "comment_id": 55617015, "body": "Trim will only remove trailing or leading whitespace. If you want to remove all whitespace, use replace."}, {"owner": {"reputation": 2082, "user_id": 5442132, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/U09W8.jpg?s=128&g=1", "display_name": "myselfmiqdad", "link": "https://stackoverflow.com/users/5442132/myselfmiqdad"}, "edited": false, "score": 0, "creation_date": 1448493001, "post_id": 33927978, "comment_id": 55617039, "body": "This might help <a href=\"http://stackoverflow.com/questions/6219454/efficient-way-to-remove-all-whitespace-from-string\" title=\"efficient way to remove all whitespace from string\">stackoverflow.com/questions/6219454/&hellip;</a>"}, {"owner": {"reputation": 209, "user_id": 4561311, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/310aa674dda7975acbc30ffb6ab36ab4?s=128&d=identicon&r=PG&f=1", "display_name": "xyzcode", "link": "https://stackoverflow.com/users/4561311/xyzcode"}, "edited": false, "score": 0, "creation_date": 1448493892, "post_id": 33927978, "comment_id": 55617332, "body": "It doesn&#39;t affect the input at all. So if the user enters &quot;   xyz@test.com    &quot; (with whitespace before and after), it will still leave all of the extra whitespaces"}, {"owner": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 1, "creation_date": 1448494055, "post_id": 33927978, "comment_id": 55617376, "body": "Trim doesn&#39;t mutate the string. It returns a new string that has been trimmed. You&#39;ve only passed the trimmed string into <code>EmailAvailForReg</code>. <code>UpdateEmail</code> is not going to have the trimmed string because the <code>EmailAddress</code> property on <code>viewModel</code> wasn&#39;t changed."}], "answers": [{"tags": [], "owner": {"reputation": 9793, "user_id": 2391169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b9c6b03a46672d5698ec565319c072?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2391169/david"}, "is_accepted": true, "score": 6, "last_activity_date": 1607956814, "last_edit_date": 1607956814, "creation_date": 1448494221, "answer_id": 33928231, "question_id": 33927978, "link": "https://stackoverflow.com/questions/33927978/trim-not-working-properly/33928231#33928231", "title": "Trim() not working properly?", "body": "<p>Keep in mind that <a href=\"https://msdn.microsoft.com/en-us/library/system.string(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>string</code></a> is read only - you cannot change the value by calling anything on it, and instead these methods return new values with the desired changes, including <code>.Trim</code>; if you wish to change <code>viewModel.EmailAddress</code> you should assign the result of <code>Trim()</code> to that same variable:</p>\n<p>EDIT: At some point, I would like to see a <code>.=</code> operator, since this kind of &quot;mutate and save&quot; comes up surprisingly often</p>\n<pre><code>viewModel.EmailAddress = viewModel.EmailAddress.Trim()\n</code></pre>\n"}], "owner": {"reputation": 209, "user_id": 4561311, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/310aa674dda7975acbc30ffb6ab36ab4?s=128&d=identicon&r=PG&f=1", "display_name": "xyzcode", "link": "https://stackoverflow.com/users/4561311/xyzcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1715, "favorite_count": 0, "accepted_answer_id": 33928231, "answer_count": 1, "score": 2, "last_activity_date": 1607956814, "creation_date": 1448492739, "last_edit_date": 1467237901, "question_id": 33927978, "link": "https://stackoverflow.com/questions/33927978/trim-not-working-properly", "title": "Trim() not working properly?", "body": "<p>I'm building out a function to allow users to change their email address and if they accidentally put in a whitespace before or after, I need to trim it so the regex doesn't complain. It doesn't seem to work in the place I have it (the string remains exactly the same) but I'm not sure why.\nThis is in my controller: </p>\n\n<pre><code>public ActionResult ChangeEmail(ChangeEmailVM vm)\n        {\n            try\n            {\n                if (UserManager.EmailAvail(new EmailRequest\n                {\n                    Email = vm.EmailAddress.Trim()\n                }))\n                else//...etc etc\n</code></pre>\n\n<p>I was thinking I'd possibly need to put .trim() in the getter or setter of the email address but I'm not sure of the proper syntax.</p>\n"}, {"tags": ["c#", "uwp"], "comments": [{"owner": {"reputation": 4488, "user_id": 5254458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOw1L.jpg?s=128&g=1", "display_name": "Franklin Chen - MSFT", "link": "https://stackoverflow.com/users/5254458/franklin-chen-msft"}, "edited": false, "score": 0, "creation_date": 1448501612, "post_id": 33927936, "comment_id": 55619322, "body": "Could you please share your xaml code?"}, {"owner": {"reputation": 4488, "user_id": 5254458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOw1L.jpg?s=128&g=1", "display_name": "Franklin Chen - MSFT", "link": "https://stackoverflow.com/users/5254458/franklin-chen-msft"}, "edited": false, "score": 0, "creation_date": 1448512594, "post_id": 33927936, "comment_id": 55621949, "body": "Which tablet device have you tried? In my Windows 10 PC(10.0.10586), I just placed your Grid under the root Grid panel and tested it in these two resolutions, the results are all the same."}, {"owner": {"reputation": 507, "user_id": 3839076, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b1439449586432ad1f8f85410885fb42?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea485", "link": "https://stackoverflow.com/users/3839076/andrea485"}, "reply_to_user": {"reputation": 4488, "user_id": 5254458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOw1L.jpg?s=128&g=1", "display_name": "Franklin Chen - MSFT", "link": "https://stackoverflow.com/users/5254458/franklin-chen-msft"}, "edited": false, "score": 0, "creation_date": 1448538269, "post_id": 33927936, "comment_id": 55634949, "body": "I noticed that on my tablet Dell venue 7140 with resolution 125 and 150 is not working properly, with 100 and 175 working properly. I tried to change the resolution even on my laptop and it&#39;s the same thing. both with Windows 10.0.10586"}, {"owner": {"reputation": 507, "user_id": 3839076, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b1439449586432ad1f8f85410885fb42?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea485", "link": "https://stackoverflow.com/users/3839076/andrea485"}, "reply_to_user": {"reputation": 4488, "user_id": 5254458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sOw1L.jpg?s=128&g=1", "display_name": "Franklin Chen - MSFT", "link": "https://stackoverflow.com/users/5254458/franklin-chen-msft"}, "edited": false, "score": 1, "creation_date": 1448546674, "post_id": 33927936, "comment_id": 55640276, "body": "I found the problem: changing the color in black and changing the thickness is now displayed correctly.` &lt;Border Grid.Row=&quot;0&quot; BorderBrush=&quot;Black&quot; BorderThickness=&quot;0,1,0,1&quot;&gt; &lt;/Border&gt;`"}, {"owner": {"reputation": 2091, "user_id": 4788286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/96pxN.jpg?s=128&g=1", "display_name": "Tam&#225;s Deme", "link": "https://stackoverflow.com/users/4788286/tam%c3%a1s-deme"}, "edited": false, "score": 0, "creation_date": 1448629481, "post_id": 33927936, "comment_id": 55673663, "body": "Post it as an answer, and accept it so the post is closed :)"}], "answers": [{"tags": [], "owner": {"reputation": 507, "user_id": 3839076, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b1439449586432ad1f8f85410885fb42?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea485", "link": "https://stackoverflow.com/users/3839076/andrea485"}, "is_accepted": true, "score": 0, "last_activity_date": 1448638613, "creation_date": 1448638613, "answer_id": 33960677, "question_id": 33927936, "link": "https://stackoverflow.com/questions/33927936/screen-resolution-not-display-correctly-grid/33960677#33960677", "title": "Screen resolution not display correctly grid", "body": "<p>I solved it by changing the thickness greater than 0.4:</p>\n\n<pre><code>&lt;Border Grid.Row=\"0\" BorderBrush=\"#F2F2F2\" BorderThickness=\"0,0.4,0,0.4\"&gt; &lt;/Border&gt;\n</code></pre>\n"}], "owner": {"reputation": 507, "user_id": 3839076, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b1439449586432ad1f8f85410885fb42?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea485", "link": "https://stackoverflow.com/users/3839076/andrea485"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 33960677, "answer_count": 1, "score": 0, "last_activity_date": 1448638613, "creation_date": 1448492549, "last_edit_date": 1448502155, "question_id": 33927936, "link": "https://stackoverflow.com/questions/33927936/screen-resolution-not-display-correctly-grid", "title": "Screen resolution not display correctly grid", "body": "<p>I created a simple application on my laptop with 1440x900 resolution and size of text,app 100% (setting the menu screen in the settings). when I run the application on my tablet with 1920x1080 resolution and 125%, the grid is not displayed correctly.\nright:\n<a href=\"https://i.stack.imgur.com/4Ichw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Ichw.png\" alt=\"right\"></a></p>\n\n<p>wrong:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Hd5W5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Hd5W5.png\" alt=\"wrong\"></a></p>\n\n<p>if my tablet I change the size of font,app in 100% or 175%, the grid is displayed correctly. </p>\n\n<p>thank you</p>\n\n<p>Edit:\nThis is the code xaml:</p>\n\n<pre><code>&lt;Grid x:Name=\"Grid\"&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"60\"&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition Height=\"60\"&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition Height=\"60\"&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition Height=\"60\"&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition Height=\"60\"&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition Height=\"60\"&gt;&lt;/RowDefinition&gt;\n          &lt;/Grid.RowDefinitions&gt;\n\n        &lt;Border Grid.Row=\"0\" BorderBrush=\"#F2F2F2\" BorderThickness=\"0,0.1,0,0.1\"&gt;\n            &lt;Line Stroke=\"#E9E9E9\" X1=\"0\" X2=\"400\" Y1=\"30\" Y2=\"30\"  StrokeThickness=\"1\" StrokeDashArray=\"6\" StrokeDashCap=\"Flat\" /&gt;\n        &lt;/Border&gt;\n\n        &lt;Border Grid.Row=\"1\" BorderBrush=\"#F2F2F2\" BorderThickness=\"0,0.1,0,0.1\"&gt;\n            &lt;Line Stroke=\"#E9E9E9\" X1=\"0\" X2=\"400\" Y1=\"30\" Y2=\"30\"  StrokeThickness=\"1\" StrokeDashArray=\"6\" StrokeDashCap=\"Flat\" /&gt;\n\n        &lt;/Border&gt;\n\n        &lt;Border Grid.Row=\"2\" BorderBrush=\"#F2F2F2\" BorderThickness=\"0,0.1,0,0.1\"&gt;\n            &lt;Line Stroke=\"#E9E9E9\" X1=\"0\" X2=\"400\" Y1=\"30\" Y2=\"30\"  StrokeThickness=\"1\" StrokeDashArray=\"6\" StrokeDashCap=\"Flat\" /&gt;\n\n        &lt;/Border&gt;\n        &lt;Border Grid.Row=\"3\" BorderBrush=\"#F2F2F2\" BorderThickness=\"0,0.1,0,0.1\"&gt;\n            &lt;Line Stroke=\"#E9E9E9\" X1=\"0\" X2=\"400\" Y1=\"30\" Y2=\"30\"  StrokeThickness=\"1\" StrokeDashArray=\"6\" StrokeDashCap=\"Flat\" /&gt;\n\n        &lt;/Border&gt;\n        &lt;Border Grid.Row=\"4\" BorderBrush=\"#F2F2F2\" BorderThickness=\"0,0.1,0,0.1\"&gt;\n            &lt;Line Stroke=\"#E9E9E9\" X1=\"0\" X2=\"400\" Y1=\"30\" Y2=\"30\"  StrokeThickness=\"1\" StrokeDashArray=\"6\" StrokeDashCap=\"Flat\" /&gt;\n\n        &lt;/Border&gt;\n       &lt;Border Grid.Row=\"5\" BorderBrush=\"#F2F2F2\" BorderThickness=\"0,0.1,0,0.1\"&gt;\n            &lt;Line Stroke=\"#E9E9E9\" X1=\"0\" X2=\"400\" Y1=\"30\" Y2=\"30\"  StrokeThickness=\"1\" StrokeDashArray=\"6\" StrokeDashCap=\"Flat\" /&gt;\n\n        &lt;/Border&gt;\n</code></pre>\n\n<p>\n                \n</p>\n"}, {"tags": ["c#", "model-view-controller", "remote-validation"], "answers": [{"comments": [{"owner": {"reputation": 7115, "user_id": 186820, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/836b23aeaf0cdc2e3ced82c8dd692614?s=128&d=identicon&r=PG", "display_name": "LittleFunny", "link": "https://stackoverflow.com/users/186820/littlefunny"}, "edited": false, "score": 0, "creation_date": 1448493353, "post_id": 33927984, "comment_id": 55617168, "body": "Yes I have checked that too.     &lt;add key=&quot;ClientValidationEnabled&quot; value=&quot;true&quot;/&gt;     &lt;add key=&quot;UnobtrusiveJavaScriptEnabled&quot; value=&quot;true&quot;/&gt;"}, {"owner": {"reputation": 766, "user_id": 5555200, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/aySTm.png?s=128&g=1", "display_name": "DiegoS", "link": "https://stackoverflow.com/users/5555200/diegos"}, "reply_to_user": {"reputation": 7115, "user_id": 186820, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/836b23aeaf0cdc2e3ced82c8dd692614?s=128&d=identicon&r=PG", "display_name": "LittleFunny", "link": "https://stackoverflow.com/users/186820/littlefunny"}, "edited": false, "score": 0, "creation_date": 1457192912, "post_id": 33927984, "comment_id": 59299882, "body": "Have you solved it? can you specify what else have you tried?"}], "tags": [], "owner": {"reputation": 766, "user_id": 5555200, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/aySTm.png?s=128&g=1", "display_name": "DiegoS", "link": "https://stackoverflow.com/users/5555200/diegos"}, "is_accepted": false, "score": 0, "last_activity_date": 1448492782, "creation_date": 1448492782, "answer_id": 33927984, "question_id": 33927794, "link": "https://stackoverflow.com/questions/33927794/asp-net-mvc-remote-validation-not-fired/33927984#33927984", "title": "ASP.NET MVC: Remote Validation not fired", "body": "<p>Might be this missing in your web.config?</p>\n\n<pre><code>  &lt;appSettings&gt;\n    &lt;add key=\"ClientValidationEnabled\" value=\"true\" /&gt;\n    &lt;add key=\"UnobtrusiveJavaScriptEnabled\" value=\"true\" /&gt;\n  &lt;/appSettings&gt;\n</code></pre>\n\n<p>\"<em>Because no JavaScript is emitted when you use unobtrusive client validation, if you forget to include the validation scripts, you will not see any errors when the page loads. The only result is that the form values will not be validated in the browser.</em>\"</p>\n\n<p>Source: <a href=\"https://msdn.microsoft.com/en-us/library/gg508808(VS.98).aspx\" rel=\"nofollow\">How to: Implement Remote Validation in ASP.NET MVC</a></p>\n"}], "owner": {"reputation": 7115, "user_id": 186820, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/836b23aeaf0cdc2e3ced82c8dd692614?s=128&d=identicon&r=PG", "display_name": "LittleFunny", "link": "https://stackoverflow.com/users/186820/littlefunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448492782, "creation_date": 1448491789, "question_id": 33927794, "link": "https://stackoverflow.com/questions/33927794/asp-net-mvc-remote-validation-not-fired", "title": "ASP.NET MVC: Remote Validation not fired", "body": "<p>Having problem calling the remote validation. I have everything setting properly with the matching property name with argument in the remoting methods in my controller. Only thing I suspect was the model which I located in a separate project. </p>\n\n<p>This is my code of the model:</p>\n\n<pre><code>[Display(Name=\"First name\")]\n    [Required(ErrorMessage=\"First name required\")]\n    public string Firstname { get; set; }\n\n    [Display(Name = \"Last name\")]\n    [Required(ErrorMessage = \"Last name required\")]\n    public string Lastname { get; set; }\n\n    [Display(Name = \"Username\")]\n    [Required(ErrorMessage = \"Username required\")]\n    [Remote(\"IsUsernameExisted\", \"UserValidationController\", HttpMethod = \"POST\")]\n    public string Username { get; set; }\n\n    [Display(Name = \"Email address\")]\n    [Required(ErrorMessage = \"Email address required\")]\n    [Remote(\"IsEmailExisted\", \"UserValidationController\", HttpMethod = \"POST\")]\n    public string EmailAddress { get; set; }\n\n    [Display(Name = \"Password\")]\n    [Required(ErrorMessage = \"Password required\")]\n    public string Password { get; set; }\n\n    [Display(Name = \"Confirmation password\")]\n    [Required(ErrorMessage = \"Confirmation required\")]\n    [System.Web.Mvc.CompareAttribute(\"Password\", ErrorMessage = \"Passwords don't match.\")]\n    public string ConfirmationPassword { get; set; }\n</code></pre>\n\n<p>This model is a separate project but in same solution in visual studio.</p>\n\n<p>Will it the reason the remote validation not get fired. </p>\n"}, {"tags": ["c#", "asp.net-mvc", "image", "barcode-scanner"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5485072, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ad1ad28b2c8c17800f207e1952f5220?s=128&d=identicon&r=PG&f=1", "display_name": "everest", "link": "https://stackoverflow.com/users/5485072/everest"}, "edited": false, "score": 0, "creation_date": 1448492222, "post_id": 33927834, "comment_id": 55616710, "body": "Oh great, I also found keyboard emulation, wedge sending it to the page. Does it put in a text field, I am wondering how to send this data via an ajax call back and not the input text field."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 73, "user_id": 5485072, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ad1ad28b2c8c17800f207e1952f5220?s=128&d=identicon&r=PG&f=1", "display_name": "everest", "link": "https://stackoverflow.com/users/5485072/everest"}, "edited": false, "score": 1, "creation_date": 1448492318, "post_id": 33927834, "comment_id": 55616747, "body": "@Everest depends on the specific scanner, the cheap ones are just virtual keyboards and you can&#39;t do anything with them that you can&#39;t do with typing on a keyboard. More expensive ones have special SDKs that let you intercept the input before it gets typed as a keyboard but those are device specific. It all depends on the specific device, there is no general purpose capture standard like TWIAN."}, {"owner": {"reputation": 18209, "user_id": 2266130, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/YBXhC.png?s=128&g=1", "display_name": "Jeroen van Langen", "link": "https://stackoverflow.com/users/2266130/jeroen-van-langen"}, "edited": false, "score": 1, "creation_date": 1448492361, "post_id": 33927834, "comment_id": 55616762, "body": "The scanner will type numbers, just like the keyboard. So if you want to capture the numbers, just create a text field and use a submit button to send the numbers to the server. like a normal Form."}, {"owner": {"reputation": 73, "user_id": 5485072, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ad1ad28b2c8c17800f207e1952f5220?s=128&d=identicon&r=PG&f=1", "display_name": "everest", "link": "https://stackoverflow.com/users/5485072/everest"}, "edited": false, "score": 0, "creation_date": 1448492634, "post_id": 33927834, "comment_id": 55616875, "body": "so, to send it to the server... in the <code>ASP MVC Web APP</code> ,.. I understand a hidden text field with a submit. But who is responsible, who will trigger the submit, the scanner? if they are scanning 15 to 10 items continuously , how will this get there.."}, {"owner": {"reputation": 73, "user_id": 5485072, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ad1ad28b2c8c17800f207e1952f5220?s=128&d=identicon&r=PG&f=1", "display_name": "everest", "link": "https://stackoverflow.com/users/5485072/everest"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448492800, "post_id": 33927834, "comment_id": 55616957, "body": "@ScottChamberlain any suggestions on the scanners. The Motorola, Mapjects and Honeywell ones are too expensive, we looked at all of them. I need something working fairly quick for a farmers market, what would I be looking to spend (range) and which one is easy to integrate"}, {"owner": {"reputation": 18209, "user_id": 2266130, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/YBXhC.png?s=128&g=1", "display_name": "Jeroen van Langen", "link": "https://stackoverflow.com/users/2266130/jeroen-van-langen"}, "edited": false, "score": 0, "creation_date": 1448517456, "post_id": 33927834, "comment_id": 55623465, "body": "If the barcodes are the same length, you could trigger the submit after a certain count of numbers."}], "tags": [], "owner": {"reputation": 18209, "user_id": 2266130, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/YBXhC.png?s=128&g=1", "display_name": "Jeroen van Langen", "link": "https://stackoverflow.com/users/2266130/jeroen-van-langen"}, "is_accepted": true, "score": 1, "last_activity_date": 1448492027, "creation_date": 1448492027, "answer_id": 33927834, "question_id": 33927791, "link": "https://stackoverflow.com/questions/33927791/acquiring-the-scan-data-from-a-barcode-scanner-wedge-simulation-to-ajax-servers/33927834#33927834", "title": "Acquiring the scan data from a barcode scanner Wedge, Simulation to AJAX serverside", "body": "<p>Normally a simple barcode scanner wil 'emulate' a keyboard/keypad and 'type' the numbers as they were typed on a keyboard. So when scanning, be sure a TextBox is selected.</p>\n"}], "owner": {"reputation": 73, "user_id": 5485072, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2ad1ad28b2c8c17800f207e1952f5220?s=128&d=identicon&r=PG&f=1", "display_name": "everest", "link": "https://stackoverflow.com/users/5485072/everest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 1, "closed_date": 1450049945, "accepted_answer_id": 33927834, "answer_count": 1, "score": 0, "last_activity_date": 1448492473, "creation_date": 1448491777, "last_edit_date": 1448492473, "question_id": 33927791, "link": "https://stackoverflow.com/questions/33927791/acquiring-the-scan-data-from-a-barcode-scanner-wedge-simulation-to-ajax-servers", "closed_reason": "Not suitable for this site", "title": "Acquiring the scan data from a barcode scanner Wedge, Simulation to AJAX serverside", "body": "<p>I have a web application ASP MVC C#, and the users have a scanner at the desktop. They perform scans of goods.</p>\n\n<p>Please help understand, <em>how to connect with the scanner</em> and acquire the scan from the user (is this a twain like driver standard)?</p>\n\n<ol>\n<li>How exactly, can you I get the scan data to my application, its a simple barcode. </li>\n<li>Is there a standard, or a protocol that I can register to read.</li>\n<li>Is there a framework that works well with scanners</li>\n</ol>\n\n<p>Update 1: \nHow can I control whether the data shows up/scans to the text field or simply sent to a backend AJAX post childAction, for e.g. \n<code>[post] public .. PostedScanData(string ScannnedData) {..</code>  can you please share a sample if possible</p>\n"}, {"tags": ["c#", "asp.net", "shared-libraries"], "answers": [{"comments": [{"owner": {"reputation": 2669, "user_id": 1623754, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/382890079c7edd28ea2de92e6f2815f8?s=128&d=identicon&r=PG", "display_name": "Koopakiller", "link": "https://stackoverflow.com/users/1623754/koopakiller"}, "edited": false, "score": 0, "creation_date": 1448721479, "post_id": 33927962, "comment_id": 55701246, "body": "But it  is a shared project, not a class library. That means all files will copied to the referencing project. If you look at a Windows/WP JavaScript App it works."}], "tags": [], "owner": {"reputation": 1738, "user_id": 3244413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972fa390c836f4e51bfa94fc7c4d9902?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Gourley", "link": "https://stackoverflow.com/users/3244413/darren-gourley"}, "is_accepted": false, "score": -1, "last_activity_date": 1448492667, "creation_date": 1448492667, "answer_id": 33927962, "question_id": 33927723, "link": "https://stackoverflow.com/questions/33927723/shared-project-for-asp-net/33927962#33927962", "title": "Shared Project for ASP.NET", "body": "<p>At the end of the day your images have to actually be somewhere, you can't just reference them from another project. It would work if this other project was hosted in IIS, given a domain, and you referenced the images from this domain. Perhaps call it your CDN. </p>\n\n<p>When you reference a project to get at  classes etc, the project is bundled up in to a dll and packaged along with the main project. Images, js files etc can't be bundled in to a dll, and will not be copied across to your project. </p>\n"}, {"tags": [], "owner": {"reputation": 348, "user_id": 4406940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920f870bf0b7382a0d8f208e0fab5688?s=128&d=identicon&r=PG&f=1", "display_name": "Eckd", "link": "https://stackoverflow.com/users/4406940/eckd"}, "is_accepted": false, "score": 0, "last_activity_date": 1448495800, "creation_date": 1448495800, "answer_id": 33928488, "question_id": 33927723, "link": "https://stackoverflow.com/questions/33927723/shared-project-for-asp-net/33928488#33928488", "title": "Shared Project for ASP.NET", "body": "<p>You still can bundle resources with project and distribute it, but you nee to create nuget package.</p>\n\n<ol>\n<li>create project </li>\n<li>make nuget package </li>\n<li>publish it to private feed (e.g. myget.org) </li>\n<li>add reference to your feed from client projects</li>\n</ol>\n\n<p>PS: Only content of folder 'Content' included in nuget package.</p>\n"}, {"tags": [], "owner": {"reputation": 1226, "user_id": 2294547, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/lat0n.jpg?s=128&g=1", "display_name": "Matthew Hudson", "link": "https://stackoverflow.com/users/2294547/matthew-hudson"}, "is_accepted": false, "score": 0, "last_activity_date": 1527589226, "creation_date": 1527589226, "answer_id": 50581926, "question_id": 33927723, "link": "https://stackoverflow.com/questions/33927723/shared-project-for-asp-net/50581926#50581926", "title": "Shared Project for ASP.NET", "body": "<p>Apologies for the speculative answer, but hopefully this will help someone;</p>\n\n<p>This is a struggle I'm currently facing too (which is concerning, as nearly two years have passed with barely a mention).</p>\n\n<p>I have also had to manually add the Import line to each solution as it appears you have.</p>\n\n<p>I think the issue is with the inbuilt debugger not knowing how to serve the files properly. If you <strong>deploy the compiled solution to any instance of IIS</strong> it appears to work correctly.</p>\n\n<p>I am experimenting with the inbuilt debugger to see if I can get it to work, but am quite confident I'll have to <strong>use a local IIS instance moving forward</strong>.</p>\n\n<p>Shared projects provide invaluable functionality, so it's a shame it's still not natively supported.</p>\n"}], "owner": {"reputation": 2669, "user_id": 1623754, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/382890079c7edd28ea2de92e6f2815f8?s=128&d=identicon&r=PG", "display_name": "Koopakiller", "link": "https://stackoverflow.com/users/1623754/koopakiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 541, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1527589226, "creation_date": 1448491459, "question_id": 33927723, "link": "https://stackoverflow.com/questions/33927723/shared-project-for-asp-net", "title": "Shared Project for ASP.NET", "body": "<p>I have two ASP.NET web projects and they share a lot of images and JavaScript files. I tried to create a shared project and linking it into both ASP.NET <em>csproj</em> files:</p>\n\n<pre><code>&lt;Import Project=\"..\\Shared\\Shared.projitems\" Label=\"Shared\" /&gt;\n</code></pre>\n\n<p>But images inside the shared project are not found during debugging with IIS (Browsers \"image not found\" image is displayed). But Visual Studio recognized them and showing the image files in IntelliSense.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["c#", "migradoc"], "answers": [{"comments": [{"owner": {"reputation": 1809, "user_id": 1383366, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/3a4d9b9bba5c161be88d53ac75c6b7b5?s=128&d=identicon&r=PG", "display_name": "redcurry", "link": "https://stackoverflow.com/users/1383366/redcurry"}, "edited": false, "score": 0, "creation_date": 1448903986, "post_id": 33934601, "comment_id": 55764174, "body": "Thank you! I had to play a lot with the indents and paddings to make things look right, but it worked! Too bad about the table header not repeating if the table breaks across two pages."}], "tags": [], "owner": {"reputation": 18344, "user_id": 162529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EWVD6.png?s=128&g=1", "display_name": "I liked the old Stack Overflow", "link": "https://stackoverflow.com/users/162529/i-liked-the-old-stack-overflow"}, "is_accepted": true, "score": 2, "last_activity_date": 1448529431, "creation_date": 1448529431, "answer_id": 33934601, "question_id": 33927555, "link": "https://stackoverflow.com/questions/33927555/in-migradoc-how-do-i-surround-some-text-and-a-table-with-the-same-border/33934601#33934601", "title": "In MigraDoc, how do I surround some text and a table with the same border?", "body": "<p>I think I would use a single table, maybe with some dummy columns and/or dummy rows.</p>\n\n<p>You can add a row between \"paragraph\" and \"table\". You can add dummy columns left and right and below \"table\" to get a double border here.</p>\n\n<p>For the \"paragraph\" you can use MergeRight to have it span all columns.</p>\n\n<p>Most likely you will have to add two rows at the top, one row at the bottom, one column at the left, one column at the right. And \"table\" header will not be repeated if \"table\" should break across two pages.</p>\n"}], "owner": {"reputation": 1809, "user_id": 1383366, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/3a4d9b9bba5c161be88d53ac75c6b7b5?s=128&d=identicon&r=PG", "display_name": "redcurry", "link": "https://stackoverflow.com/users/1383366/redcurry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 33934601, "answer_count": 1, "score": 1, "last_activity_date": 1448529431, "creation_date": 1448490606, "question_id": 33927555, "link": "https://stackoverflow.com/questions/33927555/in-migradoc-how-do-i-surround-some-text-and-a-table-with-the-same-border", "title": "In MigraDoc, how do I surround some text and a table with the same border?", "body": "<p>Using MigraDoc, I'm able to write a sentence (in a single paragraph) and follow it with a table. I would like to surround both of these with a single outer border (the table should still have its own border). I tried creating a text frame, adding the text and table, and setting the border for the frame, but that didn't work (the text was in the border but the table was not).</p>\n"}, {"tags": ["c#", "wpf", "file", "resources"], "comments": [{"owner": {"reputation": 1135, "user_id": 5063263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9dadb72e3e03e28dc7f64b43353f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "ivan", "link": "https://stackoverflow.com/users/5063263/ivan"}, "edited": false, "score": 0, "creation_date": 1448490767, "post_id": 33927531, "comment_id": 55616136, "body": "Try moving the folder to the same place where the .exe is"}, {"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1448490848, "post_id": 33927531, "comment_id": 55616163, "body": "If they are embedded resources, then you need to read them as a stream from the embedded resources and copy them out manually. Perhaps <a href=\"https://support.microsoft.com/en-us/kb/319292\" rel=\"nofollow noreferrer\">this Knowledge Base tutorial</a> can help you."}], "answers": [{"tags": [], "owner": {"reputation": 3357, "user_id": 4371905, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHqwg.png?s=128&g=1", "display_name": "Tim Eeckhaut", "link": "https://stackoverflow.com/users/4371905/tim-eeckhaut"}, "is_accepted": false, "score": 2, "last_activity_date": 1448491599, "last_edit_date": 1448491599, "creation_date": 1448491286, "answer_id": 33927689, "question_id": 33927531, "link": "https://stackoverflow.com/questions/33927531/link-to-local-text-file-in-solution-c/33927689#33927689", "title": "Link to local text file in Solution c#", "body": "<p>Step 1: add the files to your project</p>\n\n<p><a href=\"https://i.stack.imgur.com/HrHyX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HrHyX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Step 2: make them embedded resource</p>\n\n<p><a href=\"https://i.stack.imgur.com/TlKv0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TlKv0.png\" alt=\"enter image description here\"></a></p>\n\n<p>Step 3: export them to filesystem at runtime:</p>\n\n<pre><code>using System.Reflection;\n\nnamespace ConsoleApplication1\n{\n    class Program4\n    {\n        public static void Main(string[] args)\n        {\n            using(var stream = Assembly.GetExecutingAssembly()\n                .GetManifestResourceStream(\"ConsoleApplication1.Files.TextFile1.txt\"))\n            using (var filestream = System.IO.File.OpenWrite(\"target.txt\"))\n            {\n                stream.CopyTo(filestream);\n                filestream.Flush();\n                filestream.Close();\n                stream.Close();\n            }\n        }\n    }\n}\n</code></pre>\n\n<ul>\n<li>\"ConsoleApplication1.Files.TextFile1.txt\" comes from:\n\n<ul>\n<li>ConsoleApplication1: default namespace of the project containing the files</li>\n<li>Files.TextFile1.txt: relative path, dotted, inside the dll (look @ screenshot 1)</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 117, "user_id": 2410405, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/58633ff1512b1ab17e06f8c901f24ad8?s=128&d=identicon&r=PG", "display_name": "Emanuele", "link": "https://stackoverflow.com/users/2410405/emanuele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448491599, "creation_date": 1448490473, "question_id": 33927531, "link": "https://stackoverflow.com/questions/33927531/link-to-local-text-file-in-solution-c", "title": "Link to local text file in Solution c#", "body": "<p>I need to save a set of 20 txt files into my solution so they will be included into the exe file. In such a way I will be able to send to the final users only the executable file and anything else.</p>\n\n<p>I need to use the following function:</p>\n\n<pre><code>File.Copy( sourcePath, @path + \"\\\\FileName.txt\");\n</code></pre>\n\n<p>to copy one of the 20 files into another directory (according to the request of the user). In order to include the 20 txt files into the solution, I created a new folder into the Solution Explorer and I put them into it. Then I selected \"Resources\" into the option of the single txt file. Let's suppose the name of the folder is FOO and the file is NAME01, then I'm assuming the local address of the single txt file is \"\\FOO\\NAME01.txt\". But this is not working, I'm getting an arror from the File.Copy function related to the sourcePath.</p>\n\n<p>Do you have any suggestions? I'm stacked on this problem and I cannot find any solution on the web. Many thanks!</p>\n"}, {"tags": ["c#", "wpf", "xaml"], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 3448356, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a5085b67bef3fab1039e11ea18924d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar Romeroo", "link": "https://stackoverflow.com/users/3448356/cesar-romeroo"}, "edited": false, "score": 0, "creation_date": 1448577264, "post_id": 33931594, "comment_id": 55654634, "body": "This seems to be the answer I need but after tested doesn&#39;t work, the image is not displayed I edited post to clarify applied code"}, {"owner": {"reputation": 1612, "user_id": 1820184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FJ81G.png?s=128&g=1", "display_name": "bars222", "link": "https://stackoverflow.com/users/1820184/bars222"}, "reply_to_user": {"reputation": 163, "user_id": 3448356, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a5085b67bef3fab1039e11ea18924d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar Romeroo", "link": "https://stackoverflow.com/users/3448356/cesar-romeroo"}, "edited": false, "score": 0, "creation_date": 1448603744, "post_id": 33931594, "comment_id": 55660459, "body": "Maybe something wrong with images path. Is image displayed correctly if you add <code>&lt;Image Source=&quot;pack:&#47;&#47;siteoforigin:,,,&#47;Resources&#47;a_128.png&quot; &#47;&gt;</code> on some place in the window? Also I&#39;ve used StaticResource for header style, but it also works with DinamicResource."}, {"owner": {"reputation": 163, "user_id": 3448356, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a5085b67bef3fab1039e11ea18924d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar Romeroo", "link": "https://stackoverflow.com/users/3448356/cesar-romeroo"}, "edited": false, "score": 0, "creation_date": 1448676122, "post_id": 33931594, "comment_id": 55691392, "body": "Yes, Actually i put a Image and set Source from the Source from the property manager and that was the string generated, and whish I put on Header"}, {"owner": {"reputation": 1612, "user_id": 1820184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FJ81G.png?s=128&g=1", "display_name": "bars222", "link": "https://stackoverflow.com/users/1820184/bars222"}, "reply_to_user": {"reputation": 163, "user_id": 3448356, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a5085b67bef3fab1039e11ea18924d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar Romeroo", "link": "https://stackoverflow.com/users/3448356/cesar-romeroo"}, "edited": false, "score": 0, "creation_date": 1448863671, "post_id": 33931594, "comment_id": 55740502, "body": "I&#39;ve changed answer, maybe it helps. And you should test somewhere in window that image resources is displayed correctly. For example, create <code>Button</code> and set it&#39;s <code>Content</code> to <code>StaticResouce</code>."}], "tags": [], "owner": {"reputation": 1612, "user_id": 1820184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FJ81G.png?s=128&g=1", "display_name": "bars222", "link": "https://stackoverflow.com/users/1820184/bars222"}, "is_accepted": false, "score": 0, "last_activity_date": 1448863527, "last_edit_date": 1448863527, "creation_date": 1448517771, "answer_id": 33931594, "question_id": 33927490, "link": "https://stackoverflow.com/questions/33927490/set-image-source-inside-a-button-in-columnheaderstyle-template/33931594#33931594", "title": "Set Image source inside a Button in ColumnHeaderStyle Template", "body": "<p>You can bind image to the some property of <code>DataGridColumn</code>, for example to <code>Header</code> property. In that case <code>Image</code> code looks like this.</p>\n\n<pre><code>&lt;Image Stretch=\"Uniform\" Height=\"60\" Width=\"100\" VerticalAlignment=\"Stretch\"                                                 \n       Source=\"{Binding Path=Column.Header, RelativeSource={RelativeSource Mode=TemplatedParent}}\" /&gt;\n</code></pre>\n\n<p>And <code>Columns</code> code. I think you can use <code>Bindings</code> in the headers if you want.</p>\n\n<pre><code>&lt;DataGrid.Columns&gt;\n    &lt;DataGridCheckBoxColumn Header=\"/WPFTest;component/Images/GPlus.png\" Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\"/&gt;\n    &lt;DataGridCheckBoxColumn Header=\"/WPFTest;component/Images/GMain.ico\" Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\"/&gt;\n    &lt;DataGridCheckBoxColumn Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\"/&gt;\n&lt;/DataGrid.Columns&gt;\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>Another way. You can define button content in <code>Resources</code>.</p>\n\n<pre><code>&lt;Image x:Key=\"testImage\" Height=\"60\" Width=\"100\" Source=\"/WPFTest;component/Images/GPlus.png\" /&gt;\n&lt;Image x:Key=\"testImage2\" Height=\"60\" Width=\"100\" Source=\"/WPFTest;component/Images/GMain.ico\" /&gt;\n</code></pre>\n\n<p>And should change the button in the <code>ControlTemplate</code>.</p>\n\n<pre><code>&lt;Button x:Name=\"button\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\"\n        Content=\"{Binding Path=Column.Header, RelativeSource={RelativeSource Mode=TemplatedParent}}\"&gt;\n</code></pre>\n\n<p>And <code>Columns</code>.</p>\n\n<pre><code>&lt;DataGrid.Columns&gt;\n    &lt;DataGridCheckBoxColumn Header=\"{StaticResource testImage}\" Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\"/&gt;\n    &lt;DataGridCheckBoxColumn Header=\"{StaticResource testImage2}\" Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\"/&gt;\n    &lt;DataGridCheckBoxColumn Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\"/&gt;\n&lt;/DataGrid.Columns&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9031, "user_id": 3667257, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/tmhZR.jpg?s=128&g=1", "display_name": "AnjumSKhan", "link": "https://stackoverflow.com/users/3667257/anjumskhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1448521825, "creation_date": 1448521825, "answer_id": 33932529, "question_id": 33927490, "link": "https://stackoverflow.com/questions/33927490/set-image-source-inside-a-button-in-columnheaderstyle-template/33932529#33932529", "title": "Set Image source inside a Button in ColumnHeaderStyle Template", "body": "<p>You are changing the template which would be applied to all the column headers. If you want to use control-template and still want different images for individual headers, you can go for </p>\n\n<ol>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/library/system.windows.controls.styleselector(v=vs.110).aspx\" rel=\"nofollow\">Style selectors</a>,</p></li>\n<li><p>If you still want to use TemplateBinding syntax, then you can get your ImageSource value in Button's Tag property and bind your Image's source like <code>&lt;Image Source=\"{TemplateBinding Tag}\" /&gt;</code> in your current template .</p></li>\n</ol>\n\n<p>If you want separate images for separate col headers, you can either </p>\n\n<ol>\n<li><p>Hard code values in every column header like <code>&lt;Image source = \"img/headerimg1.png\"/&gt;</code> , or</p></li>\n<li><p>Binding Source property like <code>&lt;Image source = {x:Static local:SomeClass.Src1} /&gt;</code>.</p>\n\n<pre><code>            &lt;DataGridTemplateColumn.HeaderTemplate&gt;\n                &lt;DataTemplate&gt;                            \n                 &lt;Image Source=\"{x:Static local:SomeClass.Src1}\"/&gt;                                            \n                &lt;/DataTemplate&gt;\n            &lt;/DataGridTemplateColumn.HeaderTemplate&gt;\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 163, "user_id": 3448356, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a5085b67bef3fab1039e11ea18924d2?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar Romeroo", "link": "https://stackoverflow.com/users/3448356/cesar-romeroo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448863527, "creation_date": 1448490299, "last_edit_date": 1448577416, "question_id": 33927490, "link": "https://stackoverflow.com/questions/33927490/set-image-source-inside-a-button-in-columnheaderstyle-template", "title": "Set Image source inside a Button in ColumnHeaderStyle Template", "body": "<p>I basecally want the headers of the columns perform as a button, I tought using a a ColumnHEaderStyle would be easy but I think I'm missing something</p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;Style x:Key=\"ColumnHeadTemplate\" TargetType=\"{x:Type DataGridColumnHeader}\"&gt;\n        &lt;Setter Property=\"Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"{x:Type DataGridColumnHeader}\"&gt;\n                    &lt;Grid Height=\"82\"&gt;\n                        &lt;Button x:Name=\"button\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\"&gt;\n                            &lt;Image   Stretch=\"Uniform\" Height=\"77\" Width=\"120\" VerticalAlignment=\"Stretch\" Source=\"{TemplateBinding ??}\" /&gt;\n                        &lt;/Button&gt;\n                    &lt;/Grid&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n&lt;/Window.Resources&gt;\n&lt;DataGrid x:Name=\"dataGrid\" SelectionChanged=\"dataGrid_SelectionChanged\" ColumnHeaderStyle=\"{DynamicResource ColumnHeadTemplate}\"&gt;\n    &lt;DataGrid.Columns&gt;\n        &lt;DataGridCheckBoxColumn Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\"/&gt;\n        &lt;DataGridCheckBoxColumn Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\"/&gt;\n        &lt;DataGridCheckBoxColumn Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\"/&gt;\n    &lt;/DataGrid.Columns&gt;\n&lt;/DataGrid&gt;\n</code></pre>\n\n<p>The template works, but now I'm stuck trying to set the Image Source for each Column, how can acomplish that?</p>\n\n<p><strong>Edit 1</strong>\nAfter test </p>\n\n<pre><code>&lt;Window.Resources&gt;\n    &lt;Style x:Key=\"ColumnHeadTemplate\" TargetType=\"{x:Type DataGridColumnHeader}\"&gt;\n        &lt;Setter Property=\"Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"{x:Type DataGridColumnHeader}\"&gt;\n                    &lt;Grid Height=\"82\"&gt;\n                        &lt;Button x:Name=\"button\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\"&gt;\n                            &lt;Image   Stretch=\"Uniform\" Height=\"77\" Width=\"120\" VerticalAlignment=\"Stretch\" Source=\"{Binding Path=Column.Header, RelativeSource={RelativeSource Mode=TemplatedParent}}\"  /&gt;\n                        &lt;/Button&gt;\n                    &lt;/Grid&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n&lt;/Window.Resources&gt;\n&lt;Viewbox Stretch=\"Fill\"&gt;\n    &lt;DataGrid x:Name=\"dataGrid\" SelectionChanged=\"dataGrid_SelectionChanged\" ColumnHeaderStyle=\"{DynamicResource ColumnHeadTemplate}\" Height=\"319\" Width=\"1014\"&gt;\n        &lt;DataGrid.Columns&gt;\n            &lt;DataGridCheckBoxColumn Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\" Header=\"pack://siteoforigin:,,,/Resources/a_128.png\"/&gt;\n            &lt;DataGridCheckBoxColumn Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\" Header=\"pack://siteoforigin:,,,/Resources/b_128.png\"/&gt;\n            &lt;DataGridCheckBoxColumn Binding=\"{x:Null}\" ClipboardContentBinding=\"{x:Null}\" Header=\"pack://siteoforigin:,,,/Resources/c_128.png\"/&gt;\n\n        &lt;/DataGrid.Columns&gt;\n    &lt;/DataGrid&gt;\n&lt;/Viewbox&gt;\n</code></pre>\n\n<p>But the image is not displayed in the header</p>\n"}, {"tags": ["c#", "if-statement"], "comments": [{"owner": {"reputation": 7506, "user_id": 622391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cea6f87ff9eacc4b168afcb647d69977?s=128&d=identicon&r=PG", "display_name": "Simon M\u1d9cKenzie", "link": "https://stackoverflow.com/users/622391/simon-m%e1%b6%9ckenzie"}, "edited": false, "score": 3, "creation_date": 1448490163, "post_id": 33927421, "comment_id": 55615882, "body": "If you named your image resources like &quot;Spades1, Hearts4&quot; etc., you could load them by name via <code>cardType + cardNum</code>..."}], "answers": [{"tags": [], "owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "is_accepted": false, "score": 0, "last_activity_date": 1448490220, "creation_date": 1448490220, "answer_id": 33927473, "question_id": 33927421, "link": "https://stackoverflow.com/questions/33927421/c-i-have-50-else-if-statements-for-cards-is-there-a-way-to-make-it-shorter-or/33927473#33927473", "title": "C# I have 50+ else if statements for cards, is there a way to make it shorter or do it all at one go?", "body": "<p>Put all of your items in to an array then use your random to pick a index from the array.</p>\n\n<pre><code>private Image[] _cards = new Image[] {ace_of_spades, ace_of_hearts, /* and so on for all of the cards*/ }\n\nvoid YourFunction(Random rnd)\n{\n    var nextCardIndex = rnd.GetNext(_cards.Length);\n    pictureBox1.Image = _cards[nextCardIndex];\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448490281, "post_id": 33927479, "comment_id": 55615938, "body": "Your indexer is much better than mine."}, {"owner": {"reputation": 12251, "user_id": 1199684, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d997a71f1df34149c9166926baad0d37?s=128&d=identicon&r=PG", "display_name": "bytecode77", "link": "https://stackoverflow.com/users/1199684/bytecode77"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448490354, "post_id": 33927479, "comment_id": 55615969, "body": "Thanks! Well, your&#39;s randomizes the image, but I think the OP wants to randomize two numbers and find the right card by those two."}], "tags": [], "owner": {"reputation": 12251, "user_id": 1199684, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d997a71f1df34149c9166926baad0d37?s=128&d=identicon&r=PG", "display_name": "bytecode77", "link": "https://stackoverflow.com/users/1199684/bytecode77"}, "is_accepted": false, "score": 5, "last_activity_date": 1448490240, "creation_date": 1448490240, "answer_id": 33927479, "question_id": 33927421, "link": "https://stackoverflow.com/questions/33927421/c-i-have-50-else-if-statements-for-cards-is-there-a-way-to-make-it-shorter-or/33927479#33927479", "title": "C# I have 50+ else if statements for cards, is there a way to make it shorter or do it all at one go?", "body": "<p>There are a lot of ways, but in general I would say: <strong>Use an array as a lookup</strong></p>\n\n<p>For example, you have an array like</p>\n\n<pre><code>Image[] images = new[]\n{\n    ace_of_spades,\n    ace_of_hearts,\n    ...\n};\n</code></pre>\n\n<p>Now all you have to do is calculate the right index. Since you didn't provide as much information as I need to help you on this, I will simply guess that it would look similar to this:</p>\n\n<pre><code>pictureBox1.Image = images[cardNum * 7 + (int)cardType];\n</code></pre>\n\n<p>Like I said, this is the idea behind this. Now you have to find the right calculation for it.</p>\n"}, {"tags": [], "owner": {"reputation": 4077, "user_id": 2394816, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13e6e64263ea27ab1814eebad0649034?s=128&d=identicon&r=PG", "display_name": "Karl Gjertsen", "link": "https://stackoverflow.com/users/2394816/karl-gjertsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1448490695, "creation_date": 1448490695, "answer_id": 33927571, "question_id": 33927421, "link": "https://stackoverflow.com/questions/33927421/c-i-have-50-else-if-statements-for-cards-is-there-a-way-to-make-it-shorter-or/33927571#33927571", "title": "C# I have 50+ else if statements for cards, is there a way to make it shorter or do it all at one go?", "body": "<p>I would rename your images. If you could have names such as Spade_1, Spade_2, etc you could build up the file name in a simple step.</p>\n\n<pre><code>var name = cardType + \"_\" + cardNum;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43082, "user_id": 74195, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/2Il1P.jpg?s=128&g=1", "display_name": "DRapp", "link": "https://stackoverflow.com/users/74195/drapp"}, "is_accepted": false, "score": 0, "last_activity_date": 1448490734, "creation_date": 1448490734, "answer_id": 33927582, "question_id": 33927421, "link": "https://stackoverflow.com/questions/33927421/c-i-have-50-else-if-statements-for-cards-is-there-a-way-to-make-it-shorter-or/33927582#33927582", "title": "C# I have 50+ else if statements for cards, is there a way to make it shorter or do it all at one go?", "body": "<p>Why not to randomization from 0-51 (total 52 cards).   </p>\n\n<p>Then for the suit, the suit would be based on the INTEGER of card # / 13..  Thus cards 0-12 ex:Spades, 13-25=Hearts, 26-38 = Diamonds, 39-51 = Clubs.</p>\n\n<p>The Modulus of the number 13 would be the card (from 0-12).  BY adding 1 to the modulus result, you would go from 0-12 as an array 0 = Ace, 12 = King</p>\n"}, {"comments": [{"owner": {"reputation": 2397, "user_id": 3720039, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/dc77388e4198a27e82147b72571d1016?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/3720039/taylor"}, "edited": false, "score": 0, "creation_date": 1448494309, "post_id": 33927778, "comment_id": 55617480, "body": "Should I type up this code in the Program.cs file or Form1.cs?"}, {"owner": {"reputation": 688, "user_id": 363677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/361Uo.jpg?s=128&g=1", "display_name": "Mike U", "link": "https://stackoverflow.com/users/363677/mike-u"}, "reply_to_user": {"reputation": 2397, "user_id": 3720039, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/dc77388e4198a27e82147b72571d1016?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/3720039/taylor"}, "edited": false, "score": 0, "creation_date": 1448504214, "post_id": 33927778, "comment_id": 55619933, "body": "The classes (with the exception of &quot;Program&quot;) can go wherever.  All of these are Types that would go inside a namespace.  How you implement using the &quot;Deck&quot; class would depend on what kind of application you&#39;re making.  This is just a high-level design for a series of classes to implement building something which needs a deck of cards.  Walking you through creating an entire application begining-to-end is a bit more involved."}, {"owner": {"reputation": 688, "user_id": 363677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/361Uo.jpg?s=128&g=1", "display_name": "Mike U", "link": "https://stackoverflow.com/users/363677/mike-u"}, "reply_to_user": {"reputation": 2397, "user_id": 3720039, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/dc77388e4198a27e82147b72571d1016?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/3720039/taylor"}, "edited": false, "score": 0, "creation_date": 1449507663, "post_id": 33927778, "comment_id": 56025980, "body": "Setup a setup of libraries to handle this sort of thing.  It also includes (the beginnings of) a base class to handle game logic.  There is also a separate project specifically for an &quot;Uno&quot; type game. <a href=\"https://github.com/tenshino/RainstormStudios/tree/6e4dcff8c9586c0869249d38ba7c00cf5f0c9bda/RainstormStudios.Games/Cards\" rel=\"nofollow noreferrer\">github.com/tenshino/RainstormStudios/tree/&hellip;</a>"}, {"owner": {"reputation": 688, "user_id": 363677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/361Uo.jpg?s=128&g=1", "display_name": "Mike U", "link": "https://stackoverflow.com/users/363677/mike-u"}, "reply_to_user": {"reputation": 2397, "user_id": 3720039, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/dc77388e4198a27e82147b72571d1016?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/3720039/taylor"}, "edited": false, "score": 0, "creation_date": 1452705160, "post_id": 33927778, "comment_id": 57290796, "body": "Just FYI:  I mucked up my Git repo, so here&#39;s an updated link: <a href=\"https://github.com/tenshino/RainstormStudios/tree/master/RainstormStudios.Games/Cards\" rel=\"nofollow noreferrer\">github.com/tenshino/RainstormStudios/tree/master/&hellip;</a>"}, {"owner": {"reputation": 2397, "user_id": 3720039, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/dc77388e4198a27e82147b72571d1016?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/3720039/taylor"}, "edited": false, "score": 0, "creation_date": 1460935479, "post_id": 33927778, "comment_id": 60956198, "body": "I know I accepted the answer late, but I got back to this project and ended up googling the same issue. Thank you!"}], "tags": [], "owner": {"reputation": 688, "user_id": 363677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/361Uo.jpg?s=128&g=1", "display_name": "Mike U", "link": "https://stackoverflow.com/users/363677/mike-u"}, "is_accepted": true, "score": 4, "last_activity_date": 1448491741, "creation_date": 1448491741, "answer_id": 33927778, "question_id": 33927421, "link": "https://stackoverflow.com/questions/33927421/c-i-have-50-else-if-statements-for-cards-is-there-a-way-to-make-it-shorter-or/33927778#33927778", "title": "C# I have 50+ else if statements for cards, is there a way to make it shorter or do it all at one go?", "body": "<p>So many non-OOP suggestions of how to handle this.  Here's my solution, which lets each object track itself, and will provide a simple way to shuffle the deck and get the image associated with each card (I've written a few card games).</p>\n\n<p>For storing the actual images, embed them into your project as resource files, named in a specific way:</p>\n\n<ul>\n<li>card_Club_1</li>\n<li>card_Club_2</li>\n<li>card_Club_3</li>\n<li>etc...</li>\n</ul>\n\n<p>Then, when you want a card image, you just combine the suit and value and request that resource name from the resource manager, as shown below.  This method requires a bit more setup and planning, but will give you <em>much</em> cleaner code.  You can even do all this in a separate project and then re-use the classes/resources by just referencing the DLL in the application where you want to have a deck of cards available.</p>\n\n<pre><code>enum Suit : uint\n{\n    Club = 0,\n    Heart,\n    Spade,\n    Diamond\n}\nclass Card\n{\n    public int\n        Value;\n    public Suit\n        Suit;\n\n    public System.Drawing.Image GetImage()\n    {\n        return System.Drawing.Image.FromStream(\n            global::cardLibraryProject.Properties.Resources.ResourceManager.GetStream(string.Format(\"card_{0}_{1}\", this.Suit, this.Value))\n        );\n    }\n}\nclass Deck\n{\n    System.Collections.ArrayList\n        _arr;\n\n    private Deck()\n    {\n        this._arr = new System.Collections.ArrayList(52);\n    }\n\n    void Add(Card crd)\n    {\n        if (!this._arr.Contains(crd))\n            this._arr.Add(crd);\n    }\n\n    public void Shuffle()\n    {\n        Random rnd = new Random(DateTime.Now.Millisecond);\n        System.Collections.ArrayList tmp1 = new System.Collections.ArrayList(this._arr);\n        System.Collections.ArrayList tmp2 = new System.Collections.ArrayList(52);\n        while (tmp1.Count &gt; 0)\n        {\n            int idx = rnd.Next(tmp1.Count);\n            tmp2.Add(tmp1[idx]);\n            tmp1.RemoveAt(idx);\n        }\n        this._arr = tmp2;\n        tmp1.Clear();\n        tmp2.Clear();\n    }\n\n    public static Deck CreateDeck()\n    {\n        Deck newDeck = new Deck();\n        for (int s = 0; s &lt; 4; s++)\n            for (int i = 0; i &lt; 13; i++)\n                newDeck.Add(new Card { Value = i, Suit = (Suit)s });\n        return newDeck;\n    }\n}\nclass Program\n{\n    public void Main(string[] args)\n    {\n        Deck cards = Deck.CreateDeck();\n        cards.Shuffle();\n\n        pictureBox1.Image = cards[0].GetImage();\n        // code to play game would go here.  Obviously, if you took\n        // my suggestion about creating a \"Cards\" library, then you\n        // wouldn't have a \"void Main\" at all, and this would\n        // all go in the application that was the actual game.\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2397, "user_id": 3720039, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/dc77388e4198a27e82147b72571d1016?s=128&d=identicon&r=PG&f=1", "display_name": "Taylor", "link": "https://stackoverflow.com/users/3720039/taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 33927778, "answer_count": 5, "score": 6, "last_activity_date": 1448491741, "creation_date": 1448489982, "last_edit_date": 1448490359, "question_id": 33927421, "link": "https://stackoverflow.com/questions/33927421/c-i-have-50-else-if-statements-for-cards-is-there-a-way-to-make-it-shorter-or", "title": "C# I have 50+ else if statements for cards, is there a way to make it shorter or do it all at one go?", "body": "<p>I have a form that loads and generates 7 different random numbers, from 1-13, 1 being Ace, and 13 being King. After generating 7 different random numbers, it puts each of those random numbers into the 7 picture boxes. I'm displaying the picture boxes using the if statement.</p>\n\n<p>It also cycles through an array of \"Spades, Hearts, Clubs and Diamonds\", 13 times.</p>\n\n<p>And My if statements are like:</p>\n\n<pre><code>if (cardNum == 1 &amp;&amp; cardType ==  \"Spades\")\n{\n    pictureBox1.Image = ace_of_spades;\n}\nelse if (cardNum == 1 &amp;&amp; cardType == \"Hearts\")\n{\n    pictureBox1.Image = ace_of_hearts;\n}\nelse if (...)\n{\n    //change picture box\n} //repeat it like 50 times\n</code></pre>\n\n<p>Is there a simple, easy way to pick 7 random cards and show them in the picture box?</p>\n\n<p>It is extremely time consuming, the way I do it.</p>\n"}, {"tags": ["c#", ".net", "entity-framework", "asp.net-mvc-4"], "comments": [{"owner": {"reputation": 1563, "user_id": 2637902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8147a0a0de99ced8d697310780c3aae?s=128&d=identicon&r=PG", "display_name": "Papa", "link": "https://stackoverflow.com/users/2637902/papa"}, "edited": false, "score": 0, "creation_date": 1448491547, "post_id": 33927415, "comment_id": 55616434, "body": "Do the foreign keys exist?"}, {"owner": {"reputation": 707, "user_id": 1697145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZsuvT.jpg?s=128&g=1", "display_name": "Tiedt Tech", "link": "https://stackoverflow.com/users/1697145/tiedt-tech"}, "reply_to_user": {"reputation": 1563, "user_id": 2637902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8147a0a0de99ced8d697310780c3aae?s=128&d=identicon&r=PG", "display_name": "Papa", "link": "https://stackoverflow.com/users/2637902/papa"}, "edited": false, "score": 0, "creation_date": 1448491750, "post_id": 33927415, "comment_id": 55616510, "body": "foreign keys exist in database @Papa"}, {"owner": {"reputation": 6266, "user_id": 5497207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34e185da0f69447ef588089e15e15198?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz Ozgul", "link": "https://stackoverflow.com/users/5497207/oguz-ozgul"}, "edited": false, "score": 0, "creation_date": 1448492334, "post_id": 33927415, "comment_id": 55616753, "body": "There are code first and database first approaches. My favorite though, is the <a href=\"https://msdn.microsoft.com/en-us/data/jj591620.aspx\" rel=\"nofollow noreferrer\">Read first</a> approach"}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1448496367, "post_id": 33927415, "comment_id": 55618073, "body": "@marlon.tiedt what is your expected db structure ? Can you say what type relationships are you trying to achieve ? One to many/one/zero ?"}, {"owner": {"reputation": 707, "user_id": 1697145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZsuvT.jpg?s=128&g=1", "display_name": "Tiedt Tech", "link": "https://stackoverflow.com/users/1697145/tiedt-tech"}, "reply_to_user": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1448497086, "post_id": 33927415, "comment_id": 55618254, "body": "relationships is one-to-one @Shyju"}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1448500489, "post_id": 33927415, "comment_id": 55619068, "body": "@marlon.tiedt One to one is not practical with foreign key to same table. Take a look at my answer."}], "answers": [{"comments": [{"owner": {"reputation": 707, "user_id": 1697145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZsuvT.jpg?s=128&g=1", "display_name": "Tiedt Tech", "link": "https://stackoverflow.com/users/1697145/tiedt-tech"}, "edited": false, "score": 0, "creation_date": 1448492662, "post_id": 33927858, "comment_id": 55616890, "body": "but this way I will have to duplicate classes?"}, {"owner": {"reputation": 1300, "user_id": 1080738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QveyE.jpg?s=128&g=1", "display_name": "Julius Depulla", "link": "https://stackoverflow.com/users/1080738/julius-depulla"}, "reply_to_user": {"reputation": 707, "user_id": 1697145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZsuvT.jpg?s=128&g=1", "display_name": "Tiedt Tech", "link": "https://stackoverflow.com/users/1697145/tiedt-tech"}, "edited": false, "score": 0, "creation_date": 1448493338, "post_id": 33927858, "comment_id": 55617165, "body": "No, you will not have duplicate classes. I have expanded on the code hope it helps.This is Code First Approach. Using EF conventions. Read this blog. <a href=\"http://tinyurl.com/p24ytvt\" rel=\"nofollow noreferrer\">tinyurl.com/p24ytvt</a>"}, {"owner": {"reputation": 28736, "user_id": 54981, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32378ae3a7538b84f48f59752ef6fe28?s=128&d=identicon&r=PG", "display_name": "SWeko", "link": "https://stackoverflow.com/users/54981/sweko"}, "edited": false, "score": 0, "creation_date": 1448493427, "post_id": 33927858, "comment_id": 55617189, "body": "You can have a property with the same name as the class in EF, if you have a self-referencing table."}, {"owner": {"reputation": 1300, "user_id": 1080738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QveyE.jpg?s=128&g=1", "display_name": "Julius Depulla", "link": "https://stackoverflow.com/users/1080738/julius-depulla"}, "reply_to_user": {"reputation": 28736, "user_id": 54981, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32378ae3a7538b84f48f59752ef6fe28?s=128&d=identicon&r=PG", "display_name": "SWeko", "link": "https://stackoverflow.com/users/54981/sweko"}, "edited": false, "score": 0, "creation_date": 1448493623, "post_id": 33927858, "comment_id": 55617257, "body": "@SWeko You cannot use the same type as a navigation property. Issue here is the navigation properties are wrong. Think of SQL database table, Can the same unique primary key be a foreign key in the same table? You need your foreign key to come from another table."}, {"owner": {"reputation": 1300, "user_id": 1080738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QveyE.jpg?s=128&g=1", "display_name": "Julius Depulla", "link": "https://stackoverflow.com/users/1080738/julius-depulla"}, "reply_to_user": {"reputation": 28736, "user_id": 54981, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32378ae3a7538b84f48f59752ef6fe28?s=128&d=identicon&r=PG", "display_name": "SWeko", "link": "https://stackoverflow.com/users/54981/sweko"}, "edited": false, "score": 0, "creation_date": 1448493940, "post_id": 33927858, "comment_id": 55617346, "body": "@SWeko The navigation properties are what Entity Framework use to determine the entity relational model between your POCOs and hence your database tables"}, {"owner": {"reputation": 707, "user_id": 1697145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZsuvT.jpg?s=128&g=1", "display_name": "Tiedt Tech", "link": "https://stackoverflow.com/users/1697145/tiedt-tech"}, "edited": false, "score": 0, "creation_date": 1448493979, "post_id": 33927858, "comment_id": 55617356, "body": "If I use only one reference to <code>Usuario</code>, it works. If you use two, gives the error"}, {"owner": {"reputation": 1300, "user_id": 1080738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QveyE.jpg?s=128&g=1", "display_name": "Julius Depulla", "link": "https://stackoverflow.com/users/1080738/julius-depulla"}, "edited": false, "score": 0, "creation_date": 1448494090, "post_id": 33927858, "comment_id": 55617382, "body": "If you do not want any entity relationship to any other classes or POCOs, you can delete those two properties with the virtual keyword"}, {"owner": {"reputation": 28736, "user_id": 54981, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32378ae3a7538b84f48f59752ef6fe28?s=128&d=identicon&r=PG", "display_name": "SWeko", "link": "https://stackoverflow.com/users/54981/sweko"}, "edited": false, "score": 0, "creation_date": 1448528884, "post_id": 33927858, "comment_id": 55628860, "body": "@coderealm - no, it can be self referencing - think parent / child relationship. I&#39;m actually looking at the exact same case (only configured with fluid api, not annotations)"}, {"owner": {"reputation": 1300, "user_id": 1080738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QveyE.jpg?s=128&g=1", "display_name": "Julius Depulla", "link": "https://stackoverflow.com/users/1080738/julius-depulla"}, "reply_to_user": {"reputation": 28736, "user_id": 54981, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32378ae3a7538b84f48f59752ef6fe28?s=128&d=identicon&r=PG", "display_name": "SWeko", "link": "https://stackoverflow.com/users/54981/sweko"}, "edited": false, "score": 0, "creation_date": 1448569320, "post_id": 33927858, "comment_id": 55651731, "body": "@Sweko Very clear distinction though  parent / child relationship rather than Parent/Parent or Child/Child Relationship which is self referencing"}, {"owner": {"reputation": 28736, "user_id": 54981, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/32378ae3a7538b84f48f59752ef6fe28?s=128&d=identicon&r=PG", "display_name": "SWeko", "link": "https://stackoverflow.com/users/54981/sweko"}, "edited": false, "score": 0, "creation_date": 1448575284, "post_id": 33927858, "comment_id": 55654048, "body": "@coderealm - the reference is actually Person/Person, and one of those persons is the parent, and one of the persons is the child. Take a look at Shyju&#39;s answer."}], "tags": [], "owner": {"reputation": 1300, "user_id": 1080738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QveyE.jpg?s=128&g=1", "display_name": "Julius Depulla", "link": "https://stackoverflow.com/users/1080738/julius-depulla"}, "is_accepted": false, "score": -1, "last_activity_date": 1448494342, "last_edit_date": 1448494342, "creation_date": 1448492129, "answer_id": 33927858, "question_id": 33927415, "link": "https://stackoverflow.com/questions/33927415/unable-to-determine-the-principal-end-of-an-association-between-the-types-enti/33927858#33927858", "title": "Unable to determine the principal end of an association between the types - Entity Framework error, class relationship between the same class", "body": "<p>The error is because the class name <code>Usuario</code> is exactly the same as the in the property <code>public virtual Usuario UsuarioAlt { get; set; }</code></p>\n\n<p>You cannot use the same type as a navigation property. The issue here is the navigation properties are wrong. Think of SQL database table, Can the same unique primary key be a foreign key in the same table? You need your foreign key to come from another table.</p>\n\n<p>The navigation properties are what Entity Framework use to determine the entity relational model between your POCOs and hence your database tables.</p>\n\n<p>You want a different class for the relation. If you have a second class with that name, use namespace aliasing, so the runtime can know the difference between the two class, now it is like a class referencing itself \n.</p>\n\n<p>You should write your model as below</p>\n\n<pre><code>public class Usuario\n{\n    [Key]\n    public int UsuarioID { get; set; }\n    public string Name { get; set; }\n    public int UsuCad { get; set; }        \n    public int UsuAlt { get; set; }\n    public virtual SomeSecondClass SomeSecondClass { get; set; }\n    public virtual SomeThirdClass SomeThirdClass { get; set; }\n}\n\npublic class SomeSecondClass \n{\n   public int SomeSecondClassID { get; set;}\n   // More properties\n}\n\npublic class SomeThirdClass \n{\n   public int SomeThirdClassID { get; set;}\n   // More properties\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 707, "user_id": 1697145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZsuvT.jpg?s=128&g=1", "display_name": "Tiedt Tech", "link": "https://stackoverflow.com/users/1697145/tiedt-tech"}, "is_accepted": true, "score": 4, "last_activity_date": 1448499859, "creation_date": 1448499859, "answer_id": 33929026, "question_id": 33927415, "link": "https://stackoverflow.com/questions/33927415/unable-to-determine-the-principal-end-of-an-association-between-the-types-enti/33929026#33929026", "title": "Unable to determine the principal end of an association between the types - Entity Framework error, class relationship between the same class", "body": "<h3>reply</h3>\n\n<p>After searching a lot, I found a tip about using <code>InverseProperty</code>\nThen the code looks like this. This property <code>ForeignKey</code> It is to mount the link and property <code>InverseProperty</code> for to inform that the field depends on this other camp, reversing the  foreign key.</p>\n\n<p>Thanks for the help</p>\n\n<pre><code>public class Usuario\n{\n    [Key]\n    public int UsuarioID { get; set; }\n    public string Nome { get; set; }\n    public int UsuCad { get; set; }        \n    public int UsuAlt { get; set; }\n\n    [ForeignKey(\"UsuCad\")]\n    [InverseProperty(\"UsuarioID\")]\n    public virtual Usuario UsuarioCad { get; set; }\n    [ForeignKey(\"UsuAlt\")]\n    [InverseProperty(\"UsuarioID\")]\n    public virtual Usuario UsuarioAlt { get; set; }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "is_accepted": false, "score": 3, "last_activity_date": 1448500390, "creation_date": 1448500390, "answer_id": 33929099, "question_id": 33927415, "link": "https://stackoverflow.com/questions/33927415/unable-to-determine-the-principal-end-of-an-association-between-the-types-enti/33929099#33929099", "title": "Unable to determine the principal end of an association between the types - Entity Framework error, class relationship between the same class", "body": "<p>I am not 100% sure what kind of db schema you are trying to achieve here. My assumption is that you want to have foreign key to the same table. In your comment, you said you want a one to one relation ship. Technically this is not possible. Because when you try to insert the first record, You need to provide a value for your foreign key column. The value should be an Id of an existing record. Wait... We don't have any records yet ! </p>\n\n<p>Since 1-1 is not really practical here, You should be doing a one to zero/one relationship. That means your foreign key column should be <strong>nullable</strong> so that you can insert your first record with <code>NULL</code> value in your foreign key column.</p>\n\n<p>I am having a little hard time understanding your model &amp; property names. So i am going to use a general class/table which everyone can understand, but with your specific requirement ( Self reference foreign key)</p>\n\n<p><em>I am not using data annotations, I am using Fluent API</em></p>\n\n<p>The silly business requirement/assumption is that :</p>\n\n<ul>\n<li>One <strong>Person</strong> may or may not have a <strong>Parent</strong> </li>\n<li>One <strong>Person</strong> may or may not have a <strong>Kid</strong> </li>\n</ul>\n\n<p>So our entity class will look like this</p>\n\n<pre><code>public class Person\n{\n    public int Id { set; get; }\n    public string Name { set; get; }\n    public virtual Person Parent { set; get; }\n    public virtual Person Kid { set; get; }    \n}\n</code></pre>\n\n<p>Now to use fluent API to control the relationships, We need to go to our DBContext class and override the <code>OnModelCreating</code> method</p>\n\n<pre><code>public class MyDbContext : DbContext\n{\n    public MyDbContext() : base(\"MyConnectionStringName\") { }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {    \n        modelBuilder.Entity&lt;Person&gt;().HasKey(d =&gt; d.Id)\n            .HasOptional(m =&gt; m.Kid).WithOptionalPrincipal(d=&gt;d.Parent);\n\n        base.OnModelCreating(modelBuilder);\n    }   \n\n    public DbSet&lt;Person&gt; Persons { set; get; }\n}\n</code></pre>\n\n<p>This will create the table with 3 Columns, <strong>ID</strong>, <strong>Name</strong> and <strong>Parent_Id</strong> (NULLABLE, Foreign Key relationship to <code>ID</code> of same table)</p>\n\n<p>I can insert data like this</p>\n\n<pre><code>var db = new MyDbContext();\n\nvar myMom = new Person {Name = \"Indira\"};\nvar me = new Person {Name = \"Shyju\", Parent = myMom};\nvar myDaughter = new Person { Name = \"Gauri\", Parent = me};\n\ndb.Persons.Add(myMom);\ndb.Persons.Add(me);\ndb.Persons.Add(myDaughter);\n\ndb.SaveChanges();\n</code></pre>\n\n<p>And you will have your data with ParentId column having a foreign key to the ID column of the same table.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0iIDw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0iIDw.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 707, "user_id": 1697145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZsuvT.jpg?s=128&g=1", "display_name": "Tiedt Tech", "link": "https://stackoverflow.com/users/1697145/tiedt-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3245, "favorite_count": 3, "accepted_answer_id": 33929026, "answer_count": 3, "score": 6, "last_activity_date": 1448502100, "creation_date": 1448489962, "last_edit_date": 1448502100, "question_id": 33927415, "link": "https://stackoverflow.com/questions/33927415/unable-to-determine-the-principal-end-of-an-association-between-the-types-enti", "title": "Unable to determine the principal end of an association between the types - Entity Framework error, class relationship between the same class", "body": "<p>Have the class below, and try to look for records in the database returns error. \nUsing C #, MVC 4, Entity Framework 4 and SQL Server 2012 database.</p>\n\n<h3>Error</h3>\n\n<pre><code>Unable to determine the principal end of an association between the types 'FlexApp.Models.Model.Usuario' and 'FlexApp.Models.Model.Usuario'. \n\nThe principal end of this association must be explicitly configured using either the relationship fluent API or data annotations.\n</code></pre>\n\n<h3>Class</h3>\n\n<pre><code>public class Usuario\n{\n    [Key]\n    public int UsuarioID { get; set; }\n    public string Nome { get; set; }\n    public int UsuCad { get; set; }        \n    public int UsuAlt { get; set; }\n\n    [ForeignKey(\"UsuCad\")]\n    public virtual Usuario UsuarioCad { get; set; }\n    [ForeignKey(\"UsuAlt\")]\n    public virtual Usuario UsuarioAlt { get; set; }\n}\n</code></pre>\n\n<h3>DataBase FK</h3>\n\n<pre><code>alter table USUARIO add constraint USUARIO_fk01 foreign KEY(UsuCad) REFERENCES USUARIO(UsuarioID);\nalter table USUARIO add constraint USUARIO_fk02 foreign KEY(UsuAlt) REFERENCES USUARIO(UsuarioID);\n</code></pre>\n"}, {"tags": ["javascript", "c#", "json", "ajax", "asp.net-mvc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1448489979, "post_id": 33927392, "comment_id": 55615804, "body": "<code>data: { handle: &quot;MyHandle&quot;, BlobName: &quot;blob&quot;, NewName: &quot;new&quot; },</code>"}, {"owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "edited": false, "score": 0, "creation_date": 1448490098, "post_id": 33927392, "comment_id": 55615853, "body": "Well thanks, but I need a generalized solution.  This is a simplified model for the purposes of this question.... I would like to know how to pass custom classes properly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1448490217, "post_id": 33927392, "comment_id": 55615909, "body": "You pass the custom class by passing the name/value pairs of its properties (as I showed)"}, {"owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "edited": false, "score": 0, "creation_date": 1448490462, "post_id": 33927392, "comment_id": 55616008, "body": "Thanks, but in the actual use case, I am getting an object in response to a previous ajax call that the server is expecting to get back as a single bundle called &quot;businessData&quot;.  Although my example in this question shows me constructing from whole cloth in Javascript, that isn&#39;t the actual source in real life.  In real life, Javascript merely has an object that it knows it wants to ship up to the server, and it knows the server should understand it because it was provided by the server in the first place."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 1, "creation_date": 1448490579, "post_id": 33927392, "comment_id": 55616058, "body": "Then show your real case!"}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1448491476, "post_id": 33927392, "comment_id": 55616403, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/8517071/send-json-data-via-post-ajax-and-receive-json-response-from-controller-mvc\">Send JSON data via POST (ajax) and receive json response from Controller (MVC)</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 1, "creation_date": 1448492262, "post_id": 33927392, "comment_id": 55616724, "body": "Your still not telling us what the real use case is. Best guess is that your first ajax call is returning a <code>BusinessModel</code> model object, and assuming you have assigned it to <code>var bd</code>, then you can just add additional properties - <code>db.handle = &#39;MyHandle&#39;;</code> and then post back the model and the value of <code>handle</code> using <code>data: db;</code>"}, {"owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "edited": false, "score": 0, "creation_date": 1448494824, "post_id": 33927392, "comment_id": 55617645, "body": "Well, this is a good solution and it works for me right now.  If you had posted as the answer, I would have marked it as such.  So Thank you!  There is a longer term issue in that in the future, we will want to be providing more than a single instance in the same ajax call, and heeded by the same controller action.  So the problem will re-arise, I believe.  As those classes could have properties with the same name, we could be back in the same soup.  But for now I&#39;m off and running.  THANKS."}], "answers": [{"tags": [], "owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1456220582, "last_edit_date": 1456220582, "creation_date": 1448495045, "answer_id": 33928368, "question_id": 33927392, "link": "https://stackoverflow.com/questions/33927392/how-do-i-get-pass-a-populated-custom-class-from-javascript-through-ajax-to-net/33928368#33928368", "title": "How do I get pass a populated custom class from javascript through AJAX to .NET MVC app?", "body": "<p>Please see Stephan Muecke's comment.  He provided the answer that works at least for now.</p>\n"}], "owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 707, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1456220707, "creation_date": 1448489849, "last_edit_date": 1456220707, "question_id": 33927392, "link": "https://stackoverflow.com/questions/33927392/how-do-i-get-pass-a-populated-custom-class-from-javascript-through-ajax-to-net", "title": "How do I get pass a populated custom class from javascript through AJAX to .NET MVC app?", "body": "<p>I have the following .net class in c#:</p>\n\n<pre><code>public class BusinessModel\n{\n    public string BlobName { get; set; }\n    public string NewName { get; set; }\n}\n</code></pre>\n\n<p>And I have the following action in my MVC Ajax Controller:</p>\n\n<pre><code>[HttpPost]\npublic ActionResult DoBusiness(string handle, BusinessModel businessData)\n{\n    // Do stuff with the business data.\n}\n</code></pre>\n\n<p>First I try to use the following Javascript code to invoke this:</p>\n\n<pre><code>var bd = JSON.stringify({ BlobName: \"blob\", NewName: \"new\" });\n\n$.ajax({\n    type: \"POST\",\n    url: \"/Ajax/DoBusiness\",\n    data: { handle: \"MyHandle\", businessData: bd },\n    success: businessComplete,\n    error: businessFailed\n});\n</code></pre>\n\n<p>And in this case, using fiddler to view, the following is how the data is rendered on the request:</p>\n\n<blockquote>\n  <p>handle=MyHandle&amp;businessData=%7B%22BlobName%22%3A%22blob%22%2C%22NewName%22%3A%22new%22%7D</p>\n</blockquote>\n\n<p>Which is the following decoded:</p>\n\n<blockquote>\n  <p>handle=MyHandle&amp;businessData={\"BlobName\":\"blob\",\"NewName\":\"new\"}</p>\n</blockquote>\n\n<p>But when I use the Visual Studio debugger to look at the values actually passed to the controller action, the value of the parameter \"handle\" is \"MyHandle\" as expected, but the value of the parameter \"businessData\" is null.</p>\n\n<p>Now I alter the Javascript code to read as follows (merely removing the JSON.stringify call):</p>\n\n<pre><code>var bd = { BlobName: \"blob\", NewName: \"new\" };\n\n$.ajax({\n    type: \"POST\",\n    url: \"/Ajax/DoBusiness\",\n    data: { handle: \"MyHandle\", businessData: bd },\n    success: businessComplete,\n    error: businessFailed\n});\n</code></pre>\n\n<p>In this case, the data (shown by fiddler) is rendered in the request as:</p>\n\n<blockquote>\n  <p>handle=MyHandle&amp;businessData%5BBlobName%5D=blob&amp;businessData%5BNewName%5D=new</p>\n</blockquote>\n\n<p>Which is the following decoded:</p>\n\n<blockquote>\n  <p>handle=MyHandle&amp;businessData[BlobName]=blob&amp;businessData[NewName]=new</p>\n</blockquote>\n\n<p>And in this case, the Visual Studio debugger still shows that \"handle\" is set to \"MyHandle\" as expected, but instead of being null, the \"businessData\" parameter is filled with an actual instance, but both properties \"BlobName\" and \"NewName\" are set to null.</p>\n\n<p><strong>Finally the question:</strong> What am I doing wrong?  How can I actually get that class properly populated in the controller action?</p>\n\n<p><strong>EDIT In response to comment on possible duplicate:</strong>\nThe possible duplicate, titled \"Send JSON data via POST (ajax) and receive json response from Controller (MVC)\" specifically addresses how to send instances of models bound with MVC binding.  My question is more not related to an object that might be MVC-bound.  I am curious about how to populate ANY object, that might be arbitrarily provided.</p>\n\n<p><strong>EDIT In response to Stephen's comment:</strong>\nThis is a simplified scenario.  The real-life actual use-case has an overlapping set of Ajax calls, and this one is called in response to a previous one which has passed along an arbitrary object constructed on the server which it wants back in the subsequent call (this example).  Providing that fully-fleshed real-life use case would, in my opinion, make this question unduly long, so pardon the simplification, and I hope this explanation will serve to appropriately frame the context.</p>\n"}, {"tags": ["c#", "console-application"], "comments": [{"owner": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "edited": false, "score": 0, "creation_date": 1448489784, "post_id": 33927325, "comment_id": 55615719, "body": "Are you running via Ctrl+F5?"}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1448489823, "post_id": 33927325, "comment_id": 55615733, "body": "None writes for you &quot;Press any key to continue...&quot; and waits for any key. You are in charge of what your code does"}, {"owner": {"reputation": 462, "user_id": 5531716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d13a93b5c890662ee4578a71b4fa8ec?s=128&d=identicon&r=PG&f=1", "display_name": "Baskar Rao", "link": "https://stackoverflow.com/users/5531716/baskar-rao"}, "edited": false, "score": 0, "creation_date": 1448489826, "post_id": 33927325, "comment_id": 55615736, "body": "Include Console.ReadLine() after WriteLine() as the console window does not wait, it closes. You need to write Console.WriteLine(&quot;Press any key to continue....&quot;) followed by Console.ReadLine()"}, {"owner": {"reputation": 11, "user_id": 5606153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013a5a910a07aa02b7ea93b748afb317?s=128&d=identicon&r=PG&f=1", "display_name": "x86_64", "link": "https://stackoverflow.com/users/5606153/x86-64"}, "reply_to_user": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "edited": false, "score": 0, "creation_date": 1448489850, "post_id": 33927325, "comment_id": 55615749, "body": "@Chase: Yes. Ctrl+F5 :  does not show anything F5: Printing shows all outputs to console"}, {"owner": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "edited": false, "score": 0, "creation_date": 1448489927, "post_id": 33927325, "comment_id": 55615789, "body": "Try add Console.ReadKey();  after your Console.WriteLine(&quot;Hello!!!&quot;);"}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 2, "creation_date": 1448489941, "post_id": 33927325, "comment_id": 55615793, "body": "Add <code>Console.WriteLine(&quot;Press any key to continue...&quot;); Console.ReadKey(true);</code> at the end. Programs do what you ask them to do, unless you explicitly say &quot;wait for user input, then exit&quot; it will exit immediately after running the last statement."}, {"owner": {"reputation": 11, "user_id": 5606153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013a5a910a07aa02b7ea93b748afb317?s=128&d=identicon&r=PG&f=1", "display_name": "x86_64", "link": "https://stackoverflow.com/users/5606153/x86-64"}, "reply_to_user": {"reputation": 2435, "user_id": 2313116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vCE0z.jpg?s=128&g=1", "display_name": "ivamax9", "link": "https://stackoverflow.com/users/2313116/ivamax9"}, "edited": false, "score": 0, "creation_date": 1448490072, "post_id": 33927325, "comment_id": 55615839, "body": "@Chase:  I tried that as well...no luck. The Ctrl+F5 just does not print anything.  @Steve/@Ron:  You do not have to print &quot;Press any key to continue...&quot; to see this. Console applicaions always show this in the end of your application."}, {"owner": {"reputation": 688, "user_id": 363677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/361Uo.jpg?s=128&g=1", "display_name": "Mike U", "link": "https://stackoverflow.com/users/363677/mike-u"}, "edited": false, "score": 0, "creation_date": 1448490373, "post_id": 33927325, "comment_id": 55615974, "body": "@x86_64 the &quot;Press any key to continue&quot; being automatic is news to me, but I&#39;ve not used 2015 much at all.  Reading your description/comments, are you saying that your output is coming out on the Command/Immediate panel of Visual Studio, rather than the visible shell?"}, {"owner": {"reputation": 11, "user_id": 5606153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013a5a910a07aa02b7ea93b748afb317?s=128&d=identicon&r=PG&f=1", "display_name": "x86_64", "link": "https://stackoverflow.com/users/5606153/x86-64"}, "reply_to_user": {"reputation": 688, "user_id": 363677, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/361Uo.jpg?s=128&g=1", "display_name": "Mike U", "link": "https://stackoverflow.com/users/363677/mike-u"}, "edited": false, "score": 0, "creation_date": 1448490797, "post_id": 33927325, "comment_id": 55616144, "body": "@Mike:  Build my code in VS 2010, run it using Ctrl+F5, you will see the &quot;Press...&quot; in the end.   This was always the case running your build from VS (Ctrl+F5):   <a href=\"http://stackoverflow.com/questions/1103402/how-does-vs-compile-console-applications-to-show-press-any-key-to-continue\" title=\"how does vs compile console applications to show press any key to continue\">stackoverflow.com/questions/1103402/&hellip;</a>"}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1448505326, "post_id": 33927325, "comment_id": 55620219, "body": "@x86_64 I&#39;ve been writing .NET applications since 1.0 came out (about 13 years ago) and C++/VB software much longer than that. I guarantee you that the &quot;halting&quot; is not automatic, and your own code proves it."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5606153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013a5a910a07aa02b7ea93b748afb317?s=128&d=identicon&r=PG&f=1", "display_name": "x86_64", "link": "https://stackoverflow.com/users/5606153/x86-64"}, "edited": false, "score": 0, "creation_date": 1448491400, "post_id": 33927424, "comment_id": 55616366, "body": "I understand the framework does not do halting. I should have framed my question better. I was referring to running the application from Visual Studio using Ctrl+F5. That always shows &quot;Press any key to continue...&quot;. Switching to VS 2015 I seem to be missing that. I always saw that feature in VS 2010."}], "tags": [], "owner": {"reputation": 12251, "user_id": 1199684, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d997a71f1df34149c9166926baad0d37?s=128&d=identicon&r=PG", "display_name": "bytecode77", "link": "https://stackoverflow.com/users/1199684/bytecode77"}, "is_accepted": false, "score": 2, "last_activity_date": 1448490002, "creation_date": 1448490002, "answer_id": 33927424, "question_id": 33927325, "link": "https://stackoverflow.com/questions/33927325/visual-studio-2015-console-app-does-not-print-anything/33927424#33927424", "title": "Visual Studio 2015 Console app does not print anything", "body": "<p>.NET Framework doesn't do halting <em>for</em> you. You have to do it yourself, or your console will immediately close.</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        Console.WriteLine(\"Hello!!!\");\n        Console.ReadKey();\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5607934, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/abca4b38e9372121ee37ec161058a4da?s=128&d=identicon&r=PG", "display_name": "x86_64", "link": "https://stackoverflow.com/users/5607934/x86-64"}, "is_accepted": false, "score": -1, "last_activity_date": 1448532108, "creation_date": 1448532108, "answer_id": 33935622, "question_id": 33927325, "link": "https://stackoverflow.com/questions/33927325/visual-studio-2015-console-app-does-not-print-anything/33935622#33935622", "title": "Visual Studio 2015 Console app does not print anything", "body": "<p>@RonBeyer:<br>\n* Please use my above code in a simple console application</p>\n\n<ul>\n<li><p>Build it</p></li>\n<li><p>Run it as Ctrl + F5</p></li>\n<li><p>You will see this:</p></li>\n</ul>\n\n<p><a href=\"http://i.stack.imgur.com/WqLtO.jpg\" rel=\"nofollow\">Output from above console app</a></p>\n\n<p>I am able to see the above using VS2012 Professional but not usnig VS2015 Professional. </p>\n\n<p>Thank you.\nx86_64</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 4204860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9876fa3fc389e03999c31adf17f1d7?s=128&d=identicon&r=PG&f=1", "display_name": "Paysha Yugen", "link": "https://stackoverflow.com/users/4204860/paysha-yugen"}, "is_accepted": false, "score": 0, "last_activity_date": 1450165261, "last_edit_date": 1495541747, "creation_date": 1450098778, "answer_id": 34267987, "question_id": 33927325, "link": "https://stackoverflow.com/questions/33927325/visual-studio-2015-console-app-does-not-print-anything/34267987#34267987", "title": "Visual Studio 2015 Console app does not print anything", "body": "<p>What kind of antivirus software you have - Avast?\nI ran into the same problem with Console Application starting from VS2015.\nI also noticed, that it creates a couple of processes, that can't be killed with Task Manager.</p>\n\n<p>@MadDoctor5813 <a href=\"https://stackoverflow.com/questions/34215983/c-sharp-application-built-with-visual-studio-2015-refuses-to-start\">here</a> ran into the same kind of problem and disabling antivirus (Avast in his and my case) solved to problem.</p>\n\n<p>Avast usually shows a message, when blocking or checking VS projects, but this time it doesn't warn a user, so that's why it's not really obvious, what's going on.</p>\n"}], "owner": {"reputation": 11, "user_id": 5606153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013a5a910a07aa02b7ea93b748afb317?s=128&d=identicon&r=PG&f=1", "display_name": "x86_64", "link": "https://stackoverflow.com/users/5606153/x86-64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1241, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1450165261, "creation_date": 1448489616, "last_edit_date": 1448490032, "question_id": 33927325, "link": "https://stackoverflow.com/questions/33927325/visual-studio-2015-console-app-does-not-print-anything", "title": "Visual Studio 2015 Console app does not print anything", "body": "<p>I have been using Visual Studio 2015 Professional for quite some time now, primarily for WPF and Console based apps. Very recently I have noticed that my Console based apps just stopped printing anything to console. </p>\n\n<p>To test this I wrote a very simple console application:</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        Console.WriteLine(\"Hello!!!\");\n    }\n}\n</code></pre>\n\n<p>When I run the above code, I was expecting the see a black console with the below statements:</p>\n\n<pre><code>Hello!!!\nPress any key to continue...\n</code></pre>\n\n<p>I just see a black console with cursor blinking... nothing else.</p>\n\n<p>My laptop is Windows 7 64 bit and the VS 2015 Pro is 32 bit. I run using <strong>\"Any CPU\"</strong> configuration. This issue is driving me nuts!</p>\n\n<p>The interesting thing is, when I run in debug mode all I can see output printing on to console.</p>\n\n<p>How do I get things printing back in console?</p>\n"}, {"tags": ["c#", "winforms", "crystal-reports"], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 1446295, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9d63cfe3a7eb3bda0ef4994bd3ae0a0?s=128&d=identicon&r=PG", "display_name": "mvaculisteanu", "link": "https://stackoverflow.com/users/1446295/mvaculisteanu"}, "is_accepted": false, "score": 0, "last_activity_date": 1468568357, "creation_date": 1468568357, "answer_id": 38390482, "question_id": 33927204, "link": "https://stackoverflow.com/questions/33927204/crystalreports-system-argumentexception-resource-defaultanimation-gif-cannot/38390482#38390482", "title": "CrystalReports: System.ArgumentException: Resource &#39;DefaultAnimation.gif&#39; cannot be found in class", "body": "<p>I encountered the same problem when I wanted to inherit the CrystalReportViewer.</p>\n\n<p>I just added a image named 'DefaultAnimation.gif' in the project and set it's build action to Embedded Resource (right click on image - > properties)</p>\n"}], "owner": {"reputation": 2919, "user_id": 1112819, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/1Rm8x.png?s=128&g=1", "display_name": "devfunkd", "link": "https://stackoverflow.com/users/1112819/devfunkd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468568357, "creation_date": 1448489043, "last_edit_date": 1448490335, "question_id": 33927204, "link": "https://stackoverflow.com/questions/33927204/crystalreports-system-argumentexception-resource-defaultanimation-gif-cannot", "title": "CrystalReports: System.ArgumentException: Resource &#39;DefaultAnimation.gif&#39; cannot be found in class", "body": "<p>I am trying to use the CrystalReports library from <a href=\"https://www.nuget.org/packages/CrystalDecisions.Windows.Forms/\" rel=\"nofollow\">https://www.nuget.org/packages/CrystalDecisions.Windows.Forms/</a> but I keep getting the following exception when I attempt to open a report in my winforms application.</p>\n\n<p>I've searched online and a few people have talked about extracting and embedding the missing resource but how do I do that and where/how do I find it/get it?      </p>\n\n<pre><code>  System.ArgumentException: Resource 'DefaultAnimation.gif' cannot be found in class 'UserInterface.CustomControls.MyReportViewer'.\n       at System.Drawing.Bitmap..ctor(Type type, String resource)\n       at CrystalDecisions.Windows.Forms.CrystalReportViewer.InitReportViewer()\n       at CrystalDecisions.Windows.Forms.CrystalReportViewer..ctor()\n       at UserInterface.CustomControls.MyReportViewer..ctor() in C:\\Projects\\UserInterface\\CustomControls\\MyReportViewer.cs:line 22\n       at UserInterface.Controls.ReportingControl.FrmReportViewer.InitializeComponent() in C:\\Projects\\UserInterface\\Controls\\ReportingControl\\FrmReportViewer.cs:line 60\n       at UserInterface.Controls.ReportingControl.FrmReportViewer..ctor(Report reportToPrint) in C:\\Projects\\UserInterface\\Controls\\ReportingControl\\FrmReportViewer.cs:line 247\n       at UserInterface.Controls.ReportingControl.FrmReports.OnCustomCommandClicked(FormCommand commandClicked) in C:\\Projects\\UserInterface\\Controls\\ReportingControl\\FrmReports.cs:line 310\n       at  UserInterface.Controls.ReportingControl.FrmReports.gridEXReport_DoubleClick(Object sender, EventArgs e) in C:\\Projects\\UserInterface\\Controls\\ReportingControl\\FrmReports.cs:line 395\n       at System.Windows.Forms.Control.OnDoubleClick(EventArgs e)\n       at Janus.Windows.GridEX.GridEX.OnDoubleClick(EventArgs e)\n       at Janus.Windows.GridEX.GridEX.OnMouseUp(MouseEventArgs e)\n       at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\n       at System.Windows.Forms.Control.WndProc(Message&amp; m)\n       at System.Windows.Forms.ScrollableControl.WndProc(Message&amp; m)\n       at System.Windows.Forms.ContainerControl.WndProc(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\n       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\n       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\n</code></pre>\n"}, {"tags": ["c#", "list"], "comments": [{"owner": {"reputation": 33608, "user_id": 1651298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sy8Lv.jpg?s=128&g=1", "display_name": "Giorgi Nakeuri", "link": "https://stackoverflow.com/users/1651298/giorgi-nakeuri"}, "edited": false, "score": 1, "creation_date": 1448489236, "post_id": 33927193, "comment_id": 55615501, "body": "Search for deep copy, deep clone"}, {"owner": {"reputation": 11630, "user_id": 5149474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atyzF.jpg?s=128&g=1", "display_name": "Eser", "link": "https://stackoverflow.com/users/5149474/eser"}, "edited": false, "score": 3, "creation_date": 1448489288, "post_id": 33927193, "comment_id": 55615521, "body": "<a href=\"http://codeidol.com/csharp/csharpckbk2/Classes-and-Structures/Building-Cloneable-Classes/\" rel=\"nofollow noreferrer\">codeidol.com/csharp/csharpckbk2/Classes-and-Structures/&hellip;</a>"}, {"owner": {"reputation": 328, "user_id": 3375577, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93e79b819c6c8197e3cbba4db56ac0f6?s=128&d=identicon&r=PG&f=1", "display_name": "dutycorpse", "link": "https://stackoverflow.com/users/3375577/dutycorpse"}, "edited": false, "score": 0, "creation_date": 1448489321, "post_id": 33927193, "comment_id": 55615534, "body": "<a href=\"http://stackoverflow.com/questions/13758044/copying-a-list-to-another-new-list-should-not-reference-to-old-list\" title=\"copying a list to another new list should not reference to old list\">stackoverflow.com/questions/13758044/&hellip;</a>"}, {"owner": {"reputation": 590, "user_id": 484572, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/caa6ffcd00097e9055706b570aded53d?s=128&d=identicon&r=PG", "display_name": "Noel", "link": "https://stackoverflow.com/users/484572/noel"}, "edited": false, "score": 0, "creation_date": 1448489322, "post_id": 33927193, "comment_id": 55615535, "body": "<a href=\"http://stackoverflow.com/questions/1952185/how-do-i-copy-items-from-list-to-list-without-foreach\" title=\"how do i copy items from list to list without foreach\">stackoverflow.com/questions/1952185/&hellip;</a>"}, {"owner": {"reputation": 462, "user_id": 5531716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d13a93b5c890662ee4578a71b4fa8ec?s=128&d=identicon&r=PG&f=1", "display_name": "Baskar Rao", "link": "https://stackoverflow.com/users/5531716/baskar-rao"}, "edited": false, "score": 0, "creation_date": 1448489498, "post_id": 33927193, "comment_id": 55615602, "body": "You need to implement Prototype Design Pattern to solve your issue to avoid changes in one list not to affect another list."}], "answers": [{"tags": [], "owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "is_accepted": false, "score": 3, "last_activity_date": 1448489688, "last_edit_date": 1495535377, "creation_date": 1448489370, "answer_id": 33927254, "question_id": 33927193, "link": "https://stackoverflow.com/questions/33927193/how-to-copy-one-list-to-another-in-c/33927254#33927254", "title": "How to copy one list to another in C#", "body": "<p>You are performing a <a href=\"https://stackoverflow.com/questions/184710/what-is-the-difference-between-a-deep-copy-and-a-shallow-copy\">shallow copy of the list, you need to perform a deep copy</a> of it. The list are two separate lists, but the items in the list are shared between them. If you edit a item, not the list itself, the edit will show up in both.</p>\n\n<p>You will need to provide some method to copy <code>Address</code> when making the new list.</p>\n\n<pre><code>employeeAddressDataToSaveReturn = new List&lt;Address&gt;(employeeAddressDataToSave.Select(x=&gt;x.Copy());`\n</code></pre>\n\n<p>This now calls the <code>Address.Copy()</code> method (which you will need to write) and it will return a copy of itself.</p>\n\n<p>Here is a quick example, you did not show <code>Address</code> so I will have to make one up</p>\n\n<pre><code>class Address\n{\n    public string Street {get;set;}\n    public string Zip {get;set;}\n\n    public Address Copy()\n    {\n        var result = new Address();\n        result.Street = this.Street;\n        retult.Zip = this.Zip;\n        return result;\n    }\n}\n</code></pre>\n\n<p>If <code>Address</code> contains nested <a href=\"https://stackoverflow.com/questions/4274193/what-is-the-difference-between-a-mutable-and-immutable-string-in-c\">mutable</a> classes you will need to write a <code>Copy()</code> method for them too and call <code>Copy()</code> recursively.</p>\n"}, {"tags": [], "owner": {"reputation": 9933, "user_id": 678410, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/57083a995514ca4e66842dec135edd6f?s=128&d=identicon&r=PG", "display_name": "Anders Forsgren", "link": "https://stackoverflow.com/users/678410/anders-forsgren"}, "is_accepted": false, "score": 1, "last_activity_date": 1448489799, "creation_date": 1448489799, "answer_id": 33927373, "question_id": 33927193, "link": "https://stackoverflow.com/questions/33927193/how-to-copy-one-list-to-another-in-c/33927373#33927373", "title": "How to copy one list to another in C#", "body": "<p>Your lists don't contain address data items, they contain <em>references</em> to address data items. The lists are separate, meaning that if you add a reference to an address to list2, it is not added to list1:</p>\n\n<pre><code>var list1 = GetList1();\nConsole.WriteLine(list1.Count); // 3\nvar list2 = new List(list1);\nlist2.Add(new AddressData(\"John Doe\", \"Foo street\", \"12345\"); \nConsole.WriteLine(list1.Count); // 3\nConsole.WriteLine(list2.Count); // 4\n</code></pre>\n\n<p>However if you edit an <em>item</em> in list1, you will also modify it in the other list</p>\n\n<pre><code>Console.WriteLine(list1[2].Name); // Bob\nConsole.WriteLine(list2[2].Name); // Bob\nlist2[2].Name = \"Jim\";\nConsole.WriteLine(list1[2].Name); // Jim &lt;-- Changed\nConsole.WriteLine(list2[2].Name); // Jim \n</code></pre>\n\n<p>If you want to make a deep copy, implement a copy/clone method on your address class, and copy the whole list, item by item</p>\n\n<pre><code>list2 = list1.Select(a =&gt; a.Copy()).ToList();\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5285471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b205288c99102d877751d6e4b7c9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Ninja.J", "link": "https://stackoverflow.com/users/5285471/ninja-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14061, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448490157, "creation_date": 1448488976, "last_edit_date": 1448489103, "question_id": 33927193, "link": "https://stackoverflow.com/questions/33927193/how-to-copy-one-list-to-another-in-c", "title": "How to copy one list to another in C#", "body": "<p>I have a list that I want to copy to another list.</p>\n\n<p>I have 'employeeAddressDataToSave' List and I want to copy this list to 'employeeAddressDataToSaveReturn' List.</p>\n\n<p>I'm using the following code to do that. After I set this, further down the road, I'm updating employeeAddressDataToSave List. Those changes are automatically getting to 'employeeAddressDataToSaveReturn' list. I don't want my employeeAddressDataToSaveReturn list to be updated with changes to employeeAddressDataToSave . Is there a way to do that?</p>\n\n<pre><code>employeeAddressDataToSaveReturn = new List&lt;Address&gt;(employeeAddressDataToSave);\n</code></pre>\n"}, {"tags": ["c#", "algorithm", "sorting", "mergesort"], "answers": [{"tags": [], "owner": {"reputation": 12251, "user_id": 1199684, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d997a71f1df34149c9166926baad0d37?s=128&d=identicon&r=PG", "display_name": "bytecode77", "link": "https://stackoverflow.com/users/1199684/bytecode77"}, "is_accepted": false, "score": 0, "last_activity_date": 1448489804, "creation_date": 1448489804, "answer_id": 33927375, "question_id": 33927184, "link": "https://stackoverflow.com/questions/33927184/merge-sort-implementation-query/33927375#33927375", "title": "merge sort implementation query", "body": "<p>Taking the risk of not answering the question like you want it, I would suggest <strong>LINQ</strong>. This is not merge sort in particular, but rather a concatenation of two arrays and then sorting.</p>\n\n<p>If your array isn't so big that performance matters, you might want to go for this approach, because it's simple and less code (which is always good).</p>\n\n<pre><code>int[] arr1 = new[] { 1, 2, 3, 7, 8, 10 };\nint[] arr2 = new[] { 4, 6, 9, 12, 15 };\n\nint[] merged = arr1.Concat(arr2).OrderBy(n =&gt; n).ToArray();\n</code></pre>\n\n<p>Furthermore, I post this if it is interesting for others.</p>\n"}, {"comments": [{"owner": {"reputation": 396, "user_id": 4712199, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Bm3KN.jpg?s=128&g=1", "display_name": "JH_Dev", "link": "https://stackoverflow.com/users/4712199/jh-dev"}, "edited": false, "score": 0, "creation_date": 1448560147, "post_id": 33927467, "comment_id": 55648126, "body": "Thanks @FireAlkazar  that makes a lot of sense finally understand what is going on"}], "tags": [], "owner": {"reputation": 1267, "user_id": 1479335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWkHs.png?s=128&g=1", "display_name": "FireAlkazar", "link": "https://stackoverflow.com/users/1479335/firealkazar"}, "is_accepted": true, "score": 1, "last_activity_date": 1448490182, "creation_date": 1448490182, "answer_id": 33927467, "question_id": 33927184, "link": "https://stackoverflow.com/questions/33927184/merge-sort-implementation-query/33927467#33927467", "title": "merge sort implementation query", "body": "<p><code>left</code> value is changing during merge and as you have code block </p>\n\n<blockquote>\n  <p>while (left &lt;= lEnd)<br>\n  {<br>\n  //...<br>\n  left++;<br>\n  }  </p>\n</blockquote>\n\n<p><code>left</code> will be finally assigned to <code>lEnd + 1</code>(the condition for ending while loop).<br>\nOtherwise <code>right</code> is not changing and is the last index of currently manipulated sequence. </p>\n"}], "owner": {"reputation": 396, "user_id": 4712199, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Bm3KN.jpg?s=128&g=1", "display_name": "JH_Dev", "link": "https://stackoverflow.com/users/4712199/jh-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 33927467, "answer_count": 2, "score": 2, "last_activity_date": 1448490182, "creation_date": 1448488957, "last_edit_date": 1448489890, "question_id": 33927184, "link": "https://stackoverflow.com/questions/33927184/merge-sort-implementation-query", "title": "merge sort implementation query", "body": "<p>I found this example of a merge sort algorithm online on a tutorial webpage and I have been trying to understand ow the code implements the algorithm. The example i found uses recursion and a temporary array to sort the array of unsorted algorithms.\n  My query is in the final step of the process. When copying the elements of the temporary array into the original array to sort the array. why does the algorithm decrements the right attribute instead of incrementing the left attribute? when i incremented the left left value the algorithm does not work.</p>\n\n<pre><code>class Assignment1\n{\n    static void Main(string[] args)\n    {\n        Console.WriteLine(\"Size of array:\");\n        int n = Convert.ToInt16(Console.ReadLine());\n        int[] unsorted = new int[n];\n\n        for(int i = 0; i &lt; n; i++)\n        {\n            Console.WriteLine(\"Enter a number:\");\n            unsorted[i] = Convert.ToInt16(Console.ReadLine());\n        }\n\n        Console.WriteLine(\"--------Sort---------\");\n\n        Recursion_Sort(unsorted, 0, n - 1);\n        for (int i = 0; i &lt; n; i++)\n        {\n              Console.WriteLine(unsorted[i]);\n        }\n    }\n\n    static public void Merge(int[] numbers, int left, int mid, int right, int n)\n    {\n\n        int[] tempArray = new int[n];\n\n        int i, lEnd, size, pos;\n\n\n\n        lEnd = mid - 1;\n        pos = left;\n        size = (right - left + 1);\n\n\n        while ((left &lt;= lEnd) &amp;&amp; (mid &lt;= right))\n        {\n\n            if (numbers[left] &lt;= numbers[mid])\n            {\n\n                tempArray[pos] = numbers[left];\n                pos++;\n                left++;\n            }\n\n            else\n            {\n\n                tempArray[pos] = numbers[mid];\n                pos++;\n                mid++;\n            }\n        }\n\n\n\n        while (left &lt;= lEnd)\n        {\n            tempArray[pos] = numbers[left];\n            pos++;\n            left++;\n        }\n\n\n        while (mid &lt;= right)\n        {\n            tempArray[pos] = numbers[mid];\n            pos++;\n            mid++;\n        }\n        Console.WriteLine(tempArray.Length);\n\n\n        for (i = 0; i &lt; size; i++)\n        {\n            numbers[right] = tempArray[right];\n            right--;\n        }\n    }\n\n    static public void Recursion_Sort(int[] numbers, int left, int right)\n    {\n\n        int mid;\n\n        if (right &gt; left)\n        {\n            mid = (right + left) / 2;\n\n\n            Recursion_Sort(numbers, left, mid);\n            Recursion_Sort(numbers, (mid + 1), right);\n            // we then merge the sorted sub arrays using the merge method\n            Merge(numbers, left, (mid + 1), right, numbers.Length);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "sql", "sql-server"], "comments": [{"owner": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "edited": false, "score": 2, "creation_date": 1448489217, "post_id": 33927173, "comment_id": 55615488, "body": "Use CASE statement on current timestamp in your WHERE condition."}, {"owner": {"reputation": 2992, "user_id": 1438082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/358935c3b3878f717094b9bf319d3f2c?s=128&d=identicon&r=PG", "display_name": "user1438082", "link": "https://stackoverflow.com/users/1438082/user1438082"}, "reply_to_user": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "edited": false, "score": 0, "creation_date": 1448489481, "post_id": 33927173, "comment_id": 55615593, "body": "@ConsiderMe would you mind elaborating with some sql please ?"}, {"owner": {"reputation": 2709, "user_id": 5552667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ab93af25a6711aced7ee104a7e2ed6?s=128&d=identicon&r=PG&f=1", "display_name": "ZLK", "link": "https://stackoverflow.com/users/5552667/zlk"}, "edited": false, "score": 1, "creation_date": 1448490494, "post_id": 33927173, "comment_id": 55616021, "body": "WHERE Timestamp &gt;= CASE  \t\tWHEN DATEPART(hh, GETDATE()) IN (0,1)  \t\tTHEN CAST(GETDATE()-1 AS DATE) + CAST(&#39;04:00:00&#39; AS DATETIME)  \t\tELSE CAST(GETDATE()-0 AS DATE) + CAST(&#39;04:00:00&#39; AS DATETIME) END"}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 1437919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e214c5ecfea88da29e6d9bb5d59cde9d?s=128&d=identicon&r=PG", "display_name": "TomP123", "link": "https://stackoverflow.com/users/1437919/tomp123"}, "is_accepted": true, "score": 1, "last_activity_date": 1448490941, "creation_date": 1448490941, "answer_id": 33927628, "question_id": 33927173, "link": "https://stackoverflow.com/questions/33927173/sql-for-this-shift/33927628#33927628", "title": "SQL For this shift", "body": "<p>This seems like what you're after:</p>\n\n<pre><code>SELECT * \nFROM [TraceData].[dbo].[ActiveData2] \nwhere Timestamp  &gt;= CASE \n    WHEN CAST(CURRENT_TIMESTAMP AS TIME) BETWEEN CAST('00:00:00' AS TIME) AND CAST('02:00:00' AS TIME)\n    THEN CAST(GETDATE()-0 AS DATE) + CAST('04:00:00' AS DATETIME) \n    ELSE CAST(GETDATE()-1 AS DATE) + CAST('04:00:00' AS DATETIME)\norder by Timestamp DESC\n</code></pre>\n\n<p>However it looks like between 2am and 4am, you'll be trying to return data from the future. Not sure whether that's what you want...</p>\n"}], "owner": {"reputation": 2992, "user_id": 1438082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/358935c3b3878f717094b9bf319d3f2c?s=128&d=identicon&r=PG", "display_name": "user1438082", "link": "https://stackoverflow.com/users/1438082/user1438082"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 33927628, "answer_count": 1, "score": 0, "last_activity_date": 1448490941, "creation_date": 1448488907, "last_edit_date": 1448489180, "question_id": 33927173, "link": "https://stackoverflow.com/questions/33927173/sql-for-this-shift", "title": "SQL For this shift", "body": "<p>The query below gets data from 4am on the date the query is ran until now.</p>\n\n<p>The problem is I need to also run the query at 2am on the following day (to return data from 4am on the previous day to now)- Hence the query no longer works as it is querying the wrong day - i.e I always want the query to have its start time at 4am on the current day unless the query is being ran between 12 am and 2 am - for which i want the start date to be 4am on the previous day.</p>\n\n<p>I have the query in the application configuration file in my winform c# program.\nWithout programmatically sending the day offset, is it possible to modify the query to work with my requirements ?</p>\n\n<pre><code>SELECT * \nFROM [TraceData].[dbo].[ActiveData2] \nwhere Timestamp  &gt;= CAST(GETDATE()-0 AS DATE) + CAST('04:00:00' AS DATETIME)  \norder by Timestamp DESC\n</code></pre>\n"}, {"tags": ["c#", "model-view-controller"], "answers": [{"tags": [], "owner": {"reputation": 49661, "user_id": 781754, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4ee1072483e3ab3c7302820d04935328?s=128&d=identicon&r=PG", "display_name": "Daniel Mann", "link": "https://stackoverflow.com/users/781754/daniel-mann"}, "is_accepted": false, "score": 1, "last_activity_date": 1448489460, "creation_date": 1448489460, "answer_id": 33927282, "question_id": 33927171, "link": "https://stackoverflow.com/questions/33927171/missing-a-using-directive-or-an-assembly-reference-mvc/33927282#33927282", "title": "Missing a using directive or an assembly reference MVC", "body": "<p>Look at your view:</p>\n\n<p><code>@model IEnumerable&lt;ultimateorganiser.Models.Club&gt;</code></p>\n\n<p>You're saying that the model should be an <code>IEnumerable&lt;Club&gt;</code>. </p>\n\n<p>Then, you try to access a property on your model:</p>\n\n<p><code>@Html.DisplayNameFor(model =&gt; model.ClubName)</code></p>\n\n<p>Your model is an <code>IEnumerable</code>, not a <code>Club</code>. You need to iterate over the model.</p>\n"}, {"comments": [{"owner": {"reputation": 495, "user_id": 4568980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9cd5fe0551dab422b4c01a454d17a555?s=128&d=identicon&r=PG&f=1", "display_name": "Cathal O &#39;Donnell", "link": "https://stackoverflow.com/users/4568980/cathal-o-donnell"}, "edited": false, "score": 0, "creation_date": 1448489794, "post_id": 33927296, "comment_id": 55615722, "body": "I added a foreach and it runs fine, thanks for your help!"}], "tags": [], "owner": {"reputation": 765, "user_id": 5559380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd592dc05054cd1a4a3d09083540fed?s=128&d=identicon&r=PG&f=1", "display_name": "Lidaranis", "link": "https://stackoverflow.com/users/5559380/lidaranis"}, "is_accepted": true, "score": 1, "last_activity_date": 1448489509, "creation_date": 1448489509, "answer_id": 33927296, "question_id": 33927171, "link": "https://stackoverflow.com/questions/33927171/missing-a-using-directive-or-an-assembly-reference-mvc/33927296#33927296", "title": "Missing a using directive or an assembly reference MVC", "body": "<p>Your problem is the this. The @model in your view is an ienumerable but you are using it like a club. Ienumerable is a list so, you need to go through the list, item by item in order to access properties like club name. So either use a @foreach in the view if you have more than one club or get rid of the ienumerable in the @model if you have only one.</p>\n"}], "owner": {"reputation": 495, "user_id": 4568980, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/9cd5fe0551dab422b4c01a454d17a555?s=128&d=identicon&r=PG&f=1", "display_name": "Cathal O &#39;Donnell", "link": "https://stackoverflow.com/users/4568980/cathal-o-donnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4767, "favorite_count": 0, "accepted_answer_id": 33927296, "answer_count": 2, "score": 0, "last_activity_date": 1448489509, "creation_date": 1448488898, "question_id": 33927171, "link": "https://stackoverflow.com/questions/33927171/missing-a-using-directive-or-an-assembly-reference-mvc", "title": "Missing a using directive or an assembly reference MVC", "body": "<p>'IEnumerable' does not contain a definition for 'ClubName' and no extension method 'ClubName' accepting a first argument of type 'IEnumerable' could be found (are you missing a using directive or an assembly reference?) </p>\n\n<p>This is the error I run into every time I try to run my code.</p>\n\n<p>This is the code from my Home Controller </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Data.Entity;\nusing System.Linq;\nusing System.Net;\nusing System.Web;\nusing System.Web.Mvc;\nusing ultimateorganiser.Models;\nusing ultimateorganiser.ViewModels;\nusing System.Data;\n\nnamespace ultimateorganiser.Controllers\n{\n    public class HomeController : Controller\n    {\n        public UltimateDb db = new UltimateDb();\n        ClubViewModels cvm = new ClubViewModels();\n        MemberViewModels mvm = new MemberViewModels();\n\n        //Home Page\n        public ActionResult Index()\n        {\n            cvm.Clubs = db.Clubs.Include(\"clubmembers\").ToList();\n            cvm.NumberofClubs = cvm.Clubs.Count();\n            cvm.MemberCount = 0;\n            cvm.Clubs.ForEach(clb =&gt; cvm.MemberCount += clb.ClubMembers.Count());\n            ViewBag.title = \"Clubs List (\" + cvm.NumberofClubs + \")\";\n            return View(cvm.Clubs);\n        }\n</code></pre>\n\n<p>This is the View Model(ClubViewModels)</p>\n\n<pre><code>using ultimateorganiser.Models;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\n\n\nnamespace ultimateorganiser.ViewModels\n{\n    public class ClubViewModels\n    {\n        public int NumberofClubs { get; set; }\n        public List&lt;Club&gt; Clubs { get; set; }\n        public int MemberCount { get; set; }\n    }\n}\n</code></pre>\n\n<p>This is my View</p>\n\n<pre><code>@model IEnumerable&lt;ultimateorganiser.Models.Club&gt;\n\n@{\n    ViewBag.Title = \"Index\";\n}\n\n&lt;h2&gt;Index&lt;/h2&gt;\n\n&lt;div&gt;\n    &lt;h4&gt;Club&lt;/h4&gt;\n    &lt;hr /&gt;\n    &lt;dl class=\"dl-horizontal\"&gt;\n        &lt;dt&gt;\n            @Html.DisplayNameFor(model =&gt; model.ClubName)\n        &lt;/dt&gt;\n\n        &lt;dd&gt;\n            @Html.DisplayFor(model =&gt; model.ClubName)\n        &lt;/dd&gt;\n\n        &lt;dt&gt;\n            @Html.DisplayNameFor(model =&gt; model.ClubDescription)\n        &lt;/dt&gt;\n\n        &lt;dd&gt;\n            @Html.DisplayFor(model =&gt; model.ClubDescription)\n        &lt;/dd&gt;\n\n        &lt;dt&gt;\n            @Html.DisplayNameFor(model =&gt; model.ClubImage)\n        &lt;/dt&gt;\n\n        &lt;dd&gt;\n            @Html.DisplayFor(model =&gt; model.ClubImage)\n        &lt;/dd&gt;\n\n    &lt;/dl&gt;\n&lt;/div&gt;\n&lt;p&gt;\n    @Html.ActionLink(\"Edit\", \"Edit\", new { id = Model.ClubID }) |\n    @Html.ActionLink(\"Back to List\", \"Index\")\n&lt;/p&gt;\n</code></pre>\n\n<p>When I run it on my browser it tells me that it is a \"Compilation Error\",\n\" 'IEnumerable' does not contain a definition for 'ClubName' and no extension method 'ClubName' accepting a first argument of type 'IEnumerable' could be found (are you missing a using directive or an assembly reference\"</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 2, "creation_date": 1448489013, "post_id": 33927163, "comment_id": 55615380, "body": "This is your reference to read about variable scope in C# <a href=\"https://msdn.microsoft.com/en-us/library/aa691132(v=vs.71).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa691132(v=vs.71).aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 39443, "user_id": 129164, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec326c009186734854c600265b69a6ce?s=128&d=identicon&r=PG", "display_name": "devuxer", "link": "https://stackoverflow.com/users/129164/devuxer"}, "is_accepted": true, "score": 3, "last_activity_date": 1448491378, "last_edit_date": 1448491378, "creation_date": 1448489433, "answer_id": 33927273, "question_id": 33927163, "link": "https://stackoverflow.com/questions/33927163/c-using-local-object-in-to-another-function/33927273#33927273", "title": "C#: Using local object in to another function", "body": "<p>Move <code>Hero bohater</code> outside of <code>button1_Click</code> so that it is defined in the <strong>class</strong> instead of in the <strong>method</strong>.</p>\n\n<p>With your current code, <code>bohater</code> is a <strong>local variable</strong> that can only be used inside <code>button_Click</code>. If you define it in the class instead, <code>bohater</code> becomes a <strong>field</strong> that can be used by any method in the class.</p>\n\n<p>So, at the top of your class, put:</p>\n\n<pre><code>private Hero bohater;\n</code></pre>\n\n<p>And inside <code>button_Click</code>, put:</p>\n\n<pre><code>this.bohater = new Hero(name, clas, sex);\n</code></pre>\n\n<p>You also need to update the <code>attack_mode</code> method, like this:</p>\n\n<pre><code>while (this.bohater.hp &gt;= 0 || wojo.hp &gt;= 0)\n{\n    this.bohater.hp -= (wojo.atack - this.bohater.defence_p);\n    wojo.hp -= (this.bohater.atack_p - wojo.defence);\n}\n</code></pre>\n\n<p>Note that <code>this</code> is used to indicate that <code>bohater</code> is in class scope. (You don't have to use <code>this</code> but it makes the code easier to understand.)</p>\n"}, {"tags": [], "owner": {"reputation": 838, "user_id": 862427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/866dd9f4bd43830ca0e530a5f2df2994?s=128&d=identicon&r=PG", "display_name": "Ric Gaudet", "link": "https://stackoverflow.com/users/862427/ric-gaudet"}, "is_accepted": false, "score": 1, "last_activity_date": 1448489556, "creation_date": 1448489556, "answer_id": 33927306, "question_id": 33927163, "link": "https://stackoverflow.com/questions/33927163/c-using-local-object-in-to-another-function/33927306#33927306", "title": "C#: Using local object in to another function", "body": "<p>Define it as the property Bohater in the class you are in:</p>\n\n<pre><code>public Hero Bohater {get; set;}\n</code></pre>\n\n<p>or define it as a field, if you are just using it internally and temporarily:</p>\n\n<pre><code>Hero Bohater;\n</code></pre>\n\n<p>instead of defining it inside an <code>if</code> statement inside a button method. \nThis will allow other methods within the class to access it, as well as other classes (if desired).  Your definition of the variable only extends to the <code>if</code> statement, and does not exist outside of that statement.</p>\n\n<p>Review how the scope of a property/field/variable is determined.  This is just one example of how to solve your problem; there are many others, depending on how you intend to use the \"variable\".</p>\n"}], "owner": {"reputation": 13, "user_id": 4183870, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7OF05ecPU2E/AAAAAAAAAAI/AAAAAAAAAwo/3SQjeBTLPck/photo.jpg?sz=128", "display_name": "Piotr Owczarek", "link": "https://stackoverflow.com/users/4183870/piotr-owczarek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 33927273, "answer_count": 2, "score": 1, "last_activity_date": 1448491378, "creation_date": 1448488864, "question_id": 33927163, "link": "https://stackoverflow.com/questions/33927163/c-using-local-object-in-to-another-function", "title": "C#: Using local object in to another function", "body": "<p>my English isn't good. I have a problem with object specific class.\nI creating that object using function (WFA: button_click)</p>\n\n<pre><code>    public void button1_Click(object sender, EventArgs e)\n    {\n        clas = comboBox1.Text;\n        name = textBox1.Text;\n        sex = radioButton1.Checked;\n        if (nazwa.Length != 0 &amp;&amp; nazwa.Length != 0)\n        {\n            Hero Bohater = new Hero(name, clas, sex);\n        }\n    }\n</code></pre>\n\n<p>And, when I using another button:</p>\n\n<pre><code>private void chodzenie_Click(object sender, EventArgs e)\n        {\n            int r = rnd.Next(1, 100);\n            if (r % 10 == 0 || r % 10 == 5)\n            {\n                attack_mode();\n            }   \n        }\nprivate void attack_mode()\n        {\n            int wybor = rnd.Next(0, 1);\n            if (wybor == 0)\n            {\n                small_enemy wojo = new small_enemy(\"Antek\");\n                while (Bohater.hp &gt;= 0 || wojo.hp &gt;= 0)\n                {\n                    Bohater.hp -= (wojo.atack - Bohater.defence_p);\n                    wojo.hp -= (Bohater.atack_p - wojo.defence);\n                }\n            }\n            else\n            {\n                big_enemy wojo = new big_enemy(\"Waldek\");\n                while (Bohater.hp != 0 || wojo.hp != 0)\n                {\n                    Bohater.hp -= (wojo.atack - Bohater.defence_p);\n                    wojo.hp -= (Bohater.atack_p - wojo.defence);\n                }\n            }     \n        }\n</code></pre>\n\n<p>Visual can't see my object and receive Error</p>\n\n<blockquote>\n  <p>The name 'Bohater' does not exist in the current context</p>\n</blockquote>\n\n<p>How to make usable creating object (in function), and uses in global scope?</p>\n\n<p>Ofc all of this is in one file, but another function.\nI'm try to get Answer in internet, maybe my searching isn't good.</p>\n"}, {"tags": ["c#", "if-statement"], "comments": [{"owner": {"reputation": 2085, "user_id": 4372746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7421528d3e64e8186fcc0f6020cc1f14?s=128&d=identicon&r=PG&f=1", "display_name": "Glorin Oakenfoot", "link": "https://stackoverflow.com/users/4372746/glorin-oakenfoot"}, "edited": false, "score": 3, "creation_date": 1448488805, "post_id": 33927132, "comment_id": 55615294, "body": "<code>if</code> statements are not loops. They simply execute depending on the condition presented."}, {"owner": {"reputation": 1356, "user_id": 4358137, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bfsy9.jpg?s=128&g=1", "display_name": "Seth Kitchen", "link": "https://stackoverflow.com/users/4358137/seth-kitchen"}, "edited": false, "score": 0, "creation_date": 1448488876, "post_id": 33927132, "comment_id": 55615324, "body": "What is the question? Even the Description is incoherent"}, {"owner": {"reputation": 1300, "user_id": 1080738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QveyE.jpg?s=128&g=1", "display_name": "Julius Depulla", "link": "https://stackoverflow.com/users/1080738/julius-depulla"}, "edited": false, "score": 0, "creation_date": 1448488980, "post_id": 33927132, "comment_id": 55615366, "body": "Refactor into methods"}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 3, "creation_date": 1448488991, "post_id": 33927132, "comment_id": 55615372, "body": "Cleaning up this code is a great idea! You have magic numbers, violate the DRY principle ... Suggestion: put all textboxes into an array and then access the array with index <code>i</code>."}, {"owner": {"reputation": 560, "user_id": 3984496, "user_type": "registered", "accept_rate": 97, "profile_image": "https://graph.facebook.com/100004670621627/picture?type=large", "display_name": "Tom Pitts", "link": "https://stackoverflow.com/users/3984496/tom-pitts"}, "reply_to_user": {"reputation": 2085, "user_id": 4372746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7421528d3e64e8186fcc0f6020cc1f14?s=128&d=identicon&r=PG&f=1", "display_name": "Glorin Oakenfoot", "link": "https://stackoverflow.com/users/4372746/glorin-oakenfoot"}, "edited": false, "score": 0, "creation_date": 1448489021, "post_id": 33927132, "comment_id": 55615384, "body": "The question is, can I condense the if statements down? @GlorinOakenfoot I have a for loop that calls this method, each time giving incrementing i by one 32 times. It does the for loop every 2 seconds on a timer."}], "answers": [{"tags": [], "owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "is_accepted": false, "score": 0, "last_activity_date": 1448489141, "creation_date": 1448489141, "answer_id": 33927210, "question_id": 33927132, "link": "https://stackoverflow.com/questions/33927132/c-if-loop-within-a-for-loop-within-an-if-loop/33927210#33927210", "title": "C# If loop within a for loop within an if loop", "body": "<p>Well, for one you can do this:</p>\n\n<p><code>if ((now &lt; min || now &gt; max) &amp;&amp; now !=0)</code></p>\n\n<p>Which simplifies your statements dramatically, as both <code>now&lt;min</code> and <code>now&gt;max</code> do the same thing.</p>\n\n<p>For the 33 text boxes, you'd have to either put them into an array and use an index lookup, write a function called <code>getTextBoxFromIndex()</code> and do the giant-if-block once, or see if you can do something like <code>mw[\"TxtBox\"+i]</code> (some environments will support it, others wont).</p>\n"}, {"tags": [], "owner": {"reputation": 10603, "user_id": 695833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H6qQG.jpg?s=128&g=1", "display_name": "Ed Bayiates", "link": "https://stackoverflow.com/users/695833/ed-bayiates"}, "is_accepted": true, "score": 3, "last_activity_date": 1448489465, "last_edit_date": 1448489465, "creation_date": 1448489151, "answer_id": 33927211, "question_id": 33927132, "link": "https://stackoverflow.com/questions/33927132/c-if-loop-within-a-for-loop-within-an-if-loop/33927211#33927211", "title": "C# If loop within a for loop within an if loop", "body": "<p>Just use an array for the textboxes, something like this:</p>\n\n<pre><code>internal static void isGreaterThanOrBelowValue(int min, int max, int now, int i)\n{\n    MainWindow mw = new MainWindow();\n    TextBox[] tbList = new TextBox[] { mw.TxtBox1, mw.TxtBox2, mw.TxtBox3 };\n\n    if (now !=0 &amp;&amp; (now &lt; min || now &gt; max))\n    {\n        tbList[i-1].Foreground = new SolidColorBrush(Colors.Red);\n    }\n}\n</code></pre>\n\n<p>You could also build the array outside the function as a class member if the textboxes don't change, so that you were not rebuilding it every time the function is called:</p>\n\n<pre><code>static MainWindow mw = new MainWindow();\nstatic TextBox[] tbList = new TextBox[] { mw.TxtBox1, mw.TxtBox2, mw.TxtBox3 };\n\ninternal static void isGreaterThanOrBelowValue(int min, int max, int now, int i)\n{\n    if (now !=0 &amp;&amp; (now &lt; min || now &gt; max))\n    {\n        tbList[i-1].Foreground = new SolidColorBrush(Colors.Red);\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1356, "user_id": 4358137, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bfsy9.jpg?s=128&g=1", "display_name": "Seth Kitchen", "link": "https://stackoverflow.com/users/4358137/seth-kitchen"}, "is_accepted": false, "score": 0, "last_activity_date": 1448489258, "creation_date": 1448489258, "answer_id": 33927231, "question_id": 33927132, "link": "https://stackoverflow.com/questions/33927132/c-if-loop-within-a-for-loop-within-an-if-loop/33927231#33927231", "title": "C# If loop within a for loop within an if loop", "body": "<p>For one you can reduce the code by using \"else if\" instead of \"if\" everytime. </p>\n\n<p>When you do</p>\n\n<pre><code>if(I==1)\n{\n}\nif(I==2)\n{\n}\n</code></pre>\n\n<p>It will check both conditions always.</p>\n\n<p>When you do</p>\n\n<pre><code>if(I==1)\n{\n}\nelse if(I==2)\n{\n}\n</code></pre>\n\n<p>The second statement will only be checked if the first statement is false. Since we know i=1, we know i can't be 2, so we shouldn't check statement 2. </p>\n\n<p>Also read the comments because they give good information. You can write a function that checks if i>0 and i&lt;3 and sets the brush to red accordingly. Honestly this question is too broad. There are many ways to reduce your code.</p>\n"}], "owner": {"reputation": 560, "user_id": 3984496, "user_type": "registered", "accept_rate": 97, "profile_image": "https://graph.facebook.com/100004670621627/picture?type=large", "display_name": "Tom Pitts", "link": "https://stackoverflow.com/users/3984496/tom-pitts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 33927211, "answer_count": 3, "score": 1, "last_activity_date": 1448494942, "creation_date": 1448488746, "question_id": 33927132, "link": "https://stackoverflow.com/questions/33927132/c-if-loop-within-a-for-loop-within-an-if-loop", "title": "C# If loop within a for loop within an if loop", "body": "<p>I would like to reduce this code if I can:</p>\n\n<pre><code>class Alarm\n{\n    internal static void isGreaterThanOrBelowValue(int min, int max, int now, int i)\n    {\n        MainWindow mw = new MainWindow();\n\n        if (now &lt; min &amp;&amp; now !=0)\n        {\n            if(i == 1)\n            {\n                mw.TxtBox1.Foreground = new SolidColorBrush(Colors.Red);\n            }\n            if (i == 2)\n            {\n                mw.TxtBox2.Foreground = new SolidColorBrush(Colors.Red);\n            }\n            if (i == 3)\n            {\n                mw.TxtBox3.Foreground = new SolidColorBrush(Colors.Red);\n            }\n        }\n        if (now &gt; max &amp;&amp; now !=0)\n        {\n            if(i == 1)\n            {\n                mw.TxtBox1.Foreground = new SolidColorBrush(Colors.Red);\n            }\n            if (i == 2)\n            {\n                mw.TxtBox2.Foreground = new SolidColorBrush(Colors.Red);\n            }\n            if (i == 3)\n            {\n                mw.TxtBox3.Foreground = new SolidColorBrush(Colors.Red);\n            }\n        }\n\n}\n</code></pre>\n\n<p>I want to do the following:</p>\n\n<p>i can be between 1 and 33.</p>\n\n<p>I can get the textbox name (TxtBox1) etc.</p>\n\n<p>I would like to reduce the if statements so I don't have 32 if statements for each larger if statement.</p>\n\n<p>Thank you! :)</p>\n"}, {"tags": ["c#", "asp.net-mvc", "unity-container"], "owner": {"reputation": 46, "user_id": 3230725, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mF7Q5.png?s=128&g=1", "display_name": "ProSardar", "link": "https://stackoverflow.com/users/3230725/prosardar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1451657498, "creation_date": 1448488370, "last_edit_date": 1451657498, "question_id": 33927042, "link": "https://stackoverflow.com/questions/33927042/how-can-i-inject-unity-dependency-to-any-my-class", "title": "How can i inject Unity dependency to any my class", "body": "<p>In ASP.NET MVC5 i just have class <strong>Saver</strong></p>\n\n<pre><code> public class Saver\n {\n    private readonly ResponseModel _model;\n\n    [Dependency]\n    public SomeService SomeService { get; set; }\n\n\n    public Saver(ResponseModel model)\n    {\n        _model= estateModel;\n    }\n\n    public void Save(){\n        // here SomeService is null\n    }        \n }\n</code></pre>\n\n<p>In UnityConfig.cs I have this</p>\n\n<p><code>container.RegisterType&lt;SomeService &gt;(new TransientLifetimeManager());</code></p>\n\n<p>Then in UnityMvcActivator.cs i have this</p>\n\n<pre><code>        IUnityContainer container = UnityConfig.GetConfiguredContainer();\n\n        FilterProviders.Providers.Remove(FilterProviders.Providers.OfType&lt;FilterAttributeFilterProvider&gt;().First());\n        FilterProviders.Providers.Add(new UnityFilterAttributeFilterProvider(container));\n\n        DependencyResolver.SetResolver(new UnityDependencyResolver(container));\n\n        // TODO: Uncomment if you want to use PerRequestLifetimeManager\n        DynamicModuleUtility.RegisterModule(typeof(UnityPerRequestHttpModule));\n</code></pre>\n\n<p>What can I do to resolve this error. Why inject work in controller, but don't  in other classes, which isn't a controller?</p>\n"}, {"tags": ["c#", "textbox", "listbox"], "comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1448488436, "post_id": 33927025, "comment_id": 55615100, "body": "You should always make sure your index is greater than -1 when acting on the list."}], "answers": [{"comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 24, "user_id": 5344563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-DksuGhRVxLs/AAAAAAAAAAI/AAAAAAAAAGw/GkJb1ncm1oU/photo.jpg?sz=128", "display_name": "gopi", "link": "https://stackoverflow.com/users/5344563/gopi"}, "edited": false, "score": 0, "creation_date": 1448489660, "post_id": 33927109, "comment_id": 55615669, "body": "Also looking at your code in the delete handler. Better reading the ListIndex and execute the remove from the db before removing the item from the Listbox."}, {"owner": {"reputation": 24, "user_id": 5344563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-DksuGhRVxLs/AAAAAAAAAAI/AAAAAAAAAGw/GkJb1ncm1oU/photo.jpg?sz=128", "display_name": "gopi", "link": "https://stackoverflow.com/users/5344563/gopi"}, "edited": false, "score": 0, "creation_date": 1448489845, "post_id": 33927109, "comment_id": 55615747, "body": "OK, will do so. One last thing - I&#39;ve noticed that the modifyRecordButton_Click actualy doesn&#39;t modify anything. Any idea why?"}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 24, "user_id": 5344563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-DksuGhRVxLs/AAAAAAAAAAI/AAAAAAAAAGw/GkJb1ncm1oU/photo.jpg?sz=128", "display_name": "gopi", "link": "https://stackoverflow.com/users/5344563/gopi"}, "edited": false, "score": 0, "creation_date": 1448490022, "post_id": 33927109, "comment_id": 55615819, "body": "How do you bind the Person data to your listbox?"}, {"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "reply_to_user": {"reputation": 24, "user_id": 5344563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-DksuGhRVxLs/AAAAAAAAAAI/AAAAAAAAAGw/GkJb1ncm1oU/photo.jpg?sz=128", "display_name": "gopi", "link": "https://stackoverflow.com/users/5344563/gopi"}, "edited": false, "score": 0, "creation_date": 1448490666, "post_id": 33927109, "comment_id": 55616091, "body": "In other words. If you want to set the DataSource property of your Listbox to some kind of collection you should do it using a BindingSource component that provides the infrastructure to refresh the current selected item after you have made changes to its property. This doesn&#39;t happen automatically"}], "tags": [], "owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "is_accepted": false, "score": 0, "last_activity_date": 1448488633, "creation_date": 1448488633, "answer_id": 33927109, "question_id": 33927025, "link": "https://stackoverflow.com/questions/33927025/c-removing-item-from-listbox-while-updating-textboxes/33927109#33927109", "title": "C# removing item from listbox while updating textboxes", "body": "<p>Defensive programming requires that you check the value of SelectedIndex before using it. Don't be surprised but you get a SelectedIndexChanged event when the Listbox has not item selected thus SelectedIndex is -1</p>\n\n<pre><code>private void personListBox_SelectedIndexChanged(object sender, EventArgs e)\n{\n    if(personListBox.SelectedIndex != -1)\n    {\n        Persond = (Person) personListBox.Items[personListBox.SelectedIndex];\n        NameTextBox.Text = d.Name;\n        SurnameTextBox.Text = d.Surname;\n        DateOfBirthPicker.Value = d.DateOfBirth;\n        FemaleRadioButton.Checked = d.Sex;\n    }\n}\n</code></pre>\n\n<p>The same check should be applied to the modifyRecordButton_Click and deleteRecordButton_Click handlers</p>\n"}], "owner": {"reputation": 24, "user_id": 5344563, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-DksuGhRVxLs/AAAAAAAAAAI/AAAAAAAAAGw/GkJb1ncm1oU/photo.jpg?sz=128", "display_name": "gopi", "link": "https://stackoverflow.com/users/5344563/gopi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1448488633, "creation_date": 1448488300, "last_edit_date": 1448488619, "question_id": 33927025, "link": "https://stackoverflow.com/questions/33927025/c-removing-item-from-listbox-while-updating-textboxes", "title": "C# removing item from listbox while updating textboxes", "body": "<p>I'm writing a C# app, which is supposed to keep fields: first name, surname, date of birth and sex. If I select a person in the listbox, it coppies the values from the listbox into corresponding textboxes. I should then be able to: add a new record into listbox, modify the record in listbox, or to delete the actually selected record. My problem is, that in both function the app crashes with index set to \"-1\".</p>\n\n<p>My code:</p>\n\n<pre><code>    class Person\n    {\n        public string Name{ get; set; }\n        public string Surname{ get; set; }\n        public DateTime DateOfBirth { get; set; }\n        public bool Sex{ get; set; }\n\n        public override string ToString()\n        {\n            return Name\n            + \" \" + Surname\n            + \", nar.\" + DateOfBirth.ToShortDateString()\n            + \" (\" + (Sex? \"male\" : \"female\")\n            + \")\";\n        }\n    }\n\n    private void personListBox_SelectedIndexChanged(object sender, EventArgs e)\n    {\n        Persond = (Person) personListBox.Items[personListBox.SelectedIndex];\n        NameTextBox.Text = d.Name;\n        SurnameTextBox.Text = d.Surname;\n        DateOfBirthPicker.Value = d.DateOfBirth;\n        FemaleRadioButton.Checked = d.Sex;\n    }\n\n    private void modifyRecordButton_Click(object sender, EventArgs e)\n    {\n\n            Person d = (Person)personListBox.Items[personListBox.SelectedIndex];\n            d.Name= NameTextBox.Text;\n            d.Surname= SurnameTextBox.Text;\n            d.DateOfBirth= DateOfBirthPicker.Value;\n            d.Sex= FemaleRadioButton.Checked;\n            detiListBox.Refresh();        \n    }\n\n    private void DeleteButton_Click(object sender, EventArgs e)\n    {\n        personListBox.Items.Remove(detiListBox.SelectedItem);\n        personListBox.Refresh();\n        Person d = (Person)personListBox.Items[personListBox.SelectedIndex];\n        d.Name = NameTextBox.Text;\n        d.Surname= PrijmeniTextBox.Text;\n        d.DateOfBirth= DateOfBirthPicker.Value;\n        d.Sex= FemaleRadioButton.Checked;\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "mongodb", "mongodb-.net-driver"], "comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448488438, "post_id": 33926988, "comment_id": 55615102, "body": "is collection a <code>IQueryable&lt;Base&gt;</code> or a <code>IEnumerable&lt;Base&gt;</code>? I bet you it is a IQueryable."}, {"owner": {"reputation": 19423, "user_id": 81514, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mdTlA.jpg?s=128&g=1", "display_name": "Ralph Shillington", "link": "https://stackoverflow.com/users/81514/ralph-shillington"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448488695, "post_id": 33926988, "comment_id": 55615238, "body": "collection is an IMongoCollection&lt;Base&gt;"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448488937, "post_id": 33926988, "comment_id": 55615355, "body": "Oh, ok. So it is using <a href=\"http://api.mongodb.org/csharp/current/html/M_MongoDB_Driver_IMongoCollection_1_OfType__1.htm\" rel=\"nofollow noreferrer\"><code>IMongoCollection.OfType&lt;T&gt;</code></a> not the <a href=\"https://msdn.microsoft.com/en-us/library/bb360913(v=vs.100).aspx\" rel=\"nofollow noreferrer\"><code>Enumerable.OfType&lt;T&gt;</code></a> or <a href=\"https://msdn.microsoft.com/en-us/library/bb344857(v=vs.100).aspx\" rel=\"nofollow noreferrer\"><code>Queryable.OfType&lt;T&gt;</code></a> extension methods. No idea then."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 1, "creation_date": 1448489546, "post_id": 33926988, "comment_id": 55615627, "body": "This is unrelated to the driver. The generated filter is correct. But it seems you may have found a bug in MongoDB itself."}, {"owner": {"reputation": 10774, "user_id": 25333, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1a3fe0ef24651f2c23d52b6f1ecd9fbf?s=128&d=identicon&r=PG", "display_name": "Craig Wilson", "link": "https://stackoverflow.com/users/25333/craig-wilson"}, "edited": false, "score": 0, "creation_date": 1448490276, "post_id": 33926988, "comment_id": 55615935, "body": "OfType is merely amending the filter to include the discriminator. My suggestion here would be to repro this in the shell. What version of the server are you using?"}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 10774, "user_id": 25333, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1a3fe0ef24651f2c23d52b6f1ecd9fbf?s=128&d=identicon&r=PG", "display_name": "Craig Wilson", "link": "https://stackoverflow.com/users/25333/craig-wilson"}, "edited": false, "score": 1, "creation_date": 1448490508, "post_id": 33926988, "comment_id": 55616027, "body": "@CraigWilson this repros for me on 2.6.7 (also checked with the profiling collection)."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "edited": false, "score": 1, "creation_date": 1448542215, "post_id": 33926988, "comment_id": 55637377, "body": "@RalphShillington I suggest reporting this and posting a link here..."}], "answers": [{"comments": [{"owner": {"reputation": 10774, "user_id": 25333, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1a3fe0ef24651f2c23d52b6f1ecd9fbf?s=128&d=identicon&r=PG", "display_name": "Craig Wilson", "link": "https://stackoverflow.com/users/25333/craig-wilson"}, "edited": false, "score": 1, "creation_date": 1448490570, "post_id": 33927516, "comment_id": 55616053, "body": "The problem might be that the discriminator is persisted as an array and is matching the 2nd element of the _t array... And the positional operator ($) in the update is using that position in the update statement."}, {"owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "reply_to_user": {"reputation": 10774, "user_id": 25333, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1a3fe0ef24651f2c23d52b6f1ecd9fbf?s=128&d=identicon&r=PG", "display_name": "Craig Wilson", "link": "https://stackoverflow.com/users/25333/craig-wilson"}, "edited": false, "score": 0, "creation_date": 1448490811, "post_id": 33927516, "comment_id": 55616145, "body": "@CraigWilson seems very likely. It indeed doesn&#39;t repro when <code>_t</code> is just a simple field."}], "tags": [], "owner": {"reputation": 100162, "user_id": 885318, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0caa455bd74c1d9d10d2af49afa18228?s=128&d=identicon&r=PG", "display_name": "i3arnon", "link": "https://stackoverflow.com/users/885318/i3arnon"}, "is_accepted": true, "score": 1, "last_activity_date": 1448490392, "creation_date": 1448490392, "answer_id": 33927516, "question_id": 33926988, "link": "https://stackoverflow.com/questions/33926988/adding-oftypet-on-mongocollection-breaks-the-behaviour-of-updateoneasync/33927516#33927516", "title": "Adding OfType&lt;T&gt; on MongoCollection &quot;breaks&quot; the behaviour of UpdateOneAsync", "body": "<p>This is unrelated to the MongoDB C# driver, but it seems to be a bug in MongoDB itself when the type is used in the query.</p>\n\n<p>You can see that this causes the same issue without using <code>OfType</code>, but specifying the type field explicitly (i.e. <code>\"_t\"</code>):</p>\n\n<pre><code>var filter = Builders&lt;Person&gt;.Filter.And(\n    new BsonDocument(\"_t\", \"Person\"),\n    Builders&lt;Person&gt;.Filter.Eq(p =&gt; p.Id, person.Id), \n    Builders&lt;Person&gt;.Filter.Eq(\"Addresses.Index\", 4));\nvar update = Builders&lt;Person&gt;.Update.Set(\n    \"Addresses.$\", \n    new EmailAddress { Index = 4, MailTo = \"Never@home.com\" });\nawait db.GetCollection&lt;Person&gt;(\"Objects\").UpdateOneAsync(filter, update);\n</code></pre>\n\n<p>You can see the query this will generate with this piece of code:</p>\n\n<pre><code>Console.WriteLine(db.GetCollection&lt;Person&gt;(\"Objects\").Find(filter));\n</code></pre>\n\n<p>And the query is the following which is perfectly correct:</p>\n\n<pre><code>{ \"_t\" : \"Person\", \"_id\" : ObjectId(\"5656356f64c22e5d38aeb92e\"), \"Addresses.4 }\n</code></pre>\n"}], "owner": {"reputation": 19423, "user_id": 81514, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mdTlA.jpg?s=128&g=1", "display_name": "Ralph Shillington", "link": "https://stackoverflow.com/users/81514/ralph-shillington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 33927516, "answer_count": 1, "score": 0, "last_activity_date": 1448490392, "creation_date": 1448488110, "question_id": 33926988, "link": "https://stackoverflow.com/questions/33926988/adding-oftypet-on-mongocollection-breaks-the-behaviour-of-updateoneasync", "title": "Adding OfType&lt;T&gt; on MongoCollection &quot;breaks&quot; the behaviour of UpdateOneAsync", "body": "<p>I've run into what I can only understand to be a bug in the C# driver.</p>\n\n<p>This <a href=\"https://gist.github.com/rshillington/1c63d0a17cf7a1aa24e6#file-program-cs\" rel=\"nofollow\">gist</a> illustrates the problem.</p>\n\n<p>If I run</p>\n\n<pre><code>collection.UpdateOneAsync(\n    \"{ \\\"_id\\\" : ObjectId(\\\"5656277cd4d37b13b4e7e009\\\"), \\\"Addresses.Index\\\" : 4 },\n    \"{ \\\"$set\\\" : { \\\"Addresses.$\\\" : { \\\"_t\\\" : [\\\"Address\\\", \\\"EmailAddress\\\"], \\\"Index\\\" : 4, \\\"MailTo\\\" : \\\"Never@home.com\\\" } } }\")\n</code></pre>\n\n<p>I get the desired result.  </p>\n\n<p>If however I use the Builders to build the filter definition and update definition like so:</p>\n\n<p><code>var filter = Builders&lt;Person&gt;\n        .Filter\n        .And(Builders&lt;Person&gt;.Filter.Eq(p =&gt; p.Id, person.Id),\n                Builders&lt;Person&gt;.Filter.Eq(\"Addresses.Index\", 4));</code></p>\n\n<p><code>var update = Builders&lt;Person&gt;.Update.Set(\"Addresses.$\", new EmailAddress { Index = 4, MailTo = \"Never@home.com\" });</code></p>\n\n<p>then I must change my call to update to be</p>\n\n<p><code>await collection.OfType&lt;Person&gt;().UpdateOneAsync(filter, update);</code></p>\n\n<p>and the call to OfType results in the wrong address being replaced.</p>\n"}, {"tags": ["c#", "vb.net"], "comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1448487912, "post_id": 33926912, "comment_id": 55614850, "body": "What are the errors?  What is your question?"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448487929, "post_id": 33926912, "comment_id": 55614861, "body": "if you are getting the Image then you should be able to save the image to your local"}, {"owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "edited": false, "score": 2, "creation_date": 1448487958, "post_id": 33926912, "comment_id": 55614875, "body": "You are mixing C# and VB.NET code"}, {"owner": {"reputation": 1, "user_id": 5606110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11daaad66128359dd31abecfef34c68c?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron MC", "link": "https://stackoverflow.com/users/5606110/aaron-mc"}, "edited": false, "score": 0, "creation_date": 1448488024, "post_id": 33926912, "comment_id": 55614903, "body": "The errors are &quot;me&quot; &quot;isnot&quot; &quot;then&quot; &quot;Path&quot; &quot;My&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5606110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11daaad66128359dd31abecfef34c68c?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron MC", "link": "https://stackoverflow.com/users/5606110/aaron-mc"}, "edited": false, "score": 0, "creation_date": 1448488604, "post_id": 33926989, "comment_id": 55615183, "body": "Thanks it fixed it a bit but now picturebox1 does not exist in the current context. It looks like <a href=\"https://gyazo.com/595b2899ee6d8180808f90e0d6792b9f\" rel=\"nofollow noreferrer\">gyazo.com/595b2899ee6d8180808f90e0d6792b9f</a>"}, {"owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "reply_to_user": {"reputation": 1, "user_id": 5606110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11daaad66128359dd31abecfef34c68c?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron MC", "link": "https://stackoverflow.com/users/5606110/aaron-mc"}, "edited": false, "score": 0, "creation_date": 1448489234, "post_id": 33926989, "comment_id": 55615499, "body": "@AaronMC What did you call your picture box control?"}, {"owner": {"reputation": 1, "user_id": 5606110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11daaad66128359dd31abecfef34c68c?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron MC", "link": "https://stackoverflow.com/users/5606110/aaron-mc"}, "edited": false, "score": 0, "creation_date": 1448490737, "post_id": 33926989, "comment_id": 55616122, "body": "My picturebox i entred the URL as &quot;<a href=\"http://api.skype.com/users/pyromcee/profile/avatar\" rel=\"nofollow noreferrer\">api.skype.com/users/pyromcee/profile/avatar</a>&quot; under &quot;Image Location&quot; The code when i double click is nothing. I used the top code with the Save button when i double click."}, {"owner": {"reputation": 1, "user_id": 5606110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11daaad66128359dd31abecfef34c68c?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron MC", "link": "https://stackoverflow.com/users/5606110/aaron-mc"}, "edited": false, "score": 0, "creation_date": 1448490993, "post_id": 33926989, "comment_id": 55616215, "body": "heres my Skype tool download - <a href=\"http://www.gcpmc.org/uploads/4/8/3/4/48346419/zippymodss_skype_tool_2.0.zip\" rel=\"nofollow noreferrer\">gcpmc.org/uploads/4/8/3/4/48346419/&hellip;</a>  if you want you can open it and go to &quot;grabbers&quot; tab and enter a skype username and hit &quot;grab&quot; it pulls the image up properly and works, i just want to know how to get the button that says &quot;save&quot; to to save the photo without error."}, {"owner": {"reputation": 1, "user_id": 5606110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11daaad66128359dd31abecfef34c68c?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron MC", "link": "https://stackoverflow.com/users/5606110/aaron-mc"}, "edited": false, "score": 0, "creation_date": 1448491995, "post_id": 33926989, "comment_id": 55616629, "body": "I fixed the &quot;path error&quot; by adding &quot;System.IO.Path&quot; instead of &quot;IO.Path&quot; all i got is Error #1 - Noninvocable Member &#39;system.environment.specialfolder&#39; cannot be used like a method. Error #2 - Then beside it i got &quot;The name &#39;specialfolder&#39; does not exist in the current context."}, {"owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "reply_to_user": {"reputation": 1, "user_id": 5606110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11daaad66128359dd31abecfef34c68c?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron MC", "link": "https://stackoverflow.com/users/5606110/aaron-mc"}, "edited": false, "score": 0, "creation_date": 1448492617, "post_id": 33926989, "comment_id": 55616869, "body": "Should be Environment.GetFolderPath"}], "tags": [], "owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "is_accepted": false, "score": 1, "last_activity_date": 1448492602, "last_edit_date": 1448492602, "creation_date": 1448488113, "answer_id": 33926989, "question_id": 33926912, "link": "https://stackoverflow.com/questions/33926912/c-errors-trying-to-save-image-from-program-to-desktop-in-tool/33926989#33926989", "title": "C# - Errors trying to Save Image from program to desktop in tool", "body": "<p>Here is a C# version:</p>\n\n<pre><code>if (picturebox1.Image != null)\n{\n    picturebox1.Image.Save(System.IO.Path.Combine(Environment.GetFolderPath(SpecialFolder.Desktop), textBox6.Text));\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5606110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11daaad66128359dd31abecfef34c68c?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron MC", "link": "https://stackoverflow.com/users/5606110/aaron-mc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1448493239, "creation_date": 1448487805, "last_edit_date": 1448493239, "question_id": 33926912, "link": "https://stackoverflow.com/questions/33926912/c-errors-trying-to-save-image-from-program-to-desktop-in-tool", "title": "C# - Errors trying to Save Image from program to desktop in tool", "body": "<p>So my tool gets a picture online and puts it in the middle, i just wonder how do i save?</p>\n\n<p>here is my code i used but it has error's i wonder why?</p>\n\n<pre><code>if Me.picturebox1.Image IsNot Nothing Then\n        Me.Picturebox1.Image.Save(IO.Path.Combine(My.Computer.filesystem.SpecialDirectories.Desktop, textBox6.Text));\n</code></pre>\n\n<p>Here is a Gyazo image of it. The program works properly i just want to get it to save the Image.</p>\n\n<p><a href=\"https://gyazo.com/913191e35c3caab9016cd09b7fd28b59\" rel=\"nofollow\">https://gyazo.com/913191e35c3caab9016cd09b7fd28b59</a></p>\n\n<hr>\n\n<p>If you really need My code before this when it grabs the picture here it is</p>\n\n<pre><code> pictureBox1.Image = new System.Drawing.Bitmap(new System.IO.MemoryStream(new System.Net.WebClient().DownloadData(\"http://api.skype.com/users/\" + textBox6.Text + \"/profile/avatar\")));\n</code></pre>\n"}, {"tags": ["c#", "search", "binary-search-tree", "nodes"], "comments": [{"owner": {"reputation": 667, "user_id": 955885, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bd04cb5d81cd38d0d0157565a2f8775?s=128&d=identicon&r=PG&f=1", "display_name": "Nicko Po", "link": "https://stackoverflow.com/users/955885/nicko-po"}, "edited": false, "score": 0, "creation_date": 1448488220, "post_id": 33926850, "comment_id": 55614994, "body": "You know, debuggers make life much easier. That said, FindNode() should have node.left, instead of root.left. Same for right. Also your AddNode fails for insertion of existing nodes."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5432462, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-YjVwuO1uj6Q/AAAAAAAAAAI/AAAAAAAAAC8/AXXx49OHEFg/photo.jpg?sz=128", "display_name": "Shadow Absinthe", "link": "https://stackoverflow.com/users/5432462/shadow-absinthe"}, "edited": false, "score": 0, "creation_date": 1448532258, "post_id": 33927792, "comment_id": 55631166, "body": "This was perfect, found my solution. Thanks"}], "tags": [], "owner": {"reputation": 1267, "user_id": 1479335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wWkHs.png?s=128&g=1", "display_name": "FireAlkazar", "link": "https://stackoverflow.com/users/1479335/firealkazar"}, "is_accepted": true, "score": 2, "last_activity_date": 1448491783, "creation_date": 1448491783, "answer_id": 33927792, "question_id": 33926850, "link": "https://stackoverflow.com/questions/33926850/c-find-specific-node-in-binary-search-tree/33927792#33927792", "title": "C# Find Specific Node in Binary Search Tree", "body": "<p>Try to change the following:<br>\n1. Use <code>CompareTo</code> method with 0 not 1, so <code>a.CompareTo(current.data) &lt; 1</code> should be <code>a.CompareTo(current.data) &lt; 0</code><br>\nSee documentation <a href=\"https://msdn.microsoft.com/en-us/library/system.icomparable.compareto%28v=vs.110%29.aspx\" rel=\"nofollow\">IComparable.CompareTo Method</a><br>\n2. As your <code>FindNode</code> is recursive call, change <code>root</code> to <code>node</code> usage</p>\n\n<pre><code>public string FindNode(Node node, string s)\n{\n    if (node == null)\n        return Output = \"not found\";\n    else if (s.CompareTo(node.data) &lt; 0)\n        return FindNode(node.left, s);\n    else if (s.CompareTo(node.data) &gt; 0)\n        return FindNode(node.right, s);\n\n    return Output = \"found\";\n}\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 13, "user_id": 5432462, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-YjVwuO1uj6Q/AAAAAAAAAAI/AAAAAAAAAC8/AXXx49OHEFg/photo.jpg?sz=128", "display_name": "Shadow Absinthe", "link": "https://stackoverflow.com/users/5432462/shadow-absinthe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5612, "favorite_count": 0, "accepted_answer_id": 33927792, "answer_count": 1, "score": 1, "last_activity_date": 1448491783, "creation_date": 1448487510, "question_id": 33926850, "link": "https://stackoverflow.com/questions/33926850/c-find-specific-node-in-binary-search-tree", "title": "C# Find Specific Node in Binary Search Tree", "body": "<p>been noodling around with BST's and I have a pretty good idea of them but I would like to be able to search for a particular node in the BST and have it tell me if it exists. I am using strings in the BST and everything seems to work well but I cannot figure out this Find method. If someone could tell me what I am doing wrong and how to fix it this would be appreciated. </p>\n\n<pre><code>class Node\n    {          \n        public string number;\n        public string data;\n        public Node left;\n        public Node right;\n        public string Content;\n        public Node(string data)\n        {\n            this.data = data;\n        }\n    }\n    class BinarySearchTree\n    { \n        public Node root, current;\n        public BinarySearchTree()\n        {\n            this.root = null;\n        }\n\n        public void AddNode(string a) // code to insert nodes to the binary search tree\n        {\n            Node newNode = new Node(a); //create a new node\n            if (root == null) // if the tree is empty new node will be the root node\n                root = newNode;\n            else\n            {\n                Node previous;\n                current = root;\n\n                while (current != null)\n                {\n                    previous = current;\n\n                    if (a.CompareTo(current.data) &lt; 1) //if the new node is less than the            current node\n                    {\n                        current = current.left;\n                        if (current == null)\n                            previous.left = newNode;\n                    }                         \n                    else //if the new node is greater than the current node\n                    {\n                        current = current.right;\n\n                        if (current == null)\n                            previous.right = newNode;\n                    }\n                }\n            }\n        }\n\n        public string FindNode(Node node, string s)\n        {\n            if (root == null)\n                return Output = \"not found\";\n            else if (s.CompareTo(root.data) &lt; 1)\n                return FindNode(root.left, s);\n            else if (s.CompareTo(root.data) &gt; 1)\n                return FindNode(root.right, s);\n\n            return Output = \"found\";\n        }\n\n        string SearchResult = \"\";\n        static string Output = \"\";\n        public string Display(Node rootNode)\n        {\n            if (rootNode != null)\n            {\n                Display(rootNode.left);\n                Output += rootNode.data;\n                Display(rootNode.right);\n            }\n            return Output;\n        }           \n    }\n\n    private void btnExecute_Click(object sender, EventArgs e)\n    {\n        BinarySearchTree btree = new BinarySearchTree();\n        btree.AddNode(\"D\");\n        btree.AddNode(\"B\");\n        btree.AddNode(\"F\");\n        btree.AddNode(\"E\");\n        btree.AddNode(\"A\");\n        btree.AddNode(\"G\");\n        btree.AddNode(\"C\");\n        string target;\n        txtOutput.Text += \"The sorted values of the Binary Search Tree are: \\r\\n \\r\\n\";\n        txtOutput.Text += btree.Display(btree.root);\n        txtOutput.Text += btree.FindNode(btree.root, \"A\");\n\n    }\n</code></pre>\n"}, {"tags": ["c#", "c++", "com", "vb6", "regfreecom"], "comments": [{"owner": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "edited": false, "score": 0, "creation_date": 1448504708, "post_id": 33926756, "comment_id": 55620053, "body": "Have you tried sxstrace? Also, here is a similar question and answer, <a href=\"http://stackoverflow.com/questions/21924248/how-to-use-embedded-registration-free-manifest-for-activex-component-from-manage\" title=\"how to use embedded registration free manifest for activex component from manage\">stackoverflow.com/questions/21924248/&hellip;</a>."}, {"owner": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "reply_to_user": {"reputation": 9256, "user_id": 17776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6ba26f0f56f887d9e01c48e5ef040f75?s=128&d=identicon&r=PG", "display_name": "jac", "link": "https://stackoverflow.com/users/17776/jac"}, "edited": false, "score": 1, "creation_date": 1448507296, "post_id": 33926756, "comment_id": 55620665, "body": "Yes I&#39;ve used sxstrace. I got past all the problems it reported and now when I run it, the log is empty. The other question you linked to appears to talk about C# client whereas I want a C# COM server."}, {"owner": {"reputation": 7399, "user_id": 800524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02839e8311c198171b66b57d1d0cc023?s=128&d=identicon&r=PG", "display_name": "acelent", "link": "https://stackoverflow.com/users/800524/acelent"}, "edited": false, "score": 0, "creation_date": 1448619265, "post_id": 33926756, "comment_id": 55667992, "body": "You should declare <code>IClass1</code> in your assembly manifest as well."}, {"owner": {"reputation": 7399, "user_id": 800524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02839e8311c198171b66b57d1d0cc023?s=128&d=identicon&r=PG", "display_name": "acelent", "link": "https://stackoverflow.com/users/800524/acelent"}, "edited": false, "score": 0, "creation_date": 1448620906, "post_id": 33926756, "comment_id": 55668994, "body": "Also, you seem to have added the necessary <code>file</code> element, so it seems like a solution to <a href=\"http://stackoverflow.com/q/33837803/800524\">a previous question</a>.  Perhaps you should answer your own question and mark it as accepted."}, {"owner": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "edited": false, "score": 0, "creation_date": 1448631043, "post_id": 33926756, "comment_id": 55674601, "body": "BTW, I have reproduced this problem in C++ in two completely separate/different environments on two versions of Visual Studio. The newer one recreated from the info above was on Windows 10, VS Express 2012 and .NET 4.5. There are no manifest files for the C++ test, so I don&#39;t know what I could be missing."}, {"owner": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "reply_to_user": {"reputation": 7399, "user_id": 800524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02839e8311c198171b66b57d1d0cc023?s=128&d=identicon&r=PG", "display_name": "acelent", "link": "https://stackoverflow.com/users/800524/acelent"}, "edited": false, "score": 0, "creation_date": 1448631772, "post_id": 33926756, "comment_id": 55675009, "body": "@PauloMadeira I don&#39;t think adding the file element had any discernible effect so I don&#39;t think I have answers to either of my questions yet. Declaring IClass1 would make no difference in the C++ client because there are no explicitly created manifests in this case. The manifest is created and embedded implicitly, so I don&#39;t know what could be missing. It must be something in the .NET COM server DLL?"}], "answers": [{"comments": [{"owner": {"reputation": 1858, "user_id": 1040437, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c2cea78a2e9da9add2f8988d0f45700?s=128&d=identicon&r=PG", "display_name": "John Zabroski", "link": "https://stackoverflow.com/users/1040437/john-zabroski"}, "edited": false, "score": 0, "creation_date": 1572638731, "post_id": 34076433, "comment_id": 103633663, "body": "@BlueMonkMN You do Minnesota proud."}, {"owner": {"reputation": 1858, "user_id": 1040437, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c2cea78a2e9da9add2f8988d0f45700?s=128&d=identicon&r=PG", "display_name": "John Zabroski", "link": "https://stackoverflow.com/users/1040437/john-zabroski"}, "edited": false, "score": 0, "creation_date": 1572639009, "post_id": 34076433, "comment_id": 103633770, "body": "In my case, I was debugging an Excel add-in that had gotten registered under two different CLSID&#39;s, and the old CLSID was winning out over the new CLSID. The CLSID was configured using a non-deterministic algorithm, and made deterministic it by annotating my C# type with a <code>Guid</code> and using <code>[ComRegisterFunction]</code> attribute on <code>public static void RegisterFunction(Type type) { Registry.ClassesRoot.CreateSubKey(GetSubKeyName(type)); }</code> where GetSubKeyName is defined as <code>private static string GetSubKeyName(Type type) {return &quot;CLSID\\\\{&quot; + type.GUID.ToString().ToUpper() + &quot;}\\\\Programmable&quot;; }</code>"}], "tags": [], "owner": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "is_accepted": true, "score": 15, "last_activity_date": 1457048312, "last_edit_date": 1457048312, "creation_date": 1449177940, "answer_id": 34076433, "question_id": 33926756, "link": "https://stackoverflow.com/questions/33926756/managed-reg-free-com-server-wont-activate/34076433#34076433", "title": "Managed Reg-Free COM Server Won&#39;t Activate", "body": "<p>After many trials working through various samples with Microsoft support, I have identified <em>many</em> pitfalls that arise in attempting to implement a managed COM server with an unmanaged C++ COM client. Here are the key pieces of information that I recall, which can be applied to the sample code in the question to make sure it works.</p>\n\n<ol>\n<li>The client should not use the Isolated COM settings in the C++ project. My memory is fading, but Microsoft support tells me this is for something else -- I think for developing an isolated COM interface to an un-managed COM server instead of a managed COM server. Although this is not at all clear from its description at <a href=\"https://msdn.microsoft.com/en-us/library/zzbcs3x5(v=vs.120).aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/zzbcs3x5(v=vs.120).aspx</a>.</li>\n<li>The client may select \"Yes\" or \"No\" for the \"Embed Manifest\" setting, but if \"Yes\" is selected, then the manifest that includes the dependent assembly information must be provided as an input manifest file. If the embedded manifest does not contain dependent assembly information, then any external manifest file would be ignored. Also, make sure that the configuration (Debug, for example) being edited matches the configuration being tested!\n<a href=\"https://i.stack.imgur.com/5iblX.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/5iblX.png\" alt=\"enter image description here\"></a></li>\n<li>If the COM server is signed with a key (is strongly named), then the assemblyIdentity element in both the client manifest and the server manifest <em>must</em> contain a publicKeyToken, otherwise HRESULT error 0x80131040 will occur during CoCreateInstance.</li>\n<li>Embedding the RT_MANIFEST resource as a Win32 resource in managed code is not easy with Visual Studio 2013 because C# and VB.NET projects tend to want to embed resources as managed .NET resources, not Win32 resources (you can verify this by opening the DLL output file with the resource viewer and notice that .NET executables generally get a version resource and not much else, even if the project has a manifest file included). One way to get around this is to create a RC file like this:</li>\n</ol>\n\n<p>-</p>\n\n<pre><code>#define RT_MANIFEST 24\n#define MANIFEST_RESOURCE_ID 1\nMANIFEST_RESOURCE_ID RT_MANIFEST ClassLibrary1.manifest\n</code></pre>\n\n<p>Then add a pre-build step like this:</p>\n\n<pre><code>\"C:\\Program Files (x86)\\Windows Kits\\8.1\\bin\\x86\\rc.exe\"  \"$(ProjectDir)ClassLibrary1.rc\"\n</code></pre>\n\n<p>Then in the project settings \"Application\" tab, change the \"Resources\" to use ClassLibrary1.res instead of \"Icon and manifest\". But this comes with problems: firstly, the path to RC.EXE is not easy to define without hard-coding it; secondly, the version information from AssemblyInfoCommon will be ignored because the resources in the RC file totally replace all Win32 resources that would be generated by the .NET compiler.</p>\n\n<p>Another possibility is to simply keep the server COM DLL manifest file separate and not embed it as a resource. I have read that this may not be reliable, but it works on Windows 7 Enterprise 64-bit SP1.</p>\n\n<ol start=\"5\">\n<li>To ensure that the unmanaged client loads the proper .NET runtime, it needs a config file (<code>ConsoleApplication1.exe.config</code>) that defines how to load .NET. For .NET 4.5, I have seen this work: </li>\n</ol>\n\n<p>-</p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;startup useLegacyV2RuntimeActivationPolicy=\"true\"&gt;\n    &lt;supportedRuntime version=\"v4.0\"/&gt;\n  &lt;/startup&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>While for .NET 3.5, it seems useLegacyV2RuntimeActivationPolicy needs to be switched:</p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;startup useLegacyV2RuntimeActivationPolicy=\"false\"&gt;\n    &lt;supportedRuntime version=\"v3.5\"/&gt;\n  &lt;/startup&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<ol start=\"6\">\n<li><p>It's important to check that all the framework and CLR versions are in sync. And it's important to understand that the CLR versions are not the same as the framework versions. For example, if you want to build a managed COM server on .NET 3.5, the CLR version (runtimeVersion) should be \"2.0.50727\", but the .NET version (supportedRuntime) should be \"v3.5\".</p></li>\n<li><p>Make sure that the COM server's .NET Framework target version matches the client's supportedRuntime. If it is being built from the command line, it may not be picking up the framework version from the Visual Studio project file (for example, if you are running the C# of VB.NET compiler directly instead of calling MSBuild), make sure that the build is targeting the right version of the framework.</p></li>\n</ol>\n\n<p>I have not validated all the above yet, but intend to walk through this whole process soon to verify that I caught everything. Here is what I ended up with that I haven't mentioned yet:</p>\n\n<p><strong>ConsoleApplication1.exe.manifest</strong> (in source directory, gets copied or embeded into output directory at build time)</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"&gt;\n\n&lt;assemblyIdentity\n            type = \"win32\"\n            name = \"ConsoleApplication1\"\n            version = \"1.0.0.0\" /&gt;\n&lt;dependency&gt;\n            &lt;dependentAssembly&gt;\n                        &lt;assemblyIdentity\n                                    type=\"win32\"\n                                    name=\"ClassLibrary1\"\n                                    version=\"1.0.0.0\"\n                                    publicKeyToken=\"541b4aff0f04b60a\"/&gt;\n            &lt;/dependentAssembly&gt;\n&lt;/dependency&gt;\n&lt;/assembly&gt;\n</code></pre>\n\n<p><strong>ClassLibrary1.manifest</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;assembly manifestVersion=\"1.0\" xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n   &lt;assemblyIdentity type=\"win32\" name=\"ClassLibrary1\" version=\"1.0.0.0\" publicKeyToken=\"541b4aff0f04b60a\" /&gt;\n   &lt;clrClass clsid=\"{81723475-B5E3-4FA0-A3FE-6DE66CEE211C}\" progid=\"ClassLibrary1.Class1\" threadingModel=\"both\" name=\"ClassLibrary1.Class1\" runtimeVersion=\"v2.0.50727\"&gt;&lt;/clrClass&gt;\n&lt;/assembly&gt;\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Now to go through and validate every detail with full error message info etc.</p>\n\n<p>I start by creating a single solution containing two projects with all default values and the code shown in the question. I begin with no manifest files nor any of the project settings mentioned in the question, and will explicitly call out when I am making these changes in the process below. These are the steps and errors that are on the path to making this project work.</p>\n\n<ol>\n<li>Error: \"Class1: Undeclared identifier\". Need to run a Developer Command Prompt and execute the following command line in order to get a TLB file that the C++ code can import: <code>tlbexp ClassLibrary1.dll</code></li>\n<li>Move the TLB file into the ConsoleApplication1 project directory and re-build. Same Error.</li>\n<li>Replace the angle brackets on <code>#import &lt;ClassLibrary1.tlb&gt; raw_interfaces_only</code> with quotes, so it reads <code>#import \"ClassLibrary1.tlb\" raw_interfaces_only</code>. Rebuild: Success.</li>\n<li>At this point, if we run we get <code>Error 80040154</code> (Class not registered) because we have not registered the component nor set up registration-free COM.</li>\n<li>Knowing that trying to set up Isolated COM in the client would present <code>Error  800401f9</code> we'll skip that and just try to create a client manifest. Create a new text file with the following content, and save it as ConsoleApplication1.exe.manifest in the ConsoleApplication1 project directory:</li>\n</ol>\n\n<p>-</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"&gt;\n   &lt;assemblyIdentity type=\"win32\" name=\"ConsoleApplication1\" version=\"1.0.0.0\" /&gt;\n   &lt;dependency&gt;\n   &lt;dependentAssembly&gt;\n   &lt;assemblyIdentity name=\"ClassLibrary1\" version=\"1.0.0.0\" /&gt;\n   &lt;/dependentAssembly&gt;\n   &lt;/dependency&gt;\n&lt;/assembly&gt;\n</code></pre>\n\n<ol start=\"6\">\n<li>At this point it appears the steps mentioned earlier in this solution are a little over-complicated. You can simply include the manifest file in the project by showing hidden files, and using the \"Include In Project\" command on the manifest file.</li>\n<li>Running at this point would present the error message \"The application has failed to start because its side-by-side configuration is incorrect. Please see the application event log or use the command line sxstrace.exe tool for more detail.\" This is partly because we haven't put ClassLibrary1.dll anywhere where ConsoleApplication1.exe can find it. The parsed sxstrace output at this point looks like this:</li>\n</ol>\n\n<p>-</p>\n\n<pre><code>INFO: Parsing Manifest File C:\\Users\\bmarty\\Documents\\Visual Studio 2013\\Projects\\RegFreeCOM\\Debug\\ConsoleApplication1.exe.\n    INFO: Manifest Definition Identity is ConsoleApplication1,type=\"win32\",version=\"1.0.0.0\".\n    INFO: Reference: ClassLibrary1,version=\"1.0.0.0\"\nINFO: Resolving reference ClassLibrary1,version=\"1.0.0.0\".\n    INFO: Resolving reference for ProcessorArchitecture ClassLibrary1,version=\"1.0.0.0\".\n        INFO: Resolving reference for culture Neutral.\n            INFO: Applying Binding Policy.\n                INFO: No binding policy redirect found.\n            INFO: Begin assembly probing.\n                INFO: Did not find the assembly in WinSxS.\n                INFO: Attempt to probe manifest at C:\\Users\\bmarty\\Documents\\Visual Studio 2013\\Projects\\RegFreeCOM\\Debug\\ClassLibrary1.DLL.\n                INFO: Attempt to probe manifest at C:\\Users\\bmarty\\Documents\\Visual Studio 2013\\Projects\\RegFreeCOM\\Debug\\ClassLibrary1.MANIFEST.\n                INFO: Attempt to probe manifest at C:\\Users\\bmarty\\Documents\\Visual Studio 2013\\Projects\\RegFreeCOM\\Debug\\ClassLibrary1\\ClassLibrary1.DLL.\n                INFO: Attempt to probe manifest at C:\\Users\\bmarty\\Documents\\Visual Studio 2013\\Projects\\RegFreeCOM\\Debug\\ClassLibrary1\\ClassLibrary1.MANIFEST.\n                INFO: Did not find manifest for culture Neutral.\n            INFO: End assembly probing.\n    ERROR: Cannot resolve reference ClassLibrary1,version=\"1.0.0.0\".\nERROR: Activation Context generation failed.\nEnd Activation Context Generation.\n</code></pre>\n\n<ol start=\"8\">\n<li>Copying the ClassLibrary1.dll file into the same directory as ConsoleApplication1.exe doesn't change anything because we haven't provided any manifest for the file by which the COM dependency can be identified. So the next step is to create a manifest for ClassLibrary1. One version of ClassLibrary1.manifest is already present in the question. Let's try that one by creating a text file with that content and saving it in the ClassLibrary1 project directory as ClassLibrary1.manifest. To include it in the project, let's try the same simple \"Include in Project\" command (again, turning on the visibility of hidden files to make that possible). Now what happens when copying the new ClassLibrary1.dll to the directory with ConsoleApplication1.exe and running?</li>\n<li>The same error and sxstrace results occur because a manifest file in a managed DLL does not get embedded as a Win32 resource, as you can verify by opening the DLL file with Visual Studio, which shows the file's Win32 resources. It shows the version resource and nothing else. So let's exclude the manifest from the ClassLibrary1 and just copy the manifest file over to ConsoleApplication1.exe's location as an external file instead.</li>\n<li>Success! The program runs and completes normally. But what if we want to use a component built with a different version of .NET framework. Or maybe your test isn't working at this point because your Visual Studio defaulted to a different version? Right now I see that my ClassLibrary1 project defaulted to .NET 3.5. What happens if I change it to 4.0, rebuild, copy and run again?</li>\n<li>Error 8013101b occurs. That corresponds (according to a google search) to COR_E_NEWER_RUNTIME which also means \"A module specified in the manifest was not found.\" This happens when, for example, an EXE that loaded .NET 2.0 is trying to reference a DLL built with .NET 4.0. So now we have to tell the un-managed client EXE which version of the .NET framework to load as it resolves its COM reference. This is done with a config file named ConsoleApplication1.exe.config. Just create a new text file and save it with that name in the ConsoleApplication1.exe directory. It has the following content:</li>\n</ol>\n\n<p>-</p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;startup useLegacyV2RuntimeActivationPolicy=\"true\"&gt;\n    &lt;supportedRuntime version=\"v4.0\"/&gt;\n  &lt;/startup&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>The same error would still occur if useLegacyV2RuntimeActivationPolicy were excluded in this case. Unfortunately, I don't fully understand why, but I suspect it has something to do with the newer v4.0 runtime activation policy defaulting to loading CLR v2.0 if the executable being loaded does not explicitly reference .NET 4.0 (which un-managed code does not because it doesn't explicitly reference .NET period).</p>\n\n<ol start=\"12\">\n<li>Success again! But wait, there's more. What if your COM dll is signed with a key (has a strong name)? Let's add a key to ClassLibrary1, configure it to be used in signing the DLL on the project's \"Signing\" tab, and see what happens when we copy the updated DLL to ConsoleApplication1.exe's directory.</li>\n<li>Now we get Error 80131040 (\"The located assembly's manifest definition does not match the assembly reference\"). And sxstrace, and fuslogvw are frustratingly unhelpful here in yielding <em>any</em> information about what is going on. Fortunately, I now know, in this particular reg-free-com scenario, it's caused by the lack of the publicKeyToken attribute on the assemblyIdentity elements describing ClassLibrary1 (in both manifest files). But how do you get the publicKeyToken value? Run <code>sn -T ClassLibrary1.dll</code> from a developer command prompt. After updating ClassLibrary1.manifest and ConsoleApplication1.exe.manifest, remember to rebuild ConsoleApplication1.exe if the manifest is embedded, and to copy ClassLibrary1.manifest to the ConsoleApplication1.exe directory. Run again and?</li>\n<li>I went through a few more gyrations of error solving with the help of sxstrace, but that was due to stupid errors. For the benefit of others who make stupid errors, here are some more things to be aware of if you're getting sxstrace errors: a) make sure you're using the attribute <code>publicKeyToken</code> and not some other ridiculous name like <code>privateKeyToken</code>; b) Make sure that all the attributes you specified in the assemblyIdentity on the server side manifest match those on the client side manifest, and that you don't have <code>type=\"win32\"</code> specified on one but not the other.</li>\n<li>Success! The output is <code>B Inserted obby</code></li>\n</ol>\n\n<p>I should also note that the VB6 client also works by using the following files along with the VB6 client:</p>\n\n<p><strong>Project1.exe.config:</strong></p>\n\n<pre><code>&lt;configuration&gt;\n  &lt;startup useLegacyV2RuntimeActivationPolicy=\"true\"&gt;\n    &lt;supportedRuntime version=\"v4.0\"/&gt;\n  &lt;/startup&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p><strong>Project1.exe.manifest:</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"&gt;\n   &lt;assemblyIdentity type=\"win32\" name=\"Project1\" version=\"1.0.0.0\" /&gt;\n   &lt;dependency&gt;\n   &lt;dependentAssembly&gt;\n   &lt;assemblyIdentity name=\"ClassLibrary1\" version=\"1.0.0.0\" publicKeyToken=\"541b4aff0f04b60a\" /&gt;\n   &lt;/dependentAssembly&gt;\n   &lt;/dependency&gt;\n&lt;/assembly&gt;\n</code></pre>\n\n<p>However, there does seem to be a tendency to report \"ActiveX Component Can't Create Object\" (Runtime error 429) in rare cases when the executable is built and run before creating the configuration and manifest files. Rebuilding the EXE file seems to fix it, but then I can't get the problem to come back, so it's hard to identify a specific cause.</p>\n\n<p>I thought I was a reasonably good problem solver, but something about the numerous moving parts and numerous unhelpful error codes and error messages reported in reg-free com configuration problems makes this nearly impossible to figure out without some solid experience, inside knowledge or Microsoft source code. Hopefully this answer will help others acquire similar experience. Please extend this answer if you learn more!</p>\n\n<h1>Addendum 1</h1>\n\n<p>The managed COM server's manifest <em>can</em> be properly and easily embedded if you use the \"Add\"->\"New Item...\" command on the project to add an \"Application Manifest File\". This adds a file called app.manifest to the project. But the real tricky part is that it does so in a way that cannot be replicated any other way via the Visual Studio UI, except through one screwy work-around. Since the \"Manifest\" field on the \"Application\" tab of the project settings window is disabled for \"Class Library\" type projects, the manifest, which would normally be set here, cannot be set for a class library. But you can temporarily change the project to a Windows Application, change the Manifest selection here, then restore it to a Class Library. The setting will stick so the selected manifest gets properly embedded. You can verify the setting in a text editor by viewing the project file. Look for:</p>\n\n<pre><code>&lt;PropertyGroup&gt;\n  &lt;ApplicationManifest&gt;app.manifest&lt;/ApplicationManifest&gt;\n&lt;/PropertyGroup&gt;\n</code></pre>\n\n<h1>Addendum 2</h1>\n\n<p>Error 0x80131040 can still occur with all the above precautions taken. To help narrow down the cause of this, it helps to use the fusion log viewer to see more information about what is happening as assemblies are being loaded and resolved. Google \"Fuslogvw\" for more information about how to view this log (fuslogvw.exe is a utility provided when Visual Studio is installed). It's also important to realize that this application, by default, apparently does not show any information until you configure it to log information to files, reproduce the problem, then restart the application to read the log files after they are produced. And, according to MSDN documentation, it's also important to remember to run this utility as administrator.</p>\n\n<p>Once you've passed all the hurdles to running fuslogvw.exe, you may see something like this in the log:</p>\n\n<pre><code>WRN: Comparing the assembly name resulted in the mismatch: Major Version\nERR: The assembly reference did not match the assembly definition found.\nERR: Failed to complete setup of assembly (hr = 0x80131040). Probing terminated.\n</code></pre>\n\n<p>Despite the fact that the COM server's manifest file listed the version as 1.0.0.0, that is not the (only) version used when binding from a COM client reference to the server. My client EXE file was trying to reference 1.0.0.0, which exactly matched the version in the COM server's manifest file, but it did not match the .NET version of the DLL. After correcting both the client and server manifest files to reflect the version actually in the .NET server DLL, then error 0x80131040 went away, and fuslogvw.exe was the key to identifying that as the source of the problem.</p>\n\n<p>If the Client manifest is in sync with the actual .NET DLL version, but the server DLL's manifest file does not reflect this version, a different error will occur:</p>\n\n<blockquote>\n  <p>The application has failed to start because its side-by-side\n  configuration is incorrect. Please see the application event log or\n  use the command-line sxstrace.exe tool for more detail.</p>\n</blockquote>\n\n<h1>Addendum 3</h1>\n\n<p>Error 0xc0150002 or the following message may be reported:</p>\n\n<blockquote>\n  <p>The application was unable to start correctly (0xc0150002), Click OK\n  to close the application.</p>\n</blockquote>\n\n<p>I have seen this occur in a case where the client manifest was embedded in an unmanaged DLL rather than an unmanaged EXE, <em>and</em> the manifest's <code>assemblyIdentity</code> element did not exactly match the server's <code>assemblyIdentity</code>. The client had an extra <code>processorArchitecture=\"x86\"</code> in it that the server did not specify, causing a mismatch. Unfortunately I don't know how to learn this without luckily thinking to check the manifest files to see that they match (or reading this article). That error doesn't clearly point to a manifest file being the source of the problem, so you just have to be aware that there's a possible correlation between that error message and this cause.</p>\n\n<h1>Addendum 4</h1>\n\n<p>I have seen external manifest files get completely ignored yielding a completely empty sxstrace log, even when the executables involved have no embedded manifests. This can apparently happen as a result of the activation context cache (a problem documented at <a href=\"http://csi-windows.com/blog/all/27-csi-news-general/245-find-out-why-your-external-manifest-is-being-ignored\" rel=\"noreferrer\">http://csi-windows.com/blog/all/27-csi-news-general/245-find-out-why-your-external-manifest-is-being-ignored</a>). To work around this problem you can use the following command to touch the date stamp of the file whose manifest is being ignored:</p>\n\n<pre><code>copy /b myfile.exe+,,\n</code></pre>\n\n<h1>Addendum 5</h1>\n\n<p>I have seen another hard-to-explain Class Not Registered error (<code>0x80040154</code> - <code>REGDB_E_CLASSNOTREG</code>) that occurs when calling CoCreateInstance under the following conditions:</p>\n\n<ol>\n<li>An CPP file contains a constructor for a class that is instantiated in global scope so dynamic initialization will call the constructor during <code>DllMain</code> if the <code>/clr</code> switch is <strong>not</strong> applied to the CPP file, or during <code>.cctor</code> if the <code>/clr</code> switch <strong>is</strong> applied to the file.</li>\n<li>The DLL has an embedded manifest to make it be able to reference the COM class being created via Reg-Free COM.</li>\n<li>The COM DLL is implemented in managed code (with a COM-Callable Wrapper aka CCW) in .NET 2.0.</li>\n<li>The EXE that loaded the DLL does <strong>not</strong> have a Reg-Free Manifest referencing the created COM class.</li>\n<li>The COM DLL is <strong>not</strong> registered with <code>regasm</code>.</li>\n<li>The CPP file calling <code>CoCreateInstance</code> has the <code>/clr</code> switch applied to the C++ compiler settings.</li>\n</ol>\n\n<p>If any of the last 3 conditions are altered, the problem goes away. (Additionally, if the last condition is altered, you may get a loader lock due to #1 -- read about loader lock and it's relation to CLR at <a href=\"https://msdn.microsoft.com/en-us/library/ms173266.aspx\" rel=\"noreferrer\" title=\"Initialization of Mixed Assemblies\">Initialization of Mixed Assemblies</a>). So if you are encountering a Class Not Registered error in similar circumstances, consider whether you can alter any of those last 3 conditions to resolve the error.\n<strong>Note:</strong> I'm having a hard time nailing down the behavior of #6. It seems the effect of switching this also depends the state of #1. It looks like calling the constructor (including its <code>CoCreateInstance</code>) after the DLL is fully loaded still causes Class Not Registered whereas calling the constructor during the DLL initialization will succeed if the <code>/clr</code> switch is not specified. My solution for the time being is to re-code the client CPP file in managed C++ since it was a relatively simple interface class between the COM component and the rest of the un-managed code. So now there's no more COM in this client, just a .NET reference.</p>\n"}, {"comments": [{"owner": {"reputation": 1268, "user_id": 1475411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP52h.png?s=128&g=1", "display_name": "MNS", "link": "https://stackoverflow.com/users/1475411/mns"}, "reply_to_user": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "edited": false, "score": 0, "creation_date": 1510028877, "post_id": 47078217, "comment_id": 81249679, "body": "@BlueMonkMN No. Every time a clean build was taken and an external manifest file for client exe was copied to debug folder using post build event. So Addendum 4 was met implicitly."}, {"owner": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "edited": false, "score": 0, "creation_date": 1510061466, "post_id": 47078217, "comment_id": 81267858, "body": "Is it possible the activation context was cached by some action that happened before the copy, and followed the copied file based on a checksum or signature or something, and so did not get refreshed in the new location? It would be interesting to know if the cache was involved somehow because it seems odd that there would be <i>no</i> activation context."}, {"owner": {"reputation": 1268, "user_id": 1475411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP52h.png?s=128&g=1", "display_name": "MNS", "link": "https://stackoverflow.com/users/1475411/mns"}, "reply_to_user": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "edited": false, "score": 0, "creation_date": 1510127700, "post_id": 47078217, "comment_id": 81297714, "body": "I don&#39;t know whether activation context is getting cached or not. But even if it is getting cached, I don&#39;t expect <code>class not registered</code> message during <code>CreateInstance</code>.  When call to <code>CreateActCtx</code> is commented, it still continues to report this message. I think my problem closely matches to what you explained in Addendum 5. In that, conditions 2 and 5 are true and rest of them are false in my scenario."}], "tags": [], "owner": {"reputation": 1268, "user_id": 1475411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YP52h.png?s=128&g=1", "display_name": "MNS", "link": "https://stackoverflow.com/users/1475411/mns"}, "is_accepted": false, "score": 1, "last_activity_date": 1509634294, "creation_date": 1509634294, "answer_id": 47078217, "question_id": 33926756, "link": "https://stackoverflow.com/questions/33926756/managed-reg-free-com-server-wont-activate/47078217#47078217", "title": "Managed Reg-Free COM Server Won&#39;t Activate", "body": "<p>To all my frustrations, BlueMonkMN's explanation was really useful but yet I encountered the <code>Class not registered</code> message.</p>\n\n<p>I have a .NET 4.6 COM interop Dll and a C++ client which makes use of Registration Free COM by the means of Windows SxS technology. Assembly manifest was embedded inside the COM Dll and the application manifest was put outside, as a separate .manifest file.   </p>\n\n<p>Everything was working as advertised but it started getting the <code>Class not registered</code> message during <code>CreateInstance</code> when any one of the following happens.</p>\n\n<ul>\n<li>Copy the interop COM Dll along with C++ client executable and the\nmanifest file to some other directory.</li>\n<li>Make non COM related changes to C++ client and then rebuild the\napplication.</li>\n</ul>\n\n<p>In this situation, to add insult to injury, <code>sxstrace</code> log was empty, application event log (<code>eventvwr</code>) didn't report any SideBySide error and the Assembly Binding Log Viewer (<code>FUSLOGVW.exe</code>) didn't show anything from the C++ client application.  </p>\n\n<p>Let me add another Addendum to BlueMonkMN's answer ablove.</p>\n\n<h1>Addendum 6</h1>\n\n<p>What I understand from my so far experiments is that, in such a case, the Activation Context for the C++ client application is not getting created.</p>\n\n<p>In such a situation one need to create the Activation context by themselves. </p>\n\n<p>Following code is put inside the C++ client application, after a call to <code>CoInitialize(0);</code> and before making any call to <code>CreateInstance</code>.</p>\n\n<pre><code>ACTCTX context;\nmemset(&amp;context, 0, sizeof(context));\n\ncontext.cbSize = sizeof(context);\ncontext.lpSource = L\"CPPClient.exe.manifest\";\ncontext.lpAssemblyDirectory = L\"D:\\\\code\\\\vs2017\\\\CPPClient\\\\Debug\";\ncontext.dwFlags = ACTCTX_FLAG_ASSEMBLY_DIRECTORY_VALID; \n\nHANDLE hActCtx = CreateActCtx(&amp;context);\n\nULONG_PTR cookie = 0;\nBOOL result = ActivateActCtx(hActCtx, &amp;cookie);\n\n//Rest of the code goes here.\n</code></pre>\n\n<p>As a cleanup measure, following piece of code is put just before a call to <code>CoUninitialize();</code></p>\n\n<pre><code>DeactivateActCtx(0, cookie);\nReleaseActCtx(hActCtx);\n</code></pre>\n\n<p>Now it sounds good. Side by Side is working very well. If anything goes wrong, then it can be seen in sxstrace or in application event log or in Assembly Binding Log Viewer.</p>\n"}], "owner": {"reputation": 23367, "user_id": 78162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1497a61bc7f673e30f224a3df61a6742?s=128&d=identicon&r=PG", "display_name": "BlueMonkMN", "link": "https://stackoverflow.com/users/78162/bluemonkmn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2382, "favorite_count": 7, "accepted_answer_id": 34076433, "answer_count": 2, "score": 11, "last_activity_date": 1509634294, "creation_date": 1448487089, "question_id": 33926756, "link": "https://stackoverflow.com/questions/33926756/managed-reg-free-com-server-wont-activate", "title": "Managed Reg-Free COM Server Won&#39;t Activate", "body": "<p>I started with a very sophisticated system of clients and servers with COM references and other things, and I've cut down and down until I realized I can't even get Microsoft sample code to work for registration free COM activation of a managed COM server written in C#.</p>\n\n<p>Server code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Runtime.InteropServices.ComTypes;\nusing System.Runtime.InteropServices;\nusing System.ComponentModel;\n\nnamespace ClassLibrary1\n{\n   [Guid(\"A7AC6D8C-FF17-4D2C-A3B1-2C8690A8EA04\")\n   ,ComVisible(true)]\n   public interface IClass1\n   {\n      [DispId(1)]\n      string DummyFunction(string inputValue);\n   }\n\n   [Guid(\"81723475-B5E3-4FA0-A3FE-6DE66CEE211C\"),\n   ClassInterface(ClassInterfaceType.None),\n   ComDefaultInterface(typeof(IClass1)),\n   ComVisible(true)]\n   public class Class1 : IClass1\n   {\n      public string DummyFunction(string inputValue)\n      {\n         return inputValue.Substring(0, 1) + \" Inserted \" + inputValue.Substring(1);\n      }\n   }\n}\n</code></pre>\n\n<p>Client VB6 Code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim c As ClassLibrary1.Class1\nSet c = New Class1\nMsgBox c.DummyFunction(\"Ben\")\n</code></pre>\n\n<p>Client C++ Code:</p>\n\n<p></p>\n\n<pre><code>#include \"stdafx.h\"\n\n#import &lt;ClassLibrary1.tlb&gt; raw_interfaces_only\n\nusing namespace ClassLibrary1;\n\nint _tmain(int argc, _TCHAR* argv[])\n{\n   IClass1Ptr p;\n\n   HRESULT hr = CoInitializeEx(NULL, COINIT_MULTITHREADED);\n   hr = CoCreateInstance(__uuidof(Class1), NULL, CLSCTX_INPROC_SERVER, __uuidof(IClass1), (void **)&amp;p);\n   if (FAILED(hr))\n   {\n      _tprintf_s(_T(\"Error %x\\n\"), hr);\n      CoUninitialize();\n      return 1;\n   }\n   _bstr_t b = _T(\"Bobby\");\n   BSTR b2;\n   p-&gt;DummyFunction(b, &amp;b2);\n   wprintf_s(L\"%s\\n\", b2);\n   p-&gt;Release();\n   CoUninitialize();\n    return 0;\n}\n</code></pre>\n\n<p>Both of the clients work fine when I remove all Reg-Free COM code and register the ClassLibrary1.dll with regasm /codebase.</p>\n\n<p>Then I unregister ClassLibrary1, and try to introduce Reg-Free COM for the VB6 client with the file Project1.exe.manifest:</p>\n\n\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"&gt;\n   &lt;assemblyIdentity type=\"win32\" name=\"Project1\" version=\"1.0.0.0\" /&gt;\n   &lt;dependency&gt;\n   &lt;dependentAssembly&gt;\n   &lt;assemblyIdentity name=\"ClassLibrary1\" version=\"1.0.0.0\" /&gt;\n   &lt;/dependentAssembly&gt;\n   &lt;/dependency&gt;\n&lt;/assembly&gt;\n</code></pre>\n\n<p>And ClassLibrary1.manifest:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;assembly manifestVersion=\"1.0\" xmlns=\"urn:schemas-microsoft-com:asm.v1\"&gt;\n   &lt;assemblyIdentity version=\"1.0.0.0\" name=\"ClassLibrary1\" /&gt;\n   &lt;clrClass clsid=\"{81723475-B5E3-4FA0-A3FE-6DE66CEE211C}\" name=\"ClassLibrary1.Class1\" tlbid=\"{F8A2D334-5BBB-4007-8308-A1417052E6D6}\"&gt;&lt;/clrClass&gt;\n   &lt;file name=\"ClassLibrary1.dll\" &gt;&lt;/file&gt;\n&lt;/assembly&gt;\n</code></pre>\n\n<p>Now I get Error 429 (ActiveX Component can't create object) sometimes, and (inexplicably) an automation error other times:</p>\n\n<blockquote>\n  <p>Run-time error '-2146234304 (80131040)':\n  Automation Error</p>\n</blockquote>\n\n<p>then I try to introduce COM Isolation into the C++ client:\n<a href=\"https://i.stack.imgur.com/RPqGG.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/RPqGG.png\" alt=\"Isolated COM Type Library=F:\\Lib\\ClassLibrary1.tlb - Component File Name=ClassLibrary1.dll\"></a></p>\n\n<p>Now when I run the C++ client, the output is merely</p>\n\n<blockquote>\n  <p>Error 800401f9</p>\n</blockquote>\n"}, {"tags": ["c#", "sql", "asp.net"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 1, "creation_date": 1448487154, "post_id": 33926725, "comment_id": 55614466, "body": "what does the header in this .aspx file look like. are you using <code>CodeFile=</code> or <code>CodeBehind=</code> if make sure you have <code>CodeBehind=</code>"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1448487240, "post_id": 33926725, "comment_id": 55614502, "body": "@M.kazem Akhgary how is your comment helpful or productive. it&#39;s quite obvious the the code behind can&#39;t find the <code>Label2.Text</code> what&#39;s your actual comment"}, {"owner": {"reputation": 775, "user_id": 2847379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9ec73d9e807b93deae33c4cf922fed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michael McGriff", "link": "https://stackoverflow.com/users/2847379/michael-mcgriff"}, "edited": false, "score": 0, "creation_date": 1448487283, "post_id": 33926725, "comment_id": 55614516, "body": "Show the <code>Page</code> declaration on the aspx file."}], "answers": [{"tags": [], "owner": {"reputation": 2541, "user_id": 4004002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TZlts.jpg?s=128&g=1", "display_name": "DVK", "link": "https://stackoverflow.com/users/4004002/dvk"}, "is_accepted": false, "score": 2, "last_activity_date": 1448487860, "creation_date": 1448487860, "answer_id": 33926924, "question_id": 33926725, "link": "https://stackoverflow.com/questions/33926725/the-name-does-not-exist-in-the-current-context/33926924#33926924", "title": "The name &#39; &#39; does not exist in the current context", "body": "<p>Your label is inside of an item template, which means you cannot just access it any old place on the page.  If you want to gain access to the value inside the label, then you need to tie into one of the DataList events, such as OnItemCommand (if you wanted to access the value as the result of a command button click, for instance).  You can use FindControl inside of the event handler to access the value.  For example:</p>\n\n<pre><code>&lt;asp:DataList runat=\"server\" ID=\"test\" OnItemCommand=\"test_ItemCommand\"&gt;\n    &lt;ItemTemplate&gt;\n        &lt;asp:Label runat=\"server\" ID=\"Label2\" Text=\"Test\" /&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:DataList&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>protected void test_ItemCommand(object source, System.Web.UI.WebControls.DataListCommandEventArgs e)\n{\n    if (e.Item != null)\n    {\n        var label2 = e.Item.FindControl(\"Label2\");\n\n        if (label2 != null &amp;&amp; label2 is Label)\n        {\n            var productID = ((Label)label2).Text;\n\n            // now you have the contents of the label's text property\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5606071, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DIoIi.jpg?s=128&g=1", "display_name": "LEgXr", "link": "https://stackoverflow.com/users/5606071/legxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1629, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448487866, "creation_date": 1448486986, "last_edit_date": 1448487097, "question_id": 33926725, "link": "https://stackoverflow.com/questions/33926725/the-name-does-not-exist-in-the-current-context", "title": "The name &#39; &#39; does not exist in the current context", "body": "<p>The name 'Label2.Text' does not exist in the current context\nCatalog.aspx</p>\n\n<pre><code> &lt;asp:DataList ID=\"DataList1\" runat=\"server\" DataKeyField=\"Id\" DataSourceID=\"SqlDataSource1\" RepeatColumns=\"4\" RepeatLayout=\"Flow\"&gt;\n    &lt;ItemTemplate&gt;\n        &lt;div class=\"Item\"&gt;\n            &lt;div class=\"name\"&gt;\n                &lt;asp:Label ID=\"NameLabel\" runat=\"server\" Text='&lt;%# Eval(\"Name\") %&gt;' /&gt;\n            &lt;/div&gt;\n            &lt;div&gt;\n                \u041a\u043e\u0434:&lt;asp:Label ID=\"Label2\" runat=\"server\" Text='&lt;%# Eval(\"Id\") %&gt;' /&gt;\n            &lt;/div&gt;\n            &lt;img src=\"&lt;%# Eval(\"Image\") %&gt;\" height=\"115\" alt=\"item\"/&gt;\n            &lt;div class=\"price\"&gt;\n                \u0426\u0435\u043d\u0430:\n\n                &lt;asp:Label ID=\"PriceLabel\" runat=\"server\" Text='&lt;%# Eval(\"Price\")%&gt;' /&gt;p.\n                &lt;asp:Button ID=\"Button2\" runat=\"server\" ForeColor=\"Black\" \n                    onclick=\"Button2_Click\" Text=\"\u0412 \u041a\u041e\u0420\u0417\u0418\u041d\u0423\" /&gt;\n            &lt;/div&gt;\n            &lt;div class=\"desc\"&gt;\n                &lt;asp:Label ID=\"DescriptionLabel\" runat=\"server\" Text='&lt;%# Eval(\"Description\") %&gt;' /&gt;\n\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:DataList&gt;\n</code></pre>\n\n<p>Catalog.aspx.cs</p>\n\n<pre><code>sqlCon.Open();\nSqlCommand cmd_SQL = new SqlCommand(\"INSERT INTO Cart(ClientId,ProductId,Amount) VALUES (@ClientId,@ProductId,@Amount)\", sqlCon);\ncmd_SQL.Parameters.Add(\"@ClientId\", SqlDbType.NVarChar).Value =Membership.GetUser().ProviderUserKey.ToString();\ncmd_SQL.Parameters.Add(\"@ProductId\", SqlDbType.NVarChar).Value =Label2.Text;\ncmd_SQL.Parameters.Add(\"@Amount\", SqlDbType.NVarChar).Value = 1;\n\ncmd_SQL.CommandType = CommandType.Text;\ncmd_SQL.ExecuteNonQuery();\n</code></pre>\n\n<p>The name 'Label2.Text' does not exist in the current context</p>\n"}, {"tags": ["c#", "json", "httpwebresponse", "memorystream", "large-object-heap"], "comments": [{"owner": {"reputation": 12857, "user_id": 1282539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d73911f3fb624361e7d39b82f9395cc1?s=128&d=identicon&r=PG", "display_name": "SimpleVar", "link": "https://stackoverflow.com/users/1282539/simplevar"}, "edited": false, "score": 1, "creation_date": 1448486821, "post_id": 33926576, "comment_id": 55614299, "body": "Why don&#39;t you try both and benchmark? Test with various sizes and you can choose a strategy (chunks or not) depending on the <code>Content-Length</code> header, so you&#39;ll be good with both small and large jsons."}, {"owner": {"reputation": 3273, "user_id": 4355338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rc5kr.jpg?s=128&g=1", "display_name": "Sievajet", "link": "https://stackoverflow.com/users/4355338/sievajet"}, "edited": false, "score": 0, "creation_date": 1448487217, "post_id": 33926576, "comment_id": 55614492, "body": "If you don&#39;t need the full bytearray at once, you can use a streamreader to read specific parts. this will reduce the memory pressure."}, {"owner": {"reputation": 57, "user_id": 3662316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jz7uE.jpg?s=128&g=1", "display_name": "Caca Milis", "link": "https://stackoverflow.com/users/3662316/caca-milis"}, "reply_to_user": {"reputation": 3273, "user_id": 4355338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rc5kr.jpg?s=128&g=1", "display_name": "Sievajet", "link": "https://stackoverflow.com/users/4355338/sievajet"}, "edited": false, "score": 0, "creation_date": 1448487970, "post_id": 33926576, "comment_id": 55614880, "body": "@Sievajet - I need the full byte array at once as it&#39;s passed to another object."}], "owner": {"reputation": 57, "user_id": 3662316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jz7uE.jpg?s=128&g=1", "display_name": "Caca Milis", "link": "https://stackoverflow.com/users/3662316/caca-milis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1448486302, "creation_date": 1448486302, "question_id": 33926576, "link": "https://stackoverflow.com/questions/33926576/httpwebresponses-how-efficient-is-memorystream-copyto-vs-chunking", "title": "HttpWebResponses: How efficient is MemoryStream.CopyTo vs chunking?", "body": "<p>I'm running into a problem with downloading large JSON objects from an API. Usually, this documents are small in size, but occasionally they are quite large (100k+). This puts the large object heap into play and there are some performance concerns.</p>\n\n<p>Here is the guts of the downloader method that returns the response bytes. </p>\n\n<pre><code>using (var httpWebResponse = (HttpWebResponse)request.GetResponse())\n{\n    byte[] responseBytes;\n    using (var responseStream = httpWebResponse.GetResponseStream())\n    {\n        using (var memoryStream = new MemoryStream())\n        {\n            if (responseStream != null)\n            {\n               responseStream.CopyTo(memoryStream);\n            }\n            responseBytes = memoryStream.ToArray();\n        }\n     }\n     return responseBytes;\n }\n</code></pre>\n\n<p>If the end goal is to get the contents of the webresponse into a byte array, is this the most efficient way to do this? In the past I would just read the stream in chunks. I've been told that this is less efficient than CopyTo for the 90% of the time (when the JSON response is sub-85k), but better for the other 10%.</p>\n\n<p>I cannot seem to find a general consensus on this. Any input would be appreciated.</p>\n"}, {"tags": ["c#", "uml", "diagram", "extends"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5606006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1a6e7395628cf96d2fefb26174f6fc9?s=128&d=identicon&r=PG&f=1", "display_name": "\u041f\u0430\u0432\u0435\u043b \u0425\u0432\u043e\u0439\u043d\u0438\u0446\u043a\u0438\u0439", "link": "https://stackoverflow.com/users/5606006/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb-%d0%a5%d0%b2%d0%be%d0%b9%d0%bd%d0%b8%d1%86%d0%ba%d0%b8%d0%b9"}, "edited": false, "score": 0, "creation_date": 1448487633, "post_id": 33926712, "comment_id": 55614687, "body": "Class Form is the System.Windows.Forms.Form and when i automatic generate code using this diagram, class Form shouldn&#39;t be in my project."}], "tags": [], "owner": {"reputation": 30989, "user_id": 3379653, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/f97JZ.png?s=128&g=1", "display_name": "qwerty_so", "link": "https://stackoverflow.com/users/3379653/qwerty-so"}, "is_accepted": true, "score": 1, "last_activity_date": 1448493847, "last_edit_date": 1448493847, "creation_date": 1448486936, "answer_id": 33926712, "question_id": 33926555, "link": "https://stackoverflow.com/questions/33926555/display-system-class-inheritance-in-uml-class-diagramc/33926712#33926712", "title": "Display System class inheritance in UML class diagram(c#)", "body": "<p>Use a generalization like this: <a href=\"https://i.stack.imgur.com/8Y29X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Y29X.png\" alt=\"enter image description here\"></a></p>\n\n<p>or this: <a href=\"https://i.stack.imgur.com/i3BOZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i3BOZ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 5606006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1a6e7395628cf96d2fefb26174f6fc9?s=128&d=identicon&r=PG&f=1", "display_name": "\u041f\u0430\u0432\u0435\u043b \u0425\u0432\u043e\u0439\u043d\u0438\u0446\u043a\u0438\u0439", "link": "https://stackoverflow.com/users/5606006/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb-%d0%a5%d0%b2%d0%be%d0%b9%d0%bd%d0%b8%d1%86%d0%ba%d0%b8%d0%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 33926712, "answer_count": 1, "score": 0, "last_activity_date": 1448493847, "creation_date": 1448486207, "last_edit_date": 1448488750, "question_id": 33926555, "link": "https://stackoverflow.com/questions/33926555/display-system-class-inheritance-in-uml-class-diagramc", "title": "Display System class inheritance in UML class diagram(c#)", "body": "<p>How can I show System class inheritance in a UML class diagram?</p>\n\n<p>Example:</p>\n\n<p>public class MyForm : Form</p>\n\n<p>Form is the System class of c#</p>\n"}, {"tags": ["c#", "mysql", "asp.net", "web-services", "gridview"], "owner": {"reputation": 185, "user_id": 2148116, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/106e0b39bf9bc55644ac0cda8e955ee6?s=128&d=identicon&r=PG", "display_name": "user2148116", "link": "https://stackoverflow.com/users/2148116/user2148116"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3564, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448490173, "creation_date": 1448485883, "last_edit_date": 1448490173, "question_id": 33926470, "link": "https://stackoverflow.com/questions/33926470/insert-data-into-database-using-web-service-in-asp-net-using-c", "title": "insert data into database using web service in Asp.net using C#", "body": "<p>I was wondering if I could ask you to help me to insert data into database using web service in Asp.net using C#.\nI created database by MySql workbench and then I created Web service, after that I tried to apply tutorial in this link \n<a href=\"http://www.aspsnippets.com/Articles/Insert-data-into-database-using-Web-Service-in-ASPNet-using-C-and-VBNet.aspx\" rel=\"nofollow\">http://www.aspsnippets.com/Articles/Insert-data-into-database-using-Web-Service-in-ASPNet-using-C-and-VBNet.aspx</a>\n, but it did not work with me, this is the code in Service:</p>\n\n<pre><code>using System.Linq;\nusing System.Web;\nusing System.Web.Services;\nusing System.Data;\nusing System.Configuration;\nusing System.Data.SqlClient;\nusing System.Web.Services.Protocols;\nusing System.Xml.Serialization;\nusing System.Xml;\n\nnamespace toleen\n{\n    /// &lt;summary&gt;\n    /// Summary description for Service1\n    /// &lt;/summary&gt;\n    [WebService(Namespace = \"http://tempuri.org/\")]\n    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]\n    [System.ComponentModel.ToolboxItem(false)]\n    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. \n    // [System.Web.Script.Services.ScriptService]\n    public class Service1 : System.Web.Services.WebService\n    {\n\n        [WebMethod]\n        public DataTable Get()\n        {\n            string constr = ConfigurationManager.ConnectionStrings[\"constr\"].ConnectionString;\n            using (SqlConnection con = new SqlConnection(constr))\n            {\n                using (SqlCommand cmd = new SqlCommand(\"SELECT * FROM nursery\"))\n                {\n                    using (SqlDataAdapter sda = new SqlDataAdapter())\n                    {\n                        cmd.Connection = con;\n                        sda.SelectCommand = cmd;\n                        using (DataTable dt = new DataTable())\n                        {\n                            dt.TableName = \"nursery\";\n                            sda.Fill(dt);\n                            return dt;\n                        }\n                    }\n                }\n            }\n        }\n\n        [WebMethod]\n        public void Insert(int n_id, string n_name, string n_address)\n        {\n            string constr = ConfigurationManager.ConnectionStrings[\"constr\"].ConnectionString;\n            using (SqlConnection con = new SqlConnection(constr))\n            {\n                using (SqlCommand cmd = new SqlCommand(\"INSERT INTO nursery(n_id, n_name, n_address) VALUES (@n_id, @n_name, @n_address)\"))\n                {\n                    cmd.Parameters.AddWithValue(\"@n_id\", n_id);\n                    cmd.Parameters.AddWithValue(\"@n_name\", n_name);\n                    cmd.Parameters.AddWithValue(\"@n_address\", n_address);\n                    cmd.Connection = con;\n                    con.Open();\n                    cmd.ExecuteNonQuery();\n                    con.Close();\n                }\n            }\n        }\n\n        [WebMethod]\n        public void myThrow()\n        {\n\n            // Build the detail element of the SOAP fault.\n            System.Xml.XmlDocument doc = new System.Xml.XmlDocument();\n            System.Xml.XmlNode node = doc.CreateNode(XmlNodeType.Element,\n                 SoapException.DetailElementName.Name, SoapException.DetailElementName.Namespace);\n\n            // Build specific details for the SoapException.\n            // Add first child of detail XML element.\n            System.Xml.XmlNode details =\n              doc.CreateNode(XmlNodeType.Element, \"mySpecialInfo1\",\n                             \"http://tempuri.org/\");\n            System.Xml.XmlNode detailsChild =\n              doc.CreateNode(XmlNodeType.Element, \"childOfSpecialInfo\",\n                             \"http://tempuri.org/\");\n            details.AppendChild(detailsChild);\n\n            // Add second child of detail XML element with an attribute.\n            System.Xml.XmlNode details2 =\n              doc.CreateNode(XmlNodeType.Element, \"mySpecialInfo2\",\n                             \"http://tempuri.org/\");\n            XmlAttribute attr = doc.CreateAttribute(\"t\", \"attrName\",\n                                \"http://tempuri.org/\");\n            attr.Value = \"attrValue\";\n            details2.Attributes.Append(attr);\n\n            // Append the two child elements to the detail node.\n            node.AppendChild(details);\n            node.AppendChild(details2);\n\n            //Throw the exception    \n            SoapException se = new SoapException(\"Fault occurred\",\n              SoapException.ClientFaultCode,\n              Context.Request.Url.AbsoluteUri,\n              node);\n\n            throw se;\n            return;\n        }\n    }\n}\n</code></pre>\n\n<p>Then I created web Reference \nalso, I add web form and wrote this code</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\n\nnamespace toleen\n{\n    public partial class WebForm1 : System.Web.UI.Page\n    {\n        protected void Page_Load(object sender, EventArgs e)\n        {\n            if (!this.IsPostBack)\n            {\n                this.BindGrid();\n            }\n\n\n        }\n\n        private void BindGrid()\n        {\n            CRUD_Service.Service1 service = new CRUD_Service.Service1();\n            GridView1.DataSource = service.Get();\n            GridView1.DataBind();\n\n        }\n\n\n\n        protected void Insert(object sender, EventArgs e)\n        {\n            CRUD_Service.Service1 service = new CRUD_Service.Service1();\n            service.Insert(Convert.ToInt32(txtId.Text.Trim()), txtName.Text.Trim(), txtaddress.Text.Trim());\n            this.BindGrid();\n        }\n    }\n}\n</code></pre>\n\n<p>but whene I stat debugging , this problem happened in this <code>line:GridView1.DataSource = service.Get();</code>\nSoap exception was unhandled in user code.</p>\n\n<p>can you please help me to solve it</p>\n"}, {"tags": ["c#", "json", "sockets", "uwp", "private-network"], "comments": [{"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 1, "creation_date": 1448485752, "post_id": 33926327, "comment_id": 55613744, "body": "You&#39;re teetering right on the edge (if not falling into it) of asking for an off-site resource, which is off-topic for Stack Overflow. You may want to reword this to avoid asking for examples/tutorials/web site recommendations/resources (which are all off-topic)."}, {"owner": {"reputation": 1356, "user_id": 4358137, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bfsy9.jpg?s=128&g=1", "display_name": "Seth Kitchen", "link": "https://stackoverflow.com/users/4358137/seth-kitchen"}, "edited": false, "score": 0, "creation_date": 1448486079, "post_id": 33926327, "comment_id": 55613931, "body": "<a href=\"https://github.com/Microsoft/Windows-universal-samples\" rel=\"nofollow noreferrer\">github.com/Microsoft/Windows-universal-samples</a> duh"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 5550893, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/HUkQL.jpg?s=128&g=1", "display_name": "Daniel Jerome", "link": "https://stackoverflow.com/users/5550893/daniel-jerome"}, "edited": false, "score": 0, "creation_date": 1449072879, "post_id": 33929136, "comment_id": 55849717, "body": "I am able to use this example to create a method that will echo locally. However, when I target my server it seems to time out or lose the thread before the server gets a chance to respond. I&#39;ve looked into the Network communications in the background tutorial to see if that is the solution. <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/xaml/mt617016.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/apps/xaml/&hellip;</a> But I am not really sure how to use this and the links for the code examples on github are not responding. Could someone show an example of how such an app would properly &quot;ping&quot; a remote server and wait for a response like a server?"}], "tags": [], "owner": {"reputation": 560, "user_id": 5527295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd903c1489bf986b5bdd407e3180db81?s=128&d=identicon&r=PG&f=1", "display_name": "panda", "link": "https://stackoverflow.com/users/5527295/panda"}, "is_accepted": false, "score": 1, "last_activity_date": 1448500661, "creation_date": 1448500661, "answer_id": 33929136, "question_id": 33926327, "link": "https://stackoverflow.com/questions/33926327/does-anyone-know-where-i-can-find-a-universal-windows-private-network-client/33929136#33929136", "title": "Does anyone know where I can find a Universal Windows Private Network (Client &amp; Server) code Example?", "body": "<p>(<a href=\"https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/DatagramSocket\" rel=\"nofollow\">https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/DatagramSocket</a>)</p>\n\n<p>Here is a sample. There are <code>CPP</code>, <code>js</code>, and <code>cs</code> code in this sample, I've only tested the <code>cs</code> code. Wish this can help you. </p>\n"}], "owner": {"reputation": 171, "user_id": 5550893, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/HUkQL.jpg?s=128&g=1", "display_name": "Daniel Jerome", "link": "https://stackoverflow.com/users/5550893/daniel-jerome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448500661, "creation_date": 1448485266, "last_edit_date": 1448485644, "question_id": 33926327, "link": "https://stackoverflow.com/questions/33926327/does-anyone-know-where-i-can-find-a-universal-windows-private-network-client", "title": "Does anyone know where I can find a Universal Windows Private Network (Client &amp; Server) code Example?", "body": "<p>I am brand new to Universal Windows Apps (Win 10). I am trying to port a console application over to UWP that acts as a remote testing and administrative console for a custom Windows Service application. I can not seem to find any solid example code to demonstrate where to place a socket listener in the MainPage.xaml.cs file (or wherever it's supposed to go). I have been successful with porting the MSDN example into a method that serializes a PCL model object with Json and sends it to the server. I just can not seem to handle the listener correctly. I don't think that I am using it in the right place, especially when it comes to the async usage. I am having protocol\\port usage errors because it's basically saying that it is already open (I just tossed it in the test method). I would like to deserialize the Json response that is received and use it to populate a List.  Here is an example of what is working for me for sending.</p>\n\n<pre><code>    private async void Pulse(string target)\n    {\n\n        if (target == null || target == string.Empty)\n        {\n            greetingOutput.Text = \"No Ip specified\";\n            return;\n        }\n\n\n        else\n        {\n\n            try\n            {\n\n                Windows.Networking.Sockets.StreamSocket socket = new Windows.Networking.Sockets.StreamSocket();\n                Windows.Networking.HostName serverHost = new Windows.Networking.HostName(target);\n                await socket.ConnectAsync(serverHost, serverPort);\n                Stream streamOut = socket.OutputStream.AsStreamForWrite();\n                StreamWriter writer = new StreamWriter(streamOut);\n                HeartBeatPing heartBeatPing = new HeartBeatPing(GetLocalIp(), target);\n                string msg = JsonConvert.SerializeObject(heartBeatPing);\n                await writer.WriteLineAsync(msg);\n                await writer.FlushAsync();\n                Stream streamIn = socket.InputStream.AsStreamForRead();\n                StreamReader reader = new StreamReader(streamIn);\n                string response = await reader.ReadLineAsync();\n\n\n            }\n            catch (Exception xCeption)\n            {\n                greetingOutput.Text += \"\\n\" + xCeption.ToString();\n            }\n\n        }\n\n    }\n</code></pre>\n\n<p>Some of you might notice from the greetingsOutput.text that I have started with the \"C# Hello World\" example from Microsoft's training site. </p>\n\n<p>I would also like to add that I am not going to be using any HTTP for this because there is going to be some custom encryption and other \"things\" happening with the Json objects that will require separate ports.</p>\n\n<p>I'm not far enough into my Universal Windows Apps with XAML and C# (Unleashed) books to have even a clue as to what I am doing. I am however well seasoned C# programmer in other platforms such as MVC, Windows Service, Console, and others. I have a solid understand of enterprise class patterns and practices based on my knowledge of \"The Gang of Four\".</p>\n\n<p>Any help would be greatly appreciated. Thank you.</p>\n"}, {"tags": ["c#", "windows"], "comments": [{"owner": {"reputation": 3, "user_id": 5605965, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CU8881j1JgM/AAAAAAAAAAI/AAAAAAAAB-w/SL9JTs-0MYg/photo.jpg?sz=128", "display_name": "Aaron Mendoza", "link": "https://stackoverflow.com/users/5605965/aaron-mendoza"}, "edited": false, "score": 0, "creation_date": 1448485083, "post_id": 33926271, "comment_id": 55613398, "body": "or i mean It grabs a image from a Link from what a user types (textbox6)"}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 1, "creation_date": 1448485747, "post_id": 33926271, "comment_id": 55613743, "body": "Did you create your own IO class?  <code>MYPROGRAMNAME.IO</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5605965, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CU8881j1JgM/AAAAAAAAAAI/AAAAAAAAB-w/SL9JTs-0MYg/photo.jpg?sz=128", "display_name": "Aaron Mendoza", "link": "https://stackoverflow.com/users/5605965/aaron-mendoza"}, "edited": false, "score": 0, "creation_date": 1448485531, "post_id": 33926330, "comment_id": 55613630, "body": "when i use the code you entered it now gives me a namespace error"}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "reply_to_user": {"reputation": 3, "user_id": 5605965, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CU8881j1JgM/AAAAAAAAAAI/AAAAAAAAB-w/SL9JTs-0MYg/photo.jpg?sz=128", "display_name": "Aaron Mendoza", "link": "https://stackoverflow.com/users/5605965/aaron-mendoza"}, "edited": false, "score": 0, "creation_date": 1448486094, "post_id": 33926330, "comment_id": 55613940, "body": "@AaronMendoza Your screen shot shows <code>Webclient</code> when it should be <code>WebClient</code>.  How did you get that to compile?"}, {"owner": {"reputation": 3, "user_id": 5605965, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CU8881j1JgM/AAAAAAAAAAI/AAAAAAAAB-w/SL9JTs-0MYg/photo.jpg?sz=128", "display_name": "Aaron Mendoza", "link": "https://stackoverflow.com/users/5605965/aaron-mendoza"}, "edited": false, "score": 0, "creation_date": 1448486302, "post_id": 33926330, "comment_id": 55614049, "body": "I honestly don&#39;t know but i copied yours and it&#39;s now working Thanks :)"}, {"owner": {"reputation": 5695, "user_id": 5466575, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-HQWnjB6PMu0/AAAAAAAAAAI/AAAAAAAAAF0/JyBt49xzaLU/photo.jpg?sz=128", "display_name": "Neha Jain", "link": "https://stackoverflow.com/users/5466575/neha-jain"}, "edited": false, "score": 0, "creation_date": 1448486312, "post_id": 33926330, "comment_id": 55614058, "body": "Look like some namespace issue. Because System.IO.MemoryStream class exist since 1.1 framework <a href=\"https://msdn.microsoft.com/en-us/library/system.io.memorystream(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5695, "user_id": 5466575, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-HQWnjB6PMu0/AAAAAAAAAAI/AAAAAAAAAF0/JyBt49xzaLU/photo.jpg?sz=128", "display_name": "Neha Jain", "link": "https://stackoverflow.com/users/5466575/neha-jain"}, "is_accepted": true, "score": 0, "last_activity_date": 1448486124, "last_edit_date": 1448486124, "creation_date": 1448485273, "answer_id": 33926330, "question_id": 33926271, "link": "https://stackoverflow.com/questions/33926271/myprogram-io-memorystream-is-a-property-but-is-used-like-a-type-error/33926330#33926330", "title": "&#39;MYPROGRAM.IO.MemoryStream&#39; is a &#39;property&#39; but is used like a &#39;type&#39; Error?", "body": "<p>Look like you have created another property IO.MemoryStream in your project. Instead you should use <code>System.IO.MemoryStream</code> namespace. See modified below.</p>\n\n<pre><code>pictureBox1.Image = new System.Drawing.Bitmap(new System.IO.MemoryStream(new System.Net.WebClient().DownloadData(\"http://api.skype.com/users/\" + textBox6.Text + \"/profile/avatar\")));\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5605965, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CU8881j1JgM/AAAAAAAAAAI/AAAAAAAAB-w/SL9JTs-0MYg/photo.jpg?sz=128", "display_name": "Aaron Mendoza", "link": "https://stackoverflow.com/users/5605965/aaron-mendoza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 33926330, "answer_count": 1, "score": -1, "last_activity_date": 1448488520, "creation_date": 1448485039, "last_edit_date": 1448488520, "question_id": 33926271, "link": "https://stackoverflow.com/questions/33926271/myprogram-io-memorystream-is-a-property-but-is-used-like-a-type-error", "title": "&#39;MYPROGRAM.IO.MemoryStream&#39; is a &#39;property&#39; but is used like a &#39;type&#39; Error?", "body": "<p>So I am trying to code something that goes to a link, but changes the middle part with what a user types. Such as:</p>\n\n<pre><code>pictureBox1.Image = new System.Drawing.Bitmap(new IO.MemoryStream(new System.Net.Webclient().DownloadData(\"http://api.skype.com/users/\" + textBox6.Text + \"/profile/avatar\")));\n</code></pre>\n\n<p>for my Skype tool I'm making, but the only problem I get is <code>MemoryStream</code>. It says</p>\n\n<blockquote>\n  <p>'MYPROGRAMNAME.IO.MemoryStream' is a 'property' but is used like a 'type'</p>\n</blockquote>\n\n<p>I don't know what's wrong. I can't find anything.</p>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448484917, "post_id": 33926203, "comment_id": 55613326, "body": "sure would help if you show us what your currently doing.."}, {"owner": {"reputation": 1088, "user_id": 1013823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pkbV7.jpg?s=128&g=1", "display_name": "Kris Oye", "link": "https://stackoverflow.com/users/1013823/kris-oye"}, "edited": false, "score": 0, "creation_date": 1448485169, "post_id": 33926203, "comment_id": 55613439, "body": "Are you pre-loading values from the database to assist in autocomplete functionality or are you doing lookups against your database as data is keyed in?  You really should include some code so your problem is more easily understood."}, {"owner": {"reputation": 21, "user_id": 5552552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2d3ed42d3a092c8d8dbe8f08651e40f9?s=128&d=identicon&r=PG&f=1", "display_name": "Uzair Lodhi", "link": "https://stackoverflow.com/users/5552552/uzair-lodhi"}, "edited": false, "score": 0, "creation_date": 1448489233, "post_id": 33926203, "comment_id": 55615500, "body": "(<a href=\"http://stackoverflow.com/questions/33905587/inventry-form-not-updating-itself-after-save-data-c-sharp-winform/33905780?noredirect=1#comment55614014_33905780\" title=\"inventry form not updating itself after save data c sharp winform\">stackoverflow.com/questions/33905587/&hellip;</a>) you can check here"}, {"owner": {"reputation": 21, "user_id": 5552552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2d3ed42d3a092c8d8dbe8f08651e40f9?s=128&d=identicon&r=PG&f=1", "display_name": "Uzair Lodhi", "link": "https://stackoverflow.com/users/5552552/uzair-lodhi"}, "reply_to_user": {"reputation": 1088, "user_id": 1013823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pkbV7.jpg?s=128&g=1", "display_name": "Kris Oye", "link": "https://stackoverflow.com/users/1013823/kris-oye"}, "edited": false, "score": 0, "creation_date": 1448489734, "post_id": 33926203, "comment_id": 55615699, "body": "@KrisOye I am pre-loading values like <code>public DataForm()         {             InitializeComponent();              AutoCompleteTextPlot();             AutoCompleteTextLocation();             AutoCompleteTextSize();             AutoCompleteTextComArea();             AutoCompleteTextRemarks();             AutoCompleteTextOwnerName();             AutoCompleteTextCustomerName();         }</code>"}, {"owner": {"reputation": 21, "user_id": 5552552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2d3ed42d3a092c8d8dbe8f08651e40f9?s=128&d=identicon&r=PG&f=1", "display_name": "Uzair Lodhi", "link": "https://stackoverflow.com/users/5552552/uzair-lodhi"}, "edited": false, "score": 0, "creation_date": 1448490004, "post_id": 33926203, "comment_id": 55615814, "body": "``@MethodMan I just want to know is there any way update form with recent data change in the database with queries like <code>this.refresh()</code> or <code>this.update()</code> ? by the way both are not working in my case.And I just commented the code please have a look"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5552552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2d3ed42d3a092c8d8dbe8f08651e40f9?s=128&d=identicon&r=PG&f=1", "display_name": "Uzair Lodhi", "link": "https://stackoverflow.com/users/5552552/uzair-lodhi"}, "edited": false, "score": 0, "creation_date": 1448529382, "post_id": 33929104, "comment_id": 55629181, "body": "Thanks for your time my problem solved by using all functions call for example <code>AutoCompleteTextPlot(); AutoCompleteTextLocation(); AutoCompleteTextSize(); </code> in the save button code"}], "tags": [], "owner": {"reputation": 1088, "user_id": 1013823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pkbV7.jpg?s=128&g=1", "display_name": "Kris Oye", "link": "https://stackoverflow.com/users/1013823/kris-oye"}, "is_accepted": false, "score": 0, "last_activity_date": 1448500436, "creation_date": 1448500436, "answer_id": 33929104, "question_id": 33926203, "link": "https://stackoverflow.com/questions/33926203/how-to-update-inventory-form-after-every-transaction-for-autocomplete-etc/33929104#33929104", "title": "How to update inventory form after every transaction for autocomplete etc", "body": "<p>So you don't appear to reload the data source after you've submitted the form.  It feels a bit heavy-handed but you could reload all of your autoloading hints after a successful submission:</p>\n\n<pre><code>public DataForm()\n{\n    InitializeComponent();\n    InitializeAutocomplete(() =&gt; InitializeAutocomplete(tbName, \"OwnerName\", \"Owners\"));\n    InitializeAutocomplete(() =&gt; InitializeAutocomplete(tbRemarks, \"RemarkText\", \"Remarks\"));\n}\n\nList&lt;Action&gt; autoCompleteInitializers = new List&lt;Action&gt;();\n\nprivate void ReinitializeAutocomplete()\n{\n    foreach(var initializer in autoCompleteInitializers)\n    {\n        initializer();\n    }\n}\n\nprivate void InitializeAutocomplete(Action init)\n{\n    init();\n    autoCompleteInitializers.Add(init);\n}\n\nprivate void InitializeAutocomplete(TextBox tb, string fieldName, string tableName)\n{\n    tb.AutoCompleteMode = AutoCompleteMode.Suggest;\n    tb.AutoCompleteSource = AutoCompleteSource.CustomSource;\n    tb.AutoCompleteCustomSource = new AutoCompleteStringCollection();\n    using (SQLiteConnection dbconn = new SQLiteConnection())\n    {\n        dbconn.Open();\n        using (SQLiteCommand dbcmd = dbconn.CreateCommand())\n        {\n            dbcmd.CommandText = String.Format(\"select {0} from {1}\", fieldName, tableName);\n            dbcmd.CommandType = CommandType.Text;\n            using (SQLiteDataReader reader = dbcmd.ExecuteReader())\n            {\n                while (reader.Read())\n                {\n                    tb.AutoCompleteCustomSource.Add(reader[fieldName].ToString());\n                }\n            }\n        }\n    }\n}\n\nprivate void btnSubmit_Click(object sender, EventArgs e)\n{\n    if (bTransactionSuccess) ReinitializeAutocomplete();\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5552552, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2d3ed42d3a092c8d8dbe8f08651e40f9?s=128&d=identicon&r=PG&f=1", "display_name": "Uzair Lodhi", "link": "https://stackoverflow.com/users/5552552/uzair-lodhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1448503633, "creation_date": 1448484734, "last_edit_date": 1448503633, "question_id": 33926203, "link": "https://stackoverflow.com/questions/33926203/how-to-update-inventory-form-after-every-transaction-for-autocomplete-etc", "title": "How to update inventory form after every transaction for autocomplete etc", "body": "<p>How do I update my form autocomplete source with database after every transaction (i.e saving data etc).  I am not been able to autocomplete with the data I just save until I close application and reopen it.</p>\n\n<p>I am using C#, winform, SQLite:</p>\n\n<pre><code>public DataForm() { \n   InitializeComponent(); \n   AutoCompleteTextPlot(); \n   AutoCompleteTextLocation(); \n   AutoCompleteTextSize(); \n   AutoCompleteTextComArea(); \n   AutoCompleteTextRemarks(); \n   AutoCompleteTextOwnerName(); \n   AutoCompleteTextCustomerName(); \n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "reflection", "uwp", ".net-native"], "comments": [{"owner": {"reputation": 36301, "user_id": 50447, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c8779a33adeec01e05d5a480c7cd3c3?s=128&d=identicon&r=PG", "display_name": "Rowland Shaw", "link": "https://stackoverflow.com/users/50447/rowland-shaw"}, "edited": false, "score": 0, "creation_date": 1448484893, "post_id": 33926168, "comment_id": 55613319, "body": "What is <code>DataContext</code>? Or to put it another way, if you&#39;re using Entity Framework, which specific version are you using?"}], "answers": [{"comments": [{"owner": {"reputation": 635, "user_id": 931371, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57642dfc0faef8c2957dfa336a6ee280?s=128&d=identicon&r=PG", "display_name": "TIKSN", "link": "https://stackoverflow.com/users/931371/tiksn"}, "edited": false, "score": 0, "creation_date": 1448535269, "post_id": 33927308, "comment_id": 55633099, "body": "Yes I did, for all concrete types of TMobileEntity."}], "tags": [], "owner": {"reputation": 4059, "user_id": 1289864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sg1kP.jpg?s=128&g=1", "display_name": "Ken Tucker", "link": "https://stackoverflow.com/users/1289864/ken-tucker"}, "is_accepted": false, "score": 1, "last_activity_date": 1448489557, "creation_date": 1448489557, "answer_id": 33927308, "question_id": 33926168, "link": "https://stackoverflow.com/questions/33926168/platformnotsupportedexception-when-using-entityframework-and-net-native/33927308#33927308", "title": "PlatformNotSupportedException when using EntityFramework and .NET Native", "body": "<p>Assuming you are using ef7</p>\n\n<p>Open Properties/Default.rd.xml and add the following to the file</p>\n\n<pre><code>&lt;!-- Add your application specific runtime directives here. --&gt;\n&lt;Type Name=\"System.Collections.ArrayList\" Dynamic=\"Required All\" /&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1656, "user_id": 5199288, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q0Cru.jpg?s=128&g=1", "display_name": "MattWhilden", "link": "https://stackoverflow.com/users/5199288/mattwhilden"}, "is_accepted": false, "score": 3, "last_activity_date": 1448498349, "last_edit_date": 1448498349, "creation_date": 1448494966, "answer_id": 33928354, "question_id": 33926168, "link": "https://stackoverflow.com/questions/33926168/platformnotsupportedexception-when-using-entityframework-and-net-native/33928354#33928354", "title": "PlatformNotSupportedException when using EntityFramework and .NET Native", "body": "<p>It's not super enlightening but you can check out the source of the exception here: <a href=\"https://github.com/dotnet/corert/blob/master/src/System.Private.CoreLib/src/Internal/Reflection/Core/NonPortable/RuntimeType.cs#L262\" rel=\"nofollow\">https://github.com/dotnet/corert/blob/master/src/System.Private.CoreLib/src/Internal/Reflection/Core/NonPortable/RuntimeType.cs#L262</a></p>\n\n<p>At a high level, EF really just isn't ready to support UWP and being ahead of time compiled. I know they're working hard to get this support for the next update of the UWP tools. </p>\n\n<p>This specific issue is that the current implementation of reflection in .NET Native is trying to use TypeInfo.IsAssignableFrom and has limitations vis a vis uninstantiated generic types. I think the plan is to correct this for the next version of .NET Native.</p>\n\n<p>So I think you're probably just going to have to remove whatever in EF is hitting this issue. Sorry I don't have better news.</p>\n"}], "owner": {"reputation": 635, "user_id": 931371, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57642dfc0faef8c2957dfa336a6ee280?s=128&d=identicon&r=PG", "display_name": "TIKSN", "link": "https://stackoverflow.com/users/931371/tiksn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1096, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1448500047, "creation_date": 1448484584, "last_edit_date": 1448500047, "question_id": 33926168, "link": "https://stackoverflow.com/questions/33926168/platformnotsupportedexception-when-using-entityframework-and-net-native", "title": "PlatformNotSupportedException when using EntityFramework and .NET Native", "body": "<p>I have an UWP (Windows 10) app which runs perfectly on debug mode (.NET Native disabled).</p>\n\n<p>When I am running it on release mode, (or in debug mode with .NET Native compilation on I receive error on <em>return context.Set().ToList();</em> line.</p>\n\n<pre><code>    public IEnumerable&lt;TMobileEntity&gt; ReadAll()\n    {\n        using (var context = new DataContext(database.DatabasePath))\n        {\n            return context.Set&lt;TMobileEntity&gt;().ToList();\n        }\n    }\n</code></pre>\n\n<p>here is an exception details</p>\n\n<blockquote>\n  <p>{System.TypeInitializationException: A type initializer threw an\n  exception. To determine which type, inspect the InnerException's\n  StackTrace property. ---> System.PlatformNotSupportedException:\n  TypeHandles are not supported for types that return true for\n  ContainsGenericParameters.    at\n  Internal.Reflection.Core.NonPortable.RuntimeType.get_TypeHandle() in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.CoreLib\\Internal\\Reflection\\Core\\NonPortable\\RuntimeType.cs:line\n  262    at\n  System.Reflection.Runtime.TypeInfos.RuntimeTypeInfo.IsAssignableFrom(TypeInfo\n  typeInfo) in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.Reflection.Core\\System\\Reflection\\Runtime\\TypeInfos\\RuntimeTypeInfo.cs:line\n  398    at\n  Remotion.Linq.Parsing.Structure.IntermediateModel.SupportedMethodSpecifications.HasIndexSelectorParameter(MethodInfo\n  methodInfo, Int32 parameterPosition)    at\n  Remotion.Linq.Parsing.Structure.IntermediateModel.SupportedMethodSpecifications.&lt;>c__DisplayClass14.b__13(MethodInfo\n  mi)    at System.Func<code>2.Invoke(T arg)    at\n  System.Linq.Enumerable.&lt;&gt;c__DisplayClass0</code>1.b__1(TSource\n  x) in\n  f:\\dd\\ndp\\fxcore\\Open\\src\\System.Linq\\src\\System\\Linq\\Enumerable.cs:line\n  69    at System.Func<code>2.Invoke(T arg)    at\n  System.Linq.Enumerable.WhereEnumerableIterator</code>1.MoveNext() in\n  f:\\dd\\ndp\\fxcore\\Open\\src\\System.Linq\\src\\System\\Linq\\Enumerable.cs:line\n  199    at\n  Remotion.Linq.Parsing.Structure.NodeTypeProviders.MethodInfoBasedNodeTypeRegistry.Register(IEnumerable<code>1\n  methods, Type nodeType)    at\n  Remotion.Linq.Parsing.Structure.NodeTypeProviders.MethodInfoBasedNodeTypeRegistry.CreateFromRelinqAssembly()\n  at Microsoft.Data.Entity.Query.QueryCompiler.CreateNodeTypeProvider() \n  at Microsoft.Data.Entity.Query.QueryCompiler..cctor()    at\n  System.Runtime.CompilerServices.ClassConstructorRunner.Call[T](IntPtr\n  pfn)    at\n  System.Runtime.CompilerServices.ClassConstructorRunner.EnsureClassConstructorRun(Void*\n  returnValue, StaticClassConstructionContext* pContext) in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.CoreLib\\System\\Runtime\\CompilerServices\\ClassConstructorRunner.cs:line\n  69    Exception_EndOfInnerExceptionStack    at\n  System.Runtime.CompilerServices.ClassConstructorRunner.EnsureClassConstructorRun(Void*\n  returnValue, StaticClassConstructionContext* pContext) in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.CoreLib\\System\\Runtime\\CompilerServices\\ClassConstructorRunner.cs:line\n  86    at\n  Microsoft.Data.Entity.Query.QueryCompiler.Preprocess(Expression query,\n  QueryContext queryContext)    at\n  Microsoft.Data.Entity.Query.QueryCompiler.Execute[TResult](Expression\n  query)    at\n  Microsoft.Data.Entity.Query.Internal.EntityQueryProvider.Execute[TResult](Expression\n  expression)    at Remotion.Linq.QueryableBase</code>1.GetEnumerator()    at\n  Microsoft.Data.Entity.Internal.InternalDbSet<code>1.System.Collections.Generic.IEnumerable&lt;TEntity&gt;.GetEnumerator()\n  at System.Collections.Generic.List</code>1..ctor(IEnumerable<code>1 collection)\n  in\n  f:\\dd\\ndp\\fxcore\\src\\System.Collections\\System\\Collections\\Generic\\List.cs:line\n  88    at System.Linq.Enumerable.ToList[TSource](IEnumerable</code>1 source) \n  at TIKSN.GroceryChecklist.ModernMobile.Data.RepositoryBase<code>1.ReadAll()\n  in E:\\Visual Studio Online\\tiksn\\Grocery\n  Checklist\\Develop\\ModernMobile.Data.UWP\\RepositoryBase.cs:line 42<br>\n  at\n  TIKSN.GroceryChecklist.MobileDataService.ChecklistItemsManagementService.&lt;GetCurrentChecklistItems&gt;d__5.MoveNext()\n  in E:\\Visual Studio Online\\tiksn\\Grocery\n  Checklist\\Develop\\MobileDataService\\ChecklistItemsManagementService.cs:line\n  62    at\n  System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.CoreLib\\System\\Runtime\\ExceptionServices\\ExceptionDispatchInfo.cs:line\n  66    at\n  System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task\n  task) in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.Threading\\System\\Runtime\\CompilerServices\\TaskAwaiter.cs:line\n  186    at\n  System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task\n  task) in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.Threading\\System\\Runtime\\CompilerServices\\TaskAwaiter.cs:line\n  155    at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task\n  task) in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.Threading\\System\\Runtime\\CompilerServices\\TaskAwaiter.cs:line\n  127    at System.Runtime.CompilerServices.TaskAwaiter</code>1.GetResult() in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.Threading\\System\\Runtime\\CompilerServices\\TaskAwaiter.cs:line\n  320    at\n  TIKSN.GroceryChecklist.ModernMobile.ViewModels.ChecklistPageViewModel.d__15.MoveNext()\n  in E:\\Visual Studio Online\\tiksn\\Grocery\n  Checklist\\Develop\\ModernMobile.UWP\\ViewModels\\ChecklistPageViewModel.cs:line\n  82    at\n  System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.CoreLib\\System\\Runtime\\ExceptionServices\\ExceptionDispatchInfo.cs:line\n  66    at\n  System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task\n  task) in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.Threading\\System\\Runtime\\CompilerServices\\TaskAwaiter.cs:line\n  186    at\n  System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task\n  task) in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.Threading\\System\\Runtime\\CompilerServices\\TaskAwaiter.cs:line\n  155    at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task\n  task) in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.Threading\\System\\Runtime\\CompilerServices\\TaskAwaiter.cs:line\n  127    at System.Runtime.CompilerServices.TaskAwaiter.GetResult() in\n  f:\\dd\\ndp\\fxcore\\src\\System.Private.Threading\\System\\Runtime\\CompilerServices\\TaskAwaiter.cs:line\n  112    at\n  TIKSN.GroceryChecklist.ModernMobile.ViewModels.PageViewModelBase.d__46.MoveNext()\n  in E:\\Visual Studio Online\\tiksn\\Grocery\n  Checklist\\Develop\\ModernMobile.UWP\\ViewModels\\PageViewModelBase.cs:line\n  102}  System.Exception {System.TypeInitializationException}</p>\n</blockquote>\n"}, {"tags": ["c#", "multithreading", "list", "parallel-processing", "thread-safety"], "answers": [{"comments": [{"owner": {"reputation": 566, "user_id": 3495690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efc58a00064855e8f5dc5861cd16b21b?s=128&d=identicon&r=PG&f=1", "display_name": "user3495690", "link": "https://stackoverflow.com/users/3495690/user3495690"}, "edited": false, "score": 0, "creation_date": 1448488740, "post_id": 33926871, "comment_id": 55615253, "body": "This would work, except I do not know if a particular thread wants to write until it reads the values from the list (there are different &quot;write&quot; conditions for each thread)"}], "tags": [], "owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "is_accepted": false, "score": 1, "last_activity_date": 1448488037, "last_edit_date": 1448488037, "creation_date": 1448487609, "answer_id": 33926871, "question_id": 33926157, "link": "https://stackoverflow.com/questions/33926157/in-c-how-to-know-if-a-thread-is-waiting-to-enter-write-lock-for-readerwriterlo/33926871#33926871", "title": "In C#, how to know if a thread is waiting to enter write lock for ReaderWriterLockSlim?", "body": "<p>Move the logic further back, Use <code>TryEnterUpgradeableReadLock</code> on the readers with a 0 timeout, then that one reader becomes your writer waiting for the other readers to finish.</p>\n\n<pre><code>public void YourFunction()\n{\n    bool enteredUpgLock = false;\n    bool enteredWriteLock = false;\n\n    try\n    {\n        //Preemptively take a upgradeable read lock, only one thread can do this.\n        enteredUpgLock = _readerWriterLock.TryEnterUpgradeableReadLock(0);\n\n        try\n        {\n            //If we don't have the upgradeable lock take a normal read lock.\n            if (!enteredUpgLock)\n            {\n                _readerWriterLock.EnterReadLock();\n            }\n\n            DoReadWork();\n        }\n        finally\n        {\n            //Release the read lock if we had it.\n            if(!enteredUpgLock)\n                _readerWriterLock.ExitReadLock();\n        }\n\n        try\n        {\n            if (enteredUpgLock)\n            {\n                //We held the upgradeable lock, wait forever till we can take it.\n                _readerWriterLock.EnterWriteLock();\n                enteredWriteLock = true;\n            }\n            else\n            {\n                //We did not have the upgrade lock, try to take the write lock but if we can't bail out.\n                enteredWriteLock = _readerWriterLock.TryEnterWriteLock(0);\n                if(!enteredWriteLock)\n                    return;\n            }\n\n            DoWriteWork();\n        }\n        finally \n        {\n            if(enteredWriteLock)\n                _readerWriterLock.ExitWriteLock();\n        }\n    }\n    finally \n    {\n        //If we had the upgradeable lock, release it.\n        if (enteredUpgLock)\n        {\n            _readerWriterLock.ExitUpgradeableReadLock();\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 566, "user_id": 3495690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efc58a00064855e8f5dc5861cd16b21b?s=128&d=identicon&r=PG&f=1", "display_name": "user3495690", "link": "https://stackoverflow.com/users/3495690/user3495690"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448488037, "creation_date": 1448484532, "question_id": 33926157, "link": "https://stackoverflow.com/questions/33926157/in-c-how-to-know-if-a-thread-is-waiting-to-enter-write-lock-for-readerwriterlo", "title": "In C#, how to know if a thread is waiting to enter write lock for ReaderWriterLockSlim?", "body": "<p>I am trying to implement the ReaderWriterLockSlim for a list. I would like each thread to be able to read from the list at once, but only one thread to be permitted to \"wait\" for the write lock. If a thread attempts to gain control of the write lock while another thread is already writing or waiting to write, I would like it not to wait for the lock. I have found the <a href=\"https://msdn.microsoft.com/en-us/library/bb302037(v=vs.110).aspx\" rel=\"nofollow\">TryEnterReadLock(Int32)</a> method, but from my understanding, it will only wait until the calling thread can gain control of the write lock or the timeout is reached. I would try this with a timeout of \"0\", however, I don't think this will work since if other threads possess the read lock, it will timeout before gaining access to the write lock. I know I could use a variable to represent whether or not a thread is writing or waiting to write, but I wanted to know if there is a more professional way of doing this (I'd prefer not to have to create another variable and consequently have to create a mutex lock for it).</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "iis", "signalr"], "comments": [{"owner": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "edited": false, "score": 0, "creation_date": 1448485908, "post_id": 33926142, "comment_id": 55613832, "body": "Are you able to test the application against IIS (not the express version)? If so, does it behave the same way?"}, {"owner": {"reputation": 1524, "user_id": 3022900, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b70bbcb50b5b6043301dfd5ed8de47dc?s=128&d=identicon&r=PG&f=1", "display_name": "LiranBo", "link": "https://stackoverflow.com/users/3022900/liranbo"}, "reply_to_user": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "edited": false, "score": 0, "creation_date": 1448486121, "post_id": 33926142, "comment_id": 55613960, "body": "@MikeHofer no, I haven&#39;t tried to run it on IIS (non-express). I will have access to the project server only in a few days from now so I can&#39;t test it there yet. Can I set VS to run my project on this version instead of the express version?"}, {"owner": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "edited": false, "score": 0, "creation_date": 1448486575, "post_id": 33926142, "comment_id": 55614173, "body": "You should be able to test IIS locally on your machine. Control Panel -&gt; Programs and Features -&gt; Turn Windows features on or off. Then check the option for Internet Information Services. Expand the node for World Wide Web Services. Expand the section for Application Development Features, and check everything (just to be on the safe side). Restart your machine. You should be able to test locally on IIS running on your machine."}, {"owner": {"reputation": 1524, "user_id": 3022900, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b70bbcb50b5b6043301dfd5ed8de47dc?s=128&d=identicon&r=PG&f=1", "display_name": "LiranBo", "link": "https://stackoverflow.com/users/3022900/liranbo"}, "reply_to_user": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "edited": false, "score": 0, "creation_date": 1448486802, "post_id": 33926142, "comment_id": 55614290, "body": "@MikeHofer thanks, I&#39;m giving it a try..."}, {"owner": {"reputation": 1524, "user_id": 3022900, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b70bbcb50b5b6043301dfd5ed8de47dc?s=128&d=identicon&r=PG&f=1", "display_name": "LiranBo", "link": "https://stackoverflow.com/users/3022900/liranbo"}, "reply_to_user": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "edited": false, "score": 0, "creation_date": 1448488441, "post_id": 33926142, "comment_id": 55615105, "body": "@MikeHofer, I&#39;ve tried to change the project web properties to run on local IIS, and I&#39;m getting this error: <code>Configuring Web http:&#47;&#47;... for ASP.NET 4.5 failed. You must manually configure this site for ASP.NET 4.5 in order for the site to run correctly. ASP.NET 4.0 has not been registered on the WebServer. You need to manually configure your Web server for ASP.NET in order for your site to run correctly.</code>  I&#39;ve looked up in <code>Application Development Features</code> I don&#39;t have those 2 version (4.0 &amp; 4.5) in there..."}, {"owner": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "edited": false, "score": 0, "creation_date": 1448634943, "post_id": 33926142, "comment_id": 55676754, "body": "See this page for the fix: <a href=\"http://blogs.msdn.com/b/webdev/archive/2014/11/11/dialog-box-may-be-displayed-to-users-when-opening-projects-in-microsoft-visual-studio-after-installation-of-microsoft-net-framework-4-6.aspx\" rel=\"nofollow noreferrer\">blogs.msdn.com/b/webdev/archive/2014/11/11/&hellip;</a>"}, {"owner": {"reputation": 1524, "user_id": 3022900, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b70bbcb50b5b6043301dfd5ed8de47dc?s=128&d=identicon&r=PG&f=1", "display_name": "LiranBo", "link": "https://stackoverflow.com/users/3022900/liranbo"}, "reply_to_user": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "edited": false, "score": 0, "creation_date": 1449223917, "post_id": 33926142, "comment_id": 55923811, "body": "@Mike Hofer thanks for your help. so far I moved the db to something local (instead of the project MDF file), I needed to change this so I can move from iisexpress, but after I made this change, it seems like the problem is gone. I didn&#39;t move from iisexpress yet but I will update if this problem recurs. Again, thanks for your help!"}], "owner": {"reputation": 1524, "user_id": 3022900, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b70bbcb50b5b6043301dfd5ed8de47dc?s=128&d=identicon&r=PG&f=1", "display_name": "LiranBo", "link": "https://stackoverflow.com/users/3022900/liranbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 951, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448485334, "creation_date": 1448484470, "last_edit_date": 1448485334, "question_id": 33926142, "link": "https://stackoverflow.com/questions/33926142/iis-express-consumes-90-of-cpu-while-the-server-is-idle", "title": "iis express consumes 90% of cpu while the server is idle", "body": "<p>I'm working on a MVC .Net project that uses SignalR as a bi-directional communication between he client and server side.</p>\n\n<p>Lately I've noticed that my CPU is getting overloaded quite quickly when I start the server (from visual studio). I looked around in task manager and seen that <code>iisexpress.exe</code> is consuming almost 90% of my CPU, and if I pause the project it shows that the server is idle and yet it's consuming all of my CPU.</p>\n\n<p>I also tried to run the project on a much stronger PC, but the results were the same.</p>\n\n<p>I read about this issue and saw this is a known issue which can be solved by turning off the <code>browser link</code> option, so I tried that, but not only that it didn't drop my CPU usage back to normal, but it also killed my connection between the server and the client side. Apparently this option is based on the SignalR technology, so by turning that option off I basically kill the communication between them.</p>\n\n<p>I have three questions about it:</p>\n\n<ol>\n<li>How can I solve this issue? turning off <code>browser link</code> doesn't work.</li>\n<li>Will this problem persist even after I'll publish the project to the server? meaning it will run directly on the IIS server without VS in the background?</li>\n<li>Is it not recommended to use SignalR on large HTML pages?</li>\n</ol>\n\n<p>I would really appreciate your help!</p>\n"}, {"tags": ["c#", "postsharp"], "answers": [{"tags": [], "owner": {"reputation": 3952, "user_id": 291379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YPApF.jpg?s=128&g=1", "display_name": "Jakub Linhart", "link": "https://stackoverflow.com/users/291379/jakub-linhart"}, "is_accepted": true, "score": 1, "last_activity_date": 1448621341, "creation_date": 1448621341, "answer_id": 33955717, "question_id": 33926071, "link": "https://stackoverflow.com/questions/33926071/how-to-exclude-certain-assembly-class-method-whatever-from-solution-wide-aspect/33955717#33955717", "title": "How to exclude certain assembly/class/method/whatever from solution-wide-aspect?", "body": "<p><a href=\"http://doc.postsharp.net/p_postsharp_extensibility_multicastattribute_attributeexclude\" rel=\"nofollow\">AttributeExclude</a> can be used to remove all other instances of the same attribute type from specified elements set. </p>\n\n<p>AutoDataContractAttribute can be multicasted using PostSharp xml configuration file to all classes in <code>MyNamespace.Customer</code>:</p>\n\n<pre><code>&lt;my:AutoDataContractAttribute AttributeTargetTypes=\"MyNamespace.Customer\" /&gt;\n</code></pre>\n\n<p>Say the attribute should not be multicasted types in <code>MyNamespace.Customer.Excluded</code> namespace. This could be done by adding:</p>\n\n<pre><code>&lt;my:AutoDataContractAttribute AttributeExclude=\"True\" AttributeTargetTypes=\"MyNamespace.Customer.Excluded.*\" /&gt;\n</code></pre>\n\n<p>Whole example:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Project xmlns=\"http://schemas.postsharp.org/1.0/configuration\"&gt;\n    &lt;Multicast xmlns:my=\"clr-namespace:MyCustomAttributes;assembly:MyAssembly\"&gt;\n        &lt;my:AutoDataContractAttribute AttributeTargetTypes=\"MyNamespace.Customer\" /&gt;\n        &lt;my:AutoDataContractAttribute AttributeExclude=\"True\" AttributeTargetTypes=\"MyNamespace.Customer.Excluded.*\" /&gt;\n    &lt;/Multicast&gt;\n&lt;/Project&gt;\n</code></pre>\n\n<p>When <a href=\"http://doc.postsharp.net/p_postsharp_extensibility_multicastattribute_attributeexclude\" rel=\"nofollow\">AttributeExclude</a> is True then <a href=\"http://doc.postsharp.net/p_postsharp_extensibility_multicastattribute_attributepriority\" rel=\"nofollow\">AttributePriority</a> property needs to be specified as well. It is done automatically when using XML but in more complicated cases it could be not sufficient and you would need to specify the <a href=\"http://doc.postsharp.net/p_postsharp_extensibility_multicastattribute_attributepriority\" rel=\"nofollow\">AttributePriority</a> explicitly. It could be done by <a href=\"http://doc.postsharp.net/multicast\" rel=\"nofollow\">adding aspects declaratively using attributes</a>:</p>\n\n<pre><code>[assembly: AutoDataContractAttribute(AttributePriority = 1,\n    AttributeTargetTypes=\"MyNamespace.Customer\")]\n[assembly: AutoDataContractAttribute(AttributeExclude = true,\n    AttributeTargetTypes = \"MyNamespace.Customer.Excluded.*\",\n    AttributePriority = 10)]\n</code></pre>\n"}], "owner": {"reputation": 7197, "user_id": 587467, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7787bdb4718fdc9b42fb46d671bd7eca?s=128&d=identicon&r=PG", "display_name": "Tar", "link": "https://stackoverflow.com/users/587467/tar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 1, "accepted_answer_id": 33955717, "answer_count": 1, "score": 1, "last_activity_date": 1448621341, "creation_date": 1448484181, "question_id": 33926071, "link": "https://stackoverflow.com/questions/33926071/how-to-exclude-certain-assembly-class-method-whatever-from-solution-wide-aspect", "title": "How to exclude certain assembly/class/method/whatever from solution-wide-aspect?", "body": "<p>These links show how to add solution-wide aspects:</p>\n\n<ol>\n<li><a href=\"http://doc.postsharp.net/xml-multicasting\" rel=\"nofollow\">Adding Aspects Using XML</a></li>\n<li><a href=\"http://www.postsharp.net/blog/post/New-in-PostSharp-31-Solution-Level-Aspects-and-PostSharp-Configuration-Files\" rel=\"nofollow\">Solution-Level Aspects and PostSharp Configuration Files</a></li>\n<li><a href=\"http://doc.postsharp.net/deadlock-detection\" rel=\"nofollow\">Detecting Deadlocks at Runtime</a></li>\n</ol>\n\n<p><strong>My question</strong>: assuming added some solution-wide-aspect, how can I exclude certain assembly/class/method/whatever ?</p>\n"}, {"tags": ["c#", "winforms", "user-controls", ".net-3.5", "visual-studio-2015"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3791797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f6373d69ca927adc6d0409d005c2be?s=128&d=identicon&r=PG&f=1", "display_name": "user3791797", "link": "https://stackoverflow.com/users/3791797/user3791797"}, "edited": false, "score": 0, "creation_date": 1448488608, "post_id": 33926593, "comment_id": 55615185, "body": "Excellent thanks, this seems like an approach I can follow. I just need to redesign my controls to add the buttons now ;)"}], "tags": [], "owner": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "is_accepted": false, "score": 0, "last_activity_date": 1448486355, "creation_date": 1448486355, "answer_id": 33926593, "question_id": 33925957, "link": "https://stackoverflow.com/questions/33925957/c-user-control-with-sequences-navigate-within-winforms/33926593#33926593", "title": "C# User Control (with sequences). Navigate within WinForms", "body": "<p>I ran into a similar scenario some years ago. If memory serves, I approached it as follows:</p>\n\n<ol>\n<li><p>Separate the navigation buttons into their own control that groups\nthe buttons together. Design this control to support docking.</p></li>\n<li><p>In this control, provide distinct buttons for Back, Next, Finish and\nCancel. Provide separate properties on the control that determine\nwhat the user can do: CanMoveBack, CanMoveForward, CanFinish, and\nCanCancel. The container should be able to set these. </p></li>\n<li><p>In the setter for the navigation properties, you want to be able to\nadjust the visibility/disabled status of each of the navigation\nbuttons. Don't hot-swap text. That way, each button does one thing,\nand only one thing. This keeps their event handlers nice and clean.</p></li>\n<li><p>The user control itself should raise events: OnBackClicked,\nOnNextClicked, OnFinishClicked, and OnCancelClicked. Your button\nevent handlers should raise these. The container should decide what\nto do when they are clicked.</p></li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 3791797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f6373d69ca927adc6d0409d005c2be?s=128&d=identicon&r=PG&f=1", "display_name": "user3791797", "link": "https://stackoverflow.com/users/3791797/user3791797"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448486355, "creation_date": 1448483732, "question_id": 33925957, "link": "https://stackoverflow.com/questions/33925957/c-user-control-with-sequences-navigate-within-winforms", "title": "C# User Control (with sequences). Navigate within WinForms", "body": "<p>I'm looking for the best, most effecient way of implimenting user controls navigation based on events, below is the intended use.</p>\n\n<p>I also don't know what is best, to have the next back button on the control or form.</p>\n\n<p>Lastly, the next button may sometimes change and initially be validate on some controls and then if validated change to next if the validate is ok.</p>\n\n<p>Ok the concept:</p>\n\n<p>I have 1 primary user control with 3 checkboxes, behind each checkbox is a sequence of more user forms therefore, if all three are selected it should then load all three sequences one after another.</p>\n\n<p>Regardless of how many are selected, all sequences end with the same final user control.</p>\n\n<p>Basically I need to understand the best and most practicle way approach this (examples welcome).</p>\n\n<p>There are lots of topics that cover winforms / user control navigation but I cannot seem to see a solution which pops out to me and fits my needs.</p>\n\n<p>For compatibility with some systems, I have decided to use .net 3.5; should this make a difference in suggestions.</p>\n\n<p>Feedback, links, code etc all welcome :)</p>\n"}, {"tags": ["c#", "ms-word", "vsto", "office-interop", "word-2013"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448560270, "post_id": 33925914, "comment_id": 55648191, "body": "I&#39;m not familiar with the syntax you&#39;re using: var test = new { ... }. Testing in-process (VBA) changing the properties you list does work, so it could have something to do with how you&#39;ve constructed your code. You mention this should run on DocumentOpen - it&#39;s possible that when your code is called the document is not quite ready to receive these commands. Could you provide exact repro steps for the real problem?"}, {"owner": {"reputation": 197, "user_id": 1482952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17b79adf32cf29ece2796534e48ec92c?s=128&d=identicon&r=PG", "display_name": "c0nn", "link": "https://stackoverflow.com/users/1482952/c0nn"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448580540, "post_id": 33925914, "comment_id": 55655618, "body": "@CindyMeister Thanks for the response, Cindy. You&#39;re correct that this isn&#39;t how I&#39;m attempting to interact with the <code>MarkupMode</code> property in my code, but even this contrived example demonstrates my problem, and is easy to reproduce. Using the anonymous object construct I provided isn&#39;t necessary; it just shows the properties I&#39;m looking at, and their values when debugging. You can just as easily simply inspect the properties of <code>Document.ActiveWindow.View</code>."}, {"owner": {"reputation": 197, "user_id": 1482952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17b79adf32cf29ece2796534e48ec92c?s=128&d=identicon&r=PG", "display_name": "c0nn", "link": "https://stackoverflow.com/users/1482952/c0nn"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448580894, "post_id": 33925914, "comment_id": 55655701, "body": "@CindyMeister A quick description: After toggling inline revision markup on/off, as shown in the screengrabs I provided, and subsequently inspecting the properties of <code>Document.ActiveWindow.View</code>, whether you do that by triggering a <code>SelectionChange</code> event as I do, or some other mechanism, you can verify that none of the properties I listed (<code>ShowRevisionsAndComments</code>, <code>ShowInsertionsAndDeletions</code>, <code>MarkupMode</code>, <code>RevisionsMode</code>) ever change. Which led me to believe that perhaps I&#39;m not looking at the right property."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448642054, "post_id": 33925914, "comment_id": 55680508, "body": "I&#39;d still be interested in repro steps for how you intend to actually USE the properties. It&#39;s possible that Word is returning &quot;false&quot; information because things haven&#39;t actually taken effect at the time the event you want to use to monitor this triggers. Important is whether the properties can actually be set in VSTO at the point you require them..."}, {"owner": {"reputation": 197, "user_id": 1482952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17b79adf32cf29ece2796534e48ec92c?s=128&d=identicon&r=PG", "display_name": "c0nn", "link": "https://stackoverflow.com/users/1482952/c0nn"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1448822626, "post_id": 33925914, "comment_id": 55728563, "body": "@CindyMeister fair enough. Example of my usage provided in an edit on my post."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 1482952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17b79adf32cf29ece2796534e48ec92c?s=128&d=identicon&r=PG", "display_name": "c0nn", "link": "https://stackoverflow.com/users/1482952/c0nn"}, "edited": false, "score": 0, "creation_date": 1448923766, "post_id": 34007816, "comment_id": 55774959, "body": "Ah, I didn&#39;t consider using the <code>RevisionsView</code> property. This doesn&#39;t exactly fix my issue. You&#39;re looking for the final markup, but I am attempting to do a text search on the string containing <i>both</i> the original and new text, exactly as it appears when revisions are rendered in the document inline. The string I would then be looking for is: &quot;Video provides a powerful useful way to help you prove your point.&quot; In the context of the document, &quot;powerful&quot; underlined, and &quot;useful&quot; struck through. Is this possible?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 197, "user_id": 1482952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17b79adf32cf29ece2796534e48ec92c?s=128&d=identicon&r=PG", "display_name": "c0nn", "link": "https://stackoverflow.com/users/1482952/c0nn"}, "edited": false, "score": 0, "creation_date": 1448924213, "post_id": 34007816, "comment_id": 55775166, "body": "That&#39;s exactly the result the code I posted returned. So, yes, it&#39;s possible and it&#39;s odd you Aren&#39;t getting that, which is why I listed the steps I used in such detail."}, {"owner": {"reputation": 197, "user_id": 1482952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17b79adf32cf29ece2796534e48ec92c?s=128&d=identicon&r=PG", "display_name": "c0nn", "link": "https://stackoverflow.com/users/1482952/c0nn"}, "edited": false, "score": 0, "creation_date": 1448925128, "post_id": 34007816, "comment_id": 55775576, "body": "Ah, I understand. I misunderstood how revisions are searched over -- I assumed that <code>expectedText</code> would always equal the text returned by <code>Range.Text</code>, when it fact it doesn&#39;t, when revisions are in the document. Thanks for your assistance and patience."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1448916852, "creation_date": 1448916852, "answer_id": 34007816, "question_id": 33925914, "link": "https://stackoverflow.com/questions/33925914/word-interop-add-in-changing-window-view-properties-do-not-affect-revision-mar/34007816#34007816", "title": "Word interop add-in - changing Window View properties do not affect Revision markup style", "body": "<p>It works for me. What I did:</p>\n\n<ol>\n<li>Created a test document. Used =rand() ->Press Enter to put some text in the document. Copied in the phrase, changing \"powerful\" to \"useful\".</li>\n<li>Turned on track changes and made some changes, including selecting \"useful\" and typing \"powerful\".</li>\n<li>Made sure the changes were displaying in balloons and the \"Original\" view of the mark-up was being shown.</li>\n<li>Saved and closed the document.</li>\n<li>Put a break-point on the line that calls OccurrenceOfText, then F5 to start the add-in in debug mode.</li>\n<li>Opened the saved document. The Open event fired. I checked the values of the View.Markup and View.RevisionsView - they had changed to inline and \"Final\". Stepped through the rest of the code and it executed correctly (found the occurrence).</li>\n</ol>\n\n<p>I needed to modify your code slightly since I don't have your \"wrapper\". I also changed the way OccurrenceOfText returns the Range: no need to do it in the complicated manner you use...</p>\n\n<p>I note that you do not appear to set View.RevisionsView - perhaps this is why you're not seeing the result you expect?</p>\n\n<pre><code> private void Application_DocumentOpen(Microsoft.Office.Interop.Word.Document doc)\n  {\n            //Test revisions\n    // expected text, as taken from screengrab example above. Includes\n    //  text removed in a revision\n    string expectedText = \"Video provides a powerful way to help you prove your point.\";\n\n    // make sure that we're in print view\n    if (doc.ActiveWindow.View.Type != Word.WdViewType.wdPrintView)\n    {\n        doc.ActiveWindow.View.Type = Word.WdViewType.wdPrintView;\n    }\n\n    // attempt to ensure that document revisions are marked up inline. Does not accomplish anything\n    Word.View vw = doc.ActiveWindow.View;\n    vw.MarkupMode = Word.WdRevisionsMode.wdInLineRevisions;\n    vw.RevisionsView = Word.WdRevisionsView.wdRevisionsViewFinal;      \n    // attempt to locate text. Will fail if revisions are not marked up inline (deletion is not part of document content range otherwise)\n    var locatedRange = OccurrenceOfText(doc.Content, expectedText);\n}\n\n// extension method to locate text inside a range. Searching entire Content in this example\nprivate static Word.Range OccurrenceOfText(Word.Range rng, string text)\n{\n    rng.Find.Forward = true;\n    rng.Find.Format = false;\n\n    rng.Find.Execute(text);\n\n    if (!rng.Find.Found)\n    {\n        throw new Exception(\"Unable to locate text! Are Revisions marked up inline?\");\n    }\n\n    // return brand new range containing located content\n    return rng;  //.Document.Range(rng.Start, rng.End);\n }\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 1482952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17b79adf32cf29ece2796534e48ec92c?s=128&d=identicon&r=PG", "display_name": "c0nn", "link": "https://stackoverflow.com/users/1482952/c0nn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "accepted_answer_id": 34007816, "answer_count": 1, "score": 1, "last_activity_date": 1469883138, "creation_date": 1448483546, "last_edit_date": 1469883138, "question_id": 33925914, "link": "https://stackoverflow.com/questions/33925914/word-interop-add-in-changing-window-view-properties-do-not-affect-revision-mar", "title": "Word interop add-in - changing Window View properties do not affect Revision markup style", "body": "<p>Using an application level add-in, I'm performing some operations on document open that <em>require revisions (tracked changes) to be rendered inline and not hidden</em>, so that they are contained within the <code>Range</code> of the document. After consulting the documentation, I thought that all I had to do was change the <a href=\"https://i.stack.imgur.com/tKB8Z.png\" rel=\"nofollow noreferrer\">the view properties</a> of the active window: <code>MarkupMode</code> claims to do what I want. </p>\n\n<p>But this property seems to be completely disconnected from how revisions display in the document! To test this, I tried toggling the mode manually in a document, and looking at <code>MarkupMode</code>, and checking it immediately afterwards in an <code>onSelectionChange</code> event handler. I went ahead and tracked a bunch of properties of <code>ActiveWindow.View</code>, for good measure. To my surprise and chagrin, when I looked at the locals with changes rendered inline:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tKB8Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tKB8Z.png\" alt=\"before\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/kXJqD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kXJqD.png\" alt=\"before values\"></a></p>\n\n<p><em>... and compared the values to those with changes hidden:</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/xDhP3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xDhP3.png\" alt=\"after\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/2LyOM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2LyOM.png\" alt=\"after values\"></a></p>\n\n<p>Nothing changed! What gives? Am I not looking at the right property/properties to ensure that changes are rendered inline? Is Microsoft completely incapable of writing meaningful documentation? I'll point out that I tried to make the property change in code as well, to see if the rendering of revisions would change, with no success. I would appreciate any feedback.</p>\n\n<p><strong>Edit:</strong> Simple code to duplicate issue:</p>\n\n<pre><code>private void ThisAddIn_Startup(object sender, EventArgs e)\n{\n    Application.WindowSelectionChange += application_WindowSelectionChange;\n}\n\nprivate void application_WindowSelectionChange(Selection sel)\n{\n    var testDoc = sel.Document;\n\n    var test = new\n    {\n        testDoc.ActiveWindow.View,\n        testDoc.ActiveWindow.View.ShowRevisionsAndComments,\n        testDoc.ActiveWindow.View.ShowInsertionsAndDeletions,\n        testDoc.ActiveWindow.View.MarkupMode,\n        testDoc.ActiveWindow.View.RevisionsMode\n    };\n}\n</code></pre>\n\n<p><strong>Edit 2:</strong> Beyond this contrived example, I need to have control over the markup style of Revisions because I am searching for text on <code>DocumentOpen</code> that may include text that is present as <code>Revision</code> objects. More specifically, I am attempting to do the following, using the above text (with text \"powerful way to help you prove \" deleted in a revision):</p>\n\n<pre><code>private void ThisAddIn_Startup(object sender, EventArgs e)\n{\n    Application.DocumentOpen += application_DocumentOpen;\n}\n\nprivate void application_DocumentOpen(Document doc)\n{\n    // expected text, as taken from screengrab example above. Includes\n    //  text removed in a revision\n    string expectedText = \"Video provides a powerful way to help you prove your point.\";\n\n    // make sure that we're in print view\n    if (doc.ActiveWindow.View.Type != WdViewType.wdPrintView)\n    {\n        doc.ActiveWindow.View.Type = WdViewType.wdPrintView;\n    }\n\n    // attempt to ensure that document revisions are marked up inline. Does not accomplish anything\n    doc.ActiveWindow.View.MarkupMode = WdRevisionsMode.wdInLineRevisions;        \n    // attempt to locate text. Will fail if revisions are not marked up inline (deletion is not part of document content range otherwise)\n    var locatedRange = doc.Content.OccurrenceOfText(expectedText);\n}\n\n// extension method to locate text inside a range. Searching entire Content in this example\nprivate static Range OccurrenceOfText(this Range rng, string text)\n{\n    rng.Find.Forward = true;\n    rng.Find.Format = false;\n\n    rng.Find.Execute(text);\n\n    if (!rng.Find.Found)\n    {\n        throw new Exception(\"Unable to locate text! Are Revisions marked up inline?\");\n    }\n\n    // return brand new range containing located content\n    return rng.Document.Range(rng.Start, rng.End);\n}\n</code></pre>\n\n<p><strong>Edit 3:</strong> As Cindy made clear, my problem was that I was using the wrong property: I needed to use the <code>View.RevisionsFilter.Markup</code> property to make the change. Additionally, an issue that I hadn't diagnosed is that depending on the View properties, it is entirely possible that the <code>Range</code> returned from a search performed as I do returns a <code>Text</code> property that is different than the text that was searched with. This can happen if <code>Revision</code> objects are present inside the <code>Range</code>.</p>\n"}, {"tags": ["c#", ".net", "multithreading", "timer", "synchronization"], "comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448484414, "post_id": 33925903, "comment_id": 55613111, "body": "I find the question unclear. Please explain why you are using two concurrently running timers in the first place. Why not just start one timer, and then when it has elapsed, start a second one? Why, since the intervals for the two timers are different, do you have any expectation that they would remain synchronous even after one iteration? What have you tried to attempt to address whatever synchronization issue you are concerned with? How is this question not a duplicate of the many existing questions on Stack Overflow involving timers and synchronization with a real-time clock?"}, {"owner": {"reputation": 12857, "user_id": 1282539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d73911f3fb624361e7d39b82f9395cc1?s=128&d=identicon&r=PG", "display_name": "SimpleVar", "link": "https://stackoverflow.com/users/1282539/simplevar"}, "edited": false, "score": 0, "creation_date": 1448484593, "post_id": 33925903, "comment_id": 55613194, "body": "<code>System.Windows.Forms.Timer</code> are not that accurate. If you want accuracy try using <code>System.Timers.Timer</code> or <code>System.Threading.Timer</code>, you can find all the differences <a href=\"https://web.archive.org/web/20150329101415/https://msdn.microsoft.com/en-us/magazine/cc164015.aspx\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "reply_to_user": {"reputation": 12857, "user_id": 1282539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d73911f3fb624361e7d39b82f9395cc1?s=128&d=identicon&r=PG", "display_name": "SimpleVar", "link": "https://stackoverflow.com/users/1282539/simplevar"}, "edited": false, "score": 0, "creation_date": 1448484954, "post_id": 33925903, "comment_id": 55613337, "body": "@SimpleVar: though, none of those timer classes are 100% precise. Because they all have the contract that the timer will be fire no earlier than the given interval, but possibly later, and because they are all subject to the vagaries of Windows&#39; thread scheduling, they will all have similar imprecisions. To be precise over a long period of time, code relying on timing needs to take into account an external clock (e.g. the computer&#39;s real time clock). Alternatively, one might choose to just use one timer instead, running multiple activities from that timer. It depends on the situation."}, {"owner": {"reputation": 12857, "user_id": 1282539, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d73911f3fb624361e7d39b82f9395cc1?s=128&d=identicon&r=PG", "display_name": "SimpleVar", "link": "https://stackoverflow.com/users/1282539/simplevar"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448485251, "post_id": 33925903, "comment_id": 55613488, "body": "@PeterDuniho I agree. The <code>Forms.Timer</code> is <i>way</i> inaccurate though. I would also consider having only one timer, and work with it - it is the easiest and least limiting option, since the timers don&#39;t really have to be accurate as they just have to be synced."}, {"owner": {"reputation": 43, "user_id": 5529489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-un94v6EvjzU/AAAAAAAAAAI/AAAAAAAABHI/exQ52ZaZfsI/photo.jpg?sz=128", "display_name": "HugoHonda", "link": "https://stackoverflow.com/users/5529489/hugohonda"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448490048, "post_id": 33925903, "comment_id": 55615832, "body": "@PeterDuniho I thought I should create the two timers independently so I could use them again in other processes. I tried to use lock instruction to sync them but it was also not successfull. The fact is that you are right, Forms.Timer is inaccurate for what I need. The easiest way to solve was using the the answer down here. I had also to add async to the button click method. I will study more the case to understand and see if it won&#39;t give me any problems in the future. Thank you guys"}], "answers": [{"comments": [{"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448484223, "post_id": 33926069, "comment_id": 55613014, "body": "How does this address the OP&#39;s difficulty in synchronizing <i>two</i> timed activities?"}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448484613, "post_id": 33926069, "comment_id": 55613202, "body": "@PeterDuniho, as per his first sentence in the question, OP is trying to show the label for some time and then hide it for some time, and this is exactly what this code does. His attempt to use two timers will not give him what he wants as far as I understand his requirement."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448484823, "post_id": 33926069, "comment_id": 55613293, "body": "All due respect, I don&#39;t think you can say <i>what</i> the OP is trying to do. His problem description says <i>&quot;after some expositions&quot;</i>, not <i>&quot;after a single exposition&quot;</i>. The timers are already out of sync after a single exposition, so if that were all he was concerned about, surely that&#39;s what he&#39;d have said. It&#39;s clear you&#39;re willing to make the assumption, but it&#39;s just that: an assumption. The code in your answer doesn&#39;t actually do the same thing that the OP&#39;s code does, and the OP hasn&#39;t been clear about just how far from the behavior he&#39;s got he wants to go."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 2, "creation_date": 1448485062, "post_id": 33926069, "comment_id": 55613390, "body": "@PeterDuniho, as far as I understand the question, the original requirement is to hide and show the label for specific time periods. The fact that OP choose to use two timers is just an attempt to meet this requirement. My answer is telling OP that he can meet his original requirement without using two timers."}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1448485502, "post_id": 33926069, "comment_id": 55613604, "body": "@YacoubMassad In order for this to compile, you have to add <code>async</code> to the button click method."}, {"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1448485589, "post_id": 33926069, "comment_id": 55613654, "body": "@RonBeyer, I actually compiled and tested this :)"}, {"owner": {"reputation": 43, "user_id": 5529489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-un94v6EvjzU/AAAAAAAAAAI/AAAAAAAABHI/exQ52ZaZfsI/photo.jpg?sz=128", "display_name": "HugoHonda", "link": "https://stackoverflow.com/users/5529489/hugohonda"}, "edited": false, "score": 0, "creation_date": 1448490333, "post_id": 33926069, "comment_id": 55615960, "body": "@YacoubMassad Thank you, your answer is really a better way and solved my problem until now. Forms.Timer is really inaccurate for what I need. I also had to add async to the button click method. Thank you very much :)"}], "tags": [], "owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "is_accepted": true, "score": 2, "last_activity_date": 1448484845, "last_edit_date": 1448484845, "creation_date": 1448484169, "answer_id": 33926069, "question_id": 33925903, "link": "https://stackoverflow.com/questions/33925903/c-precisely-show-label-for-x-seconds-and-hide-it-for-y-seconds/33926069#33926069", "title": "C# precisely show label for X seconds and hide it for Y seconds", "body": "<p>A better way to do this is as like this:</p>\n\n<pre><code>private async Task DoIt()\n{\n    for(int i = 0 ; i &lt; numExpositions; i++)\n    {\n        wordLabel.Visible = true;\n        await Task.Delay(expositionTime); //expositionTime is the number of milliseconds to keep the label visible\n        wordLabel.Visible = false;\n        await Task.Delay(intervalTime); //intervalTime is the number of milliseconds to keep the label hidden\n    }\n\n}\n\nprivate void button1_Click(object sender, EventArgs e)\n{\n    DoIt();\n}\n</code></pre>\n\n<p>This requires you to use the .NET framework version 4.5 or later.</p>\n"}], "owner": {"reputation": 43, "user_id": 5529489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-un94v6EvjzU/AAAAAAAAAAI/AAAAAAAABHI/exQ52ZaZfsI/photo.jpg?sz=128", "display_name": "HugoHonda", "link": "https://stackoverflow.com/users/5529489/hugohonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 933, "favorite_count": 0, "closed_date": 1448569287, "accepted_answer_id": 33926069, "answer_count": 1, "score": 3, "last_activity_date": 1448484845, "creation_date": 1448483484, "question_id": 33925903, "link": "https://stackoverflow.com/questions/33925903/c-precisely-show-label-for-x-seconds-and-hide-it-for-y-seconds", "closed_reason": "Needs details or clarity", "title": "C# precisely show label for X seconds and hide it for Y seconds", "body": "<p>I am writing a code for a form that should <strong>precisely</strong> blink a word Label.\nIt uses an \"expositionTime\" to <strong>show a Label for X millisececonds</strong> and an \"intervalTime\" to <strong>hide it for Y milliseconds</strong>.</p>\n\n<p>The process will be repeated for Z times 'numExpositions' and starts after a button is clicked.\nMy code is working without errors, I am using two timers to do the work.\nThe problem is that <strong>the timers get desynchronized</strong> after some expositions.</p>\n\n<p><strong>My question is if is there a solution that gives me precise time syncronization, where exposition time (show label) and interval (hide) will start and finish together - maybe using timers elapse on separate threads or monitor wait and how implement them.</strong></p>\n\n<p>Part of my code using two timers:</p>\n\n<pre><code>private System.Windows.Forms.Timer timer1;\nprivate System.Windows.Forms.Timer timer2;\nprivate static int counter = 0;\nprivate static int numExpositions = 16;\nprivate static int expositionTime = 2000;\nprivate static int intervalTime = 1800;\n\n// starts both timers that get desynchronized after some time \nprivate void button1_Click(object sender, EventArgs e) { startTimer1(); startTimer2(); }\n\npublic void startTimer1()\n{\n        timer1 = new System.Windows.Forms.Timer() { Interval = expositionTime + intervalTime };\n        timer1.Tick += new EventHandler(OnTimer1Event);\n        timer1.Start();\n}\n\npublic void startTimer2()\n{\n        timer2 = new System.Windows.Forms.Timer() { Interval = intervalTime };\n        timer2.Tick += new EventHandler(OnTimer2Event);\n        timer2.Start();\n}\n\nprivate void OnTimer1Event(object sender, EventArgs e)\n{\n    if (counter &gt;= numExpositions) // stops timers\n        {\n            timer1.Stop();\n            timer2.Stop();\n            wordLabel.Visible = false;\n            counter = 0;\n            this.Close()\n        }\n        else\n        {\n            wordLabel.Visible = true; // shows wordLabel\n        }\n    }\n\nprivate void OnTimer2Event(object sender, EventArgs e)\n{\n    wordLabel.Visible = false; // hides wordLabel\n}\n</code></pre>\n"}, {"tags": ["c#", "excel", "performance"], "comments": [{"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1448484233, "post_id": 33925872, "comment_id": 55613016, "body": "Accessing Excel (mainly with something as comprehensive as Interop) is very slow. 6 mins sounds too much time though. If all what you want is reading cell values, it would be better to rely on a faster approach (e.g., convert it to CSV and access it as a text file)."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 2898637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kU9sl.jpg?s=128&g=1", "display_name": "MMHRA", "link": "https://stackoverflow.com/users/2898637/mmhra"}, "edited": false, "score": 0, "creation_date": 1448484524, "post_id": 33926061, "comment_id": 55613161, "body": "i have tested your suggest but it still takes pretty much time to do all loops.its not about StringBuilder. its about the amount of cells and loops."}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "reply_to_user": {"reputation": 17, "user_id": 2898637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kU9sl.jpg?s=128&g=1", "display_name": "MMHRA", "link": "https://stackoverflow.com/users/2898637/mmhra"}, "edited": false, "score": 0, "creation_date": 1448484615, "post_id": 33926061, "comment_id": 55613205, "body": "@MohammadMahdiHajiRamezanAli As said above: accessing Excel is slow (mainly with Interop), if you just want to read all the cells, you wouldn&#39;t need to access it as an Excel file (becuase you are not using all the associated special Excel features), but as a mere CSV file (text file)."}, {"owner": {"reputation": 2390, "user_id": 4810224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QQuLz.jpg?s=128&g=1", "display_name": "bot_insane", "link": "https://stackoverflow.com/users/4810224/bot-insane"}, "reply_to_user": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1448484757, "post_id": 33926061, "comment_id": 55613264, "body": "@varocarbas I didn&#39;t get it. <code>label1.Text + &quot;some text&quot;</code> is creating new object over and over and assigning it to <code>label1.Text</code>. Also marking previous object for GC collectiong. I am saying something wrong ?"}, {"owner": {"reputation": 17, "user_id": 2898637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kU9sl.jpg?s=128&g=1", "display_name": "MMHRA", "link": "https://stackoverflow.com/users/2898637/mmhra"}, "reply_to_user": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1448485092, "post_id": 33926061, "comment_id": 55613403, "body": "@varocarbas then you mean there is no way to make it faster? would it be faster if they were in a text file?thanks"}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "reply_to_user": {"reputation": 17, "user_id": 2898637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kU9sl.jpg?s=128&g=1", "display_name": "MMHRA", "link": "https://stackoverflow.com/users/2898637/mmhra"}, "edited": false, "score": 0, "creation_date": 1448485195, "post_id": 33926061, "comment_id": 55613451, "body": "@MohammadMahdiHajiRamezanAli There are always ways to make things faster. I am saying that for what you are doing it would be better to treat it as CSV; this is an automatic conversion as far as CSV is a supported format by Excel. You store the workbook as CSV and access it as text."}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1448723373, "post_id": 33926061, "comment_id": 55701839, "body": "@AramKocharyan I am coming back to properly state my position (because I have read quite a few ideas on your same line of thought during the last days). Assignation/reinstantiation of a single variable (even of 1000) is not relevant at all from a macroscopic point of view. Things like <code>StringBilder</code> might be the best approach for different reasons, but not for delivering a better (and actually noticeably) improvement in performance/memory. Not understanding this point would be like thinking that coke light + whisky has less calories than water..."}, {"owner": {"reputation": 12216, "user_id": 2480047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d9d32532677b536217a7df8b35f106?s=128&d=identicon&r=PG", "display_name": "varocarbas", "link": "https://stackoverflow.com/users/2480047/varocarbas"}, "edited": false, "score": 0, "creation_date": 1448723690, "post_id": 33926061, "comment_id": 55701950, "body": "... That is: using any kind of string concatenation cannot be seen as a way to improve performance (or memory management). You might fully optimise a given code without even caring about this issue. In any case and as said the other day, knowing a bit about the underlying reality is not a bad thing (as long as you apply the ideas in the right context). The inmutable character of the string type is a bit tricky (in .NET and everywhere) and provokes memory re-allocations in quite a few scenarios (other than the ones I mentioned in my previous comments), but this happens at a veeeeery tiny level."}], "tags": [], "owner": {"reputation": 2390, "user_id": 4810224, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QQuLz.jpg?s=128&g=1", "display_name": "bot_insane", "link": "https://stackoverflow.com/users/4810224/bot-insane"}, "is_accepted": false, "score": 0, "last_activity_date": 1448484105, "creation_date": 1448484105, "answer_id": 33926061, "question_id": 33925872, "link": "https://stackoverflow.com/questions/33925872/reading-excel-cells-takes-a-lot-of-time/33926061#33926061", "title": "Reading Excel cells takes a lot of time", "body": "<blockquote>\n  <p>The String object is immutable. Every time you use one of the methods\n  in the System.String class, you create a new string object in memory,\n  which requires a new allocation of space for that new object.</p>\n</blockquote>\n\n<p>Use <code>StringBuilder</code> when populating data from excel, then put it into <code>label1.Text</code></p>\n\n<p>Here is example: </p>\n\n<pre><code>label1.Text = \"\";\n\nStringBuilder excelContent = new StringBuilder();\n\nfor ( j = 1; j &lt;=last_row; j++)\n{\n    for ( i = 1; i &lt;= last_column; i++)\n    {\n        if (xlws.Cells[j,i].value != null)\n        {\n            excelContent.Append(xlws.Cells[j, i].value.ToString());\n        }\n    }\n    excelContent.Append(\"\\n\");\n}\n\nlabel1.Text = excelContent.ToString();\n</code></pre>\n\n<p>You can read more about <code>StringBuilder</code> <a href=\"https://msdn.microsoft.com/en-us/library/2839d5h5(v=vs.110).aspx\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1488, "user_id": 1723904, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf0fcd1786bd69aa2800fbf8d5febddf?s=128&d=identicon&r=PG", "display_name": "DeadZone", "link": "https://stackoverflow.com/users/1723904/deadzone"}, "is_accepted": false, "score": 1, "last_activity_date": 1448484967, "creation_date": 1448484967, "answer_id": 33926253, "question_id": 33925872, "link": "https://stackoverflow.com/questions/33925872/reading-excel-cells-takes-a-lot-of-time/33926253#33926253", "title": "Reading Excel cells takes a lot of time", "body": "<p>My company has several internal tools that access Excel workbooks.  And there are several ways to do so.  Treating the workbook as a data source and querying it with OleDb works well.  In my experience it is much faster than using Excel Automation.  Here is some sample code that comes from an existing project.  It queries a workbook that has 2 spreadsheets, one for Metric units and one for English (Imperial) units.  Hope it helps...</p>\n\n<pre><code>// get Excel file that should be imported\nstring strFilePath = \"\";\nthis.openFileDialog.Title = \"Select Excel File For Importing\";\nthis.openFileDialog.Filter = \"Excel Files|*.xls;\";\nthis.openFileDialog.CheckFileExists = true;\nthis.openFileDialog.Multiselect = false;\nthis.openFileDialog.ShowDialog();\nstrFilePath = this.openFileDialog.FileName;\nthis.txtExcelFileName.Text = this.openFileDialog.FileName;\n\nstring strConnectionString = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + strFilePath + \";Extended Properties=\\\"Excel 8.0;HDR=YES;IMEX=1;ImportMixedTypes=Text;\\\"\";\nSystem.Data.OleDb.OleDbDataAdapter dataAdapterExcel = new System.Data.OleDb.OleDbDataAdapter();\nSystem.Data.OleDb.OleDbConnection oledbConnection = new System.Data.OleDb.OleDbConnection(strConnectionString);\nDataTable tblEnglishTab = new DataTable(\"English\");\nDataTable tblMetricTab = new DataTable(\"Metric\");\nDataSet datasetExcelData = new DataSet();\n\noledbConnection.Open();\nSystem.Data.OleDb.OleDbCommand cmdselect = new System.Data.OleDb.OleDbCommand();\n\ntry\n{\n    cmdselect.CommandText = \"SELECT * FROM [English$A1:N10000]\";\n    cmdselect.Connection = oledbConnection;\n    dataAdapterExcel.SelectCommand = cmdselect;\n    dataAdapterExcel.Fill(tblEnglishTab);\n    datasetExcelData.Tables.Add(tblEnglishTab);\n}    \ncatch (Exception)\n{\n    MessageBox.Show(\"Please verify the Excel file type.\\nUnable to locate the English worksheet in the specified file.\"Excel Import\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n}    \ntry\n{\n    cmdselect.CommandText = \"SELECT * FROM [Metric$A1:N10000]\";\n    cmdselect.Connection = oledbConnection;\n    dataAdapterExcel.SelectCommand = cmdselect;\n    dataAdapterExcel.Fill(tblMetricTab);\n    datasetExcelData.Tables.Add(tblMetricTab);\n}\ncatch (Exception)\n{\n    MessageBox.Show(\"Please verify the Excel file type.\\nUnable to locate the Metric worksheet in the specified file.\", \"Excel Import\", MessageBoxButtons.OK, MessageBoxIcon.Error);\n}\noledbConnection.Close();\ndataAdapterExcel = null;\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 2898637, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kU9sl.jpg?s=128&g=1", "display_name": "MMHRA", "link": "https://stackoverflow.com/users/2898637/mmhra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1448486536, "creation_date": 1448483349, "last_edit_date": 1448486536, "question_id": 33925872, "link": "https://stackoverflow.com/questions/33925872/reading-excel-cells-takes-a-lot-of-time", "title": "Reading Excel cells takes a lot of time", "body": "<p>I have an Excel file which it has 360 rows and 181 columns (65,160 cells). Most of the cells are empty and I just want to save non-empty cells.</p>\n\n<p>The Main problem is, when I run my code, it takes about six minutes to process all of the cells and this procedure should be done for 3,000 Excel files. I wrote this code in my form_load event:</p>\n\n<pre><code>        Excel.Application xlapp;\n        Excel.Workbook xlwb;\n        Excel.Worksheet xlws;\n\n        object misValue = System.Reflection.Missing.Value;\n\n        xlapp = new Excel.Application();\n        xlwb = xlapp.Workbooks.Open(\"test.xlsx\", 0, true, 5, \"\", \"\", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, \"\\t\", false, false, 0, true, 1, 0);\n        xlws = (Excel.Worksheet)xlwb.Worksheets.get_Item(1);\n\n        int i = 0;\n        int j = 0;\n\n        Int32 last_row = Convert.ToInt32(xlws.UsedRange.Rows.Count);\n        Int32 last_column = Convert.ToInt32(xlws.UsedRange.Columns.Count);\n\n        label1.Text = \"\";\n\n        for ( j = 1; j &lt;=last_row; j++)\n        {\n            for ( i = 1; i &lt;= last_column; i++)\n            {\n                if (xlws.Cells[j,i].value != null)\n                {\n                    label1.Text = label1.Text + xlws.Cells[j, i].value.ToString();\n                }\n            }\n            label1.Text += \"\\n\";\n        }\n\n        xlwb.Close(true, misValue, misValue);\n        xlapp.Quit();\n\n        releaseObject(xlws);\n        releaseObject(xlwb);\n        releaseObject(xlapp);\n</code></pre>\n\n<p>and this is my releaseObject function:</p>\n\n<pre><code>        private void releaseObject(object obj)\n    {\n\n        try\n        {System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n         obj = null;}\n\n        catch (Exception ex)\n        {obj = null;\n         MessageBox.Show(\"Unable to release the Object \" + ex.ToString());}\n\n        finally\n\n        {GC.Collect();}\n\n    }  \n</code></pre>\n\n<p>Is there any way to reduce the wasted time?</p>\n"}, {"tags": ["c#", "asp.net-mvc", "asp.net-web-api"], "comments": [{"owner": {"reputation": 7098, "user_id": 169635, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/152aa709c559fc190524753c556b39e7?s=128&d=identicon&r=PG", "display_name": "Sergey Litvinov", "link": "https://stackoverflow.com/users/169635/sergey-litvinov"}, "edited": false, "score": 0, "creation_date": 1448483142, "post_id": 33925750, "comment_id": 55612450, "body": "Are your sample is correct? your <code>Paginate</code> method has 4 parameters(ignoring params), but you are sanding just 3 in the sample call"}, {"owner": {"reputation": 19212, "user_id": 4275342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/KnE9R.png?s=128&g=1", "display_name": "Roman Marusyk", "link": "https://stackoverflow.com/users/4275342/roman-marusyk"}, "reply_to_user": {"reputation": 7098, "user_id": 169635, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/152aa709c559fc190524753c556b39e7?s=128&d=identicon&r=PG", "display_name": "Sergey Litvinov", "link": "https://stackoverflow.com/users/169635/sergey-litvinov"}, "edited": false, "score": 0, "creation_date": 1448484732, "post_id": 33925750, "comment_id": 55613256, "body": "Yes, U&#39;re right. It was just a mistake. I&#39;ve already updated the question"}], "answers": [{"tags": [], "owner": {"reputation": 7098, "user_id": 169635, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/152aa709c559fc190524753c556b39e7?s=128&d=identicon&r=PG", "display_name": "Sergey Litvinov", "link": "https://stackoverflow.com/users/169635/sergey-litvinov"}, "is_accepted": true, "score": 6, "last_activity_date": 1448483310, "creation_date": 1448483310, "answer_id": 33925858, "question_id": 33925750, "link": "https://stackoverflow.com/questions/33925750/how-to-use-paginate-method/33925858#33925858", "title": "How to use Paginate method", "body": "<p>Your method signature has <code>TKey</code> that i suppose is a key for sorting, but in your call you are specifying the whole object <code>Region</code>, and then you specify <code>int</code> in the <code>keySelector</code>, so it can't compile it as it tries to use <code>int</code> type as <code>Region</code> type for <code>TKey</code>. </p>\n\n<p>I suppose your sample should be:</p>\n\n<pre><code>repository.Paginate&lt;int&gt;(pageNo, pageSize, x =&gt; x.ID, null);\n</code></pre>\n\n<p>Generic type <code>T</code> i suppose is specified for the whole class, so it should be fine here to not specify it in the call, as repository instance is already generic specific.</p>\n"}], "owner": {"reputation": 19212, "user_id": 4275342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/KnE9R.png?s=128&g=1", "display_name": "Roman Marusyk", "link": "https://stackoverflow.com/users/4275342/roman-marusyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 1, "accepted_answer_id": 33925858, "answer_count": 1, "score": 6, "last_activity_date": 1448484697, "creation_date": 1448482917, "last_edit_date": 1448484697, "question_id": 33925750, "link": "https://stackoverflow.com/questions/33925750/how-to-use-paginate-method", "title": "How to use Paginate method", "body": "<p>I have a problem with a PaginatedList in a Web API project.</p>\n\n<p>In the repository there's a method like:</p>\n\n<pre><code>public virtual PaginatedList&lt;T&gt; Paginate&lt;TKey&gt;(int pageIndex, int pageSize,\n    Expression&lt;Func&lt;T, TKey&gt;&gt; keySelector,\n    Expression&lt;Func&lt;T, bool&gt;&gt; predicate,\n    params Expression&lt;Func&lt;T, object&gt;&gt;[] includeProperties)\n{\n    IQueryable&lt;T&gt; query = AllIncluding(includeProperties).OrderBy(keySelector);\n\n    query = (predicate == null)\n        ? query\n        : query.Where(predicate);\n\n    return query.ToPaginatedList(pageIndex, pageSize);\n}\n</code></pre>\n\n<p>But, when I try to use it, like this:</p>\n\n<pre><code>var a = repository.Paginate&lt;Region&gt;(pageNo, pageSize, x =&gt; x.ID, null);\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>Cannot implicitly convert type 'int' to\n  'Domain.Entities.Dictionaries.Region'</p>\n</blockquote>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c#", "amazon-web-services", "amazon-s3"], "answers": [{"tags": [], "owner": {"reputation": 719, "user_id": 62511, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ce9cbd6275e1f2140b3f8bd9d09d161?s=128&d=identicon&r=PG", "display_name": "Russ960", "link": "https://stackoverflow.com/users/62511/russ960"}, "is_accepted": true, "score": 6, "last_activity_date": 1448913576, "creation_date": 1448913576, "answer_id": 34006900, "question_id": 33925680, "link": "https://stackoverflow.com/questions/33925680/aws-multi-part-upload-error-the-xml-you-provided-was-not-well-formed-or-did-not/34006900#34006900", "title": "AWS Multi-Part Upload error: The XML you provided was not well-formed or did not validate against our published schema", "body": "<p>The issue was found that while the example code does not use PartETag it is necessary.  I added the following under the definition of UploadPartResponse:</p>\n\n<pre><code>List&lt;PartETag&gt; partETags = new List&lt;PartETag&gt;();\n</code></pre>\n\n<p>Then added the following after the uploadResponses.Add portion of code:</p>\n\n<pre><code>PartETag petag = new PartETag(s3Client.UploadPart(uploadRequest).PartNumber, s3Client.UploadPart(uploadRequest).ETag);\npartETags.Add(petag);\n</code></pre>\n\n<p>Finally modified CompleteMultipartUploadRequest to the code below:</p>\n\n<pre><code>// Step 3: complete.\nCompleteMultipartUploadRequest completeRequest = new CompleteMultipartUploadRequest\n{\n    BucketName = bucketName,\n    Key = fileTest, \n    UploadId = initResponse.UploadId,\n    PartETags = partETags\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6466430, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f3561b470fd38275677f990456464d33?s=128&d=identicon&r=PG", "display_name": "wolle", "link": "https://stackoverflow.com/users/6466430/wolle"}, "is_accepted": false, "score": 3, "last_activity_date": 1465935235, "creation_date": 1465935235, "answer_id": 37821268, "question_id": 33925680, "link": "https://stackoverflow.com/questions/33925680/aws-multi-part-upload-error-the-xml-you-provided-was-not-well-formed-or-did-not/37821268#37821268", "title": "AWS Multi-Part Upload error: The XML you provided was not well-formed or did not validate against our published schema", "body": "<p>you have to simply add the last line, instaed of creating a list an calling UploadPart twice:</p>\n\n<pre><code> CompleteMultipartUploadRequest completeRequest = new CompleteMultipartUploadRequest\n            {\n                BucketName = bucketName,\n                Key = keyName,\n                UploadId = initResponse.UploadId,\n                PartETags = uploadResponses.Select(part=&gt;new PartETag(part.PartNumber,part.ETag)).ToList()\n            };\n</code></pre>\n"}], "owner": {"reputation": 719, "user_id": 62511, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7ce9cbd6275e1f2140b3f8bd9d09d161?s=128&d=identicon&r=PG", "display_name": "Russ960", "link": "https://stackoverflow.com/users/62511/russ960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2347, "favorite_count": 1, "accepted_answer_id": 34006900, "answer_count": 2, "score": 2, "last_activity_date": 1549918991, "creation_date": 1448482581, "question_id": 33925680, "link": "https://stackoverflow.com/questions/33925680/aws-multi-part-upload-error-the-xml-you-provided-was-not-well-formed-or-did-not", "title": "AWS Multi-Part Upload error: The XML you provided was not well-formed or did not validate against our published schema", "body": "<p>I have used the sample code from Amazon and it seems to work ok but then fails with the following error:</p>\n\n<blockquote>\n  <p>The XML you provided was not well-formed or did not validate against\n  our published schema</p>\n</blockquote>\n\n<p>I think the ETags is required though commented out in doc (<a href=\"http://docs.aws.amazon.com/AmazonS3/latest/dev/LLuploadFileDotNet.html\" rel=\"nofollow\">http://docs.aws.amazon.com/AmazonS3/latest/dev/LLuploadFileDotNet.html</a>).  I have been struggling building this.  </p>\n\n<p>Code:\n        // List to store upload part responses.\n        List uploadResponses = new List();</p>\n\n<pre><code>    // 1. Initialize.\n    InitiateMultipartUploadRequest initiateRequest = new InitiateMultipartUploadRequest\n    {\n        BucketName = bucketName,\n        Key = keyName\n    };\n\n    InitiateMultipartUploadResponse initResponse = s3Client.InitiateMultipartUpload(initiateRequest);\n\n    // 2. Upload Parts.\n    long contentLength = new FileInfo(fileName).Length;\n    long partSize = 5 * (long)Math.Pow(2, 20); // 5 MB\n\n    try\n    {\n        long filePosition = 0;\n        for (int i = 1; filePosition &lt; contentLength; i++)\n        {\n\n            // Create request to upload a part.\n            UploadPartRequest uploadRequest = new UploadPartRequest\n            {\n                BucketName = bucketName,\n                Key = keyName,\n                UploadId = initResponse.UploadId,\n                PartNumber = i,\n                PartSize = partSize,\n                FilePosition = filePosition,\n                FilePath = fileName\n            };\n\n            // Upload part and add response to our list.\n            uploadResponses.Add(s3Client.UploadPart(uploadRequest));\n            filePosition += partSize;\n        }\n\n        // Step 3: complete.\n        CompleteMultipartUploadRequest completeRequest = new CompleteMultipartUploadRequest\n        {\n            BucketName = bucketName,\n            Key = keyName,\n            UploadId = initResponse.UploadId\n        };\n\n        CompleteMultipartUploadResponse completeUploadResponse =\n          s3Client.CompleteMultipartUpload(completeRequest);\n\n        return \"Complete\";\n</code></pre>\n"}, {"tags": ["c#", "xml"], "comments": [{"owner": {"reputation": 18407, "user_id": 797882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YKWuK.jpg?s=128&g=1", "display_name": "CodeNotFound", "link": "https://stackoverflow.com/users/797882/codenotfound"}, "edited": false, "score": 0, "creation_date": 1448482924, "post_id": 33925674, "comment_id": 55612348, "body": "The XML you lput in nyour question look like the original. You must put the content of the line is spotted in the error message."}, {"owner": {"reputation": 161, "user_id": 5554574, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-EW-0RNbUQUc/AAAAAAAAAAI/AAAAAAAAAIo/I-bC6O_UJ_g/photo.jpg?sz=128", "display_name": "Fatih Sert", "link": "https://stackoverflow.com/users/5554574/fatih-sert"}, "edited": false, "score": 0, "creation_date": 1448484867, "post_id": 33925674, "comment_id": 55613306, "body": "I did not reproduce the same situation. Everything looks good. Also your xml is well-formatted"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1448486510, "post_id": 33925674, "comment_id": 55614143, "body": "The portion of the xml file you posted looks good.  I would check the entire xml as follows from menu : Project : Add New Item : XML File.  A window will open with the identification xml line.  Paste your xml into window.  The errors will show up in the Error List windows just like any other compiler error."}, {"owner": {"reputation": 740, "user_id": 3593686, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vsoPH.jpg?s=128&g=1", "display_name": "Paulo Hgo", "link": "https://stackoverflow.com/users/3593686/paulo-hgo"}, "reply_to_user": {"reputation": 18407, "user_id": 797882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YKWuK.jpg?s=128&g=1", "display_name": "CodeNotFound", "link": "https://stackoverflow.com/users/797882/codenotfound"}, "edited": false, "score": 0, "creation_date": 1448486661, "post_id": 33925674, "comment_id": 55614214, "body": "@CodeNotFound There is no line 1960 in the file... that&#39;s what&#39;s puzzling me."}, {"owner": {"reputation": 740, "user_id": 3593686, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vsoPH.jpg?s=128&g=1", "display_name": "Paulo Hgo", "link": "https://stackoverflow.com/users/3593686/paulo-hgo"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1448486939, "post_id": 33925674, "comment_id": 55614351, "body": "@jdweng I had tried that already. I did all the obvious things like restarting VS and so on... no clue on what&#39;s going on here."}, {"owner": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "edited": false, "score": 0, "creation_date": 1448486960, "post_id": 33925674, "comment_id": 55614364, "body": "There&#39;s no explicit path on the file name in your code (strFileToLoad). Are you <i>sure</i> you&#39;re reading the file you think you&#39;re reading?"}, {"owner": {"reputation": 740, "user_id": 3593686, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vsoPH.jpg?s=128&g=1", "display_name": "Paulo Hgo", "link": "https://stackoverflow.com/users/3593686/paulo-hgo"}, "edited": false, "score": 0, "creation_date": 1448487505, "post_id": 33925674, "comment_id": 55614620, "body": "As stupid as it sounds, I rebooted my machine and i doesn&#39;t happen anymore.... I guess I&#39;ll never know what happened here. Maybe some other process locking this file like an editor that didn&#39;t exit properly... not sure. thanks for your help though!"}], "owner": {"reputation": 740, "user_id": 3593686, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vsoPH.jpg?s=128&g=1", "display_name": "Paulo Hgo", "link": "https://stackoverflow.com/users/3593686/paulo-hgo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448482566, "creation_date": 1448482566, "question_id": 33925674, "link": "https://stackoverflow.com/questions/33925674/nbsp-issue-reading-xml", "title": "nbsp issue reading XML", "body": "<p>There are several posts on this issue but none of the solutions seem to work for me. Not sure what I'm doing wrong. \nI'm trying to read an XML file that looks like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;content languageCode=\"en\" languageID=\"1\"&gt;\n  &lt;ftypeparser&gt;c:\\users\\pdeoliveira\\Documents\\Xmlparsernew.xml&lt;/ftypeparser&gt;\n  &lt;xmlparser&gt;c:\\users\\pdeoliveira\\Documents\\Xmlparser.xml&lt;/xmlparser&gt;\n  &lt;sourcelocation&gt;c:\\localization\\2015&lt;/sourcelocation&gt;\n  &lt;rpkfile&gt;RPK_DefaultSyllabi_2015.xml&lt;/rpkfile&gt;\n  &lt;loglocation&gt;c:\\users\\pdeoliveira\\Documents\\Buildloc_Log.txt&lt;/loglocation&gt;\n  &lt;losefiles&gt;&lt;locfile&gt;c:\\localization\\2015\\Strings.xml&lt;/locfile&gt;&lt;/losefiles&gt;\n&lt;/content&gt;\n</code></pre>\n\n<p>Here's the code that reads it: </p>\n\n<pre><code>        XmlDocument doc = new XmlDocument();\n        string filetoload = \"config.xml\";\n            try\n            {\n                doc.Load(filetoload);\n            }\n            catch (Exception e)\n            {\n             Console.Writeline(e);\n            }\n</code></pre>\n\n<p>And here's the exception I get: </p>\n\n<pre><code>System.Xml.XmlException: Reference to undeclared entity 'nbsp'. Line 1960, position 12.\n    at System.Xml.XmlTextReaderImpl.Throw(Exception e)\n    at System.Xml.XmlTextReaderImpl.HandleGeneralEntityReference(String name,       Boolean isInAttributeValue, Boolean pushFakeEntityIfNullResolver, Int32  entityStartLinePos)\n    at System.Xml.XmlTextReaderImpl.ResolveEntity()\n    at System.Xml.XmlLoader.LoadEntityReferenceNode(Boolean direct)\n    at System.Xml.XmlLoader.LoadNode(Boolean skipOverWhitespace)\n    at System.Xml.XmlLoader.LoadDocSequence(XmlDocument parentDoc)\n    at System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace)\n    at System.Xml.XmlDocument.Load(XmlReader reader)\n    at System.Xml.XmlDocument.Load(String filename)\n    at ConsoleApplication9.Program.getrestype(String fname) in  c:\\Users\\pdeoliveira\\Documents\\Visual Studio  2013\\Projects\\BuildLoc\\BuildLoc\\Program.cs:line 1067\n</code></pre>\n\n<p>I tried using the declaration for nbsp like suggested in other posts: </p>\n\n<pre><code>&lt;!DOCTYPE doctypeName [\n   &lt;!ENTITY nbsp \"&amp;#160;\"&gt;\n]&gt;\n</code></pre>\n\n<p>That didn't work either. The interesting thing is that my file is only 10 or so lines long and it points to an issue on line 1960...??\nAny help would be appreciated. </p>\n"}, {"tags": ["c#", "excel", "sqlite", "office-interop"], "answers": [{"comments": [{"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1448484742, "post_id": 33925786, "comment_id": 55613259, "body": "You are correct, sir.  Thank you for saving me a huge headache the day before Thanksgiving!  This now takes all of a millisecond."}], "tags": [], "owner": {"reputation": 384, "user_id": 5601585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cc66cd843f23cd582c84493691ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "Maertin", "link": "https://stackoverflow.com/users/5601585/maertin"}, "is_accepted": true, "score": 1, "last_activity_date": 1448483034, "last_edit_date": 1495535231, "creation_date": 1448483034, "answer_id": 33925786, "question_id": 33925664, "link": "https://stackoverflow.com/questions/33925664/slow-nested-for-loop-to-read-excel-objects/33925786#33925786", "title": "Slow nested &#39;for&#39; loop to read Excel objects", "body": "<p><a href=\"https://stackoverflow.com/questions/17577184/importing-excel-into-a-datatable-quickly\">Importing Excel into a DataTable Quickly</a></p>\n\n<p>I believe above question should resolve your problem. Individual calls at .value2 is causing the problem. You could copy values into array or datatable and accordingly do manipulations to speed up things.</p>\n"}], "owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 33925786, "answer_count": 1, "score": 2, "last_activity_date": 1448487006, "creation_date": 1448482525, "last_edit_date": 1448487006, "question_id": 33925664, "link": "https://stackoverflow.com/questions/33925664/slow-nested-for-loop-to-read-excel-objects", "title": "Slow nested &#39;for&#39; loop to read Excel objects", "body": "<p>I am working on a form that will allow my users to choose a spreadsheet and copy its data to an SQLite database.  My SQLite query is transaction and happens in about one second but the portion of my code that is not running right is where it loops through the Excel range and creates my insert statements.  It is a nested for loop running over all the columns in the selected range and all the rows.  This whole process for a spreadsheet with 360 rows and 43 columns takes about four minutes to run.  I initially thought it was the SQLite insert so I converted it to a bulk insert.  Once I dug in a bit and stepped through the code I realized it is the 'for' loop causing this.  Here is my code:</p>\n\n<pre><code>int counter = 1;\n        string contents = null;\n        string bulkInsert = null;\n        Excel.Application xlApp = new Excel.Application();\n        Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(file);\n        Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];\n        Excel.Range xlRange = xlWorksheet.UsedRange;\n\n        int rowCount = xlRange.Rows.Count;\n        int colCount = xlRange.Columns.Count;\n\n        for (int i = 2; i &lt;= rowCount; i++)\n        {\n\n                for (int j = 1; j &lt;= colCount; j++)\n                {\n                    contents = contents + Convert.ToString(\"'\" + xlRange.Cells[i, j].Value2) + \"',\";\n\n\n                    //MessageBox.Show(xlRange.Cells[i, j].Value2.ToString());\n\n\n                }\n                contents = contents.Remove(contents.Length - 1);\n                bulkInsert = bulkInsert + \"INSERT INTO DeferralInput VALUES (\" + contents + \"); \";\n                contents = \"\";\n        }\n\n        bulkInsert = \"BEGIN TRANSACTION; \" + bulkInsert + \" COMMIT;\";\n        xlApp.Quit();\n        ExecuteQuery(bulkInsert);\n</code></pre>\n\n<p>If anyone has any thoughts on how to speed this up or if I did something wrong I am open to try anything.</p>\n"}, {"tags": ["c#", ".net", "multithreading", "async-await", "task"], "comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 1, "creation_date": 1448483366, "post_id": 33925654, "comment_id": 55612566, "body": "Why are you stuck calling a async method from a sync one. What is preventing you from caling/writing a synchronous version of <code>GetContentFromDbAsync()</code> or making the code calling <code>GetContentFromDbAsync()</code> async too? If you are using async because &quot;it is faster&quot; the way you are doing it will be worse performing than had you done it fully synchronous or had done it fully asynchronous, mixing both gives you the performance losses from both styles and you don&#39;t get any of the gains."}, {"owner": {"reputation": 11425, "user_id": 593461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af7355ae7b3eafbb2ed3ae42460ada1f?s=128&d=identicon&r=PG", "display_name": "Boas Enkler", "link": "https://stackoverflow.com/users/593461/boas-enkler"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448483413, "post_id": 33925654, "comment_id": 55612588, "body": "Because the method is used inside a razor view as HTML Extension."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448483953, "post_id": 33925654, "comment_id": 55612858, "body": "Ok, that explains why you can&#39;t make it async, why cant you call <code>GetContentFromDb()</code>?"}, {"owner": {"reputation": 11425, "user_id": 593461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af7355ae7b3eafbb2ed3ae42460ada1f?s=128&d=identicon&r=PG", "display_name": "Boas Enkler", "link": "https://stackoverflow.com/users/593461/boas-enkler"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448483992, "post_id": 33925654, "comment_id": 55612880, "body": "Because its mongodb and it only has a async interface"}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "edited": false, "score": 0, "creation_date": 1448502969, "post_id": 33925654, "comment_id": 55619622, "body": "@BoasEnkler: ASP.NET vNext supports <code>async</code> Razor. Until then, the best approach is to confine <code>async</code> to your controller&#39;s generation of viewmodels, and use HTML helpers only to translate from VMs to HTML (synchronously)."}], "answers": [{"comments": [{"owner": {"reputation": 11425, "user_id": 593461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af7355ae7b3eafbb2ed3ae42460ada1f?s=128&d=identicon&r=PG", "display_name": "Boas Enkler", "link": "https://stackoverflow.com/users/593461/boas-enkler"}, "edited": false, "score": 0, "creation_date": 1448482743, "post_id": 33925711, "comment_id": 55612269, "body": "ok just meets my expectation but was unsure as missing the hint there"}], "tags": [], "owner": {"reputation": 20198, "user_id": 326370, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9b4bb78735000e374a6f0887b58347e7?s=128&d=identicon&r=PG", "display_name": "Ilya Kogan", "link": "https://stackoverflow.com/users/326370/ilya-kogan"}, "is_accepted": false, "score": 2, "last_activity_date": 1448482713, "creation_date": 1448482713, "answer_id": 33925711, "question_id": 33925654, "link": "https://stackoverflow.com/questions/33925654/locking-behavior-task-waitany-vs-task-result/33925711#33925711", "title": "Locking Behavior Task.WaitAny vs. Task.Result", "body": "<p><code>Task.WaitAny</code> is blocking as well. Note that the MSDN comment on <code>Result</code> states that \"it is equivalent to calling the Wait method\". So calling <code>Result</code>, <code>Wait</code>, <code>WaitAny</code> or any other form of waiting blocks the current thread until the async method finishes execution.</p>\n"}], "owner": {"reputation": 11425, "user_id": 593461, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af7355ae7b3eafbb2ed3ae42460ada1f?s=128&d=identicon&r=PG", "display_name": "Boas Enkler", "link": "https://stackoverflow.com/users/593461/boas-enkler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1448482713, "creation_date": 1448482490, "question_id": 33925654, "link": "https://stackoverflow.com/questions/33925654/locking-behavior-task-waitany-vs-task-result", "title": "Locking Behavior Task.WaitAny vs. Task.Result", "body": "<p><strong>Given Scenario:</strong></p>\n\n<p>I'm struggling with some locking issues. Below is a simplified code which describes the the situation in the given code. I need to use a async method inside a non async Method which should return the resulting string of the <code>GetContentFromDbAsync()</code> method</p>\n\n<p><strong>Given Task:</strong></p>\n\n<pre><code>myTask = Task.Run(async () =&gt; await GetContentFromDbAsync(key));\n</code></pre>\n\n<p>Now My Question is there A difference in locking behavior when doing these variations ? Task.Result Does lock the thread is this also true for option 2 ? </p>\n\n<p><strong>Option 1:</strong></p>\n\n<pre><code>string result = myTask.ConfigureAwait(false)).Result;\n</code></pre>\n\n<p>In the MSDN I can read:</p>\n\n<blockquote>\n  <p>Accessing the property's get accessor blocks the calling thread until\n  the asynchronous operation is complete; it is equivalent to calling\n  the Wait method.</p>\n</blockquote>\n\n<p><strong>Option 2:</strong></p>\n\n<pre><code>string result ;\nmyTask.ContinueWith( (t) =&gt; { result = t; },TaskContinuationOptions.OnlyOnRanToCompletion);\nTask.WaitAny(myTask)\n</code></pre>\n\n<p>For Task.WaitAny no such hint is written in the MSDN, are they just missing it or does it have another locking behavior, and why?</p>\n\n<p>So would <code>Task.WaitAny</code> have a better locking behavior regarding at pot. deadlocks?</p>\n"}, {"tags": ["c#", "xml", "imdb"], "comments": [{"owner": {"reputation": 888, "user_id": 1122242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c94e800354854bafd803f7ff56239e0?s=128&d=identicon&r=PG", "display_name": "moveaway00", "link": "https://stackoverflow.com/users/1122242/moveaway00"}, "edited": false, "score": 0, "creation_date": 1448482528, "post_id": 33925637, "comment_id": 55612160, "body": "Please include the exact errors you see"}, {"owner": {"reputation": 51, "user_id": 3572883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000473038336/picture?type=large", "display_name": "Louni", "link": "https://stackoverflow.com/users/3572883/louni"}, "reply_to_user": {"reputation": 888, "user_id": 1122242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c94e800354854bafd803f7ff56239e0?s=128&d=identicon&r=PG", "display_name": "moveaway00", "link": "https://stackoverflow.com/users/1122242/moveaway00"}, "edited": false, "score": 0, "creation_date": 1448482735, "post_id": 33925637, "comment_id": 55612266, "body": "Sorry I forgot, I added it"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3572883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000473038336/picture?type=large", "display_name": "Louni", "link": "https://stackoverflow.com/users/3572883/louni"}, "edited": false, "score": 0, "creation_date": 1448483418, "post_id": 33925791, "comment_id": 55612593, "body": "An unhandled exception of type &#39;System.Xml.XmlException&#39; occurred in System.Xml.dll  Additional information: The &#39; &#39; character, hexadecimal value 0x20, cannot be included in a name. It gives me that error when i use XDocument.Load"}, {"owner": {"reputation": 888, "user_id": 1122242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c94e800354854bafd803f7ff56239e0?s=128&d=identicon&r=PG", "display_name": "moveaway00", "link": "https://stackoverflow.com/users/1122242/moveaway00"}, "reply_to_user": {"reputation": 51, "user_id": 3572883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000473038336/picture?type=large", "display_name": "Louni", "link": "https://stackoverflow.com/users/3572883/louni"}, "edited": false, "score": 0, "creation_date": 1448483571, "post_id": 33925791, "comment_id": 55612663, "body": "Apparently XDocument doesn&#39;t like spaces in the file name. I&#39;ll edit the answer to use XmlDocument"}], "tags": [], "owner": {"reputation": 888, "user_id": 1122242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c94e800354854bafd803f7ff56239e0?s=128&d=identicon&r=PG", "display_name": "moveaway00", "link": "https://stackoverflow.com/users/1122242/moveaway00"}, "is_accepted": false, "score": 0, "last_activity_date": 1448483738, "last_edit_date": 1448483738, "creation_date": 1448483076, "answer_id": 33925791, "question_id": 33925637, "link": "https://stackoverflow.com/questions/33925637/read-specific-place-from-xml-c/33925791#33925791", "title": "Read specific place from XML c#", "body": "<p>Both <code>XDocument.Parse</code> and <code>XmlDocument.LoadXml</code> expect their parameter to be the string which contains the xml, not a string containing a file name. You want to use <code>XmlDocument.Load</code>, which accepts a filename:</p>\n\n<pre><code>XmlDocument xml = new XmlDocument();\nxml.Load(\"game of thrones.xml\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8827, "user_id": 2563833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/ns0R0.png?s=128&g=1", "display_name": "Arghya C", "link": "https://stackoverflow.com/users/2563833/arghya-c"}, "is_accepted": true, "score": 2, "last_activity_date": 1448483490, "last_edit_date": 1448483490, "creation_date": 1448483189, "answer_id": 33925826, "question_id": 33925637, "link": "https://stackoverflow.com/questions/33925637/read-specific-place-from-xml-c/33925826#33925826", "title": "Read specific place from XML c#", "body": "<p>You are selecting the <code>movie</code> node incorrectly.</p>\n\n<pre><code>var xmlString = File.ReadAllText(@\"C:\\YourDirectory\\YourFile.xml\"); //or from service\n\nvar xDoc = XDocument.Parse(xmlString);\nvar rating = xDoc.Descendants(\"movie\").First().Attribute(\"imdbRating\").Value;\n</code></pre>\n\n<p>The node you need to select is <em><code>movie</code></em>, not <em><code>movie title!</code></em>  </p>\n\n<p>But, it should not throw error at <code>XDocument.Parse</code>. Check your <code>XML</code> once again, I tried with your sample <code>XML</code> and it worked just fine. Make sure there's no empty space at beginning of file.</p>\n"}], "owner": {"reputation": 51, "user_id": 3572883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100000473038336/picture?type=large", "display_name": "Louni", "link": "https://stackoverflow.com/users/3572883/louni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 33925826, "answer_count": 2, "score": 2, "last_activity_date": 1448487392, "creation_date": 1448482434, "last_edit_date": 1592644375, "question_id": 33925637, "link": "https://stackoverflow.com/questions/33925637/read-specific-place-from-xml-c", "title": "Read specific place from XML c#", "body": "<p>So I have an XML file and it gets information from imdb which is like that,</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;root response=&quot;True&quot;&gt;\n    &lt;movie title=&quot;Game of Thrones&quot; year=&quot;2011\u2013&quot; rated=&quot;TV-MA&quot; released=&quot;17 Apr 2011&quot; runtime=&quot;56 min&quot; genre=&quot;Adventure, Drama, Fantasy&quot; director=&quot;N/A&quot; writer=&quot;David Benioff, D.B. Weiss&quot; actors=&quot;Peter Dinklage, Lena Headey, Emilia Clarke, Kit Harington&quot; plot=&quot;Several noble families fight for control of the mythical land of Westeros.&quot; language=&quot;English&quot; country=&quot;USA&quot; awards=&quot;Won 1 Golden Globe. Another 133 wins &amp;amp; 248 nominations.&quot; poster=&quot;http://ia.media-imdb.com/images/M/MV5BNTgxOTI4NzY2M15BMl5BanBnXkFtZTgwMjY3MTM2NDE@._V1_SX300.jpg&quot; metascore=&quot;N/A&quot; imdbRating=&quot;9.5&quot; imdbVotes=&quot;868,876&quot; imdbID=&quot;tt0944947&quot; type=&quot;series&quot;/&gt;\n&lt;/root&gt;\n</code></pre>\n<p>I wanna get a specific attribute which is <code>imdbRating</code> I've looked so many parse questions from this site and I still couldn't figured it out best solution I come up with is,</p>\n<pre><code>XDocument doc = XDocument.Parse(&quot;game of thrones.xml&quot;);\nstring var = doc.Descendants(&quot;movie title&quot;).Attributes(&quot;imdbRating&quot;).FirstOrDefault().Value;\nlabelImdb.Content = var;\n</code></pre>\n<p>but it does give me an error in this line</p>\n<pre><code>XDocument doc = XDocument.Parse(&quot;game of thrones.xml&quot;);\n</code></pre>\n<p>I also tried that and didn't work either</p>\n<pre><code>var xml = new XmlDocument();\nxml.LoadXml(&quot;game of thrones.xml&quot;);\nstring dummy = xml.DocumentElement.SelectSingleNode(&quot;imdbRating&quot;).InnerText;\nConsole.WriteLine(dummy);\nConsole.ReadLine();\n</code></pre>\n<p>second one gives an error in this line,</p>\n<pre><code>xml.LoadXml(&quot;game of thrones.xml&quot;);\n</code></pre>\n<p>error is</p>\n<blockquote>\n<p>An unhandled exception of type 'System.Xml.XmlException' occurred in System.Xml.dll</p>\n<p>Additional information: Data at the root level is invalid. Line 1, position 1.</p>\n</blockquote>\n"}, {"tags": ["c#", "asp.net", "html", "audio"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5604812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58cc08b8fed438fd5e00b4324041f538?s=128&d=identicon&r=PG&f=1", "display_name": "Alfredas", "link": "https://stackoverflow.com/users/5604812/alfredas"}, "edited": false, "score": 0, "creation_date": 1448646874, "post_id": 33929252, "comment_id": 55682615, "body": "Hello @Khazratbek thanks for reply. But I can&#39;t give &lt;audio&gt; dynamic ID because it&#39;s runat=&quot;server&quot;. That&#39;s my another question with full code <a href=\"http://stackoverflow.com/questions/33921848/html5-audio-autoplay-in-asp-net\" title=\"html5 audio autoplay in asp net\">stackoverflow.com/questions/33921848/&hellip;</a> Can you check and give me advice? Thanks.."}, {"owner": {"reputation": 7030, "user_id": 3536342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XGovx.png?s=128&g=1", "display_name": "DavidPostill", "link": "https://stackoverflow.com/users/3536342/davidpostill"}, "edited": false, "score": 2, "creation_date": 1449492857, "post_id": 33929252, "comment_id": 56015767, "body": "@Khazratbek Teamviewer sessions are not encouraged as such sessions are of no value to future visitors. If you want to start a discussion use chat. Note that this is being discussed on meta, see <a href=\"https://meta.stackoverflow.com/q/311869\">Should we allow people to offer to help through outside communications like Team Viewer?</a>"}, {"owner": {"reputation": 1618, "user_id": 5553294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xTGbH.jpg?s=128&g=1", "display_name": "Khazratbek", "link": "https://stackoverflow.com/users/5553294/khazratbek"}, "reply_to_user": {"reputation": 7030, "user_id": 3536342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XGovx.png?s=128&g=1", "display_name": "DavidPostill", "link": "https://stackoverflow.com/users/3536342/davidpostill"}, "edited": false, "score": 1, "creation_date": 1449541932, "post_id": 33929252, "comment_id": 56041707, "body": "@DavidPostill they create a question because of me =) =) =) Really funny. I just tried to help a user, as he tried himself and couldn&#39;t generate the code what he need. Next time I just will use chat for that and then upload final code as an answer."}], "tags": [], "owner": {"reputation": 1618, "user_id": 5553294, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xTGbH.jpg?s=128&g=1", "display_name": "Khazratbek", "link": "https://stackoverflow.com/users/5553294/khazratbek"}, "is_accepted": true, "score": 0, "last_activity_date": 1448501601, "creation_date": 1448501601, "answer_id": 33929252, "question_id": 33925549, "link": "https://stackoverflow.com/questions/33925549/how-to-access-html5-audio-play-event-in-codebehind-asp-net-with-c/33929252#33929252", "title": "How to access html5 audio play() event in codebehind asp.net with c#", "body": "<p>Naturally for another audio it will not work. It will work only for the first one. Because you gave the same ID to all of them. ID also should be dynamic, depending on your audio. For example, you may load it from database: <em>&lt;%#Eval(\"id\")%></em>.\nYou have some control, when clicking on that control audio have to be played. Would be better if you will do it on a link. For example,</p>\n\n<pre><code>&lt;a href=\"javascript:PlayAudio(&lt;%#Eval(\"id\") %&gt;)\"&gt;\n     &lt;img src=\"....\" width=\"..\" height=\"..\" /&gt;\n&lt;/a&gt;\n</code></pre>\n\n<p>And then write javascript function:</p>\n\n<pre><code>PlayAudio(id){\n   document.getElementById('audio'+id).setAttribute(\"autoplay\", \"autoplay\");\n}\n</code></pre>\n\n<p>Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3529650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ykqw9.jpg?s=128&g=1", "display_name": "FabioMut", "link": "https://stackoverflow.com/users/3529650/fabiomut"}, "is_accepted": false, "score": 0, "last_activity_date": 1571570241, "last_edit_date": 1571570241, "creation_date": 1571569052, "answer_id": 58472280, "question_id": 33925549, "link": "https://stackoverflow.com/questions/33925549/how-to-access-html5-audio-play-event-in-codebehind-asp-net-with-c/58472280#58472280", "title": "How to access html5 audio play() event in codebehind asp.net with c#", "body": "<p>Try this:</p>\n\n<p>in ASPX page:</p>\n\n<pre><code> &lt;asp:Label runat=\"server\" ID=\"lbl_sound\" Visible=\"false\"/&gt;\n</code></pre>\n\n<p>In code behind:</p>\n\n<pre><code>//clear label on load page , and set value in your event\npublic void goSound()\n{\n  lbl_sound.Text=\"&lt;div&gt;&lt;audio autoplay hidden&gt;&lt;source src='Sound/myaudio.wav' type='audio/mpeg'&gt;&lt;/audio&gt;&lt;/div&gt;\"\n}\n</code></pre>\n\n<p>it worked for me</p>\n"}], "owner": {"reputation": 3, "user_id": 5604812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58cc08b8fed438fd5e00b4324041f538?s=128&d=identicon&r=PG&f=1", "display_name": "Alfredas", "link": "https://stackoverflow.com/users/5604812/alfredas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1888, "favorite_count": 1, "accepted_answer_id": 33929252, "answer_count": 2, "score": 0, "last_activity_date": 1571570241, "creation_date": 1448482159, "question_id": 33925549, "link": "https://stackoverflow.com/questions/33925549/how-to-access-html5-audio-play-event-in-codebehind-asp-net-with-c", "title": "How to access html5 audio play() event in codebehind asp.net with c#", "body": "<p>I have an html5 audio tag in repeater. When user clicks button I want to fire play() event in codebehind. I can find audio and give src but can't fire play(). \nPs:Autoplay is working only one time for another audio not working.\nMy codes are:</p>\n\n<p><strong>aspx in repeater</strong></p>\n\n<pre><code>&lt;audio id=\"player2\" runat=\"server\" src=\"\" type=\"audio/mp3\" \ncontrols=\"controls\" preload=\"none\" autoplay=\"autoplay\"&gt;\n</code></pre>\n\n<p></p>\n\n<p><strong>Codebehind</strong></p>\n\n<pre><code>        HtmlAudio audio = (HtmlAudio)e.Item.FindControl(\"player2\");\n         switch (e.CommandName)\n        {\n            case \"play\":\n\n                audio.Src = dt.Rows[0][\"AudioPath\"].ToString();                    \n                **audio play() ?**                   \n                break;             \n\n        }\n</code></pre>\n"}, {"tags": ["c#", "list"], "comments": [{"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1448482245, "post_id": 33925535, "comment_id": 55612004, "body": "are you sure about the spaces before and after <code>maxClubs</code>? also note that the search is case sensitive."}, {"owner": {"reputation": 20198, "user_id": 326370, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9b4bb78735000e374a6f0887b58347e7?s=128&d=identicon&r=PG", "display_name": "Ilya Kogan", "link": "https://stackoverflow.com/users/326370/ilya-kogan"}, "edited": false, "score": 0, "creation_date": 1448482259, "post_id": 33925535, "comment_id": 55612014, "body": "Then it probably doesn&#39;t contain the string. Have you tried to debug and see what&#39;s in the list?"}, {"owner": {"reputation": 36140, "user_id": 997973, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f5a40ddfdb04a2dc8ebecb80e3158685?s=128&d=identicon&r=PG", "display_name": "Wouter de Kort", "link": "https://stackoverflow.com/users/997973/wouter-de-kort"}, "edited": false, "score": 0, "creation_date": 1448482279, "post_id": 33925535, "comment_id": 55612021, "body": "are you sure about casing? Have you looked at using IndexOf? This would allow you to directly remove an item if there is a valid index."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5178825"}, "edited": false, "score": 0, "creation_date": 1448482286, "post_id": 33925535, "comment_id": 55612024, "body": "i tried without the spaces still the same even thought i dont think this should be a problem because the List has spaces anyway and yes i have tried to check"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5178825"}, "edited": false, "score": 0, "creation_date": 1448482407, "post_id": 33925596, "comment_id": 55612092, "body": "well it will get a lot harder if i want to check for the entire string is there a way to check for just &quot;max clubs &quot; ?"}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "edited": false, "score": 0, "creation_date": 1448482596, "post_id": 33925596, "comment_id": 55612192, "body": "You can iterate through the list with Linq. (see edit... though it looks like a lot of others have posted a similar solution that is probably a lot closer to what you&#39;re actually looking for)"}], "tags": [], "owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "is_accepted": false, "score": 1, "last_activity_date": 1448482423, "last_edit_date": 1448482423, "creation_date": 1448482314, "answer_id": 33925596, "question_id": 33925535, "link": "https://stackoverflow.com/questions/33925535/list-contains-doesnt-detects-a-string/33925596#33925596", "title": "List.Contains() doesn&#39;t detects a string", "body": "<p>Contains as it pertains to a List object looks for the entire string in a list of strings.</p>\n\n<p>You are looking for \"max clubs\" as a substring.  That is the \"Contains\" off the string object</p>\n\n<p>Example:</p>\n\n<pre><code>List&lt;string&gt; x = new List&lt;string&gt;(){\"Hello\", \"goodbye\"};\nbool y = x.Contains(\"good\"); // will be false\ny = x.Contains(\"goodbye\"); // will be true\n\ny = x[0].Contains(\"Hell\"); // will be true\n</code></pre>\n\n<p>You're probably looking for something like this:</p>\n\n<pre><code>List&lt;string&gt; stringsWithMaxClubs = Cvqt.Where(argString =&gt; argString.Contains(\" maxClubs \" + name)).ToList();\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5178825"}, "edited": false, "score": 0, "creation_date": 1448482489, "post_id": 33925607, "comment_id": 55612136, "body": "Thanks a lot mate ! I will test it out and if it works i will mark this as an answer :)"}], "tags": [], "owner": {"reputation": 24913, "user_id": 1300910, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/se92W.jpg?s=128&g=1", "display_name": "huysentruitw", "link": "https://stackoverflow.com/users/1300910/huysentruitw"}, "is_accepted": false, "score": 0, "last_activity_date": 1448482553, "last_edit_date": 1448482553, "creation_date": 1448482364, "answer_id": 33925607, "question_id": 33925535, "link": "https://stackoverflow.com/questions/33925535/list-contains-doesnt-detects-a-string/33925607#33925607", "title": "List.Contains() doesn&#39;t detects a string", "body": "<p>Your list contains strings in the form of <code>maxClubs + \" maxClubs \" + name</code> while you're searching for <code>\" maxClubs \" + name</code>. There will be no element in your list that exactly matches this (unless <code>maxClubs</code> is an empty string).</p>\n\n<p>You can use Linq <a href=\"https://msdn.microsoft.com/library/bb534972%28v=vs.100%29.aspx\" rel=\"nofollow\"><code>Any</code></a> for what you want:</p>\n\n<pre><code>if (Cvqt.Any(x =&gt; x.Contains(\" maxClubs \" + name)))\n{\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "is_accepted": true, "score": 1, "last_activity_date": 1448482915, "last_edit_date": 1448482915, "creation_date": 1448482566, "answer_id": 33925673, "question_id": 33925535, "link": "https://stackoverflow.com/questions/33925535/list-contains-doesnt-detects-a-string/33925673#33925673", "title": "List.Contains() doesn&#39;t detects a string", "body": "<p>When you do <code>Contains</code> on a <code>List&lt;string&gt;</code> it only checks if the list contains a string that is a <strong><em>exact match</em></strong> to what you are passing in, it will not do a partial match.</p>\n\n<p>If you want partial matches you need to do something more complicated like </p>\n\n<pre><code>if (Cvqt.Any(x=&gt;x.Contains(\" maxClubs \" + name)))\n{\n    Cvqt.Remove(maxClubs.ToString() + \" maxClub \" + name);\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var item = Cvqt.FirstOrDefault(x =&gt; x.Contains(\" maxClubs \" + name));\nif (item != null)\n{\n    Cvqt.Remove(item);\n}\n</code></pre>\n\n<p>if you want to remove the found item instead of the specific string using <code>maxClubs</code>.</p>\n\n<p>What those two methods do is call <a href=\"https://msdn.microsoft.com/en-us/library/dy85x1sa(v=vs.110).aspx\" rel=\"nofollow\"><code>String.Contains</code></a> on each item instead of <a href=\"https://msdn.microsoft.com/en-us/library/bhkz42b3(v=vs.110).aspx\" rel=\"nofollow\"><code>List&lt;T&gt;.Contains</code></a> on the entire list, which is what you where doing. Doing a <code>List&lt;T&gt;.Contains(T t1)</code> is the same as doing a <code>Object.Equals(T t1, T listItem)</code> on each item in the list.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5178825"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2318, "favorite_count": 0, "accepted_answer_id": 33925673, "answer_count": 3, "score": 1, "last_activity_date": 1448482915, "creation_date": 1448482125, "last_edit_date": 1448482759, "question_id": 33925535, "link": "https://stackoverflow.com/questions/33925535/list-contains-doesnt-detects-a-string", "title": "List.Contains() doesn&#39;t detects a string", "body": "<p>As the title says my list \"Cvqt\" contains different strings for example <code>\"1 maxHearts Player\"</code> and I'm trying to check if it contains <code>\" maxHearths \" + name</code> (which is already set whenever something enter's the method as Player) and i have tried to but break point there and it show's Player so this is not problem but it will simply jump over the if statement's.. Here's the code</p>\n\n<pre><code>if (Cvqt.Contains(\" maxClubs \" + name))\n{\n    Cvqt.Remove(maxClubs.ToString() + \" maxClub \" + name);\n}\nelse \n{\n    maxClubs = j;\n    Cvqt.Add(maxClubs + \" maxClubs \" + name); \n}                           \nif (Cvqt.Contains(\" clubs \" + name))\n{\n    Cvqt.Remove(clubs.ToString() + \" clubs \" + name);\n    clubs--;\n}\nelse \n{\n    Cvqt.Add(clubs + \" clubs \" + name); \n}\n</code></pre>\n"}, {"tags": ["c#", "httpwebrequest", "console.writeline", "system.net.httpwebrequest"], "comments": [{"owner": {"reputation": 415, "user_id": 1570093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01f035b57df122d980a84e826f64bbd3?s=128&d=identicon&r=PG", "display_name": "Tim Freese", "link": "https://stackoverflow.com/users/1570093/tim-freese"}, "edited": false, "score": 0, "creation_date": 1448482485, "post_id": 33925511, "comment_id": 55612133, "body": "Do you want the label to be updated after button1 is clicked?"}, {"owner": {"reputation": 71, "user_id": 4346726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/O3M2X.jpg?s=128&g=1", "display_name": "Conall Curran", "link": "https://stackoverflow.com/users/4346726/conall-curran"}, "reply_to_user": {"reputation": 415, "user_id": 1570093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01f035b57df122d980a84e826f64bbd3?s=128&d=identicon&r=PG", "display_name": "Tim Freese", "link": "https://stackoverflow.com/users/1570093/tim-freese"}, "edited": false, "score": 0, "creation_date": 1448482837, "post_id": 33925511, "comment_id": 55612306, "body": "@TimFreese yes but if its possible to print text beside the label that would be better?"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4346726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/O3M2X.jpg?s=128&g=1", "display_name": "Conall Curran", "link": "https://stackoverflow.com/users/4346726/conall-curran"}, "edited": false, "score": 0, "creation_date": 1448483504, "post_id": 33925778, "comment_id": 55612633, "body": "Great stuff Tim thanks, its nipped that wee thing on the bud! the program is having trouble creating a web request based on the user input do you think that&#39;s down to me not parse the &quot;fileURI&quot;?"}], "tags": [], "owner": {"reputation": 415, "user_id": 1570093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01f035b57df122d980a84e826f64bbd3?s=128&d=identicon&r=PG", "display_name": "Tim Freese", "link": "https://stackoverflow.com/users/1570093/tim-freese"}, "is_accepted": false, "score": 1, "last_activity_date": 1448483013, "creation_date": 1448483013, "answer_id": 33925778, "question_id": 33925511, "link": "https://stackoverflow.com/questions/33925511/writing-to-label/33925778#33925778", "title": "Writing to Label", "body": "<p>All you really are missing is setting the label text at the end.</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    Uri fileURI = new Uri(URLbox.Text);\n    WebRequest request = WebRequest.Create(fileURI);\n    HttpWebResponse response = null;\n\n    request.Method = \"HEAD\";\n    bool exists = false;\n\n    try\n    {\n        response = (HttpWebResponse)request.GetResponse();\n        exists = response.StatusCode == HttpStatusCode.OK;\n\n    }\n    catch\n    {\n        exists = false;\n    }\n    finally\n    {\n\n        if (response != null)\n\n            response.Close();\n    }\n\n    if(exists)\n    {\n        label1.Text = \"Active\";\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 4346726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/O3M2X.jpg?s=128&g=1", "display_name": "Conall Curran", "link": "https://stackoverflow.com/users/4346726/conall-curran"}, "is_accepted": false, "score": 0, "last_activity_date": 1450464197, "creation_date": 1450464197, "answer_id": 34362055, "question_id": 33925511, "link": "https://stackoverflow.com/questions/33925511/writing-to-label/34362055#34362055", "title": "Writing to Label", "body": "<p>Following code works! </p>\n\n<pre><code> public URLTester1()\n    {\n        InitializeComponent();\n    }\n\n\n    //Web Page Active?\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        Uri fileURI = new Uri(URLbox1.Text);\n\n        //tests http response \n        WebRequest request = WebRequest.Create(fileURI);\n        HttpWebResponse response = null;\n\n        request.Method = \"HEAD\";\n\n\n        bool exists = false;\n\n        try\n        {\n            response = (HttpWebResponse)request.GetResponse();\n            exists = response.StatusCode == HttpStatusCode.OK;\n\n        }\n        catch\n        {\n            exists = false;\n        }\n        finally\n        {\n            // close your response.\n            if (response != null)\n\n                response.Close();\n        }\n\n        if (exists)\n        {\n            label1.Text = \"Active\";\n        }\n        else\n        {\n            label1.Text = \"Inactive\";\n        }\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4346726, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/O3M2X.jpg?s=128&g=1", "display_name": "Conall Curran", "link": "https://stackoverflow.com/users/4346726/conall-curran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1450464197, "creation_date": 1448482038, "question_id": 33925511, "link": "https://stackoverflow.com/questions/33925511/writing-to-label", "title": "Writing to Label", "body": "<p>I'm currently trying to develop a web crawler in C# that will test the page exists, which is specified by the user. I'm hoping that once the crawler starts it will write the pages status to a windows form (which includes labels). But I'm having trouble getting the program to actually write to the form? </p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n    {\n        Uri fileURI = new Uri(URLbox.Text);\n        WebRequest request = WebRequest.Create(fileURI);\n        HttpWebResponse response = null;\n\n        request.Method = \"HEAD\";\n        bool exists = false;\n\n        try\n        {\n            response = (HttpWebResponse)request.GetResponse();\n            exists = response.StatusCode == HttpStatusCode.OK;\n\n        }\n        catch\n        {\n            exists = false;\n        }\n        finally\n        {\n\n            if (response != null)\n\n                response.Close();\n        }\n\n    }\n    private void label1_Click(object sender, EventArgs e)\n    {\n        Console.Write.ToString = (\"Active\");\n    }\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c#", "xml", "xpath"], "comments": [{"owner": {"reputation": 888, "user_id": 1122242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c94e800354854bafd803f7ff56239e0?s=128&d=identicon&r=PG", "display_name": "moveaway00", "link": "https://stackoverflow.com/users/1122242/moveaway00"}, "edited": false, "score": 1, "creation_date": 1448482781, "post_id": 33925504, "comment_id": 55612290, "body": "Please specify what you mean by &quot;without success&quot;. Did you get any error messages? If so, please post them here. If there were no errors, how exactly does the result differ from your expectations?"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448485194, "post_id": 33925504, "comment_id": 55613450, "body": "I don&#39;t understand why you expect the given XPath expression to identify the node with the minimum value; doesn&#39;t it only compare the current node to the adjacent ones, and not all of them? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that reliably reproduces your problem, along with a precise explanation of what that code does and how that&#39;s different from what you want."}, {"owner": {"reputation": 39, "user_id": 5605777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a5e90e23544367f5d3b6661be552fc?s=128&d=identicon&r=PG&f=1", "display_name": "student", "link": "https://stackoverflow.com/users/5605777/student"}, "reply_to_user": {"reputation": 888, "user_id": 1122242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c94e800354854bafd803f7ff56239e0?s=128&d=identicon&r=PG", "display_name": "moveaway00", "link": "https://stackoverflow.com/users/1122242/moveaway00"}, "edited": false, "score": 0, "creation_date": 1449021540, "post_id": 33925504, "comment_id": 55822518, "body": "@moveaway00 No error messages... but also no results.. it didn&#39;t do anything..."}, {"owner": {"reputation": 39, "user_id": 5605777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a5e90e23544367f5d3b6661be552fc?s=128&d=identicon&r=PG&f=1", "display_name": "student", "link": "https://stackoverflow.com/users/5605777/student"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1449021664, "post_id": 33925504, "comment_id": 55822565, "body": "@PeterDuniho XPath seemed a more elegant solution... With just one expression I would get what I wanted. I was trying to reproduce this exercise: <a href=\"https://rmanimaran.wordpress.com/2011/03/20/xml-find-max-and-min-value-in-a-attribute-using-xpath-and-linq/\" rel=\"nofollow noreferrer\">rmanimaran.wordpress.com/2011/03/20/&hellip;</a>"}, {"owner": {"reputation": 39, "user_id": 5605777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a5e90e23544367f5d3b6661be552fc?s=128&d=identicon&r=PG&f=1", "display_name": "student", "link": "https://stackoverflow.com/users/5605777/student"}, "edited": false, "score": 0, "creation_date": 1449021712, "post_id": 33925504, "comment_id": 55822581, "body": "Sorry for not replying sooner and thank you for all your answers. I had exams..."}], "answers": [{"tags": [], "owner": {"reputation": 2612, "user_id": 1655605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368e9d44d189f8d458fa466f34f8212a?s=128&d=identicon&r=PG", "display_name": "TYY", "link": "https://stackoverflow.com/users/1655605/tyy"}, "is_accepted": false, "score": 0, "last_activity_date": 1448484626, "creation_date": 1448484626, "answer_id": 33926181, "question_id": 33925504, "link": "https://stackoverflow.com/questions/33925504/how-to-find-min-and-max-value-of-xml-element/33926181#33926181", "title": "How to find Min and Max value of xml element", "body": "<p>You could XElement and then getall the expense elements. To get just the interger value, you would need to remove the currency symbol as shown below.</p>\n\n<pre><code>var parsedXml = XElement.Parse(xmlToParse);\nvar expenses = (from e1 in parsedXml.Elements(\"expense\")\n                select int.Parse(Regex.Replace(e1.Value,\"[^0-9]\", string.Empty))).ToList();\nvar minValue = expenses.Min();\nvar maxValue =  expenses.Max();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 5605777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a5e90e23544367f5d3b6661be552fc?s=128&d=identicon&r=PG&f=1", "display_name": "student", "link": "https://stackoverflow.com/users/5605777/student"}, "edited": false, "score": 0, "creation_date": 1449022324, "post_id": 33926184, "comment_id": 55822756, "body": "I was really looking for an XPath solution out of curiosity. In my idea XPath would have a simpler code. What you think of this: <a href=\"https://rmanimaran.wordpress.com/2011/03/20/xml-find-max-and-min-value-in-a-attribute-using-xpath-and-linq/\" rel=\"nofollow noreferrer\">rmanimaran.wordpress.com/2011/03/20/&hellip;</a>"}, {"owner": {"reputation": 15339, "user_id": 642579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jJpEP.png?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/642579/markus"}, "reply_to_user": {"reputation": 39, "user_id": 5605777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a5e90e23544367f5d3b6661be552fc?s=128&d=identicon&r=PG&f=1", "display_name": "student", "link": "https://stackoverflow.com/users/5605777/student"}, "edited": false, "score": 0, "creation_date": 1449041685, "post_id": 33926184, "comment_id": 55829384, "body": "@student of course this looks very simple. However, the complexity in your sample is related to the structure of the XML. It would be much easier, if there was a parent node that groups <code>month</code> and <code>expense</code>. The complexity is related to the flat structure of these elements. So also an XPath expression would be very complex - and I doubt that it is easier to unterstand and to maintain than the Linq to XML query."}], "tags": [], "owner": {"reputation": 15339, "user_id": 642579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jJpEP.png?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/642579/markus"}, "is_accepted": false, "score": 0, "last_activity_date": 1448485855, "last_edit_date": 1448485855, "creation_date": 1448484634, "answer_id": 33926184, "question_id": 33925504, "link": "https://stackoverflow.com/questions/33925504/how-to-find-min-and-max-value-of-xml-element/33926184#33926184", "title": "How to find Min and Max value of xml element", "body": "<p>Instead of using XPath, I suggest to use <a href=\"https://msdn.microsoft.com/en-us/library/bb387098.aspx\" rel=\"nofollow\">Linq to XML</a>. You can then parse the elements into memory and query them a lot better. You can use the following sample to get the min and the max values: </p>\n\n<pre><code>void Main()\n{\n    const string content = \"&lt;?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?&gt;\" + \n                                \"&lt;shop&gt;\" + \n                                   \"&lt;month&gt;Jan&lt;/month&gt;\" + \n                                   \"&lt;expense&gt;2520,50\u20ac&lt;/expense&gt;\" + \n                                   \"&lt;month&gt;Feb&lt;/month&gt;\" + \n                                   \"&lt;expense&gt;2900,00\u20ac&lt;/expense&gt;\" + \n                                   \"&lt;month&gt;Mar&lt;/month&gt;\" + \n                                   \"&lt;expense&gt;1000,00\u20ac&lt;/expense&gt;\" + \n                                   \"&lt;month&gt;Apr&lt;/month&gt;\" + \n                                   \"&lt;expense&gt;1520,00\u20ac&lt;/expense&gt;\" + \n                                   \"&lt;month&gt;May&lt;/month&gt;\" + \n                                   \"&lt;expense&gt;500,00\u20ac&lt;/expense&gt;\" + \n                                   \"&lt;month&gt;Jun&lt;/month&gt;\" + \n                                   \"&lt;expense&gt;1250,50\u20ac&lt;/expense&gt;\" + \n                                   \"&lt;month&gt;Jul&lt;/month&gt;\" + \n                                   \"&lt;expense&gt;300,00\u20ac&lt;/expense&gt;\" + \n                                   \"&lt;month&gt;Aug&lt;/month&gt;\" + \n                                   \"&lt;expense&gt;0,00\u20ac&lt;/expense&gt;\" + \n                                 \"&lt;/shop&gt;\";\n    var doc = XDocument.Parse(content);\n    var elements = doc.Element(\"shop\")  // Element shop\n                        .Elements()     // All elements under shop\n                        .Select((x, i) =&gt; new { Index = i, Element = x }) // Get index for grouping\n                        .GroupBy(x =&gt; x.Index / 2)  // Group by index so that month and expense element are contained in a group\n                        .Select(x =&gt; new { Month = x.ElementAt(0).Element.Value, Expense = decimal.Parse(x.ElementAt(1).Element.Value, System.Globalization.NumberStyles.Any) })    // Parse into anonymous type\n                        .OrderBy(x =&gt; x.Expense)    // Order by expense\n                        .ToArray(); // Execute query\n    var min = elements.FirstOrDefault();\n    var max = elements.LastOrDefault();\n}\n</code></pre>\n\n<p>At the beginning, you load the XML into an XDocument. In this sample, I parse the string, but you can also use the <code>Load</code> method to read a file. </p>\n\n<p>The query is a bit complicated; first, you get all the elements under <code>shop</code>. You then select them into an anonymous type that also contains the index of the element. The index is used to build groups that contain month and expense. </p>\n\n<p>Then, a new anonymous type is created that contains both month and expense (as a decimal) in a single object. Please note that parsing the value of expense into a decimal is culture dependent. In the sample, I do not specify a culture, but this might be required in a real world scenario. The resulting list is sorted by <code>Expense</code> in ascending order. </p>\n\n<p>By using <code>FirstOrDefault</code> and <code>LastOrDefault</code> respectively, you can retrieve the min and max values. </p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 5605777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a5e90e23544367f5d3b6661be552fc?s=128&d=identicon&r=PG&f=1", "display_name": "student", "link": "https://stackoverflow.com/users/5605777/student"}, "edited": false, "score": 0, "creation_date": 1449022139, "post_id": 33926300, "comment_id": 55822702, "body": "I had written a solution but yours is better than mine :) I will try it."}, {"owner": {"reputation": 8827, "user_id": 2563833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/ns0R0.png?s=128&g=1", "display_name": "Arghya C", "link": "https://stackoverflow.com/users/2563833/arghya-c"}, "reply_to_user": {"reputation": 39, "user_id": 5605777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a5e90e23544367f5d3b6661be552fc?s=128&d=identicon&r=PG&f=1", "display_name": "student", "link": "https://stackoverflow.com/users/5605777/student"}, "edited": false, "score": 0, "creation_date": 1449029201, "post_id": 33926300, "comment_id": 55824761, "body": "@student I remember I had tested this code with your xml and it worked fine. Try it and see if it serves your purpose :)"}], "tags": [], "owner": {"reputation": 8827, "user_id": 2563833, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/ns0R0.png?s=128&g=1", "display_name": "Arghya C", "link": "https://stackoverflow.com/users/2563833/arghya-c"}, "is_accepted": false, "score": 2, "last_activity_date": 1448485150, "creation_date": 1448485150, "answer_id": 33926300, "question_id": 33925504, "link": "https://stackoverflow.com/questions/33925504/how-to-find-min-and-max-value-of-xml-element/33926300#33926300", "title": "How to find Min and Max value of xml element", "body": "<p>You need to read the xml, then find the Min/Max of the expenses and the corresponding month.</p>\n\n<p>Here is one <code>O(n)</code> way to find the Month with Min/Max expense.</p>\n\n<pre><code>var xmlString = File.ReadAllText(@\"C:\\YourDirectory\\YourFile.xml\");\n\nvar xDoc = XDocument.Parse(xmlString);\nvar months = xDoc.Descendants(\"month\");\nvar expenses = xDoc.Descendants(\"expense\");\n\nvar cultureInfo = new CultureInfo(\"fr-FR\");\n\ndecimal maxExp = decimal.MinValue;\ndecimal minExp = decimal.MaxValue;\nstring maxExpMonth = string.Empty; //=&gt; \"Feb\"\nstring minExpMonth = string.Empty; //=&gt; \"Aug\"\nfor (int i = 0; i &lt; expenses.Count(); i++)\n{\n    var exp = decimal.Parse(expenses.ElementAt(i).Value, NumberStyles.Currency, cultureInfo);\n    if (exp &gt; maxExp)\n    {\n        maxExp = exp;\n        maxExpMonth = months.ElementAt(i).Value;\n    }\n    if (exp &lt; minExp)\n    {\n        minExp = exp;\n        minExpMonth = months.ElementAt(i).Value;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5605777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a5e90e23544367f5d3b6661be552fc?s=128&d=identicon&r=PG&f=1", "display_name": "student", "link": "https://stackoverflow.com/users/5605777/student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2478, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1449021420, "creation_date": 1448482004, "last_edit_date": 1449021420, "question_id": 33925504, "link": "https://stackoverflow.com/questions/33925504/how-to-find-min-and-max-value-of-xml-element", "title": "How to find Min and Max value of xml element", "body": "<p>Can anyone help me with this problem?</p>\n\n<p>I have to find the Min and Max months according to expenses values:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;shop&gt;\n   &lt;month&gt;Jan&lt;/month&gt;\n   &lt;expense&gt;2520,50\u20ac&lt;/expense&gt;\n   &lt;month&gt;Feb&lt;/month&gt;\n   &lt;expense&gt;2900,00\u20ac&lt;/expense&gt;\n   &lt;month&gt;Mar&lt;/month&gt;\n   &lt;expense&gt;1000,00\u20ac&lt;/expense&gt;\n   &lt;month&gt;Apr&lt;/month&gt;\n   &lt;expense&gt;1520,00\u20ac&lt;/expense&gt;\n   &lt;month&gt;May&lt;/month&gt;\n   &lt;expense&gt;500,00\u20ac&lt;/expense&gt;\n   &lt;month&gt;Jun&lt;/month&gt;\n   &lt;expense&gt;1250,50\u20ac&lt;/expense&gt;\n   &lt;month&gt;Jul&lt;/month&gt;\n   &lt;expense&gt;300,00\u20ac&lt;/expense&gt;\n   &lt;month&gt;Aug&lt;/month&gt;\n   &lt;expense&gt;0,00\u20ac&lt;/expense&gt;\n &lt;/shop&gt;\n</code></pre>\n\n<p>I already tried with XPath but without success...</p>\n\n<pre><code>XmlDocument doc = new XmlDocument();\ndoc.Load(\"XML/despesas.xml\");\n\nXmlNode node = doc.SelectSingleNode(\"//shop/expense[not(. &lt;=../preceding-sibling::expense) and not(. &lt;=../following-sibling::expense)]\");\nint min = Convert.ToInt32(node.Value);\n</code></pre>\n"}, {"tags": ["c#", "visual-studio-2012", "foreach", ".net-4.5", "concurrentdictionary"], "comments": [{"owner": {"reputation": 48582, "user_id": 383710, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a139d0f3bf5fbce8838eee134b28c969?s=128&d=identicon&r=PG", "display_name": "DaveShaw", "link": "https://stackoverflow.com/users/383710/daveshaw"}, "edited": false, "score": 1, "creation_date": 1448482117, "post_id": 33925483, "comment_id": 55611935, "body": "I would guess that ChattingServer.ConnectedClient is not public."}], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 5448245, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a53eeffb6e1cf094037311a48a0acc83?s=128&d=identicon&r=PG&f=1", "display_name": "Kieran Ojakangas", "link": "https://stackoverflow.com/users/5448245/kieran-ojakangas"}, "edited": false, "score": 0, "creation_date": 1448483146, "post_id": 33925553, "comment_id": 55612453, "body": "<i>hands on face</i> You guys are absolutely right, I missed that detail. Works fine now. Thanks."}], "tags": [], "owner": {"reputation": 65023, "user_id": 1828879, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5e67a6d7eb5968245e751e05ba1c936b?s=128&d=identicon&r=PG", "display_name": "Timothy Shields", "link": "https://stackoverflow.com/users/1828879/timothy-shields"}, "is_accepted": true, "score": 5, "last_activity_date": 1448482507, "last_edit_date": 1448482507, "creation_date": 1448482173, "answer_id": 33925553, "question_id": 33925483, "link": "https://stackoverflow.com/questions/33925483/c-concurrentdictionary-usage-inconsistent-accessibility/33925553#33925553", "title": "C# ConcurrentDictionary usage inconsistent accessibility?", "body": "<p><code>ChattingService</code> is public, and its <code>_connectedClients</code> member is public. But the type of <code>_connectedClients</code> involves <code>ChattingServer.ConnectedClient</code>, which is not public.</p>\n\n<p>Imagine you were to reference your <code>ChattingServer</code> assembly from another project and then write code like this:</p>\n\n<pre><code>using ChattingServer;\n...\nConcurrentDictionary&lt;string, ConnectedClient&gt; dict = myChattingService._connectedClients;\n</code></pre>\n\n<p>The accessibility of your <code>ChattingService</code> type and its <code>_connectedClients</code> field allow you to access that field, but the type <code>ConnectedClient</code> isn't public, so you have access to a field whose type should be hidden, according to the accessibility modifiers you have placed on the types and members in the <code>ChattingServer</code> assembly. This is why you are getting the build error: the accessibility modifiers on your types and members in the <code>ChattingServer</code> assembly contradict each other.</p>\n\n<p>If you, for example, make <code>ChattingServer.ConnectedClient</code> public, or make <code>_connectedClients</code> private, that will fix the problem.</p>\n"}], "owner": {"reputation": 379, "user_id": 5448245, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a53eeffb6e1cf094037311a48a0acc83?s=128&d=identicon&r=PG&f=1", "display_name": "Kieran Ojakangas", "link": "https://stackoverflow.com/users/5448245/kieran-ojakangas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 33925553, "answer_count": 1, "score": 3, "last_activity_date": 1448482507, "creation_date": 1448481940, "question_id": 33925483, "link": "https://stackoverflow.com/questions/33925483/c-concurrentdictionary-usage-inconsistent-accessibility", "title": "C# ConcurrentDictionary usage inconsistent accessibility?", "body": "<p>I'm following along with a tutorial to build a chat client and server, right now I've got the following error:</p>\n\n<pre><code>Inconsistent accessibility: field type 'System.Collections.Concurrent.ConcurrentDictionary&lt;string,ChattingServer.ConnectedClient&gt;' is less accessible than field 'ChattingServer.ChattingService._connectedClients' c:\\Users\\KOEMXE\\Documents\\Visual Studio 2012\\Projects\\ChatApplication\\ChattingServer\\ChattingService.cs 17  62  ChattingServer\n</code></pre>\n\n<p>Here's the class file where the relevant issue lies (ChattingService.cs):</p>\n\n<pre><code>using ChattingInterfaces;\nusing System;\nusing System.Collections.Concurrent;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Runtime.Serialization;\nusing System.ServiceModel;\nusing System.Text;\n\nnamespace ChattingServer\n{\n    [ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.Single)]\n    public class ChattingService : IChattingService\n    {\n        //private ConnectedClient _connectedClients;\n\n        public ConcurrentDictionary&lt;string, ConnectedClient&gt; _connectedClients = new ConcurrentDictionary&lt;string, ConnectedClient&gt;();\n\n        public int Login(string userName)\n        {\n            //is anyone else logged in with my name?\n            foreach (var client in _connectedClients)\n            {\n                if(client.Key.ToLower() == userName.ToLower())\n                {\n                    //if yes\n                    return 1;\n                }\n            }\n\n            var establishedUserConnection = OperationContext.Current.GetCallbackChannel&lt;IClient&gt;();\n\n            ConnectedClient newClient = new ConnectedClient();\n            newClient.connection = establishedUserConnection;\n            newClient.UserName = userName;\n\n\n\n            _connectedClients.TryAdd(userName, newClient);\n\n            return 0;\n        }\n\n\n        public void SendMessageToALL(string message, string userName)\n        {\n            foreach (var client in _connectedClients)\n            {\n                if (client.Key.ToLower() != userName.ToLower())\n                {\n                    client.Value.connection.GetMessage(message, userName);\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Do I need to declare the type in the ConcurrentDictionary object elsewhere? What's the issue? Thanks!</p>\n"}, {"tags": ["c#", "ms-word", "ms-office"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 1, "creation_date": 1448482266, "post_id": 33925442, "comment_id": 55612016, "body": "There are so many examples online on how to create a word doc using InterOp as well as HttpContext I do this all the time in my web applications currently also look into using <code>OpenXml</code> if you are not familiar with Microsoft.Interop"}, {"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448482484, "post_id": 33925442, "comment_id": 55612132, "body": "@MethodMan My question is not about how to create the contents of a Word document, but how to get a memory stream created document and launch it in Word without a phisical file path. I am not using interop by the way."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448482930, "post_id": 33925442, "comment_id": 55612350, "body": "<a href=\"http://blogs.msdn.com/b/mcsuksoldev/archive/2010/04/09/creating-a-new-microsoft-word-document-from-a-template-using-openxml.aspx\" rel=\"nofollow noreferrer\">blogs.msdn.com/b/mcsuksoldev/archive/2010/04/09/&hellip;</a>"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448483252, "post_id": 33925442, "comment_id": 55612513, "body": "<a href=\"http://stackoverflow.com/questions/16194646/create-word-document-with-open-xml\" title=\"create word document with open xml\">stackoverflow.com/questions/16194646/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 0, "creation_date": 1448482624, "post_id": 33925643, "comment_id": 55612209, "body": "I am not using Interop. I want to get my memory stream created document and open it in word in a way that if the user clicks save (in Microsoft Word) the Word file save as will be shown."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "reply_to_user": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 0, "creation_date": 1448482774, "post_id": 33925643, "comment_id": 55612282, "body": "Exactly how are you using this &quot;Memory Stream&quot;?  <i>You don&#39;t need a memory stream to create a doc file</i> - you just need an &quot;object&quot;.  An in-memory object.  Created by Interop, or by DocX, for example.  Q: So what&#39;s it for?  How is it created? What is your &quot;use case&quot; for requiring a memory stream?  Please clarify."}, {"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 0, "creation_date": 1448483028, "post_id": 33925643, "comment_id": 55612394, "body": "My application creates a Word document using OpenXML. The file content is not my question here. This is working great. I want to launch this file in Microsoft Word. When the user clicks &quot;Save&quot; on Microsoft Word, I want that word asks where to save the file. So I suspect I cannot open this document form a file stream."}], "tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": false, "score": 2, "last_activity_date": 1448486248, "last_edit_date": 1448486248, "creation_date": 1448482455, "answer_id": 33925643, "question_id": 33925442, "link": "https://stackoverflow.com/questions/33925442/how-to-open-word-document-from-memory-stream/33925643#33925643", "title": "How to open Word document from memory stream", "body": "<p>Just programmatically create a new Word document using the standard Microsoft.Interop.Word .Net namespace:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/hhf98b5c.aspx\" rel=\"nofollow\">How to: Programmatically Create New Documents</a></li>\n</ul>\n\n<p>Note that you might need to install MS-Office to do this.</p>\n\n<p>Note, too, that your application can display it's own \"Save As\" dialog (or, for that matter, could just use a hard-coded path) <em>independent</em> of Word.  Your program chooses the path - and your program writes the Word document object if/when it's ready.</p>\n\n<p>Finally, here's an alternative, open source library, <a href=\"https://docx.codeplex.com/\" rel=\"nofollow\">DocX</a>:</p>\n\n<ul>\n<li><p><a href=\"http://www.codeproject.com/Articles/660478/Csharp-Create-and-Manipulate-Word-Documents-Progra\" rel=\"nofollow\">http://www.codeproject.com/Articles/660478/Csharp-Create-and-Manipulate-Word-Documents-Progra</a></p></li>\n<li><p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff478386.aspx\" rel=\"nofollow\">How to: Open a word processing document from a stream (Open XML SDK)</a></p></li>\n</ul>\n\n<p>ADDENDUM:</p>\n\n<p>Thank you for your clarification:</p>\n\n<ol>\n<li><p>You're using the OpenXML SDK (as an alternative to .Net Interop or DocX libraries I mentioned above). You've already created an in-memory document object.  </p></li>\n<li><p>Now you want the user to be able to open the document object in Word (presumably to review it), before saving it (to a filename of his/her own choosing).</p></li>\n<li><p>You can't (easily) do that :)</p></li>\n<li><p>One option, suggested by sovemp above:</p>\n\n<p>a. OpenXML writes to a temp file (so it can be opened in Word)</p>\n\n<p>b. Make the temp file read-only (to force the user to do an explicit \"Save As\")</p>\n\n<p>c. Use .Net Process.Start() to invoke MSWord (specifying your temp file in your command line).</p></li>\n<li><p>Another option might be to use a \"Preview Handler\":</p>\n\n<ul>\n<li><p><a href=\"http://www.codeproject.com/Articles/25465/Using-Vista-Preview-Handlers-in-a-WPF-Application\" rel=\"nofollow\">http://www.codeproject.com/Articles/25465/Using-Vista-Preview-Handlers-in-a-WPF-Application</a></p></li>\n<li><p><a href=\"https://previewhandlers.codeplex.com/\" rel=\"nofollow\">https://previewhandlers.codeplex.com/</a></p></li>\n</ul></li>\n<li><p>Still another option might be to serve the memory stream in a web browser, using HTTP ContentType \"application/msword\" (for example)</p></li>\n<li><p>Finally, if all you want is for the user to specify a filename (if \"preview\" isn't essential), you can always pop up your own \"Save as\" dialog and write document to disk directly from OpenXML.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 0, "creation_date": 1448489861, "post_id": 33925910, "comment_id": 55615753, "body": "Are you saying that if I mark the file as read-only it will force Microsoft Word to ask user to &quot;Save As...&quot; with another name instead of saving directly to the temporary path I created?"}, {"owner": {"reputation": 1390, "user_id": 713865, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b845379b752baf685c6d11094b31204?s=128&d=identicon&r=PG", "display_name": "sovemp", "link": "https://stackoverflow.com/users/713865/sovemp"}, "reply_to_user": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 0, "creation_date": 1448497384, "post_id": 33925910, "comment_id": 55618324, "body": "Yes exactly. I think this is similar to how web browsers do it if I&#39;m not mistaken."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1448554965, "post_id": 33925910, "comment_id": 55645428, "body": "Building on sovemp&#39;s content: It&#39;s not possible to &quot;stream&quot; content into the Word application. Closest you can get requires some kind of &quot;interop&quot; interaction, either pasting from the Clipboard, using InsertFile or Range.XML in order to put content into an already open Word document. There&#39;s no way to create a document from a stream - Word simply is not built to do that."}], "tags": [], "owner": {"reputation": 1390, "user_id": 713865, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b845379b752baf685c6d11094b31204?s=128&d=identicon&r=PG", "display_name": "sovemp", "link": "https://stackoverflow.com/users/713865/sovemp"}, "is_accepted": false, "score": 4, "last_activity_date": 1448483511, "creation_date": 1448483511, "answer_id": 33925910, "question_id": 33925442, "link": "https://stackoverflow.com/questions/33925442/how-to-open-word-document-from-memory-stream/33925910#33925910", "title": "How to open Word document from memory stream", "body": "<p>I don't think you can do this purely on the memory stream.  However, I would save the memory stream to a temporary file, by saving to the Temp folder or AppData\\temp or something like that with a randomly-generated name, and then mark that file as read-only.  Then open word on that file (with System.Diagnostics.Process or however you are doing it), and since it is read-only, it will ask the user to save changes when they exit.</p>\n"}], "owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8701, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1448534954, "creation_date": 1448481749, "last_edit_date": 1448534954, "question_id": 33925442, "link": "https://stackoverflow.com/questions/33925442/how-to-open-word-document-from-memory-stream", "title": "How to open Word document from memory stream", "body": "<p>In our WPF application, we must create a Word document and open it automatically.</p>\n\n<p>Today we ask the user to specify the file name and location BEFORE we create the document and them open the file using the Process.Start method.</p>\n\n<p>Now, I want to create the Word document in memory stream, open it and eventually, when the user decides to save the document in Microsoft Word, he will have to specify the location and name. So I will not be using the SaveFileDialog in my app.</p>\n\n<p>This is similar to when you start Microsoft Word. A default document is created and when you click save, you will guided to the \"save as\" function.</p>\n\n<p>How can I do that?</p>\n"}, {"tags": ["java", "c#", "automation", "white-framework"], "comments": [{"owner": {"reputation": 1236, "user_id": 1162324, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d33728a4fd234a9c00e390766928525f?s=128&d=identicon&r=PG", "display_name": "Max Young", "link": "https://stackoverflow.com/users/1162324/max-young"}, "edited": false, "score": 0, "creation_date": 1448486956, "post_id": 33925413, "comment_id": 55614360, "body": "Could you please take a screen shot of what inspect.exe returns when hovering over the control. You can get inspect here <a href=\"https://msdn.microsoft.com/en-us/windows/desktop/bg162891.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/windows/desktop/bg162891.aspx</a> and it installs to this location C:\\Program Files (x86)\\Windows Kits\\8.1\\bin\\x86."}, {"owner": {"reputation": 275, "user_id": 5547912, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/859c58fb2a80331797b420244ceba553?s=128&d=identicon&r=PG&f=1", "display_name": "Juste3alfaz", "link": "https://stackoverflow.com/users/5547912/juste3alfaz"}, "reply_to_user": {"reputation": 1236, "user_id": 1162324, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d33728a4fd234a9c00e390766928525f?s=128&d=identicon&r=PG", "display_name": "Max Young", "link": "https://stackoverflow.com/users/1162324/max-young"}, "edited": false, "score": 0, "creation_date": 1448536526, "post_id": 33925413, "comment_id": 55633913, "body": "For UIA Verify can recognize the button, but Ranorex Spy can, see the update"}, {"owner": {"reputation": 1236, "user_id": 1162324, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d33728a4fd234a9c00e390766928525f?s=128&d=identicon&r=PG", "display_name": "Max Young", "link": "https://stackoverflow.com/users/1162324/max-young"}, "edited": false, "score": 0, "creation_date": 1448545836, "post_id": 33925413, "comment_id": 55639748, "body": "Yeah I was hoping to see what inspect.exe produces since it uses the ui automation com wrapper and is written by microsoft. UIAVerify is using the .net System.Windows.Automation namespace and I am not sure what Ranorex uses."}, {"owner": {"reputation": 275, "user_id": 5547912, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/859c58fb2a80331797b420244ceba553?s=128&d=identicon&r=PG&f=1", "display_name": "Juste3alfaz", "link": "https://stackoverflow.com/users/5547912/juste3alfaz"}, "reply_to_user": {"reputation": 1236, "user_id": 1162324, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d33728a4fd234a9c00e390766928525f?s=128&d=identicon&r=PG", "display_name": "Max Young", "link": "https://stackoverflow.com/users/1162324/max-young"}, "edited": false, "score": 0, "creation_date": 1448557722, "post_id": 33925413, "comment_id": 55646995, "body": "Ranorex have api, and it uses all .net ana java for Web, desktop and mobile, and it works perfect, but the problem I most pay to get Ranorex"}, {"owner": {"reputation": 4221, "user_id": 1829500, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ae2b0b34cefdc3cbc21bba47521d8d36?s=128&d=identicon&r=PG", "display_name": "Mrunal Gosar", "link": "https://stackoverflow.com/users/1829500/mrunal-gosar"}, "edited": false, "score": 0, "creation_date": 1455524872, "post_id": 33925413, "comment_id": 58510406, "body": "have you built ur java app using swing?..If so, then go for SWTBot"}, {"owner": {"reputation": 275, "user_id": 5547912, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/859c58fb2a80331797b420244ceba553?s=128&d=identicon&r=PG&f=1", "display_name": "Juste3alfaz", "link": "https://stackoverflow.com/users/5547912/juste3alfaz"}, "edited": false, "score": 0, "creation_date": 1455530968, "post_id": 33925413, "comment_id": 58514269, "body": "I don&#39;t have the source code of the origin app"}], "owner": {"reputation": 275, "user_id": 5547912, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/859c58fb2a80331797b420244ceba553?s=128&d=identicon&r=PG&f=1", "display_name": "Juste3alfaz", "link": "https://stackoverflow.com/users/5547912/juste3alfaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448536640, "creation_date": 1448481676, "last_edit_date": 1448536640, "question_id": 33925413, "link": "https://stackoverflow.com/questions/33925413/teststack-white-error-java-app", "title": "TestStack White error JAVA app", "body": "<p>I try TestStack.White to run an automation for JAVA app, here in my example is Calculator coded in JAVA, under VS2015 in C#. I installed TestStack.White using NuGet and tring with Winform app and it works, but here with java app, I can open the application, But not all component I can click on it.\nSo I try to know the component name with UIA Verify interface, but it selects the whole window, after that I look for something similar to UI Verify, and I found Ranorex STudio with Track Features and it works I can see Java Component name, but after I know the name, and I searsh for it in the app, the code not working. This is my code:</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        Application aa = Application.Launch(\"..\\\\..\\\\CalculatorOrange.jar\");\n        Window calcWindos = aa.GetWindow(\"Calculator Lite - 1.5.3\", InitializeOption.NoCache);\n\n        Button twoBtn = calcWindos.Get&lt;Button&gt;(SearchCriteria.ByText(\"8\"));\n        twoBtn.Click();\n        //var twoBtn = calcWindos.Get&lt;MenuBar&gt;(\"mnuFile\");\n        //twoBtn.Click();\n    }\n}\n</code></pre>\n\n<p>and it shows this error:</p>\n\n<blockquote>\n  <p>An unhandled exception of type 'TestStack.White.AutomationException'\n  occurred in TestStack.White.dll</p>\n  \n  <p>Additional information: Failed to get (ControlType=button or\n  ControlType=check box),Name=8</p>\n</blockquote>\n\n<p>This image shows the component type and name\n<a href=\"https://i.stack.imgur.com/ffjEH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ffjEH.png\" alt=\"enter image description here\"></a></p>\n\n<p>Update 1 : On the left, I use Ranorex Spy, and it shows all the Component, and on the right the Inspect for Microsoft\n<a href=\"https://i.stack.imgur.com/prnFY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/prnFY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "sql-server", "performance", "collections", "sqldatareader"], "comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448482095, "post_id": 33925260, "comment_id": 55611915, "body": "I think it uses reflection, but <a href=\"https://github.com/StackExchange/dapper-dot-net\" rel=\"nofollow noreferrer\">Dapper</a> is a pre-built library that does exactly what you are looking for. It is developed by the people at StackOverflow and is used as the backend for this very site."}, {"owner": {"reputation": 221, "user_id": 2468143, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/afc4a6661e09e3f6058ebf1f7da94b3f?s=128&d=identicon&r=PG", "display_name": "Jbob Johan", "link": "https://stackoverflow.com/users/2468143/jbob-johan"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448482288, "post_id": 33925260, "comment_id": 55612025, "body": "@ScottChamberlain the question is why if I am willing to just tell it to take a list of initialized objects why do you need Dapper ? why reflection what am I missing here ?"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448482663, "post_id": 33925260, "comment_id": 55612231, "body": "I don&#39;t understand what you are trying to say, sorry."}, {"owner": {"reputation": 221, "user_id": 2468143, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/afc4a6661e09e3f6058ebf1f7da94b3f?s=128&d=identicon&r=PG", "display_name": "Jbob Johan", "link": "https://stackoverflow.com/users/2468143/jbob-johan"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448482938, "post_id": 33925260, "comment_id": 55612355, "body": "@ScottChamberlain I want to populate an <code>SqlDataReader</code>, I can do it with <code>IDataReader</code>, we can see how in those examples, it should be less complex if you feed it with <code>new List&lt;aknownInitializedObject&gt;</code> instead of generic that has to use reflection as it does not know the members but I do supply it"}, {"owner": {"reputation": 221, "user_id": 2468143, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/afc4a6661e09e3f6058ebf1f7da94b3f?s=128&d=identicon&r=PG", "display_name": "Jbob Johan", "link": "https://stackoverflow.com/users/2468143/jbob-johan"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448483414, "post_id": 33925260, "comment_id": 55612590, "body": "@ScottChamberlain I just want to change it to use specific object and specify the members instead of using reflection or any other getmember as I don&#39;t ask from it to get members I want give it  so I could save the overhead , just type it fileds - objectfields  here they are just use them"}, {"owner": {"reputation": 221, "user_id": 2468143, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/afc4a6661e09e3f6058ebf1f7da94b3f?s=128&d=identicon&r=PG", "display_name": "Jbob Johan", "link": "https://stackoverflow.com/users/2468143/jbob-johan"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448496901, "post_id": 33925260, "comment_id": 55618199, "body": "@ScottChamberlain please review my answer as i am making it clearer now. if there&#39;s any thing to change or make sure there will be no major accidents  as it is ... please do comment it."}], "answers": [{"comments": [{"owner": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "reply_to_user": {"reputation": 221, "user_id": 2468143, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/afc4a6661e09e3f6058ebf1f7da94b3f?s=128&d=identicon&r=PG", "display_name": "Jbob Johan", "link": "https://stackoverflow.com/users/2468143/jbob-johan"}, "edited": false, "score": 0, "creation_date": 1448634722, "post_id": 33926853, "comment_id": 55676640, "body": "@JbobJohan Yes. How can I help you?"}], "tags": [], "owner": {"reputation": 14801, "user_id": 47580, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/miRRJ.jpg?s=128&g=1", "display_name": "Mike Hofer", "link": "https://stackoverflow.com/users/47580/mike-hofer"}, "is_accepted": false, "score": 0, "last_activity_date": 1448487518, "creation_date": 1448487518, "answer_id": 33926853, "question_id": 33925260, "link": "https://stackoverflow.com/questions/33925260/populate-idatareader-without-reflection-using-any-specified-object-collection/33926853#33926853", "title": "populate IDataReader without reflection using any (specified) object Collection", "body": "<p>You are asking the runtime and the compiler to do something that it cannot do without reflecting over the type. </p>\n\n<p>The information that allows the CLR and the compiler to know what properties are on the type are in the type's metadata. Reflection is the mechanism that queries metadata and serves it up in a meaningful way so that we can use it to discover the shape and content of a type. Without it, a type is essentially a named black box.</p>\n\n<p>You <em>could</em> do what you want, but you'd have to code it by hand. The reason the libraries out there exist is because reflection makes it possible for you to avoid that extra work.</p>\n"}, {"tags": [], "owner": {"reputation": 221, "user_id": 2468143, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/afc4a6661e09e3f6058ebf1f7da94b3f?s=128&d=identicon&r=PG", "display_name": "Jbob Johan", "link": "https://stackoverflow.com/users/2468143/jbob-johan"}, "is_accepted": false, "score": 0, "last_activity_date": 1448498908, "last_edit_date": 1448498908, "creation_date": 1448495550, "answer_id": 33928445, "question_id": 33925260, "link": "https://stackoverflow.com/questions/33925260/populate-idatareader-without-reflection-using-any-specified-object-collection/33928445#33928445", "title": "populate IDataReader without reflection using any (specified) object Collection", "body": "<p>needs further test to try</p>\n\n<ul>\n<li>eliminate unnecessary mappings <strong>Update: tested ok</strong></li>\n</ul>\n\n<p>(gain extra performance when <code>MyTestObject</code> properties/fields are same as columns)</p>\n\n<ul>\n<li><p>if making it generic will effect it only slightly the use it with <code>T\n</code>\n<strong>using :</strong></p>\n\n<pre><code>public string sqlCon =\"data source=(local);Initial Catalog=XXX;Integrated Security=True\";\npublic SqlCommand Cmd;\npublic SqlConnection Conn;\npublic SqlDataReader Drdr;\npublic Form1()\n{\n    InitializeComponent();\n    this.Conn = new SqlConnection(this.sqlCon);\n    this.Cmd = new SqlCommand(\"select * from [tblTestBC]\", this.Conn);\n    useBulkCopy();\n}\nvoid justread()\n{\n    this.Cmd.Connection.Open();\n    this.Drdr = this.Cmd.ExecuteReader();\n    if (this.Drdr.HasRows)\n        while (this.Drdr.Read())\n        {\n\n        }\n    this.Cmd.Connection.Close();\n}\nvoid useBulkCopy()\n{\n    var bulkCopy = new SqlBulkCopy(this.Cmd.Connection);\n    bulkCopy.DestinationTableName = \"tblTestBC\";\n    //bulkCopy.ColumnMappings.Add(\"age\", \"age\");\n    //bulkCopy.ColumnMappings.Add(\"name\", \"name\");\n    this.Cmd.Connection.Open();\n    try\n    {\n\n        using (var dataReader = new mySimpleDataReader())\n        {\n            bulkCopy.WriteToServer(dataReader);\n        }\n        this.Cmd.Connection.Close();\n    }\n    catch (Exception e)\n    {\n    }\n\n}\n</code></pre></li>\n</ul>\n\n<p><strong>GenericIdataReader</strong></p>\n\n<pre><code>namespace GenericIdataReader\n{\n    public class MyTestObject\n    {\n        public int age;\n        public string name;\n    }\n    public class mySimpleDataReader : IDataReader\n    {\n        private IEnumerator&lt;MyTestObject&gt; enumerator = null;\n        public List&lt;MyTestObject&gt; prpLst { get; set; }\n        List&lt;MyTestObject&gt; lst()\n        {\n            var rt = new List&lt;MyTestObject&gt;(5);\n            for (int i = 0; i &lt; rt.Capacity; i++)\n            {\n                var tmp = new MyTestObject { age = i, name = \"MyTestObject-&gt;\"+i };\n                rt.Add(tmp);\n            }\n            return rt;\n        }\n        public mySimpleDataReader()\n        {\n            this.prpLst = this.lst();\n            this.enumerator = this.prpLst.GetEnumerator();            \n        }\n\n\n        public void Close()\n        {\n            throw new NotImplementedException();\n        }\n\n        public int Depth\n        {\n            get { throw new NotImplementedException(); }\n        }\n\n        public DataTable GetSchemaTable()\n        {\n            throw new NotImplementedException();\n        }\n\n        public bool IsClosed\n        {\n            get { throw new NotImplementedException(); }\n        }\n\n        public bool NextResult()\n        {\n            throw new NotImplementedException();\n        }\n\n        public bool Read()\n        {\n            return enumerator.MoveNext();\n        }\n\n        public int RecordsAffected\n        {\n            get { throw new NotImplementedException(); }\n        }\n\n        public void Dispose()\n        {\n            this.enumerator.Dispose();\n        }\n\n        public int FieldCount\n        {\n            get { return 2; }// must be setted \n        }\n\n        public bool GetBoolean(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public byte GetByte(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public long GetBytes(int i, long fieldOffset, byte[] buffer, int bufferoffset, int length)\n        {\n            throw new NotImplementedException();\n        }\n\n        public char GetChar(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public long GetChars(int i, long fieldoffset, char[] buffer, int bufferoffset, int length)\n        {\n            throw new NotImplementedException();\n        }\n\n        public IDataReader GetData(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public string GetDataTypeName(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public DateTime GetDateTime(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public decimal GetDecimal(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public double GetDouble(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public Type GetFieldType(int i)\n        {\n             throw new NotImplementedException();\n        }\n\n        public float GetFloat(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public Guid GetGuid(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public short GetInt16(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public int GetInt32(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public long GetInt64(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public string GetName(int i)\n        {\n           throw new NotImplementedException();\n        }\n\n        public int GetOrdinal(string name)\n        {\n           throw new NotImplementedException();\n        }\n\n        public string GetString(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public object GetValue(int i) // this is where data is being pooled\n        {\n            if (i &gt; 0) return enumerator.Current.name;\n// so need to create an object that will hold numeric index or simply change\n//this to return an indexed object instead of an enumerator according to parmeter i value\n            return enumerator.Current.age;\n        }\n\n        public int GetValues(object[] values)\n        {\n            throw new NotImplementedException();\n        }\n\n        public bool IsDBNull(int i)\n        {\n            throw new NotImplementedException();\n        }\n\n        public object this[string name]\n        {\n            get { throw new NotImplementedException(); }\n        }\n\n        public object this[int i]\n        {\n            get { throw new NotImplementedException(); }\n        }\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 2468143, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/afc4a6661e09e3f6058ebf1f7da94b3f?s=128&d=identicon&r=PG", "display_name": "Jbob Johan", "link": "https://stackoverflow.com/users/2468143/jbob-johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1448498908, "creation_date": 1448481036, "last_edit_date": 1448497262, "question_id": 33925260, "link": "https://stackoverflow.com/questions/33925260/populate-idatareader-without-reflection-using-any-specified-object-collection", "title": "populate IDataReader without reflection using any (specified) object Collection", "body": "<p>I struggling to get something done when it suppose to be very easy to implement </p>\n\n<p>say I have a car object</p>\n\n<pre><code>public class tblCarObj\n{\n    public String Model;\n    public Int32 Year;\n}\n</code></pre>\n\n<p>within these lines there is an implementation of <code>reflection</code> that is based on the fact that the object members are unknown (is this the only reason?)</p>\n\n<p>which is nice for a generic functionality, but I am sacrificing functionality for performance if needed. and I wonder why both Links (see below) uses this approach.</p>\n\n<p>can I simply use <code>MyCarReader&lt;tblCarObj&gt;</code></p>\n\n<p>instead of </p>\n\n<pre><code>    //for this instance.        \n    private IEnumerator&lt;T&gt; enumerator = null;\n\n    //List of all public fields in &lt;T&gt;\n    private List&lt;FieldInfo&gt; fields = new List&lt;FieldInfo&gt;();\n\n    public MyGenericDataReader(IEnumerable&lt;T&gt; enumerator)\n    {\n        this.enumerator = enumerator.GetEnumerator();            \n\n        //Find the enumerator of all public fields\n        foreach (FieldInfo fieldinfo in typeof(T).GetFields(                \n            BindingFlags.Instance |\n            BindingFlags.Public))\n        {\n            fields.Add(fieldinfo);\n        }\n    }  \n</code></pre>\n\n<p><strong>is there a way to implement this method without the use of reflection ?</strong></p>\n\n<p>background</p>\n\n<p>the task Is to simply upload a collection of objects into database table,</p>\n\n<pre><code>List&lt;tblCarObj&gt;\n</code></pre>\n\n<p>where:</p>\n\n<ul>\n<li>DataBase Table is Ready</li>\n<li>DataBase Table matches the DataObject members</li>\n<li>both are known at compile time.</li>\n</ul>\n\n<p>and directly use it on <code>SQLBulckCopy</code> instead of a more complex object such as  <code>DataTable</code></p>\n\n<ul>\n<li><a href=\"http://technico.qnownow.com/custom-data-reader-to-bulk-copy-data-from-object-collection-to-sql-server/\" rel=\"nofollow\">MyGenericDataReader.cs</a></li>\n<li><a href=\"http://www.csvreader.com/posts/GenericListDataReader.cs\" rel=\"nofollow\">GenericListDataReader.cs</a></li>\n</ul>\n"}, {"tags": ["c#", "excel", "schema", "oledb"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448481590, "post_id": 33925222, "comment_id": 55611676, "body": "how long do you expect it to return.. do you know what the total and or max size in regards to rows that a single excel sheet can handle.. it&#39;s like 67K I thought.. so 200K is large.. also <code>you only need to write this Debug.WriteLine</code> you do not have to fully qualify it.. there are better ways to load the excel file into a <code>DataTable</code> as well I will post an example that I have just tried.."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448481911, "post_id": 33925222, "comment_id": 55611815, "body": "look at these .. this is what I have used to just try some of my own Excel <a href=\"http://stackoverflow.com/questions/18006318/how-to-import-all-the-excel-sheets-to-dataset-in-c-sharp\" title=\"how to import all the excel sheets to dataset in c sharp\">stackoverflow.com/questions/18006318/&hellip;</a>"}, {"owner": {"reputation": 285, "user_id": 266592, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7fe4d3a99032a11e9f6ccf17f0ff68cd?s=128&d=identicon&r=PG", "display_name": "wham12", "link": "https://stackoverflow.com/users/266592/wham12"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448506746, "post_id": 33925222, "comment_id": 55620545, "body": "I&#39;m not trying to load the whole file, just the schema (headers). I would expect those to come back almost immediately. (Btw, the 65k limit is just for 97-2003 versions, 2007+ can handle just over 1M rows.)"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448655532, "post_id": 33925222, "comment_id": 55685926, "body": "if you are trying to just load the headers.. then you are obviously doing something wrong.. look at this link <a href=\"http://stackoverflow.com/questions/3924745/use-getoledbschematable-to-get-the-columns-of-a-table-named-street\" title=\"use getoledbschematable to get the columns of a table named street\">stackoverflow.com/questions/3924745/&hellip;</a> also you can also do a google search to find other example by typing in the following in the search engine <code>C# GetOleDBSchemaTable</code>"}, {"owner": {"reputation": 285, "user_id": 266592, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7fe4d3a99032a11e9f6ccf17f0ff68cd?s=128&d=identicon&r=PG", "display_name": "wham12", "link": "https://stackoverflow.com/users/266592/wham12"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448656282, "post_id": 33925222, "comment_id": 55686224, "body": "That is exactly what I&#39;m doing in my code sample above, and it takes longer than I would expect it to for the <code>con.GetOleDbSchemaTable</code> to return the columns DataTable."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448656403, "post_id": 33925222, "comment_id": 55686262, "body": "it&#39;s not exactly what you&#39;re doing.. for starters..you don&#39;t need this part in regards to this  <code>DbProviderFactory factory = DbProviderFactories.GetFactory(&quot;System.Data.OleDb&quot;);     DbDataAdapter adapter = factory.CreateDataAdapter();</code> totally not necessary <code>DbProviderFactory</code>"}], "owner": {"reputation": 285, "user_id": 266592, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7fe4d3a99032a11e9f6ccf17f0ff68cd?s=128&d=identicon&r=PG", "display_name": "wham12", "link": "https://stackoverflow.com/users/266592/wham12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450123766, "creation_date": 1448480879, "last_edit_date": 1450123766, "question_id": 33925222, "link": "https://stackoverflow.com/questions/33925222/getoledbschematable-columns-slow-for-large-worksheet", "title": "GetOleDbSchemaTable columns slow for large worksheet", "body": "<p>I am using the ACE OLEDB connection string to connect to an excel file. I've noticed my query (see example below) that returns the column schema takes longer to run when the worksheet has more rows of data on it.<br>\nFor some of my larger worksheets (200k rows) it is taking around 10 seconds for the header schema to be returned. It there a way to speed this up or a better way to get the column headers?</p>\n\n<pre><code>    string connectionString = string.Empty;\n    connectionString = String.Format(@\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={0};\n        Extended Properties=\"\"Excel 12.0 Xml;HDR=YES;IMEX=1\"\"\", path);\n\n    OleDbConnection con = new OleDbConnection(connectionString);\n    con.Open();\n\n    DataTable dtSchema = new DataTable();\n\n    System.Diagnostics.Debug.WriteLine(\"Start: \" + DateTime.Now.ToLongTimeString());\n    dtSchema = con.GetOleDbSchemaTable(OleDbSchemaGuid.Columns,\n                    new Object[] { null, null, WorksheetName, null });\n    System.Diagnostics.Debug.WriteLine(\"End: \" + DateTime.Now.ToLongTimeString());\n\n\n    con.Close();\n</code></pre>\n\n<p><strong>UPDATE</strong><br>\nI tried rewriting this - turning Headers off and manually reading only the first row. It still takes around 10 seconds to process on my larger files (small ones still come back very quickly). Is there anything else I can try that might be able to get the header(first row) values quicker?</p>\n\n<pre><code>string connectionString = string.Empty;\nconnectionString = String.Format(@\"Provider=Microsoft.ACE.OLEDB.12.0; Data Source={0}; \n    Extended Properties=\"\"Excel 12.0 Xml;HDR=NO;\"\"\", path);\n\nDataTable dtSchema = new DataTable();                        \n\nusing (OleDbConnection conn = new OleDbConnection(connectionString))\n{\n    OleDbCommand command = new OleDbCommand(String.Format(\"SELECT * FROM [{0}A1:II1]\", WorksheetName),conn);\n\n    OleDbDataAdapter dataAdapter = new OleDbDataAdapter();\n    dataAdapter.SelectCommand = command;\n\n    DataSet dataSet = new DataSet();\n    dataAdapter.Fill(dataSet);\n\n    dtSchema = dataSet.Tables[0];\n}\n</code></pre>\n"}, {"tags": ["c#", "wpf", "xaml", "gridview"], "comments": [{"owner": {"reputation": 307, "user_id": 1319406, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cwHgB.jpg?s=128&g=1", "display_name": "Danielle", "link": "https://stackoverflow.com/users/1319406/danielle"}, "edited": false, "score": 0, "creation_date": 1448481300, "post_id": 33925207, "comment_id": 55611542, "body": "Is the horizontal orientation of your StackPanel intentional? I would think you would want a vertical orientation with Left Horizontal Alignment."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448485558, "post_id": 33925207, "comment_id": 55613642, "body": "This question is unclear. We see the image showing what is happening. But how <i>specifically</i> is that different from what you want? Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that reliably reproduces the problem, along with a precise explanation of what that code does and how that&#39;s different from what you want."}, {"owner": {"reputation": 1519, "user_id": 5368270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3595ff283fe3b162ba7259b543929b9d?s=128&d=identicon&r=PG&f=1", "display_name": "Code", "link": "https://stackoverflow.com/users/5368270/code"}, "reply_to_user": {"reputation": 307, "user_id": 1319406, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cwHgB.jpg?s=128&g=1", "display_name": "Danielle", "link": "https://stackoverflow.com/users/1319406/danielle"}, "edited": false, "score": 0, "creation_date": 1448488179, "post_id": 33925207, "comment_id": 55614972, "body": "@Danielle if you would like to post that as a proposed solution I will mark it as correct"}, {"owner": {"reputation": 1519, "user_id": 5368270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3595ff283fe3b162ba7259b543929b9d?s=128&d=identicon&r=PG&f=1", "display_name": "Code", "link": "https://stackoverflow.com/users/5368270/code"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448488282, "post_id": 33925207, "comment_id": 55615021, "body": "@PeterDuniho How do you see this as unclear? I clearly stated I am having problems manipulating the position of of textblocks in a gridview. I do not know where I want it positioned so it would be pointless to state that in the question"}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448488511, "post_id": 33925207, "comment_id": 55615133, "body": "<i>&quot;How do you see this as unclear&quot;</i> -- please read my comment, as it explains already how I see the question as unclear.  <i>&quot;I do not know where I want it positioned&quot;</i> -- then how do you know the current behavior is wrong? It seems absurd to me that you would not know what the <i>expected output</i> of your own program would be, but if you truly don&#39;t know what the expected output is, you have no business saying the current output isn&#39;t correct."}, {"owner": {"reputation": 1519, "user_id": 5368270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3595ff283fe3b162ba7259b543929b9d?s=128&d=identicon&r=PG&f=1", "display_name": "Code", "link": "https://stackoverflow.com/users/5368270/code"}, "edited": false, "score": 0, "creation_date": 1448489485, "post_id": 33925207, "comment_id": 55615594, "body": "The question is &quot;Does anyone know of a way I can manipulate the position of the textblocks in my GridView?&quot; Seems pretty clear to me."}, {"owner": {"reputation": 1431, "user_id": 3063835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f10ab12800198b9531488aa7a97df5e?s=128&d=identicon&r=PG&f=1", "display_name": "Rowbear", "link": "https://stackoverflow.com/users/3063835/rowbear"}, "edited": false, "score": 0, "creation_date": 1448493130, "post_id": 33925207, "comment_id": 55617090, "body": "@Code I must say I agree with Peter. I saw this question when you had just posted it and my first thought was &quot;does he just want a vertical stack panel?&quot;, but I didn&#39;t post an answer because I wasn&#39;t sure of your intentions.  You merely mentioned that the text is cut off, and you wanted a way to manipulate it. Well, there are multiple ways to manipulate, and multiple ways to make it not cut off :) If you described the final positioning of the text blocks that you wanted, it would&#39;ve been 100% clear. Anyway, glad you got your question answered :). Oh btw, you can also use a WrapPanel instead."}], "answers": [{"tags": [], "owner": {"reputation": 307, "user_id": 1319406, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cwHgB.jpg?s=128&g=1", "display_name": "Danielle", "link": "https://stackoverflow.com/users/1319406/danielle"}, "is_accepted": true, "score": 1, "last_activity_date": 1448887355, "creation_date": 1448887355, "answer_id": 33998951, "question_id": 33925207, "link": "https://stackoverflow.com/questions/33925207/aligning-items-in-gridview/33998951#33998951", "title": "Aligning items in GridView", "body": "<p>Set the Orientation of the StackPanel to be Vertical with a Left Horizontal Alignment and see if that gives you the desired look.</p>\n"}], "owner": {"reputation": 1519, "user_id": 5368270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3595ff283fe3b162ba7259b543929b9d?s=128&d=identicon&r=PG&f=1", "display_name": "Code", "link": "https://stackoverflow.com/users/5368270/code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 33998951, "answer_count": 1, "score": 1, "last_activity_date": 1448887355, "creation_date": 1448480815, "question_id": 33925207, "link": "https://stackoverflow.com/questions/33925207/aligning-items-in-gridview", "title": "Aligning items in GridView", "body": "<p>I am having trouble aligning my items in my <code>Gridview</code>. I have a <code>DataTemplate</code> that has a <code>Stackpanel</code> within it. Inside of that <code>Stackpanel</code> I have 3 <code>TextBlocks</code>. I am unable to move those textblock where I want to in the <code>Gridview</code>. I will post my XAML below..</p>\n\n<p><strong>XAML</strong></p>\n\n<pre><code>&lt;Page.Resources&gt;\n    &lt;DataTemplate x:Key=\"TileTemplate\"&gt;\n        &lt;StackPanel Orientation=\"Horizontal\"&gt;\n            &lt;TextBlock Text=\"{Binding TitleView}\" FontFamily=\"Segoe UI\" FontWeight=\"SemiBold\" FontSize=\"18\" Foreground=\"White\" TextWrapping=\"Wrap\" HorizontalAlignment=\"Left\"  VerticalAlignment=\"Top\" Margin=\"10,10\" /&gt;\n            &lt;TextBlock Text=\"{Binding BodyView}\" FontFamily=\"Segoe UI\" FontWeight=\"Light\" FontSize=\"14\" Foreground=\"White\" TextWrapping=\"Wrap\" Margin=\"10,50\" /&gt;\n            &lt;TextBlock Text=\"{Binding AuthorView}\" FontFamily=\"Segoe UI\" FontWeight=\"Light\" FontStyle=\"Italic\" FontSize=\"10\" Foreground=\"White\" TextWrapping=\"Wrap\" HorizontalAlignment=\"Left\" VerticalAlignment=\"Bottom\" Margin=\"10,10\" /&gt;\n        &lt;/StackPanel&gt;\n    &lt;/DataTemplate&gt;\n&lt;/Page.Resources&gt;\n\n &lt;Grid x:Name=\"tileGrid\"&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"Auto\" /&gt;\n        &lt;RowDefinition /&gt;\n    &lt;/Grid.RowDefinitions&gt;\n\n\n\n    &lt;GridView x:Name=\"tileGridView\" Margin=\"12,60\" ItemTemplate=\"{StaticResource TileTemplate}\"&gt;\n        &lt;GridView.ItemsPanel&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;ItemsWrapGrid Orientation=\"Horizontal\"/&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/GridView.ItemsPanel&gt;\n\n        &lt;GridView.ItemContainerStyle&gt;\n            &lt;Style TargetType=\"GridViewItem\"&gt;\n                &lt;Style.Setters&gt;\n                    &lt;Setter Property=\"Template\"&gt;\n                        &lt;Setter.Value&gt;\n                            &lt;ControlTemplate&gt;\n                                &lt;Grid Background=\"#2A2A2A\"\n                                  Margin=\"5\"\n                                  Height=\"200\"\n                                  Width=\"300\"&gt;\n                                    &lt;ContentPresenter /&gt;\n                                &lt;/Grid&gt;\n                            &lt;/ControlTemplate&gt;\n                        &lt;/Setter.Value&gt;\n                    &lt;/Setter&gt;\n                &lt;/Style.Setters&gt;\n            &lt;/Style&gt;\n        &lt;/GridView.ItemContainerStyle&gt;\n      &lt;/GridView&gt;\n    &lt;/Grid&gt;\n</code></pre>\n\n<p>This is the result I am getting:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vjCoU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vjCoU.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see it is completely cutting out the Author and is not aligning my body correctly (via my inline styling of the textblock).</p>\n\n<p>Does anyone know of a way I can manipulate the position of the textblocks in my GridView?</p>\n"}, {"tags": ["c#", "uwp", "windows-10", "win-universal-app", "cortana"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448480692, "post_id": 33925096, "comment_id": 55611260, "body": "does <code>UWP</code> support using <code>WMI</code> if so then do it using WMI"}, {"owner": {"reputation": 13042, "user_id": 2374028, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/nJ7ED.png?s=128&g=1", "display_name": "Charles Clayton", "link": "https://stackoverflow.com/users/2374028/charles-clayton"}, "reply_to_user": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448481043, "post_id": 33925096, "comment_id": 55611428, "body": "@MethodMan Thanks for the idea, it was worth checking out. Unfortunately <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/efcf0564-5bdb-44c5-95a8-76395b662b2b/uwp-wmi-support-on-uwp-applications?forum=wpdevelop\" rel=\"nofollow noreferrer\">it doesn&#39;t look that <code>WMI</code> is supported either</a>. That&#39;s what I mean, I thought registering and executing the commands would be the hard part, I didn&#39;t realize the C# would be so limited in <code>UWP</code>."}, {"owner": {"reputation": 457, "user_id": 2630919, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d8421ea4fe9d124b26a4926d966d0a1?s=128&d=identicon&r=PG&f=1", "display_name": "ezaspi", "link": "https://stackoverflow.com/users/2630919/ezaspi"}, "edited": false, "score": 5, "creation_date": 1488208091, "post_id": 33925096, "comment_id": 72117672, "body": "bummer. Microsoft wants more apps but they tie our hands tighter. I want to send command to a &quot;trusted&quot; app process - what&#39;s the big deal?? Man in the middle attacks? The developer can send and receive json from an app to a server, why not app to app?"}], "answers": [{"comments": [{"owner": {"reputation": 13042, "user_id": 2374028, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/nJ7ED.png?s=128&g=1", "display_name": "Charles Clayton", "link": "https://stackoverflow.com/users/2374028/charles-clayton"}, "edited": false, "score": 0, "creation_date": 1448483076, "post_id": 33925585, "comment_id": 55612421, "body": "Thanks for your response! I&#39;ll try some of these tonight."}, {"owner": {"reputation": 1519, "user_id": 4254283, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88c30fc27b801167b3469fff4b7ddf64?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4254283/sam"}, "edited": false, "score": 0, "creation_date": 1479006654, "post_id": 33925585, "comment_id": 68376462, "body": "Have anyone try to use AppService to &quot;Shutdown&quot; or &quot;Restart&quot; the tablet? I can&#39;t seem to find a way to do it."}, {"owner": {"reputation": 548, "user_id": 3778612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e51cf5579855ee8e9f85bbd8e42112a?s=128&d=identicon&r=PG&f=1", "display_name": "Ch.Idea", "link": "https://stackoverflow.com/users/3778612/ch-idea"}, "edited": false, "score": 0, "creation_date": 1543744233, "post_id": 33925585, "comment_id": 94021708, "body": "This document says option 4 is still usable in Windows 10, however it can&#39;t be published onto general consumer Windows Store. <a href=\"https://docs.microsoft.com/en-us/windows/uwp/winrt-components/brokered-windows-runtime-components-for-side-loaded-windows-store-apps\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/uwp/winrt-components/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1809, "user_id": 5109947, "user_type": "registered", "profile_image": "https://graph.facebook.com/1006604226018969/picture?type=large", "display_name": "Daniel Meixner", "link": "https://stackoverflow.com/users/5109947/daniel-meixner"}, "is_accepted": false, "score": 21, "last_activity_date": 1448482283, "creation_date": 1448482283, "answer_id": 33925585, "question_id": 33925096, "link": "https://stackoverflow.com/questions/33925096/how-to-execute-process-commands-or-similar-using-a-universal-windows-platform/33925585#33925585", "title": "How to execute Process commands (or similar) using a Universal Windows Platform (UWP) App?", "body": "<p>There are - limited - ways to achieve similar behavior. </p>\n\n<ol>\n<li><p>You could use LaunchUri to trigger other apps which registered for a certain URI-Scheme. This should work for your webbrowser scenario. More details here:\n<a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.system.launcher.launchuriasync.aspx\">https://msdn.microsoft.com/en-us/library/windows/apps/windows.system.launcher.launchuriasync.aspx</a></p></li>\n<li><p>You could trigger another app and get results back from it using LaunchForResults. The called app has to support this. More details here:\n<a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/mt269386.aspx\">https://msdn.microsoft.com/en-us/library/windows/apps/mt269386.aspx</a></p></li>\n<li><p>You could trigger App Services provided by another app. The called app has to support this. The app service will be executed in background. ( I think this is pretty cool.) More details here:<a href=\"http://blogs.msdn.com/b/mvpawardprogram/archive/2015/06/11/writing-windows-10-app-services-in-javascript.aspx\">http://blogs.msdn.com/b/mvpawardprogram/archive/2015/06/11/writing-windows-10-app-services-in-javascript.aspx</a></p></li>\n<li><p>This is a little hacky: I'm not sure if this still works but it did work for Windows 8.1: You could create a so called \"Brokered Component\". This allows you to trigger everything from you app on you machine, but you won't be able to publish a brokered component into the store. This also allowed Process.Start() on Windows 8.1.  It only worked for sideloaded apps. I'm not sure if it still works on Windows 10. \nMore info here: <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/dn630195.aspx\">https://msdn.microsoft.com/en-us/library/windows/apps/dn630195.aspx</a></p></li>\n</ol>\n\n<p>Summary: \nStarting another app is pretty easy as long as the target app registered as app service or registered a protocol handler (Uri scheme). \nStarting scripts or other *.exe is impossible if option 4 doesn't work any longer.  </p>\n"}, {"comments": [{"owner": {"reputation": 474, "user_id": 5667488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HPT20.jpg?s=128&g=1", "display_name": "Sieg", "link": "https://stackoverflow.com/users/5667488/sieg"}, "edited": false, "score": 0, "creation_date": 1517514923, "post_id": 44006005, "comment_id": 84137910, "body": "But, if I use this, still I can publish my app in the Store?"}, {"owner": {"reputation": 12794, "user_id": 686985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE56D.jpg?s=128&g=1", "display_name": "Stefan Wick  MSFT", "link": "https://stackoverflow.com/users/686985/stefan-wick-msft"}, "reply_to_user": {"reputation": 474, "user_id": 5667488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HPT20.jpg?s=128&g=1", "display_name": "Sieg", "link": "https://stackoverflow.com/users/5667488/sieg"}, "edited": false, "score": 0, "creation_date": 1517515582, "post_id": 44006005, "comment_id": 84138319, "body": "Yes, in general you can. You will have to go through the Desktop App publishing process, which will include an onboarding review of your app, since it has the fulltrust capability. You can get that process started here: <a href=\"https://developer.microsoft.com/en-us/windows/projects/campaigns/desktop-bridge\" rel=\"nofollow noreferrer\">developer.microsoft.com/en-us/windows/projects/campaigns/&hellip;</a>"}], "tags": [], "owner": {"reputation": 12794, "user_id": 686985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nE56D.jpg?s=128&g=1", "display_name": "Stefan Wick  MSFT", "link": "https://stackoverflow.com/users/686985/stefan-wick-msft"}, "is_accepted": false, "score": 15, "last_activity_date": 1494949553, "creation_date": 1494949553, "answer_id": 44006005, "question_id": 33925096, "link": "https://stackoverflow.com/questions/33925096/how-to-execute-process-commands-or-similar-using-a-universal-windows-platform/44006005#44006005", "title": "How to execute Process commands (or similar) using a Universal Windows Platform (UWP) App?", "body": "<p>With the Windows 10 Anniversary Update (1607) there is an option to enable this scenario on PC. With this API in the Desktop Extension SDK you can launch a fulltrust process that runs at the full user privileges:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/uwp/api/Windows.ApplicationModel.FullTrustProcessLauncher\" rel=\"noreferrer\">https://docs.microsoft.com/en-us/uwp/api/Windows.ApplicationModel.FullTrustProcessLauncher</a></p>\n\n<p>This way you can light it up on the platforms where it is supported, i.e. PCs running 1607 or above. And your app will still be universal:</p>\n\n<pre><code>if (ApiInformation.IsApiContractPresent(\"Windows.ApplicationModel.FullTrustAppContract\", 1, 0))\n{\n    await FullTrustProcessLauncher.LaunchFullTrustProcessForCurrentAppAsync();\n}\n</code></pre>\n"}], "owner": {"reputation": 13042, "user_id": 2374028, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/nJ7ED.png?s=128&g=1", "display_name": "Charles Clayton", "link": "https://stackoverflow.com/users/2374028/charles-clayton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17914, "favorite_count": 13, "answer_count": 2, "score": 31, "last_activity_date": 1549682326, "creation_date": 1448480376, "last_edit_date": 1549682326, "question_id": 33925096, "link": "https://stackoverflow.com/questions/33925096/how-to-execute-process-commands-or-similar-using-a-universal-windows-platform", "title": "How to execute Process commands (or similar) using a Universal Windows Platform (UWP) App?", "body": "<p>I'm working on creating custom Cortana commands. The commands are registered and executed using a Universal Windows Platform Application. <a href=\"https://github.com/crclayton/custom-cortana-commands-template\">(GitHub)</a></p>\n\n<p>For instance, I've registered the following command</p>\n\n<pre><code>&lt;Command Name=\"ShutDown\"&gt;      \n  &lt;ListenFor&gt;Shut down&lt;/ListenFor&gt;\n  &lt;Navigate/&gt;    \n&lt;/Command&gt;\n</code></pre>\n\n<p>To run this function in a UWP application</p>\n\n<pre><code>static async void ShutDown()\n{\n    var dialog = new MessageDialog(\"This is where I would shut the computer down.\");\n    await dialog.ShowAsync();\n    //System.Diagnostics.Process.Start(\"Shutdown\", \"-s -t 10\");\n}\n</code></pre>\n\n<p>But after setting this up I learned <code>System.Diagnostics.Process</code> isn't supported in UWP. </p>\n\n<p>The custom commands I want to run involve some sort of execution such as launching external programs, running other scripts, or opening websites. </p>\n\n<p>It makes sense that UWP doesn't support them given that it's universal and an XBox or a phone might not be able to do these, but I was hoping there was some alternative or hacky way to accomplish this on a Windows 10 PC.</p>\n\n<p>Is there a way for me to execute <code>Process</code> commands or something else with similar functionality in a UWP application? It seems like even though I can get Cortana to execute my C# code, UWP doesn't support much that would be useful in this situation.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "signalr", "portable-class-library", "webproxy"], "owner": {"reputation": 63, "user_id": 5605747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8503718551a402aa8b12af87ae4347bc?s=128&d=identicon&r=PG&f=1", "display_name": "ccgre", "link": "https://stackoverflow.com/users/5605747/ccgre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1448531552, "creation_date": 1448480364, "last_edit_date": 1448531552, "question_id": 33925092, "link": "https://stackoverflow.com/questions/33925092/signalr-behind-web-proxy-for-portable-class-library", "title": "SignalR behind web proxy for portable class library", "body": "<p>I am developing a PCL Library that will be used for Xamarin/iOS to access a SignalR backend. Everything worked fine, until I tried to run the app behind a web proxy, which resulted in \"Connection refused\" exceptions.</p>\n\n<p>Normally, SignalR client libraries allow me to specify the Web Proxy using <code>HubConnection.Proxy</code>, however the Portable version lacks this property.</p>\n\n<p>What is the correct way to specify the web proxy for the hubConnection, so that it can connect properly?</p>\n"}, {"tags": ["c#", "sql-server"], "comments": [{"owner": {"reputation": 12155, "user_id": 35142, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b935a7d95c904243e5bc325587927fe9?s=128&d=identicon&r=PG", "display_name": "Bob Kaufman", "link": "https://stackoverflow.com/users/35142/bob-kaufman"}, "edited": false, "score": 2, "creation_date": 1448480150, "post_id": 33924964, "comment_id": 55610959, "body": "Welcome to StackOverflow! We&#39;re glad you&#39;re here. This is not a good question for our site. Have a look at <a href=\"http://stackoverflow.com/help/how-to-ask\">this page</a> that will give you an idea of the kind of questions that are asked here. A big problem with your question is that it hinges on an external link that may or may not be there in the future. Also, you don&#39;t show us any of your code. If you can copy and paste the relevant piece of your code into your question, rather than asking us to watch a video, you will likely get better answers."}, {"owner": {"reputation": 1, "user_id": 5605740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87238ff7d7c2a90f0380d392ea9753fc?s=128&d=identicon&r=PG&f=1", "display_name": "Umy99", "link": "https://stackoverflow.com/users/5605740/umy99"}, "edited": false, "score": 1, "creation_date": 1448480673, "post_id": 33924964, "comment_id": 55611248, "body": "Hi guys, Thanks for the replys i am having the exact same problems as this guy.   <a href=\"http://stackoverflow.com/questions/30148583/c-sharp-login-page-sql-server-sda-filldt-error\" title=\"c sharp login page sql server sda filldt error\">stackoverflow.com/questions/30148583/&hellip;</a>  I cant add images because my score is too low at the moment"}, {"owner": {"reputation": 1, "user_id": 5605740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87238ff7d7c2a90f0380d392ea9753fc?s=128&d=identicon&r=PG&f=1", "display_name": "Umy99", "link": "https://stackoverflow.com/users/5605740/umy99"}, "edited": false, "score": 0, "creation_date": 1448480741, "post_id": 33924964, "comment_id": 55611286, "body": "Please open the link the images are on there but no solutions, i really need help. Hope you can help"}, {"owner": {"reputation": 172, "user_id": 1532687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb1a186ce452e192de0dc13b040949c3?s=128&d=identicon&r=PG", "display_name": "Robert Conley", "link": "https://stackoverflow.com/users/1532687/robert-conley"}, "edited": false, "score": 0, "creation_date": 1448481376, "post_id": 33924964, "comment_id": 55611576, "body": "Please post the code that populates your adapter, also please copy and paste the text shown in your exception."}, {"owner": {"reputation": 1, "user_id": 5605740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87238ff7d7c2a90f0380d392ea9753fc?s=128&d=identicon&r=PG&f=1", "display_name": "Umy99", "link": "https://stackoverflow.com/users/5605740/umy99"}, "edited": false, "score": 0, "creation_date": 1448481493, "post_id": 33924964, "comment_id": 55611635, "body": "private void button2_Click(object sender, EventArgs e)         {               SqlConnection con = new SqlConnection(@&quot;Data Source=(LocalDB)\\v11.0;AttachDbFilename=C:\\Users\\Ergo\\Docume&zwnj;&#8203;nts\\Data.mdf;Integra&zwnj;&#8203;ted Security=True;Connect Timeout=30&quot;);             SqlDataAdapter sda = new SqlDataAdapter(&quot;Select Count(*) From Table where USERNAME =&#39;&quot; + textBox1.Text + &quot;&#39; and PASSWORD =&#39;&quot; + textBox2.Text + &quot;&#39;&quot;, con);             DataTable dt = new DataTable();             sda.Fill(dt);             if (dt.Rows[0][0].ToString() == &quot;1&quot;)"}, {"owner": {"reputation": 1, "user_id": 5605740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87238ff7d7c2a90f0380d392ea9753fc?s=128&d=identicon&r=PG&f=1", "display_name": "Umy99", "link": "https://stackoverflow.com/users/5605740/umy99"}, "edited": false, "score": 0, "creation_date": 1448481506, "post_id": 33924964, "comment_id": 55611640, "body": "{                   this.Hide();                  Main ss = new Main();                 ss.Show();             }             else             {                 MessageBox.Show(&quot;Please Check Username and Password&quot;);             }         }"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 1, "creation_date": 1448487693, "post_id": 33924964, "comment_id": 55614727, "body": "Please don&#39;t post your code into the comments; edit your question and add the code there. That way you can format the code so that it is readable. Code in comments is not nice to look at."}], "owner": {"reputation": 1, "user_id": 5605740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87238ff7d7c2a90f0380d392ea9753fc?s=128&d=identicon&r=PG&f=1", "display_name": "Umy99", "link": "https://stackoverflow.com/users/5605740/umy99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448479949, "creation_date": 1448479908, "last_edit_date": 1448479949, "question_id": 33924964, "link": "https://stackoverflow.com/questions/33924964/create-login-window-in-c", "title": "Create Login Window in C#", "body": "<p>I was watching this video <a href=\"https://www.youtube.com/watch?v=tcmmCcMs8yU\" rel=\"nofollow\">https://www.youtube.com/watch?v=tcmmCcMs8yU</a> . It basically teaches me how to create my own login page using SQL Server.</p>\n\n<p>So after following exactly what he did, when I click the submit button I have an error highlighting sda.Fill(dt);. I am pretty new to SQL Server, please advise!</p>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 1726, "user_id": 2746390, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/CXw9P.jpg?s=128&g=1", "display_name": "George Lica", "link": "https://stackoverflow.com/users/2746390/george-lica"}, "edited": false, "score": 3, "creation_date": 1448479646, "post_id": 33924833, "comment_id": 55610703, "body": "You can use inheritance, just be aware that if your base form/s are generic then you will have issues in opening it in designer. To open a generic form in designer, you must do a trick, create an intermediate nongeneric class X that inherits from your generic form and after that, inherit every child form from X."}, {"owner": {"reputation": 19212, "user_id": 4275342, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/KnE9R.png?s=128&g=1", "display_name": "Roman Marusyk", "link": "https://stackoverflow.com/users/4275342/roman-marusyk"}, "edited": false, "score": 0, "creation_date": 1448479677, "post_id": 33924833, "comment_id": 55610723, "body": "<code>public class BaseForm : System.Windows.Forms.Form</code>"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1448480048, "post_id": 33924833, "comment_id": 55610914, "body": "Project &gt; Add New Item &gt; Windows Forms &gt; Inherited Form.  Click around some more, this is supposed to be discoverable."}], "answers": [{"tags": [], "owner": {"reputation": 10227, "user_id": 1244816, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/HHnBj.jpg?s=128&g=1", "display_name": "Jens Kloster", "link": "https://stackoverflow.com/users/1244816/jens-kloster"}, "is_accepted": false, "score": 2, "last_activity_date": 1448479890, "creation_date": 1448479890, "answer_id": 33924961, "question_id": 33924833, "link": "https://stackoverflow.com/questions/33924833/extending-a-form-in-c/33924961#33924961", "title": "Extending a Form in C#", "body": "<p>Yes.</p>\n\n<p>Make a base form - that is a form like any other.</p>\n\n<pre><code>public class MyBaseForm : Form\n</code></pre>\n\n<p>Modify that form so that it looks like the templets you want.</p>\n\n<p>Now all you have to do, is to make the rest of your forms inherit the templeform you just created.</p>\n\n<pre><code>public class MyForm1 : MyBaseForm\n</code></pre>\n\n<p>Easy :-)</p>\n"}, {"tags": [], "owner": {"reputation": 23885, "user_id": 20382, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/cf2d51b76b8f3d77a12fa4c945096fb2?s=128&d=identicon&r=PG", "display_name": "TcKs", "link": "https://stackoverflow.com/users/20382/tcks"}, "is_accepted": false, "score": 5, "last_activity_date": 1448480497, "creation_date": 1448480497, "answer_id": 33925122, "question_id": 33924833, "link": "https://stackoverflow.com/questions/33924833/extending-a-form-in-c/33925122#33925122", "title": "Extending a Form in C#", "body": "<p>Be careful with inheritance in combination with visual studio designer.\nIf you are not \"friend\" with all the designer-related attributes (<code>BrowsableAttribute</code>, <code>DefaultValueAttribute</code>, ...) and support members (such as <code>MyProperty</code>, <code>ShouldSerializeMyProperty()</code>, <code>ResetMyProperty()</code>), the attempt to reuse code and safe time can cause headache.</p>\n\n<p>If you can, use composition instead of inheritance.\nI have good experience with designing the form in designer and create panels for \"content\" controls.</p>\n\n<p>And the content controls can inherit from \"usercontrol\", co you can design them in visual studio designer too.</p>\n\n<p>After that, you can just combine any predesigned form with any predesigned control.</p>\n\n<p>The simple example of case you described:</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Form with \"skeleton\" common for your application.\n/// &lt;/summary&gt;\npublic partial class FormWithPicture : Form {\n    private Control content;\n    /// &lt;summary&gt;\n    /// The control which should be used as \"main\" content of this form.\n    /// &lt;/summary&gt;\n    public Control Content {\n        get { return this.content; }\n        set {\n            this.content = value;\n            // the \"panel1\" is the container of the content\n            this.panel1.Controls.Clear();\n            if (null != value) {\n                this.panel1.Controls.Add(value);\n            }\n        }\n    }\n\n    public FormWithPicture() {\n        InitializeComponent();\n    }\n}\n\n// somewhere else\nnew FormWithPicture {\n    Content = new ContentControl_A()\n}.Show();\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5601665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/016738de268384afff7768ffa3bccd18?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey W", "link": "https://stackoverflow.com/users/5601665/jeffrey-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3751, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1448480497, "creation_date": 1448479413, "last_edit_date": 1448479559, "question_id": 33924833, "link": "https://stackoverflow.com/questions/33924833/extending-a-form-in-c", "title": "Extending a Form in C#", "body": "<p>For my application I need several forms. These forms all need to have a certain picture and need to have a white background color. </p>\n\n<p>Instead of creating a standard Form in VisualStudio and editing each one of the individualy to have these specifications, is there a way to make my own Form that I can use each time? By extending it perhaps?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c#", "wpf", "database", "xaml", "datacontext"], "comments": [{"owner": {"reputation": 880, "user_id": 1979354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6682211859f2139212f77c3dee07a9cb?s=128&d=identicon&r=PG", "display_name": "Spawn", "link": "https://stackoverflow.com/users/1979354/spawn"}, "edited": false, "score": 1, "creation_date": 1448480053, "post_id": 33924821, "comment_id": 55610915, "body": "Open connection, retrieve data, close connection.... What&#39;s problem? :) As for me, not so good to do it in constructor."}, {"owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "reply_to_user": {"reputation": 880, "user_id": 1979354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6682211859f2139212f77c3dee07a9cb?s=128&d=identicon&r=PG", "display_name": "Spawn", "link": "https://stackoverflow.com/users/1979354/spawn"}, "edited": false, "score": 0, "creation_date": 1448480155, "post_id": 33924821, "comment_id": 55610962, "body": "the &quot;retrieve data&quot; bit in the middle :P I&#39;m useless with db connections"}, {"owner": {"reputation": 307, "user_id": 1319406, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cwHgB.jpg?s=128&g=1", "display_name": "Danielle", "link": "https://stackoverflow.com/users/1319406/danielle"}, "edited": false, "score": 0, "creation_date": 1448481154, "post_id": 33924821, "comment_id": 55611490, "body": "That sort of depends on how you are connecting. Do you have a custom database wrapper of sorts that has methods to handle this for you? Or are you planning on using raw IDbCommands? You can use your connection to .CreateCommand() with CommandType = Text, CommandText = SQL which returns a reader."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5058256, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_-QW6FbmzSg/AAAAAAAAAAI/AAAAAAAAAXs/FHGEjaz38Zg/photo.jpg?sz=128", "display_name": "Natalia Stovbun", "link": "https://stackoverflow.com/users/5058256/natalia-stovbun"}, "is_accepted": false, "score": 0, "last_activity_date": 1448531780, "last_edit_date": 1448531780, "creation_date": 1448531015, "answer_id": 33935201, "question_id": 33924821, "link": "https://stackoverflow.com/questions/33924821/converting-from-normal-list-data-to-a-database-in-wpf-xaml/33935201#33935201", "title": "Converting from normal list data to a database in wpf xaml", "body": "<p>If I understand you correctly, the EntityFramework should help you work with the DB. You need to install the NuGet using the EntityFramework. (More info: <a href=\"https://msdn.microsoft.com/en-us/data/jj574514.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/data/jj574514.aspx</a> , <a href=\"http://metanit.com/sharp/entityframework/3.3.php\" rel=\"nofollow\">http://metanit.com/sharp/entityframework/3.3.php</a>)</p>\n\n<p>app.config</p>\n\n<pre><code> &lt;configSections&gt;\n    &lt;entityFramework&gt;\n       &lt;defaultConnectionFactory type=\"System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework\" /&gt;\n      &lt;providers&gt;\n          &lt;provider invariantName=\"System.Data.SqlClient\" type=\"System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer\" /&gt;\n      &lt;/providers&gt;\n    &lt;/entityFramework&gt;\n    &lt;connectionStrings&gt;\n         &lt;add name=\"DictionaryPlus\" connectionString=\"Data Source=(localdb)\\v11.0;Initial Catalog=DataBaseName;\"\n    providerName=\"System.Data.SqlClient\"/&gt;\n    &lt;/connectionStrings&gt;\n &lt;/configuration&gt;\n</code></pre>\n\n<p>xaml.cs file</p>\n\n<pre><code>public partial class MainWindow : Window\n{\n    Db_Context db = null;\n\n    public MainWindow()\n    { db = new Db_Context(); }\n\n    private async void Window_Loaded(object sender, RoutedEventArgs e)\n    {\n\n        await db.Users.LoadAsync();\n\n        /* Data usage */\n\n        /* Binding */\n\n        CollectionViewSource userViewSource = ((CollectionViewSource)(this.FindResource(\"userViewSource\")));\n        userViewSource.Source = db.Users.Local;\n\n        /* Add data */\n\n        db.Users.Add(new User());\n        await db.SaveChangesAsync();\n\n        this.list_Users.Items.Refresh();\n\n    } \n}\n\npublic class Db_Context : DbContext\n{\n    public Db_Context() : base(\"DataBaseName\") { }\n    public DbSet&lt;User&gt; Users { get; set; }\n}\n</code></pre>\n\n<p>xaml file</p>\n\n<pre><code> &lt;Window.Resources&gt;\n      &lt;CollectionViewSource x:Key=\"userViewSource\" d:DesignSource=\"{d:DesignInstance {x:Type Model:User}, CreateList=True}\"/&gt;\n &lt;/Window.Resources&gt;\n\n &lt;ListBox x:Name=\"list_Users\" DisplayMemberPath=\"Name\" ItemsSource=\"{Binding Source={StaticResource userViewSource}}\" SelectedValuePath=\"Id\" Focusable=\"False\"/&gt;\n</code></pre>\n"}], "owner": {"reputation": 840, "user_id": 2463166, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/u5iip.png?s=128&g=1", "display_name": "Badja", "link": "https://stackoverflow.com/users/2463166/badja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448531780, "creation_date": 1448479385, "question_id": 33924821, "link": "https://stackoverflow.com/questions/33924821/converting-from-normal-list-data-to-a-database-in-wpf-xaml", "title": "Converting from normal list data to a database in wpf xaml", "body": "<p>So I have been trying to fix many errors in my system for a while and I'm pretty close to being done. One of these errors resulted in me creating a simple list that is the equivalent of my database fields. As we all know, this is is stupid for a lot of data - and now I've finished with test data, it's time to implement a database connection.</p>\n\n<p>So below are the code files that I am using and descriptions with them:</p>\n\n<p><code>DBDisplayViewModel.cs</code></p>\n\n<pre><code>public class DBDisplayViewModel\n{\n    public ICollectionView Users { get; private set; }\n\n    /// &lt;summary&gt;\n    /// To pull the database\n    /// &lt;/summary&gt;\n    private static string connectionString = Properties.Settings.Default.DBUsers;\n    public DBDisplayViewModel()\n    {\n        //TODO Database connection\n\n         #Region old code\n     var _users = new List&lt;User&gt;\n                             {\n                                 new User\n                                     {\n                                         ID = \"IDTest\",\n                                         FirstName = \"FNTest\",\n                                         LastName = \"LNTest\",\n                                     },\n        #endregion\n\n\n        Users = CollectionViewSource.GetDefaultView(_users);\n    }\n\n}\n</code></pre>\n\n<p><code>Users.cs</code></p>\n\n<pre><code>    public class Patients : INotifyPropertyChanged\n{\n    private string _id;\n    private string _firstName;\n    private string _lastName;\n\n    /// &lt;summary&gt;\n    /// Define ID\n    /// &lt;/summary&gt;\n    public string ID\n    {\n        get { return _id; }\n        set\n        {\n            _id = value;\n            NotifyPropertyChanged(\"ID\");\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Define First Name\n    /// &lt;/summary&gt;\n    public string FirstName\n    {\n        get { return _firstName; }\n        set\n        {\n            _firstName = value;\n            NotifyPropertyChanged(\"FirstName\");\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Define Last Name\n    /// &lt;/summary&gt;\n    public string LastName\n    {\n        get { return _lastName; }\n        set\n        {\n            _lastName = value;\n            NotifyPropertyChanged(\"LastName\");\n        }\n    }\n\n\n\n    /// &lt;summary&gt;\n    /// INotifyPropertyChanged Members\n    /// &lt;/summary&gt;\n    public event PropertyChangedEventHandler PropertyChanged;\n\n\n    /// &lt;summary&gt;\n    /// Private Helpers\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"propertyName\"&gt;&lt;/param&gt;\n    private void NotifyPropertyChanged(string propertyName)\n    {\n        if (PropertyChanged != null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n        }\n    }\n\n}\n</code></pre>\n\n<p><code>DBDisplay.xaml</code> simply has a binding (that needs to connect to the DB)</p>\n\n<pre><code>&lt;DataGrid ItemsSource=\"{Binding Users}\"\n</code></pre>\n\n<p><code>DBDisplay.xaml.cs</code> simply has the ViewModel in</p>\n\n<pre><code> public DBDisplay()\n    {\n        InitializeComponent();\n        // Pull in the ViewModel\n        DataContext = new DBDisplayViewModel();\n    }\n</code></pre>\n\n<p>So from what I can see, in the View Model, where the <code>#Region</code> is, I need to connect to my (preexisting) database, <code>DBUsers</code></p>\n\n<p>Can someone break down the way to do this, and if I'm doing anything wrong? Thank you ever so much</p>\n"}, {"tags": ["c#", "pdf", "printing"], "comments": [{"owner": {"reputation": 2864, "user_id": 3862022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f9d6e3b856773850723ee04f364564?s=128&d=identicon&r=PG&f=1", "display_name": "csenga", "link": "https://stackoverflow.com/users/3862022/csenga"}, "edited": false, "score": 0, "creation_date": 1448479373, "post_id": 33924774, "comment_id": 55610572, "body": "<a href=\"http://stackoverflow.com/questions/18704839/send-text-file-directly-to-network-printer\" title=\"send text file directly to network printer\">stackoverflow.com/questions/18704839/&hellip;</a>"}, {"owner": {"reputation": 63, "user_id": 2133424, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fc0113881df199edacb844d6ed4155f4?s=128&d=identicon&r=PG", "display_name": "Spades", "link": "https://stackoverflow.com/users/2133424/spades"}, "reply_to_user": {"reputation": 2864, "user_id": 3862022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9f9d6e3b856773850723ee04f364564?s=128&d=identicon&r=PG&f=1", "display_name": "csenga", "link": "https://stackoverflow.com/users/3862022/csenga"}, "edited": false, "score": 0, "creation_date": 1448479974, "post_id": 33924774, "comment_id": 55610878, "body": "When I reference it by name it says: &quot;The network name cannot be found. Yet it populates the combo box printer list without issue. <i>IF</i> I use &quot;\\\\ServerName\\prt0001&quot; it works.  But I need to reference it by the name the OS provides."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 630298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ec4a7dbd16e629aa1bef6dbf1cf849?s=128&d=identicon&r=PG", "display_name": "Anand", "link": "https://stackoverflow.com/users/630298/anand"}, "is_accepted": true, "score": 1, "last_activity_date": 1496847591, "creation_date": 1496847591, "answer_id": 44416250, "question_id": 33924774, "link": "https://stackoverflow.com/questions/33924774/using-file-copy-to-send-pdf-to-printer-by-printer-name/44416250#44416250", "title": "Using File.Copy to send PDF to Printer by Printer Name", "body": "<p>Use one of the printer names that comes out of the printer classes.</p>\n\n<pre><code>foreach (String printer in System.Drawing.Printing.PrinterSettings.InstalledPrinters)\n{\n     textBox1.Text += printer.ToString() + System.Environment.NewLine;\n }\n</code></pre>\n\n<p>See all the printers that are listed in this text box, copy and paste the printer name in the file.copy method.</p>\n\n<pre><code>File.Copy(FileInfo.FullName, **Printer name here**, true);\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 2133424, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fc0113881df199edacb844d6ed4155f4?s=128&d=identicon&r=PG", "display_name": "Spades", "link": "https://stackoverflow.com/users/2133424/spades"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2999, "favorite_count": 1, "accepted_answer_id": 44416250, "answer_count": 1, "score": 1, "last_activity_date": 1513692467, "creation_date": 1448479160, "last_edit_date": 1513692467, "question_id": 33924774, "link": "https://stackoverflow.com/questions/33924774/using-file-copy-to-send-pdf-to-printer-by-printer-name", "title": "Using File.Copy to send PDF to Printer by Printer Name", "body": "<p>I am trying to send an PDF file to a printer using the <code>File.Copy</code> method in C#.  When I reference the printer by name however, it always responds with </p>\n\n<blockquote>\n  <p>'Could not find a part of the path'</p>\n</blockquote>\n\n<p>The printer name is fully qualified.  The user is selecting from a combo box that displays all the systems printers using the <code>PrinterSettings.InstalledPrinters</code> values.</p>\n\n<p>Am I missing something simple? </p>\n\n<p>Example:</p>\n\n<pre><code>File.Copy(FileInfo.FullName, \"\\\\\\\\ServerName\\\\PrinterName\", true);\n</code></pre>\n\n<p>The <code>\"\\\\\\\\ServerName\\\\PrinterName\"</code> is directly one of the names from <code>PrinterSettings.InstalledPrinters</code> collection.</p>\n"}, {"tags": ["c#", "arrays", "string", "printing", "console"], "answers": [{"tags": [], "owner": {"reputation": 196, "user_id": 5290040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5355b11e0793999c0436608a587c3b20?s=128&d=identicon&r=PG&f=1", "display_name": "sschimmel", "link": "https://stackoverflow.com/users/5290040/sschimmel"}, "is_accepted": false, "score": 1, "last_activity_date": 1448479480, "creation_date": 1448479480, "answer_id": 33924851, "question_id": 33924725, "link": "https://stackoverflow.com/questions/33924725/c-how-to-print-string-array-in-the-console/33924851#33924851", "title": "c# how to print string array in the console?", "body": "<pre><code>Console.WriteLine(\"The day after {1}/{4}/{2} is {3}\", d, m, y, md.NextDay1())\n</code></pre>\n\n<p>Your arguments here should range from 0-3, not 1-4.</p>\n\n<p>You might find it easier to parse your input into a DateTime, which could then easily be output in a variety of formats -- and you could find the next day simply by calling .AddDays(1).</p>\n"}, {"tags": [], "owner": {"reputation": 477, "user_id": 4354379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20051ef7f0df71bdc8f506a148937ae?s=128&d=identicon&r=PG", "display_name": "berserck", "link": "https://stackoverflow.com/users/4354379/berserck"}, "is_accepted": false, "score": 0, "last_activity_date": 1448479753, "creation_date": 1448479753, "answer_id": 33924931, "question_id": 33924725, "link": "https://stackoverflow.com/questions/33924725/c-how-to-print-string-array-in-the-console/33924931#33924931", "title": "c# how to print string array in the console?", "body": "<p>See this example to format the date:</p>\n\n<pre><code>DateTime time = DateTime.Now;             // Use current time.\nstring format = \"MMM ddd d HH:mm yyyy\";   // Use this format.\nConsole.WriteLine(time.ToString(format)); // Write to console.\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>Feb Fri 27 11:41 2009\n</code></pre>\n\n<p>Source is <a href=\"http://www.dotnetperls.com/datetime-format\" rel=\"nofollow\">http://www.dotnetperls.com/datetime-format</a></p>\n"}], "owner": {"reputation": 5, "user_id": 5605247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5810126997b82835ec7a691a6b8ac34f?s=128&d=identicon&r=PG&f=1", "display_name": "I.Ali", "link": "https://stackoverflow.com/users/5605247/i-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1448479753, "creation_date": 1448478991, "last_edit_date": 1448479218, "question_id": 33924725, "link": "https://stackoverflow.com/questions/33924725/c-how-to-print-string-array-in-the-console", "title": "c# how to print string array in the console?", "body": "<p>The bold text is where i need to change something but not sure what. I want the console to display the month as a string e.g 'Jul' 'Aug'...\nbasically my coding for case 1 displays = 1/1/2001\nand case 3 i want it to display = 1/Jan/2001</p>\n\n<pre><code>static void Main(string[] args)\n{\n\n    do\n    {\n        Console.WriteLine(\"Please select a date format by entering either the 1, 2 or 3 Key\");\n        Console.WriteLine(\" 1 = dd/mm/yyyy \");\n        Console.WriteLine(\" 2 = mm/dd/yyyy \");\n        Console.WriteLine(\" 3 = dd/mmm/yyyy \");\n    } while (!int.TryParse(Console.ReadLine(), out f) || f &lt; 0 || f&gt;3);\n\n    switch(f)\n    {\n        case 1:\n            getDate1();\n            Console.WriteLine(\"The day after {0}/{1}/{2} is {3}\", d, m, y, md.NextDay1());\n            break;\n        case 2:\n            getAmericanDate();\n            Console.WriteLine(\"The day after {1}/{0}/{2} is {3}\", d, m, y, md.NextDay1());\n            break;\n        **case 3:\n            getAbbreviatedMonth();\n            Console.WriteLine(\"The day after {1}/{4}/{2} is {3}\", d, m, y, md.NextDay1());\n            break;**\n\n    }\n\n\nstatic void getAbbreviatedMonth() //dd/mmm/yyyy\n{\n\n    do\n    {\n        Console.Write(\"PLease enter the year (not earlier than 1812) as 4 digits  &gt;&gt; \");\n    } while (!int.TryParse(Console.ReadLine(), out y) || y &lt; 1812);\n\n\n    do\n    {\n        Console.Write(\"Please enter the month as a three letter character ( e.g 'Jul')   &gt;&gt; \");\n    } while (isCorrectMonth(Console.ReadLine()));\n\n\n    do\n    {\n\n        Console.Write(\"Please enter the day as a whole between 1 &amp; {0} &gt;&gt; \", DayInMonth(m, y));\n    } while (!int.TryParse(Console.ReadLine(), out d) || d &gt; DayInMonth(m, y) || d &lt; 1);\n\n\n\n    md = new myDate(d, m, y);\n}\n\n\nstatic bool isCorrectMonth(string monthToCheck)\n{\n    string stringToCheck = monthToCheck.ToLower();\n    string[] stringArray = { \"jan\", \"feb\", \"mar\", \"apr\", \"may\", \"jun\", \"jul\", \"aug\", \"sep\", \"oct\", \"nov\", \"dec\" };\n    foreach (string x in stringArray)\n    {\n        if (x.Contains(stringToCheck))\n        {\n            // Process..\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n    }\n    return false;\n}\n</code></pre>\n"}, {"tags": ["c#", "excel", "oledbdataadapter"], "comments": [{"owner": {"reputation": 28426, "user_id": 66849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be5a20b7fb7b8c8be281a747ac4fa05d?s=128&d=identicon&r=PG", "display_name": "PHeiberg", "link": "https://stackoverflow.com/users/66849/pheiberg"}, "edited": false, "score": 0, "creation_date": 1448484622, "post_id": 33924724, "comment_id": 55613211, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/3232281/oledb-mixed-excel-datatypes-missing-data\">OleDB &amp; mixed Excel datatypes : missing data</a>"}], "owner": {"reputation": 576, "user_id": 3666516, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/TKxPR.jpg?s=128&g=1", "display_name": "Lord Null", "link": "https://stackoverflow.com/users/3666516/lord-null"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1448479401, "creation_date": 1448478990, "last_edit_date": 1448479401, "question_id": 33924724, "link": "https://stackoverflow.com/questions/33924724/data-source-with-differing-data-types", "title": "Data source with differing data types", "body": "<p>I am reading data from an Excel document using OleDbDataAdapter.Fill method. I understand this reads the data into a DataTable.  </p>\n\n<p>How do we handle the situation where the data in an Excel column might have differing data types?</p>\n\n<p>For example, if the data in an Excel column looks like this:</p>\n\n<pre><code>100\n200\nSome text\n300\n</code></pre>\n\n<p>When the data is being read in the DataTable column (that is being loaded with the data) will be typed as double (since the first value in the column is a number). When it gets to the 3rd value (\"Some text\") instead of adding this text to the DataTable it adds a null (or empty string) instead.</p>\n\n<p>The problem is I'd like to know what the values were in the Excel file column after it has been read in.  </p>\n\n<p>How do we capture the \"Some text\" text if the column has been typed as double and the text is then ignored?</p>\n"}, {"tags": ["c#", "twilio", "mms"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1448478886, "post_id": 33924629, "comment_id": 55610312, "body": "I got a similar error when using Google Voice on a different provider, although it worked on Twilio."}, {"owner": {"reputation": 441, "user_id": 1495304, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6d13504893c105e72584a2fcc8d8d841?s=128&d=identicon&r=PG", "display_name": "Pipe2Path", "link": "https://stackoverflow.com/users/1495304/pipe2path"}, "reply_to_user": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1448480996, "post_id": 33924629, "comment_id": 55611407, "body": "The error message actually reads this: &quot;The &#39;To&#39; phone number: &lt;toPhone&gt;, is not currently reachable using the &#39;From&#39; phone number: &lt;fromPhone&gt; via MMS.&quot;. So this could be an issue with either number?"}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "edited": false, "score": 0, "creation_date": 1448483433, "post_id": 33924629, "comment_id": 55612600, "body": "Does it work for other numbers? Or just this recipient?"}, {"owner": {"reputation": 53136, "user_id": 28376, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ec1383b240b5ba15ffb9743fceb3c0e?s=128&d=identicon&r=PG", "display_name": "philnash", "link": "https://stackoverflow.com/users/28376/philnash"}, "edited": false, "score": 0, "creation_date": 1448537475, "post_id": 33924629, "comment_id": 55634465, "body": "Twilio MMS only works from US and Canadian Twilio numbers right now. Are you sending from a number from either of those countries? It also only sends proper MMS messages to US/Canadian recipients, so are you sending to either of those countries? You can send MMS internationally (from a US/Canadian Twilio number), but the picture would get replaced with a short URL to the image file."}, {"owner": {"reputation": 441, "user_id": 1495304, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6d13504893c105e72584a2fcc8d8d841?s=128&d=identicon&r=PG", "display_name": "Pipe2Path", "link": "https://stackoverflow.com/users/1495304/pipe2path"}, "edited": false, "score": 0, "creation_date": 1448556128, "post_id": 33924629, "comment_id": 55646102, "body": "I tried using another number and get the same error. Both the numbers are here in the US."}], "owner": {"reputation": 441, "user_id": 1495304, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6d13504893c105e72584a2fcc8d8d841?s=128&d=identicon&r=PG", "display_name": "Pipe2Path", "link": "https://stackoverflow.com/users/1495304/pipe2path"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 817, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1448481429, "creation_date": 1448478660, "last_edit_date": 1448481429, "question_id": 33924629, "link": "https://stackoverflow.com/questions/33924629/twilio-rest-api-error-code-21612", "title": "Twilio rest api error code 21612", "body": "<p>When I attempt to send an image file using the Twilio.SendMessage Rest API call, I get the error : Code 21612 - The 'To' phone number is not currently reachable via SMS or MMS.</p>\n\n<p>Here is the code I use:</p>\n\n<pre><code>var message = twilio.SendMessage(fromPhone, phone, \"a message for you\", new string[] {\"http://website.com/images/folder/pic.jpg\"});\n</code></pre>\n\n<p>This phone number works fine for text messages. I checked with my carrier, and my plan includes \"picture Messaging\" as well. So I am questioning the validity of the error message. Is there something else I need to check or do to get this to work?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1448479172, "post_id": 33924627, "comment_id": 55610456, "body": "what <code>slist.Sort(rand.Next(10));</code> supposed to do? sort based on random number? and what would be the definition of sorting based on number?"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1448479257, "post_id": 33924627, "comment_id": 55610512, "body": "@M.kazemAkhgary it&#39;s quite obvious what the <code>OP</code> wants to do, the List&lt;T&gt; has some good extension methods one of them being <code>Sum()</code>"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448479426, "post_id": 33924627, "comment_id": 55610591, "body": "@Maler, what is this at the bottom of your code..?  <code>Class1 show = new Class1();  show.TotalSum(); show.Sort();</code> where in your class do you have <code>TotalSum or Sort()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2959, "user_id": 819153, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a691c06e10ba780802b6df69be781637?s=128&d=identicon&r=PG", "display_name": "Zinov", "link": "https://stackoverflow.com/users/819153/zinov"}, "is_accepted": false, "score": 2, "last_activity_date": 1448479707, "last_edit_date": 1448479707, "creation_date": 1448478874, "answer_id": 33924695, "question_id": 33924627, "link": "https://stackoverflow.com/questions/33924627/generate-list-with-random-numbers-sort-and-total-sum/33924695#33924695", "title": "Generate list with random numbers. Sort and total sum", "body": "<blockquote>\n  <p>just use the 2 methods</p>\n</blockquote>\n\n<pre><code>list.Sum(); \nlist.Sort();\n</code></pre>\n\n<p>I suggest that you use rand.Next(Environment.TickCount) to get better random numbers, but at the end you need to use a different primitive value to store the result</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        var array = Class1.Sort();\n        PrintArray(array);\n\n        Console.WriteLine();\n\n        Console.WriteLine(\"Total sum: {0}\", Class1.TotalSum());\n\n        Console.ReadLine();\n    }\n\n    static void PrintArray(List&lt;double&gt; array)\n    {\n        foreach (var a in array)\n            Console.WriteLine(a);\n    }\n}\n\npublic class Class1\n{\n\n    public static double TotalSum()\n    {\n        var rand = new Random();\n\n        var alist = new List&lt;double&gt;();\n        for (int i = 0; i &lt; 50; i++)\n        {\n            alist.Add(rand.Next(10));\n        }\n\n        return alist.Sum();\n    }\n\n    public static List&lt;double&gt; Sort()\n    {\n        var rand = new Random();\n\n        var slist = new List&lt;double&gt;();\n        for (int i = 0; i &lt; 50; i++)\n        {\n            slist.Add(rand.Next(10)); // rand.Next does not work with Sort\n        }\n\n        slist.Sort();\n\n        return slist;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "is_accepted": false, "score": 2, "last_activity_date": 1448481239, "last_edit_date": 1448481239, "creation_date": 1448480077, "answer_id": 33925016, "question_id": 33924627, "link": "https://stackoverflow.com/questions/33924627/generate-list-with-random-numbers-sort-and-total-sum/33925016#33925016", "title": "Generate list with random numbers. Sort and total sum", "body": "<p>I think I got what you mean. You want a class that holds random list of numbers and you need some functions.</p>\n\n<p>Its better to give more suitable name to your class. for example \"RandomList\" would be good.</p>\n\n<p>You can't use <code>Console.WriteLine(list)</code> to print items of list. You have to iterate through items and print them in the way you want.</p>\n\n<p>You can't use <code>var</code> to define fields. You have to write the type explicitly.</p>\n\n<p><code>static</code> keyword in other word is <code>one for all instances</code>. So if you dont use static it would be <code>one per instance</code>. Instance is just the object that you create with the constructor. Its better to declare random number generator as static, but other methods and list field should remain non static.</p>\n\n<p>With the use of Linq <code>Sum()</code> you can get the sum of all the items from list. If you dont want to use Linq then you have to iterate through list and add each item to value <code>sum</code>.</p>\n\n<p>I commented the code to explain things.</p>\n\n<pre><code>class Program\n{\n    static void Main(string[] args)\n    {\n        RandomList show = new RandomList(50, 10);\n        show.TotalSum();\n        show.Sort();\n    }\n}\nclass RandomList\n{\n    private static Random rand = new Random();\n\n    private List&lt;double&gt; _list; // this field holds your list\n\n    public RandomList(int length , int maxValuePerItem) // this is the constructor\n    {\n        _list = new List&lt;double&gt;(); \n\n        // populate list\n        for (int i = 0; i &lt; length; i++)\n        {\n            _list.Add(rand.Next(maxValuePerItem)); \n        }\n    }\n\n    public void TotalSum()\n    {\n        Console.WriteLine(\"Total sum: {0}\", _list.Sum()); // {0} is required to specify the place to put _list.Sum() inside string.\n\n\n        // without linq way\n        // int sum = 0;\n        // foreach(var i in _list) sum += i;\n    }\n\n    public void Sort()\n    {\n        _list.Sort();\n\n        foreach (var d in _list) \n        {\n            Console.Write(d + \" , \"); // you need to print this in the way you want.\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5605635, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5b5716d5987f5486f092555f5d105cac?s=128&d=identicon&r=PG&f=1", "display_name": "Maler", "link": "https://stackoverflow.com/users/5605635/maler"}, "edited": false, "score": 0, "creation_date": 1448560150, "post_id": 33925028, "comment_id": 55648130, "body": "Thanks for your help and clarification."}], "tags": [], "owner": {"reputation": 5012, "user_id": 3845456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEWf8.jpg?s=128&g=1", "display_name": "DrewJordan", "link": "https://stackoverflow.com/users/3845456/drewjordan"}, "is_accepted": false, "score": 0, "last_activity_date": 1448480132, "creation_date": 1448480132, "answer_id": 33925028, "question_id": 33924627, "link": "https://stackoverflow.com/questions/33924627/generate-list-with-random-numbers-sort-and-total-sum/33925028#33925028", "title": "Generate list with random numbers. Sort and total sum", "body": "<p>A constructor is typically used to initialize some values. In your case, you should use it to initialize your list, that is, to load it with 50 random numbers. We will also change it so that the list is a property of the class. </p>\n\n<p>Note that the methods shouldn't be static, since they are acting on a property of the class. We are also using the built-in methods of <code>List</code> (<code>Sum()</code> and <code>Sort()</code>) instead of rolling our own. </p>\n\n<pre><code>class Class1\n{\n    var rand = new Random();\n    var alist;\n\n    public Class1() // constructor creates a new list and initializes it\n    {\n        alist = new List&lt;double&gt;();\n        for (int i = 0; i &lt; 50; i++)\n        {\n            alist.Add(rand.Next(10)); \n        }\n    }\n\n\n    public List&lt;double&gt; TotalSum()\n    {\n        Console.WriteLine(\"Total sum:\", alist.Sum());\n    }\n\n    public List&lt;double&gt; Sort()\n    {\n        alist.Sort();   \n        for (double num in alist)\n        {\n            Console.WriteLine(num.ToString());\n        }\n\n    }\n\n\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Class1 show = new Class1();\n            show.TotalSum();\n            show.Sort();\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5605635, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5b5716d5987f5486f092555f5d105cac?s=128&d=identicon&r=PG&f=1", "display_name": "Maler", "link": "https://stackoverflow.com/users/5605635/maler"}, "edited": false, "score": 0, "creation_date": 1448559911, "post_id": 33925272, "comment_id": 55648022, "body": "Setter and getter - that is nice. Thanks for your help."}], "tags": [], "owner": {"reputation": 39660, "user_id": 3880585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8pfp3.png?s=128&g=1", "display_name": "gaetanoM", "link": "https://stackoverflow.com/users/3880585/gaetanom"}, "is_accepted": false, "score": 0, "last_activity_date": 1448481073, "creation_date": 1448481073, "answer_id": 33925272, "question_id": 33924627, "link": "https://stackoverflow.com/questions/33924627/generate-list-with-random-numbers-sort-and-total-sum/33925272#33925272", "title": "Generate list with random numbers. Sort and total sum", "body": "<p>Because you asked how to use the constructor I tried to rewrite your code in a way that the constructor do something of usefull. I added a property and a local variable plus another function.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>public class Class1\n    {\n        Random rand = new Random();\n        List&lt;double&gt; alist { get; set; }\n\n        public Class1(int howmany = 50)\n        {\n            alist = new List&lt;double&gt;();\n            for (var i = 0; i &lt; howmany; i++)\n            {\n                alist.Add(rand.NextDouble());\n            }\n        }\n\n        public void Sort()\n        {\n            alist.Sort();\n        }\n\n        public void printTotalSum()\n        {\n            Console.WriteLine(\"Total sum: {0}\", alist.Sum());\n        }\n\n        public void printList() {\n            Console.WriteLine(\"The list contains:\");\n            for (int i = 0; i &lt; alist.Count; i++)\n            {\n                Console.WriteLine(alist[i]);\n            }\n        }\n\n    }\n\n   class Program\n    {\n        static void Main(string[] args)\n        {\n\n            Class1 show = new Class1(10);\n            show.printTotalSum();\n            show.Sort();\n            show.printList();\n        }\n    }\n</code></pre>\n\n\n"}], "owner": {"reputation": 41, "user_id": 5605635, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5b5716d5987f5486f092555f5d105cac?s=128&d=identicon&r=PG&f=1", "display_name": "Maler", "link": "https://stackoverflow.com/users/5605635/maler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1719, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1448481239, "creation_date": 1448478640, "last_edit_date": 1448479084, "question_id": 33924627, "link": "https://stackoverflow.com/questions/33924627/generate-list-with-random-numbers-sort-and-total-sum", "title": "Generate list with random numbers. Sort and total sum", "body": "<p>I am new to programming and i would be delighted if someone could help me with the following problem.\nI have problem with two methods. \nFirst sum all of 50 random numbers in a list, second sort list with 50 random numbers.\nI know how to do this when a list has for example four numbers{1,2,3,8} , but not with 50 random numbers.</p>\n\n<p>It will be nice to use a constructor to this two methods, but I don't now how to do this.</p>\n\n<p>Any help would be much appreciated.</p>\n\n<pre><code>class Class1\n{\n  var rand = new Random();\n\n  public Class1( ) //  how to use a constructor ?\n\n\n    public static List&lt;double&gt; TotalSum()\n    {\n\n        var alist = new List&lt;double&gt;();\n        for (int i = 0; i &lt; 50; i++)\n        {\n            alist.Add(rand.Next(10));\n        }\n        Console.WriteLine(\"Total sum:\", alist);\n    }\n\n    public static List&lt;double&gt; Sort()\n    {\n        var slist = new List&lt;double&gt;();\n        for (int i = 0; i &lt; 50; i++)\n        {\n            slist.Sort(rand.Next(10));   // rand.Next does not work with Sort\n            Console.WriteLine(slist);\n        }\n    }\n\n\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            Class1 show = new Class1(); \n            show.TotalSum();\n            show.Sort();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "xaml", "windows-store-apps"], "comments": [{"owner": {"reputation": 51, "user_id": 5174783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f82ced5d853b97ade83d756da6bc8d93?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5174783/sam"}, "edited": false, "score": 0, "creation_date": 1448478702, "post_id": 33924602, "comment_id": 55610203, "body": "When I make an executable and run it on the Windows 8.1 pc it won&#39;t let me enter this page, but if I transfer the project to the Windows 8.1 pc and delete any line, then add it back in and make excutable with visual studio community 2015 it works."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5174783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f82ced5d853b97ade83d756da6bc8d93?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5174783/sam"}, "edited": false, "score": 0, "creation_date": 1448502520, "post_id": 33927081, "comment_id": 55619506, "body": "I would like to understand then when I&#39;ve made an executable it doesn&#39;t work on 8.1. Also, when I transfer the project to windows 8.1 and run it in visual studio community it will say the error stated above. Yet, if I delete any line within the code and and replace it, the program works without errors... Thank you for your response."}], "tags": [], "owner": {"reputation": 1356, "user_id": 4358137, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/bfsy9.jpg?s=128&g=1", "display_name": "Seth Kitchen", "link": "https://stackoverflow.com/users/4358137/seth-kitchen"}, "is_accepted": false, "score": 0, "last_activity_date": 1448488507, "creation_date": 1448488507, "answer_id": 33927081, "question_id": 33924602, "link": "https://stackoverflow.com/questions/33924602/windows-ui-xaml-markup-xamlparse-exception/33927081#33927081", "title": "&quot;Windows.UI.Xaml.Markup.XamlParse.Exception&quot;", "body": "<p>Once you make an executable, it will run the same on every computer (as long as it's the same architecture). You need not worry about it glitching out (at least with a compilation error like the one you're talking about).</p>\n\n<p>There is a difference between a compilation error and a runtime error. </p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5174783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f82ced5d853b97ade83d756da6bc8d93?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5174783/sam"}, "is_accepted": false, "score": 2, "last_activity_date": 1448525825, "creation_date": 1448525825, "answer_id": 33933540, "question_id": 33924602, "link": "https://stackoverflow.com/questions/33924602/windows-ui-xaml-markup-xamlparse-exception/33933540#33933540", "title": "&quot;Windows.UI.Xaml.Markup.XamlParse.Exception&quot;", "body": "<p>If anyone is having the problem above I have found a solution. I was editing a copy template of ListViewItem. Instead, one should go to the definition of listViewItemExpanded and copy that template. You then can make edits from there and it no longer throws exceptions when transferring an executable from windows 10 to windows 8.1.</p>\n"}], "owner": {"reputation": 51, "user_id": 5174783, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f82ced5d853b97ade83d756da6bc8d93?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/5174783/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1448525825, "creation_date": 1448478549, "question_id": 33924602, "link": "https://stackoverflow.com/questions/33924602/windows-ui-xaml-markup-xamlparse-exception", "title": "&quot;Windows.UI.Xaml.Markup.XamlParse.Exception&quot;", "body": "<p>WinRT information: Cannot deserialize XBF metadata property list as 'HorizontalContentAlignment' was not found in type 'null'.[Line: 0 Position: 0]</p>\n\n<p>No additional information.</p>\n\n<p>This error appears when I transfer my project from visual studio 2013 pro (Lenovo, Windows 10) to visual studio community 2015 (Dell, Windows 8.1). It occurs within the constructor item detail page.</p>\n\n<p>Debugging thus far: \nInner Exception: null, \"Text associated with this error code not be found\"</p>\n\n<p>If I delete my edited copy of ListViewItemStyle it gives no errors.</p>\n\n<p>If I add a copy of ListViewItemStyle without editing it, I still get an error.</p>\n\n<p>If I delete one line of code either in the xaml item page or xaml.cs item page and add it back in immediately, it gives no error.</p>\n\n<p>I have also tried adding the style to the listview instead of the listview items, still gives error.</p>\n\n<p>I am concerned with this because I don't want to release the app and have it glich out.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>&lt;Page\nx:Name=\"pageRoot\"    \nLoaded=\"Research_Loaded\"\nxmlns:xc=\"using:ColorPicker\"\nNavigationCacheMode=\"Disabled\"&gt;\n&lt;Page.Resources&gt;\n    &lt;SolidColorBrush x:Name=\"selectedColor\" Color=\"YellowGreen\"/&gt;\n    &lt;Style x:Key=\"ListViewItemStyle1\" TargetType=\"ListViewItem\"&gt;\n        &lt;Setter Property=\"FontFamily\" Value=\"{ThemeResource ContentControlThemeFontFamily}\"/&gt;\n        &lt;Setter Property=\"FontSize\" Value=\"20\"/&gt;\n        &lt;Setter Property=\"Background\" Value=\"Transparent\"/&gt;\n        &lt;Setter Property=\"TabNavigation\" Value=\"Local\"/&gt;\n        &lt;Setter Property=\"IsHoldingEnabled\" Value=\"True\"/&gt;\n        &lt;Setter Property=\"Margin\" Value=\"0,0,18,2\"/&gt;\n        &lt;Setter Property=\"HorizontalContentAlignment\" Value=\"Left\"/&gt;\n        &lt;Setter Property=\"VerticalContentAlignment\" Value=\"Center\"/&gt;\n        &lt;Setter Property=\"FontWeight\" Value=\"Bold\"/&gt;\n        &lt;Setter Property=\"Template\"&gt;\n            &lt;Setter.Value&gt;\n                &lt;ControlTemplate TargetType=\"ListViewItem\"&gt;\n                    &lt;ListViewItemPresenter CheckHintBrush=\"{ThemeResource ListViewItemCheckHintThemeBrush}\" CheckBrush=\"{ThemeResource ListViewItemCheckThemeBrush}\" ContentMargin=\"4\" ContentTransitions=\"{TemplateBinding ContentTransitions}\" CheckSelectingBrush=\"{ThemeResource ListViewItemCheckSelectingThemeBrush}\" DragForeground=\"{ThemeResource ListViewItemDragForegroundThemeBrush}\" DragOpacity=\"{ThemeResource ListViewItemDragThemeOpacity}\" DragBackground=\"{ThemeResource ListViewItemDragBackgroundThemeBrush}\" DisabledOpacity=\"{ThemeResource ListViewItemDisabledThemeOpacity}\" FocusBorderBrush=\"{ThemeResource ListViewItemFocusBorderThemeBrush}\" HorizontalContentAlignment=\"{TemplateBinding HorizontalContentAlignment}\" Padding=\"{TemplateBinding Padding}\" PointerOverBackgroundMargin=\"1\" PlaceholderBackground=\"{ThemeResource ListViewItemPlaceholderBackgroundThemeBrush}\" PointerOverBackground=\"{ThemeResource ListViewItemPointerOverBackgroundThemeBrush}\" ReorderHintOffset=\"{ThemeResource ListViewItemReorderHintThemeOffset}\" SelectedPointerOverBorderBrush=\"{ThemeResource selectedColor}\" SelectionCheckMarkVisualEnabled=\"True\" SelectedForeground=\"{ThemeResource FocusVisualWhiteStrokeThemeBrush}\" SelectedPointerOverBackground=\"{ThemeResource ListViewItemSelectedPointerOverBackgroundThemeBrush}\" SelectedBorderThickness=\"{ThemeResource ListViewItemCompactSelectedBorderThemeThickness}\" SelectedBackground=\"{ThemeResource ListViewItemSelectedBackgroundThemeBrush}\" VerticalContentAlignment=\"{TemplateBinding VerticalContentAlignment}\"/&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/Setter.Value&gt;\n        &lt;/Setter&gt;\n    &lt;/Style&gt;\n\n&lt;/Page.Resources&gt;\n\n&lt;!--\n    This grid acts as a root panel for the page that defines two rows:\n    * Row 0 contains the back button and page title\n    * Row 1 contains the rest of the page layout\n--&gt;\n&lt;Grid x:Name=\"mainGrid\" Background=\"{ThemeResource ApplicationPageBackgroundThemeBrush}\"\n    DataContext=\"{Binding Item}\"\n    d:DataContext=\"{Binding Groups[0].Items[0], Source={d:DesignData Source=/DataModel/layOut.json, Type=data:DataSource}}\" SizeChanged=\"image_SizeChanged\"&gt;\n    &lt;Grid.ChildrenTransitions&gt;\n        &lt;TransitionCollection&gt;\n            &lt;EntranceThemeTransition/&gt;\n        &lt;/TransitionCollection&gt;\n    &lt;/Grid.ChildrenTransitions&gt;\n\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"140\"/&gt;\n        &lt;RowDefinition Height=\".8*\" MinHeight=\"500\"/&gt;\n        &lt;RowDefinition Height=\".1*\" MinHeight=\"50\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n\n    &lt;!-- Back button and page title --&gt;\n    &lt;Grid&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\"120\"/&gt;\n            &lt;ColumnDefinition Width=\"*\"/&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Button x:Name=\"backButton\" Margin=\"39,50,39,0\" Command=\"{Binding NavigationHelper.GoBackCommand, ElementName=pageRoot}\"\n                    Style=\"{StaticResource NavigationBackButtonNormalStyle}\"\n                    VerticalAlignment=\"Top\"\n                    AutomationProperties.Name=\"Back\"\n                    AutomationProperties.AutomationId=\"BackButton\"\n                    AutomationProperties.ItemType=\"Navigation Button\" Click=\"leavePage_Event_Click\"/&gt;\n        &lt;TextBlock x:Name=\"pageTitle\" Text=\"{Binding Title}\" Style=\"{StaticResource HeaderTextBlockStyle}\" Grid.Column=\"1\"\n            IsHitTestVisible=\"false\" TextWrapping=\"NoWrap\" VerticalAlignment=\"Bottom\" Margin=\"0,0,30,48\" FontWeight=\"Medium\"/&gt;\n    &lt;/Grid&gt;\n\n    &lt;!-- THIS IS THE MIDDLE REGION OF THE PAGE                     --&gt;\n    &lt;Grid Grid.Row=\"1\" x:Name=\"contentRegion\"&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"1*\" MinHeight=\"520\"/&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition Width=\".17*\" MinWidth=\"240\" MaxWidth=\"300\"/&gt;\n            &lt;ColumnDefinition Width=\".13*\" MinWidth=\"175\" MaxWidth=\"200\"/&gt;\n            &lt;ColumnDefinition Width=\".4*\" MinWidth=\"510\"/&gt;\n            &lt;ColumnDefinition Width=\".13*\" MinWidth=\"175\" MaxWidth=\"200\"/&gt;\n            &lt;ColumnDefinition Width=\".17*\" MinWidth=\"240\" MaxWidth=\"300\"/&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;!-- USED FOR COLOR DIFFERENTIAL   --&gt;\n\n                &lt;Button x:Name=\"seg\" FontSize=\"24\" Content=\"Body\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Top\" Height=\"60\" BorderThickness=\"0\"&gt;\n                    &lt;Button.Flyout&gt;\n                        &lt;Flyout Placement=\"Right\"&gt;\n                            &lt;ListView x:Name=\"segMenu\" SelectionMode=\"Multiple\" IsItemClickEnabled=\"True\" Width=\"210\" ItemClick=\"segment_Button_Click\"&gt;\n                                &lt;ListViewItem Content=\" Full Bod\" Tag=\"25\" Width=\"190\" Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Clear\" Tag=\"26\" Width=\"190\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Hair\"  Tag=\"0\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Eyes\"  Tag=\"1\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Fingers\"  Tag=\"2\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Back\"  Tag=\"3\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Front\"  Tag=\"4\" Width=\"190\"  IsSelected=\"True\" Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  Side\"  Tag=\"5\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right Side\"  Tag=\"11\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  Elbow\"  Tag=\"6\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right Elbow\"  Tag=\"12\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  \"  Tag=\"7\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right \"  Tag=\"13\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  Hand\"  Tag=\"8\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right Hand\"  Tag=\"14\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  Hand\"  Tag=\"9\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right Hand\"  Tag=\"15\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  Thumb\"  Tag=\"10\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right Thumb\"  Tag=\"16\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  Hip\"  Tag=\"17\" Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right Hip\"  Tag=\"21\"  Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  Knee Cap\"  Tag=\"18\"  Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right Knee Cap\"  Tag=\"22\"  Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  Ankle\"  Tag=\"19\"  Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right Ankle\"  Tag=\"23\"  Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Left  Toe\"  Tag=\"20\"  Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                                &lt;ListViewItem Content=\" Right Toe\"  Tag=\"24\"  Width=\"190\"  IsSelected=\"True\"  Style=\"{StaticResource ListViewItemStyle1}\"/&gt;\n                            &lt;/ListView&gt;\n                        &lt;/Flyout&gt;\n                    &lt;/Button.Flyout&gt;\n                &lt;/Button&gt;\n\n\n    &lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n"}, {"tags": ["c#", "json", "indexing"], "comments": [{"owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "edited": false, "score": 1, "creation_date": 1448478778, "post_id": 33924545, "comment_id": 55610256, "body": "This is non-trivial.  Have a look at the <a href=\"https://github.com/ravendb/ravendb\" rel=\"nofollow noreferrer\">RavenDB</a> code base.  This is exactly what they do."}], "owner": {"reputation": 79, "user_id": 5605613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ce9bf1f354b25990671793cbf90f6b?s=128&d=identicon&r=PG&f=1", "display_name": "dahln", "link": "https://stackoverflow.com/users/5605613/dahln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448478378, "creation_date": 1448478378, "question_id": 33924545, "link": "https://stackoverflow.com/questions/33924545/indexing-json-files-in-c", "title": "Indexing Json files in C#", "body": "<p>I am working on an c# application which needs to create a lot of json files.  Within this application there is the occasional need to be able to search the json files for a particular value.  Looping through all the files is not an option based on how many files there are.  Using a DB like MongoDB is also not an option.   The application is already creating all the json files, I am looking for a way to index the files, so that searching is fast and easy. I imagine I need a way to update the indexes when a json file is created or modified.  Please suggest any tools for indexing a lot of json files in c#.  </p>\n"}, {"tags": ["c#", "key", "console-application", "move"], "comments": [{"owner": {"reputation": 47, "user_id": 5525420, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yGUtsgNr7lg/AAAAAAAAAAI/AAAAAAAAABc/tad9kTTQbkg/photo.jpg?sz=128", "display_name": "Itay Habani", "link": "https://stackoverflow.com/users/5525420/itay-habani"}, "edited": false, "score": 0, "creation_date": 1448478300, "post_id": 33924505, "comment_id": 55609972, "body": "For some reason the website did not include the spaces in my example, so you cant really tell the diffrence. The point is, it moved right."}, {"owner": {"reputation": 352, "user_id": 4835627, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10153337036588783/picture?type=large", "display_name": "Austin Donley", "link": "https://stackoverflow.com/users/4835627/austin-donley"}, "edited": false, "score": 0, "creation_date": 1448478445, "post_id": 33924505, "comment_id": 55610057, "body": "If you use the code format you can show spaces really well. Code format is started by using 4 blank spaces."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1448478483, "post_id": 33924505, "comment_id": 55610074, "body": "@ItayHabani why don&#39;t you post your code in question here..? let us see what it is you are attempting to do.."}, {"owner": {"reputation": 380, "user_id": 3059182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wDX05.jpg?s=128&g=1", "display_name": "Captain Delano", "link": "https://stackoverflow.com/users/3059182/captain-delano"}, "edited": false, "score": 0, "creation_date": 1448478842, "post_id": 33924505, "comment_id": 55610287, "body": "Possible cross-site duplicate: <a href=\"http://electronics.stackexchange.com/questions/8874/is-it-possible-to-send-characters-through-serial-to-go-up-a-line-on-the-console\" title=\"is it possible to send characters through serial to go up a line on the console\">electronics.stackexchange.com/questions/8874/&hellip;</a>"}, {"owner": {"reputation": 994, "user_id": 3360029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JGRDq.jpg?s=128&g=1", "display_name": "Robbie Coyne", "link": "https://stackoverflow.com/users/3360029/robbie-coyne"}, "reply_to_user": {"reputation": 380, "user_id": 3059182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wDX05.jpg?s=128&g=1", "display_name": "Captain Delano", "link": "https://stackoverflow.com/users/3059182/captain-delano"}, "edited": false, "score": 2, "creation_date": 1448478972, "post_id": 33924505, "comment_id": 55610349, "body": "@Amasa I&#39;m pretty sure that had nothing to do with this"}, {"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1448479007, "post_id": 33924505, "comment_id": 55610371, "body": "Look into <a href=\"https://msdn.microsoft.com/en-us/library/system.console.setcursorposition(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>Console.SetCursorPosition</code></a>, you&#39;ll also need some kind of loop and <a href=\"https://msdn.microsoft.com/en-us/library/system.console.keyavailable(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>Console.KeyAvailable</code></a>, then <a href=\"https://msdn.microsoft.com/en-us/library/x3h8xffw(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>Console.ReadKey</code></a> if its true. You can see how I did this for a Nibbles clone I was working on here: <a href=\"https://github.com/ingeniousllc/Nibbles/blob/master/Nibbles/Level.cs\" rel=\"nofollow noreferrer\">github.com/ingeniousllc/Nibbles/blob/master/Nibbles/Level.cs</a>"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1448480356, "post_id": 33924505, "comment_id": 55611075, "body": "Highlight your code and press the toolbar button that looks like <code>{ }</code> to format the code if it does not show up correctly."}], "answers": [{"comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1448479376, "post_id": 33924796, "comment_id": 55610573, "body": "You may want to <code>Thread.Sleep</code> some period inside the loop to keep the program from pegging out a processor."}, {"owner": {"reputation": 47, "user_id": 5525420, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yGUtsgNr7lg/AAAAAAAAAAI/AAAAAAAAABc/tad9kTTQbkg/photo.jpg?sz=128", "display_name": "Itay Habani", "link": "https://stackoverflow.com/users/5525420/itay-habani"}, "edited": false, "score": 0, "creation_date": 1448551996, "post_id": 33924796, "comment_id": 55643624, "body": "Thanks, but its not that helpful... Im learning c# at my school, and this is my first year, so I dont really know what try, catch and some of those expressions mean... Today at class a friend show me how he did it, and he just used a for loop inside a foor loop. the outer one for the &#39;<i>&#39;, and the inner one, for the spaces before the &#39;</i>&#39;. Can you show me a smiliar version to what he did please?"}], "tags": [], "owner": {"reputation": 121, "user_id": 4251720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b16103a49898959dc06c923b29afe09?s=128&d=identicon&r=PG&f=1", "display_name": "Francois", "link": "https://stackoverflow.com/users/4251720/francois"}, "is_accepted": false, "score": 1, "last_activity_date": 1448479463, "last_edit_date": 1448479463, "creation_date": 1448479252, "answer_id": 33924796, "question_id": 33924505, "link": "https://stackoverflow.com/questions/33924505/c-console-application-moving-a-character/33924796#33924796", "title": "C# Console Application | Moving a character", "body": "<p>Hope this is good enough. Run the code, and press the arrow keys to move the asterisk around. Got inspiration from here: <a href=\"https://msdn.microsoft.com/en-us/library/system.console.setcursorposition(v=vs.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/system.console.setcursorposition(v=vs.110).aspx</a></p>\n\n<pre><code>public class Program\n{\n    public static void Main(string[] args)\n    {\n        const char toWrite = '*'; // Character to write on-screen.\n\n        int x = 0, y = 0; // Contains current cursor position.\n\n        Write(toWrite); // Write the character on the default location (0,0).\n\n        while (true)\n        {\n            if (Console.KeyAvailable)\n            {\n                var command = Console.ReadKey().Key;\n\n                switch (command)\n                {\n                    case ConsoleKey.DownArrow:\n                        y++;\n                        break;\n                    case ConsoleKey.UpArrow:\n                        if (y &gt; 0)\n                        {\n                            y--;\n                        }\n                        break;\n                    case ConsoleKey.LeftArrow:\n                        if (x &gt; 0)\n                        {\n                            x--;\n                        }\n                        break;\n                    case ConsoleKey.RightArrow:\n                        x++;\n                        break;\n                }\n\n                Write(toWrite, x, y);\n            }\n            else\n            {\n                Thread.Sleep(100);\n            }\n        }\n    }\n\n    public static void Write(char toWrite, int x = 0, int y = 0)\n    {\n        try\n        {\n            if (x &gt;= 0 &amp;&amp; y &gt;= 0) // 0-based\n            {\n                Console.Clear();\n                Console.SetCursorPosition(x, y);\n                Console.Write(toWrite);\n            }\n        }\n        catch (Exception)\n        {\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5525420, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yGUtsgNr7lg/AAAAAAAAAAI/AAAAAAAAABc/tad9kTTQbkg/photo.jpg?sz=128", "display_name": "Itay Habani", "link": "https://stackoverflow.com/users/5525420/itay-habani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8424, "favorite_count": 0, "protected_date": 1605052594, "answer_count": 1, "score": 0, "last_activity_date": 1605052477, "creation_date": 1448478224, "last_edit_date": 1448478927, "question_id": 33924505, "link": "https://stackoverflow.com/questions/33924505/c-console-application-moving-a-character", "title": "C# Console Application | Moving a character", "body": "<p>First of all, I'd like to apologize since this was probably asked before me. However, no matter where I looked, I just could'nt find the answer.\nI want to make a certain character move ( constantly, or by a certain key ). \nBy moving i mean it changing its position on screen. I dont think i really got the idea of it, but i think you can just use a for loop and add a space before this character everytime. If possible I would like to know how to make this for loop.\nFor example:\nWhen you run the program, you see this:\n*\nAnd then after you press a key or just constantly ( as I mentioned before ):\n *\nAs you can see, the character moved right. But i want to know how to make it move to all directions ( up, down, etc.)</p>\n"}, {"tags": ["c#", "unity3d", "nullreferenceexception", "raycasting"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4933713, "user_type": "registered", "profile_image": "https://graph.facebook.com/907636145944321/picture?type=large", "display_name": "Thusten", "link": "https://stackoverflow.com/users/4933713/thusten"}, "edited": false, "score": 0, "creation_date": 1448479406, "post_id": 33924735, "comment_id": 55610581, "body": "This worked, thank you :)"}], "tags": [], "owner": {"reputation": 36, "user_id": 3225312, "user_type": "registered", "profile_image": "https://graph.facebook.com/795965273/picture?type=large", "display_name": "user3225312", "link": "https://stackoverflow.com/users/3225312/user3225312"}, "is_accepted": true, "score": 0, "last_activity_date": 1448479014, "creation_date": 1448479014, "answer_id": 33924735, "question_id": 33924446, "link": "https://stackoverflow.com/questions/33924446/nullreferenceexception-collider-internal-raycast-unity3d/33924735#33924735", "title": "NullReferenceException Collider.Internal_Raycast Unity3d", "body": "<p>Haven't dealt directly yet but from what I'm seeing you're creating a collider where you should be using a collider that's already attached to the gameObject.</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\n\npublic class ExampleClass : MonoBehaviour {\npublic Collider coll;\nvoid Start() {\n    coll = GetComponent&lt;Collider&gt;();\n}\nvoid Update() {\n    if (Input.GetMouseButtonDown(0)) {\n        Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);\n        RaycastHit hit;\n        if (coll.Raycast(ray, out hit, 100.0F))\n            transform.position = ray.GetPoint(100.0F);\n\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>In the Start method you can see that the code is grabbing a pre-existing collider. This would likely be a good place to start.</p>\n"}], "owner": {"reputation": 11, "user_id": 4933713, "user_type": "registered", "profile_image": "https://graph.facebook.com/907636145944321/picture?type=large", "display_name": "Thusten", "link": "https://stackoverflow.com/users/4933713/thusten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1448479015, "accepted_answer_id": 33924735, "answer_count": 1, "score": 0, "last_activity_date": 1448479014, "creation_date": 1448477991, "last_edit_date": 1448478527, "question_id": 33924446, "link": "https://stackoverflow.com/questions/33924446/nullreferenceexception-collider-internal-raycast-unity3d", "closed_reason": "Duplicate", "title": "NullReferenceException Collider.Internal_Raycast Unity3d", "body": "<p>I'm getting NullReferenceException and can't figure out what I am supposed to be fixing. I've read through the manuals for NRE's and raycasting but I can't find any answer.</p>\n\n<blockquote>\n  <p>NullReferenceException<br>\n  UnityEngine.Collider.Internal_Raycast (UnityEngine.Collider col, Ray ray, UnityEngine.RaycastHit&amp; hitInfo, Single maxDistance)<br>\n  (at C:/buildslave/unity/build/artifacts/generated/common/modules/DynamicsBindings.gen.cs:2257)<br>\n  UnityEngine.Collider.Raycast (Ray ray, UnityEngine.RaycastHit&amp; hitInfo, Single maxDistance)<br>\n  (at C:/buildslave/unity/build/artifacts/generated/common/modules/DynamicsBindings.gen.cs:2265)<br>\n  TileMouseOver.Update () (at Assets/TileMouseOver.cs:22)</p>\n</blockquote>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\n\npublic class TileMouseOver : MonoBehaviour {\n  [SerializeField]\n  public Color highlightColor;\n  [SerializeField]\n  Color normalColor;\n\n  void Start() {\n    normalColor = GetComponent&lt;Renderer&gt;().material.color;\n  }\n\n  void Update () {\n    Ray ray = Camera.main.ScreenPointToRay( Input.mousePosition );\n    var rayCollider = new Collider();\n    RaycastHit hitInfo;\n\n    if( rayCollider.Raycast( ray, out hitInfo, Mathf.Infinity )) {\n        GetComponent&lt;Renderer&gt;().material.color = highlightColor;\n    } else {\n        GetComponent&lt;Renderer&gt;().material.color = normalColor;\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "linq", "razor"], "comments": [{"owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "edited": false, "score": 0, "creation_date": 1448478640, "post_id": 33924434, "comment_id": 55610163, "body": "On which line are you getting the error?"}], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 2212697, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e4aeb4cb5316ae7bd301893eee6fa250?s=128&d=identicon&r=PG", "display_name": "Pedro Fernandes Filho", "link": "https://stackoverflow.com/users/2212697/pedro-fernandes-filho"}, "edited": false, "score": 0, "creation_date": 1448478354, "post_id": 33924521, "comment_id": 55610004, "body": "You can try a cast on the View: <code>(List&lt;SelectListItem&gt;)ViewBag.ddCompany</code>"}, {"owner": {"reputation": 63, "user_id": 5445378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99b5a47de33d12de37d134069d74abd6?s=128&d=identicon&r=PG&f=1", "display_name": "Aron Valencio", "link": "https://stackoverflow.com/users/5445378/aron-valencio"}, "edited": false, "score": 0, "creation_date": 1448480422, "post_id": 33924521, "comment_id": 55611108, "body": "Thanks for the answer, Pedro! I tried to create List&lt;SelectListItem&gt; ddCompany in my ViewModel, but the couldn&#39;t manage to assign the LINQ query to it. How should I do it?"}], "tags": [], "owner": {"reputation": 755, "user_id": 2031096, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e8238252be41ca6b504f81d37415cb69?s=128&d=identicon&r=PG", "display_name": "George Findulov", "link": "https://stackoverflow.com/users/2031096/george-findulov"}, "is_accepted": false, "score": 0, "last_activity_date": 1448478281, "creation_date": 1448478281, "answer_id": 33924521, "question_id": 33924434, "link": "https://stackoverflow.com/questions/33924434/pass-linq-query-to-viewbag-to-create-dropdownlist/33924521#33924521", "title": "Pass LINQ query to VIewBag to create DropDownList", "body": "<p>You're passing an anonymous type to your view which is not practical scenario for what you're trying to do - anonymous types are generated as internal. You better use a view model to pass your data and you will not have such a problem anymore.</p>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 5445378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99b5a47de33d12de37d134069d74abd6?s=128&d=identicon&r=PG&f=1", "display_name": "Aron Valencio", "link": "https://stackoverflow.com/users/5445378/aron-valencio"}, "edited": false, "score": 0, "creation_date": 1448479834, "post_id": 33924579, "comment_id": 55610810, "body": "Hey Kiwi, thanks for the answer! It compiled, but still not working. &quot;There is no ViewData item of type &#39;IEnumerable&lt;SelectListItem&gt;&#39; that has the key &#39;ddComapny&#39;.&quot;. I tried to declare the ddCompany as a IEnumerable&lt;SelectListItem&gt; but still receiving the same error message"}, {"owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "reply_to_user": {"reputation": 63, "user_id": 5445378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99b5a47de33d12de37d134069d74abd6?s=128&d=identicon&r=PG&f=1", "display_name": "Aron Valencio", "link": "https://stackoverflow.com/users/5445378/aron-valencio"}, "edited": false, "score": 0, "creation_date": 1448479927, "post_id": 33924579, "comment_id": 55610861, "body": "&#39;ddComapny&#39;?  is that a typo?"}, {"owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "reply_to_user": {"reputation": 63, "user_id": 5445378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99b5a47de33d12de37d134069d74abd6?s=128&d=identicon&r=PG&f=1", "display_name": "Aron Valencio", "link": "https://stackoverflow.com/users/5445378/aron-valencio"}, "edited": false, "score": 0, "creation_date": 1448480827, "post_id": 33924579, "comment_id": 55611316, "body": "@AronValencio  That&#39;s a different problem.  KiwiPiet&#39;s code circumvents your original problem by replacing the code you had with the error completely.  This new error relates to being unable to create a dropdown because of a naming conflict.  Correct the typo (probably in your view) and it should work.  See my answer for your original error."}], "tags": [], "owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "is_accepted": false, "score": 1, "last_activity_date": 1448478477, "creation_date": 1448478477, "answer_id": 33924579, "question_id": 33924434, "link": "https://stackoverflow.com/questions/33924434/pass-linq-query-to-viewbag-to-create-dropdownlist/33924579#33924579", "title": "Pass LINQ query to VIewBag to create DropDownList", "body": "<p>Instead of creating an anonymous type, can you try the following?</p>\n\n<pre><code>var ddCompany = (from c in leases.tblvCompanies\n                 select new SelectListItem{ Value = c.Company_ID, Text = c.Company })\n                 .ToList();\nViewBag.ddCompany = ddCompany;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36783, "user_id": 2946329, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a9ygJ.jpg?s=128&g=1", "display_name": "Salah Akbari", "link": "https://stackoverflow.com/users/2946329/salah-akbari"}, "is_accepted": false, "score": 1, "last_activity_date": 1448482633, "last_edit_date": 1448482633, "creation_date": 1448479037, "answer_id": 33924746, "question_id": 33924434, "link": "https://stackoverflow.com/questions/33924434/pass-linq-query-to-viewbag-to-create-dropdownlist/33924746#33924746", "title": "Pass LINQ query to VIewBag to create DropDownList", "body": "<p>Why you don't using a strongly-typed view? You can pass a view model\nbetween the controller and the view for this purpose. like this:</p>\n\n<pre><code>public class HomeController : Controller\n{ \n  ...\n\n   public ActionResult Index()\n   {\n      List&lt;SelectListItem&gt; ddCompany = new List&lt;SelectListItem&gt;();\n      var companyList = (from c in leases.tblvCompanies\n               select new {c.Company_ID, c.Company }).ToList();\n      foreach(var item in companyList)\n      {\n         //in this line you should use item instead of companyList\n         ddCompany.Add(new SelectListItem { Value = item.Company_ID, Text = item.Company });\n      }\n      return View(ddCompany);\n   }\n}\n</code></pre>\n\n<p>And in the view:</p>\n\n<pre><code>@model List&lt;MvcApplication1.Models.SelectListItem&gt;\n\n@foreach(var item in Model)\n{\n   &lt;span&gt;@item.Value&lt;/span&gt;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20059, "user_id": 856353, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BHW9.jpg?s=128&g=1", "display_name": "Robert McKee", "link": "https://stackoverflow.com/users/856353/robert-mckee"}, "is_accepted": true, "score": 2, "last_activity_date": 1448480706, "last_edit_date": 1448480706, "creation_date": 1448480318, "answer_id": 33925076, "question_id": 33924434, "link": "https://stackoverflow.com/questions/33924434/pass-linq-query-to-viewbag-to-create-dropdownlist/33925076#33925076", "title": "Pass LINQ query to VIewBag to create DropDownList", "body": "<p>You shouldn't be referencing the list companyList in your loop instead of the singular item:</p>\n\n<pre><code>ddCompany.Add(new SelectListItem { Value = companyList.Company_ID, Text = companyList.Company });\n</code></pre>\n\n<p>should be: </p>\n\n<pre><code>ddCompany.Add(new SelectListItem { Value = item.Company_ID, Text = item.Company });\n</code></pre>\n\n<p>I would actually suggest the following:</p>\n\n<pre><code>ViewBag.ddCompany=leases.tblvCompanies\n  .Select(c=&gt;new SelectListItem {Value=c.Company_ID,Text=c.Company})\n  .ToList();\n</code></pre>\n\n<p>Although I usually don't like passing UI elements (SelectListItem) from the controller to the view, that's the view's responsibility.</p>\n"}], "owner": {"reputation": 63, "user_id": 5445378, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99b5a47de33d12de37d134069d74abd6?s=128&d=identicon&r=PG&f=1", "display_name": "Aron Valencio", "link": "https://stackoverflow.com/users/5445378/aron-valencio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1740, "favorite_count": 0, "accepted_answer_id": 33925076, "answer_count": 4, "score": 0, "last_activity_date": 1448546688, "creation_date": 1448477933, "last_edit_date": 1448546688, "question_id": 33924434, "link": "https://stackoverflow.com/questions/33924434/pass-linq-query-to-viewbag-to-create-dropdownlist", "title": "Pass LINQ query to VIewBag to create DropDownList", "body": "<p>I'm trying to pass a LINQ query to a view bag in order to bring a list from my database and display it in a <code>DropDownList</code>.</p>\n\n<p>This is what I came up with:</p>\n\n<pre><code>List&lt;SelectListItem&gt; ddCompany = new List&lt;SelectListItem&gt;();\nvar companyList = (from c in leases.tblvCompanies\n                   select new {c.Company_ID, c.Company }).ToList();\nforeach(var item in companyList)\n{\n    ddCompany.Add(new SelectListItem { Value = companyList.Company_ID, Text = companyList.Company });\n}\nViewBag.ddCompany = ddCompany;\n</code></pre>\n\n<p>The error I'm getting is the following:    </p>\n\n<blockquote>\n  <p>'System.Collections.Generic.List&lt;AnonymousType#1&gt;' does not contain a\n  definition for 'Company_ID' and no extension method 'Company_ID'\n  accepting a first argument of type\n  'System.Collections.Generic.List&lt;AnonymousType#1&gt;' could be found (are\n  you missing a using directive or an assembly reference?)</p>\n</blockquote>\n\n<p>Can somebody help me to figure out why it doesn't work? There is any other way different than this one?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Thanks to KiwiPiet and Robert McKee here is what made it work:</p>\n\n<p>Controller:</p>\n\n<pre><code>List&lt;SelectListItem&gt; ddCompany = new List&lt;SelectListItem&gt;();\n            var companyList = (from c in leases.tblvCompanies\n                               orderby c.Company ascending\n                               select new { c.Company_ID, c.Company }).ToList();\n            foreach (var item in companyList)\n            {\n                ddCompany.Add(new SelectListItem { Value = item.Company_ID.ToString(), Text = item.Company });\n            }\n            ViewBag.ddCompanyList = ddCompany;\n\n            ViewBag.messageString = \"ddCompanyList\";\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>@Html.DropDownList(\"ddCompanyList\")\n</code></pre>\n"}, {"tags": ["c#", "sql-server"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1448478015, "post_id": 33924423, "comment_id": 55609802, "body": "varchar will maintain carriage returns with no problem. Now if you want these lines breaks to show up in html you will have to get a little creative. Do NOT use the text datatype. It has been deprecated in favor of varchar(max) since sql 2005."}, {"owner": {"reputation": 7104, "user_id": 2224701, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/cN98G.jpg?s=128&g=1", "display_name": "Vojt\u011bch Dohnal", "link": "https://stackoverflow.com/users/2224701/vojt%c4%9bch-dohnal"}, "edited": false, "score": 0, "creation_date": 1448478066, "post_id": 33924423, "comment_id": 55609830, "body": "Use CRLF characters?"}, {"owner": {"reputation": 709, "user_id": 1349083, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/dpNwc.jpg?s=128&g=1", "display_name": "J.P Masangcay", "link": "https://stackoverflow.com/users/1349083/j-p-masangcay"}, "reply_to_user": {"reputation": 7104, "user_id": 2224701, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/cN98G.jpg?s=128&g=1", "display_name": "Vojt\u011bch Dohnal", "link": "https://stackoverflow.com/users/2224701/vojt%c4%9bch-dohnal"}, "edited": false, "score": 0, "creation_date": 1448478392, "post_id": 33924423, "comment_id": 55610026, "body": "@Vojt\u011bchDohnal My program is in Winform (Updated my question). Thank you for the info about text data type though. Will I be able to maintain the line breaks and beginning spaces when I SELECT them in C#?"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1448478767, "post_id": 33924423, "comment_id": 55610250, "body": "If you have spaces in the data you will have spaces in the strings in c#. Why not just try it? For displaying in a windows forms app you need to make sure that whatever control you are using for display supports multiple line presentation."}, {"owner": {"reputation": 709, "user_id": 1349083, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/dpNwc.jpg?s=128&g=1", "display_name": "J.P Masangcay", "link": "https://stackoverflow.com/users/1349083/j-p-masangcay"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1448479043, "post_id": 33924423, "comment_id": 55610405, "body": "I will try it. @SeanLange what about when printing in paper? will it still display the line breaks?"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 2, "creation_date": 1448479156, "post_id": 33924423, "comment_id": 55610446, "body": "You seem to be overly concerned with the kind of presentation that people do everyday. Of course spaces will be maintained. A line break is just a character like any other character. However, when being presented it inserts a line break instead of series of dark pixels like a &quot;normal&quot; character. Again, try it."}, {"owner": {"reputation": 709, "user_id": 1349083, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/dpNwc.jpg?s=128&g=1", "display_name": "J.P Masangcay", "link": "https://stackoverflow.com/users/1349083/j-p-masangcay"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1448479266, "post_id": 33924423, "comment_id": 55610515, "body": "Thank you @SeanLange. Yes, I am a bit overly concerned about it."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 1, "creation_date": 1448479465, "post_id": 33924423, "comment_id": 55610606, "body": "The best way to find out if something will print a certain way is to stick a piece of paper in the printer and print it. :) You are going to have to do that anyway before you are done."}], "answers": [{"comments": [{"owner": {"reputation": 10677, "user_id": 122195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65228e5118999b6712f54a7076e15776?s=128&d=identicon&r=PG", "display_name": "thepirat000", "link": "https://stackoverflow.com/users/122195/thepirat000"}, "edited": false, "score": 2, "creation_date": 1448480459, "post_id": 33924763, "comment_id": 55611127, "body": "You should use <code>Environment.NewLine</code> instead of <code>&quot;\\n&quot;</code>."}], "tags": [], "owner": {"reputation": 5, "user_id": 3300286, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007579570926/picture?type=large", "display_name": "Rinner", "link": "https://stackoverflow.com/users/3300286/rinner"}, "is_accepted": false, "score": 0, "last_activity_date": 1448479106, "creation_date": 1448479106, "answer_id": 33924763, "question_id": 33924423, "link": "https://stackoverflow.com/questions/33924423/c-sql-what-is-the-best-way-to-insert-or-select-text-to-or-from-a-db-table-with/33924763#33924763", "title": "C# SQL -What is the best way to INSERT or SELECT text to or from a db table with line breaks", "body": "<p>You should try this code.</p>\n\n<pre><code>private string GetDBString(string SqlFieldName, SqlDataReader Reader)\n    {\nreturn Reader[SqlFieldName].Equals(DBNull.Value) ? String.Empty : Reader.GetString(SqlFieldName);\n    }\n</code></pre>\n\n<p>Then try something like this.</p>\n\n<pre><code>private void somemethod()\n{\nstring query = \"SELECT * FROM [mssql_table_name] WHERE id=1\";\n//I suppose you should have your datarow as id one. This helps a lot or where line=\"data in that\"\n//whatever helps to find your row\nSqlConnection sqc = new SqlConnection(connection_string); // Defined by you\nsqc.Open();\nSqlCommand command = SqlCommand(query,sqc);\nSqlDataReader reader = command.ExecuteReader();\nthis.footer.Text = GetDBString(\"line1\", reader) + \"\\n\" + GetDBString(\"line\",reader)... etc;\n</code></pre>\n\n<p>All you need is before the new GetDBString insert between: + \"\\n \" +</p>\n\n<p>I hope I did help you and I understood your problem well.</p>\n"}], "owner": {"reputation": 709, "user_id": 1349083, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/dpNwc.jpg?s=128&g=1", "display_name": "J.P Masangcay", "link": "https://stackoverflow.com/users/1349083/j-p-masangcay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448479106, "creation_date": 1448477908, "last_edit_date": 1448478442, "question_id": 33924423, "link": "https://stackoverflow.com/questions/33924423/c-sql-what-is-the-best-way-to-insert-or-select-text-to-or-from-a-db-table-with", "title": "C# SQL -What is the best way to INSERT or SELECT text to or from a db table with line breaks", "body": "<p>I am creating a footer of a receipt with <code>Graphic.DrawString</code>. The data is being <code>SELECT</code> from my database. Currently my table design holds 5 fields for the lines (line 1, 2, 3 up to 7). They are all single lines which is not very flexible. Say I want to put in a promo or a fairly long message on my footer. I am thinking of changing my table design to have 1 column of just the message and the data type probably <code>text</code> or <code>varchar</code>. What can I do to put multiple lines in that field?</p>\n\n<p>EDIT: (Update: My receipt is created in Winform)</p>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 4600, "user_id": 770230, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a6a5d05eef9086348dbbd089e974d71?s=128&d=identicon&r=PG", "display_name": "Dan Bechard", "link": "https://stackoverflow.com/users/770230/dan-bechard"}, "edited": false, "score": 0, "creation_date": 1448480641, "post_id": 33924421, "comment_id": 55611230, "body": "In your example RegEx, <code>*.</code> should be <code>.*</code>. Not sure if that&#39;s a typo, so I&#39;m not going to submit an edit."}, {"owner": {"reputation": 47502, "user_id": 231316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VfU5E.jpg?s=128&g=1", "display_name": "Chris Haas", "link": "https://stackoverflow.com/users/231316/chris-haas"}, "edited": false, "score": 0, "creation_date": 1448481198, "post_id": 33924421, "comment_id": 55611507, "body": "I just wanted to point out that if you&#39;re ever not sure what actually needs to be escaped in a literal string inside of a regex you can ask the system to figure it out for you using  <a href=\"https://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.escape(v=vs.110).aspx\" rel=\"nofollow noreferrer\">System.Text.RegularExpressions.Regex.Escape()</a>"}, {"owner": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "reply_to_user": {"reputation": 4600, "user_id": 770230, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a6a5d05eef9086348dbbd089e974d71?s=128&d=identicon&r=PG", "display_name": "Dan Bechard", "link": "https://stackoverflow.com/users/770230/dan-bechard"}, "edited": false, "score": 0, "creation_date": 1448485182, "post_id": 33924421, "comment_id": 55613447, "body": "@Dan yeah typo, sorry."}, {"owner": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "reply_to_user": {"reputation": 47502, "user_id": 231316, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VfU5E.jpg?s=128&g=1", "display_name": "Chris Haas", "link": "https://stackoverflow.com/users/231316/chris-haas"}, "edited": false, "score": 0, "creation_date": 1448485201, "post_id": 33924421, "comment_id": 55613457, "body": "@ChrisHaas excellent thank you. I will check that out."}], "answers": [{"comments": [{"owner": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "edited": false, "score": 0, "creation_date": 1448482133, "post_id": 33924489, "comment_id": 55611945, "body": "I am accepting this because you posted first and the solution worked, even though others posted more verbose responses. But I honestly appreciate the answers from others, and thank you all for your time."}, {"owner": {"reputation": 6043, "user_id": 5290909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a34788cb69a6f3007f88e3a36a590ca?s=128&d=identicon&r=PG", "display_name": "Mariano", "link": "https://stackoverflow.com/users/5290909/mariano"}, "reply_to_user": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "edited": false, "score": 0, "creation_date": 1448497433, "post_id": 33924489, "comment_id": 55618339, "body": "@BugHunterUK you can <a href=\"http://stackoverflow.com/help/privileges/vote-up\">up-vote</a> all helpful answers."}], "tags": [], "owner": {"reputation": 12977, "user_id": 4453262, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b98c905b863b482c3d1d6616d3482b54?s=128&d=identicon&r=PG&f=1", "display_name": "karthik manchala", "link": "https://stackoverflow.com/users/4453262/karthik-manchala"}, "is_accepted": true, "score": 2, "last_activity_date": 1448478134, "creation_date": 1448478134, "answer_id": 33924489, "question_id": 33924421, "link": "https://stackoverflow.com/questions/33924421/escaping-characters-in-regex-pattern-string/33924489#33924489", "title": "Escaping characters in RegEx pattern string", "body": "<p>In C# each backslash in a string can be written as <code>\\\\\\\\</code>.</p>\n\n<p>You can use the following:</p>\n\n<pre><code>MatchCollection matches = Regex.Matches(content, \"first_cursor\\\\\\\\{2}&amp;quot;:\\\\\\\\{2}&amp;quot([-0-9A-Za-z]+)\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4600, "user_id": 770230, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a6a5d05eef9086348dbbd089e974d71?s=128&d=identicon&r=PG", "display_name": "Dan Bechard", "link": "https://stackoverflow.com/users/770230/dan-bechard"}, "is_accepted": false, "score": 1, "last_activity_date": 1448480711, "last_edit_date": 1448480711, "creation_date": 1448478471, "answer_id": 33924576, "question_id": 33924421, "link": "https://stackoverflow.com/questions/33924421/escaping-characters-in-regex-pattern-string/33924576#33924576", "title": "Escaping characters in RegEx pattern string", "body": "<p>I prefer to use <a href=\"https://msdn.microsoft.com/en-us/library/362314fe.aspx\" rel=\"nofollow\">verbatim string literals</a> when writing RegEx strings in C#:</p>\n\n<pre><code>string pattern = @\"first_cursor\\\\\\\\&amp;quot;:\\\\\\\\&amp;quot;([-0-9A-Za-z]+)\\\\\\\\&amp;quot;\";\n</code></pre>\n\n<p>This prevents you from having to escape the slashes twice; once for C# and again for the RegEx engine.</p>\n\n<p>As an aside, this syntax is also useful when storing paths in strings:</p>\n\n<pre><code>string logFile = @\"C:\\Temp\\mylog.txt\";\n</code></pre>\n\n<p>And even supports multi-line for SQL commands and such:</p>\n\n<pre><code>string query = @\"\n    SELECT *\n      FROM tblStudents\n     WHERE FirstName = 'Bobby'\n       AND LastName = 'Tables'\n\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 338, "user_id": 2364253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3289349624d97578e070f7439c5f131?s=128&d=identicon&r=PG", "display_name": "Cat_Clan", "link": "https://stackoverflow.com/users/2364253/cat-clan"}, "is_accepted": false, "score": 0, "last_activity_date": 1448479939, "creation_date": 1448479939, "answer_id": 33924978, "question_id": 33924421, "link": "https://stackoverflow.com/questions/33924421/escaping-characters-in-regex-pattern-string/33924978#33924978", "title": "Escaping characters in RegEx pattern string", "body": "<p>You can use lookahead to elimate some of the contenders:</p>\n\n<pre><code>var example = @\"first_cursor\\\\&amp;quot;:\\\\&amp;quot;MTQ0ODQ3NjcyNDoxNDQ4NDc2NzI0OjE6LTM4OTc1OTc2MjM4MDc1OTM2NjY6MTQ0ODQ3NjAwMzowOjA6NTQw\\\\&amp;quot;\";\nvar regex = new Regex(\"(?&lt;!&amp;[-0-9A-Za-z]*)(?&lt;!_[-0-9A-Za-z]*)[-0-9A-Za-z]+\");\nvar matches = regex.Matches(example);\nforeach(var match in matches)\n{\n  if (match.ToString() != \"first\")\n  {\n    Console.WriteLine(match);\n  }\n}\n</code></pre>\n\n<p>This would give you two matches. One for first and one for the string you are looking for. Then you can iterate over the matches and see if it's not \"first\" then it should be what you are looking for.</p>\n"}], "owner": {"reputation": 6685, "user_id": 5045227, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/33d94e8bd370131f074aeb3e26622e8f?s=128&d=identicon&r=PG&f=1", "display_name": "BugHunterUK", "link": "https://stackoverflow.com/users/5045227/bughunteruk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 0, "closed_date": 1448481837, "accepted_answer_id": 33924489, "answer_count": 3, "score": -2, "last_activity_date": 1448480711, "creation_date": 1448477905, "question_id": 33924421, "link": "https://stackoverflow.com/questions/33924421/escaping-characters-in-regex-pattern-string", "closed_reason": "Duplicate", "title": "Escaping characters in RegEx pattern string", "body": "<p>I'm trying to extract <code>MTQ0ODQ3NjcyNDoxNDQ4NDc2NzI0OjE6LTM4OTc1OTc2MjM4MDc1OTM2NjY6MTQ0ODQ3NjAwMzowOjA6NTQw</code> from the string below.</p>\n\n<p>I am having issues with the <code>\\\\</code> (backslash) characters. How do I escape these in C#. Is there any documentation that shows characters that need escaping in regex patterns, and how to escape them?</p>\n\n<pre><code>first_cursor\\\\&amp;quot;:\\\\&amp;quot;MTQ0ODQ3NjcyNDoxNDQ4NDc2NzI0OjE6LTM4OTc1OTc2MjM4MDc1OTM2NjY6MTQ0ODQ3NjAwMzowOjA6NTQw\\\\&amp;quot;\n</code></pre>\n\n<p>I've tried the following to no avail. I tried to avoid having to escape the backslashes altogether:</p>\n\n<pre><code>MatchCollection matches = Regex.Matches(content, \"first_cursor*.quot;([-0-9A-Za-z]+)\");\n</code></pre>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["c#", "asp.net-mvc", "asp.net-mvc-3", "asp.net-mvc-routing"], "comments": [{"owner": {"reputation": 758, "user_id": 5090812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6d3db871d5f7a32ce905951fc1a859?s=128&d=identicon&r=PG", "display_name": "user5090812", "link": "https://stackoverflow.com/users/5090812/user5090812"}, "edited": false, "score": 0, "creation_date": 1448477892, "post_id": 33924366, "comment_id": 55609729, "body": "If you can reproduce the problem locally, the network inspector in Chrome or Firefox might be helpful here.  Using it, you could see the actual sequence of redirects that was followed."}, {"owner": {"reputation": 782, "user_id": 3228150, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/100002001613453/picture?type=large", "display_name": "Ariel", "link": "https://stackoverflow.com/users/3228150/ariel"}, "reply_to_user": {"reputation": 758, "user_id": 5090812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6d3db871d5f7a32ce905951fc1a859?s=128&d=identicon&r=PG", "display_name": "user5090812", "link": "https://stackoverflow.com/users/5090812/user5090812"}, "edited": false, "score": 0, "creation_date": 1448478264, "post_id": 33924366, "comment_id": 55609953, "body": "I did it, it gives a lot of redirects and then stops, if you wait some secs and reload everything is fine, but this always happens after you change from the form to the appointment area, as you can see in my edit the only difference is that in the redirect header i have a Location attribute"}], "answers": [{"tags": [], "owner": {"reputation": 782, "user_id": 3228150, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/100002001613453/picture?type=large", "display_name": "Ariel", "link": "https://stackoverflow.com/users/3228150/ariel"}, "is_accepted": true, "score": 0, "last_activity_date": 1448997465, "last_edit_date": 1448997465, "creation_date": 1448997277, "answer_id": 34028263, "question_id": 33924366, "link": "https://stackoverflow.com/questions/33924366/c-mvc-routebase-routing-too-many-redirects/34028263#34028263", "title": "C# MVC RouteBase routing too many redirects", "body": "<p>After some research I found that my problem was related to the fact that I wasn't using <code>Clone</code> on the values that were coming from the cache. Since the .NET cache keeps a reference value when you get its value, it's necessary to implement <code>ICloneable</code> on the object you are getting from it.</p>\n\n<p>Since I was only \"putting\" the value on another var and later editing this var I was in fact changing the original value on the cache... and with that I was getting a wrong return when I would hit the cache again.</p>\n\n<p>In my case I was getting a redirect because of some Session verification that I was doing on my Controller, on the first time (freshly made cache) I would hit the correct page.  But after I would try to re-enter the same page, I would get a different value from it.</p>\n\n<p>To correct it I implemented <code>ICloneable</code> on my Model. I have also changed my example with the new approach if anyone also have this problem.</p>\n\n<p><a href=\"http://pastebin.com/yTdWKMp4\" rel=\"nofollow\">http://pastebin.com/yTdWKMp4</a></p>\n"}], "owner": {"reputation": 782, "user_id": 3228150, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/100002001613453/picture?type=large", "display_name": "Ariel", "link": "https://stackoverflow.com/users/3228150/ariel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2119, "favorite_count": 0, "accepted_answer_id": 34028263, "answer_count": 1, "score": 0, "last_activity_date": 1448997465, "creation_date": 1448477668, "last_edit_date": 1448547866, "question_id": 33924366, "link": "https://stackoverflow.com/questions/33924366/c-mvc-routebase-routing-too-many-redirects", "title": "C# MVC RouteBase routing too many redirects", "body": "<p>I have this custom routing system where i will get the <strong>paths</strong>, <strong>controllers</strong>, <strong>views</strong> and <strong>areas</strong> from my <strong>DB</strong> and set them according to the <strong>requested path</strong>.</p>\n\n<p>My problem right now is that when i try to access one page it gives me the <code>too many redirects response</code>.</p>\n\n<p>What happens in this area is:</p>\n\n<ul>\n<li>User access page and fill a form;</li>\n<li>Form is posted using AJAX and then a redirect is made from jquery;</li>\n<li>User makes an appointment or generate a voucher;</li>\n</ul>\n\n<p>If the user tries to return to the previous page by typing it on the browser( i don't have any button to that link ) he gets the too many redirects problem.</p>\n\n<p>Since the code is kind of big i'm going to post it here: <a href=\"http://pastebin.com/yTdWKMp4\" rel=\"nofollow\">http://pastebin.com/yTdWKMp4</a></p>\n\n<p>I only left out my DB logic.</p>\n\n<p>What could be doing this ? I only could see the problem in this area but i don't know for sure it isn't happening in other areas.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>These are the headers from the requests</p>\n\n<pre><code>HTTP/1.1 302 Found\nCache-Control: private, no-store, max-age=1\nContent-Type: text/html; charset=utf-8\nContent-Encoding: gzip\nExpires: Wed, 25 Nov 2015 19:01:23 GMT\nLast-Modified: Wed, 25 Nov 2015 19:01:22 GMT\nEtag: \"\"\nLocation: /teste-lp\nServer: Microsoft-IIS/8.0\nX-AspNetMvc-Version: 3.0\nX-AspNet-Version: 4.0.30319\nX-Powered-By: ASP.NET\nX-UA-Compatible: IE=Edge,chrome=1\nDate: Wed, 25 Nov 2015 19:01:22 GMT\nContent-Length: 115\n\nHTTP/1.1 200 OK\nCache-Control: private, no-store, max-age=1\nContent-Type: text/html; charset=utf-8\nContent-Encoding: gzip\nExpires: Wed, 25 Nov 2015 19:02:10 GMT\nLast-Modified: Wed, 25 Nov 2015 19:02:09 GMT\nEtag: \"\"\nServer: Microsoft-IIS/8.0\nX-AspNetMvc-Version: 3.0\nX-AspNet-Version: 4.0.30319\nX-Powered-By: ASP.NET\nX-UA-Compatible: IE=Edge,chrome=1\nDate: Wed, 25 Nov 2015 19:02:12 GMT\nContent-Length: 6852\n</code></pre>\n\n<p><strong>EDIT 2</strong></p>\n\n<p>After much debugging and logging i found the beginning of the problem, it's related to a redirect i have when a certain session is null:</p>\n\n<pre><code>if (TempData[\"LeadID\"] == null || Session[\"UnidadeCE\"] == null)\n{\n    Response.Redirect( HelperMethods.CreateLink( Request.RawUrl.TrimStart( '/' ).Split( '/' )[0] ) );\n    Response.End();\n\n    return null;\n}\n</code></pre>\n\n<p>I have this verification at the appointment and voucher, if he tries to reload the page he is redirected to the form page. Now what is weird is, when he changes URL the RouteBase executes and tries to fetch the PageInfo( VirtualPath, Controller and View ) for that new URL and at the moment of my search for some reason i'm getting the page of appointment instead of the form one so i get back at the same page and the looping starts.</p>\n\n<p>I have updated my pastebin with the filtering and DB Search, there are no repeated records in my DB. It looks like some sort of freaking cache but the var is local and there's no sharing.</p>\n\n<p><strong>EDIT 3</strong></p>\n\n<p>After some var watching ( i have nearly 6k routes ) i found that the problem lies between my route checking on the pastebin file on line 128, that pageList parameter is my list of all routes from the cache, i do a url search based and then i take the route that i need, on line 167 is where my problem is located. At that moment i have copied the content of the route i want into my <code>freakingPage</code> var (not so cool, i know) and then i change the values of <code>Action</code> and <code>Controller</code> but what also happens is the value changes on the <code>pageList</code> var and also at the Cache, line 203.</p>\n\n<p>What could be causing this ?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 10328, "user_id": 4798077, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A03gw.jpg?s=128&g=1", "display_name": "Ron Beyer", "link": "https://stackoverflow.com/users/4798077/ron-beyer"}, "edited": false, "score": 0, "creation_date": 1448478161, "post_id": 33924234, "comment_id": 55609887, "body": "You should not put into a <code>using</code> statement something that you return. It will be disposed or closed at some point outside of the callers control."}], "answers": [{"tags": [], "owner": {"reputation": 28426, "user_id": 66849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/be5a20b7fb7b8c8be281a747ac4fa05d?s=128&d=identicon&r=PG", "display_name": "PHeiberg", "link": "https://stackoverflow.com/users/66849/pheiberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1448482904, "last_edit_date": 1448482904, "creation_date": 1448478482, "answer_id": 33924580, "question_id": 33924234, "link": "https://stackoverflow.com/questions/33924234/ado-net-dal-and-bll/33924580#33924580", "title": "ADO.NET DAL and BLL", "body": "<p>If you want to roll your own, something like this is better: </p>\n\n<pre><code>public class DataQuery\n{\n    private readonly string _connectionString;\n\n    public DataQuery(string connectionString)\n    {\n        _connectionString = connectionString;\n    }\n\n    public IEnumerable&lt;T&gt; GetList&lt;T&gt;(string procedure,\n        Func&lt;IDataRecord, T&gt; entityCreator,\n        params SqlParameter[] commandParameters\n        )\n    {\n        var result = new List&lt;T&gt;();\n        using (var connection = CreateConnection())\n        using (var command = CreateCommand(procedure, connection, commandParameters))\n        using (var reader = command.ExecuteReader())\n        {\n            result.Add(entityCreator(reader));\n        }\n        return result;\n    }\n\n    private SqlConnection CreateConnection()\n    {\n        var connection = new SqlConnection(_connectionString);\n        connection.Open();\n        return connection;\n    }\n\n    private static DbCommand CreateCommand(string procedure, \n        SqlConnection connection, SqlParameter[] commandParameters)\n    {\n        var command = new SqlCommand(procedure, connection)\n        {\n            CommandType = CommandType.StoredProcedure\n        };\n        command.Parameters.AddRange(commandParameters);\n        return command;\n    }\n}\n</code></pre>\n\n<p>Which you would call like this:</p>\n\n<pre><code>var connectionString = ConfigurationManager.ConnectionStrings[\"DefaultConnection\"]\n    .ConnectionString;\n\nvar query = new DataQuery(connectionString);\nFunc&lt;IDataRecord, DishesTypes&gt; creator = dr =&gt; \n    new DishesTypes\n    {\n        DishTypeId = (int)dr[\"DishTypeId\"],\n        DishType = (string)dr[\"DishType\"]\n    };\n\nvar results = query.GetList(\"DishesTypesSelectAllRows\", creator);\n</code></pre>\n\n<hr>\n\n<p>Otherwise, which I recommend, have a look at <a href=\"https://github.com/StackExchange/dapper-dot-net\" rel=\"nofollow\">Dapper</a>.</p>\n\n<p>Dapper would allow you to simply do:</p>\n\n<pre><code>var results = connection.Query&lt;DishesTypes&gt;(\"DishesTypesSelectAllRows\", \n    commandType: CommandType.StoredProcedure);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384, "user_id": 5508620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97df8be3125bcc658ca0413e24114920?s=128&d=identicon&r=PG", "display_name": "Brian Payne", "link": "https://stackoverflow.com/users/5508620/brian-payne"}, "is_accepted": false, "score": 0, "last_activity_date": 1448479822, "creation_date": 1448479822, "answer_id": 33924951, "question_id": 33924234, "link": "https://stackoverflow.com/questions/33924234/ado-net-dal-and-bll/33924951#33924951", "title": "ADO.NET DAL and BLL", "body": "<p>First of all, your <code>using</code> statement is closing your connection, so you cannot expect to return a useable <code>IDataReader</code>. Second, your connection is never opened, so you would not get a result, anyway. Having said that, if your dataset will always be small enough to fit in memory, you could use something like what I have done below. This should have minimal impact on your code.</p>\n\n<pre><code>    public class SqlHelper\n    {\n        public static IDataReader ExecuteReader(string procedure, params SqlParameter[] commandParameters)\n        {\n            using (var connection = new SqlConnection(ConfigurationManager.ConnectionStrings[\"DefaultConnection\"].ConnectionString))\n            {\n                connection.Open();\n                using (var command = new SqlCommand(procedure, connection))\n                {\n                    command.CommandType = CommandType.StoredProcedure;\n                    command.Parameters.AddRange(commandParameters);\n                    DataTable dt = new DataTable();\n                    using (SqlDataAdapter da = new SqlDataAdapter(command))\n                        da.Fill(dt);\n                    return dt.CreateDataReader();\n                }\n            }\n        }\n    }\n\n    public class DishesTypes\n    {\n        public static IDataReader DishesTypesSelectAll()\n        {\n            return SqlHelper.ExecuteReader(\"DishesTypesSelectAllRows\");//name of procedure\n        }\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4645880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3e0b33b10fd7b75e0e5796b956644d7a?s=128&d=identicon&r=PG&f=1", "display_name": "\u0415\u0432\u0433\u0435\u043d\u0438\u0439 \u041a\u0443\u0437\u043d\u0435\u0446\u043e\u0432", "link": "https://stackoverflow.com/users/4645880/%d0%95%d0%b2%d0%b3%d0%b5%d0%bd%d0%b8%d0%b9-%d0%9a%d1%83%d0%b7%d0%bd%d0%b5%d1%86%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 33924580, "answer_count": 2, "score": 1, "last_activity_date": 1448482904, "creation_date": 1448477209, "last_edit_date": 1448479441, "question_id": 33924234, "link": "https://stackoverflow.com/questions/33924234/ado-net-dal-and-bll", "title": "ADO.NET DAL and BLL", "body": "<p><strong><em>I have two classes <code>SqlHelper</code> and <code>DishesTypes</code> there are used in a DAL project</em></strong></p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class SqlHelper\n{ \n    public static SqlDataReader ExecuteReader(string procedure, \n        params SqlParameter[] commandParameters) \n    {             \n        using (var connection = new SqlConnection(\n            ConfigurationManager.ConnectionStrings[\"DefaultConnection\"].ConnectionString))       \n        using (var command = new SqlCommand(procedure, _connection)) \n        {                    \n            command.CommandType = CommandType.StoredProcedure;\n            command.Parameters.AddRange(commandParameters);\n            return command.ExecuteReader();                                 \n        }    \n    }\n\n    public class DishesTypes \n    {\n        public static SqlDataReader DishesTypesSelectAll() \n        {\n            return SqlHelper.ExecuteReader(\"DishesTypesSelectAllRows\"); //name of procedure\n        }\n    }\n</code></pre>\n\n<p><strong><em>And I have class <code>DishedTypes</code> that used in a BLL project like this</em></strong></p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>public class DishesTypes\n{\n    public int DishTypeId { get; set; }\n    public string DishType { get; set; }\n\n    public static List&lt;DishesTypes&gt; DishesTypesSelectAll()\n    {\n        IDataReader dr = DataAccessLayer.DishesTypes.DishesTypesSelectAll();          \n\n        List&lt;DishesTypes&gt; dishesTypesList = new List&lt;DishesTypes&gt;();\n\n        while (dr.Read())\n        {\n            DishesTypes myDishesTypes = new DishesTypes\n            {\n                DishTypeId = (int)dr[\"DishTypeId\"],\n                DishType = (string)dr[\"DishType\"]\n            };\n            dishesTypesList.Add(myDishesTypes);\n        }\n        return dishesTypesList;\n    }\n}\n</code></pre>\n\n<p>Problems starts here <code>while (dr.Read())</code>,The reason, the connection to this point has already closed and it is necessary to reconnect how best to change the implementation of classes adhering layers DAL and BLL, to work?</p>\n"}, {"tags": ["c#", "big-o", "keyedcollection"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1448477456, "post_id": 33924226, "comment_id": 55609469, "body": "Why are you not using the .NET <code>Dictionary</code>?  If you&#39;re implementing your own using a linear search, it&#39;s <i>going</i> to be a <i>lot</i> slower.  Don&#39;t do that."}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1448477459, "post_id": 33924226, "comment_id": 55609473, "body": "index on dictionary does not make sense. do you mean its <code>List&lt;T&gt;</code>? also dictionary type is <code>Dictionary&lt;T1,T2&gt;</code>"}, {"owner": {"reputation": 1596, "user_id": 1309672, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/280cb09d03255ca83164f6e0ef274652?s=128&d=identicon&r=PG", "display_name": "Middas", "link": "https://stackoverflow.com/users/1309672/middas"}, "edited": false, "score": 0, "creation_date": 1448477526, "post_id": 33924226, "comment_id": 55609512, "body": "It&#39;s an OrderedDictionary, I know there are performance hits in doing that by itself, but I&#39;m trying to optimize it as much as possible."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1448477569, "post_id": 33924226, "comment_id": 55609533, "body": "@Middas Using a custom implementation that&#39;s dramatically slower isn&#39;t a good way to improve performance.  Just use the .NET implementation."}, {"owner": {"reputation": 1596, "user_id": 1309672, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/280cb09d03255ca83164f6e0ef274652?s=128&d=identicon&r=PG", "display_name": "Middas", "link": "https://stackoverflow.com/users/1309672/middas"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1448477796, "post_id": 33924226, "comment_id": 55609668, "body": "@Servy I agree with you; however, in my scenario, I needed the flexibility that this custom implementation provides.  I tried switching it out with a List of objects that had a Name and the Value in the object, but there was no performance gain."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1448478167, "post_id": 33924226, "comment_id": 55609889, "body": "If you have additional behavior to provide then encapsulate a <code>Dictionary</code>, don&#39;t rewrite one.  Using a <code>List</code> will of course be just as slow, that&#39;s the same (flawed) design as what you&#39;ve shown here.  You need to avoid a linear search to improve performance."}, {"owner": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1448478173, "post_id": 33924226, "comment_id": 55609892, "body": "So KeyedCollection has a protected dictionary. Add a method <code>TryGetItem</code> to your KeyedCollection that calls <code>TryGetValue</code> on the dictionary. Then you could have something like the first method except you would only need 1 lookup by key and there would be no exception to handle."}, {"owner": {"reputation": 1596, "user_id": 1309672, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/280cb09d03255ca83164f6e0ef274652?s=128&d=identicon&r=PG", "display_name": "Middas", "link": "https://stackoverflow.com/users/1309672/middas"}, "reply_to_user": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1448478336, "post_id": 33924226, "comment_id": 55609998, "body": "@mikez Wouldn&#39;t that have the same overhead as my try-catch implementation because the exception is still thrown in the underlying class?"}, {"owner": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1448478636, "post_id": 33924226, "comment_id": 55610160, "body": "@Middas No. That is the point of <code>TryGetValue</code>. It is not a wrapper that catches an internally generated exception for you. It directly does the lookup and returns a boolean indicating success or failure. The indexer does the same lookup but throws if the item is not found."}, {"owner": {"reputation": 1596, "user_id": 1309672, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/280cb09d03255ca83164f6e0ef274652?s=128&d=identicon&r=PG", "display_name": "Middas", "link": "https://stackoverflow.com/users/1309672/middas"}, "reply_to_user": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1448479393, "post_id": 33924226, "comment_id": 55610577, "body": "@mikez Thanks, I&#39;ll give that a try as well to see if there are performance gains."}], "answers": [{"comments": [{"owner": {"reputation": 1596, "user_id": 1309672, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/280cb09d03255ca83164f6e0ef274652?s=128&d=identicon&r=PG", "display_name": "Middas", "link": "https://stackoverflow.com/users/1309672/middas"}, "edited": false, "score": 0, "creation_date": 1448477951, "post_id": 33924335, "comment_id": 55609768, "body": "Based on this answer, what is the better implementation?  The fixed O(1) of the try-catch implementation knowing that while the size is under a certain amount it will be slower, but the runtime will never increase?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 1596, "user_id": 1309672, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/280cb09d03255ca83164f6e0ef274652?s=128&d=identicon&r=PG", "display_name": "Middas", "link": "https://stackoverflow.com/users/1309672/middas"}, "edited": false, "score": 0, "creation_date": 1448478084, "post_id": 33924335, "comment_id": 55609842, "body": "@Middas The better implementation is to fix the core algorithm to one that has a better runtime, namely a hash based lookup or a tree based structure, rather than doing linear searches."}, {"owner": {"reputation": 1596, "user_id": 1309672, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/280cb09d03255ca83164f6e0ef274652?s=128&d=identicon&r=PG", "display_name": "Middas", "link": "https://stackoverflow.com/users/1309672/middas"}, "edited": false, "score": 0, "creation_date": 1448478186, "post_id": 33924335, "comment_id": 55609903, "body": "Thanks for your input, I&#39;ll look into that."}], "tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": true, "score": 3, "last_activity_date": 1448477529, "creation_date": 1448477529, "answer_id": 33924335, "question_id": 33924226, "link": "https://stackoverflow.com/questions/33924226/big-o-runtime-of-exceptions/33924335#33924335", "title": "Big O Runtime of Exceptions", "body": "<p>Throwing an exception here is going to be O(1), because the cost of throwing and catching the exception is in no way dependent on the size of the collection; it's going to be a fixed cost.  That fixed cost may be high, but it won't grow.</p>\n"}], "owner": {"reputation": 1596, "user_id": 1309672, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/280cb09d03255ca83164f6e0ef274652?s=128&d=identicon&r=PG", "display_name": "Middas", "link": "https://stackoverflow.com/users/1309672/middas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 33924335, "answer_count": 1, "score": 0, "last_activity_date": 1448477529, "creation_date": 1448477189, "last_edit_date": 1448477361, "question_id": 33924226, "link": "https://stackoverflow.com/questions/33924226/big-o-runtime-of-exceptions", "title": "Big O Runtime of Exceptions", "body": "<p>I have a custom <code>Dictionary&lt;T&gt;</code> that has a backing collection of <code>KeyedCollection</code>.  While trying to optimize performance issues that I'm seeing while running in a profiler, I noticed that the <code>IndexOf(T key)</code> is one of my problem areas.  The code is currently implemented as the following:</p>\n\n<pre><code>public int IndexOf(TKey key)\n{\n     if (keyedCollection.Contains(key))\n     {\n         return keyedCollection.IndexOf(keyedCollection[key]);\n     }\n     else\n     {\n         return -1;\n     }\n}\n</code></pre>\n\n<p>I know that both <code>Contains(T key)</code> and <code>IndexOf(T key)</code> have big-O runtimes of O(n) and have confirmed this on the MSDN site. (<a href=\"https://msdn.microsoft.com/en-us/library/ms132438(v=vs.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/ms132438(v=vs.110).aspx</a>)<br>\nI thought a good way to optimize this code would be to take out one of the O(n) operations, so I changed the code to this:</p>\n\n<pre><code>public int IndexOf(TKey key)\n{\n     try\n     {\n         return keyedCollection.IndexOf(keyedCollection[key]);\n     }\n     catch (KeyNotFoundException)\n     {\n         return -1;\n     }\n}\n</code></pre>\n\n<p>When I compared the runtimes between the 2 over about 500,000 operations, the code with the <code>Contains(T key)</code> out performed the try-catch scenario by a factor of nearly 2.</p>\n\n<p>My question is, is there a huge amount of overhead when using a try-catch block that would greatly decrease performance?</p>\n"}, {"tags": ["c#", "xml", "xmldocument"], "comments": [{"owner": {"reputation": 3929, "user_id": 698202, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/TgNgr.png?s=128&g=1", "display_name": "geedubb", "link": "https://stackoverflow.com/users/698202/geedubb"}, "edited": false, "score": 0, "creation_date": 1448477345, "post_id": 33924171, "comment_id": 55609404, "body": "You are cloning the node but not doing anything with it before you save."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5605503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-nsd9SYSKmEk/AAAAAAAAAAI/AAAAAAAAAJo/XO0NLLr7Id8/photo.jpg?sz=128", "display_name": "Ant&#243;nio Garcez", "link": "https://stackoverflow.com/users/5605503/ant%c3%b3nio-garcez"}, "edited": false, "score": 0, "creation_date": 1448486524, "post_id": 33924222, "comment_id": 55614147, "body": "I forgot to insert in the document...-.-, but I tried to duplicate with this: <code>ancestor_node.ParentNode.InsertAfter(ancestor_node, ancestor_node)</code> and didn&#39;t insert in the document. Is this option also wrong?"}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "reply_to_user": {"reputation": 61, "user_id": 5605503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-nsd9SYSKmEk/AAAAAAAAAAI/AAAAAAAAAJo/XO0NLLr7Id8/photo.jpg?sz=128", "display_name": "Ant&#243;nio Garcez", "link": "https://stackoverflow.com/users/5605503/ant%c3%b3nio-garcez"}, "edited": false, "score": 0, "creation_date": 1448486737, "post_id": 33924222, "comment_id": 55614259, "body": "You need to insert the clone, not the original., so it should be <code>ancestor_node.ParentNode.InsertAfter(clone, ancestor_node)</code>."}, {"owner": {"reputation": 61, "user_id": 5605503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-nsd9SYSKmEk/AAAAAAAAAAI/AAAAAAAAAJo/XO0NLLr7Id8/photo.jpg?sz=128", "display_name": "Ant&#243;nio Garcez", "link": "https://stackoverflow.com/users/5605503/ant%c3%b3nio-garcez"}, "edited": false, "score": 0, "creation_date": 1448620706, "post_id": 33924222, "comment_id": 55668886, "body": "I only click in the up arrow"}], "tags": [], "owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "is_accepted": true, "score": 1, "last_activity_date": 1448477170, "creation_date": 1448477170, "answer_id": 33924222, "question_id": 33924171, "link": "https://stackoverflow.com/questions/33924171/i-can-not-add-a-node-in-a-xml-file/33924222#33924222", "title": "I can not add a node in a XML file", "body": "<p>You are ignoring the return value of <code>ancestor_node.Clone();</code>. It returns an <code>XmlNode</code>. Insert that one in the document again.</p>\n"}], "owner": {"reputation": 61, "user_id": 5605503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-nsd9SYSKmEk/AAAAAAAAAAI/AAAAAAAAAJo/XO0NLLr7Id8/photo.jpg?sz=128", "display_name": "Ant&#243;nio Garcez", "link": "https://stackoverflow.com/users/5605503/ant%c3%b3nio-garcez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 33924222, "answer_count": 1, "score": 1, "last_activity_date": 1448477170, "creation_date": 1448476988, "question_id": 33924171, "link": "https://stackoverflow.com/questions/33924171/i-can-not-add-a-node-in-a-xml-file", "title": "I can not add a node in a XML file", "body": "<p>I have this code:</p>\n\n<pre><code>XmlDocument doc = new XmlDocument();\ndoc.Load(file_data);\nXmlNamespaceManager namespace_xml = new XmlNamespaceManager(doc.NameTable);\n\n//adicionar todos os namespaces necessarios\nforeach (KeyValuePair&lt;string, string&gt; namespace_elem in all_namespaces)\n{\n    namespace_xml.AddNamespace(namespace_elem.Key, namespace_elem.Value);\n}\n\nXmlNodeList node_list = doc.DocumentElement.SelectNodes(\"//w:tr//w:tc//w:p\", namespace_xml);\nRegex rgx = new Regex(@\"^\\{\\{[a-zA-Z0-9_]+\\}\\}$\");\n\nfor (int i = 0; i &lt; node_list.Count; i++)\n{\n    XmlNode node_elem = node_list[i];\n    Match mtch = rgx.Match(node_elem.InnerText);\n\n    if (mtch.Success)\n    {\n        //caso seja uma linha que tenha de ser inserida\n        XmlNode ancestor_node = null;\n        XmlNode aux_node_elem = node_elem;\n\n        while(aux_node_elem.ParentNode != null)\n        {\n            if (aux_node_elem.ParentNode.Name.Equals(\"w:tr\"))\n            {\n                ancestor_node = aux_node_elem.ParentNode;\n                break;\n            }\n\n            aux_node_elem = aux_node_elem.ParentNode;\n        }\n\n        ancestor_node.Clone();\n        doc.Save(file_data);\n        break;\n    }\n}\n</code></pre>\n\n<p>I want to find a node, in a XML file, whose text starts with \"{{\" and finishes with \"}}\" and duplicate his father. I can find that node but I can not duplicate his father. The following code is the XML that I want to use:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n&lt;w:document xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\" xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\" mc:Ignorable=\"w14 w15 wp14\"&gt;\n  &lt;w:body&gt;\n    &lt;w:tbl&gt;\n      &lt;w:tblPr&gt;\n        &lt;w:tblStyle w:val=\"GridTable4\" /&gt;\n        &lt;w:tblW w:w=\"0\" w:type=\"auto\" /&gt;\n        &lt;w:tblLook w:val=\"04A0\" w:firstRow=\"1\" w:lastRow=\"0\" w:firstColumn=\"1\" w:lastColumn=\"0\" w:noHBand=\"0\" w:noVBand=\"1\" /&gt;\n      &lt;/w:tblPr&gt;\n      &lt;w:tblGrid&gt;\n        &lt;w:gridCol w:w=\"1698\" /&gt;\n        &lt;w:gridCol w:w=\"1699\" /&gt;\n        &lt;w:gridCol w:w=\"1699\" /&gt;\n        &lt;w:gridCol w:w=\"1699\" /&gt;\n        &lt;w:gridCol w:w=\"1699\" /&gt;\n      &lt;/w:tblGrid&gt;\n      &lt;w:tr w:rsidR=\"0090425B\" w:rsidTr=\"0090425B\"&gt;\n        &lt;w:trPr&gt;\n          &lt;w:cnfStyle w:val=\"100000000000\" w:firstRow=\"1\" w:lastRow=\"0\" w:firstColumn=\"0\" w:lastColumn=\"0\" w:oddVBand=\"0\" w:evenVBand=\"0\" w:oddHBand=\"0\" w:evenHBand=\"0\" w:firstRowFirstColumn=\"0\" w:firstRowLastColumn=\"0\" w:lastRowFirstColumn=\"0\" w:lastRowLastColumn=\"0\" /&gt;\n        &lt;/w:trPr&gt;\n        &lt;w:tc&gt;\n          &lt;w:tcPr&gt;\n            &lt;w:cnfStyle w:val=\"001000000000\" w:firstRow=\"0\" w:lastRow=\"0\" w:firstColumn=\"1\" w:lastColumn=\"0\" w:oddVBand=\"0\" w:evenVBand=\"0\" w:oddHBand=\"0\" w:evenHBand=\"0\" w:firstRowFirstColumn=\"0\" w:firstRowLastColumn=\"0\" w:lastRowFirstColumn=\"0\" w:lastRowLastColumn=\"0\" /&gt;\n            &lt;w:tcW w:w=\"1698\" w:type=\"dxa\" /&gt;\n          &lt;/w:tcPr&gt;\n          &lt;w:p w:rsidR=\"0090425B\" w:rsidRDefault=\"0090425B\"&gt;\n            &lt;w:r&gt;\n              &lt;w:t&gt;Cabe\u00e7alho 1&lt;/w:t&gt;\n            &lt;/w:r&gt;\n          &lt;/w:p&gt;\n        &lt;/w:tc&gt;\n        &lt;w:tc&gt;\n          &lt;w:tcPr&gt;\n            &lt;w:tcW w:w=\"1699\" w:type=\"dxa\" /&gt;\n          &lt;/w:tcPr&gt;\n          &lt;w:p w:rsidR=\"0090425B\" w:rsidRDefault=\"0090425B\"&gt;\n            &lt;w:pPr&gt;\n              &lt;w:cnfStyle w:val=\"100000000000\" w:firstRow=\"1\" w:lastRow=\"0\" w:firstColumn=\"0\" w:lastColumn=\"0\" w:oddVBand=\"0\" w:evenVBand=\"0\" w:oddHBand=\"0\" w:evenHBand=\"0\" w:firstRowFirstColumn=\"0\" w:firstRowLastColumn=\"0\" w:lastRowFirstColumn=\"0\" w:lastRowLastColumn=\"0\" /&gt;\n            &lt;/w:pPr&gt;\n            &lt;w:r&gt;\n              &lt;w:t&gt;Cabe\u00e7alho 2&lt;/w:t&gt;\n            &lt;/w:r&gt;\n          &lt;/w:p&gt;\n        &lt;/w:tc&gt;\n      &lt;/w:tr&gt;\n    &lt;/w:tbl&gt;\n    &lt;w:p w:rsidR=\"00163F00\" w:rsidRDefault=\"00163F00\"&gt;\n      &lt;w:bookmarkStart w:id=\"0\" w:name=\"_GoBack\" /&gt;\n      &lt;w:bookmarkEnd w:id=\"0\" /&gt;\n    &lt;/w:p&gt;\n    &lt;w:sectPr w:rsidR=\"00163F00\"&gt;\n      &lt;w:pgSz w:w=\"11906\" w:h=\"16838\" /&gt;\n      &lt;w:pgMar w:top=\"1417\" w:right=\"1701\" w:bottom=\"1417\" w:left=\"1701\" w:header=\"708\" w:footer=\"708\" w:gutter=\"0\" /&gt;\n      &lt;w:cols w:space=\"708\" /&gt;\n      &lt;w:docGrid w:linePitch=\"360\" /&gt;\n    &lt;/w:sectPr&gt;\n  &lt;/w:body&gt;\n&lt;/w:document&gt;\n</code></pre>\n\n<p>I try everything but I can not add a new node in the XML file. What did I make wrong?</p>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 5107, "user_id": 5554372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b825ef37da46ff65c28aa741225ef464?s=128&d=identicon&r=PG&f=1", "display_name": "Valentin", "link": "https://stackoverflow.com/users/5554372/valentin"}, "edited": false, "score": 0, "creation_date": 1448478397, "post_id": 33924168, "comment_id": 55610032, "body": "As I far as I concern, Renderer.bounds are a result of the position, scale and rotation. What behaviour you want to implement?"}], "answers": [{"tags": [], "owner": {"reputation": 5107, "user_id": 5554372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b825ef37da46ff65c28aa741225ef464?s=128&d=identicon&r=PG&f=1", "display_name": "Valentin", "link": "https://stackoverflow.com/users/5554372/valentin"}, "is_accepted": false, "score": 0, "last_activity_date": 1448478538, "creation_date": 1448478538, "answer_id": 33924595, "question_id": 33924168, "link": "https://stackoverflow.com/questions/33924168/unity-renderer-bounds-issue/33924595#33924595", "title": "Unity Renderer.bounds issue?", "body": "<p>You can't change <code>Renderer.bounds</code>. You can try to change <code>Mesh.bounds</code></p>\n"}, {"tags": [], "owner": {"reputation": 498, "user_id": 2643689, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/42866f7fe1c0675a90a9f82267728899?s=128&d=identicon&r=PG", "display_name": "Orren Ravid", "link": "https://stackoverflow.com/users/2643689/orren-ravid"}, "is_accepted": false, "score": 0, "last_activity_date": 1448478559, "creation_date": 1448478559, "answer_id": 33924604, "question_id": 33924168, "link": "https://stackoverflow.com/questions/33924168/unity-renderer-bounds-issue/33924604#33924604", "title": "Unity Renderer.bounds issue?", "body": "<p>It appears that the Renderer's bounds in Unity are read only. According to the documentation at <a href=\"http://docs.unity3d.com/ScriptReference/Renderer-bounds.html\" rel=\"nofollow\">http://docs.unity3d.com/ScriptReference/Renderer-bounds.html</a> , </p>\n\n<p>The renderer is</p>\n\n<blockquote>\n  <p>The bounding volume of the renderer (Read Only).</p>\n</blockquote>\n\n<p>I currently haven't found any way to change the renderer settings in Unity's documentation but I will change my answer accordingly when I do.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5601572"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 630, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1448478588, "creation_date": 1448476976, "last_edit_date": 1448478588, "question_id": 33924168, "link": "https://stackoverflow.com/questions/33924168/unity-renderer-bounds-issue", "title": "Unity Renderer.bounds issue?", "body": "<p>I would like to make rend.bounds.max.y be always equal to 20 on collision no matter what, using the script below. But it seems that I can't set it manually and the script has no effect on my GameObject.</p>\n\n<p>Script:</p>\n\n<pre><code>public class ClassKey : MonoBehaviour{\n\nvoid Start()\n   { \n       rend = GetComponent&lt;Renderer&gt;();\n   }\n\nvoid OnCollisionEnter(Collision col)\n   {\n       //more code\n       rend.bounds.max.y = 20;\n       //more code\n   }\n}\n</code></pre>\n\n<p>What I want to achieve: \"Change <code>rend.bounds.max.y</code> to 20 when colliding (and keep 20 forever), and let <code>rend.bounds.max.x</code> and <code>rend.bounds.max.z</code> vary freely when colliding\"</p>\n\n<p>The problem: Renderer.bounds is read only... How can I go around this?</p>\n"}, {"tags": ["c#", "methods"], "comments": [{"owner": {"reputation": 4689, "user_id": 1296030, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qhTIW.png?s=128&g=1", "display_name": "lintmouse", "link": "https://stackoverflow.com/users/1296030/lintmouse"}, "edited": false, "score": 0, "creation_date": 1448476816, "post_id": 33924050, "comment_id": 55609114, "body": "Where exactly are you putting your break points?"}, {"owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "edited": false, "score": 1, "creation_date": 1448476835, "post_id": 33924050, "comment_id": 55609123, "body": "This is not an answer to your question, but you should <a href=\"http://haacked.com/archive/2014/11/11/async-void-methods/\" rel=\"nofollow noreferrer\">avoid async void methods</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5178825"}, "edited": false, "score": 0, "creation_date": 1448476866, "post_id": 33924050, "comment_id": 55609138, "body": "whenever it enters the if (i &lt; 2)"}, {"owner": {"reputation": 1247, "user_id": 2066142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534a5578fc14238a5f94159410d53cc8?s=128&d=identicon&r=PG", "display_name": "KiwiPiet", "link": "https://stackoverflow.com/users/2066142/kiwipiet"}, "edited": false, "score": 0, "creation_date": 1448476922, "post_id": 33924050, "comment_id": 55609174, "body": "Have you put a break inside the Colors method?"}, {"owner": {"reputation": 4689, "user_id": 1296030, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qhTIW.png?s=128&g=1", "display_name": "lintmouse", "link": "https://stackoverflow.com/users/1296030/lintmouse"}, "edited": false, "score": 0, "creation_date": 1448476998, "post_id": 33924050, "comment_id": 55609205, "body": "@Assim - what happens when you comment out <code>Task.Delay()</code>?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5178825"}, "is_accepted": true, "score": 0, "last_activity_date": 1448477096, "creation_date": 1448477096, "answer_id": 33924203, "question_id": 33924050, "link": "https://stackoverflow.com/questions/33924050/c-method-not-getting-called/33924203#33924203", "title": "c# Method not getting called", "body": "<p>Just did Clean and Rebuild of the solution that did the job for me thanks to Ron Beyer for the quick answer ! Cheers..</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5178825"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "closed_date": 1460272656, "accepted_answer_id": 33924203, "answer_count": 1, "score": -1, "last_activity_date": 1448477096, "creation_date": 1448476522, "last_edit_date": 1448476815, "question_id": 33924050, "link": "https://stackoverflow.com/questions/33924050/c-method-not-getting-called", "closed_reason": "Not suitable for this site", "title": "c# Method not getting called", "body": "<p>as the title says my method \"Colors\" is not getting called at multiple places i tried putting a break point but it just skip's the method and keep's going on and on here's the method code</p>\n\n<pre><code>void Colors(int start, int end, string name)\n{\n    for (int j = 0; j &lt;= 13; j++)\n    {\n        for (int p = start; p &lt; end; p++)\n        {\n            if (Reserve[p].Contains(\"clubs\"))\n            {\n                string a = j.ToString() + \"_clubs\";\n                string b = j.ToString() + \"-clubs\";\n                clubs++;\n                if (Reserve[p].Contains(a) || Reserve[p].Contains(b))\n                {\n                    if (maxClubs &lt;= j)\n                    {\n                        maxClubs = j;\n                        if (Cvqt.Contains(maxClubs.ToString() + \" \" + \"maxClub \" + name))\n                        {\n\n                        }\n                        else\n                        {\n                            Cvqt.Add(maxClubs + \" \" + \"maxClub \" + name);\n                        }\n                        if (Cvqt.Contains(clubs.ToString() + \" \" + \"clubs\" + name))\n                        {\n\n                        }\n                        else\n                        {\n                            Cvqt.Add(clubs + \" \" + \"clubs\" + name);\n                        }\n                        /////////////////////////////\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>And here i call the method</p>\n\n<pre><code>async void Shuffle()\n{\n    bool check = false;\n    Bitmap backImage = new Bitmap(\"Assets\\\\Back\\\\Back.png\");\n    int horizontal = 580, vertical = 480;\n    Random r = new Random();\n    for (i = ImgLocation.Length; i &gt; 0; i--)\n    {\n        int j = r.Next(i);\n        var k = ImgLocation[j];\n        ImgLocation[j] = ImgLocation[i - 1];\n        ImgLocation[i - 1] = k;\n    }\n    for (i = 0; i &lt; 17; i++)\n    {\n        Deck[i] = Image.FromFile(ImgLocation[i]);\n        Reserve[i] = ImgLocation[i];\n        Holder[i] = new PictureBox();\n        Holder[i].SizeMode = PictureBoxSizeMode.StretchImage;\n        Holder[i].Height = 130;\n        Holder[i].Width = 80;\n        this.Controls.Add(Holder[i]);\n        Holder[i].Name = \"pb\" + i.ToString();\n        await Task.Delay(200);\n        if (i &lt; 2)\n        {\n            Holder[i].Image = Deck[i];\n\n            if (Holder[0].Tag != null)\n            {\n                Holder[1].Tag = Reserve[1];\n            }\n            Holder[0].Tag = Reserve[0];\n            Holder[i].Location = new Point(horizontal, vertical);\n            horizontal += Holder[i].Width;\n            Colors(0, 1, \"Player\"); //it's just skipping this part here\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "winforms", "performance", "next"], "comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 2, "creation_date": 1448476784, "post_id": 33923995, "comment_id": 55609093, "body": "You are re-loading the image every time.  Try just changing the active frame when navigating pages."}, {"owner": {"reputation": 9587, "user_id": 747965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2fzty.jpg?s=128&g=1", "display_name": "Glenn Ferrie", "link": "https://stackoverflow.com/users/747965/glenn-ferrie"}, "edited": false, "score": 3, "creation_date": 1448476827, "post_id": 33923995, "comment_id": 55609118, "body": "You need to devise a caching strategy that works for your app.  For example, after you load page 1, on a separate Thread (pre-.NET) or Task (.NET 4 or better) you can load pages 2 - 10 and keep them readily available when the page is changed.  This is not a quick fix, you need to also think about how often you refresh your cache, etc."}, {"owner": {"reputation": 1390, "user_id": 713865, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b845379b752baf685c6d11094b31204?s=128&d=identicon&r=PG", "display_name": "sovemp", "link": "https://stackoverflow.com/users/713865/sovemp"}, "edited": false, "score": 1, "creation_date": 1448477099, "post_id": 33923995, "comment_id": 55609254, "body": "Also, you can make sure you are not validating the image data when you call FromStream, which will improve your performace.  See this:  <a href=\"http://blogs.msdn.com/b/omars/archive/2004/03/29/100941.aspx\" rel=\"nofollow noreferrer\">blogs.msdn.com/b/omars/archive/2004/03/29/100941.aspx</a>"}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1448478224, "post_id": 33923995, "comment_id": 55609923, "body": "I tried looking at active frame, but i couldn&#39;t wrap my head around it. I&#39;m new to programming so some of the concepts are foggy. @LarsTech"}], "answers": [{"comments": [{"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448478975, "post_id": 33924507, "comment_id": 55610351, "body": "When i tested this i received a GDI+ error. The number of pages incremented on my form but the image did not refresh. Meaning that when i clicked next to go to page 2. The image in page 2 did not show."}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448479406, "post_id": 33924507, "comment_id": 55610582, "body": "It threw an exception?  Did you copy/paste the code exactly? Or is this just an example similar to what you&#39;re working on?  And what was the exception that got thrown?  Also, I didn&#39;t notice this when I was refactoring your code, but what is the purpose of &quot;image2&quot; in btnNextImage_Click_1?  That can be removed (I&#39;ll edit)"}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448479829, "post_id": 33924507, "comment_id": 55610807, "body": "yeah i copied and pasted it again, and it did the same thing. I think the error is here: _myImg.SelectActiveFrame(System.Drawing.Imaging.FrameDimensi&zwnj;&#8203;on.Page, int_Current_Page);... The image2 is nothing i forgot to take that off. I was just trying different ways to make this work."}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448479912, "post_id": 33924507, "comment_id": 55610853, "body": "What is the value of int_Current_Page at the time of the error?"}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448480023, "post_id": 33924507, "comment_id": 55610904, "body": "The value of int_Current_Page increases every time i hit the next button."}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448480089, "post_id": 33924507, "comment_id": 55610934, "body": "The only thing that wont show is the next image in the Tif document"}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448480100, "post_id": 33924507, "comment_id": 55610939, "body": "What was the error message that was thrown when this occurred?"}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 1, "creation_date": 1448480860, "post_id": 33924507, "comment_id": 55611332, "body": "Try it with &quot;FromFile&quot; (see my edit). It&#39;s possible that &quot;FromStream&quot; requires that Stream to remain open for the lifetime of that image&#39;s manipulation (that using block will close and dispose that stream)."}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448481371, "post_id": 33924507, "comment_id": 55611570, "body": "The performance increased and the GDI+ error was removed, but i needed a way to dispose the file that&#39;s why i used the using statement."}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 1, "creation_date": 1448481724, "post_id": 33924507, "comment_id": 55611739, "body": "So it&#39;s working now?  :)  What do you mean by &quot;dispose&quot; the file? Dispose means cleaning up unmanaged resources when the object is no longer in use.  FromFile is handling all of that for you.  If you mean Dispose as in delete the file, that&#39;s a different API call (<code>File.Delete()</code>)."}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448482329, "post_id": 33924507, "comment_id": 55612050, "body": "With the using statement i was able to delete the file in the directory. Every time i use FromFile(); The method locks the file. I can&#39;t go in the directory and delete the file."}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448483127, "post_id": 33924507, "comment_id": 55612445, "body": "I see. Well that&#39;s an annoying bug. I corrected it using information found here: <a href=\"http://stackoverflow.com/questions/6576341/open-image-from-file-then-release-lock\" title=\"open image from file then release lock\">stackoverflow.com/questions/6576341/&hellip;</a>  See if that works. :)"}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448483666, "post_id": 33924507, "comment_id": 55612704, "body": "I just tried implementing the &quot;using&quot; and the image displayed, but now my lblNumPage = 0 and lblCurrPage = 0. Meaning: The application thinks there is only 1 image. So when i click next non of the other images display."}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 1, "creation_date": 1448484057, "post_id": 33924507, "comment_id": 55612927, "body": "Well that&#39;s weird. The other thing you could do is revert back to the way you were before, but store that stream as a member variable as well. You wouldn&#39;t be able to use the &quot;using&quot; statement, and you&#39;d have to close/Dispose it when the form is disposed (probably have to override the form&#39;s Dispose method to include that)."}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448484392, "post_id": 33924507, "comment_id": 55613101, "body": "How can i implement that?"}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448485600, "post_id": 33924507, "comment_id": 55613666, "body": "I tried implementing this in the protected override void Dispose i get an error: Form1 already defines a member called &#39;Dispose&#39; with the same parameter types."}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 1, "creation_date": 1448485855, "post_id": 33924507, "comment_id": 55613806, "body": "That means that form already has a dispose override somewhere.  Locate the method and add the <code>if (_stream != null) _stream.Dispose();</code> line to that.  It might be in the .designer.cs file."}, {"owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448486307, "post_id": 33924507, "comment_id": 55614053, "body": "I just caught that thanks, I tested it out again. I went to the directory while the application was open and while i was viewing the file. I tried deleting the file i was viewing it was still locked. When i try deleting it. Windows error message says File In Use: The action can&#39;t be completed because the file is open in vshost32.exe (visual studio)"}, {"owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "reply_to_user": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "edited": false, "score": 0, "creation_date": 1448486676, "post_id": 33924507, "comment_id": 55614226, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/96189/discussion-between-mutantninjacodemonkey-and-taji01\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1189, "user_id": 92196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6105f5790872b848e0d36ba4b3bc9419?s=128&d=identicon&r=PG", "display_name": "MutantNinjaCodeMonkey", "link": "https://stackoverflow.com/users/92196/mutantninjacodemonkey"}, "is_accepted": true, "score": 1, "last_activity_date": 1448484501, "last_edit_date": 1448484501, "creation_date": 1448478225, "answer_id": 33924507, "question_id": 33923995, "link": "https://stackoverflow.com/questions/33923995/speed-up-application-when-moving-to-the-next-page/33924507#33924507", "title": "Speed Up Application when Moving to the Next Page", "body": "<p>This is probably slowing down in one of two places, either loading the enormous file (hopefully) or Selecting the active frame.  If it's the first issue, it's probably easy to fix just by lazy-loading the image one time:</p>\n\n<pre><code>private int int_Current_Page = 0;\n\nprivate void btnNextImage_Click_1(object sender, EventArgs e)\n{\n    Image image2;\n    try\n    {\n        if (int_Current_Page == Convert.ToInt32(lblNumPages.Text)) // if you have reached the last page it ends here\n                                                              // the \"-1\" should be there for normalizing the number of pages\n        { int_Current_Page = Convert.ToInt32(lblNumPages.Text); }\n        else\n        {                   \n            int_Current_Page++; //page increment\n            Refresh_Image();\n        }\n    }\n    catch(Exception ex)\n    {\n        MessageBox.Show(ex.Message);\n    }\n}\n\nprivate void btnPrevImage_Click_1(object sender, EventArgs e)\n{\n    if (int_Current_Page == 0) // it stops here if you reached the bottom, the first page of the tiff\n    { int_Current_Page = 0; }\n    else\n    {\n        int_Current_Page--; // if its not the first page, then go to the previous page\n        Refresh_Image(); // refresh the image on the selected page\n    }\n}\n\nprivate void openButton_Click_1(object sender, EventArgs e)\n{\n    Refresh_Image(); //Opens the large image document\n}\nFileStream _stream; \nImage _myImg; // setting the selected tiff\nprivate void Refresh_Image()\n{\n    // Image myImg; // setting the selected tiff - Now a member variable\n    Image myBmp; // a new occurance of Image for viewing\n\n    if (_myImg == null)\n    {\n        _stream = new FileStream(@\"C:\\my_Image_document\", FileMode.Open, FileAccess.Read)\n        _myImg = Image.FromStream(_Stream);\n    }\n    int intPages = _myImg.GetFrameCount(System.Drawing.Imaging.FrameDimension.Page); // getting the number of pages of this tiff\n    intPages--; // the first page is 0 so we must correct the number of pages to -1\n    lblNumPages.Text = Convert.ToString(intPages); // showing the number of pages\n    lblCurrPage.Text = Convert.ToString(int_Current_Page); // showing the number of page on which we're on\n\n    _myImg.SelectActiveFrame(System.Drawing.Imaging.FrameDimension.Page, int_Current_Page); // going to the selected page\n\n    myBmp = new Bitmap(_myImg, pictureBox1.Width, pictureBox1.Height);\n\n    pictureBox1.Image = myBmp; // showing the page in the pictureBox1  \n}\n\nprotected override void Dispose(bool disposing)\n{\n    if (_stream != null) _stream.Dispose();\n    base.Dispose(disposing);\n}\n</code></pre>\n"}], "owner": {"reputation": 2111, "user_id": 4767245, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c23b01ed37481415f3dd18b405ad74d9?s=128&d=identicon&r=PG&f=1", "display_name": "taji01", "link": "https://stackoverflow.com/users/4767245/taji01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 2, "accepted_answer_id": 33924507, "answer_count": 1, "score": 0, "last_activity_date": 1448484501, "creation_date": 1448476342, "last_edit_date": 1448481091, "question_id": 33923995, "link": "https://stackoverflow.com/questions/33923995/speed-up-application-when-moving-to-the-next-page", "title": "Speed Up Application when Moving to the Next Page", "body": "<p>I\u2019m using WinForms. In my Form I have a picture-box that displays image documents. These image documents have many pages. I have an open, next, and previous button on my form. The next button goes forward one page, and the previous button goes back one page in the document that\u2019s opened in the picture-box. I also have labels on my form to indicate how much pages there are, and what page the user is currently viewing. </p>\n\n<p>The problem with my code is when i open large image files into my picture-box, for example documents that has 1200 pages, and click next. The page loads up slow. I want to improve the performance of the code. </p>\n\n<p>How can i make viewing the image documents faster or my code better?</p>\n\n<p>I provided a tif document to test on: <a href=\"http://www.filedropper.com/sampletifdocument5pages\" rel=\"nofollow noreferrer\">http://www.filedropper.com/sampletifdocument5pages</a></p>\n\n<pre><code>    private int int_Current_Page = 0;\n\n    private void btnNextImage_Click_1(object sender, EventArgs e)\n    {\n        Image image2;\n        try\n        {\n            if (int_Current_Page == Convert.ToInt32(lblNumPages.Text)) // if you have reached the last page it ends here\n                                                                  // the \"-1\" should be there for normalizing the number of pages\n            { int_Current_Page = Convert.ToInt32(lblNumPages.Text); }\n            else\n            {                   \n                int_Current_Page++; //page increment\n\n                using (FileStream stream = new FileStream(@\"C:\\my_Image_document\", FileMode.Open, FileAccess.Read))\n                {\n                    image2 = Image.FromStream(stream);\n                    Refresh_Image();\n                } \n            }\n        }\n        catch(Exception ex)\n        {\n            MessageBox.Show(ex.Message);\n        }\n    }\n\n    private void btnPrevImage_Click_1(object sender, EventArgs e)\n    {\n        if (int_Current_Page == 0) // it stops here if you reached the bottom, the first page of the tiff\n        { int_Current_Page = 0; }\n        else\n        {\n            int_Current_Page--; // if its not the first page, then go to the previous page\n            Refresh_Image(); // refresh the image on the selected page\n        }\n    }\n\n    private void openButton_Click_1(object sender, EventArgs e)\n    {\n        Refresh_Image(); //Opens the large image document\n    }\n\n    private void Refresh_Image()\n    {\n        Image myImg; // setting the selected tiff\n        Image myBmp; // a new occurance of Image for viewing\n\n        using (FileStream stream = new FileStream(@\"C:\\my_Image_document\", FileMode.Open, FileAccess.Read))\n        {\n            myImg = Image.FromStream(stream);\n\n            int intPages = myImg.GetFrameCount(System.Drawing.Imaging.FrameDimension.Page); // getting the number of pages of this tiff\n            intPages--; // the first page is 0 so we must correct the number of pages to -1\n            lblNumPages.Text = Convert.ToString(intPages); // showing the number of pages\n            lblCurrPage.Text = Convert.ToString(int_Current_Page); // showing the number of page on which we're on\n\n            myImg.SelectActiveFrame(System.Drawing.Imaging.FrameDimension.Page, int_Current_Page); // going to the selected page\n\n            myBmp = new Bitmap(myImg, pictureBox1.Width, pictureBox1.Height);\n\n            pictureBox1.Image = myBmp; // showing the page in the pictureBox1  \n        }\n    }\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3wv3U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3wv3U.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "wpf", "scroll", "treeview"], "comments": [{"owner": {"reputation": 4480, "user_id": 1440057, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/TBIqJ.jpg?s=128&g=1", "display_name": "Nikhil Vartak", "link": "https://stackoverflow.com/users/1440057/nikhil-vartak"}, "edited": false, "score": 0, "creation_date": 1448476838, "post_id": 33923959, "comment_id": 55609124, "body": "This is a similar question with accepted answer. <a href=\"http://stackoverflow.com/questions/2064848/wpf-datagrid-how-do-i-stop-auto-scrolling-when-a-cell-is-clicked\" title=\"wpf datagrid how do i stop auto scrolling when a cell is clicked\">stackoverflow.com/questions/2064848/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4875, "user_id": 1144624, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/c640c2471d507b73b93d5cb34eaebfed?s=128&d=identicon&r=PG", "display_name": "Kcvin", "link": "https://stackoverflow.com/users/1144624/kcvin"}, "is_accepted": true, "score": 1, "last_activity_date": 1448480934, "last_edit_date": 1495540318, "creation_date": 1448480934, "answer_id": 33925241, "question_id": 33923959, "link": "https://stackoverflow.com/questions/33923959/list-scrolls-horizontally-when-item-is-clicked/33925241#33925241", "title": "List scrolls horizontally when item is clicked", "body": "<p>Here is a working solution which derives from the <a href=\"https://stackoverflow.com/a/5538532/1144624\">answer</a> in this <a href=\"https://stackoverflow.com/questions/2064848/wpf-datagrid-how-do-i-stop-auto-scrolling-when-a-cell-is-clicked\">question</a>:</p>\n\n<h2>Code-behind</h2>\n\n<pre><code>public partial class MainWindow : Window\n{\n    public List&lt;Item&gt; Items\n    {\n        get\n        {\n            return new List&lt;Item&gt;()\n            {\n                new Item(),\n                new Item(),\n                new Item(),\n                new Item(),\n            };\n        }\n    }\n    public MainWindow()\n    {\n        InitializeComponent();\n        DataContext = this;\n    }\n\n    private void TreeViewItem_CancelRequestBringIntoView(object sender, RequestBringIntoViewEventArgs e)\n    {\n        e.Handled = true;\n    }\n}\n</code></pre>\n\n<h2>Model</h2>\n\n<pre><code>public class Item\n{\n    public string Text\n    {\n        get\n        {\n            return \"Itemaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\";\n        }\n    }\n\n    public List&lt;Item&gt; Items\n    {\n        get\n        {\n            return new List&lt;Item&gt;()\n            {\n                new Item(),\n                new Item(),\n                new Item(),\n            };\n        }\n    }\n}\n</code></pre>\n\n<h2>View</h2>\n\n<pre><code>&lt;Grid Width=\"200\"&gt;\n    &lt;TreeView ItemsSource=\"{Binding Items}\"&gt;\n        &lt;TreeView.ItemTemplate&gt;\n            &lt;HierarchicalDataTemplate ItemsSource=\"{Binding Items}\"&gt;\n                &lt;TextBlock Text=\"{Binding Text}\"/&gt;\n            &lt;/HierarchicalDataTemplate&gt;\n        &lt;/TreeView.ItemTemplate&gt;\n        &lt;TreeView.ItemContainerStyle&gt;\n            &lt;Style TargetType=\"{x:Type TreeViewItem}\"&gt;\n                &lt;EventSetter Event=\"Control.RequestBringIntoView\"\n                             Handler=\"TreeViewItem_CancelRequestBringIntoView\" /&gt;\n            &lt;/Style&gt;\n        &lt;/TreeView.ItemContainerStyle&gt;\n    &lt;/TreeView&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<h2>Output</h2>\n\n<p><a href=\"https://i.stack.imgur.com/6pBPI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6pBPI.png\" alt=\"Proof\"></a></p>\n"}], "owner": {"reputation": 3713, "user_id": 514875, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HNnwT.png?s=128&g=1", "display_name": "Black Dynamite", "link": "https://stackoverflow.com/users/514875/black-dynamite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 33925241, "answer_count": 1, "score": 0, "last_activity_date": 1448481573, "creation_date": 1448476208, "last_edit_date": 1448481573, "question_id": 33923959, "link": "https://stackoverflow.com/questions/33923959/list-scrolls-horizontally-when-item-is-clicked", "title": "List scrolls horizontally when item is clicked", "body": "<p>I have a problem with my <code>TreeView</code> and <code>DataGrid</code>.  The issue is that whenever I click an item in my <code>TreeView</code> (or <code>DataGrid</code>), the view horizontally scrolls to the right, I'm guessing, in a bid to make it more visible.  I've got some images of my <code>TreeView</code> below:</p>\n\n<p>Before Item Click:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kiNCq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kiNCq.png\" alt=\"Before Item Click\"></a></p>\n\n<p>After Item Click</p>\n\n<p><a href=\"https://i.stack.imgur.com/bWzOR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bWzOR.png\" alt=\"After Item Click\"></a></p>\n\n<p>I'm sure I could disable the Horizontal scrollbar, but I would still like the user to have the option to scroll, just not auto-scroll when an item is clicked.</p>\n\n<p>Any help on this is greatly appreciated and just for the sake of completeness, I've attached my TreeView code below:</p>\n\n<pre><code>&lt;TreeView x:Name=\"TreeView\" \n          ItemsSource=\"{Binding Path=FileStubsView}\"\n          SelectedItemChanged=\"TreeView_OnSelectedItemChanged\"\n          common:MultipleSelectTreeView.PreviewMouseDoubleClick=\"HandleTreeItemDoubleClick\"\n          Tag=\"{Binding DataContext,RelativeSource={RelativeSource Mode=Self}}\"\n          Grid.Row=\"1\" \n          Grid.Column=\"0\" \n          Margin=\"0,2,0,0\" \n          TreeViewItem.Expanded=\"TreeViewItem_Expanded\" \n          TreeViewItem.Collapsed=\"TreeViewItem_Collapsed\" &gt;\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "validation"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1448498526, "post_id": 33923958, "comment_id": 55618586, "body": "The use a view model as it should be used. <code>LocationsViewModel</code> should not contain you data model, just the properties you want in the view (which will not have validation attributes applied to them)"}], "answers": [{"comments": [{"owner": {"reputation": 1326, "user_id": 3960185, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/y6LB5.jpg?s=128&g=1", "display_name": "Julio Schurt", "link": "https://stackoverflow.com/users/3960185/julio-schurt"}, "edited": false, "score": 0, "creation_date": 1448914327, "post_id": 33924075, "comment_id": 55770083, "body": "I can&#180;t use <code>ModelState.Remove (&quot;yourObject&quot;)</code> but we can use <code>ModelState.Remove(&quot;yourObject.property&quot;);</code> instead."}], "tags": [], "owner": {"reputation": 688, "user_id": 755908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/32972a77da795da82dbd8b5371a56ec3?s=128&d=identicon&r=PG", "display_name": "Ian", "link": "https://stackoverflow.com/users/755908/ian"}, "is_accepted": true, "score": 2, "last_activity_date": 1448916179, "last_edit_date": 1448916179, "creation_date": 1448476579, "answer_id": 33924075, "question_id": 33923958, "link": "https://stackoverflow.com/questions/33923958/mvc-validation-model-state-using-viewmodel/33924075#33924075", "title": "MVC - Validation (Model.State) using ViewModel", "body": "<p>You'll need two things. The first is to remove the object from the ModelState which you do not want to validate. The second is you need to put your code block that is to execute in a valid state within the if(ModelState.IsValid) block.</p>\n\n<pre><code>public ActionResult Edit(int? id)\n{\n    //don't validate this field\n    ModelState.Remove(\"yourObject.property\"); \n\n    if (ModelState.IsValid)\n    {\n        ...\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5475, "user_id": 265165, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/96ccb09c24ac7eca20a64e350bd414c4?s=128&d=identicon&r=PG", "display_name": "thmshd", "link": "https://stackoverflow.com/users/265165/thmshd"}, "is_accepted": false, "score": 0, "last_activity_date": 1448916793, "creation_date": 1448916793, "answer_id": 34007800, "question_id": 33923958, "link": "https://stackoverflow.com/questions/33923958/mvc-validation-model-state-using-viewmodel/34007800#34007800", "title": "MVC - Validation (Model.State) using ViewModel", "body": "<p>In addition to the solution you've already chosen, I found the custom <a href=\"http://requiredif.blogspot.de/\" rel=\"nofollow\"><code>RequiredIfAttribute</code></a> useful. Using that, you can control if something is required base upon another condition, e.g.:</p>\n\n<pre><code>...\npublic bool RequireLocationName {\n   get {\n       return !Addresses.Any();\n   }\n}\n\n[RequiredIf(\"RequireLocationName\", true)]\npublic bool LocationName { get; set; }\n</code></pre>\n"}], "owner": {"reputation": 1326, "user_id": 3960185, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/y6LB5.jpg?s=128&g=1", "display_name": "Julio Schurt", "link": "https://stackoverflow.com/users/3960185/julio-schurt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1671, "favorite_count": 0, "accepted_answer_id": 33924075, "answer_count": 2, "score": 0, "last_activity_date": 1448916793, "creation_date": 1448476206, "question_id": 33923958, "link": "https://stackoverflow.com/questions/33923958/mvc-validation-model-state-using-viewmodel", "title": "MVC - Validation (Model.State) using ViewModel", "body": "<p>I\u00b4m needing some help. I have the following scenario and I think that I doing something wrong.</p>\n\n<p><strong>- Model \"State\"</strong></p>\n\n<pre><code>    namespace App.Model\n    {\n        public class State\n        {\n\n            [Key]\n            [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]\n            public int idState { get; set; }\n\n            [Required(ErrorMessage = \"Initials is required\")]\n            public string StateInitials { get; set; }\n\n            [Required(ErrorMessage = \"Name is required\")]\n            public string StateName { get; set; }\n\n            [Display(Name = \"Update Date\")]\n            [DisplayFormat(DataFormatString = \"{0:dd/MM/yyyy}\")]\n            public DateTime? UpdateDate { get; set; }\n\n            [Display(Name = \"Update Responsible\")]\n            public string UpdateResponsible { get; set; }\n\n        } //class\n\n    } //namespace\n</code></pre>\n\n<p><strong>- Model \"Location\"</strong></p>\n\n<pre><code>    namespace App.Model\n    {\n        public class Location\n        {\n\n            [Key]\n            [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]\n            public int idLocation { get; set; }\n\n            public int idState { get; set; }\n\n            [Required(ErrorMessage = \"Name is required\")]\n            public string LocationName { get; set; }\n\n            public string Status { get; set; }\n            public string ManagerName { get; set; }\n            public string Address { get; set; }\n\n            [Display(Name = \"Update Date\")]\n            [DisplayFormat(DataFormatString = \"{0:dd/MM/yyyy}\")]\n            public DateTime? UpdateDate { get; set; }\n\n            [Display(Name = \"Update Responsible\")]\n            public string UpdateResponsible { get; set; }\n\n        } //class\n\n    } //namespace\n</code></pre>\n\n<p>The relation between State and Location is one to many, but I didn\u00b4t describe this on model (using navigation fields).</p>\n\n<p>I have a view where I want to edit the locations. To do that, I\u00b4m using the following view model.</p>\n\n<p><strong>- View Model \"LocationsViewModel\"</strong></p>\n\n<pre><code>    namespace App.ViewModel\n    {\n        public class LocationsViewModel\n        {\n\n            public State objState { get; set; }\n\n            public List&lt;Location&gt; lstLocations { get; set; }\n\n        } //class\n\n    } //namespace\n</code></pre>\n\n<p>To edit the Locations I use the following controller.</p>\n\n<pre><code>namespace App.Controllers\n{\n\n  public class LocationController : Controller\n  {\n\n    private DbContext db = new DbContext();\n\n    // GET: /Location/Edit/5\n    public ActionResult Edit(int? id)\n    {\n\n        if (id == null)\n        {\n            return new HttpStatusCodeResult(HttpStatusCode.BadRequest);\n        }\n\n        State objState = db.States.Find(id);\n\n        if (objState == null)\n        {\n            return HttpNotFound();\n        }\n\n        LocationsViewModel model = new LocationsViewModel();\n        model.objState = objState;\n        model.lstLocations = getLocations(objState.idState);  //I didn\u00b4t show this method here just to simplify\n\n        return View(model);\n\n    } //Edit\n\n    // POST: /Location/Edit/5\n    [HttpPost]\n    [ValidateAntiForgeryToken]\n    public ActionResult Editar(LocationsViewModel model)\n    {\n\n        State objState = db.States.Find(model.objState.idState);\n\n        try\n        {\n\n            if (ModelState.IsValid)\n            {\n\n                //Saving Locations\n                foreach (Location obj in model.lstLocations)\n                {\n\n                    Location objLocation =  db.Locations.Find(obj.idLocation);\n                    objLocation.LocationName = obj.LocationName;\n                    objLocation.Status = obj.Status;\n                    objLocation.ManagerName = obj.ManagerName;\n                    objLocation.Address = obj.Address;\n\n                    objLocation.UpdateDate = DateTime.Now;\n                    objLocation.UpdateResponsible = User.Identity.Name;\n                    db.Entry(objLocation).State = EntityState.Modified;\n\n                    db.SaveChanges();\n\n                } //foreach\n\n                return RedirectToAction(\"Index\");\n\n            }\n\n        }\n        catch (Exception e)\n        {\n            ModelState.AddModelError(\"\", e.Message);\n        }\n\n        model.objState = objState;\n        model.lstLocations = getLocations(objState.idState);  //I didn\u00b4t show this method here just to simplify\n\n        return View(model);\n\n    } //Edit\n\n} //class\n\n} //namespace\n</code></pre>\n\n<p><strong>The problem/question is:</strong></p>\n\n<p>I wrote this code to edit (save) the list of locations of a specific State. When I submit the \"Edit\" view, the MVC try to validade the list of Locations (lstLocations) and the State (objState) as well, but I want to validate <strong>only</strong> the list of locations.</p>\n\n<p><strong>Note 1.</strong> I need to pass to my Edit view both objects: objState and lstLocations. I need the objState object because I show some State\u00b4s properties to the user on page (view).</p>\n\n<p><strong>Note 2.</strong> I\u00b4m getting <strong>ModelState.IsValid = false</strong> because <strong>model.objLocation</strong> is not valid, but I don\u00b4t want to check objLocation (is not relevant for this view). I just want to check the list of Locations (lstLocation)</p>\n\n<p>What is the best approach to achieve my gol? Am I doing something wrong? Need I to change my way of thinking?</p>\n"}, {"tags": ["c#", "entity-framework", "visual-studio-2015"], "comments": [{"owner": {"reputation": 775, "user_id": 139553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/laXG6.jpg?s=128&g=1", "display_name": "Yort", "link": "https://stackoverflow.com/users/139553/yort"}, "edited": false, "score": 1, "creation_date": 1448476793, "post_id": 33923955, "comment_id": 55609101, "body": "Have you &quot;attached&quot; the databases to your SQL instance? If you connect using the Microsoft Sql Server Management tools do the databases appear? My guess is either the databases are not attached, or there is a security issue... But with a lack of permissions you can usually see the databases, just not access them."}, {"owner": {"reputation": 155, "user_id": 5463254, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11f40d5dc6fe7f7d39dce792ff108c85?s=128&d=identicon&r=PG&f=1", "display_name": "Morgoth", "link": "https://stackoverflow.com/users/5463254/morgoth"}, "reply_to_user": {"reputation": 775, "user_id": 139553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/laXG6.jpg?s=128&g=1", "display_name": "Yort", "link": "https://stackoverflow.com/users/139553/yort"}, "edited": false, "score": 0, "creation_date": 1448479827, "post_id": 33923955, "comment_id": 55610806, "body": "Thanks for your answer. Here is what I get : - When I open the databse in SQL server 2014, just like in VS, no problem - When I try to Attach the database, I can run the script (top of the window) with no problem, but when I click OK (which is supposed to attach and create the database I presume, I get this :&quot; An error occurred when attaching the database(s).  Click the hyperlink in the Message column for details. &quot; The error message in the &quot;Messages&quot; is : (see next comment)"}, {"owner": {"reputation": 155, "user_id": 5463254, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11f40d5dc6fe7f7d39dce792ff108c85?s=128&d=identicon&r=PG&f=1", "display_name": "Morgoth", "link": "https://stackoverflow.com/users/5463254/morgoth"}, "reply_to_user": {"reputation": 775, "user_id": 139553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/laXG6.jpg?s=128&g=1", "display_name": "Yort", "link": "https://stackoverflow.com/users/139553/yort"}, "edited": false, "score": 0, "creation_date": 1448479835, "post_id": 33923955, "comment_id": 55610811, "body": "Msg 1813, Level 16, State 2, Line 3 Could not open new database &#39;Northwind&#39;. CREATE DATABASE is aborted. Msg 950, Level 20, State 1, Line 3 Database &#39;Northwind&#39; cannot be upgraded because its non-release version (539) is not supported by this version of SQL Server. You cannot open a database that is incompatible with this version of sqlservr.exe. You must re-create the database.&quot;   So I guess my Windows/SQL/Visual Studio are too recent..."}, {"owner": {"reputation": 2742, "user_id": 4892515, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/JHSqd.png?s=128&g=1", "display_name": "Antoine Pelletier", "link": "https://stackoverflow.com/users/4892515/antoine-pelletier"}, "edited": false, "score": 0, "creation_date": 1448480922, "post_id": 33923955, "comment_id": 55611362, "body": "i&#39;d rater say it&#39;s you&#39;r sample that is out of date"}, {"owner": {"reputation": 155, "user_id": 5463254, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11f40d5dc6fe7f7d39dce792ff108c85?s=128&d=identicon&r=PG&f=1", "display_name": "Morgoth", "link": "https://stackoverflow.com/users/5463254/morgoth"}, "edited": false, "score": 0, "creation_date": 1448481195, "post_id": 33923955, "comment_id": 55611506, "body": "yeah that&#39;s more accurate and logical :) The problem is there is no updated version of these. Could any of you guys direct me towards a small recent sample database to practice my basic LINQ query ? Thanks all for your answers."}, {"owner": {"reputation": 775, "user_id": 139553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/laXG6.jpg?s=128&g=1", "display_name": "Yort", "link": "https://stackoverflow.com/users/139553/yort"}, "edited": false, "score": 0, "creation_date": 1448484264, "post_id": 33923955, "comment_id": 55613037, "body": "That&#39;s odd. In every case where I&#39;ve done something like this, attaching an older database to a newer sql instance has automatically upgraded the databases to the new format. It&#39;s only a problem going back the other way (newer databases on an older sql server version won&#39;t work). The message about a non-release version is not something I&#39;ve seen before though."}, {"owner": {"reputation": 155, "user_id": 5463254, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11f40d5dc6fe7f7d39dce792ff108c85?s=128&d=identicon&r=PG&f=1", "display_name": "Morgoth", "link": "https://stackoverflow.com/users/5463254/morgoth"}, "edited": false, "score": 0, "creation_date": 1448484683, "post_id": 33923955, "comment_id": 55613236, "body": "I&#39;ve just tried the same methods with a 2014 version of the AdventureWorks database, and it went just fine, both in SQL Server 2014 and VS 2015. Thanks again everyone for your answers."}], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 139553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/laXG6.jpg?s=128&g=1", "display_name": "Yort", "link": "https://stackoverflow.com/users/139553/yort"}, "edited": false, "score": 0, "creation_date": 1448484768, "post_id": 33926189, "comment_id": 55613266, "body": "There&#39;s also this set of sample databases, which might be useful. You could try adventureworks (ad) instead of northwind - I think adventureworks is a more modern sample. <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=41700\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=41700</a>"}, {"owner": {"reputation": 775, "user_id": 139553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/laXG6.jpg?s=128&g=1", "display_name": "Yort", "link": "https://stackoverflow.com/users/139553/yort"}, "edited": false, "score": 0, "creation_date": 1449720537, "post_id": 33926189, "comment_id": 56133153, "body": "SQL 2000 databases are just too old to be supported. See this; <a href=\"https://weblogs.asp.net/dixin/attach-sql-server-2000-database-to-sql-server-2014\" rel=\"nofollow noreferrer\">weblogs.asp.net/dixin/&hellip;</a>"}], "tags": [], "owner": {"reputation": 775, "user_id": 139553, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/laXG6.jpg?s=128&g=1", "display_name": "Yort", "link": "https://stackoverflow.com/users/139553/yort"}, "is_accepted": false, "score": 0, "last_activity_date": 1448484662, "creation_date": 1448484662, "answer_id": 33926189, "question_id": 33923955, "link": "https://stackoverflow.com/questions/33923955/cant-see-my-northwind-db-when-adding-connection-in-visual-studio/33926189#33926189", "title": "Can&#39;t see my Northwind DB when adding connection in Visual Studio", "body": "<p>You need to attach the databases before you can see them**. You're having a problem attaching the databases due to versioning (which is odd), but your sample db's are very old. Perhaps try newer ones from here <a href=\"https://northwinddatabase.codeplex.com/\" rel=\"nofollow\">https://northwinddatabase.codeplex.com/</a> and make sure you attach them before expecting them to show up in the tools.</p>\n\n<p>** Technically this is not true. I believe there is a way of connecting to sql server and passing a file path in the connection string, however this will likely still fail for your due to the error you get trying to attach the dbs you have. Additionally, it requires a specially crafted connection string which may or may not be usable with the gui tools you're trying to use. It is also, in my opinion, a less common way of accessing sql server databases, so I would stick with attaching them first. If you want to find out more about this, I believe the feature you need to research is called 'sql server user instances'.</p>\n"}], "owner": {"reputation": 155, "user_id": 5463254, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/11f40d5dc6fe7f7d39dce792ff108c85?s=128&d=identicon&r=PG&f=1", "display_name": "Morgoth", "link": "https://stackoverflow.com/users/5463254/morgoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1394, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448484662, "creation_date": 1448476199, "last_edit_date": 1495541242, "question_id": 33923955, "link": "https://stackoverflow.com/questions/33923955/cant-see-my-northwind-db-when-adding-connection-in-visual-studio", "title": "Can&#39;t see my Northwind DB when adding connection in Visual Studio", "body": "<p>As a beginner in C#/VS I want to practice making basic LINQ queries on simple DB's. I downloaded the \"famous\" Northwind and Pubs databases on the official Microsoft websites (<a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=23654\" rel=\"nofollow noreferrer\">https://www.microsoft.com/en-us/download/details.aspx?id=23654</a>). It gave me a .msi files that installed 6 files on my c: instnwnd.sql, instpubs.sql, NORTHWND.LDF, NORTHWND.MDF, PUBS.MDF, PUBS_LOG.LDF.</p>\n\n<p>When I launch Visual Community 2015 and simply make an \"Open => File...\" and open the \"instnwnd.sql\", it opens the .sql file without problem. The problem is when I'm trying to make a connection to the database, being either through the Solution  Explorer (Data Connections => Add Connection) or while I'm trying to create an EDM (Database first), which is what I want to do eventually. </p>\n\n<p>The exact problem is that one : the Northwind and Pubs databases doesn't show up in the database list when i'm trying to add a connection, I only get the system databases. Here is what I get :</p>\n\n<p><a href=\"http://img15.hostingpics.net/pics/128870screenshot1.jpg\" rel=\"nofollow noreferrer\">http://img15.hostingpics.net/pics/128870screenshot1.jpg</a></p>\n\n<p>I read many MSDN documentation pages and several StackOverFlow topic about the matter (the closest of solving my issue was that one, but didn't work :<a href=\"https://stackoverflow.com/questions/21563940/how-to-connect-to-localdb-in-visual-studio-server-explorer\">How to connect to LocalDB in Visual Studio Server Explorer?</a>). I have SQL Server Express 2014 with tools, started SQL services in my Windows Services etc.</p>\n\n<p>What should I do in order to have those databases available so I can generate code and starting making my LINQ exercices ? </p>\n\n<p>Thanks in advance !</p>\n"}, {"tags": ["c#", "windows", "account"], "answers": [{"comments": [{"owner": {"reputation": 1644, "user_id": 1574221, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3354f9ca5a8b1d4cc30f5bcc1de26ed5?s=128&d=identicon&r=PG", "display_name": "marsh-wiggle", "link": "https://stackoverflow.com/users/1574221/marsh-wiggle"}, "edited": false, "score": 0, "creation_date": 1448487431, "post_id": 33924897, "comment_id": 55614583, "body": "Martin, do you have also a &quot;NetLocalGroupGetMembers&quot;? Try to get running the example at pinvoke but doesn&#39;t work. Thanks!"}, {"owner": {"reputation": 96339, "user_id": 98607, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ccd9dbbb08784dfcc5ac18c6d839b9d?s=128&d=identicon&r=PG", "display_name": "Martin Liversage", "link": "https://stackoverflow.com/users/98607/martin-liversage"}, "reply_to_user": {"reputation": 1644, "user_id": 1574221, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3354f9ca5a8b1d4cc30f5bcc1de26ed5?s=128&d=identicon&r=PG", "display_name": "marsh-wiggle", "link": "https://stackoverflow.com/users/1574221/marsh-wiggle"}, "edited": false, "score": 0, "creation_date": 1448491799, "post_id": 33924897, "comment_id": 55616531, "body": "@boboes: It should be simple except when I try I get an unexpected error <i>The group name could not be found</i> (2220). I don&#39;t know why and I would like to understand the cause of this problem. However, it will have to wait until later."}, {"owner": {"reputation": 1644, "user_id": 1574221, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3354f9ca5a8b1d4cc30f5bcc1de26ed5?s=128&d=identicon&r=PG", "display_name": "marsh-wiggle", "link": "https://stackoverflow.com/users/1574221/marsh-wiggle"}, "edited": false, "score": 0, "creation_date": 1448532759, "post_id": 33924897, "comment_id": 55631477, "body": "Martin, I have found several solutions which can find the group but not the members. Look here: <a href=\"http://stackoverflow.com/questions/33935825/pinvoke-netlocalgroupgetmembers-runs-into-fatalexecutionengineerror\" title=\"pinvoke netlocalgroupgetmembers runs into fatalexecutionengineerror\">stackoverflow.com/questions/33935825/&hellip;</a>"}, {"owner": {"reputation": 96339, "user_id": 98607, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ccd9dbbb08784dfcc5ac18c6d839b9d?s=128&d=identicon&r=PG", "display_name": "Martin Liversage", "link": "https://stackoverflow.com/users/98607/martin-liversage"}, "reply_to_user": {"reputation": 1644, "user_id": 1574221, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3354f9ca5a8b1d4cc30f5bcc1de26ed5?s=128&d=identicon&r=PG", "display_name": "marsh-wiggle", "link": "https://stackoverflow.com/users/1574221/marsh-wiggle"}, "edited": false, "score": 1, "creation_date": 1448538924, "post_id": 33924897, "comment_id": 55635380, "body": "@boboes: I have updated my code so you now can get the members of a group. I had overlooked that the C++ declaration of strings used <code>LPCWSTR</code> and not <code>LPCTSTR</code> leading to wrong marshalling of strings in a 32 bit process."}], "tags": [], "owner": {"reputation": 96339, "user_id": 98607, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ccd9dbbb08784dfcc5ac18c6d839b9d?s=128&d=identicon&r=PG", "display_name": "Martin Liversage", "link": "https://stackoverflow.com/users/98607/martin-liversage"}, "is_accepted": true, "score": 1, "last_activity_date": 1448538777, "last_edit_date": 1448538777, "creation_date": 1448479649, "answer_id": 33924897, "question_id": 33923951, "link": "https://stackoverflow.com/questions/33923951/how-to-get-a-list-of-local-machine-groups-users-when-machine-is-not-in-active/33924897#33924897", "title": "How to get a list of local machine groups / users when machine is not in active directory?", "body": "<p>You can use P/Invoke to call the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa370680(v=vs.85).aspx\" rel=\"nofollow\">native network management API</a> to get local user and group names:</p>\n\n<pre><code>static class NativeMethods {\n\n  [DllImport(\"netapi32.dll\")]\n  public static extern void NetApiBufferFree(IntPtr bufptr);\n\n  [DllImport(\"netapi32.dll\")]\n  public static extern UInt32 NetUserEnum([MarshalAs(UnmanagedType.LPWStr)] String servername, UInt32 level, UInt32 filter, ref IntPtr bufptr, UInt32 prefmaxlen, ref UInt32 entriesread, ref UInt32 totalentries, IntPtr resumehandle);\n\n  [DllImport(\"netapi32.dll\")]\n  public static extern UInt32 NetLocalGroupEnum([MarshalAs(UnmanagedType.LPWStr)] String servername, UInt32 level, ref IntPtr bufptr, UInt32 prefmaxlen, ref UInt32 entriesread, ref UInt32 totalentries, IntPtr resumehandle);\n\n  [DllImport(\"Netapi32.dll\")]\n  public extern static UInt32 NetLocalGroupGetMembers([MarshalAs(UnmanagedType.LPWStr)] String servername, [MarshalAs(UnmanagedType.LPWStr)] String localgroupname, UInt32 level, ref IntPtr bufptr, UInt32 prefmaxlen, ref UInt32 entriesread, ref UInt32 totalentries, IntPtr resumehandle);\n\n}\n</code></pre>\n\n<p>The API allows you to get various information about users. If you only want names you can use this function:</p>\n\n<pre><code>IEnumerable&lt;String&gt; GetUserNames() {\n  var buffer = IntPtr.Zero;\n  try {\n    UInt32 entriesRead = 0;\n    UInt32 totalEntries = 0;\n    var result = NativeMethods.NetUserEnum(null, 0, 0, ref buffer, UInt32.MaxValue, ref entriesRead, ref totalEntries, IntPtr.Zero);\n    if (result != 0)\n      throw new Win32Exception((Int32) result);\n    var userNames = Enumerable\n      .Range(0, (Int32) entriesRead)\n      .Select(\n        i =&gt; {\n          var userInfo = Marshal.ReadIntPtr(buffer, i*IntPtr.Size);\n          var userName = Marshal.PtrToStringAuto(userInfo);\n          return userName;\n        }\n      )\n      .ToList();\n    return userNames;\n  }\n  finally {\n    NativeMethods.NetApiBufferFree(buffer);\n  }\n}\n</code></pre>\n\n<p>The LINQ statement is used to \"parse\" the buffer that contains <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa370961(v=vs.85).aspx\" rel=\"nofollow\"><code>USER_INFO_0</code></a> strutures. If you are querying for additional information you will have to do more elaborate \"parsing\".</p>\n\n<p>Likewise you can get local group names:</p>\n\n<pre><code>IEnumerable&lt;String&gt; GetLocalGroupNames() {\n  var buffer = IntPtr.Zero;\n  try {\n    UInt32 entriesRead = 0;\n    UInt32 totalEntries = 0;\n    var result = NativeMethods.NetLocalGroupEnum(null, 0, ref buffer, UInt32.MaxValue, ref entriesRead, ref totalEntries, IntPtr.Zero);\n    if (result != 0)\n      throw new Win32Exception((Int32) result);\n    var localGroupNames = Enumerable\n      .Range(0, (Int32) entriesRead)\n      .Select(\n        i =&gt; {\n          var localGroupInfo = Marshal.ReadIntPtr(buffer, i*IntPtr.Size);\n          var groupName = Marshal.PtrToStringAuto(localGroupInfo);\n          return groupName;\n        }\n      )\n      .ToList();\n    return localGroupNames;\n  }\n  finally {\n    NativeMethods.NetApiBufferFree(buffer);\n  }\n}\n</code></pre>\n\n<p>The structures in the buffer are <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa370275(v=vs.85).aspx\" rel=\"nofollow\"><code>LOCALGROUP_INFO_0</code></a> with the same layout as the <code>USER_INFO_0</code> structure so the \"parsing\" code is identical.</p>\n\n<p>Finally, here is how to get group membership using the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa370281(v=vs.85).aspx\" rel=\"nofollow\"><code>LOCALGROUP_MEMBERS_INFO_3</code></a> structure:</p>\n\n<pre><code>IEnumerable&lt;String&gt; GetLocalGroupUsers(String localGroupName) {\n  var buffer = IntPtr.Zero;\n  try {\n    UInt32 entriesRead = 0;\n    UInt32 totalEntries = 0;\n    var result = NativeMethods.NetLocalGroupGetMembers(null, localGroupName, 3, ref buffer, UInt32.MaxValue, ref entriesRead, ref totalEntries, IntPtr.Zero);\n    if (result != 0)\n      throw new Win32Exception((Int32) result);\n    var userNames = Enumerable\n      .Range(0, (Int32) entriesRead)\n      .Select(\n        i =&gt; {\n          var membersInfo = Marshal.ReadIntPtr(buffer, i*IntPtr.Size);\n          var userName = Marshal.PtrToStringAuto(membersInfo );\n          return userName;\n        }\n      )\n      .ToList();\n    return userNames;\n  }\n  finally {\n    NativeMethods.NetApiBufferFree(buffer);\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 1644, "user_id": 1574221, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3354f9ca5a8b1d4cc30f5bcc1de26ed5?s=128&d=identicon&r=PG", "display_name": "marsh-wiggle", "link": "https://stackoverflow.com/users/1574221/marsh-wiggle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 848, "favorite_count": 1, "accepted_answer_id": 33924897, "answer_count": 1, "score": 1, "last_activity_date": 1448538777, "creation_date": 1448476176, "last_edit_date": 1448480878, "question_id": 33923951, "link": "https://stackoverflow.com/questions/33923951/how-to-get-a-list-of-local-machine-groups-users-when-machine-is-not-in-active", "title": "How to get a list of local machine groups / users when machine is not in active directory?", "body": "<p>Is there a way to get in C# a list of local groups and users, when the windows machine is no AD member and an LDAP search can't be used?</p>\n"}, {"tags": ["c#", "wpf", "multithreading", "async-await", "task"], "comments": [{"owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 0, "creation_date": 1448476677, "post_id": 33923900, "comment_id": 55609030, "body": "I know I am creating flow documents using BackGroundWorker.  The document is returned to Complete which is on the main thread."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448486118, "post_id": 33923900, "comment_id": 55613955, "body": "The short version is: the <code>FixedDocument</code> needs to be owned by (created in) the thread where you want to use it. You can&#39;t create it in one thread and then use it in a different thread. See the marked duplicate for additional details."}, {"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "reply_to_user": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 0, "creation_date": 1448489209, "post_id": 33923900, "comment_id": 55615483, "body": "@Frisbee I am afraid I cannot use BackgroudWorker, since the thread must be STA. And the reason is because every FixedPage my FixedDocument has contain a custom UserControl object. If I try to not use STA, I get exceptions. Any Ideas?"}, {"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "reply_to_user": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448489325, "post_id": 33923900, "comment_id": 55615536, "body": "@PeterDuniho What would be the workaround strategy if the bottleneck of the FixedDocument creation is actual a user control instantiation. The control is simple, but multiply by 200 pages and you have issues. I was thinking about adding pages to the document asynchronously, but did nome come up with a solution."}, {"owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 0, "creation_date": 1448490086, "post_id": 33923900, "comment_id": 55615846, "body": "It gets ugly.  You may be able to serialize to XML.  If you search my name and FlowDocument I had a question a long time ago on it and a guy got me going."}, {"owner": {"reputation": 62092, "user_id": 3538012, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dcc3c1ad5e4ae4d79ba377020978d107?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Duniho", "link": "https://stackoverflow.com/users/3538012/peter-duniho"}, "edited": false, "score": 0, "creation_date": 1448490625, "post_id": 33923900, "comment_id": 55616077, "body": "<i>&quot;What would be the workaround strategy if the bottleneck of the FixedDocument creation is actual a user control instantiation&quot;</i> -- in this case, I&#39;m aware of none. Some UI objects inherit <code>Freezable</code>; they can generally be created on any thread, as long as they can be frozen before use in a different thread. But for non-freezable objects, you have to create them in the UI thread where they will be used. The usual answer is &quot;don&#39;t do that&quot;. It&#39;s unlikely you actually need <b>200</b> different pages instantiated at the same time. How is a user supposed to interact with 200 different pages at once?"}, {"owner": {"reputation": 42585, "user_id": 607314, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/N7ogx.png?s=128&g=1", "display_name": "paparazzo", "link": "https://stackoverflow.com/users/607314/paparazzo"}, "edited": false, "score": 0, "creation_date": 1448491154, "post_id": 33923900, "comment_id": 55616282, "body": "How does a question get closed on just one vote from a non-moderator?"}], "owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1448486071, "answer_count": 0, "score": 0, "last_activity_date": 1448625860, "creation_date": 1448476012, "last_edit_date": 1448625860, "question_id": 33923900, "link": "https://stackoverflow.com/questions/33923900/attach-fixeddocument-created-in-another-thread", "closed_reason": "Duplicate", "title": "Attach FixedDocument created in another thread", "body": "<p>We have a WPF application that must show a FixedDocument using a DocumentViewer.</p>\n\n<p>The FixedDocument contains several pages that takes about 10 seconds to be created, so we decided to do this creation asynchronously.</p>\n\n<p>As the FixedDocument contain FixedPages and these pages contains instances of UserControl objects, we need to create this document on a STA Apartment.</p>\n\n<p>We are experiencing issues to attach the created FixedDocument to the DocumentViewer, since they are in different UI threads.</p>\n\n<p>Here is the UI snippet:</p>\n\n<pre><code>&lt;Grid Style=\"{StaticResource ContentRoot}\"&gt;\n    &lt;Grid.RowDefinitions&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n        &lt;RowDefinition Height=\"Auto\"/&gt;\n    &lt;/Grid.RowDefinitions&gt;\n\n    &lt;Label Grid.Row=\"0\" Content=\"Loading...\" Visibility=\"{Binding LabelDocument.IsNotCompleted,\n        Converter={StaticResource BooleanToVisibilityConverter}}\"/&gt;\n\n    &lt;DocumentViewer  Document=\"{Binding LabelDocument.Result}\" Grid.Row=\"1\"/&gt;\n\n    &lt;Label Content=\"{Binding UrlByteCount.ErrorMessage}\" Grid.Row=\"2\" Background=\"Red\"\n        Visibility=\"{Binding LabelDocument.IsFaulted,\n        Converter={StaticResource BooleanToVisibilityConverter}}\"/&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p>Than you have the ViewModel:</p>\n\n<pre><code>public LabelPrintViewModel()\n    {\n        //....\n        LabelDocument = new NotifyTaskCompletion&lt;FixedDocument&gt;(CreateLabels());\n    }\n\n private Task&lt;FixedDocument&gt; CreateLabels()\n    {\n        var tcs = new TaskCompletionSource&lt;FixedDocument&gt;();\n        Thread thread = new Thread(() =&gt;\n        {\n            try\n            {\n                //Code to create the Fixed Pages goes here.\n\n\n                FixedDocument fixedDocument = new FixedDocument();\n\n                foreach (var page in pages)\n                {\n                    PageContent pageContent = new PageContent();\n\n                    ((System.Windows.Markup.IAddChild)pageContent).AddChild(page);\n                    fixedDocument.Pages.Add(pageContent);\n                }\n                tcs.SetResult(fixedDocument);\n            }\n            catch (Exception ex)\n            {\n                tcs.SetException(ex);\n            }\n\n        });\n\n        thread.SetApartmentState(ApartmentState.STA);\n        thread.Start();\n        return tcs.Task;\n    }\n</code></pre>\n\n<p>When the code runs I get the famous \"The calling thread cannot access this object because a different thread owns it\". </p>\n\n<p>I tried to use the TaskScheduler.FromCurrentSynchronizationContext() to fix it, but no success:</p>\n\n<pre><code>return tcs.Task.ContinueWith&lt;FixedDocument&gt;(r=&gt;\n        {\n            return r.Result;\n        }, scheduler);\n</code></pre>\n\n<p>I understand the reason of the error, but cannot find a way to fix it. Using dispatcher is not solving the problem because I think the problem is not where the code is being called, but the fact that I have two separate UI threads that need to comunicate....</p>\n\n<p>How can I fix that?</p>\n\n<p>PS: The DocumentViewer binding approach was performed based on this <a href=\"https://msdn.microsoft.com/en-us/magazine/dn605875.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">great article</a>.</p>\n\n<p>Thank you,</p>\n\n<p><strong>*UPDATE *</strong>\nI end up using a XpsDocument saved on a temporary file as an intermediate media, so the DocumentViewer can now open it very quickly. In future, I hope to find a way to serialize the FixedDocument in a way that I do not get cross thread issues.</p>\n\n<p>At the moment, I am still srugling to programmatically create my user control that contains each FixedPage visual. </p>\n\n<p>Don't know why, but the second time I visit the page containing the DocumentViewer and the Document is generated, I can not longer instantiate my custom user control:</p>\n\n<pre><code>public async void OnNavigatedTo(FirstFloor.ModernUI.Windows.Navigation.NavigationEventArgs e)\n    {\n        LabelPrintViewModel vm = new LabelPrintViewModel();\n        this.DataContext = vm;\n\n        string s = await vm.LabelDocument.Task;\n\n        XpsDocument doc = new XpsDocument(s, FileAccess.Read);\n        docViewer.Document = doc.GetFixedDocumentSequence();\n\n    } \n</code></pre>\n\n<p>This time I will put the code to create the pages. The second time I call this thread the application hangs on the LabelView constructor call:</p>\n\n<pre><code>//Each item is a tinny ViewModel object to populate LabelView\n                foreach (var item in _labelsToPrint)\n                {\n                    double pageWidth = 96 * 4.0;\n                    double pageHeight = 96 * 2.12;\n\n//The second time the calling page loads, the app hangs here.\n                    LabelView lv = new LabelView(item);\n                    lv.Width = pageWidth;\n                    lv.Height = pageHeight;\n\n                    FixedPage fp = new FixedPage();\n                    fp.Width = pageWidth;\n                    fp.Height = pageHeight;\n\n                    fp.Children.Add(lv);\n\n                    PageContent pageContent = new PageContent();\n                    pageContent.Child = fp;\n\n                    fixedDoc.Pages.Add(pageContent);\n                }\n\n                FileInfo tempFile = new FileInfo(System.IO.Path.GetTempPath() + DateTime.Now.Ticks.ToString() + \".xps\");\n                var paginator = fixedDoc.DocumentPaginator;\n                var xpsDocument = new XpsDocument(tempFile.FullName, FileAccess.Write);\n                var documentWriter = XpsDocument.CreateXpsDocumentWriter(xpsDocument);\n                documentWriter.Write(paginator);\n                xpsDocument.Close();\n\n                tcs.SetResult(tempFile.FullName);\n</code></pre>\n\n<p>If I replace my custom control with a TextBlock object, no problem happens. What might be wrong?</p>\n\n<p><em>UPDATE</em></p>\n\n<p>I narrowed down the custom control instantiation issue and isolated what was making the app to hang. The XAML contains references to a localization mechanism (<a href=\"http://wpflocalizeextension.codeplex.com\" rel=\"nofollow\">http://wpflocalizeextension.codeplex.com</a>). There are some UI elements like:</p>\n\n<pre><code>&lt;TextBlock Text=\"{lex:Loc Description}\" Style=\"{StaticResource labelTextBox}\"/&gt;\n</code></pre>\n\n<p>If I make the localization in the viewModel instead, the problem is solved. </p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 2716, "user_id": 1087692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143e0e17fa2f09f8bd0ba9154bc555e2?s=128&d=identicon&r=PG", "display_name": "tzachs", "link": "https://stackoverflow.com/users/1087692/tzachs"}, "edited": false, "score": 0, "creation_date": 1448482707, "post_id": 33923879, "comment_id": 55612252, "body": "Can you provide a screenshot of how the listbox looks after coloring it and how you expect it to look?"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 5605349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b92a551f8ab1dbc55dd798f3279690?s=128&d=identicon&r=PG&f=1", "display_name": "mr_applesauce", "link": "https://stackoverflow.com/users/5605349/mr-applesauce"}, "is_accepted": false, "score": 0, "last_activity_date": 1448646044, "last_edit_date": 1448646044, "creation_date": 1448486070, "answer_id": 33926516, "question_id": 33923879, "link": "https://stackoverflow.com/questions/33923879/listbox-item-colors-on-wrong-place/33926516#33926516", "title": "Listbox item colors on wrong place", "body": "<p>Found it,</p>\n\n<pre><code>  string tempFilename = string.Empty;\n  SolidBrush Brushcolor;\n  bool colorSwitch = false;\n\nprotected override void OnDrawItem(DrawItemEventArgs e)\n{\n e.DrawBackground();\n\n// Group colors\n   string text = this.Items[e.Index].ToString();\n   string filename = Path.GetFileName(text);\n\n    if (filename == tempFilename)\n     equal = true;\n    else equal = false;\n\n    if (equal)\n     Brushcolor = ExChangeBrush(!colorSwitch);\n    else\n    {\n     Brushcolor = ExChangeBrush(colorSwitch);\n     colorSwitch = !colorSwitch;\n    }\n\n    tempFilename = filename;\n// end Group colors\n\n   e.Graphics.FillRectangle(Brushcolor, e.Bounds);\n\n   e.Graphics.DrawString(text, e.Font, new SolidBrush(Color.Black), new PointF(e.Bounds.X, e.Bounds.Y));\n\n   base.OnDrawItem(e);\n  }\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5605349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51b92a551f8ab1dbc55dd798f3279690?s=128&d=identicon&r=PG&f=1", "display_name": "mr_applesauce", "link": "https://stackoverflow.com/users/5605349/mr-applesauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448646044, "creation_date": 1448475939, "question_id": 33923879, "link": "https://stackoverflow.com/questions/33923879/listbox-item-colors-on-wrong-place", "title": "Listbox item colors on wrong place", "body": "<p>I want to give every group of filenames a different color,\nbut only the first filename will have a different color in this code,\nI can't find anything wrong while debugging the code,\nwhat can be the problem ?...</p>\n\n<pre><code>public class ListBoxEx : ListBox\n {\n  private string PreviousText = string.Empty;\n  private string CurrentText = string.Empty;\n  private bool equal = false;\n\n  public ListBoxEx()\n  {\n     this.DrawMode = DrawMode.OwnerDrawFixed;\n  }\n\n  protected override void OnDrawItem(DrawItemEventArgs e)\n  {\n   try\n   {\n    e.DrawBackground();\n\n    if (this.Items.Count &gt; 0 &amp;&amp; e.Index &gt; 0)\n    {\n      PreviousText = Path.GetFileName(this.Items[e.Index - 1].ToString());\n      CurrentText = Path.GetFileName(this.Items[e.Index].ToString());\n\n      if (CurrentText == PreviousText)\n       equal = true;\n      else equal = false;\n\n      if (equal)\n       e.Graphics.FillRectangle(new SolidBrush(Color.LightYellow), e.Bounds);\n      else\n       e.Graphics.FillRectangle(new SolidBrush(Color.LightBlue), e.Bounds);\n\n      e.Graphics.DrawString(this.Items[e.Index].ToString(), e.Font, new SolidBrush(Color.Black), new PointF(e.Bounds.X, e.Bounds.Y));\n\n  base.OnDrawItem(e);\n    }\n   }\n   catch (Exception ex)\n    {\n    throw (ex);\n   }\n  }\n }\n</code></pre>\n"}, {"tags": ["c#", "wpf", "data-binding", "getter-setter"], "comments": [{"owner": {"reputation": 54818, "user_id": 962089, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/b6SVs.jpg?s=128&g=1", "display_name": "chris", "link": "https://stackoverflow.com/users/962089/chris"}, "edited": false, "score": 1, "creation_date": 1448476313, "post_id": 33923862, "comment_id": 55608848, "body": "If you&#39;re expecting it to update immediately, you&#39;ll need <code>UpdateSourceTrigger</code>. I&#39;m not sure whether that&#39;s what you&#39;re asking, though. This should still work when the textbox loses focus."}, {"owner": {"reputation": 114, "user_id": 5451176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679ffdb5e8de1ddb70ae2d46c5e719ed?s=128&d=identicon&r=PG&f=1", "display_name": "Smurfie", "link": "https://stackoverflow.com/users/5451176/smurfie"}, "edited": false, "score": 0, "creation_date": 1448476681, "post_id": 33923862, "comment_id": 55609036, "body": "Did you set the DataContext?"}], "answers": [{"tags": [], "owner": {"reputation": 1072, "user_id": 941040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a9344858057650cb46971d83307a99?s=128&d=identicon&r=PG", "display_name": "jayint32", "link": "https://stackoverflow.com/users/941040/jayint32"}, "is_accepted": false, "score": 1, "last_activity_date": 1448476549, "creation_date": 1448476549, "answer_id": 33924061, "question_id": 33923862, "link": "https://stackoverflow.com/questions/33923862/wpf-two-way-binding-with-custom-gets-and-sets/33924061#33924061", "title": "WPF Two-Way Binding with custom gets and sets", "body": "<pre><code>&lt;TextBox Text={Binding MyProperty, UpdateSourceTrigger=PropertyChanged} /&gt;\n</code></pre>\n\n<p>You don't need to specify Mode=TwoWay as TwoWay is the default binding mode for TextBox controls.  PropertyChanged as UpdateSourceTrigger will execute the setter on every keypress that modifies the text.  You can also use the LostFocus UpdateSourceTrigger if you want to delay the setter until the user has finished inputting the value and tabs or clicks to the next control.</p>\n"}], "owner": {"reputation": 4568, "user_id": 3685285, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/72b7ac073315a8da6956e2d7dce165b1?s=128&d=identicon&r=PG&f=1", "display_name": "user3685285", "link": "https://stackoverflow.com/users/3685285/user3685285"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448476549, "creation_date": 1448475881, "question_id": 33923862, "link": "https://stackoverflow.com/questions/33923862/wpf-two-way-binding-with-custom-gets-and-sets", "title": "WPF Two-Way Binding with custom gets and sets", "body": "<p>I have a property:</p>\n\n<pre><code>private int myProperty;\n\npublic int MyProperty\n{\n    get\n    {\n       return myProperty;\n    }\n    set\n    {\n        // do something special\n    }\n}\n</code></pre>\n\n<p>I want to bind this property to a textbox like so:</p>\n\n<pre><code>&lt;TextBox Text={Binding MyProperty, Mode=TwoWay} /&gt;\n</code></pre>\n\n<p>Such that when the user changes the value in the textbox, the set is invoked. But the binding doesn't seem to work at all. What am I doing wrong?</p>\n"}, {"tags": ["c#", "wpf", "xaml", "windows-10"], "owner": {"reputation": 11, "user_id": 5604491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12fd3f6bf0565b63bad1d1ae6ebafdda?s=128&d=identicon&r=PG&f=1", "display_name": "ierof", "link": "https://stackoverflow.com/users/5604491/ierof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 957, "favorite_count": 3, "answer_count": 0, "score": 1, "last_activity_date": 1493105175, "creation_date": 1448475820, "last_edit_date": 1448527983, "question_id": 33923840, "link": "https://stackoverflow.com/questions/33923840/wpf-clickmode-press-and-showdialog-and-touchinput-issue", "title": "WPF ClickMode Press and ShowDialog and TouchInput issue", "body": "<p>I have a problem:</p>\n\n<p>After touching button in current window another window opens by <code>ShowDialog()</code>.\nThis new dialog window has the only button. Click handler closes dialog window.</p>\n\n<p>When I open dialog by touching button with <code>ClickMode = Release</code> (default mode), there is no problems.\nBut! When I try to do it by pressing button with <code>ClickMode = Press</code>, the first touch on dialog window is ignored.\nIt reproduces in win8 - win10 with touch (not mouse click, with mouse everything OK).</p>\n\n<p>I suppose, there are some troubles with <code>Dispatcher.PushFrame</code> inside <code>ShowDialog()</code> and virtualizing mouse events in touch input.</p>\n\n<p><strong>Does anyone have any ideas how to make button with <code>ClickMode=Press</code> work the same with touch and mouse input?</strong></p>\n\n<p>My code </p>\n\n<p><code>MainWindow.xaml</code></p>\n\n<pre><code>&lt;Window x:Class=\"SimpleTouchCrash.MainWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    Title=\"MainWindow\" Height=\"350\" Width=\"525\"&gt;\n    &lt;StackPanel&gt;\n        &lt;Button x:Name=\"btnPress\" ClickMode=\"Press\" Click=\"BtnPress_OnClick\" Height=\"100\"&gt;Mode: Press&lt;/Button&gt;\n         &lt;Button x:Name=\"btnRelease\" Click=\"BtnPress_OnClick\" Height=\"100\"&gt;Mode: Release&lt;/Button&gt;\n    &lt;/StackPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p><code>MainWindow.xaml.cs</code></p>\n\n<pre><code>using System.Windows;       \nnamespace SimpleTouchCrash\n{\n    public partial class MainWindow\n    {\n        public MainWindow()\n        {\n            InitializeComponent();\n        }\n        private void BtnPress_OnClick(object sender, RoutedEventArgs e)\n        {\n            var dlg= new Dialog();\n            dlg.ShowDialog();\n        }\n    }\n}\n</code></pre>\n\n<p><code>Dialog.xaml</code></p>\n\n<pre><code>&lt;Window x:Class=\"SimpleTouchCrash.Dialog\"\n            xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n            xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n            Title=\"Dialog\" Height=\"300\" Width=\"300\"&gt;\n        &lt;Grid&gt;\n            &lt;Button x:Name=\"btnCloseDialog\" Click=\"BtnCloseDialog_OnClick\"&gt;Close me!&lt;/Button&gt;\n        &lt;/Grid&gt;\n    &lt;/Window&gt;\n</code></pre>\n\n<p><code>Dialog.xaml.cs</code></p>\n\n<pre><code>using System.Windows;\n    namespace SimpleTouchCrash\n    {\n        public partial class Dialog \n        {\n            public Dialog()\n            {\n                InitializeComponent();\n            }\n            private void BtnCloseDialog_OnClick(object sender, RoutedEventArgs e)\n            {\n                Close();\n            }\n        };\n    }\n</code></pre>\n\n<p>P.S. I know there is a \"hack\" to disable touch input:\n<a href=\"https://connect.microsoft.com/VisualStudio/Feedback/Details/1016534\" rel=\"nofollow\">https://connect.microsoft.com/VisualStudio/Feedback/Details/1016534</a>\nBut using this \"hack\" in Windows 10 [November release 1511] every touch causes exception.</p>\n\n<pre><code>System.ArgumentNullException: ???????? ?? ????? ???? ??????????????.\n??? ?????????: key\n   ? System.Collections.Generic.Dictionary`2.FindEntry(TKey key)\n   ? System.Collections.Generic.Dictionary`2.TryGetValue(TKey key, TValue&amp; value)\n   ? System.Windows.Input.StylusLogic.ProcessInputReport(RawStylusInputReport inputReport)\n   ? System.Windows.Input.PenContext.FirePenInRange(Int32 stylusPointerId, Int32[] data, Int32 timestamp)\n   ? System.Windows.Input.PenThreadWorker.FireEvent(PenContext penContext, Int32 evt, Int32 stylusPointerId, Int32 cPackets, Int32 cbPacket, IntPtr pPackets)\n   ? System.Windows.Input.PenThreadWorker.ThreadProc()\n   ? System.Threading.ThreadHelper.ThreadStart_Context(Object state)\n   ? System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)\n   ? System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)\n   ? System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n   ? System.Threading.ThreadHelper.ThreadStart()\n</code></pre>\n\n<p>P.P.S. I know about MS Surface SDK <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=26716\" rel=\"nofollow\">https://www.microsoft.com/en-us/download/details.aspx?id=26716</a>\nBut I can't use it because my app should run on Windows XP also.</p>\n"}, {"tags": ["c#", "inheritance", "interface", "custom-attributes"], "comments": [{"owner": {"reputation": 338, "user_id": 2364253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3289349624d97578e070f7439c5f131?s=128&d=identicon&r=PG", "display_name": "Cat_Clan", "link": "https://stackoverflow.com/users/2364253/cat-clan"}, "edited": false, "score": 1, "creation_date": 1448476297, "post_id": 33923815, "comment_id": 55608843, "body": "This has been answered on: <a href=\"http://stackoverflow.com/questions/12106566/attribute-on-interface-members-does-not-work\" title=\"attribute on interface members does not work\">stackoverflow.com/questions/12106566/&hellip;</a> Another interesting approach is: <a href=\"http://stackoverflow.com/questions/540749/can-a-c-sharp-class-inherit-attributes-from-its-interface\" title=\"can a c sharp class inherit attributes from its interface\">stackoverflow.com/questions/540749/&hellip;</a>"}, {"owner": {"reputation": 338, "user_id": 2364253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3289349624d97578e070f7439c5f131?s=128&d=identicon&r=PG", "display_name": "Cat_Clan", "link": "https://stackoverflow.com/users/2364253/cat-clan"}, "edited": false, "score": 0, "creation_date": 1448476812, "post_id": 33923815, "comment_id": 55609112, "body": "Also this is a good read on the topic and a more or less formal stand from Microsoft employees: <a href=\"http://bradwilson.typepad.com/blog/2011/08/interface-attributes-class-attributes.html\" rel=\"nofollow noreferrer\">bradwilson.typepad.com/blog/2011/08/&hellip;</a>"}], "owner": {"reputation": 9, "user_id": 3548015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f6f7ccedddfec896756f662f411b40?s=128&d=identicon&r=PG&f=1", "display_name": "user3548015", "link": "https://stackoverflow.com/users/3548015/user3548015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1448484650, "answer_count": 0, "score": 0, "last_activity_date": 1448475722, "creation_date": 1448475722, "question_id": 33923815, "link": "https://stackoverflow.com/questions/33923815/c-attributes-to-extended-interfaces-derived-interfaces", "closed_reason": "Duplicate", "title": "c# Attributes to extended interfaces ( derived interfaces )", "body": "<p>Is there a way of applying attributes to interfaces such that the deriving interfaces also get the attribute?</p>\n\n<pre><code>using System;\nnamespace Attributes\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            GetAttributes&lt;IBaseInterface&gt;();    //  Writes Hello World! to console\n            GetAttributes&lt;IModuleInterface&gt;();  //  Doesnt get the MyAttribute\n            Console.ReadKey();\n        }\n\n        static void GetAttributes&lt;T&gt;()\n        {\n            var a = typeof(T).GetCustomAttributes(typeof(MyAttribute), true);\n            if (a.Length &gt; 0)\n                Console.WriteLine((a[0] as MyAttribute).Abc);\n        }\n    }\n\n    [AttributeUsage(AttributeTargets.Interface, Inherited = true)]\n    public class MyAttribute : System.Attribute\n    {\n        public string Abc;\n    }\n\n    [MyAttribute(Abc = \"Hello World!\")]\n    public interface IBaseInterface\n    {\n\n    }\n\n    public interface IModuleInterface : IBaseInterface\n    {\n\n    }\n}\n</code></pre>\n\n<p>The IBaseInterface has the MyAttribute but the same attribute is not inherited by the derived IModuleInterface.</p>\n\n<p>Question: Can attributes of a base interface be somehow applied to derived (extended) interfaces? If yes how and if not why not? Also can you suggest some good articles on this topic?</p>\n"}, {"tags": ["c#", "sql", "sql-server-2008"], "comments": [{"owner": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "edited": false, "score": 1, "creation_date": 1448475775, "post_id": 33923808, "comment_id": 55608537, "body": "Different databases?"}, {"owner": {"reputation": 6942, "user_id": 225600, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f7ef6af7822f38db2fc5deb0c4d484df?s=128&d=identicon&r=PG", "display_name": "Prescott", "link": "https://stackoverflow.com/users/225600/prescott"}, "edited": false, "score": 1, "creation_date": 1448475803, "post_id": 33923808, "comment_id": 55608554, "body": "When you say doesn&#39;t work - do you mean it returns no records? Have you walked through your code to ensure that AppSettings is correctly set and loaded?"}, {"owner": {"reputation": 790, "user_id": 1394909, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/746bfa102ebee06c66755ec3288a67fb?s=128&d=identicon&r=PG", "display_name": "Zee", "link": "https://stackoverflow.com/users/1394909/zee"}, "edited": false, "score": 1, "creation_date": 1448476070, "post_id": 33923808, "comment_id": 55608719, "body": "How do you know it does not work? Have you called dr2.Read()?"}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 1, "creation_date": 1448476081, "post_id": 33923808, "comment_id": 55608724, "body": "btw <code>not like &#39;Passed&#39;</code> should be <code>&lt;&gt; &#39;Passed&#39;</code>"}, {"owner": {"reputation": 2992, "user_id": 1438082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/358935c3b3878f717094b9bf319d3f2c?s=128&d=identicon&r=PG", "display_name": "user1438082", "link": "https://stackoverflow.com/users/1438082/user1438082"}, "reply_to_user": {"reputation": 6942, "user_id": 225600, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f7ef6af7822f38db2fc5deb0c4d484df?s=128&d=identicon&r=PG", "display_name": "Prescott", "link": "https://stackoverflow.com/users/225600/prescott"}, "edited": false, "score": 0, "creation_date": 1448477696, "post_id": 33923808, "comment_id": 55609604, "body": "@Prescott yes i have walked through the code. No working means 0 records are returned given the same query that has results in SQL management studio."}, {"owner": {"reputation": 2992, "user_id": 1438082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/358935c3b3878f717094b9bf319d3f2c?s=128&d=identicon&r=PG", "display_name": "user1438082", "link": "https://stackoverflow.com/users/1438082/user1438082"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1448477715, "post_id": 33923808, "comment_id": 55609612, "body": "@GordonLinoff i have updated the question to clarify"}, {"owner": {"reputation": 2992, "user_id": 1438082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/358935c3b3878f717094b9bf319d3f2c?s=128&d=identicon&r=PG", "display_name": "user1438082", "link": "https://stackoverflow.com/users/1438082/user1438082"}, "reply_to_user": {"reputation": 790, "user_id": 1394909, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/746bfa102ebee06c66755ec3288a67fb?s=128&d=identicon&r=PG", "display_name": "Zee", "link": "https://stackoverflow.com/users/1394909/zee"}, "edited": false, "score": 0, "creation_date": 1448477783, "post_id": 33923808, "comment_id": 55609656, "body": "@Zee Yes i have singled stepped through the code. No results are returned given that the same query on management studio has results."}], "answers": [{"comments": [{"owner": {"reputation": 2992, "user_id": 1438082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/358935c3b3878f717094b9bf319d3f2c?s=128&d=identicon&r=PG", "display_name": "user1438082", "link": "https://stackoverflow.com/users/1438082/user1438082"}, "edited": false, "score": 0, "creation_date": 1448481548, "post_id": 33924426, "comment_id": 55611658, "body": "you are correct - that was the issue - i thought it was an issue embedding sql commands in c#"}], "tags": [], "owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "is_accepted": true, "score": 2, "last_activity_date": 1448477914, "creation_date": 1448477914, "answer_id": 33924426, "question_id": 33923808, "link": "https://stackoverflow.com/questions/33923808/sql-query-does-not-work-in-c/33924426#33924426", "title": "SQL Query Does not work in c#", "body": "<p>Maybe a typo but you declare <code>Query2</code> and use <code>Query</code></p>\n\n<pre><code>string **Query2** = @ConfigurationManager.AppSettings[\"Query2\"];  \nconn2.Open();\n\nSqlCommand cmd2 = new SqlCommand(**Query**, conn2); \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2992, "user_id": 1438082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/358935c3b3878f717094b9bf319d3f2c?s=128&d=identicon&r=PG", "display_name": "user1438082", "link": "https://stackoverflow.com/users/1438082/user1438082"}, "edited": false, "score": 0, "creation_date": 1448480590, "post_id": 33924430, "comment_id": 55611199, "body": "i dont have access on the server to create stored procedures."}], "tags": [], "owner": {"reputation": 4304, "user_id": 1113636, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/SuCW2.jpg?s=128&g=1", "display_name": "Gaspa79", "link": "https://stackoverflow.com/users/1113636/gaspa79"}, "is_accepted": false, "score": 1, "last_activity_date": 1448477921, "creation_date": 1448477921, "answer_id": 33924430, "question_id": 33923808, "link": "https://stackoverflow.com/questions/33923808/sql-query-does-not-work-in-c/33924430#33924430", "title": "SQL Query Does not work in c#", "body": "<p>Problems like this can be better debugged or completely solved by putting the Query in a stored procedure and just running the stored procedure using C#. </p>\n\n<p>So your stored procedure creating query would looksomething like this</p>\n\n<pre><code>USE TraceData;\nGO\nCREATE PROCEDURE MyWrappedQuery\n\nAS \nBEGIN\n\nSELECT \n    * \nFROM \n    [TraceData].[dbo].[MachineLog2] \nWHERE \n    [MachineFailReason] not like 'Passed' \n    AND Timestamp  &gt;= CAST(GETDATE()-1 AS DATETIME) + CAST('04:00:00' AS DATETIME)  \nORDER BY Timestamp DESC\n\nEND\n</code></pre>\n\n<p>And in C# you can either run the query 'exec MyWrappedQuery' or run the SP through ado.net</p>\n\n<p>Try that and reply to this, It should work if the query works in SQL server but not through C#. </p>\n"}], "owner": {"reputation": 2992, "user_id": 1438082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/358935c3b3878f717094b9bf319d3f2c?s=128&d=identicon&r=PG", "display_name": "user1438082", "link": "https://stackoverflow.com/users/1438082/user1438082"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 33924426, "answer_count": 2, "score": -3, "last_activity_date": 1448477921, "creation_date": 1448475700, "last_edit_date": 1448477545, "question_id": 33923808, "link": "https://stackoverflow.com/questions/33923808/sql-query-does-not-work-in-c", "title": "SQL Query Does not work in c#", "body": "<p>When I run the query below in SQL Management studio, it works brilliantly.</p>\n\n<p>When i run it in c# the result has no rows (only the headers) - Why ?\nI have single stepped through the code. Only the headers are returned. No Records.\nNote: Query2 is defined as the SQL query.</p>\n\n<p><strong>SQL Management Studio Query - Works</strong></p>\n\n<pre><code>SELECT \n    * \nFROM \n    [TraceData].[dbo].[MachineLog2] \nWHERE \n    [MachineFailReason] not like 'Passed' \n    AND Timestamp  &gt;= CAST(GETDATE()-1 AS DATETIME) + CAST('04:00:00' AS DATETIME)  \nORDER BY Timestamp DESC\n</code></pre>\n\n<p><strong>C# Code - Does NOT Work</strong></p>\n\n<pre><code>SqlConnection conn2 = new SqlConnection(connectionString);  \nstring Query2 = @ConfigurationManager.AppSettings[\"Query2\"];  \nconn2.Open();\n\nSqlCommand cmd2 = new SqlCommand(Query, conn2); \nSqlDataReader dr2 = cmd2.ExecuteReader();\n</code></pre>\n"}]