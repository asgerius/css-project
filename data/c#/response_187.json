[{"tags": ["c#", "methods", "colon"], "comments": [{"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1533772681, "post_id": 51757130, "comment_id": 90473714, "body": "Yes, the base constructor runs first."}, {"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 3, "creation_date": 1533773144, "post_id": 51757130, "comment_id": 90473792, "body": "@Plutonix what a time to be alive! (if that was the case)"}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533777512, "post_id": 51757130, "comment_id": 90474601, "body": "BTW there is <b>no</b> <i>colon</i> in any <i>method</i>.  There is a <i>colon</i> in your <i>class definition</i> however."}], "answers": [{"tags": [], "owner": {"reputation": 304, "user_id": 1552656, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e5bb4b9515c33650afb0de55b3f6db13?s=128&d=identicon&r=PG", "display_name": "Matt Brand", "link": "https://stackoverflow.com/users/1552656/matt-brand"}, "is_accepted": true, "score": 1, "last_activity_date": 1533773051, "creation_date": 1533773051, "answer_id": 51757195, "question_id": 51757130, "link": "https://stackoverflow.com/questions/51757130/colon-in-the-method/51757195#51757195", "title": "Colon in the method", "body": "<p>For constructors (function names with the same name as the class name), the : indicates that a constructor of the base class will be called and will execute first, with any passed parameters, before the code of the child constructor. </p>\n\n<p>So for the function <code>public Cylinder(double radius, double height) : base(radius)</code> the constructor for Circle is executed before the code in the Cylinder constructor, which in turn calls the constructor for Shape setting <code>this.x</code> and <code>this.y</code>, and then executes its own code, which it has none, and then finally the code in Cylinder constructor is executed, setting <code>y</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 142455, "user_id": 5133585, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/dfqcw.png?s=128&g=1", "display_name": "Sweeper", "link": "https://stackoverflow.com/users/5133585/sweeper"}, "is_accepted": false, "score": 0, "last_activity_date": 1533775256, "creation_date": 1533775256, "answer_id": 51757378, "question_id": 51757130, "link": "https://stackoverflow.com/questions/51757130/colon-in-the-method/51757378#51757378", "title": "Colon in the method", "body": "<p>You are right. When you create an instance of <code>Cylinder</code>, the constructor of <code>Shape</code> is executed first, initialising <code>x</code> and <code>y</code>. Then the constructor of <code>Circle</code> is executed, initialising <code>radius</code>. Finally, the constructor of <code>Cylinder</code> is executed, changing <code>y</code> to <code>height</code>.</p>\n\n<p>Note that this <code>: base</code> syntax only works on constructor. It doesn't work on ordinary methods. For ordinary methods, you do this:</p>\n\n<pre><code>public void Method1() {\n    base.Method1(); // to call the base class implementation first\n}\n</code></pre>\n\n<p>And this pattern of calling the base class constructor before anything else makes sense, doesn't it? Each subclass is a specialisation of their direct superclasses. So it makes sense to first \"construct\" the superclass, then \"construct\" the more specialised subclass.</p>\n"}], "owner": {"reputation": 65, "user_id": 9738481, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153532918471966/picture?type=large", "display_name": "Daniel Gilliland", "link": "https://stackoverflow.com/users/9738481/daniel-gilliland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "closed_date": 1533777450, "accepted_answer_id": 51757195, "answer_count": 2, "score": 0, "last_activity_date": 1533790319, "creation_date": 1533772467, "last_edit_date": 1533790319, "question_id": 51757130, "link": "https://stackoverflow.com/questions/51757130/colon-in-the-method", "closed_reason": "Duplicate", "title": "Colon in the method", "body": "<p>Just trying to confirm my understanding of a colon in a method. I found <a href=\"https://stackoverflow.com/questions/1071148/what-does-this-colon-mean\">this</a> post which explains that the code after the colon is run before the called method.</p>\n\n<p>Does this mean with the <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/instance-constructors\" rel=\"nofollow noreferrer\">code</a> below that Shape is run before Circle? And Circle is run before Cylinder?</p>\n\n<pre><code>public abstract class Shape\n{\n    public const double pi = Math.PI;\n    protected double x, y;\n\n    public Shape(double x, double y) =&gt; (this.x, this.y) = (x, y);\n    public abstract double Area();\n}\npublic class Circle : Shape\n{\n    public Circle(double radius) : base(radius, 0) { }\n    public override double Area() =&gt; pi * x * x;\n}\npublic class Cylinder : Circle\n{\n    public Cylinder(double radius, double height) : base(radius) =&gt; y = height;\n    public override double Area() =&gt; (2 * base.Area()) + (2 * pi * x * y);\n}\npublic class TestShapes\n{\n    private static void Main()\n    {\n        double radius = 2.5;\n        double height = 3.0;\n\n        Circle ring = new Circle(radius);\n        Cylinder tube = new Cylinder(radius, height);\n\n        Console.WriteLine(\"Area of the circle = {0:F2}\", ring.Area());\n        Console.WriteLine(\"Area of the cylinder = {0:F2}\", tube.Area());\n\n        // Keep the console window open in debug mode.\n        Console.WriteLine(\"Press any key to exit.\");\n        Console.ReadKey();\n    }\n}\n/* Output:\nArea of the circle = 19.63\nArea of the cylinder = 86.39\n*/\n</code></pre>\n"}, {"tags": ["c#", ".net", "wpf", "textbox", "focus"], "answers": [{"tags": [], "owner": {"reputation": 233, "user_id": 8297345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65d32a5b9febb9846598749237f3aa72?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Obermuller", "link": "https://stackoverflow.com/users/8297345/eric-obermuller"}, "is_accepted": false, "score": 0, "last_activity_date": 1533930259, "creation_date": 1533930259, "answer_id": 51793186, "question_id": 51757124, "link": "https://stackoverflow.com/questions/51757124/how-do-i-keep-a-textbox-scrolled-to-the-end-even-after-i-switch-focus-to-another/51793186#51793186", "title": "How do I keep a textbox scrolled to the end even after I switch focus to another textbox?", "body": "<p>Try this:\nTextboxA.CaretIndex = TextboxA.Text.Length;</p>\n"}], "owner": {"reputation": 1, "user_id": 8452713, "user_type": "registered", "profile_image": "https://graph.facebook.com/490518117953443/picture?type=large", "display_name": "NingaMEW", "link": "https://stackoverflow.com/users/8452713/ningamew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1533930259, "creation_date": 1533772354, "question_id": 51757124, "link": "https://stackoverflow.com/questions/51757124/how-do-i-keep-a-textbox-scrolled-to-the-end-even-after-i-switch-focus-to-another", "title": "How do I keep a textbox scrolled to the end even after I switch focus to another textbox?", "body": "<p>I have two textboxes, textboxB copies from textboxA every time the text is changed but textboxA doesn't keep scrolling to the end.  They're both one line textboxes that must have the cursor at the end 100% of the time.  pls help.</p>\n\n<pre><code>    private void Question_TextChanged(object sender, System.Windows.Controls.TextChangedEventArgs e)\n    {\n        autoComplete.Text = Question.Text;\n        autoComplete.Focus();\n        autoComplete.Select(autoComplete.Text.Length, 0);\n        Question.Focus();\n    }\n</code></pre>\n"}, {"tags": ["c#", "plugins", "dynamics-crm", "microsoft-dynamics", "microsoft-dynamics-webapi"], "comments": [{"owner": {"reputation": 20105, "user_id": 7920473, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10155688613669453/picture?type=large", "display_name": "Arun Vinoth", "link": "https://stackoverflow.com/users/7920473/arun-vinoth"}, "edited": false, "score": 0, "creation_date": 1533773555, "post_id": 51757114, "comment_id": 90473875, "body": "Do you have any firewall restrictions? Can you check from outside firewall?"}, {"owner": {"reputation": 825, "user_id": 4070633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tdwfs.jpg?s=128&g=1", "display_name": "Sxntk", "link": "https://stackoverflow.com/users/4070633/sxntk"}, "edited": false, "score": 0, "creation_date": 1533907635, "post_id": 51757114, "comment_id": 90532393, "body": "The plug-in is registered as none or sandbox? If it is none, try to change it to sandbox"}], "answers": [{"comments": [{"owner": {"reputation": 2825, "user_id": 3723803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Fujn1.jpg?s=128&g=1", "display_name": "Tim Hutchison", "link": "https://stackoverflow.com/users/3723803/tim-hutchison"}, "edited": false, "score": 0, "creation_date": 1533827549, "post_id": 51769854, "comment_id": 90499703, "body": "Thanks for the feedback! The reason we are using the Web API from a plugin is that the code that uses the Web API is a part of a dll library that is called from the plugin.  Within the plugin itself, we are using Web Services for all calls that we make"}, {"owner": {"reputation": 16340, "user_id": 1569689, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/21d698866fd3dfd4c566b5688ee99166?s=128&d=identicon&r=PG", "display_name": "James Wood", "link": "https://stackoverflow.com/users/1569689/james-wood"}, "reply_to_user": {"reputation": 2825, "user_id": 3723803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Fujn1.jpg?s=128&g=1", "display_name": "Tim Hutchison", "link": "https://stackoverflow.com/users/3723803/tim-hutchison"}, "edited": false, "score": 0, "creation_date": 1533831096, "post_id": 51769854, "comment_id": 90502033, "body": "Well I would suggest you change your API or create a version to have compatibilty with plugins."}], "tags": [], "owner": {"reputation": 16340, "user_id": 1569689, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/21d698866fd3dfd4c566b5688ee99166?s=128&d=identicon&r=PG", "display_name": "James Wood", "link": "https://stackoverflow.com/users/1569689/james-wood"}, "is_accepted": false, "score": 0, "last_activity_date": 1533825543, "last_edit_date": 1592644375, "creation_date": 1533825543, "answer_id": 51769854, "question_id": 51757114, "link": "https://stackoverflow.com/questions/51757114/dynamics-c-plugin-fails-when-run-but-succeeds-when-debugging/51769854#51769854", "title": "Dynamics C# Plugin fails when run, but succeeds when Debugging", "body": "<p>I think the answer here is to not use the Web API within a plugin.</p>\n<p><a href=\"https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/use-microsoft-dynamics-365-web-services\" rel=\"nofollow noreferrer\">Use Dynamics 365 web services</a></p>\n<blockquote>\n<h2>Web API</h2>\n<p><strong>Use the Web API</strong> for any projects that access Dynamics 365 data <strong>with\ncode that doesn\u2019t run on the server</strong>, including requests from web\nresources and form scripts that run in Dynamics 365 application\nclients. At this time <strong>you can\u2019t easily use the Web API for code that\nruns on the server, such as in plug-ins or workflow assemblies.</strong></p>\n<h2>Organization service</h2>\n<p>Business logic that runs in <strong>plug-ins</strong> or workflow assemblies on the server <strong>expect to use the Organization service.</strong></p>\n</blockquote>\n<p>As for why you are getting <code>401 - Unauthorized</code> in your plugin trace logs. I suspect its probably because the you are trying to make CRM call itself, and it simply can't authenticate. In any case plugin <a href=\"https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/plugin-isolation-trusts-statistics#web-access\" rel=\"nofollow noreferrer\">Web Access</a> is quite limited in this respect.</p>\n<blockquote>\n<p>The following web access restrictions apply to this sandbox capability.</p>\n<ul>\n<li>Anonymous authentication is supported and recommended.</li>\n</ul>\n</blockquote>\n<p>In terms of why the plugin works when debugging, I would guess its because the HTTP request is now being sent from your local machine and not the server. I'm assuming the Fiddler log is from your machine.</p>\n<p>Finally, the initial 401 followed by success when debugging; I believe the 401 is a credential challenge which is <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication\" rel=\"nofollow noreferrer\">common</a> in many authentication schemes.</p>\n"}, {"tags": [], "owner": {"reputation": 2825, "user_id": 3723803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Fujn1.jpg?s=128&g=1", "display_name": "Tim Hutchison", "link": "https://stackoverflow.com/users/3723803/tim-hutchison"}, "is_accepted": true, "score": 0, "last_activity_date": 1533911024, "last_edit_date": 1592644375, "creation_date": 1533905360, "answer_id": 51786931, "question_id": 51757114, "link": "https://stackoverflow.com/questions/51757114/dynamics-c-plugin-fails-when-run-but-succeeds-when-debugging/51786931#51786931", "title": "Dynamics C# Plugin fails when run, but succeeds when Debugging", "body": "<p>Upon investigating the <code>401.1 Unauthorized</code> error, I came across <a href=\"https://support.microsoft.com/en-us/help/896861/you-receive-error-401-1-when-you-browse-a-web-site-that-uses-integrate\" rel=\"nofollow noreferrer\">this</a> article. Here's the relevant piece:</p>\n<blockquote>\n<p>When you use the fully qualified domain name (FQDN) or a custom host header to browse a local Web site that is hosted on a computer that is running Microsoft Internet Information Services (IIS) 5.1 or a later version, you may receive an error message that resembles the following:</p>\n<p>HTTP 401.1 - Unauthorized: Logon Failed</p>\n<p>This issue occurs when the Web site uses Integrated Authentication and has a name that is mapped to the local loopback address.</p>\n<p>Note You only receive this error message if you try to browse the Web site directly on the server. If you browse the Web site from a client computer, the Web site works as expected.</p>\n</blockquote>\n<p>The article provides several methods for resolving the issue, but here is the one that worked for us (must be done on the server):</p>\n<ol>\n<li>Use regedit to navigate to HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanServer\\Parameters and add a value called DisableStrictNameChecking (REG-DWORD, Decimal) with a value of 1</li>\n<li>Use regedit to navigate to HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0 and add a Multi-String value called BackConnectionHostNames with a value of your hostname of the web api endpoint</li>\n<li>Open the command line and type iisreset (must be run as administrator)</li>\n<li>Restart the server</li>\n</ol>\n"}], "owner": {"reputation": 2825, "user_id": 3723803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Fujn1.jpg?s=128&g=1", "display_name": "Tim Hutchison", "link": "https://stackoverflow.com/users/3723803/tim-hutchison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 0, "accepted_answer_id": 51786931, "answer_count": 2, "score": 3, "last_activity_date": 1533911024, "creation_date": 1533772221, "last_edit_date": 1533904821, "question_id": 51757114, "link": "https://stackoverflow.com/questions/51757114/dynamics-c-plugin-fails-when-run-but-succeeds-when-debugging", "title": "Dynamics C# Plugin fails when run, but succeeds when Debugging", "body": "<h3>Overview</h3>\n\n<p>I am on Dynamics 2016 on premise.</p>\n\n<p>I have a Business Process Flow in Microsoft Dynamics to handle creation of a new client. When the process finishes, I am attaching a workflow that kicks off an action which calls a plugin to do some custom processing. I am following <a href=\"https://sigaostudios.com/2017/05/business-process-flow-trigger-plugin/\" rel=\"nofollow noreferrer\">this</a> article to set up this process. When this plugin is triggered in Dynamics, it appears to run successfully, but does not create the records I am expecting it to create.  However, when I profile the plugin and run it through the Plugin Registration Tool/Visual Studio the records are created that I expect to see.</p>\n\n<p>When I added trace logs to my plugin, I noticed that it appears I am receiving a <code>401 - Unauthorized</code> error from Dynamics when I call the Web API.  When I looked at the network traffic while debugging it looks like I receive an initial <code>401</code> error, but then a retry successfully gets the records I am trying to get.</p>\n\n<h3>Code</h3>\n\n<p>This is the section of code I think the <code>401-Unauthorized</code> error is coming from</p>\n\n<pre><code>private void GetGlobalFieldNameMapsAsync(String url = \"ccseq_globalfieldnamemaps?$select=ccseq_system,ccseq_entitytype,ccseq_fieldtype,ccseq_name,ccseq_datatype\")\n{\n    HttpClient client = new HttpClient(new HttpClientHandler() { Credentials = new NetworkCredential(\"admin\", \"password\", \"domain\") });\n    HttpResponseMessage responseMessage = new HttpResponseMessage();\n    try\n    {\n        client.BaseAddress = new Uri(Helpers.GetSystemUrl(APIConnector.Application.Dynamics));\n        client.DefaultRequestHeaders.Clear();\n        client.DefaultRequestHeaders.Accept.Add(new System.Net.Http.Headers.MediaTypeWithQualityHeaderValue(\"application/json\"));\n        client.DefaultRequestHeaders.Add(\"OData-MaxVersion\", \"4.0\");\n        client.DefaultRequestHeaders.Add(\"OData-Version\", \"4.0\");    \n\n        responseMessage = client.GetAsync(url).Result;    \n\n        JObject responseData = JObject.Parse(responseMessage.Content.ReadAsStringAsync().Result);\n\n        if (responseData[\"@odata.nextLink\"] != null)\n        {\n                    GetGlobalFieldNameMapsAsync(Convert.ToString(responseData[\"@odata.nextLink\"]));\n        }\n\n        foreach (var v in responseData[\"value\"])\n        {\n            GlobalFieldNameMap newGFNM = new GlobalFieldNameMap();\n            newGFNM.System.Value = Convert.ToInt32(v[\"ccseq_system\"]);\n            newGFNM.EntityType.Value = Convert.ToInt32(v[\"ccseq_entitytype\"]);\n            newGFNM.FieldType.Value = Convert.ToInt32(v[\"ccseq_fieldtype\"]);\n            newGFNM.FieldName.Value = Convert.ToString(v[\"ccseq_name\"]);\n            newGFNM.DataType.Value = Convert.ToInt32(v[\"ccseq_datatype\"]);\n            FieldNameMap.Add(newGFNM);\n        }\n\n    }\n    catch (Exception e)\n    {\n        throw new Exception(e.Message + \" - \" + responseMessage.Content.ReadAsStringAsync().Result);\n    }\n}\n</code></pre>\n\n<h3>Network Traffic</h3>\n\n<p><a href=\"https://i.stack.imgur.com/Vlk9l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vlk9l.png\" alt=\"Network Traffic\"></a></p>\n\n<p>I can't seem to puzzle out how I am seeing the plugin successfully run during debugging, but seeing it fail when running directly in dynamics. The plugin appears to be running under the same user regardless of whether it's running in Dynamics or on my local machine. I'm passing in admin credentials so they should have full permissions to do anything in the system. Any thoughts?</p>\n\n<p>I have asked <a href=\"https://stackoverflow.com/questions/51623647/call-dynamics-web-api-in-c-sharp-plugin\">this</a> question and <a href=\"https://stackoverflow.com/questions/51635589/unable-to-debug-dynamics-c-sharp-plugin-in-plugin-registration-tool\">this</a> question which may be related, but don't quite cover this issue.</p>\n\n<hr>\n\n<h3>Update</h3>\n\n<p>I noticed this error message in the trace logs</p>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt; \n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt; \n&lt;head&gt; \n&lt;title&gt;IIS 8.5 Detailed Error - 401.1 - Unauthorized&lt;/title&gt; \n&lt;style type=\"text/css\"&gt; \n&lt;!-- \nbody{margin:0;font-size:.7em;font-family:Verdana,Arial,Helvetica,sans-serif;} \ncode{margin:0;color:#006600;font-size:1.1em;font-weight:bold;} \n.config_source code{font-size:.8em;color:#000000;} \npre{margin:0;font-size:1.4em;word-wrap:break-word;} \nul,ol{margin:10px 0 10px 5px;} \nul.first,ol.first{margin-top:5px;} \nfieldset{padding:0 15px 10px 15px;word-break:break-all;} \n.summary-container fieldset{padding-bottom:5px;margin-top:4px;} \nlegend.no-expand-all{padding:2px 15px 4px 10px;margin:0 0 0 -12px;} \nlegend{color:#333333;;margin:4px 0 8px -12px;_margin-top:0px; \nfont-weight:bold;font-size:1em;} \na:link,a:visited{color:#007EFF;font-weight:bold;} \na:hover{text-decoration:none;} \nh1{font-size:2.4em;margin:0;color:#FFF;} \nh2{font-size:1.7em;margin:0;color:#CC0000;} \nh3{font-size:1.4em;margin:10px 0 0 0;color:#CC0000;} \nh4{font-size:1.2em;margin:10px 0 5px 0; \n}#header{width:96%;margin:0 0 0 0;padding:6px 2% 6px 2%;font-family:\"trebuchet MS\",Verdana,sans-serif; \ncolor:#FFF;background-color:#5C87B2; \n}#content{margin:0 0 0 2%;position:relative;} \n.summary-container,.content-container{background:#FFF;width:96%;margin-top:8px;padding:10px;position:relative;} \n.content-container p{margin:0 0 10px 0; \n}#details-left{width:35%;float:left;margin-right:2%; \n}#details-right{width:63%;float:left;overflow:hidden; \n}#server_version{width:96%;_height:1px;min-height:1px;margin:0 0 5px 0;padding:11px 2% 8px 2%;color:#FFFFFF; \nbackground-color:#5A7FA5;border-bottom:1px solid #C1CFDD;border-top:1px solid #4A6C8E;font-weight:normal; \nfont-size:1em;color:#FFF;text-align:right; \n}#server_version p{margin:5px 0;} \ntable{margin:4px 0 4px 0;width:100%;border:none;} \ntd,th{vertical-align:top;padding:3px 0;text-align:left;font-weight:normal;border:none;} \nth{width:30%;text-align:right;padding-right:2%;font-weight:bold;} \nthead th{background-color:#ebebeb;width:25%; \n}#details-right th{width:20%;} \ntable tr.alt td,table tr.alt th{} \n.highlight-code{color:#CC0000;font-weight:bold;font-style:italic;} \n.clear{clear:both;} \n.preferred{padding:0 5px 2px 5px;font-weight:normal;background:#006633;color:#FFF;font-size:.8em;} \n--&gt; \n&lt;/style&gt; \n\n&lt;/head&gt; \n&lt;body&gt; \n&lt;div id=\"content\"&gt; \n&lt;div class=\"content-container\"&gt; \n&lt;h3&gt;HTTP Error 401.1 - Unauthorized&lt;/h3&gt; \n&lt;h4&gt;You do not have permission to view this directory or page using the credentials that you supplied.&lt;/h4&gt; \n&lt;/div&gt; \n&lt;div class=\"content-container\"&gt; \n&lt;fieldset&gt;&lt;h4&gt;Most likely causes:&lt;/h4&gt; \n&lt;ul&gt; &lt;li&gt;The username supplied to IIS is invalid.&lt;/li&gt; &lt;li&gt;The password supplied to IIS was not typed correctly. &lt;/li&gt; &lt;li&gt;Incorrect credentials were cached by the browser.&lt;/li&gt; &lt;li&gt;IIS could not verify the identity of the username and password provided.&lt;/li&gt; &lt;li&gt;The resource is configured for Anonymous authentication, but the configured anonymous account either has an invalid password or was disabled.&lt;/li&gt; &lt;li&gt;The server is configured to deny login privileges to the authenticating user or the group in which the user is a member.&lt;/li&gt; &lt;li&gt;Invalid Kerberos configuration may be the cause if all of the following are true:&lt;/li&gt; &lt;ul&gt; &lt;li&gt;Integrated authentication was used.&lt;/li&gt; &lt;li&gt;the application pool identity is a custom account.&lt;/li&gt; &lt;li&gt;the server is a member of a domain.&lt;/li&gt; &lt;/ul&gt; &lt;/ul&gt; \n&lt;/fieldset&gt; \n&lt;/div&gt; \n&lt;div class=\"content-container\"&gt; \n&lt;fieldset&gt;&lt;h4&gt;Things you can try:&lt;/h4&gt; \n&lt;ul&gt; &lt;li&gt;Verify that the username and password are correct, and are not cached by the browser.&lt;/li&gt; &lt;li&gt;Use a different username and password.&lt;/li&gt; &lt;li&gt;If you are using a custom anonymous account, verify that the password has not expired.&lt;/li&gt; &lt;li&gt;Verify that the authenticating user or the user's group, has not been denied login access to the server.&lt;/li&gt; &lt;li&gt;Verify that the account was not locked out due to numerous failed login attempts.&lt;/li&gt; &lt;li&gt;If you are using authentication and the server is a member of a domain, verify that you have configured the application pool identity using the utility SETSPN.exe, or changed the configuration so that NTLM is the favored authentication type.&lt;/li&gt; &lt;li&gt;Create a tracing rule to track failed requests for this HTTP status code. For more information about creating a tracing rule for failed requests, click &lt;a href=\"http://go.microsoft.com/fwlink/?LinkID=66439\"&gt;here&lt;/a&gt;. &lt;/li&gt; &lt;/ul&gt; \n&lt;/fieldset&gt; \n&lt;/div&gt; \n\n&lt;div class=\"content-container\"&gt; \n&lt;fieldset&gt;&lt;h4&gt;Detailed Error Information:&lt;/h4&gt; \n&lt;div id=\"details-left\"&gt; \n&lt;table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt; \n&lt;tr class=\"alt\"&gt;&lt;th&gt;Module&lt;/th&gt;&lt;td&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;WindowsAuthenticationModule&lt;/td&gt;&lt;/tr&gt; \n&lt;tr&gt;&lt;th&gt;Notification&lt;/th&gt;&lt;td&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;AuthenticateRequest&lt;/td&gt;&lt;/tr&gt; \n&lt;tr class=\"alt\"&gt;&lt;th&gt;Handler&lt;/th&gt;&lt;td&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;ExtensionlessUrlHandler-Integrated-4.0&lt;/td&gt;&lt;/tr&gt; \n&lt;tr&gt;&lt;th&gt;Error Code&lt;/th&gt;&lt;td&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;0xc000006d&lt;/td&gt;&lt;/tr&gt; \n\n&lt;/table&gt; \n&lt;/div&gt; \n&lt;div id=\"details-right\"&gt; \n&lt;table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"&gt; \n&lt;tr class=\"alt\"&gt;&lt;th&gt;Requested URL&lt;/th&gt;&lt;td&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;https://crminternal.cohencpa.com:443/COHEN/api/data/v8.2/ccseq_globalfieldnamemaps?$select=ccseq_system,ccseq_entitytype,ccseq_fieldtype,ccseq_name,ccseq_datatype&lt;/td&gt;&lt;/tr&gt; \n&lt;tr&gt;&lt;th&gt;Physical Path&lt;/th&gt;&lt;td&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;C:\\Program Files\\Microsoft Dynamics CRM\\CRMWeb\\COHEN\\api\\data\\v8.2\\ccseq_globalfieldnamemaps&lt;/td&gt;&lt;/tr&gt; \n&lt;tr class=\"alt\"&gt;&lt;th&gt;Logon Method&lt;/th&gt;&lt;td&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Not yet determined&lt;/td&gt;&lt;/tr&gt; \n&lt;tr&gt;&lt;th&gt;Logon User&lt;/th&gt;&lt;td&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Not yet determined&lt;/td&gt;&lt;/tr&gt; \n\n&lt;/table&gt; \n&lt;div class=\"clear\"&gt;&lt;/div&gt; \n&lt;/div&gt; \n&lt;/fieldset&gt; \n&lt;/div&gt; \n\n&lt;div class=\"content-container\"&gt; \n&lt;fieldset&gt;&lt;h4&gt;More Information:&lt;/h4&gt; \nThis error occurs when either the username or password supplied to IIS is invalid, or when IIS cannot use the username and password to authenticate the user. \n&lt;p&gt;&lt;a href=\"http://go.microsoft.com/fwlink/?LinkID=62293&amp;amp;IIS70Error=401,1,0xc000006d,9600\"&gt;View more information &amp;raquo;&lt;/a&gt;&lt;/p&gt; \n&lt;p&gt;Microsoft Knowledge Base Articles:&lt;/p&gt; \n&lt;ul&gt;&lt;li&gt;907273&lt;/li&gt;&lt;li&gt;871179&lt;/li&gt;&lt;li&gt;896861&lt;/li&gt;&lt;/ul&gt; \n\n&lt;/fieldset&gt; \n&lt;/div&gt; \n&lt;/div&gt; \n&lt;/body&gt; \n&lt;/html&gt; \n</code></pre>\n"}, {"tags": ["c#", "android", "ios", "xamarin", "xamarin.forms"], "answers": [{"tags": [], "owner": {"reputation": 10610, "user_id": 1970317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8a0ab8445fafb38afdf26cb976df32f?s=128&d=identicon&r=PG", "display_name": "EvZ", "link": "https://stackoverflow.com/users/1970317/evz"}, "is_accepted": true, "score": 0, "last_activity_date": 1533792473, "creation_date": 1533792473, "answer_id": 51759407, "question_id": 51757078, "link": "https://stackoverflow.com/questions/51757078/creating-a-pop-up-outside-of-app-xamarin-forms/51759407#51759407", "title": "Creating A Pop Up Outside Of App Xamarin Forms", "body": "<p>Background tasks on mobile has quite a lot of limitations. Which is logical. The user would not like if some app will always run in background and collect user data, drain the battery or affect overal performance of the the mobile device. Therefore for there are strict set of rules every developer must follow when creating a background tasks.</p>\n\n<p>You best bet would be to use local notifications, there is a well documented <a href=\"https://github.com/edsnider/localnotificationsplugin\" rel=\"nofollow noreferrer\">open source library</a> that you can use for this. There will be no pop-ups but notifications which you could customize according to OS guides.</p>\n"}], "owner": {"reputation": 313, "user_id": 4305208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d406b9fa769339e7afac7472d7b65c?s=128&d=identicon&r=PG", "display_name": "Joe Fioti", "link": "https://stackoverflow.com/users/4305208/joe-fioti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 51759407, "answer_count": 1, "score": -1, "last_activity_date": 1533792473, "creation_date": 1533771874, "question_id": 51757078, "link": "https://stackoverflow.com/questions/51757078/creating-a-pop-up-outside-of-app-xamarin-forms", "title": "Creating A Pop Up Outside Of App Xamarin Forms", "body": "<p>I have an app that needs to create a pop up to notify the user of something, even when the app is closed. I would like it to be fullscreen, but if that's not possible, a pop up that takes up most of the screen will do. I don't know how to make part of the app run in the background on Android and iOS to check if it's time for the pop up. I also don't know how to go about making the actual pop up. Any help would be greatly appreciated!</p>\n\n<p>Side notes: I am using a cross platform Xamarin.Forms app. I have a main page that the user can set the time they want the pop up to appear, and I save this to the Application.Current.Properties dictionary for data persistence.</p>\n"}, {"tags": ["c#", "sql", "linq"], "comments": [{"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 2, "creation_date": 1533770509, "post_id": 51756812, "comment_id": 90473261, "body": "Have you tried using <code>.First()</code>?"}, {"owner": {"reputation": 291, "user_id": 670033, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd721e17ac2aeddf46e5a1136fede91f?s=128&d=identicon&r=PG", "display_name": "Larry Hengen", "link": "https://stackoverflow.com/users/670033/larry-hengen"}, "reply_to_user": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 0, "creation_date": 1533827733, "post_id": 51756812, "comment_id": 90499819, "body": "Yes.  It limits the main result set to the first row, not the sub-query"}, {"owner": {"reputation": 291, "user_id": 670033, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd721e17ac2aeddf46e5a1136fede91f?s=128&d=identicon&r=PG", "display_name": "Larry Hengen", "link": "https://stackoverflow.com/users/670033/larry-hengen"}, "reply_to_user": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 0, "creation_date": 1533828386, "post_id": 51756812, "comment_id": 90500307, "body": "There is a &quot;select Top 1&quot; in the sub-query in the SQL version"}, {"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 1, "creation_date": 1533833358, "post_id": 51756812, "comment_id": 90503213, "body": "The most sane way then would probably be to split the C# version into two queries - do the &quot;subquery&quot; first, store the result of <code>.First()</code> in a temporary variable, then check against it in the &quot;main&quot; query."}, {"owner": {"reputation": 6718, "user_id": 68693, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/081abbd481555f4929927a36ae5b3d47?s=128&d=identicon&r=PG", "display_name": "Tipx", "link": "https://stackoverflow.com/users/68693/tipx"}, "edited": false, "score": 0, "creation_date": 1533845735, "post_id": 51756812, "comment_id": 90508844, "body": "Just a small connexe point: The concept of &quot;first&quot; row is dangerous if there is no sort order. It might be obvious for humans in some case (creation date, id, etc.) but, you shouldn&#39;t rely on the default returned order since it&#39;s not guaranteed to be deterministic."}], "answers": [{"tags": [], "owner": {"reputation": 5866, "user_id": 2102132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8pk78.png?s=128&g=1", "display_name": "Milney", "link": "https://stackoverflow.com/users/2102132/milney"}, "is_accepted": false, "score": 0, "last_activity_date": 1533828502, "creation_date": 1533828502, "answer_id": 51770868, "question_id": 51756812, "link": "https://stackoverflow.com/questions/51756812/what-is-the-lambda-syntax-to-limit-a-subquery-to-the-first-row/51770868#51770868", "title": "What is the Lambda Syntax to limit a subquery to the first row?", "body": "<p>You need to use not the GetAllIncluding method then, as it looks like that includes the whole collection...</p>\n"}, {"comments": [{"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1533902063, "post_id": 51775073, "comment_id": 90528852, "body": "But then what&#39;s the type of <code>ti.Item.ItemPrice</code>? The SQL query suggests that Item has multiple ItemPrices, so it should be a collection. I wonder if <code>ti.Item.ItemPrice.LocationId</code> even compiles. Also, you probably could have use LINQ after all, but a different statement."}], "tags": [], "owner": {"reputation": 291, "user_id": 670033, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd721e17ac2aeddf46e5a1136fede91f?s=128&d=identicon&r=PG", "display_name": "Larry Hengen", "link": "https://stackoverflow.com/users/670033/larry-hengen"}, "is_accepted": false, "score": 0, "last_activity_date": 1533851846, "last_edit_date": 1533851846, "creation_date": 1533845435, "answer_id": 51775073, "question_id": 51756812, "link": "https://stackoverflow.com/questions/51756812/what-is-the-lambda-syntax-to-limit-a-subquery-to-the-first-row/51775073#51775073", "title": "What is the Lambda Syntax to limit a subquery to the first row?", "body": "<p>I think Abion47's comment was on the money, but I resolved the issue by upgrading to EF Core 2.1.1 and executing the SQL using the Query&lt;TaxItemInfo>.FromSQL() method.  I think this is one of those cases where a query could not easily be expressed using Lambda notation, and was more efficiently executed using SQL.<code></p>\n\n<pre><code>var taxInfo = Context.Query&lt;TaxItemInfo&gt;().FromSql\n  (\n    $@\"select ti.TaxId, ti.ApplyTax, ip.Price, tx.Value as TaxValue,   tx.SpecifyItems, tx.TaxType, tx.UseNetPrice\n       from TaxItem ti \n       inner join Tax tx on tx.id = ti.TaxId \n       inner join Item on ti.ItemId = Item.Id \n       inner join \n       (\n         select top 1 locationId,regionId,ItemId,Price from ItemPrice where  ItemId = {ItemId} and \n           ( \n             (LocationId is not null and LocationId = {LocationId}) OR \n             (LocationId is null and RegionId = {RegionId}) \n            ) \n        ) ip on ip.ItemId = Item.Id\"\n  );\n</code></pre>\n\n<p></code></p>\n"}, {"tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1533847222, "creation_date": 1533847222, "answer_id": 51775446, "question_id": 51756812, "link": "https://stackoverflow.com/questions/51756812/what-is-the-lambda-syntax-to-limit-a-subquery-to-the-first-row/51775446#51775446", "title": "What is the Lambda Syntax to limit a subquery to the first row?", "body": "<p>I don't ABP framework, this is plain Linq:</p>\n\n<pre><code>var taxItems = from ti in context.TaxItem\n               let ip = ti.Item.ItemPrice\n                   .FirstOrDefault(x =&gt; x.LocationId == LocationId ||\n                                  x.RegionId == locationCacheItem.RegionId)\n               select new {\n                  TaxId = ti.TaxId, \n                  ApplyTax = ti.ApplyTax, \n                  Price = ip.Price, \n                  TaxValue = ti.Tax.Value, \n                  SpecifyItems = ti.Tax.SpecifyItems, \n                  TaxType = ti.Tax.TaxType, \n                  UseNetPrice = ti.Tax.UseNetPrice\n               };\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 670033, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/cd721e17ac2aeddf46e5a1136fede91f?s=128&d=identicon&r=PG", "display_name": "Larry Hengen", "link": "https://stackoverflow.com/users/670033/larry-hengen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1533851846, "creation_date": 1533769462, "last_edit_date": 1533827821, "question_id": 51756812, "link": "https://stackoverflow.com/questions/51756812/what-is-the-lambda-syntax-to-limit-a-subquery-to-the-first-row", "title": "What is the Lambda Syntax to limit a subquery to the first row?", "body": "<p>I have a database with Item, Tax, TaxItem and ItemPrice tables.  The relationships are quite simple with the exception of the ItemPrice table.  In the ItemPrice table there can be multiple rows for a given ItemId since Locations can override the prices specified at the Region level.  Each record must contain either a RegionId or LocationId but not both and both cannot be null.</p>\n\n<p><b>ItemPrice</b><br>\nId<br>\nItemId<br>\nLocationId (nullable)<br>\nPrice<br>\nRegionId (nullable)<br></p>\n\n<p><b>Item</b><br>\nId<br>\nName<br></p>\n\n<p><b>Tax</b><br>\nId<br>\nName<br>\nType<br>\nValue<br></p>\n\n<p><b>TaxItem</b><br>\nItemId<br>\nTaxId<br></p>\n\n<p>The ABP framework I am using leverages the repository pattern.  The code I current have is as follows:</p>\n\n<pre><code>var taxItems = _TaxItemRepository\n.GetAllIncluding(ti =&gt; ti.Item, ti =&gt; ti.Tax, ti =&gt; ti.Item.ItemPrice)\n.Where(ti =&gt;\n    (ti.ItemId == ItemId)\n    &amp;&amp;\n    (\n        (ti.Item.ItemPrice.LocationId.HasValue &amp;&amp; ti.Item.ItemPrice.LocationId == LocationId)\n        ||\n        (!ti.Item.ItemPrice.LocationId.HasValue &amp;&amp; ti.Item.ItemPrice.RegionId == locationCacheItem.RegionId)\n    )\n);\n</code></pre>\n\n<p>Unfortunately it is not equivalent to the following SQL that provides the correct results:</p>\n\n<pre><code>declare @ItemId bigint, @LocationId bigint, @RegionId bigint\nset @ItemId = 1\nset @LocationId = 1\nset @RegionId = 1\n\n\n        select ti.TaxId as TaxId, ti.ApplyTax as ApplyTax, ip.Price, tx.Value as TaxValue, tx.SpecifyItems, tx.TaxType, tx.UseNetPrice\n        from TaxItem ti \n        inner join Tax tx on tx.id = ti.TaxId\n        inner join Item on ti.ItemId = Item.Id\n        inner join \n        (   \n            select top 1 locationId, regionId, ItemId, Price \n            from ItemPrice \n            where ItemId = @ItemId and \n            (\n                (LocationId is not null and LocationId = @locationId) OR \n                (LocationId is null and RegionId = @RegionId) \n            )\n        ) ip on ip.ItemId = Item.Id\n</code></pre>\n\n<p>I have two records in the ItemPrice table for ItemID 1:</p>\n\n<pre>   \nLocationId  Price   RegionId\n1           1.25    NULL\nNULL        1.50    1\n</pre>   \n\n<p>How do I get the Lambda expression to limit the subquery to the first row?</p>\n"}, {"tags": ["c#", "itext", "itext7"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 13551, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd1f5e9b661b10cfb7bdee6cf746ae6c?s=128&d=identicon&r=PG", "display_name": "Sean Rock", "link": "https://stackoverflow.com/users/13551/sean-rock"}, "is_accepted": false, "score": 0, "last_activity_date": 1539538098, "creation_date": 1539538098, "answer_id": 52805237, "question_id": 51756770, "link": "https://stackoverflow.com/questions/51756770/adding-header-to-pages-using-itext7/52805237#52805237", "title": "Adding header to pages using iText7", "body": "<p>I believe you need to use page events. This is well documented. Create a class that implements IEventHandler that will handle specific events.</p>\n\n<p>Add a event handler for a specific event</p>\n\n<pre><code>pdf.AddEventHandler(PdfDocumentEvent.START_PAGE, new StartPageEventHandler());\n</code></pre>\n\n<p>StartPageEventHandler is a class you create, implementing IEventHandler. You'll likely need to take this approach for both header and footer.</p>\n\n<p><a href=\"https://developers.itextpdf.com/content/itext-7-jump-start-tutorial-net/chapter-3-using-renderers-and-event-handlers\" rel=\"nofollow noreferrer\">See this link for more info</a> </p>\n"}], "owner": {"reputation": 2649, "user_id": 1048588, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/1324473728/picture?type=large", "display_name": "jstuardo", "link": "https://stackoverflow.com/users/1048588/jstuardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1295, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1539538098, "creation_date": 1533769170, "last_edit_date": 1533773939, "question_id": 51756770, "link": "https://stackoverflow.com/questions/51756770/adding-header-to-pages-using-itext7", "title": "Adding header to pages using iText7", "body": "<p>I need to add an HTML block as the header of all pages using iText7. The header contains an image logo and some text.</p>\n\n<p>I have this at the moment, before closing the document object:</p>\n\n<pre><code>for (int i = 1; i &lt;= n; i++)\n{\n    float x = pdf.GetPage(i).GetPageSize().GetWidth() / 2;  // 297.5f\n    float yFooter = 20;\n\n    if (headerBlock != null)\n    {\n        float yHeader = 600;// pdf.GetPage(i).GetPageSize().GetTop() - 20;\n\n        // Header\n        document.ShowTextAligned(headerBlock, 0, yHeader, page, TextAlignment.LEFT, VerticalAlignment.BOTTOM, 0);\n    }\n\n    // Footer\n    Paragraph footerBlock = new Paragraph(String.Format(\"P\u00e1gina {0} de {1}\", i, n));\n    document.ShowTextAligned(footerBlock, x, yFooter, page, TextAlignment.CENTER, VerticalAlignment.MIDDLE, 0);\n}\n</code></pre>\n\n<p>Footer works correctly but header. </p>\n\n<p>Header was loaded this way:</p>\n\n<pre><code>Paragraph headerBlock = String.IsNullOrWhiteSpace(header) ? null : CreateHtmlParagraph(header);\n</code></pre>\n\n<p>where, <code>CreateHtmlParagraph</code> is defined this way:</p>\n\n<pre><code>private Paragraph CreateHtmlParagraph(string html)\n{\n    Paragraph p = new Paragraph();\n    ConverterProperties properties = new ConverterProperties();\n    properties.SetBaseUri(HttpContext.Current.Server.MapPath(\"/\"));\n    var elements = HtmlConverter.ConvertToElements(html, properties);\n\n    foreach (IElement e in elements)\n        p.Add((IBlockElement)e);\n\n    return p;\n}\n</code></pre>\n\n<p>When I add the header using the <code>document.Add</code> method, it works well, but for the first page only. All other content follows it.</p>\n\n<p>When I try to add it using <code>ShowTextAligned</code> method, only the image is rendered in all pages.</p>\n\n<p>By the way, is there a way to get the actual height of the header paragraph? I think, once the header positioning is solved, I will have the problem that the other content blocks will be overlapped by the header.</p>\n"}, {"tags": ["c#", "asp.net", ".net", "async-await"], "comments": [{"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 3, "creation_date": 1533769312, "post_id": 51756758, "comment_id": 90473001, "body": "The parentheses is how this has always worked"}, {"owner": {"reputation": 385, "user_id": 1732910, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/4vbwd.jpg?s=128&g=1", "display_name": "Daniel Kempner", "link": "https://stackoverflow.com/users/1732910/daniel-kempner"}, "reply_to_user": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 0, "creation_date": 1533769474, "post_id": 51756758, "comment_id": 90473035, "body": "I&#39;ll take your word for it, thanks. Marking this as closed."}, {"owner": {"reputation": 3744, "user_id": 4298200, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-HcKtiretO2g/AAAAAAAAAAI/AAAAAAAAAH0/IXGAL7MX8sQ/photo.jpg?sz=128", "display_name": "Neuron", "link": "https://stackoverflow.com/users/4298200/neuron"}, "edited": false, "score": 2, "creation_date": 1533773839, "post_id": 51756758, "comment_id": 90473940, "body": "<i>don&#39;t</i> post code as screenshots. Please simply copy&amp;paste it. That way search engines can index your post, other people can find it through the search, people can copy&amp;paste the code, it uses less traffic, the list goes on and on. Thanks!"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1533774043, "post_id": 51756758, "comment_id": 90473971, "body": "@DJKempner - Please don&#39;t post screenshots - we need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so that we can run your code and give you a decent answer. Please post the code as text."}, {"owner": {"reputation": 23543, "user_id": 2281790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/pP0ow.jpg?s=128&g=1", "display_name": "Harald Coppoolse", "link": "https://stackoverflow.com/users/2281790/harald-coppoolse"}, "edited": false, "score": 0, "creation_date": 1533799099, "post_id": 51756758, "comment_id": 90480889, "body": "If you don&#39;t use parentheses, your await is defined as <code>await (GetInts().Sum())</code>, which of course can&#39;t compile"}, {"owner": {"reputation": 385, "user_id": 1732910, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/4vbwd.jpg?s=128&g=1", "display_name": "Daniel Kempner", "link": "https://stackoverflow.com/users/1732910/daniel-kempner"}, "reply_to_user": {"reputation": 3744, "user_id": 4298200, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-HcKtiretO2g/AAAAAAAAAAI/AAAAAAAAAH0/IXGAL7MX8sQ/photo.jpg?sz=128", "display_name": "Neuron", "link": "https://stackoverflow.com/users/4298200/neuron"}, "edited": false, "score": 0, "creation_date": 1533832051, "post_id": 51756758, "comment_id": 90502548, "body": "Thanks @LonelyNeuron, I dropped in the source code."}, {"owner": {"reputation": 385, "user_id": 1732910, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/4vbwd.jpg?s=128&g=1", "display_name": "Daniel Kempner", "link": "https://stackoverflow.com/users/1732910/daniel-kempner"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1533832061, "post_id": 51756758, "comment_id": 90502550, "body": "Thanks @Enigmativity, I dropped in the source code."}], "answers": [{"tags": [], "owner": {"reputation": 385, "user_id": 1732910, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/4vbwd.jpg?s=128&g=1", "display_name": "Daniel Kempner", "link": "https://stackoverflow.com/users/1732910/daniel-kempner"}, "is_accepted": false, "score": -1, "last_activity_date": 1533769509, "creation_date": 1533769509, "answer_id": 51756821, "question_id": 51756758, "link": "https://stackoverflow.com/questions/51756758/cant-method-chain-with-async-await/51756821#51756821", "title": "Can&#39;t method chain with async/await", "body": "<p>Confirmed by Marc, the parentheses enclosing method as seen in the second image is the proper approach. Nothing to see here.</p>\n"}, {"tags": [], "owner": {"reputation": 4417, "user_id": 1120092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5677677496ae72bb84f363cb7a3c4dc3?s=128&d=identicon&r=PG", "display_name": "Pete Garafano", "link": "https://stackoverflow.com/users/1120092/pete-garafano"}, "is_accepted": true, "score": 3, "last_activity_date": 1533774072, "creation_date": 1533774072, "answer_id": 51757285, "question_id": 51756758, "link": "https://stackoverflow.com/questions/51756758/cant-method-chain-with-async-await/51757285#51757285", "title": "Can&#39;t method chain with async/await", "body": "<p>There are a few ways of handling this. The most common is probably the parentheses that you show in your code and confirmed by Marc.</p>\n\n<p>An alternative is <a href=\"https://msdn.microsoft.com/en-us/library/dd321405(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>.ContinueWith</code></a> which lets you pass the result of the first operation to the second. Here's a <a href=\"https://msdn.microsoft.com/en-us/library/dd537612(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Microsoft Example</a>. Keep in mind, when you utilize <code>ContinueWith</code>, exceptions will get wrapped in an <code>AggregateException</code>, which can alter your exception handling.</p>\n"}], "owner": {"reputation": 385, "user_id": 1732910, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/4vbwd.jpg?s=128&g=1", "display_name": "Daniel Kempner", "link": "https://stackoverflow.com/users/1732910/daniel-kempner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 51757285, "answer_count": 2, "score": -1, "last_activity_date": 1533831996, "creation_date": 1533769095, "last_edit_date": 1533831996, "question_id": 51756758, "link": "https://stackoverflow.com/questions/51756758/cant-method-chain-with-async-await", "title": "Can&#39;t method chain with async/await", "body": "<p>I have an ASP.NET app running on .NET 4.6.1.</p>\n\n<p>I can't use <code>.Sum()</code> on my awaited <code>GetInts()</code> result. The compiler thinks that <code>GetInts()</code> is a task. <code>SumIntsOneLinerBroker()</code> doesn't compile.</p>\n\n<pre><code>public Task&lt;List&lt;int&gt;&gt; GetInts() {\n    var list = new List&lt;int&gt; { 4, 5 };\n\n    return Task.FromResult(list);\n}\n\npublic async Task&lt;int&gt; SumInts() {\n    var ints = await GetInts();\n    return ints.Sum();\n}\n\npublic async Task&lt;int&gt; SumIntsOneLinerBroker() {\n    return await GetInts().Sum();\n}\n\npublic async Task&lt;int&gt; SumIntsOneLinerWorking() {\n    return (await GetInts()).Sum();\n}\n</code></pre>\n"}, {"tags": ["c#", "api", "asp.net-core", "header", "swagger"], "answers": [{"tags": [], "owner": {"reputation": 21589, "user_id": 4875631, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Goodbye StackExchange", "link": "https://stackoverflow.com/users/4875631/goodbye-stackexchange"}, "is_accepted": true, "score": 4, "last_activity_date": 1533769119, "creation_date": 1533769119, "answer_id": 51756764, "question_id": 51756738, "link": "https://stackoverflow.com/questions/51756738/add-multiple-header-values-in-swagger/51756764#51756764", "title": "Add Multiple Header Values in Swagger", "body": "<p>Just add more parameters, and include the <code>FromHeader</code> attribute on each parameter you want to match:</p>\n\n<pre><code>[HttpGet]\n[Route(\"api/{bookID}\")]\npublic async Task&lt;IActionResult&gt; GetBooksByID(\n    string bookID,\n    [FromHeader(Name = \"Correlation-ID\")] string correlationID,\n    [FromHeader(Name = \"Tenant-ID\")] string tenantID,\n    [FromHeader(Name = \"User-ID\")] string userID)\n{\n   //...\n}\n</code></pre>\n"}], "owner": {"reputation": 1944, "user_id": 9324000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/634508523bd010e56708dd4b776aa127?s=128&d=identicon&r=PG&f=1", "display_name": "superninja", "link": "https://stackoverflow.com/users/9324000/superninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 51756764, "answer_count": 1, "score": 2, "last_activity_date": 1533953579, "creation_date": 1533768901, "last_edit_date": 1533953579, "question_id": 51756738, "link": "https://stackoverflow.com/questions/51756738/add-multiple-header-values-in-swagger", "title": "Add Multiple Header Values in Swagger", "body": "<p>I know how to add one header value in Swagger, here's the code:</p>\n\n<pre><code>[HttpGet]\n[Route(\"api/{bookID}\")]\npublic async Task&lt;IActionResult&gt; GetBooksByID([FromHeader(Name = \"Correlation-ID\")]string bookID)\n{\n   //...\n}\n</code></pre>\n\n<p>But what if I would like to <strong>add additional header values</strong>, such as \"TenantID\", \"UserID\", etc.</p>\n\n<p>How would the syntax look like?</p>\n"}, {"tags": ["c#", "visual-studio", "visual-studio-2015"], "comments": [{"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 0, "creation_date": 1533768798, "post_id": 51756687, "comment_id": 90472877, "body": "Something doesn&#39;t look right here, are you sure this is line that throws? Can you double check please"}, {"owner": {"reputation": 664, "user_id": 8166144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZEFuA.png?s=128&g=1", "display_name": "Azhy", "link": "https://stackoverflow.com/users/8166144/azhy"}, "edited": false, "score": 0, "creation_date": 1533769084, "post_id": 51756687, "comment_id": 90472943, "body": "You initiallized this variable with itself value."}], "answers": [{"tags": [], "owner": {"reputation": 664, "user_id": 8166144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZEFuA.png?s=128&g=1", "display_name": "Azhy", "link": "https://stackoverflow.com/users/8166144/azhy"}, "is_accepted": false, "score": 0, "last_activity_date": 1533769326, "creation_date": 1533769326, "answer_id": 51756794, "question_id": 51756687, "link": "https://stackoverflow.com/questions/51756687/there-is-no-argument-given-that-corresponds-to-the-required-formal-parameter-in/51756794#51756794", "title": "There is no argument given that corresponds to the required formal parameter &#39;info&#39;", "body": "<p>As i said this line of code which you wrote doesnt do anything it just initialleze <code>this.CurveList</code> as its value, i think you should change yours to this:-</p>\n\n<pre><code>public CurveCollection(List&lt;Rhino.Geometry.Curve&gt; curves) \n{\n    this.CurveList = curves;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10200281, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OCmSycJsuKQ/AAAAAAAAAAI/AAAAAAAAAE0/63B4KF3qeSY/photo.jpg?sz=128", "display_name": "Charlie P", "link": "https://stackoverflow.com/users/10200281/charlie-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533769326, "creation_date": 1533768580, "last_edit_date": 1533768711, "question_id": 51756687, "link": "https://stackoverflow.com/questions/51756687/there-is-no-argument-given-that-corresponds-to-the-required-formal-parameter-in", "title": "There is no argument given that corresponds to the required formal parameter &#39;info&#39;", "body": "<p>I have a VS C# project (project1) that compiles and works fine without any errors. </p>\n\n<p>I have created a second project (project2) that adds a number of files as links from the first project. I've added all the necessary references etc. I've created a conditional compilation symbol for project2. Project2 is giving one error:</p>\n\n<blockquote>\n  <p>There is no argument given that corresponds to the required formal\n  parameter 'info' of 'Curve.Curve(SerializationInfo, StreamingContext)'</p>\n</blockquote>\n\n<pre><code>public CurveCollection(List&lt;Rhino.Geometry.Curve&gt; curves) \n{\n      this.CurveList = this.CurveList;\n}\n</code></pre>\n\n<p>I've searched through the forums to try and find why this error is being caused, and I'm at a loss. </p>\n\n<p>Can someone shed some light on what I may be missing?</p>\n"}, {"tags": ["c#", "sockets", "ssl", "encryption", "tls1.2"], "answers": [{"comments": [{"owner": {"reputation": 2425, "user_id": 693943, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bef0b29b7ebaec03aeff8accf444aefe?s=128&d=identicon&r=PG", "display_name": "Matthew Goulart", "link": "https://stackoverflow.com/users/693943/matthew-goulart"}, "edited": false, "score": 0, "creation_date": 1533769046, "post_id": 51756535, "comment_id": 90472934, "body": "I&#39;ll take a look at your blogs on pipelines. I&#39;ve started to look into the RFC spec on TLS 1.2 and, although not trivial, I think it may be useful to implement the protocol using a library like BouncyCastle to do the (very) low level stuff."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 2425, "user_id": 693943, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bef0b29b7ebaec03aeff8accf444aefe?s=128&d=identicon&r=PG", "display_name": "Matthew Goulart", "link": "https://stackoverflow.com/users/693943/matthew-goulart"}, "edited": false, "score": 0, "creation_date": 1533769229, "post_id": 51756535, "comment_id": 90472979, "body": "@MatthewGoulart you might also want to ask Tim Seaward whether &quot;Leto&quot; will be supporting that; &quot;Leto&quot; is &quot;OpenSSL meets pipelines&quot;"}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 2425, "user_id": 693943, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bef0b29b7ebaec03aeff8accf444aefe?s=128&d=identicon&r=PG", "display_name": "Matthew Goulart", "link": "https://stackoverflow.com/users/693943/matthew-goulart"}, "edited": false, "score": 0, "creation_date": 1533769980, "post_id": 51756535, "comment_id": 90473133, "body": "@MatthewGoulart sure, it&#39;ll do; part 3 has lots more practical hands-on code that&#39;ll be more useful for real usage; but the emphasis to consider before jumping in: you still need a TLS piece; options 1) SslStream in the middle (I&#39;m using NetworkStream=&gt;SslStream=&gt;pipelines); 2) &quot;Leto&quot; (Tim&#39;s thing); 3) &quot;Kestrel&quot; has a TLS wrapper; last time I asked David Fowler about this, he hinted that it isn&#39;t quite perfect for the socket mode yet, but : they&#39;re working on it"}, {"owner": {"reputation": 2425, "user_id": 693943, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bef0b29b7ebaec03aeff8accf444aefe?s=128&d=identicon&r=PG", "display_name": "Matthew Goulart", "link": "https://stackoverflow.com/users/693943/matthew-goulart"}, "edited": false, "score": 0, "creation_date": 1533770402, "post_id": 51756535, "comment_id": 90473236, "body": "I appreciate the info. I&#39;ll take a look at all three options. After reading a few paragraphs it seems your blog will be my evening read for the next few nights."}], "tags": [], "owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "is_accepted": false, "score": 1, "last_activity_date": 1533767392, "creation_date": 1533767392, "answer_id": 51756535, "question_id": 51756461, "link": "https://stackoverflow.com/questions/51756461/adding-encryption-to-a-server-built-with-socketasynceventargs/51756535#51756535", "title": "Adding encryption to a server built with SocketAsyncEventArgs", "body": "<p>There is no direct way to attach SAEA to encryption. They don't share an API in common, so everything is bridges.</p>\n\n<p>The easiest way to do this is - as you know - <code>SslStream</code>, but: that isn't usually compatible with <code>SocketAsyncEventArgs</code>. There are alternatives - I can think of at least 3 different ways of doing this with \"pipelines\", for example; but all of them would be a major architecture change from <em>naked</em> SAEA. So if the difference between SAEA and <code>SslStream</code> is too large, the difference between SAEA and <code>IDuplexPipe</code> is even larger. However, \"pipelines\" is <em>designed</em> for high scalable perf, so... maybe it'll suit your tastes anyway? I've blogged about pipelines <em>a lot</em> recently, if it would help; plus I have github examples of client/server code, including a 2.5M+ ops/second redis-like server.</p>\n"}], "owner": {"reputation": 2425, "user_id": 693943, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bef0b29b7ebaec03aeff8accf444aefe?s=128&d=identicon&r=PG", "display_name": "Matthew Goulart", "link": "https://stackoverflow.com/users/693943/matthew-goulart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1533767392, "creation_date": 1533766887, "question_id": 51756461, "link": "https://stackoverflow.com/questions/51756461/adding-encryption-to-a-server-built-with-socketasynceventargs", "title": "Adding encryption to a server built with SocketAsyncEventArgs", "body": "<p>I've looked high and low and am quite surprised to find <em>absolutely nothing</em> that answers this question:</p>\n\n<p><strong>How can one implement SSL/TLS (or similar) encryption when using <code>SocketAsyncEventArgs</code>?</strong> I did read that one <em>could</em> theoretically use a <code>SslStream</code> and \"cheat\" by creating a go-between to coordinate data in and out of the stream, to and from the socket. That all seems ridiculous...</p>\n\n<p>I Looked into BouncyCastle but they don't seem to have support for server-side encryption. Admittedly, the source for this info is almost 10 years old, but my own research turned up nothing.</p>\n\n<p>I'm not interested in changing my server architecture, so please refrain from telling me \"I don't really need the performance of <code>SocketAsyncEVentArgs</code> and should just change to <code>TcpListener</code>\".</p>\n\n<p>I'm interested in any method of implementing reliable encryption between client and server using <code>SocketAsyncEventArgs</code>.</p>\n"}, {"tags": ["c#", "wcf", "session", "windows-services"], "comments": [{"owner": {"reputation": 168, "user_id": 9108621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aadac0bbfa1e85d67bbd9e06884abc28?s=128&d=identicon&r=PG&f=1", "display_name": "Evertude", "link": "https://stackoverflow.com/users/9108621/evertude"}, "edited": false, "score": 1, "creation_date": 1533775568, "post_id": 51756453, "comment_id": 90474251, "body": "WCF supports instantiation PerCall, PerSession (default, one instance per caller) and Singleton. Take a look at <a href=\"https://blogs.msdn.microsoft.com/rickrain/2009/06/15/wcf-instancing-concurrency-and-throttling-part-1/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/rickrain/2009/06/15/&hellip;</a>"}, {"owner": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "reply_to_user": {"reputation": 168, "user_id": 9108621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aadac0bbfa1e85d67bbd9e06884abc28?s=128&d=identicon&r=PG&f=1", "display_name": "Evertude", "link": "https://stackoverflow.com/users/9108621/evertude"}, "edited": false, "score": 0, "creation_date": 1533872629, "post_id": 51756453, "comment_id": 90515179, "body": "....adding to @Evertude, you most likely want <code>PerSession</code>.  You don&#39;t want <code>PerCall</code>"}], "owner": {"reputation": 13571, "user_id": 2769729, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BowZi.png?s=128&g=1", "display_name": "Sarah Weinberger", "link": "https://stackoverflow.com/users/2769729/sarah-weinberger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533766854, "creation_date": 1533766854, "question_id": 51756453, "link": "https://stackoverflow.com/questions/51756453/saving-variables-across-calls-in-wcf-as-a-windows-service", "title": "Saving Variables Across Calls in WCF as a Windows Service", "body": "<p>I created a WCF Service Library, which I host via a Windows Service.</p>\n\n<p>Is it possible to save information across API calls?</p>\n\n<p>I know that if I host the WCF Service Library in IIS with ASP.Net compatibility turned on and making a few modifications to the WCF library that I can use \n<code>HttpContext</code>.</p>\n\n<pre><code>HttpContext.Current.Session[\"name\"] = &lt;value&gt;;\n</code></pre>\n\n<p>WCF started as a Windows Service does not have ASP.Net support to the best of my knowledge, as the library is not hosted by IIS. Is there a way for a WCF library launched via a Windows Service to save information across calls for a specific caller?</p>\n"}, {"tags": ["c#", "excel", "range", "vsto", "office-interop"], "answers": [{"comments": [{"owner": {"reputation": 1768, "user_id": 7369926, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/127985c6b4901ccbaeb6b9d47b465dc9?s=128&d=identicon&r=PG&f=1", "display_name": "ProgSky", "link": "https://stackoverflow.com/users/7369926/progsky"}, "edited": false, "score": 0, "creation_date": 1533822478, "post_id": 51756659, "comment_id": 90496172, "body": "I can use xlCellTypeLastCell to find last cell. How do I get the position of first non empty element ?"}, {"owner": {"reputation": 67, "user_id": 10180321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qSnhxN6_0jA/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppKDI0ZTrrdRI23Vkbl8Hzc7tcSQ/mo/photo.jpg?sz=128", "display_name": "sette", "link": "https://stackoverflow.com/users/10180321/sette"}, "reply_to_user": {"reputation": 1768, "user_id": 7369926, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/127985c6b4901ccbaeb6b9d47b465dc9?s=128&d=identicon&r=PG&f=1", "display_name": "ProgSky", "link": "https://stackoverflow.com/users/7369926/progsky"}, "edited": false, "score": 0, "creation_date": 1533847587, "post_id": 51756659, "comment_id": 90509583, "body": "Have you looked into UsedRange? <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.usedrange.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}], "tags": [], "owner": {"reputation": 67, "user_id": 10180321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qSnhxN6_0jA/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppKDI0ZTrrdRI23Vkbl8Hzc7tcSQ/mo/photo.jpg?sz=128", "display_name": "sette", "link": "https://stackoverflow.com/users/10180321/sette"}, "is_accepted": true, "score": 1, "last_activity_date": 1535637118, "last_edit_date": 1535637118, "creation_date": 1533768302, "answer_id": 51756659, "question_id": 51756435, "link": "https://stackoverflow.com/questions/51756435/c-interop-excel-range-find-first-and-last-populated-value/51756659#51756659", "title": "c# interop excel range find first and last populated value", "body": "<p>You can use the SpecialCells method available with Excel.\n<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-specialcells-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-specialcells-method-excel</a></p>\n\n<p>In your case, you want to find the last cell so: <em>xlCellTypeLastCell\nwith no value i.e Type.Missing</em>.</p>\n\n<pre><code>Excel.Range lastCell = workSheet.Cells.SpecialCells(XlCellType.xlCellTypeLastCell, Type.Missing); \nExcel.Range myRange = workSheet.get_Range(\"B1\", lastCell);\n</code></pre>\n\n<p>lastCell should give the its row and column values.<br/>\nHope this helps.</p>\n"}], "owner": {"reputation": 1768, "user_id": 7369926, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/127985c6b4901ccbaeb6b9d47b465dc9?s=128&d=identicon&r=PG&f=1", "display_name": "ProgSky", "link": "https://stackoverflow.com/users/7369926/progsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 592, "favorite_count": 0, "accepted_answer_id": 51756659, "answer_count": 1, "score": 0, "last_activity_date": 1535637118, "creation_date": 1533766720, "last_edit_date": 1533822707, "question_id": 51756435, "link": "https://stackoverflow.com/questions/51756435/c-interop-excel-range-find-first-and-last-populated-value", "title": "c# interop excel range find first and last populated value", "body": "<p>I have a range (one row) and I want to know column position of first and last populated value in that range. This is how I am trying to calculate the position. </p>\n\n<pre><code>var xlRange = (Excel.Range)currentSheet.Cells[10, 1].EntireRow; // 10th row.\nlong firstColumn= (long)xlRange.get_End(Excel.XlDirection.xlToRight).Column;\n</code></pre>\n\n<p>Sheet looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/xVwYX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xVwYX.png\" alt=\"enter image description here\"></a></p>\n\n<p>firstColumn returns 8. Which is correct. But I dont know how to get column position of last populated cell. </p>\n\n<p>Also </p>\n\n<pre><code>long firstColumn= (long)xlRange.get_End(Excel.XlDirection.xlToRight).Column;\n</code></pre>\n\n<p>return 12 for <code>firstColumn</code> when excel is setup as below: </p>\n\n<p><a href=\"https://i.stack.imgur.com/LKIob.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LKIob.png\" alt=\"enter image description here\"></a></p>\n\n<p>I was expecting to get 1. </p>\n\n<p>Any pointer? </p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1533767848, "post_id": 51756419, "comment_id": 90472678, "body": "Does the code work or not?  Do-Loops are really fast, so your code is just pummeling the TextBox with string updates faster than it can handle.  Don&#39;t do that.  Pings usually work better on a timer with a reasonable interval."}, {"owner": {"reputation": 41, "user_id": 8634204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af72cb7001216b0718fd627eab767e5?s=128&d=identicon&r=PG&f=1", "display_name": "Erwin", "link": "https://stackoverflow.com/users/8634204/erwin"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1533767998, "post_id": 51756419, "comment_id": 90472705, "body": "It does work. I have it to set the thread to sleep at an interval of 30000"}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1533768031, "post_id": 51756419, "comment_id": 90472710, "body": "I don&#39;t see that code."}, {"owner": {"reputation": 41, "user_id": 8634204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af72cb7001216b0718fd627eab767e5?s=128&d=identicon&r=PG&f=1", "display_name": "Erwin", "link": "https://stackoverflow.com/users/8634204/erwin"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1533768951, "post_id": 51756419, "comment_id": 90472912, "body": "I apologize, it was removed at the time of copy because I am trying to get it to work, so I am moving a lot around. In monitor right under status is System.Threading.Thread.Sleep(30000);"}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1533769105, "post_id": 51756419, "comment_id": 90472950, "body": "The question has an edit link underneath it.  Update it appropriately.  It sounds like you have sleep running on the UI thread, hence why the form is locking up."}, {"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 0, "creation_date": 1533769284, "post_id": 51756419, "comment_id": 90472992, "body": "Can you paste your ping code, as it will be easier to get you a complete solution"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1533774656, "post_id": 51756419, "comment_id": 90474089, "body": "Your <code>do { ... } while (true)</code> loop would be killing your CPU and the call to <code>monitor</code> is killing the UI thread."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 10180321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qSnhxN6_0jA/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppKDI0ZTrrdRI23Vkbl8Hzc7tcSQ/mo/photo.jpg?sz=128", "display_name": "sette", "link": "https://stackoverflow.com/users/10180321/sette"}, "edited": false, "score": 0, "creation_date": 1533768397, "post_id": 51756491, "comment_id": 90472783, "body": "Why has this been downgraded? Please respond, so I can improve."}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1533768647, "post_id": 51756491, "comment_id": 90472843, "body": "Not your downvoter, but the question does not claim to have a cross-thread issue.  The code is calling Invoke already in the DoWork method."}, {"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 0, "creation_date": 1533769329, "post_id": 51756491, "comment_id": 90473007, "body": "Yeah threading isnt the problem here, its the implimentation of the constant ping and thread sleeping on the ui (is my gut feel)"}], "tags": [], "owner": {"reputation": 67, "user_id": 10180321, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-qSnhxN6_0jA/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ppKDI0ZTrrdRI23Vkbl8Hzc7tcSQ/mo/photo.jpg?sz=128", "display_name": "sette", "link": "https://stackoverflow.com/users/10180321/sette"}, "is_accepted": false, "score": -1, "last_activity_date": 1533767058, "creation_date": 1533767058, "answer_id": 51756491, "question_id": 51756419, "link": "https://stackoverflow.com/questions/51756419/c-background-worker-append-textbox/51756491#51756491", "title": "C# Background Worker Append TextBox", "body": "<p>Erwin, when dealing with C# - threads and UI elements usually you will come across cross-thread operations i.e. Background thread with UI threads. This interaction needs to be done in thread safe way with the help of Invoke to avoid invalid operations.</p>\n\n<p>Please look into below resource:  InvokeRequired section.\n<a href=\"https://docs.microsoft.com/en-us/dotnet/framework/winforms/controls/how-to-make-thread-safe-calls-to-windows-forms-controls\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/framework/winforms/controls/how-to-make-thread-safe-calls-to-windows-forms-controls</a></p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 9448914, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle Huff", "link": "https://stackoverflow.com/users/9448914/kyle-huff"}, "is_accepted": false, "score": 0, "last_activity_date": 1533769374, "creation_date": 1533769374, "answer_id": 51756800, "question_id": 51756419, "link": "https://stackoverflow.com/questions/51756419/c-background-worker-append-textbox/51756800#51756800", "title": "C# Background Worker Append TextBox", "body": "<p>The background worker is running on a thread pool thread, but your call to Status and Sleep is running on the UI thread.  You need to move that stuff back into bgWorker_DoWork.</p>\n"}, {"tags": [], "owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "is_accepted": false, "score": 1, "last_activity_date": 1534369765, "last_edit_date": 1534369765, "creation_date": 1533772554, "answer_id": 51757139, "question_id": 51756419, "link": "https://stackoverflow.com/questions/51756419/c-background-worker-append-textbox/51757139#51757139", "title": "C# Background Worker Append TextBox", "body": "<p>You've got several mistakes. First,</p>\n\n<pre><code>Invoke((MethodInvoker)delegate\n{\n    monitor();\n});\n</code></pre>\n\n<p>will call <code>monitor()</code> on your UI thread. In almost all cases you should not call methods on other threads. You especially should not call methods that block or do anything that takes more than a few milliseconds on your UI thread, and that is what this does:</p>\n\n<pre><code>System.Threading.Thread.Sleep(30000);\n</code></pre>\n\n<p>Instead of calling a method on another thread; submit immutable data to the other thread and let the thread decide when to handle it. There is an event already built in to BackgroundWorker which does that. Before you call <code>bgWorker.RunWorkerAsync()</code> do this:</p>\n\n<pre><code>url = new Uri(something);\nbgWorker.WorkerReportsProgress = true;\nbgWorker.WorkerSupportsCancellation = true;\nbgWorker.ProgressChanged += Bgw_ProgressChanged;\n\n\nprivate void Bgw_ProgressChanged(object sender, ProgressChangedEventArgs e)\n{\n    textBox2.AppendText(\"Status of: \" + url + \": \" + e.UserState.ToString()\n        + Environment.NewLine);\n}\n</code></pre>\n\n<p>Your <code>bgWorker_DoWork</code> should look more like this:</p>\n\n<pre><code>void bgWorker_DoWork(object sender, DoWorkEventArgs e)\n{\n    while (!bgw.CancellationPending)\n    {\n        System.Threading.Thread.Sleep(new TimeSpan(0, 0, 30));\n        var status = ResultOfPing(e.Argument as Uri);\n        bgw.ReportProgress(0, status);\n    }\n\n    e.Cancel = true;\n}\n</code></pre>\n\n<p>and you should call it like this:</p>\n\n<pre><code>bgWorker.RunWorkerAsync(url);\n</code></pre>\n\n<p>You've got a second problem. BackgroundWorker creates a thread, and your thread is going to spend most of its time blocked on a timer or waiting for network responses. That is a poor use of a thread. You would be better off using completion callbacks or <a href=\"http://msdn.com/async\" rel=\"nofollow noreferrer\">async/await</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1533774940, "creation_date": 1533774940, "answer_id": 51757354, "question_id": 51756419, "link": "https://stackoverflow.com/questions/51756419/c-background-worker-append-textbox/51757354#51757354", "title": "C# Background Worker Append TextBox", "body": "<p>Try this code:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    bool cancel;\n\n    public Form1()\n    {\n        InitializeComponent();\n\n    }\n\n    public void StartPinging()\n    {\n        this.cancel = false;\n        startButton.Enabled = false;\n        stopButton.Enabled = true;\n        responseBox.Clear();\n        responseBox.AppendText(\"Starting to ping server.\");\n        responseBox.AppendText(Environment.NewLine);\n        var bw = new BackgroundWorker\n        {\n            WorkerReportsProgress = false,\n            WorkerSupportsCancellation = true\n        };\n        bw.DoWork += (obj, ev) =&gt;\n        {\n            while (!cancel)\n            {\n                // Ping Server Here\n                string response = Server.PingServer();\n\n                this.Invoke(new UiMethod(() =&gt;\n                {\n                    responseBox.AppendText(response);\n                    responseBox.AppendText(Environment.NewLine);\n                }));\n            }\n        };\n\n        bw.RunWorkerCompleted += (obj, ev) =&gt;\n        {\n            this.Invoke(new UiMethod(() =&gt;\n            {\n                responseBox.AppendText(\"Stopped pinging the server.\");\n                responseBox.AppendText(Environment.NewLine);\n                startButton.Enabled = true;\n                stopButton.Enabled = false;\n            }));\n        };\n\n        bw.RunWorkerAsync();\n    }\n\n    delegate void UiMethod();\n\n\n    private void startButton_Click(object sender, EventArgs e)\n    {\n        StartPinging();\n    }\n\n    private void stopButton_Click(object sender, EventArgs e)\n    {\n        responseBox.AppendText(\"Cancelation Pressed.\");\n        responseBox.AppendText(Environment.NewLine);\n        cancel = true;\n    }\n}\n\npublic class Server\n{\n    static Random rng = new Random();\n    public static string PingServer()\n    {\n        int time = 1200 + rng.Next(2400);\n        Thread.Sleep(time);\n        return $\"{time} ms\";\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TCCVM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TCCVM.png\" alt=\"scr\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "is_accepted": false, "score": 1, "last_activity_date": 1533775055, "creation_date": 1533775055, "answer_id": 51757363, "question_id": 51756419, "link": "https://stackoverflow.com/questions/51756419/c-background-worker-append-textbox/51757363#51757363", "title": "C# Background Worker Append TextBox", "body": "<p>Use Microsoft's Reactive Framework (NuGet \"System.Reactive.Windows.Forms\" and add <code>using System.Reactive.Linq;</code>) and then you can do this:</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    var url = textBox1.Text;\n    Observable\n        .Interval(TimeSpan.FromMinutes(0.5))\n        .SelectMany(_ =&gt; Observable.Start(() =&gt; Status(url)))\n        .ObserveOn(this)\n        .Subscribe(status =&gt; textBox2.AppendText(\"Status of: \" + status + \"\\n\"));\n}\n</code></pre>\n\n<p>You then just need to change <code>Status</code> to have this signature: <code>string Status(string url)</code>.</p>\n\n<p>That's it. No background worker. No invoking. And <code>Status</code> is nicely run on a background thread.</p>\n"}], "owner": {"reputation": 41, "user_id": 8634204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af72cb7001216b0718fd627eab767e5?s=128&d=identicon&r=PG&f=1", "display_name": "Erwin", "link": "https://stackoverflow.com/users/8634204/erwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1534369765, "creation_date": 1533766620, "last_edit_date": 1533790743, "question_id": 51756419, "link": "https://stackoverflow.com/questions/51756419/c-background-worker-append-textbox", "title": "C# Background Worker Append TextBox", "body": "<p>first off I'd like to say I'm brand new to C# so I am not too aware with how the background worker is supposed to be implemented. I have a GUI program that basically pings a domain a returns the response to a textbox. I am able to get it to work normally, however, it freezes the code because it is running on the same thread which is why I am trying to implement a background worker.\nHere is the basic setup</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{\n    url = textBox1.Text;\n    button1.Enabled = false;\n    button2.Enabled = true;\n    bgWorker.DoWork += new DoWorkEventHandler(bgWorker_DoWork);\n    bgWorker.RunWorkerAsync();\n\n}\nprivate void bgWorker_DoWork(object sender, DoWorkEventArgs e)\n{\n    do\n    {\n        if (bgWorker.CancellationPending)\n            break;\n\n        Invoke((MethodInvoker)delegate { monitor(); });\n\n    } while (true);\n}\npublic void monitor()\n{\n    textBox2.AppendText(\"Status of: \" + url + \"\\n\");\n    Status(url);\n    System.Threading.Thread.Sleep(30000);\n}\nprivate void Status(string url)\n{\n    // This method does all the ping work and also appends the status to the Text box as it goes through , as OK or down\n}\n</code></pre>\n\n<p>I have not worked with bgworkers before and as you can imagine it's confusing. I've looked at tons of other articles and I can't seem to get it. Sorry if the code looks crazy, I'm trying to learn.</p>\n"}, {"tags": ["c#", "sql-server", "ado.net"], "comments": [{"owner": {"reputation": 93997, "user_id": 3010968, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/5c9bc5babd6d3ceafcc3f95fbdd5b313?s=128&d=identicon&r=PG&f=1", "display_name": "Selman Gen&#231;", "link": "https://stackoverflow.com/users/3010968/selman-gen%c3%a7"}, "edited": false, "score": 3, "creation_date": 1533766622, "post_id": 51756392, "comment_id": 90472318, "body": "Is there a particular reason why you wanna have a million records in a list?"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 1, "creation_date": 1533766646, "post_id": 51756392, "comment_id": 90472327, "body": "Instead of adding the data to a list (which is extremely fast, the problem is in the reading, not in adding the items), you could stream the results back to the caller using <code>yield return new DataClass ...</code>"}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 1, "creation_date": 1533766668, "post_id": 51756392, "comment_id": 90472338, "body": "If you know how many objects are going to be in the list (say 1.2 million), try creating the list with a capacity: <code>var list = new List&lt;DataClass&gt;(1_200_000);</code>  If you just create the list and add <i>a lot</i> of things to it, it has to grow over and over again."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "edited": false, "score": 3, "creation_date": 1533766894, "post_id": 51756392, "comment_id": 90472403, "body": "If you know you&#39;re going to have a very large list, creating it at roughly the right size (or over) will stop a lot of re-allocations / block-copies. But... 1M should work fine... I regularly work with 10M row buffers, no problem. But, to avoid GC from hurting me, I work with <code>readonly struct</code> when I do that..."}, {"owner": {"reputation": 921791, "user_id": 23354, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CrVFH.png?s=128&g=1", "display_name": "Marc Gravell", "link": "https://stackoverflow.com/users/23354/marc-gravell"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 2, "creation_date": 1533766922, "post_id": 51756392, "comment_id": 90472415, "body": "@jdweng <code>SqlBulkCopy</code> is for putting data into the database, not getting it out"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 2, "creation_date": 1533766958, "post_id": 51756392, "comment_id": 90472423, "body": "BTW, if you only use list to populate excel - you don&#39;t need it. you can go from reader directly to excel. You can use Excel as regular data table if you use microsoft.ace.ole db driver"}, {"owner": {"reputation": 141, "user_id": 6684342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ukrF.jpg?s=128&g=1", "display_name": "Gedward Romo", "link": "https://stackoverflow.com/users/6684342/gedward-romo"}, "reply_to_user": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1533770549, "post_id": 51756392, "comment_id": 90473273, "body": "- I insert in List for use it in a excel file for user (reports of two months).   - my CPU is in 100% now while insert to List and don&#39;t stop , the database is a server (not my host)    Folks, I use the list because I will use it after for download report in excel (this list is the data for excel)  @Flydog57 try it, still the same"}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1533770964, "post_id": 51756392, "comment_id": 90473374, "body": "Is the insertion into a <code>List&lt;T&gt;</code> taking forever, or the work to get it into Excel.  How are you creating you Excel file?  For example, if you are using OpenXML (creating it cell by cell with the object model rather than the XML-ish API), it doesn&#39;t scale that well."}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1533771189, "post_id": 51756392, "comment_id": 90473419, "body": "One other thing to consider is that accessing the contents of a DataReader using the column name (as you do) requires a string lookup for every field and every row. It&#39;s &quot;quick and dirty&quot; if you have a handful of rows. For a million, get the (integer) ordinal values for each column and use those integers rather than the strings."}, {"owner": {"reputation": 4609, "user_id": 1111169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43c129d75cbb379dea164181b46deff?s=128&d=identicon&r=PG", "display_name": "KumarHarsh", "link": "https://stackoverflow.com/users/1111169/kumarharsh"}, "edited": false, "score": 0, "creation_date": 1533809151, "post_id": 51756392, "comment_id": 90487038, "body": "You are saying SP is not a problem. Fetching millions record means your machine configuration has to be strong.Though SqlDatareader is good choice once you can try DataTable.Even if somehow you succeed ,exporting millions to excel is again tough,you hv to use CSV file then.I think you should SSIS package."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533911008, "post_id": 51756392, "comment_id": 90534412, "body": "<i>&quot;I insert in List for use it in a excel file for user&quot;</i> - so you do take data from SqlServer and fill Excel. <b>You don&#39;t need List to do this.</b> Go from sql server directly to excel via <code>microsof.ace.oledb.xx</code> provider. And there are plenty of examples on SO, CodeProject etc. This is like taking data from 1 db to another."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 6684342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ukrF.jpg?s=128&g=1", "display_name": "Gedward Romo", "link": "https://stackoverflow.com/users/6684342/gedward-romo"}, "edited": false, "score": 0, "creation_date": 1533772513, "post_id": 51756855, "comment_id": 90473688, "body": "Thank you for your answer. I change the data type like ( myfield = (string)sqlDataReader[&quot;data&quot;] ) but still is the same.  My problem is in that code, specifically in while loop ( while (sqlDataReader.Read()) ), never finish. But... with records less than 500 thousend works fine.   I don&#39;t use excel like database, I use a store procedure for obtain data, after I save the data in list and finally use ExcelWorksheet class  for use the data into excel file"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 141, "user_id": 6684342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ukrF.jpg?s=128&g=1", "display_name": "Gedward Romo", "link": "https://stackoverflow.com/users/6684342/gedward-romo"}, "edited": false, "score": 0, "creation_date": 1533808766, "post_id": 51756855, "comment_id": 90486781, "body": "@GedwardRomo, if your problem is really in that code then there is something wrong in your server. As I said, I filled 5 million rows list in 12 seconds. You didn&#39;t give the definition of DataClass either."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533911214, "post_id": 51756855, "comment_id": 90534531, "body": "<b>Bad Approach</b>"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533911540, "post_id": 51756855, "comment_id": 90534726, "body": "@T.S. what is bad approach?"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533912263, "post_id": 51756855, "comment_id": 90535179, "body": "Use of <code>Microsoft.Office.Interop.Excel.Application</code> in this project is bad approach"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533912402, "post_id": 51756855, "comment_id": 90535257, "body": "@T.S. Would you please explain why is that? It is probably the fastest way to do it."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533912917, "post_id": 51756855, "comment_id": 90535597, "body": "Expensive, heavy, version-dependent, non scalable and not advised by MS themselves. What needs to be done - use excel as db table and fill it using simple <code>while reader.read()</code> loop. In this case, code is light, little resources are used, it is scalable because it is can be deployed not only on desktop but also on web server or any server. No excel install needed. <a href=\"https://stackoverflow.com/questions/10702788/do-we-need-to-install-microsoft-office-in-server-for-excel-import-in-asp-net\" title=\"do we need to install microsoft office in server for excel import in asp net\">stackoverflow.com/questions/10702788/&hellip;</a>"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533913084, "post_id": 51756855, "comment_id": 90535685, "body": "@T.S. :) Why wouldn&#39;t show us some sample working code to do that. You are just making assumptions. You could also use Epplus without installing excel but that doesn&#39;t mean it is better. FWIW reader.Read() approach has never been a better approach."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533916086, "post_id": 51756855, "comment_id": 90537416, "body": "I am not going to reinvent the wheel here. It is invented and widely used. I am not answering the question to write code again. Examples are aplenty. With your approach you can only do one excel at the time, can&#39;t do server, requires installation of software. There is enough evidence and experience to say, this is bad approach for this specific OP need. I rest my case"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533916989, "post_id": 51756855, "comment_id": 90537872, "body": "@T.S., maybe at least a reference link to the invented wheel?"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533917433, "post_id": 51756855, "comment_id": 90538088, "body": "Check this <a href=\"https://www.codeproject.com/Tips/705470/Read-and-Write-Excel-Documents-Using-OLEDB\" rel=\"nofollow noreferrer\">codeproject.com/Tips/705470/&hellip;</a>"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533917772, "post_id": 51756855, "comment_id": 90538236, "body": "@T.S. Bad approach :)"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533919829, "post_id": 51756855, "comment_id": 90539227, "body": "elaborate, why?"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533935884, "post_id": 51756855, "comment_id": 90545939, "body": "@T.S. check the link you gave carefully."}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533941778, "post_id": 51756855, "comment_id": 90547400, "body": "@T.S. I wasted some time for you, thinking you might still haven&#39;t been able to see what is bad in that approach. I will now &#39;EDIT&#39; my reply to elaborate why it was bad."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533950000, "post_id": 51756855, "comment_id": 90548676, "body": "I am glad that you proved that <b>epplus</b> is faster than <code>ace.oledb</code>. This however doesn&#39;t change the point that using <code>Microsoft.Office.Interop.Excel.Application</code> for this problem is bad approach. The speed is only one thing to consider. You totally disregarding lack of scalability and other aforementioned factors. Besides, such processes happen in off hours and if server runs these, using <code>interop</code> is no go. Everything has its place and time. Golden hammer is an antipattern."}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1533976046, "post_id": 51756855, "comment_id": 90552670, "body": "@T.S. interop is a GOOD approach. The speed is only one thing to consider, right. But it still has plusses, you can do the most with Excel IF you are using interop. I am not disregarding scalability or other factors, I simply don&#39;t understand what you are talking about. For example, scalability and Excel. Please explain that and other non-existent factors. How come Excel is scalable if you use ACE.OLEDB or Epplus? Give me a solid sample if possible this time.  To me it looks like you just don&#39;t want to stand corrected."}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1534029070, "post_id": 51756855, "comment_id": 90564792, "body": "<i>&quot;..it looks like you just don&#39;t want to stand corrected&quot;</i> -quite contrary. I liked to hear EpPlus library can be very fast, &amp; I&#39;ll keep it in mind. Your answer for THIS problem, should be wrapped around EpPlus, not interop. Interop has some real disadvantages and you should read carefully because I listed them. If I was to develop a DLL that just moves data using Excel workbooks, I wouln&#39;t consider interop - it is not useful in web applications or multi-process services. Are you going to start Excel App on web server? Are you satisfied that you can do only one data process at the time?"}, {"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "reply_to_user": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1534074745, "post_id": 51756855, "comment_id": 90572105, "body": "@T.S. what have you listed :) You are again making assumptions around your &#39;beliefs&#39; and &#39;preferences&#39; rather than solid facts. Instead of asking questions, show the answers in code. How come you came to web server from OP&#39;s question? How come you reasoned you could do one data process at a time? Why aren&#39;t you questioning SQL server if you are so eager about scalability? This discussion has no end. I agree to disagree. Interop is a GOOD approach for OP question. Period."}], "tags": [], "owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "is_accepted": false, "score": 0, "last_activity_date": 1533943395, "last_edit_date": 1533943395, "creation_date": 1533769902, "answer_id": 51756855, "question_id": 51756392, "link": "https://stackoverflow.com/questions/51756392/insert-one-million-of-objects-with-add-to-list-is-slowly/51756855#51756855", "title": "Insert one million of objects with &quot;Add&quot; to List is slowly", "body": "<p>(This wouldn't fit as a comment and sort of an answer after all)</p>\n\n<p>I just tried your code (slightly correcting the typos and instead of an SP using an SQL statement) with 5,000,000 records and loaded the list in 12 seconds. Instead of all those ToString() I casted the types (ie: MyField = (int)sqlDataReader[\"MyField\"]). Had 4 fields (Guid, string, int and decimal) and timed on a Phenom II X6 1090T with 16Gb RAM, database on 7200 RPM 500Gb disk and the server was SQL Express 2012. IOW, I don't think that your bottleneck is reading the data nor populating the list.</p>\n\n<p>You are saying \"go through and download that list in an excel\". First populating a list to load to excel is not only unnecessary but very slow operation by nature. I think the code you didn't include had excel COM calls in it and it is slow. Doing 1 million of them you are guaranteed to wait and wait if it ever finishes.</p>\n\n<p>There are multiple much faster ways to get the data to excel and probably the fastest is to use Excel's QueryTables.Add method. ie:</p>\n\n<pre><code>void Main()\n{\n    Microsoft.Office.Interop.Excel.Application xl = new Microsoft.Office.Interop.Excel.Application();\n    var workbook = xl.Workbooks.Add();\n    xl.Visible = true;\n\n    Worksheet sht = ((Worksheet)workbook.ActiveSheet);\n    Range target = (Range)sht.Range[\"A1\"];\n\n    string strCon = @\"ODBC;Driver={SQL Server Native Client 11.0};Server=.\\SQLExpress;Database=Test;Trusted_Connection=yes\";\n    string strSQL = \"select * from MyTable\";\n    var qt = sht.QueryTables.Add(strCon, target, strSQL);\n    qt.Refresh();\n}\n</code></pre>\n\n<p>A code like this ran in 2 seconds on my system, and in Excel it started getting external data, which completed in 20 seconds for 1 million rows.</p>\n\n<p>(And always keep in mind excel is not a database)</p>\n\n<p>EDIT: As T.S. claimed this to be a bad approach and suggested using ACE.OLEDB insertion instead I got my time testing some approaches (although I knew from my experience already, I was ready to stand corrected). </p>\n\n<p>This part discusses about 3 ways to get the data to Excel from SQL server. I used the same data from SQL server for these tests, each time selecting <strong>same 1 million rows</strong>:</p>\n\n<ol>\n<li><p>QueryTables.Add approach was the fastest. Elapsed - <strong>00:00:29.7767063</strong> </p></li>\n<li><p>Insert data using Epplus from NuGet. This one doesn't need Excel to be installed if that is your concern. In this one, unlike the other two approaches I used Linq to get the data as a collection. Slower than 1st approach but not bad at all. Elapsed - <strong>00:00:37.7340975</strong> </p></li>\n<li><p>This one is the <strong>worst</strong> approach of these three. Used ACE.OleDb to insert the data using the code that T.S provided the link. As expected it was awfully slow. Its timing was unacceptable but anyway I timed. Elapsed - <strong>00:11:52.7427790</strong></p></li>\n</ol>\n\n<p>Go figure.</p>\n"}], "owner": {"reputation": 141, "user_id": 6684342, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ukrF.jpg?s=128&g=1", "display_name": "Gedward Romo", "link": "https://stackoverflow.com/users/6684342/gedward-romo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533943395, "creation_date": 1533766485, "last_edit_date": 1533808647, "question_id": 51756392, "link": "https://stackoverflow.com/questions/51756392/insert-one-million-of-objects-with-add-to-list-is-slowly", "title": "Insert one million of objects with &quot;Add&quot; to List is slowly", "body": "<p>I do not have problems when the records are at most 200 thousand, but when the records exceed one million, it takes a long time to enter the data to the list called \"list\". (I waited 30 minutes and still did not finish inserting the list)\nWhat is this doing wrong?\nWill there be any way to return a list or arrangement with more than 1 million records?</p>\n\n<p>Note: return to list and then go through and download that list in an excel (I did not attach the code because it stays stuck in the point I explained)</p>\n\n<pre><code>var list = new List&lt;DataClass&gt;();       \nusing (SqlCommand sqlCommand = new SqlCommand(\"PROCEDURE_HERE\", sqlConnection))\n{\n    sqlCommand.CommandType = CommandType.StoredProcedure;\n    sqlCommand.Parameters.Add(new SqlParameter(\"@Field_1\", dataInput_field1);\n    sqlCommand.CommandTimeout = 0;\n\n    using (SqlDataReader sqlDataReader = sqlCommand.ExecuteReader())\n    {\n\n        while (sqlDataReader.Read())\n        {\n            list.Add( new DataClass {\n                   response_1 = sqlDataReader[\"Nombre\"].ToString(),\n                   response_2 = sqlDataReader[\"correlativo_sgrc\"].ToString(),\n                   response_3 = sqlDataReader[\"rut\"].ToString(),\n                   response_4 = sqlDataReader[\"Celular\"].ToString(),\n                   response_5 = sqlDataReader[\"fecha_envio\"].ToString(),\n                   response_6 = sqlDataReader[\"hora_envio\"].ToString(),\n                   response_7 = sqlDataReader[\"mensaje\"].ToString()\n               });\n        } \n    }\n};\n</code></pre>\n\n<p>EDIT: I explain the flow:</p>\n\n<ol>\n<li>Search the data with a store procedure (sp) in database</li>\n<li>Obtain the data of sp and save into the list (is the code that I paste here)</li>\n<li>Return the list and use it for create a excel file with the class\nExcelWorksheet (for download a report)</li>\n</ol>\n"}, {"tags": ["c#", "azure-api-apps"], "comments": [{"owner": {"reputation": 123, "user_id": 9614380, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UBHBIoCKrMQ/AAAAAAAAAAI/AAAAAAAAKg0/O3Uea6Iw6RE/photo.jpg?sz=128", "display_name": "George T Kurian", "link": "https://stackoverflow.com/users/9614380/george-t-kurian"}, "edited": false, "score": 0, "creation_date": 1538558667, "post_id": 51756368, "comment_id": 92183721, "body": "When I tried to execute EmguCV on IIS, this error came - <code>Unable to load DLL &#39;cvextern&#39;: The specified module could not be found. (Exception from HRESULT: 0x8007007E)</code>. I solved it by <a href=\"https://stackoverflow.com/a/52623386/9614380\">this</a>. This may help you :)"}, {"owner": {"reputation": 1, "user_id": 2360403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55880a84f0d2273c563109c0a1e055a5?s=128&d=identicon&r=PG", "display_name": "fedemart", "link": "https://stackoverflow.com/users/2360403/fedemart"}, "reply_to_user": {"reputation": 123, "user_id": 9614380, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UBHBIoCKrMQ/AAAAAAAAAAI/AAAAAAAAKg0/O3Uea6Iw6RE/photo.jpg?sz=128", "display_name": "George T Kurian", "link": "https://stackoverflow.com/users/9614380/george-t-kurian"}, "edited": false, "score": 0, "creation_date": 1538658949, "post_id": 51756368, "comment_id": 92227174, "body": "Hi @GeorgeTKurian, I ended up setting the current working directory to the bin folder when running locally and when deploying to azure using an xdt file to add the bin folder path to the system PATH variable"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2360403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55880a84f0d2273c563109c0a1e055a5?s=128&d=identicon&r=PG", "display_name": "fedemart", "link": "https://stackoverflow.com/users/2360403/fedemart"}, "is_accepted": false, "score": 0, "last_activity_date": 1538660757, "creation_date": 1538660757, "answer_id": 52648370, "question_id": 51756368, "link": "https://stackoverflow.com/questions/51756368/could-not-load-file-or-assembly-when-running-azure-api-app/52648370#52648370", "title": "Could not load file or assembly when running azure API app", "body": "<p>To make it work while debugging the Azure api locally I had to set the current working directory to the bin folder, where the managed dll and opencv dependencies reside. </p>\n\n<p>To do so I added this line to the Application_Start method in the Global.asax.cs</p>\n\n<pre><code>Environment.CurrentDirectory = HttpRuntime.BinDirectory;\n</code></pre>\n\n<p>But this solution does not work when deploying it to Azure, so I had to place an <code>xdt</code> file inside the <code>D:\\home\\site</code> folder to add the bin path to the system PATH variable.</p>\n\n<p>Here's how the <code>applicationHost.xdt</code> file looks like.</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt; \n&lt;configuration xmlns:xdt=\"http://schemas.microsoft.com/XML-Document-Transform\"&gt; \n  &lt;system.webServer&gt; \n    &lt;runtime xdt:Transform=\"InsertIfMissing\"&gt;\n      &lt;environmentVariables xdt:Transform=\"InsertIfMissing\"&gt;\n        &lt;add name=\"PATH\" value=\"%PATH%;%HOME%\\site\\wwwroot\\bin\" xdt:Locator=\"Match(name)\" xdt:Transform=\"InsertIfMissing\" /&gt;    \n      &lt;/environmentVariables&gt;\n    &lt;/runtime&gt; \n  &lt;/system.webServer&gt; \n&lt;/configuration&gt; \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2360403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55880a84f0d2273c563109c0a1e055a5?s=128&d=identicon&r=PG", "display_name": "fedemart", "link": "https://stackoverflow.com/users/2360403/fedemart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538660757, "creation_date": 1533766330, "question_id": 51756368, "link": "https://stackoverflow.com/questions/51756368/could-not-load-file-or-assembly-when-running-azure-api-app", "title": "Could not load file or assembly when running azure API app", "body": "<p>I'm calling a managed x64 dll from within an azure API app. I referenced it by browsing to it. It has a dependency on an opencv dll and some files on a data folder, all at root level with a Build Action as Content and Copy To Output Directory as Copy Always. I'm using the 64 bit version of IIS Express.</p>\n\n<p>I created a test project and referenced the Azure API app to test the functionality from a test method and it works fine, both the test project and Azure API app target x64 platform. </p>\n\n<p>The problem comes when I try to run the azure API app by itself, it fails with \"Could not load file or assembly 'some.dll' or one of its dependencies. The specified module could not be found.\"</p>\n\n<p>Appreciate any ideas on how to figure out what the problem could be.</p>\n"}, {"tags": ["c#", "ldap", "forms-authentication", "windows-server-2016", "iis-10"], "owner": {"reputation": 11, "user_id": 10199993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fb34a0d30383dab579f4d8efea4b036?s=128&d=identicon&r=PG&f=1", "display_name": "Skeenlander", "link": "https://stackoverflow.com/users/10199993/skeenlander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1536699339, "creation_date": 1533766091, "last_edit_date": 1536699339, "question_id": 51756323, "link": "https://stackoverflow.com/questions/51756323/mvc-forms-authentication-breaks-no-longer-functional-after-move-to-server-2016", "title": "MVC Forms authentication breaks no longer functional after move to Server 2016", "body": "<p>I am working on an application transfer between Windows Server 2008R2 running IIS 7.5 into a Windows 2016 Server running IIS 10. The login system for the application is using Form Authentication with LDAP to allow the user to log in and make changes. The user can login without any issue on the 2008R2 server, creating the necessary cookie for usage. However, on the 2016 Server, the login system authentication seems to break. It seems as though the cookie is created but that the system does not seem to be able to find the user after the cookie is created. Furthermore, on a specific page that does not run any of the login processes, the application appears to be using Windows Authentication rather than the Forms Authentication that it is explicitly being told to use. The settings for the application in the web.config specifically tell it to use forms rather than windows authentication.</p>\n\n<p>The web.config for the application contains the following information for the connection strings:</p>\n\n<pre><code>&lt;connectionStrings&gt;\n&lt;add name=\"ADConnectionString\" connectionString=\"LDAP://OURLDAPSYSTEM\"/&gt;\n&lt;/connectionStrings&gt;\n</code></pre>\n\n<p>The LDAP item for this system is only used for validation not permissions.</p>\n\n<p>and the authentication and membership:</p>\n\n<pre><code>&lt;system.web&gt;\n  &lt;authentication mode=\"Forms\"&gt;\n    &lt;forms name=\".ADAuthCookie\" loginUrl=\"~/\" timeout=\"60\" slidingExpiration=\"true\" protection=\"All\"/&gt;\n  &lt;/authentication&gt;\n  &lt;membership defaultProvider=\"ADMembershipProvider\"&gt;\n    &lt;providers&gt;\n      &lt;add name=\"ADMembershipProvider\" type=\"System.Web.Security.ActiveDirectoryMembershipProvider\" connectionStringName=\"ADConnectionString\" attributeMapUsername=\"sAMAccountName\"/&gt;\n    &lt;/providers&gt;\n  &lt;/membership&gt;\n&lt;/system.web&gt;\n</code></pre>\n\n<p>In the controller that performs the login process:</p>\n\n<pre><code>userLoginSuccess = Membership.ValidateUser(model.UserName, model.Password);\n//Make call to another DB to check permissions for usage\nFormsAuthentication.SetAuthCookie(model.UserName, true);\n</code></pre>\n\n<p>On the IIS on the server, the authentication for the application appears as follows:\n<a href=\"https://i.stack.imgur.com/ZepGP.png\" rel=\"nofollow noreferrer\">Authentication for the application</a></p>\n\n<p>While the authentication for the entire Web Site appears as follows: <a href=\"https://i.stack.imgur.com/lz3XA.png\" rel=\"nofollow noreferrer\">Authentication for the Site</a></p>\n\n<p>Each of these match what is already located on the Windows 2008R2 server.</p>\n\n<p>Anyone have any ideas what would have changed on the Windows 2016 server that would prevent the authentication from working the same as 2008R2? And if so, how would I fix this issue?</p>\n"}, {"tags": ["c#", ".net", "json.net"], "comments": [{"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 1, "creation_date": 1533766386, "post_id": 51756319, "comment_id": 90472245, "body": "What do you mean by &quot;it&#39;s not picking up my entire JSON object&quot;?"}, {"owner": {"reputation": 5331, "user_id": 4256749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lpRO.png?s=128&g=1", "display_name": "Kzrystof", "link": "https://stackoverflow.com/users/4256749/kzrystof"}, "edited": false, "score": 0, "creation_date": 1533769214, "post_id": 51756319, "comment_id": 90472975, "body": "BTW, do not dispose HttpClient."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1533770177, "post_id": 51756319, "comment_id": 90473174, "body": "Parsing is not the same as deserializing"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10184369, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Ff1SK85hA4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7owWBz-O87sr6a9SRgkZlLlBP76lw/mo/photo.jpg?sz=128", "display_name": "Junior", "link": "https://stackoverflow.com/users/10184369/junior"}, "edited": false, "score": 0, "creation_date": 1533786866, "post_id": 51756900, "comment_id": 90476381, "body": "I&#39;ve edited my original comment and added the changes I&#39;ve made to my code and where I&#39;m stuck now"}, {"owner": {"reputation": 5331, "user_id": 4256749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lpRO.png?s=128&g=1", "display_name": "Kzrystof", "link": "https://stackoverflow.com/users/4256749/kzrystof"}, "reply_to_user": {"reputation": 13, "user_id": 10184369, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Ff1SK85hA4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7owWBz-O87sr6a9SRgkZlLlBP76lw/mo/photo.jpg?sz=128", "display_name": "Junior", "link": "https://stackoverflow.com/users/10184369/junior"}, "edited": false, "score": 0, "creation_date": 1533809293, "post_id": 51756900, "comment_id": 90487160, "body": "@Junior I have edited my answer to include the deserialization of a Customer out of a JArray. If it does answer your question, please mark it as an answer so that it can help someone else."}, {"owner": {"reputation": 13, "user_id": 10184369, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Ff1SK85hA4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7owWBz-O87sr6a9SRgkZlLlBP76lw/mo/photo.jpg?sz=128", "display_name": "Junior", "link": "https://stackoverflow.com/users/10184369/junior"}, "edited": false, "score": 0, "creation_date": 1533848042, "post_id": 51756900, "comment_id": 90509749, "body": "Thanks this works, but it only builds a single customer. I want to deseriliaze the entire response using:    JArray a = (JArray)result[&quot;Items&quot;][&quot;$values&quot;]   This will return many Customer records. I want to store this in a c# collection. I thought the JArray function does that, but it does not."}, {"owner": {"reputation": 13, "user_id": 10184369, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Ff1SK85hA4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7owWBz-O87sr6a9SRgkZlLlBP76lw/mo/photo.jpg?sz=128", "display_name": "Junior", "link": "https://stackoverflow.com/users/10184369/junior"}, "edited": false, "score": 0, "creation_date": 1533913863, "post_id": 51756900, "comment_id": 90536155, "body": "thank you so much. This was exactly what I was looking for. Syntax for the foreach loop is perfect! Thanks again"}], "tags": [], "owner": {"reputation": 5331, "user_id": 4256749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lpRO.png?s=128&g=1", "display_name": "Kzrystof", "link": "https://stackoverflow.com/users/4256749/kzrystof"}, "is_accepted": true, "score": 0, "last_activity_date": 1533895764, "last_edit_date": 1533895764, "creation_date": 1533770221, "answer_id": 51756900, "question_id": 51756319, "link": "https://stackoverflow.com/questions/51756319/need-help-deserializing-json-object-returned-from-api/51756900#51756900", "title": "Need help deserializing JSON Object returned from API", "body": "<p>There is a mistake in the code you provided. You are trying to cast the <code>Properties</code> into a <code>JArray</code> when it is an object. </p>\n\n<p>If you do want the array in the <code>Properties</code> object, do this:</p>\n\n<pre><code>JArray arr = (JArray)result[\"Items\"][\"$values\"][0][\"Properties\"][\"$values\"];\n</code></pre>\n\n<p>Otherwise, if you are looking for the <code>Properties</code> object, then you should do this instead:</p>\n\n<pre><code>JObject obj = (JObject)result[\"Items\"][\"$values\"][0][\"Properties\"];\n</code></pre>\n\n<p>Finally, to rebuild the list of <code>Customer</code> instances, you could use the following logic with the static methods:</p>\n\n<pre><code>var customersJson = (JArray)result[\"Items\"][\"$values\"];\n\nvar customers = new List&lt;Customer&gt;();\n\nforeach (JObject o in customersJson)\n{\n     var customerJson = (JArray) o[\"Properties\"][\"$values\"];\n     customers.Add(BuildCustomer(customerJson));\n}\n</code></pre>\n\n<p>[...]</p>\n\n<pre><code>private static Customer BuildCustomer(JArray a)\n{\n    return new Customer\n    {\n        ResultRow = GetValue(a, \"ResultRow\"),\n        WorkPhone = GetValue(a, \"Work Phone\"),\n        Email = GetValue(a, \"Email\"),\n        FullName = GetValue(a, \"Full Name\"),\n        iMISId = GetValue(a, \"iMISId\"),\n        PreferredPhone = GetValue(a, \"Preferred Phone\"),\n        Organization = GetValue(a, \"Organization\")\n     };\n}\n\nprivate static string GetValue(JArray array, string name)\n{\n    JToken obj = array.FirstOrDefault(x =&gt; (string) x[\"Name\"] == name);\n\n    if (obj == null)\n        return string.Empty;\n\n    return (string) obj[\"Value\"];\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10184369, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Ff1SK85hA4/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7owWBz-O87sr6a9SRgkZlLlBP76lw/mo/photo.jpg?sz=128", "display_name": "Junior", "link": "https://stackoverflow.com/users/10184369/junior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 51756900, "answer_count": 1, "score": 0, "last_activity_date": 1533895764, "creation_date": 1533766049, "last_edit_date": 1533779482, "question_id": 51756319, "link": "https://stackoverflow.com/questions/51756319/need-help-deserializing-json-object-returned-from-api", "title": "Need help deserializing JSON Object returned from API", "body": "<p>I have the following JSON Output: </p>\n\n<pre><code>{{\n  \"$type\": \"Asi.Soa.Core.DataContracts.PagedResult`1[[Asi.Soa.Core.DataContracts.GenericEntityData, Asi.Contracts]], Asi.Contracts\",\n  \"Items\": {\n    \"$type\": \"System.Collections.Generic.List`1[[Asi.Soa.Core.DataContracts.GenericEntityData, Asi.Contracts]], mscorlib\",\n    \"$values\": [\n      {\n        \"$type\": \"Asi.Soa.Core.DataContracts.GenericEntityData, Asi.Contracts\",\n        \"EntityTypeName\": \"14\",\n        \"Properties\": {\n          \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyDataCollection, Asi.Contracts\",\n          \"$values\": [\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"ResultRow\",\n              \"Value\": \"1\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Work Phone\",\n              \"Value\": \"(782) 438-7600\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Email\",\n              \"Value\": \"agsaz@rmax.net\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Full Name\",\n              \"Value\": \"Agazny\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"iMISId\",\n              \"Value\": \"eg1\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Preferred Phone\",\n              \"Value\": \"780\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Organization\",\n              \"Value\": \"Re\"\n            }\n          ]\n        }\n      },\n      {\n        \"$type\": \"Asi.Soa.Core.DataContracts.GenericEntityData, Asi.Contracts\",\n        \"EntityTypeName\": \"14\",\n        \"Properties\": {\n          \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyDataCollection, Asi.Contracts\",\n          \"$values\": [\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"ResultRow\",\n              \"Value\": \"2\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Work Phone\",\n              \"Value\": \"7802\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Email\",\n              \"Value\": \"aksm\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Full Name\",\n              \"Value\": \"Aji\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"iMISId\",\n              \"Value\": \"esa\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Preferred Phone\",\n              \"Value\": \"780\"\n            },\n            {\n              \"$type\": \"Asi.Soa.Core.DataContracts.GenericPropertyData, Asi.Contracts\",\n              \"Name\": \"Organization\",\n              \"Value\": \"Hom\"\n            }\n          ]\n        }\n      }\n</code></pre>\n\n<p>I am trying to deserialize this response into workable c# objects and POST it to a different API that accepts a totally different format of JSON. </p>\n\n<p>This is my code so far:</p>\n\n<pre><code> using (var client = new HttpClient())\n {\n      // Format headers\n      client.DefaultRequestHeaders.Accept.Clear();\n\n      client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue(\"application/json\"));\n\n      // Request token, and append to headers\n      await AddTokenToHeaders(client);\n\n      // Query HTTP Service                \n      var response = await client.GetAsync(baseUrl + \"api/IQA?querydocumentversionkey=f2005a6e-7f47-47c3-a7e7-bbd2a7b6ab38\");\n\n      if (response.IsSuccessStatusCode)\n      {\n           var customer = await response.Content.ReadAsStringAsync();\n           JObject result = JObject.Parse(await response.Content.ReadAsStringAsync());\n\n           JArray a = (JArray)result[\"Items\"][\"$values\"][0][\"Properties\"];\n           var test =  a.AsJEnumerable();\n</code></pre>\n\n<p>However, it's not picking up my entire JSON object and I am not able to map it to the properties of my class:</p>\n\n<p>--Update. </p>\n\n<p>I have updated my code and I was able to get the Jarray in the format I wanted, however when I try enumerate by jObject into my List of Class Customer, the properties I try to cast returns nulls. </p>\n\n<p>Thanks for the response. I was able to get the output I was looking for by using the following code. However, attempting to put the output in my List of Customer class with the properties specified however, I am getting nulls on the properties of class Customer. </p>\n\n<pre><code>JObject result = JObject.Parse(await response.Content.ReadAsStringAsync());\n                JArray a = (JArray)result[\"Items\"][\"$values\"];\n                List&lt;Customer&gt; items = ((JArray)a).Select(x =&gt; new Customer\n                {\n                    ResultRow = (string)x[\"ResultRow\"],\n                    WorkPhone = (string)x[\"Work Phone\"],\n                    Email = (string)x[\"Email\"],\n                    FullName = (string)x[\"Full Name\"],\n                    iMISId = (string)x[\"iMISId\"],\n                    PreferredPhone = (string)x[\"Preferred Phone\"],\n                    Organization = (string)x[\"Organization\"]\n                }).ToList();\n\n\n public class Customer\n    {\n        [JsonProperty(\"ResultRow\")]\n        public string ResultRow { get; set; }\n\n        [JsonProperty(\"Work Phone\")]\n        public string WorkPhone { get; set; }\n\n        [JsonProperty(\"Email\")]\n        public string Email { get; set; }\n\n        [JsonProperty(\"Full Name\")]\n        public string FullName { get; set; }\n\n        [JsonProperty(\"iMISId\")]\n        public string iMISId { get; set; }\n\n        [JsonProperty(\"Preferred Phone\")]\n        public string PreferredPhone { get; set; }\n\n        [JsonProperty(\"Organization\")]\n        public string Organization { get; set; }\n\n    }\n</code></pre>\n"}, {"tags": ["c#", "sql-server", "tsql"], "comments": [{"owner": {"reputation": 49169, "user_id": 13744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ed60d3cd033224d3ea343433ccf6e62?s=128&d=identicon&r=PG", "display_name": "gbjbaanb", "link": "https://stackoverflow.com/users/13744/gbjbaanb"}, "edited": false, "score": 0, "creation_date": 1533765742, "post_id": 51756201, "comment_id": 90472050, "body": "Have you tried with <a href=\"https://www.codeproject.com/articles/835519/passing-table-valued-parameters-with-dapper\" rel=\"nofollow noreferrer\">Dapper?</a>"}, {"owner": {"reputation": 125, "user_id": 10146544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8e4758d0a38e963e69ca86cb6fcdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Pepe", "link": "https://stackoverflow.com/users/10146544/pepe"}, "reply_to_user": {"reputation": 49169, "user_id": 13744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ed60d3cd033224d3ea343433ccf6e62?s=128&d=identicon&r=PG", "display_name": "gbjbaanb", "link": "https://stackoverflow.com/users/13744/gbjbaanb"}, "edited": false, "score": 0, "creation_date": 1533765831, "post_id": 51756201, "comment_id": 90472081, "body": "No sir, I&#39;m updating really old windows forms project so I think that&#39;s no a solution @gbjbaanb"}, {"owner": {"reputation": 49169, "user_id": 13744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5ed60d3cd033224d3ea343433ccf6e62?s=128&d=identicon&r=PG", "display_name": "gbjbaanb", "link": "https://stackoverflow.com/users/13744/gbjbaanb"}, "edited": false, "score": 0, "creation_date": 1533809824, "post_id": 51756201, "comment_id": 90487474, "body": "have you tried with Dapper... its a SQL client library so will work quite happily with winforms and any other C# app."}, {"owner": {"reputation": 2092, "user_id": 7926183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff222c5bfb610f85712e726ee7c5f93?s=128&d=identicon&r=PG&f=1", "display_name": "SMor", "link": "https://stackoverflow.com/users/7926183/smor"}, "edited": false, "score": 0, "creation_date": 1533820453, "post_id": 51756201, "comment_id": 90494658, "body": "@Pepe No one can read your mind or see your screen. Your topic still refers to &quot;does not work&quot; which was a runtime error initially. Does the procedure now execute successfully? What does &quot;how can i part as desire output ...&quot; mean? Are you now having a display issue with the information returned by the procedure? And please think about your error handling. Is the label &quot;GetTableBySQL&quot; useful to anyone? It does not appear you have a method or function of that name."}], "answers": [{"comments": [{"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 1, "creation_date": 1533766654, "post_id": 51756340, "comment_id": 90472330, "body": "He probably wants <code>cmd.Parameters.Add(new SqlParameter(&quot;@StartingDate&quot;, SqlDbType.DateTime).Value = new DateTime(2018, 8, 8)</code> and such."}, {"owner": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "reply_to_user": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1533766872, "post_id": 51756340, "comment_id": 90472398, "body": "exactly &lt;br /&gt;&lt;br /&gt;"}, {"owner": {"reputation": 125, "user_id": 10146544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8e4758d0a38e963e69ca86cb6fcdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Pepe", "link": "https://stackoverflow.com/users/10146544/pepe"}, "edited": false, "score": 0, "creation_date": 1533768269, "post_id": 51756340, "comment_id": 90472759, "body": "Exactly, I have problems with date, I update my try in my question with current issue there"}], "tags": [], "owner": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "is_accepted": false, "score": 0, "last_activity_date": 1533766167, "creation_date": 1533766167, "answer_id": 51756340, "question_id": 51756201, "link": "https://stackoverflow.com/questions/51756201/executing-stored-procedure-does-not-work-with-adding-parameters/51756340#51756340", "title": "Executing stored procedure does not work with adding parameters", "body": "<p>The problems is caused because</p>\n\n<pre><code>cmd.Parameters.Add(new SqlParameter(parameters, SqlDbType.NVarChar));\n</code></pre>\n\n<p>is creating a parameter with the name of whatever value is held in the variable <code>parameters</code> which is the string value <code>\"@StartingDate = '{startDate}', @EndingDate = '{endDate}'\"</code> because that is what you passed into <code>ExeSQLParamAndType</code> with this code:</p>\n\n<pre><code>db.ExeSQLParamAndType(\"StoredProcedureCalc\"\n, parameters\n, \"@EmployeeGuidIdTableType\"\n,$\"@StartingDate = '{startDate}', @EndingDate = '{endDate}'\");\n</code></pre>\n\n<p>you need to create two parameters, one called <code>startDate</code> and one called <code>EndDate</code></p>\n\n<pre><code>cmd.Parameters.Add(new SqlParameter(startingDate, SqlDbType.NVarChar));\ncmd.Parameters.Add(new SqlParameter(EndingDate , SqlDbType.NVarChar));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 732, "user_id": 2748245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/578784511/picture?type=large", "display_name": "Keith Harris", "link": "https://stackoverflow.com/users/2748245/keith-harris"}, "is_accepted": false, "score": 0, "last_activity_date": 1533789651, "creation_date": 1533789651, "answer_id": 51758972, "question_id": 51756201, "link": "https://stackoverflow.com/questions/51756201/executing-stored-procedure-does-not-work-with-adding-parameters/51758972#51758972", "title": "Executing stored procedure does not work with adding parameters", "body": "<p>C# DateTime and SQL Server DateTime are incompatible. You must change the setting in your SQL tables to use Datetime2 not DateTime.  You can do this by directly issuing an ALTER statement to every table with a Datetime field in your Database or adding a one line command in your DbContext class telling Entity Framework to specifically use \"datetime2\" for all classes that use DateTime.</p>\n"}], "owner": {"reputation": 125, "user_id": 10146544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8e4758d0a38e963e69ca86cb6fcdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Pepe", "link": "https://stackoverflow.com/users/10146544/pepe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533789651, "creation_date": 1533765332, "last_edit_date": 1533788760, "question_id": 51756201, "link": "https://stackoverflow.com/questions/51756201/executing-stored-procedure-does-not-work-with-adding-parameters", "title": "Executing stored procedure does not work with adding parameters", "body": "<p>In T-SQL I have an exec like this:</p>\n\n<pre><code>    EXEC [dbo].[usp_TaskStatus_Time_Calculation_Final] \n       @EmployeeGuidIdTableType = @EmployeeGuidIdTableType, \n       @StartingDate = '2018-08-02 00:00:00.000', \n       @EndingDate = '2018-08-08 00:00:00.000'\n</code></pre>\n\n<p>It works correctly, parameters do their job correctly, so I want to reproduce this in C# and I do:</p>\n\n<pre><code>public DataTable ExeSQLParamAndType(string SprocName, DataTable paramArray, string tableTypeName, string parameters = null)\n{\n    SqlCommand cmd = new SqlCommand(SprocName, this.dbconn);\n    cmd.CommandType = CommandType.StoredProcedure;\n\n    cmd.Parameters.Add(new SqlParameter(tableTypeName, SqlDbType.Structured));\n    cmd.Parameters[tableTypeName].Value = paramArray;\n    cmd.Parameters.Add(new SqlParameter(parameters, SqlDbType.NVarChar));\n\n    DataTable tbl = new DataTable(\"Table1\")\n        {\n            Locale = System.Globalization.CultureInfo.InvariantCulture\n        };\n    SqlDataAdapter da = new SqlDataAdapter(cmd);\n\n    try\n    {\n        da.Fill(tbl);\n    }\n    catch (SqlException e)\n    {\n        this.HandleSQLError(e, \"GetTableBySQL\", SprocName);\n    }\n    finally\n    {\n        cmd.Dispose();\n    }\n\n    return tbl;\n}\n</code></pre>\n\n<p>Execute method:</p>\n\n<pre><code>db.ExeSQLParamAndType(\"StoredProcedureCalc\", parameters,\n                      \"@EmployeeGuidIdTableType\",\n                      $\"@StartingDate = '{startDate}', @EndingDate = '{endDate}'\");\n</code></pre>\n\n<p>I get an exception when trying to pass <code>StaringDate</code> and <code>EndingDate</code> parameter in line  <code>this.HandleSQLError(e, \"GetTableBySQL\", SprocName);</code></p>\n\n<blockquote>\n  <p>@StartingDate = ''2018-08-02 00:00:00.000'', @EndingDate = ''2018-08-08 00:00:00.000'' is not a parameter for procedure StoredProcedureCalc</p>\n</blockquote>\n\n<p>Someone see something wrong there? Regards</p>\n\n<p><strong>Note</strong>: If I execute it from c# without this two parameters (just with table type) it works</p>\n\n<p><strong>Update</strong></p>\n\n<p>I change my code as comments below to:</p>\n\n<pre><code>var startDate =  $\"'{startingDate.Value.ToString(\"yyyy-MM-dd 00:00:00.000\")}'\";\nvar endDate = $\"'{endingDate.Value.ToString(\"yyyy-MM-dd 00:00:00.000\")}'\";\n\ndb.ExeSQLParamAndType(\"usp_TaskStatus_Time_Calculation_Final\", parameters, \"@EmployeeGuidIdTableType\", startDate, endDate);\n</code></pre>\n\n<p>and method like:</p>\n\n<pre><code>public DataTable ExeSQLParamAndType(string sprocName, DataTable paramArray, string tableTypeName, string startingDate, string endingDate)\n{\n    SqlCommand cmd = new SqlCommand(sprocName, this.dbconn);\n    cmd.CommandType = CommandType.StoredProcedure;\n\n    cmd.Parameters.Add(new SqlParameter(tableTypeName, SqlDbType.Structured));\n    cmd.Parameters[tableTypeName].Value = paramArray;\n\n    DateTime.TryParse(startingDate, out var startDate);\n    cmd.Parameters.Add(new SqlParameter(\"@StartingDate\", SqlDbType.DateTime));\n    cmd.Parameters[\"@StartingDate\"].Value = startDate;\n\n    DateTime.TryParse(startingDate, out var endDate);\n    cmd.Parameters.Add(new SqlParameter(\"@EndingDate\", SqlDbType.DateTime));\n    cmd.Parameters[\"@EndingDate\"].Value = endDate;\n\n    DataTable tbl = new DataTable(\"Table1\")\n            {\n                Locale = System.Globalization.CultureInfo.InvariantCulture\n            };\n\n    SqlDataAdapter da = new SqlDataAdapter(cmd);\n\n    try\n    {\n        da.Fill(tbl);\n    }\n    catch (SqlException e)\n    {\n        this.HandleSQLError(e, \"GetTableBySQL\", sprocName);\n    }\n    finally\n    {\n        cmd.Dispose();\n    }\n\n    return tbl;\n}\n</code></pre>\n\n<p>But I have troubles with <code>DateTime</code>, how can I parse as desire output format: 2018-08-02 00:00:00.000 ?</p>\n"}, {"tags": ["c#", "moq"], "answers": [{"comments": [{"owner": {"reputation": 4637, "user_id": 1786596, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7056f74fda5a406bc3b2883cdb0286b7?s=128&d=identicon&r=PG", "display_name": "Dbl", "link": "https://stackoverflow.com/users/1786596/dbl"}, "edited": false, "score": 0, "creation_date": 1533811734, "post_id": 51756267, "comment_id": 90488575, "body": "Thanks. i&#39;ll try it out later this day and upvote accordingly"}], "tags": [], "owner": {"reputation": 4522, "user_id": 7840778, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158454600115285/picture?type=large", "display_name": "Steve Land", "link": "https://stackoverflow.com/users/7840778/steve-land"}, "is_accepted": true, "score": 2, "last_activity_date": 1533809001, "last_edit_date": 1533809001, "creation_date": 1533765807, "answer_id": 51756267, "question_id": 51756174, "link": "https://stackoverflow.com/questions/51756174/can-moq-mock-behavior-in-order-to-use-an-expressions-methods-parameters/51756267#51756267", "title": "Can Moq mock behavior in order to use an expressions methods parameters?", "body": "<p>You can access invocation parameters in your mock method delegate by using the <code>Func</code> overload for <code>Returns()</code> to provide a lambda that accepts <em>exactly the same arguments</em> as the method you are mocking. Moq will pass any provided arguments through to your delegate.</p>\n\n<p><strong>Example from the docs:</strong></p>\n\n<pre><code>// access invocation arguments when returning a value\nmock.Setup(x =&gt; x.DoSomethingStringy(It.IsAny&lt;string&gt;()))\n    .Returns((string s) =&gt; s.ToLower());\n</code></pre>\n\n<blockquote>\n  <p><strong>Note 1</strong> If you're mocking a method that has any default parameters you must provide these <em>explicitly</em>.</p>\n  \n  <p><strong>Note 2</strong> Its worth mentioning the <code>Callback</code> option which is useful if you need to modify an object that isnt being returned, or you need to change your Mock behaviour based on the number of calls made.\n  <a href=\"https://github.com/Moq/moq4/wiki/Quickstart#callbacks\" rel=\"nofollow noreferrer\">https://github.com/Moq/moq4/wiki/Quickstart#callbacks</a></p>\n</blockquote>\n\n<p>There are good examples on the wiki page: <a href=\"https://github.com/Moq/moq4/wiki/Quickstart\" rel=\"nofollow noreferrer\">https://github.com/Moq/moq4/wiki/Quickstart</a></p>\n"}], "owner": {"reputation": 4637, "user_id": 1786596, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7056f74fda5a406bc3b2883cdb0286b7?s=128&d=identicon&r=PG", "display_name": "Dbl", "link": "https://stackoverflow.com/users/1786596/dbl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 51756267, "answer_count": 1, "score": 0, "last_activity_date": 1533809001, "creation_date": 1533765177, "question_id": 51756174, "link": "https://stackoverflow.com/questions/51756174/can-moq-mock-behavior-in-order-to-use-an-expressions-methods-parameters", "title": "Can Moq mock behavior in order to use an expressions methods parameters?", "body": "<p>I've got a class with dozens of methods - i only really need to work with two of those methods and avoid dependency injection.</p>\n\n<pre><code>Task&lt;List&lt;ApplicationUser&gt;&gt; GetAllContractors(CancellationToken cancellationToken);\nTask&lt;ApplicationUser&gt; FindByNameAsync(string normalizedUserName, CancellationToken cancellationToken);\n</code></pre>\n\n<p>My current attempt: (Works for all contractors easily enough since i don't need any parameter to take effect)</p>\n\n<pre><code>users.AddRange(await ManifestJsonLoader.LoadAsync&lt;List&lt;ApplicationUser&gt;&gt;(\"Mynamespace.sampleUsers.json\"));\nvar userProviderMock = new Mock&lt;IUserProvider&gt;(MockBehavior.Strict);\nuserProviderMock.Setup(service =&gt; service.GetAllContractors(CancellationToken.None)).Returns(Task.FromResult(users));\nuserProviderMock.Setup(service =&gt; service.FindByNameAsync(It.Is&lt;string&gt;(name =&gt; users.FirstOrDefault(d =&gt; d.UserName == name) != null), It.IsAny&lt;CancellationToken&gt;()));\n</code></pre>\n\n<p>I've looked for \"moq method with parameters\" but so far none of the results answered my question. Maybe i'm looking for the wrong keywords here.</p>\n"}, {"tags": ["c#", "json", "json.net"], "comments": [{"owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1533765200, "post_id": 51756145, "comment_id": 90471871, "body": "Are those two the only options?"}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1533765413, "post_id": 51756145, "comment_id": 90471953, "body": "The second JSON is not well-formed.  Try uploading to <a href=\"https://jsonlint.com/\" rel=\"nofollow noreferrer\">jsonlint.com</a> and you will get <code>Error: Parse error on line 4:</code>.  Can you please provide valid JSON samples?"}, {"owner": {"reputation": 60380, "user_id": 172861, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/7b64b4df7e1c9ca6fd953fd8a9a5c82b?s=128&d=identicon&r=PG", "display_name": "Ian Vink", "link": "https://stackoverflow.com/users/172861/ian-vink"}, "edited": false, "score": 0, "creation_date": 1533765687, "post_id": 51756145, "comment_id": 90472032, "body": "My bad in typing. The question is more about changing schemas"}, {"owner": {"reputation": 60380, "user_id": 172861, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/7b64b4df7e1c9ca6fd953fd8a9a5c82b?s=128&d=identicon&r=PG", "display_name": "Ian Vink", "link": "https://stackoverflow.com/users/172861/ian-vink"}, "reply_to_user": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1533765742, "post_id": 51756145, "comment_id": 90472049, "body": "@poke  Yes, there are only two types"}, {"owner": {"reputation": 3660, "user_id": 2085502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35944d07bd203fe68ed3781347412474?s=128&d=identicon&r=PG", "display_name": "Christoph L&#252;tjen", "link": "https://stackoverflow.com/users/2085502/christoph-l%c3%bctjen"}, "edited": false, "score": 0, "creation_date": 1533765759, "post_id": 51756145, "comment_id": 90472052, "body": "You&#39;ll need a custom creation converter: <a href=\"https://www.newtonsoft.com/json/help/html/CustomCreationConverter.htm\" rel=\"nofollow noreferrer\">newtonsoft.com/json/help/html/CustomCreationConverter.htm</a>"}, {"owner": {"reputation": 496, "user_id": 2788956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e98415c20a56b57f2521bd678575aa8a?s=128&d=identicon&r=PG&f=1", "display_name": "CSakura", "link": "https://stackoverflow.com/users/2788956/csakura"}, "reply_to_user": {"reputation": 3660, "user_id": 2085502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35944d07bd203fe68ed3781347412474?s=128&d=identicon&r=PG", "display_name": "Christoph L&#252;tjen", "link": "https://stackoverflow.com/users/2085502/christoph-l%c3%bctjen"}, "edited": false, "score": 0, "creation_date": 1533765934, "post_id": 51756145, "comment_id": 90472124, "body": "You can make the Msg property a generic list, and provide a method in the POCO to get the real type of list item. Or write your own converter, like @ChristophL&#252;tjen said"}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1533765936, "post_id": 51756145, "comment_id": 90472126, "body": "<code>{&quot;Error&quot;, 5 }</code> is not well-formed JSON.  Should that be <code>{&quot;Error&quot;: 5 }</code>?"}, {"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 0, "creation_date": 1533766168, "post_id": 51756145, "comment_id": 90472193, "body": "You&#39;ll need to set the type of <code>Msg</code> to be A] <code>Object</code>, B] <code>dynamic</code>, or C] a generic type."}], "answers": [{"tags": [], "owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "is_accepted": true, "score": 4, "last_activity_date": 1533801465, "last_edit_date": 1533801465, "creation_date": 1533766658, "answer_id": 51756425, "question_id": 51756145, "link": "https://stackoverflow.com/questions/51756145/deserializing-json-with-varying-schemas/51756425#51756425", "title": "Deserializing JSON with varying schemas", "body": "<p>You can <a href=\"https://www.newtonsoft.com/json/help/html/CustomJsonConverter.htm\" rel=\"nofollow noreferrer\">write a custom <code>JsonConverter</code></a> that handles different types. You could for example have the following JSON:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>{\n    \"Code\": 0,\n    \"Msg\": [\n        \"A single string\",\n        { \"Message\": \"An object with a message\" },\n        { \"Message\": \"An object with a message and a code\", \"Code\": 5 },\n        { \"Code\": 5 }\n    ]\n}\n</code></pre>\n\n<p>In this example, the <code>Msg</code> array can contain primitive strings, or a complex object. And that object can contain a <code>Message</code>, a <code>Code</code>, or both.</p>\n\n<p>You would choose the most common data structure for this, one that is able to represent all that information. That means for example that you will have to wrap that primitive string into a compatible object.</p>\n\n\n\n<pre class=\"lang-csharp prettyprint-override\"><code>public class Error\n{\n    public int Code { get; set; }\n    public ErrorMessage[] Msg { get; set; }\n}\n\npublic class ErrorMessage\n{\n    public string Message { get; set; }\n    public int? Code { get; set; }\n}\n</code></pre>\n\n<p>You can then use a custom </p>\n\n<p>And then, with a custom <a href=\"https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_JsonConverter.htm\" rel=\"nofollow noreferrer\"><code>JsonConverter</code></a>, you could parse the above JSON:</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>public class ErrorMessageConverter : JsonConverter\n{\n    public override bool CanConvert(Type objectType)\n        =&gt; objectType == typeof(ErrorMessage);\n\n    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)\n    {\n        // handle the primitive string\n        if (reader.TokenType == JsonToken.String)\n            return new ErrorMessage { Message = (string)reader.Value };\n\n        // handle a complex object; just assume that it is an `ErrorMessage` here\n        else if (reader.TokenType == JsonToken.StartObject)\n            return JObject.Load(reader).ToObject&lt;ErrorMessage&gt;();\n\n        throw new NotSupportedException();\n    }\n\n    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)\n    {\n        throw new NotImplementedException();\n    }\n}\n</code></pre>\n\n<p>This would be one way to use that converter:</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>// the single quotes are just here to make it more readable; JSON.NET support this\n// although it isn\u2019t valid JSON\nvar json = @\"{\n    'Code': 0,\n    'Msg': [\n        'A single string',\n        { 'Message': 'An object with a message' },\n        { 'Message': 'An object with a message and a code', 'Code': 5 },\n        { 'Code': 5 }\n    ]\n}\";\n\nvar settings = new JsonSerializerSettings()\nsettings.Converters.Add(new ErrorMessageConverter());\n\nvar result = JsonConvert.DeserializeObject&lt;Error&gt;(json, settings);\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/rXBA7.png\" alt=\"Successfully parsed result\"></p>\n"}], "owner": {"reputation": 60380, "user_id": 172861, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/7b64b4df7e1c9ca6fd953fd8a9a5c82b?s=128&d=identicon&r=PG", "display_name": "Ian Vink", "link": "https://stackoverflow.com/users/172861/ian-vink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 51756425, "answer_count": 1, "score": 1, "last_activity_date": 1533801465, "creation_date": 1533765033, "last_edit_date": 1533768328, "question_id": 51756145, "link": "https://stackoverflow.com/questions/51756145/deserializing-json-with-varying-schemas", "title": "Deserializing JSON with varying schemas", "body": "<p>I use JSON.Net with .NET 4.7.</p>\n\n<p>In an API I call, I can get two kinds of error jsons for the same call seemingly randomly :(.</p>\n\n<p><strong>Error Type 1:</strong></p>\n\n<pre><code>{\n   \"Code\": 0,\n   \"Msg\": [\"Some Warning\"]\n}\n</code></pre>\n\n<p><strong>Error Type 2:</strong></p>\n\n<pre><code>{\n    \"Code\": 0,\n    \"Msg\": [\n          {\"Error\": 5 },\n          {\"Error\": 6 }\n    ]\n}\n</code></pre>\n\n<p>As you can see, the <code>Msg</code> changes its structure. I'd like to have a common POCO to deserialize into, but how when the <code>Msg</code> changes?</p>\n\n<pre><code>JsonConvert.DeserializeObject&lt;MyCommonPoco&gt;(theJson);\n</code></pre>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1533765014, "post_id": 51756124, "comment_id": 90471812, "body": "Are you sure <code>PlayAgain()</code> is getting called?"}, {"owner": {"reputation": 103, "user_id": 10126419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDDvy6-EfO8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5vpHW7ADT5qpjx0tKUDGZELw7BQ/mo/photo.jpg?sz=128", "display_name": "Brendon", "link": "https://stackoverflow.com/users/10126419/brendon"}, "reply_to_user": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1533765359, "post_id": 51756124, "comment_id": 90471928, "body": "Yes! Debugged it and it is being called."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 10126419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDDvy6-EfO8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5vpHW7ADT5qpjx0tKUDGZELw7BQ/mo/photo.jpg?sz=128", "display_name": "Brendon", "link": "https://stackoverflow.com/users/10126419/brendon"}, "edited": false, "score": 0, "creation_date": 1533766582, "post_id": 51756352, "comment_id": 90472304, "body": "I&#39;m fairly certain the Invoke is not on a destroyed GameObject. The code above is for a button."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 1, "creation_date": 1533766698, "post_id": 51756352, "comment_id": 90472352, "body": "While you&#39;re certain, try to add OnDestroy like he said to see if that&#39;s the issue"}, {"owner": {"reputation": 103, "user_id": 10126419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDDvy6-EfO8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5vpHW7ADT5qpjx0tKUDGZELw7BQ/mo/photo.jpg?sz=128", "display_name": "Brendon", "link": "https://stackoverflow.com/users/10126419/brendon"}, "edited": false, "score": 0, "creation_date": 1533769444, "post_id": 51756352, "comment_id": 90473026, "body": "The GameObject is not destroyed"}, {"owner": {"reputation": 1194, "user_id": 7594662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PNwQk.jpg?s=128&g=1", "display_name": "Bagdan Gilevich", "link": "https://stackoverflow.com/users/7594662/bagdan-gilevich"}, "reply_to_user": {"reputation": 103, "user_id": 10126419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDDvy6-EfO8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5vpHW7ADT5qpjx0tKUDGZELw7BQ/mo/photo.jpg?sz=128", "display_name": "Brendon", "link": "https://stackoverflow.com/users/10126419/brendon"}, "edited": false, "score": 0, "creation_date": 1533772764, "post_id": 51756352, "comment_id": 90473727, "body": "@BrendonSon ok then can you provide more info and source code? What happens before PlayAgain is called?"}], "tags": [], "owner": {"reputation": 1194, "user_id": 7594662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PNwQk.jpg?s=128&g=1", "display_name": "Bagdan Gilevich", "link": "https://stackoverflow.com/users/7594662/bagdan-gilevich"}, "is_accepted": false, "score": 1, "last_activity_date": 1533766231, "creation_date": 1533766231, "answer_id": 51756352, "question_id": 51756124, "link": "https://stackoverflow.com/questions/51756124/invoke-not-being-called/51756352#51756352", "title": "Invoke not being called", "body": "<p><code>Invoke</code> doesn't work for a destroyed <code>GameObject</code>. I suppose your <code>GameObject</code> gets destroyed before <code>PlayAgain</code> is fired. Check it via <code>OnDestroy</code> </p>\n\n<pre><code>void OnDestroy () {\n    Debug.Log(\"Oops\");\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 10126419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDDvy6-EfO8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5vpHW7ADT5qpjx0tKUDGZELw7BQ/mo/photo.jpg?sz=128", "display_name": "Brendon", "link": "https://stackoverflow.com/users/10126419/brendon"}, "edited": false, "score": 0, "creation_date": 1533787101, "post_id": 51757827, "comment_id": 90476431, "body": "Ah! My Time.scale is zero :D. I&#39;ll give coroutine a shot! Thank you"}, {"owner": {"reputation": 1382, "user_id": 2593814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a653363d89e821b28ddaf4b826939c35?s=128&d=identicon&r=PG", "display_name": "Ron Tang", "link": "https://stackoverflow.com/users/2593814/ron-tang"}, "reply_to_user": {"reputation": 103, "user_id": 10126419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDDvy6-EfO8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5vpHW7ADT5qpjx0tKUDGZELw7BQ/mo/photo.jpg?sz=128", "display_name": "Brendon", "link": "https://stackoverflow.com/users/10126419/brendon"}, "edited": false, "score": 0, "creation_date": 1533787573, "post_id": 51757827, "comment_id": 90476542, "body": "@BrendonSon if your time scale is zero. Pleas use yield return new  WaitForSecondsRealtime.If this help you please accept my answer"}], "tags": [], "owner": {"reputation": 1382, "user_id": 2593814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a653363d89e821b28ddaf4b826939c35?s=128&d=identicon&r=PG", "display_name": "Ron Tang", "link": "https://stackoverflow.com/users/2593814/ron-tang"}, "is_accepted": true, "score": 3, "last_activity_date": 1533779972, "creation_date": 1533779972, "answer_id": 51757827, "question_id": 51756124, "link": "https://stackoverflow.com/questions/51756124/invoke-not-being-called/51757827#51757827", "title": "Invoke not being called", "body": "<ol>\n<li>Checking <code>Time.scale</code> is not zero.</li>\n<li>Checking <code>gameObject</code> is not destoryed.</li>\n<li>Checking return value of  <code>IsInvoking</code> is true.</li>\n</ol>\n\n<p>If all no problem but <code>Invoke</code> still not work,it maybe bug of <code>Invoke</code>,use <code>StartCoroutine</code>.</p>\n"}], "owner": {"reputation": 103, "user_id": 10126419, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nDDvy6-EfO8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p5vpHW7ADT5qpjx0tKUDGZELw7BQ/mo/photo.jpg?sz=128", "display_name": "Brendon", "link": "https://stackoverflow.com/users/10126419/brendon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 51757827, "answer_count": 2, "score": 1, "last_activity_date": 1533779972, "creation_date": 1533764938, "last_edit_date": 1533767703, "question_id": 51756124, "link": "https://stackoverflow.com/questions/51756124/invoke-not-being-called", "title": "Invoke not being called", "body": "<p>I'm trying to delay my scene loading just a bit to let my button sound play through before the new scene gets loaded, but I seem to be having errors, which is weird considering the exact same code worked for my other button. The Debug below does not get called. Thank you!</p>\n\n<pre><code>public class DeathScene : MonoBehaviour {\n    public void PlayAgain()\n    {\n        Invoke(\"Restart\", 0.25f);\n    }\n    void Restart()\n    {\n        Debug.Log(\"restart\");\n        SceneManager.LoadScene(SceneManager.GetActiveScene().buildIndex);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "entity-framework-6", "entity-framework-migrations"], "comments": [{"owner": {"reputation": 21589, "user_id": 4875631, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Goodbye StackExchange", "link": "https://stackoverflow.com/users/4875631/goodbye-stackexchange"}, "edited": false, "score": 3, "creation_date": 1533764777, "post_id": 51756045, "comment_id": 90471741, "body": "You have to first update all the null values to false first, and then run your AlterColumns."}, {"owner": {"reputation": 138, "user_id": 3990909, "user_type": "registered", "profile_image": "https://graph.facebook.com/1280592573/picture?type=large", "display_name": "Matt Jackson", "link": "https://stackoverflow.com/users/3990909/matt-jackson"}, "reply_to_user": {"reputation": 21589, "user_id": 4875631, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fGuXb.png?s=128&g=1", "display_name": "Goodbye StackExchange", "link": "https://stackoverflow.com/users/4875631/goodbye-stackexchange"}, "edited": false, "score": 0, "creation_date": 1533766428, "post_id": 51756045, "comment_id": 90472260, "body": "@FrankerZ is correct, check the db column for any existing NULL values"}, {"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 1, "creation_date": 1533766596, "post_id": 51756045, "comment_id": 90472310, "body": "I concur, either manually update the values so they are all not null with a query, or write it in the migration"}], "owner": {"reputation": 408, "user_id": 3014311, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/EeYwr.jpg?s=128&g=1", "display_name": "user3014311", "link": "https://stackoverflow.com/users/3014311/user3014311"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 729, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533768464, "creation_date": 1533764554, "last_edit_date": 1533768464, "question_id": 51756045, "link": "https://stackoverflow.com/questions/51756045/updating-existing-nullable-column-to-non-nullable-in-db-ef6", "title": "Updating existing nullable column to non-nullable in db EF6", "body": "<p>I added a new column to table using :</p>\n\n<pre><code>AddColumn(\"dbo.XYZ\", \"abc\", c =&gt; c.Boolean());\n</code></pre>\n\n<p>Model: </p>\n\n<pre><code>public class XYZ{\n    public bool? abc {get; set;}\n}\n</code></pre>\n\n<p>This added a new nullable bit column abc to XYZ. </p>\n\n<p>Now I want to Alter the column to non-nullable boolean with default value false.\nSo I tried this: </p>\n\n<pre><code> AlterColumn(\"dbo.XYZ\", \"abc\", c =&gt; c.Boolean(nullable: false,defaultValue:false));\n</code></pre>\n\n<p>Model changes: </p>\n\n<pre><code>public class XYZ {\n    public bool abc{ get; set; }\n}\n</code></pre>\n\n<p>On running update-database, I get the following error: </p>\n\n<blockquote>\n  <p>Cannot insert the value NULL into column 'abc', table 'dbo.XYZ';\n  column does not allow nulls. UPDATE fails. The statement has been\n  terminated.</p>\n</blockquote>\n\n<p>I actually want to update existing null records with default value. </p>\n"}, {"tags": ["c#", "asp.net", "job-scheduling", "hangfire"], "answers": [{"comments": [{"owner": {"reputation": 20165, "user_id": 165873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4cvPG.jpg?s=128&g=1", "display_name": "Vijjendra", "link": "https://stackoverflow.com/users/165873/vijjendra"}, "edited": false, "score": 4, "creation_date": 1533909749, "post_id": 51766599, "comment_id": 90533710, "body": "For this I need to save the JobId in database so I can use that later when needed."}], "tags": [], "owner": {"reputation": 6477, "user_id": 9608718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414d776388a58815290c0efc4a4bb114?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Riabov", "link": "https://stackoverflow.com/users/9608718/alex-riabov"}, "is_accepted": true, "score": 17, "last_activity_date": 1568931672, "last_edit_date": 1568931672, "creation_date": 1533816418, "answer_id": 51766599, "question_id": 51756040, "link": "https://stackoverflow.com/questions/51756040/cancel-or-delete-scheduled-job-hangfire/51766599#51766599", "title": "Cancel or Delete Scheduled Job - HangFire", "body": "<p><code>BackgroundJob.Schedule</code> returns you an id of that job, you can use it to delete this job:</p>\n\n<pre><code>var jobId = BackgroundJob.Schedule(() =&gt;  MyRepository.SomeMethod(2),TimeSpan.FromDays(7));\n\nBackgroundJob.Delete(jobId);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 3029066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f2639d3e71496612ecc4b219bb25091?s=128&d=identicon&r=PG&f=1", "display_name": "user3029066", "link": "https://stackoverflow.com/users/3029066/user3029066"}, "is_accepted": false, "score": 0, "last_activity_date": 1602358192, "last_edit_date": 1602358192, "creation_date": 1602351025, "answer_id": 64296327, "question_id": 51756040, "link": "https://stackoverflow.com/questions/51756040/cancel-or-delete-scheduled-job-hangfire/64296327#64296327", "title": "Cancel or Delete Scheduled Job - HangFire", "body": "<p>You don't need to save their IDs to retrieve the jobs later. Instead, you can utilize the <em>MonitoringApi</em> class of the Hangfire API. Note that, you will need to filter out the jobs according to your needs.</p>\n<p><em>Text</em> is my custom class in my example code.</p>\n<pre><code>public void ProcessInBackground(Text text)\n{\n    // Some code\n}\n\npublic void SomeMethod(Text text)\n{\n    // Some code\n\n    // Delete existing jobs before adding a new one\n    DeleteExistingJobs(text.TextId);\n\n    BackgroundJob.Enqueue(() =&gt; ProcessInBackground(text));\n}\n\nprivate void DeleteExistingJobs(int textId)\n{\n    var monitor = JobStorage.Current.GetMonitoringApi();\n\n    var jobsProcessing = monitor.ProcessingJobs(0, int.MaxValue)\n        .Where(x =&gt; x.Value.Job.Method.Name == &quot;ProcessInBackground&quot;);\n    foreach (var j in jobsProcessing)\n    {\n        var t = (Text)j.Value.Job.Args[0];\n        if (t.TextId == textId)\n        {\n            BackgroundJob.Delete(j.Key);\n        }\n    }\n\n    var jobsScheduled = monitor.ScheduledJobs(0, int.MaxValue)\n        .Where(x =&gt; x.Value.Job.Method.Name == &quot;ProcessInBackground&quot;);\n    foreach (var j in jobsScheduled)\n    {\n        var t = (Text)j.Value.Job.Args[0];\n        if (t.TextId == textId)\n        {\n            BackgroundJob.Delete(j.Key);\n        }\n    }\n}\n</code></pre>\n<p>My reference: <a href=\"https://discuss.hangfire.io/t/cancel-a-running-job/603/10\" rel=\"nofollow noreferrer\">https://discuss.hangfire.io/t/cancel-a-running-job/603/10</a></p>\n"}], "owner": {"reputation": 20165, "user_id": 165873, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4cvPG.jpg?s=128&g=1", "display_name": "Vijjendra", "link": "https://stackoverflow.com/users/165873/vijjendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8580, "favorite_count": 2, "accepted_answer_id": 51766599, "answer_count": 2, "score": 7, "last_activity_date": 1602358192, "creation_date": 1533764532, "last_edit_date": 1568931618, "question_id": 51756040, "link": "https://stackoverflow.com/questions/51756040/cancel-or-delete-scheduled-job-hangfire", "title": "Cancel or Delete Scheduled Job - HangFire", "body": "<p>I have scheduled a Job via using Hangfire library. My scheduled Code like below.</p>\n\n<pre><code>BackgroundJob.Schedule(() =&gt; MyRepository.SomeMethod(2),TimeSpan.FromDays(7));\n\npublic static bool DownGradeUserPlan(int userId)\n    {\n        //Write logic here\n    }\n</code></pre>\n\n<p>Now I want to Delete this Scheduled Job later on some event. </p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1533764746, "post_id": 51756031, "comment_id": 90471722, "body": "Have you tried checking <code>Form[&quot;RadioButton&quot;]</code> to see what the value is?"}, {"owner": {"reputation": 393, "user_id": 2903379, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/52f972881fadcb1910f622d9c0f33cbf?s=128&d=identicon&r=PG&f=1", "display_name": "user2903379", "link": "https://stackoverflow.com/users/2903379/user2903379"}, "reply_to_user": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1533764902, "post_id": 51756031, "comment_id": 90471778, "body": "yea. &quot;Form doesn&#39;t exist in the current context&quot;"}, {"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1533764942, "post_id": 51756031, "comment_id": 90471787, "body": "I meant with all the preceding junk too. Just examine the value of what you&#39;re trying to compare to &quot;True&quot;."}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1533764963, "post_id": 51756031, "comment_id": 90471792, "body": "As long as the submitted form data has <code>RadioButton: True</code> in the body, your code should generate <code>true</code> for the <code>IsAlreadyCustomer</code> variable."}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1533764992, "post_id": 51756031, "comment_id": 90471802, "body": "BTW, You do not need the <code>Convert.ToBoolean</code> call as the <code>==</code> expression will return a boolean value."}, {"owner": {"reputation": 393, "user_id": 2903379, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/52f972881fadcb1910f622d9c0f33cbf?s=128&d=identicon&r=PG&f=1", "display_name": "user2903379", "link": "https://stackoverflow.com/users/2903379/user2903379"}, "reply_to_user": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1533765112, "post_id": 51756031, "comment_id": 90471844, "body": "@itsme86 yes I did just <code>controllerContext.HttpContext.Request.Form[&quot;RadioButton&quot;] == &quot;True&quot;</code> and it came back <code>&quot;False&quot;</code>"}, {"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 0, "creation_date": 1533765217, "post_id": 51756031, "comment_id": 90471879, "body": "No, I mean examine the value. You&#39;re examining the comparison result. What does <code>controllerContext.HttpContext.Request.Form[&quot;RadioButton&quot;]</code> evaluate to? <code>&lt;something&gt; == &quot;True&quot;</code> is false, but what&#39;s the &lt;something&gt;?"}, {"owner": {"reputation": 393, "user_id": 2903379, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/52f972881fadcb1910f622d9c0f33cbf?s=128&d=identicon&r=PG&f=1", "display_name": "user2903379", "link": "https://stackoverflow.com/users/2903379/user2903379"}, "edited": false, "score": 0, "creation_date": 1533765412, "post_id": 51756031, "comment_id": 90471951, "body": "In my code, I&#39;m setting IsAreadyCustomer to the value of the radio button. Ive declared <code>IsAlreadyCustomer</code> as a bool. Then setting it using the code above. It should be coming back as True but its being set to false. I&#39;ll update my question for more info"}, {"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 1, "creation_date": 1533765653, "post_id": 51756031, "comment_id": 90472023, "body": "You&#39;re not setting <code>IsAlreadyCustomer</code> to the value of the radio button though. You&#39;re setting it to the result of comparing the value of the radio button to &quot;True&quot;."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1533765712, "post_id": 51756031, "comment_id": 90472043, "body": "Put a breakpoint in the method. Run to the breakpoint. Go to the <code>Immediate Window</code> and evaluate <code>?controllerContext.HttpContext.Request.Form[&quot;RadioButton&quot;]</code> What <b>exactly</b> does it display?"}, {"owner": {"reputation": 393, "user_id": 2903379, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/52f972881fadcb1910f622d9c0f33cbf?s=128&d=identicon&r=PG&f=1", "display_name": "user2903379", "link": "https://stackoverflow.com/users/2903379/user2903379"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1533765789, "post_id": 51756031, "comment_id": 90472066, "body": "@mjwills it comes back as <code>&quot;False&quot;</code> (as a string)"}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 5, "creation_date": 1533765847, "post_id": 51756031, "comment_id": 90472089, "body": "It would be awesome if you could provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 18794, "user_id": 1220550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1osH.jpg?s=128&g=1", "display_name": "Peter B", "link": "https://stackoverflow.com/users/1220550/peter-b"}, "edited": false, "score": 3, "creation_date": 1533769345, "post_id": 51756031, "comment_id": 90473009, "body": "Instead of doing it all in the hardest way possible, you should (1) create and use a <b>Model class</b>, (2) use <b>HTML Helpers</b> for rendering the HTML output, and (3) use <b>Model Binding</b> instead of messing around with Request.Form. For examples of how to do that, see e.g. <b><a href=\"https://stackoverflow.com/q/2559208/1220550\">this question</a></b>."}, {"owner": {"reputation": 393, "user_id": 2903379, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/52f972881fadcb1910f622d9c0f33cbf?s=128&d=identicon&r=PG&f=1", "display_name": "user2903379", "link": "https://stackoverflow.com/users/2903379/user2903379"}, "reply_to_user": {"reputation": 18794, "user_id": 1220550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1osH.jpg?s=128&g=1", "display_name": "Peter B", "link": "https://stackoverflow.com/users/1220550/peter-b"}, "edited": false, "score": 0, "creation_date": 1533802384, "post_id": 51756031, "comment_id": 90482794, "body": "@PeterB Unfortunatley that option isnt available for me"}], "owner": {"reputation": 393, "user_id": 2903379, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/52f972881fadcb1910f622d9c0f33cbf?s=128&d=identicon&r=PG&f=1", "display_name": "user2903379", "link": "https://stackoverflow.com/users/2903379/user2903379"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533767951, "creation_date": 1533764484, "last_edit_date": 1533767951, "question_id": 51756031, "link": "https://stackoverflow.com/questions/51756031/why-does-my-convert-to-bool-not-work-c", "title": "Why does my convert to bool not work c#", "body": "<p>I have an MVC project that has a radio button.  Im using a custom input so it looks a bit like this.</p>\n\n<pre><code>&lt;input class=\"cb_yes\" data-val=\"true\" data-val-required=\"You must select\" id=\"radio_Yes\" name=\"RadioButton\" type=\"radio\" value=\"True\"&gt;\n&lt;span id=\"radio-yes\"&gt;&lt;/span&gt;Yes&lt;/label&gt;\n&lt;input class=\"cb_no\" data-val=\"true\" data-val-required=\"You must select\" id=\"radio_No\" name=\"RadioButton\" type=\"radio\" value=\"False\"&gt;\n&lt;span id=\"radio-no\"&gt;&lt;/span&gt;No&lt;/label&gt;\n</code></pre>\n\n<p>Notice that the <code>name</code> is the same. </p>\n\n<p>When Yes is clicked, in the browser console I can do </p>\n\n<p><code>$(\"input[name='RadioButton']\").val()</code> and it came back as <code>True</code>. So far so good.</p>\n\n<p>I'm then doing some C# to convert this value to a c# bool.</p>\n\n<p>I'm doing</p>\n\n<p><code>IsAlreadyCustomer = Convert.ToBoolean(controllerContext.HttpContext.Request.Form[\"RadioButton\"] == \"True\");</code></p>\n\n<p>but it's coming back as <code>false</code>. I'm looking in the \"QuickWatch\" to test and doing </p>\n\n<p><code>controllerContext.HttpContext.Request.Form[\"RadioButton\"] == \"True\"</code> but thats, no suprise, false.</p>\n\n<p>I cant seem to see why it's coming back as false. I dont get why my browser says True but QuickWatch is saying false</p>\n\n<p>Have I wrote it correctly? What am I doing wrong?</p>\n\n<hr>\n\n<h3>Update:</h3>\n\n<p>First, I'm declaring a bool, then I try to set the bool to true based on the value of the radio button.</p>\n\n<pre><code>bool IsAlreadyCustomer;\n   //if null then false, else         \n IsAlreadyCustomer = Convert.ToBoolean(controllerContext.HttpContext.Request.Form[\"RadioButton\"] == \"True\");`\n        `\n</code></pre>\n"}, {"tags": ["c#", "oop", "unity3d"], "comments": [{"owner": {"reputation": 18479, "user_id": 1141432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012a5bc2ab8149295daba3ed25471679?s=128&d=identicon&r=PG", "display_name": "itsme86", "link": "https://stackoverflow.com/users/1141432/itsme86"}, "edited": false, "score": 1, "creation_date": 1533764536, "post_id": 51755943, "comment_id": 90471645, "body": "1) There is no difference in this case. 2) You need a fundamental understanding of variables, properties, and scope. You should have a <code>Player</code> class member that you instantiate in <code>Start()</code>. Instead, you&#39;re creating a player and then throwing it away because it goes out of scope when <code>Start()</code> returns."}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 1, "creation_date": 1533764901, "post_id": 51755943, "comment_id": 90471777, "body": "For #2, look at <a href=\"https://hackernoon.com/c-static-vs-instance-classes-and-methods-50fe8987b231\" rel=\"nofollow noreferrer\">C# static vs instance methods</a> to learn why sometimes you need an instance of a class (the variable name) to call a method, and other times you just use the class name (for static methods)."}, {"owner": {"reputation": 2940, "user_id": 3800096, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dffaee3296e432469a794c508c297abc?s=128&d=identicon&r=PG&f=1", "display_name": "AustinWBryan", "link": "https://stackoverflow.com/users/3800096/austinwbryan"}, "edited": false, "score": 0, "creation_date": 1533791235, "post_id": 51755943, "comment_id": 90477529, "body": "You should have the <code>Update</code> function it it&#39;s not in use, it&#39;s worse on preformance. Also, you shouldn&#39;t include it in the Stack Overflow post as it&#39;s not relavent to your issue."}, {"owner": {"reputation": 2940, "user_id": 3800096, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dffaee3296e432469a794c508c297abc?s=128&d=identicon&r=PG&f=1", "display_name": "AustinWBryan", "link": "https://stackoverflow.com/users/3800096/austinwbryan"}, "edited": false, "score": 1, "creation_date": 1533791545, "post_id": 51755943, "comment_id": 90477636, "body": "I suggest you take a good amount of time to study C# and core programming concepts by themself before trying to make a game. It took me quite a while before I finally was ready for a game. Right now, you&#39;re learning to very complex things at once and that&#39;s hindering your learning of both things."}], "answers": [{"tags": [], "owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "is_accepted": false, "score": 2, "last_activity_date": 1533765983, "last_edit_date": 1533765983, "creation_date": 1533765479, "answer_id": 51756222, "question_id": 51755943, "link": "https://stackoverflow.com/questions/51755943/unity-c-class-and-objects/51756222#51756222", "title": "Unity C# Class and Objects", "body": "<p>When you execute <code>Player nexus = new Player();</code>, you are creating a new instance (/object) of type (/class) \"Player\".  The variable <code>nexus</code> is an object reference (i.e., it refers to the object instance you just created).  Once you have an instance, you can call instance methods on that object, set or read its properties (which, by the way, you have none of).  Since there is only one reference to that object (the <code>nexus</code> variable), when that reference goes out of scope (at the end of the function), the object no longer is referenced by anything and is eligible for garbage collection.</p>\n\n<p>When you declare a method (/function) with the <code>static</code> keyword, you are creating it at the class level, rather than at the instance level.  If you wanted to call the non-static <code>Update</code> or <code>Attack</code> methods, you'd have to say <code>nexus.Update</code> or <code>nexus.Attack</code>.  To call the static <code>Using</code> or <code>Move</code> methods, you'd use the class name (Player) like this: <code>Player.Using</code> or <code>Player.Move</code>.</p>\n\n<p>The code you posted does not compile, does it?  You can't call an instance method from a static method.  You can't call the instance method <code>Attack</code> or <code>this.Attack</code> from the static method <code>Using</code> (there's no \"this\" there (<code>this</code> is the current object instance associated with an instance method)).  It's best to post code that at least compiles (unless you say (in a comment) <code>//this is the code that doesn't compile</code></p>\n\n<p>You also only create a new Player instance in the <code>Start</code> method, which is a little odd.  Generally, you create instances of objects in other classes or in static <em>factory</em> methods (not always, but generally).</p>\n\n<p>Read up on the nature of object oriented programming, on C#'s <code>static</code> keyword and on the nature of object instances (in general).  You probably want to read up on C#'s properties as well.</p>\n\n<p>Oh, and naming something <code>Using</code> is going to hurt in the long run (lower case <code>using</code> is a C# keyword that already has two meanings).</p>\n\n<p>Finally, to answer your question, \"calling an instance method this way: <code>Attack()</code> or that way: <code>this.Attack()</code> has the same semantics.\"  Of course, as noted above, you can't use either form if you are trying to call an instance method from a static method.</p>\n"}, {"comments": [{"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1533765795, "post_id": 51756228, "comment_id": 90472067, "body": "Note that the code in the <code>Using</code> function will not compile because it&#39;s a <code>static</code> function while <code>Attack</code> is a non <code>static</code> function. You <b>can&#39;t</b> call non <code>static</code> function from a <code>static</code> function."}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1533765826, "post_id": 51756228, "comment_id": 90472079, "body": "And, that first sample of code (calling the instance method <code>Attack</code> from the static method <code>Using</code>) won&#39;t compile.  The two <code>Start</code> method examples are a little weird too.  As @itsme86 noted, the first one creates a new Player object, but, since the reference immediately goes out of scope, that object is lost forever and is eligible for &quot;Garbage collection&quot;.  The second example would only work if the Player class had a public string property named <code>name</code> (which, by convention, should really start with a capital letter).  The WriteLine call relies on Player having a ToString method <i>override</i>"}, {"owner": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "edited": false, "score": 0, "creation_date": 1533766622, "post_id": 51756228, "comment_id": 90472317, "body": "NB, Just quoting the OPs code for the purpose of explanation. Have left out comments re: code quality of and other factors which are outside of the scope of the question"}], "tags": [], "owner": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "is_accepted": false, "score": 1, "last_activity_date": 1533790933, "last_edit_date": 1533790933, "creation_date": 1533765502, "answer_id": 51756228, "question_id": 51755943, "link": "https://stackoverflow.com/questions/51755943/unity-c-class-and-objects/51756228#51756228", "title": "Unity C# Class and Objects", "body": "<ol>\n<li>The <code>this</code> keyword means \"A reference to the current instance of the class\" It's syntactic sugar really (it can make your code clearer to read)</li>\n</ol>\n\n<p>When you do</p>\n\n<pre><code>public static void Using() {\n    Attack();\n    this.Attack();\n}\n</code></pre>\n\n<p>Behind the scenes, the compiler will execute it as so:</p>\n\n<pre><code>public static void Using() {\n    this.Attack();\n    this.Attack();\n}\n</code></pre>\n\n<p>so in your context, they are the same.</p>\n\n<p>There are times it is useful see <a href=\"https://stackoverflow.com/questions/23250/when-do-you-use-the-this-keyword\">this post</a></p>\n\n<ol start=\"2\">\n<li>If I understand correctly, this question relates to why do you need to have a variable called name rather than just naming the object as the player \nname.\nThe variable \"name\" and the name of the object are two different things</li>\n</ol>\n\n<p>Lets say you want to output the players name to the screen </p>\n\n<pre><code>void Start () {\n    Player nexus = new Player();\n\n}\n</code></pre>\n\n<p>in the method above, i can't [simply] do it</p>\n\n<pre><code>void Start () {\n    Player p = new Player();\n    p.name = \"nexus\";\n    Console.WriteLine(p);\n}\n</code></pre>\n\n<p>Whereas here I output the value in the variable called name. Variables are basically a box with name on (name) which hold values (nexus)</p>\n\n<p>I suggest you look at some <a href=\"https://www.youtube.com/watch?v=SXmVym6L8dw&amp;list=PLAC325451207E3105\" rel=\"nofollow noreferrer\">basic programming tutorials</a> before you tackle Unity</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9771277, "user_type": "registered", "profile_image": "https://graph.facebook.com/2059940410701930/picture?type=large", "display_name": "Patrick Silveira", "link": "https://stackoverflow.com/users/9771277/patrick-silveira"}, "is_accepted": false, "score": 3, "last_activity_date": 1533765831, "creation_date": 1533765831, "answer_id": 51756271, "question_id": 51755943, "link": "https://stackoverflow.com/questions/51755943/unity-c-class-and-objects/51756271#51756271", "title": "Unity C# Class and Objects", "body": "<blockquote>\n  <p>What is the difference between calling a function Attack() versus this.Attack?</p>\n</blockquote>\n\n<p>When you are coding the class Player for example and you want to use the method \"Attack()\" you can do that by typing Attack() or this.Attack(). It does the same thing in both cases.</p>\n\n<p>When you use \"this.\" you guarantee that the method you are using is the implemented on the class you are on. For example:</p>\n\n<pre><code>public void GroupAttack(DifferentPlayer ally){\n    Attack(); \n    ally.Attack();\n}\n\npublic void GroupAttackWithThis(DifferentPlayer ally){\n    this.Attack(); \n    ally.Attack();\n}\n</code></pre>\n\n<p>There is no difference between the method GroupAttack and GroupAttackWithThis.</p>\n\n<p>Useful link to see the difference:\n<a href=\"https://stackoverflow.com/questions/6547310/in-java-what-is-the-difference-between-this-method-and-method\">In Java, what is the difference between this.method() and method()?</a></p>\n\n<blockquote>\n  <p>I created the object of the Player class with the random name nexus. However, when I call a function from a different class I seem to use the class name rather than this variable name. So what is the purpose of creating a variable name?</p>\n</blockquote>\n\n<p>It happens because you made the function \"Move\" static, it means that for every instance of that class it will do exactly the same. Static is used when you want a method or a variable to have the same value or have a behavior identical every time for every instance of the class.\nIf your method is not static you will need to use the name of the variable to use it, that is because you will want your method to change his behavior for every instance.\nA simple example:</p>\n\n<pre><code>public string GetName(){\n    return name;\n}\n</code></pre>\n\n<p>This method will return for every Player a different name (will return the name of the player in the variable). So if you do:</p>\n\n<pre><code>Player jhon = new Player();\njhon.name = \"Jhon\";\nString jhonsName = jhon.GetName();\n</code></pre>\n\n<p>The variable \"jhonsName\" will contain a string with the value \"Jhon\".</p>\n\n<p>I hope this could be useful for you and good luck with your game.</p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 10199922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eBnVW.png?s=128&g=1", "display_name": "Game Generator", "link": "https://stackoverflow.com/users/10199922/game-generator"}, "is_accepted": false, "score": 2, "last_activity_date": 1533790907, "last_edit_date": 1533790907, "creation_date": 1533767883, "answer_id": 51756606, "question_id": 51755943, "link": "https://stackoverflow.com/questions/51755943/unity-c-class-and-objects/51756606#51756606", "title": "Unity C# Class and Objects", "body": "<p>There are some differences between Unitys MonoBehaviour to the normal C# classes. I recommend to watch some Unity Tutorials. Unity-Scripts are Scene oriented.</p>\n\n<ol>\n<li><p>There is no difference. <i>this.Something</i> can be used to mark something as \"from the class object\" (Normally Properties or Variables) to distinguish from parameters.</p></li>\n<li><p>Writing <i>Player nexus = new Player();</i> should be a Warning because you should not do this with a MonoBehaviour. </p></li>\n</ol>\n\n<p>You create a Player in the Scene by putting the Script \"Player\" on a GameObject. You should access the Player script from the GameObject. So you should remove \"static\" on the methods. Then put <i>public Player player;</i> inside UsingStuff (under public class UsingStuff : MonoBehaviour {). Then Drag your Player on the placeholder for Player. You will find it on the GameObject with the UsingStuff-Script in the scene. Now you can call player.Move() (with small p) in the Start Method.</p>\n\n<p>Try another naming for your variable <i>name</i>. It already exist for every MonoBehaviour. It refers to the name of the GameObject the Script is lying on. Your naming should also throw a Warning.</p>\n"}, {"comments": [{"owner": {"reputation": 316, "user_id": 1507878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c10c58d579fdc4e36c076851a229461?s=128&d=identicon&r=PG", "display_name": "Nikaas", "link": "https://stackoverflow.com/users/1507878/nikaas"}, "edited": false, "score": 3, "creation_date": 1533797156, "post_id": 51757621, "comment_id": 90479895, "body": "This site is not like forums. You should not post replies as answers. You can use comments, or open a new question."}, {"owner": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "edited": false, "score": 1, "creation_date": 1533808117, "post_id": 51757621, "comment_id": 90486338, "body": "Agreed, probably best to add and edit to the bottom of your original post because this will get missed as it is classed as an answer"}], "tags": [], "owner": {"reputation": 113, "user_id": 3612412, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2b918a387afce5cbe39750226185750?s=128&d=identicon&r=PG&f=1", "display_name": "shodai", "link": "https://stackoverflow.com/users/3612412/shodai"}, "is_accepted": false, "score": 0, "last_activity_date": 1533836120, "last_edit_date": 1533836120, "creation_date": 1533777643, "answer_id": 51757621, "question_id": 51755943, "link": "https://stackoverflow.com/questions/51755943/unity-c-class-and-objects/51757621#51757621", "title": "Unity C# Class and Objects", "body": "<p>Alright, so first off thank you to everyone for pointing at different details. I think I am getting my head around things. I now have a working example:</p>\n\n<pre><code>public class Player : MonoBehaviour {\n\n    public string name;\n    public int power;\n    public int speed;\n\n    public void gameData() {\n        print (\"Player name = \" + name);\n        print (\"Player power = \" + power);\n        print (\"Player speed = \" + speed);   \n    }\n    private void Attack () { }\n}\n...\n\npublic class UsingStuff : MonoBehaviour {\n\nvar P1 = new Player();\nvar P2 = new Player();\nvar P3 = new Player();\n\nprivate void Start () {\n    P1.name  = \"Bill\";\n    P1.power = 10;\n    P1.speed = 30;\n\n    P2.name  = \"Bob\";\n    P2.power = 100;\n    P2.speed = 3;\n\n    P3.name  = \"Jerry\";\n    P3.power = 50;\n    P3.speed = 10;\n\n    P1.gameData();\n    P2.gameData();\n    P3.gameData();\n}\n</code></pre>\n\n<p>However, even though the program works, I am getting a warning that is specific to using Unity and MonoDevelop, so that is a different issue all together. Thank you all for your help.</p>\n"}, {"tags": [], "owner": {"reputation": 2940, "user_id": 3800096, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dffaee3296e432469a794c508c297abc?s=128&d=identicon&r=PG&f=1", "display_name": "AustinWBryan", "link": "https://stackoverflow.com/users/3800096/austinwbryan"}, "is_accepted": false, "score": 1, "last_activity_date": 1533791072, "creation_date": 1533791072, "answer_id": 51759182, "question_id": 51755943, "link": "https://stackoverflow.com/questions/51755943/unity-c-class-and-objects/51759182#51759182", "title": "Unity C# Class and Objects", "body": "<p>On top of the other answers, you can also use <code>this</code> to disambiguate. Common example:</p>\n\n<pre><code>public MyType(this name) =&gt; this.name = name;\n</code></pre>\n\n<p>Or to use Extension Methods: </p>\n\n<pre><code>public static void MyCustomExtensionMethod(this Foo foo) { }\n...\npublic class Bar() : Foo\n{\n   // I did not create Foo and do not have access to Foo\n   this.MyCustomExtensionMethod();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 10199922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eBnVW.png?s=128&g=1", "display_name": "Game Generator", "link": "https://stackoverflow.com/users/10199922/game-generator"}, "is_accepted": false, "score": 0, "last_activity_date": 1533859761, "creation_date": 1533859761, "answer_id": 51777286, "question_id": 51755943, "link": "https://stackoverflow.com/questions/51755943/unity-c-class-and-objects/51777286#51777286", "title": "Unity C# Class and Objects", "body": "<p>I\u00b4m not able to comment so i will answer this way on your second post:</p>\n\n<p><strong>First case:</strong></p>\n\n<p>If you <strong>don`t</strong> <i>need the player as a script connected with a GameObject and Unity functions like Update loops</i>: Remove the inheritance (from MonoBehaviour) and it will work:\n<code>\n    public class Player \n    {\n     ...\n    }\n</code></p>\n\n<p><strong>Second more common case:</strong></p>\n\n<p><strong>If you need a Player as a object in the scene which uses Unity functions</strong> leave the Player Script as it is. The mistake is in using  <i>var P1 = new Player();</i> You know that have to add your Script to a GameObject in Unity Scene? Watch some basic Unity tutorials to understand: <a href=\"https://unity3d.com/de/learn/tutorials/topics/interface-essentials/game-objects-and-components?playlist=17090\" rel=\"nofollow noreferrer\">https://unity3d.com/de/learn/tutorials/topics/interface-essentials/game-objects-and-components?playlist=17090</a> </p>\n\n<p>This shows how to control a GameObject Script from another Script:\n<a href=\"https://unity3d.com/de/learn/tutorials/topics/scripting/activating-gameobjects?playlist=17117\" rel=\"nofollow noreferrer\">https://unity3d.com/de/learn/tutorials/topics/scripting/activating-gameobjects?playlist=17117</a> </p>\n"}, {"tags": [], "owner": {"reputation": 1444, "user_id": 6534880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6YTr5.jpg?s=128&g=1", "display_name": "Prodigle", "link": "https://stackoverflow.com/users/6534880/prodigle"}, "is_accepted": false, "score": 1, "last_activity_date": 1533901380, "creation_date": 1533901380, "answer_id": 51785768, "question_id": 51755943, "link": "https://stackoverflow.com/questions/51755943/unity-c-class-and-objects/51785768#51785768", "title": "Unity C# Class and Objects", "body": "<p>You may want to just read some more OOP theory before diving into code. I can hopefully throw some pointers which should help you get on track :)</p>\n\n<p>Firstly, from inside a class, calling Attack() is the same as this.Attack(). this is just a little more explicit that you're talking about the current object and not some other function called Attack.</p>\n\n<p>Your Player class is your template for what a Player should like. You should not access Player. because this is accessing your template and not an object of a player.\nE.G</p>\n\n<pre><code>Player.Something() //Accesses a function inside the Player class.\n</code></pre>\n\n<p>You will rarely do something like the above, it's a more complicated idea. These are called static properties/functions and apply to the template of the class. All your functions here are static when they should not be :)</p>\n\n<p>So your class is your template of what a player should be like, but how do we make an object of a player?</p>\n\n<pre><code>public class UsingStuff : MonoBehaviour \n{\n    private void Start () {\n        Player myPlayer = new Player(); //Makes an object called myPlayer\n        Player otherPlayer = new Player(); //Another player object\n        //For functions\n        myPlayer.Attack(); //myPlayer will attack\n        otherPlayer.Move(); //otherPlayer.move\n        //For variables\n        myPlayer.name = \"Dave\";\n        otherPlayer.name = \"Emma\";\n        //Now both our players have different names\n    }\n}\n</code></pre>\n\n<p>Hopefully this makes a bit more sense, Your class is your template of what a player should have/be able to do. To actually use/make players you create objects of them, and then each one has their variables. For example if <code>Ouch(){this.hp--);</code> then <code>myPlayer.Ouch()</code> would cause myPlayer to lose 1 of his health, but otherPlayer would not be affected.</p>\n"}], "owner": {"reputation": 113, "user_id": 3612412, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2b918a387afce5cbe39750226185750?s=128&d=identicon&r=PG&f=1", "display_name": "shodai", "link": "https://stackoverflow.com/users/3612412/shodai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2190, "favorite_count": 0, "answer_count": 8, "score": 0, "last_activity_date": 1533901380, "creation_date": 1533763971, "last_edit_date": 1533791189, "question_id": 51755943, "link": "https://stackoverflow.com/questions/51755943/unity-c-class-and-objects", "title": "Unity C# Class and Objects", "body": "<p>Alight, I apologize that this will be a rather dumb question, but I am trying to gain a full understanding of the purpose and use of objects. Specifically I am working in Unity, but I am not sure that this matters. Also, I should also mention that the language is rather overwhelming. But here is the simple example that I am working on.</p>\n\n<pre><code>public class Player : MonoBehaviour \n{\n    private string name = \"Players Name\";\n\n    private void Start () {\n        var nexus = new Player();\n    }\n\n    public static void Using() {\n        // how are these different?\n        Attack();\n        this.Attack();\n    }\n\n    public static void Move() {\n        print (\"The player is moving\"); \n    }\n\n    private void Attack () {\n        print (\"The player is attacking\"); \n    }\n}\n\npublic class UsingStuff : MonoBehaviour \n{\n    private void Start () {\n        Player.Move();\n    }\n}\n</code></pre>\n\n<p>So here are the questions:</p>\n\n<ol>\n<li>What is the difference between calling a function Attack() versus this.Attack? From a novice perspective, they would seem to do exactly the same thing. However, I am assuming that my example is just too simplistic.</li>\n<li>I created the object of the Player class with the random name nexus. However, when I call a function from a different class I seem to use the class name rather than this variable name. So what is the purpose of creating a variable name?</li>\n</ol>\n\n<p>I will leave it at those two for now, as hopefully that will help with some confusion for some other things.\nThank you for your help.</p>\n"}, {"tags": ["c#", "regex"], "answers": [{"tags": [], "owner": {"reputation": 24411, "user_id": 292411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8fdeba51c2ba145110541a5bb19696?s=128&d=identicon&r=PG&f=1", "display_name": "C.Evenhuis", "link": "https://stackoverflow.com/users/292411/c-evenhuis"}, "is_accepted": false, "score": 0, "last_activity_date": 1533765483, "creation_date": 1533765483, "answer_id": 51756223, "question_id": 51755910, "link": "https://stackoverflow.com/questions/51755910/regex-for-string-with-quotes/51756223#51756223", "title": "Regex for string with quotes", "body": "<p>The problem is with the input data; the value of <code>activityJson</code> has unescaped quotes in it, making it hard to determine where the data ends.</p>\n\n<p>If you are able to change the input data, you should definitely do so. </p>\n\n<p>As an example, in xml double quotes are escaped with <code>&amp;quot;</code>:</p>\n\n<pre><code>&lt;data attrib=\"value with &amp;quot;quotes&amp;quot;\" /&gt;\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 5058197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/135a21aad9dee63ee27bab75056988cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jitendra Singh Rathor", "link": "https://stackoverflow.com/users/5058197/jitendra-singh-rathor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533765483, "creation_date": 1533763805, "question_id": 51755910, "link": "https://stackoverflow.com/questions/51755910/regex-for-string-with-quotes", "title": "Regex for string with quotes", "body": "<p>I have a string which is in below format</p>\n\n<pre><code>Key1=\"value1\" Key2=\"value2\" Key3=\"value3\"\n</code></pre>\n\n<p>I want to extract extract keys and values from the string.\n\"value\" can contain new line, single quote, double quotes etc.</p>\n\n<pre><code>s = @\"interactionId=\"\"1f367d11-1f9d-4ff4-9fa3-e793dc0f7fe4\"\" timestamp=\"\"2018-08-07T18:25:38.8309683Z\"\" textPayload=\"\"#\"\" activityJson=\"\"{\n  \"\"type\"\": \"\"conversationUpdate\"\",\n  \"\"id\"\": \"\"e3abig35e395\"\",\n  \"\"timestamp\"\": \"\"2018-08-07T18:25:15.415+00:00\"\",\n  \"\"localTimestamp\"\": \"\"2018-08-07T11:25:15-07:00\"\"\";\n</code></pre>\n\n<p>I was able to write this. but it does work when Value has quotes in it.</p>\n\n<pre><code>var ItemRegex = new Regex(@\"(?&lt;key&gt;[^, ]+)=(?&lt;value&gt;[\"\"].+?[\"\"]|[^ ]+)\", RegexOptions.Multiline);\n\nresult = \n                ItemRegex.Matches(message)\n                .Cast&lt;Match&gt;()\n                .Select(m =&gt; new\n                {\n                    key = m.Groups[\"key\"].ToString().Trim('\"'),\n                    value = m.Groups[\"value\"].ToString().Trim('\"')\n                })\n                .ToDictionary(kvp =&gt; kvp.key, kvp =&gt; kvp.value);\n</code></pre>\n\n<p>How can I escape quotes?</p>\n"}, {"tags": ["c#", "mono", "rider"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 2, "creation_date": 1533763895, "post_id": 51755904, "comment_id": 90471427, "body": "What encoding do the files use?"}, {"owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1533763911, "post_id": 51755904, "comment_id": 90471433, "body": "I&#39;m not that proficient in Linux, but that symbol typically represents a character that is missing in your font or character set.  If unicode characters are in use, then make sure you are using UTF-8 instead of ASCII, and that the font you are using supports those international characters."}, {"owner": {"reputation": 4365, "user_id": 504331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f04eb63c5350fbf814d05377a7768ae7?s=128&d=identicon&r=PG&f=1", "display_name": "JSBach", "link": "https://stackoverflow.com/users/504331/jsbach"}, "reply_to_user": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 0, "creation_date": 1533763990, "post_id": 51755904, "comment_id": 90471449, "body": "@SLaks updated the question: they usw Windows-1252"}, {"owner": {"reputation": 4365, "user_id": 504331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f04eb63c5350fbf814d05377a7768ae7?s=128&d=identicon&r=PG&f=1", "display_name": "JSBach", "link": "https://stackoverflow.com/users/504331/jsbach"}, "reply_to_user": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1533764019, "post_id": 51755904, "comment_id": 90471464, "body": "@ElementalPete True, but this is a compile error."}, {"owner": {"reputation": 18739, "user_id": 4003407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bb6a20caae0ab19fe7eab3ac3f74fb?s=128&d=identicon&r=PG&f=1", "display_name": "user4003407", "link": "https://stackoverflow.com/users/4003407/user4003407"}, "edited": false, "score": 0, "creation_date": 1533764682, "post_id": 51755904, "comment_id": 90471694, "body": "Did you specify <code>&lt;CodePage&gt;1252&lt;&#47;CodePage&gt;</code> in you <code>.csproj</code> file?"}, {"owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1533764706, "post_id": 51755904, "comment_id": 90471705, "body": "So it seems like Linux is not handling the Windows encoding properly.  See this link for techniques to change the file&#39;s encoding: <a href=\"https://stackoverflow.com/questions/2014069/windows-1252-to-utf-8-encoding\" title=\"windows 1252 to utf 8 encoding\">stackoverflow.com/questions/2014069/&hellip;</a>"}, {"owner": {"reputation": 4365, "user_id": 504331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f04eb63c5350fbf814d05377a7768ae7?s=128&d=identicon&r=PG&f=1", "display_name": "JSBach", "link": "https://stackoverflow.com/users/504331/jsbach"}, "reply_to_user": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1533770917, "post_id": 51755904, "comment_id": 90473364, "body": "@ElementalPete I cannot change the file encoding because windows users are using them."}], "owner": {"reputation": 4365, "user_id": 504331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f04eb63c5350fbf814d05377a7768ae7?s=128&d=identicon&r=PG&f=1", "display_name": "JSBach", "link": "https://stackoverflow.com/users/504331/jsbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533763991, "creation_date": 1533763746, "last_edit_date": 1533763991, "question_id": 51755904, "link": "https://stackoverflow.com/questions/51755904/unexpected-character-when-compiling-c-with-special-characters-on-linux", "title": "Unexpected character &#39;\ufffd&#39; when compiling C# with special characters on linux", "body": "<p>I just downloaded Mono, Jetbrains Rider and cloned a c# (private) github project.</p>\n\n<p>This project was written in Windows and use Windows-1252 encoding and the source code contains special characters  (\u00e1, \u00e7, \u00e3, etc). \nIf I try to build this project (both using Rider os MSBuild on bash), I get </p>\n\n<blockquote>\n  <p>MyFile.cs(16, 3): [CS1056] Unexpected character '\ufffd'\n  I configured Rider so it shows the file correctly, but making </p>\n</blockquote>\n\n<pre><code>cat MyFile.cs\n</code></pre>\n\n<p>Shows the \ufffd mark symbol.</p>\n\n<p><strong>Is there anything I have to set on Rider / MSBuild so it reads the files correctly?</strong></p>\n"}, {"tags": ["c#", ".net", "msbuild", "roslyn"], "comments": [{"owner": {"reputation": 2633, "user_id": 5359302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4edae8a9b44323b8b6908d4b0d410730?s=128&d=identicon&r=PG&f=1", "display_name": "George Alexandria", "link": "https://stackoverflow.com/users/5359302/george-alexandria"}, "edited": false, "score": 0, "creation_date": 1533800172, "post_id": 51755892, "comment_id": 90481420, "body": "It would be very useful if you will put a .proj file. Also did you try to create compilation for you project by hand? I mean add all trees, references and put the specific options. Did this compilation have diagnostics?"}, {"owner": {"reputation": 19162, "user_id": 1142970, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/3dce6a26e6a1d06a1aa280ef279fc60c?s=128&d=identicon&r=PG", "display_name": "ChaseMedallion", "link": "https://stackoverflow.com/users/1142970/chasemedallion"}, "reply_to_user": {"reputation": 2633, "user_id": 5359302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4edae8a9b44323b8b6908d4b0d410730?s=128&d=identicon&r=PG&f=1", "display_name": "George Alexandria", "link": "https://stackoverflow.com/users/5359302/george-alexandria"}, "edited": false, "score": 0, "creation_date": 1533819436, "post_id": 51755892, "comment_id": 90493958, "body": "@GeorgeAlexandria thanks for commenting. I&#39;ve added an anonymized version of the csproj to the post. Also, as you&#39;ve suggested I tried creating the compilation manually by adding all .cs files and metadata references. This also broke. However, I then switched from the facades directory to the directory for the current framework install and that worked!"}, {"owner": {"reputation": 2633, "user_id": 5359302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4edae8a9b44323b8b6908d4b0d410730?s=128&d=identicon&r=PG&f=1", "display_name": "George Alexandria", "link": "https://stackoverflow.com/users/5359302/george-alexandria"}, "edited": false, "score": 0, "creation_date": 1533827531, "post_id": 51755892, "comment_id": 90499690, "body": "It&#39;s well news, that it works when you add references from the framework directory. I saw that <code>MsBuildWorkspace</code> gave to you diagnostic during parse the solution. I suggest try to fix diagnostics using the same nuget version with your VS or adding a binding redirection."}], "owner": {"reputation": 19162, "user_id": 1142970, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/3dce6a26e6a1d06a1aa280ef279fc60c?s=128&d=identicon&r=PG", "display_name": "ChaseMedallion", "link": "https://stackoverflow.com/users/1142970/chasemedallion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 647, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1533822430, "creation_date": 1533763685, "last_edit_date": 1533822430, "question_id": 51755892, "link": "https://stackoverflow.com/questions/51755892/errors-with-core-types-when-compiling-a-solution-using-roslyn", "title": "Errors with core types when compiling a solution using Roslyn", "body": "<p>I am trying to compile a solution with several C# projects targeting .NET Framework 4.6 using Roslyn (Microsoft.CodeAnalysis.CSharp 2.8.2 and friends).</p>\n\n<p>The solution in question builds fine in VS2017, but when I try to compile through Roslyn I get loads of errors about basic core types like \"The type or namespace name 'AssemblyTitleAttribute' could not be found\".</p>\n\n<p>EDIT: perhaps more importantly, there are diagnostics emitted by the MSBuildWorkspace itself once the solution is opened. They look like this:</p>\n\n<blockquote>\n  <p>Msbuild failed when processing the file\n  'C:\\dev\\MySolution\\My.Assembly.Name\\My.Assembly.Name.csproj' with\n  message: C:\\Program Files (x86)\\Microsoft Visual\n  Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets:\n  (1603, 5): The \"GetReferenceNearestTargetFrameworkTask\" task could not\n  be instantiated from the assembly \"C:\\Program Files (x86)\\Microsoft\n  Visual\n  Studio\\2017\\Professional\\Common7\\IDE\\CommonExtensions\\Microsoft\\NuGet\\NuGet.Build.Tasks.dll\".\n  Please verify the task assembly has been built using the same version\n  of the Microsoft.Build.Framework assembly as the one installed on your\n  computer and that your host application is not missing a binding\n  redirect for Microsoft.Build.Framework. Unable to cast object of type\n  'NuGet.Build.Tasks.GetReferenceNearestTargetFrameworkTask' to type\n  'Microsoft.Build.Framework.ITask'. C:\\Program Files (x86)\\Microsoft\n  Visual\n  Studio\\2017\\Professional\\MSBuild\\15.0\\Bin\\Microsoft.Common.CurrentVersion.targets:\n  (1603, 5): The \"GetReferenceNearestTargetFrameworkTask\" task has been\n  declared or used incorrectly, or failed during construction. Check the\n  spelling of the task name and the assembly name.</p>\n</blockquote>\n\n<p>Here's the code I'm using:</p>\n\n<pre><code>var solution = await MSBuildWorkspace.Create().OpenSolutionAsync(@\"C:\\path\\to\\solution.sln\");\nvar project = solution.Products.Single(p =&gt; p.Name == \"ProjectName\");\nvar compilation = await project.GetCompilationAsync();\nvar diagnostics = compilation.GetDiagnostics()\n    .Where(d =&gt; !d.IsSuppressed &amp;&amp; d.Severity == DiagnosticSeverity.Error)\n    .ToArray();\nforeach (var diagnostic in diagnostics) { /* print */ }\n</code></pre>\n\n<p><strong>What am I doing wrong?</strong></p>\n\n<p>Things I've tried so far:</p>\n\n<ul>\n<li><p>Adding facade DLL metadata references:</p>\n\n<pre><code>    var metadataReferenceDlls = Directory.GetFiles(@\"C:\\Program Files (x86)\\Reference Assemblies\\Microsoft\\Framework\\.NETFramework\\v4.6\\Facades\\\", \"*.dll\");\n    var metadataReferences = metadataReferenceDlls.Select(f =&gt; MetadataReference.CreateFromFile(f)).ToArray();\n    foreach (var projectId in solution.ProjectIds.ToArray())\n    {\n        solution = solution.AddMetadataReferences(projectId, metadataReferences);\n    }\n</code></pre></li>\n<li><p>Adding current runtime metadata references (same as above but with <code>Path.GetDirectoryName(typeof(object).Assembly.Location)</code> as the search path). <em>This Works!</em>. However, it feels non-ideal since I still have to manually parse out all referenced DLLs.</p></li>\n<li><p>Installing Microsoft.Build.Locator and calling <code>MSBuildLocator.RegisterDefaults();</code> upfront</p></li>\n</ul>\n\n<p>Also posted on Roslyn's GitHub here: <a href=\"https://github.com/dotnet/roslyn/issues/29170\" rel=\"nofollow noreferrer\">https://github.com/dotnet/roslyn/issues/29170</a></p>\n\n<p>EDIT: As requested, here is the csproj:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Project ToolsVersion=\"12.0\" DefaultTargets=\"Build\" xmlns=\"http://schemas.microsoft.com/developer/msbuild/2003\"&gt;\n  &lt;Import Project=\"..\\packages\\GitLink.3.1.0\\build\\GitLink.props\" Condition=\"Exists('..\\packages\\GitLink.3.1.0\\build\\GitLink.props')\" /&gt;\n  &lt;PropertyGroup&gt;\n    &lt;Configuration Condition=\" '$(Configuration)' == '' \"&gt;Debug&lt;/Configuration&gt;\n    &lt;Platform Condition=\" '$(Platform)' == '' \"&gt;AnyCPU&lt;/Platform&gt;\n    &lt;ProjectGuid&gt;{C768D1C6-3C45-4170-A4DB-B05B7F833181}&lt;/ProjectGuid&gt;\n    &lt;OutputType&gt;Library&lt;/OutputType&gt;\n    &lt;AppDesignerFolder&gt;Properties&lt;/AppDesignerFolder&gt;\n    &lt;RootNamespace&gt;My.Assembly.Name&lt;/RootNamespace&gt;\n    &lt;AssemblyName&gt;My.Assembly.Name&lt;/AssemblyName&gt;\n    &lt;TargetFrameworkVersion&gt;v4.6&lt;/TargetFrameworkVersion&gt;\n    &lt;FileAlignment&gt;512&lt;/FileAlignment&gt;\n    &lt;SolutionDir Condition=\"$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'\"&gt;..\\&lt;/SolutionDir&gt;\n    &lt;RestorePackages&gt;true&lt;/RestorePackages&gt;\n    &lt;NuGetPackageImportStamp&gt;\n    &lt;/NuGetPackageImportStamp&gt;\n    &lt;TargetFrameworkProfile /&gt;\n    &lt;CodeAnalysisRuleSet&gt;$(SolutionDir)\\StyleCop.ruleset&lt;/CodeAnalysisRuleSet&gt;\n    &lt;GitLinkEnabled&gt;true&lt;/GitLinkEnabled&gt;\n    &lt;GitLinkGitRemoteUrl&gt;http://gitlink/{revision}/{filename}&lt;/GitLinkGitRemoteUrl&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' \"&gt;\n    &lt;DebugSymbols&gt;true&lt;/DebugSymbols&gt;\n    &lt;DebugType&gt;full&lt;/DebugType&gt;\n    &lt;Optimize&gt;false&lt;/Optimize&gt;\n    &lt;OutputPath&gt;bin\\Debug\\&lt;/OutputPath&gt;\n    &lt;DefineConstants&gt;DEBUG;TRACE&lt;/DefineConstants&gt;\n    &lt;ErrorReport&gt;prompt&lt;/ErrorReport&gt;\n    &lt;WarningLevel&gt;4&lt;/WarningLevel&gt;\n    &lt;DocumentationFile&gt;bin\\Debug\\My.Assembly.Name.XML&lt;/DocumentationFile&gt;\n    &lt;NoWarn&gt;1570, 1571, 1572, 1573, 1574, 1580, 1581, 1584, 1587, 1589, 1590, 1591, 1592, 1598, 1710, 1711, 1712, 1723&lt;/NoWarn&gt;\n    &lt;TreatWarningsAsErrors&gt;true&lt;/TreatWarningsAsErrors&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;PropertyGroup Condition=\" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' \"&gt;\n    &lt;DebugType&gt;pdbonly&lt;/DebugType&gt;\n    &lt;Optimize&gt;true&lt;/Optimize&gt;\n    &lt;OutputPath&gt;bin\\Release\\&lt;/OutputPath&gt;\n    &lt;DefineConstants&gt;TRACE&lt;/DefineConstants&gt;\n    &lt;ErrorReport&gt;prompt&lt;/ErrorReport&gt;\n    &lt;WarningLevel&gt;4&lt;/WarningLevel&gt;\n  &lt;/PropertyGroup&gt;\n  &lt;ItemGroup&gt;\n    &lt;Reference Include=\"EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL\"&gt;\n      &lt;SpecificVersion&gt;False&lt;/SpecificVersion&gt;\n      &lt;HintPath&gt;..\\packages\\EntityFramework.6.1.3\\lib\\net45\\EntityFramework.dll&lt;/HintPath&gt;\n    &lt;/Reference&gt;\n    &lt;Reference Include=\"EntityFramework.SqlServer, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL\"&gt;\n      &lt;SpecificVersion&gt;False&lt;/SpecificVersion&gt;\n      &lt;HintPath&gt;..\\packages\\EntityFramework.6.1.3\\lib\\net45\\EntityFramework.SqlServer.dll&lt;/HintPath&gt;\n    &lt;/Reference&gt;\n    &lt;Reference Include=\"Newtonsoft.Json, Version=9.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed, processorArchitecture=MSIL\"&gt;\n      &lt;HintPath&gt;..\\packages\\Newtonsoft.Json.9.0.1\\lib\\net45\\Newtonsoft.Json.dll&lt;/HintPath&gt;\n      &lt;Private&gt;True&lt;/Private&gt;\n    &lt;/Reference&gt;\n    &lt;Reference Include=\"RazorEngine, Version=3.5.0.0, Culture=neutral, PublicKeyToken=9ee697374c7e744a, processorArchitecture=MSIL\"&gt;\n      &lt;SpecificVersion&gt;False&lt;/SpecificVersion&gt;\n      &lt;HintPath&gt;..\\packages\\RazorEngine.3.4.2\\lib\\net45\\RazorEngine.dll&lt;/HintPath&gt;\n    &lt;/Reference&gt;\n    &lt;Reference Include=\"System\" /&gt;\n    &lt;Reference Include=\"System.ComponentModel.DataAnnotations\" /&gt;\n    &lt;Reference Include=\"System.Configuration\" /&gt;\n    &lt;Reference Include=\"System.Core\" /&gt;\n    &lt;Reference Include=\"System.Data.Entity.Design\" /&gt;\n    &lt;Reference Include=\"System.Data.DataSetExtensions\" /&gt;\n    &lt;Reference Include=\"Microsoft.CSharp\" /&gt;\n    &lt;Reference Include=\"System.Data\" /&gt;\n    &lt;Reference Include=\"System.Web.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL\"&gt;\n      &lt;SpecificVersion&gt;False&lt;/SpecificVersion&gt;\n      &lt;HintPath&gt;..\\packages\\Microsoft.AspNet.Razor.3.1.1\\lib\\net45\\System.Web.Razor.dll&lt;/HintPath&gt;\n    &lt;/Reference&gt;\n    &lt;Reference Include=\"System.Xml\" /&gt;\n  &lt;/ItemGroup&gt;\n  &lt;ItemGroup&gt;\n    &lt;!-- long list of files --&gt;\n    &lt;Compile Include=\"File1.cs\" /&gt;\n    &lt;Compile Include=\"File2.cs\" /&gt;\n  &lt;/ItemGroup&gt;\n  &lt;ItemGroup&gt;\n    &lt;None Include=\"App.config\"&gt;\n      &lt;SubType&gt;Designer&lt;/SubType&gt;\n    &lt;/None&gt;\n    &lt;None Include=\"packages.config\"&gt;\n      &lt;SubType&gt;Designer&lt;/SubType&gt;\n    &lt;/None&gt;\n  &lt;/ItemGroup&gt;\n  &lt;ItemGroup&gt;\n    &lt;ProjectReference Include=\"..\\My.OtherProject.Name\\My.OtherProject.Name.csproj\"&gt;\n      &lt;Project&gt;{96b3bcc3-9052-403e-97ca-44eef392ee15}&lt;/Project&gt;\n      &lt;Name&gt;My.OtherProject.Name&lt;/Name&gt;\n    &lt;/ProjectReference&gt;\n  &lt;/ItemGroup&gt;\n  &lt;ItemGroup&gt;\n    &lt;Analyzer Include=\"..\\packages\\StyleCop.Analyzers.1.1.0-beta007\\analyzers\\dotnet\\cs\\StyleCop.Analyzers.CodeFixes.dll\" /&gt;\n    &lt;Analyzer Include=\"..\\packages\\StyleCop.Analyzers.1.1.0-beta007\\analyzers\\dotnet\\cs\\StyleCop.Analyzers.dll\" /&gt;\n  &lt;/ItemGroup&gt;\n  &lt;Import Project=\"$(MSBuildToolsPath)\\Microsoft.CSharp.targets\" /&gt;\n  &lt;!-- To modify your build process, add your task inside one of the targets below and uncomment it. \n       Other similar extension points exist, see Microsoft.Common.targets.\n  &lt;Target Name=\"BeforeBuild\"&gt;\n  &lt;/Target&gt;\n  &lt;Target Name=\"AfterBuild\"&gt;\n  &lt;/Target&gt;\n  --&gt;\n  &lt;Target Name=\"EnsureNuGetPackageBuildImports\" BeforeTargets=\"PrepareForBuild\"&gt;\n    &lt;PropertyGroup&gt;\n      &lt;ErrorText&gt;This project references NuGet package(s) that are missing on this computer. Enable NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105. The missing file is {0}.&lt;/ErrorText&gt;\n    &lt;/PropertyGroup&gt;\n    &lt;Error Condition=\"!Exists('..\\packages\\GitLink.3.1.0\\build\\GitLink.props')\" Text=\"$([System.String]::Format('$(ErrorText)', '..\\packages\\GitLink.3.1.0\\build\\GitLink.props'))\" /&gt;\n    &lt;Error Condition=\"!Exists('..\\packages\\GitLink.3.1.0\\build\\GitLink.targets')\" Text=\"$([System.String]::Format('$(ErrorText)', '..\\packages\\GitLink.3.1.0\\build\\GitLink.targets'))\" /&gt;\n  &lt;/Target&gt;\n  &lt;Import Project=\"..\\packages\\GitLink.3.1.0\\build\\GitLink.targets\" Condition=\"Exists('..\\packages\\GitLink.3.1.0\\build\\GitLink.targets')\" /&gt;\n&lt;/Project&gt;\n</code></pre>\n"}, {"tags": ["c#", "winforms", "azure", "azure-keyvault"], "comments": [{"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "edited": false, "score": 0, "creation_date": 1533949846, "post_id": 51755847, "comment_id": 90548661, "body": "Storing the key on end user client machine is not secure."}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 1, "creation_date": 1533968975, "post_id": 51755847, "comment_id": 90551209, "body": "You could use ProtectedData <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/security/how-to-use-data-protection\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/standard/security/&hellip;</a> it uses the logged in user&#39;s credentials as the encryption key, so you can only read data in a session opened by this user. Many apps use this."}], "answers": [{"comments": [{"owner": {"reputation": 10768, "user_id": 1592821, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/683f82a14ba9c318ef99ca8268826422?s=128&d=identicon&r=PG", "display_name": "Kirsten Greed", "link": "https://stackoverflow.com/users/1592821/kirsten-greed"}, "edited": false, "score": 0, "creation_date": 1533954368, "post_id": 51795480, "comment_id": 90549244, "body": "How would I store a connection string for a winforms app in Azure AD?"}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "reply_to_user": {"reputation": 10768, "user_id": 1592821, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/683f82a14ba9c318ef99ca8268826422?s=128&d=identicon&r=PG", "display_name": "Kirsten Greed", "link": "https://stackoverflow.com/users/1592821/kirsten-greed"}, "edited": false, "score": 1, "creation_date": 1533967024, "post_id": 51795480, "comment_id": 90550797, "body": "To use Windows Authentication, it&#39;s not necessary to create an <a href=\"https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-whatis\" rel=\"nofollow noreferrer\">Azure Active Directory</a>. If you have on premises Active Directory, your client machine should join to the same active directory and login to the same domain.Also your on premises SQL Server should be joined to the same domain and allows <a href=\"https://docs.microsoft.com/en-us/sql/relational-databases/security/choose-an-authentication-mode?view=sql-server-2017#connecting-through-windows-authentication\" rel=\"nofollow noreferrer\">Windows Authentication</a>."}, {"owner": {"reputation": 10768, "user_id": 1592821, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/683f82a14ba9c318ef99ca8268826422?s=128&d=identicon&r=PG", "display_name": "Kirsten Greed", "link": "https://stackoverflow.com/users/1592821/kirsten-greed"}, "edited": false, "score": 0, "creation_date": 1533967294, "post_id": 51795480, "comment_id": 90550853, "body": "What if I am using Azure SQL Server?"}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "reply_to_user": {"reputation": 10768, "user_id": 1592821, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/683f82a14ba9c318ef99ca8268826422?s=128&d=identicon&r=PG", "display_name": "Kirsten Greed", "link": "https://stackoverflow.com/users/1592821/kirsten-greed"}, "edited": false, "score": 1, "creation_date": 1533967796, "post_id": 51795480, "comment_id": 90550947, "body": "Then to use Windows Authentication, you need Azure AD. Take a look at <a href=\"https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication-configure\" rel=\"nofollow noreferrer\">Configure and manage Azure Active Directory authentication with SQL Database, Managed Instance, or SQL Data Warehouse</a>. If users are logged in to the same directory, they can use active directory integrated authentication, if they are not logged in but they have a domain user name and password, then can provide the domain username and domain password to your application and use active directory password authentication."}], "tags": [], "owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "is_accepted": true, "score": 1, "last_activity_date": 1533948509, "last_edit_date": 1533948509, "creation_date": 1533948028, "answer_id": 51795480, "question_id": 51755847, "link": "https://stackoverflow.com/questions/51755847/secure-place-to-store-authclientsecret-for-a-winforms-app/51795480#51795480", "title": "Secure place to store AuthClientSecret for a winforms app?", "body": "<p>Storing the key on end user client machine is not secure. </p>\n\n<p>If your application directly connects to database from your client machines, then you need to use Windows Authentication. (No need to use Azure KeyVault. Instead you may want to use Azure AD).</p>\n\n<p>If your application connects to a remote service like a Web API hosted on Azure App Service, you need to store the client secret of Azure Vault in Application Settings in Azure portal. Then if you need to secure data-access, again you need an authentication and authorization mechanism.</p>\n"}], "owner": {"reputation": 10768, "user_id": 1592821, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/683f82a14ba9c318ef99ca8268826422?s=128&d=identicon&r=PG", "display_name": "Kirsten Greed", "link": "https://stackoverflow.com/users/1592821/kirsten-greed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 51795480, "answer_count": 1, "score": 2, "last_activity_date": 1534053730, "creation_date": 1533763448, "last_edit_date": 1534053730, "question_id": 51755847, "link": "https://stackoverflow.com/questions/51755847/secure-place-to-store-authclientsecret-for-a-winforms-app", "title": "Secure place to store AuthClientSecret for a winforms app?", "body": "<p>I was thinking of using Azure KeyVault to store my connection string instead of App.Config </p>\n\n<p>However in order to access the key vault I understand I would need to use the AuthClientSecret.</p>\n\n<p>So where should I store that?  If I store it in app.config wouldn't it be like storing a key to a key?</p>\n"}, {"tags": ["c#", "wpf", "lambda", "listbox"], "comments": [{"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1533763561, "post_id": 51755820, "comment_id": 90471310, "body": "The last statement of the question is confusing. Can you explain what exactly you are trying to do here? And what issue you are facing with this code ?"}, {"owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1533763663, "post_id": 51755820, "comment_id": 90471350, "body": "What framework are you using?  Winforms?  WPF? Asp.Net MVC?"}, {"owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "edited": false, "score": 0, "creation_date": 1533763768, "post_id": 51755820, "comment_id": 90471389, "body": "I am using the WPF framework."}, {"owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "reply_to_user": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1533764019, "post_id": 51755820, "comment_id": 90471463, "body": "@ChetanRanpariya I am trying to check if the selected item match the Ayanlune enum from the Player.Crystals. The list is made of all the Player.Crystals that has been stored in the CrystalHeld attribute."}, {"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1533764092, "post_id": 51755820, "comment_id": 90471479, "body": "And what issue you are facing with this code ;"}, {"owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "edited": false, "score": 0, "creation_date": 1533764194, "post_id": 51755820, "comment_id": 90471518, "body": "if (CrystalsHeldBox2.SelectedItem == Player.CrystalsHeld.Find(item =&gt; item == Player.Crystals.Ayanlune)) does not seem to work, it returns Operator == cannot be applied to operands of type &#39;object&#39; and &#39;Player.Crystals&#39;"}, {"owner": {"reputation": 69330, "user_id": 1612975, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nVzDH.png?s=128&g=1", "display_name": "TheGeneral", "link": "https://stackoverflow.com/users/1612975/thegeneral"}, "edited": false, "score": 0, "creation_date": 1533764236, "post_id": 51755820, "comment_id": 90471532, "body": "What is the type in CrystalsHeldBox2? Crystals ?"}, {"owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "edited": false, "score": 0, "creation_date": 1533764299, "post_id": 51755820, "comment_id": 90471547, "body": "ListBox CrystalsHeldBox2 = new ListBox(); CrystalsHeldBox2.ItemsSource = Player.CrystalsHeld;"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "edited": false, "score": 0, "creation_date": 1533764477, "post_id": 51756006, "comment_id": 90471626, "body": "Cannot convert from &#39;object&#39; to &#39;Game.Player.Crystals&#39;"}, {"owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "edited": false, "score": 0, "creation_date": 1533764628, "post_id": 51756006, "comment_id": 90471679, "body": "But this wouldn&#39;t work for me. I want to use this like a switch. Meaning there might be many different Crystals that are contained in it. I need to check if that specific crystal is selected. In sum, I&#39;m listing all of the crystals the player have in the box, then the player can select the one they want and press a button and that button checks which one was selected and return true for that one."}, {"owner": {"reputation": 86752, "user_id": 87399, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/6rBH5.png?s=128&g=1", "display_name": "Joe White", "link": "https://stackoverflow.com/users/87399/joe-white"}, "reply_to_user": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "edited": false, "score": 0, "creation_date": 1533826360, "post_id": 51756006, "comment_id": 90498839, "body": "You&#39;re right, I added the cast. As for your second comment - isn&#39;t that exactly what this code does? You choose a specific crystal type that you&#39;re currently interested in (<code>CrystalsHeldBox2.SelectedItem</code>), and you want to see whether that crystal is in the player&#39;s list (<code>Contains</code>)."}, {"owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "edited": false, "score": 0, "creation_date": 1533913533, "post_id": 51756006, "comment_id": 90535940, "body": "I think I had badly explained, my apologies. I have a list and I select an item in the list. I want to see if that item match a specific one. I&#39;ve figured it out. <code>if (CrystalsHeldBox2.SelectedItem.Equals(Player.Crystals.Ayanlu&zwnj;&#8203;ne))</code> but thanks for the information on cast, I didn&#39;t know I could do that."}], "tags": [], "owner": {"reputation": 86752, "user_id": 87399, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/6rBH5.png?s=128&g=1", "display_name": "Joe White", "link": "https://stackoverflow.com/users/87399/joe-white"}, "is_accepted": false, "score": 0, "last_activity_date": 1533826175, "last_edit_date": 1533826175, "creation_date": 1533764305, "answer_id": 51756006, "question_id": 51755820, "link": "https://stackoverflow.com/questions/51755820/c-check-if-an-listenum-item-is-selected-in-a-listbox-and-if-so-return-true/51756006#51756006", "title": "C# Check if an List&lt;enum&gt; item is selected in a listbox and if so return true", "body": "<p>I don't think you need LINQ for this. A simple <a href=\"https://msdn.microsoft.com/en-us/library/bhkz42b3(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>List&lt;T&gt;.Contains</code></a> should do:</p>\n\n<pre><code>if (Player.CrystalsHeld.Contains((Crystals) CrystalsHeldBox2.SelectedItem))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "edited": false, "score": 0, "creation_date": 1533764763, "post_id": 51756037, "comment_id": 90471729, "body": "I have a listbox uielement that has the elements contained in CrystalHeld List&lt;Crystals&gt; being displayed. I want to check if the one being selected matches a specific one."}], "tags": [], "owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "is_accepted": false, "score": 0, "last_activity_date": 1533764521, "creation_date": 1533764521, "answer_id": 51756037, "question_id": 51755820, "link": "https://stackoverflow.com/questions/51755820/c-check-if-an-listenum-item-is-selected-in-a-listbox-and-if-so-return-true/51756037#51756037", "title": "C# Check if an List&lt;enum&gt; item is selected in a listbox and if so return true", "body": "<p><code>CrystalsHeld</code> is a <code>List</code>, not a <code>ListBox</code>.  A <code>ListBox</code> is a UI control, while a <code>List</code> is a C# collection.</p>\n\n<p>You can check if a <code>List</code> contains an object like this:</p>\n\n<pre><code>if (CrystalsHeld.Contains(CrystalsHeldBox2.SelectedItem))\n{\n    // Do Stuff\n}\n</code></pre>\n\n<p>If it is actually a <code>ListBox</code>, then that control has an <code>Items</code> property that contains what is in the <code>ListBox</code>.  You can get to it in code behind like:</p>\n\n<pre><code>if (CrystalsHeld.Items.Contains(CrystalsHeldBox2.SelectedItem))\n{\n    // Do Stuff\n}\n</code></pre>\n\n<p>Or if you are using MVVM, you can bind the control's <code>Items</code> property to a property in your ViewModel and so something similar.</p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "is_accepted": false, "score": 0, "last_activity_date": 1533767353, "creation_date": 1533767353, "answer_id": 51756531, "question_id": 51755820, "link": "https://stackoverflow.com/questions/51755820/c-check-if-an-listenum-item-is-selected-in-a-listbox-and-if-so-return-true/51756531#51756531", "title": "C# Check if an List&lt;enum&gt; item is selected in a listbox and if so return true", "body": "<p>So! I figured it out! I needed to do Equals:</p>\n\n<pre><code>if (CrystalsHeldBox2.SelectedItem.Equals(Player.Crystals.Ayanlune))\n                {\n                    AddInline(\"This is the right object!\");\n                }\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 9902665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LtB0JEaqjxM/AAAAAAAAAAI/AAAAAAAAAIA/5ZGOxRU3LTE/photo.jpg?sz=128", "display_name": "Mathias Chartier", "link": "https://stackoverflow.com/users/9902665/mathias-chartier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 730, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1533826175, "creation_date": 1533763342, "last_edit_date": 1533767728, "question_id": 51755820, "link": "https://stackoverflow.com/questions/51755820/c-check-if-an-listenum-item-is-selected-in-a-listbox-and-if-so-return-true", "title": "C# Check if an List&lt;enum&gt; item is selected in a listbox and if so return true", "body": "<p>I am trying to validate if an Item which is part of an Enum list is selected in a checkbox.</p>\n\n<p>I am trying something like this:</p>\n\n<pre><code>if (CrystalsHeldBox2.SelectedItem == Player.CrystalsHeld.Find(item =&gt; item == Player.Crystals.Ayanlune))\n</code></pre>\n\n<p>It is part of a class as follows:</p>\n\n<pre><code>[JsonProperty(\"CrystalsHeld\")]\npublic List&lt;Crystals&gt; CrystalsHeld { get; set; }\n\n[JsonProperty(\"RV\")]\npublic List&lt;string&gt; RV { get; set; }\n\npublic Player()\n{\n    Inventory = new List&lt;Item&gt;();\n    CrystalsHeld = new List&lt;Crystals&gt;();\n    RV = new List&lt;string&gt;();\n}\n\npublic enum Crystals : int\n{\n    Ayanlune = 1\n}\n</code></pre>\n\n<p>Basically I want to do something like this:\nIf Ayanlune Crystal is in the Listbox that displays all of the player CrystalsHeld, be true.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 2942, "user_id": 4436077, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/958db005e9c5216e82e4e346174bb6bb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4436077/alex"}, "edited": false, "score": 0, "creation_date": 1533763375, "post_id": 51755771, "comment_id": 90471245, "body": "What is wrong with what you have done?"}, {"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 1, "creation_date": 1533763399, "post_id": 51755771, "comment_id": 90471255, "body": "Why different classes? Do they have anything different from each other?"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1533763432, "post_id": 51755771, "comment_id": 90471270, "body": "Your generic class is missing the definition of <code>T</code>: <code>class MyTreeClass&lt;T&gt;</code>"}, {"owner": {"reputation": 14371, "user_id": 321866, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/25e93a50d485eca289f887868e1bcea5?s=128&d=identicon&r=PG", "display_name": "C Johnson", "link": "https://stackoverflow.com/users/321866/c-johnson"}, "edited": false, "score": 0, "creation_date": 1533764418, "post_id": 51755771, "comment_id": 90471602, "body": "Is this question for homework?"}, {"owner": {"reputation": 32638, "user_id": 2052655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mWqp.jpg?s=128&g=1", "display_name": "Rufus L", "link": "https://stackoverflow.com/users/2052655/rufus-l"}, "edited": false, "score": 0, "creation_date": 1533764451, "post_id": 51755771, "comment_id": 90471619, "body": "You should probably modify your example if you are really looking for a tree structure that holds different types. The way you have it presented, all three types are identical."}, {"owner": {"reputation": 496, "user_id": 1364233, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8179438b701f80c9d298e378449683b2?s=128&d=identicon&r=PG", "display_name": "AlexS", "link": "https://stackoverflow.com/users/1364233/alexs"}, "reply_to_user": {"reputation": 2942, "user_id": 4436077, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/958db005e9c5216e82e4e346174bb6bb?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4436077/alex"}, "edited": false, "score": 0, "creation_date": 1533770243, "post_id": 51755771, "comment_id": 90473195, "body": "@Alex The issue with what I have done is that the  MyTreeClass syntax does not compile, and generic type T does not exit because its not been declared."}, {"owner": {"reputation": 496, "user_id": 1364233, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8179438b701f80c9d298e378449683b2?s=128&d=identicon&r=PG", "display_name": "AlexS", "link": "https://stackoverflow.com/users/1364233/alexs"}, "reply_to_user": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1533770368, "post_id": 51755771, "comment_id": 90473231, "body": "@ChetanRanpariya the classes are different because they perform very different functions, but it will be helpful to arrange them in a tree data structure."}, {"owner": {"reputation": 496, "user_id": 1364233, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8179438b701f80c9d298e378449683b2?s=128&d=identicon&r=PG", "display_name": "AlexS", "link": "https://stackoverflow.com/users/1364233/alexs"}, "reply_to_user": {"reputation": 14371, "user_id": 321866, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/25e93a50d485eca289f887868e1bcea5?s=128&d=identicon&r=PG", "display_name": "C Johnson", "link": "https://stackoverflow.com/users/321866/c-johnson"}, "edited": false, "score": 0, "creation_date": 1533770443, "post_id": 51755771, "comment_id": 90473244, "body": "@CJohnson No it isn&#39;t homework, I&#39;m 35, i code in my spare time not professionally."}], "answers": [{"tags": [], "owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "is_accepted": false, "score": 1, "last_activity_date": 1533764289, "creation_date": 1533764289, "answer_id": 51756001, "question_id": 51755771, "link": "https://stackoverflow.com/questions/51755771/how-to-define-an-inheritable-tree-class-in-c-to-build-tree-like-data-structure/51756001#51756001", "title": "How to define an inheritable tree class in C# to build tree like data structure made from different class types?", "body": "<p>You might be looking for the <a href=\"https://en.wikipedia.org/wiki/Composite_pattern\" rel=\"nofollow noreferrer\">composite pattern</a> which is a common way to model tree structures, e.g. a file system where you have a leaves (files) and containers (folders) and containers can contain other containers or leaves themselves.</p>\n\n<p>In your case, at least the way you described it so far, it is a bit simpler because there is no behavioral difference between those nodes. So for your structure, the nodes can actually be shallow and you only need to implement the composition within your base class. In that way, you don\u2019t have leaves but only (different) containers.</p>\n\n<pre><code>public abstract class BaseNode\n{\n    public IList&lt;BaseNode&gt; Children\n    { get; } = new List&lt;BaseNode&gt;();\n}\n\npublic class NodeClassA : BaseNode { }\npublic class NodeClassB : BaseNode { }\npublic class NodeClassC : BaseNode { }\n</code></pre>\n\n<p>And then you can already build your structure.</p>\n"}, {"tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": false, "score": 1, "last_activity_date": 1533817984, "last_edit_date": 1533817984, "creation_date": 1533765909, "answer_id": 51756292, "question_id": 51755771, "link": "https://stackoverflow.com/questions/51755771/how-to-define-an-inheritable-tree-class-in-c-to-build-tree-like-data-structure/51756292#51756292", "title": "How to define an inheritable tree class in C# to build tree like data structure made from different class types?", "body": "<p>This is not possible in a strict type safe way because type safety is ensured at compile time, which requires the types to be statically declared. But the tree is built dynamically at runtime with different node types.</p>\n\n<p>The way to go is to have a static node data type which can be generic. Different types of data can be derived form a given base data type. Use polymorphy to work with them. I.e. use the same set of methods with different implementations.</p>\n\n<pre><code>public class TreeNode&lt;T&gt;\n{\n    public T Data { get; set; }\n\n    private List&lt;TreeNode&lt;T&gt;&gt; _children = new List&lt;TreeNode&lt;T&gt;&gt;();\n    public IEnumerable&lt;TreeNode&lt;T&gt;&gt; Children =&gt; _children;\n\n    public TreeNode&lt;T&gt; AddChild(T data)\n    {\n        var node = new TreeNode&lt;T&gt; { Data = data };\n        _children.Add(node);\n        return node;\n    }\n\n    public void VisitPreOrder(Action&lt;T, int&gt; action, int level)\n    {\n        action(Data, level);\n        foreach (TreeNode&lt;T&gt; node in Children) {\n            node.VisitPreOrder(action, level + 1);\n        }\n    }\n}\n\npublic class Tree&lt;T&gt;\n{\n    public TreeNode&lt;T&gt; Root { get; } = new TreeNode&lt;T&gt;();\n\n    public void VisitPreOrder(Action&lt;T, int&gt; action)\n    {\n        Root.VisitPreOrder(action, 0);\n    }\n}\n</code></pre>\n\n<p>Now you can have data classes that are totally unrelated to the tree:</p>\n\n<pre><code>public class A\n{\n    public int Index { get; set; }\n\n    public virtual void PrintLine()\n    {\n        Console.WriteLine($\"A {Index}\");\n    }\n}\n\npublic class B : A\n{\n    public override void PrintLine()\n    {\n        Console.WriteLine($\"B {Index}\");\n    }\n}\n\npublic class C : B\n{\n    public override void PrintLine()\n    {\n        Console.WriteLine($\"C {Index}\");\n    }\n}\n</code></pre>\n\n<p>Create a tree structure from your example</p>\n\n<pre><code>TreeNode&lt;A&gt; node;\n\nvar tree = new Tree&lt;A&gt;();\ntree.Root.Data = new B { Index = 0 };            // NodeClassB\ntree.Root.AddChild(new C { Index = 1 });         // __NodeClassC\nnode = tree.Root.AddChild(new A { Index = 2 });  // __NodeClassA\nnode.AddChild(new B { Index = 3 });              // ____NodeClassB\nnode.AddChild(new B { Index = 4 });              // ____NodeClassB\nnode.AddChild(new A { Index = 5 });              // ____NodeClassA\nnode = tree.Root.AddChild(new A { Index = 6 });  // __NodeClassA\nnode.AddChild(new C { Index = 7 });              // ____NodeClassC\ntree.Root.AddChild(new B { Index = 8 });         // __NodeClassB\ntree.Root.AddChild(new C { Index = 9 });         // __NodeClassC \n</code></pre>\n\n<p>Because each data type (base type or derived type) does its own thing appropriate for its type, you don't need to know its exact type. This is called polymorphy. This prints the tree structure:</p>\n\n<pre><code>tree.VisitPreOrder((item, level) =&gt; {\n    Console.Write(new string('_', 4 * level));\n    item.PrintLine();\n});\n</code></pre>\n\n<blockquote>\n  <p>B 0<br>\n  ____C 1<br>\n  ____A 2<br>\n  ________B 3<br>\n  ________B 4<br>\n  ________A 5<br>\n  ____A 6<br>\n  ________C 7<br>\n  ____B 8<br>\n  ____C 9</p>\n</blockquote>\n\n<p>Note that you don't need to know the concrete data type of <code>T</code> when declaring the <code>Tree&lt;T&gt;</code> and <code>TreeNode&lt;T&gt;</code> classes since <code>T</code> is generic. You could as well declare</p>\n\n<pre><code>var stringTree = new Tree&lt;string&gt;();\nvar intTree = new Tree&lt;int&gt;();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "is_accepted": false, "score": 0, "last_activity_date": 1533767615, "creation_date": 1533767615, "answer_id": 51756572, "question_id": 51755771, "link": "https://stackoverflow.com/questions/51755771/how-to-define-an-inheritable-tree-class-in-c-to-build-tree-like-data-structure/51756572#51756572", "title": "How to define an inheritable tree class in C# to build tree like data structure made from different class types?", "body": "<p>Just make your arbitrary class inherit or compose a collection of some kind. For example your arbitrary classes could all be lists. The augmentation would be that the add method sets the child's parent and that the parent is a property. </p>\n"}], "owner": {"reputation": 496, "user_id": 1364233, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8179438b701f80c9d298e378449683b2?s=128&d=identicon&r=PG", "display_name": "AlexS", "link": "https://stackoverflow.com/users/1364233/alexs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1533817984, "creation_date": 1533763088, "last_edit_date": 1533764164, "question_id": 51755771, "link": "https://stackoverflow.com/questions/51755771/how-to-define-an-inheritable-tree-class-in-c-to-build-tree-like-data-structure", "title": "How to define an inheritable tree class in C# to build tree like data structure made from different class types?", "body": "<p>I\u2018Ve been reading around this topic for some time, but I simply don't know the C# syntax well enough. Hopefully this is clear to you and you are willing to help me out. The examples I found are tree structures of the same type or class, which are not what I need here.</p>\n\n<p>In short, I want to be able to define an arbitrary class, like NodeClassA, NodeClassB, NodeClassC below and be able to attach any number of these to each other to form a tree data structure as illustrated arbitrarily below.</p>\n\n<p>Each Node should be able to access its parent.</p>\n\n<p>Can anyone help properly define the MyTreeClass below?</p>\n\n<p>NodeClassB <br>\n__NodeClassC <br>\n__NodeClassA <br>\n____NodeClassB <br>\n____NodeClassB <br>\n____NodeClassA <br>\n__NodeClassA <br>\n____NodeClassC <br>\n__NodeClassB <br>\n__NodeClassC <br></p>\n\n<pre><code>class MyTreeClass\n{\n    public void AddChild(T NodeClassX) { }\n    public T GetChild() { }\n}\nclass NodeClassA:MyTreeClass\n{\n    public void foo(int a) { }\n}\n\nclass NodeClassB : MyTreeClass\n{\n    public void foo(int b) { }\n}\n\nclass NodeClassC : MyTreeClass\n{\n    public void foo(int c) { }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "sql-server", "geospatial"], "answers": [{"tags": [], "owner": {"reputation": 12246, "user_id": 214980, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bf7aec50272874960980fd6923cf962c?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/214980/sean"}, "is_accepted": false, "score": 1, "last_activity_date": 1533909184, "last_edit_date": 1533909184, "creation_date": 1533847310, "answer_id": 51775459, "question_id": 51755560, "link": "https://stackoverflow.com/questions/51755560/combine-union-and-simplify-reduce-dbgeometry-records-for-geojson/51775459#51775459", "title": "Combine (union?) and simplify/reduce DbGeometry records for GeoJson", "body": "<p>Looks like this is not possible in SQL Server. </p>\n\n<p>You need to convert the geometries to topologies, then simplify, then match back to the original geometries to preserve the properties/attributes/id/etc.</p>\n\n<p>See: <a href=\"https://trac.osgeo.org/postgis/wiki/UsersWikiSimplifyWithTopologyExt\" rel=\"nofollow noreferrer\">https://trac.osgeo.org/postgis/wiki/UsersWikiSimplifyWithTopologyExt</a></p>\n\n<p>SQL Server doesn't have support for Topologies.</p>\n\n<hr>\n\n<h2>EDIT</h2>\n\n<p>I'm working on the code below, which converts polygons (not multipolygons) to linestrings, unions the linestrings to effectively get a topology layer, then simplifies that. It works really well, but the difficulty is not in converting the multilinestrings to multipolygons, which might need a <a href=\"http://nettopologysuite.github.io/html/class_net_topology_suite_1_1_operation_1_1_polygonize_1_1_polygonizer.html\" rel=\"nofollow noreferrer\">tool like this</a>.</p>\n\n<pre><code>select\n    geometry::STGeomFromText(replace(replace(e1.boundaries.STAsText(), 'POLYGON (', 'LINESTRING '), '))', ')'), 4326)\n    .STUnion(geometry::STGeomFromText(replace(replace(e2.boundaries.STAsText(), 'POLYGON (', 'LINESTRING '), '))', ')'), 4326))\n    .STUnion(geometry::STGeomFromText(replace(replace(e3.boundaries.STAsText(), 'POLYGON (', 'LINESTRING '), '))', ')'), 4326))\n    .Reduce(0.1)\nfrom entities e1\ncross join entities e2 \ncross join entities e3\nwhere e1.code  = 'dc7'\nand e2.code = 'dc6'\nand e3.code = 'dc8'\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/srYNh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/srYNh.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<h2>EDIT</h2>\n\n<p>Using NetTopologySuite, it can be done. I've <a href=\"https://www.webfresh.co.za/2018/08/10/simplifying-spatial-data-while-preserving-topologies-in-c/\" rel=\"nofollow noreferrer\">written it up here</a>. Using the <code>Polygonizer</code>, you can convert the linestrings back to polygons. Then you have to match the polygons back to the originals by using a ratio of area intersection, and then (if matched) you can re-associate the properties.</p>\n"}], "owner": {"reputation": 12246, "user_id": 214980, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bf7aec50272874960980fd6923cf962c?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/214980/sean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1533909184, "creation_date": 1533761898, "question_id": 51755560, "link": "https://stackoverflow.com/questions/51755560/combine-union-and-simplify-reduce-dbgeometry-records-for-geojson", "title": "Combine (union?) and simplify/reduce DbGeometry records for GeoJson", "body": "<p>I have a number of spatial entities in a table, with a <code>geometry</code> field called <code>Boundaries</code>. I want to produce a GeoJson file with the simplified shapes/geometries.</p>\n\n<p>This is my first attempt:</p>\n\n<pre><code>var entities = await db.Entities.ToListAsync();\n\ndynamic geoJson = new ExpandoObject();\ngeoJson.type = \"FeatureCollection\";\n\nvar features = new List&lt;dynamic&gt;();\n\nforeach (var entity in entities)\n{\n    // simplify (uses SqlGeometry.Reduce)\n    var simplified = Utilities.Geo.Simplify(entity.Boundaries, tolerance);\n\n    // convert to GeoJSON4EntityFramework.Feature with the appropriate Id\n    var feature = Utilities.Geo.GetFeature(simplified, entity.Id);\n\n    features.Add(feature);\n}\n\ngeoJson.features = features;\n\nreturn geoJson;\n</code></pre>\n\n<p>The problem with the result is that, because the geometries are simplified individually, the boundaries aren't common, as shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/y5A2j.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y5A2j.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>A second attempt is to combine the entities first, then simplify, then output as GeoJson:</p>\n\n<pre><code>var entities = await db.Entities.ToListAsync();\n\n// bit of a hack to union all the boundaries\nDbGeometry allBoundaries = null;\nfor (var i = 0; i &lt; entities.Count; i++)\n{\n    if (i == 0) allBoundaries = entities[i].Boundaries;\n    else allBoundaries = allBoundaries.Union(entities[i].Boundaries);\n}\n\n// simplify (uses SqlGeometry.Reduce)\nvar simplified = Utilities.Geo.Simplify(allBoundaries, tolerance);\n\ndynamic geoJson = new ExpandoObject();\ngeoJson.type = \"FeatureCollection\";\n\nvar features = new List&lt;dynamic&gt;();\n\n// convert to GeoJSON4EntityFramework.Feature with the (in)appropriate Id\nvar feature = Utilities.Geo.GetFeature(simplified, \"ALL\");\n\nfeatures.Add(feature);\n\ngeoJson.features = features;\n\nreturn geoJson;\n</code></pre>\n\n<p>However, the <code>.Union</code> is combining the entities into a single entity, despite what is <a href=\"https://stackoverflow.com/questions/31120785/combine-several-dbgeography-polygons\">said here</a> that this doesn't happen. (I also then don't have the opportunity to put an Id on each feature, so just used 'ALL' for now). The result is the completely merged shape:</p>\n\n<p><a href=\"https://i.stack.imgur.com/agP2Z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/agP2Z.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So the question is: how do I combine the boundaries across rows, then simplify, then produce as a feature collection, with each feature having the\ncorrect Id, as can be done in MapShaper (shown below)?</p>\n\n<p><a href=\"https://i.stack.imgur.com/7OzuO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7OzuO.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "winforms", "unc"], "comments": [{"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 2, "creation_date": 1533761836, "post_id": 51755494, "comment_id": 90470732, "body": "Typically your deployment technology; ClickOnce, WIX, Windows Store, or whatever, decides where to install your files. Which one are you using? Why do you care where the installer put your files; you shouldn&#39;t need to know."}, {"owner": {"reputation": 11, "user_id": 9994364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acba07c1fc21b4fd8208ca8778b33291?s=128&d=identicon&r=PG&f=1", "display_name": "kennyozordi", "link": "https://stackoverflow.com/users/9994364/kennyozordi"}, "reply_to_user": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1533762044, "post_id": 51755494, "comment_id": 90470816, "body": "In the the publish wizard I am asked to specify the UNC path."}, {"owner": {"reputation": 7206, "user_id": 5741643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/27485d5a049481e18d6aeb3f18480447?s=128&d=identicon&r=PG&f=1", "display_name": "Poul Bak", "link": "https://stackoverflow.com/users/5741643/poul-bak"}, "edited": false, "score": 0, "creation_date": 1533762348, "post_id": 51755494, "comment_id": 90470910, "body": "The UNC path in the publish wizard is a web server, where people can download and install your file"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6487917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LpOaJ.jpg?s=128&g=1", "display_name": "fixmycode - Karl Kroenig", "link": "https://stackoverflow.com/users/6487917/fixmycode-karl-kroenig"}, "is_accepted": false, "score": 2, "last_activity_date": 1533762195, "creation_date": 1533762195, "answer_id": 51755611, "question_id": 51755494, "link": "https://stackoverflow.com/questions/51755494/can-i-use-c-program-files-as-the-unc-path-when-publishing-my-project/51755611#51755611", "title": "Can I use C:\\Program Files as the UNC path when publishing my project", "body": "<p>I think, you have a big misunderstanding here. First of all, if you include a computername, you need to write it in the form \\computername.</p>\n\n<p>But what do you have in mind? Publishing my project? When you publish or install a project, you will never ever use absolute pathes like \"C:\\Program Files\", but instead you will use variable names for system folders. You may check for Environment specialfolder enumeration to get an idea. </p>\n\n<p>And - you should have in mind, that EVERY installer available today will properly do that job for you. Have a look at Innosetup. Or, make that question more clear.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9994364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acba07c1fc21b4fd8208ca8778b33291?s=128&d=identicon&r=PG&f=1", "display_name": "kennyozordi", "link": "https://stackoverflow.com/users/9994364/kennyozordi"}, "edited": false, "score": 0, "creation_date": 1533763468, "post_id": 51755663, "comment_id": 90471279, "body": "Thanks,  I changed the UNC path to C:\\Users\\mypcname\\Desktop\\appname  But it returns an error message saying &quot;the string must be a fully qualified UNC path&quot;"}], "tags": [], "owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "is_accepted": false, "score": 1, "last_activity_date": 1533763205, "last_edit_date": 1533763205, "creation_date": 1533762453, "answer_id": 51755663, "question_id": 51755494, "link": "https://stackoverflow.com/questions/51755494/can-i-use-c-program-files-as-the-unc-path-when-publishing-my-project/51755663#51755663", "title": "Can I use C:\\Program Files as the UNC path when publishing my project", "body": "<p>If you are using the publish dialog, then you are deploying using <em>ClickOnce</em>. If you are distributing it, then typically you would be using FTP to publish it to a web server or something - if you choose a location on your hard drive, then that is just where the files will be placed; you would need to copy those files onto a flash drive and take it from computer to computer to deploy it.</p>\n\n<p><code>C:\\mypcname\\folder</code> is not a valid file path, so that one is out.  <code>C:\\Program Files</code> is probably not a very good option.  A folder under \"My Documents\" would probably be better.</p>\n\n<p>Either way, the option you choose has nothing to do with where the project will wind up on your users' computers once they \"install\" it... <em>ClickOnce</em> actually puts everything into the hidden <code>AppData</code> folder under the <code>Users</code> folder of the user.  If you want the application to wind up in <code>C:\\Program Files</code>, then <em>ClickOnce</em> is not the deployment technique you are looking for.  Look into something like <em>InstallShield</em> instead.</p>\n"}], "owner": {"reputation": 11, "user_id": 9994364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acba07c1fc21b4fd8208ca8778b33291?s=128&d=identicon&r=PG&f=1", "display_name": "kennyozordi", "link": "https://stackoverflow.com/users/9994364/kennyozordi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1507, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1533763205, "creation_date": 1533761634, "question_id": 51755494, "link": "https://stackoverflow.com/questions/51755494/can-i-use-c-program-files-as-the-unc-path-when-publishing-my-project", "title": "Can I use C:\\Program Files as the UNC path when publishing my project", "body": "<p>I want to publish a c# project. I want to know if I can use C:\\Program Files as the UNC path Or I must add my PC name like C:\\mypcname\\folder\nI want to make sure it can be installed from another computer system.</p>\n"}, {"tags": ["c#", "entity-framework", "asp.net-web-api2"], "comments": [{"owner": {"reputation": 6477, "user_id": 9608718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414d776388a58815290c0efc4a4bb114?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Riabov", "link": "https://stackoverflow.com/users/9608718/alex-riabov"}, "edited": false, "score": 0, "creation_date": 1533761980, "post_id": 51755419, "comment_id": 90470790, "body": "We need to know more about your objects structure. Also, what is db? Is it dbContext of EF?"}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 1, "creation_date": 1533761981, "post_id": 51755419, "comment_id": 90470791, "body": "Well if you create a entity-framework navigation property named <code>SectionContent</code> that would be an enumeration of <code>SectionContent</code> so normally the serializer can just serialize the response in one go and get the json you&#39;re looking for."}], "answers": [{"comments": [{"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 1, "creation_date": 1533762900, "post_id": 51755734, "comment_id": 90471105, "body": "In your second example, <code>entity</code> would be a collection of entities, so the second line wouldn&#39;t work."}, {"owner": {"reputation": 356, "user_id": 4613299, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eLVK9xQc7ho/AAAAAAAAAAI/AAAAAAAAAiY/mSNST4pLwjQ/photo.jpg?sz=128", "display_name": "Sajad Afaghiy", "link": "https://stackoverflow.com/users/4613299/sajad-afaghiy"}, "reply_to_user": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533763993, "post_id": 51755734, "comment_id": 90471451, "body": "Where clause may has null, one or more than one result and if you define second entity in first entity as collection like <code>public virtual ICollection&lt;Entity2nd&gt; Entity2nd { get; set; }</code>, there would be no problem."}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533771546, "post_id": 51755734, "comment_id": 90473498, "body": "You misunderstand.  <code>class context : DbContext { public ICollection&lt;Entity1st&gt; Entity1st; }</code> means that <code>var entity = context.Entity1st</code> is a collection."}, {"owner": {"reputation": 356, "user_id": 4613299, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eLVK9xQc7ho/AAAAAAAAAAI/AAAAAAAAAiY/mSNST4pLwjQ/photo.jpg?sz=128", "display_name": "Sajad Afaghiy", "link": "https://stackoverflow.com/users/4613299/sajad-afaghiy"}, "reply_to_user": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533772621, "post_id": 51755734, "comment_id": 90473701, "body": "Thanks @ErikPhilips. I&#39;ve edited it according to your comment. \ud83c\udf3c"}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533773405, "post_id": 51755734, "comment_id": 90473848, "body": "That&#39;s also very hard on the DB.  You are executing Entity1st.Count + 1 statements.  If you simply did a join it would be a single query."}], "tags": [], "owner": {"reputation": 356, "user_id": 4613299, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eLVK9xQc7ho/AAAAAAAAAAI/AAAAAAAAAiY/mSNST4pLwjQ/photo.jpg?sz=128", "display_name": "Sajad Afaghiy", "link": "https://stackoverflow.com/users/4613299/sajad-afaghiy"}, "is_accepted": true, "score": 1, "last_activity_date": 1533772391, "last_edit_date": 1533772391, "creation_date": 1533762832, "answer_id": 51755734, "question_id": 51755419, "link": "https://stackoverflow.com/questions/51755419/combine-multiple-models-into-1-json-webapi-response/51755734#51755734", "title": "Combine multiple Models into 1 JSON WebAPI response", "body": "<p>If you are using entity framework (EF) and your tables relationship type is one to many, you can use <strong>Include</strong> in lambda expression to return first table with data of second table.</p>\n\n<pre><code>return context.Entity1st.Include(x =&gt; x.Entity2nd);\n</code></pre>\n\n<p>or you can also do as bellow:</p>\n\n<pre><code>var entities = context.Entity1st;\n\nforeach (var entity in entities)\n{\n    entity.Entity2nd = context.Entity2nd.Where(x =&gt; x.Entity1stId == entity.Id);\n}\n\nreturn entities;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6477, "user_id": 9608718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414d776388a58815290c0efc4a4bb114?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Riabov", "link": "https://stackoverflow.com/users/9608718/alex-riabov"}, "is_accepted": false, "score": 2, "last_activity_date": 1533763301, "creation_date": 1533763301, "answer_id": 51755809, "question_id": 51755419, "link": "https://stackoverflow.com/questions/51755419/combine-multiple-models-into-1-json-webapi-response/51755809#51755809", "title": "Combine multiple Models into 1 JSON WebAPI response", "body": "<p>I would start from defining DTO object, since returning database objects directly isn't the best practice, you usually don't want to revial all fields also it gives you more flexibility with changing DB structure without breaking API contract. Also you need your collection to be wrapped in Sections property, so you can't just return a list of objects. So, you need structure like:</p>\n\n<pre><code>public class SectionsResponse\n{\n    public List&lt;SectionDTO&gt; Sections {get;set;}\n}\n\npublic class SectionDTO\n{\n    public string SectionID {get;set;}\n    .... add other properties\n    public List&lt;ContentDTO&gt; sectionContent {get;set;}\n}\n\npublic class ContentDTO\n{\n   ... define your properties\n}\n</code></pre>\n\n<p>Next step will be to implement mapping between your database object and DTO. You may use existing library for this purpose, e.g. <a href=\"https://www.infoworld.com/article/3192900/application-development/how-to-work-with-automapper-in-c.html\" rel=\"nofollow noreferrer\">AutoMapper</a></p>\n\n<p>As for working with database you can apply <a href=\"https://msdn.microsoft.com/en-us/library/jj574232(v=vs.113).aspx\" rel=\"nofollow noreferrer\">eagerly loading</a> from Entity Framework. In short it will look like:</p>\n\n<pre><code>return db.Sections.Include(x =&gt; x.Content);\n</code></pre>\n\n<p>or wrapped with DTO and AutoMapper:</p>\n\n<pre><code>return new SectionsResponse() { Sections = mapper.Map&lt;List&lt;Section&gt;, List&lt;SectionDTO&gt;&gt;(db.Sections.Include(x =&gt; x.Content)) };\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 1766400, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5c1806a56e95ab28d1bc246bd6b095d8?s=128&d=identicon&r=PG", "display_name": "Nate23VT", "link": "https://stackoverflow.com/users/1766400/nate23vt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1042, "favorite_count": 0, "accepted_answer_id": 51755734, "answer_count": 2, "score": 0, "last_activity_date": 1533772391, "creation_date": 1533761301, "last_edit_date": 1533765771, "question_id": 51755419, "link": "https://stackoverflow.com/questions/51755419/combine-multiple-models-into-1-json-webapi-response", "title": "Combine multiple Models into 1 JSON WebAPI response", "body": "<p>I am working a bit backwards here and trying to create a web api from a provided JSON example that is being used for the front end.  Here is the JSON format.</p>\n\n<pre><code> {\"Sections\": [{\n     \"sectionID\":\"1\",\n     \"sectionOrder\":1,\n     \"sectionName\":\"Approach\",\n     \"sectionText\": \"\",\n     \"sectionContent\": [{\n         \"contentID\": \"1\",\n         \"contentTitle\": \"Definition\",\n         \"contentText\": \"Lorem Ipsum\",\n         \"contentImage\": \"\"\n     },\n     {\n         \"contentID\": \"2\",\n         \"contentTitle\": \"Vision\",\n         \"contentText\": \"Lorem Ipsum\",\n         \"contentImage\": \"image2.jpg\"\n     }]\n}]}\n</code></pre>\n\n<p>I have created 2 tables (Section &amp; Section Content linked by SectionContentID) and added the tables as models using entity framework.  I have then created a controller to return the section table but now is where I am stuck on how to join the section content data into 1 JSON response. </p>\n\n<p>My controller just looks like this:</p>\n\n<pre><code>public IQueryable&lt;Sections&gt; GetSections()\n{\n    //how do I add db.SectionsContent to Sections linked by the sectionContentID field?\n    return db.Sections;\n}\n</code></pre>\n"}, {"tags": ["c#", "json", "json.net"], "comments": [{"owner": {"reputation": 4417, "user_id": 1120092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5677677496ae72bb84f363cb7a3c4dc3?s=128&d=identicon&r=PG", "display_name": "Pete Garafano", "link": "https://stackoverflow.com/users/1120092/pete-garafano"}, "edited": false, "score": 2, "creation_date": 1533762421, "post_id": 51755371, "comment_id": 90470932, "body": "Instead of going to a string (unless this is really what you want), you could probably get this to go into some sort of dictionary. I answered something similar here: <a href=\"https://stackoverflow.com/questions/23505096/deserialize-json-with-dynamic-objects/23520523#23520523\" title=\"deserialize json with dynamic objects\">stackoverflow.com/questions/23505096/&hellip;</a>"}, {"owner": {"reputation": 203, "user_id": 2344654, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6860ad806a38b511096557a1b3797db0?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2344654/john"}, "reply_to_user": {"reputation": 4417, "user_id": 1120092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5677677496ae72bb84f363cb7a3c4dc3?s=128&d=identicon&r=PG", "display_name": "Pete Garafano", "link": "https://stackoverflow.com/users/1120092/pete-garafano"}, "edited": false, "score": 0, "creation_date": 1533764269, "post_id": 51755371, "comment_id": 90471538, "body": "@PeteGarafano. I do need it as a string, you I think that you have the right idea. I just need to do it like:  <code>code</code> var rawObj = JsonConvert.DeserializeObject&lt;dynamic&gt;(json); var uniq = rawObj.name; var settings = rawObj.settings; <code>code</code> thanks for the idea"}, {"owner": {"reputation": 5172, "user_id": 1411104, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d76247ee9f2ba6c7c79fc5cea3e8fba2?s=128&d=identicon&r=PG", "display_name": "MistyK", "link": "https://stackoverflow.com/users/1411104/mistyk"}, "edited": false, "score": 0, "creation_date": 1533764425, "post_id": 51755371, "comment_id": 90471604, "body": "@John see my answer, I don&#39;t think using dynamic here is the &quot;cleanest&quot; solution."}, {"owner": {"reputation": 4417, "user_id": 1120092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5677677496ae72bb84f363cb7a3c4dc3?s=128&d=identicon&r=PG", "display_name": "Pete Garafano", "link": "https://stackoverflow.com/users/1120092/pete-garafano"}, "edited": false, "score": 0, "creation_date": 1533772481, "post_id": 51755371, "comment_id": 90473682, "body": "@John I did it with <code>dynamic</code> in that answer, but nothing is stopping you from making it into a <code>Dictionary&lt;string, string&gt;</code> or something similar. If it helped at all, I&#39;ll call it a win. Good luck!"}], "answers": [{"comments": [{"owner": {"reputation": 3676, "user_id": 862495, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/26bbb772e30d41a4fdfa5657f43012ba?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/862495/nick"}, "edited": false, "score": 0, "creation_date": 1533763163, "post_id": 51755553, "comment_id": 90471183, "body": "This wont work. He said the structure of the Settings is not consistent so you can&#39;t use a Settings class like that."}], "tags": [], "owner": {"reputation": 2650, "user_id": 4588756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fl8RE.png?s=128&g=1", "display_name": "Hossein", "link": "https://stackoverflow.com/users/4588756/hossein"}, "is_accepted": false, "score": 0, "last_activity_date": 1533761882, "creation_date": 1533761882, "answer_id": 51755553, "question_id": 51755371, "link": "https://stackoverflow.com/questions/51755371/deserialize-nested-complex-json-object-to-just-a-string-c/51755553#51755553", "title": "Deserialize nested, complex json object to just a string c#", "body": "<p>I have just this solution:</p>\n\n<pre><code>public class RootObject\n        {\n            public string name { get; set; }\n            public Settings settings { get; set; }\n            public string strSettings { get; set; } &lt;-------- \n        }\n</code></pre>\n\n<p>and </p>\n\n<pre><code>  var data= Newtonsoft.Json.JsonConvert.DeserializeObject&lt;RootObject&gt;(json);\n    data.strSettings = Newtonsoft.Json.JsonConvert.SerializeObject(data.settings);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 203, "user_id": 2344654, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6860ad806a38b511096557a1b3797db0?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2344654/john"}, "edited": false, "score": 0, "creation_date": 1533764727, "post_id": 51755875, "comment_id": 90471715, "body": "I can&#39;t redefine the RootObject like this and the real object is more complex and it will not always go into a Dictionary, but +1 for the dotnetfiddle. I like those!"}, {"owner": {"reputation": 5172, "user_id": 1411104, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d76247ee9f2ba6c7c79fc5cea3e8fba2?s=128&d=identicon&r=PG", "display_name": "MistyK", "link": "https://stackoverflow.com/users/1411104/mistyk"}, "reply_to_user": {"reputation": 203, "user_id": 2344654, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6860ad806a38b511096557a1b3797db0?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2344654/john"}, "edited": false, "score": 0, "creation_date": 1533820354, "post_id": 51755875, "comment_id": 90494584, "body": "@John why can&#39;t it go to dictionary? Dictionary&lt;string,object&gt; represents any object structure in .NET"}, {"owner": {"reputation": 203, "user_id": 2344654, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6860ad806a38b511096557a1b3797db0?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2344654/john"}, "edited": false, "score": 0, "creation_date": 1533910048, "post_id": 51755875, "comment_id": 90533872, "body": "Yes, it does work to parse the json, but I really need to leave that as a string property."}], "tags": [], "owner": {"reputation": 5172, "user_id": 1411104, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d76247ee9f2ba6c7c79fc5cea3e8fba2?s=128&d=identicon&r=PG", "display_name": "MistyK", "link": "https://stackoverflow.com/users/1411104/mistyk"}, "is_accepted": false, "score": 1, "last_activity_date": 1533763573, "creation_date": 1533763573, "answer_id": 51755875, "question_id": 51755371, "link": "https://stackoverflow.com/questions/51755371/deserialize-nested-complex-json-object-to-just-a-string-c/51755875#51755875", "title": "Deserialize nested, complex json object to just a string c#", "body": "<p>Try this:</p>\n\n<pre><code>public class RootObject\n        {\n            public string name { get; set; }\n            public Dictionary&lt;string,object&gt; settings { get; set; }\n        }\n</code></pre>\n\n<p>Fiddle:\n<a href=\"https://dotnetfiddle.net/QN3nWL\" rel=\"nofollow noreferrer\">https://dotnetfiddle.net/QN3nWL</a></p>\n"}, {"comments": [{"owner": {"reputation": 203, "user_id": 2344654, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6860ad806a38b511096557a1b3797db0?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2344654/john"}, "edited": false, "score": 0, "creation_date": 1533825178, "post_id": 51756717, "comment_id": 90498007, "body": "This would work, but Brian&#39;s solution is better for me. Thanks!"}], "tags": [], "owner": {"reputation": 54, "user_id": 6405813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6074ab2d877de795184412e9fc02059?s=128&d=identicon&r=PG&f=1", "display_name": "CDurand", "link": "https://stackoverflow.com/users/6405813/cdurand"}, "is_accepted": false, "score": 2, "last_activity_date": 1533768749, "creation_date": 1533768749, "answer_id": 51756717, "question_id": 51755371, "link": "https://stackoverflow.com/questions/51755371/deserialize-nested-complex-json-object-to-just-a-string-c/51756717#51756717", "title": "Deserialize nested, complex json object to just a string c#", "body": "<p>Try using Newtonsoft.Json plus LINQ:</p>\n\n<pre><code>string jsonText = @\"{\n            'name': 'foo',\n            'settings': {\n                'settings1': true,\n                'settings2': 1\n                }\n            }\";\n\nJObject jObj = JObject.Parse(jsonText);\nvar setting = jObj.Descendants()\n                .OfType&lt;JProperty&gt;()\n                .Where(p =&gt; p.Name == \"settings\")\n                .First()\n                .Value.ToObject&lt;Settings&gt;();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 203, "user_id": 2344654, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6860ad806a38b511096557a1b3797db0?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2344654/john"}, "edited": false, "score": 0, "creation_date": 1533825116, "post_id": 51757003, "comment_id": 90497953, "body": "Brilliant! This works perfectly and I was able to easily adapt this for another challenge I had. Thanks!!!"}], "tags": [], "owner": {"reputation": 108943, "user_id": 10263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/e51Ks.jpg?s=128&g=1", "display_name": "Brian Rogers", "link": "https://stackoverflow.com/users/10263/brian-rogers"}, "is_accepted": true, "score": 2, "last_activity_date": 1533772100, "last_edit_date": 1533772100, "creation_date": 1533771089, "answer_id": 51757003, "question_id": 51755371, "link": "https://stackoverflow.com/questions/51755371/deserialize-nested-complex-json-object-to-just-a-string-c/51757003#51757003", "title": "Deserialize nested, complex json object to just a string c#", "body": "<p>You could use a <code>JToken</code> to capture your unknown <code>settings</code> during deserialization, then use a second property to allow you to access that JSON as a string if you need to.  </p>\n\n<p>Set up your class like this:</p>\n\n<pre><code>public class RootObject\n{\n    [JsonProperty(\"name\")]\n    public string Name { get; set; }\n\n    [JsonIgnore]\n    public string Settings\n    {\n        get { return SettingsToken != null ? SettingsToken.ToString(Formatting.None) : null; }\n        set { SettingsToken = value != null ? JToken.Parse(value) : JValue.CreateNull(); }\n    }\n\n    [JsonProperty(\"settings\")]\n    private JToken SettingsToken { get; set; }\n}\n</code></pre>\n\n<p>Then deserialize as usual:</p>\n\n<pre><code>var root = JsonConvert.DeserializeObject&lt;RootObject&gt;(json);\n</code></pre>\n\n<p>The <code>Settings</code> property will contain the <code>settings</code> part of the JSON as a string.  If you reserialize the object back to JSON then the <code>settings</code> will retain whatever structure it had before.</p>\n\n<p>You can also change the <code>Settings</code> property to some other JSON string, as long as it is well-formed. (If it isn't, then an exception will be thrown immediately.)</p>\n\n<p>Here is a round-trip demo:  <a href=\"https://dotnetfiddle.net/thiaWk\" rel=\"nofollow noreferrer\">https://dotnetfiddle.net/thiaWk</a></p>\n"}], "owner": {"reputation": 203, "user_id": 2344654, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/6860ad806a38b511096557a1b3797db0?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2344654/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 0, "accepted_answer_id": 51757003, "answer_count": 4, "score": 2, "last_activity_date": 1533772100, "creation_date": 1533761094, "question_id": 51755371, "link": "https://stackoverflow.com/questions/51755371/deserialize-nested-complex-json-object-to-just-a-string-c", "title": "Deserialize nested, complex json object to just a string c#", "body": "<p>I have JSON which looks like:</p>\n\n<pre><code>{\n  \"name\": \"foo\",\n  \"settings\": {\n    \"setting1\": true,\n    \"setting2\": 1\n  }\n}  \n</code></pre>\n\n<p>I know how to use json2csharp.com to create the C# classes to deserialize this. They looks like:</p>\n\n<pre><code>public class Settings\n{\n    public bool settings1 { get; set; }\n    public int settings2 { get; set; }\n}\n\npublic class RootObject\n{\n    public string name { get; set; }\n    public Settings settings { get; set; }\n}\n</code></pre>\n\n<p>but what I want is to simply deserialize it into</p>\n\n<pre><code>public class RootObject\n{\n    public string name { get; set; }\n    public string settings { get; set; }\n}\n</code></pre>\n\n<p>i.e., all of the \"setting\" JSON just needs to be saved as a string--the structure of that JSON is not consistent. How can that be done? Thanks!</p>\n"}, {"tags": ["c#", "mongodb", ".net-4.6.1"], "answers": [{"comments": [{"owner": {"reputation": 359, "user_id": 1760167, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce8beabbeb785ad952de11cb7d74c55a?s=128&d=identicon&r=PG&f=1", "display_name": "alexs", "link": "https://stackoverflow.com/users/1760167/alexs"}, "edited": false, "score": 1, "creation_date": 1533799980, "post_id": 51755792, "comment_id": 90481313, "body": "Thanks, this pointed me in the right direction.  We had recently updated the driver.  Deleted all bin and obj directories from the project and rebuilt the solution in Visual Studio and that seemed to resolve the issue."}, {"owner": {"reputation": 4417, "user_id": 1120092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5677677496ae72bb84f363cb7a3c4dc3?s=128&d=identicon&r=PG", "display_name": "Pete Garafano", "link": "https://stackoverflow.com/users/1120092/pete-garafano"}, "reply_to_user": {"reputation": 359, "user_id": 1760167, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce8beabbeb785ad952de11cb7d74c55a?s=128&d=identicon&r=PG&f=1", "display_name": "alexs", "link": "https://stackoverflow.com/users/1760167/alexs"}, "edited": false, "score": 0, "creation_date": 1533821081, "post_id": 51755792, "comment_id": 90495142, "body": "@alexs glad to hear it!"}], "tags": [], "owner": {"reputation": 4417, "user_id": 1120092, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5677677496ae72bb84f363cb7a3c4dc3?s=128&d=identicon&r=PG", "display_name": "Pete Garafano", "link": "https://stackoverflow.com/users/1120092/pete-garafano"}, "is_accepted": true, "score": 1, "last_activity_date": 1533763207, "creation_date": 1533763207, "answer_id": 51755792, "question_id": 51755165, "link": "https://stackoverflow.com/questions/51755165/mongoconfigurationexception-when-srv-connection-string/51755792#51755792", "title": "MongoConfigurationException when SRV connection string", "body": "<p>I attempted to reproduce this using</p>\n\n<pre><code>var client = new MongoClient(\"mongodb+srv://USER:PASS@cluster0-xxxx.mongodb.net/test?retryWrites=true\");\nvar dbs = await client.ListDatabaseNames().ToListAsync();\nConsole.WriteLine(dbs);\n</code></pre>\n\n<p>Which gave me the expected output (2 database names).</p>\n\n<p>My test environment is .NET 4.6.1, LINQPad, and C# Driver 2.7.0.</p>\n\n<p>You can try eliminating the C# Driver (and framework) from the equation by using the Mongo Shell to test. If you're using Mongo Shell version 3.6 or later, you can test the connection with a command similar to</p>\n\n<pre><code>mongo \"mongodb+srv://cluster0-xxxx.mongodb.net/test\" --username USER\n</code></pre>\n\n<p>That being said, you should be able to contact MongoDB Support for your atlas cluster, using the \"Support\" link on the left side of the Atlas UI. They should be able to help.</p>\n"}], "owner": {"reputation": 359, "user_id": 1760167, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce8beabbeb785ad952de11cb7d74c55a?s=128&d=identicon&r=PG&f=1", "display_name": "alexs", "link": "https://stackoverflow.com/users/1760167/alexs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1925, "favorite_count": 0, "accepted_answer_id": 51755792, "answer_count": 1, "score": 0, "last_activity_date": 1533763207, "creation_date": 1533760158, "question_id": 51755165, "link": "https://stackoverflow.com/questions/51755165/mongoconfigurationexception-when-srv-connection-string", "title": "MongoConfigurationException when SRV connection string", "body": "<p>Driver Language - C#</p>\n\n<p>Driver Version - 2.7.0</p>\n\n<p>DB Version - 4.0.0</p>\n\n<p>.NET Framework 4.6.1</p>\n\n<p>Exception message (credentials and server removed)</p>\n\n<blockquote>\n  <p>The connection string\n  'mongodb+srv://USER:PASS@uat-xxxx.mongodb.net/test?retryWrites=true'\n  is not valid.</p>\n</blockquote>\n\n<p>Code </p>\n\n<pre><code>var client = new MongoClient(@\"mongodb+srv://USER:PASS@uat-xxxx.mongodb.net/test?retryWrites=true\");\n</code></pre>\n\n<p>User and password contain no special characters</p>\n\n<p>No connection attempt is made to the server.</p>\n\n<p>However, this works fine if i use the URI version </p>\n\n<pre><code>var client = new MongoClient(@\"mongodb://USER:PASS@uat-shard-00-00-xxxxx.mongodb.net:27017,uat-shard-00-01-xxxxx.mongodb.net:27017,uat-shard-00-02-xxxxx.mongodb.net:27017/test?ssl=true&amp;replicaSet=UAT-shard-0&amp;authSource=admin&amp;retryWrites=true\");\n</code></pre>\n\n<p>I've tried to decipher the validation rules from <a href=\"https://github.com/mongodb/mongo-csharp-driver/blob/ec74978f7e827515f29cc96fba0c727828e8df7c/src/MongoDB.Driver.Core/Core/Configuration/ConnectionString.cs\" rel=\"nofollow noreferrer\">the source</a> but it's beyond my regex ability.</p>\n\n<p>The srv connection string looks fine to me and is exactly the same as that presented to me in the Mongo Atlas UI.  </p>\n\n<p>Any idea what i'm doing wrong?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "azure", "azureservicebus", "azure-worker-roles", "azure-servicebus-topics"], "comments": [{"owner": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "edited": false, "score": 0, "creation_date": 1533912519, "post_id": 51755156, "comment_id": 90535356, "body": "Update #2 looks good. I think it will work :)"}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "reply_to_user": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "edited": false, "score": 0, "creation_date": 1533912668, "post_id": 51755156, "comment_id": 90535462, "body": "@Arunprabhu Thank you. I&#39;ll try to resolve current issue &quot;Could not load file or assembly &#39;Microsoft.Azure.Amqp&quot; and report back. My main concern is my <code>RunAsync()</code> method. Is this how to properly keep it alive <code>_runCompleteEvent.WaitOne()</code> forever?"}, {"owner": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "edited": false, "score": 0, "creation_date": 1533913191, "post_id": 51755156, "comment_id": 90535744, "body": "I am not sure about _runCompleteEvent.WaitOne(), RegisterMessageHandler will keep the method alive forever."}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "reply_to_user": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "edited": false, "score": 0, "creation_date": 1533913772, "post_id": 51755156, "comment_id": 90536096, "body": "@Arunprabhu if that&#39;s the case, then I&#39;ll remove that line <code>_runCompleteEvent.WaitOne()</code>. Reason I added it, was because the MS Article (<a href=\"https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/azure/service-bus-messaging/&hellip;</a>) has <code>Console.ReadKey();</code> but I don&#39;t want <code>Console.ReadKey();</code> to be the holder of Keep-Alive."}, {"owner": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "edited": false, "score": 0, "creation_date": 1533914173, "post_id": 51755156, "comment_id": 90536331, "body": "Yeah, just remove that and check whether the method is alive."}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "reply_to_user": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "edited": false, "score": 0, "creation_date": 1533922781, "post_id": 51755156, "comment_id": 90540496, "body": "@Arunprabhu when I remove, the <code>WorkerRole</code> seem to recycle over and over again. When I add it back it seems to work just fine. &quot;seems&quot; because I&#39;m not sure what would make it continue when i don&#39;t want it to do so. =)"}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "reply_to_user": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "edited": false, "score": 0, "creation_date": 1533923454, "post_id": 51755156, "comment_id": 90540773, "body": "@Arunprabhu also, I&#39;m concerned with the cancellation token in my <code>RunAsync()</code> method. Is that only really needed if I had an ongoing while loop, like the base template creates?"}], "answers": [{"comments": [{"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1533835628, "post_id": 51759036, "comment_id": 90504375, "body": "Thanks! I thought about it, but I read it takes up the same VM as the website? I prefer this be on it&#39;s own. Maybe you can give more insight?"}, {"owner": {"reputation": 148, "user_id": 1715956, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09f9a14ed48bdbb01238890e47596b45?s=128&d=identicon&r=PG", "display_name": "Nyamnyam", "link": "https://stackoverflow.com/users/1715956/nyamnyam"}, "reply_to_user": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1534468009, "post_id": 51759036, "comment_id": 90725605, "body": "Hi yes you&#39;re right, the deployed webjob will be in the same VM (same sandbox environment) as the website if you deployed both into the same app service plan. <a href=\"https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox\" rel=\"nofollow noreferrer\">More info here</a>"}], "tags": [], "owner": {"reputation": 148, "user_id": 1715956, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/09f9a14ed48bdbb01238890e47596b45?s=128&d=identicon&r=PG", "display_name": "Nyamnyam", "link": "https://stackoverflow.com/users/1715956/nyamnyam"}, "is_accepted": false, "score": 0, "last_activity_date": 1533790142, "creation_date": 1533790142, "answer_id": 51759036, "question_id": 51755156, "link": "https://stackoverflow.com/questions/51755156/azure-service-bus-topics-and-subscriptions-with-worker-role/51759036#51759036", "title": "Azure Service Bus Topics and Subscriptions with Worker Role", "body": "<p>I'm wondering whether do you have any specific reason for choosing Worker Role over Web Job? If not, you can use the Web Job which has the ServiceBusTrigger attribute and it will make your code much simpler.\n<a href=\"https://github.com/Azure/azure-webjobs-sdk/wiki/Service-Bus\" rel=\"nofollow noreferrer\">more info here...</a></p>\n"}, {"comments": [{"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1533835767, "post_id": 51759928, "comment_id": 90504450, "body": "Thanks! I have played around with this, and thought since it was for <code>Queues</code>, it wasn&#39;t what I wanted. Though, later I&#39;ve realized they are both essentially the same thing, except <code>Topics</code> can have multiple subscribers and (I think) work as <i>FIFO</i>. I&#39;ll go back to trying this out."}, {"owner": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "reply_to_user": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1533836111, "post_id": 51759928, "comment_id": 90504586, "body": "Yes it is FIFO and it will work as expected. I got this running seamlessly in my production environment :)"}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1533838148, "post_id": 51759928, "comment_id": 90505532, "body": "Thanks! So I played around with this template and it works! (I can receive messages). However, the <code>client.OnMessage(...)</code> uses a <code>BrokeredMessage</code>. The sender I wrote based on articles sends a <code>Message</code> type, as articles state this is the &quot;new&quot; way to do it. How can I get this template to read <code>Message</code>s vs <code>BrokeredMessage</code>s?"}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1533840633, "post_id": 51759928, "comment_id": 90506652, "body": "Also, I&#39;d actually like to have all this run with <code>async&#47;await</code>. While I have some familiarity, I&#39;m not totally sure how to get all this to work properly. Would love it if you can help with that if you show some code. Thanks! =)"}, {"owner": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "reply_to_user": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1533871699, "post_id": 51759928, "comment_id": 90514994, "body": "I have provided a separate answer due to its complexity :)"}], "tags": [], "owner": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "is_accepted": false, "score": 1, "last_activity_date": 1533795033, "creation_date": 1533795033, "answer_id": 51759928, "question_id": 51755156, "link": "https://stackoverflow.com/questions/51755156/azure-service-bus-topics-and-subscriptions-with-worker-role/51759928#51759928", "title": "Azure Service Bus Topics and Subscriptions with Worker Role", "body": "<p>If you are using Visual Studio, there is a default template available for creating Azure Cloud Service and Worker Role with Service Bus Queue. There you need to change the QueueClient with SubscriptionClient in WorkerRole.cs.</p>\n\n<p>Then, the worker role will stay active, listening for the messages from Topic Subscription.</p>\n\n<p>You can find the samples <a href=\"https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-dotnet-multi-tier-app-using-service-bus-queues#create-the-worker-role\" rel=\"nofollow noreferrer\">here</a>. You should create Worker role with Service Bus Queue inside the Cloud Service</p>\n\n<p><a href=\"https://i.stack.imgur.com/xkpEA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xkpEA.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1533909617, "post_id": 51778501, "comment_id": 90533621, "body": "Thanks! I did notice the different libraries and some differences in code and was trying to mesh things into one. Thanks for the samples, but I&#39;ve already been there =)  In any case, I&#39;ll be updating my <code>client.OnMessage()</code> to <code>RegisterMessegeHandler</code> on the receiver and I&#39;ll let you know the status. Thanks again for your help in my tangled confusion."}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 1, "creation_date": 1533910304, "post_id": 51778501, "comment_id": 90534021, "body": "Of course =) I always do, but I just ran into trouble and now I know why i was using different libraries. I&#39;ll comment in a bit."}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1533911426, "post_id": 51778501, "comment_id": 90534660, "body": "I&#39;m going to add my current solution as Update #2, would you be able to take a look and make sure the pieces I&#39;ve taken for many sources doesn&#39;t conflict? Thank you."}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1533923068, "post_id": 51778501, "comment_id": 90540613, "body": "I&#39;m going to accept this one, because I was able to accomplish this without creating a <code>Worker Role with Service Bus Queue </code> since currently it seems to be using <code>WindowsAzure.ServiceBus</code> instead of the newer <code>Microsoft.Azure.ServiceBus</code> and supports <code>async&#47;await</code>. Thanks for your help!"}, {"owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "edited": false, "score": 0, "creation_date": 1534515382, "post_id": 51778501, "comment_id": 90745501, "body": "With all this discussion, and finally finished my small WorkerRole, I&#39;ve noticed that <code>Service Fabrics</code> are the <i>net gen</i> of <code>Cloud Services</code>. I&#39;ll be working on making this into a <code>Service Fabric</code>"}], "tags": [], "owner": {"reputation": 1274, "user_id": 9956374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFstU.jpg?s=128&g=1", "display_name": "Arunprabhu", "link": "https://stackoverflow.com/users/9956374/arunprabhu"}, "is_accepted": true, "score": 3, "last_activity_date": 1533871630, "creation_date": 1533871630, "answer_id": 51778501, "question_id": 51755156, "link": "https://stackoverflow.com/questions/51755156/azure-service-bus-topics-and-subscriptions-with-worker-role/51778501#51778501", "title": "Azure Service Bus Topics and Subscriptions with Worker Role", "body": "<p>Considering the complexity of the updated question Update #1 (2018/08/09), I am providing a separate answer. </p>\n\n<p>The sender and receiver are using different libraries.</p>\n\n<p>Sender - <a href=\"https://www.nuget.org/packages/Microsoft.Azure.ServiceBus/\" rel=\"nofollow noreferrer\">Microsoft.Azure.ServiceBus</a></p>\n\n<p>Receiver - <a href=\"https://www.nuget.org/packages/WindowsAzure.ServiceBus/\" rel=\"nofollow noreferrer\">WindowsAzure.ServiceBus</a></p>\n\n<p>Microsoft.Azure.ServiceBus has the message object as Message, where WindowsAzure.ServiceBus has BrokeredMessage.</p>\n\n<p>There is a method <a href=\"https://github.com/Azure/azure-service-bus/blob/master/samples/DotNet/Microsoft.Azure.ServiceBus/SendersReceiversWithTopics/Program.cs\" rel=\"nofollow noreferrer\">RegisterMessageHandler</a> available in Microsoft.Azure.ServiceBus, this is the alternative for client.OnMessage() in WindowsAzure.ServiceBus. By using this, the listener receives the message as Message object. This library supports asynchronous programming as you expect.</p>\n\n<p>Refer <a href=\"https://github.com/Azure/azure-service-bus/tree/master/samples/DotNet\" rel=\"nofollow noreferrer\">here</a> for samples from both the libraries.</p>\n"}], "owner": {"reputation": 2755, "user_id": 286618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/AN1T3.png?s=128&g=1", "display_name": "RoLYroLLs", "link": "https://stackoverflow.com/users/286618/rolyrolls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2008, "favorite_count": 1, "accepted_answer_id": 51778501, "answer_count": 3, "score": 0, "last_activity_date": 1550179625, "creation_date": 1533760134, "last_edit_date": 1533912097, "question_id": 51755156, "link": "https://stackoverflow.com/questions/51755156/azure-service-bus-topics-and-subscriptions-with-worker-role", "title": "Azure Service Bus Topics and Subscriptions with Worker Role", "body": "<p>So I've recently gotten the need to use <code>Service Bus Topic and Subscriptions</code> and I've followed many articles and tutorials. I've been able to successfully implement Microsoft's <a href=\"https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions\" rel=\"nofollow noreferrer\">Get started with Service Bus topics</a> and also successfully used <code>Visual Studio 2017's</code> <code>Worker Role</code> template to access a database.</p>\n\n<p>However, I'm confused as to how to properly \"combine\" the two. While the <a href=\"https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions\" rel=\"nofollow noreferrer\">Get started with Service Bus topics</a> article shows how to create 2 apps, one to send and one to receive and then quits, the <code>Worker Role</code> template seems to loops endlessly with <code>await Task.Delay(10000);</code>.</p>\n\n<p>I'm not sure how to \"mesh\" the two properly. Essentially, I want my <code>Worker Role</code> to stay alive and listen for entries into it's subscription forever (or until it quits obviously).</p>\n\n<p>Any guidance would be great!</p>\n\n<p>P.S.: I've asked a related question concerning proper technology I should use for my case scenario at <a href=\"https://softwareengineering.stackexchange.com/questions/376601/cloud-service-or-service-fabric\">StackExchange - Software Engineering</a> if you are interested.</p>\n\n<p><strong>Update #1 (2018/08/09)</strong></p>\n\n<p>Based on <a href=\"https://stackoverflow.com/a/51759928/286618\">Arunprabhu's answer</a>, here is some code of how I'm sending a <code>Message</code> based on articles I've read and receiving using <code>Visual Studio 2017</code>'s <code>Worker Role with Service Bus Queue</code> template.</p>\n\n<p><em>Sending (based on <a href=\"https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions\" rel=\"nofollow noreferrer\">Get started with Service Bus topics</a>)</em></p>\n\n<pre><code>using System;\nusing System.Text;\nusing System.Threading.Tasks;\nusing Microsoft.Azure.ServiceBus;\n\nnamespace TopicsSender {\n    internal static class Program {\n        private const string ServiceBusConnectionString = \"&lt;your_connection_string&gt;\";\n        private const string TopicName = \"test-topic\";\n        private static ITopicClient _topicClient;\n\n        private static void Main(string[] args) {\n            MainAsync().GetAwaiter().GetResult();\n        }\n\n        private static async Task MainAsync() {\n            const int numberOfMessages = 10;\n            _topicClient = new TopicClient(ServiceBusConnectionString, TopicName);\n\n            Console.WriteLine(\"======================================================\");\n            Console.WriteLine(\"Press ENTER key to exit after sending all the messages.\");\n            Console.WriteLine(\"======================================================\");\n\n            // Send messages.\n            await SendMessagesAsync(numberOfMessages);\n\n            Console.ReadKey();\n\n            await _topicClient.CloseAsync();\n        }\n\n        private static async Task SendMessagesAsync(int numberOfMessagesToSend) {\n            try {\n                for (var i = 0; i &lt; numberOfMessagesToSend; i++) {\n                    // Create a new message to send to the topic\n                    var messageBody = $\"Message {i}\";\n                    var message = new Message(Encoding.UTF8.GetBytes(messageBody));\n\n                    // Write the body of the message to the console\n                    Console.WriteLine($\"Sending message: {messageBody}\");\n\n                    // Send the message to the topic\n                    await _topicClient.SendAsync(message);\n                }\n            } catch (Exception exception) {\n                Console.WriteLine($\"{DateTime.Now} :: Exception: {exception.Message}\");\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><em>Receiving (based on <code>Worker Role with Service Bus Queue</code> template)</em></p>\n\n<pre><code>using System;\nusing System.Diagnostics;\nusing System.Net;\nusing System.Threading;\nusing Microsoft.ServiceBus.Messaging;\nusing Microsoft.WindowsAzure.ServiceRuntime;\n\nnamespace WorkerRoleWithSBQueue1 {\n    public class WorkerRole : RoleEntryPoint {\n        // The name of your queue\n        private const string ServiceBusConnectionString = \"&lt;your_connection_string&gt;\";\n        private const string TopicName = \"test-topic\";\n        private const string SubscriptionName = \"test-sub1\";\n\n        // QueueClient is thread-safe. Recommended that you cache \n        // rather than recreating it on every request\n        private SubscriptionClient _client;\n        private readonly ManualResetEvent _completedEvent = new ManualResetEvent(false);\n\n        public override void Run() {\n            Trace.WriteLine(\"Starting processing of messages\");\n\n            // Initiates the message pump and callback is invoked for each message that is received, calling close on the client will stop the pump.\n            _client.OnMessage((receivedMessage) =&gt; {\n                try {\n                    // Process the message\n                    Trace.WriteLine(\"Processing Service Bus message: \" + receivedMessage.SequenceNumber.ToString());\n                    var message = receivedMessage.GetBody&lt;byte[]&gt;();\n                    Trace.WriteLine($\"Received message: SequenceNumber:{receivedMessage.SequenceNumber} Body:{message.ToString()}\");\n                } catch (Exception e) {\n                    // Handle any message processing specific exceptions here\n                    Trace.Write(e.ToString());\n                }\n            });\n\n            _completedEvent.WaitOne();\n        }\n\n        public override bool OnStart() {\n            // Set the maximum number of concurrent connections \n            ServicePointManager.DefaultConnectionLimit = 12;\n\n            // Initialize the connection to Service Bus Queue\n            _client = SubscriptionClient.CreateFromConnectionString(ServiceBusConnectionString, TopicName, SubscriptionName);\n            return base.OnStart();\n        }\n\n        public override void OnStop() {\n            // Close the connection to Service Bus Queue\n            _client.Close();\n            _completedEvent.Set();\n            base.OnStop();\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Update #2 (2018/08/10)</strong></p>\n\n<p>After a few suggestions from Arunprabhu and knowing I was using different libraries, below is my current solution with pieces taken from several sources. Is there anything I'm overlooking, adding that shouldering be there, etc? Currently getting an error that may be for another question or already answered so don't want to post it yet before further research.</p>\n\n<pre><code>using System;\nusing System.Diagnostics;\nusing System.Net;\nusing System.Text;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing Microsoft.Azure.ServiceBus;\nusing Microsoft.WindowsAzure.ServiceRuntime;\n\nnamespace WorkerRoleWithSBQueue1 {\n    public class WorkerRole : RoleEntryPoint {\n        private readonly CancellationTokenSource _cancellationTokenSource = new CancellationTokenSource();\n        private readonly ManualResetEvent _runCompleteEvent = new ManualResetEvent(false);\n\n        // The name of your queue\n        private const string ServiceBusConnectionString = \"&lt;your_connection_string&gt;\";\n        private const string TopicName = \"test-topic\";\n        private const string SubscriptionName = \"test-sub1\";\n\n        // _client is thread-safe. Recommended that you cache \n        // rather than recreating it on every request\n        private SubscriptionClient _client;\n\n        public override void Run() {\n            Trace.WriteLine(\"Starting processing of messages\");\n\n            try {\n                this.RunAsync(this._cancellationTokenSource.Token).Wait();\n            } catch (Exception e) {\n                Trace.WriteLine(\"Exception\");\n                Trace.WriteLine(e.ToString());\n            } finally {\n                Trace.WriteLine(\"Finally...\");\n                this._runCompleteEvent.Set();\n            }\n        }\n\n        public override bool OnStart() {\n            // Set the maximum number of concurrent connections \n            ServicePointManager.DefaultConnectionLimit = 12;\n\n            var result = base.OnStart();\n\n            Trace.WriteLine(\"WorkerRole has been started\");\n\n            return result;\n        }\n\n        public override void OnStop() {\n            // Close the connection to Service Bus Queue\n            this._cancellationTokenSource.Cancel();\n            this._runCompleteEvent.WaitOne();\n\n            base.OnStop();\n        }\n\n        private async Task RunAsync(CancellationToken cancellationToken) {\n            // Configure the client\n            RegisterOnMessageHandlerAndReceiveMessages(ServiceBusConnectionString, TopicName, SubscriptionName);\n\n            _runCompleteEvent.WaitOne();\n\n            Trace.WriteLine(\"Closing\");\n            await _client.CloseAsync();\n        }\n\n        private void RegisterOnMessageHandlerAndReceiveMessages(string connectionString, string topicName, string subscriptionName) {\n            _client = new SubscriptionClient(connectionString, topicName, subscriptionName);\n\n            var messageHandlerOptions = new MessageHandlerOptions(ExceptionReceivedHandler) {\n                // Maximum number of concurrent calls to the callback ProcessMessagesAsync(), set to 1 for simplicity.\n                // Set it according to how many messages the application wants to process in parallel.\n                MaxConcurrentCalls = 1,\n\n                // Indicates whether MessagePump should automatically complete the messages after returning from User Callback.\n                // False below indicates the Complete will be handled by the User Callback as in `ProcessMessagesAsync` below.\n                AutoComplete = false,\n            };\n\n            _client.RegisterMessageHandler(ProcessMessageAsync, messageHandlerOptions);\n        }\n\n        private async Task ProcessMessageAsync(Message message, CancellationToken token) {\n            try {\n                // Process the message\n                Trace.WriteLine($\"Received message: SequenceNumber:{message.SystemProperties.SequenceNumber} Body:{Encoding.UTF8.GetString(message.Body)}\");\n                await _client.CompleteAsync(message.SystemProperties.LockToken);\n            } catch (Exception e) {\n                // Handle any message processing specific exceptions here\n                Trace.Write(e.ToString());\n                await _client.AbandonAsync(message.SystemProperties.LockToken);\n            }\n        }\n\n        private static Task ExceptionReceivedHandler(ExceptionReceivedEventArgs exceptionReceivedEventArgs) {\n            Console.WriteLine($\"Message handler encountered an exception {exceptionReceivedEventArgs.Exception}.\");\n            var context = exceptionReceivedEventArgs.ExceptionReceivedContext;\n            Console.WriteLine(\"Exception context for troubleshooting:\");\n            Console.WriteLine($\"- Endpoint: {context.Endpoint}\");\n            Console.WriteLine($\"- Entity Path: {context.EntityPath}\");\n            Console.WriteLine($\"- Executing Action: {context.Action}\");\n            return Task.CompletedTask;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "edited": false, "score": 0, "creation_date": 1533760631, "post_id": 51755090, "comment_id": 90470192, "body": "Based on what you show that you&#39;re getting at the server, it looks like at least the ID is binding properly.  You may want to show some of your view code that shows how you are creating your form inputs - that&#39;s probably where your problem is."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 1, "creation_date": 1533765778, "post_id": 51755090, "comment_id": 90472059, "body": "The property names in the data you are sending is wrong - its <code>inventory.processed_items[0].id: GA-6570</code>, not <code>model.inventory.processed_items[0].id: GA-6570</code> (your <code>PackageViewModel</code> dos not contain a property named <code>model</code>)"}, {"owner": {"reputation": 127, "user_id": 3508924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab38bc2190805184bba15fff1d6266d3?s=128&d=identicon&r=PG&f=1", "display_name": "AnimalTesting", "link": "https://stackoverflow.com/users/3508924/animaltesting"}, "edited": false, "score": 0, "creation_date": 1533825038, "post_id": 51755090, "comment_id": 90497910, "body": "@StephenMuecke Thanks, didn&#39;t notice that, can you put that as an answer?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "is_accepted": true, "score": 1, "last_activity_date": 1533858054, "last_edit_date": 1533858054, "creation_date": 1533857622, "answer_id": 51777061, "question_id": 51755090, "link": "https://stackoverflow.com/questions/51755090/asp-net-nested-list-of-models-is-not-binding/51777061#51777061", "title": "ASP.NET nested list of models is not binding", "body": "<p>The property names for the values you are sending do not match the model you are binding to. <code>PackageViewModel</code> does not contain a property named <code>model</code> (it contains one named <code>inventory</code>), so instead of</p>\n\n<pre><code>model.inventory.processed_items[0].id: GA-6570\n</code></pre>\n\n<p>it needs to be</p>\n\n<pre><code>inventory.processed_items[0].id: GA-6570\n</code></pre>\n\n<p>An easy way to think about this is to consider how you would access the value of a property of the model in the POST method</p>\n\n<pre><code>public ActionResult Create(PackageViewModel packageVM)\n{\n    // get the id of the first item in processed_items\n    string id = packageVM.inventory.processed_items[0].id\n</code></pre>\n\n<p>Because the parameter in the method is named <code>packageVM</code>, just drop that prefix, (i.e. becomes <code>inventory.processed_items[0].id</code>), and that is what the name of the data needs to be in order to bind.</p>\n\n<p>As a side note, it you are using the strong typed <code>***For()</code> methods inside a <code>for</code> loop to generate your form controls based on your model, they will generate the correct <code>name</code> attributes, and you can just use <code>$('form').serialize()</code> to correctly generate the data to be sent via your ajax call.</p>\n"}], "owner": {"reputation": 127, "user_id": 3508924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab38bc2190805184bba15fff1d6266d3?s=128&d=identicon&r=PG&f=1", "display_name": "AnimalTesting", "link": "https://stackoverflow.com/users/3508924/animaltesting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 51777061, "answer_count": 1, "score": 0, "last_activity_date": 1533858054, "creation_date": 1533759867, "question_id": 51755090, "link": "https://stackoverflow.com/questions/51755090/asp-net-nested-list-of-models-is-not-binding", "title": "ASP.NET nested list of models is not binding", "body": "<p>I'm trying to post a list of models to the server, using ASP.NET's model binding and manipulating a bunch of values with JavaScript. When I send the values to the server, this is what I get:</p>\n\n<pre><code>model.inventory.processed_items[0].id: GA-6570\nmodel.inventory.processed_items[0].event: \nmodel.inventory.processed_items[0].subevent: \nmodel.inventory.processed_items[0].restrict_marking: \nmodel.inventory.processed_items[0].cecp_string: \nmodel.inventory.processed_items[0].discrepancies: \nmodel.inventory.processed_items.Index: 0\nmodel.inventory.processed_items[1].id: GD-1000\nmodel.inventory.processed_items[1].event: \nmodel.inventory.processed_items[1].subevent: \nmodel.inventory.processed_items[1].restrict_marking: \nmodel.inventory.processed_items[1].cecp_string: \nmodel.inventory.processed_items[1].discrepancies: \nmodel.inventory.processed_items.Index: 1\n</code></pre>\n\n<p>These are my model classes that I'm binding to (I've omitted any fields that don't really matter to the question):</p>\n\n<pre><code>public class PackageViewModel\n{\n    public InventoryViewModel inventory { get; set; }\n}\n\npublic class InventoryViewModel\n{\n    public List&lt;ProcessedItemViewModel&gt; processed_items { get; set; }\n}\n\npublic class ProcessedItemViewModel\n{\n    public string id { get; set; }\n    public int @event { get; set; }\n    public string subevent { get; set; }\n    public string cecp_string { get; set; }\n    public string restrict_marking { get; set; }\n    public string discrepancies { get; set; }\n    public string highest_classification { get; set; }\n    public int occurences_count { get; set; }\n\n    public IEnumerable&lt;ProcessedOccurenceViewModel&gt; occurences { get; set; }\n}\n\npublic class ProcessedOccurenceViewModel\n{\n    public string text { get; set; }\n    public string security_num { get; set; }\n    public Nullable&lt;int&gt; media_count { get; set; }\n    public string classification { get; set; }\n}\n</code></pre>\n\n<p>This is my controller:</p>\n\n<pre><code>[HttpGet]\npublic ActionResult Create()\n{\n    var inventoryVM = new InventoryViewModel\n    {\n        processed_items = new List&lt;ProcessedItemViewModel&gt;()\n    };\n\n    var packageVM = new PackageViewModel {\n        inventory = inventoryVM\n    };\n    return View(packageVM);\n}\n\n[HttpPost]\npublic ActionResult Create(PackageViewModel packageVM)\n{\n    if (ModelState.IsValid)\n    {\n         ...\n    }\n}\n</code></pre>\n\n<p>When I check packageVM in debugger, the values are not bound to the view model. However, other values excluding this nested list of models are included in the packageVM model during the POST request. I don't understand why this portion is not binding because I have supplied indices and also passed in an empty list to the view.</p>\n"}, {"tags": ["c#", "parallel-processing", "task-parallel-library"], "comments": [{"owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1533762627, "post_id": 51755034, "comment_id": 90471008, "body": "In short yes the <code>BoundedCapacity</code> sets both the Input and Output buffer capacity. It doesn&#39;t look like anything significant is being done in the example so it may just be that the buffers are empty."}, {"owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1533762922, "post_id": 51755034, "comment_id": 90471110, "body": "Also your <code>MaxDegreeOfParallelism</code> will affect how many items can processed concurrently regardless of buffer size (to an extent)"}, {"owner": {"reputation": 1517, "user_id": 1149816, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ffa5599d5902b13729f2d306bd0cc2d?s=128&d=identicon&r=PG", "display_name": "Devedse", "link": "https://stackoverflow.com/users/1149816/devedse"}, "reply_to_user": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1533803129, "post_id": 51755034, "comment_id": 90483230, "body": "Ok I understand that :), but the items that have not been processed by the &#39;putInListBlock&#39; do still exist somewhere. (They are waiting to be output in an ordered manner). But I can&#39;t find any property on either of those blocks that contains an integer with a value of 9 or 10 items are done but waiting to be output to the next block as we have not received a previous result."}, {"owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1533829942, "post_id": 51755034, "comment_id": 90501408, "body": "OK just so we&#39;re on the same page: you want the items processed in parallel and ordered, item 1 is slow, item 2-10 are fast. In that case those fast items will enter an internal re-ording buffer that holds the items untill all are ready to move along. It&#39;s been a while since I pulled up the source code but I&#39;ll take a look."}, {"owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1533830471, "post_id": 51755034, "comment_id": 90501689, "body": "And <a href=\"https://github.com/dotnet/corefx/blob/master/src/System.Threading.Tasks.Dataflow/src/Internal/ReorderingBuffer.cs\" rel=\"nofollow noreferrer\">here it is</a> you can dig around more to see exactly how it&#39;s used."}, {"owner": {"reputation": 1517, "user_id": 1149816, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ffa5599d5902b13729f2d306bd0cc2d?s=128&d=identicon&r=PG", "display_name": "Devedse", "link": "https://stackoverflow.com/users/1149816/devedse"}, "reply_to_user": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1533855818, "post_id": 51755034, "comment_id": 90512075, "body": "Ah yeah makes sense, but is there a way to see how much items are in this buffer?"}, {"owner": {"reputation": 6095, "user_id": 7339946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23485b61c5f33b4e4e67999df7988858?s=128&d=identicon&r=PG", "display_name": "JSteward", "link": "https://stackoverflow.com/users/7339946/jsteward"}, "edited": false, "score": 0, "creation_date": 1533855931, "post_id": 51755034, "comment_id": 90512108, "body": "I don&#39;t think so, not anything publicly exposed at least. You could use reflection to get a count out though."}], "owner": {"reputation": 1517, "user_id": 1149816, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2ffa5599d5902b13729f2d306bd0cc2d?s=128&d=identicon&r=PG", "display_name": "Devedse", "link": "https://stackoverflow.com/users/1149816/devedse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533759641, "creation_date": 1533759641, "question_id": 51755034, "link": "https://stackoverflow.com/questions/51755034/how-does-ordering-and-threading-work-in-tpl-dataflow-looking-for-some-insight", "title": "How does ordering and threading work in TPL DataFlow (Looking for some insight)", "body": "<p><strong>Intro</strong></p>\n\n<p>While working on parallelizing an application for myself I noticed that when an item further in the past takes a long time eventually there will be only one running thread while the rest waits for this item to be completed so that the output can be returned in an ordered fashion.</p>\n\n<p>This all seems fine as I simply commented out the ordered property and my program went full speed ahead.</p>\n\n<p><strong>My confusion</strong></p>\n\n<p>What I'm not fully understanding though is where those messages are when they are done with TransformBlock1 but waiting for a previous item to be completed by this block.</p>\n\n<p>In the code I posted here:</p>\n\n<p><a href=\"https://github.com/devedse/WpfParallelDataflowInvestigation\" rel=\"nofollow noreferrer\">https://github.com/devedse/WpfParallelDataflowInvestigation</a></p>\n\n<p><strong>Questions</strong></p>\n\n<p>I've got 3 concrete questions about this code:</p>\n\n<ol>\n<li>I've set the bound capacity of this block to 10. But does this bound capacity means that it will store 10 items in some kind of output buffer?</li>\n<li>It also seems the bounded capacity influences the number of items that can be queued (as can be seen at the start where 10 items get queued).</li>\n<li>I also log the In: .. and Out: .. buffer counts, but they stay 0 all the time. Where are my messages that are done processing but are waiting to be output untill that item 5 is complete?</li>\n</ol>\n\n<p><strong>The important code</strong></p>\n\n<pre><code>public async Task&lt;IEnumerable&lt;string&gt;&gt; ProcessInParallel(IOutputWriter logListener, int maxDegreeOfParallelism = 8)\n{\n    var theResults = new List&lt;string&gt;();\n\n    var processBlock = new TransformBlock&lt;int, string&gt;(async number =&gt;\n    {\n        var processedNumber = await ProcessNumber(number);\n\n        return processedNumber;\n    }, new ExecutionDataflowBlockOptions()\n    {\n        MaxDegreeOfParallelism = maxDegreeOfParallelism,\n        BoundedCapacity = 10\n    });\n\n    var putInListBlock = new ActionBlock&lt;string&gt;(t =&gt;\n    {\n\n        if (logListener != null)\n        {\n            logListener.WriteOutput(t);\n        }\n        theResults.Add(t);\n    }, SynchronizeForUiThread(new ExecutionDataflowBlockOptions()\n    {\n\n    }));\n\n    processBlock.LinkTo(putInListBlock, new DataflowLinkOptions() { PropagateCompletion = true });\n\n\n    var ttt = Task.Run(async () =&gt;\n    {\n        while (true)\n        {\n            Console.WriteLine($\"&gt;&gt;&gt;&gt;&gt; Threads: {currentThreadsRunning}     In: {processBlock.InputCount} Out: {processBlock.OutputCount}      &gt;&gt;    In: {putInListBlock.InputCount} Out: {putInListBlock.Completion.IsCompleted}\");\n            await Task.Delay(1000);\n        }\n    });\n\n    var numbers = EnumerateNumberList(100);\n    await Task.Run(async () =&gt;\n    {\n        foreach (var number in numbers)\n        {\n            Console.WriteLine($\"Posting: {number}\");\n            var result = await processBlock.SendAsync(number);\n\n            if (!result)\n            {\n                Console.WriteLine(\"Result is false!!!\");\n            }\n\n        }\n    });\n\n\n\n    Console.WriteLine(\"Completing\");\n    processBlock.Complete();\n    await putInListBlock.Completion;\n\n    return theResults;\n}\n</code></pre>\n\n<p><strong>Logging</strong></p>\n\n<pre><code>Posting: 0\n&gt;&gt;&gt;&gt;&gt; Threads: 0     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\nPosting: 1\nPosting: 2\nPosting: 3\nPosting: 4\nPosting: 5\nPosting: 6\nPosting: 7\nPosting: 8\nPosting: 9\nPosting: 10\n&gt;&gt;&gt;&gt;&gt; Threads: 8     In: 2 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 8     In: 2 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 8     In: 2 Out: 0      &gt;&gt;    In: 0 Out: False\nProcessed: 4\n&gt;&gt;&gt;&gt;&gt; Threads: 8     In: 1 Out: 0      &gt;&gt;    In: 0 Out: False\nProcessed: 7\n&gt;&gt;&gt;&gt;&gt; Threads: 8     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 8     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\nProcessed: 0\nPosting: 11\n&gt;&gt;&gt;&gt;&gt; Threads: 8     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 8     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\nProcessed: 3\nProcessed: 9\n&gt;&gt;&gt;&gt;&gt; Threads: 6     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\nProcessed: 8\nProcessed: 6\nProcessed: 2\nProcessed: 1\nPosting: 12\nPosting: 13\nPosting: 14\nPosting: 15\n&gt;&gt;&gt;&gt;&gt; Threads: 6     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 6     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\nProcessed: 10\n&gt;&gt;&gt;&gt;&gt; Threads: 5     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 5     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 5     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\nProcessed: 13\n&gt;&gt;&gt;&gt;&gt; Threads: 4     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 4     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\nProcessed: 11\nProcessed: 14\n&gt;&gt;&gt;&gt;&gt; Threads: 2     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\nProcessed: 12\n&gt;&gt;&gt;&gt;&gt; Threads: 1     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 1     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 1     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n&gt;&gt;&gt;&gt;&gt; Threads: 1     In: 0 Out: 0      &gt;&gt;    In: 0 Out: False\n</code></pre>\n"}, {"tags": ["c#", "iis", "file-upload", "asp.net-core", "windows-server-2012"], "answers": [{"comments": [{"owner": {"reputation": 874, "user_id": 2543778, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1a0ae46d51e31973129e4acf6c2f2df6?s=128&d=identicon&r=PG&f=1", "display_name": "IEnjoyEatingVegetables", "link": "https://stackoverflow.com/users/2543778/ienjoyeatingvegetables"}, "edited": false, "score": 1, "creation_date": 1533760271, "post_id": 51755142, "comment_id": 90469991, "body": "The files are sensitive, so I will be storing them outside wwwroot. Just found the line, &quot;Store them outside of wwwroot and any directory accessible to the static file middleware and...&quot; in the docs that stated that. :| Probably should of read that a more carefully... docs link -&gt; <a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/static-files?view=aspnetcore-2.1&amp;tabs=aspnetcore2x#usefileserver\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/aspnet/core/fundamentals/&hellip;</a>"}, {"owner": {"reputation": 874, "user_id": 2543778, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1a0ae46d51e31973129e4acf6c2f2df6?s=128&d=identicon&r=PG&f=1", "display_name": "IEnjoyEatingVegetables", "link": "https://stackoverflow.com/users/2543778/ienjoyeatingvegetables"}, "edited": false, "score": 0, "creation_date": 1533760379, "post_id": 51755142, "comment_id": 90470051, "body": "If the path is arbitrary then I can just right click project -&gt; Add -&gt; New Folder and store them there or I can create a folder on the server, right? Shouldn&#39;t matter?"}, {"owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "reply_to_user": {"reputation": 874, "user_id": 2543778, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1a0ae46d51e31973129e4acf6c2f2df6?s=128&d=identicon&r=PG&f=1", "display_name": "IEnjoyEatingVegetables", "link": "https://stackoverflow.com/users/2543778/ienjoyeatingvegetables"}, "edited": false, "score": 2, "creation_date": 1533760812, "post_id": 51755142, "comment_id": 90470271, "body": "Yes, either way will work.  If you are injecting IHostingEnvironment into your service, then you can use <code>hostingEnvironment.ContentRootPath</code> to get the absolute path of the top level of your file structure as seen in Visual Studio. <code>hostingEnvironment.WebRootPath</code> gives you the absolute path to wwwroot."}, {"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 1, "creation_date": 1533827330, "post_id": 51755142, "comment_id": 90499524, "body": "It would actually be better to keep it out of your project entirely. That way there&#39;s no chance of accidentally committing anything to source control, and you can deploy multiple copies of your app (load-balancing scenarios and such) that all read/write from a common directory. You can use your config to specify the directory and then switch that out based on environment as well."}, {"owner": {"reputation": 874, "user_id": 2543778, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1a0ae46d51e31973129e4acf6c2f2df6?s=128&d=identicon&r=PG&f=1", "display_name": "IEnjoyEatingVegetables", "link": "https://stackoverflow.com/users/2543778/ienjoyeatingvegetables"}, "reply_to_user": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "edited": false, "score": 0, "creation_date": 1533922404, "post_id": 51755142, "comment_id": 90540343, "body": "@ChrisPratt care to leave an answer?"}], "tags": [], "owner": {"reputation": 2708, "user_id": 4017643, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dave Smash", "link": "https://stackoverflow.com/users/4017643/dave-smash"}, "is_accepted": false, "score": 3, "last_activity_date": 1533760075, "creation_date": 1533760075, "answer_id": 51755142, "question_id": 51755011, "link": "https://stackoverflow.com/questions/51755011/should-i-create-my-folder-for-file-uploads-under-wwwroot-inside-visual-studio/51755142#51755142", "title": "Should I create my folder for file uploads under wwwroot inside visual studio?", "body": "<p>To the best of my understanding, unless you take special precautions, files under wwwroot can be downloaded freely by users, bots, etc. with no authentication.  If the files are not sensitive in nature, then there is nothing wrong with using wwwroot.  </p>\n\n<p>If you want to provide security at the controller level (e.g., a user can only view their own files), then it's probably better to put them elsewhere in the file system.  The path is kind of arbitrary, but the security settings on the folder must be set in such a way that the dotnet process can access it.  You can give Everyone full access, or be more restrictive if you see fit.  This is done directly on the OS of the server, assuming that you have access to it.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6487917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LpOaJ.jpg?s=128&g=1", "display_name": "fixmycode - Karl Kroenig", "link": "https://stackoverflow.com/users/6487917/fixmycode-karl-kroenig"}, "is_accepted": false, "score": 0, "last_activity_date": 1533762483, "creation_date": 1533762483, "answer_id": 51755671, "question_id": 51755011, "link": "https://stackoverflow.com/questions/51755011/should-i-create-my-folder-for-file-uploads-under-wwwroot-inside-visual-studio/51755671#51755671", "title": "Should I create my folder for file uploads under wwwroot inside visual studio?", "body": "<p>For 2 reasons I would not do that.\n1. Keep control and overview. I would create a subfolder and give it the needed rights to create and write uploaded files there.\n2. You are then free to change authorization if your requirements ever should change. </p>\n"}], "owner": {"reputation": 874, "user_id": 2543778, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1a0ae46d51e31973129e4acf6c2f2df6?s=128&d=identicon&r=PG&f=1", "display_name": "IEnjoyEatingVegetables", "link": "https://stackoverflow.com/users/2543778/ienjoyeatingvegetables"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1483, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1533762483, "creation_date": 1533759579, "question_id": 51755011, "link": "https://stackoverflow.com/questions/51755011/should-i-create-my-folder-for-file-uploads-under-wwwroot-inside-visual-studio", "title": "Should I create my folder for file uploads under wwwroot inside visual studio?", "body": "<p>If I were to follow this <a href=\"https://tahirnaushad.com/2017/08/28/uploaddownload-files-in-asp-net-core-2-0/\" rel=\"nofollow noreferrer\">example</a> file uploads would be stored in the wwwroot file. It is my understanding this file is where you should store static files that will be served to the user. Sure, I want my users to be able to download but is there a filesystem, specific to asp.net core/IIS/Windows Server 2012, that would be best? I'm expecting around 10,000 files max after several years.</p>\n\n<p>I'm planning on creating a folder for the uploaded documents, I'm just unsure of where to place it.</p>\n\n<p>Note: The answer provided <a href=\"https://stackoverflow.com/questions/40129374/how-to-store-uploaded-files-in-secure-folder-and-it-can-be-accessed-securely-in\">here</a> was not sufficient</p>\n"}, {"tags": ["c#", "unity3d", "move"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9782267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935eabb2e26f9d9039d5071c3eaa7b25?s=128&d=identicon&r=PG&f=1", "display_name": "Kris ", "link": "https://stackoverflow.com/users/9782267/kris"}, "edited": false, "score": 0, "creation_date": 1533764203, "post_id": 51755930, "comment_id": 90471521, "body": "thanks I will try it.  Should I name the player &quot;other&quot; so it knows to follow the player?"}], "tags": [], "owner": {"reputation": 420, "user_id": 5240355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bl7Wb.jpg?s=128&g=1", "display_name": "Arslan Ali", "link": "https://stackoverflow.com/users/5240355/arslan-ali"}, "is_accepted": false, "score": 1, "last_activity_date": 1533763900, "creation_date": 1533763900, "answer_id": 51755930, "question_id": 51755000, "link": "https://stackoverflow.com/questions/51755000/make-enemy-follow-you-when-within-a-certain-distance/51755930#51755930", "title": "Make enemy follow you when within a certain distance", "body": "<p>Check for the distance between enemy and player using <strong>Vector3.Distance(otherPos,transformPos)</strong>\nand made check for distance according to your choice if it's less than <strong>distVal</strong>, then enemy should follow or action performed</p>\n\n<pre><code>var distVal=5.0f;\nvar dis=Vector3.Distance(enemyTransform.position,playerTransform.position);\nif(dis&lt;=disVal)\n{\n  //what enemy should do.\n}\n</code></pre>\n\n<p>Next is your own choice for normalization of vectors you set while read for distance document <a href=\"https://docs.unity3d.com/ScriptReference/Vector3.Distance.html\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 7206231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-Bhu6xTqkglU/AAAAAAAAAAI/AAAAAAAAAHw/9ajDY6B8BoE/photo.jpg?sz=128", "display_name": "Mark Quinn", "link": "https://stackoverflow.com/users/7206231/mark-quinn"}, "is_accepted": false, "score": 0, "last_activity_date": 1533889984, "creation_date": 1533889984, "answer_id": 51782283, "question_id": 51755000, "link": "https://stackoverflow.com/questions/51755000/make-enemy-follow-you-when-within-a-certain-distance/51782283#51782283", "title": "Make enemy follow you when within a certain distance", "body": "<p>Arslan's answer is fine -\njust adding a slight change to the code so you know it can be done this way too...</p>\n\n<pre><code>var distVal=5.0f;        \nif (Vector3.Distance(enemyTransform.position, playerTransform.position) &lt; disVal)\n            {\n                Debug.Log(\"Enemy following you\");\n            }\n</code></pre>\n\n<p>It's much the same but good to know of other ways it exists.</p>\n"}], "owner": {"reputation": 19, "user_id": 9782267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935eabb2e26f9d9039d5071c3eaa7b25?s=128&d=identicon&r=PG&f=1", "display_name": "Kris ", "link": "https://stackoverflow.com/users/9782267/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 642, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1533889984, "creation_date": 1533759540, "last_edit_date": 1533768342, "question_id": 51755000, "link": "https://stackoverflow.com/questions/51755000/make-enemy-follow-you-when-within-a-certain-distance", "title": "Make enemy follow you when within a certain distance", "body": "<p>I have enemies move along a set path (way points) but I want an enemy to follow the player when you are within a certain distance of it but then when out of that distance, the enemy goes back to its way points and continues moving along the path until the player is within a certain distance again. So it keeps doing that.  Below is the code I got for the enemies to move along the way points.</p>\n\n<p>I am using Unity 2d and C# </p>\n\n<pre><code>[SerializeField]\nTransform[] waypoints; //EnemyWayPoint;\n\n[SerializeField]\nfloat moveSpeed = 3f;\nint waypointIndex = 0;\n\nprivate void Start()\n{\n    transform.position = waypoints[waypointIndex].transform.position;\n}\n\n\nprivate void Update()\n{\n    Move();\n}\n\nprivate void Move()\n{\n    transform.position = Vector3.MoveTowards(transform.position, waypoints[waypointIndex].transform.position, moveSpeed * Time.deltaTime);\n\n    if (transform.position == waypoints[waypointIndex].transform.position) { \n        waypointIndex += 1;\n    }\n\n    if (waypointIndex == waypoints.Length)\n        waypointIndex = 0;\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "amazon-s3"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3197068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79190bd274f08c3347a379c6c453eb9a?s=128&d=identicon&r=PG&f=1", "display_name": "user226876", "link": "https://stackoverflow.com/users/3197068/user226876"}, "edited": false, "score": 0, "creation_date": 1585614501, "post_id": 51804757, "comment_id": 107817792, "body": "Hi Phil, did this code work for you? I got error <code>Cannot convert lambda expression to type &#39;string&#39; because it is not a delegate type</code> when I <code>InitiateMultipartUploadAsync</code>."}], "tags": [], "owner": {"reputation": 163, "user_id": 6823899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff350e21c6ca08039a039aac7a3c2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6823899/phil"}, "is_accepted": true, "score": 0, "last_activity_date": 1534033216, "creation_date": 1534033216, "answer_id": 51804757, "question_id": 51754982, "link": "https://stackoverflow.com/questions/51754982/amazon-s3-multipartupload-c-not-working/51804757#51804757", "title": "Amazon S3 MultiPartUpload C# not working", "body": "<p>In case someone else as the same bug, I changed the code completly and used this solution : <a href=\"https://github.com/aws/aws-sdk-net/issues/562\" rel=\"nofollow noreferrer\">https://github.com/aws/aws-sdk-net/issues/562</a></p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 3197068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79190bd274f08c3347a379c6c453eb9a?s=128&d=identicon&r=PG&f=1", "display_name": "user226876", "link": "https://stackoverflow.com/users/3197068/user226876"}, "is_accepted": false, "score": 0, "last_activity_date": 1585627244, "creation_date": 1585627244, "answer_id": 60943260, "question_id": 51754982, "link": "https://stackoverflow.com/questions/51754982/amazon-s3-multipartupload-c-not-working/60943260#60943260", "title": "Amazon S3 MultiPartUpload C# not working", "body": "<p>you can initiate it like this: </p>\n\n<pre><code>            s3Client = new AmazonS3Client(BUCKETREGION);\n            var initiateRequest = new InitiateMultipartUploadRequest { BucketName = BUCKET, Key = KEY };\n\n            await s3Client.InitiateMultipartUploadAsync(initiateRequest).ContinueWith(response =&gt;\n              {\n                  if (!string.IsNullOrEmpty(response.Result.UploadId))\n                  {\n                      uploadId = response.Result.UploadId;\n                  }\n                  else\n                  {\n                      Debug.WriteLine(response.Exception);\n                  }\n              });\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 6823899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ff350e21c6ca08039a039aac7a3c2de2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6823899/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 51804757, "answer_count": 2, "score": 0, "last_activity_date": 1585627244, "creation_date": 1533759465, "question_id": 51754982, "link": "https://stackoverflow.com/questions/51754982/amazon-s3-multipartupload-c-not-working", "title": "Amazon S3 MultiPartUpload C# not working", "body": "<p>I've been struggling for hours with this problem, I hope you can help me.  Somehow my compiler will only accept InitiateMultipartUploadAsync and not the regular InitiateMultipartUpload and absolutely requires the callback as parameters to compile, but I can figure out what callback function to give him.</p>\n\n<pre><code>private static async Task UploadObjectAsync()\n{\n    // Create list to store upload part responses.\n    List&lt;UploadPartResponse&gt; uploadResponses = new List&lt;UploadPartResponse&gt;();\n    // Setup information required to initiate the multipart upload.\n    InitiateMultipartUploadRequest initiateRequest = new InitiateMultipartUploadRequest\n    {\n        BucketName = \"XXXXXXXXX\",\n        Key = \"videos/multipart\"\n    };\n\n    // Initiate the upload.\n\n    InitiateMultipartUploadResponse initResponse =\n        await S3Client.InitiateMultipartUploadAsync(initiateRequest);\n\n    // Upload parts.\n    long contentLength = new FileInfo(\"videotest\").Length;\n    long partSize = 5 * (long)Math.Pow(2, 20); // 5 MB\n\n    try\n    {\n        Console.WriteLine(\"Uploading parts\");\n\n        long filePosition = 0;\n        for (int i = 1; filePosition &lt; contentLength; i++)\n        {\n            UploadPartRequest uploadRequest = new UploadPartRequest\n            {\n                BucketName = \"XXXXXXXX\",\n                Key = \"videos/multipart\",\n                UploadId = initResponse.UploadId,\n                PartNumber = i,\n                PartSize = partSize,\n                FilePosition = filePosition,\n                FilePath = \"videotest\"\n            };\n\n            // Track upload progress.\n            uploadRequest.StreamTransferProgress +=\n                new EventHandler&lt;StreamTransferProgressArgs&gt;(UploadPartProgressEventCallback);\n\n            // Upload a part and add the response to our list.\n            uploadResponses.Add(await S3Client.UploadPartAsync(uploadRequest));\n\n            filePosition += partSize;\n        }\n\n        // Setup to complete the upload.\n        CompleteMultipartUploadRequest completeRequest = new CompleteMultipartUploadRequest\n        {\n            BucketName = \"XXXXXXXXXXX\",\n            Key = \"videos/multipart\",\n            UploadId = initResponse.UploadId\n        };\n        completeRequest.AddPartETags(uploadResponses);\n\n        // Complete the upload.\n\n        CompleteMultipartUploadResponse completeUploadResponse =\n            await S3Client.CompleteMultipartUploadAsync(completeRequest);\n    }\n    catch (Exception exception)\n    {\n        Console.WriteLine(\"An AmazonS3Exception was thrown: {0}\", exception.Message);\n\n        // Abort the upload.\n        AbortMultipartUploadRequest abortMPURequest = new AbortMultipartUploadRequest\n        {\n            BucketName = \"XXXXXXXXX\",\n            Key = \"videos/multipart\",\n            UploadId = initResponse.UploadId\n        };\n        await S3Client.AbortMultipartUploadAsync(abortMPURequest);\n    }\n}\npublic static void UploadPartProgressEventCallback(object sender, StreamTransferProgressArgs e)\n{\n    // Process event. \n    Console.WriteLine(\"{0}/{1}\", e.TransferredBytes, e.TotalBytes);\n}\n</code></pre>\n\n<p>This code was inspired from the offical aws example : <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/LLuploadFileDotNet.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/AmazonS3/latest/dev/LLuploadFileDotNet.html</a>  So I really don't understand why this doesn't work !  Currently with above code, Visual Studio is telling me that InitiateMultipartUploadAsync, UploadPartAsync, CompleteMultipartUploadAsync and AbortMultipartUploadAsync all require a callback function, but 1) examples says callback is optional 2) every callback I tried doesn't work.  Thanks in advance</p>\n"}, {"tags": ["c#", ".net", "text-files", "zebra-printers", "printdocument"], "comments": [{"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1533760239, "post_id": 51754966, "comment_id": 90469966, "body": "Why must you use EPL? The Zebra printer driver supports printing text and graphics through the PrintDocument API just fine."}, {"owner": {"reputation": 13, "user_id": 7202281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc4b419484813eefa1a75eba7caf1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Cabrera", "link": "https://stackoverflow.com/users/7202281/jose-cabrera"}, "reply_to_user": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1533760772, "post_id": 51754966, "comment_id": 90470250, "body": "I will try that out"}, {"owner": {"reputation": 13, "user_id": 7202281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc4b419484813eefa1a75eba7caf1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Cabrera", "link": "https://stackoverflow.com/users/7202281/jose-cabrera"}, "reply_to_user": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1533943328, "post_id": 51754966, "comment_id": 90547680, "body": "@DourHighArch I got it working with graphics, thank you"}], "answers": [{"tags": [], "owner": {"reputation": 299, "user_id": 1436476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31784ec2475e3784e6c7901d2c8b60c5?s=128&d=identicon&r=PG", "display_name": "RonaldPaguay", "link": "https://stackoverflow.com/users/1436476/ronaldpaguay"}, "is_accepted": false, "score": 0, "last_activity_date": 1533849669, "creation_date": 1533849669, "answer_id": 51775941, "question_id": 51754966, "link": "https://stackoverflow.com/questions/51754966/print-to-zebra-printer-tlp-3842/51775941#51775941", "title": "Print To Zebra Printer TLP 3842", "body": "<p>You need to add RawPrinterHelperClass to your project, and then print like this</p>\n\n<pre><code>string ZPL_STRING = \"^XA^LL440,^FO50,50^A0N,50,50^FDTesting Zebra Printer^FS^XZ\";\nRawPrinterHelper.SendStringToPrinter(\"PrinterName\", ZPL_STRING)\n</code></pre>\n\n<p>C# Class\n<a href=\"https://github.com/andyyou/SendToPrinter/blob/master/Printer/RawPrinterHelper.cs\" rel=\"nofollow noreferrer\">https://github.com/andyyou/SendToPrinter/blob/master/Printer/RawPrinterHelper.cs</a></p>\n"}], "owner": {"reputation": 13, "user_id": 7202281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcc4b419484813eefa1a75eba7caf1c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jose Cabrera", "link": "https://stackoverflow.com/users/7202281/jose-cabrera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 384, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533849669, "creation_date": 1533759389, "question_id": 51754966, "link": "https://stackoverflow.com/questions/51754966/print-to-zebra-printer-tlp-3842", "title": "Print To Zebra Printer TLP 3842", "body": "<p>How can I print to Zebra Printer TLP 3842 using EPL Programming? The printer doesn't support Zebra Printer Language (ZPL) and I am using PrintDocument(). I been on this problem for two weeks and can't figure it out. This what I have so far in my code, that actually runs the printer: </p>\n\n<pre><code>private System.ComponentModel.Container Components;\n    private System.Windows.Forms.Button PrintButton;\n    private Font PrintFont;\n    private StreamReader StreamToPrint;\n\n    private void PrintButton_Click(Object Sender, EventArgs e)\n    {\n        try\n        {\n            StreamToPrint = new StreamReader(\"C:\\\\Users\\\\jcabrera\\\\Desktop\\\\MyFile.txt\");\n            //string ZPL_STRING = \"^XA^LL440,^FO50,50^A0N,50,50^FDTesting Zebra Printer^FS^XZ\";\n\n            // ZPL Command(s)\n\n\n            try\n            {\n                PrintFont = new Font(\"Arial\", 10);\n                PrintDocument PD = new PrintDocument();\n                PD.PrintPage += new PrintPageEventHandler(this.PD_PrintPage);\n                PD.Print();\n\n            }\n            finally\n            {\n                StreamToPrint.Close();\n            }\n        } catch(Exception ex)\n        {\n            MessageBox.Show(ex.Message);\n        }\n    }\n\n    private void PD_PrintPage(object Sender, PrintPageEventArgs ev)\n    {\n        float linesPerPage = 0;\n        float yPos = 0;\n        int count = 0;\n        float leftMargin = ev.MarginBounds.Left;\n        float topMargin = ev.MarginBounds.Top;\n        string line = null;\n\n        // Calculate the number of lines per page.\n        linesPerPage = ev.MarginBounds.Height /\n           PrintFont.GetHeight(ev.Graphics);\n\n        // Print each line of the file.\n        while (count &lt; linesPerPage &amp;&amp;\n           ((line = StreamToPrint.ReadLine()) != null))\n        {\n            yPos = topMargin + (count *\n               PrintFont.GetHeight(ev.Graphics));\n            ev.Graphics.DrawString(line, PrintFont, Brushes.Black,\n               leftMargin, yPos, new StringFormat());\n            count++;\n        }\n\n        // If more lines exist, print another page.\n        if (line != null)\n            ev.HasMorePages = true;\n        else\n            ev.HasMorePages = false;\n    }\n\n    private void InitializeComponent()\n    {\n        this.Components = new System.ComponentModel.Container();\n        this.PrintButton = new System.Windows.Forms.Button();\n\n        this.ClientSize = new System.Drawing.Size(504, 381);\n        this.Text = \"Print Example\";\n\n        PrintButton.ImageAlign = System.Drawing.ContentAlignment.MiddleLeft;\n        PrintButton.Location = new System.Drawing.Point(32, 110);\n        PrintButton.FlatStyle = System.Windows.Forms.FlatStyle.Flat;\n        PrintButton.TabIndex = 0;\n        PrintButton.Text = \"Print the file.\";\n        PrintButton.Size = new System.Drawing.Size(136, 40);\n        PrintButton.Click += new System.EventHandler(PrintButton_Click);\n        this.Controls.Add(PrintButton);\n    }\n</code></pre>\n\n<p>Using Windows Application project.</p>\n"}, {"tags": ["c#", ".net", "serialization"], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 869633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a84cbd194d3929ab9211dcbcfe1e22?s=128&d=identicon&r=PG", "display_name": "Kammersgaard", "link": "https://stackoverflow.com/users/869633/kammersgaard"}, "is_accepted": false, "score": 0, "last_activity_date": 1533760012, "creation_date": 1533760012, "answer_id": 51755122, "question_id": 51754963, "link": "https://stackoverflow.com/questions/51754963/read-a-c-serialized-class/51755122#51755122", "title": "Read a C# serialized class", "body": "<p>You could easily deserialize the file using the <a href=\"https://docs.microsoft.com/en-gb/dotnet/api/system.io.binaryreader?view=netframework-4.7\" rel=\"nofollow noreferrer\">BinaryReader</a> class.</p>\n"}], "owner": {"reputation": 205, "user_id": 4775650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5ecabe1d231f0633c563893f1740185?s=128&d=identicon&r=PG&f=1", "display_name": "mt025", "link": "https://stackoverflow.com/users/4775650/mt025"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1533760012, "creation_date": 1533759381, "question_id": 51754963, "link": "https://stackoverflow.com/questions/51754963/read-a-c-serialized-class", "title": "Read a C# serialized class", "body": "<p>I have an application that writes to a serialized class, in a binary format. Opening the file in notepad shows some data and what appears to be the structure. </p>\n\n<p>Is there any way of reading (and hopefully editing) this in a GUI debug view, such as in visual studio or with a third party application, without writing the code to parse/de-serialize it? </p>\n\n<p>Or should I just go ahead and write a wrapper that will desterilize into an <code>object</code> and output that?</p>\n"}, {"tags": ["c#", "xml", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 2334, "user_id": 9893154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5vkTj.jpg?s=128&g=1", "display_name": "\u30bf\u30b3\u30b9", "link": "https://stackoverflow.com/users/9893154/%e3%82%bf%e3%82%b3%e3%82%b9"}, "edited": false, "score": 0, "creation_date": 1534189007, "post_id": 51760894, "comment_id": 90613213, "body": "This was the issue; however, there are two things. 1. I had to remove the type specification altogether for enums (not sure why). 2. I am stull unsure as to why this caused a compile time error instead of runtime."}], "tags": [], "owner": {"reputation": 6997, "user_id": 4646738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/afLRC.png?s=128&g=1", "display_name": "V0ldek", "link": "https://stackoverflow.com/users/4646738/v0ldek"}, "is_accepted": true, "score": 1, "last_activity_date": 1533798901, "creation_date": 1533798901, "answer_id": 51760894, "question_id": 51754908, "link": "https://stackoverflow.com/questions/51754908/xmlattributeattribute-datatype-property/51760894#51760894", "title": "XmlAttributeAttribute DataType Property?", "body": "<p>The <code>DataType</code> is used for simple types in the <code>xsd</code> namespace, so <code>string</code> for example. For complex types you specify the <code>Type</code> property of the <code>XmlAttributeAttribute</code>. So since <code>xsd:string</code> is a simple type in the <code>xsd</code> namespace, you use</p>\n\n<pre><code>[XmlAttribute(\"Name\", DataType = \"string\")]\n</code></pre>\n\n<p>If you had, as you've mentioned, a custom enum, you'd do</p>\n\n<pre><code>[XmlAttribute(\"Name\", typeof(MyEnum))]\n</code></pre>\n"}], "owner": {"reputation": 2334, "user_id": 9893154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5vkTj.jpg?s=128&g=1", "display_name": "\u30bf\u30b3\u30b9", "link": "https://stackoverflow.com/users/9893154/%e3%82%bf%e3%82%b3%e3%82%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 51760894, "answer_count": 1, "score": 0, "last_activity_date": 1533798901, "creation_date": 1533759201, "question_id": 51754908, "link": "https://stackoverflow.com/questions/51754908/xmlattributeattribute-datatype-property", "title": "XmlAttributeAttribute DataType Property?", "body": "<p>I haven't found any exact documentation on this and there's not really much to the question; are we required to use <code>DataType = \"string\"</code> instead of <code>typeof(string)</code> when working with the <code>XmlAttributeAttribute</code>? For example:</p>\n\n<pre><code>XmlAttribute(\"Description\", DataType = \"string\")\nXmlAttribute(\"Description\", typeof(string))\n</code></pre>\n\n<p>Both of the lines above compile; however, when using the <code>typeof(string)</code> method, I get an error saying primitive types can't be specified (could this be related to the nesting of classes and overridden properties?).</p>\n\n<p>If you remove the <code>DataType</code> all together, for some reason reflection fails and the build won't succeed.</p>\n\n<p>Am I doing something wrong, or is this the way it is meant to be? If the requirement is to use the <code>DataType</code> method, then how do you specify custom types such as <code>enum</code>?</p>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1533764123, "post_id": 51754745, "comment_id": 90471490, "body": "See the answer from <a href=\"https://stackoverflow.com/a/51755058/3785314\">Falcon</a>. Don&#39;t ignore that because that&#39;s your issue."}, {"owner": {"reputation": 979, "user_id": 8556545, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1a75d5538fa0bccfd9594c1fe4c50e45?s=128&d=identicon&r=PG&f=1", "display_name": "TaouBen", "link": "https://stackoverflow.com/users/8556545/taouben"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1533764440, "post_id": 51754745, "comment_id": 90471614, "body": "I did not ignore it .."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 8618827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68a83b23d970125a2d612bdfb118c604?s=128&d=identicon&r=PG&f=1", "display_name": "Falcon", "link": "https://stackoverflow.com/users/8618827/falcon"}, "is_accepted": true, "score": 2, "last_activity_date": 1533759771, "creation_date": 1533759771, "answer_id": 51755058, "question_id": 51754745, "link": "https://stackoverflow.com/questions/51754745/transform-position-not-setting-correct-position-in-unity/51755058#51755058", "title": "transform.position not setting correct position in Unity?", "body": "<p>You are moving object with transform.Translate every frame, so immediately after setting up new position, your object is moved again. Notice that in your case trn, and transform, refers to the same Transform component.</p>\n"}, {"comments": [{"owner": {"reputation": 979, "user_id": 8556545, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1a75d5538fa0bccfd9594c1fe4c50e45?s=128&d=identicon&r=PG&f=1", "display_name": "TaouBen", "link": "https://stackoverflow.com/users/8556545/taouben"}, "edited": false, "score": 0, "creation_date": 1533762405, "post_id": 51755609, "comment_id": 90470926, "body": "Yes, true .. I added the getTransform&lt;&gt;() function just to chekc if things would work with it.. but that is not the problem, the new values in my capture is the problem, I dont know from where they re coming .."}], "tags": [], "owner": {"reputation": 348, "user_id": 7563114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbJY4.png?s=128&g=1", "display_name": "Aykut Karaca", "link": "https://stackoverflow.com/users/7563114/aykut-karaca"}, "is_accepted": false, "score": 0, "last_activity_date": 1533762650, "last_edit_date": 1533762650, "creation_date": 1533762192, "answer_id": 51755609, "question_id": 51754745, "link": "https://stackoverflow.com/questions/51754745/transform-position-not-setting-correct-position-in-unity/51755609#51755609", "title": "transform.position not setting correct position in Unity?", "body": "<p>Why don't you change your <code>trn.position=</code> to <code>transform.position=</code> I don't think you need <code>GetComponent&lt;&gt;</code> for transform component of the current gameObject. Or maybe related to <code>relativeTo</code> parameter of <code>.Translate</code> method.</p>\n"}], "owner": {"reputation": 979, "user_id": 8556545, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1a75d5538fa0bccfd9594c1fe4c50e45?s=128&d=identicon&r=PG&f=1", "display_name": "TaouBen", "link": "https://stackoverflow.com/users/8556545/taouben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1566, "favorite_count": 0, "accepted_answer_id": 51755058, "answer_count": 2, "score": 0, "last_activity_date": 1533768395, "creation_date": 1533758511, "last_edit_date": 1533768395, "question_id": 51754745, "link": "https://stackoverflow.com/questions/51754745/transform-position-not-setting-correct-position-in-unity", "title": "transform.position not setting correct position in Unity?", "body": "<p>I am having this problem that I don't know how to solve, I have a moving object that return to a position if a condition is verified, but it seems like it is working sometimes, but sometimes it is not .. </p>\n\n<p>Here is my script : </p>\n\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class MovingDes : MonoBehaviour {\n    private float speed = 5f;\n    Transform trn;\n    //-37.6914\n    //62.32123\n    // Use this for initialization\n    void Start() {\n        trn = GetComponent&lt;Transform&gt;();\n    }\n\n    // Update is called once per frame\n    void Update() {\n        transform.Translate(Vector3.back * (speed * Time.deltaTime));\n        if(transform.position.z &lt;= -37.6914){\n            Vector3 newPosition = new Vector3(17.5f,125.7f,165.32123f);\n            trn.position = newPosition;\n        }\n    }\n}\n</code></pre>\n\n<p>The problem is that I can see in my Unity editor that the position is different from what I have set, and I don't understand from Where those values came from, I did not write them for sure.</p>\n\n<p><a href=\"https://i.stack.imgur.com/q9N0r.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q9N0r.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["c#", "ios", "xamarin", "xamarin.ios"], "comments": [{"owner": {"reputation": 35, "user_id": 9814137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d148cb369a78b888356a34396083e25d?s=128&d=identicon&r=PG&f=1", "display_name": "J Buff", "link": "https://stackoverflow.com/users/9814137/j-buff"}, "reply_to_user": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 0, "creation_date": 1533760451, "post_id": 51754725, "comment_id": 90470084, "body": "@Jason Explination?"}, {"owner": {"reputation": 72617, "user_id": 1338, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/IUjpi.png?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/1338/jason"}, "edited": false, "score": 1, "creation_date": 1533761515, "post_id": 51754725, "comment_id": 90470579, "body": "just writing text to a file can be done with the standard .NET File IO classes.  It&#39;s unclear from you question what exactly you don&#39;t know how to do.  Perhaps if you posted the relevant code and clearly explained what specific problem you don&#39;t know how to solve?"}], "owner": {"reputation": 35, "user_id": 9814137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d148cb369a78b888356a34396083e25d?s=128&d=identicon&r=PG&f=1", "display_name": "J Buff", "link": "https://stackoverflow.com/users/9814137/j-buff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533758410, "creation_date": 1533758410, "question_id": 51754725, "link": "https://stackoverflow.com/questions/51754725/how-do-i-record-button-inputs-from-xamarin-ios-into-txt-file", "title": "How do I record button input(s) from Xamarin.iOS into txt file?", "body": "<p>I am trying to use the storyboard button, and when it is pressed, record it in a text file.</p>\n\n<p>Then, when another button is pressed, it be recorded in the same text file.</p>\n\n<p>Then, record user input from a text box (know how to do this, except) into the same file we were working with before.</p>\n\n<p>And at last, save it to the SpecialFolder.Documents folder. (I know how to do this)</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "sql-server", "entity-framework-6"], "answers": [{"comments": [{"owner": {"reputation": 686, "user_id": 4464567, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9ce21f9e271e8cf89efd4e87b9ef451?s=128&d=identicon&r=PG&f=1", "display_name": "Endi Zhupani", "link": "https://stackoverflow.com/users/4464567/endi-zhupani"}, "edited": false, "score": 0, "creation_date": 1533759182, "post_id": 51754818, "comment_id": 90469422, "body": "Is there any way to prevent the records accessed by the transaction from being read? See post update for the case I am trying to avoid."}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "reply_to_user": {"reputation": 686, "user_id": 4464567, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9ce21f9e271e8cf89efd4e87b9ef451?s=128&d=identicon&r=PG&f=1", "display_name": "Endi Zhupani", "link": "https://stackoverflow.com/users/4464567/endi-zhupani"}, "edited": false, "score": 1, "creation_date": 1533759334, "post_id": 51754818, "comment_id": 90469494, "body": "@EndiZhupani: well, if you need to prevent any other transactions from reading a row, you need to read it with more than just a (S) shared lock - you need to put an exclusive (X) lock onto that row and hang on to it (until your transaction is done). See <a href=\"https://docs.microsoft.com/en-us/sql/t-sql/queries/hints-transact-sql-table?view=sql-server-2017\" rel=\"nofollow noreferrer\">SQL Server table hints</a> for details, and see <a href=\"http://sqlblog.com/blogs/louis_davidson/archive/2006/12/13/does-xlock-always-prevent-reads-by-others.aspx\" rel=\"nofollow noreferrer\">this blog post of a warning about XLOCK</a>"}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "reply_to_user": {"reputation": 686, "user_id": 4464567, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9ce21f9e271e8cf89efd4e87b9ef451?s=128&d=identicon&r=PG&f=1", "display_name": "Endi Zhupani", "link": "https://stackoverflow.com/users/4464567/endi-zhupani"}, "edited": false, "score": 0, "creation_date": 1533759384, "post_id": 51754818, "comment_id": 90469518, "body": "@EndiZhupani: but if you&#39;re just trying to increment a number, <b>don&#39;t do this yourself</b> - let SQL Server handle this for you. Use an <code>INT IDENTITY</code> column, or if you can&#39;t use that, use a <code>SEQUENCE</code> object (in SQL Server <b>2012</b> and newer) to handle the incrementing of a counter"}, {"owner": {"reputation": 686, "user_id": 4464567, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9ce21f9e271e8cf89efd4e87b9ef451?s=128&d=identicon&r=PG&f=1", "display_name": "Endi Zhupani", "link": "https://stackoverflow.com/users/4464567/endi-zhupani"}, "edited": false, "score": 0, "creation_date": 1533760282, "post_id": 51754818, "comment_id": 90469998, "body": "The <code>IDENTITY</code> column is incremented with each new record, right? And the <code>SEQUENCE</code> object database-wide as far as I know. The column I&#39;m trying to increment is a download count. So, each row is incremented by its own. Which is why I don&#39;t think I can use those. But I think I&#39;ll handle this with a transaction inside a stored procedure and an exclusive lock during reads. Thanks for the (X) lock suggestion."}], "tags": [], "owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1533758837, "creation_date": 1533758837, "answer_id": 51754818, "question_id": 51754703, "link": "https://stackoverflow.com/questions/51754703/are-the-transaction-scopes-in-entity-framework-only-valid-for-the-specific-conne/51754818#51754818", "title": "Are the transaction scopes in Entity Framework only valid for the specific connection?", "body": "<p>Transaction - or more precisely: the locks they take and hold - are of course database-wide - they are specifically designed to prevent other transactions / sessions from doing certain things.</p>\n\n<p>And yes, the <code>Serializable</code> isolation level is the \"highest\", most restrictive isolation level - if your transaction reads rows and uses some conditions in the <code>WHERE</code> clause, SQL Server will use range-based <strong>(S)</strong> shared locks to prevent any other transaction from <strong>modifying</strong> (updating, deleting, or even inserting into these locked ranges) any data.</p>\n\n<p><strong><em>BUT</em></strong>: reading transactions use <strong>shared locks</strong> (S) by default, and those <strong>DO NOT</strong> prevent other transactions from <strong>reading</strong> those rows - shared locks, as the name implies, <em>can be shared</em> between reading transactions.</p>\n"}], "owner": {"reputation": 686, "user_id": 4464567, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9ce21f9e271e8cf89efd4e87b9ef451?s=128&d=identicon&r=PG&f=1", "display_name": "Endi Zhupani", "link": "https://stackoverflow.com/users/4464567/endi-zhupani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 51754818, "answer_count": 1, "score": 2, "last_activity_date": 1533759140, "creation_date": 1533758314, "last_edit_date": 1533759140, "question_id": 51754703, "link": "https://stackoverflow.com/questions/51754703/are-the-transaction-scopes-in-entity-framework-only-valid-for-the-specific-conne", "title": "Are the transaction scopes in Entity Framework only valid for the specific connection?", "body": "<p>I am using Entity Framework in a web application and I have a piece of code communicating with the database that is inside a transaction like this:</p>\n\n<pre><code>using (DbContextTransaction transScope = ctx.Database.BeginTransaction(System.Data.IsolationLevel.Serializable))\n{\n    // some code here.\n    transScope.Commit();\n}\n</code></pre>\n\n<p>The isolation level <code>Serializable</code>, from what I read is supposed to be the highest level of isolation, preventing even reads from the records that have been accessed during this transaction (which is what I need). </p>\n\n<p>However, when I accessed the SQL Server through another connection with SSMS (<strong>while this transaction was mid execution</strong>), I was able to access the rows read by this transaction. </p>\n\n<p>So, what I want to know is: are transaction scopes and isolation levels valid only for the current connection, or are they valid for all connections to the database?</p>\n\n<p><strong>EDITED</strong></p>\n\n<p>What I am trying to prevent is: </p>\n\n<ol>\n<li>Request A reads record with id 1 in the database. Column C has value 10.</li>\n<li>Request B reads the same record in the database. Column C has value 10.</li>\n<li>Request A updates the record with value of C = 11.</li>\n<li>Request B updates the record with value of C = 11.</li>\n</ol>\n\n<p>In this case in the end the value would be 11 but it should be 12.</p>\n"}, {"tags": ["c#", "visual-studio", "performance", "resharper", "shared-project"], "comments": [{"owner": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 1, "creation_date": 1533762749, "post_id": 51754656, "comment_id": 90471054, "body": "Which version of Visual Studio/Resharper? Both techniques are pretty deprecated if you&#39;d ask me and I haven&#39;t encountered them in a long time. Shared Projects were mostly introduced to support multi-platform builds that share sources. With the introdution of NetStandard and .NET Core, this problem should now be largely reduced.  Consider using PerfView to figure out what VisualStudio /  Resharper is spending it&#39;s time on. <a href=\"https://github.com/Microsoft/perfview\" rel=\"nofollow noreferrer\">github.com/Microsoft/perfview</a>"}, {"owner": {"reputation": 17694, "user_id": 227436, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ea9b1dccafcdbaa702ee1cf957ff3692?s=128&d=identicon&r=PG", "display_name": "Daryl", "link": "https://stackoverflow.com/users/227436/daryl"}, "reply_to_user": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 0, "creation_date": 1533767038, "post_id": 51754656, "comment_id": 90472455, "body": "@jessehouwing I work in MS Dynamics, which is not converting to .Net Core anytime soon, and even if it did, this wouldn&#39;t resolve the issues that I&#39;m having to overcome.  I&#39;ve added the versions, but I&#39;m hoping for an answer that would be version agnostic."}, {"owner": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 0, "creation_date": 1533798398, "post_id": 51754656, "comment_id": 90480521, "body": "When you run a perfview, can you see what is taking the most cpu cycles?"}, {"owner": {"reputation": 17694, "user_id": 227436, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ea9b1dccafcdbaa702ee1cf957ff3692?s=128&d=identicon&r=PG", "display_name": "Daryl", "link": "https://stackoverflow.com/users/227436/daryl"}, "reply_to_user": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 0, "creation_date": 1533846131, "post_id": 51754656, "comment_id": 90508983, "body": "@jessehouwing I&#39;ve added my prefview image.  Looks like ntdll is using up the most..."}, {"owner": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 0, "creation_date": 1533846234, "post_id": 51754656, "comment_id": 90509018, "body": "Doubleclick the high-users to dig into the stacktrace"}, {"owner": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 0, "creation_date": 1533846272, "post_id": 51754656, "comment_id": 90509033, "body": "Looks like Visual Studio is at 12.5%, if you have a quad-core CPU with hyperthreading, that means that one core is at 100%."}, {"owner": {"reputation": 17694, "user_id": 227436, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ea9b1dccafcdbaa702ee1cf957ff3692?s=128&d=identicon&r=PG", "display_name": "Daryl", "link": "https://stackoverflow.com/users/227436/daryl"}, "reply_to_user": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 0, "creation_date": 1533849038, "post_id": 51754656, "comment_id": 90510091, "body": "I may not be reading this right, but I think these are all threads within the devenv process, so I&#39;m not sure what else to do.  Double clicking just opens the Callers tab, and that doesn&#39;t seem to help."}, {"owner": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 0, "creation_date": 1533850709, "post_id": 51754656, "comment_id": 90510708, "body": "The callers tab will show you hopefully a useful methodname that may suggest which feature, extension, plugin is actually causing the calls."}, {"owner": {"reputation": 17694, "user_id": 227436, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ea9b1dccafcdbaa702ee1cf957ff3692?s=128&d=identicon&r=PG", "display_name": "Daryl", "link": "https://stackoverflow.com/users/227436/daryl"}, "reply_to_user": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 0, "creation_date": 1533899966, "post_id": 51754656, "comment_id": 90527602, "body": "Only method name I see is ntdll!_RTLUserThreadStart"}, {"owner": {"reputation": 87176, "user_id": 736079, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/Z1hIP.png?s=128&g=1", "display_name": "jessehouwing", "link": "https://stackoverflow.com/users/736079/jessehouwing"}, "edited": false, "score": 0, "creation_date": 1533913627, "post_id": 51754656, "comment_id": 90535993, "body": "My suggestion is to open a ticket on <a href=\"https://developercommunity.visualstudio.com/spaces/8/index.html\" rel=\"nofollow noreferrer\">developercommunity.visualstudio.com/spaces/8/index.html</a> and to provide the perfview trace."}], "owner": {"reputation": 17694, "user_id": 227436, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ea9b1dccafcdbaa702ee1cf957ff3692?s=128&d=identicon&r=PG", "display_name": "Daryl", "link": "https://stackoverflow.com/users/227436/daryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533813741, "creation_date": 1533758135, "last_edit_date": 1533813741, "question_id": 51754656, "link": "https://stackoverflow.com/questions/51754656/what-method-of-shared-code-files-does-visual-studio-resharper-perform-better-wit", "title": "What Method of Shared Code Files Does Visual Studio/ReSharper Perform Better With?", "body": "<h2>Setup</h2>\n\n<blockquote>\n  <p>VS Enterprise 15.7.6<br>\n  ReSharper Ultimate 2018.1.3</p>\n</blockquote>\n\n<p>I have to deploy .net Class Libraries without any expediencies on other dlls outside of the .net Framework and I'm trying to figure out Visual Studio / ReSharper performance implications (the performance of the IDE itself, not the compiled/deployed code) for sharing code files.</p>\n\n<p>My solution has 23 .net 4.5.2 class library projects, and 1 <a href=\"https://www.c-sharpcorner.com/UploadFile/7ca517/shared-project-an-impressive-features-of-visual-studio-201/\" rel=\"nofollow noreferrer\">shared project</a>.  This shared project is unique to this client.  I also have shared code that is not unique to the client that is shared as a <a href=\"https://nikcodes.com/2013/10/23/packaging-source-code-with-nuget/\" rel=\"nofollow noreferrer\">source only nuget package</a>.  This means the same code is added to every project and checked into TFS under every project.</p>\n\n<h2>Question</h2>\n\n<p>Would Visual Studio / ReSharper have better performance if I removed all the source only NuGet files, and added all of these files to the <a href=\"https://www.c-sharpcorner.com/UploadFile/7ca517/shared-project-an-impressive-features-of-visual-studio-201/\" rel=\"nofollow noreferrer\">Shared Project</a>?  </p>\n\n<p>Currently VS spends a lot of CPUs each time I type a keystroke, and I'm wondering if this change would help.  Only Negative is that any upgrade of the Source Only Nuget Package would be manual...</p>\n\n<h2>Update 1 Added PrefView</h2>\n\n<p><a href=\"https://i.stack.imgur.com/XA0VP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XA0VP.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1533758094, "post_id": 51754630, "comment_id": 90468897, "body": "There might be an operator overload for assignment but not equality"}, {"owner": {"reputation": 171, "user_id": 10121878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daabd8ad32996c8f5492e8d9b60e997c?s=128&d=identicon&r=PG&f=1", "display_name": "Zkai", "link": "https://stackoverflow.com/users/10121878/zkai"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1533758241, "post_id": 51754630, "comment_id": 90468967, "body": "@maccettura In that case, what are my options?"}, {"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1533758265, "post_id": 51754630, "comment_id": 90468979, "body": "just use <code>Equals()</code>"}, {"owner": {"reputation": 3676, "user_id": 862495, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/26bbb772e30d41a4fdfa5657f43012ba?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/862495/nick"}, "edited": false, "score": 1, "creation_date": 1533759307, "post_id": 51754630, "comment_id": 90469480, "body": "Why is this tagged for wpf?"}, {"owner": {"reputation": 30288, "user_id": 1506454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FWxUV.png?s=128&g=1", "display_name": "ASh", "link": "https://stackoverflow.com/users/1506454/ash"}, "edited": false, "score": 1, "creation_date": 1533759476, "post_id": 51754630, "comment_id": 90469561, "body": "<a href=\"https://stackoverflow.com/questions/2452417/cell-color-changing-in-excel-using-c-sharp#comment53818230_2452525\" title=\"cell color changing in excel using c sharp%23comment53818230_2452525\">stackoverflow.com/questions/2452417/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 10198065, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WR4JPtuQx88/AAAAAAAAAAI/AAAAAAAAACo/Wi8bmiSdXvw/photo.jpg?sz=128", "display_name": "David Smith", "link": "https://stackoverflow.com/users/10198065/david-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1533758651, "last_edit_date": 1533758651, "creation_date": 1533758385, "answer_id": 51754719, "question_id": 51754630, "link": "https://stackoverflow.com/questions/51754630/comparing-colors/51754719#51754719", "title": "Comparing Colors", "body": "<p>Try System.Drawing.Color.Equals:</p>\n\n<pre><code>if (xlWorkSheet.Cells[1,j+1].Interior.Color.Equals(System.Drawing.Color.Red))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 171, "user_id": 10121878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daabd8ad32996c8f5492e8d9b60e997c?s=128&d=identicon&r=PG&f=1", "display_name": "Zkai", "link": "https://stackoverflow.com/users/10121878/zkai"}, "edited": false, "score": 0, "creation_date": 1533758993, "post_id": 51754765, "comment_id": 90469334, "body": "I understand now. Still, that&#39;s not working. It&#39;s not returning any errors but my code inside the condition is not doing anything."}, {"owner": {"reputation": 465, "user_id": 7330817, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2cebdfd022b69023c46690af52a9c9a6?s=128&d=identicon&r=PG", "display_name": "Cubemaster", "link": "https://stackoverflow.com/users/7330817/cubemaster"}, "reply_to_user": {"reputation": 171, "user_id": 10121878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daabd8ad32996c8f5492e8d9b60e997c?s=128&d=identicon&r=PG&f=1", "display_name": "Zkai", "link": "https://stackoverflow.com/users/10121878/zkai"}, "edited": false, "score": 0, "creation_date": 1533759249, "post_id": 51754765, "comment_id": 90469455, "body": "Can you post a more complete segment of code? To me, it looks like you are setting red cells to be red, which is pointless. Could you maybe edit your question to include the loop that <code>j</code> is referencing?"}], "tags": [], "owner": {"reputation": 465, "user_id": 7330817, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2cebdfd022b69023c46690af52a9c9a6?s=128&d=identicon&r=PG", "display_name": "Cubemaster", "link": "https://stackoverflow.com/users/7330817/cubemaster"}, "is_accepted": true, "score": 2, "last_activity_date": 1533758629, "creation_date": 1533758629, "answer_id": 51754765, "question_id": 51754630, "link": "https://stackoverflow.com/questions/51754630/comparing-colors/51754765#51754765", "title": "Comparing Colors", "body": "<p>To elaborate on David Smith's answer:</p>\n\n<pre><code>if (xlWorkSheet.Cells[1,j+1].Interior.Color.Equals(System.Drawing.Color.Red))\n{\n    cell1.Interior.Color = System.Drawing.Color.Red;\n}\n</code></pre>\n\n<p>Certain types in c# cannot be compared using the <code>==</code> operator. It works for a few types, but anything other than primitive types generally use the <code>.Equals()</code> method instead. It serves the same purpose, but works in many more scenarios. </p>\n\n<p>See here for more: </p>\n\n<p><a href=\"https://www.c-sharpcorner.com/UploadFile/3d39b4/difference-between-operator-and-equals-method-in-C-Sharp/\" rel=\"nofollow noreferrer\">https://www.c-sharpcorner.com/UploadFile/3d39b4/difference-between-operator-and-equals-method-in-C-Sharp/</a></p>\n"}], "owner": {"reputation": 171, "user_id": 10121878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daabd8ad32996c8f5492e8d9b60e997c?s=128&d=identicon&r=PG&f=1", "display_name": "Zkai", "link": "https://stackoverflow.com/users/10121878/zkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 51754765, "answer_count": 2, "score": 1, "last_activity_date": 1533759329, "creation_date": 1533758027, "last_edit_date": 1533759329, "question_id": 51754630, "link": "https://stackoverflow.com/questions/51754630/comparing-colors", "title": "Comparing Colors", "body": "<p>I'm manipulating an excel file (using  Interop). I'm trying to check the background color of a specific cell.  </p>\n\n<pre><code>if (xlWorkSheet.Cells[1,j+1].Interior.Color == System.Drawing.Color.Red)\n{\n    cell1.Interior.Color = System.Drawing.Color.Red;\n}\n</code></pre>\n\n<blockquote>\n  <p>'Operator '==' cannot be applied to operands of type 'double' and\n  'System.Drawing.Color</p>\n</blockquote>\n\n<p>I'm not even sure If this error make sense because I have this code which I can use it just fine. So If I can assign, why can't I compare?</p>\n\n<pre><code>cellHeader.Interior.Color = System.Drawing.Color.Red;\n</code></pre>\n"}, {"tags": ["c#"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 10146544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8e4758d0a38e963e69ca86cb6fcdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Pepe", "link": "https://stackoverflow.com/users/10146544/pepe"}, "edited": false, "score": 0, "creation_date": 1533759592, "post_id": 51754909, "comment_id": 90469624, "body": "I try but <code>ItemArray</code> still comming null"}], "tags": [], "owner": {"reputation": 2650, "user_id": 4588756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fl8RE.png?s=128&g=1", "display_name": "Hossein", "link": "https://stackoverflow.com/users/4588756/hossein"}, "is_accepted": false, "score": 0, "last_activity_date": 1533761065, "last_edit_date": 1533761065, "creation_date": 1533759205, "answer_id": 51754909, "question_id": 51754626, "link": "https://stackoverflow.com/questions/51754626/data-missing-after-convert-list-to-datatable/51754909#51754909", "title": "Data missing after convert list to DataTable", "body": "<p>Just add this function and call it, it will convert List to <code>DataTable</code>.</p>\n\n<pre><code> public static DataTable ToDataTable&lt;T&gt;(List&lt;T&gt; items)\n        {\n\n            DataTable dataTable = new DataTable(typeof(T).Name);\n\n            //Get all the properties\n\n            PropertyInfo[] Props = typeof(T).GetProperties(BindingFlags.Public | BindingFlags.Instance);\n            if (Props.Length &gt; 0)\n            {\n                foreach (PropertyInfo prop in Props)\n                {\n                    if (GetDefault(prop.PropertyType.FullName) != null)\n                    {\n                        //Setting column names as Property names\n                        dataTable.Columns.Add(prop.Name, Nullable.GetUnderlyingType(prop.PropertyType) ?? prop.PropertyType);\n                    }\n                }\n            }\n            else\n            {\n                dataTable.Columns.Add(\"myColName\");\n            }\n            foreach (T item in items)\n            {\n                if (item != null)\n                {\n                    DataRow dr = dataTable.NewRow();\n                    if (Props.Length &gt; 0)\n                    {\n                        foreach (PropertyInfo prop in Props)\n                        {\n                            if (GetDefault(prop.PropertyType.FullName) != null)\n                            {\n                                //inserting property values to datatable rows\n                                dr[prop.Name] = prop.GetValue(item, null) ?? GetDefault(prop.PropertyType.FullName);\n                            }\n                        }\n                    }\n                    else\n                    {\n                            //inserting property values to datatable rows\n                            dr[0] = item;\n                    }\n\n                    dataTable.Rows.Add(dr);\n                }\n            }\n\n            //put a breakpoint here and check datatable\n\n            return dataTable;\n\n        }\n\n        public static object GetDefault(string dataType)\n        {\n\n            if (dataType.Contains(\"System.String\"))\n            {\n                return string.Empty;\n            }\n            if (dataType.Contains(\"System.Boolean\"))\n            {\n                return false;\n            }\n            if (dataType.Contains(\"System.Decimal\"))\n            {\n                return 0.0;\n            }\n            if (dataType.Contains(\"System.DateTime\"))\n            {\n                return DateTime.MinValue;\n            }\n            if (dataType.Contains(\"System.Int64\"))\n            {\n                return 0;\n            }\n            if (dataType.Contains(\"System.Guid\"))\n            {\n                return null;\n            }\n            if (dataType.Contains(\"System.Int16\"))\n            {\n                return 0;\n            }\n            if (dataType.Contains(\"Int32\"))\n            {\n                return 0;\n\n            }\n            if (dataType.Contains(\"System.Object\"))\n            {\n                return null;\n            }\n\n            return null;\n        }\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 10146544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8e4758d0a38e963e69ca86cb6fcdeb?s=128&d=identicon&r=PG&f=1", "display_name": "Pepe", "link": "https://stackoverflow.com/users/10146544/pepe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533761065, "creation_date": 1533758005, "last_edit_date": 1533759166, "question_id": 51754626, "link": "https://stackoverflow.com/questions/51754626/data-missing-after-convert-list-to-datatable", "title": "Data missing after convert list to DataTable", "body": "<p>I create a new <code>Guid</code> list like this:</p>\n\n<pre><code>List&lt;Guid&gt; EmpGuid = new List&lt;Guid&gt;();\n</code></pre>\n\n<p>Then I populate it:</p>\n\n<pre><code>foreach (DataRowView list in lstTech.SelectedItems)\n{\n    var empGuid = (Guid)list[0];\n    EmpGuid.Add(empGuid);\n}\n</code></pre>\n\n<p>Once it have items I convert it to a <code>DataTable</code>:</p>\n\n<pre><code>var parameters = ToDataTable(EmpGuid);\n</code></pre>\n\n<p><code>ToDataTable</code> method:</p>\n\n<pre><code>public static DataTable ToDataTable&lt;T&gt;(IList&lt;T&gt; data)\n{\n    PropertyDescriptorCollection props = TypeDescriptor.GetProperties(typeof(T));\n\n    DataTable table = new DataTable();\n\n    for (int i = 0; i &lt; props.Count; i++)\n    {\n        PropertyDescriptor prop = props[i];\n        table.Columns.Add(prop.Name, prop.PropertyType);\n    }\n\n    object[] values = new object[props.Count];\n\n    foreach (T item in data)\n    {\n        for (int i = 0; i &lt; values.Length; i++)\n        {\n            values[i] = props[i].GetValue(item);\n        }\n\n        table.Rows.Add(values);\n    }\n\n    return table;\n}\n</code></pre>\n\n<p>Problem is when I convert it to the <code>DataTable</code>, it creates 2 rows, but there are empty rows without my value of <code>EmpGuid</code>. Anyone have an idea why it occurs? </p>\n\n<p><a href=\"https://i.stack.imgur.com/BUCQd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BUCQd.png\" alt=\"enter image description here\"></a>\nRegards</p>\n"}, {"tags": ["c#", "loops", "foreach", "exceldatareader"], "comments": [{"owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "edited": false, "score": 0, "creation_date": 1533758017, "post_id": 51754518, "comment_id": 90468859, "body": "I have not used <code>ExcelDataReader</code> myself, but for most <code>XReader</code> classes you must use a <code>while</code> loop like <code>while (reader.Read()) { Console.WriteLine(reader[&quot;name&quot;]);</code> }`.  See <a href=\"https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a> or <a href=\"https://msdn.microsoft.com/en-us/library/system.io.streamreader(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"reputation": 144, "user_id": 5463252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/116yk.jpg?s=128&g=1", "display_name": "Hack", "link": "https://stackoverflow.com/users/5463252/hack"}, "edited": false, "score": 0, "creation_date": 1533758265, "post_id": 51754518, "comment_id": 90468980, "body": "this doesn&#39;t appear to be an issue with reading from the excel sheet, but rather an issue with how the op is displaying the output.  currently the loop is setup to go by column then by row.  You&#39;re going to need to do it the other way around to get the output you want. Or store the values for each row somewhere and display them later."}, {"owner": {"reputation": 15, "user_id": 9382248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa51d10c166fa56ef1b3589864247ba8?s=128&d=identicon&r=PG&f=1", "display_name": "Krol Noir", "link": "https://stackoverflow.com/users/9382248/krol-noir"}, "edited": false, "score": 0, "creation_date": 1533760346, "post_id": 51754518, "comment_id": 90470031, "body": "what I&#39;m looking for and practically this: string.format(&quot;{0}|{1}|{2}|{3}&quot;, colum1[row1], colum2[row1], colum3[row1], colum4[row1]); and so on, but I can not find a logic"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 10123319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ArPkz.jpg?s=128&g=1", "display_name": "Shoeless", "link": "https://stackoverflow.com/users/10123319/shoeless"}, "is_accepted": false, "score": 0, "last_activity_date": 1533758261, "creation_date": 1533758261, "answer_id": 51754686, "question_id": 51754518, "link": "https://stackoverflow.com/questions/51754518/how-can-i-iterate-over-an-excel-file/51754686#51754686", "title": "How can I iterate over an excel file", "body": "<p>The first problem is that you are asking to write two items and only two items on a single line.</p>\n\n<p>Would it help if you made the stream.writeline() statement into a .write() statement and then, after the inner loop performed a .writeline() which would terminate the line?</p>\n\n<p>Apologies for not commenting but not enough Respect points to do so.\n - Malc</p>\n"}, {"comments": [{"owner": {"reputation": 144, "user_id": 5463252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/116yk.jpg?s=128&g=1", "display_name": "Hack", "link": "https://stackoverflow.com/users/5463252/hack"}, "edited": false, "score": 0, "creation_date": 1533813558, "post_id": 51755394, "comment_id": 90489726, "body": "this doesn&#39;t solve the op&#39;s problem, what about the 3rd and 4th and nth column?"}, {"owner": {"reputation": 15, "user_id": 9382248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa51d10c166fa56ef1b3589864247ba8?s=128&d=identicon&r=PG&f=1", "display_name": "Krol Noir", "link": "https://stackoverflow.com/users/9382248/krol-noir"}, "reply_to_user": {"reputation": 144, "user_id": 5463252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/116yk.jpg?s=128&g=1", "display_name": "Hack", "link": "https://stackoverflow.com/users/5463252/hack"}, "edited": false, "score": 0, "creation_date": 1533814473, "post_id": 51755394, "comment_id": 90490340, "body": "dr[&quot;Column3&quot;], dr[&quot;Column4&quot;], dr[&quot;Column5&quot;], dr[&quot;Column6&quot;]"}, {"owner": {"reputation": 144, "user_id": 5463252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/116yk.jpg?s=128&g=1", "display_name": "Hack", "link": "https://stackoverflow.com/users/5463252/hack"}, "edited": false, "score": 0, "creation_date": 1533815456, "post_id": 51755394, "comment_id": 90490999, "body": "lol didn&#39;t even realize you answered your own question.  still think you could do better then this personally, could be made so you didn&#39;t have to manually enter the columns like that allowing for a more generic approach."}], "tags": [], "owner": {"reputation": 15, "user_id": 9382248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa51d10c166fa56ef1b3589864247ba8?s=128&d=identicon&r=PG&f=1", "display_name": "Krol Noir", "link": "https://stackoverflow.com/users/9382248/krol-noir"}, "is_accepted": false, "score": 0, "last_activity_date": 1533761196, "creation_date": 1533761196, "answer_id": 51755394, "question_id": 51754518, "link": "https://stackoverflow.com/questions/51754518/how-can-i-iterate-over-an-excel-file/51755394#51755394", "title": "How can I iterate over an excel file", "body": "<p>This is the answer, I just needed to get the dataSet and iterate over it, very easy</p>\n\n<pre><code>var data = ExcelHelper.DataSet();\n\nforeach (DataRow dr in data.Tables[0].Rows)\n{\n    Console.WriteLine(dr[\"Column1\"] + \"|\" + dr[\"Column2\"]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1534244322, "creation_date": 1534244322, "answer_id": 51839845, "question_id": 51754518, "link": "https://stackoverflow.com/questions/51754518/how-can-i-iterate-over-an-excel-file/51839845#51839845", "title": "How can I iterate over an excel file", "body": "<p>If I understand what you want truly! I think you need to add a method like <code>RowValueCollection</code> to your <code>ExcelHelper</code> as below:</p>\n\n<pre><code>public static IEnumerable&lt;string[]&gt; RowValueCollection()\n{\n    var result = Data.Tables[0].Rows.OfType&lt;DataRow&gt;()\n        .Select(dr =&gt; dr.ItemArray.Select(ia =&gt; ia.ToString()).ToArray());\n    return result;\n}\n</code></pre>\n\n<p>And then use it like this:</p>\n\n<pre><code>var rowValues = ExcelHelper.RowValueCollection();\nforeach (var row in rowValues)\n{\n    stream.WriteLine(string.Join(\"|\", row));\n}\n</code></pre>\n\n<p>HTH ;)</p>\n"}], "owner": {"reputation": 15, "user_id": 9382248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa51d10c166fa56ef1b3589864247ba8?s=128&d=identicon&r=PG&f=1", "display_name": "Krol Noir", "link": "https://stackoverflow.com/users/9382248/krol-noir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 51839845, "answer_count": 3, "score": 0, "last_activity_date": 1534244322, "creation_date": 1533757489, "question_id": 51754518, "link": "https://stackoverflow.com/questions/51754518/how-can-i-iterate-over-an-excel-file", "title": "How can I iterate over an excel file", "body": "<p>How can I iterate over an excel file?</p>\n\n<p>I currently have a class using ExcelDataReader</p>\n\n<p>Class => <a href=\"https://paste.lamlam.io/nomehogupi.cs#14fXzlopygZ27adDcXEDtQHT0tWTxoYR\" rel=\"nofollow noreferrer\">https://paste.lamlam.io/nomehogupi.cs#14fXzlopygZ27adDcXEDtQHT0tWTxoYR</a></p>\n\n<p>I have a excel file with 5 columns</p>\n\n<p>This is my current code, but it is not exporting the result that I expect ...</p>\n\n<pre><code>TextWriter stream = new StreamWriter(\"excel Path\");\n//foreach string in List&lt;string&gt;\nforeach(var item in ComboList) {\n var rows = ExcelHelper.CellValueCollection(item.Key);\n\n foreach(var row in rows) {\n  stream.WriteLine(item.Key + \"|\" + row);\n  break;\n }\n}\n\nstream.Close();\n</code></pre>\n\n<p>My result:</p>\n\n<pre><code>Column1|Row1\nColumn1|Row2\nColumn1|Row3\n...\nColumn2|Row1\nColumn2|Row2\nColumn2|Row3\n...\n</code></pre>\n\n<p>Expected:</p>\n\n<pre><code>Column1|Row1|Column2|Row1...\nColumn1|Row2|Column2|Row2...\nColumn1|Row3|Column2|Row3...\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "winforms", "gdi+"], "comments": [{"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "edited": false, "score": 0, "creation_date": 1533758974, "post_id": 51754451, "comment_id": 90469325, "body": "Why not using <code>PathGradeintBrush</code>?"}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 1, "creation_date": 1533760563, "post_id": 51754451, "comment_id": 90470155, "body": "With multiple overlapping object, this may become somewhat more complicated. You (probably) need a <a href=\"https://en.wikipedia.org/wiki/Voronoi_diagram\" rel=\"nofollow noreferrer\">Voroni</a> distribution (to register each region&#39;s associated pixels. I would change the Euclidean distance with <a href=\"https://en.wikipedia.org/wiki/Taxicab_geometry\" rel=\"nofollow noreferrer\">TaxiCab</a> (Manhattan). Similar, but in this case it might get better results (I think). Then you need to manage pixels collisions (that&#39;s where the Voroni diagram will help). First of all you need to substitute <code>SetPixel()</code> with <code>Bitmap.LockBits()</code> &amp; Co., or this will become a pain."}, {"owner": {"reputation": 119, "user_id": 10187214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E5lTyM_efeg/AAAAAAAAAAI/AAAAAAAAAQA/ArBOW8CcZtc/photo.jpg?sz=128", "display_name": "Marat Isaw", "link": "https://stackoverflow.com/users/10187214/marat-isaw"}, "reply_to_user": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "edited": false, "score": 0, "creation_date": 1533762559, "post_id": 51754451, "comment_id": 90470982, "body": "@RezaAghaei I can use that if I draw them, but I actually don&#39;t need to draw the gradients but get the values. I am using this as a Mask."}, {"owner": {"reputation": 119, "user_id": 10187214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E5lTyM_efeg/AAAAAAAAAAI/AAAAAAAAAQA/ArBOW8CcZtc/photo.jpg?sz=128", "display_name": "Marat Isaw", "link": "https://stackoverflow.com/users/10187214/marat-isaw"}, "reply_to_user": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1533762562, "post_id": 51754451, "comment_id": 90470983, "body": "@Jimi Thanks for your suggestion. I tried using Manhattan instead of Euclidean, didn&#39;t really change much. And what would Voroni (a new topic for me) change? I don&#39;t know anything about Voroni, isn&#39;t there a simpler way?"}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1533763164, "post_id": 51754451, "comment_id": 90471184, "body": "No, in your context (because of how the code performs at this time) Manhattan or Euclidean won&#39;t change anything (or make anything better). If you have multiple overlapping object that need to <i>blend</i> in a visually pleasing way, you must manage pixels collisions. A Voronoi diagram helps you to keep track of pixels regions. This is a very broad subject. You need to break it down, piece by piece. Start with using <a href=\"https://msdn.microsoft.com/en-us/library/5ey6h79d%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Bitmap.LockBits()</a> for setting the values. Many examples for this."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1533763833, "post_id": 51754451, "comment_id": 90471406, "body": "A quick Google search on the terms used here, gave back (among the others) this link: <a href=\"https://softwarebydefault.com/tag/image-gradient/\" rel=\"nofollow noreferrer\">Stained Glass Image Filter</a>. Here, a Voronoi (which I wrote wrong, twice) diagram is implemented in a quite simple way. Also, both the Euclidean and Manhattan distances are considered (+ Chebyshev). I might be interenting for you."}, {"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 1, "creation_date": 1533819948, "post_id": 51754451, "comment_id": 90494313, "body": "Do have a look at <a href=\"https://stackoverflow.com/questions/30415191/heatmap-style-gradients-in-net/30416635?s=1|59.8013#30416635\">this post</a> which does the very same but with colors and for a heat map."}], "owner": {"reputation": 119, "user_id": 10187214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E5lTyM_efeg/AAAAAAAAAAI/AAAAAAAAAQA/ArBOW8CcZtc/photo.jpg?sz=128", "display_name": "Marat Isaw", "link": "https://stackoverflow.com/users/10187214/marat-isaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1533757239, "creation_date": 1533757239, "question_id": 51754451, "link": "https://stackoverflow.com/questions/51754451/combine-gradient-layers-c", "title": "Combine gradient layers - [C#]", "body": "<p>I have a program where I can make an ellipse gradient such as this:\n<a href=\"https://i.stack.imgur.com/3NESn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3NESn.png\" alt=\"enter image description here\"></a></p>\n\n<p>But that's not enough for me I need more than 1.\nSo when I try to make for example 3 gradients, and they collide with each other this is the result:\n<a href=\"https://i.stack.imgur.com/FVHes.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FVHes.png\" alt=\"enter image description here\"></a></p>\n\n<p>But I expect this (made in photoshop)\n<a href=\"https://i.stack.imgur.com/pfBh0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pfBh0.png\" alt=\"enter image description here\"></a></p>\n\n<p>Clearly, something is wrong with the way I merge the layers there.</p>\n\n<p>Here is the source code.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\n\nnamespace Gradients {\n\n    static class Gradient {\n\n        public static Bitmap GetGradient() {\n            Random random = new Random();\n            Bitmap image = new Bitmap(300, 300);\n            int size = 300;\n\n            double[,] colorValue = new double[300, 300];\n\n            int amount = 3;\n\n            for (int x = 0; x &lt; size; x++) {\n                for (int y = 0; y &lt; size; y++) {\n                    colorValue[x, y] = 1;\n                }\n            }\n            for (int i = 0; i &lt; amount; i++) {\n\n                int centerX = random.Next(size / 10 - 1, size - (size / 10 - 1));\n                int centerY = random.Next(size / 10 - 1, size - (size / 10 - 1));\n\n                for (int x = 0; x &lt; size; x++) {\n                    for (int y = 0; y &lt; size; y++) {\n\n                        double distanceX = (centerX - x) * (centerX - x);\n                        double distanceY = (centerY - y) * (centerY - y);\n\n                        double distanceToCenter = Math.Sqrt(distanceX + distanceY) * 5;\n\n                        distanceToCenter /= size;\n                        if (distanceToCenter &gt; 1)\n                            distanceToCenter = 1;\n                        if (distanceToCenter &lt; 0)\n                            distanceToCenter = 0;\n\n                        double number = 1 - distanceToCenter; // inverting number range from 1-0 to 0-1\n                        colorValue[x, y] -= number;\n                        if (colorValue[x, y] &lt; 0)\n                            colorValue[x,y] = 0;\n                    }\n                }\n            }\n\n\n            for (int x = 0; x &lt; size; x++) {\n                for (int y = 0; y &lt; size; y++) {\n                    int cValue = Convert.ToInt32(colorValue[x, y] * 255);\n                    image.SetPixel(x, y, Color.FromArgb(cValue, 0, 0, 0));\n                }\n            }\n\n            return image;\n        }\n\n        // euclidean distance\n        private static double getDistance(int x1, int y1, int x2, int y2) {\n            return Math.Sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "asp.net-core", "nlog"], "comments": [{"owner": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1533764448, "post_id": 51754425, "comment_id": 90471617, "body": "There is nothing that will make that work out of the box, and the logging system is not really built in a way that you can make this work easily. You could maybe roll your own logger implementation, but that will be quite some work."}, {"owner": {"reputation": 81, "user_id": 5074831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afc4bfa2adf16ef8dac27b43bc0263b?s=128&d=identicon&r=PG&f=1", "display_name": "MATTHEW", "link": "https://stackoverflow.com/users/5074831/matthew"}, "reply_to_user": {"reputation": 304245, "user_id": 216074, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/609c93bafd659500f83fde04802a9be5?s=128&d=identicon&r=PG", "display_name": "poke", "link": "https://stackoverflow.com/users/216074/poke"}, "edited": false, "score": 0, "creation_date": 1533816812, "post_id": 51754425, "comment_id": 90491962, "body": "ok, thanks! I was searching to web and had a hard time finding anything"}, {"owner": {"reputation": 6770, "user_id": 10620317, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vecnB.png?s=128&g=1", "display_name": "weichch", "link": "https://stackoverflow.com/users/10620317/weichch"}, "edited": false, "score": 0, "creation_date": 1606448909, "post_id": 51754425, "comment_id": 114970811, "body": "This is not easy to do. You will have to wrap all logger instances with a wrapper which knows how to figure out the request&#39;s logging level, because within the scope of your request, multiple loggers can be used in different parts of your app. Among those, you usually have singleton parts so you will be looking at accessing scoped data from static context, which usually involves manipulating async context/HTTP context etc. What are the problems you try to solve? It feels like the logging level isn&#39;t the real problem here."}], "answers": [{"comments": [{"owner": {"reputation": 3957, "user_id": 271200, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/x93aw.jpg?s=128&g=1", "display_name": "wonea", "link": "https://stackoverflow.com/users/271200/wonea"}, "edited": false, "score": 0, "creation_date": 1606239181, "post_id": 57682629, "comment_id": 114901303, "body": "This doesn&#39;t seem to be per logger instance though, I wouldn&#39;t want to set the log for all users of my API just one."}], "tags": [], "owner": {"reputation": 11822, "user_id": 193178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DUlHJ.png?s=128&g=1", "display_name": "Rolf Kristensen", "link": "https://stackoverflow.com/users/193178/rolf-kristensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1610315620, "last_edit_date": 1610315620, "creation_date": 1566942367, "answer_id": 57682629, "question_id": 51754425, "link": "https://stackoverflow.com/questions/51754425/dynamically-set-nlog-log-level-per-logger-instance-asp-net-core-2-x/57682629#57682629", "title": "Dynamically Set Nlog Log Level per Logger Instance ASP.Net Core 2.x", "body": "<p>NLog 4.6.7 allows you to use Layouts in loggingrules filters for <code>minLevel</code> / <code>maxLevel</code></p>\n<p>You can have a NLog-Config-Variable with default loglevel, and then create a hidden method on your web-app that modifies the NLog-Config-Variable and calls <code>ReconfigExistingLoggers()</code>.</p>\n<p>Then setup a Timer that restores that NLog-Config-Variable to its orignal value after 30 secs. And also calls <code>ReconfigExistingLoggers()</code>.</p>\n<p>See also: <a href=\"https://github.com/NLog/NLog/wiki/Filtering-log-messages#semi-dynamic-routing-rules\" rel=\"nofollow noreferrer\">https://github.com/NLog/NLog/wiki/Filtering-log-messages#semi-dynamic-routing-rules</a></p>\n"}, {"tags": [], "owner": {"reputation": 11822, "user_id": 193178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DUlHJ.png?s=128&g=1", "display_name": "Rolf Kristensen", "link": "https://stackoverflow.com/users/193178/rolf-kristensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1606248488, "last_edit_date": 1606248488, "creation_date": 1606247269, "answer_id": 64993783, "question_id": 51754425, "link": "https://stackoverflow.com/questions/51754425/dynamically-set-nlog-log-level-per-logger-instance-asp-net-core-2-x/64993783#64993783", "title": "Dynamically Set Nlog Log Level per Logger Instance ASP.Net Core 2.x", "body": "<p>Maybe you could use a session-cookie to control whether debug-mode is enabled:</p>\n<pre><code>&lt;targets&gt;\n    &lt;target type=&quot;file&quot; name=&quot;logfile&quot; filename=&quot;applog.txt&quot; /&gt;\n&lt;/targets&gt;\n&lt;rules&gt;\n    &lt;logger name=&quot;*&quot; minlevel=&quot;Off&quot; writeTo=&quot;logfile&quot; ruleName=&quot;debugCookieRule&quot;&gt;\n      &lt;filters defaultAction=&quot;Log&quot;&gt;\n         &lt;when condition=&quot;'${aspnet-session:EnableDebugMode}' == ''&quot; action=&quot;Ignore&quot; /&gt;\n      &lt;/filters&gt;\n    &lt;/logger&gt;\n&lt;/rules&gt;\n</code></pre>\n<p>Then activate the session-cookie like this:</p>\n<pre><code>public void SetMinLogLevel(LogLevel NewLogLevel)\n{\n    var cookieRule = LogManager.Configuration.FindRuleByName(&quot;debugCookieRule&quot;);\n    if (cookieRule != null)\n    {\n        cookieRule.MinLevel = NewLogLevel;\n\n        // Schedule disabling of logging-rule again in 60 secs.\n        Task.Run(async () =&gt; { await Task.Delay(60000).ConfigureAwait(false); cookieRule.MinLevel = LogLevel.Off; LogManager.ReconfigExistingLoggers(); });\n\n        // Activate EnableDebugMode for this session\n        HttpContext.Session.SetString(&quot;EnableDebugMode&quot;, &quot;Doctor has arrived&quot;);\n    }\n\n    LogManager.ReconfigExistingLoggers();  // Refresh loggers\n}\n</code></pre>\n<p>If session-cookies and <code>${aspnet-session}</code> is not wanted, then NLog.Web.AspNetCore have other options for extracting HttpContext-details. See also: <a href=\"https://nlog-project.org/config/?tab=layout-renderers&amp;search=package:nlog.web.aspnetcore\" rel=\"nofollow noreferrer\">https://nlog-project.org/config/?tab=layout-renderers&amp;search=package:nlog.web.aspnetcore</a></p>\n"}, {"tags": [], "owner": {"reputation": 9154, "user_id": 273764, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6175206212bde7187fae1dc1bdfd0e5d?s=128&d=identicon&r=PG", "display_name": "Morten Mertner", "link": "https://stackoverflow.com/users/273764/morten-mertner"}, "is_accepted": false, "score": 0, "last_activity_date": 1606444855, "creation_date": 1606444855, "answer_id": 65031442, "question_id": 51754425, "link": "https://stackoverflow.com/questions/51754425/dynamically-set-nlog-log-level-per-logger-instance-asp-net-core-2-x/65031442#65031442", "title": "Dynamically Set Nlog Log Level per Logger Instance ASP.Net Core 2.x", "body": "<p>Rather than trying to customize the NLog logging levels (which will affect the entire process), I think you should go for a solution that modifies the log levels of the log statements themselves.</p>\n<p>To make this work, you'll need the following:</p>\n<ol>\n<li>A mechanism by which to identify requests for which you want debug logging</li>\n<li>A wrapper for the logger so that you can dynamically override the log level</li>\n</ol>\n<p>The first requirement is simple enough - either set a cookie or a custom HTTP header, and check for the presence of either. You'll need to make this result of this check available to your LogWrapper instance, so that it knows when it should do something special.</p>\n<p>The LogWrapper must be instantiated per request, so that the instance isn't shared across requests. The simplest way to do this is to create it on-demand in the constructor of your controller (but you could also wire it up to the DI container for automatic injection).</p>\n<p>This would look something like this:</p>\n<pre><code>public class HomeController : Controller\n{\n    private readonly LogWrapper _logger;\n\n    public HomeController(ILogger&lt;HomeController&gt; logger)\n    {\n        var isDebugRequest = ...;\n        _logger = new LogWrapper&lt;HomeController&gt;(logger, isDebugRequest);\n    }    \n\n    ...\n}\n</code></pre>\n<p>The basics of creating a log wrapper for NLog is explained <a href=\"https://github.com/NLog/NLog/wiki/Custom-extension-of-Logger-interface\" rel=\"nofollow noreferrer\">here</a>, but it looks like you're already using the wrapper created for Microsoft.Extensions.Logging, so you'd need to wrap that interface instead:</p>\n<pre><code>public class LogWrapper&lt;T&gt; : Microsoft.Extensions.Logging.ILogger\n{\n    private readonly ILogger&lt;T&gt; _logger;\n    private readonly bool _debug;\n\n    public LogWrapper(ILogger&lt;T&gt; logger, bool isDebug)\n    {\n        _logger = logger;\n        _debug = isDebug;\n    }    \n\n    public void Log&lt;TState&gt;(LogLevel logLevel,\n                            EventId eventId,\n                            TState state,\n                            Exception exception,\n                            Func&lt;TState, Exception, string&gt; formatter)\n    {\n        if (_debug) \n        {\n            // override log level here\n            _logger.Log(LogLevel.Warning, eventId, state, exception, formatter); \n        }\n        else \n        {\n            _logger.Log(logLevel, eventId, state, exception, formatter);\n        }\n    }\n\n    // ILogger has two other methods you'll need to implement\n}    \n</code></pre>\n<p>The downside to this approach is that log statements won't have their original log level, which may or may not be important for your use case.</p>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 11655094, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FDZH9.jpg?s=128&g=1", "display_name": "Saeid Amini", "link": "https://stackoverflow.com/users/11655094/saeid-amini"}, "is_accepted": false, "score": 0, "last_activity_date": 1606781648, "last_edit_date": 1606781648, "creation_date": 1606687501, "answer_id": 65065698, "question_id": 51754425, "link": "https://stackoverflow.com/questions/51754425/dynamically-set-nlog-log-level-per-logger-instance-asp-net-core-2-x/65065698#65065698", "title": "Dynamically Set Nlog Log Level per Logger Instance ASP.Net Core 2.x", "body": "<p>We know NLog 4.6.7 added support for using NLog Layout like <code>${gdc:globalLevel}</code> to <a href=\"https://github.com/nlog/NLog/wiki/Configure-from-code\" rel=\"nofollow noreferrer\">dynamically change level attributes at runtime</a>. And the Better solution is to upgrade your NLog if it is possible.</p>\n<p><strong>Update: New solution</strong>\n<em>I tried this code on version 4.5 and it works fine. It seems you don't need to upgrade your NLog version.</em>\nIn this case, all the configurations set programmatically. You can send your desired level in the header as <code>loglevel</code>. If you send <code>loglevel</code> in the header, it will be used. Otherwise, logLevel will be <code>Error</code>. See <a href=\"https://github.com/NLog/NLog/wiki/Tutorial#configure-nlog-targets-for-output\" rel=\"nofollow noreferrer\">here</a>, please.</p>\n<p>Notice: Just use <code>using NLog;</code>. You don't need <code>using Microsoft.Extensions.Logging;</code></p>\n<pre><code>[Route(&quot;api/[controller]/[action]&quot;)]\n    [ApiController]\n    public class HomeController : ControllerBase\n    {\n        private readonly Logger _log = LogManager.GetCurrentClassLogger();\n\n        [HttpGet]\n        public async Task&lt;IEnumerable&lt;string&gt;&gt; Get()\n        {\n            var requestLogLevel = Request.Headers.SingleOrDefault(x =&gt; x.Key == &quot;loglevel&quot;);\n            LogLevel logLevel = LogLevel.Error;\n            switch (requestLogLevel.Value.ToString().ToLower())\n            {\n                case &quot;trace&quot;:\n                    logLevel = LogLevel.Trace;\n                    break;\n                case &quot;debug&quot;:\n                    logLevel = LogLevel.Debug;\n                    break;\n                case &quot;info&quot;:\n                    logLevel = LogLevel.Info;\n                    break;\n                case &quot;warn&quot;:\n                case &quot;warning&quot;:\n                    logLevel = LogLevel.Warn;\n                    break;\n                case &quot;error&quot;:\n                    logLevel = LogLevel.Error;\n                    break;\n                case &quot;fatal&quot;:\n                    logLevel = LogLevel.Fatal;\n                    break;\n            }\n\n            var config = new NLog.Config.LoggingConfiguration();\n            var defaultMode = new NLog.Targets.FileTarget(&quot;defaultlog&quot;) { FileName = &quot;log.txt&quot; };\n            config.AddRule(logLevel, LogLevel.Fatal, defaultMode);\n            NLog.LogManager.Configuration = config;\n\n            _log.Trace(&quot;Some logs&quot;);\n\n            return new string[] { &quot;value1&quot;, &quot;value2&quot; };\n        }\n    }\n</code></pre>\n<p><strong>Solution 1) Upgrade NLog to 4.6.7 or later:</strong></p>\n<pre><code>var config = new NLog.Config.LoggingConfiguration();\n\n// Targets where to log to: File and Console\nvar logfile = new NLog.Targets.FileTarget(&quot;logfile&quot;) { FileName = &quot;file.txt&quot; };\nvar logconsole = new NLog.Targets.ConsoleTarget(&quot;logconsole&quot;);\n            \n// Rules for mapping loggers to targets            \nconfig.AddRule(LogLevel.Info, LogLevel.Fatal, logconsole);\nconfig.AddRule(LogLevel.Debug, LogLevel.Fatal, logfile);\n            \n// Apply config           \nNLog.LogManager.Configuration = config;\n</code></pre>\n<p><strong>Solution 2) Change the configuration file programmatically:</strong>\nBecause your version of <code>NLog</code> doesn't support change configuration automatically, we are going to change it programmatically:</p>\n<pre><code>[Route(&quot;api/[controller]/[action]&quot;)]\n[ApiController]\npublic class HomeController : ControllerBase\n{\n    private readonly Logger _log = LogManager.GetCurrentClassLogger();\n\n    // Special Authorization needed\n    public bool ChangeToDebugMode()\n    {\n        try\n        {\n            XmlDocument doc = new XmlDocument();\n            doc.Load(AppDomain.CurrentDomain.BaseDirectory +  &quot;nlog.config&quot;);\n            XmlNode root = doc.DocumentElement;\n            XmlNode myNode = root[&quot;include&quot;].Attributes[&quot;file&quot;];\n            myNode.Value = &quot;debugmode.config&quot;;\n            doc.Save(AppDomain.CurrentDomain.BaseDirectory + &quot;nlog.config&quot;);\n        }\n        catch (Exception)\n        {\n            return false;\n        }\n\n        return true;\n    }\n\n    // Special Authorization needed\n    public bool RestToDefault()\n    {\n        try\n        {\n            XmlDocument doc = new XmlDocument();\n            doc.Load(AppDomain.CurrentDomain.BaseDirectory + &quot;nlog.config&quot;);\n            XmlNode root = doc.DocumentElement;\n            XmlNode myNode = root[&quot;include&quot;].Attributes[&quot;file&quot;];\n            myNode.Value = &quot;defaultmode.config&quot;;\n            doc.Save(AppDomain.CurrentDomain.BaseDirectory + &quot;nlog.config&quot;);\n        }\n        catch (Exception)\n        {\n            return false;\n        }\n\n        return true;\n    }\n\n    [HttpGet]\n    public async Task&lt;IEnumerable&lt;string&gt;&gt; Get()\n    {\n        _log.Trace(&quot;Some logs&quot;);\n\n        return new string[] { &quot;value1&quot;, &quot;value2&quot; };\n    }\n}\n</code></pre>\n<p>In this case, you need some change in your config file.\nYou need to add <code>autoReload=true</code> to configuration. Now, when any configuration change, NLog automatically reload the configuration and you don't need to restart the application. You need to take a look at <code>autoReload</code> and <code>include</code> <a href=\"https://github.com/nlog/NLog/wiki/Configure-from-code\" rel=\"nofollow noreferrer\">here</a></p>\n<p><strong>nlog.config</strong></p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;nlog xmlns=&quot;http://www.nlog-project.org/schemas/NLog.xsd&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; autoReload=&quot;true&quot;&gt;\n  &lt;include file=&quot;defaultmode.config&quot; /&gt;\n&lt;/nlog&gt;\n</code></pre>\n<p><strong>defaultmode.config</strong></p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;\n&lt;nlog xmlns=&quot;http://www.nlog-project.org/schemas/NLog.xsd&quot;\n      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;\n\n  &lt;targets&gt;\n    &lt;target name=&quot;logfile&quot; xsi:type=&quot;File&quot; fileName=&quot;file.txt&quot; /&gt;\n  &lt;/targets&gt;\n\n  &lt;rules&gt;\n    &lt;logger name=&quot;*&quot; minlevel=&quot;Debug&quot; writeTo=&quot;logfile&quot; /&gt;\n  &lt;/rules&gt;\n  &lt;!-- ... --&gt;\n&lt;/nlog&gt;\n</code></pre>\n<p><strong>debugmode.config</strong></p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;\n&lt;nlog xmlns=&quot;http://www.nlog-project.org/schemas/NLog.xsd&quot;\n      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;\n\n  &lt;targets&gt;\n    &lt;target name=&quot;logfile&quot; xsi:type=&quot;File&quot; fileName=&quot;file.txt&quot; /&gt;\n  &lt;/targets&gt;\n\n  &lt;rules&gt;\n    &lt;logger name=&quot;*&quot; minlevel=&quot;Trace&quot; writeTo=&quot;logfile&quot; /&gt;\n  &lt;/rules&gt;\n  &lt;!-- ... --&gt;\n&lt;/nlog&gt;\n</code></pre>\n<p>I made two other config files. <code>debugmode.config</code> and <code>defaultmode.config</code>. By default in <code>nlog.config</code> file, <code>deafultmode.config</code> is included. When <code>ChangeToDebugMode</code> is called, it changes to <code>debugmode.config</code> and when <code>RestToDefault</code> is called, it changes to <code>defaultmode.config</code>. I used <code>include</code> and separate configuration into two files just for simlicity.</p>\n<p><strong>Solution 3) Based on your question:</strong>\nIn this case, I used the code that you provided in your question. If you send the log level in your request header, it will be considered. If you don't send, it will use the default value that you set in the configuration. Thus, you don't need to change your application on the client-side. It works fine. Just send your desired log level when you are debugging.</p>\n<pre><code>[Route(&quot;api/[controller]/[action]&quot;)]\n[ApiController]\npublic class HomeController : ControllerBase\n{\n    private readonly Logger _log = LogManager.GetCurrentClassLogger();\n\n    [HttpGet]\n    public async Task&lt;IEnumerable&lt;string&gt;&gt; Get()\n    {\n        var requestLogLevel = Request.Headers.SingleOrDefault(x =&gt; x.Key == &quot;loglevel&quot;);\n        LogLevel logLevel = LogLevel.Error;\n        switch (requestLogLevel.Value.ToString().ToLower())\n        {\n            case &quot;trace&quot;:\n                logLevel = LogLevel.Trace;\n                break;\n            case &quot;debug&quot;:\n                logLevel = LogLevel.Debug;\n                break;\n            case &quot;info&quot;:\n                logLevel = LogLevel.Info;\n                break;\n            case &quot;warn&quot;:\n            case &quot;warning&quot;:\n                logLevel = LogLevel.Warn;\n                break;\n            case &quot;error&quot;:\n                logLevel = LogLevel.Error;\n                break;\n            case &quot;fatal&quot;:\n                logLevel = LogLevel.Fatal;\n                break;\n        }\n        SetMinLogLevel(logLevel);               \n\n        _log.Trace(&quot;Some logs.&quot;);\n\n        return new string[] { &quot;value1&quot;, &quot;value2&quot; };\n    }\n\n    public static void SetMinLogLevel(LogLevel NewLogLevel)\n    {\n        foreach (var rule in LogManager.Configuration.LoggingRules)\n        {\n            rule.EnableLoggingForLevel(NewLogLevel);\n        }\n\n        //Call to update existing Loggers created with GetLogger() or \n        //GetCurrentClassLogger()\n        LogManager.ReconfigExistingLoggers();\n    }\n}\n</code></pre>\n<p>The problem is, this situation needs to send the log level every time.\nIn these screenshots, you see how to send log level in debugging mode.\n<a href=\"https://i.stack.imgur.com/vibQv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vibQv.png\" alt=\"The Postman result\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/bCTTa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bCTTa.png\" alt=\"output text file\" /></a></p>\n"}], "owner": {"reputation": 81, "user_id": 5074831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3afc4bfa2adf16ef8dac27b43bc0263b?s=128&d=identicon&r=PG&f=1", "display_name": "MATTHEW", "link": "https://stackoverflow.com/users/5074831/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 805, "favorite_count": 1, "answer_count": 4, "score": 4, "last_activity_date": 1610315620, "creation_date": 1533757104, "last_edit_date": 1533757447, "question_id": 51754425, "link": "https://stackoverflow.com/questions/51754425/dynamically-set-nlog-log-level-per-logger-instance-asp-net-core-2-x", "title": "Dynamically Set Nlog Log Level per Logger Instance ASP.Net Core 2.x", "body": "<p><strong>Objective</strong>: To dynamically select which HTTP request I want verbose logging (different log level).</p>\n\n<p><strong>Overview</strong>: I have a ASP.Net core 2.1 web server running and once in production, if I need to debug an issue I want to be able to change the log level. I have found how to <a href=\"https://stackoverflow.com/questions/10302561/reconfiguring-nlog-programmatically\">globally change the log level</a>; however, changing the log level is persistent... aka, does not reset after each call to my controller.</p>\n\n<pre><code>    [HttpGet]\n    public async Task&lt;IEnumerable&lt;string&gt;&gt; Get()\n    {\n        this.Logger.LogTrace(\"This should NOT get logged\");\n        SetMinLogLevel(LogLevel.Trace);\n        this.Logger.LogTrace(\"This should be logged\");\n\n        return new string[] { \"value1\", \"value2\" };\n    }\n\n   public static void SetMinLogLevel(LogLevel NewLogLevel)\n    {\n        foreach (var rule in LogManager.Configuration.LoggingRules)\n        {\n            rule.EnableLoggingForLevel(NewLogLevel);\n        }\n\n        //Call to update existing Loggers created with GetLogger() or \n        //GetCurrentClassLogger()\n        LogManager.ReconfigExistingLoggers();\n    }\n</code></pre>\n\n<p>I want the requester to be able set a flag in their HTTP request (header or cookie) to enable a more verbose level of logging per request. That way I do not flood my logs with detailed logs from their requester.</p>\n\n<p><strong>Question</strong>: How to I dynamically set the Log Level per logger instance? (I believe that is the correct wording)</p>\n\n<p>I am currently using NLog package 4.5.</p>\n"}, {"tags": ["c#", "selenium", "selenium-webdriver", "appium", "appium-desktop"], "answers": [{"tags": [], "owner": {"reputation": 162, "user_id": 361914, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/k3C1h.jpg?s=128&g=1", "display_name": "PBMax", "link": "https://stackoverflow.com/users/361914/pbmax"}, "is_accepted": true, "score": 2, "last_activity_date": 1551890557, "creation_date": 1551890557, "answer_id": 55028129, "question_id": 51754390, "link": "https://stackoverflow.com/questions/51754390/appium-set-working-directory-of-application-session-in-c/55028129#55028129", "title": "Appium set working directory of application session in C#", "body": "<p><a href=\"https://github.com/Microsoft/WinAppDriver\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/WinAppDriver</a> </p>\n\n<p>Based off this you can set it via the code below:</p>\n\n<pre><code>appCapabilities.SetCapability(\"appWorkingDir\", Directory.GetCurrentDirectory());\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 3037571, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VHrqY.jpg?s=128&g=1", "display_name": "Jade", "link": "https://stackoverflow.com/users/3037571/jade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 55028129, "answer_count": 1, "score": 0, "last_activity_date": 1551890557, "creation_date": 1533756997, "last_edit_date": 1533759126, "question_id": 51754390, "link": "https://stackoverflow.com/questions/51754390/appium-set-working-directory-of-application-session-in-c", "title": "Appium set working directory of application session in C#", "body": "<p>I am currently trying to run my application in Appium.</p>\n\n<p>I have set the tests working directory to run where the application executable is and it is successfully launching the application however it fails to get any of the application settings that are within the directory of the executable file.</p>\n\n<p>If I run the application directly it works fine.</p>\n\n<p>What would be the best course of action? Here is what I have so far:</p>\n\n<pre><code>namespace MyApp.Tests.Appium.Tests\n{\n    using Microsoft.VisualStudio.TestTools.UnitTesting;\n    using OpenQA.Selenium.Appium.Windows;\n    using OpenQA.Selenium.Remote;\n    using System;\n    using System.IO;\n\n    public class UITestBase : IDisposable\n    {\n        protected const string WindowsApplicationDriverUrl = \"http://127.0.0.1:4723\";\n\n        protected static WindowsDriver&lt;WindowsElement&gt; AppSession;\n\n        protected UITestBase()\n        {\n            DesiredCapabilities appCapabilities = new DesiredCapabilities();\n\n            var appUrl = Directory.GetCurrentDirectory() + \"\\\\MyApp.exe\";\n\n            appCapabilities.SetCapability(\"app\", appUrl);\n            appCapabilities.SetCapability(\"deviceName\", \"WindowsPC\");\n            AppSession = new WindowsDriver&lt;WindowsElement&gt;(new Uri(WindowsApplicationDriverUrl), appCapabilities);\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "xml"], "comments": [{"owner": {"reputation": 6689, "user_id": 7117003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HaW1a.png?s=128&g=1", "display_name": "petezurich", "link": "https://stackoverflow.com/users/7117003/petezurich"}, "edited": false, "score": 3, "creation_date": 1533759295, "post_id": 51754357, "comment_id": 90469473, "body": "Welcome to SO. Please proofread your questions. Right now your posting is very hard to understand. Please also provide code. What have you tried? Where exactly are you stuck?"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1533766130, "post_id": 51754357, "comment_id": 90472180, "body": "The base file is confusing.  You say you want &quot;TWO FILES&quot;.  I think you mean two elements.  Are there always going to be two IDs in both files?"}, {"owner": {"reputation": 1, "user_id": 10199593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b03302618e6d404225f2ed0c93bd6a3?s=128&d=identicon&r=PG&f=1", "display_name": "Srikar", "link": "https://stackoverflow.com/users/10199593/srikar"}, "edited": false, "score": 0, "creation_date": 1533780746, "post_id": 51754357, "comment_id": 90475242, "body": "My Base file can have n number of IDs with each ID Data between tags of &lt;Base&gt;and &lt;/Base&gt;. Lookup File ID Can have max 3 Subscribers. Let me Put different way, My Base file have 100 IDs with Data, My lookup have only 50 IDs but USA &amp; CAD Subscribers. I have to create 2 Base files with 50 IDs with data info.. this should only done by lookup"}], "owner": {"reputation": 1, "user_id": 10199593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b03302618e6d404225f2ed0c93bd6a3?s=128&d=identicon&r=PG&f=1", "display_name": "Srikar", "link": "https://stackoverflow.com/users/10199593/srikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533765763, "creation_date": 1533756789, "last_edit_date": 1533765763, "question_id": 51754357, "link": "https://stackoverflow.com/questions/51754357/create-multiple-files-using-base-xml-file-with-id-in-lookup-xml-file", "title": "Create Multiple Files Using Base XML File with ID in Lookup XML File", "body": "<p>I have Base File and Look-Up File with ID as a common Attribute in both the files.\n    I want to write C# Code to Read Base File with ID look into Look-Up File based on Subscribers, create 2 XML files with file names _USA and _CAD as suffixes</p>\n\n<p>Base File:  </p>\n\n<pre><code>Base File Name : Base_File.xml\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Publication &gt;\n    &lt;Payload &gt;\n        &lt;BaseList &gt;\n&lt;Base&gt;\n  &lt;Custom&gt;\n    &lt;CustomE&gt;\n      &lt;ML_BUY_SELL_FLAG&gt;false&lt;/ML_BUY_SELL_FLAG&gt;\n      &lt;ID_BB_GLOBAL_PARENT_COMPANY_NAME&gt;First Trust /USA&lt;/ID_BB_GLOBAL_PARENT_COMPANY_NAME&gt;\n    &lt;/CustomE&gt;\n  &lt;/Custom&gt;\n  &lt;Identifier&gt;\n    &lt;ID&gt;10072271&lt;/ID&gt;\n  &lt;/Identifier&gt;\n  &lt;/Base&gt;\n  &lt;Base&gt;\n  &lt;Custom&gt;\n    &lt;CustomE&gt;\n      &lt;ML_BUY_SELL_FLAG&gt;false&lt;/ML_BUY_SELL_FLAG&gt;\n      &lt;ID_BB_GLOBAL_PARENT_COMPANY_NAME&gt;First Trust /CAD&lt;/ID_BB_GLOBAL_PARENT_COMPANY_NAME&gt;\n    &lt;/CustomE&gt;\n  &lt;/Custom&gt;\n  &lt;Identifier&gt;\n    &lt;ID&gt;10072272&lt;/ID&gt;\n  &lt;/Identifier&gt;\n  &lt;/Base&gt;\n  &lt;/BaseList&gt;\n  &lt;/Payload&gt;\n&lt;/Publication&gt;\n</code></pre>\n\n<p>Look-Up file:</p>\n\n<pre><code>Look-Up File Name: LookUp.xml\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;Publication &gt;\n    &lt;Payload &gt;\n        &lt;SubsList &gt;\n            &lt;Subscription&gt;\n                &lt;ID&gt;10072271&lt;/ID&gt;\n                &lt;Subscribers&gt;\n                    &lt;Subscriber&gt;USA&lt;/Subscriber&gt;\n                  &lt;/Subscribers&gt;\n                  &lt;/Subscription&gt;\n                &lt;Subscription&gt;\n                &lt;ID&gt;10072272&lt;/ID&gt;\n                &lt;Subscribers&gt;\n                    &lt;Subscriber&gt;CAD&lt;/Subscriber&gt;\n                    &lt;/Subscribers&gt;\n            &lt;/Subscription&gt;      \n        &lt;/SubsList&gt;\n    &lt;/Payload&gt;\n&lt;/Publication&gt;\n</code></pre>\n"}, {"tags": ["c#", "html", "post"], "comments": [{"owner": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "edited": false, "score": 0, "creation_date": 1533756911, "post_id": 51754340, "comment_id": 90468365, "body": "Basically, you need a web server. I&#39;d do a search for &quot;simple web server in c#&quot;... I&#39;m sure you&#39;ll find code that will work."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9969132, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T20dy.jpg?s=128&g=1", "display_name": "KevinSantana11", "link": "https://stackoverflow.com/users/9969132/kevinsantana11"}, "is_accepted": false, "score": 2, "last_activity_date": 1533758471, "last_edit_date": 1533758471, "creation_date": 1533757889, "answer_id": 51754600, "question_id": 51754340, "link": "https://stackoverflow.com/questions/51754340/how-to-receive-a-http-post-request-in-a-c-program/51754600#51754600", "title": "How to receive a HTTP POST request in a C# program", "body": "<p>Depends honestly on what your using.</p>\n\n<p>If your using MVC 5 framework you will have to use an HTTP Get and Post Method which will involve some razor code.</p>\n\n<p>ex: </p>\n\n<p>C# Code:</p>\n\n<pre><code>    [HttpPost]\n    public ActionResult verifyBoard(SudokuModel model)\n    {\n\n        boolean validBoard = checkSudokuBoard(model);\n    }\n</code></pre>\n\n<p>HTML:       </p>\n\n<pre><code> @using (Html.BeginForm(\"verifyBoard\", \"Sudoku\", FormMethod.Post))\n        {\n            &lt;button type=\"submit\"&gt;\n             Submit Board\n            &lt;/button&gt;\n        }\n</code></pre>\n\n<p>this example here is assuming your passing stuff from your HTML to your C# backend. MVC ties this with the model and using the  attribute in the html so that the data is passed through with a HTTP POST.</p>\n\n<p>I think what you want is to create a JSON object that will be passed through in a POST request. More on that could be found here : <a href=\"https://stackoverflow.com/questions/2114434/apache-with-c-sharp-classes\">Apache with c# classes</a></p>\n\n<p>If i were you I would look at the above post. If that's not what you wanted look into MVC 5 but if its a single page application I would using something else like ASP.NET webForms which makes building a web app very simple and straight forward.</p>\n"}], "owner": {"reputation": 154, "user_id": 8284228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de291e604b225b2fef12b57d011a16ac?s=128&d=identicon&r=PG&f=1", "display_name": "ja08prat", "link": "https://stackoverflow.com/users/8284228/ja08prat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533758471, "creation_date": 1533756694, "last_edit_date": 1533757533, "question_id": 51754340, "link": "https://stackoverflow.com/questions/51754340/how-to-receive-a-http-post-request-in-a-c-program", "title": "How to receive a HTTP POST request in a C# program", "body": "<p>I am writing a practice web application that verifies a sudoku board. A user will input a board as a single text string delimited by spaces on a super simple HTML webpage. I want to send that text string to a back-end program written in C# that will verify the board, and send verification messages to have them print on the web page below where the user entered the board. I already have the back end written and thoroughly tested, I am just super confused on how to link the front and back ends for data input and output. I want to send the user entered board using a POST request, but I am unsure how to receive a POST request in C# and I am unsure how to send messages from the back end to be displayed as output. I'd like my C# program's output to be printed to the webpage just as if I was printing to a terminal window. </p>\n\n<p>Is there a different way other than POST/GET requests to communicate with web page? </p>\n\n<p>I am very new to web application development and everything I am finding online is very overwhelming. I am not asking anyone to write this for me, all I am asking to be pointed in the correct direction.   </p>\n"}, {"tags": ["c#", "selenium", "scroll"], "comments": [{"owner": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "edited": false, "score": 0, "creation_date": 1533757336, "post_id": 51754257, "comment_id": 90468558, "body": "I guess there is a condition for button to be clickable. If yes, are you inserting wait time for the button to be clickable?"}, {"owner": {"reputation": 3, "user_id": 7323823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M-W_8l57xHs/AAAAAAAAAAI/AAAAAAAACys/XLXedbJmH2s/photo.jpg?sz=128", "display_name": "Omw2daBeach", "link": "https://stackoverflow.com/users/7323823/omw2dabeach"}, "reply_to_user": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "edited": false, "score": 0, "creation_date": 1533758411, "post_id": 51754257, "comment_id": 90469041, "body": "I added a 20 second implicit wait but still that stubborn button refuses to be clicked =("}, {"owner": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "edited": false, "score": 0, "creation_date": 1533758860, "post_id": 51754257, "comment_id": 90469262, "body": "can you share full exception you are getting?"}, {"owner": {"reputation": 3, "user_id": 7323823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M-W_8l57xHs/AAAAAAAAAAI/AAAAAAAACys/XLXedbJmH2s/photo.jpg?sz=128", "display_name": "Omw2daBeach", "link": "https://stackoverflow.com/users/7323823/omw2dabeach"}, "reply_to_user": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "edited": false, "score": 0, "creation_date": 1533759269, "post_id": 51754257, "comment_id": 90469465, "body": "OpenQA.Selenium.WebDriverException: &#39;unknown error: Element &lt;button type=&quot;button&quot; class=&quot;btn btn-success ng-scope ng-isolate-scope&quot; ng-if=&quot;commonItems.authorizedControls.LeadCenterEdit&quot; click-and-disable=&quot;submit()&quot;&gt;...&lt;/button&gt; is not clickable at point (869, 383). Other element would receive the click: &lt;div class=&quot;modal-dialog modal-xl&quot;&gt;...&lt;/div&gt;     What does &quot;Other element would receive the click:&quot; mean? that seems like a promising clue."}, {"owner": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "edited": false, "score": 0, "creation_date": 1533759810, "post_id": 51754257, "comment_id": 90469740, "body": "that means there may be other button element or another element is covering the element you are trying to click. You can either try to give absolute path to button element or use javascript executor. Please see my answer below."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "edited": false, "score": 0, "creation_date": 1533761656, "post_id": 51754257, "comment_id": 90470653, "body": "@theGuy why absolute path is suggested?  JavaScriptt click should not be suggested unless you know the overlay is permanent."}, {"owner": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "reply_to_user": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "edited": false, "score": 0, "creation_date": 1533762856, "post_id": 51754257, "comment_id": 90471086, "body": "@Rajagopalan, I am sure I explained in my comment above. &quot;that means there may be other button element&quot; so absolute path to try to click the element. &quot;or another element is covering the element you are trying to click.&quot; so javascript solution since she already applied 20 sec wait and it didn&#39;t helped. I hope this answered your question."}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "edited": false, "score": 0, "creation_date": 1533763157, "post_id": 51754257, "comment_id": 90471180, "body": "@theGuy Absolute path still won&#39;t work, try it. She is using implicit wait of 20 seconds that would wait until element exist so that doesn&#39;t matter here because it would still throw the error."}], "answers": [{"comments": [{"owner": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "reply_to_user": {"reputation": 3, "user_id": 7323823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M-W_8l57xHs/AAAAAAAAAAI/AAAAAAAACys/XLXedbJmH2s/photo.jpg?sz=128", "display_name": "Omw2daBeach", "link": "https://stackoverflow.com/users/7323823/omw2dabeach"}, "edited": false, "score": 0, "creation_date": 1533762470, "post_id": 51755097, "comment_id": 90470947, "body": "I am glad I was able to help, please accept this answer"}, {"owner": {"reputation": 3523, "user_id": 9043475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNxvn.jpg?s=128&g=1", "display_name": "Rajagopalan", "link": "https://stackoverflow.com/users/9043475/rajagopalan"}, "reply_to_user": {"reputation": 3, "user_id": 7323823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M-W_8l57xHs/AAAAAAAAAAI/AAAAAAAACys/XLXedbJmH2s/photo.jpg?sz=128", "display_name": "Omw2daBeach", "link": "https://stackoverflow.com/users/7323823/omw2dabeach"}, "edited": false, "score": 0, "creation_date": 1533762984, "post_id": 51755097, "comment_id": 90471128, "body": "@Omw2daBeach hi you don&#39;t have to do JavaScript click if your overlaying element disappear in another few seconds, if your overlaying element is permanent then you can go with JavaScript click. Always relay on WebDriber click, not JavaScript click."}], "tags": [], "owner": {"reputation": 623, "user_id": 7019709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z8Qby.png?s=128&g=1", "display_name": "theGuy", "link": "https://stackoverflow.com/users/7019709/theguy"}, "is_accepted": true, "score": 0, "last_activity_date": 1533759892, "creation_date": 1533759892, "answer_id": 51755097, "question_id": 51754257, "link": "https://stackoverflow.com/questions/51754257/how-to-click-button-using-scroll-on-a-specific-div-using-selenium-with-c/51755097#51755097", "title": "How to click button using scroll on a specific DIV using Selenium with C#", "body": "<p>here is how you can click on button using javascript in java, I am sure it is quite similar in C#</p>\n\n<pre><code>WebElement button = driver.findElement(By.id(\"someid\"));\nJavascriptExecutor jse = (JavascriptExecutor)driver;\njse.executeScript(\"arguments[0].click();\", button);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7323823, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-M-W_8l57xHs/AAAAAAAAAAI/AAAAAAAACys/XLXedbJmH2s/photo.jpg?sz=128", "display_name": "Omw2daBeach", "link": "https://stackoverflow.com/users/7323823/omw2dabeach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 51755097, "answer_count": 1, "score": 0, "last_activity_date": 1533759892, "creation_date": 1533756342, "last_edit_date": 1533757056, "question_id": 51754257, "link": "https://stackoverflow.com/questions/51754257/how-to-click-button-using-scroll-on-a-specific-div-using-selenium-with-c", "title": "How to click button using scroll on a specific DIV using Selenium with C#", "body": "<p>I need to click a 'Save' button that is at the bottom of a pop up window. \nFirst I wrote code to simply click the 'Save' button but I got exception \"button is not clickable at point (869, 383).\" Ok, I thought, I'll scroll to the bottom of the pop up window so the button is visible and can be clicked. I implemented code to scroll down to where the button is visible, but still the exception \"button not clickable at point\" comes up and the button is not clicked. Please help </p>\n\n<p>Here is my code</p>\n\n<pre><code>//To scroll down to the bottom of pop up window\nIJavaScriptExecutor down = (IJavaScriptExecutor)driver;\ndown.ExecuteScript(\"arguments[0].scrollTop = arguments[1];\", driver.FindElement(By.Id(\"move_In\")), 1000);\n //Click Save button       \ndriver.FindElement(By.XPath(\"//button[contains(.,'Save')]\")).Click();\n</code></pre>\n\n<p>Here is the elements in webpage:</p>\n\n<p><img src=\"https://i.stack.imgur.com/8xHa9.png\" alt=\"image\"></p>\n"}, {"tags": ["c#", "asp.net-core"], "comments": [{"owner": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "edited": false, "score": 0, "creation_date": 1533755428, "post_id": 51754005, "comment_id": 90467774, "body": "google <code>ViewBag</code>"}, {"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 1, "creation_date": 1533755560, "post_id": 51754005, "comment_id": 90467826, "body": "I mean, you should just be using ViewModels"}, {"owner": {"reputation": 15, "user_id": 6520070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080a6348f522e9e4fe757c24f8689af5?s=128&d=identicon&r=PG&f=1", "display_name": "Xiaox", "link": "https://stackoverflow.com/users/6520070/xiaox"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1533755838, "post_id": 51754005, "comment_id": 90467939, "body": "@maccettura I mean - yea, viewmodels are ok, but I think that&#39;s overkill just for one additional string."}, {"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1533755893, "post_id": 51754005, "comment_id": 90467956, "body": "@Xiaox it is not overkill though. Every View that requires data/model should have a ViewModel.  You shouldn&#39;t use your entities / data models in the View.  Build up a layer of abstraction and segregation.  You will thank yourself later"}], "answers": [{"comments": [{"owner": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1533755818, "post_id": 51754084, "comment_id": 90467927, "body": "This isn&#39;t a good idea. You should use strongly typed objects whenever possible."}, {"owner": {"reputation": 369, "user_id": 10169826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8334cac710acbe4de3bd73dc9a3c05ec?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Drabik", "link": "https://stackoverflow.com/users/10169826/micha%c5%82-drabik"}, "reply_to_user": {"reputation": 9603, "user_id": 2457029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9yHWL.jpg?s=128&g=1", "display_name": "maccettura", "link": "https://stackoverflow.com/users/2457029/maccettura"}, "edited": false, "score": 0, "creation_date": 1533755865, "post_id": 51754084, "comment_id": 90467949, "body": "I am aware of that, but that wasn&#39;t the question."}], "tags": [], "owner": {"reputation": 369, "user_id": 10169826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8334cac710acbe4de3bd73dc9a3c05ec?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Drabik", "link": "https://stackoverflow.com/users/10169826/micha%c5%82-drabik"}, "is_accepted": false, "score": 0, "last_activity_date": 1533755637, "creation_date": 1533755637, "answer_id": 51754084, "question_id": 51754005, "link": "https://stackoverflow.com/questions/51754005/is-it-possible-to-return-model-and-string-without-creating-viewmodel/51754084#51754084", "title": "Is it possible to return model and string without creating viewmodel?", "body": "<p>Try using anonymous objects:</p>\n\n<pre><code>public IActionResult Test(string id)\n{\n    (...)\n\n    var user = context.Users.First(x =&gt; x.Id.ToString() == id);\n    var message = \"abc\";\n\n    return View(\"Edit\", new {User = user, Message = message});\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "edited": false, "score": 2, "creation_date": 1533758185, "post_id": 51754246, "comment_id": 90468944, "body": "Speaking of ASP.NET Core, I&#39;d prefer ValueTuples."}, {"owner": {"reputation": 13057, "user_id": 729541, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/9c8f35ef59003de814a4bca351071045?s=128&d=identicon&r=PG", "display_name": "John H", "link": "https://stackoverflow.com/users/729541/john-h"}, "reply_to_user": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "edited": false, "score": 0, "creation_date": 1533758623, "post_id": 51754246, "comment_id": 90469140, "body": "@AdamSimon That&#39;s a fair point. I&#39;ll edit an example in now. Thanks for the suggestion."}, {"owner": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "edited": false, "score": 0, "creation_date": 1533760576, "post_id": 51754246, "comment_id": 90470164, "body": "@JohnH I&#39;m afraid <code>@model (User user, string message)</code> won&#39;t work. Razor crashed for me. However, <code>@model ValueTuple&lt;User, string&gt;</code> is ok, then e.g. you can decompose the tuple like this: <code>var (user, message) = Model;</code>"}, {"owner": {"reputation": 13057, "user_id": 729541, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/9c8f35ef59003de814a4bca351071045?s=128&d=identicon&r=PG", "display_name": "John H", "link": "https://stackoverflow.com/users/729541/john-h"}, "reply_to_user": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "edited": false, "score": 0, "creation_date": 1533760617, "post_id": 51754246, "comment_id": 90470183, "body": "@AdamSimon Which versions of VS, C# and MVC are you using? This worked for me with VS2017 15.7.6, .NET Core 2.1, targeting C# 7.0."}, {"owner": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "edited": false, "score": 1, "creation_date": 1533762447, "post_id": 51754246, "comment_id": 90470939, "body": "@JohnH Ok, I&#39;ve done some digging. It works fine in ASP.NET Core 2.1 but crashes in 2.0. In the latter case, C#7.1 is the highest language version supported by Razor and that seems  not enough. At least, I found no way to make it work. The bottom line is: <b>tuple syntax will only work in 2.1 and above</b>."}, {"owner": {"reputation": 13057, "user_id": 729541, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/9c8f35ef59003de814a4bca351071045?s=128&d=identicon&r=PG", "display_name": "John H", "link": "https://stackoverflow.com/users/729541/john-h"}, "reply_to_user": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "edited": false, "score": 0, "creation_date": 1533762885, "post_id": 51754246, "comment_id": 90471099, "body": "@AdamSimon Thank you very much for that! I&#39;ve made an edit to add your information in. I have to sleep now, but hopefully that covers it. :)"}, {"owner": {"reputation": 206107, "user_id": 654031, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9d0a45dd92ecc2cb15cdbc5f80befb15?s=128&d=identicon&r=PG", "display_name": "Chris Pratt", "link": "https://stackoverflow.com/users/654031/chris-pratt"}, "reply_to_user": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "edited": false, "score": 1, "creation_date": 1533827925, "post_id": 51754246, "comment_id": 90499962, "body": "@AdamSimon FWIW, that&#39;s likely because <code>ValueTuple</code> used to require a NuGet and a <code>using</code> in previous versions of .NET Core. If you have the NuGet and add the <code>using</code> to <code>_ViewImports.cshtml</code>, it might work in ASP.NET Core 2.0, as well."}], "tags": [], "owner": {"reputation": 13057, "user_id": 729541, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/9c8f35ef59003de814a4bca351071045?s=128&d=identicon&r=PG", "display_name": "John H", "link": "https://stackoverflow.com/users/729541/john-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1533762882, "last_edit_date": 1533762882, "creation_date": 1533756315, "answer_id": 51754246, "question_id": 51754005, "link": "https://stackoverflow.com/questions/51754005/is-it-possible-to-return-model-and-string-without-creating-viewmodel/51754246#51754246", "title": "Is it possible to return model and string without creating viewmodel?", "body": "<p>I completely agree with the advice around using view models where possible. They are much easier to work with, even if they can seem overkill at times.</p>\n\n<p>That said, to answer your question, you could use a <code>Tuple</code> for this:</p>\n\n<pre><code>public IActionResult Test(string id)\n{\n    var user = context.Users.First(x =&gt; x.Id.ToString() == id);\n    var message = \"abc\";\n\n    // The generic types will be inferred here so they're not necessary\n    // but I've added them for clarity in the example.\n    var viewModel = Tuple.Create&lt;User, string&gt;(user, message);\n\n    return View(\"Edit\", viewModel);\n}\n</code></pre>\n\n<p>Then in the view, you'll need this:</p>\n\n<pre><code>@model Tuple&lt;User, string&gt;\n</code></pre>\n\n<p>Just make sure to add the correct namespace to the <code>User</code> type in the view.</p>\n\n<h1>Edit</h1>\n\n<p>For completeness, here's an example of using a <code>ValueTuple</code> from C# 7, following Adam's comment below:</p>\n\n<pre><code>public IActionResult Test(string id)\n{\n    var user = context.Users.First(x =&gt; x.Id.ToString() == id);\n    var message = \"abc\";\n\n    return View(\"Edit\", (user, message));\n}\n</code></pre>\n\n<p>If you're using .NET Core 2.1 and above, the view's <code>model</code> directive becomes:</p>\n\n<pre><code>@model (User user, string message)\n</code></pre>\n\n<p>You'd then access those like so:</p>\n\n<pre><code>@Model.user\n</code></pre>\n\n<p>Otherwise, you'll need to use (credit to @AdamSimon from the comments):</p>\n\n<pre><code>@model ValueTuple&lt;User, string&gt;\nvar (user, message) = Model;\n</code></pre>\n\n<p>See the <a href=\"https://blogs.msdn.microsoft.com/dotnet/2016/08/24/whats-new-in-csharp-7-0/\" rel=\"nofollow noreferrer\">What's New in C# 7.0</a> blog post on MSDN for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 1443, "user_id": 84591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5aa3d792616f85e297dbedfd50d24b?s=128&d=identicon&r=PG", "display_name": "Mathew Leger", "link": "https://stackoverflow.com/users/84591/mathew-leger"}, "is_accepted": false, "score": 1, "last_activity_date": 1533756619, "creation_date": 1533756619, "answer_id": 51754323, "question_id": 51754005, "link": "https://stackoverflow.com/questions/51754005/is-it-possible-to-return-model-and-string-without-creating-viewmodel/51754323#51754323", "title": "Is it possible to return model and string without creating viewmodel?", "body": "<p>You can use the ViewBag but be aware that its contents are not strongly typed.</p>\n\n<p><strong>Controller</strong></p>\n\n<pre><code>public IActionResult Test(string id)\n{\n    (...)\n\n    ViewBag.User = context.Users.First(x =&gt; x.Id.ToString() == id);\n    ViewBag.Message = \"abc\";\n\n    return View(\"Edit\");\n}\n</code></pre>\n\n<p><strong>View</strong></p>\n\n<pre><code>@{\n    User user = ViewBag.User as User; \n    string message = ViewBag.Message as string;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 6520070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080a6348f522e9e4fe757c24f8689af5?s=128&d=identicon&r=PG&f=1", "display_name": "Xiaox", "link": "https://stackoverflow.com/users/6520070/xiaox"}, "edited": false, "score": 0, "creation_date": 1533757752, "post_id": 51754399, "comment_id": 90468743, "body": "wow. I tried that but probably f... up something @ View :( Anyway thanks."}], "tags": [], "owner": {"reputation": 1810, "user_id": 2630903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JSNUo.png?s=128&g=1", "display_name": "Richard Hubley", "link": "https://stackoverflow.com/users/2630903/richard-hubley"}, "is_accepted": false, "score": 0, "last_activity_date": 1533757022, "creation_date": 1533757022, "answer_id": 51754399, "question_id": 51754005, "link": "https://stackoverflow.com/questions/51754005/is-it-possible-to-return-model-and-string-without-creating-viewmodel/51754399#51754399", "title": "Is it possible to return model and string without creating viewmodel?", "body": "<p>When adding one additional string field, you can use ViewBag. </p>\n\n<pre><code>public IActionResult Test(string id)\n{\n    (...)\n\n    var user = context.Users.First(x =&gt; x.Id.ToString() == id);\n    ViewBag.message = \"abc\";\n\n    return View(\"Edit\", user);\n}\n</code></pre>\n\n<p>I agree with others here, if it gets much more complex a viewmodel will save time down the road.</p>\n"}, {"tags": [], "owner": {"reputation": 2009, "user_id": 8656352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QowvE.jpg?s=128&g=1", "display_name": "Adam Simon", "link": "https://stackoverflow.com/users/8656352/adam-simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1533757929, "creation_date": 1533757929, "answer_id": 51754609, "question_id": 51754005, "link": "https://stackoverflow.com/questions/51754005/is-it-possible-to-return-model-and-string-without-creating-viewmodel/51754609#51754609", "title": "Is it possible to return model and string without creating viewmodel?", "body": "<p>Anonymous objects won't really work as you'd have to use reflection in the view to access its properties.</p>\n\n<p>Your options:</p>\n\n<ul>\n<li><p>Tuples</p>\n\n<ul>\n<li>Action: <code>return View(\"Edit\", Tuple.Create(user, message));</code></li>\n<li><p>View: </p>\n\n<pre><code>@model Tuple&lt;User, string&gt;\n// accessing model data:\n@{ \n   var user = Model.Item1;\n   var message = Model.Item2; \n}\n</code></pre></li>\n</ul></li>\n<li><p>Value tuples</p>\n\n<ul>\n<li>Action: <code>return View(\"Edit\", (user, message));</code></li>\n<li><p>View:</p>\n\n<pre><code>@model ValueTuple&lt;User, string&gt;\n// accessing model data:\n@{ \n    var (user, message) = Model; \n}\n</code></pre></li>\n</ul></li>\n<li><p>ViewBag/ViewData</p>\n\n<ul>\n<li><p>Action:</p>\n\n<pre><code>ViewData[\"user\"] = user; // or: ViewBag.user = user;\nViewData[\"message\"] = message; // or: ViewBag.message = message;\nreturn View(\"Edit\");\n</code></pre></li>\n<li><p>View: </p>\n\n<pre><code>// accessing model data:\n@{\n    var user = (User)ViewData[\"user\"]; // or: User user = ViewBag.user;\n    var message = (string)ViewData[\"message \"]; // or: string message = ViewBag.message ;\n}\n</code></pre></li>\n</ul></li>\n</ul>\n\n<p>However, in the end you'll usually realize you're better off creating a separate viewmodel class. ;)</p>\n"}], "owner": {"reputation": 15, "user_id": 6520070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080a6348f522e9e4fe757c24f8689af5?s=128&d=identicon&r=PG&f=1", "display_name": "Xiaox", "link": "https://stackoverflow.com/users/6520070/xiaox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 51754246, "answer_count": 5, "score": 0, "last_activity_date": 1533762882, "creation_date": 1533755316, "last_edit_date": 1533755731, "question_id": 51754005, "link": "https://stackoverflow.com/questions/51754005/is-it-possible-to-return-model-and-string-without-creating-viewmodel", "title": "Is it possible to return model and string without creating viewmodel?", "body": "<p>I'd want to achieve something like that:</p>\n\n<pre><code>public IActionResult Test(string id)\n{\n    (...)\n\n    var user = context.Users.First(x =&gt; x.Id.ToString() == id);\n    var message = \"abc\";\n\n    return View(\"Edit\", user, message);\n}\n</code></pre>\n\n<p>Is that possible without creating ViewModel?</p>\n"}, {"tags": ["c#", "asp.net-core-mvc"], "comments": [{"owner": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "edited": false, "score": 1, "creation_date": 1533755475, "post_id": 51753896, "comment_id": 90467787, "body": "<a href=\"https://api.stackexchange.com/docs/authentication\">api.stackexchange.com/docs/authentication</a>"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1533755546, "post_id": 51753896, "comment_id": 90467818, "body": "<a href=\"https://developer.github.com/apps/building-oauth-apps/authorizing-oauth-apps/\" rel=\"nofollow noreferrer\">developer.github.com/apps/building-oauth-apps/&hellip;</a>"}, {"owner": {"reputation": 2267, "user_id": 9743064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JS0FZ.jpg?s=128&g=1", "display_name": "Llazar", "link": "https://stackoverflow.com/users/9743064/llazar"}, "edited": false, "score": 0, "creation_date": 1533925703, "post_id": 51753896, "comment_id": 90541761, "body": "I know the docs pages from GitHub and Stack Overflow but in fact I need how to call the client_id and client_secret. We have 4 methods like <code>AddGoogle</code> or <code>AddTwitter</code>. What method need to use for GitHub client_id and client_secret?"}, {"owner": {"reputation": 516, "user_id": 2284624, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7e9a21a488da02e651a8cf702f323c77?s=128&d=identicon&r=PG", "display_name": "Enrique A. Pinelo Novelo", "link": "https://stackoverflow.com/users/2284624/enrique-a-pinelo-novelo"}, "edited": false, "score": 0, "creation_date": 1549292492, "post_id": 51753896, "comment_id": 95840558, "body": "hay man, I have a UWP app, But i havent been successful in applying authentication for multiple providers and acknowledge that authentication for one user. I there a way i could see your authentication architecture to learn how to do it please? @Llazar"}, {"owner": {"reputation": 2267, "user_id": 9743064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JS0FZ.jpg?s=128&g=1", "display_name": "Llazar", "link": "https://stackoverflow.com/users/9743064/llazar"}, "edited": false, "score": 0, "creation_date": 1549303274, "post_id": 51753896, "comment_id": 95846251, "body": "The solution is for ASP .NET Core Mvc not for UWP check the code in GitHub maybe can help you <a href=\"https://github.com/llgjermeni/IdentityApp-SocialProvider\" rel=\"nofollow noreferrer\">github.com/llgjermeni/IdentityApp-SocialProvider</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2267, "user_id": 9743064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JS0FZ.jpg?s=128&g=1", "display_name": "Llazar", "link": "https://stackoverflow.com/users/9743064/llazar"}, "is_accepted": true, "score": 1, "last_activity_date": 1534785861, "creation_date": 1534785861, "answer_id": 51935743, "question_id": 51753896, "link": "https://stackoverflow.com/questions/51753896/how-to-create-github-or-stackoverflow-authentication-in-asp-net-core-mvc/51935743#51935743", "title": "How to create github or stackoverflow authentication in ASP.NET Core MVC", "body": "<p>I found the solution and implemented in code. GitHub authentication can be done with the method <code>.AddOAuth()</code>. A possible implementation could be:</p>\n\n<pre><code>services.AddAuthentication(options =&gt;\n            {....      })\n       .AddOAuth(\"GitHub\", options =&gt;\n            {\n              options.ClientId = Configuration[\"GitHub:ClientId\"];\n              options.ClientSecret = Configuration[\"GitHub:ClientSecret\"];\n              options.CallbackPath = new PathString(\"/signin-github\");\n            }\n</code></pre>\n"}], "owner": {"reputation": 2267, "user_id": 9743064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JS0FZ.jpg?s=128&g=1", "display_name": "Llazar", "link": "https://stackoverflow.com/users/9743064/llazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "accepted_answer_id": 51935743, "answer_count": 1, "score": -2, "last_activity_date": 1534785861, "creation_date": 1533754811, "last_edit_date": 1533755141, "question_id": 51753896, "link": "https://stackoverflow.com/questions/51753896/how-to-create-github-or-stackoverflow-authentication-in-asp-net-core-mvc", "title": "How to create github or stackoverflow authentication in ASP.NET Core MVC", "body": "<p>I have created an test app for multiple providers authentication in ASP.NET Core. Already have created authentication for Microsoft, Google, Facebook and Twitter but I don't know how to create authentication with GitHub or Stackoverflow.</p>\n\n<pre><code>.AddFacebook(options =&gt;\n            {\n                options.AppId = \"your appId\";\n                options.AppSecret = \"your appSecret\";\n            })\n            .AddTwitter(options =&gt;\n            {\n                options.ConsumerKey = \"your ConsumerKey\";\n                options.ConsumerSecret = \"your ConsumerSecret\";\n            })\n            .AddMicrosoftAccount(options =&gt;\n            {\n                options.ClientId = \"your Microsoft ClientId\";\n                options.ClientSecret = \"your Microsoft ClientSecret\";\n            })\n            .AddGoogle(options =&gt;\n            {\n                options.ClientId = \"your Google ClientId\";\n                options.ClientSecret = \"Your Google ClientSecret\";\n            })\n</code></pre>\n"}, {"tags": ["c#", "multithreading", "asp.net-web-api"], "comments": [{"owner": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "edited": false, "score": 1, "creation_date": 1533757101, "post_id": 51753868, "comment_id": 90468439, "body": "Just curious: how a web API is related to STA Thread. I remember the apartment problem being tied to COM (and never really understood it, actually), how the subject comes out in a &quot;modern&quot; web api?"}, {"owner": {"reputation": 5716, "user_id": 1105214, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/C15zn.png?s=128&g=1", "display_name": "samis", "link": "https://stackoverflow.com/users/1105214/samis"}, "reply_to_user": {"reputation": 3762, "user_id": 3276027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e2e43f741889c0d1c599747a318ddf5?s=128&d=identicon&r=PG&f=1", "display_name": "Gian Paolo", "link": "https://stackoverflow.com/users/3276027/gian-paolo"}, "edited": false, "score": 0, "creation_date": 1533759360, "post_id": 51753868, "comment_id": 90469506, "body": "@GianPaolo I added some references to post... I&#39;m trying to <i>instantiate</i> a window, <code>CustomForm : Window</code>, so that I can create an XPS (and PDF) from it. However, I&#39;m <i>not rendering</i> it to screen with <code>view.ShowDialog()</code>, just inflating it."}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 2, "creation_date": 1533761399, "post_id": 51753868, "comment_id": 90470528, "body": "So if I&#39;m reading this correctly, you want to shoehorn a winforms app to do something that has nothing to do with winforms via an asp.net application?  That seems like a very wrong course of action to take to fulfill a requirement."}, {"owner": {"reputation": 5716, "user_id": 1105214, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/C15zn.png?s=128&g=1", "display_name": "samis", "link": "https://stackoverflow.com/users/1105214/samis"}, "reply_to_user": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533762716, "post_id": 51753868, "comment_id": 90471038, "body": "@ErikPhilips Updated post with usage example... I&#39;m trying leverage existing functionality as much as possible, which uses Entity and Windows Forms to generate a view that can be transformed into an xps and then ultimately a pdf. This will give identical print-outs in the field and office. Writing a report generation tool from the ground up would be daunting. Do you know of any tools that can take windows forms xaml, bind data, and convert them to pdf (I certainly do not want to reinvent this wheel, but will if I must, though time is of essence)?"}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533762993, "post_id": 51753868, "comment_id": 90471130, "body": "Honestly, in <b>my opinion</b> it would be better to spend the time writing a PDF and integrating it back into winforms/wpf than it would be the other way around.  And I have extensive experience creating reports from scratch in c# (while keeping them cross compatible with Full .Net and CE .Net long ago...)"}, {"owner": {"reputation": 5716, "user_id": 1105214, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/C15zn.png?s=128&g=1", "display_name": "samis", "link": "https://stackoverflow.com/users/1105214/samis"}, "reply_to_user": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533763415, "post_id": 51753868, "comment_id": 90471263, "body": "@ErikPhilips I wouldn&#39;t even know where to begin with such an approach?"}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533771446, "post_id": 51753868, "comment_id": 90473477, "body": "Generally speaking, it&#39;s easier for many programmers (i don&#39;t know if it&#39;s most or not) to generate html and use a convert to convert to pdf, then to write pure PDF.  Additionally, an advantage is that html can then be used in an email or viewed in a browser.  However this is more time consuming then just writing pure PDF.  There are many free/$$$ frameworks that allow you to do both."}, {"owner": {"reputation": 5716, "user_id": 1105214, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/C15zn.png?s=128&g=1", "display_name": "samis", "link": "https://stackoverflow.com/users/1105214/samis"}, "reply_to_user": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533817798, "post_id": 51753868, "comment_id": 90492708, "body": "@ErikPhilips Bringing the application to the web would be nice, but isn&#39;t a current priority."}, {"owner": {"reputation": 12415, "user_id": 9711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/533b57214eb2d08e12befd826172c89e?s=128&d=identicon&r=PG", "display_name": "Sixto Saez", "link": "https://stackoverflow.com/users/9711/sixto-saez"}, "reply_to_user": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533820043, "post_id": 51753868, "comment_id": 90494391, "body": "Rather than messing with the already complicated threading behavior inside of Web API, why not look at <a href=\"https://stackoverflow.com/questions/2001667/net-windows-service-needs-to-use-stathread\">hosting a dedicated Windows Service to do what you are trying.</a> A WIndows Service is also MTA but since your code &quot;owns&quot; the process you limit the fallout of clobbering other threads that would be running serving requests. Personally, I would prefer taking an approach like what @ErikPhilips recommends."}, {"owner": {"reputation": 5716, "user_id": 1105214, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/C15zn.png?s=128&g=1", "display_name": "samis", "link": "https://stackoverflow.com/users/1105214/samis"}, "reply_to_user": {"reputation": 12415, "user_id": 9711, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/533b57214eb2d08e12befd826172c89e?s=128&d=identicon&r=PG", "display_name": "Sixto Saez", "link": "https://stackoverflow.com/users/9711/sixto-saez"}, "edited": false, "score": 0, "creation_date": 1533822721, "post_id": 51753868, "comment_id": 90496356, "body": "@SixtoSaez I will consider the windows service route, thanks. I&#39;m not overly concerned about blocking requests, since each web service instance is low volume. I can get the Window/Form to instantiate within it&#39;s containing Task, which runs to completion on it&#39;s assigned thread. However, it seems to be cancelling at some point after returning, and looking for cancellation token (I think, stepping through disassembled System.Threading libraries seems pointless without debugging symbols, it&#39;s interesting that it even can, not sure why it bothers since it&#39;s never goes to the right line)."}], "answers": [{"comments": [{"owner": {"reputation": 5716, "user_id": 1105214, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/C15zn.png?s=128&g=1", "display_name": "samis", "link": "https://stackoverflow.com/users/1105214/samis"}, "edited": false, "score": 0, "creation_date": 1534772416, "post_id": 51793610, "comment_id": 90813997, "body": "related issue: <a href=\"https://stackoverflow.com/questions/51902658/cannot-get-xps-rendered-flowdocument-to-update-data-bound-elements-fields\" title=\"cannot get xps rendered flowdocument to update data bound elements fields\">stackoverflow.com/questions/51902658/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5716, "user_id": 1105214, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/C15zn.png?s=128&g=1", "display_name": "samis", "link": "https://stackoverflow.com/users/1105214/samis"}, "is_accepted": false, "score": 0, "last_activity_date": 1533932635, "creation_date": 1533932635, "answer_id": 51793610, "question_id": 51753868, "link": "https://stackoverflow.com/questions/51753868/running-a-sta-single-threaded-apartment-thread-from-a-web-api-2-1-controller/51793610#51793610", "title": "Running a STA (Single-Threaded Apartment) thread from a Web API (2.1) controller", "body": "<p>Running the WPF/Entity code directly in an STA thread seems to be working:</p>\n\n<pre><code>Thread thread = GetCustomFormPreviewView4();\nthread.Start();\nthread.Join();\n\n\nprivate Thread GetCustomFormPreviewView4()\n{\n    var thread = new Thread(() =&gt;\n        {\n            FixedDocumentSequence sequence;\n            CustomForm view = new CustomForm();\n\n            view.ViewModel = new ComplaintCustomFormViewModel(BuildingEntity.form_id, (int)Record);     \n            sequence = view.ViewModel.XpsDocument.GetFixedDocumentSequence();\n\n            //view.ShowDialog();\n            //...\n        }\n    );\n\n    thread.IsBackground = true;\n    thread.SetApartmentState(ApartmentState.STA);\n\n    return thread;\n}\n</code></pre>\n"}], "owner": {"reputation": 5716, "user_id": 1105214, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/C15zn.png?s=128&g=1", "display_name": "samis", "link": "https://stackoverflow.com/users/1105214/samis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 979, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533932635, "creation_date": 1533754638, "last_edit_date": 1533762939, "question_id": 51753868, "link": "https://stackoverflow.com/questions/51753868/running-a-sta-single-threaded-apartment-thread-from-a-web-api-2-1-controller", "title": "Running a STA (Single-Threaded Apartment) thread from a Web API (2.1) controller", "body": "<p>I'm trying to run a STA (Single-Threaded Apartment) thread from a Web API (2.1) controller.</p>\n\n<p>To do this, I'm using <a href=\"https://gist.github.com/bradphelan/cb4f484fbf6a7f9829de0dd52036fd63\" rel=\"nofollow noreferrer\">StaTaskScheduler</a>:</p>\n\n<pre><code>/// &lt;summary&gt;Provides a scheduler that uses STA threads.&lt;/summary&gt;\npublic sealed class StaTaskScheduler : TaskScheduler, IDisposable\n{\n    /// &lt;summary&gt;Stores the queued tasks to be executed by our pool of STA threads.&lt;/summary&gt;\n    private BlockingCollection&lt;Task&gt; _tasks;\n    /// &lt;summary&gt;The STA threads used by the scheduler.&lt;/summary&gt;\n    private readonly List&lt;Thread&gt; _threads;\n\n    /// &lt;summary&gt;Initializes a new instance of the StaTaskScheduler class with the specified concurrency level.&lt;/summary&gt;\n    /// &lt;param name=\"numberOfThreads\"&gt;The number of threads that should be created and used by this scheduler.&lt;/param&gt;\n    public StaTaskScheduler(int numberOfThreads)\n    {\n        // Validate arguments\n        if (numberOfThreads &lt; 1) throw new ArgumentOutOfRangeException(\"concurrencyLevel\");\n\n        // Initialize the tasks collection\n        _tasks = new BlockingCollection&lt;Task&gt;();\n\n        // Create the threads to be used by this scheduler\n        _threads = Enumerable.Range(0, numberOfThreads).Select(i =&gt;\n        {\n            var thread = new Thread(() =&gt;\n            {\n                // Continually get the next task and try to execute it.\n                // This will continue until the scheduler is disposed and no more tasks remain.\n                foreach (var t in _tasks.GetConsumingEnumerable())\n                {\n                    TryExecuteTask(t);\n                }\n            });\n            thread.IsBackground = true;\n            thread.SetApartmentState(ApartmentState.STA);\n            return thread;\n        }).ToList();\n\n        // Start all of the threads\n        _threads.ForEach(t =&gt; t.Start());\n    }\n}\n</code></pre>\n\n<p>One option is to run the STA thread from a <code>CustomHttpControllerDispatcher</code>:</p>\n\n<pre><code>public static void Register(HttpConfiguration config)\n{\n    config.Routes.MapHttpRoute(\n        name: \"DefaultApi\",\n        routeTemplate: \"api/{controller}/{id}\",\n        defaults: new { id = RouteParameter.Optional }      \n        //constraints: null,        \n        // - Trying to avoid this\n        //handler: new Controllers.CustomHttpControllerDispatcher(config)\n    );\n}\n\npublic class CustomHttpControllerDispatcher : System.Web.Http.Dispatcher.HttpControllerDispatcher\n{\n    public CustomHttpControllerDispatcher(HttpConfiguration configuration) : base(configuration)\n    {\n    }\n    protected override Task&lt;HttpResponseMessage&gt; SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)\n    {\n        // My stuff here\n    }\n}\n</code></pre>\n\n<p>However, that would require manual construction of the http response, which involves json serialization, something I would rather avoid.</p>\n\n<p>That leaves me with my current option, which is running the STA thread from within the library that the controller calls into (to generate a custom form). </p>\n\n<p><strong>Everything works OK if the library is called using a \"Windows Application\" type test application with a <code>Main</code> decorated with <code>[STAThread]</code>. However, when called from the web service controller, there is a \"swallowed\" exception when the following task returns:</strong></p>\n\n<p><strong>Note:</strong> I'm am not rendering any dialogs, so there shouldn't be any <em>\"Showing a modal dialog box or form when the application is not running in UserInteractive mode is not a valid operation.\"</em> exceptions, which do not occur at all when generating the custom form from an STA thread started within a <code>CustomHttpControllerDispatcher</code>.</p>\n\n<pre><code>private Task&lt;AClass&gt; SendAsync1()\n{\n    var staTaskScheduler = new StaTaskScheduler(1);\n\n    return Task.Factory.StartNew&lt;CustomForm&gt;(() =&gt;\n        {\n            // - execution causes \"swallowed exception\"\n            return new AClass();\n        }, \n        CancellationToken.None,\n        TaskCreationOptions.None,\n        staTaskScheduler\n    );\n}\n</code></pre>\n\n<p>That is, when step debugging, the stack trace disappears after stepping over: </p>\n\n<pre><code>return new AClass(); \n</code></pre>\n\n<p>I usually deal with this by narrowing down some breakpoints, but for this case I don't think it is possible since there are no debugging symbols or source for Task.cs (and the multitude of associated files).</p>\n\n<p><strong>Note:</strong> I can now step through the disassembly of <code>System.Threading.Tasks</code>, however the debugging process will probably be lengthy since these are not trivial libraries, so any insight would be greatly appreciated.</p>\n\n<p><strong>I'm suspecting that maybe it's b/c I'm trying to schedule an STA thread from an MTA thread (controller), but am not positive?</strong></p>\n\n<hr>\n\n<p><strong>Usage</strong></p>\n\n<pre><code>GetCustomForm().Wait();\n\n\nprivate FixedDocumentSequence _sequence;\n\nprivate async Task GetCustomForm()\n{\n    // - will be slapped with a \"calling thread cannot access...\", next issue\n    _sequence = await SendAsync1b();\n}\n\n\nprivate readonly StaTaskScheduler _staTaskScheduler = new StaTaskScheduler(1);\n\nprivate Task&lt;FixedDocumentSequence&gt; SendAsync1b()\n{\n    //var staTaskScheduler = new StaTaskScheduler(100);\n    //var staTaskScheduler = new StaTaskScheduler(1);\n\n    return Task.Factory.StartNew&lt;FixedDocumentSequence&gt;(() =&gt;\n    {\n        FixedDocumentSequence sequence;\n        CustomForm view = new CustomForm();\n\n        view.ViewModel = new ComplaintCustomFormViewModel(BuildingEntity.form_id, (int)Record);     \n        sequence = view.ViewModel.XpsDocument.GetFixedDocumentSequence();\n\n        return sequence;\n    },\n    CancellationToken.None,\n    TaskCreationOptions.None,\n    _staTaskScheduler);\n}\n</code></pre>\n\n<blockquote>\n  <p>References</p>\n  \n  <ul>\n  <li><a href=\"https://stackoverflow.com/questions/23114832/asp-net-webapi-sta-mode\">ASP.Net WebApi STA Mode</a></li>\n  <li><a href=\"https://stackoverflow.com/questions/12371269/custom-route-handlers-in-asp-net-webapi\">Custom route handlers in ASP.Net WebAPI</a></li>\n  <li><a href=\"https://www.c-sharpcorner.com/article/global-and-per-route-message-handlers-in-webapi/\" rel=\"nofollow noreferrer\">https://www.c-sharpcorner.com/article/global-and-per-route-message-handlers-in-webapi/</a></li>\n  <li><a href=\"https://docs.microsoft.com/en-us/aspnet/web-api/overview/advanced/http-message-handlers\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/aspnet/web-api/overview/advanced/http-message-handlers</a></li>\n  <li><a href=\"https://weblog.west-wind.com/posts/2012/Sep/18/Creating-STA-COM-compatible-ASPNET-Applications\" rel=\"nofollow noreferrer\">https://weblog.west-wind.com/posts/2012/Sep/18/Creating-STA-COM-compatible-ASPNET-Applications</a></li>\n  </ul>\n</blockquote>\n"}, {"tags": ["c#", "serialization", "data-binding", "asp.net-core-mvc", "asp.net-core-1.0"], "comments": [{"owner": {"reputation": 6724, "user_id": 4685428, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/de2eda4db020c2b1541f877424225d73?s=128&d=identicon&r=PG&f=1", "display_name": "Aleks Andreev", "link": "https://stackoverflow.com/users/4685428/aleks-andreev"}, "edited": false, "score": 0, "creation_date": 1533755043, "post_id": 51753858, "comment_id": 90467613, "body": "It would be awesome if you create an <a href=\"https://stackoverflow.com/help/mcve\">example</a> of problem."}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1533755533, "post_id": 51753858, "comment_id": 90467811, "body": "It&#39;s a very simple class (see <a href=\"https://referencesource.microsoft.com/#System.Runtime.Serialization/System/Runtime/Serialization/DataMemberAttribute.cs\" rel=\"nofollow noreferrer\">source</a>). You could just write your own."}, {"owner": {"reputation": 753, "user_id": 1795613, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d101719f129342a60f51597c784e8962?s=128&d=identicon&r=PG", "display_name": "EL MOJO", "link": "https://stackoverflow.com/users/1795613/el-mojo"}, "reply_to_user": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1533755808, "post_id": 51753858, "comment_id": 90467921, "body": "@JohnWu Sure I could do that but nothing will happen during serialization.  The DataMemberAttribute is used by the serialization engine.  I can&#39;t just create a similar class and have it magically work.  It needs to be &quot;wired-up&quot;."}, {"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 0, "creation_date": 1533765069, "post_id": 51753858, "comment_id": 90471830, "body": "What serializer and data format (XML vs JSON) are you using?  Both the data contract serializers and <a href=\"https://stackoverflow.com/questions/tagged/json.net\">json.net</a> support data contract attributes."}, {"owner": {"reputation": 753, "user_id": 1795613, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d101719f129342a60f51597c784e8962?s=128&d=identicon&r=PG", "display_name": "EL MOJO", "link": "https://stackoverflow.com/users/1795613/el-mojo"}, "edited": false, "score": 0, "creation_date": 1533820813, "post_id": 51753858, "comment_id": 90494941, "body": "Both XML and JSON.  The client can decide.  I want to override the default behavior of serializers when a property is null or empty."}], "owner": {"reputation": 753, "user_id": 1795613, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d101719f129342a60f51597c784e8962?s=128&d=identicon&r=PG", "display_name": "EL MOJO", "link": "https://stackoverflow.com/users/1795613/el-mojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533755677, "creation_date": 1533754612, "last_edit_date": 1533755677, "question_id": 51753858, "link": "https://stackoverflow.com/questions/51753858/derive-override-the-datamemberattribute", "title": "Derive/Override the DataMemberAttribute", "body": "<p>I'd like to override some of the functionality of the DataMemberAttribute but cannot create a derived class because it is marked as 'sealed'.</p>\n\n<p>What I would like to do is have EmitDefaultValue be defaulted to 'false' instead of 'true' and I'd also like to not \"emit\" a collection if it is null or empty.</p>\n\n<p>Any ideas?</p>\n\n<hr>\n\n<p>Commenter wanted an example.  There really isn't a way to show an example and I believe my question is fairly clear.  But what the heck, here goes.</p>\n\n<p>Instead of having to do this on every property:</p>\n\n<pre><code>[DataContract]\npublic class MyDto\n{\n  [DataMember( EmitDefaultValue = false )]\n  public string Name { get; set; }\n\n  [DataMember( EmitDefaultValue = false )]\n  public string Occupation { get; set; }\n\n  [DataMember( EmitDefaultValue = false )]\n  public List&lt;string&gt; Friends { get; set; }\n}\n</code></pre>\n\n<p>I'd like to be able to do this:</p>\n\n<pre><code>[DataContract]\npublic class MyDto\n{\n  [CustomSerialization]\n  public string Name { get; set; }\n\n  [CustomSerialization]\n  public string Occupation { get; set; }\n\n  [CustomSerialization]\n  public List&lt;string&gt; Friends { get; set; }\n}\n</code></pre>\n\n<p>And for the last property \"Friends\", if it is null or empty, to not serialize it in the output.</p>\n"}, {"tags": ["c#", "sql", "database", "charts", "axis"], "comments": [{"owner": {"reputation": 1815, "user_id": 3573553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6257a1a8fe4eed27a804da5642832c03?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/3573553/mark"}, "edited": false, "score": 3, "creation_date": 1533754619, "post_id": 51753752, "comment_id": 90467424, "body": "If you can include what you have already tried and any errors you got that could help people to make suggestions"}, {"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1533824687, "post_id": 51753752, "comment_id": 90497667, "body": "This is best done by <b>not adding the x-valaues as strings. Correct this mistake</b> and you can set the x-axis <code>Interval</code> and <code>IntervalType</code> as needed. While you add strings all x-values are <b>zero</b> (!!) and no useful settings are possible. <b>Common error..</b> -  When you add <code>DateTimes</code> you can set the <code>LabelFormat</code> etc as you want, incl. <code>&quot;MMM&quot;</code>.."}], "owner": {"reputation": 1, "user_id": 10064721, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fsBd8vgGk4c/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oqvmgJkomRW8E1RK7P3KR7Nq1d6A/mo/photo.jpg?sz=128", "display_name": "Kay KayIArkay", "link": "https://stackoverflow.com/users/10064721/kay-kayiarkay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533757588, "creation_date": 1533754225, "last_edit_date": 1533757588, "question_id": 51753752, "link": "https://stackoverflow.com/questions/51753752/c-chart-x-axis-with-12-month-intervals-when-data-only-has-example-3-months", "title": "C# Chart, x - axis with 12 month intervals when data only has example : 3 months", "body": "<p>I am making a chart with C# where the user selects a start date and end date.  I would like the x - axis to show each month as an interval and label (Jan, Feb, Mar, etc..) even if there is no data retrieved for that month.  This would mean some months are blank.  If there an easy way to do this?</p>\n\n<pre><code>    OleDbDataReader reader = command.ExecuteReader();\n\n    string[] months = new string[] { \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\" };\n\n    for (int i = 0; i &lt; months.Length; i++)\n    {\n        while (reader.Read())\n        {                                       \n            if (Convert.ToDateTime(reader[\"dateValue\"]).ToString(\"MMM\") != months[i].ToString())\n\n            {\n                this.chartCasesByDate.Series[\"Number of Cases\"].Points.AddXY(months[i].ToString(), \"\");\n                break;\n\n            }\n            else\n            {\n                this.chartCasesByDate.Series[\"Number of Cases\"].Points.AddXY(Convert.ToDateTime(reader[\"dateValue\"]).ToString(\"MMM\"), reader[\"count\"]);                            \n            }\n        }                                                                                                \n    }\n</code></pre>\n"}, {"tags": ["c#", ".net"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5705240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06d46c78ef303831c21b44ad065a0307?s=128&d=identicon&r=PG&f=1", "display_name": "MartinT", "link": "https://stackoverflow.com/users/5705240/martint"}, "is_accepted": false, "score": 0, "last_activity_date": 1533758791, "creation_date": 1533758791, "answer_id": 51754808, "question_id": 51753737, "link": "https://stackoverflow.com/questions/51753737/uri-class-not-shown-in-system-namespace/51754808#51754808", "title": "uri class not shown in system namespace", "body": "<p>I solved my own problem but I don't understand why it worked. In desperation I created another new Project using .NET 4.5 and copied and pasted the code over. It compiled and Uri shows up as a Class in the Object Browser. I have no idea what the difference between the 2 projects is. </p>\n"}], "owner": {"reputation": 1, "user_id": 5705240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06d46c78ef303831c21b44ad065a0307?s=128&d=identicon&r=PG&f=1", "display_name": "MartinT", "link": "https://stackoverflow.com/users/5705240/martint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533758791, "creation_date": 1533754169, "question_id": 51753737, "link": "https://stackoverflow.com/questions/51753737/uri-class-not-shown-in-system-namespace", "title": "uri class not shown in system namespace", "body": "<p>I'm trying to compile the following code using the .NET 4.5 Framework:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing Microsoft.TeamFoundation.Client;\nusing Microsoft.TeamFoundation.Discussion.Client;\nusing Microsoft.TeamFoundation.VersionControl.Client;\n\nclass CodeReview\n{\n\n    public List&lt;CodeReviewComment&gt; GetCodeReviewComments(int workItemId)\n    {\n        List&lt;CodeReviewComment&gt; comments = new List&lt;CodeReviewComment&gt;();\n        Uri tfsuri = new Uri(MYURL);\n        TeamFoundationDiscussionService service = new TeamFoundationDiscussionService();\n        service.Initialize(new Microsoft.TeamFoundation.Client.TfsTeamProjectCollection(tfsuri));\n        IDiscussionManager discussionManager = service.CreateDiscussionManager();\n\n        IAsyncResult result = discussionManager.BeginQueryByCodeReviewRequest(workItemId, QueryStoreOptions.ServerAndLocal, new AsyncCallback(CallCompletedCallback), null);\n        var output = discussionManager.EndQueryByCodeReviewRequest(result);\n\n        foreach (DiscussionThread thread in output)\n        {\n            if (thread.RootComment != null)\n            {\n                CodeReviewComment comment = new CodeReviewComment();\n                comment.Author = thread.RootComment.Author.DisplayName;\n                comment.Comment = thread.RootComment.Content;\n                comment.PublishDate = thread.RootComment.PublishedDate.ToShortDateString();\n                comment.ItemName = thread.ItemPath;\n                comments.Add(comment);\n            }\n        }\n\n        return comments;\n    }\n\n    static void CallCompletedCallback(IAsyncResult result)\n    {\n        // Handle error conditions here\n    }\n\n    public class CodeReviewComment\n    {\n        public string Author { get; set; }\n        public string Comment { get; set; }\n        public string PublishDate { get; set; }\n        public string ItemName { get; set; }\n    }\n\n}\n</code></pre>\n\n<p>The Visual Studio compiler is complaining that \"the type or namespace 'Uri' could not be found\" and when I expand the System namespace in the Object Browser it doesnt list any of the Uri classes. I've tried a few other versions of .NET and still have the same problem although it does appear if I select the .NET 4.0 Client Profile but then none of the TeamFoundation classes are present in the Microsoft namespace.</p>\n"}, {"tags": ["c#", "ssis", "ssis-2008", "winscp-net", "script-task"], "answers": [{"tags": [], "owner": {"reputation": 4945, "user_id": 1169697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8076bb688cf139206f4a4e121dc1b08c?s=128&d=identicon&r=PG", "display_name": "digital.aaron", "link": "https://stackoverflow.com/users/1169697/digital-aaron"}, "is_accepted": true, "score": 2, "last_activity_date": 1533756502, "creation_date": 1533756502, "answer_id": 51754299, "question_id": 51753727, "link": "https://stackoverflow.com/questions/51753727/how-do-i-use-dts-events-fireinformation-in-ssis-script-task-while-handling-win/51754299#51754299", "title": "How do I use DTS.Events.FireInformation() in SSIS Script Task while handling WinSCPnet.dll FileTransferProgress?", "body": "<p>The answer I figured out was pretty simple. I changed <code>SessionFileTransferProgress</code> from <code>private static void</code> to <code>private void</code>. Once this method was no longer static, I was able to use <code>this</code> to invoke the <code>Dts.Events.Fire*</code> methods. <code>SessionFileTransferProgress</code> was changed to:</p>\n\n<pre><code>private void SessionFileTransferProgress(object sender, FileTransferProgressEventArgs e)\n{\n    bool fireAgain = false;\n\n    this.Dts.Events.FireInformation(0, null,\n                    string.Format(\"\\r{0} ({1:P0})\", e.FileName, e.FileProgress),\n                    null, 0, ref fireAgain);\n\n    // Remember a name of the last file reported\n    _lastFileName = e.FileName;\n}\n</code></pre>\n"}], "owner": {"reputation": 4945, "user_id": 1169697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8076bb688cf139206f4a4e121dc1b08c?s=128&d=identicon&r=PG", "display_name": "digital.aaron", "link": "https://stackoverflow.com/users/1169697/digital-aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4960, "favorite_count": 1, "accepted_answer_id": 51754299, "answer_count": 1, "score": 3, "last_activity_date": 1533757942, "creation_date": 1533754121, "question_id": 51753727, "link": "https://stackoverflow.com/questions/51753727/how-do-i-use-dts-events-fireinformation-in-ssis-script-task-while-handling-win", "title": "How do I use DTS.Events.FireInformation() in SSIS Script Task while handling WinSCPnet.dll FileTransferProgress?", "body": "<p>I have a Script Task in an SSIS (2008) package that downloads files from a remote FTP server to a local directory. The Script Task is written in C# 2008, and uses WinSCPnet.dll. Using examples from WinSCP's documentation, I came up with the script below. The script functions correctly to download the files, but all the file success/failure messages are held until the entire script completes, and then all the messages are dumped at once. File progress is not displayed at all using <code>Console.Write()</code>, and trying to use <code>Dts.Events.FireInformation()</code> in <code>SessionFileTransferProgress</code> gives me </p>\n\n<p><code>Error: \"An object reference is required for the non-static field, method, or property Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase.Dts.get\"</code></p>\n\n<p>Is there a way I can use the DTS.events.Fire* events to display file progress information as it happens, and file completion status after each file?</p>\n\n<p>Script:</p>\n\n<pre><code>/*\n   Microsoft SQL Server Integration Services Script Task\n   Write scripts using Microsoft Visual C# 2008.\n   The ScriptMain is the entry point class of the script.\n*/\n\nusing System;\nusing Microsoft.SqlServer.Dts.Runtime;\nusing Microsoft.SqlServer.Dts.Tasks.ScriptTask;\nusing System.AddIn;\nusing WinSCP;\n\nnamespace ST_3a1cf75114b64e778bd035dd91edb5a1.csproj\n{\n    [AddIn(\"ScriptMain\", Version = \"1.0\", Publisher = \"\", Description = \"\")]\n    public partial class ScriptMain : VSTARTScriptObjectModelBase\n    {\n        public void Main()\n        {\n            // Setup session options\n            SessionOptions sessionOptions = new SessionOptions\n            {\n                Protocol = Protocol.Ftp,\n                HostName = (string)Dts.Variables[\"User::FTPServerName\"].Value,\n                UserName = (string)Dts.Variables[\"User::UserName\"].Value,\n                Password = (string)Dts.Variables[\"User::Password\"].Value\n            };\n\n            try\n            {\n                using (Session session = new Session())\n                {\n                    // Will continuously report progress of transfer\n                    session.FileTransferProgress += SessionFileTransferProgress;\n\n                    session.ExecutablePath = (string)Dts.Variables[\"User::PathToWinSCP\"].Value;\n\n                    // Connect\n                    session.Open(sessionOptions);\n\n                    TransferOptions transferOptions = new TransferOptions();\n                    transferOptions.TransferMode = TransferMode.Binary;\n\n\n                    TransferOperationResult transferResult = session.GetFiles(\n                                                                                (string)Dts.Variables[\"User::ExportPath\"].Value\n                                                                                , (string)Dts.Variables[\"User::ImportPath\"].Value\n                                                                                , false\n                                                                                , transferOptions\n                                                                            );\n\n                    // Throw on any error\n                    transferResult.Check();\n\n                    // Print results\n                    bool fireAgain = false;\n                    foreach (TransferEventArgs transfer in transferResult.Transfers)\n                    {\n                        Dts.Events.FireInformation(0, null,\n                            string.Format(\"Download of {0} succeeded\", transfer.FileName),\n                            null, 0, ref fireAgain);\n                    }\n                }\n\n                Dts.TaskResult = (int)DTSExecResult.Success;\n            }\n\n            catch (Exception e)\n            {\n                Dts.Events.FireError(0, null,\n                    string.Format(\"Error downloading file: {0}\", e),\n                    null, 0);\n\n                Dts.TaskResult = (int)DTSExecResult.Failure;\n            }\n        }\n\n        private static void SessionFileTransferProgress(object sender, FileTransferProgressEventArgs e)\n        {\n            //bool fireAgain = false;\n\n\n            // Print transfer progress\n            Console.Write(\"\\r{0} ({1:P0})\", e.FileName, e.FileProgress);\n\n            /*Dts.Events.FireInformation(0, null,\n                            string.Format(\"\\r{0} ({1:P0})\", e.FileName, e.FileProgress),\n                            null, 0, ref fireAgain);*/\n\n            // Remember a name of the last file reported\n            _lastFileName = e.FileName;\n        }\n\n        private static string _lastFileName;\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "json.net"], "comments": [{"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 1, "creation_date": 1533754060, "post_id": 51753657, "comment_id": 90467197, "body": "Can you share whatever code you have written for this and explain what issue you are facing in that ?"}, {"owner": {"reputation": 59, "user_id": 9707586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/709818f7fe340ee0cee9e398eec1af0f?s=128&d=identicon&r=PG&f=1", "display_name": "Sharad Singh", "link": "https://stackoverflow.com/users/9707586/sharad-singh"}, "reply_to_user": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1533754301, "post_id": 51753657, "comment_id": 90467289, "body": "@ChetanRanpariya I need the code to get this. I have not written any code."}, {"owner": {"reputation": 573, "user_id": 7015118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1PJLG.png?s=128&g=1", "display_name": "Any Moose", "link": "https://stackoverflow.com/users/7015118/any-moose"}, "edited": false, "score": 0, "creation_date": 1533754790, "post_id": 51753657, "comment_id": 90467492, "body": "You are only looking at parent items, you could try to iterate over the child items. <a href=\"https://stackoverflow.com/questions/26680492/json-to-c-sharp-get-child-nodes\" title=\"json to c sharp get child nodes\">stackoverflow.com/questions/26680492/&hellip;</a>"}, {"owner": {"reputation": 59, "user_id": 9707586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/709818f7fe340ee0cee9e398eec1af0f?s=128&d=identicon&r=PG&f=1", "display_name": "Sharad Singh", "link": "https://stackoverflow.com/users/9707586/sharad-singh"}, "reply_to_user": {"reputation": 573, "user_id": 7015118, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1PJLG.png?s=128&g=1", "display_name": "Any Moose", "link": "https://stackoverflow.com/users/7015118/any-moose"}, "edited": false, "score": 0, "creation_date": 1533754964, "post_id": 51753657, "comment_id": 90467575, "body": "@AnyMoose. I do not know the keys of Json. This is dynamic. I gave just sample json."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1533755518, "post_id": 51753657, "comment_id": 90467805, "body": "Deserialize to a Dictionary and look at the keys."}], "answers": [{"comments": [{"owner": {"reputation": 108943, "user_id": 10263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/e51Ks.jpg?s=128&g=1", "display_name": "Brian Rogers", "link": "https://stackoverflow.com/users/10263/brian-rogers"}, "edited": false, "score": 1, "creation_date": 1533758331, "post_id": 51754389, "comment_id": 90469013, "body": "You don&#39;t need to make your own <code>Flatten()</code> extension method; you could just use the built-in <a href=\"https://www.newtonsoft.com/json/help/html/M_Newtonsoft_Json_Linq_Extensions_Descendants__1.htm\" rel=\"nofollow noreferrer\"><code>Descendants()</code></a> extension method instead.  Fiddle: <a href=\"https://dotnetfiddle.net/szIubI\" rel=\"nofollow noreferrer\">dotnetfiddle.net/szIubI</a>"}], "tags": [], "owner": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "is_accepted": true, "score": 3, "last_activity_date": 1533759042, "last_edit_date": 1533759042, "creation_date": 1533756996, "answer_id": 51754389, "question_id": 51753657, "link": "https://stackoverflow.com/questions/51753657/need-all-the-unique-keys-name-from-json-string/51754389#51754389", "title": "Need all the unique Keys name from Json string", "body": "<p>You just need to flatten the object and filter accordingly:</p>\n\n<pre><code>var uniqueKeys = json.Descendants()\n    .OfType&lt;JProperty&gt;()\n    .Where(x =&gt; x.Value is JValue)\n    .Select(x =&gt; x.Name)\n    .Distinct();\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9707586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/709818f7fe340ee0cee9e398eec1af0f?s=128&d=identicon&r=PG&f=1", "display_name": "Sharad Singh", "link": "https://stackoverflow.com/users/9707586/sharad-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 3, "accepted_answer_id": 51754389, "answer_count": 1, "score": 0, "last_activity_date": 1533774368, "creation_date": 1533753842, "last_edit_date": 1533754856, "question_id": 51753657, "link": "https://stackoverflow.com/questions/51753657/need-all-the-unique-keys-name-from-json-string", "title": "Need all the unique Keys name from Json string", "body": "<p>I have following sample json string in C#</p>\n\n<pre><code>{\n    \"AccountNumberGenerationRequest\": {\n        \"BranchNumber\": 8034,\n        \"AccountType\": \"041\"\n    },\n    \"CreateDepositAccountRequest\": {\n        \"AccountNumber\": \"9999999999\",\n        \"BranchNumber\": 8034,\n        \"AccountType\": 41,\n        \"WithholdingIndicator\": \"4\"\n    },\n    \"AccountNameAddressRequest\": {\n        \"AccountNumber\": \"9999999999\",\n        \"NameAndAddressType\": 1,\n    },\n    \"CustomerAccountRelationshipRequest\": {\n        \"CustomerNumber1\": \"58008\",\n        \"Customer1ToAccountRelationshipCode\": \"000\"\n    },\n    \"UpdatePartialInformationRequest\": {\n        \"AccountNumber\": \"9999999999\",\n        \"PartialInformationList\": [{\n            \"KeywordCode\": \"FDWTHE\",\n            \"KeywordValue\": \"1\"\n        }]\n    },\n    \"RequestUUID\": \"557d5442-8a28-4dab-b191-fe1596ddf2b8\"\n}\n</code></pre>\n\n<p>And want to read all the unique keys that has end values. Like below</p>\n\n<pre><code>[\"BranchNumber\",\"AccountType\",\"AccountNumber\",\"BranchNumber\",\"AccountType\",\"WithholdingIndicator\",\"AccountNumber\",\"NameAndAddressType\",\"CustomerNumber1\",\"Customer1ToAccountRelationshipCode\",\"KeywordCode\",\"KeywordValue\",\"RequestUUID\"]\n</code></pre>\n\n<p>I am using following code</p>\n\n<pre><code>var jsonSerializerSettings = new JsonSerializerSettings { NullValueHandling = NullValueHandling.Ignore };\n\n        var json=  JObject.Parse(JsonConvert.SerializeObject(p, jsonSerializerSettings));\n\n        IList&lt;string&gt; keys = json.Properties().Select(c=&gt; c.Name).ToList();\n\n        foreach(string key in keys)\n        {\n            Console.WriteLine(key);\n        }\n</code></pre>\n\n<p>But getting only </p>\n\n<pre><code>AccountNumberGenerationRequest\nAccountNumberGenerationRequest\nAccountNameAddressRequest\nAccountNameAddressRequest\nUpdatePartialInformationRequest\nRequestUUID\n</code></pre>\n\n<p>How Can I get this in C#. This is not hardcoded Json. It can be any json.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 1390, "user_id": 8951109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c6ce25a6621f6b6c3889babd4e8c6a?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Hofmann", "link": "https://stackoverflow.com/users/8951109/sebastian-hofmann"}, "edited": false, "score": 3, "creation_date": 1533754090, "post_id": 51753654, "comment_id": 90467209, "body": "Make sure you are <code>using System.Linq</code>."}, {"owner": {"reputation": 171, "user_id": 10121878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daabd8ad32996c8f5492e8d9b60e997c?s=128&d=identicon&r=PG&f=1", "display_name": "Zkai", "link": "https://stackoverflow.com/users/10121878/zkai"}, "reply_to_user": {"reputation": 1390, "user_id": 8951109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1c6ce25a6621f6b6c3889babd4e8c6a?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Hofmann", "link": "https://stackoverflow.com/users/8951109/sebastian-hofmann"}, "edited": false, "score": 0, "creation_date": 1533754615, "post_id": 51753654, "comment_id": 90467422, "body": "@SebastianHofmann I already have it."}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1533754936, "post_id": 51753654, "comment_id": 90467566, "body": "<i>they are both strings.</i> No they&#39;re not. The variable <code>terms</code> is not a string. It is a string[]. You can&#39;t search an array of strings the same way you search a string. What are you trying to do?"}], "answers": [{"comments": [{"owner": {"reputation": 30288, "user_id": 1506454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FWxUV.png?s=128&g=1", "display_name": "ASh", "link": "https://stackoverflow.com/users/1506454/ash"}, "edited": false, "score": 2, "creation_date": 1533755762, "post_id": 51753701, "comment_id": 90467903, "body": "it actually has <code>Contains(object o)</code> method, because it implement IList"}], "tags": [], "owner": {"reputation": 1721, "user_id": 9070959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fc72be4dddc4ff4156a7d875912d67?s=128&d=identicon&r=PG&f=1", "display_name": "emsimpson92", "link": "https://stackoverflow.com/users/9070959/emsimpson92"}, "is_accepted": false, "score": 0, "last_activity_date": 1533759632, "last_edit_date": 1533759632, "creation_date": 1533754008, "answer_id": 51753701, "question_id": 51753654, "link": "https://stackoverflow.com/questions/51753654/string-does-not-contain-a-definition-for-contains/51753701#51753701", "title": "&#39;string[]&#39; does not contain a definition for &#39;Contains&#39;", "body": "<p><code>string[]</code> unlike <code>List&lt;string&gt;</code> has no <code>Contains()</code> method. You'll need to run a loop through your array and compare each index.</p>\n\n<pre><code>for(int i = 0; i &lt; terms.Length; i++)\n{\n    if (terms[i].Contains(xlWorkSheet.Cells[1, i1 + 1].Value.ToString()))\n    {\n        // do something\n    }\n}\n</code></pre>\n\n<p>However, instead of doing this I suggest you just use <code>List&lt;string&gt;</code>. With that you can use <code>List.Contains()</code> the same way you're trying to do in your example. In C# lists are superior to arrays in most cases.</p>\n"}, {"tags": [], "owner": {"reputation": 130, "user_id": 8786679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94448167a4d38675ca935f40bb444e12?s=128&d=identicon&r=PG&f=1", "display_name": "hbgoddard", "link": "https://stackoverflow.com/users/8786679/hbgoddard"}, "is_accepted": false, "score": 2, "last_activity_date": 1533754211, "creation_date": 1533754211, "answer_id": 51753748, "question_id": 51753654, "link": "https://stackoverflow.com/questions/51753654/string-does-not-contain-a-definition-for-contains/51753748#51753748", "title": "&#39;string[]&#39; does not contain a definition for &#39;Contains&#39;", "body": "<p>You can use <code>Array.Exists</code> and pass a comparison lambda expression:</p>\n\n<pre><code>if (Array.Exists(terms, elem =&gt; elem == xlWorkSheet.Cells[1, i1 + 1].Value.ToString()))\n{\n    ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 2, "creation_date": 1533754957, "post_id": 51753856, "comment_id": 90467570, "body": "The question is why is the compiler binding to <code>Queryable.Contains</code> instead of <code>Enumerable.Contains</code>?"}], "tags": [], "owner": {"reputation": 2416, "user_id": 2486830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f27a137502762f8c393da56b413475f4?s=128&d=identicon&r=PG", "display_name": "George Helyar", "link": "https://stackoverflow.com/users/2486830/george-helyar"}, "is_accepted": false, "score": 2, "last_activity_date": 1533754607, "creation_date": 1533754607, "answer_id": 51753856, "question_id": 51753654, "link": "https://stackoverflow.com/questions/51753654/string-does-not-contain-a-definition-for-contains/51753856#51753856", "title": "&#39;string[]&#39; does not contain a definition for &#39;Contains&#39;", "body": "<p>There is an extension method <code>System.Linq.Enumerable.Contains</code>.</p>\n\n<p><code>string[]</code> is an <code>IEnumerable&lt;string&gt;</code> so you can use this.</p>\n\n<p>Add <code>using System.Linq;</code> to the top of the file to use it.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/system.linq.enumerable.contains(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/system.linq.enumerable.contains(v=vs.110).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 30288, "user_id": 1506454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FWxUV.png?s=128&g=1", "display_name": "ASh", "link": "https://stackoverflow.com/users/1506454/ash"}, "is_accepted": true, "score": 5, "last_activity_date": 1533759614, "last_edit_date": 1533759614, "creation_date": 1533755711, "answer_id": 51754104, "question_id": 51753654, "link": "https://stackoverflow.com/questions/51753654/string-does-not-contain-a-definition-for-contains/51754104#51754104", "title": "&#39;string[]&#39; does not contain a definition for &#39;Contains&#39;", "body": "<p>Array (<code>string[]</code>) implements <code>IList</code> and therefore should have <code>Contains(object o)</code> method. But <a href=\"https://msdn.microsoft.com/en-us/library/bb336401(v=vs.110).aspx\" rel=\"nofollow noreferrer\">implementation is explicit</a>, meaning that access to that method is possible only if class is treated as interface:</p>\n\n<pre><code>if (((IList)terms).Contains(xlWorkSheet.Cells[1, i1 + 1].Value.ToString()))\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 10121878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daabd8ad32996c8f5492e8d9b60e997c?s=128&d=identicon&r=PG&f=1", "display_name": "Zkai", "link": "https://stackoverflow.com/users/10121878/zkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9988, "favorite_count": 0, "accepted_answer_id": 51754104, "answer_count": 4, "score": 3, "last_activity_date": 1596544846, "creation_date": 1533753833, "last_edit_date": 1533755856, "question_id": 51753654, "link": "https://stackoverflow.com/questions/51753654/string-does-not-contain-a-definition-for-contains", "title": "&#39;string[]&#39; does not contain a definition for &#39;Contains&#39;", "body": "<p>The full error code:</p>\n\n<blockquote>\n  <p>Error CS1929  'string[]' does not contain a definition for 'Contains' and\n  the best extension method overload\n  'Queryable.Contains(IQueryable, TSource)' requires a\n  receiver of type 'IQueryable'</p>\n</blockquote>\n\n<pre><code>  string[] terms = new string[31];\n</code></pre>\n\n<p>I'm trying to see if an array contains something in my Excel file. (Using Interop)</p>\n\n<pre><code>if (terms.Contains(xlWorkSheet.Cells[1, i1 + 1].Value.ToString())) ;\n{\n\n}\n</code></pre>\n\n<p>Why is Contains not working here? </p>\n\n<p>I searched and apparently, it has something to do with the type not being the same, but in this case, it is. They are both strings.</p>\n"}, {"tags": ["c#", ".net", "sql-server", "service-broker"], "comments": [{"owner": {"reputation": 2290, "user_id": 8979763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J2iBy.jpg?s=128&g=1", "display_name": "Gibbon", "link": "https://stackoverflow.com/users/8979763/gibbon"}, "edited": false, "score": 0, "creation_date": 1533758497, "post_id": 51753592, "comment_id": 90469094, "body": "Have you checked that the user does have all permissions for service broker? whichever account your app is using would need RECIEVE permissions on the queues, SEND on FROM service and REFERENCES on contract"}], "owner": {"reputation": 363, "user_id": 1247395, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/3a0f49667a6dca1ce4580f801b727012?s=128&d=identicon&r=PG", "display_name": "user1247395", "link": "https://stackoverflow.com/users/1247395/user1247395"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533753591, "creation_date": 1533753591, "question_id": 51753592, "link": "https://stackoverflow.com/questions/51753592/sqldependency-start-exception-invalid-object-name", "title": "SqlDependency.Start - Exception &#39;Invalid object name...&quot;", "body": "<p>I am attempting to use the SqlDependency Object to monitor changes in SQL server but I am having an issue with the SqlDependency.Start command.</p>\n\n<p>In SQL server I issue these commands</p>\n\n<pre><code>CREATE QUEUE PJLTestQueue2;\nCREATE SERVICE PJLTestService2 ON QUEUE PJLTestQueue2 ([http://schemas.microsoft.com/SQL/Notifications/PostQueryNotification]);\n</code></pre>\n\n<p>In my code I have</p>\n\n<pre><code>readonly string ConnectionString = \"Data Source=***\"\nreadonly string queueName = \"PJLTestQueue2\";\nSqlDependency.Start(ConnectionString, queueName);\n</code></pre>\n\n<p>It throws and the exception message is: \"Invalid object name 'PJLTestQueue2'.\"</p>\n\n<p>I can issue the command select *from sys.service_queues and I see the PJLTestQueue2 in the output.</p>\n\n<p>Do I need to configure the queue differently?</p>\n\n<p>Is there some permission that I am missing?</p>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1533753245, "post_id": 51753456, "comment_id": 90466805, "body": "You are not able to do <code>var statval = rvwStatDdl.SelectedValue;</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 874, "user_id": 2543778, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1a0ae46d51e31973129e4acf6c2f2df6?s=128&d=identicon&r=PG&f=1", "display_name": "IEnjoyEatingVegetables", "link": "https://stackoverflow.com/users/2543778/ienjoyeatingvegetables"}, "is_accepted": false, "score": 0, "last_activity_date": 1533753459, "creation_date": 1533753459, "answer_id": 51753559, "question_id": 51753456, "link": "https://stackoverflow.com/questions/51753456/how-to-get-selected-value-of-item-from-dropdownlist-inside-formview/51753559#51753559", "title": "How to get selected value of item from dropdownlist inside formview?", "body": "<p>You can access the SelectedValue property.</p>\n\n<p>Try \n<code>protected void name_SelectedIndexChanged(object sender, EventArgs e){\n        DropDownList list = (DropDownList)sender;\n        string value = list.SelectedValue;}</code></p>\n\n<p>Credit: <a href=\"https://stackoverflow.com/questions/9371187/dropdownlist-selected-value-at-selectedindexchanged-event\">Dropdownlist selected value at Selectedindexchanged event</a> Frank Lee's answer</p>\n"}, {"tags": [], "owner": {"reputation": 420, "user_id": 5240355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bl7Wb.jpg?s=128&g=1", "display_name": "Arslan Ali", "link": "https://stackoverflow.com/users/5240355/arslan-ali"}, "is_accepted": true, "score": 2, "last_activity_date": 1533753708, "creation_date": 1533753708, "answer_id": 51753618, "question_id": 51753456, "link": "https://stackoverflow.com/questions/51753456/how-to-get-selected-value-of-item-from-dropdownlist-inside-formview/51753618#51753618", "title": "How to get selected value of item from dropdownlist inside formview?", "body": "<p>I think you should cast as <strong>DropDownList</strong> after finding control</p>\n\n<pre><code>var statVal = ((DropDownList)fvDocRvwrs.FindControl(\"rwStatDdl\")).SelectedValue.ToString();\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 1916528, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/303b0a427abf8f0ab3cdb9a1b2aa54ca?s=128&d=identicon&r=PG", "display_name": "user1916528", "link": "https://stackoverflow.com/users/1916528/user1916528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 51753618, "answer_count": 2, "score": 0, "last_activity_date": 1533753708, "creation_date": 1533753063, "question_id": 51753456, "link": "https://stackoverflow.com/questions/51753456/how-to-get-selected-value-of-item-from-dropdownlist-inside-formview", "title": "How to get selected value of item from dropdownlist inside formview?", "body": "<p>I need to get the value of the selected item in a dropdown list that's inside the edit template of a formview control.  The formview ID is \"fvDocRvwrs\". </p>\n\n<p>Here's the markup for the dropdownlist:</p>\n\n<pre><code>&lt;asp:DropDownList SelectedValue='&lt;%# Bind(\"rvwStat\") %&gt;' runat=\"server\" ID=\"rvwStatDdl\" CssClass=\"form-control\" DataSourceID=\"sdsStatuses\" DataTextField=\"stat\" DataValueField=\"statIdPk\" AppendDataBoundItems=\"true\" OnSelectedIndexChanged=\"rvwStatDdl_SelectedIndexChanged\"&gt;&lt;asp:ListItem Value=\"\"&gt;--Please Select--&lt;/asp:ListItem&gt;&lt;/asp:DropDownList&gt;\n</code></pre>\n\n<p>I'm just having some difficulty getting the SelectedValue using the onselectedindexchanged event of the dropdownlist.  I am able to find the control using:</p>\n\n<pre><code>protected void rvwStatDdl_SelectedIndexChanged(object sender, EventArgs e)\n    {\n        var statVal = fvDocRvwrs.FindControl(\"rwStatDdl\").ToString();\n    }\n</code></pre>\n\n<p>I just need to know how to populate a variable with the selected value.</p>\n"}, {"tags": ["c#", "asp.net-mvc-4"], "comments": [{"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 1, "creation_date": 1533753340, "post_id": 51753440, "comment_id": 90466850, "body": "If you trust the string values, you can use <code>Html.Raw</code> which does not do any html encoding"}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1533753565, "post_id": 51753440, "comment_id": 90466960, "body": "BTW, you can send your custom error message via ModelStateDictionary as well."}, {"owner": {"reputation": 421, "user_id": 9698139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2129f0842cf4d80df486c039f9c99dd0?s=128&d=identicon&r=PG&f=1", "display_name": "Sander", "link": "https://stackoverflow.com/users/9698139/sander"}, "edited": false, "score": 0, "creation_date": 1533753574, "post_id": 51753440, "comment_id": 90466963, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/122641/how-can-i-decode-html-characters-in-c\">How can I decode HTML characters in C#?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 12429, "user_id": 4154421, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EObMn.png?s=128&g=1", "display_name": "Jason W", "link": "https://stackoverflow.com/users/4154421/jason-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1533754016, "creation_date": 1533754016, "answer_id": 51753704, "question_id": 51753440, "link": "https://stackoverflow.com/questions/51753440/how-to-display-convert-currency-symbol-in-mvc-view-that-is-set-in-the-viewbag-as/51753704#51753704", "title": "How to display/convert currency symbol in MVC view that is set in the Viewbag as a string", "body": "<p>You can use the <code>HttpUtility</code> to decode within your view:</p>\n\n<pre><code>@HttpUtility.HtmlDecode(Model.Value)\n</code></pre>\n"}], "owner": {"reputation": 209, "user_id": 1214916, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/17b9d0c4d84ef17dae07b6988bf6b5f1?s=128&d=identicon&r=PG", "display_name": "user1214916", "link": "https://stackoverflow.com/users/1214916/user1214916"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1533756646, "creation_date": 1533753005, "last_edit_date": 1533756646, "question_id": 51753440, "link": "https://stackoverflow.com/questions/51753440/how-to-display-convert-currency-symbol-in-mvc-view-that-is-set-in-the-viewbag-as", "title": "How to display/convert currency symbol in MVC view that is set in the Viewbag as a string", "body": "<p>I have a MVC 4 project in C# and the controller calls the business layer for some validation which returns a string.  This string if not null will return back to the View in Viewbag and display in a dialog which is plan text.  The validation string contains some message and also an amount with pound sign symbol (\u00a3).  When it is displayed in the view, the \u00a3 symbol shows as <code>&amp;#163;</code> </p>\n\n<p>What do I need to do so \u00a3 sign displayed as the currency symbol besides using Html.Raw (since it's not a good practice to put this in Razor view)? </p>\n\n<p>Edit: htmldecode is not the right answer.  I need a way to not encode the string again.  Either Html.Raw or MvcHtmlString.Create works</p>\n"}, {"tags": ["c#", "winforms", "reporting-services", "reportviewer"], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "edited": false, "score": 0, "creation_date": 1534335379, "post_id": 51856854, "comment_id": 90669096, "body": "I am about to try this out now."}, {"owner": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "edited": false, "score": 0, "creation_date": 1534339814, "post_id": 51856854, "comment_id": 90671509, "body": "So I encountered a few hiccups in this solution: 1. I have a separate class with the <code>Print</code> functionalities in it and this class does not have a constructor for <code>ReportViewer</code>. Just <code>Report</code>, <code>LocalReport</code>, and <code>ServerReport</code>. I tried doing it on the <code>ServerReport</code> constructor AND the <code>Report</code> constructor. Neither have the <code>PrinterSettings</code> property. 2. <code>reportViewer1.PrinterSettings.PaperSizes</code> does not have a <code>cast</code> property. Continued in next comment...."}, {"owner": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "edited": false, "score": 0, "creation_date": 1534339906, "post_id": 51856854, "comment_id": 90671557, "body": "But I used yours as an example to create a separate <code>PaperSize</code> variable and if the report is landscape, I set the <code>PaperSize</code> variable width and height accordingly and use this variable for my printing purposes. It now prints in landscape. The only problem I have is, the report is getting squeezed in a bit. My actual report is designed to fit a landscape paper exactly, but for some reason, the application squeezes it in. I can look at further and figure out what&#39;s going on now. Thank you so much for bringing me this far! :)"}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "reply_to_user": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "edited": false, "score": 0, "creation_date": 1534351881, "post_id": 51856854, "comment_id": 90678271, "body": "I didn&#39;t have any problem printing the report. I just added another way of creating the <code>PageSetting</code> based on the default page setting of the report, since you have setup the default page setting to be landscape, you can use it. (Just for your information <code>Cast</code> is a linq extension method in <code>System.Linq</code> namespace."}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "reply_to_user": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "edited": false, "score": 0, "creation_date": 1534351945, "post_id": 51856854, "comment_id": 90678297, "body": "Also I created an extension method called <code>Print</code> for <code>LocalReport</code>. You can easily use <code>Print()</code> or <code>Print(PageSettings)</code>. You can find it <a href=\"http://www.reza-aghaei.com/print-rdlc-report-without-showing-the-reportviewer/\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "edited": false, "score": 0, "creation_date": 1534367296, "post_id": 51856854, "comment_id": 90685052, "body": "Beautiful, thank you so much! You&#39;ve been very helpful :)"}, {"owner": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "edited": false, "score": 0, "creation_date": 1534367616, "post_id": 51856854, "comment_id": 90685180, "body": "Will the code on your link work if I change the <code>LocalReport</code> to <code>ServerReport</code> instead? This is a much more streamlined clean way of doing it and I wanted to try it out."}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "reply_to_user": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "edited": false, "score": 0, "creation_date": 1534381540, "post_id": 51856854, "comment_id": 90688483, "body": "You&#39;re welcome :) At the moment I don&#39;t have access to Reporting Services, I&#39;ll look at that as soon as I have access to SSRS."}, {"owner": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "edited": false, "score": 0, "creation_date": 1534427458, "post_id": 51856854, "comment_id": 90708711, "body": "The only thing I had to change in your code was the <code>report.Render</code> function. <code>ServerReport</code> has a different <code>Render()</code> function than a <code>LocalReport</code> does. I changed that and the report prints in Landscape perfectly. Again, thank you!"}], "tags": [], "owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "is_accepted": true, "score": 3, "last_activity_date": 1607923502, "last_edit_date": 1607923502, "creation_date": 1534328045, "answer_id": 51856854, "question_id": 51753431, "link": "https://stackoverflow.com/questions/51753431/printing-an-ssrs-report-in-landscape-mode-from-windows-forms-application/51856854#51856854", "title": "Printing an SSRS report in Landscape mode from Windows Forms application", "body": "<p>You need to use a suitable <code>PageSettings</code> for the <code>PrintDocument</code> which is used for printing. You need to apply some changes to code of that <a href=\"https://docs.microsoft.com/en-us/previous-versions/ms252091(v=vs.140)?redirectedfrom=MSDN&amp;WT.mc_id=DT-MVP-5003235\" rel=\"nofollow noreferrer\">article</a> to be able to print in different paper size or page layout.</p>\n<p>First you need to create a suitable <code>PageSettings</code>, for example if you have set the default page setting for your report to be landscape:</p>\n<pre><code>var report = reportViewer1.LocalReport;\nvar pageSettings = new PageSettings();\npageSettings.PaperSize = report.GetDefaultPageSettings().PaperSize;\npageSettings.Landscape = report.GetDefaultPageSettings().IsLandscape;\npageSettings.Margins = report.GetDefaultPageSettings().Margins;\n</code></pre>\n<p>or if you want to create a new page setting:</p>\n<pre><code>var pageSettings = new PageSettings();\npageSettings.Landscape = true;\npageSettings.PaperSize = reportViewer1.PrinterSettings.PaperSizes.Cast&lt;PaperSize&gt;()\n    .Where(x =&gt; x.Kind == PaperKind.A4).First();\n</code></pre>\n<p>Then use the <code>pageSetting</code> when creating the deviceInfo:</p>\n<pre><code>string deviceInfo =\n    $@&quot;&lt;DeviceInfo&gt;\n        &lt;OutputFormat&gt;EMF&lt;/OutputFormat&gt;\n        &lt;PageWidth&gt;{pageSettings.PaperSize.Width * 100}in&lt;/PageWidth&gt;\n        &lt;PageHeight&gt;{pageSettings.PaperSize.Height * 100}in&lt;/PageHeight&gt;\n        &lt;MarginTop&gt;{pageSettings.Margins.Top * 100}in&lt;/MarginTop&gt;\n        &lt;MarginLeft&gt;{pageSettings.Margins.Left * 100}in&lt;/MarginLeft&gt;\n        &lt;MarginRight&gt;{pageSettings.Margins.Right * 100}in&lt;/MarginRight&gt;\n        &lt;MarginBottom&gt;{pageSettings.Margins.Bottom * 100}in&lt;/MarginBottom&gt;\n    &lt;/DeviceInfo&gt;&quot;;\n</code></pre>\n<p>And at last, use the same pageSettings with <code>PrintDocument</code>:</p>\n<pre><code>PrintDocument printDoc = new PrintDocument();\nprintDoc.DefaultPageSettings = pageSettings;\n</code></pre>\n<p>I've created an extension method to make it easier to print the report easily by calling <code>Print()</code> or <code>Print(PageSettings)</code>. You can find it here: <a href=\"http://www.reza-aghaei.com/print-rdlc-report-without-showing-the-reportviewer/\" rel=\"nofollow noreferrer\">Print RDLC Report without showing the ReportViewer</a></p>\n"}], "owner": {"reputation": 449, "user_id": 7366463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a3f98dca3557707c30be43341d25c5?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Cucumber", "link": "https://stackoverflow.com/users/7366463/crazy-cucumber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 51856854, "answer_count": 1, "score": 2, "last_activity_date": 1607923502, "creation_date": 1533752986, "last_edit_date": 1534262180, "question_id": 51753431, "link": "https://stackoverflow.com/questions/51753431/printing-an-ssrs-report-in-landscape-mode-from-windows-forms-application", "title": "Printing an SSRS report in Landscape mode from Windows Forms application", "body": "<p>I have a Windows Forms application that has a <code>textbox</code>, a <code>button</code>, and 3 <code>ReportViewer</code>. The 3 <code>ReportViewer</code> boxes are hidden. When you enter a <code>ShopOrder</code> into the textbox and click on the button, it will automatically pass the Shop order value as a parameter to all 3 reports, render the report, and once the rendering is complete, render the report as EMF file, print the report.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms252091.aspx\" rel=\"nofollow noreferrer\">I am using this link as a guide to print SSRS reports automatically from a Windows Forms application.</a></p>\n\n<p>I have a few variances in my application because I am using <code>ServerReports</code> in my <code>ReportViewer</code> and not <code>LocalReport</code>. But after all these changes, my application prints them all out with no problems.</p>\n\n<p>But the only issue I have is, I am not able to set my page orientation to <code>Landscape</code>, even though the orientation on my report is Landscape. </p>\n\n<p>So I thought maybe I need to set the <code>deviceInfo</code> variable's <code>PageWidth</code> and <code>PageHeight</code> variables accordingly, so this is what the <code>deviceInfo</code> variable has:</p>\n\n<pre><code>string deviceInfo =\n    @\"&lt;DeviceInfo&gt;\n        &lt;OutputFormat&gt;EMF&lt;/OutputFormat&gt;\n        &lt;PageWidth&gt;11in&lt;/PageWidth&gt;\n        &lt;PageHeight&gt;8.5in&lt;/PageHeight&gt;\n        &lt;MarginTop&gt;0.25in&lt;/MarginTop&gt;\n        &lt;MarginLeft&gt;0.25in&lt;/MarginLeft&gt;\n        &lt;MarginRight&gt;0.25in&lt;/MarginRight&gt;\n        &lt;MarginBottom&gt;0.25in&lt;/MarginBottom&gt;\n    &lt;/DeviceInfo&gt;\";\n</code></pre>\n\n<p>I have two <code>Export</code> functions: <code>Export</code> and <code>ExportLandscape</code>. The code snippet above is a part of <code>ExportLandscape</code>. When I call <code>ExportLandscape</code>, my report still prints in Portrait. </p>\n\n<p>I tried just completely removing the Page setup options from my <code>DeviceInfo</code> variable and made it just say the <code>OutputFormat</code>. That didn't do it either.</p>\n\n<p>Is there anything else I need to change for my report to print in Landscape? What am I missing? </p>\n\n<p>It is also worth noting that, out of my 3 reports, 2 of them print in Landscape and 1 prints in Portrait. So I would really like for my application to just print it in whatever page settings the report is in. I just tried getting the report's page size and report's margins and setting those to my <code>DeviceInfo</code> variable <a href=\"https://blogs.msdn.microsoft.com/brianhartman/2009/02/27/manually-printing-a-report/\" rel=\"nofollow noreferrer\">as suggested here</a>. STILL NO LUCK!! </p>\n\n<p>I just tried adding a breakpoint at the <code>Export(ReportViewer report)</code> function and stepped through. When I get the <code>report.ServerReport.GetDefaultPageSettings().PaperSize</code> in the immediate window, I see this:</p>\n\n<pre><code>{[PaperSize Letter Kind=Letter Height=1100 Width=850]}\n    Height: 1100\n    Kind: Letter\n    PaperName: \"Letter\"\n    RawKind: 1\n    Width: 850\n</code></pre>\n\n<p>This makes me feel like even though my report is set to landscape (height = 8.5in and Width = 11in), my application does not seem to recognize it. </p>\n\n<p><strong>Important Update:</strong>  </p>\n\n<p>The printer I am printing to has 2 paper trays. When I print a portrait report, it takes it from the default tray with the default paper size (tray 2). But when my application sends the landscape report to print, the printer tries to get a paper out of tray 1. When I load tray 1 with the same paper that is in tray 2, it asks me to enter a width and height of the paper. The printer does not seem to understand when I tell it to print it in landscape. Or rather, the printer thinks this is some new setting that it does not know about. When I enter 11 for width and 8.5 for height, it prints landscape data on a portrait paper. </p>\n\n<p>To make myself clearer, the data is getting printed with a width of 11 and height of 8.5. AKA, only 75% of the data gets printed. The rest gets pushed out of the page because the page is still being oriented in portrait. </p>\n"}, {"tags": ["c#", "ajax", "web-services", "httpwebrequest", "postman"], "comments": [{"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1533775690, "post_id": 51753391, "comment_id": 90474276, "body": "You need to explicitly set <code>ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12;</code> A validation callback is not required. Also, you should provide a CookieContainer (it will set 2 cookies). If a sample code is needed, let me know."}, {"owner": {"reputation": 3092, "user_id": 648368, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/nsODi.jpg?s=128&g=1", "display_name": "Tomer W", "link": "https://stackoverflow.com/users/648368/tomer-w"}, "reply_to_user": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1533787541, "post_id": 51753391, "comment_id": 90476536, "body": "@Jimi I did set a cookie container but it was same. and Forgot to show i enabled all Tls1, Tls2, Ssl."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1533813603, "post_id": 51753391, "comment_id": 90489757, "body": "Is there something else that is not shown here? What is needed for this connection (tested by exclusion): Tls1.2, a User-Agent header, Automatic decompression (<code>.AutomaticDecompression = DecompressionMethods.GZip | DecompressionMethods.Deflate;</code>) coupled with a <code>Accept-encoding</code> header. A <code>CookieContainer</code> could be useful (on your side), but is not required. Neither is the Server Certificate validation callback (with the connection address provided, might be needed for a different access level). You didn&#39;t say whether there&#39;s a Proxy in between."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1533814093, "post_id": 51753391, "comment_id": 90490077, "body": "The Accept-encoding header: <code>webRequest.Headers.Add(HttpRequestHeader.AcceptEncoding, &quot;gzip, deflate;q=0.8&quot;);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8885, "user_id": 5402620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21079ba43a1f39464935b350d2649049?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathon Chase", "link": "https://stackoverflow.com/users/5402620/jonathon-chase"}, "edited": false, "score": 0, "creation_date": 1533758412, "post_id": 51754542, "comment_id": 90469042, "body": "It looks like the headers required are the <code>User-Agent</code> to avoid a 403 and the <code>Accept-Encoding</code> to avoid the 500."}, {"owner": {"reputation": 3092, "user_id": 648368, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/nsODi.jpg?s=128&g=1", "display_name": "Tomer W", "link": "https://stackoverflow.com/users/648368/tomer-w"}, "edited": false, "score": 0, "creation_date": 1533787560, "post_id": 51754542, "comment_id": 90476540, "body": "this seem to work... i just need to figure the return streem. Thanks"}, {"owner": {"reputation": 3092, "user_id": 648368, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/nsODi.jpg?s=128&g=1", "display_name": "Tomer W", "link": "https://stackoverflow.com/users/648368/tomer-w"}, "edited": false, "score": 0, "creation_date": 1533836859, "post_id": 51754542, "comment_id": 90504944, "body": "Thanks, It works great now. didn&#39;t know Postman add headers that it doesn&#39;t show. Thanks again"}], "tags": [], "owner": {"reputation": 2290, "user_id": 8979763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J2iBy.jpg?s=128&g=1", "display_name": "Gibbon", "link": "https://stackoverflow.com/users/8979763/gibbon"}, "is_accepted": true, "score": 1, "last_activity_date": 1533757602, "creation_date": 1533757602, "answer_id": 51754542, "question_id": 51753391, "link": "https://stackoverflow.com/questions/51753391/webhttprequest-fails-500-while-postman-successfully-runs-the-web-get-request/51754542#51754542", "title": "WebHttpRequest fails (500) while postman successfully runs the web GET request", "body": "<p>So, the reason that this is failing is because of the headers being included in the client request from postman by default, though not from the C# request.</p>\n\n<p>Using a program like Fiddler (<a href=\"https://www.telerik.com/fiddler\" rel=\"nofollow noreferrer\">https://www.telerik.com/fiddler</a>) you can watch the request to see that the headers from the postman request are:</p>\n\n<pre><code>Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8    \nAccept-Encoding: gzip, deflate, br    \nAccept-Language: en-US,en;q=0.9    \nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36\n</code></pre>\n\n<p>Yet from C# are just</p>\n\n<pre><code>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36\n</code></pre>\n\n<p>Filling in the extra client request headers like this allows it to go through fine: </p>\n\n<pre><code>webRequest.Accept = \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\";\nwebRequest.Headers.Add(\"Accept-Encoding\", \"gzip deflate,br\");\nwebRequest.Headers.Add(\"Accept-Language\", \"en-US,en;q=0.9\");\n</code></pre>\n"}], "owner": {"reputation": 3092, "user_id": 648368, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/nsODi.jpg?s=128&g=1", "display_name": "Tomer W", "link": "https://stackoverflow.com/users/648368/tomer-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1973, "favorite_count": 0, "accepted_answer_id": 51754542, "answer_count": 1, "score": 2, "last_activity_date": 1533836801, "creation_date": 1533752847, "last_edit_date": 1533836801, "question_id": 51753391, "link": "https://stackoverflow.com/questions/51753391/webhttprequest-fails-500-while-postman-successfully-runs-the-web-get-request", "title": "WebHttpRequest fails (500) while postman successfully runs the web GET request", "body": "<p>I try to get a specific value from a specific site...</p>\n\n<p>the site periodically updating the value using an Ajax call to \n<a href=\"https://www.plus500.co.il/api/LiveData/FeedUpdate?instrumentId=19\" rel=\"nofollow noreferrer\">https://www.plus500.co.il/api/LiveData/FeedUpdate?instrumentId=19</a></p>\n\n<p>(you can Navigate to the address and see you get the XML response.)</p>\n\n<p>using Postman:\nsending </p>\n\n<pre><code>GET /api/LiveData/FeedUpdate?instrumentId=19 HTTP/1.1\nHost: www.plus500.co.il\nCache-Control: no-cache\nPostman-Token: f823c87d-3edc-68ce-e1e7-02a8fc68be7a\n</code></pre>\n\n<p>I get a valid Json Response...</p>\n\n<p>Though, when i try it from C#:</p>\n\n<pre><code>var webRequest = WebRequest.CreateHttp(@\"https://www.plus500.co.il/api/LiveData/FeedUpdate?instrumentId=19\");\nwebRequest.Method = \"GET\";\nusing (var response = webRequest.GetResponse())\n{...}\n</code></pre>\n\n<p>The request Fails with Error-Code 403 (Forbidden)</p>\n\n<p>when adding:</p>\n\n<pre><code>webRequest.UserAgent = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36\";\n</code></pre>\n\n<p>The request Fails with Error-Code 500 (Internal Server Error)</p>\n\n<p><strong>Addition (Edit)</strong></p>\n\n<p>I also initiate with</p>\n\n<pre><code>ServicePointManager.ServerCertificateValidationCallback = delegate { return true; };\n        ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12 |\n                                   SecurityProtocolType.Tls11 |\n                                   SecurityProtocolType.Tls |\n                                   SecurityProtocolType.Ssl3;\n</code></pre>\n\n<p>Also, I Tried Setting a CookieContainer, but the result is the same 500.</p>\n\n<p>Why is Postman/Chrome Successfuly querying this API while C# Webrequest do not?<br>\nWhat is the difference?</p>\n"}, {"tags": ["c#", "azure", "azure-table-storage", "row-key"], "comments": [{"owner": {"reputation": 64493, "user_id": 272109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32170c62eb744820e8afdd023379a95a?s=128&d=identicon&r=PG", "display_name": "David Makogon", "link": "https://stackoverflow.com/users/272109/david-makogon"}, "edited": false, "score": 2, "creation_date": 1533754697, "post_id": 51753367, "comment_id": 90467452, "body": "Not sure exactly what you&#39;re asking. You can use anything you want for partition key and row key, as long as the combination of the two (pk+rk) is unique. Please edit your question to be more specific. Also, note that each call to <code>CreateTableIfNotExists()</code> requires a call to Table Storage, which is unnecessary if you create your table as part of your setup/startup."}], "answers": [{"tags": [], "owner": {"reputation": 749, "user_id": 9800292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda0544bbd230cc28489563aa70065ea?s=128&d=identicon&r=PG&f=1", "display_name": "Pete Philters", "link": "https://stackoverflow.com/users/9800292/pete-philters"}, "is_accepted": true, "score": 1, "last_activity_date": 1533770061, "creation_date": 1533770061, "answer_id": 51756881, "question_id": 51753367, "link": "https://stackoverflow.com/questions/51753367/how-to-auto-generate-a-rowkey-in-a-azure-table-storage-using-c/51756881#51756881", "title": "How to auto generate a RowKey in a Azure table storage using C#", "body": "<p>In your customer entity class you are calling the <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/constructors\" rel=\"nofollow noreferrer\">Constructor</a> </p>\n\n<pre><code>public CustomerEntity(string lastName, string firstName)\n{ \n    this.PartitionKey = lastName;\n    this.RowKey = firstName;\n}\n</code></pre>\n\n<p>So when you initialise a new object you pass through two parameters, as defined in the constructor, <code>firstname</code> and <code>lastname</code>.</p>\n\n<p>new </p>\n\n<p>These are set by name by the constructor and hold no meaning outside their context (i.e. in the table store). </p>\n\n<pre><code>CustomerEntity customer1 = new CustomerEntity(\"NoSolution\", \"Smith\");\n</code></pre>\n\n<p>In your code all you need to do is change your constructor to be like </p>\n\n<pre><code>public CustomerEntity(string requesterName, string uniqueRowKey)\n{ \n    this.PartitionKey = requesterName ;\n    this.RowKey = uniqueRowKey;\n}\n</code></pre>\n\n<p>Your RowKey must be unique and your partition key is used to make searching easier by grouping rows of similar types. You can then pass through to your constructor like this:</p>\n\n<pre><code>string rowKey = Guid.NewGuid().ToString(\"N\"); //This give you a unique guid with no hyphens.\nCustomerEntity customer1 = new CustomerEntity(\"John Smith\", rowKey);\n</code></pre>\n\n<p>Which would insert your entity with that set to the Partition Key and Row Key respectively. </p>\n\n<p>Is that the sort of thing you were looking for? </p>\n"}], "owner": {"reputation": 257, "user_id": 10190803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92cc0e9e3e6aa5c29bc05b9c64296921?s=128&d=identicon&r=PG&f=1", "display_name": "user10190803", "link": "https://stackoverflow.com/users/10190803/user10190803"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2709, "favorite_count": 1, "accepted_answer_id": 51756881, "answer_count": 1, "score": 3, "last_activity_date": 1533770061, "creation_date": 1533752738, "question_id": 51753367, "link": "https://stackoverflow.com/questions/51753367/how-to-auto-generate-a-rowkey-in-a-azure-table-storage-using-c", "title": "How to auto generate a RowKey in a Azure table storage using C#", "body": "<p>I am trying to change the RowKey from a predefined lastname from the Micorosft Docs tutorial: <a href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/table-storage-how-to-use-dotnet#add-an-entity-to-a-table\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/azure/cosmos-db/table-storage-how-to-use-dotnet#add-an-entity-to-a-table</a>, to a unique value.</p>\n\n<p>This is my current code:</p>\n\n<pre><code>private void storeuserinput(Activity activity)\n        {\n            var uid = activity.From.Id;\n            var uname = activity.From.Name;\n\n            if (activity.Text?.ToLower().ToString() == \"no\" || activity.Text?.ToLower().ToString() == \"NO\" || activity.Text?.ToLower().ToString() == \"No\" || activity.Text?.ToLower().ToString() == \"Nope\" || activity.Text?.ToLower().ToString() == \"nope\")\n            {\n                var userinput = firstmessage;\n\n                string connectionString = CloudConfigurationManager.GetSetting(\"StorageConnectionString\");\n\n                // Parse the connection string and return a reference to the storage account.\n                CloudStorageAccount storageAccount = CloudStorageAccount.Parse(CloudConfigurationManager.GetSetting(\"StorageConnectionString\"));\n\n                // Create the table client.\n                CloudTableClient tableClient = storageAccount.CreateCloudTableClient();\n\n                // Retrieve a reference to the table.\n                CloudTable table = tableClient.GetTableReference(\"UnansweredChatBot\");\n\n                // Create the table if it doesn't exist.\n                table.CreateIfNotExists();\n\n                // Create a new customer entity.\n                CustomerEntity customer1 = new CustomerEntity(\"NoSolution\", \"Smith\");\n                customer1.Query = firstmessage;\n\n                // Create the TableOperation object that inserts the customer entity.\n                TableOperation insertOperation = TableOperation.Insert(customer1);\n\n                // Execute the insert operation.\n                table.Execute(insertOperation);\n            }\n\n            //extract other data from \"activity\" object\n\n            //your code logic here\n            //store data in your table storage\n\n            //Note: specifcial scenario of user send attachment\n        }\n\npublic class CustomerEntity : TableEntity\n{\n    public CustomerEntity(string lastName, string firstName)\n    {\n        this.PartitionKey = lastName;\n        this.RowKey = firstName;\n    }\n\npublic CustomerEntity() { } // the parameter-less constructor must be provided\n\npublic string Query { get; set; }\n}\n</code></pre>\n\n<p>Any insight help with this problem would be much appreciated!</p>\n"}, {"tags": ["c#", "visual-studio"], "comments": [{"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1533753228, "post_id": 51753360, "comment_id": 90466791, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11023998/clickonce-does-not-support-the-request-execution-level-requireadministrator\">&quot;ClickOnce does not support the request execution level &#39;requireAdministrator.&#39;&quot;</a>"}, {"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 0, "creation_date": 1533753570, "post_id": 51753360, "comment_id": 90466962, "body": "The answer, by Brian (and duplicated below) in that original question was the same thing you could have tried here.  (See <code>asInvoker</code> notation)"}], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 5741643, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/27485d5a049481e18d6aeb3f18480447?s=128&d=identicon&r=PG&f=1", "display_name": "Poul Bak", "link": "https://stackoverflow.com/users/5741643/poul-bak"}, "is_accepted": true, "score": 1, "last_activity_date": 1533753253, "creation_date": 1533753253, "answer_id": 51753502, "question_id": 51753360, "link": "https://stackoverflow.com/questions/51753360/clickonce-does-not-support-visual-studio-bug/51753502#51753502", "title": "&quot;ClickOnce does not support&quot; visual studio Bug?", "body": "<p>You have an 'app.manifest' that sets this. Open it make sure it contains:</p>\n\n<pre><code>      &lt;requestedPrivileges xmlns=\"urn:schemas-microsoft-com:asm.v3\"&gt;\n            &lt;requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\" /&gt;\n      &lt;/requestedPrivileges&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14319440, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GjSVaIHNwPaPLW1ACFZwyJwVzRxkO8FIZZaArNrwg=k-s128", "display_name": "Rajavelayutham R", "link": "https://stackoverflow.com/users/14319440/rajavelayutham-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1600761671, "last_edit_date": 1600761671, "creation_date": 1600759946, "answer_id": 64005021, "question_id": 51753360, "link": "https://stackoverflow.com/questions/51753360/clickonce-does-not-support-visual-studio-bug/64005021#64005021", "title": "&quot;ClickOnce does not support&quot; visual studio Bug?", "body": "<p>Go to the application properties (right-click on the solution file and click the properties), then go the security tab.<br />\nThen disable the <em>click-once</em> security setting check box.<br />\nThat will work.</p>\n"}], "owner": {"reputation": 159, "user_id": 9668640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6689aaa518d1b365eee2056f8bebee1a?s=128&d=identicon&r=PG&f=1", "display_name": "Flufy", "link": "https://stackoverflow.com/users/9668640/flufy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 51753502, "answer_count": 2, "score": -1, "last_activity_date": 1600761671, "creation_date": 1533752716, "question_id": 51753360, "link": "https://stackoverflow.com/questions/51753360/clickonce-does-not-support-visual-studio-bug", "title": "&quot;ClickOnce does not support&quot; visual studio Bug?", "body": "<p>I want to publish my C# app, but I got the error <code>\"ClickOnce does not support the request execution level 'requireAdministrator.'\u201d</code>.</p>\n\n<p>Then I tried to uncheck \"Enable ClickOnce security settings\" <a href=\"https://stackoverflow.com/a/11036922/9114020\">like this answer</a>.</p>\n\n<p>but when I click \"Publish\" the \"Enable Clickonce Security Settings\" re-enables, like <a href=\"https://stackoverflow.com/q/40493629/9114020\">this un answerd question</a></p>\n\n<p>Therefore I can't cancel the error <code>\"ClickOnce does not support the request execution level 'requireAdministrator.'\u201d</code></p>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 1333, "user_id": 10045057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOog4.png?s=128&g=1", "display_name": "Nathalia Soragge", "link": "https://stackoverflow.com/users/10045057/nathalia-soragge"}, "edited": false, "score": 0, "creation_date": 1533753003, "post_id": 51753337, "comment_id": 90466664, "body": "What you need is called Inverse Kinematics (IK). You can see the manual page about it here: <a href=\"https://docs.unity3d.com/Manual/InverseKinematics.html\" rel=\"nofollow noreferrer\">Inverse Kinematics</a>"}, {"owner": {"reputation": 318, "user_id": 5444350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a6915585005bd4f31414961c7d5968c?s=128&d=identicon&r=PG&f=1", "display_name": "Senbazuru", "link": "https://stackoverflow.com/users/5444350/senbazuru"}, "edited": false, "score": 0, "creation_date": 1533797751, "post_id": 51753337, "comment_id": 90480237, "body": "I can really recommend <a href=\"https://github.com/Stereoarts/SAFullBodyIK\" rel=\"nofollow noreferrer\">SAFullBodyIK</a> IK solver to you. It&#39;s a free git project and compares well to AssetStore solutions for money."}, {"owner": {"reputation": 29, "user_id": 3926685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5be7c3cf165bafd29359d902aefbde3e?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/3926685/john-doe"}, "edited": false, "score": 0, "creation_date": 1533808223, "post_id": 51753337, "comment_id": 90486418, "body": "Thank you guys. I have managed to be able to move the hands and legs of a humanoid with Unity IK. But Unity IK only work with the legs and arms. Not torso or head. Looks like a Custom IK system needs to be used."}], "owner": {"reputation": 29, "user_id": 3926685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5be7c3cf165bafd29359d902aefbde3e?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/3926685/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533752633, "creation_date": 1533752633, "question_id": 51753337, "link": "https://stackoverflow.com/questions/51753337/how-can-i-move-only-a-certain-body-part-of-humanoid-with-cursor-in-unity", "title": "How can I move only a certain body part of humanoid with cursor in Unity?", "body": "<p>For example a humanoid is standing still and one hand is grabbed with the cursor and cursor is moved around to make the humanoid do a waving motion. In this case the hand and the arm will only be moved but the rest of the body stays still.</p>\n\n<p>How can I achieve this? How do I add a collider between each joint? or do I need to use ragdoll mechanics? I have no idea how to achieve this. If someone could send me in the right direction. I just need to basically be able to turn a humanoid in to a puppet where any parts can be grabbed and moved with the cursor.</p>\n"}, {"tags": ["c#", "unity3d", "camera"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10199338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lTzBQyOwLhY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pF023YsHim9mw06qzfHSX3szxaDg/mo/photo.jpg?sz=128", "display_name": "Tachi", "link": "https://stackoverflow.com/users/10199338/tachi"}, "edited": false, "score": 0, "creation_date": 1533789182, "post_id": 51755151, "comment_id": 90476945, "body": "How do I go about doing it then? I&#39;ve tried removing it as a child, when there&#39;s no enemy the camera seems ok, but the moment I place an enemy the camera looks directly at the centerpoint of both targets, which still leaves my question unsolved."}], "tags": [], "owner": {"reputation": 111, "user_id": 8618827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68a83b23d970125a2d612bdfb118c604?s=128&d=identicon&r=PG&f=1", "display_name": "Falcon", "link": "https://stackoverflow.com/users/8618827/falcon"}, "is_accepted": false, "score": 0, "last_activity_date": 1533760118, "creation_date": 1533760118, "answer_id": 51755151, "question_id": 51753317, "link": "https://stackoverflow.com/questions/51753317/camera-lock-on-behind-player-while-targeting-enemy/51755151#51755151", "title": "Camera Lock-On behind player while targeting enemy", "body": "<p>If you are moving you camera by script, it shouldn't be child of the moving player at the same time. You are setting up some position from script, but at the same time, this position is modified also by parent object so final result is unpredictable.</p>\n"}], "owner": {"reputation": 1, "user_id": 10199338, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lTzBQyOwLhY/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pF023YsHim9mw06qzfHSX3szxaDg/mo/photo.jpg?sz=128", "display_name": "Tachi", "link": "https://stackoverflow.com/users/10199338/tachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1533760118, "creation_date": 1533752529, "last_edit_date": 1533759689, "question_id": 51753317, "link": "https://stackoverflow.com/questions/51753317/camera-lock-on-behind-player-while-targeting-enemy", "title": "Camera Lock-On behind player while targeting enemy", "body": "<p>Something similar to either Rocket League or Kingdom Hearts, where the camera locks onto the target but it still keeps the player in the center of the screen. I've placed the camera as a child of the player, but after trying out various solutions from others I'm still unable to position the camera correctly.</p>\n\n<pre><code>public List&lt;Transform&gt; targets;\n\nprivate void EnemyCam()\n{\n    Vector3 centerPoint = GetCenterPoint();\n    transform.LookAt(centerPoint);\n\n    Vector3 newPos = centerPoint;\n\n    transform.position = Vector3.SmoothDamp(transform.position, newPos, ref \n    velocity, smoothTime);\n}\n\nprivate Vector3 GetCenterPoint()\n{\n    if (targets.Count == 1)\n        return targets[0].position;\n\n    var bounds = new Bounds(targets[0].position, Vector3.zero);\n\n    for (int i = 0; i &lt; targets.Count; ++i)\n        bounds.Encapsulate(targets[i].position);\n\n    return bounds.center;\n}\n</code></pre>\n"}, {"tags": ["c#", "linq", "select", "dynamic"], "comments": [{"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 0, "creation_date": 1533752950, "post_id": 51753165, "comment_id": 90466631, "body": "In the <code>foreach</code> loop, you are repeatedly overriding <code>mbr</code> with a new value without using it. Did you mean to do this?"}, {"owner": {"reputation": 2608, "user_id": 4430183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHS4j.jpg?s=128&g=1", "display_name": "Emre Savc\u0131", "link": "https://stackoverflow.com/users/4430183/emre-savc%c4%b1"}, "reply_to_user": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 0, "creation_date": 1533753059, "post_id": 51753165, "comment_id": 90466691, "body": "Actually I try to mix two different solution one in the question other is : <a href=\"https://stackoverflow.com/questions/17647627/dynamic-linq-order-by-on-nested-property-with-null-properties\" title=\"dynamic linq order by on nested property with null properties\">stackoverflow.com/questions/17647627/&hellip;</a> I saw the accepted answer do the same thing in loop."}], "answers": [{"comments": [{"owner": {"reputation": 2608, "user_id": 4430183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHS4j.jpg?s=128&g=1", "display_name": "Emre Savc\u0131", "link": "https://stackoverflow.com/users/4430183/emre-savc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1533753617, "post_id": 51753530, "comment_id": 90466983, "body": "I know eventually it becomes CityId. I want to generate linq select something like .Select(s =&gt; new { s.Recipient.CityId }) and parameter fields can change dynamically."}, {"owner": {"reputation": 2608, "user_id": 4430183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHS4j.jpg?s=128&g=1", "display_name": "Emre Savc\u0131", "link": "https://stackoverflow.com/users/4430183/emre-savc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1533811441, "post_id": 51753530, "comment_id": 90488375, "body": "I added the answer which is solved my problem. I hope it helps you to understand what I was trying to solve. Thx for trying to help."}], "tags": [], "owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "is_accepted": false, "score": 0, "last_activity_date": 1533753345, "creation_date": 1533753345, "answer_id": 51753530, "question_id": 51753165, "link": "https://stackoverflow.com/questions/51753165/dynamically-generate-linq-select-with-nested-properties/51753530#51753530", "title": "Dynamically generate LINQ select with nested properties", "body": "<p>I believe your problem is in this chunk of code:</p>\n\n<pre><code>string[] nestedProps = o.Split('.');\nExpression mbr = xParameter;\n\nforeach (var prop in nestedProps)\n    mbr = Expression.PropertyOrField(mbr, prop);\n\n// property \"Field1\"\nPropertyInfo mi = typeof( Shipment ).GetProperty( ((MemberExpression)mbr).Member.Name );\n</code></pre>\n\n<p>The <code>foreach</code> loop is repeatedly assigning a value to <code>mbr</code> and then overwriting it, which means its ultimate value is going to be the expression equivalent of the last value in <code>nestedProps</code>. Assuming the input string is <code>\"Recipient.CityId\"</code>, <code>mbr</code> is going to be an expression of <code>CityId</code>. You then try to do <code>GetProperty</code> on the <code>Shipment</code> type looking for a property by the name of <code>CityId</code>, which of course doesn't exist (<code>CityId</code> being a property of <code>Address</code>).</p>\n\n<p>I'm not sure what to suggest in order to fix the problem, though, since I'm not sure what you ultimately want out of this.</p>\n"}, {"tags": [], "owner": {"reputation": 2608, "user_id": 4430183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHS4j.jpg?s=128&g=1", "display_name": "Emre Savc\u0131", "link": "https://stackoverflow.com/users/4430183/emre-savc%c4%b1"}, "is_accepted": false, "score": 4, "last_activity_date": 1533811353, "creation_date": 1533811353, "answer_id": 51764873, "question_id": 51753165, "link": "https://stackoverflow.com/questions/51753165/dynamically-generate-linq-select-with-nested-properties/51764873#51764873", "title": "Dynamically generate LINQ select with nested properties", "body": "<p>Finally I found the solution. It generates correct lambda for two level nested properties like Shipment.Sender.CityName. So anyone who needs the same thing can use it.</p>\n\n<p>I hope it helps.</p>\n\n<pre><code>/* this comes from request\n*  request.Fields = \"Sender.CityId,Sender.CityName,Recipient.CityName,parcelUniqueId\"\n*/\n\n// in the service method\n\nvar shipmentList = _context.Shipments.\n                .OrderByDescending(s =&gt; s.Id)\n                .Skip((request.Page -1) * request.PageSize)\n                .Take(request.PageSize)\n                .Select(new SelectLambdaBuilder&lt;Shipment&gt;().CreateNewStatement(request.Fields))\n                .ToList();\n\npublic class SelectLambdaBuilder&lt;T&gt;\n{\n    // as a performence consideration I cached already computed type-properties\n    private static Dictionary&lt;Type, PropertyInfo[]&gt; _typePropertyInfoMappings = new Dictionary&lt;Type, PropertyInfo[]&gt;();\n    private readonly Type _typeOfBaseClass = typeof(T);\n\n    private Dictionary&lt;string, List&lt;string&gt;&gt; GetFieldMapping(string fields)\n    {\n        var selectedFieldsMap = new Dictionary&lt;string, List&lt;string&gt;&gt;();\n\n        foreach (var s in fields.Split(','))\n        {\n            var nestedFields = s.Split('.').Select(f =&gt; f.Trim()).ToArray();\n            var nestedValue = nestedFields.Length &gt; 1 ? nestedFields[1] : null;\n\n            if (selectedFieldsMap.Keys.Any(key =&gt; key == nestedFields[0]))\n            {\n                selectedFieldsMap[nestedFields[0]].Add(nestedValue);\n            }\n            else\n            {\n                selectedFieldsMap.Add(nestedFields[0], new List&lt;string&gt; { nestedValue });\n            }\n        }\n\n        return selectedFieldsMap;\n    }\n\n    public Func&lt;T, T&gt; CreateNewStatement(string fields)\n    {\n        ParameterExpression xParameter = Expression.Parameter(_typeOfBaseClass, \"s\");\n        NewExpression xNew = Expression.New(_typeOfBaseClass);\n\n        var selectFields = GetFieldMapping(fields);\n\n        var shpNestedPropertyBindings = new List&lt;MemberAssignment&gt;();\n        foreach (var keyValuePair in selectFields)\n        {\n            PropertyInfo[] propertyInfos;\n            if (!_typePropertyInfoMappings.TryGetValue(_typeOfBaseClass, out propertyInfos))\n            {\n                var properties = _typeOfBaseClass.GetProperties();\n                propertyInfos = properties;\n                _typePropertyInfoMappings.Add(_typeOfBaseClass, properties);\n            }\n\n            var propertyType = propertyInfos\n                .FirstOrDefault(p =&gt; p.Name.ToLowerInvariant().Equals(keyValuePair.Key.ToLowerInvariant()))\n                .PropertyType;\n\n            if (propertyType.IsClass)\n            {\n                PropertyInfo objClassPropInfo = _typeOfBaseClass.GetProperty(keyValuePair.Key);\n                MemberExpression objNestedMemberExpression = Expression.Property(xParameter, objClassPropInfo);\n\n                NewExpression innerObjNew = Expression.New(propertyType);\n\n                var nestedBindings = keyValuePair.Value.Select(v =&gt;\n                {\n                    PropertyInfo nestedObjPropInfo = propertyType.GetProperty(v);\n\n                    MemberExpression nestedOrigin2 = Expression.Property(objNestedMemberExpression, nestedObjPropInfo);\n                    var binding2 = Expression.Bind(nestedObjPropInfo, nestedOrigin2);\n\n                    return binding2;\n                });\n\n                MemberInitExpression nestedInit = Expression.MemberInit(innerObjNew, nestedBindings);\n                shpNestedPropertyBindings.Add(Expression.Bind(objClassPropInfo, nestedInit));\n            }\n            else\n            {\n                Expression mbr = xParameter;\n                mbr = Expression.PropertyOrField(mbr, keyValuePair.Key);\n\n                PropertyInfo mi = _typeOfBaseClass.GetProperty( ((MemberExpression)mbr).Member.Name );\n\n                var xOriginal = Expression.Property(xParameter, mi);\n\n                shpNestedPropertyBindings.Add(Expression.Bind(mi, xOriginal));\n            }\n        }\n\n        var xInit = Expression.MemberInit(xNew, shpNestedPropertyBindings);\n        var lambda = Expression.Lambda&lt;Func&lt;T,T&gt;&gt;( xInit, xParameter );\n\n        return lambda.Compile();\n    }\n</code></pre>\n\n<p>It compiles the lambda as below:</p>\n\n<pre><code>s =&gt; new Shipment {\n    Recipient = new Address {\n        CityName = s.Recipient.CityName\n    },\n    Sender = new Address {\n        CityId = s.Sender.CityId,\n        CityName = s.Sender.CityName\n    },\n    ParcelUniqueId = s.ParcelUniqueId\n}\n</code></pre>\n\n<p>I share the some screenshots from debug :</p>\n\n<p><a href=\"https://i.stack.imgur.com/pnukJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pnukJ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bW4Su.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bW4Su.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 2608, "user_id": 4430183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHS4j.jpg?s=128&g=1", "display_name": "Emre Savc\u0131", "link": "https://stackoverflow.com/users/4430183/emre-savc%c4%b1"}, "edited": false, "score": 0, "creation_date": 1533848986, "post_id": 51772067, "comment_id": 90510067, "body": "I&#39;am glad to see another solution, I was thinking to make my one more generic like yours with helping from recursive calls. Now I made just some modification with mine and yours and merge them. Thank you a lot."}], "tags": [], "owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "is_accepted": true, "score": 5, "last_activity_date": 1533832559, "creation_date": 1533832559, "answer_id": 51772067, "question_id": 51753165, "link": "https://stackoverflow.com/questions/51753165/dynamically-generate-linq-select-with-nested-properties/51772067#51772067", "title": "Dynamically generate LINQ select with nested properties", "body": "<p>It's good that you've found a solution of your specific problem.</p>\n\n<p>Here is a more general solution which handles different source and target types as soon as the primitive property names and types match (e.g. <code>Entity</code> -> <code>Dto</code> etc.), as well as multiple levels of nesting:</p>\n\n<pre><code>public static Expression&lt;Func&lt;TSource, TTarget&gt;&gt; BuildSelector&lt;TSource, TTarget&gt;(string members) =&gt;\n    BuildSelector&lt;TSource, TTarget&gt;(members.Split(',').Select(m =&gt; m.Trim()));\n\npublic static Expression&lt;Func&lt;TSource, TTarget&gt;&gt; BuildSelector&lt;TSource, TTarget&gt;(IEnumerable&lt;string&gt; members)\n{\n    var parameter = Expression.Parameter(typeof(TSource), \"e\");\n    var body = NewObject(typeof(TTarget), parameter, members.Select(m =&gt; m.Split('.')));\n    return Expression.Lambda&lt;Func&lt;TSource, TTarget&gt;&gt;(body, parameter);\n}\n\nstatic Expression NewObject(Type targetType, Expression source, IEnumerable&lt;string[]&gt; memberPaths, int depth = 0)\n{\n    var bindings = new List&lt;MemberBinding&gt;();\n    var target = Expression.Constant(null, targetType);\n    foreach (var memberGroup in memberPaths.GroupBy(path =&gt; path[depth]))\n    {\n        var memberName = memberGroup.Key;\n        var targetMember = Expression.PropertyOrField(target, memberName);\n        var sourceMember = Expression.PropertyOrField(source, memberName);\n        var childMembers = memberGroup.Where(path =&gt; depth + 1 &lt; path.Length);\n        var targetValue = !childMembers.Any() ? sourceMember :\n            NewObject(targetMember.Type, sourceMember, childMembers, depth + 1);\n        bindings.Add(Expression.Bind(targetMember.Member, targetValue));\n    }\n    return Expression.MemberInit(Expression.New(targetType), bindings);\n}\n</code></pre>\n\n<p>The first two methods are just the publicly exposed high level helpers. The actual work is done by the private recursive <code>NewObject</code> method. It groups the current level properties and for each grouping, either creates simple assignment like <code>PropertyN = source.Property1.Property2...PropertyN</code> if it is the last level, or recursively <code>PropertyN = new TypeN { \u2026 }</code> otherwise.</p>\n\n<p>Sample usage which matches the expression from your example:</p>\n\n<pre><code>var test = BuildSelector&lt;Shipment, Shipment&gt;(\n    \"Recipient.CityName, Sender.CityId, Sender.CityName, ParcelUniqueId\");\n</code></pre>\n\n<p>Simply call <code>Compile</code> when you need <code>Func</code>.</p>\n"}], "owner": {"reputation": 2608, "user_id": 4430183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHS4j.jpg?s=128&g=1", "display_name": "Emre Savc\u0131", "link": "https://stackoverflow.com/users/4430183/emre-savc%c4%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2947, "favorite_count": 3, "accepted_answer_id": 51772067, "answer_count": 3, "score": 6, "last_activity_date": 1614072838, "creation_date": 1533752008, "last_edit_date": 1614072838, "question_id": 51753165, "link": "https://stackoverflow.com/questions/51753165/dynamically-generate-linq-select-with-nested-properties", "title": "Dynamically generate LINQ select with nested properties", "body": "<p>Currently we have a package that generates linq select dynamically from fields from string. It works well with flat properties but it is not designed to work with nested fields like someObj.NestedObj.SomeField.</p>\n<p>Our current code works as below in the service method:</p>\n<pre><code>_context.Shipments\n    .Where(s =&gt; s.Id == request.Id) // it does not matter just an example\n    .Select(request.Fields)\n    .ToPage(request); // ToPage extension comes from a nuget package\n</code></pre>\n<p>The parameter &quot;fields&quot; of request object is just a string which seperated with commas including Shipment object's properties.</p>\n<p>I made some refactoring to Shipment, I grouped some fields into a new class named as Address and add it to Shipment as below:</p>\n<pre><code>// before refactoring\nclass Shipment {\n    // other fields...\n    public string SenderAddress;\n    public string SenderCityName;\n    public string SenderCityId;\n\n    public string RecipientAddress;\n    public string CityName;\n    public string CityId;\n}\n\n// after refactoring\nclass Shipment {\n   // other fields...\n   public Address Sender;\n   public Address Recipient;\n}\n\nclass Address {\n    public string AddressText;\n    public string CityName;\n    public string CityId;\n}\n</code></pre>\n<p>For the sake of current database mapping I added the corresponding mappings as :</p>\n<pre><code>public class ShipmentMap : DataEntityTypeConfiguration&lt;Shipment&gt;\n    {\n        public ShipmentMap()\n        {\n            ToTable(&quot;Shipments&quot;);\n            // other property mappings\n            Property(s =&gt; s.Recipient.AddressText).HasMaxLength(1100).HasColumnName(&quot;RecipientAddress&quot;);\n            Property(s =&gt; s.Recipient.CityName).HasMaxLength(100).HasColumnName(&quot;CityName&quot;);\n            Property(s =&gt; s.Recipient.CityId).IsOptional().HasColumnName(&quot;CityId&quot;);\n\n            Property(s =&gt; s.Sender.AddressText).HasMaxLength(1100).HasColumnName(&quot;SenderAddress&quot;);\n            Property(s =&gt; s.Sender.CityName).HasMaxLength(100).HasColumnName(&quot;SenderCityName&quot;);\n            Property(s =&gt; s.Sender.CityId).IsOptional().HasColumnName(&quot;SenderCityId&quot;);\n        }\n    }\n</code></pre>\n<p>DataEntityTypeConfiguration comes from nuget packages as :</p>\n<pre><code>  public abstract class DataEntityTypeConfiguration&lt;T&gt; : EntityTypeConfiguration&lt;T&gt; where T : class\n  {\n    protected virtual void PostInitialize();\n  }\n</code></pre>\n<p>So, my problem is with the select(fields) not works for when fields = &quot;Recipient.CityId&quot;.</p>\n<p>How can I dynamically generate linq for selecting with nested fields?</p>\n<p>I tried below using <a href=\"https://stackoverflow.com/questions/16516971/linq-dynamic-select\">LINQ : Dynamic select</a> but it does not work.</p>\n<pre><code>// assume that request.Fields= &quot;Recipient.CityId&quot;\n\n// in the service method\nList&lt;Shipment&gt; x = _context.Shipments\n    .Where(s =&gt; s.Id == request.Id)\n    .Select(CreateNewStatement(request.Fields))\n    .ToList();\n\n\n // I tried to generate select for linq here    \n Func&lt;Shipment, Shipment&gt; CreateNewStatement(string fields)\n        {\n            // input parameter &quot;o&quot;\n            var xParameter = Expression.Parameter( typeof( Shipment ), &quot;o&quot; );\n\n            // new statement &quot;new Data()&quot;\n            var xNew = Expression.New( typeof( Shipment ) );\n\n            // create initializers\n            var bindings = fields.Split( ',' ).Select( o =&gt; o.Trim() )\n                .Select(o =&gt;\n                {\n                    string[] nestedProps = o.Split('.');\n                    Expression mbr = xParameter;\n\n                    foreach (var prop in nestedProps)\n                        mbr = Expression.PropertyOrField(mbr, prop);\n\n                    // property &quot;Field1&quot;\n                    PropertyInfo mi = typeof( Shipment ).GetProperty( ((MemberExpression)mbr).Member.Name );\n                    //\n                    // original value &quot;o.Field1&quot;\n                    var xOriginal = Expression.Property( xParameter, mi );\n\n                    MemberBinding bnd = Expression.Bind( mi, xOriginal );\n                    return bnd;\n                });\n\n            // initialization &quot;new Data { Field1 = o.Field1, Field2 = o.Field2 }&quot;\n            var xInit = Expression.MemberInit( xNew, bindings );\n\n            // expression &quot;o =&gt; new Data { Field1 = o.Field1, Field2 = o.Field2 }&quot;\n            var lambda = Expression.Lambda&lt;Func&lt;Shipment,Shipment&gt;&gt;( xInit, xParameter );\n\n            // compile to Func&lt;Data, Data&gt;\n            return lambda.Compile();\n        }\n</code></pre>\n<p>It throws exception because mbr becomes CityId after the loop and &quot;mi&quot; is null because there is no field CityId on shipment. What am I missing here? How can I create dynamic select for given string with nested properties?</p>\n<p>UPDATE:</p>\n<p>I found the solution and added it as answer, also I created a github gist for solution:</p>\n<p><a href=\"https://gist.github.com/mstrYoda/663789375b0df23e2662a53bebaf2c7c\" rel=\"nofollow noreferrer\">https://gist.github.com/mstrYoda/663789375b0df23e2662a53bebaf2c7c</a></p>\n"}, {"tags": ["c#", ".net", "refit"], "answers": [{"comments": [{"owner": {"reputation": 469, "user_id": 1351913, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/b1aac68475fa428ef4b081d5c6c63682?s=128&d=identicon&r=PG", "display_name": "albilaga", "link": "https://stackoverflow.com/users/1351913/albilaga"}, "edited": false, "score": 0, "creation_date": 1534853359, "post_id": 51941273, "comment_id": 90846250, "body": "I don&#39;t need upload many files. I just want to upload a file. Using <code>StreamPart</code> is causing the error"}, {"owner": {"reputation": 469, "user_id": 1351913, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/b1aac68475fa428ef4b081d5c6c63682?s=128&d=identicon&r=PG", "display_name": "albilaga", "link": "https://stackoverflow.com/users/1351913/albilaga"}, "edited": false, "score": 0, "creation_date": 1534916174, "post_id": 51941273, "comment_id": 90870982, "body": "yes. already read it @hossein. Still got the exception like I described above"}], "tags": [], "owner": {"reputation": 2650, "user_id": 4588756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fl8RE.png?s=128&g=1", "display_name": "Hossein", "link": "https://stackoverflow.com/users/4588756/hossein"}, "is_accepted": false, "score": 8, "last_activity_date": 1537243805, "last_edit_date": 1537243805, "creation_date": 1534823198, "answer_id": 51941273, "question_id": 51753141, "link": "https://stackoverflow.com/questions/51753141/multipart-content-with-refit/51941273#51941273", "title": "Multipart Content with refit", "body": "<p>You can use <code>IEnumerable&lt;StreamPart&gt;</code> to upload a files:</p>\n\n<pre><code>  [Multipart]\n  [Post(\"/users/{id}\")]\n  Task UpdateProfilePicture(int id, [AliasAs(\"profile_picture\")] IEnumerable&lt;StreamPart&gt; streams);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1496, "user_id": 5960632, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/gIuBD.jpg?s=128&g=1", "display_name": "Maxime G&#233;linas", "link": "https://stackoverflow.com/users/5960632/maxime-g%c3%a9linas"}, "is_accepted": false, "score": 4, "last_activity_date": 1570024190, "last_edit_date": 1570024190, "creation_date": 1569005227, "answer_id": 58033755, "question_id": 51753141, "link": "https://stackoverflow.com/questions/51753141/multipart-content-with-refit/58033755#58033755", "title": "Multipart Content with refit", "body": "<p>It's an old question, but maybe it could help others.</p>\n\n<p>I wasn't able to use <code>StreamPart</code> either since the file size received on the server side was always 0 so I used <code>ByteArrayPart</code> instead like specified here <a href=\"http://github.com/reactiveui/refit#multipart-uploads\" rel=\"nofollow noreferrer\">github.com/reactiveui/refit#multipart-uploads</a>.</p>\n\n<p><strong>Interface:</strong></p>\n\n<pre><code>[Multipart]\n[Post(\"/api/&lt;some-path&gt;\")]\nTask&lt;HttpResponseMessage&gt; Upload([AliasAs(\"file\")] ByteArrayPart bytes);\n</code></pre>\n\n<p><strong>Usage:</strong></p>\n\n<pre><code>var stream;\nusing (MemoryStream ms = new MemoryStream())\n{\n    stream.CopyTo(ms);\n    client.Upload(new ByteArrayPart(ms.ToArray(), fileName));\n}\n</code></pre>\n\n<blockquote>\n  <p>Note that this technique <strong>will load the entire stream in memory!</strong>\n    It worked for me, because I had small files, but you should find a better way if you are dealing with large files or memory usage is an issue. </p>\n</blockquote>\n"}], "owner": {"reputation": 469, "user_id": 1351913, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/b1aac68475fa428ef4b081d5c6c63682?s=128&d=identicon&r=PG", "display_name": "albilaga", "link": "https://stackoverflow.com/users/1351913/albilaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4835, "favorite_count": 2, "answer_count": 2, "score": 12, "last_activity_date": 1570024190, "creation_date": 1533751900, "last_edit_date": 1533913793, "question_id": 51753141, "link": "https://stackoverflow.com/questions/51753141/multipart-content-with-refit", "title": "Multipart Content with refit", "body": "<p>I am using multipart with Refit. I try to upload profile picture for my service\nthe code generated from postman is looking like this</p>\n\n<pre><code>var client = new RestClient(\"http://api.example.com/api/users/1\");\nvar request = new RestRequest(Method.POST);\nrequest.AddHeader(\"Postman-Token\", \"xxx\");\nrequest.AddHeader(\"Cache-Control\", \"no-cache\");\nrequest.AddHeader(\"content-type\", \"multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW\");\nrequest.AddParameter(\"multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW\", \"------WebKitFormBoundary7MA4YWxkTrZu0gW\\r\\nContent-Disposition: form-data; name=\\\"_method\\\"\\r\\n\\r\\nput\\r\\n------WebKitFormBoundary7MA4YWxkTrZu0gW\\r\\nContent-Disposition: form-data; name=\\\"profile_picture\\\"; filename=\\\"ic_default_avatar.png\\\"\\r\\nContent-Type: image/png\\r\\n\\r\\n\\r\\n------WebKitFormBoundary7MA4YWxkTrZu0gW--\", ParameterType.RequestBody);\nIRestResponse response = client.Execute(request);\n</code></pre>\n\n<p>and then I construct Refit method like this</p>\n\n<pre><code>[Multipart]\n[Post(\"/users/{id}\")]\nIObservable&lt;BaseResponse&lt;User&gt;&gt; UpdateProfilePicture(int id,[AliasAs(\"profile_picture\")] byte[] profilePicture,[AliasAs(\"_method\")]string method=\"put\");\n</code></pre>\n\n<p>if I use <code>byte[]</code> or <code>ByteArrayPart</code> it will throw exception </p>\n\n<blockquote>\n  <p>{System.Net.Http.HttpRequestException: An error occurred while sending\n  the request ---> System.Net.WebException: Error getting response\n  stream (chunked Read2): ReceiveFailure ---> System.Exception:   at\n  System.Net.WebConnection.HandleError (System.Net.WebExceptionStatus\n  st, System.Exception e, System.String where) [0x00031] in\n  :0    at\n  System.Net.WebConnection.Read (System.Net.HttpWebRequest request,\n  System.Byte[] buffer, System.Int32 offset, System.Int32 size)\n  [0x000d2] in :0    at\n  System.Net.WebConnectionStream.ReadAll () [0x0010e] in\n  :0    at\n  System.Net.HttpWebResponse.ReadAll () [0x00011] in\n  :0    at\n  System.Net.HttpWebRequest.CheckFinalStatus (System.Net.WebAsyncResult\n  result) [0x001d6] in :0    at\n  System.Net.HttpWebRequest.SetResponseData\n  (System.Net.WebConnectionData data) [0x0013e] in\n  :0    at\n  System.Net.WebConnection.ReadDone (System.IAsyncResult result)\n  [0x0024d] in :0    at\n  System.Net.Sockets.SocketAsyncResult+&lt;>c.b__27_0\n  (System.Object state) [0x00000] in\n  :0    at\n  System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem\n  () [0x00015] in :0    at\n  System.Threading.ThreadPoolWorkQueue.Dispatch () [0x00074] in\n  :0    at\n  ObjCRuntime.Runtime.ThreadPoolDispatcher (System.Func`1[TResult]\n  callback) [0x00006] in &lt;0b60c1467e7449608ac42f9c7bbfdd05>:0    at\n  System.Threading._ThreadPoolWaitCallback.PerformWaitCallback ()\n  [0x00009] in :0    at\n  System.Net.WebConnection.HandleError (System.Net.WebExceptionStatus\n  st, System.Exception e, System.String where) [0x00031] in\n  /Library/Frameworks/Xamarin.iOS.framework/Versions/11.12.0.4/src/Xamarin.iOS/mcs/class/System/System.Net/WebConnection.cs:439</p>\n</blockquote>\n\n<p>. and if I use <code>Stream</code> or <code>StreamPart</code> it will also throw exception said stream is closed.</p>\n"}, {"tags": ["c#", "winforms", "vsto", "excel-addins"], "comments": [{"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 1, "creation_date": 1533752161, "post_id": 51753114, "comment_id": 90466207, "body": "You should create a property <code>ListBoxData</code> in Form1 with type object[] and setter of the property should add values to the list. And you assign the values to that property by doing <code>fm.ListBoxData = new object[] { 1, 2, 3, 4, 5 };</code>"}, {"owner": {"reputation": 1768, "user_id": 7369926, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/127985c6b4901ccbaeb6b9d47b465dc9?s=128&d=identicon&r=PG&f=1", "display_name": "ProgSky", "link": "https://stackoverflow.com/users/7369926/progsky"}, "reply_to_user": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1533753027, "post_id": 51753114, "comment_id": 90466675, "body": "Great. thanks for the hint. Could you check if my implementation looks good. I have posted as the answer ?"}], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 8520655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YmYGf.jpg?s=128&g=1", "display_name": "Mark Diedericks", "link": "https://stackoverflow.com/users/8520655/mark-diedericks"}, "edited": false, "score": 1, "creation_date": 1533770848, "post_id": 51753494, "comment_id": 90473340, "body": "In this implementation, you&#39;ll never be setting the objects in the list but rather adding them. Instead, you must use <code>listBox1.Items.Clear()</code> to empty the list and then add the new items."}], "tags": [], "owner": {"reputation": 1768, "user_id": 7369926, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/127985c6b4901ccbaeb6b9d47b465dc9?s=128&d=identicon&r=PG&f=1", "display_name": "ProgSky", "link": "https://stackoverflow.com/users/7369926/progsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1533753229, "creation_date": 1533753229, "answer_id": 51753494, "question_id": 51753114, "link": "https://stackoverflow.com/questions/51753114/c-vsto-winform-control-access-controls-from-dynamically-created-form/51753494#51753494", "title": "C# VSTO Winform Control Access controls from dynamically created Form", "body": "<p>Per Chetan's suggestion:\nProperty : </p>\n\n<pre><code> public object[] ListBoxData\n        {\n            set\n            {\n                listBox1.Items.AddRange(value);\n            }\n        }\n</code></pre>\n\n<p>Change in Button Click: </p>\n\n<pre><code> Form1 fm = new Form1();\n            fm.ListBoxData = new object[] { 1, 2, 3, 4, 5 };\n            fm.Show();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 306, "user_id": 8520655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YmYGf.jpg?s=128&g=1", "display_name": "Mark Diedericks", "link": "https://stackoverflow.com/users/8520655/mark-diedericks"}, "is_accepted": true, "score": 1, "last_activity_date": 1533771069, "creation_date": 1533771069, "answer_id": 51756999, "question_id": 51753114, "link": "https://stackoverflow.com/questions/51753114/c-vsto-winform-control-access-controls-from-dynamically-created-form/51756999#51756999", "title": "C# VSTO Winform Control Access controls from dynamically created Form", "body": "<p>In your scenario, since you create a new Form1 instance each time you wish to show it, and since it is a custom form, I would simply modify the form's constructor to accept the input data.</p>\n\n<pre><code>public Form1(object[] ListBoxData)\n{\n   ...\n   listBox1.Items.AddRange(ListBoxData);\n}\n</code></pre>\n\n<p>You can then simply just pass in the values when you click the button;</p>\n\n<pre><code>Form1 fm = new Form1(new object[] { 1, 2, 3, 4, 5 });\nfm.Show();\n</code></pre>\n"}], "owner": {"reputation": 1768, "user_id": 7369926, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/127985c6b4901ccbaeb6b9d47b465dc9?s=128&d=identicon&r=PG&f=1", "display_name": "ProgSky", "link": "https://stackoverflow.com/users/7369926/progsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 51756999, "answer_count": 2, "score": 1, "last_activity_date": 1533771069, "creation_date": 1533751780, "last_edit_date": 1533751968, "question_id": 51753114, "link": "https://stackoverflow.com/questions/51753114/c-vsto-winform-control-access-controls-from-dynamically-created-form", "title": "C# VSTO Winform Control Access controls from dynamically created Form", "body": "<p>I have an <em>Excel</em> Addin that call a Windows Form that has a List Box. Before I show the form, I want to populate the <code>ListBox</code> dynamically based on values from <em>Excel</em>. </p>\n\n<p>Winform Looks like below: </p>\n\n<p><a href=\"https://i.stack.imgur.com/NEtfk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NEtfk.png\" alt=\"enter image description here\"></a></p>\n\n<p>Button click within Ribbon looks like below: </p>\n\n<pre><code>private void button1_Click(object sender, RibbonControlEventArgs e)\n{\n    Form1 fm = new Form1();\n    System.Windows.Forms.ListBox lbx = fm.Controls.Find(\"listBox1\", true).FirstOrDefault() as System.Windows.Forms.ListBox;\n    lbx.Items.AddRange(new object[] { 1, 2, 3, 4, 5 });\n    fm.Show();\n}\n</code></pre>\n\n<p>Is </p>\n\n<pre><code>System.Windows.Forms.ListBox lbx = fm.Controls.Find(\"listBox1\", true).FirstOrDefault() as System.Windows.Forms.ListBox;\n</code></pre>\n\n<p>the best way of accessing the <code>ListBox</code> and adding <code>Item</code>s to it?<br>\nOr is there any other way?</p>\n"}, {"tags": ["c#", "linq", "casting"], "comments": [{"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 0, "creation_date": 1533752089, "post_id": 51753106, "comment_id": 90466170, "body": "What is <code>result</code>? Is that a typo and should be <code>results</code>? But in that case, <code>results</code> can&#39;t contain a definition for <code>myDouble</code>."}, {"owner": {"reputation": 1411, "user_id": 723948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f2dff1f175c1e943707c9a65d109c37?s=128&d=identicon&r=PG", "display_name": "chadiusvt", "link": "https://stackoverflow.com/users/723948/chadiusvt"}, "reply_to_user": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 0, "creation_date": 1533752365, "post_id": 51753106, "comment_id": 90466321, "body": "Yes typo, now fixed. <code>result</code> is the dynamic result of a DB query, which contains several values, one of which is a double. I have updated with a sample value for clarification."}], "answers": [{"comments": [{"owner": {"reputation": 1411, "user_id": 723948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f2dff1f175c1e943707c9a65d109c37?s=128&d=identicon&r=PG", "display_name": "chadiusvt", "link": "https://stackoverflow.com/users/723948/chadiusvt"}, "edited": false, "score": 1, "creation_date": 1533753318, "post_id": 51753473, "comment_id": 90466837, "body": "I actually just tried this, and found the issue. In my specific case, one of the entries has hiding a <code>null</code> value, which is why the previous <code>Cast()</code> did not work. Using this explicit cast finally brought the issue to light."}], "tags": [], "owner": {"reputation": 5331, "user_id": 4256749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2lpRO.png?s=128&g=1", "display_name": "Kzrystof", "link": "https://stackoverflow.com/users/4256749/kzrystof"}, "is_accepted": true, "score": 2, "last_activity_date": 1533753140, "creation_date": 1533753140, "answer_id": 51753473, "question_id": 51753106, "link": "https://stackoverflow.com/questions/51753106/linq-average-of-dynamic-double/51753473#51753473", "title": "Linq average of dynamic double", "body": "<p>It is working if you force the cast of the dynamic to double instead of letting the <code>.ToDouble</code> method find the appropriate type itself. Instead, do an explicit cast:</p>\n\n<pre><code>for(var i = 0; i &lt; result.Count; i++)\n    cumulativeAvg.Add(result.Take(i + 1).Average(r =&gt; (double)r.myDouble));\n</code></pre>\n"}], "owner": {"reputation": 1411, "user_id": 723948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f2dff1f175c1e943707c9a65d109c37?s=128&d=identicon&r=PG", "display_name": "chadiusvt", "link": "https://stackoverflow.com/users/723948/chadiusvt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 51753473, "answer_count": 1, "score": 2, "last_activity_date": 1533753483, "creation_date": 1533751749, "last_edit_date": 1533753483, "question_id": 51753106, "link": "https://stackoverflow.com/questions/51753106/linq-average-of-dynamic-double", "title": "Linq average of dynamic double", "body": "<p>I have a dynamic result set, which contains a key value double (but the compiler still sees it as a dynamic).  I am trying to take a cumulative average of this, but cannot figure out the correct cast or how to call the specific overload of the Linq <code>Average()</code> method.  It consistently tries to call the <code>Average&lt;dynamic&gt;(Func&lt;dynamic, int&gt; selector)</code> version, when I am pretty sure I need the <code>Average&lt;dynamic&gt;(Func&lt;dynamic, double&gt; selector)</code> version.</p>\n\n<p>Intellisense on the <code>Average()</code> and <code>Sum()</code> methods is what is showing me that the compiler is choosing the <code>&lt;dynamic, int&gt;</code> version.  How can I specify to use the <code>double</code> version?</p>\n\n<p>Here is a good sample of the iterations of things I have tried and their corresponding error. At this point, I feel I have tried every combination, and with or without <code>Cast&lt;double&gt;()</code> and <code>Convert.ToDouble()</code> that I can think of.</p>\n\n<pre><code>// ## filled with values from DB query, but here with examples ##\nvar result = new List&lt;dynamic&gt;() { new { myDouble = 0.123 }, new { myDouble = 0.456 } }; \nvar cumulativeAvg = new List&lt;double&gt;();\n</code></pre>\n\n<p><strong>UPDATE</strong> My result set turned out to have a hidden <code>null</code> value, which caused the errors:</p>\n\n<pre><code>var result = new List&lt;dynamic&gt;() {\n    new { myDouble = 0.123 }\n    , new { myDouble = 0.456 }\n    , new { myDouble = null }\n}; \n</code></pre>\n\n<p>For all of the following loops, the ERROR is:\n<strong>Cannot implicitly convert type 'double' to 'int'</strong></p>\n\n<pre><code>for(var i = 0; i &lt; result.Count; i++)\n    cumulativeAvg.Add(result.Take(i + 1).Average(r =&gt; Convert.ToDouble(r.myDouble)));\n\nfor(var i = 0; i &lt; result.Count; i++)\n    cumulativeAvg.Add(result.Take(i + 1).Select(r =&gt; Convert.ToDouble(r.myDouble)).Average());\n\nfor(var i = 0; i &lt; result.Count; i++)\n    cumulativeAvg.Add(result.Take(i + 1).Select(r =&gt; Convert.ToDouble(r.myDouble)).ToList().Average());\n\nfor(var i = 0; i &lt; result.Count; i++)\n    cumulativeAvg.Add(result.Take(i + 1).Sum(r =&gt; Convert.ToDouble(r.myDouble)) / (i + 1));\n</code></pre>\n\n<p>For all of the following loops, the ERROR is:\n<strong>Specified cast is not valid.</strong></p>\n\n<pre><code>for(var i = 0; i &lt; result.Count; i++)\n    cumulativeAvg.Add(result.Take(i + 1).Select(r =&gt; Convert.ToDouble(r.myDouble)).Cast&lt;double&gt;().Average());\n\nfor(var i = 0; i &lt; result.Count; i++)\n    cumulativeAvg.Add(result.Take(i + 1).Cast&lt;double&gt;().Select(r =&gt; Convert.ToDouble(r.myDouble)).Average());\n\nfor(var i = 0; i &lt; result.Count; i++)\n    cumulativeAvg.Add(result.Select(r =&gt; Convert.ToDouble(r.myDouble)).Cast&lt;double&gt;().Take(i + 1).Average());\n</code></pre>\n"}, {"tags": ["c#", "ado.net", "connection-string", "ibm-midrange", "binary-data"], "answers": [{"comments": [{"owner": {"reputation": 16176, "user_id": 2933177, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LRuRW.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/2933177/charles"}, "edited": false, "score": 1, "creation_date": 1533759216, "post_id": 51754797, "comment_id": 90469439, "body": "Good info...but the best fix is to tag your data with the right CCSID in the first place."}, {"owner": {"reputation": 16176, "user_id": 2933177, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LRuRW.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/2933177/charles"}, "edited": false, "score": 0, "creation_date": 1533764877, "post_id": 51754797, "comment_id": 90471771, "body": "Looks like they may have added some functionality...the 7.1 Tech Ref has  iDB2ProviderSettings.CharBitDataCcsid property   Specifies the CCSID used to translate iDB2CharBitData and iDB2VarCharBitData types when the CharBitDataAsString property is set to True. This property is ignored when CharBitDataAsString is set to False."}], "tags": [], "owner": {"reputation": 1032, "user_id": 3175562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/866fd7f2263cbabce6395353970679ae?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3175562/mike"}, "is_accepted": false, "score": 2, "last_activity_date": 1533759370, "last_edit_date": 1533759370, "creation_date": 1533758747, "answer_id": 51754797, "question_id": 51753095, "link": "https://stackoverflow.com/questions/51753095/how-to-convert-ccsid-65535-characters-in-as400-ado-net-connection-string/51754797#51754797", "title": "How to convert CCSID 65535 characters in AS400 ADO.Net connection string", "body": "<p>The best resource for this kind of question is the IBM Redbook <a href=\"https://www.redbooks.ibm.com/redbooks/pdfs/sg246440.pdf\" rel=\"nofollow noreferrer\">Integrating DB2 Universal Database for iSeries with \nMicrosoft ADO.NET</a>.</p>\n\n<p>On page 151, there is a chart that compares the features of the <code>IBMDA400</code> or <code>IBMDASQL</code> OLE DB providers to the <code>IBM.Data.DB2.iSeries</code> .NET provider.  It says:</p>\n\n<blockquote>\n  <p><strong>Force Translate</strong> Not implemented by the IBM.Data.DB2.iSeries provider.\n  Read  about handling character data tagged with CCSID 65535 in \n  \u201ciDB2CharBitData and iDB2VarCharBitData\u201d on page 90.</p>\n</blockquote>\n\n<p>It is also noteworthy that in section 4.5.2 where it lists attributes that you can put on a connection string, there is nothing similar to what you are trying to specify.  This implies that you may be able to do this transformation on the connection string if you use an OLE DB provider, but not the .NET provider.</p>\n\n<p>It does give some techniques that you should be able to use to clean up your query and allow you to stay with the <code>IBM.Data.DB2.iSeries</code> provider (which I would usually prefer). They show the <code>CAST</code> technique you are currently using on page 91 and then on page 93 they show an alternative technique that can be used on an <code>iDB2DataReader</code>, calling method <code>GetiDB2CharBitData</code> or <code>GetiDB2VarCharBitData</code>. There is also a <code>.ToString</code> overload that you might prefer:  <code>.ToString(CCSID)</code>. I think this second technique performs the translation on the client side (in the .NET provider) whereas your current technique performs the translation on the server side (in the iSeries SQL code).</p>\n"}, {"comments": [{"owner": {"reputation": 407, "user_id": 8478506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13ff4c0dfb9f219e9098c64de0678af?s=128&d=identicon&r=PG&f=1", "display_name": "Sarov", "link": "https://stackoverflow.com/users/8478506/sarov"}, "edited": false, "score": 0, "creation_date": 1533820281, "post_id": 51756239, "comment_id": 90494550, "body": "It works! Interestingly, if I only add &quot;; CharBitDataAsString=True&quot;, then the value of _connection.CharBitDataCcsid is -1. But it still seems to work."}, {"owner": {"reputation": 16176, "user_id": 2933177, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LRuRW.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/2933177/charles"}, "reply_to_user": {"reputation": 407, "user_id": 8478506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13ff4c0dfb9f219e9098c64de0678af?s=128&d=identicon&r=PG&f=1", "display_name": "Sarov", "link": "https://stackoverflow.com/users/8478506/sarov"}, "edited": false, "score": 0, "creation_date": 1533821449, "post_id": 51756239, "comment_id": 90495425, "body": "@Sarov Probably using the &quot;default CCSID&quot; for the job"}], "tags": [], "owner": {"reputation": 16176, "user_id": 2933177, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LRuRW.jpg?s=128&g=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/2933177/charles"}, "is_accepted": true, "score": 4, "last_activity_date": 1533765598, "creation_date": 1533765598, "answer_id": 51756239, "question_id": 51753095, "link": "https://stackoverflow.com/questions/51753095/how-to-convert-ccsid-65535-characters-in-as400-ado-net-connection-string/51756239#51756239", "title": "How to convert CCSID 65535 characters in AS400 ADO.Net connection string", "body": "<p>Looks like there's been enhancements since the Redbook Mike references was published.</p>\n\n<p>In the 7.1 DB2 for i .NET Provider Technical Reference (installed as part of the programmer's toolkit component of iAccess for Windows or the newer ACS Windows Application Package)  there's a couple of properties of interest...</p>\n\n<p><strong>iDB2Connection.CharBitDataAsString Property</strong><br>\nGets a boolean value which indicates whether character bit data tagged with CCSID 65535 should be translated as string data. </p>\n\n<p><strong>iDB2ProviderSettings.CharBitDataCcsid Property</strong><br>\nSpecifies the CCSID used to translate iDB2CharBitData and iDB2VarCharBitData types when the CharBitDataAsString property is set to True. This property is ignored when CharBitDataAsString is set to False. </p>\n"}], "owner": {"reputation": 407, "user_id": 8478506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13ff4c0dfb9f219e9098c64de0678af?s=128&d=identicon&r=PG&f=1", "display_name": "Sarov", "link": "https://stackoverflow.com/users/8478506/sarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1774, "favorite_count": 0, "accepted_answer_id": 51756239, "answer_count": 2, "score": 2, "last_activity_date": 1533765598, "creation_date": 1533751711, "question_id": 51753095, "link": "https://stackoverflow.com/questions/51753095/how-to-convert-ccsid-65535-characters-in-as400-ado-net-connection-string", "title": "How to convert CCSID 65535 characters in AS400 ADO.Net connection string", "body": "<p>I'm trying to set things up such that I can read binary data from the AS400 database without having to put \"CAST(TABLE.COL AS CHAR(29) CCSID 37) COL\" on every selected column. It's a pain to put that every time, not to mention coupling the column size to the C# code (I suppose I could just cast to VARCHAR(9999) for everything, but...).</p>\n\n<p>I assumed I could do so via the connection string for ADO.Net. However, after trying every suggested setting from various pages I've read to try to get it to work, they all give a \"The ConnectionString property is invalid.\" error.</p>\n\n<p>I've tried each of the following, and they all give the same error:</p>\n\n<pre><code>var connectionString = \"DataSource=\" + /*blah blah...*/ + \n//\"; CCSID=37; TRANSLATE=1\" +\n//\"; BinAsChar=true; CCSID=37;\" +\n//\"; BinAsChar=true; CCSID=37; TRANSLATE=1\" +\n//\"; BinAsChar=true; CCSID=37; Force Translate=1\" +\n//\"; BinAsChar=true; CCSID=37; ForceTranslation=1\" +\n//\"; CCSID=37; ForceTranslation=1\" +\n//\"; ForceTranslation=1\" +\n//\"; CCSID=37\" +\n//\"; Host CCSID=37\" +\n//\"; CharsetFor65535=0\" +\n//\"; CCSID=EBCDIC\" +\n\"\";\n</code></pre>\n\n<p>Is there any way to get this to work? Or do I have to just continue polluting all of my queries?</p>\n"}, {"tags": ["c#", "object-model"], "comments": [{"owner": {"reputation": 327, "user_id": 748742, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/aa0ae6a9a17fd2e7bd0638c4a80ba2ac?s=128&d=identicon&r=PG", "display_name": "uba2012", "link": "https://stackoverflow.com/users/748742/uba2012"}, "edited": false, "score": 0, "creation_date": 1533765397, "post_id": 51753089, "comment_id": 90471945, "body": "Is my question not understandable ?"}, {"owner": {"reputation": 327, "user_id": 748742, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/aa0ae6a9a17fd2e7bd0638c4a80ba2ac?s=128&d=identicon&r=PG", "display_name": "uba2012", "link": "https://stackoverflow.com/users/748742/uba2012"}, "edited": false, "score": 0, "creation_date": 1533772176, "post_id": 51753089, "comment_id": 90473611, "body": "I guess both ways are valid"}, {"owner": {"reputation": 2940, "user_id": 3800096, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dffaee3296e432469a794c508c297abc?s=128&d=identicon&r=PG&f=1", "display_name": "AustinWBryan", "link": "https://stackoverflow.com/users/3800096/austinwbryan"}, "edited": false, "score": 0, "creation_date": 1533792538, "post_id": 51753089, "comment_id": 90477972, "body": "You&#39;re couldn&#39;t would&#39;nt&#39;ve even compiled"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 748742, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/aa0ae6a9a17fd2e7bd0638c4a80ba2ac?s=128&d=identicon&r=PG", "display_name": "uba2012", "link": "https://stackoverflow.com/users/748742/uba2012"}, "edited": false, "score": 0, "creation_date": 1533800135, "post_id": 51758098, "comment_id": 90481398, "body": "Would it also be possible to show employee information (employee name and employee office) on a a screen through the UI this way (the employee object does not have any office property)?"}, {"owner": {"reputation": 4665, "user_id": 6383857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPDaW.jpg?s=128&g=1", "display_name": "StaticBeagle", "link": "https://stackoverflow.com/users/6383857/staticbeagle"}, "reply_to_user": {"reputation": 327, "user_id": 748742, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/aa0ae6a9a17fd2e7bd0638c4a80ba2ac?s=128&d=identicon&r=PG", "display_name": "uba2012", "link": "https://stackoverflow.com/users/748742/uba2012"}, "edited": false, "score": 0, "creation_date": 1533825786, "post_id": 51758098, "comment_id": 90498423, "body": "@uba2012 you can, you will have to go through the office though. To show all the employees in all offices you can use the query above (not tested =]) and once the user wants to zero in into one of the employees then you have everything you need by adding the employee id to the query above. As an alternative, you can also add the office name as a property to the employee that you populate via a trigger (if you don&#39;t care about repeated data) or populate it on the fly after you query the office."}, {"owner": {"reputation": 327, "user_id": 748742, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/aa0ae6a9a17fd2e7bd0638c4a80ba2ac?s=128&d=identicon&r=PG", "display_name": "uba2012", "link": "https://stackoverflow.com/users/748742/uba2012"}, "edited": false, "score": 0, "creation_date": 1533826018, "post_id": 51758098, "comment_id": 90498596, "body": "thanks for your reply. I think I will a office property to the employee class this way I can navigate from the employee object to office and the other way around too. The database cannot be changed I am only interested in class design so I cannot use EF to create tables."}, {"owner": {"reputation": 4665, "user_id": 6383857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPDaW.jpg?s=128&g=1", "display_name": "StaticBeagle", "link": "https://stackoverflow.com/users/6383857/staticbeagle"}, "reply_to_user": {"reputation": 327, "user_id": 748742, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/aa0ae6a9a17fd2e7bd0638c4a80ba2ac?s=128&d=identicon&r=PG", "display_name": "uba2012", "link": "https://stackoverflow.com/users/748742/uba2012"}, "edited": false, "score": 0, "creation_date": 1533826283, "post_id": 51758098, "comment_id": 90498782, "body": "@uba2012 yeah adding the property to employee will probably make things simpler. That sounds like a good plan."}], "tags": [], "owner": {"reputation": 4665, "user_id": 6383857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tPDaW.jpg?s=128&g=1", "display_name": "StaticBeagle", "link": "https://stackoverflow.com/users/6383857/staticbeagle"}, "is_accepted": true, "score": 2, "last_activity_date": 1533782709, "creation_date": 1533782709, "answer_id": 51758098, "question_id": 51753089, "link": "https://stackoverflow.com/questions/51753089/sql-table-to-classes/51758098#51758098", "title": "SQL table to classes", "body": "<p>I find the second approach to be easier to work with (more natural). Reason being, when you model your data this way:</p>\n\n<pre><code>public Class Employee\n{\n    string Name {get; set;}\n}\n\npublic Class Office\n{\n    string OfficeName {get; set}\n    List&lt;Employee&gt;Employees {get; set}\n}\n</code></pre>\n\n<p>You can create these tables (or use <a href=\"https://msdn.microsoft.com/en-us/library/aa937723(v=vs.113).aspx\" rel=\"nofollow noreferrer\">entity framework</a> to create the tables for you) in the following manner:</p>\n\n<pre><code>// Office table             // Employee table\n-----------------           ----------------------------------\n| Id(PK) | Name | --------&gt; | Id(PK) | OfficeId(FK) | Name |  \n-----------------           ----------------------------------\n\n// PK: Primary Key\n// FK: Foreign Key\n</code></pre>\n\n<p>The <code>one-to-many</code> relationship is represented via the <code>FK</code> in the <code>employee</code> table and the <code>employee</code> has a <code>FK</code> to the office where he/she belongs. Then by using simple <code>joins</code> you can get all info you need from the tables. e.g.</p>\n\n<p>Get all <code>employees</code> for an <code>office</code>  </p>\n\n<pre><code>    SQL: SELECT Offices.OfficeId, Offices.Name, Employees.Name \n         FROM Offices\n         JOIN Employees ON Offices.Id = Employees.OfficeId\n         WHERE Offices.Name = 'some_name'\n    // Or you can use LINQ had you had used Entity Framework\n</code></pre>\n\n<p>This would've been a bit more complicated if you had used your first approach.</p>\n"}], "owner": {"reputation": 327, "user_id": 748742, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/aa0ae6a9a17fd2e7bd0638c4a80ba2ac?s=128&d=identicon&r=PG", "display_name": "uba2012", "link": "https://stackoverflow.com/users/748742/uba2012"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 51758098, "answer_count": 1, "score": 0, "last_activity_date": 1533792522, "creation_date": 1533751681, "last_edit_date": 1533792522, "question_id": 51753089, "link": "https://stackoverflow.com/questions/51753089/sql-table-to-classes", "title": "SQL table to classes", "body": "<p>I have a modelling question that I need help understanding. </p>\n\n<p>I have a table called Employee and a table called Office. There is a 1 to many relationship between the classes (1 employee has one office and one office has multiple employees). </p>\n\n<p>The goal is to create classes from those tables and I have found two ways:</p>\n\n<p>1:</p>\n\n<pre><code>public class Employee\n{\n    private string Name   { get; set; }\n    private Office Office { get; set; }\n}\n\npublic class Office\n{\n    private string OfficeName { get; set; }\n}\n</code></pre>\n\n<p>2:</p>\n\n<pre><code>public class Employee\n{\n    private string Name {get; set;}\n}\n\npublic class Office\n{\n    private string OfficeName       { get; set; }\n    private List&lt;Employee&gt;Employees { get; set; }\n}\n</code></pre>\n\n<p>Which way is the correct way to model this ?</p>\n"}, {"tags": ["javascript", "c#", "webview", "uwp"], "answers": [{"tags": [], "owner": {"reputation": 7891, "user_id": 6782612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KuUfK.jpg?s=128&g=1", "display_name": "Xie Steven", "link": "https://stackoverflow.com/users/6782612/xie-steven"}, "is_accepted": true, "score": 1, "last_activity_date": 1533871638, "creation_date": 1533871638, "answer_id": 51778503, "question_id": 51753062, "link": "https://stackoverflow.com/questions/51753062/how-to-catch-javascript-errors-and-warnings-for-page-in-webview-in-uwp/51778503#51778503", "title": "How to catch JavaScript errors and warnings for page in WebView in UWP", "body": "<blockquote>\n  <p>This answer for JavaScript error handling shows how to do this in plain JavaScript, but I need to know how and when to inject code like this into a WebView, or if there is a better way to do this.</p>\n</blockquote>\n\n<p>You could try to use <a href=\"https://docs.microsoft.com/en-us/uwp/api/webview_invokescriptasync\" rel=\"nofollow noreferrer\">InvokeScriptAsync</a> with the JavaScript <code>eval</code> function to inject content into the web page when Navigation Completed.</p>\n\n<p>Then, if you want to get the error message in your app, you could use  <code>window.external.notify</code> with a string parameter to send information back to your app. To receive these messages, handle the <a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.controls.webview.scriptnotify\" rel=\"nofollow noreferrer\">ScriptNotify</a> event.</p>\n\n<p>I made a simple code sample for your reference:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;!--this is my local web page HTMLPage1.html--&gt;\n&lt;html lang=\"en\" xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n&lt;meta charset=\"utf-8\" /&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;script type=\"text/javascript\"&gt;\n    function test() {\n\n    }\n&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;input  value=\"click\" onclick=\"test1()\" type=\"button\"/&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;WebView x:Name=\"webview\" NavigationCompleted=\"webview_NavigationCompleted\" ScriptNotify=\"webview_ScriptNotify\" Source=\"ms-appx-web:///HTMLPage1.html\"&gt;&lt;/WebView&gt;\n</code></pre>\n\n<pre class=\"lang-cs prettyprint-override\"><code>private void webview_ScriptNotify(object sender, NotifyEventArgs e)\n{\n    string msg = e.Value;\n}\n\nprivate async void webview_NavigationCompleted(WebView sender, WebViewNavigationCompletedEventArgs args)\n{\n    string functionString = \"window.onerror = function(error, url, line) {window.external.notify( 'ERR:'+error+' url'+url+' Line: '+line);};\";\n    var ret = await webview.InvokeScriptAsync(\"eval\", new string[] { functionString });\n}\n</code></pre>\n"}], "owner": {"reputation": 1223, "user_id": 4496300, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7aba600fee1da1de6390088e1e5252bb?s=128&d=identicon&r=PG", "display_name": "Greg Thatcher", "link": "https://stackoverflow.com/users/4496300/greg-thatcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 0, "accepted_answer_id": 51778503, "answer_count": 1, "score": 1, "last_activity_date": 1533871638, "creation_date": 1533751588, "question_id": 51753062, "link": "https://stackoverflow.com/questions/51753062/how-to-catch-javascript-errors-and-warnings-for-page-in-webview-in-uwp", "title": "How to catch JavaScript errors and warnings for page in WebView in UWP", "body": "<p>I would like to catch and log any JavaScript errors or Warnings from pages I host in a <a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.controls.webview\" rel=\"nofollow noreferrer\">WebView</a> inside my UWP app.</p>\n\n<p>I would like to be able to catch these errors for <em>any</em> webpage I load in my app's WebView.</p>\n\n<p>I know that Visual Studio has a mechanism to attach to a UWP apps' WebView and log the JavaScript errors, but I would like to do the same without Visual Studio.</p>\n\n<p>This answer for <a href=\"https://stackoverflow.com/questions/6970475/get-all-javascript-errors-on-page-javascript-error-handling\">JavaScript error handling</a> shows how to do this in plain JavaScript, but I need to know how and when to inject code like this into a WebView, or if there is a better way to do this.</p>\n\n<p>If possible, I would like to have something similar to the JavaScript console in F12 tools, but I at least need to be able to get JavaScript errors and warnings.</p>\n"}, {"tags": ["c#", "uwp"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1533766836, "creation_date": 1533766836, "answer_id": 51756449, "question_id": 51753008, "link": "https://stackoverflow.com/questions/51753008/listview-notifycollectionchangedeventhandler-always-raises-argumentoutofrangeex/51756449#51756449", "title": "ListView: NotifyCollectionChangedEventHandler always raises ArgumentOutOfRangeException", "body": "<p>For what it is worth, the problem went away after I derived the class from <code>List&lt;T&gt;</code> rather than <code>ObservableCollection&lt;T&gt;</code>.</p>\n"}], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 51756449, "answer_count": 1, "score": 1, "last_activity_date": 1533766836, "creation_date": 1533751362, "question_id": 51753008, "link": "https://stackoverflow.com/questions/51753008/listview-notifycollectionchangedeventhandler-always-raises-argumentoutofrangeex", "title": "ListView: NotifyCollectionChangedEventHandler always raises ArgumentOutOfRangeException", "body": "<p>I have a <code>ListView</code> control which I load asynchronously (by setting <code>ListView.ItemsSource</code>) using a collection class that implements <code>ISupportIncrementalLoading</code> / <code>INotifyCollectionChanged</code>.</p>\n\n<p>When I attempt to invoke the <code>INotifyCollectionChanged</code> event subscriber, I get <code>ArgumentOutOfRangeException</code> \"<em>This collection cannot work with indices larger than Int32.MaxValue - 1 (0x7FFFFFFF - 1).\\r\\nParameter name: index\"</em> exception.</p>\n\n<p>I tried just about every overload of the NotifyCollectionChangedEventArgs constructor. No matter what I do, I always get the same exception.\nI do not see anything wrong with my NotifyCollectionChangedEventArgs object that I pass to the event handler.</p>\n\n<p>Any ideas?</p>\n\n<pre><code>public class GroupDataSource&lt;T&gt; : ObservableCollection&lt;T&gt;,\n     INotifyCollectionChanged,                  \n     ISupportIncrementalLoading  where T : SDataEntity, new()\n{\n        ...\n        async Task NotifyOfInsertedItems(int baseIndex, int count)\n        {\n                        await Windows.ApplicationModel.Core.CoreApplication.MainView.CoreWindow.Dispatcher.RunAsync(CoreDispatcherPriority.Normal,\n                            () =&gt;\n                            {\n                                foreach (NotifyCollectionChangedEventHandler handler in _eventHandlers)\n                                {\n                                    for (int i = 0; i &lt; count; i++)\n                                    {\n                                        var args = new NotifyCollectionChangedEventArgs(NotifyCollectionChangedAction.Add, _items[i + baseIndex], i + baseIndex);\n                                        try\n                                        {\n                                            handler(this, args);\n                                        }\n                                        catch(Exception e)\n                                        {\n                                            //todo: log it\n                                            //this is where I get System.ArgumentOutOfRangeException\n                                        }\n                                    }\n                                }\n                            }\n                            );\n                    }\n\n        public IAsyncOperation&lt;LoadMoreItemsResult&gt;LoadMoreItemsAsync(uint count)\n        {\n\n                        return Task.Run&lt;LoadMoreItemsResult&gt;(\n                            async () =&gt;\n                            {\n                                    //skipped - asynchronously load data\n\n                                    int baseIndex = _items.Count;\n                                    lock (_items)\n                                    {\n                                        _items.AddRange(newResults);\n                                    }\n                                    await NotifyOfInsertedItems(baseIndex, newResults.Count);\n\n                                    return new LoadMoreItemsResult() { Count = (uint)newResults.Count };\n                                }\n\n                            }).AsAsyncOperation&lt;LoadMoreItemsResult&gt;();\n                    }\n        }\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/COSeV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/COSeV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "io", "messagebox"], "comments": [{"owner": {"reputation": 2034, "user_id": 2486496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Rpd3r.jpg?s=128&g=1", "display_name": "gravity", "link": "https://stackoverflow.com/users/2486496/gravity"}, "edited": false, "score": 1, "creation_date": 1533751428, "post_id": 51752985, "comment_id": 90465821, "body": "I believe we may need to see the entirety of <code>comboBoxReprint_SelectedIndexChanged</code> and/or if you call that method anywhere else manually.  I&#39;m guessing (blindly) that the latter may be happening."}, {"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1533751597, "post_id": 51752985, "comment_id": 90465906, "body": "You need to share the complete code of <code>comboBoxReprint_SelectedIndexChanged</code>"}, {"owner": {"reputation": 1035, "user_id": 5156187, "user_type": "registered", "profile_image": "https://graph.facebook.com/881841408548334/picture?type=large", "display_name": "Yasiru Nayanajith", "link": "https://stackoverflow.com/users/5156187/yasiru-nayanajith"}, "edited": false, "score": 0, "creation_date": 1533751836, "post_id": 51752985, "comment_id": 90466034, "body": "So where&#39;s the code for the second message box"}, {"owner": {"reputation": 167, "user_id": 9824303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf39aea58ea109dd7295f632a42fee74?s=128&d=identicon&r=PG&f=1", "display_name": "SJ10", "link": "https://stackoverflow.com/users/9824303/sj10"}, "edited": false, "score": 0, "creation_date": 1533756337, "post_id": 51752985, "comment_id": 90468129, "body": "Have you tried to run this code under a button press event? I am willing to bet that your issue is that the method you are trying to do this in is called more than once every time you use the control that causes this. I have seen this problem many times before."}, {"owner": {"reputation": 1676, "user_id": 61708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8508ac9e4bd637e6c2fd3523ce1f1f3?s=128&d=identicon&r=PG", "display_name": "Dunk", "link": "https://stackoverflow.com/users/61708/dunk"}, "edited": false, "score": 0, "creation_date": 1533765670, "post_id": 51752985, "comment_id": 90472027, "body": "Not wanting to state the obvious but have you set a breakpoint on the .Show call and look at the stack trace each time the breakpoint is hit? At the very least it should tell you what is triggering the calls."}], "owner": {"reputation": 21, "user_id": 9291861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LRIgL.jpg?s=128&g=1", "display_name": "ArthurA", "link": "https://stackoverflow.com/users/9291861/arthura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1533752754, "creation_date": 1533751268, "last_edit_date": 1533752754, "question_id": 51752985, "link": "https://stackoverflow.com/questions/51752985/messagebox-more-than-one-when-executing-code", "title": "MessageBox, more than one when executing code", "body": "<p>I am creating a code in Visual Studio C# and when I execute my code I get to a section where I have a Messagebox pop up to confirm if you want to change a value. At this point a 2nd MessageBox will proceed the first. Does anyone have any ideas on how I can eliminate that 2nd box?</p>\n\n<p>For note: I had this error in a past code I made but it would continuously increase the number of boxes every time I reset the code because the control was called in one of my Initialize methods that got called on start, the error I am having is always two MessageBoxes consistently</p>\n\n<p>EDIT: It's the same messagebox that's showing up directly after itself.</p>\n\n<p>Example of code where I use the MessageBox and get the problem:</p>\n\n<pre><code>private void comboBoxReprint_SelectedIndexChanged(object sender, EventArgs e)\n{\n    DialogResult result = MessageBox.Show(\n        \"Change Reason to: \\r\\n\" comboBoxReprint.Text + \"\\r\\n\\r\\n\" + \"Confirm?\", \n        \"Label Reprint Reason\",\n        MessageBoxButtons.YesNo, MessageBoxIcon.Information);\n\n        if (result == DialogResult.Yes)\n        {\n            Console.WriteLine(\"PROCEED WITH PROCESS\");\n\n\n            //Grab the selection so I can save it \n            string _reason = (string)comboBoxReprint.SelectedItem;\n\n\n            //move forward in the flowchart.\n            if (MODE == \"B\")\n            {\n                //SAVE BAG REPRINT REASON TO DB TABLE;\n                //Get time in this moment.\n                string _time = DateTime.Now.ToString(\"h:mm:ss tt\");\n                //InsertData(ID, _reason, \"LabelReprintReasonBag\");\n            }\n\n            else if (MODE == \"P\")\n            {\n                //SAVE PACK REPRINT REASON TO TABLE;\n                //InsertData(ID, _reason, \"LabelReprintReasonPack\");\n            }\n\n            comboBoxReprint.Enabled = false;\n\n\n            //Proceed to section B of flowchat. \n            if (MODE == \"B\")\n            {\n                QueryTestPresCheck();\n            }\n\n            else if (MODE == \"P\")\n            {\n                //Run Query for Bagging VI result *************************************************************************************************\n                //SelectData(_LN, _SN, \"BAGGING_VI_RESULT\");\n            }\n        }\n        else if (result == DialogResult.No)\n        {\n            comboBoxReprint.ResetText();\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "oracle", "entity-framework", "migration", "database-migration"], "comments": [{"owner": {"reputation": 3268, "user_id": 9850970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/85lTf.png?s=128&g=1", "display_name": "Aldert", "link": "https://stackoverflow.com/users/9850970/aldert"}, "edited": false, "score": 0, "creation_date": 1533755083, "post_id": 51752976, "comment_id": 90467630, "body": "Seems nothing wrong with your code..Have you tried different db (sql server), just to validate. At first I was thinking a setting on oracle db but seems unlikely and a bit far fetched. I have no oracle db i could try but this looks weird"}, {"owner": {"reputation": 11, "user_id": 10199245, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TCFoxVVsTYM/AAAAAAAAAAI/AAAAAAAAACo/kT4C06BKQtI/photo.jpg?sz=128", "display_name": "Eberson Henrique da Silva Dias", "link": "https://stackoverflow.com/users/10199245/eberson-henrique-da-silva-dias"}, "reply_to_user": {"reputation": 3268, "user_id": 9850970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/85lTf.png?s=128&g=1", "display_name": "Aldert", "link": "https://stackoverflow.com/users/9850970/aldert"}, "edited": false, "score": 0, "creation_date": 1533851856, "post_id": 51752976, "comment_id": 90511022, "body": "I have experience with mysql and I have no problem, only with oracle this occurs"}], "owner": {"reputation": 11, "user_id": 10199245, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-TCFoxVVsTYM/AAAAAAAAAAI/AAAAAAAAACo/kT4C06BKQtI/photo.jpg?sz=128", "display_name": "Eberson Henrique da Silva Dias", "link": "https://stackoverflow.com/users/10199245/eberson-henrique-da-silva-dias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1533751473, "creation_date": 1533751212, "last_edit_date": 1533751473, "question_id": 51752976, "link": "https://stackoverflow.com/questions/51752976/entity-framework-with-oracle-command-add-migration-creates-in-the-table-key-fiel", "title": "Entity Framework with Oracle command Add-Migration creates in the table key field of the decimal type, but in the template is integer", "body": "<p>Because when I run <code>Add-Migration Test -Force</code> command, it generates the create table in the table it places as decimal, whereas in the model it is int \"id_usuario = c.Decimal(nullable: false, precision: 10, scale: 0, identity: true),\"</p>\n\n<pre><code>public partial class Teste : DbMigration\n{\n    public override void Up()\n    {\n        CreateTable(\n            \"dbo.sec_usuarios\",\n            c =&gt; new\n                {\n                    id_usuario = c.Decimal(nullable: false, precision: 10, scale: 0, identity: true),\n                    id_cidade = c.Decimal(nullable: false, precision: 10, scale: 0),\n                    nome_completo = c.String(),\n                })\n            .PrimaryKey(t =&gt; t.id_usuario);\n\n    }\n\n    public override void Down()\n    {\n        DropTable(\"dbo.sec_usuarios\");\n    }\n}\n</code></pre>\n\n<p>See my model with the property <code>public int id_usuario { get; set; }</code>:</p>\n\n<pre><code>[Table(\"sec_usuarios\")]\npublic class usuario\n{\n    [Key]\n    public int id_usuario { get; set; }\n\n    public int id_cidade { get; set; }\n\n    public string nome_completo { get; set; }\n}\n</code></pre>\n\n<p>This is my Context</p>\n\n<pre><code>public class Contexto: DbContext\n{\n    public Contexto() : base(\"Contexto\")\n    {  }\n\n    public DbSet&lt;usuario&gt; Usuarios { get; set; }\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        modelBuilder.HasDefaultSchema(\"SYSTEM\");\n        base.OnModelCreating(modelBuilder);\n    }\n}\n</code></pre>\n\n<p>I do not know why this occurs, where can I determine by default int? Is there an intermediary?</p>\n"}, {"tags": ["c#", "authentication", "asp.net-core", "google-oauth"], "comments": [{"owner": {"reputation": 12678, "user_id": 2940908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/E79WU.jpg?s=128&g=1", "display_name": "agua from mars", "link": "https://stackoverflow.com/users/2940908/agua-from-mars"}, "edited": false, "score": 0, "creation_date": 1533751541, "post_id": 51752834, "comment_id": 90465876, "body": "did you check if the id_token is sent by google ?"}, {"owner": {"reputation": 39709, "user_id": 2833802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PzEYJ.jpg?s=128&g=1", "display_name": "Set", "link": "https://stackoverflow.com/users/2833802/set"}, "edited": false, "score": 0, "creation_date": 1533753527, "post_id": 51752834, "comment_id": 90466939, "body": "BTW, <a href=\"https://stackoverflow.com/q/42053135\">you don&#39;t need to use <code>.ConfigureAwait(false)</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9285962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a72aef6c23dc7b7f8c644ca32489e40?s=128&d=identicon&r=PG&f=1", "display_name": "Aleknik", "link": "https://stackoverflow.com/users/9285962/aleknik"}, "edited": false, "score": 0, "creation_date": 1533816325, "post_id": 51753947, "comment_id": 90491614, "body": "I tried your solution but i was getting an error from google that nonce was missing so added this: <code>queryStrings.Add(&quot;nonce&quot;, Guid.NewGuid().ToString(&quot;N&quot;));</code> . Now i&#39;m getting an exception: <code>Exception: The oauth state was missing or invalid.</code>"}], "tags": [], "owner": {"reputation": 39709, "user_id": 2833802, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PzEYJ.jpg?s=128&g=1", "display_name": "Set", "link": "https://stackoverflow.com/users/2833802/set"}, "is_accepted": false, "score": 0, "last_activity_date": 1533755068, "creation_date": 1533755068, "answer_id": 51753947, "question_id": 51752834, "link": "https://stackoverflow.com/questions/51752834/asp-net-core-2-x-google-authentication-get-id-token/51753947#51753947", "title": "ASP.NET Core 2.x google authentication get id_token", "body": "<p>By default, <a href=\"https://github.com/aspnet/Security/blob/master/src/Microsoft.AspNetCore.Authentication.Google/GoogleHandler.cs#L56\" rel=\"nofollow noreferrer\">Google authentication implementation uses <code>response_type=code</code></a>. With this flow, you don't have <code>id_token</code> in response. To have it, <code>response_type</code> should be <code>response_type=code id_token</code> (from <a href=\"https://medium.com/@darutk/diagrams-of-all-the-openid-connect-flows-6968e3990660\" rel=\"nofollow noreferrer\">here</a>). </p>\n\n<p>You may override that <code>BuildChallengeUrl</code> method in derived <code>YourGoogleHandler</code> class, and change DI registration from <code>.AddGoogle()</code> to</p>\n\n<pre><code>.AddOAuth&lt;GoogleOptions, YourGoogleHandler&gt;\n  (GoogleDefaults.AuthenticationScheme, GoogleDefaults.DisplayName, googleOptions)\n</code></pre>\n\n<p>(code was taken from <a href=\"https://github.com/aspnet/Security/blob/master/src/Microsoft.AspNetCore.Authentication.Google/GoogleExtensions.cs\" rel=\"nofollow noreferrer\">Microsoft.AspNetCore.Authentication.Google/GoogleExtensions.cs</a></p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 1599661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ae1cc1d796fafb118ac9711e39dba4?s=128&d=identicon&r=PG", "display_name": "Suresh Amudalapalli", "link": "https://stackoverflow.com/users/1599661/suresh-amudalapalli"}, "is_accepted": false, "score": 0, "last_activity_date": 1560871160, "creation_date": 1560871160, "answer_id": 56652322, "question_id": 51752834, "link": "https://stackoverflow.com/questions/51752834/asp-net-core-2-x-google-authentication-get-id-token/56652322#56652322", "title": "ASP.NET Core 2.x google authentication get id_token", "body": "<p>The solution that worked for me.. </p>\n\n<pre><code> services.AddAuthentication()\n           .AddOpenIdConnect(GoogleDefaults.AuthenticationScheme,\n               GoogleDefaults.DisplayName,\n               options =&gt;\n               {\n                   options.SignInScheme = IdentityServerConstants.ExternalCookieAuthenticationScheme;\n                   options.Authority =  \"https://accounts.google.com\";\n                   options.ClientId = googleOAuthSettings.ClientId;\n                   options.ClientSecret = googleOAuthSettings.ClientSecret;\n                   options.ResponseType = OpenIdConnectResponseType.IdToken;\n                   options.CallbackPath =  \"signin-google\";\n                   options.SaveTokens = true; //this has to be true to get the token value\n                   options.Scope.Add(\"email\");\n               });\n</code></pre>\n\n<p>OpenIdConnect provider for Google OAuth allow us to customise the ResponseType.</p>\n\n<p>As per the <a href=\"https://stackoverflow.com/questions/56565997/identity-server-4-getschemesupportssignoutasync-returns-incorrect-response?answertab=active#tab-top\">link</a> , OpenIdConnectHandler which appears to implement IAuthenticationSignOutHandler. So that's why regardless of what is in the discovery document (end session endpoint supported or not), if you use the AddOpenIdConnect(...), it will always register a handler which seemingly supports sign out. If you are using any IdentityServer4 quick start, then you can get rid of that error by checking with a condition in AccountService.cs --> BuildLoggedOutViewModelAsync method. </p>\n\n<blockquote>\n  <p>var providerSupportsSignOut = await\n  _httpContextAccessor.HttpContext.GetSchemeSupportsSignOutAsync(idp)</p>\n</blockquote>\n\n<p>Here, we can add additional check like : <code>idp != Google.</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9285962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a72aef6c23dc7b7f8c644ca32489e40?s=128&d=identicon&r=PG&f=1", "display_name": "Aleknik", "link": "https://stackoverflow.com/users/9285962/aleknik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1162, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1560871160, "creation_date": 1533750711, "question_id": 51752834, "link": "https://stackoverflow.com/questions/51752834/asp-net-core-2-x-google-authentication-get-id-token", "title": "ASP.NET Core 2.x google authentication get id_token", "body": "<p>I'm using Google authentication for my asp.net mvc application.\nI added Google to my Startup.cs class:</p>\n\n<pre><code>services.AddAuthentication(options =&gt;\n{\n    options.DefaultAuthenticateScheme = GoogleDefaults.AuthenticationScheme;\n    options.DefaultChallengeScheme = GoogleDefaults.AuthenticationScheme;\n})\n.AddGoogle(googleOptions =&gt;\n{\n    googleOptions.ClientId = _configuration[\"Authentication:Google:ClientId\"];\n    googleOptions.ClientSecret = _configuration[\"Authentication:Google:ClientSecret\"];\n    googleOptions.SaveTokens = true;\n});\n</code></pre>\n\n<p>I can get access_token from controller using this:</p>\n\n<pre><code>var token = await HttpContext.GetTokenAsync(\"access_token\").ConfigureAwait(false);\n</code></pre>\n\n<p>I need id_token to authenticate to my custom backend application like <a href=\"https://developers.google.com/identity/sign-in/web/backend-auth\" rel=\"nofollow noreferrer\">this</a>.\nI tried using this code but I get null.</p>\n\n<pre><code>var token = await HttpContext.GetTokenAsync(\"id_token\").ConfigureAwait(false);\n</code></pre>\n\n<p>Is it possible to get id_token somehow?</p>\n"}, {"tags": ["c#", "asp.net-core-mvc"], "comments": [{"owner": {"reputation": 6505, "user_id": 3059097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b82e3e2f10c9983fb609e74224d078?s=128&d=identicon&r=PG", "display_name": "casey", "link": "https://stackoverflow.com/users/3059097/casey"}, "edited": false, "score": 0, "creation_date": 1533751137, "post_id": 51752820, "comment_id": 90465653, "body": "Please include more of the cshtml file including at least your @model declaration and the form tag that contains this select control.  As is there is not enough context to answer your question."}, {"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 0, "creation_date": 1533751186, "post_id": 51752820, "comment_id": 90465686, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5688910/asp-net-mvc-dropdownlistfor-with-model-of-type-liststring\">ASP.NET MVC DropDownListFor with model of type List&lt;string&gt;</a>"}, {"owner": {"reputation": 339, "user_id": 6856253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c578a774a1f4f6f7afca8739073074?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/6856253/doe"}, "reply_to_user": {"reputation": 6505, "user_id": 3059097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66b82e3e2f10c9983fb609e74224d078?s=128&d=identicon&r=PG", "display_name": "casey", "link": "https://stackoverflow.com/users/3059097/casey"}, "edited": false, "score": 0, "creation_date": 1533751724, "post_id": 51752820, "comment_id": 90465971, "body": "@casey Added some more details"}], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 6856253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c578a774a1f4f6f7afca8739073074?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/6856253/doe"}, "edited": false, "score": 0, "creation_date": 1533751532, "post_id": 51752958, "comment_id": 90465871, "body": "Made this change, but the value of both <code>selectedApi</code> and <code>Api</code> in the controller action are still <code>Null</code>."}, {"owner": {"reputation": 339, "user_id": 6856253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c578a774a1f4f6f7afca8739073074?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/6856253/doe"}, "edited": false, "score": 0, "creation_date": 1533751632, "post_id": 51752958, "comment_id": 90465929, "body": "Also, I cant really use this approach because changing <code>asp-for</code> to <code>SelectListItem </code> changes my dropdown to a single select dropdown. I need it to be a multi select dropdown."}, {"owner": {"reputation": 13794, "user_id": 4870358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Os0to.jpg?s=128&g=1", "display_name": "Marcus H&#246;glund", "link": "https://stackoverflow.com/users/4870358/marcus-h%c3%b6glund"}, "reply_to_user": {"reputation": 339, "user_id": 6856253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c578a774a1f4f6f7afca8739073074?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/6856253/doe"}, "edited": false, "score": 0, "creation_date": 1533751743, "post_id": 51752958, "comment_id": 90465981, "body": "@JoshMuroe u still need the Api  values in the model. Updated the answers model. Have you linked the <i>@model</i> to the page"}, {"owner": {"reputation": 339, "user_id": 6856253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c578a774a1f4f6f7afca8739073074?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/6856253/doe"}, "edited": false, "score": 0, "creation_date": 1533751871, "post_id": 51752958, "comment_id": 90466050, "body": "Yes, I still have the <code>List&lt;SelectListItem&gt; Api</code> in there. The model is linked to the page since I have other input fields on the page and they are passed to the controller action just fine."}, {"owner": {"reputation": 13794, "user_id": 4870358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Os0to.jpg?s=128&g=1", "display_name": "Marcus H&#246;glund", "link": "https://stackoverflow.com/users/4870358/marcus-h%c3%b6glund"}, "reply_to_user": {"reputation": 339, "user_id": 6856253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c578a774a1f4f6f7afca8739073074?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/6856253/doe"}, "edited": false, "score": 0, "creation_date": 1533752236, "post_id": 51752958, "comment_id": 90466253, "body": "@JoshMuroe you need to set the selected item to the value type of the SelectListItem value. Updated the answer"}], "tags": [], "owner": {"reputation": 13794, "user_id": 4870358, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Os0to.jpg?s=128&g=1", "display_name": "Marcus H&#246;glund", "link": "https://stackoverflow.com/users/4870358/marcus-h%c3%b6glund"}, "is_accepted": true, "score": 0, "last_activity_date": 1533752203, "last_edit_date": 1533752203, "creation_date": 1533751147, "answer_id": 51752958, "question_id": 51752820, "link": "https://stackoverflow.com/questions/51752820/values-selected-in-dropdown-not-being-passed-to-the-controller/51752958#51752958", "title": "Values selected in dropdown not being passed to the controller", "body": "<p>The <code>asp-for</code> tag holds the selected item and it should not be the same as the collection set in <code>asp-items</code>.\nSo add a new property, which matches the value type set of the SelectListItems of API(in this example a use an int), on the model like this</p>\n\n<pre><code>public class Model\n{\n    public int selectedApi { get; set; }\n    public List&lt;SelectListItem&gt; Api { get; set; }\n}\n</code></pre>\n\n<p>and use it on the select tag for the selected item</p>\n\n<pre><code>&lt;select id=\"api\" class=\"form-control\" asp-for=\"selectedApi\" asp-items=\"@Model.Api\"&gt;\n&lt;/select&gt;\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 6856253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c578a774a1f4f6f7afca8739073074?s=128&d=identicon&r=PG&f=1", "display_name": "Doe", "link": "https://stackoverflow.com/users/6856253/doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 51752958, "answer_count": 1, "score": 2, "last_activity_date": 1533753102, "creation_date": 1533750672, "last_edit_date": 1533751708, "question_id": 51752820, "link": "https://stackoverflow.com/questions/51752820/values-selected-in-dropdown-not-being-passed-to-the-controller", "title": "Values selected in dropdown not being passed to the controller", "body": "<p>I followed <a href=\"https://stackoverflow.com/questions/34624034/select-tag-helper-in-asp-net-core-mvc\">Select Tag Helper in ASP.NET Core MVC</a> to populate a multi select dropdown from a method call, but the value I am selecting is not being passed to the controller. </p>\n\n<pre><code>&lt;form asp-controller=\"ApiController\" asp-action=\"Usage\"&gt;\n&lt;label asp-for=\"Api\"&gt;&lt;/label&gt;\n&lt;div&gt;\n    &lt;select id=\"api\" class=\"form-control\" asp-for=\"Api\" asp-items=\"@Model.Api\"&gt;\n\n    &lt;/select&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>The options in this dropdown contain all Apis.</p>\n\n<p><strong>Model</strong></p>\n\n<pre><code>public class Model\n{\n    public List&lt;SelectListItem&gt; Api { get; set; }\n}\n</code></pre>\n\n<p>When I look at the action method, the model has a <code>Null</code> value for Api.</p>\n"}, {"tags": ["c#", "html", ".net-core", "web-inspector"], "comments": [{"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 1, "creation_date": 1533750666, "post_id": 51752785, "comment_id": 90465390, "body": "Please provide code effort of how you tried to acquire this data."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1533750720, "post_id": 51752785, "comment_id": 90465418, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 59, "user_id": 2449040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhMyb.jpg?s=128&g=1", "display_name": "Cyphryx", "link": "https://stackoverflow.com/users/2449040/cyphryx"}, "reply_to_user": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1533750954, "post_id": 51752785, "comment_id": 90465546, "body": "Code added to question"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1533751060, "post_id": 51752785, "comment_id": 90465615, "body": "So, whats in the <code>htmlCode</code> variable?"}, {"owner": {"reputation": 59, "user_id": 2449040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhMyb.jpg?s=128&g=1", "display_name": "Cyphryx", "link": "https://stackoverflow.com/users/2449040/cyphryx"}, "reply_to_user": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1533751322, "post_id": 51752785, "comment_id": 90465763, "body": "htmlCode now defined above"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1533751380, "post_id": 51752785, "comment_id": 90465791, "body": "Hi, no, i mean, after you call <code>DownloadString</code>, what&#39;s in the htmlCode variable? Doesn&#39;t it contain the page?"}, {"owner": {"reputation": 59, "user_id": 2449040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhMyb.jpg?s=128&g=1", "display_name": "Cyphryx", "link": "https://stackoverflow.com/users/2449040/cyphryx"}, "reply_to_user": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1533751452, "post_id": 51752785, "comment_id": 90465833, "body": "It only contains the source code.  I&#39;ll add an image of the difference between what&#39;s received via DownloadString versus what you can view in the inspector."}, {"owner": {"reputation": 59, "user_id": 2449040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhMyb.jpg?s=128&g=1", "display_name": "Cyphryx", "link": "https://stackoverflow.com/users/2449040/cyphryx"}, "reply_to_user": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1533751704, "post_id": 51752785, "comment_id": 90465962, "body": "htmlCode contents now displayed in question"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1533751762, "post_id": 51752785, "comment_id": 90465995, "body": "Maybe the site author tried to block crawlers. You might want to try one of the javascript files. Maybe they are calling a public service to fetch the data."}, {"owner": {"reputation": 59, "user_id": 2449040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhMyb.jpg?s=128&g=1", "display_name": "Cyphryx", "link": "https://stackoverflow.com/users/2449040/cyphryx"}, "reply_to_user": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1533752110, "post_id": 51752785, "comment_id": 90466181, "body": "I&#39;m a desktop app dev, not a web dev, hence my question on &quot;i can browse the data in my browser, how do I do it with C#?&quot;  There&#39;s bound to be somebody that knows dev enough to explain how I can capture the same data the browser is capturing for its inspector."}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 1, "creation_date": 1533752436, "post_id": 51752785, "comment_id": 90466367, "body": "Ah, yes, but it&#39;s a lot of work. You see; your browser runs javascript. For example: a page loads: the source is there. But then some javascript interacts with the page and start fetching some data and altering the page. Browsers can handle that really good because that what they are build for. If you want to build it in code... you&#39;re basically building your own browser... with javascript interpreter. That&#39;s a lot of code. So... maybe you can try things with a browser-plugin, or analyse the javascript to get the actual data source. Maybe there is a lib somewhere. But it&#39;s not easy."}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 0, "creation_date": 1534115210, "post_id": 51752785, "comment_id": 90581840, "body": "Many Web pages have active content. A WebBrowser can interpret and execute client side Javascript (mainly) code. Some data can be pushed by the a server. In short, you can&#39;t scrape any Web page with a non-responsive system. You could use the <code>WebBrowser</code> class. It works well enough in most case, but it&#39;s difficult to setup correctly, to have IE11/Edge compatibility (you can find info on SO about that). A more evolved client may be needed. See <a href=\"https://stackoverflow.com/questions/790542/replacing-net-webbrowser-control-with-a-better-browser-like-chrome\">this question</a> for some directions."}, {"owner": {"reputation": 146, "user_id": 8446267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cjxtG.jpg?s=128&g=1", "display_name": "Johni Michels", "link": "https://stackoverflow.com/users/8446267/johni-michels"}, "edited": false, "score": 0, "creation_date": 1534716328, "post_id": 51752785, "comment_id": 90794030, "body": "Am I the only one that couldn&#39;t see how you couldn&#39;t find the data? After you make a POST request like: <a href=\"https://www1.gigbuilder.com/gbmusic.nsf/musiclist?open&amp;list=getsong&amp;unid=373119AB109D294386257DA700325738\" rel=\"nofollow noreferrer\">www1.gigbuilder.com/gbmusic.nsf/&hellip;</a> It literally responds the same html with a special div with the class: &quot;fancybox-wrap fancybox-desktop fancybox-type-iframe fancybox-opened&quot; That&#39;s where all the data is."}, {"owner": {"reputation": 146, "user_id": 8446267, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cjxtG.jpg?s=128&g=1", "display_name": "Johni Michels", "link": "https://stackoverflow.com/users/8446267/johni-michels"}, "edited": false, "score": 0, "creation_date": 1534716603, "post_id": 51752785, "comment_id": 90794068, "body": "Actually if you replace the unid value in the request with the id give on each tr you&#39;ll navigate in this data."}], "answers": [{"tags": [], "owner": {"reputation": 319, "user_id": 10074551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfb261402a6e5ae77544f874a2ca75d?s=128&d=identicon&r=PG&f=1", "display_name": "UbuntuCore", "link": "https://stackoverflow.com/users/10074551/ubuntucore"}, "is_accepted": false, "score": 0, "last_activity_date": 1534421301, "creation_date": 1534421301, "answer_id": 51876721, "question_id": 51752785, "link": "https://stackoverflow.com/questions/51752785/capturing-data-from-browser-page-inspector-in-c-net-core-console-application/51876721#51876721", "title": "Capturing data from browser page inspector in C# .NET Core Console Application", "body": "<p>Read about Selenium Automation tool for C#, but it'll open every web page that you want to scrap and then e.g return source code or perform some actions on that webpage.</p>\n\n<p>Generally this tool is not (afaik) for web crawlers, but can be good at the beginning, especially if your dotnet core app is sitting on some virtual machine / docker.</p>\n\n<p>But care, it may be risky to open not-safe pages via browser.</p>\n"}, {"tags": [], "owner": {"reputation": 947, "user_id": 250525, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/34a03c949d5a77d7d8adf8d27ecb0d6c?s=128&d=identicon&r=PG", "display_name": "brechtvhb", "link": "https://stackoverflow.com/users/250525/brechtvhb"}, "is_accepted": false, "score": 0, "last_activity_date": 1534429724, "creation_date": 1534429724, "answer_id": 51879487, "question_id": 51752785, "link": "https://stackoverflow.com/questions/51752785/capturing-data-from-browser-page-inspector-in-c-net-core-console-application/51879487#51879487", "title": "Capturing data from browser page inspector in C# .NET Core Console Application", "body": "<p>You might watn to try pupeteer sharp.\nIt allows you to get the current HTML state.</p>\n\n<pre><code>using (var page = await browser.NewPageAsync())\n{\n    await page.GoToAsync(\"http://www.spapage.com\");\n    var result = await page.GetContentAsync();\n}\n</code></pre>\n\n<p><a href=\"https://github.com/kblok/puppeteer-sharp\" rel=\"nofollow noreferrer\">https://github.com/kblok/puppeteer-sharp</a></p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 2449040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhMyb.jpg?s=128&g=1", "display_name": "Cyphryx", "link": "https://stackoverflow.com/users/2449040/cyphryx"}, "edited": false, "score": 0, "creation_date": 1534808636, "post_id": 51891502, "comment_id": 90829554, "body": "Awesome! Thank you so much!"}], "tags": [], "owner": {"reputation": 783, "user_id": 455531, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/21af663638d5e851e650d0a6a0360718?s=128&d=identicon&r=PG", "display_name": "Sierrodc", "link": "https://stackoverflow.com/users/455531/sierrodc"}, "is_accepted": true, "score": 2, "last_activity_date": 1534495230, "creation_date": 1534495230, "answer_id": 51891502, "question_id": 51752785, "link": "https://stackoverflow.com/questions/51752785/capturing-data-from-browser-page-inspector-in-c-net-core-console-application/51891502#51891502", "title": "Capturing data from browser page inspector in C# .NET Core Console Application", "body": "<p>There are few ways to implement what you need (considering a C# console application).</p>\n\n<p>Maybe the easiest one is to use tools that interact with an instance of a browser, i.e. Selenium (used for unit tests).\nSo:</p>\n\n<ol>\n<li>Install Selenium.WebDriver nuget package</li>\n<li>Install a browser where your application will run (let's suppose chrome)</li>\n<li>Download the browser driver (<a href=\"https://sites.google.com/a/chromium.org/chromedriver/downloads\" rel=\"nofollow noreferrer\">chromedriver</a>)</li>\n<li><p>Write something like:</p>\n\n<pre><code>IWebDriver driver = null;\ntry\n{\n    ChromeOptions options = new ChromeOptions();\n    options.AddArguments(\"--incognito\");\n\n    driver = new ChromeDriver(options);\n    driver.Manage().Timeouts().ImplicitWait = TimeSpan.FromSeconds(5);\n    driver.Url = \"https://www.wedj.com/dj-photo-video.nsf/firstdance.html\";\n\n    var musicTable = driver.FindElement(By.Id(\"musicTable\"));\n    // interact with driver to get data from the page.\n }\n finally\n {\n    if (driver != null)\n       driver.Dispose();\n }\n</code></pre></li>\n</ol>\n\n<p>Otherwise, you  need to investigate a little bit more how the webpage works.\nAs far as I can see, the page loads a javascript, <a href=\"https://www.wedj.com/dj-photo-video.nsf/musiclist.js\" rel=\"nofollow noreferrer\">https://www.wedj.com/dj-photo-video.nsf/musiclist.js</a>, that it is responsible to load the list of music from server.\nThis js script basically load data from following url: <a href=\"https://www.wedj.com/gbmusic.nsf/musicList?open&amp;wedj=1&amp;list=category_firstdance&amp;count=100\" rel=\"nofollow noreferrer\">https://www.wedj.com/gbmusic.nsf/musicList?open&amp;wedj=1&amp;list=category_firstdance&amp;count=100</a> (you can open it also in a browser). Excluding \"(\" and \")\", the result is a json you can parse (maybe using newtonsoft.json package):</p>\n\n<pre><code>{\n  \"more\": \"yes\",\n  \"title\": \"&lt;h1&gt;Most Requested Wedding First Dance Songs&lt;\\/h...\",\n  \"event\": \"&lt;table class='musicTable g6-table-all g6-small' id='musicTable' borde...\"\n}\n</code></pre>\n\n<p>The event property contains the data you need (you can use HtmlAgilityPack nuget package to parse it).</p>\n\n<hr>\n\n<p>Pro Selenium:</p>\n\n<ol>\n<li>easy to interact with</li>\n<li>the behavior is the same of what you see by the browser</li>\n</ol>\n\n<p>Cons Selenium: </p>\n\n<ol>\n<li>you need chrome or another browser installed</li>\n<li>the browser is running when you interact with it</li>\n<li>the browser download the full page (images, html, js, css...)</li>\n</ol>\n\n<p>Pro manual:</p>\n\n<ol>\n<li>you load only what you need</li>\n<li>no dependencies to external programs (i.e. browsers)</li>\n</ol>\n\n<p>Cons manual:</p>\n\n<ol>\n<li>you need to understand how html/js works</li>\n<li>you need to manually parse the json/html</li>\n</ol>\n\n<hr>\n\n<p>In this specific case, I prefer the second options.</p>\n"}], "owner": {"reputation": 59, "user_id": 2449040, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhMyb.jpg?s=128&g=1", "display_name": "Cyphryx", "link": "https://stackoverflow.com/users/2449040/cyphryx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1993, "favorite_count": 1, "accepted_answer_id": 51891502, "answer_count": 3, "score": -1, "last_activity_date": 1534495230, "creation_date": 1533750572, "last_edit_date": 1533751647, "question_id": 51752785, "link": "https://stackoverflow.com/questions/51752785/capturing-data-from-browser-page-inspector-in-c-net-core-console-application", "title": "Capturing data from browser page inspector in C# .NET Core Console Application", "body": "<p>My C# .NET Core console application is a simple web crawler.  On pages where the needed data is contained in the source code, I am able to access the needed data.  In pages where the data can be copied from the window, viewed in the browser's Page Inspector, but NOT in the source code, I'm stuck.</p>\n\n<p><a href=\"https://i.stack.imgur.com/oDxHJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oDxHJ.png\" alt=\"Chrome Page Inspector shows code needed for download\"></a></p>\n\n<p>Please provide code examples of how I can acquire this data.</p>\n\n<p>My current capture code is below:</p>\n\n<pre><code>var htmlCode = string.empty;\nusing (WebClient client = new WebClient()) // WebClient class inherits IDisposable\n{\n     // Get the file content without saving it\n     htmlCode = client.DownloadString(\"https://www.wedj.com/dj-photo-video.nsf/firstdance.html\");\n}\n</code></pre>\n\n<p>Using the above code, you receive the source code as seen here:\n<a href=\"https://i.stack.imgur.com/pswWN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pswWN.png\" alt=\"enter image description here\"></a></p>\n\n<p>The data shown in image 1, as seen from the browser inspector is hidden inside of </p>\n\n<pre><code>&lt;div class=\"entry row\"&gt;\n</code></pre>\n"}, {"tags": ["c#", "jquery", "html", "ajax"], "comments": [{"owner": {"reputation": 823, "user_id": 1132557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Xbihg.png?s=128&g=1", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1132557/kingsley"}, "edited": false, "score": 0, "creation_date": 1533751286, "post_id": 51752725, "comment_id": 90465747, "body": "What does the response look like?"}, {"owner": {"reputation": 508, "user_id": 8468636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48abbf00456ad4b2fbfe9c11fd675b94?s=128&d=identicon&r=PG&f=1", "display_name": "K-Log", "link": "https://stackoverflow.com/users/8468636/k-log"}, "edited": false, "score": 0, "creation_date": 1533751489, "post_id": 51752725, "comment_id": 90465853, "body": "So I am not seeing where you are trying to actually put the data into the table. Do have any code that actually attempts to do that or am I just missing it?"}, {"owner": {"reputation": 1, "user_id": 10198955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6f25a368df8a9212f2074c4f0fd425?s=128&d=identicon&r=PG&f=1", "display_name": "Vanessa Kim", "link": "https://stackoverflow.com/users/10198955/vanessa-kim"}, "edited": false, "score": 0, "creation_date": 1533754754, "post_id": 51752725, "comment_id": 90467481, "body": "I&#39;ve tried multiple ways, this is the one I am currently trying but I am getting absolutely no response."}, {"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1533756185, "post_id": 51752725, "comment_id": 90468068, "body": "Take a moment and read How to <a href=\"https://stackoverflow.com/questions/10638059/javascript-debugging-line-by-line-using-google-chrome\">Javascript Debugging line by line using Google Chrome</a>.  The actual problem is very basic."}], "answers": [{"tags": [], "owner": {"reputation": 1178, "user_id": 6363273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fe42bbac197395210bccc4a68df10102?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Gibbs", "link": "https://stackoverflow.com/users/6363273/ryan-gibbs"}, "is_accepted": false, "score": 1, "last_activity_date": 1533755789, "creation_date": 1533755789, "answer_id": 51754113, "question_id": 51752725, "link": "https://stackoverflow.com/questions/51752725/how-can-i-insert-objects-into-a-html-table-using-javascript-ajax/51754113#51754113", "title": "How can i insert objects into a HTML table using JavaScript / AJAX", "body": "<p>Assuming you're gettting the data you need back from that post request, I believe that the issue might be with:</p>\n\n<pre><code>$('#body').append(html);\n</code></pre>\n\n<p>That selector looks for an element with an id='body', which you do not have in your html. Instead, try using:</p>\n\n<pre><code>$('tbody').append(html);\n</code></pre>\n\n<p>Or put that id on your tbody html tag:</p>\n\n<pre><code>&lt;tbody id='body'&gt;&lt;/tbody&gt;\n</code></pre>\n\n<p>Then your script will append to that control.</p>\n\n<p>Moving forwards try checking the developer's console to see errors your code is throwing. I would imagine you are getting an error with your code as is (CTRL-SHIFT-I or right click and choose inspect, depending on your web browser).</p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 2051501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/683d1bd416fd93fc542e20f6e922483e?s=128&d=identicon&r=PG", "display_name": "Anthony Gingrich", "link": "https://stackoverflow.com/users/2051501/anthony-gingrich"}, "is_accepted": false, "score": 0, "last_activity_date": 1533757393, "creation_date": 1533757393, "answer_id": 51754495, "question_id": 51752725, "link": "https://stackoverflow.com/questions/51752725/how-can-i-insert-objects-into-a-html-table-using-javascript-ajax/51754495#51754495", "title": "How can i insert objects into a HTML table using JavaScript / AJAX", "body": "<p>If you were to flow this out with sample records, you'll notice that the variable <code>html</code> will have a value similar to this: <code>&lt;tr&gt;&lt;tr&gt;&lt;tr&gt;&lt;tr&gt;&lt;/tr&gt;</code>--depending on how many records were returned from your AJAX request.</p>\n\n<p>This, of course, assumes that the runtime doesn't crash due to <code>totalCells</code> being undefined. (As well as <code>array</code> and <code>count</code>.)</p>\n\n<p>There are much better approaches to your problem, too. I would recommend:</p>\n\n<pre><code>    var table = $('&lt;table&gt;&lt;tbody&gt;&lt;/tbody&gt;&lt;/table&gt;');\n    var tbody = table.children('tbody');\n\n    for (var i = 0; i &lt; responseData.length; i++) {\n        var tr = $('&lt;tr&gt;&lt;/tr&gt;');\n\n        for (c = 0; c &lt; totalCells; c++) {\n            tr.append($('&lt;td&gt;&lt;/td&gt;').html(array[c]));\n        }\n\n        tbody.append(tr);\n    }\n\n    $('body').append(table);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10198955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6f25a368df8a9212f2074c4f0fd425?s=128&d=identicon&r=PG&f=1", "display_name": "Vanessa Kim", "link": "https://stackoverflow.com/users/10198955/vanessa-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533757393, "creation_date": 1533750383, "last_edit_date": 1533754873, "question_id": 51752725, "link": "https://stackoverflow.com/questions/51752725/how-can-i-insert-objects-into-a-html-table-using-javascript-ajax", "title": "How can i insert objects into a HTML table using JavaScript / AJAX", "body": "<p>I am trying to create a site that takes information form a music forum by searching an artist name and populates the artist 5 top albums, by popularity, number of tracks and release date. The information is pulling correctly from the site but when I go to create and HTML table no information is displayed. Search button is function properly, its calling all the right information, can help provide a solution in which I can extract the information from the array and populate/ create a table in HTML? below is the code I am currently working with.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>function searchClicked() {\r\n   var artist_name = document.getElementById(\"artistName\").value;\r\n\r\n   var data = {};\r\n   data.ArtistName = artist_name\r\n    $.ajax({\r\n        type: \"POST\",\r\n        url: \"/Home/SearchAlbum\",\r\n        data: JSON.stringify(data),\r\n        success: function (responseData) {\r\n            debugger;\r\n            function writeTable() {\r\n                var html = ''\r\n                for (var i = 0; i &lt; responseData; i++)\r\n                    html += '&lt;tr&gt;';\r\n                for (var j = 0; j &lt; totalCells; j++) {\r\n                    html += '&lt;td&gt;' + array[count] + '&lt;/td&gt;';\r\n                    count++;\r\n                }\r\n                html += '&lt;/tr&gt;';\r\n            }\r\n            \r\n            $('#body').append(html);\r\n            \r\n            count = 0;\r\n            \r\n        },\r\n                 contentType: \"application/json; charset=utf-8\",\r\n   })</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>table {\r\n    width: 100%\r\n}\r\n\r\ntable, th, td {\r\n    border: 1px solid black;\r\n    border-collapse: collapse;\r\n}\r\n\r\nth, td {\r\n    padding: 5px;\r\n    text-align: left;\r\n}\r\n\r\ntable#artistName tr:nth-child(even) {\r\n    background-color: aquamarine\r\n}\r\n\r\ntable#artistName tr:nth-child(odd) {\r\n    background-color: aquamarine\r\n}\r\n\r\ntable#artistName th {\r\n    background-color: black;\r\n    color: white;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\"&gt;&lt;/script&gt;\r\n&lt;div class=\"jumbotron\"&gt;\r\n   &lt;p&gt; Enter Artist Name:&lt;/p&gt;\r\n   &lt;input id=\"artistName\" type=\"text\" /&gt;\r\n   &lt;button id=\"seachButton\" onclick=\"searchClicked()\"&gt;seach&lt;/button&gt;\r\n &lt;/div&gt;\r\n\r\n\r\n&lt;table id=\"ALbumInfo\"&gt;\r\n  &lt;thead&gt;\r\n     &lt;tr&gt;\r\n      &lt;th&gt;Album Name &lt;/th&gt;\r\n      &lt;th&gt;Release Date&lt;/th&gt;\r\n      &lt;th&gt;Popularity&lt;/th&gt;\r\n      &lt;th&gt;Number of Tracks&lt;/th&gt;\r\n     &lt;/tr&gt;\r\n  &lt;/thead&gt;\r\n  &lt;tbody&gt;&lt;/tbody&gt;\r\n&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I Really want to understand whats going wrong here.</p>\n"}, {"tags": ["c#", "wpf", "binding"], "comments": [{"owner": {"reputation": 5634, "user_id": 4601149, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/x0fdS.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4601149/dan"}, "edited": false, "score": 0, "creation_date": 1533750322, "post_id": 51752608, "comment_id": 90465221, "body": "For some reason, at least on my PC, the image is not being added correctly. I have tried twice but the image will not render in the question. Hopefully this is a server glitch and it will be rendered eventually. In the meantime just press on the link"}, {"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 0, "creation_date": 1533750977, "post_id": 51752608, "comment_id": 90465570, "body": "I think you need to call <code>RaisePropertyChanged(TotalTime);</code> this way, passing the <code>Property</code> name?"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 2, "creation_date": 1533751054, "post_id": 51752608, "comment_id": 90465614, "body": "@Sach <code>CallerMemberName</code> takes care of that"}, {"owner": {"reputation": 9311, "user_id": 302248, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3bc412e2217f6ffc8c78a34ee34e1de?s=128&d=identicon&r=PG", "display_name": "Sach", "link": "https://stackoverflow.com/users/302248/sach"}, "edited": false, "score": 0, "creation_date": 1533751070, "post_id": 51752608, "comment_id": 90465621, "body": "I see, didn&#39;t know about that."}], "answers": [{"comments": [{"owner": {"reputation": 5634, "user_id": 4601149, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/x0fdS.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4601149/dan"}, "edited": false, "score": 0, "creation_date": 1533751381, "post_id": 51752919, "comment_id": 90465792, "body": "Okay. But by taking that approach, how would I factor in the other text boxes?"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 5634, "user_id": 4601149, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/x0fdS.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4601149/dan"}, "edited": false, "score": 0, "creation_date": 1533751507, "post_id": 51752919, "comment_id": 90465858, "body": "@Dan That&#39;s why it would probably need to be a multi-value converter. The common alternative would be to throw a DP on the converter that always holds the full time so it can be modified appropriately."}, {"owner": {"reputation": 5634, "user_id": 4601149, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/x0fdS.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4601149/dan"}, "edited": false, "score": 0, "creation_date": 1533751797, "post_id": 51752919, "comment_id": 90466011, "body": "Sorry I meant if <code>TimeSecondsConverter</code> was a multi-value converter, how would I link it to the other text boxes using the line <code>Text=&quot;{Binding TotalTime, Converter={StaticResource TimeSecondsConverter}&quot;</code>? That is why I used xml tags to do the binding instead of it being all in line like that"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 5634, "user_id": 4601149, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/x0fdS.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4601149/dan"}, "edited": false, "score": 1, "creation_date": 1533751865, "post_id": 51752919, "comment_id": 90466049, "body": "@Dan oh, sorry. In the multi-value case you have to do the full tags as you had it."}, {"owner": {"reputation": 5634, "user_id": 4601149, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/x0fdS.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4601149/dan"}, "edited": false, "score": 0, "creation_date": 1533751954, "post_id": 51752919, "comment_id": 90466097, "body": "Okay. So basically instead of having one converter, I would need 5 (one for each box) to achieve what I want to do?"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "reply_to_user": {"reputation": 5634, "user_id": 4601149, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/x0fdS.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4601149/dan"}, "edited": false, "score": 1, "creation_date": 1533751988, "post_id": 51752919, "comment_id": 90466118, "body": "@Dan That&#39;s right. You need to explicitly bind each box."}, {"owner": {"reputation": 5634, "user_id": 4601149, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/x0fdS.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4601149/dan"}, "edited": false, "score": 0, "creation_date": 1533754753, "post_id": 51752919, "comment_id": 90467480, "body": "Thanks for the help"}], "tags": [], "owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "is_accepted": true, "score": 1, "last_activity_date": 1533751033, "creation_date": 1533751033, "answer_id": 51752919, "question_id": 51752608, "link": "https://stackoverflow.com/questions/51752608/update-text-boxes-when-a-propertys-value-changes-wpf/51752919#51752919", "title": "Update text boxes when a property&#39;s value changes - WPF", "body": "<p>This isn't really what a converter is for.</p>\n\n<p>Converters take a set of view model values and convert them to view values for display. Then if the <em>view values</em> change it can convert them back to view model values.</p>\n\n<p>In your case, the view model value is updated through code (not through a change to the view) and so the converter has no reason to run the <code>ConvertBack</code> method (the value is already a view model value!). This is one of several reasons why converters <em>should not have side-effects</em>.</p>\n\n<p>The correct way to do this would be to have <code>TotalTime</code> as a property on the VM (probably as a number or <code>TimeSpan</code> and not a string as you have it) and then do individual converters for each of the pieces. For example:</p>\n\n<pre><code> &lt;TextBox Text=\"{Binding TotalTime, Converter={StaticResource TimeSecondsConverter}\"/&gt;\n</code></pre>\n\n<p>The main text box would then just be bound to <code>TotalTime</code>. <code>TimeSecondsConverter</code> would probably need to be a multi-value converter in order for <code>ConvertBack</code> to work.</p>\n"}], "owner": {"reputation": 5634, "user_id": 4601149, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/x0fdS.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/4601149/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 51752919, "answer_count": 1, "score": 2, "last_activity_date": 1533751033, "creation_date": 1533749949, "last_edit_date": 1533750339, "question_id": 51752608, "link": "https://stackoverflow.com/questions/51752608/update-text-boxes-when-a-propertys-value-changes-wpf", "title": "Update text boxes when a property&#39;s value changes - WPF", "body": "<p><em>The context of this example is there are four text boxes that hold a total amount of time. 1 for hours, 1 for minutes, 1 for seconds, and 1 for milliseconds.</em></p>\n\n<p><em>There is a fifth text box that holds the total time in just milliseconds. This can be seen in the image below.</em></p>\n\n<hr>\n\n<p>I have made an implementation of <code>IMultiValueConverter</code> that should convert 4 <code>TextBox</code> components and the converted value in a property. It should also be able to update the 4 boxes when the property's value changes.</p>\n\n<p>When the user types in the text box that holds the converted output and then that box loses focus, the other 4 text boxes are updated. However, when the property's value is programmatically changed, in this case by a button click, the values in the 4 text boxes are not updated.</p>\n\n<p>How can I make these 4 text boxes update through the converter?</p>\n\n<p>The ultimate goal, in this example, is to store the total time (in milliseconds) in a property and have 5 text boxes updating through bindings when that property is updated.</p>\n\n<p>This is the code for the converter.</p>\n\n<pre><code>using System;\nusing System.Globalization;\nusing System.Windows.Data;\n\nnamespace MultiBinding_Example\n{\n    public class MultiDoubleToStringConverter : IMultiValueConverter\n    {\n        private const double HOURS_TO_MILLISECONDS = 3600000;\n        private const double MINUTES_TO_MILLISECONDS = 60000;\n        private const double SECONDS_TO_MILLISECONDS = 1000;\n        private const string ZERO_STRING = \"0\";\n        private object valBuffer = null;\n\n        /*\n         * values[0] is the variable from the view model\n         * values[1] is hours\n         * values[2] is the remaining whole minutes\n         * values[3] is the remaining whole seconds\n         * values[4] is the remaining whole milliseconds rounded to the nearest millisecond\n         */\n\n        public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)\n        {\n            object returnVal = ZERO_STRING;\n            try\n            {\n                if (values != null)\n                {\n                    double hoursToMilliseconds = (values[1] == null || values[1].ToString() == string.Empty) ? 0 : System.Convert.ToDouble(values[1]) * HOURS_TO_MILLISECONDS;\n                    double minutesToMilliseconds = (values[2] == null || values[2].ToString() == string.Empty) ? 0 : System.Convert.ToDouble(values[2]) * MINUTES_TO_MILLISECONDS;\n                    double secondsToMilliseconds = (values[3] == null || values[3].ToString() == string.Empty) ? 0 : System.Convert.ToDouble(values[3]) * SECONDS_TO_MILLISECONDS;\n                    double totalTime = ((values[4] == null || values[4].ToString() == string.Empty) ? 0 : System.Convert.ToDouble(values[4])) + secondsToMilliseconds + minutesToMilliseconds + hoursToMilliseconds;\n                    returnVal = totalTime.ToString();\n\n                    if (values[0] == valBuffer)\n                    {\n                        values[0] = returnVal;\n                    }\n                    else\n                    {\n                        valBuffer = returnVal = values[0];\n                        ConvertBack(returnVal, new Type[] { typeof(string), typeof(string), typeof(string), typeof(string), typeof(string) }, parameter, culture);\n                    }\n                }\n            }\n            catch (FormatException) { }\n\n            return returnVal;\n        }\n\n        public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)\n        {\n            try\n            {\n                if (value != null &amp;&amp; value.ToString() != string.Empty)\n                {\n                    double timeInMilliseconds = System.Convert.ToDouble(value);\n\n                    object[] timeValues = new object[5];\n                    timeValues[0] = value;\n                    timeValues[1] = Math.Floor(timeInMilliseconds / HOURS_TO_MILLISECONDS).ToString();\n                    timeValues[2] = Math.Floor((timeInMilliseconds % HOURS_TO_MILLISECONDS) / MINUTES_TO_MILLISECONDS).ToString();\n                    timeValues[3] = Math.Floor((timeInMilliseconds % MINUTES_TO_MILLISECONDS) / SECONDS_TO_MILLISECONDS).ToString();\n                    timeValues[4] = Math.Round(timeInMilliseconds % SECONDS_TO_MILLISECONDS, MidpointRounding.AwayFromZero).ToString();\n                    return timeValues;\n                }\n            }\n            catch (FormatException) { }\n\n            return new object[] { ZERO_STRING, ZERO_STRING, ZERO_STRING, ZERO_STRING, ZERO_STRING };\n        }\n    }\n}\n</code></pre>\n\n<p>To test this, I have a quite a simple layout that consists of a few <code>Label</code> components, a few <code>TextBox</code> components and a <code>Button</code>.</p>\n\n<p>It looks like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ieoVA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ieoVA.png\" alt=\"enter image description here\"></a></p>\n\n<p>The XAML for it is the following.</p>\n\n<pre><code>&lt;Window x:Class=\"MultiBinding_Example.MainWindow\"\n        xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n        xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n        xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n        xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n        xmlns:local=\"clr-namespace:MultiBinding_Example\"\n        mc:Ignorable=\"d\"\n        Title=\"MainWindow\" Height=\"450\" Width=\"800\"&gt;\n    &lt;Window.Resources&gt;\n        &lt;local:MultiDoubleToStringConverter x:Key=\"multiDoubleToStringConverter\"/&gt;\n    &lt;/Window.Resources&gt;\n    &lt;StackPanel&gt;\n        &lt;Label Content=\"Multi Value Converter\" HorizontalAlignment=\"Center\" FontSize=\"35\" FontWeight=\"Bold\" Margin=\"0, 25, 0, 0\"/&gt;\n        &lt;Label Content=\"Formatted Total Time\" FontWeight=\"Bold\" FontSize=\"24\" Margin=\"20, 10\"/&gt;\n        &lt;Grid Margin=\"80, 10\"&gt;\n            &lt;Grid.ColumnDefinitions&gt;\n                &lt;ColumnDefinition Width=\"*\"/&gt;\n                &lt;ColumnDefinition Width=\"auto\"/&gt;\n                &lt;ColumnDefinition Width=\"*\"/&gt;\n                &lt;ColumnDefinition Width=\"auto\"/&gt;\n                &lt;ColumnDefinition Width=\"*\"/&gt;\n                &lt;ColumnDefinition Width=\"auto\"/&gt;\n                &lt;ColumnDefinition Width=\"*\"/&gt;\n                &lt;ColumnDefinition Width=\"auto\"/&gt;\n            &lt;/Grid.ColumnDefinitions&gt;\n            &lt;TextBox Name=\"Hours\" HorizontalContentAlignment=\"Right\" VerticalContentAlignment=\"Center\" Text=\"0\"  Grid.Column=\"0\"/&gt;\n            &lt;Label Content=\"Hours\" Grid.Column=\"1\" Margin=\"0, 0, 15, 0\"/&gt;\n\n            &lt;TextBox Name=\"Minutes\" HorizontalContentAlignment=\"Right\" VerticalContentAlignment=\"Center\" Text=\"0\" Grid.Column=\"2\"/&gt;\n            &lt;Label Content=\"Minutes\" Grid.Column=\"3\" Margin=\"0, 0, 15, 0\"/&gt;\n\n            &lt;TextBox Name=\"Seconds\" HorizontalContentAlignment=\"Right\" VerticalContentAlignment=\"Center\" Text=\"0\" Grid.Column=\"4\"/&gt;\n            &lt;Label Content=\"Seconds\" Grid.Column=\"5\" Margin=\"0, 0, 15, 0\"/&gt;\n\n            &lt;TextBox Name=\"Milliseconds\" HorizontalContentAlignment=\"Right\" VerticalContentAlignment=\"Center\" Text=\"0\" Grid.Column=\"6\"/&gt;\n            &lt;Label Content=\"Milliseconds\" Grid.Column=\"7\"/&gt;\n        &lt;/Grid&gt;\n\n        &lt;Label Content=\"Unformatted Total Time\" FontWeight=\"Bold\" FontSize=\"24\" Margin=\"20, 10\"/&gt;\n        &lt;Grid Margin=\"80, 10\"&gt;\n            &lt;Grid.ColumnDefinitions&gt;\n                &lt;ColumnDefinition Width=\"*\"/&gt;\n                &lt;ColumnDefinition Width=\"auto\"/&gt;\n            &lt;/Grid.ColumnDefinitions&gt;\n            &lt;TextBox HorizontalContentAlignment=\"Right\" VerticalContentAlignment=\"Center\" Grid.Column=\"0\"&gt;\n                &lt;TextBox.Text&gt;\n                    &lt;MultiBinding Converter=\"{StaticResource multiDoubleToStringConverter}\" Mode=\"TwoWay\"&gt;\n                        &lt;Binding Path=\"TotalTime\"/&gt;\n                        &lt;Binding ElementName=\"Hours\" Path=\"Text\"/&gt;\n                        &lt;Binding ElementName=\"Minutes\" Path=\"Text\"/&gt;\n                        &lt;Binding ElementName=\"Seconds\" Path=\"Text\"/&gt;\n                        &lt;Binding ElementName=\"Milliseconds\" Path=\"Text\"/&gt;\n                    &lt;/MultiBinding&gt;\n                &lt;/TextBox.Text&gt;\n            &lt;/TextBox&gt;\n            &lt;Label Content=\"Milliseconds\" Grid.Column=\"1\"/&gt;\n        &lt;/Grid&gt;\n        &lt;Button Grid.Column=\"1\" Margin=\"250, 20\" Height=\"50\" Content=\"Random Total Milliseconds\" Click=\"RandomTime_Click\"/&gt;\n    &lt;/StackPanel&gt;\n&lt;/Window&gt;\n</code></pre>\n\n<p>The code behind is the following.</p>\n\n<pre><code>using System;\nusing System.ComponentModel;\nusing System.Runtime.CompilerServices;\nusing System.Windows;\n\nnamespace MultiBinding_Example\n{\n    public partial class MainWindow : Window, INotifyPropertyChanged\n    {\n        public event PropertyChangedEventHandler PropertyChanged;\n        private Random random = new Random();\n\n        private string totalTime;\n        public string TotalTime {\n            get =&gt; totalTime;\n            set {\n                totalTime = value;\n                RaisePropertyChanged();\n            }\n        }\n\n        public MainWindow()\n        {\n            InitializeComponent();\n            DataContext = this;\n            UpdateTotalTime();\n        }\n\n        private void RaisePropertyChanged([CallerMemberName] string propertyName = null)\n        {\n            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));\n        }\n\n        private void RandomTime_Click(object sender, RoutedEventArgs e)\n        {\n            UpdateTotalTime();\n        }\n\n        private void UpdateTotalTime()\n        {\n            double percent = random.NextDouble();\n            double time = Math.Floor(percent * random.Next(1000, 100000000));\n            TotalTime = time.ToString();\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "rest", "web-services", "asp.net-web-api"], "answers": [{"comments": [{"owner": {"reputation": 2052, "user_id": 899471, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/q0762.jpg?s=128&g=1", "display_name": "Gary O. Stenstrom", "link": "https://stackoverflow.com/users/899471/gary-o-stenstrom"}, "edited": false, "score": 0, "creation_date": 1533752735, "post_id": 51753163, "comment_id": 90466521, "body": "Nailed it. If you could post this an answer I will accept it. I don&#39;t really want to expose that field for public edit, but this answered the question. Thanks!"}, {"owner": {"reputation": 71, "user_id": 8365453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/915ee3d96e953c1837c690b10605bac7?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Mielczarek", "link": "https://stackoverflow.com/users/8365453/micha%c5%82-mielczarek"}, "reply_to_user": {"reputation": 2052, "user_id": 899471, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/q0762.jpg?s=128&g=1", "display_name": "Gary O. Stenstrom", "link": "https://stackoverflow.com/users/899471/gary-o-stenstrom"}, "edited": false, "score": 0, "creation_date": 1533753671, "post_id": 51753163, "comment_id": 90467013, "body": "Soo, you can also create a constructor with this parameters, and not expose setters for public. It sounds like an immutable object,"}, {"owner": {"reputation": 2052, "user_id": 899471, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/q0762.jpg?s=128&g=1", "display_name": "Gary O. Stenstrom", "link": "https://stackoverflow.com/users/899471/gary-o-stenstrom"}, "edited": false, "score": 0, "creation_date": 1533755383, "post_id": 51753163, "comment_id": 90467745, "body": "The object is originally created by a Domain Component with data coming from from the data base and is passed to a web page via a web svc request. A user makes makes modifications to public properties such ad Name (ID is not one of them) via the web form. The form submits the change back to the web service. It&#39;s this submit back where it loses the ID. So the OBJECT is not immutable but some properties on it should not be able to be modified."}, {"owner": {"reputation": 2052, "user_id": 899471, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/q0762.jpg?s=128&g=1", "display_name": "Gary O. Stenstrom", "link": "https://stackoverflow.com/users/899471/gary-o-stenstrom"}, "edited": false, "score": 0, "creation_date": 1533755526, "post_id": 51753163, "comment_id": 90467808, "body": "Also, the complete object has about 30 properties of which about 5 are internal. I&#39;d rather not pass 20+ properties through a query string nor do I want to, If I don&#39;t have to, create a specific data transfer object to pass all that back and forth."}], "tags": [], "owner": {"reputation": 71, "user_id": 8365453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/915ee3d96e953c1837c690b10605bac7?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Mielczarek", "link": "https://stackoverflow.com/users/8365453/micha%c5%82-mielczarek"}, "is_accepted": true, "score": 3, "last_activity_date": 1533752005, "creation_date": 1533752005, "answer_id": 51753163, "question_id": 51752574, "link": "https://stackoverflow.com/questions/51752574/post-guid-to-webapi-received-as-null/51753163#51753163", "title": "POST Guid to WebAPI received as NULL", "body": "<p>Are you sure that String name has value passed in json ? \nI think that public api like yours TransferObject should not have internal properties (and internal setter or getter) if you want to deserialize that with JsonSerializer. JsonSerializer is external .dll and has no access to your setter.</p>\n\n<p>Let's try with public setter. </p>\n"}], "owner": {"reputation": 2052, "user_id": 899471, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/q0762.jpg?s=128&g=1", "display_name": "Gary O. Stenstrom", "link": "https://stackoverflow.com/users/899471/gary-o-stenstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 51753163, "answer_count": 1, "score": 0, "last_activity_date": 1533752005, "creation_date": 1533749789, "question_id": 51752574, "link": "https://stackoverflow.com/questions/51752574/post-guid-to-webapi-received-as-null", "title": "POST Guid to WebAPI received as NULL", "body": "<p>I am posting an object as JSON to a WebAPI service written in C#. One of the properties is a Guid? (nullable). Even when it's populated however it's being received as a NULL.</p>\n\n<p>To illustrate the issue, I have a C# object.</p>\n\n<pre><code>public class TransferObject\n{\n    public String Name { get; internal set; }\n\n    public Guid? ID { get; internal set; }\n}\n</code></pre>\n\n<p>The JSON being sent to the WebService looks like ..</p>\n\n<pre><code>{\n    \"Name\":\"Robert Smith\",\n    \"ID\": \"5bcf697c-5db1-4ae8-be28-5f6c4c972fcd\"\n}\n</code></pre>\n\n<p>And the web service method looks like ...</p>\n\n<pre><code>[HttpPost]\npublic HttpResponse SaveName([FromBody] TransferObject model)\n{\n    Guid modelID = model.ID; // returns null\n    String name = model.Name // \"Robert Smith\"\n}\n</code></pre>\n\n<p>The Name is being populated correctly. Anyone have any ideas why the Guid is being \"nullified\" in the <strong>model</strong> argument?</p>\n"}, {"tags": ["c#", "uwp"], "comments": [{"owner": {"reputation": 1299, "user_id": 5704347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bc37b9e462bbc6755257f8621686442?s=128&d=identicon&r=PG&f=1", "display_name": "Goodies", "link": "https://stackoverflow.com/users/5704347/goodies"}, "edited": false, "score": 2, "creation_date": 1533751460, "post_id": 51752517, "comment_id": 90465837, "body": "There was a topic about this a few weeks ago <a href=\"https://stackoverflow.com/questions/47339719/how-to-disable-uwp-app-suspension\" title=\"how to disable uwp app suspension\">stackoverflow.com/questions/47339719/&hellip;</a> it turns you can tell the linker that youw uwp app is only intended for PC/Windows. In that mode, it is possible to circumvent it see <a href=\"https://blogs.msdn.microsoft.com/mvpawardprogram/2018/01/30/non-suspending-uwp-desktop-apps/#comment-130715\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/mvpawardprogram/2018/01/30/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 730, "user_id": 6870937, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1aad76c09b289b27f9b5a0eff0bd159c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmar", "link": "https://stackoverflow.com/users/6870937/ahmar"}, "edited": false, "score": 0, "creation_date": 1533797610, "post_id": 51753869, "comment_id": 90480144, "body": "I think you did not quite understand my question, I use <code>HttpClient</code> to get the ID of the video or the URL. I do not download the entire video with <code>HttpClient</code>. Is <code>BackgroundTransfer</code> still applicable for such short fetching operations?"}, {"owner": {"reputation": 730, "user_id": 6870937, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1aad76c09b289b27f9b5a0eff0bd159c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmar", "link": "https://stackoverflow.com/users/6870937/ahmar"}, "edited": false, "score": 0, "creation_date": 1533870997, "post_id": 51753869, "comment_id": 90514840, "body": "As a matter of fact, no <code>await</code> function runs if the app is minimized. It waits for the app to come to foreground and then continues, otherwise it&#39;s kind of paused. So I decided to use the <code>Task.Result</code> method since the user is not using the app I can get the results for async methods without blocking the app UI."}], "tags": [], "owner": {"reputation": 21144, "user_id": 4068779, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r0Hsj.png?s=128&g=1", "display_name": "Rob Caplan - MSFT", "link": "https://stackoverflow.com/users/4068779/rob-caplan-msft"}, "is_accepted": false, "score": 1, "last_activity_date": 1533754652, "creation_date": 1533754652, "answer_id": 51753869, "question_id": 51752517, "link": "https://stackoverflow.com/questions/51752517/httpclient-not-executing-getasync-in-minimized-uwp-app/51753869#51753869", "title": "HttpClient not executing GetAsync in Minimized UWP App", "body": "<p>The <a href=\"https://docs.microsoft.com/en-us/windows/uwp/networking/background-transfers\" rel=\"nofollow noreferrer\">BackgroundTransfer classes</a> are designed specifically to download data in the background even if the app is suspended or closed.</p>\n\n<p>HttpClient is better for very short downloads that will complete quickly. For lengthy downloads such as videos use <a href=\"https://docs.microsoft.com/en-us/uwp/api/Windows.Networking.BackgroundTransfer.BackgroundDownloader\" rel=\"nofollow noreferrer\">Windows.Networking.BackgroundTransfer.BackgroundDownloader</a>. If you need to process the file when the download completes you can use that completion as a trigger for a background task.</p>\n\n<p>See the provided documentation links for overviews and how tos. There is a full sample at <a href=\"https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/BackgroundTransfer\" rel=\"nofollow noreferrer\">https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/BackgroundTransfer</a> </p>\n"}, {"tags": [], "owner": {"reputation": 730, "user_id": 6870937, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1aad76c09b289b27f9b5a0eff0bd159c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmar", "link": "https://stackoverflow.com/users/6870937/ahmar"}, "is_accepted": true, "score": 0, "last_activity_date": 1533872358, "creation_date": 1533872358, "answer_id": 51778605, "question_id": 51752517, "link": "https://stackoverflow.com/questions/51752517/httpclient-not-executing-getasync-in-minimized-uwp-app/51778605#51778605", "title": "HttpClient not executing GetAsync in Minimized UWP App", "body": "<p>So I decided to write my own answer here because I am not really sure if someone else might get to this issue. One thing that I suspect is that I recently updated C# Language to v7.3 because VS 2017 said so while writing some code. Maybe the issue is related to that but so far my solution works in the minimized state.</p>\n\n<p>I also want to state here that I implemented <code>BackgroundTask</code> first to overcome this problem using <code>ApplicationTrigger</code> to trigger the process when needed but it was kind of a hack honestly. Have a look at the code:</p>\n\n<pre><code>public static async Task&lt;string&gt; GetBackgroundTaskReturnValue(string apiRequestUrl)\n{\n        StaticItemsHelper.IsBackgroundPlaylistTaskRunning = true;\n        if (StaticItemsHelper.IsBackgroundPlaylistTaskRunning)\n        {\n            for (int seconds = 0; seconds &lt; 20;)\n            {\n                if (!StaticItemsHelper.IsBackgroundPlaylistTaskRunning)\n                {\n                    break;\n                }\n                else\n                {\n                    Task.Delay(1000).Wait();\n                }\n            }\n        }\n        var request = BackgroundTaskHelper.BackgroundPlaylistTrigger.RequestAsync().GetResults();\n        if (request == Windows.ApplicationModel.Background.ApplicationTriggerResult.Allowed)\n        {\n            SettingsHelper.localSettings.Values[SettingsHelper.BackgroundPlaylistPlaybackURLKey] = apiRequestUrl;\n            SettingsHelper.localSettings.Values[SettingsHelper.BackgroundPlaylistPlaybackTokenKey] = StaticItemsHelper.CurrentUserAccessToken;\n            if (SettingsHelper.tempFolder.TryGetItemAsync(SettingsHelper.BackgroundPlaylistPlaybackReturnKey).GetResults() is StorageFile file)\n            {\n                await file.DeleteAsync();\n            }\n            for (int seconds = 0; seconds &lt; 30;)\n            {\n                if (SettingsHelper.tempFolder.TryGetItemAsync(SettingsHelper.BackgroundPlaylistPlaybackReturnKey).GetResults() is StorageFile _rfile)\n                {\n                    var _returnVal = FileIO.ReadTextAsync(_rfile).GetResults();\n                    if (!string.IsNullOrEmpty(_returnVal.ToString()))\n                    {\n                        await _rfile.DeleteAsync();\n                        SettingsHelper.localSettings.Values.Remove(SettingsHelper.BackgroundPlaylistPlaybackTokenKey);\n                        SettingsHelper.localSettings.Values.Remove(SettingsHelper.BackgroundPlaylistPlaybackURLKey);\n                        StaticItemsHelper.IsBackgroundPlaylistTaskRunning = false;\n                        return _returnVal;\n                    }\n                }\n                Task.Delay(2000).Wait();\n                seconds += 2;\n            }\n        }\n        else if (request == Windows.ApplicationModel.Background.ApplicationTriggerResult.CurrentlyRunning)\n        {\n            for (int seconds = 0; seconds &lt; 30;)\n            {\n                Task.Delay(2000).Wait();\n                seconds += 2;\n                request = BackgroundTaskHelper.BackgroundPlaylistTrigger.RequestAsync().GetResults();\n                if (request == Windows.ApplicationModel.Background.ApplicationTriggerResult.Allowed)\n                {\n                    return GetBackgroundTaskReturnValue(apiRequestUrl).Result;\n                }\n            }\n        }\n        if (SettingsHelper.tempFolder.TryGetItemAsync(SettingsHelper.BackgroundPlaylistPlaybackReturnKey).GetResults() is StorageFile _file)\n        {\n            await _file.DeleteAsync();\n        }\n        SettingsHelper.localSettings.Values.Remove(SettingsHelper.BackgroundPlaylistPlaybackTokenKey);\n        SettingsHelper.localSettings.Values.Remove(SettingsHelper.BackgroundPlaylistPlaybackURLKey);\n        StaticItemsHelper.IsBackgroundPlaylistTaskRunning = false;\n        return \"{ \\\"error\\\": {\\\"code\\\": \\\"NetworkError\\\", \\\"message\\\": \\\"Server returned nothing.\\\"} }\";\n}\n</code></pre>\n\n<p><strong>Actual Solution:</strong>\nBut then it was also not working as I expected so I decided to drop it and used the following code instead. (Compare this with the question)</p>\n\n<pre><code>public static async Task&lt;string&gt; GetResponseDataFromAPI(string apiRequestUrl, CancellationTokenSource cts = default)\n{\n        cts = cts ?? new CancellationTokenSource(TimeSpan.FromSeconds(20));\n        try\n        {\n            if (StaticItemsHelper.IsAppInBackground)\n            {\n                //return await ViewHelper.GetBackgroundTaskReturnValue(apiRequestUrl);\n                var responseData = AuthRequestHelper.globalHttpClient.GetAsync(apiRequestUrl, cts.Token).Result;\n                var result = responseData.Content.ReadAsStringAsync().Result;\n                return result;\n            }\n            else\n            {\n                var responseData = await AuthRequestHelper.globalHttpClient.GetAsync(apiRequestUrl, cts.Token);\n                var result = await responseData.Content.ReadAsStringAsync();\n                return result;\n            }\n        }\n        catch (Exception ex)\n        {\n            INotifyHelper.iNotifyObject.IsDataLoading = false;\n            // show error\n            return \"{ \\\"error\\\": {\\\"code\\\": \" + $\"\\\"{ex.HResult}\\\", \\\"message\\\": \\\"{ex.Message}\\\"\" + \"} }\";\n        }\n}\n</code></pre>\n\n<p>Hopefully, this helps someone else. </p>\n"}], "owner": {"reputation": 730, "user_id": 6870937, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1aad76c09b289b27f9b5a0eff0bd159c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmar", "link": "https://stackoverflow.com/users/6870937/ahmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 51778605, "answer_count": 2, "score": 1, "last_activity_date": 1533872358, "creation_date": 1533749567, "last_edit_date": 1533750555, "question_id": 51752517, "link": "https://stackoverflow.com/questions/51752517/httpclient-not-executing-getasync-in-minimized-uwp-app", "title": "HttpClient not executing GetAsync in Minimized UWP App", "body": "<p>I am working on a project where I play a couple of videos. To be able to play those videos I need to fetch their data when requested by the app through <code>HttpClient</code> from <code>System.Net.Http</code>. Everything works normally and the UWP app downloads required information from Internet when the app is in foreground.</p>\n\n<p>As soon as the app leaves foreground and gets minimized by user the <code>HttpClient</code>, whether it's from <code>System.Net.Http</code> namesoace or <code>Windows.Web.Http</code> namespace, does not work. I have even tried to set a breakpoint there and as soon as I move forward <code>HttpClient</code> does not respond to the <code>await client.GetAsync()</code> method and stays there without returning any result unless you activate the app again and then it returns any value. I cant use <code>BackgroundTasks</code> because they need <code>Triggers</code> but I need to access data on demand.</p>\n\n<p>I have also read <a href=\"https://msdn.microsoft.com/en-us/magazine/mt590969.aspx\" rel=\"nofollow noreferrer\">this</a> article describing to request <code>ExtendedExecutionState</code> but the result is still the same. I request this state when the app gets a request to play a list of items. Even after getting the result as <code>Allowed</code>, the <code>HttpClient</code> has the same behavior as above.</p>\n\n<p>Is there any method that can execute internet related queries when requested and get some information?</p>\n\n<p>The code that I execute to access data from internet is:</p>\n\n<pre><code>public static async Task&lt;string&gt; GetResponseDataFromAPI(string apiRequestUrl, CancellationTokenSource cts = default)\n{\n    cts = cts ?? new CancellationTokenSource(TimeSpan.FromSeconds(20));\n    try\n    {\n        var responseData = await AuthRequestHelper.globalHttpClient.GetAsync(apiRequestUrl, cts.Token);\n        var result = await responseData.Content.ReadAsStringAsync();\n        return result;\n    }\n    catch (Exception ex)\n    {\n        INotifyHelper.iNotifyObject.IsVideoLoading = false;\n        INotifyHelper.iNotifyObject.IsDataLoading = false;\n        // show error\n        return \"{ \\\"error\\\": {\\\"code\\\": \" + $\"\\\"{ex.HResult}\\\", \\\"message\\\": \\\"{ex.Message}\\\"\" + \"} }\";\n    }\n}\n</code></pre>\n\n<p>The returned value is then analyzed to get required data from it.</p>\n\n<p>The code that is executed to request <code>ExtendedExecutionSession</code> is:</p>\n\n<pre><code>public static async void RequestBackgroundExtendedExecution()\n{\n    using (var session = new ExtendedExecutionSession())\n    {\n        session.Reason = ExtendedExecutionReason.Unspecified;\n        session.Description = \"Background Playlist Playback\";\n        session.Revoked += Session_Revoked;\n        if (await session.RequestExtensionAsync() is ExtendedExecutionResult result)\n        {\n            if (result == ExtendedExecutionResult.Denied)\n            {\n                // show user that background playlist playback will not be possible\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Is there anything that can be done to execute the requested operations while in minimized state? A little help to point in the right direction will be much appreciated. Thanks</p>\n"}, {"tags": ["c#", "exception", "encoding", "exception-handling"], "comments": [{"owner": {"reputation": 1068, "user_id": 1738861, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/42bf2a56cdbe10ddc283fc7aa76e8300?s=128&d=identicon&r=PG", "display_name": "Adam Mrozek", "link": "https://stackoverflow.com/users/1738861/adam-mrozek"}, "reply_to_user": {"reputation": 314912, "user_id": 73070, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d54ed51c0f03cb461741c3ec77a837b2?s=128&d=identicon&r=PG", "display_name": "Joey", "link": "https://stackoverflow.com/users/73070/joey"}, "edited": false, "score": 0, "creation_date": 1533750675, "post_id": 51752509, "comment_id": 90465395, "body": "@Joey I know I can simply replace that characters, the problem is I cannot recognize characters to replace. Of course I can use Regex [a-zA-Z0-9] but message will be very unclear in that case."}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1533802099, "post_id": 51752509, "comment_id": 90482610, "body": "Where/how do you inspect that string when you see the odd characters? I ask because the string itself may be completely fine, but the transport to you, like say through a http request, or a log file, or something like this may mess this up."}, {"owner": {"reputation": 314912, "user_id": 73070, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d54ed51c0f03cb461741c3ec77a837b2?s=128&d=identicon&r=PG", "display_name": "Joey", "link": "https://stackoverflow.com/users/73070/joey"}, "reply_to_user": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1533802256, "post_id": 51752509, "comment_id": 90482726, "body": "@LasseV&#229;gs&#230;therKarlsen: I&#39;d strongly guess that the exception message has been taken (and parsed) from the connection to Postgres itself and thus it&#39;s the connector that mangles it because the encoding isn&#39;t the same that the database server uses."}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1533803081, "post_id": 51752509, "comment_id": 90483209, "body": "If the string is like that in the exception, then yes, it&#39;s the building of the exception and where/how that code gets the string that is faulty."}], "answers": [{"tags": [], "owner": {"reputation": 314912, "user_id": 73070, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d54ed51c0f03cb461741c3ec77a837b2?s=128&d=identicon&r=PG", "display_name": "Joey", "link": "https://stackoverflow.com/users/73070/joey"}, "is_accepted": false, "score": 0, "last_activity_date": 1533819145, "last_edit_date": 1533819145, "creation_date": 1533801381, "answer_id": 51761645, "question_id": 51752509, "link": "https://stackoverflow.com/questions/51752509/c-exception-wrong-encoding/51761645#51761645", "title": "C# exception wrong encoding", "body": "<p>As a workaround you can try replacing the offending characters. \ufffd is U+FFFD Replacement Character, so the following should suffice:</p>\n\n<pre><code>var cleanedMessage = e.Message.Replace('\ufffd', '?');\n</code></pre>\n\n<p>If your JSON conversion has problems with anything non-ASCII (should not happen, but such problems abound), you could also replace everything beyond ASCII:</p>\n\n<pre><code>var cleanedMessage = Regex.Replace(e.Message, \"[^\\x00-~]\", \"?\");\n</code></pre>\n\n<p>However, fundamentally, if you see those characters, then Npgsql already did something very wrong and the problem should ideally be fixed there.</p>\n\n<p>From looking at the source of that library, it uses <code>connector.Settings.Encoding</code> as the encoding to convert whatever is read from the socket. It defaults to UTF-8, but apparently it's not UTF-8 in your case, otherwise you wouldn't get those replacement characters. Codepage 1250 would be my guess in your case, but perhaps you can just use <code>Encoding.Default</code> to get that.</p>\n"}], "owner": {"reputation": 1068, "user_id": 1738861, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/42bf2a56cdbe10ddc283fc7aa76e8300?s=128&d=identicon&r=PG", "display_name": "Adam Mrozek", "link": "https://stackoverflow.com/users/1738861/adam-mrozek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533819145, "creation_date": 1533749534, "question_id": 51752509, "link": "https://stackoverflow.com/questions/51752509/c-exception-wrong-encoding", "title": "C# exception wrong encoding", "body": "<p>I started working with .net core and I need to open database connection via npgsql. Here is the code:</p>\n\n<pre><code>try\n{\n    await conn.OpenAsync();\n}\ncatch (Exception e)\n{\n    await Utils.ThrowErrorAsync(session, e.Message);\n    return;\n}\n</code></pre>\n\n<p>The problem is that <code>e.Message</code> is in wrong codepage (without diacritics).</p>\n\n<p>There is:</p>\n\n<p><code>28P01: autoryzacja has\ufffdem nie powiod\ufffda si\ufffd dla u\ufffdytkownika postgres</code></p>\n\n<p>but should be (polish):</p>\n\n<p><code>28P01: autoryzacja has\u0142em nie powiod\u0142a si\u0119 dla u\u017cytkownika postgres</code></p>\n\n<p>I cannot change codepage for this exception so there is no way to stringify this error message into JSON and parse back. There is an exception thrown: <code>Unexpected end of JSON input</code>. </p>\n\n<p>So my question is:</p>\n\n<p>1) Is there possible to change CodePage of Exception?</p>\n\n<p>2) Is there a way to remove problematic chars from this string?</p>\n\n<p>Regards</p>\n"}, {"tags": ["c#", "asp.net", "itext"], "answers": [{"comments": [{"owner": {"reputation": 70840, "user_id": 1622493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7S0d.jpg?s=128&g=1", "display_name": "Bruno Lowagie", "link": "https://stackoverflow.com/users/1622493/bruno-lowagie"}, "edited": false, "score": 0, "creation_date": 1533752695, "post_id": 51752968, "comment_id": 90466502, "body": "That is correct, hence the up-vote. Unfortunately, Mike Dotnetting is outdated, because it still talks about iText 5. Starting with iText 7, you don&#39;t need to worry about setting the widths of the columns. In iText 7, the columns adapt their width based on their content."}, {"owner": {"reputation": 1932, "user_id": 3753686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqBQl.jpg?s=128&g=1", "display_name": "Tomato32", "link": "https://stackoverflow.com/users/3753686/tomato32"}, "reply_to_user": {"reputation": 70840, "user_id": 1622493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7S0d.jpg?s=128&g=1", "display_name": "Bruno Lowagie", "link": "https://stackoverflow.com/users/1622493/bruno-lowagie"}, "edited": false, "score": 0, "creation_date": 1533779202, "post_id": 51752968, "comment_id": 90474922, "body": "@BrunoLowagie: Thank you for your suggestions, my friend :))"}], "tags": [], "owner": {"reputation": 1932, "user_id": 3753686, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqBQl.jpg?s=128&g=1", "display_name": "Tomato32", "link": "https://stackoverflow.com/users/3753686/tomato32"}, "is_accepted": false, "score": 1, "last_activity_date": 1533751191, "creation_date": 1533751191, "answer_id": 51752968, "question_id": 51752434, "link": "https://stackoverflow.com/questions/51752434/increase-the-width-of-two-columns-in-pdf-in-c/51752968#51752968", "title": "Increase the width of two columns in PDF in c#", "body": "<p>You should set the width of the columns. And you can do that by applying them to the table object. For example:</p>\n\n<pre><code>float[] widths = new float[] { 1f, 2f }; //relative col widths in proportions - 1/3 and 2/3\ntable.SetWidths(widths);\n</code></pre>\n\n<p>You can visit this link to refer more: <a href=\"https://www.mikesdotnetting.com/article/86/itextsharp-introducing-tables\" rel=\"nofollow noreferrer\">https://www.mikesdotnetting.com/article/86/itextsharp-introducing-tables</a>\nHope to help, my friend!</p>\n"}], "owner": {"reputation": 47, "user_id": 8936439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f12fcaa00e1fc420613bd9b60899de38?s=128&d=identicon&r=PG&f=1", "display_name": "Ann Sara", "link": "https://stackoverflow.com/users/8936439/ann-sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533751191, "creation_date": 1533749287, "question_id": 51752434, "link": "https://stackoverflow.com/questions/51752434/increase-the-width-of-two-columns-in-pdf-in-c", "title": "Increase the width of two columns in PDF in c#", "body": "<p>I am downloading a PDF using Itextsharp .I need to increase the width of two columns in pdf.I have tried using celcols.width ,however its not working.Now all the columns have same width.Any help will be really appreciated.Thanks in Advance`.</p>\n\n<pre><code> protected void Button6_Click(object sender, EventArgs e)\n    {\n        try\n        {\n\n            string fromdate = \"\", todate = \"\";\n            string compgrp = \"All\";\n\n\n            var pdfDoc = new Document(PageSize.A3, 10f, 10f, 10f, 0f);\n            System.IO.MemoryStream mStream = new System.IO.MemoryStream();\n            PdfWriter writer = PdfWriter.GetInstance(pdfDoc, mStream);\n            PdfPageEventHelper pageEventHelper = new PdfPageEventHelper();\n            writer.PageEvent = pageEventHelper;\n            HeaderFooter header = new HeaderFooter(new Phrase(\"Schedule report\" + DateTime.Now.ToString(\"dd/MMM/yyyy hh:mm tt\") + \"\"), false);\n            header.BackgroundColor = new iTextSharp.text.Color(System.Drawing.ColorTranslator.FromHtml(\"#62e456\"));\n            // Remove the border that is set by default  \n            header.Border = iTextSharp.text.Rectangle.TITLE;\n            // Align the text: 0 is left, 1 center and 2 right.  \n            header.Alignment = Element.ALIGN_CENTER;\n            pdfDoc.Header = header;\n            // Header.  \n            pdfDoc.Open();\n            string Connectionstring = ConfigurationManager.ConnectionStrings[\"SPCFConnectionString\"].ConnectionString;\n            SqlConnection cn = new SqlConnection(Connectionstring);\n            cn.Open();\n            try\n            {\n                if (ddl_clntsearch.SelectedValue.ToString() == \"\")\n                {\n                    compgrp = \"All\";\n                }\n                else\n                {\n                    compgrp = ddl_clntsearch.SelectedValue.ToString();\n                }\n                string[] querylist = new string[]\n                     {\n                                 \"exec [SP0480_05] '\" + compgrp +\"','\" + txt_mobnum.Text +\"','\"+txt_searchdate.Text+\"','\" + ddl_status.SelectedValue.ToString() +\"'\",\n\n                     };\n\n                string[] Headers = new string[]\n                     {\n                         \"Date\",\" Name\",\"Shift time\",\"User\",\"Remarks\",\"Amount\",\"Signature\"\n                     };\n\n                foreach (string query in querylist)\n                {\n                    iTextSharp.text.Table pdfTableheader = new iTextSharp.text.Table(7, 1);\n                    pdfTableheader.BorderWidth = 1; pdfTableheader.Width = 100; pdfTableheader.Spacing = 1;\n                    //pdfTableheader.Padding = 1;\n                    foreach (string items in Headers)\n                    {\n                        Cell cellCols = new Cell();\n                        Chunk chunkCols = new Chunk();\n                        cellCols.BackgroundColor = new iTextSharp.text.Color(System.Drawing.ColorTranslator.FromHtml(\"#62e05e\"));\n                        iTextSharp.text.Font ColFont = FontFactory.GetFont(FontFactory.TIMES_ROMAN, 12, iTextSharp.text.Font.BOLD, iTextSharp.text.Color.BLACK);\n                        //if (items == \"Name\")\n                        //{\n                        //    cellCols.Width = 300f;\n                        //}\n                        //else\n                        //{\n                        //    cellCols.Width = 100f;\n                        //}\n                        chunkCols = new Chunk(items, ColFont);\n\n                        cellCols.Add(chunkCols);\n                        pdfTableheader.AddCell(cellCols);\n                    }\n                    pdfDoc.Add(pdfTableheader);\n                    SqlCommand cmd = new SqlCommand(query, cn);\n                    cmd.CommandTimeout = 30;\n                    cmd.CommandType = CommandType.Text;\n                    SqlDataReader dr = cmd.ExecuteReader();\n                    DataTable dataTable = new DataTable();\n                    dataTable.Load(dr);\n                    object[] array = new object[dataTable.Columns.Count];\n\n                    //dataTable.Rows.Add(array);\n                    int cols = dataTable.Columns.Count;\n                    int rows = dataTable.Rows.Count;\n                    iTextSharp.text.Table pdfTable = new iTextSharp.text.Table(cols, rows);\n                    pdfTable.BorderWidth = 1; pdfTable.Width = 100; pdfTable.Spacing = 2;\n                    //pdfTable.Padding = 1; \n\n                    //creating table data (actual result)   \n\n                    for (int k = 0; k &lt;= rows - 1; k++)\n                    {\n                        for (int j = 0; j &lt; cols; j++)\n                        {\n\n\n                            Cell cellRows = new Cell();\n                            //if (k % 2 == 0)\n                            cellRows.BackgroundColor = new iTextSharp.text.Color(System.Drawing.ColorTranslator.FromHtml(\"#ffffff\"));\n\n                            iTextSharp.text.Font RowFont = FontFactory.GetFont(FontFactory.HELVETICA,12);\n                            Chunk chunkRows = new Chunk(dataTable.Rows[k][j].ToString(), RowFont);\n                            cellRows.Add(chunkRows);\n\n                            pdfTable.AddCell(cellRows);\n                        }\n                    }\n\n                    pdfDoc.Add(pdfTable);\n                }\n            }\n            catch (Exception exc)\n            {\n\n            }\n\n            //creating table headers  \n            cn.Close();\n            pdfDoc.Close();\n\n            Response.ContentType = \"application/pdf\";\n            Response.AddHeader(\"Content-Disposition\", string.Format(\"attachment;filename=REF-{0}.pdf\", \"Report\"));\n            Response.BinaryWrite(mStream.ToArray());\n\n\n        }\n        catch (Exception ex)\n        {\n\n        }\n    }\n</code></pre>\n\n<p>Here I need to increase the width of 2nd and 3rd column ie Name and User</p>\n"}, {"tags": ["javascript", "c#", "angularjs", "asp.net-mvc", "routing"], "comments": [{"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 1, "creation_date": 1533749693, "post_id": 51752431, "comment_id": 90464913, "body": "Does not make sense to return a view if you are going to redirect. What is happening with <code>window.location.href = &#39;&#47;Home&#47;PurchaseSuccess&#39;;</code> approach ? It should make the browser to navigate to that url. Check your page has any script errors."}, {"owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 1, "creation_date": 1533750065, "post_id": 51752431, "comment_id": 90465114, "body": "IMHO, why not return a result/JSON data that Angular can handle the UI/routing for? In other words let Angular do the UI (what display and associated data parsed from your server response)."}, {"owner": {"reputation": 83, "user_id": 4905495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c13b52bae8bf6fcfffbc140a240673b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Meservy", "link": "https://stackoverflow.com/users/4905495/andrew-meservy"}, "reply_to_user": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1533751179, "post_id": 51752431, "comment_id": 90465682, "body": "@Shyju It does redirect to the url, but it does not bring the model with it."}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1533751217, "post_id": 51752431, "comment_id": 90465705, "body": "That has nothing to do with the code you shared in the question. You need to see why <code>PurchaseSuccess</code> action method is not returning what it should be. Debug that method"}, {"owner": {"reputation": 83, "user_id": 4905495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c13b52bae8bf6fcfffbc140a240673b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Meservy", "link": "https://stackoverflow.com/users/4905495/andrew-meservy"}, "reply_to_user": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 0, "creation_date": 1533751338, "post_id": 51752431, "comment_id": 90465769, "body": "@EdSF That sounds great, but how do I do that with AngularJS? I have not been able to find any resources on how to redirect with a model in AngularJS. Could you elaborate a little bit more? Thanks!"}, {"owner": {"reputation": 83, "user_id": 4905495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c13b52bae8bf6fcfffbc140a240673b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Meservy", "link": "https://stackoverflow.com/users/4905495/andrew-meservy"}, "reply_to_user": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1533751616, "post_id": 51752431, "comment_id": 90465915, "body": "@Shyju I think we have a misunderstanding. The PurchaseSuccess action method just returns the view as of this moment, but I need it to return the view with the model that is returned as a response from the initial post request. Everything is working as expected, but I am looking for an approach to redirect after the post request with the model. The redirect works without the model, but I need the model to display important information about the order on the purchaseSuccess page. Hope that clarifies the question a little?"}, {"owner": {"reputation": 83, "user_id": 4905495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c13b52bae8bf6fcfffbc140a240673b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Meservy", "link": "https://stackoverflow.com/users/4905495/andrew-meservy"}, "reply_to_user": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1533751793, "post_id": 51752431, "comment_id": 90466009, "body": "@Shyju I have updated the question with those controller methods."}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 2, "creation_date": 1533751806, "post_id": 51752431, "comment_id": 90466018, "body": "You need to query your data and build the (view) model in the <code>PurchaseSuccess</code> action method and pass that to the view to render the desired HTML.  You probably need to return a unique Id from your <code>PlaceOrder</code> method and pass that to your <code>PurchaseSuccess</code> method so that it can get the data."}, {"owner": {"reputation": 5865, "user_id": 884101, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/67f7c5940eff152578a015bacbffa89f?s=128&d=identicon&r=PG", "display_name": "Chetan Ranpariya", "link": "https://stackoverflow.com/users/884101/chetan-ranpariya"}, "edited": false, "score": 1, "creation_date": 1533751865, "post_id": 51752431, "comment_id": 90466048, "body": "Instead of redirecting with model, you should redirect with orderid and in controller action you should get the details of order from database and display in the view."}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 1, "creation_date": 1533751912, "post_id": 51752431, "comment_id": 90466078, "body": "When using libraries like angular/react and doing an ajax post, don&#39;t you want to stay on the same page (so user does not get the feeling of navigating to a different page) ?"}, {"owner": {"reputation": 10219, "user_id": 304683, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/pPt7E.jpg?s=128&g=1", "display_name": "EdSF", "link": "https://stackoverflow.com/users/304683/edsf"}, "edited": false, "score": 1, "creation_date": 1533751961, "post_id": 51752431, "comment_id": 90466103, "body": "Look into <a href=\"https://docs.angularjs.org/api/ngRoute/service/%24route\" rel=\"nofollow noreferrer\">Angular routing</a> and/or newer implementations (depending on what Angular version you&#39;re using). Hth"}, {"owner": {"reputation": 83, "user_id": 4905495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c13b52bae8bf6fcfffbc140a240673b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Meservy", "link": "https://stackoverflow.com/users/4905495/andrew-meservy"}, "reply_to_user": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1533752019, "post_id": 51752431, "comment_id": 90466138, "body": "@Shyju That is actually not a bad idea. I mean, it seems like a waste to make another call to the database when I already have access to the full object in my other method, but that would definitely work. Thanks for the solution!! I will do this if there is not a more efficient solution (which it seems like there may not be haha)"}, {"owner": {"reputation": 83, "user_id": 4905495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c13b52bae8bf6fcfffbc140a240673b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Meservy", "link": "https://stackoverflow.com/users/4905495/andrew-meservy"}, "reply_to_user": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 0, "creation_date": 1533752159, "post_id": 51752431, "comment_id": 90466206, "body": "@Shyju Most of the time yes, but in this case it is necessary to redirect away to a separate page."}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 1, "creation_date": 1533753271, "post_id": 51752431, "comment_id": 90466814, "body": "Not an answer to your question. But this post helps you understand options to transfer data (with normal form submit scenarios) <a href=\"https://stackoverflow.com/questions/11209191/how-do-i-include-a-model-with-a-redirecttoaction/11209320#11209320\" title=\"how do i include a model with a redirecttoaction\">stackoverflow.com/questions/11209191/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 886, "user_id": 6846162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/247a08a4dedec40690006001230d0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "jian", "link": "https://stackoverflow.com/users/6846162/jian"}, "is_accepted": false, "score": 1, "last_activity_date": 1533753206, "creation_date": 1533753206, "answer_id": 51753488, "question_id": 51752431, "link": "https://stackoverflow.com/questions/51752431/how-to-redirect-with-a-model-after-making-a-post-request-in-angular-net-mvc/51753488#51753488", "title": "How to redirect with a model after making a post request in Angular/.NET MVC?", "body": "<p>When you use Angular to make a request, you are making an Ajax request where the intention is to get some data from server side without leaving the current page. </p>\n\n<p>If you do want to go to another page, it's probably better just use a normal form with a submit button and an action attribute pointing to the page you want to redirect to. Like:</p>\n\n<pre><code>&lt;form action=\"newPageUrl\" method=\"post\"&gt; \n    ... // more inputs that carry the data you want to send to server side\n    &lt;input type=\"submit\"&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>However, when people use Angular, it is more often that they just let Angular do the routing/rendering. That means you put your <code>PurchaseSuccess.cshtml</code> and <code>PurchaseFail.cshtml</code> on the client side as view templates and let client side render it: You make a post request to submit the order, server receives the order and returns a new data model, client side gets the data model and reders it into the view that it already holds in memory (or request the template file on the fly if you choose to configure it that way). </p>\n"}], "owner": {"reputation": 83, "user_id": 4905495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c13b52bae8bf6fcfffbc140a240673b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Meservy", "link": "https://stackoverflow.com/users/4905495/andrew-meservy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533753206, "creation_date": 1533749271, "last_edit_date": 1533751741, "question_id": 51752431, "link": "https://stackoverflow.com/questions/51752431/how-to-redirect-with-a-model-after-making-a-post-request-in-angular-net-mvc", "title": "How to redirect with a model after making a post request in Angular/.NET MVC?", "body": "<p>I am using .NET MVC and AngularJS. After making a post request to place an order, I need to return the order that was created to a different view.</p>\n\n<p>I have two views. Purchase Success and Purchase Fail. Here is the post request in Angular:</p>\n\n<pre><code>$http.post('/Home/PlaceOrder/', placeOrderViewModel)\n                .then(function (response) {\n                    if (response != null) {\n                        window.location = '/Home/PurchaseSuccess';\n                    } else {\n                        window.location = '/Home/PurchaseFail';\n                    }\n                }, function () {\n                    alert('error');\n                });\n</code></pre>\n\n<p>Here is the method on my MVC controller.</p>\n\n<pre><code>public ActionResult PlaceOrder(PlaceOrderViewModel viewModel)\n{\n\n}\n</code></pre>\n\n<p>It accepts a view model from the Angular post request, and does some work. Then I have it returning either the purchase success or purchase fail view with the order model attached to a successful order.</p>\n\n<pre><code>return View(\"~/Views/Home/PurchaseSuccess.cshtml\", order);\n\nreturn View(\"~/Views/Home/PurchaseFail.cshtml\");\n</code></pre>\n\n<p>Returning the view does not work. MVC does not seem to be able to handle the change in views since the request was made from Angular? The redirect in the Angular success handler is already working, and works great when you do not have a model being returned.</p>\n\n<p>I basically just need to be able to redirect to the purchase success view with the model.</p>\n\n<p>Thank you for your time!</p>\n\n<p>EDIT: Here is the purchase success and purchase fail controller methods:</p>\n\n<pre><code>public ActionResult PurchaseSuccess()\n        {\n            return View();\n        }\n\n        public ActionResult PurchaseFail()\n        {\n            return View();\n        }\n</code></pre>\n"}, {"tags": ["c#", "regex", "asp.net-web-api"], "comments": [{"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 1, "creation_date": 1533749142, "post_id": 51752351, "comment_id": 90464598, "body": "IMHO you shouldn&#39;t be using Regex for this. It would probably be easier and faster to use something like <code>string.Split(&#39;_&#39;)</code> and then iterate over the resulting array, checking for validity and required attributes."}, {"owner": {"reputation": 3599, "user_id": 3608792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AeAON.jpg?s=128&g=1", "display_name": "Dan Wilson", "link": "https://stackoverflow.com/users/3608792/dan-wilson"}, "edited": false, "score": 2, "creation_date": 1533749329, "post_id": 51752351, "comment_id": 90464714, "body": "Your best bet is to play with it in a RegEx tool: <a href=\"https://regex101.com/r/s9ilVe/1\" rel=\"nofollow noreferrer\">regex101.com/r/s9ilVe/1</a>"}, {"owner": {"reputation": 4244, "user_id": 3348112, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ab4cd9458f5debd780353a5554b718d8?s=128&d=identicon&r=PG&f=1", "display_name": "CAustin", "link": "https://stackoverflow.com/users/3348112/caustin"}, "edited": false, "score": 0, "creation_date": 1533749663, "post_id": 51752351, "comment_id": 90464900, "body": "You say you want to match numbers 1-9 for the first field, but <code>[1-9]?[0-9]</code> would match 0-99. Why is the first digit optional, and why is there a second digit at all?"}], "answers": [{"comments": [{"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1534339202, "post_id": 51752471, "comment_id": 90671153, "body": "I chose this as the answer because it works in all cases I tried.  Although, it seems it would works for something out of scope as well IE: custodian_1_xxx_1_15 where xxx is not an acceptable sub-string.  It&#39;s Ok, though, I will document around this."}], "tags": [], "owner": {"reputation": 10920, "user_id": 3390419, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/cXKh9.jpg?s=128&g=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/3390419/paolo"}, "is_accepted": true, "score": 1, "last_activity_date": 1533749399, "creation_date": 1533749399, "answer_id": 51752471, "question_id": 51752351, "link": "https://stackoverflow.com/questions/51752351/c-regex-to-match-specific-strings/51752471#51752471", "title": "C# RegEx to match specific strings", "body": "<p>You may use pattern:</p>\n\n<pre><code>^custodian(?:_[a-z0-9]+)+$\n</code></pre>\n\n<ul>\n<li><code>^</code> Assert position beginning of line.</li>\n<li><code>custodian</code> Match literal substring <code>custodian</code>.</li>\n<li><code>(?:_[a-z0-9]+)+</code> Non capturing group. Multiple sequence of <code>_</code> followed by alphanumerics.</li>\n<li><code>$</code> Assert position end of line.</li>\n</ul>\n\n<p>You can check the correct matches <a href=\"https://regex101.com/r/i6Hi1i/1\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Obviously you can modify the pattern to add substring <code>signer</code> in non capturing group as:</p>\n\n<p><code>^(?:custodian|signer)(?:_[a-z0-9]+)+$</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 78607, "user_id": 319403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e92a9af9e53cc8e5af575c4b18b34c21?s=128&d=identicon&r=PG", "display_name": "cHao", "link": "https://stackoverflow.com/users/319403/chao"}, "edited": false, "score": 0, "creation_date": 1533753225, "post_id": 51752493, "comment_id": 90466789, "body": "The end bit matches a string ending in <code>_</code> (with no number). You can fix that by getting rid of the <code>?</code> after the last <code>[1-9]</code>."}], "tags": [], "owner": {"reputation": 664, "user_id": 8166144, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZEFuA.png?s=128&g=1", "display_name": "Azhy", "link": "https://stackoverflow.com/users/8166144/azhy"}, "is_accepted": false, "score": 1, "last_activity_date": 1533749462, "creation_date": 1533749462, "answer_id": 51752493, "question_id": 51752351, "link": "https://stackoverflow.com/questions/51752351/c-regex-to-match-specific-strings/51752493#51752493", "title": "C# RegEx to match specific strings", "body": "<p>I suggest using <code>\\d</code> for numbers not yours and this is my code try it:-</p>\n\n<pre><code>(?:custodian|signer)_[1-9]?[0-9]_(?:txt|ssn)_[1-9][0-9]?(_[1-9]?\\d*)?\n</code></pre>\n\n<p>I just added a <code>\\d</code> value to the end of your pattern to match all end digits before another match.</p>\n"}, {"tags": [], "owner": {"reputation": 91458, "user_id": 5424988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0b4f91c20dcd87cbd58dd351455198c?s=128&d=identicon&r=PG&f=1", "display_name": "The fourth bird", "link": "https://stackoverflow.com/users/5424988/the-fourth-bird"}, "is_accepted": false, "score": 1, "last_activity_date": 1533749467, "creation_date": 1533749467, "answer_id": 51752496, "question_id": 51752351, "link": "https://stackoverflow.com/questions/51752351/c-regex-to-match-specific-strings/51752496#51752496", "title": "C# RegEx to match specific strings", "body": "<p>You could use an anchor to assert the start <code>^</code> and the end <code>$</code> of the string and for the last part make at least the first 1-9 not optional or else it would match and underscore at the end:</p>\n\n<p><a href=\"https://regex101.com/r/hmYECg/1\" rel=\"nofollow noreferrer\"><code>^(?:custodian|signer)_[1-9]?[0-9]_(?:txt|ssn)_[1-9][0-9]?(_[1-9][0-9]?[0-9]?)?$</code></a></p>\n"}, {"comments": [{"owner": {"reputation": 2868, "user_id": 922202, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a909d49e7e0b73f4b1e10dc15b3e20f?s=128&d=identicon&r=PG", "display_name": "Guillaume CR", "link": "https://stackoverflow.com/users/922202/guillaume-cr"}, "reply_to_user": {"reputation": 10920, "user_id": 3390419, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/cXKh9.jpg?s=128&g=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/3390419/paolo"}, "edited": false, "score": 0, "creation_date": 1533750064, "post_id": 51752553, "comment_id": 90465112, "body": "@UnbearableLightness Well it doesn&#39;t match the whole string, but it does match some of it. Added anchors."}, {"owner": {"reputation": 10920, "user_id": 3390419, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/cXKh9.jpg?s=128&g=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/3390419/paolo"}, "edited": false, "score": 0, "creation_date": 1533750133, "post_id": 51752553, "comment_id": 90465146, "body": "Yeah that&#39;s better, the last capturing group should be made non capturing though."}, {"owner": {"reputation": 2868, "user_id": 922202, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a909d49e7e0b73f4b1e10dc15b3e20f?s=128&d=identicon&r=PG", "display_name": "Guillaume CR", "link": "https://stackoverflow.com/users/922202/guillaume-cr"}, "reply_to_user": {"reputation": 10920, "user_id": 3390419, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/cXKh9.jpg?s=128&g=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/3390419/paolo"}, "edited": false, "score": 0, "creation_date": 1533750170, "post_id": 51752553, "comment_id": 90465157, "body": "@UnbearableLightness OP&#39;s regex captures the last group."}, {"owner": {"reputation": 10920, "user_id": 3390419, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/cXKh9.jpg?s=128&g=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/3390419/paolo"}, "edited": false, "score": 0, "creation_date": 1533750197, "post_id": 51752553, "comment_id": 90465170, "body": "Uh, apologies, my bad."}], "tags": [], "owner": {"reputation": 2868, "user_id": 922202, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a909d49e7e0b73f4b1e10dc15b3e20f?s=128&d=identicon&r=PG", "display_name": "Guillaume CR", "link": "https://stackoverflow.com/users/922202/guillaume-cr"}, "is_accepted": false, "score": 1, "last_activity_date": 1533750042, "last_edit_date": 1533750042, "creation_date": 1533749697, "answer_id": 51752553, "question_id": 51752351, "link": "https://stackoverflow.com/questions/51752351/c-regex-to-match-specific-strings/51752553#51752553", "title": "C# RegEx to match specific strings", "body": "<p>If you're only interested in the last digits, this super generic regex will do:</p>\n\n<pre><code>(?:.+)_(\\d+)\n</code></pre>\n\n<p>If you do need to match the whole string, this worked:</p>\n\n<pre><code>^(?:custodian|signer)_\\d+_(?:txt|ssn)(?:_\\d+)?_(\\d+)$\n</code></pre>\n"}], "owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 51752471, "answer_count": 4, "score": 0, "last_activity_date": 1533750042, "creation_date": 1533748992, "question_id": 51752351, "link": "https://stackoverflow.com/questions/51752351/c-regex-to-match-specific-strings", "title": "C# RegEx to match specific strings", "body": "<p>I need to match (using regex) strings that can be like this:</p>\n\n<p>required: custodian_{number 1 - 9}_{fieldType either txt or ssn}\noptional: _{fieldLength 1-999}</p>\n\n<p>So for example:\ncustodian_1_ssn_1 is valid\ncustodian_1_ssn_1_255 is valid</p>\n\n<p>custodian or custodian_ or custodian_1 or custodian_1_ or custodian_1_ssn or custodian_1_ssn_ or custodian_1_ssn_1_ are not valid</p>\n\n<p>Currently I am working with this:</p>\n\n<pre><code>(?:custodian|signer)_[1-9]?[0-9]_(?:txt|ssn)_[1-9][0-9]?(_[1-9]?[0-9]?[0-9]?)?\n</code></pre>\n\n<p>as my regex and my api is working to pick up:\ncustodian_1_txt_1\ncustodian_1_ssn_1\n<strong>custodian_1_txt_1_25</strong>5  &lt;---- not matching the last \"5\"</p>\n\n<p>any thoughts?</p>\n"}, {"tags": ["c#", "asp.net", "checkboxlist"], "comments": [{"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1533749711, "post_id": 51752317, "comment_id": 90464928, "body": "Interesting way of building a query... But if you select only 2 columns, but still bind the data to the GridView you will get that error because you specify all the columns as BoundField."}, {"owner": {"reputation": 97, "user_id": 7040249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c8a037ab944d520fbffcff1dc3440a?s=128&d=identicon&r=PG&f=1", "display_name": "derekg8881", "link": "https://stackoverflow.com/users/7040249/derekg8881"}, "reply_to_user": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1533750183, "post_id": 51752317, "comment_id": 90465164, "body": "Yeah I&#39;m kind of new to C#. It worked so I just kind of left it. lol What should I change it to? TemplateField then orr.....?"}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 1, "creation_date": 1533750588, "post_id": 51752317, "comment_id": 90465349, "body": "If you bind data to the GridView with variable columns I suggest setting <code>AutoGenerateColumns</code> to true."}, {"owner": {"reputation": 97, "user_id": 7040249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c8a037ab944d520fbffcff1dc3440a?s=128&d=identicon&r=PG&f=1", "display_name": "derekg8881", "link": "https://stackoverflow.com/users/7040249/derekg8881"}, "reply_to_user": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1533751135, "post_id": 51752317, "comment_id": 90465652, "body": "What do you mean by variable columns? I checked the box while the columns are still BoundField called <code>AutoGenerateColumns</code> and it created each column twice so pretty much two tables are side by side combined into one table and when I chose a team and used 2 checkbox columns I still got the same error."}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1533752492, "post_id": 51752317, "comment_id": 90466395, "body": "<code>SELECT Fname, Lname</code> or <code>SELECT Fname, Lname, UserID</code> are datasets with variable columns. 2 vs 3 columns."}, {"owner": {"reputation": 97, "user_id": 7040249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c8a037ab944d520fbffcff1dc3440a?s=128&d=identicon&r=PG&f=1", "display_name": "derekg8881", "link": "https://stackoverflow.com/users/7040249/derekg8881"}, "reply_to_user": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1533760767, "post_id": 51752317, "comment_id": 90470246, "body": "Changing it to autogeneratedcolumns worked but is there a way to edit the formatting of these columns such as having some of columns&#39; data to be centered and some to be left aligned?"}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1533761371, "post_id": 51752317, "comment_id": 90470520, "body": "With AutoGenerateColumns you can only do that in the RowDataBound event. You can also make sure all the columns are in the dataset, even if they are dummies and then you could use BoundField: <code>SELECT Fname, Lname, NULL as UserID, NULL as Deskphone etc.. FROM Info WHERE Team = &#39;DB2&#39;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 7040249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c8a037ab944d520fbffcff1dc3440a?s=128&d=identicon&r=PG&f=1", "display_name": "derekg8881", "link": "https://stackoverflow.com/users/7040249/derekg8881"}, "edited": false, "score": 0, "creation_date": 1533750118, "post_id": 51752568, "comment_id": 90465141, "body": "What should I change it to? TemplateField?"}, {"owner": {"reputation": 2190, "user_id": 154889, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0f0ff8346537f5fff52b513d6fb551d?s=128&d=identicon&r=PG", "display_name": "Mel Gerats", "link": "https://stackoverflow.com/users/154889/mel-gerats"}, "reply_to_user": {"reputation": 97, "user_id": 7040249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c8a037ab944d520fbffcff1dc3440a?s=128&d=identicon&r=PG&f=1", "display_name": "derekg8881", "link": "https://stackoverflow.com/users/7040249/derekg8881"}, "edited": false, "score": 1, "creation_date": 1533753313, "post_id": 51752568, "comment_id": 90466834, "body": "As @VDWWD said, set <code>AutoGenerateColumns</code> to true on the gridview, and remove all the boundfields"}, {"owner": {"reputation": 97, "user_id": 7040249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c8a037ab944d520fbffcff1dc3440a?s=128&d=identicon&r=PG&f=1", "display_name": "derekg8881", "link": "https://stackoverflow.com/users/7040249/derekg8881"}, "edited": false, "score": 0, "creation_date": 1533753669, "post_id": 51752568, "comment_id": 90467010, "body": "wow. That worked. I messed with that setting before but I never removed the boundfields at all."}, {"owner": {"reputation": 97, "user_id": 7040249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c8a037ab944d520fbffcff1dc3440a?s=128&d=identicon&r=PG&f=1", "display_name": "derekg8881", "link": "https://stackoverflow.com/users/7040249/derekg8881"}, "edited": false, "score": 0, "creation_date": 1533754689, "post_id": 51752568, "comment_id": 90467446, "body": "But is there a way to edit the formatting of these columns such as having some of columns&#39; data to be centered and some to be left aligned?"}, {"owner": {"reputation": 2190, "user_id": 154889, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0f0ff8346537f5fff52b513d6fb551d?s=128&d=identicon&r=PG", "display_name": "Mel Gerats", "link": "https://stackoverflow.com/users/154889/mel-gerats"}, "reply_to_user": {"reputation": 97, "user_id": 7040249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c8a037ab944d520fbffcff1dc3440a?s=128&d=identicon&r=PG&f=1", "display_name": "derekg8881", "link": "https://stackoverflow.com/users/7040249/derekg8881"}, "edited": false, "score": 0, "creation_date": 1533794619, "post_id": 51752568, "comment_id": 90478699, "body": "sure, but you should post that in a different question"}], "tags": [], "owner": {"reputation": 2190, "user_id": 154889, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0f0ff8346537f5fff52b513d6fb551d?s=128&d=identicon&r=PG", "display_name": "Mel Gerats", "link": "https://stackoverflow.com/users/154889/mel-gerats"}, "is_accepted": false, "score": 0, "last_activity_date": 1533749776, "creation_date": 1533749776, "answer_id": 51752568, "question_id": 51752317, "link": "https://stackoverflow.com/questions/51752317/a-field-or-property-with-the-name-x-was-not-found-on-the-selected-data-source/51752568#51752568", "title": "A field or property with the name &#39;X&#39; was not found on the selected data source", "body": "<p>You get the error because you try to bind all the columns in GridView1 where you show the result. When you uncheck one field, you remove it from your query, so it is not part of the resultset. However, you still try to bind a column to it:</p>\n\n<pre><code>&lt;asp:BoundField DataField=\"Fname\" HeaderText=\"First Name\" SortExpression=\"Fname\" /&gt;\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7040249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34c8a037ab944d520fbffcff1dc3440a?s=128&d=identicon&r=PG&f=1", "display_name": "derekg8881", "link": "https://stackoverflow.com/users/7040249/derekg8881"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533749776, "creation_date": 1533748871, "last_edit_date": 1533749341, "question_id": 51752317, "link": "https://stackoverflow.com/questions/51752317/a-field-or-property-with-the-name-x-was-not-found-on-the-selected-data-source", "title": "A field or property with the name &#39;X&#39; was not found on the selected data source", "body": "<p>This might be a long post but I've tried a lot to fix it and haven't figured it out. </p>\n\n<p>I am creating an ASP GUI for a user to look up employee info. It has a dropdown list for what team they are on and then there are 18 checkbox lists that are being used as filters for what the user wants to search by. I have a data source that grabs 19 columns of employee information all from one table so there's no joins here. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Lvo3q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lvo3q.png\" alt=\"enter image description here\"></a></p>\n\n<p>My Problem:</p>\n\n<p>It works fine when I just use the dropdown list for the user to select a team and no checkboxes are checked. It returns the all employees and their information from the team I chose along with all columns in the database. But when I check any box such as 'First Name' (which has the column name Fname in my database) I will get an error saying \"A field or property with the name 'Lname' was not found on the selected data source.\" Lname is the next column in my table (with the alias name 'Last Name' in my GUI). If I run the GUI again and check the boxes 'first name\" and 'last name', it will return the same error but instead of it saying 'Lname' was not found on the data source, it will say the next column which is UserID. If I check all the boxes it will return with the same error but with the column name 'Team' was not found. The column 'Team' is being used for the dropdown list.</p>\n\n<p>Looking at the SQL Command at the bottom after the error happens, it shows a correct SQL statement of <code>\"SELECT Fname, Lname FROM Info WHERE Team = 'DB2'\"</code> and that's when I select the team DB2 from the dropdown list and select the checkboxes Fname and Lname.</p>\n\n<p>Here is my cs code:</p>\n\n<pre><code>public partial class WebForm1 : System.Web.UI.Page\n{\n    string SQLCmd = \"SELECT *\";\n\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void btnSearch_Click(object sender, EventArgs e)\n    {\n        SQLQueryBuilder();\n        SqlDataSource1.SelectCommand = SQLCmd;\n        GridView1.DataBind();\n    }\n\n    private void SQLQueryBuilder()\n    {\n        foreach (ListItem i in CheckBoxList1.Items)\n        {\n            if (i.Selected == true)\n            {\n                SQLCmd = SQLCmd.Remove(SQLCmd.Length - 1);\n                SQLCmd += i.Value + \",  \";                                     \n            }                                                                    \n        }\n\n        if (SQLCmd.EndsWith(\",  \"))\n        {\n            SQLCmd = SQLCmd.Remove(SQLCmd.Length - 3);\n        }\n\n        SQLFromClause();\n\n        if (DropDownList1.SelectedValue != \"Please Select a Team...\")\n        {\n            SQLWhereClause();\n            SQLCmd += \" Team = '\" + DropDownList1.SelectedValue + \"'\";\n        }                        \n    }\n\n    private void SQLFromClause()\n    {\n        SQLCmd += \" FROM Info\";\n    }\n\n    private void SQLWhereClause()\n    {\n        SQLCmd += \" WHERE\";            \n    }\n}\n}\n</code></pre>\n\n<p>I've tried modifying my SQL Statement here and there but it is returning the correct column names and correct SQL Statement so I don't think it's that.</p>\n\n<p>Here is my source code for the GUI:</p>\n\n<pre><code>&lt;%@ Page Title=\"\" Language=\"C#\" MasterPageFile=\"~/PhoneList.Master\" AutoEventWireup=\"true\" CodeBehind=\"WebForm1.aspx.cs\" Inherits=\"PhoneList.WebForm1\" %&gt;\n</code></pre>\n\n<p>\n\n\n    </p>\n\n<pre><code>    &lt;asp:CheckBoxList ID=\"CheckBoxList1\" runat=\"server\" Height=\"16px\" RepeatColumns=\"3\" style=\"position:absolute; top: 118px; left: 7px; z-index: 1; height: 152px; width: 350px;\"&gt;\n        &lt;asp:ListItem Value=\"Fname\" Selected=\"True\"&gt;First Name&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Lname\" Selected=\"True\"&gt;Last Name&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"UserID\" Selected=\"True\"&gt;User ID&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Deskphone\" Selected=\"True\"&gt;Desk Phone&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Cellphone\" Selected=\"True\"&gt;Cell Phone&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Home\" Selected=\"True\"&gt;Home Phone&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Workhours\" Selected=\"True\"&gt;Work Hours&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"RDO\" Selected=\"True\"&gt;RDO&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Telework\" Selected=\"True\"&gt;Telework&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Laptopnum\" Selected=\"True\"&gt;Laptop #&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Desktopnum\" Selected=\"True\"&gt;Desktop #&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Monitor1\" Selected=\"True\"&gt;Monitor 1&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Monitor2\" Selected=\"True\"&gt;Monitor 2&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"USB\" Selected=\"True\"&gt;USB&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"WorkspaceID\" Selected=\"True\"&gt;Workspace ID&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Birthday\" Selected=\"True\"&gt;Birthday&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"IP\" Selected=\"True\"&gt;IP Address&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem Value=\"Laptopmodel\" Selected=\"True\"&gt;Laptop Model&lt;/asp:ListItem&gt;\n     &lt;/asp:CheckBoxList&gt;\n\n    &lt;asp:Label ID=\"lblFilter\" runat=\"server\" Text=\"Filters:\" style=\"position:absolute; top: 96px; left: 14px;\"&gt;&lt;/asp:Label&gt;\n\n    &lt;asp:Button ID=\"btnSearch\" runat=\"server\" OnClick=\"btnSearch_Click\" Text=\"Search\" style=\"position:absolute; top: 274px; left: 13px;\" /&gt;\n\n    &lt;asp:DropDownList ID=\"DropDownList1\" runat=\"server\" style=\"position:absolute; margin-top: 0px; top: 70px; left: 11px;\"&gt;\n        &lt;asp:ListItem&gt;Please Select a Team...&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem&gt;DB2&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem&gt;Oracle&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem&gt;SQL&lt;/asp:ListItem&gt;\n        &lt;asp:ListItem&gt;Sybase&lt;/asp:ListItem&gt;        \n    &lt;/asp:DropDownList&gt;\n\n&lt;/p&gt;\n&lt;p&gt;\n    &lt;asp:GridView ID=\"GridView1\" runat=\"server\" AllowSorting=\"True\" AutoGenerateColumns=\"False\" DataSourceID=\"SqlDataSource1\" style=\"left: 7px;\"&gt;\n        &lt;AlternatingRowStyle BackColor=\"#FFCC99\" /&gt;\n        &lt;Columns&gt;\n            &lt;asp:BoundField DataField=\"Fname\" HeaderText=\"First Name\" SortExpression=\"Fname\" /&gt;\n            &lt;asp:BoundField DataField=\"Lname\" HeaderText=\"Last Name\" SortExpression=\"Lname\" /&gt;\n            &lt;asp:BoundField DataField=\"UserID\" HeaderText=\"User ID\" SortExpression=\"UserID\" /&gt;\n            &lt;asp:BoundField DataField=\"Deskphone\" HeaderText=\"Desk Phone\" SortExpression=\"Deskphone\" /&gt;\n            &lt;asp:BoundField DataField=\"Cellphone\" HeaderText=\"Cell Phone\" SortExpression=\"Cellphone\" /&gt;\n            &lt;asp:BoundField DataField=\"Home\" HeaderText=\"Home Phone\" SortExpression=\"Home\" /&gt;\n            &lt;asp:BoundField DataField=\"Workhours\" HeaderText=\"Work Hours\" SortExpression=\"Workhours\" /&gt;\n            &lt;asp:BoundField DataField=\"RDO\" HeaderText=\"RDO\" SortExpression=\"RDO\" /&gt;\n            &lt;asp:BoundField DataField=\"Telework\" HeaderText=\"Telework\" SortExpression=\"Telework\" /&gt;\n            &lt;asp:BoundField DataField=\"Laptopnum\" HeaderText=\"Laptop #\" SortExpression=\"Laptopnum\" /&gt;\n            &lt;asp:BoundField DataField=\"Desktopnum\" HeaderText=\"Desktop #\" SortExpression=\"Desktopnum\" /&gt;\n            &lt;asp:BoundField DataField=\"Monitor1\" HeaderText=\"Monitor 1\" SortExpression=\"Monitor1\" /&gt;\n            &lt;asp:BoundField DataField=\"Monitor2\" HeaderText=\"Monitor 2\" SortExpression=\"Monitor2\" /&gt;\n            &lt;asp:CheckBoxField DataField=\"USB\" HeaderText=\"USB\" SortExpression=\"USB\" /&gt;\n            &lt;asp:BoundField DataField=\"WorkspaceID\" HeaderText=\"Workspace ID\" SortExpression=\"WorkspaceID\" /&gt;\n            &lt;asp:BoundField DataField=\"Birthday\" HeaderText=\"Birthday\" SortExpression=\"Birthday\" /&gt;\n            &lt;asp:BoundField DataField=\"IP\" HeaderText=\"IP Address\" SortExpression=\"IP\" /&gt;\n            &lt;asp:BoundField DataField=\"Laptopmodel\" HeaderText=\"Laptop Model\" SortExpression=\"Laptopmodel\" /&gt;\n            &lt;asp:BoundField DataField=\"Team\" HeaderText=\"Team\" SortExpression=\"Team\" /&gt;\n        &lt;/Columns&gt;\n        &lt;HeaderStyle BackColor=\"#FF9900\" /&gt;\n    &lt;/asp:GridView&gt;\n    &lt;asp:SqlDataSource ID=\"SqlDataSource1\" runat=\"server\" ConnectionString=\"&lt;%$ ConnectionStrings:ExampleConnectionString %&gt;\" \n        SelectCommand=\"SELECT Fname, Lname, UserID, Deskphone, Cellphone, Home, Workhours, RDO, Telework, Laptopnum, Desktopnum, Monitor1, Monitor2, USB, WorkspaceID, Birthday, IP, Laptopmodel, Team FROM Info\"&gt; \n        &lt;/asp:SqlDataSource&gt;\n&lt;/p&gt;\n&lt;p&gt;\n\n    &amp;nbsp;&lt;/p&gt;\n&lt;p&gt;\n    &amp;nbsp;&lt;/p&gt;\n</code></pre>\n\n<p></p>\n\n<p>I've tried having the select command be <code>SELECT * FROM Info</code> originally but that didn't change anything. All of the column names are clearly correct since when I only use the dropdown list without clicking any checkboxes, it returns the correct data. When I copy the SQL Command that the script generates and paste it directly into my SQL Server Management Studio, it brings back the correct information so I don't know what the problem is!</p>\n"}, {"tags": ["c#", "system.data.sqlite"], "answers": [{"tags": [], "owner": {"reputation": 2862, "user_id": 10115847, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Okv0j.jpg?s=128&g=1", "display_name": "Or Yaacov", "link": "https://stackoverflow.com/users/10115847/or-yaacov"}, "is_accepted": false, "score": 1, "last_activity_date": 1533758263, "creation_date": 1533758263, "answer_id": 51754687, "question_id": 51752306, "link": "https://stackoverflow.com/questions/51752306/c-how-to-correctly-embed-system-data-sqlite-libraries/51754687#51754687", "title": "C# How to correctly embed System.Data.SQLite libraries", "body": "<p><a href=\"https://i.stack.imgur.com/VzIPo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VzIPo.png\" alt=\"enter image description here\"></a></p>\n\n<p>make sure that when you are deploying your app the DLL System.Data.SQLite  is included. \nIn the picture you can see a demo with System.data, you should do the same with your DLL file, after build make sure that the DLL is in the source folder, and then your program should run.\nand make sure that it support your current .NET version</p>\n"}], "owner": {"reputation": 101, "user_id": 8232368, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2e501ab1680d9d7684016beac98571e?s=128&d=identicon&r=PG", "display_name": "Technical", "link": "https://stackoverflow.com/users/8232368/technical"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1533758263, "creation_date": 1533748826, "question_id": 51752306, "link": "https://stackoverflow.com/questions/51752306/c-how-to-correctly-embed-system-data-sqlite-libraries", "title": "C# How to correctly embed System.Data.SQLite libraries", "body": "<p>I have a C# project which uses System.Data.SQLite (.NET 3.5 version) libraries. Target platform is x86, target framework is 4.5.2.</p>\n\n<p>Here's what I've done:</p>\n\n<ol>\n<li>Added System.Data.SQLite to project's dependecies</li>\n<li>Put System.Data.SQLite and SQLite.Interop.dll into project's root folder</li>\n</ol>\n\n<p>The program runs perfectly on my PC (Windows Server 2008 R2) and my laptop (Windows 10). It also works on another PC (Windows 10).</p>\n\n<p>However, when deployed to customer PC (Windows 7), I get DllNotFoundException on System.Data.SQLite. The PC has .NET Framework 4.5 installed. I tried both x64 and x86 System.Data.SQLite versions, but I still get exception.</p>\n\n<p>If I remove System.Data.SQLite dependency and code, which uses this library, the program runs just fine.</p>\n\n<p>What could be the problem?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 44402, "user_id": 20471, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/35b5e9e9ccf3bfe5ff8d22b64a5234d3?s=128&d=identicon&r=PG", "display_name": "Joe Phillips", "link": "https://stackoverflow.com/users/20471/joe-phillips"}, "edited": false, "score": 11, "creation_date": 1533748550, "post_id": 51752220, "comment_id": 90464268, "body": "Make City a list of Cities."}, {"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1533748725, "post_id": 51752220, "comment_id": 90464375, "body": "I don&#39;t understand what the problem is exactly. Can you <a href=\"https://stackoverflow.com/posts/51752220/edit\">edit</a> to clarify?"}, {"owner": {"reputation": 18804, "user_id": 3225, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cplXg.png?s=128&g=1", "display_name": "kenny", "link": "https://stackoverflow.com/users/3225/kenny"}, "edited": false, "score": 0, "creation_date": 1533748910, "post_id": 51752220, "comment_id": 90464463, "body": "try to learn how to create List&lt;City&gt; and update the question"}, {"owner": {"reputation": 8541, "user_id": 8366499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9t89.jpg?s=128&g=1", "display_name": "divibisan", "link": "https://stackoverflow.com/users/8366499/divibisan"}, "reply_to_user": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 0, "creation_date": 1533762052, "post_id": 51752220, "comment_id": 90470819, "body": "@Pac0 Fair point, my mistake."}], "answers": [{"comments": [{"owner": {"reputation": 178, "user_id": 9981885, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1WWxvSP4_Vg/AAAAAAAAAAI/AAAAAAAAAU4/ul7blWIomQg/photo.jpg?sz=128", "display_name": "Scornz", "link": "https://stackoverflow.com/users/9981885/scornz"}, "edited": false, "score": 0, "creation_date": 1533749156, "post_id": 51752324, "comment_id": 90464610, "body": "I don&#39;t believe you can explicitly initialize a List like that, that ability is reserved for arrays."}, {"owner": {"reputation": 18804, "user_id": 3225, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cplXg.png?s=128&g=1", "display_name": "kenny", "link": "https://stackoverflow.com/users/3225/kenny"}, "edited": false, "score": 1, "creation_date": 1533749313, "post_id": 51752324, "comment_id": 90464705, "body": "no that list constructor works fine, any IEnumerable&lt;City&gt; works. <a href=\"https://msdn.microsoft.com/en-us/library/fkbw11z0(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/fkbw11z0(v=vs.110).aspx</a>"}, {"owner": {"reputation": 21, "user_id": 10199080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Evgeniy Bojenov", "link": "https://stackoverflow.com/users/10199080/evgeniy-bojenov"}, "edited": false, "score": 0, "creation_date": 1533752701, "post_id": 51752324, "comment_id": 90466504, "body": "but how to add a <code>Number</code> to city? each city will have its own number. I have <code>public class Live {     public Person { get; set; }     public City { get; set; }     public int Number { get; set; } }</code>"}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "reply_to_user": {"reputation": 21, "user_id": 10199080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Evgeniy Bojenov", "link": "https://stackoverflow.com/users/10199080/evgeniy-bojenov"}, "edited": false, "score": 0, "creation_date": 1533760575, "post_id": 51752324, "comment_id": 90470163, "body": "@EvgeniyBojenov If the number is linked with a City, then it should be in the City class. If all this is from a Relational Database and / or for some reasons you don&#39;t want to add the Number property to the class City, then maybe you should do some kind of intermediate class (PersonCity) . Each PersonCity would contain a City and a related Number. And then, Person would contain a List&lt;PersonCity&gt;."}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "reply_to_user": {"reputation": 178, "user_id": 9981885, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1WWxvSP4_Vg/AAAAAAAAAAI/AAAAAAAAAU4/ul7blWIomQg/photo.jpg?sz=128", "display_name": "Scornz", "link": "https://stackoverflow.com/users/9981885/scornz"}, "edited": false, "score": 0, "creation_date": 1533760618, "post_id": 51752324, "comment_id": 90470184, "body": "@Scornz as kenny said, this is perfectly valid initialization for any List, Array, Set, etc..."}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "reply_to_user": {"reputation": 21, "user_id": 10199080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Evgeniy Bojenov", "link": "https://stackoverflow.com/users/10199080/evgeniy-bojenov"}, "edited": false, "score": 0, "creation_date": 1533760762, "post_id": 51752324, "comment_id": 90470243, "body": "@EvgeniyBojenov On a more general comment : I can understand that you have doubts and struggle to create a correct model. That&#39;s a learning path for every coder. However, you have to realize that there are lots of different ways to achieve this, and some ways are better than other <i>for specific situations</i>. The more you clarify what you need to model exactly, what your program / teaching exercise is supposed to achieve, the better your question and the answers will be. (...)"}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 0, "creation_date": 1533760884, "post_id": 51752324, "comment_id": 90470312, "body": "(.. continued). Until now, all we could see in your question is : you want a Person to have several cities. Now you add the requirement that number is linked to the city. Maybe if you show what you need to have at the end exactly then we could help more precisely (also, this is an important point to learn programming : modelize precisely before coding !)"}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "reply_to_user": {"reputation": 21, "user_id": 10199080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Evgeniy Bojenov", "link": "https://stackoverflow.com/users/10199080/evgeniy-bojenov"}, "edited": false, "score": 0, "creation_date": 1533762240, "post_id": 51752324, "comment_id": 90470874, "body": "@EvgeniyBojenov Also, I edited my answer with a definition of the <code>Live</code> class that would work with my example."}], "tags": [], "owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "is_accepted": false, "score": 0, "last_activity_date": 1533762158, "last_edit_date": 1533762158, "creation_date": 1533748893, "answer_id": 51752324, "question_id": 51752220, "link": "https://stackoverflow.com/questions/51752220/how-add-items-to-list/51752324#51752324", "title": "How add items to list", "body": "<p>you can change City to be Cities (a list of City) instead.</p>\n\n<pre><code>var live = new List&lt;Live&gt;();\nlives.Add(new Live\n{\n    Person = new Person\n    {\n        FirstName = \"Joe\",\n        LastName = \"Doe\"\n    },\n    Cities = new List&lt;City&gt;\n    {\n        new City \n        {\n            Name = \"NY\",\n        },\n        new City\n        {\n            Name = \"LA\",\n        }\n    },\n    Number = 31\n});\n</code></pre>\n\n<p>In order to compile, your Person class should be defined like this :</p>\n\n<pre><code>public class Live\n{\n    public Person Person { get; set; }\n    public List&lt;City&gt; Cities { get; set; }\n    public int Number;\n}\n</code></pre>\n\n<p>Also, as per your comment, if you want <code>Number</code> for each City, then the simplest solution I can imagine is to move Number from Person class to the City class. </p>\n\n<p>Ultimately, it depends on what you need to model exactly, there are other ways.</p>\n"}, {"tags": [], "owner": {"reputation": 178, "user_id": 9981885, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1WWxvSP4_Vg/AAAAAAAAAAI/AAAAAAAAAU4/ul7blWIomQg/photo.jpg?sz=128", "display_name": "Scornz", "link": "https://stackoverflow.com/users/9981885/scornz"}, "is_accepted": false, "score": 0, "last_activity_date": 1533749028, "creation_date": 1533749028, "answer_id": 51752363, "question_id": 51752220, "link": "https://stackoverflow.com/questions/51752220/how-add-items-to-list/51752363#51752363", "title": "How add items to list", "body": "<p>In the <code>Live</code> class, make the variable <code>City</code> a <code>City[]</code> instead, allowing someone to live in more than one city.</p>\n\n<pre><code>City City;\n</code></pre>\n\n<p><strong><em>TO</em></strong> </p>\n\n<pre><code>City[] Cities;\n</code></pre>\n\n<p>And then you can change your code to look a bit like this...</p>\n\n<pre><code>var live = new List&lt;Live&gt;();\nlives.Add(new Live\n{\n    Person = new Person\n    {\n        FirstName = \"Joe\",\n        LastName = \"Doe\"\n    },\n    Cities = new City[]\n    {\n        new City {\n            Name = \"LA\"\n        },\n        new City {\n            Name = \"NY\"\n        }\n    },\n    Number = 31\n});\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>If you want <code>Cities</code> to be a <code>List&lt;City&gt;</code> then you can modify your code to look like this instead...</p>\n\n<pre><code>var live = new List&lt;Live&gt;();\nlives.Add(new Live\n{\n    Person = new Person\n    {\n        FirstName = \"Joe\",\n        LastName = \"Doe\"\n    },\n    Cities = new List&lt;City&gt;(\n    new City[]\n    {\n        new City {\n            Name = \"LA\"\n        },\n        new City {\n            Name = \"NY\"\n        }\n    }),\n    Number = 31\n});\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10199080, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Evgeniy Bojenov", "link": "https://stackoverflow.com/users/10199080/evgeniy-bojenov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1533762158, "creation_date": 1533748473, "question_id": 51752220, "link": "https://stackoverflow.com/questions/51752220/how-add-items-to-list", "title": "How add items to list", "body": "<p>I have class person,city and street. Number its House number. I was faced with such a problem that a person can live not only in 1 city, but for example in 2 (NY and LA). How add new city to person.</p>\n\n<pre><code>var live = new List&lt;Live&gt;();\n    lives.Add(new Live\n    {\n        Person = new Person\n        {\n            FirstName = \"Joe\",\n            LastName = \"Doe\"\n        },\n        City = new City\n        {\n            Name = \"NY\",\n        },\n        Number = 31\n    });\n</code></pre>\n"}]