[{"tags": ["c#", "wpf"], "comments": [{"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "reply_to_user": {"reputation": 13408, "user_id": 585968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d0399ab165e17f668b2cdd1a5c1dc0?s=128&d=identicon&r=PG&f=1", "display_name": "MickyD", "link": "https://stackoverflow.com/users/585968/mickyd"}, "edited": false, "score": 0, "creation_date": 1473293248, "post_id": 39380582, "comment_id": 66089219, "body": "I saw that too, tried those there and is not the same with what I am looking for. as I said, I searched around."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1473294125, "post_id": 39380582, "comment_id": 66089406, "body": "Are you sure you didn&#39;t try <code>https:&#47;&#47;www.google.com.au&#47;search?q=change+the+color+of+the+f&zwnj;&#8203;orm+background+in+WP&zwnj;&#8203;F+C%23</code> as I got loads of very good results?"}, {"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "reply_to_user": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1473294492, "post_id": 39380582, "comment_id": 66089474, "body": "@Enigmativity I did, no result! and where is the Duplicated posot that I made? as I said, there was many asking the same question, but none of them worked for me..."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1473299694, "post_id": 39380582, "comment_id": 66090543, "body": "There seems to be plenty of good google results and the two duplicates look useful. You need to try some of the the approaches and then post the code that doesn&#39;t work for you, along with why it doesn&#39;t and what it should do, so that we can help you fix it. Please don&#39;t ask us to do the research for you."}], "owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "closed_date": 1473294165, "answer_count": 0, "score": 0, "last_activity_date": 1473293812, "creation_date": 1473292164, "question_id": 39380582, "link": "https://stackoverflow.com/questions/39380582/changing-the-window-form-background-in-random-color-in-wpf-by-code-in-c", "closed_reason": "Duplicate", "title": "Changing the Window/Form background in random color in WPF by code in C#", "body": "<p>I am trying to create a random color background which changed slowly. \nBut I cant find out how to change the color of the form background in WPF C#. searched a lot on google but no result. Here too.</p>\n\n<p>Also, was thinking to control the colors with a timer. but cant find Timer in tools. Should I add it or there is any other way?</p>\n"}, {"tags": ["c#", "email", "sendgrid"], "answers": [{"comments": [{"owner": {"reputation": 5614, "user_id": 2556858, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/853215343/picture?type=large", "display_name": "Libin Joseph", "link": "https://stackoverflow.com/users/2556858/libin-joseph"}, "edited": false, "score": 0, "creation_date": 1473627835, "post_id": 39423201, "comment_id": 66203594, "body": "Thanks @KyleT12. This was the case with mine."}], "tags": [], "owner": {"reputation": 36, "user_id": 5071798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc86f70eb7baf8608c9d53f7651e212?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Thumbadoo", "link": "https://stackoverflow.com/users/5071798/kyle-thumbadoo"}, "is_accepted": true, "score": 1, "last_activity_date": 1473488286, "creation_date": 1473488286, "answer_id": 39423201, "question_id": 39380517, "link": "https://stackoverflow.com/questions/39380517/sendgrid-email-using-mailhelper/39423201#39423201", "title": "SendGrid email using MailHelper", "body": "<p>Sendgrid API responds with bad request when there are more than 1 email address that is the same in the Personalization object. Make sure all the emails are unique</p>\n"}], "owner": {"reputation": 5614, "user_id": 2556858, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/853215343/picture?type=large", "display_name": "Libin Joseph", "link": "https://stackoverflow.com/users/2556858/libin-joseph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "accepted_answer_id": 39423201, "answer_count": 1, "score": 0, "last_activity_date": 1473488286, "creation_date": 1473291539, "question_id": 39380517, "link": "https://stackoverflow.com/questions/39380517/sendgrid-email-using-mailhelper", "title": "SendGrid email using MailHelper", "body": "<p>I am using SendGrid mailhelper (as part of C# SDK) to send email. I need to send to multiple users, and hence I am using Personalization. </p>\n\n<p>I get an error : Bad Request </p>\n\n<p>This is my code:</p>\n\n<pre><code> static async Task Execute(string sub, string body, List&lt;Recipient&gt; recipients)\n    {\n        string apiKey = Environment.GetEnvironmentVariable(\"SendGrid_ApiKey\", EnvironmentVariableTarget.User);\n\n        dynamic sg = new SendGridAPIClient(apiKey);\n\n        SendGrid.Helpers.Mail.Email from = new SendGrid.Helpers.Mail.Email(\"test1@gmail.com\");\n        string subject = sub;\n        Personalization personalization = new Personalization();\n\n       SendGrid.Helpers.Mail.Email emails = new SendGrid.Helpers.Mail.Email();\n        var i = 0;\n        foreach (var recp in recipients)\n        {\n            emails.Address = recp.Email;\n            emails.Name = recp.FirstName + \" \" + recp.LastName;\n            personalization.AddTo(emails);\n            i++;\n        }\n        SendGrid.Helpers.Mail.Email to = new SendGrid.Helpers.Mail.Email(\"test1@gmail.com\");\n\n        Content content = new Content(\"text/plain\", body);\n        Mail mail = new Mail(from, subject, to, content);\n        mail.AddPersonalization(personalization);\n        dynamic response = await sg.client.mail.send.post(requestBody: mail.Get());\n    }\n</code></pre>\n\n<p>I appreciate if someone could advise me what am I doing incorrect.</p>\n"}, {"tags": ["c#", "arrays", "compare", "string-comparison"], "comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 1, "creation_date": 1473293490, "post_id": 39380473, "comment_id": 66089268, "body": "Please <a href=\"https://stackoverflow.com/posts/39380473/edit\">edit</a> your post to clarify what you expect and what you&#39;ve tried."}, {"owner": {"reputation": 1281, "user_id": 663853, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/0ABQE.jpg?s=128&g=1", "display_name": "Robert Green MBA", "link": "https://stackoverflow.com/users/663853/robert-green-mba"}, "edited": false, "score": 0, "creation_date": 1473293644, "post_id": 39380473, "comment_id": 66089302, "body": "I have added javascript solution but you need to create a custom comparer.  You want to match &quot;ANGEL MARTIN ROMERO RIVERA&quot; with &quot;ANGEL MARTIN&quot; so you have to do this manually.  So that it will not match &quot;ANGEL MARTIN ROMERO RIVERA&quot; with &quot;ANGEL CARLOS MARTIN&quot;, thus my javascript solution is a step in the right direction..."}, {"owner": {"reputation": 1281, "user_id": 663853, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/0ABQE.jpg?s=128&g=1", "display_name": "Robert Green MBA", "link": "https://stackoverflow.com/users/663853/robert-green-mba"}, "edited": false, "score": 0, "creation_date": 1473355444, "post_id": 39380473, "comment_id": 66119694, "body": "Updated with C# example."}], "answers": [{"comments": [{"owner": {"reputation": 1281, "user_id": 663853, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/0ABQE.jpg?s=128&g=1", "display_name": "Robert Green MBA", "link": "https://stackoverflow.com/users/663853/robert-green-mba"}, "edited": false, "score": 0, "creation_date": 1473292967, "post_id": 39380675, "comment_id": 66089157, "body": "1 way how to do this, but you can try a plethora of other solutions too... here is a PURE VANILLA javascript solution"}, {"owner": {"reputation": 6582, "user_id": 3274830, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/R9y6g.jpg?s=128&g=1", "display_name": "mok", "link": "https://stackoverflow.com/users/3274830/mok"}, "reply_to_user": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 0, "creation_date": 1473293330, "post_id": 39380675, "comment_id": 66089232, "body": "@AlexeiLevenkov It&#39;s really a low quality question, and sometimes I really doubt that whether we should answer these questions at all or not."}, {"owner": {"reputation": 1281, "user_id": 663853, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/0ABQE.jpg?s=128&g=1", "display_name": "Robert Green MBA", "link": "https://stackoverflow.com/users/663853/robert-green-mba"}, "reply_to_user": {"reputation": 6582, "user_id": 3274830, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/R9y6g.jpg?s=128&g=1", "display_name": "mok", "link": "https://stackoverflow.com/users/3274830/mok"}, "edited": false, "score": 0, "creation_date": 1473352692, "post_id": 39380675, "comment_id": 66118329, "body": "@mok WOW! I fixed it!"}], "tags": [], "owner": {"reputation": 1281, "user_id": 663853, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/0ABQE.jpg?s=128&g=1", "display_name": "Robert Green MBA", "link": "https://stackoverflow.com/users/663853/robert-green-mba"}, "is_accepted": false, "score": 1, "last_activity_date": 1473352674, "last_edit_date": 1473352674, "creation_date": 1473292935, "answer_id": 39380675, "question_id": 39380473, "link": "https://stackoverflow.com/questions/39380473/find-matching-string-from-two-arrays/39380675#39380675", "title": "Find matching string from two Arrays", "body": "<pre><code>using System;\nusing System.Threading;\n\nnamespace ConsoleApplication1\n{\n    class Program\n    {\n        static string[] array1 = new string[] { \"ANGEL MARTIN ROMERO RIVERA\", \"CRISOGONO CORTES ZARATE\", \"RAFAEL ARMANDO DE LEON ALVARADO\", \"TEST\" };\n        static string[] array2 = new string[] { \"ANGEL MARTIN\", \"CRISOGONO ZARATE\", \"RAFAEL DE LEON ALVARADO\", \"TEST\" };\n\n        static void Main(string[] args)\n        {\n            for (var i = 0; i &lt; array1.Length; i++)\n            {\n\n                for (var j = 0; j &lt; array2.Length; j++)\n                {\n\n                    // compare (if they will equal)\n                    if (array1[i] == array2[j])\n                    {\n                        // will match Array1 &amp; Array2 on \"TEST\", ok, so loop...\n                        Console.WriteLine(\"Match: {0}array1:{1}{2}array2:{3}\", System.Environment.NewLine, array1[i], System.Environment.NewLine, array2[j]);\n                    }\n                    else\n                    {\n                        // if data is like your example\n                        if (array1[i].Contains(array2[j]))\n                        {\n                            Console.WriteLine(\"Match: {0}array1:{1}{2}array2:{3}\", System.Environment.NewLine, array1[i], System.Environment.NewLine, array2[j]);\n                            // match on\n                            // will match Array1 &amp; Array2 on \"ANGEL MARTIN\" and \"TEST\", ok, so loop...\n                            // will NOT match on CRISOGONO ZARATE, but the else condition will...\n                        }\n                        else\n                        {\n                            // so, to get this match we do\n                            var array2subArray = array2[j].Split(' ');\n\n                            for (var k = 0; k &lt; array2subArray.Length; k++)\n                            {\n                                // match all the terms in each array where the match is possible (or the smaller against the larger, i.e., if array1[i] is a name of 4 words and array2[j] is a name of 2 words, for this to be a valid match, both of the words in array2[j] must be contained in array1[i]\n                                // I would write the code but then that would leave out the fun for you...\n\n                                // Here's a start...\n                                // you need to fix the below, but it is a start, blah, blah, blah...\n                                if (array1[i].Contains(array2subArray[k]))\n                                {\n                                    // this will match on \"CRISOGONO\"\n                                    Console.WriteLine(\"Potential Match: {0}array1:{1}{2}array2:{3}\", System.Environment.NewLine, array1[i], System.Environment.NewLine, array2[j]);\n                                    Console.WriteLine(\"processing furter to see if true match...\");\n                                }\n                            }\n                        }\n                    }\n\n                }\n            }\n            Console.ReadKey();\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6806866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4328f459775b35ac8c80f23cf8606ab?s=128&d=identicon&r=PG&f=1", "display_name": "Hashem Kalan", "link": "https://stackoverflow.com/users/6806866/hashem-kalan"}, "is_accepted": false, "score": -3, "last_activity_date": 1473293301, "creation_date": 1473293301, "answer_id": 39380719, "question_id": 39380473, "link": "https://stackoverflow.com/questions/39380473/find-matching-string-from-two-arrays/39380719#39380719", "title": "Find matching string from two Arrays", "body": "<p>In This Cases The Size Of Two Arrays Should Be Equal</p>\n\n<p>This Code Maybe UseFul For You</p>\n\n<pre><code>public bool Compare(string[] arr1,string[] arr2)\n{\n   bool result=true;\n   for(int i=0;i&lt;arr1.length;i++)\n   {\n     if(arr1[i].ToLowwer()!=arr2[i].ToLowwer())\n     {\n       result=false;\n       break;\n     }\n   }\n   return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6806779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JB5AAZ4T5eU/AAAAAAAAAAI/AAAAAAAAPE0/ClOM7Fpiqds/photo.jpg?sz=128", "display_name": "Parmar Dheeraj", "link": "https://stackoverflow.com/users/6806779/parmar-dheeraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1473352674, "creation_date": 1473291219, "last_edit_date": 1473293536, "question_id": 39380473, "link": "https://stackoverflow.com/questions/39380473/find-matching-string-from-two-arrays", "title": "Find matching string from two Arrays", "body": "<p>Array1</p>\n\n<pre><code>\"ANGEL MARTIN ROMERO RIVERA\"\n\"CRISOGONO CORTES ZARATE\"\n\"RAFAEL ARMANDO DE LEON ALVARADO\"\n</code></pre>\n\n<p>Array2</p>\n\n<pre><code>\"ANGEL MARTIN\"\n\"CRISOGONO ZARATE\"\n\"RAFAEL DE LEON ALVARADO\"\n</code></pre>\n\n<p>Can you please tell me how I can compare/match both arrays ???</p>\n"}, {"tags": ["c#", "regex", "email-validation"], "comments": [{"owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 2, "creation_date": 1473291514, "post_id": 39380472, "comment_id": 66088820, "body": "nice to tell us what you want to do, if you have an problems, maybe come back and show us what&#39;s not working for you?"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 1, "creation_date": 1473291611, "post_id": 39380472, "comment_id": 66088840, "body": "I&#39;d recommend starting from proper regex (from <a href=\"http://stackoverflow.com/questions/20771794/mailrfc822address-regex\" title=\"mailrfc822address regex\">stackoverflow.com/questions/20771794/mailrfc822address-regex</a>&zwnj;&#8203;), and as @KeithNicholas pointed out you need to have more than just list of requirements in the post."}, {"owner": {"reputation": 5276, "user_id": 3776535, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c960c9d125c661738fe7b61ff41b740b?s=128&d=identicon&r=PG", "display_name": "Burt_Harris", "link": "https://stackoverflow.com/users/3776535/burt-harris"}, "edited": false, "score": 1, "creation_date": 1473291670, "post_id": 39380472, "comment_id": 66088858, "body": "I don&#39;t think you can do all that with a single regex"}, {"owner": {"reputation": 2128, "user_id": 604990, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/c2GUE.jpg?s=128&g=1", "display_name": "Varun Sharma", "link": "https://stackoverflow.com/users/604990/varun-sharma"}, "reply_to_user": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1473291677, "post_id": 39380472, "comment_id": 66088861, "body": "@Keith - 1. it is allowing two consecutive full stops and 2. it is allowing emails to start and end with special characters. It should only allow [0-9a-zA-Z] at the beginning and end of the email. So $test@test.com is invalid but test%test@test.c%om is valid."}, {"owner": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1473291762, "post_id": 39380472, "comment_id": 66088876, "body": "sure it&#39;s allowing it.... what have you done to try and stop it?"}, {"owner": {"reputation": 2128, "user_id": 604990, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/c2GUE.jpg?s=128&g=1", "display_name": "Varun Sharma", "link": "https://stackoverflow.com/users/604990/varun-sharma"}, "reply_to_user": {"reputation": 40865, "user_id": 10431, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/22aac6106c44ae4078bd4c0a564714e0?s=128&d=identicon&r=PG", "display_name": "Keith Nicholas", "link": "https://stackoverflow.com/users/10431/keith-nicholas"}, "edited": false, "score": 0, "creation_date": 1473291878, "post_id": 39380472, "comment_id": 66088915, "body": "@Keith - I wrote a separate one and so there are two separate ones. I would like to have 1 regular expression. But if its not possible as Burt said then its fine."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1473292838, "post_id": 39380472, "comment_id": 66089137, "body": "This is not a question. It&#39;s a statement that you <i>want to modify it</i>. Are you asking permission to do so? Go ahead; it&#39;s OK with me if you modify it to meet those requirements."}, {"owner": {"reputation": 2128, "user_id": 604990, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/c2GUE.jpg?s=128&g=1", "display_name": "Varun Sharma", "link": "https://stackoverflow.com/users/604990/varun-sharma"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1473293096, "post_id": 39380472, "comment_id": 66089185, "body": "@Ken - No I am not asking for permission. I tried modifying it but it is breaking the existing functionality which is why asked here. Let me know if anything else is not clear to you."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1473293366, "post_id": 39380472, "comment_id": 66089241, "body": "As I said, you <b>have not asked a question</b>. You&#39;ve <b>made a statement</b>. This is a <i>question and answer</i> site, which means there should be a clear, specific question asked. You&#39;ve not done so, and you&#39;ve not shown any indication of what you&#39;ve tried (you haven&#39;t even said you did in the question) or explained how that effort didn&#39;t work. All of that explains my last comment. Let me know if anything else is not clear to you."}, {"owner": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "edited": false, "score": 1, "creation_date": 1473319889, "post_id": 39380472, "comment_id": 66097029, "body": "You should take a look at <a href=\"http://stackoverflow.com/documentation/regex/3605/useful-regex-showcase/12416/match-an-email-address#t=201609080730531388617\">this</a>"}, {"owner": {"reputation": 2128, "user_id": 604990, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/c2GUE.jpg?s=128&g=1", "display_name": "Varun Sharma", "link": "https://stackoverflow.com/users/604990/varun-sharma"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1479944785, "post_id": 39380472, "comment_id": 68775660, "body": "@Ken White - Okay. It&#39;s clear to me."}, {"owner": {"reputation": 2128, "user_id": 604990, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/c2GUE.jpg?s=128&g=1", "display_name": "Varun Sharma", "link": "https://stackoverflow.com/users/604990/varun-sharma"}, "reply_to_user": {"reputation": 27069, "user_id": 2307070, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l8ha6.jpg?s=128&g=1", "display_name": "Thomas Ayoub", "link": "https://stackoverflow.com/users/2307070/thomas-ayoub"}, "edited": false, "score": 0, "creation_date": 1479944819, "post_id": 39380472, "comment_id": 68775677, "body": "@Thomas - Thanks, there was a detailed explanation there. Thanks for that."}], "answers": [{"tags": [], "owner": {"reputation": 19060, "user_id": 4003419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lIeUm.png?s=128&g=1", "display_name": "LukStorms", "link": "https://stackoverflow.com/users/4003419/lukstorms"}, "is_accepted": true, "score": 1, "last_activity_date": 1476259666, "last_edit_date": 1476259666, "creation_date": 1473322822, "answer_id": 39385940, "question_id": 39380472, "link": "https://stackoverflow.com/questions/39380472/regular-expression-for-given-scenario/39385940#39385940", "title": "Regular Expression for given scenario", "body": "<pre class=\"lang-js prettyprint-override\"><code>^[a-zA-Z0-9]+(?:\\.?[\\w!#$%&amp;'*+/=?^`{|}~\\-]+)*@[a-zA-Z0-9](?:\\.?[\\w\\-]+)+\\.[A-Za-z0-9]+$\n</code></pre>\n\n<p>No <code>..</code> and at least 1 <code>.</code> and 1 <code>@</code>.<br>\nAlso starts/ends with letters/numbers.</p>\n\n<p>The <code>^</code> (start) and <code>$</code> (end) were just added to match a whole string, not just a substring. But you could replace those by a word boundary <code>\\b</code>.</p>\n\n<p>An alternative where the special characters aren't hardcoded:</p>\n\n<pre><code>^(?!.*[.]{2})[a-zA-Z0-9][^@\\s]*?@[a-zA-Z0-9][^@\\s]*?\\.[A-Za-z0-9]+$\n</code></pre>\n"}], "owner": {"reputation": 2128, "user_id": 604990, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/c2GUE.jpg?s=128&g=1", "display_name": "Varun Sharma", "link": "https://stackoverflow.com/users/604990/varun-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 39385940, "answer_count": 1, "score": -4, "last_activity_date": 1476259666, "creation_date": 1473291216, "question_id": 39380472, "link": "https://stackoverflow.com/questions/39380472/regular-expression-for-given-scenario", "title": "Regular Expression for given scenario", "body": "<p>I already have an email address regular expression FROM RFC 2822 FORMAT</p>\n\n<pre><code>[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\n</code></pre>\n\n<p>but want to modify it to include the following some new conditions:</p>\n\n<ol>\n<li>at least one full stop</li>\n<li>at least one @ character</li>\n<li>no consecutive full stops</li>\n<li>must not start/end with special characters i.e. should only start/end with [0-9a-zA-Z]</li>\n<li>should still follow RFC specification for regular expression rules.</li>\n</ol>\n\n<p>Currently the above one allows the email to start with special characters. Also it is allowing two consecutive full stops (except for domain name which is fine, so test@test..com fails and its correct). </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "dll", "asp.net-core", "asp.net-core-mvc", "sqlconnection"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 230912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/1d03c020c30f276dc93fd0d8e5846c12?s=128&d=identicon&r=PG", "display_name": "rcastagna", "link": "https://stackoverflow.com/users/230912/rcastagna"}, "edited": false, "score": 0, "creation_date": 1473335503, "post_id": 39380375, "comment_id": 66106344, "body": "Yes, I saw that in the docs, and figured I&#39;d give it a try - hoping that there would be an &quot;automagic&quot; translation between the old syntax and the new. Unfortunately, no such luck...the data layer .dll was still looking for the old ConfigurationManager stuff."}, {"owner": {"reputation": 1281, "user_id": 663853, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/0ABQE.jpg?s=128&g=1", "display_name": "Robert Green MBA", "link": "https://stackoverflow.com/users/663853/robert-green-mba"}, "reply_to_user": {"reputation": 153, "user_id": 230912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/1d03c020c30f276dc93fd0d8e5846c12?s=128&d=identicon&r=PG", "display_name": "rcastagna", "link": "https://stackoverflow.com/users/230912/rcastagna"}, "edited": false, "score": 0, "creation_date": 1473356668, "post_id": 39380375, "comment_id": 66120306, "body": "Do you have access to the source code for the .dll?  My thinking is that the .dll project should contain an app.config file.  So then when you use it in the other project it would look for the same settings in its configuration file.  So, then if the new project doesn&#39;t use a configuration file for its settings it doesn&#39;t mean that you can&#39;t add  a configuration file (app.config or web.config) and this may satisfy the requirements needed by the .dll.  Try it... Let me know your results."}], "tags": [], "owner": {"reputation": 1281, "user_id": 663853, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/0ABQE.jpg?s=128&g=1", "display_name": "Robert Green MBA", "link": "https://stackoverflow.com/users/663853/robert-green-mba"}, "is_accepted": false, "score": 1, "last_activity_date": 1473290422, "creation_date": 1473290422, "answer_id": 39380375, "question_id": 39380351, "link": "https://stackoverflow.com/questions/39380351/asp-net-core-ui-app-with-separate-data-dll/39380375#39380375", "title": "ASP.NET Core UI App with separate data .dll", "body": "<p>Actually you do have reference to your connection string from the new .json file.  You will do something like:</p>\n\n<pre><code>var builder = new ConfigurationBuilder();\nbuilder.AddInMemoryCollection();\nvar config = builder.Build();\nconfig[\"somekey\"] = \"somevalue\";\n\n// do some other work\n\nvar setting = config[\"somekey\"]; // also returns \"somevalue\"\n</code></pre>\n\n<p>here is a link: <a href=\"https://docs.asp.net/en/latest/fundamentals/configuration.html#getting-and-setting-configuration-settings\" rel=\"nofollow\">docs.asp.net</a></p>\n"}, {"tags": [], "owner": {"reputation": 153, "user_id": 230912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/1d03c020c30f276dc93fd0d8e5846c12?s=128&d=identicon&r=PG", "display_name": "rcastagna", "link": "https://stackoverflow.com/users/230912/rcastagna"}, "is_accepted": true, "score": 0, "last_activity_date": 1473447468, "creation_date": 1473447468, "answer_id": 39418133, "question_id": 39380351, "link": "https://stackoverflow.com/questions/39380351/asp-net-core-ui-app-with-separate-data-dll/39418133#39418133", "title": "ASP.NET Core UI App with separate data .dll", "body": "<p>I have resolved my issue with a work-around, and it will do for now. Ultimately, I'd like to find a better option, but I'm moving forward which makes my boss happy.</p>\n\n<p>I ended up changing my method signatures to accept a string value representing the connection string that's no longer in the calling project because of the conversion to Core MVC.</p>\n\n<p>In the called .dll, the code now looks to see if there is a value to the passed parameter, and, if so, uses the passed value to initialize the <code>SqlConnection</code>. If no parameter is provided, it will look to the config section in <code>web.config</code> using the <code>ConfigurationManager</code> capabilities.</p>\n\n<p>This will allow the existing project to use the code, as well as the new Core MVC project. It's a bit kludgy, but functional.</p>\n"}], "owner": {"reputation": 153, "user_id": 230912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/1d03c020c30f276dc93fd0d8e5846c12?s=128&d=identicon&r=PG", "display_name": "rcastagna", "link": "https://stackoverflow.com/users/230912/rcastagna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 39418133, "answer_count": 2, "score": -2, "last_activity_date": 1473447468, "creation_date": 1473290212, "last_edit_date": 1473314581, "question_id": 39380351, "link": "https://stackoverflow.com/questions/39380351/asp-net-core-ui-app-with-separate-data-dll", "title": "ASP.NET Core UI App with separate data .dll", "body": "<p>I'm in the process of moving the UI side of an application to the new ASP.NET Core MVC structure. Unfortunately, I still need to reference a data layer which is built in the prior-generation ASP.NET framework. This data .dll has the appropriate connection strings to various databases all being managed by <code>ConfigurationManager.ConnectionStrings[\"ConnectionStringName\"].ConnectionString</code> which required me to mimic in the UI layer in order to actually get at the data.</p>\n\n<p>Now, with ASP.NET Core MVC, the <code>web.config</code> for configuration has been replaced with the <code>appsettings.json</code> file.</p>\n\n<p>That paradigm shift breaks all my access to data since I can no longer replicate the connection string in the UI application.</p>\n\n<p>Is there an appropriate solution that can make this data layer .dll more self-contained and rely on its own, internally defined connection string(s), while still exposing the Methods to the \"containing\" application - in this case, the UI layer?</p>\n"}, {"tags": ["c#", "wpf", "listview", "scrollbar", "window-resize"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3785067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tf8iX.jpg?s=128&g=1", "display_name": "MikeGeek", "link": "https://stackoverflow.com/users/3785067/mikegeek"}, "edited": false, "score": 0, "creation_date": 1473343871, "post_id": 39380434, "comment_id": 66112452, "body": "It certainly solves the stated problem, but it creates another one.  The user can no longer reach the far right end of the last column if they drag a column divider to increase the width of one or more &#39;middle&#39; columns.  I only want to suppress the <i>automated</i> display of a horizontal scrollbar as a direct result of the user changing the width of the window."}], "tags": [], "owner": {"reputation": 543, "user_id": 1672990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iaalg.png?s=128&g=1", "display_name": "Eric Sondergard", "link": "https://stackoverflow.com/users/1672990/eric-sondergard"}, "is_accepted": false, "score": 0, "last_activity_date": 1473290902, "creation_date": 1473290902, "answer_id": 39380434, "question_id": 39380282, "link": "https://stackoverflow.com/questions/39380282/how-to-avoid-horizontal-scrollbar-during-proportional-resize-of-wpf-listview-col/39380434#39380434", "title": "How To Avoid Horizontal Scrollbar During Proportional Resize of WPF ListView Columns", "body": "<p>Setting the <code>HorizontalScrollBarVisibility</code> property to disabled should do it.</p>\n\n<pre><code>myListView.SetValue(ScrollViewer.HorizontalScrollBarVisibilityProperty,\n    ScrollBarVisibility.Disabled);\n</code></pre>\n\n<p>Or in XAML...</p>\n\n<pre><code>&lt;ListView ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\"&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3785067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tf8iX.jpg?s=128&g=1", "display_name": "MikeGeek", "link": "https://stackoverflow.com/users/3785067/mikegeek"}, "is_accepted": true, "score": 0, "last_activity_date": 1473691994, "creation_date": 1473691994, "answer_id": 39453185, "question_id": 39380282, "link": "https://stackoverflow.com/questions/39380282/how-to-avoid-horizontal-scrollbar-during-proportional-resize-of-wpf-listview-col/39453185#39453185", "title": "How To Avoid Horizontal Scrollbar During Proportional Resize of WPF ListView Columns", "body": "<p>Here's what I ended up with.  It handles a vertical scrollbar as well.  the one drawback I've found so far is that the horizontal scrollbar will sometimes flash briefly while the user is resizing the window.  If anyone knows a better way, please post!  Thanks!</p>\n\n<pre><code>        /// &lt;summary&gt;\n    /// Proportionally resize listview columns when listview size changes\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"sender\"&gt;&lt;/param&gt;\n    /// &lt;param name=\"e\"&gt;&lt;/param&gt;\n    private void onLV_FileList_SizeChanged(object sender, SizeChangedEventArgs e)\n    {\n        if ((sender is ListView) &amp;&amp; \n            (e.PreviousSize.Width &gt; 0))\n        {\n            double total_width = 0;\n            GridViewColumnCollection gvcc = ((GridView)(sender as ListView).View).Columns;\n            foreach (GridViewColumn gvc in gvcc)\n            {\n                gvc.Width = (gvc.Width / e.PreviousSize.Width) * e.NewSize.Width;\n                total_width += gvc.Width;\n            }\n\n            //Increase width of last column to fit width of listview if integer division made the total width to small\n            if (total_width &lt; e.NewSize.Width)\n            {\n                gvcc[gvcc.Count - 1].Width += (e.NewSize.Width - total_width);\n            }\n\n            //Render changes to ListView before checking for horizontal scrollbar\n            this.AllowUIToUpdate();\n\n            //Decrease width of last column to eliminate scrollbar if it is displayed now\n            ScrollViewer svFileList = this.FindVisualChild&lt;ScrollViewer&gt;(LV_FileList);\n            while ((svFileList.ComputedHorizontalScrollBarVisibility != Visibility.Collapsed) &amp;&amp;  (gvcc[gvcc.Count - 1].Width &gt; 1))\n            {\n                gvcc[gvcc.Count - 1].Width--;\n                this.AllowUIToUpdate();\n            }\n        }\n    }\n\n\n    /// &lt;summary&gt;\n    /// Threaded invocation to handle updating UI in resize loop\n    /// &lt;/summary&gt;\n    private void AllowUIToUpdate()\n    {\n        DispatcherFrame dFrame = new DispatcherFrame();\n\n        Dispatcher.CurrentDispatcher.BeginInvoke(DispatcherPriority.Render, new DispatcherOperationCallback(delegate(object parameter)\n        {\n            dFrame.Continue = false;\n            return null;\n\n        }), null);\n\n        Dispatcher.PushFrame(dFrame);\n    }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3785067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tf8iX.jpg?s=128&g=1", "display_name": "MikeGeek", "link": "https://stackoverflow.com/users/3785067/mikegeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 39453185, "answer_count": 2, "score": 0, "last_activity_date": 1473798392, "creation_date": 1473289610, "last_edit_date": 1473798392, "question_id": 39380282, "link": "https://stackoverflow.com/questions/39380282/how-to-avoid-horizontal-scrollbar-during-proportional-resize-of-wpf-listview-col", "title": "How To Avoid Horizontal Scrollbar During Proportional Resize of WPF ListView Columns", "body": "<p>Goal:  In a WPF Grid, programmatically resize the columns in a child ListView when the window size is changed, maintaining relative column sizes, without ever displaying a horizontal scrollbar.</p>\n\n<p>Currently, the proportional resizing is working very well except that when I reduce the width of the window, I will get a horizontal scrollbar that has only a tiny amount of space it scrolls.  I am wondering if this is due to the Width property not accounting for the graphic dividers between columns?.. or..?</p>\n\n<p>The part that is causing the problem is the last section where I extend the width of the last column to fill the rest of the space.  I don't want to subtract some magic number that I produce from trial &amp; error (which might work to a certain extent).</p>\n\n<p>..and yes, eventually I will account for the presence (or not) of a vertical scrollbar, but right now I just want to avoid ever seeing a horizontal scrollbar.</p>\n\n<p>Here is the code that resizes the ListView columns:</p>\n\n<pre><code>LV_FileList.SizeChanged += this.onLV_FileList_SizeChanged;\n</code></pre>\n\n<p>...</p>\n\n<pre><code>/// &lt;summary&gt;\n/// Proportionally resize listview columns when listview size changes\n/// &lt;/summary&gt;\n/// &lt;param name=\"sender\"&gt;&lt;/param&gt;\n/// &lt;param name=\"e\"&gt;&lt;/param&gt;\nprivate void onLV_FileList_SizeChanged(object sender, SizeChangedEventArgs e)\n{\n    if ((sender is ListView) &amp;&amp; \n        (e.PreviousSize.Width &gt; 0))\n    {\n        double total_width = 0;\n        GridViewColumnCollection gvcc = ((GridView)(sender as ListView).View).Columns;\n        foreach (GridViewColumn gvc in gvcc)\n        {\n            gvc.Width = (gvc.Width / e.PreviousSize.Width) * e.NewSize.Width;\n            total_width += gvc.Width;\n        }\n\n        //Increase width of last column to fit width of listview if integer division made the total width to small\n        if (total_width &lt; e.NewSize.Width)\n        {\n            gvcc[gvcc.Count - 1].Width += (e.NewSize.Width - total_width);\n        }\n    }\n}\n</code></pre>\n\n<p>I added a While loop to the problematic section, but it has the unfortunate effect of not working.  The ComputedHorizontalScrollBarVisibilityProperty value never changes as the width of the last column is decremented, so it just goes to 0 and throws an invalid value exception for the width of the column.  I even tried throwing a call to LV_FileList.UpdateLayout() in the loop, thinking that maybe the display of the listview control needs to be refreshed or something before the horizontal scrollbar goes away.  No dice.</p>\n\n<pre><code>                //Increase width of last column to fit width of listview if integer division made the total width to small\n            if (total_width &lt; e.NewSize.Width)\n            {\n                gvcc[gvcc.Count - 1].Width += (e.NewSize.Width - total_width);\n                while ((Visibility)LV_FileList.GetValue(ScrollViewer.ComputedHorizontalScrollBarVisibilityProperty) == Visibility.Visible)\n                {\n                    gvcc[gvcc.Count - 1].Width--;\n                    //LV_FileList.UpdateLayout();  &lt;-- doesn't help\n                }\n            }\n</code></pre>\n"}, {"tags": ["c#", "authentication", "cookies", "asp.net-web-api", "token"], "answers": [{"comments": [{"owner": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "edited": false, "score": 0, "creation_date": 1473307323, "post_id": 39380869, "comment_id": 66092165, "body": "Awesome!  That&#39;s reassuring as I&#39;d definitely prefer to avoid doing a lot of rework here.  So <code>cookies</code> + <code>csrf protection</code> is just as good as <code>tokens</code> from a security standpoint?"}, {"owner": {"reputation": 525, "user_id": 2870402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955dbce91d4b6a282d38fbc050bebace?s=128&d=identicon&r=PG", "display_name": "Alexey Mitev", "link": "https://stackoverflow.com/users/2870402/alexey-mitev"}, "reply_to_user": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "edited": false, "score": 1, "creation_date": 1473338423, "post_id": 39380869, "comment_id": 66108400, "body": "Yes, authentication cookies + ASP.NET AntiForgery (which by the way also uses its own cookie, see <a href=\"https://github.com/aspnet/Antiforgery/blob/dev/src/Microsoft.AspNetCore.Antiforgery/Internal/DefaultAntiforgeryTokenStore.cs\" rel=\"nofollow noreferrer\">github.com/aspnet/Antiforgery/blob/dev/src/&hellip;</a> or <a href=\"http://aspnetwebstack.codeplex.com/SourceControl/latest#src/System.Web.WebPages/Helpers/AntiXsrf/AntiForgeryTokenStore.cs\" rel=\"nofollow noreferrer\">aspnetwebstack.codeplex.com/SourceControl/latest#src/&hellip;</a> for previous version of ASP.NET) is as good as tokens from a security standpoint because ASP.NET AntiForgery is essentially a token itself: it is per-client, it is generated on the server and it is validated on the server."}, {"owner": {"reputation": 525, "user_id": 2870402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955dbce91d4b6a282d38fbc050bebace?s=128&d=identicon&r=PG", "display_name": "Alexey Mitev", "link": "https://stackoverflow.com/users/2870402/alexey-mitev"}, "reply_to_user": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "edited": false, "score": 1, "creation_date": 1473338428, "post_id": 39380869, "comment_id": 66108411, "body": "By the way, if you use ASP.NET Core on the server side you can set up AntiForgery middleware to use HTTP headers instead of form fields like this: <code>services.AddAntiforgery(options =&gt; options.HeaderName = yourHeaderName);</code>. This way you would be able to reuse default validator instead of writing your own."}], "tags": [], "owner": {"reputation": 525, "user_id": 2870402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955dbce91d4b6a282d38fbc050bebace?s=128&d=identicon&r=PG", "display_name": "Alexey Mitev", "link": "https://stackoverflow.com/users/2870402/alexey-mitev"}, "is_accepted": true, "score": 1, "last_activity_date": 1473294499, "creation_date": 1473294499, "answer_id": 39380869, "question_id": 39380152, "link": "https://stackoverflow.com/questions/39380152/webapi-tokens-vs-cookies/39380869#39380869", "title": "WebApi - Tokens vs Cookies", "body": "<p>Well, you would have to leave cookies anyway because otherwise you wouldn't be able to authenticate returning users (they would have to authenticate every time they open the app page). (Of course there are other exotic options like using client local storage or \"Flash cookies\" but this is pretty much the same approach.)</p>\n\n<p>To answer your question, yes, you will need to implement CSRF protection. It doesn't matter which implementation you choose: it can be the implementation that uses custom HTTP headers or additional WebAPI request params, it can be implemented using built-in anti-forgery API (described in the article you mentioned) or you can make your own implementation.</p>\n\n<p>I would probably implement custom CSRF protection mechanism because this way you can make it more suitable for your SPA (for example you can send it through WebAPI response as a result of authentication operation instead of rendering it to the HTML or JS as it was suggested in the article).</p>\n"}], "owner": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 2, "accepted_answer_id": 39380869, "answer_count": 1, "score": 0, "last_activity_date": 1473294499, "creation_date": 1473288725, "question_id": 39380152, "link": "https://stackoverflow.com/questions/39380152/webapi-tokens-vs-cookies", "title": "WebApi - Tokens vs Cookies", "body": "<p>I\u2019m working on an existing single-page application consuming data from WebAPI.</p>\n\n<p>Authentication is largely handled with WebSecurity and SimpleMembership via forms authentication as the application was originally built on MVC.</p>\n\n<p>I know that this is bad (CSRF), and I want to fix it either by </p>\n\n<ul>\n<li>implementing some kind of CSRF protection (preferred)</li>\n<li>or by reimplementing Authentication and Authorization to use tokens instead of cookies.</li>\n</ul>\n\n<p>Would implementing <a href=\"http://www.asp.net/web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks\" rel=\"nofollow\">header validation</a> be an adequate solution?  The API is being consumed by both web and mobile clients, in case it matters.</p>\n\n<p>I\u2019m not too skilled around security and want to make sure we\u2019re not setting ourselves up for vulnerability by using cookies here.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1473288861, "post_id": 39380151, "comment_id": 66088168, "body": "Binary operator <code>*=</code> has lower precedence than the binary operator <code>+</code>."}, {"owner": {"reputation": 15416, "user_id": 3509591, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Rshrf.jpg?s=128&g=1", "display_name": "Zze", "link": "https://stackoverflow.com/users/3509591/zze"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1473288937, "post_id": 39380151, "comment_id": 66088192, "body": "@zerkms so the msdn site is wrong? or am I missunderstanding something here?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1473288951, "post_id": 39380151, "comment_id": 66088195, "body": "It is not wrong. Why is it?"}, {"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 2, "creation_date": 1473289123, "post_id": 39380151, "comment_id": 66088242, "body": "The reason for your confusion is because the section you are looking at is the <b><i>Arithmetic Overflow</i></b> section, not the <b><i>Additive Operators</i></b> section.  You are simply misreading the documentation."}, {"owner": {"reputation": 15416, "user_id": 3509591, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Rshrf.jpg?s=128&g=1", "display_name": "Zze", "link": "https://stackoverflow.com/users/3509591/zze"}, "reply_to_user": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 0, "creation_date": 1473289210, "post_id": 39380151, "comment_id": 66088272, "body": "@DavidL yes - you are correct. My mistake - thankyou"}, {"owner": {"reputation": 8555, "user_id": 638028, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xj2Hg.png?s=128&g=1", "display_name": "Klitos Kyriacou", "link": "https://stackoverflow.com/users/638028/klitos-kyriacou"}, "edited": false, "score": 1, "creation_date": 1473289572, "post_id": 39380151, "comment_id": 66088366, "body": "I&#39;d say the MSDN documentation is slightly wrong because it says the Assignment and Lambda operators &quot;have higher precedence than the next section&quot; but the next section is not part of the list of operators. There should be no next section; that heading should instead be a footnote. The documentation implies that Assignment and Lambda operators have higher precedence than Arithmetic Overflow (whatever that would mean, if it made sense)."}, {"owner": {"reputation": 15416, "user_id": 3509591, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Rshrf.jpg?s=128&g=1", "display_name": "Zze", "link": "https://stackoverflow.com/users/3509591/zze"}, "reply_to_user": {"reputation": 8555, "user_id": 638028, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xj2Hg.png?s=128&g=1", "display_name": "Klitos Kyriacou", "link": "https://stackoverflow.com/users/638028/klitos-kyriacou"}, "edited": false, "score": 0, "creation_date": 1473289660, "post_id": 39380151, "comment_id": 66088392, "body": "@KlitosKyriacou 100% agree and not at all friendly to tired eyes &amp; mind."}, {"owner": {"reputation": 15416, "user_id": 3509591, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Rshrf.jpg?s=128&g=1", "display_name": "Zze", "link": "https://stackoverflow.com/users/3509591/zze"}, "reply_to_user": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 1, "creation_date": 1473296913, "post_id": 39380151, "comment_id": 66089926, "body": "@DavidL I have submitted feedback to the msdn doc: I think this page needs to be placed into a table like previous versions, because Arithmetic Overflow is not an operator and should be more clearly a foot note as previous versions.   In current form I think it is easy to mistake that Assignment operators take precedence over (+,-,*,/) especailly because the first sentence under &#39;Assignment and Lambda Operators&#39; states &#39;higher precedence than the next section&#39; when technically there is no operator which follows.  As mistaken by myself here: <a href=\"http://stackoverflow.com/\">stackoverflow.com</a>.... etc."}, {"owner": {"reputation": 15416, "user_id": 3509591, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Rshrf.jpg?s=128&g=1", "display_name": "Zze", "link": "https://stackoverflow.com/users/3509591/zze"}, "reply_to_user": {"reputation": 8555, "user_id": 638028, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/xj2Hg.png?s=128&g=1", "display_name": "Klitos Kyriacou", "link": "https://stackoverflow.com/users/638028/klitos-kyriacou"}, "edited": false, "score": 0, "creation_date": 1473296927, "post_id": 39380151, "comment_id": 66089929, "body": "@KlitosKyriacou See comment above."}], "answers": [{"comments": [{"owner": {"reputation": 15416, "user_id": 3509591, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Rshrf.jpg?s=128&g=1", "display_name": "Zze", "link": "https://stackoverflow.com/users/3509591/zze"}, "edited": false, "score": 0, "creation_date": 1473289315, "post_id": 39380178, "comment_id": 66088300, "body": "I have made a mistake, I was looking at the <b>Arithmetic Overflow</b> section, not the <b>Additive Operators</b> section. <i>whoops</i>"}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 4, "last_activity_date": 1473289311, "last_edit_date": 1473289311, "creation_date": 1473288937, "answer_id": 39380178, "question_id": 39380151, "link": "https://stackoverflow.com/questions/39380151/why-does-resolve-after/39380178#39380178", "title": "Why does *= resolve after +", "body": "<blockquote>\n  <p>So what is meant by the msdn site and in what cases is their statement true?</p>\n</blockquote>\n\n<p>It means exactly what it states: the sections are ordered from higher to lower precedence.</p>\n\n<p>In their list <code>*=</code> operator (it's a single operator and its precedence has no relations with the precedence of either <code>=</code> or <code>*</code>) has lower precedence than the binary <code>+</code> operator.</p>\n\n<p>So <code>+</code> is evaluated first.</p>\n"}, {"comments": [{"owner": {"reputation": 15416, "user_id": 3509591, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Rshrf.jpg?s=128&g=1", "display_name": "Zze", "link": "https://stackoverflow.com/users/3509591/zze"}, "edited": false, "score": 0, "creation_date": 1473289096, "post_id": 39380192, "comment_id": 66088235, "body": "oh whoops - haha I did mess that quote up"}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": false, "score": 0, "last_activity_date": 1473289045, "creation_date": 1473289045, "answer_id": 39380192, "question_id": 39380151, "link": "https://stackoverflow.com/questions/39380151/why-does-resolve-after/39380192#39380192", "title": "Why does *= resolve after +", "body": "<blockquote>\n  <p>These operators have higher precedence than the next section (+, -, *, /) </p>\n</blockquote>\n\n<p>You have added the <code>(+, -, *, /)</code> to this quote (incorrectly), what it actually says is:</p>\n\n<blockquote>\n  <p>These operators have higher precedence than the next section and lower precedence than the previous section.</p>\n</blockquote>\n\n<p><code>+</code> is in the <em>previous</em> section, so it has higher precedence. </p>\n"}], "owner": {"reputation": 15416, "user_id": 3509591, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/Rshrf.jpg?s=128&g=1", "display_name": "Zze", "link": "https://stackoverflow.com/users/3509591/zze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 39380178, "answer_count": 2, "score": 0, "last_activity_date": 1473289311, "creation_date": 1473288724, "last_edit_date": 1473289111, "question_id": 39380151, "link": "https://stackoverflow.com/questions/39380151/why-does-resolve-after", "title": "Why does *= resolve after +", "body": "<p>Is there ever any cuircumstance where the following algorithms are <strong>not</strong> equal?</p>\n\n<pre><code>int var1 = 2;\nint var2 = 5;\nint var3 = 7;\n\n// Scenario 1\nvar1 *= var2 + var3; // &lt;-- 24\n\n// Scenario 2\nvar1 = 2;\nvar1 *= (var2 + var3); // &lt;-- 24\n</code></pre>\n\n<p>The reason I ask is because <a href=\"https://msdn.microsoft.com/en-AU/library/6a71f45d.aspx\" rel=\"nofollow\">msdn site</a> states the following:</p>\n\n<blockquote>\n  <p>These operators have <strong>higher precedence</strong> than the next section and lower precedence than the previous section.</p>\n</blockquote>\n\n<p>However, from my testing, it seems that this is never the case? And that even without the brackets, it seems to resolve as if it had brackets.</p>\n\n<p>I would of thought that the algorithms would be equal to:</p>\n\n<pre><code>// Scenario 1\nvar1 = var1 * var2 + var3; // &lt;-- 17\n\n//Scenario 2\nvar1 = var1 * (var2 + var3); // &lt;-- 24\n</code></pre>\n\n<p><hr>\nSo what is meant by the msdn site and in what cases is their statement true?</p>\n\n<p><strong>C# fiddle for testing:</strong></p>\n\n<p><a href=\"https://dotnetfiddle.net/Yt5ZBO\" rel=\"nofollow\">https://dotnetfiddle.net/Yt5ZBO</a></p>\n"}, {"tags": ["c#", "python", ".net", "pylint", "python.net"], "comments": [{"owner": {"reputation": 4957, "user_id": 2230844, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1b0e722a4823f29c56d7a97bc6500ccc?s=128&d=identicon&r=PG", "display_name": "denfromufa", "link": "https://stackoverflow.com/users/2230844/denfromufa"}, "edited": false, "score": 1, "creation_date": 1473823458, "post_id": 39380134, "comment_id": 66282856, "body": "you can embed python in C# using pythonnet and then call pylint from C# <code>using (Py.GIL()) { dynamic pylint = Py.Import(&quot;pylint&quot;); pylint.lint.Run(new string[] {&quot;myfile.py&quot;}); }</code>"}], "owner": {"reputation": 165, "user_id": 4971299, "user_type": "registered", "profile_image": "https://graph.facebook.com/1589882327/picture?type=large", "display_name": "CodeCorrupt", "link": "https://stackoverflow.com/users/4971299/codecorrupt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 293, "favorite_count": 3, "answer_count": 0, "score": 4, "last_activity_date": 1473828278, "creation_date": 1473288597, "last_edit_date": 1473828278, "question_id": 39380134, "link": "https://stackoverflow.com/questions/39380134/passing-code-to-pylint-as-string", "title": "Passing code to PyLint as string", "body": "<p>I am in a situation where I have python embedded in a XPDL file. I'm trying to write a program run PyLint on the embedded python code.</p>\n\n<p>Currently I'm writing the python to a file, then passing that file as the argument to PyLint. I'm writing thousands of small files to disk and immediately reading.</p>\n\n<p>If there any way I could get around writing to disk as it is slowing the process down quite a bit and I haven't been able to isolate if it's PyLint running slow or all of the disk I/O.</p>\n\n<p>I'm using C# with .NET 4.0 to write this.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c#", "wpf", "xaml", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 1467, "user_id": 2125462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaffdbb9c14decd4dbeaba461359a934?s=128&d=identicon&r=PG", "display_name": "JKoplo", "link": "https://stackoverflow.com/users/2125462/jkoplo"}, "edited": false, "score": 0, "creation_date": 1473713094, "post_id": 39381755, "comment_id": 66238187, "body": "Yeah, you&#39;d think that would work, but it doesn&#39;t. I&#39;ve tried adding ClipToBounds=False on everything and it doesn&#39;t help."}, {"owner": {"reputation": 501, "user_id": 6192538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f29cc02157105846171e815429f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Agustin0987", "link": "https://stackoverflow.com/users/6192538/agustin0987"}, "reply_to_user": {"reputation": 1467, "user_id": 2125462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaffdbb9c14decd4dbeaba461359a934?s=128&d=identicon&r=PG", "display_name": "JKoplo", "link": "https://stackoverflow.com/users/2125462/jkoplo"}, "edited": false, "score": 0, "creation_date": 1473733828, "post_id": 39381755, "comment_id": 66243522, "body": "In the XAML that you posted the <code>Grid</code> in the data template and the <code>Canvas</code> called  <code>PopupCanvas</code> don&#39;t have ClipToBounds property set. Also I know it has nothing to do with the problem but I just notice that the <code>TextBox</code> has <code>Visibility = Collapsed</code>. And another thing I would try is instead of using a <code>Canvas</code> to place the <code>TextBox</code>, I would use the <code>ColumDefinitions</code> and <code>RowDefinition</code> of <code>Grid</code> to arrange the template."}, {"owner": {"reputation": 501, "user_id": 6192538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f29cc02157105846171e815429f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Agustin0987", "link": "https://stackoverflow.com/users/6192538/agustin0987"}, "reply_to_user": {"reputation": 1467, "user_id": 2125462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaffdbb9c14decd4dbeaba461359a934?s=128&d=identicon&r=PG", "display_name": "JKoplo", "link": "https://stackoverflow.com/users/2125462/jkoplo"}, "edited": false, "score": 0, "creation_date": 1473734325, "post_id": 39381755, "comment_id": 66243629, "body": "I think the problem might be the <code>ClipToBound</code> property of the <code>Grid</code> and/or <code>Canvas</code> because you gave a fix <code>Width</code> to the <code>Grid</code>. Try that. This problem could because the text is to large to fit in a <code>Grid</code> of <code>Width</code> 40 so is clipped."}, {"owner": {"reputation": 1467, "user_id": 2125462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaffdbb9c14decd4dbeaba461359a934?s=128&d=identicon&r=PG", "display_name": "JKoplo", "link": "https://stackoverflow.com/users/2125462/jkoplo"}, "edited": false, "score": 0, "creation_date": 1473956096, "post_id": 39381755, "comment_id": 66347406, "body": "Added ClipToBounds=false to the canvas and grid with no change. Also changed the TextBlock&#39;s visibility with no effect.  It&#39;s worth noting that the EllipseTemplate used as a content control works as expected with no clipping (even if arranged in a stackpanel with other EllipseTemplates). The clipping only occurs when it&#39;s used in conjunction with the listbox."}, {"owner": {"reputation": 501, "user_id": 6192538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f29cc02157105846171e815429f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Agustin0987", "link": "https://stackoverflow.com/users/6192538/agustin0987"}, "reply_to_user": {"reputation": 1467, "user_id": 2125462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaffdbb9c14decd4dbeaba461359a934?s=128&d=identicon&r=PG", "display_name": "JKoplo", "link": "https://stackoverflow.com/users/2125462/jkoplo"}, "edited": false, "score": 1, "creation_date": 1473956987, "post_id": 39381755, "comment_id": 66347889, "body": "Ok here I have another idea. I had problem with the <code>ListBox</code> before. Try replacing the <code>ListBox</code> with an <code>ItemsControl</code>."}, {"owner": {"reputation": 501, "user_id": 6192538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f29cc02157105846171e815429f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Agustin0987", "link": "https://stackoverflow.com/users/6192538/agustin0987"}, "reply_to_user": {"reputation": 1467, "user_id": 2125462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaffdbb9c14decd4dbeaba461359a934?s=128&d=identicon&r=PG", "display_name": "JKoplo", "link": "https://stackoverflow.com/users/2125462/jkoplo"}, "edited": false, "score": 0, "creation_date": 1473957166, "post_id": 39381755, "comment_id": 66347996, "body": "Also you could try to leave all the <code>ClipToBounds</code> inside the template set to <code>True</code> and remove the <code>Width</code> property of the <code>TextBox</code>."}, {"owner": {"reputation": 1467, "user_id": 2125462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaffdbb9c14decd4dbeaba461359a934?s=128&d=identicon&r=PG", "display_name": "JKoplo", "link": "https://stackoverflow.com/users/2125462/jkoplo"}, "edited": false, "score": 0, "creation_date": 1474587829, "post_id": 39381755, "comment_id": 66604308, "body": "I followed your suggestion of replacing the ListBox with an ItemsControl and the clipping went away. The ItemsControl is more in line with the functionality we required anyway. I can&#39;t select a comment as the answer, if you repost it as an answer I&#39;ll select it."}, {"owner": {"reputation": 501, "user_id": 6192538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f29cc02157105846171e815429f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Agustin0987", "link": "https://stackoverflow.com/users/6192538/agustin0987"}, "reply_to_user": {"reputation": 1467, "user_id": 2125462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaffdbb9c14decd4dbeaba461359a934?s=128&d=identicon&r=PG", "display_name": "JKoplo", "link": "https://stackoverflow.com/users/2125462/jkoplo"}, "edited": false, "score": 0, "creation_date": 1474595244, "post_id": 39381755, "comment_id": 66605892, "body": "Ok. I just reposted the comment as answer. I am glad I could help."}], "tags": [], "owner": {"reputation": 501, "user_id": 6192538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f29cc02157105846171e815429f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Agustin0987", "link": "https://stackoverflow.com/users/6192538/agustin0987"}, "is_accepted": false, "score": 0, "last_activity_date": 1473302178, "creation_date": 1473302178, "answer_id": 39381755, "question_id": 39379966, "link": "https://stackoverflow.com/questions/39379966/wpf-listbox-items-with-name-on-mouseover-or-active/39381755#39381755", "title": "WPF Listbox items with name on mouseover or active", "body": "<p>Attempt #2 sounds like is working fine. You should be able to solve the issue of the clipping using one of these solutions (or all of them):</p>\n\n<ol>\n<li>Set the <code>ClipToBounds</code> property of the <code>ListBox</code> to <code>false</code></li>\n<li>Set the <code>ClipToBounds</code> property of the <code>Stackpanel</code> to <code>false</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 501, "user_id": 6192538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f29cc02157105846171e815429f19bc?s=128&d=identicon&r=PG&f=1", "display_name": "Agustin0987", "link": "https://stackoverflow.com/users/6192538/agustin0987"}, "is_accepted": true, "score": 0, "last_activity_date": 1474595214, "creation_date": 1474595214, "answer_id": 39651333, "question_id": 39379966, "link": "https://stackoverflow.com/questions/39379966/wpf-listbox-items-with-name-on-mouseover-or-active/39651333#39651333", "title": "WPF Listbox items with name on mouseover or active", "body": "<p>Ok here I have another idea. I had problem with the <code>ListBox</code> before. Try replacing the <code>ListBox</code> with an <code>ItemsControl</code>.</p>\n"}], "owner": {"reputation": 1467, "user_id": 2125462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaffdbb9c14decd4dbeaba461359a934?s=128&d=identicon&r=PG", "display_name": "JKoplo", "link": "https://stackoverflow.com/users/2125462/jkoplo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 39651333, "answer_count": 2, "score": 0, "last_activity_date": 1474595214, "creation_date": 1473287499, "last_edit_date": 1473715915, "question_id": 39379966, "link": "https://stackoverflow.com/questions/39379966/wpf-listbox-items-with-name-on-mouseover-or-active", "title": "WPF Listbox items with name on mouseover or active", "body": "<p>I've tried several different solutions to this, but can't land on one that meets all of my needs.</p>\n\n<p>We have an observable collection of objects that each have a status and a name. It's a sort of task-list of running items. To display this list in WPF, we have some code that represents each item as an ellipse with some colors and animations.</p>\n\n<p>The problem is that we want to display the name of the item as a 'popup' both on mouseover, or when the task is in a given state.</p>\n\n<hr>\n\n<p><strong>Attempt #1</strong></p>\n\n<p>My first attempt implemented this as a Datatemplate (to be used as an ItemTemplate) with an actual WPF Popup. I implemented two datatriggers - one for mouseover and one for task state. I positioned the popup based on my ellipse and everything was great. However, moving the window or switching to a different window left the popup on top of everything.</p>\n\n<hr>\n\n<p><strong>Attempt #2</strong></p>\n\n<p>Instead of using the popup I used a textbox in a canvas. This works great until the Datatemplate is used in the Listbox. The item host (stackpanel) ends up clipping the string.</p>\n\n<p>Here's example code:</p>\n\n<pre><code>&lt;DataTemplate x:Key=\"EllipseTemplate\"&gt;\n    &lt;Grid Height=\"40\" Width=\"40\"&gt;\n        &lt;Canvas Name=\"PopupCanvas\" HorizontalAlignment=\"Center\" Width=\"500\"&gt;\n            &lt;TextBlock Name=\"PopupName\"\n                   Width=\"{Binding ElementName=PopupCanvas, Path=ActualWidth}\"\n                   Text=\"{Binding}\"\n                   Background=\"Transparent\"\n                   FontSize=\"16\" HorizontalAlignment=\"Center\" TextAlignment=\"Center\" FontWeight=\"Bold\" \n                   Canvas.Top=\"-25\"\n                   Visibility=\"Collapsed\"\n                   /&gt;\n        &lt;/Canvas&gt;\n        &lt;Ellipse x:Name=\"Ellipse\" Height=\"25\" Width=\"25\" Margin=\"0\"\n                 HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"\n                 Fill=\"Green\" \n                 RenderTransformOrigin=\"0.5, 0.5\" StrokeThickness=\"0.5\" Stroke=\"Black\"&gt;\n        &lt;/Ellipse&gt;\n    &lt;/Grid&gt;\n    &lt;DataTemplate.Triggers&gt;\n        &lt;DataTrigger Binding=\"{Binding IsMouseOver, RelativeSource={RelativeSource TemplatedParent}}\" Value=\"True\"&gt;\n            &lt;Setter TargetName=\"PopupName\" Property=\"Visibility\" Value=\"Visible\" /&gt;\n        &lt;/DataTrigger&gt;\n    &lt;/DataTemplate.Triggers&gt;\n&lt;/DataTemplate&gt;\n\n&lt;Grid Name=\"Test\" Background=\"LightGoldenrodYellow\" ClipToBounds=\"False\" Margin=\"50\"&gt;\n    &lt;ListBox Name=\"OverlayTest\" \n             Background=\"CornflowerBlue\" \n             BorderThickness=\"0\" \n             VerticalAlignment=\"Center\" \n             Margin=\"10\" \n             ClipToBounds=\"False\" \n             ItemTemplate=\"{StaticResource EllipseTemplate}\"&gt;\n        &lt;sys:String&gt;Very long string that will get clipped&lt;/sys:String&gt;\n        &lt;sys:String&gt;Two&lt;/sys:String&gt;\n        &lt;ListBox.ItemsPanel&gt;\n            &lt;ItemsPanelTemplate&gt;\n                &lt;StackPanel Orientation=\"Horizontal\" IsItemsHost=\"True\" Margin=\"10,50,10,50\" ClipToBounds=\"False\"/&gt;\n            &lt;/ItemsPanelTemplate&gt;\n        &lt;/ListBox.ItemsPanel&gt;\n    &lt;/ListBox&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/WiFlR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WiFlR.png\" alt=\"Example of clipping\"></a></p>\n\n<hr>\n\n<p><strong>Attempt #3</strong></p>\n\n<p>I moved my canvas/textbox outside of the datatemplate and create a grid to put it above the listbox of ellipses. This works from a layout perspective, but creates a big mess in terms of checking for mouseover and centering the textbox on the control that's active/hovered.</p>\n\n<hr>\n\n<p>So that leaves me without an implementation that works the way I want. Anyone have any suggestions?</p>\n"}, {"tags": ["c#", "casting", "overflowexception"], "comments": [{"owner": {"reputation": 70250, "user_id": 189950, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1c322903e59543003a482710cc4b5cda?s=128&d=identicon&r=PG", "display_name": "Kirk Woll", "link": "https://stackoverflow.com/users/189950/kirk-woll"}, "reply_to_user": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1473287744, "post_id": 39379948, "comment_id": 66087855, "body": "@HansPassant, makes sense, but unfortunate in terms of &quot;pit of success&quot; criteria...  But thanks for sharing."}], "owner": {"reputation": 70250, "user_id": 189950, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1c322903e59543003a482710cc4b5cda?s=128&d=identicon&r=PG", "display_name": "Kirk Woll", "link": "https://stackoverflow.com/users/189950/kirk-woll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "closed_date": 1473287671, "answer_count": 0, "score": 2, "last_activity_date": 1473311245, "creation_date": 1473287397, "last_edit_date": 1473311245, "question_id": 39379948, "link": "https://stackoverflow.com/questions/39379948/why-is-an-overflowexception-raised-in-this-situation", "closed_reason": "Duplicate", "title": "Why is an OverflowException raised in this situation?", "body": "<p>Why isn't this code idempotent?</p>\n\n<pre><code>double.Parse(double.MinValue.ToString())\n</code></pre>\n\n<p>This will throw an <code>OverflowException</code> with the message</p>\n\n<blockquote>\n  <p>Value was either too large or too small for a Double</p>\n</blockquote>\n\n<p>I would expect this expression to result in a <code>double</code> whose value was equal to <code>double.MinValue</code>.  What is the reason it fails?</p>\n"}, {"tags": ["c#", "entity-framework", "ef-code-first"], "comments": [{"owner": {"reputation": 123, "user_id": 1234773, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GhmSW.jpg?s=128&g=1", "display_name": "Josh Coulter", "link": "https://stackoverflow.com/users/1234773/josh-coulter"}, "edited": false, "score": 0, "creation_date": 1473288014, "post_id": 39379942, "comment_id": 66087931, "body": "If get or set has a body, they both must have a body (they are no longer auto-properties).  Duplicated by a few other questions, including: <a href=\"http://stackoverflow.com/questions/4810415/c-sharp-must-declare-a-body-because-it-is-not-marked-abstract-extern-or-parti\">http://stackoverflow.com/questions/4810415/c-sharp-must-decl&zwnj;&#8203;are-a-body-because-i&zwnj;&#8203;t-is-not-marked-abst&zwnj;&#8203;ract-extern-or-parti</a>"}], "answers": [{"tags": [], "owner": {"reputation": 543, "user_id": 1672990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iaalg.png?s=128&g=1", "display_name": "Eric Sondergard", "link": "https://stackoverflow.com/users/1672990/eric-sondergard"}, "is_accepted": true, "score": 1, "last_activity_date": 1473288109, "creation_date": 1473288109, "answer_id": 39380069, "question_id": 39379942, "link": "https://stackoverflow.com/questions/39379942/overriding-dbcontext-get-set/39380069#39380069", "title": "Overriding DbContext get; set;", "body": "<p>You just need the braces.</p>\n\n<pre><code>public DbSet&lt;Photo&gt; Photos {\n    get { return (DbSet&lt;Photo&gt;)DbPhotos.Where(s =&gt; !s.ToDelete); }\n    set {}\n}\n</code></pre>\n\n<p>As another commenter said, as soon as you give either <code>get</code> or <code>set</code> a body, the property is no longer an auto-property. So the syntax won't allow you to treat it as such.</p>\n"}], "owner": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 39380069, "answer_count": 1, "score": 1, "last_activity_date": 1473288109, "creation_date": 1473287340, "question_id": 39379942, "link": "https://stackoverflow.com/questions/39379942/overriding-dbcontext-get-set", "title": "Overriding DbContext get; set;", "body": "<p>I have a <code>DbSet&lt;Photo&gt;</code> that I would like to use as a proxy to actual  objects:</p>\n\n<pre><code>   public DbSet&lt;Photo&gt; Photos {\n        get { return (DbSet&lt;Photo&gt;)DbPhotos.Where(s =&gt; !s.ToDelete); }\n        set; // compilation error\n    }\n</code></pre>\n\n<p>For some reason, <code>set</code> is unhappy saying <code>Accessor must declare a body</code>.  </p>\n\n<p>How do I implement the default <code>set</code> behavior while overriding the <code>get</code>?  </p>\n"}, {"tags": ["c#", "entity-framework", "configuration", "ef-fluent-api"], "comments": [{"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1474576810, "post_id": 39379896, "comment_id": 66600349, "body": "Well, a good start would be to show the database schema. What you show is a class model. And try to explain more exactly what you want to model. Yes, 0-1, but what is 0 (actually 0..1) and what is 1?"}, {"owner": {"reputation": 3931, "user_id": 434437, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e3ff098c6f1a2be291abc8df58bbee4c?s=128&d=identicon&r=PG", "display_name": "jwize", "link": "https://stackoverflow.com/users/434437/jwize"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1474578148, "post_id": 39379896, "comment_id": 66600987, "body": "This is using code first and the nullable PhotoId explains the 0 does it not? It has been a while since I wrote this but the Upload"}], "owner": {"reputation": 3931, "user_id": 434437, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e3ff098c6f1a2be291abc8df58bbee4c?s=128&d=identicon&r=PG", "display_name": "jwize", "link": "https://stackoverflow.com/users/434437/jwize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474578274, "creation_date": 1473287055, "last_edit_date": 1474578274, "question_id": 39379896, "link": "https://stackoverflow.com/questions/39379896/how-can-use-entity-framework-to-configure-0-1-relation-with-non-normalized-sch", "title": "How can use Entity Framework to configure 0 - 1 relation with non-normalized schema?", "body": "<p>I realize there are many zero to one questions out there but I am not having any luck understanding them relating to my scenario. When I say \"non normalized schema,\" I mean there is no <code>Photo</code> table which would be very simple to configure for me. It seems every example I have looked at assumes tables are, \"normalized (ie. they would have <code>Photo</code> and <code>Upload</code> tables).\" Since, I don't have time to refactor this at the moment, here is my challenge. </p>\n\n<p>Schema for database</p>\n\n<pre><code>public class Employee\n{\n    public virtual ICollection&lt;Upload&gt; Uploads {get;set;}\n    public Int32? PhotoId {get;set;}\n    public Upload Photo {get;set;}\n}\n\npublic class Upload\n{\n    public virtual ICollection&lt;Employee&gt; Employees {get;set;}\n}\n</code></pre>\n\n<p>There is a join table named <code>EmployeeUpload</code> so I can use the entities <code>employee.Uploads</code> or <code>upload.Employees</code>.</p>\n\n<p>The many-to-many was simple to configure: </p>\n\n<pre><code>HasMany(t =&gt; t.Uploads)\n    .WithMany(t =&gt; t.Employees)\n    .Map(m =&gt;\n    {\n        m.ToTable(\"EmployeeUpload\");\n        m.MapLeftKey(\"EmployeeId\");\n        m.MapRightKey(\"UploadId\");\n    });\n</code></pre>\n\n<p>However, it seems that nothing I try will allow me to configure the latter which is the optional photo. I have tried just about every configuration I can think of but I always seem to get a configuration or database error. I even tried to do a <code>WithMany</code> from the <code>Upload</code> side but only some uploads have valid <code>Employee</code> it fails (I could be wrong here).</p>\n\n<p>If possible I would like to leave the schema the way it is. </p>\n"}, {"tags": ["c#", "xml", "xsd", "xml-serialization", "xsd.exe"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 3923459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/788e4876c3630564263714f237f8c393?s=128&d=identicon&r=PG&f=1", "display_name": "orlando15767", "link": "https://stackoverflow.com/users/3923459/orlando15767"}, "edited": false, "score": 0, "creation_date": 1473297113, "post_id": 39380889, "comment_id": 66089968, "body": "That worked and created the data as xml like I needed. However, for each record it&#39;s placing it in &lt;table&gt;&lt;/table&gt; tags and not the defined element tag in the xsd. How could I modify this? Also, how can I can the other element that is required from another table to the same xml? How do you combine all tables into one query that the adapter will recognize and the dataset will read?   For this particular use case I&#39;ll have roughly 20k elements of TTC_Queue and 1 of ROW_COUNTS that are all in the same  root. Please let me know if more information is needed. Thank you for the assistance."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "reply_to_user": {"reputation": 65, "user_id": 3923459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/788e4876c3630564263714f237f8c393?s=128&d=identicon&r=PG&f=1", "display_name": "orlando15767", "link": "https://stackoverflow.com/users/3923459/orlando15767"}, "edited": false, "score": 0, "creation_date": 1473298612, "post_id": 39380889, "comment_id": 66090289, "body": "A dataset consists of multiple tables so you could use DataTable dt = new DataTable(); adapter.Fill(dt); ds.Tables.Add(dt);  Each table has a name property so you can change the Table name as follows : dt.TableName = &quot;New Table Name&quot;; or in the constructor new DataTable(&quot;table name&quot;);  You can change column names in DataTable by using an &#39;AS&#39; in the query to the database like  : SELECT COLA as abc"}, {"owner": {"reputation": 65, "user_id": 3923459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/788e4876c3630564263714f237f8c393?s=128&d=identicon&r=PG&f=1", "display_name": "orlando15767", "link": "https://stackoverflow.com/users/3923459/orlando15767"}, "edited": false, "score": 0, "creation_date": 1473363645, "post_id": 39380889, "comment_id": 66123951, "body": "Is there a way using this method to update the &lt;TABLENAME&gt; tags to include the xmlns=&quot;_TTC_Queue&quot; portion and also edit/modify the root to include the xmlns:xsi and schemaLocation? thanks"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "reply_to_user": {"reputation": 65, "user_id": 3923459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/788e4876c3630564263714f237f8c393?s=128&d=identicon&r=PG&f=1", "display_name": "orlando15767", "link": "https://stackoverflow.com/users/3923459/orlando15767"}, "edited": false, "score": 0, "creation_date": 1473368421, "post_id": 39380889, "comment_id": 66126278, "body": "Not sure.  I will investigate."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "reply_to_user": {"reputation": 65, "user_id": 3923459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/788e4876c3630564263714f237f8c393?s=128&d=identicon&r=PG&f=1", "display_name": "orlando15767", "link": "https://stackoverflow.com/users/3923459/orlando15767"}, "edited": false, "score": 0, "creation_date": 1473401367, "post_id": 39380889, "comment_id": 66135050, "body": "DataSet and DataTable both have string properties NameSpace and Prefix.  Leaving Prefix null will give default namespace and setting Namespace to &quot;TTC_Queue&quot; will give xmlns=&quot;TTC_Queue&quot;.  Setting prefix to &#39;xsi&#39; will and Namespace to &quot;TTC_Queue&quot; will give xmlns:xsi=&quot;TTC_Queue&quot;."}], "tags": [], "owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "is_accepted": true, "score": 0, "last_activity_date": 1473294705, "creation_date": 1473294705, "answer_id": 39380889, "question_id": 39379874, "link": "https://stackoverflow.com/questions/39379874/c-how-to-populate-cass-created-from-xsd-exe-from-database/39380889#39380889", "title": "C# how to populate cass created from xsd.exe from database", "body": "<p>I don't think serializing is the right approach in this case.  If you generate a SQL Query properly I think the code below should work</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Data;\nusing System.Data.SqlClient;\n\nnamespace ConsoleApplication1\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            DataSet ds = new DataSet();\n            ds.ReadXmlSchema(\"filename\");\n            string SQL = \"SELECT QUERY\";\n            string connStr = \"Enter you connection string here\";\n            SqlDataAdapter adapter = new SqlDataAdapter(SQL, connStr);\n            adapter.Fill(ds);\n\n            ds.WriteXml(\"filename\");\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 3923459, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/788e4876c3630564263714f237f8c393?s=128&d=identicon&r=PG&f=1", "display_name": "orlando15767", "link": "https://stackoverflow.com/users/3923459/orlando15767"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 39380889, "answer_count": 1, "score": 0, "last_activity_date": 1473294705, "creation_date": 1473286902, "question_id": 39379874, "link": "https://stackoverflow.com/questions/39379874/c-how-to-populate-cass-created-from-xsd-exe-from-database", "title": "C# how to populate cass created from xsd.exe from database", "body": "<p>i'm currently working a case where i have to import a lot of data from the database and output it as an xml that matches to an xsd schema. i used xsd.exe to generate the c# class for a particular schema.</p>\n\n<p>my question is, how do i use this class to be populated w/ data from the database?</p>\n\n<p>my class looks like this: ` </p>\n\n<pre><code>[System.CodeDom.Compiler.GeneratedCodeAttribute(\"xsd\", \"4.0.30319.33440\")]\n    [System.SerializableAttribute()]\n    [System.Diagnostics.DebuggerStepThroughAttribute()]\n    [System.ComponentModel.DesignerCategoryAttribute(\"code\")]\n    [System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true, Namespace = \"TTC_Queue\")]\n    [System.Xml.Serialization.XmlRootAttribute(Namespace = \"MT_Queue\", IsNullable = false)]\n    public partial class STAGING_Low\n    {\n        private object[] itemsField;\n\n        /// &lt;remarks/&gt;\n        [System.Xml.Serialization.XmlElementAttribute(\"TTC_Queue\", typeof(TTC_Queue))]\n        [System.Xml.Serialization.XmlElementAttribute(\"ROW_COUNTS\", typeof(ROW_COUNTS))]\n        public object[] Items\n        {\n            get\n            {\n                return this.itemsField;\n            }\n            set\n            {\n                this.itemsField = value;\n            }\n        }\n    }\n\n    /// &lt;remarks/&gt;\n    [System.CodeDom.Compiler.GeneratedCodeAttribute(\"xsd\", \"4.0.30319.33440\")]\n    [System.SerializableAttribute()]\n    [System.Diagnostics.DebuggerStepThroughAttribute()]\n    [System.ComponentModel.DesignerCategoryAttribute(\"code\")]\n    [System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true, Namespace = \"TTC_Queue\")]\n    public partial class TTC_Queue\n    {\n        private System.Data.SqlTypes.SqlDecimal reportingUnitCodeField;\n\n        private bool reportingUnitCodeFieldSpecified;\n\n        private System.Data.SqlTypes.SqlString preparerNField;\n        //more fields\n\n`\n</code></pre>\n\n<p>i will have multiple elements of the \"ttc_queue\" to populate in this.\ni already have populated an object[] of ttc_queue to be used in this.</p>\n\n<p>how do i set this array to the \"item fields\" and then also deserialize this?</p>\n\n<p>i currently have:</p>\n\n<pre><code> STAGING_low low = new STAGING_Low();\nlow.Items = new TTC_Queue[1];\nlow.Items.SetValue(myObject[],0);\n</code></pre>\n\n<p>where i'm setting the value i get an error:</p>\n\n<blockquote>\n  <p>An unhandled exception of type 'System.InvalidCastException' occurred in mscorlib.dll</p>\n  \n  <p>Additional information: Object cannot be stored in an array of this\n  type.</p>\n</blockquote>\n\n<p>i'm not sure what i'm missing.</p>\n\n<p>thanks for the assistance.</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc-4", "oop"], "comments": [{"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 0, "creation_date": 1473286827, "post_id": 39379813, "comment_id": 66087568, "body": "This probably should (and probably will) be closed as primarily opinion-based.  That said, my two cents are that objects (particularly those represented by interfaces) allow for variance, expansion of the API without severe costs to the invoker, and better encapsulation.  Use objects more and use them sooner rather than later."}, {"owner": {"reputation": 2919, "user_id": 775489, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d55c33b1e820d1b7e53b39db352fb5ed?s=128&d=identicon&r=PG", "display_name": "Losbear", "link": "https://stackoverflow.com/users/775489/losbear"}, "reply_to_user": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 0, "creation_date": 1473287529, "post_id": 39379813, "comment_id": 66087790, "body": "So there&#39;s no negative performance passing an object (even a large object) to a method vs passing in several/many parameters?"}, {"owner": {"reputation": 3425, "user_id": 1235495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CflFh.png?s=128&g=1", "display_name": "qwr", "link": "https://stackoverflow.com/users/1235495/qwr"}, "edited": false, "score": 1, "creation_date": 1473287719, "post_id": 39379813, "comment_id": 66087849, "body": "In your case use parameters. It is cleaner and independent. One can easily see what he needs to provide as arguments. For second choice it is better to do  when function is fully dependent on User object. in your case it just using some"}, {"owner": {"reputation": 3425, "user_id": 1235495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CflFh.png?s=128&g=1", "display_name": "qwr", "link": "https://stackoverflow.com/users/1235495/qwr"}, "edited": false, "score": 1, "creation_date": 1473287874, "post_id": 39379813, "comment_id": 66087888, "body": "@Losbear passing object will just copy reference of object. So it is ok. But I not reccomend it as I mentioned above."}, {"owner": {"reputation": 3425, "user_id": 1235495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CflFh.png?s=128&g=1", "display_name": "qwr", "link": "https://stackoverflow.com/users/1235495/qwr"}, "edited": false, "score": 0, "creation_date": 1473288342, "post_id": 39379813, "comment_id": 66088027, "body": "@Losbear is User object is your viewmodel ?"}, {"owner": {"reputation": 2919, "user_id": 775489, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d55c33b1e820d1b7e53b39db352fb5ed?s=128&d=identicon&r=PG", "display_name": "Losbear", "link": "https://stackoverflow.com/users/775489/losbear"}, "edited": false, "score": 0, "creation_date": 1473288936, "post_id": 39379813, "comment_id": 66088191, "body": "No, not my ViewModel - All my controllers inherit from a custom &#39;base controller&#39; that has a property &quot;m_CurrentUser&quot; that is this User object.  The m_CurrentUser is used by the Actions to get request-related data, including loading ViewModels"}], "answers": [{"comments": [{"owner": {"reputation": 2919, "user_id": 775489, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d55c33b1e820d1b7e53b39db352fb5ed?s=128&d=identicon&r=PG", "display_name": "Losbear", "link": "https://stackoverflow.com/users/775489/losbear"}, "edited": false, "score": 0, "creation_date": 1473287416, "post_id": 39379864, "comment_id": 66087750, "body": "Understood, but it&#39;s not that simple. Some methods are simple methods that return a single value but need several params to contruct that value.  Other methods do a bunch fo things (eg; build reports, etc) that is determined by the params passed in.  Some methods keep getting improved upon - clients keep asking for new features to be added, but in order to make the method do it, i now have to add yet another param, etc.  That&#39;s why i&#39;m trying to determine what&#39;s the &quot;breaking point&quot;"}, {"owner": {"reputation": 47817, "user_id": 2535611, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d61593cac94336661b986823abb9852e?s=128&d=identicon&r=PG", "display_name": "rafaelc", "link": "https://stackoverflow.com/users/2535611/rafaelc"}, "reply_to_user": {"reputation": 2919, "user_id": 775489, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d55c33b1e820d1b7e53b39db352fb5ed?s=128&d=identicon&r=PG", "display_name": "Losbear", "link": "https://stackoverflow.com/users/775489/losbear"}, "edited": false, "score": 1, "creation_date": 1473287575, "post_id": 39379864, "comment_id": 66087803, "body": "Each method should do one - and only one - thing. So if you have methods doing 100 differents things with 20 parameters being passed, something is wrong. Try to unit test your methods, that&#39;ll help you think about the model of your code"}], "tags": [], "owner": {"reputation": 47817, "user_id": 2535611, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d61593cac94336661b986823abb9852e?s=128&d=identicon&r=PG", "display_name": "rafaelc", "link": "https://stackoverflow.com/users/2535611/rafaelc"}, "is_accepted": false, "score": 2, "last_activity_date": 1473286825, "creation_date": 1473286825, "answer_id": 39379864, "question_id": 39379813, "link": "https://stackoverflow.com/questions/39379813/how-to-determine-if-passing-in-an-object-is-better-than-several-parameters-int/39379864#39379864", "title": "How to determine if passing in an object is better than several parameters (int, string, etc)", "body": "<p>You should think about <em>what the method is supposed to do</em> . Why does the method exist?</p>\n\n<p>The semantic of the method will determine its arguments. So, for example, if <code>HelloWord</code> is supposed to print some stuff out, like a <code>userId</code>, and <code>something else</code>, then the signature should contain <code>userId</code> and <code>something else</code> as arguments.</p>\n\n<p>On the other hand, if <code>HelloWord</code> is supposed to print out some information about a <code>User</code>, then the method signature should have the object User as a parameter.</p>\n\n<p>It all depends on the method semantic.</p>\n"}, {"comments": [{"owner": {"reputation": 2919, "user_id": 775489, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d55c33b1e820d1b7e53b39db352fb5ed?s=128&d=identicon&r=PG", "display_name": "Losbear", "link": "https://stackoverflow.com/users/775489/losbear"}, "edited": false, "score": 0, "creation_date": 1473288436, "post_id": 39379985, "comment_id": 66088048, "body": "In the case of my User object, an instance of the object is only created after the user&#39;s cookie has been read, decrypted &amp; authenticated against my datasource. The User object is then only used on backend to process the request, so it&#39;s highly unlikely it&#39;ll be hacked or injected. But I do hear your point regarding giving the method &quot;more power&quot; than it needs - which could introduce problems down the road.  Thanks for the input!"}, {"owner": {"reputation": 76753, "user_id": 1026459, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/pv5mS.png?s=128&g=1", "display_name": "Travis J", "link": "https://stackoverflow.com/users/1026459/travis-j"}, "reply_to_user": {"reputation": 2919, "user_id": 775489, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d55c33b1e820d1b7e53b39db352fb5ed?s=128&d=identicon&r=PG", "display_name": "Losbear", "link": "https://stackoverflow.com/users/775489/losbear"}, "edited": false, "score": 0, "creation_date": 1473288961, "post_id": 39379985, "comment_id": 66088199, "body": "@Losbear - Authenticated clients are the ones with the most access to cause problems."}], "tags": [], "owner": {"reputation": 76753, "user_id": 1026459, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/pv5mS.png?s=128&g=1", "display_name": "Travis J", "link": "https://stackoverflow.com/users/1026459/travis-j"}, "is_accepted": false, "score": 1, "last_activity_date": 1473287626, "creation_date": 1473287626, "answer_id": 39379985, "question_id": 39379813, "link": "https://stackoverflow.com/questions/39379813/how-to-determine-if-passing-in-an-object-is-better-than-several-parameters-int/39379985#39379985", "title": "How to determine if passing in an object is better than several parameters (int, string, etc)", "body": "<p>There is a very important difference here, and this is not an opinion.</p>\n\n<blockquote>\n  <p>I have a class/object called \"User\" that has about a dozen properties</p>\n</blockquote>\n\n<p>Given the above situation, if you were then to allow <code>(User user)</code> as opposed to only allowing <code>(Guid userGUID, Guid accountGUID, bool somethingElse)</code> you have just introduced a security hole.</p>\n\n<p>Clients would be able to send more data than they were supposed to have access to by posting the extra names of the <code>User</code> class. For example, it is possible for a client to alter foreign navigation property keys in this fashion if you make the entire class available (and it had foreign relations). It is also possible for clients to alter timestamps, and even logical separations depending on information stored in that class.</p>\n\n<p>Preventing this type of breach is easy to do if you allow the entire class to be accepted, you just need to then manually inspect each property to make sure it wasn't erroneously sent, or screen it by only selecting the subset of information sent. Either way, this is a bad idea.</p>\n\n<p>While there may be no difference in using a <code>User</code> class with the same properties as the 3 shown, allowing the model binding of a <code>User</code> class which has a larger set than the 3 can be problematic if left unchecked.</p>\n"}, {"comments": [{"owner": {"reputation": 2919, "user_id": 775489, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d55c33b1e820d1b7e53b39db352fb5ed?s=128&d=identicon&r=PG", "display_name": "Losbear", "link": "https://stackoverflow.com/users/775489/losbear"}, "edited": false, "score": 0, "creation_date": 1473288581, "post_id": 39380029, "comment_id": 66088095, "body": "I&#39;ll have a look into &quot;Clean Code&quot; - sounds interesting.  I&#39;m leaning towards leaving params in place based on what you, qwr &amp; Travis said - primarily on the basic principle that effeciency is lost anytime you pass more than you are going to use. Thanks all!"}], "tags": [], "owner": {"reputation": 1629, "user_id": 93125, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9a07de9449eb3e9760101c8f60542b6a?s=128&d=identicon&r=PG", "display_name": "Miniver Cheevy", "link": "https://stackoverflow.com/users/93125/miniver-cheevy"}, "is_accepted": true, "score": 1, "last_activity_date": 1473288157, "last_edit_date": 1473288157, "creation_date": 1473287832, "answer_id": 39380029, "question_id": 39379813, "link": "https://stackoverflow.com/questions/39379813/how-to-determine-if-passing-in-an-object-is-better-than-several-parameters-int/39380029#39380029", "title": "How to determine if passing in an object is better than several parameters (int, string, etc)", "body": "<p>In Clean Code, Robert Martin says to prefer 0 arguments, 1 or 2 arguments are acceptable and 3 is too many.  </p>\n\n<p>In my opinion as long as you're in the same process I think passing the object is preferable to passing arguments.  You wouldn't want to send (or receive) more than is needed to another process (say a web service).</p>\n\n<p>I highly recommend Clean Code, it's a good read and has a lot to say about structure.</p>\n"}], "owner": {"reputation": 2919, "user_id": 775489, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d55c33b1e820d1b7e53b39db352fb5ed?s=128&d=identicon&r=PG", "display_name": "Losbear", "link": "https://stackoverflow.com/users/775489/losbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1473288185, "accepted_answer_id": 39380029, "answer_count": 3, "score": 3, "last_activity_date": 1473289160, "creation_date": 1473286520, "last_edit_date": 1473289160, "question_id": 39379813, "link": "https://stackoverflow.com/questions/39379813/how-to-determine-if-passing-in-an-object-is-better-than-several-parameters-int", "closed_reason": "Opinion-based", "title": "How to determine if passing in an object is better than several parameters (int, string, etc)", "body": "<p>I have a class/object called \"User\" that has about a dozen properties (eg: UserGUID, UserName, etc.). It has a constructor, static methods, couple other helpers/support methods, etc.</p>\n\n<p>The website has hundreds of functions/methods where 2+ parameters come from the User object. For example:</p>\n\n<pre><code>public string HelloWorld(Guid userGUID, Guid accountGUID, bool somethingElse)\n{\n    //Do something\n}\n</code></pre>\n\n<p>I really want to pass in the User object itself to make the call cleaner and not have to keep adding parameters everytime I need a new value from the User object. Like this:</p>\n\n<pre><code>public string HelloWorld(User user)\n{\n    //Do something\n    Guid userGUID = user.UserGUID;\n}\n</code></pre>\n\n<p>So my question is, at what point is passing in the object good/bad vs passing in several parameters?  Does it depend on the size of the object? How would I determine what's \"too big\" vs \"OK\"?  Is it the number of parameters? How many params is too many?</p>\n"}, {"tags": ["c#", ".net", "vb.net", "web-services", "wcf"], "comments": [{"owner": {"reputation": 106158, "user_id": 932418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/245e0f0dce8e71cb477b5aa8dff496a6?s=128&d=identicon&r=PG", "display_name": "L.B", "link": "https://stackoverflow.com/users/932418/l-b"}, "edited": false, "score": 0, "creation_date": 1473286584, "post_id": 39379810, "comment_id": 66087491, "body": "Any code to post?"}, {"owner": {"reputation": 23, "user_id": 4421465, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3baff2ca5a39f9c9cbdb3c4ec4b55e24?s=128&d=identicon&r=PG&f=1", "display_name": "TheRaoMeister", "link": "https://stackoverflow.com/users/4421465/theraomeister"}, "reply_to_user": {"reputation": 106158, "user_id": 932418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/245e0f0dce8e71cb477b5aa8dff496a6?s=128&d=identicon&r=PG", "display_name": "L.B", "link": "https://stackoverflow.com/users/932418/l-b"}, "edited": false, "score": 0, "creation_date": 1473286782, "post_id": 39379810, "comment_id": 66087556, "body": "@L.B pretty straight forward....       Dim ecomWS As New EcomWS.EcometryPayment       Dim ecomOrdDtTab As New DataTable       ecomWS.UseDefaultCredentials = True       ecomOrdDtTab = ecomWS.GetEcometryOrders"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4421465, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3baff2ca5a39f9c9cbdb3c4ec4b55e24?s=128&d=identicon&r=PG&f=1", "display_name": "TheRaoMeister", "link": "https://stackoverflow.com/users/4421465/theraomeister"}, "edited": false, "score": 0, "creation_date": 1473347990, "post_id": 39379971, "comment_id": 66115492, "body": "Thanks, makes sense that the credentials wouldn&#39;t be making it to the existing web service. I did try <code>&lt;serviceAuthorization impersonateCallerForAllOperations=&quot;true&quot; &#47;&gt;</code> and had to set <code>&lt;OperationBehavior(Impersonation:=ImpersonationOption.Requir&zwnj;&#8203;ed)&gt;</code> for it to work. I get a different error now  &gt; Either a required impersonation level was not provided, or the provided impersonation level is invalid. I also tried setting the <code>endpointBehavior</code> like so <code>&lt;windows allowedImpersonationLevel=&quot;Impersonation&quot; &#47;&gt;</code> which did not help. Kerberos or passing credentials is not an option unfortunately."}], "tags": [], "owner": {"reputation": 21, "user_id": 6806671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84dbda1d5974e06a414bb52999980ed9?s=128&d=identicon&r=PG&f=1", "display_name": "Marlon Taborda", "link": "https://stackoverflow.com/users/6806671/marlon-taborda"}, "is_accepted": false, "score": 0, "last_activity_date": 1473287897, "last_edit_date": 1473287897, "creation_date": 1473287560, "answer_id": 39379971, "question_id": 39379810, "link": "https://stackoverflow.com/questions/39379810/webservice-call-from-wcf-service/39379971#39379971", "title": "Webservice call from WCF service", "body": "<p>Your problem it's something called double hop.\nYou have some options, use kerberos, pass in your code a valid credentials when your are calling a soap service or impersonate your wcf service, but you have to test it. \n<code>&lt;serviceAuthorization impersonateCallerForAllOperations=\"true\" /&gt;</code></p>\n"}], "owner": {"reputation": 23, "user_id": 4421465, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3baff2ca5a39f9c9cbdb3c4ec4b55e24?s=128&d=identicon&r=PG&f=1", "display_name": "TheRaoMeister", "link": "https://stackoverflow.com/users/4421465/theraomeister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1473311364, "creation_date": 1473286505, "last_edit_date": 1473311364, "question_id": 39379810, "link": "https://stackoverflow.com/questions/39379810/webservice-call-from-wcf-service", "title": "Webservice call from WCF service", "body": "<p>We have an existing web service (SOAP/XML) which is windows authenticated. We are adding a new WCF service which has anonymous authentication. When calling a function from the existing web service from the WCF service I get the following error</p>\n\n<blockquote>\n  <p>The request failed with HTTP status 401: Unauthorized.</p>\n</blockquote>\n\n<p>We do have other console and web applications calling the existing service with no issues. </p>\n\n<p>I tried setting the <code>UseDefautlCredentials</code> to <code>True</code> and does not make a difference (<code>WS.UseDefaultCredentials = True</code>). </p>\n\n<p>Also tried adding the existing service as a service reference as opposed to a web reference and I get a different error</p>\n\n<blockquote>\n  <p>The HTTP request is unauthorized with client authentication scheme 'Anonymous'. The authentication header received from the server was 'Negotiate,NTLM'.</p>\n</blockquote>\n\n<p>I really do not want to change the authentication to anonymous on the existing web service since it is AD authenticated. </p>\n\n<p>Would really appreciate any kind of help. Thanks a lot.</p>\n"}, {"tags": ["c#", "asp.net-mvc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1473288331, "post_id": 39379809, "comment_id": 66088022, "body": "Its a bit unclear why your creating a custom <code>RemoteAttribute</code> - all this is handles out of the box by the in-built attribute (by using the <code>AdditionalFiields</code> property to pass back the values of the other properties (which would include the ID of the model so you can check if its new or existing). And if you want to return different error messages, then its just <code>return Json(&quot;your error message&quot;, JsonRequestBehavior.AllowGet);</code> and that error will be displayed in the <code>@ValidationMessageFor()</code> placeholder"}, {"owner": {"reputation": 2409, "user_id": 1335792, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/QcruQ.jpg?s=128&g=1", "display_name": "Maro", "link": "https://stackoverflow.com/users/1335792/maro"}, "edited": false, "score": 0, "creation_date": 1473378526, "post_id": 39379809, "comment_id": 66129484, "body": "Because according to my tests, the built-in attribute will work only if javascript is enabled."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1473378973, "post_id": 39379809, "comment_id": 66129594, "body": "Yes of course (a <code>RemoteAttribute</code> is a client side validation attribute that works by using ajax to submit values to a controller via ajax - and all client side validation required javascipt/jquery to work in any case). So your attribute is not a <i>custom remote validation</i>. And a validation attribute should not be calling a database. But if your disabling javascript, then your code makes no sense since you returning a <code>JsonResult</code>. Are you wanting to have an attribute that allows you to do client side validation, but still gives you server side validation in case javascript is disabled?"}, {"owner": {"reputation": 2409, "user_id": 1335792, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/QcruQ.jpg?s=128&g=1", "display_name": "Maro", "link": "https://stackoverflow.com/users/1335792/maro"}, "edited": false, "score": 0, "creation_date": 1473380835, "post_id": 39379809, "comment_id": 66129991, "body": "I changed it to return ActionResult,  and i&#39;m trying to find a solution that work on both (javascript enabled or disabled)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1473381007, "post_id": 39379809, "comment_id": 66130030, "body": "Then use the standard <code>RemoteAttribute</code> that calls a server method (to work with javascript enabled). But that method in turn calls a private function in your controller that returns the result. Then you can also call that private function in the POST method (and if not valid, add a <code>ModelStateError</code> and return the view to display the error."}, {"owner": {"reputation": 2409, "user_id": 1335792, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/QcruQ.jpg?s=128&g=1", "display_name": "Maro", "link": "https://stackoverflow.com/users/1335792/maro"}, "edited": false, "score": 0, "creation_date": 1473381784, "post_id": 39379809, "comment_id": 66130206, "body": "What you are saying is that i have to post the form then call the private function?  if i would do the validation in the post why do i bother to do a remote validation?. or am i missing something"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1473382031, "post_id": 39379809, "comment_id": 66130268, "body": "Because if you want client side validation (if javascript is enabled), then you need a <code>RemoteAttribute</code> (that&#39;s what it&#39;s for). But if you also want server side validation if javascript is disabled, then you need a fallback."}, {"owner": {"reputation": 2409, "user_id": 1335792, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/QcruQ.jpg?s=128&g=1", "display_name": "Maro", "link": "https://stackoverflow.com/users/1335792/maro"}, "edited": false, "score": 0, "creation_date": 1473415312, "post_id": 39379809, "comment_id": 66142385, "body": "thanks Stephen, please post your comment as an answer and i will accept it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1473416187, "post_id": 39379809, "comment_id": 66142857, "body": "No time today. Also suggest you look at <a href=\"http://stackoverflow.com/questions/39325307/multifield-required-validation-is-not-working-in-client-side-in-mvc-5/39382081#39382081\">this answer</a> for a validation attribute that handle your 2nd point. In your case you would apply <code>[RequiredWith(&quot;FolderName&quot;)</code> to the <code>FileName</code> property  so that if the user adds a file name, an error message will be displayed if the <code>FolderName</code> is empty"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4858389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad574335fa96bfb63b901537a6d80632?s=128&d=identicon&r=PG&f=1", "display_name": "donya", "link": "https://stackoverflow.com/users/4858389/donya"}, "is_accepted": false, "score": 1, "last_activity_date": 1580800390, "last_edit_date": 1580800390, "creation_date": 1580798818, "answer_id": 60051961, "question_id": 39379809, "link": "https://stackoverflow.com/questions/39379809/complex-remote-validation-based-on-2-properties/60051961#60051961", "title": "Complex Remote validation based on 2 properties", "body": "<p><strong>See the code below:</strong></p>\n\n<pre><code>[Remote(\"CheckExist\", \"securitylevels\", AdditionalFields = \"Id\", ErrorMessage = \"the number is Zero!\")]\npublic int Number { get; set; }\n</code></pre>\n"}], "owner": {"reputation": 2409, "user_id": 1335792, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/QcruQ.jpg?s=128&g=1", "display_name": "Maro", "link": "https://stackoverflow.com/users/1335792/maro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1580800390, "creation_date": 1473286485, "last_edit_date": 1483864611, "question_id": 39379809, "link": "https://stackoverflow.com/questions/39379809/complex-remote-validation-based-on-2-properties", "title": "Complex Remote validation based on 2 properties", "body": "<p>I'm trying to use custom remote validation to validate 2 properties based on one another with no success.</p>\n\n<p><strong>Action</strong></p>\n\n<p>Edit only, no insert</p>\n\n<p><strong>Properties</strong></p>\n\n<p>Both properties are free text (no dropdownlist)</p>\n\n<ul>\n<li>FolderName</li>\n<li>FileName</li>\n</ul>\n\n<p><strong>Validation conditions</strong></p>\n\n<ul>\n<li><p>FileName can be empty even if folder name is present</p></li>\n<li><p>FileName can only be filled in if folder name is present</p></li>\n<li><p>Filename is unique for each unique folder</p></li>\n<li><p>When edit page is loaded and in case if there are already data present then no check should be done unless the user modifies theses values.</p></li>\n</ul>\n\n<p><strong>Code</strong></p>\n\n<p>1- Json function in the controller</p>\n\n<pre><code>public JsonResult IsFileValid(string folderName, string fileName)\n    {\n        if (!folderName.IsNullOrEmpty() &amp;&amp; fileName.IsNullOrEmpty())\n        {\n            // FileName can be empty even if Folder name is present\n            return Json(true, JsonRequestBehavior.AllowGet);\n        }\n\n        if (folderName.IsNullOrEmpty() &amp;&amp; fileName.IsNullOrEmpty())\n        {\n            //FileName can be empty even if Folder name is present\n            return Json(true, JsonRequestBehavior.AllowGet);\n        }\n\n        if (folderName.IsNullOrEmpty() &amp;&amp; !fileName.IsNullOrEmpty())\n        {\n            //FileName can only be filled in if Folder name is present\n            return Json(false, JsonRequestBehavior.AllowGet);\n        }\n\n        var Folder =\n            Uow.Folders.GetAll()\n                .FirstOrDefault(x =&gt; x.Name.ToLower().Trim() == folderName.Trim().ToLower());\n\n\n\n        if (Folder != null)\n        {\n            // the Folder already exists, FileName name should be unique.\n            return Uow.Files.GetAll()\n                .Any(\n                    x =&gt;\n                        x.FolderId == Folder.Id &amp;&amp;\n                        x.fileName.Trim().ToLower() == fileName.Trim().ToLower()) ? Json(false, JsonRequestBehavior.AllowGet) : Json(false, JsonRequestBehavior.AllowGet);\n        }\n        // Folder name is new, in this case we can add new Folder and basked name\n        return Json(true, JsonRequestBehavior.AllowGet);\n    }\n</code></pre>\n\n<p>2- Create Custome remote attribute class</p>\n\n<pre><code>protected override ValidationResult IsValid(object value, ValidationContext validationContext)\n    {\n        // When using remote attribute, we specify the controller, action and the error message. The aim of the following is to retrieve the controller, action and error message\n        //using reflection.\n\n        // first get the controller\n        Type controller =\n            Assembly.GetExecutingAssembly()\n                .GetTypes()\n                .FirstOrDefault(\n                    type =&gt;\n                        type.Name.ToLower() ==\n                        string.Format(\"{0}Controller\", this.RouteData[\"controller\"].ToString()).ToLower());\n        if (controller != null)\n        {\n            // Get the method in the controller with\n            MethodInfo action =\n                controller.GetMethods()\n                    .FirstOrDefault(method =&gt; method.Name.ToLower() == this.RouteData[\"action\"].ToString().ToLower());\n            if (action != null)\n            {\n                // create instance of the controller\n                object instance = Activator.CreateInstance(controller);\n\n                //invoke the action method of the controller, and pass the value which is the parameter of the action\n                object response = action.Invoke(instance, new object[] {value});\n\n                // because the remote validation action returns JsonResult\n                var returnType = response as JsonResult;\n                if (returnType != null)\n                {\n                    object jsonData = returnType.Data;\n\n                    //because the jsonDate is bool\n                    if (jsonData is bool)\n                    {\n                        // return success or the error message\n                        return (bool) jsonData ? ValidationResult.Success : new ValidationResult(this.ErrorMessage);\n                    }\n                }\n            }\n        }\n        return new ValidationResult(ErrorMessage);\n    }\n</code></pre>\n\n<p>3- My viewModel class</p>\n\n<pre><code> public class FileInViewModel\n    {\n\n        public string FolderName { get; set; }\n\n        [RemoteValidation(\"IsFileValid\",\"Home\",ErrorMessage=\"Please select different file name\")]\n        public string FileName { get; set; }\n\n        // .....\n    }\n</code></pre>\n\n<ul>\n<li>What am i missing to make it work? If also possible to have different\nerror message for each error?</li>\n<li>How can i ignore the validation for data already present when the edit page is loaded?</li>\n</ul>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1473285990, "post_id": 39379682, "comment_id": 66087295, "body": "I don&#39;t see what this has to do with SQL, so I&#39;m removing that tag."}, {"owner": {"reputation": 106158, "user_id": 932418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/245e0f0dce8e71cb477b5aa8dff496a6?s=128&d=identicon&r=PG", "display_name": "L.B", "link": "https://stackoverflow.com/users/932418/l-b"}, "edited": false, "score": 1, "creation_date": 1473286289, "post_id": 39379682, "comment_id": 66087395, "body": "And I don&#39;t see any relation with the code you posted and the question... Post sample input, expected output and what you have tried so far."}, {"owner": {"reputation": 177, "user_id": 6206185, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/5cb0dc8beccf652bc29bf39949b9b2c8?s=128&d=identicon&r=PG&f=1", "display_name": "maran", "link": "https://stackoverflow.com/users/6206185/maran"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1473286499, "post_id": 39379682, "comment_id": 66087457, "body": "@GordonLinoff yeah true my bad, how? I want to extract the parts of titles and words that are being searched in textbox to a list...so I can do stuff with it..the part of code which I posted is my attempt, in which I extracted only stuff between quotation marks...but that wouldn&#39;t extract the word Dance for example which has no quotation marks surrounding it"}, {"owner": {"reputation": 33522, "user_id": 1906557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b270530d78d3c70ea10f88c6e36202bb?s=128&d=identicon&r=PG", "display_name": "I4V", "link": "https://stackoverflow.com/users/1906557/i4v"}, "edited": false, "score": 0, "creation_date": 1473287004, "post_id": 39379682, "comment_id": 66087622, "body": "You are asking <i>&quot;How to extract words between quotation and single words&quot;</i> but post some irrelated code. To get a better answer,  explain your problem in details. For example, (I have this text, I want to create this list from it and I tried this to do it)"}, {"owner": {"reputation": 177, "user_id": 6206185, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/5cb0dc8beccf652bc29bf39949b9b2c8?s=128&d=identicon&r=PG&f=1", "display_name": "maran", "link": "https://stackoverflow.com/users/6206185/maran"}, "edited": false, "score": 0, "creation_date": 1473287335, "post_id": 39379682, "comment_id": 66087719, "body": "edited..forgot to copy 2 lines of code"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "is_accepted": false, "score": 0, "last_activity_date": 1473296418, "creation_date": 1473296418, "answer_id": 39381066, "question_id": 39379682, "link": "https://stackoverflow.com/questions/39379682/how-to-extract-words-between-quotation-and-single-words-in-textbox-input-using-r/39381066#39381066", "title": "How to extract words between quotation and single words in textbox input using regex", "body": "<p>I think this is the better way of doing task.  I have done similar program at work and it does a real good job.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Text.RegularExpressions;\n\nnamespace ConsoleApplication1\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            string input = \"\\\"Legend of Tarzan\\\" \\\"Lord of Dance\\\"\";\n            string pattern = \"\\\"(?'phase'[^\\\"]+)\\\"\";\n            MatchCollection matches = Regex.Matches(input, pattern);\n            List&lt;string&gt; wheres = new List&lt;string&gt;();\n            foreach (Match match in matches)\n            {\n                wheres.Add(string.Format(\"title % '{0}'\", match.Groups[\"phase\"].Value));\n            }\n\n            string whereClause = string.Format(\"WHERE {0}\", string.Join(\" OR \", wheres));\n\n            string SQL = string.Format(\n                \" SELECT movie_id, ts_headline, title, ts_rank, rank\" +\n                \" FROM movies\" +\n                \" {0}\" +\n                \" ORDER BY rank DESC\",\n                whereClause);\n\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 6206185, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/5cb0dc8beccf652bc29bf39949b9b2c8?s=128&d=identicon&r=PG&f=1", "display_name": "maran", "link": "https://stackoverflow.com/users/6206185/maran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1473296418, "creation_date": 1473285751, "last_edit_date": 1473287264, "question_id": 39379682, "link": "https://stackoverflow.com/questions/39379682/how-to-extract-words-between-quotation-and-single-words-in-textbox-input-using-r", "title": "How to extract words between quotation and single words in textbox input using regex", "body": "<p><strong>Problem:</strong></p>\n\n<p><a href=\"http://i.stack.imgur.com/l2Oqa.jpg\" rel=\"nofollow\">Words to extract</a></p>\n\n<p>So I have a textbox in which I input parts of title in quotation marks like \"Lord of\" and single words without quotation mark like Dance. I would like to extract all of them (Remove quotation marks and split them in some kind of list) so I can build SQL command which part is show below depending on some radiobutton choosing..</p>\n\n<p>anyway</p>\n\n<p><strong>So far I've tried:</strong></p>\n\n<pre><code>string pattern1 = \"\\\"(.*?)\\\"\";\nMatchCollection col = Regex.Matches(textBox2.Text, @pattern1); //textbox2.Text is same as in picture\n\n\nList&lt;String&gt; titles_to_query = new List&lt;String&gt; { };\n\n            for (int i = 0; i &lt; col.Count; i++)\n            {\n                titles_to_query .Add(col[i].Groups[1].Value.ToString()); \n            }\n</code></pre>\n\n<p>This would extract all of the titles in between the quotation marks</p>\n\n<p>However how can I get Dance in my list (which is not surrounded by quotation marks)? Or what if someone types in  --> \"Lord of\" Dance \"Friends</p>\n\n<p>I would like to get Lord of and Dance in list, without Friends because it is missing one quotation mark...</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1473302191, "post_id": 39379628, "comment_id": 66091121, "body": "AFAIK, there is not direct way to do that, especially you need to write the data in multiple worksheet.  You need to create your class, read the data from database and write that in Excel or PowerPoint"}, {"owner": {"reputation": 160, "user_id": 2893134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/K51Zj.jpg?s=128&g=1", "display_name": "OyeHarish", "link": "https://stackoverflow.com/users/2893134/oyeharish"}, "edited": false, "score": 0, "creation_date": 1473316095, "post_id": 39379628, "comment_id": 66094943, "body": "You can try below link. <a href=\"http://stackoverflow.com/questions/7389637/export-sql-query-data-to-excel\" title=\"export sql query data to excel\">stackoverflow.com/questions/7389637/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6064266, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PELA.png?s=128&g=1", "display_name": "Bhavdip Tala", "link": "https://stackoverflow.com/users/6064266/bhavdip-tala"}, "is_accepted": false, "score": 0, "last_activity_date": 1474052283, "last_edit_date": 1474052283, "creation_date": 1473312455, "answer_id": 39383169, "question_id": 39379628, "link": "https://stackoverflow.com/questions/39379628/output-table-from-database-or-stored-procedure-directly-into-excel-file/39383169#39383169", "title": "Output table from database or stored procedure directly into Excel file", "body": "<p>You can use <code>bcp</code> command for export table record data in excel from stored procedure result.</p>\n\n<p>Please check below link.</p>\n\n<p><a href=\"http://bhavdiptala.blogspot.in/2016/09/output-table-from-database-or-sp.html\" rel=\"nofollow\">http://bhavdiptala.blogspot.in/2016/09/output-table-from-database-or-sp.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 1859, "user_id": 5260872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08272816864f87e6b904fb63758f5bf?s=128&d=identicon&r=PG", "display_name": "Nish\u0101n Wickramarathna", "link": "https://stackoverflow.com/users/5260872/nish%c4%81n-wickramarathna"}, "is_accepted": false, "score": 0, "last_activity_date": 1542953475, "creation_date": 1542953475, "answer_id": 53441432, "question_id": 39379628, "link": "https://stackoverflow.com/questions/39379628/output-table-from-database-or-stored-procedure-directly-into-excel-file/53441432#53441432", "title": "Output table from database or stored procedure directly into Excel file", "body": "<p>For anyone coming here looking for an answer, I have tried the following method and had success in <code>dotnet core 2.0.3</code> in <code>entity framework core 2.0.3</code></p>\n\n<p>First create your model class.</p>\n\n<pre><code>public class User\n{  \n    public string Name { get; set; }  \n    public int Address { get; set; }  \n    public int ZIP { get; set; }  \n    public string Gender { get; set; }  \n} \n</code></pre>\n\n<p>Then install <a href=\"https://www.nuget.org/packages/EPPlus/\" rel=\"nofollow noreferrer\">EPPlus Nuget package</a>. (I used version 4.0.5, probably will work for other version s as well.)</p>\n\n<pre><code>Install-Package EPPlus -Version 4.0.5\n</code></pre>\n\n<p>The create <code>ExcelExportHelper</code> class, which will contain the logic to convert dataset to Excel rows. This class <strong>do not have</strong> dependencies with your model class or dataset. </p>\n\n<pre><code>public class ExcelExportHelper\n    {\n        public static string ExcelContentType\n        {\n            get\n            { return \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"; }\n        }\n\n        public static DataTable ListToDataTable&lt;T&gt;(List&lt;T&gt; data)\n        {\n            PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(typeof(T));\n            DataTable dataTable = new DataTable();\n\n            for (int i = 0; i &lt; properties.Count; i++)\n            {\n                PropertyDescriptor property = properties[i];\n                dataTable.Columns.Add(property.Name, Nullable.GetUnderlyingType(property.PropertyType) ?? property.PropertyType);\n            }\n\n            object[] values = new object[properties.Count];\n            foreach (T item in data)\n            {\n                for (int i = 0; i &lt; values.Length; i++)\n                {\n                    values[i] = properties[i].GetValue(item);\n                }\n\n                dataTable.Rows.Add(values);\n            }\n            return dataTable;\n        }\n\n        public static byte[] ExportExcel(DataTable dataTable, string heading = \"\", bool showSrNo = false, params string[] columnsToTake)\n        {\n\n            byte[] result = null;\n            using (ExcelPackage package = new ExcelPackage())\n            {\n                ExcelWorksheet workSheet = package.Workbook.Worksheets.Add(String.Format(\"{0} Data\", heading));\n                int startRowFrom = String.IsNullOrEmpty(heading) ? 1 : 3;\n\n                if (showSrNo)\n                {\n                    DataColumn dataColumn = dataTable.Columns.Add(\"#\", typeof(int));\n                    dataColumn.SetOrdinal(0);\n                    int index = 1;\n                    foreach (DataRow item in dataTable.Rows)\n                    {\n                        item[0] = index;\n                        index++;\n                    }\n                }\n\n\n                // add the content into the Excel file  \n                workSheet.Cells[\"A\" + startRowFrom].LoadFromDataTable(dataTable, true);\n\n                // autofit width of cells with small content  \n                int columnIndex = 1;\n                foreach (DataColumn column in dataTable.Columns)\n                {\n                    int maxLength;\n                    ExcelRange columnCells = workSheet.Cells[workSheet.Dimension.Start.Row, columnIndex, workSheet.Dimension.End.Row, columnIndex];\n                    try\n                    {\n                        maxLength = columnCells.Max(cell =&gt; cell.Value.ToString().Count());\n                    }\n                    catch (Exception) //nishanc\n                    {\n                        maxLength = columnCells.Max(cell =&gt; (cell.Value +\"\").ToString().Length);\n                    }\n\n                    //workSheet.Column(columnIndex).AutoFit();\n                    if (maxLength &lt; 150)\n                    {\n                        //workSheet.Column(columnIndex).AutoFit();\n                    }\n\n\n                    columnIndex++;\n                }\n\n                // format header - bold, yellow on black  \n                using (ExcelRange r = workSheet.Cells[startRowFrom, 1, startRowFrom, dataTable.Columns.Count])\n                {\n                    r.Style.Font.Color.SetColor(System.Drawing.Color.White);\n                    r.Style.Font.Bold = true;\n                    r.Style.Fill.PatternType = OfficeOpenXml.Style.ExcelFillStyle.Solid;\n                    r.Style.Fill.BackgroundColor.SetColor(Color.Brown);\n                }\n\n                // format cells - add borders  \n                using (ExcelRange r = workSheet.Cells[startRowFrom + 1, 1, startRowFrom + dataTable.Rows.Count, dataTable.Columns.Count])\n                {\n                    r.Style.Border.Top.Style = ExcelBorderStyle.Thin;\n                    r.Style.Border.Bottom.Style = ExcelBorderStyle.Thin;\n                    r.Style.Border.Left.Style = ExcelBorderStyle.Thin;\n                    r.Style.Border.Right.Style = ExcelBorderStyle.Thin;\n\n                    r.Style.Border.Top.Color.SetColor(System.Drawing.Color.Black);\n                    r.Style.Border.Bottom.Color.SetColor(System.Drawing.Color.Black);\n                    r.Style.Border.Left.Color.SetColor(System.Drawing.Color.Black);\n                    r.Style.Border.Right.Color.SetColor(System.Drawing.Color.Black);\n                }\n\n                // removed ignored columns  \n                for (int i = dataTable.Columns.Count - 1; i &gt;= 0; i--)\n                {\n                    if (i == 0 &amp;&amp; showSrNo)\n                    {\n                        continue;\n                    }\n                    if (!columnsToTake.Contains(dataTable.Columns[i].ColumnName))\n                    {\n                        workSheet.DeleteColumn(i + 1);\n                    }\n                }\n\n                if (!String.IsNullOrEmpty(heading))\n                {\n                    workSheet.Cells[\"A1\"].Value = heading;\n                   // workSheet.Cells[\"A1\"].Style.Font.Size = 20;\n\n                    workSheet.InsertColumn(1, 1);\n                    workSheet.InsertRow(1, 1);\n                    workSheet.Column(1).Width = 10;\n                }\n\n                result = package.GetAsByteArray();\n            }\n\n            return result;\n        }\n\n        public static byte[] ExportExcel&lt;T&gt;(List&lt;T&gt; data, string Heading = \"\", bool showSlno = false, params string[] ColumnsToTake)\n        {\n            return ExportExcel(ListToDataTable&lt;T&gt;(data), Heading, showSlno, ColumnsToTake);\n        }\n    }\n</code></pre>\n\n<p>Now add this method where you want to generate the excel file, probably for a method in the controller. You can pass parameters for your stored procedure as well. <strong>Note that the return type of the method is <code>FileContentResult</code></strong>. Whatever query you execute, important thing is <strong>you must have the results in a <code>List</code>.</strong></p>\n\n<pre><code>[HttpPost]\npublic async Task&lt;FileContentResult&gt; Create([Bind(\"Id,StartDate,EndDate\")] GetReport getReport)\n{\n    DateTime startDate = getReport.StartDate;\n    DateTime endDate = getReport.EndDate;\n\n    // call the stored procedure and store dataset in a List.\n    List&lt;User&gt; users = _context.Reports.FromSql(\"exec dbo.SP_GetEmpReport @start={0}, @end={1}\", startDate, endDate).ToList();\n    //set custome column names\n    string[] columns = { \"Name\", \"Address\", \"ZIP\", \"Gender\"};\n    byte[] filecontent = ExcelExportHelper.ExportExcel(users, \"Users\", true, columns);\n    // set file name.\n    return File(filecontent, ExcelExportHelper.ExcelContentType, \"Report.xlsx\"); \n}\n</code></pre>\n\n<p>More details can be found <a href=\"https://www.c-sharpcorner.com/article/export-to-excel-in-asp-net-mvc/\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 37, "user_id": 6022907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd192223359365022e43b9c49c787e11?s=128&d=identicon&r=PG&f=1", "display_name": "Skycloud", "link": "https://stackoverflow.com/users/6022907/skycloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1909, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542953475, "creation_date": 1473285488, "last_edit_date": 1473311550, "question_id": 39379628, "link": "https://stackoverflow.com/questions/39379628/output-table-from-database-or-stored-procedure-directly-into-excel-file", "title": "Output table from database or stored procedure directly into Excel file", "body": "<p>I've seen a lot of posts and examples of how to output a gridview table into excel file but I am wondering how to bypass the gridview and directly turn a SQL query or stored procedure from a database into an Excel or Powerpoint output.</p>\n\n<p>This is needed because there are many (20+) reports that need to be output into one Excel (different sheets) or one PowerPoint file (different slides). I don't want to the webpage to cycle through each database report by first displaying it in gridview, then export it to Excel. The webpage setup will be a simple list of reports that the user can select and then click a button and have it come out in Excel and Ppt form.</p>\n\n<p>I'd like to do it without help from outside library if possible.</p>\n\n<p>I am using C# and ASP in Visual Studio 2015.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["java", "c#", "android", "xamarin"], "comments": [{"owner": {"reputation": 12040, "user_id": 1205368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/677b7e41294af5f94727c9f44098c8dd?s=128&d=identicon&r=PG", "display_name": "Salem", "link": "https://stackoverflow.com/users/1205368/salem"}, "edited": false, "score": 0, "creation_date": 1473286091, "post_id": 39379469, "comment_id": 66087332, "body": "Don&#39;t do it. Someone (with some effort) can get those credentials. Store them in a server and then create something like a rest endpoint (with authentication like an api key)."}, {"owner": {"reputation": 1239, "user_id": 2966445, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VQtGO.jpg?s=128&g=1", "display_name": "user2966445", "link": "https://stackoverflow.com/users/2966445/user2966445"}, "reply_to_user": {"reputation": 12040, "user_id": 1205368, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/677b7e41294af5f94727c9f44098c8dd?s=128&d=identicon&r=PG", "display_name": "Salem", "link": "https://stackoverflow.com/users/1205368/salem"}, "edited": false, "score": 0, "creation_date": 1473286246, "post_id": 39379469, "comment_id": 66087382, "body": "@Salem Don&#39;t you still have to store the API key and secret in the app?"}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1473288123, "post_id": 39379469, "comment_id": 66087962, "body": "I second the &quot;don&#39;t do it&quot;. If you store the id/pwd in code, your Google account would be owned the minute the ipa is downloaded. Personally I would just not send blind email from within app, I would OAuth2 to an https endpoint and post the message to it and have the server send it...."}, {"owner": {"reputation": 1239, "user_id": 2966445, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VQtGO.jpg?s=128&g=1", "display_name": "user2966445", "link": "https://stackoverflow.com/users/2966445/user2966445"}, "reply_to_user": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1473289203, "post_id": 39379469, "comment_id": 66088269, "body": "@SushiHangover Thanks, but once again in order to use OAuth2 you need credentials, right?"}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1473355134, "post_id": 39379469, "comment_id": 66119544, "body": "@user2966445 OAuth2 <b>Implicit flow</b> does not require a user secret to be used, this is used by lots of services/APIs (i.e. Facebook, MS, Google, etc,,,) and is a forced requirement by most,  so that you do not have to store anything on the client other than a client identifier and no client secret.  (i.e. Facebook only allows server-based apps/services to contain the <i>secret</i> for logging in to their services, and clients to use an id via implicit flow) This is a good blog article explaining how it works: <a href=\"http://labs.hybris.com/2012/06/05/oauth2-the-implicit-flow-aka-as-the-client-side-flow/\" rel=\"nofollow noreferrer\">labs.hybris.com/2012/06/05/&hellip;</a>"}, {"owner": {"reputation": 1239, "user_id": 2966445, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VQtGO.jpg?s=128&g=1", "display_name": "user2966445", "link": "https://stackoverflow.com/users/2966445/user2966445"}, "reply_to_user": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1473388290, "post_id": 39379469, "comment_id": 66131592, "body": "@SushiHangover This looks like a front-end flow where the user is already logged in to a site and sees the &quot;authorization&quot; screen to proceed. I&#39;m looking for a backend (behind-the-scenes) solution where an app talks to an API without the user knowing."}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1473389363, "post_id": 39379469, "comment_id": 66131818, "body": "@user2966445 if the <i>user</i> never <i>logins</i> into to anything (your service, a 3rd party service (Facebook, G+, MS, Azure AD, etc...) , than you can use certificate pinning to enforce a https connection to an endpoint that only allows a client with that cert to attach... no client secrets, no MITM issue, etc... In the end, the issue will always be if an app contains a hard-coded secret than other security is moot..."}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1473389620, "post_id": 39379469, "comment_id": 66131847, "body": "@user2966445 I&#39;ve seen app scanners that download apps 24/7 from the app stores and do nothing but pull id/pwd from code. Lucky this was in a professional security environment, but the toolset was actually bought from a hacker group that uses this for fun/profit... :-/ In the end, it is your app/your account that could be used for whatever reason, you are the one that must decide if the risk and liability is acceptable."}, {"owner": {"reputation": 1239, "user_id": 2966445, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VQtGO.jpg?s=128&g=1", "display_name": "user2966445", "link": "https://stackoverflow.com/users/2966445/user2966445"}, "reply_to_user": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1473394685, "post_id": 39379469, "comment_id": 66132972, "body": "@SushiHangover I guess this is way more complicated of an issue than I thought. I assumed most mobile apps call APIs behind the scenes in order to retrieve data, make updates, etc."}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 1, "creation_date": 1473395429, "post_id": 39379469, "comment_id": 66133140, "body": "@user2966445 they do, mostly using SSL endpoints of course, but the security on who and/or what is allowed to make those calls to it is up to you, if you do not secure the endpoint you have to be willing to accept that it <i>could</i> be used by anyone. As a public example look at Pokemon Go, on launch they used SSL endpoints but no authorization on who could use them, they skipped any security on them, thus hundreds of hackers use that to create all those third party mapping services, disassembled the app and got the TCP Socket, http GET&amp;POST parameters... it took them months to lock it down.. ;-)"}, {"owner": {"reputation": 1239, "user_id": 2966445, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VQtGO.jpg?s=128&g=1", "display_name": "user2966445", "link": "https://stackoverflow.com/users/2966445/user2966445"}, "reply_to_user": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1473396057, "post_id": 39379469, "comment_id": 66133329, "body": "@SushiHangover Do you know what Pokemon Go uses now, in place of the compromised solution?"}, {"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 1, "creation_date": 1473397236, "post_id": 39379469, "comment_id": 66133650, "body": "@user2966445 Well, they started with non-secure (HTTP!) endpoints within Google&#39;s cloud.. just crazy, lazy and/or stupid.... these were &quot;hacked&quot; the day of release. I, personally, have not looked recently, but what I saw on reddit they are pinning client certs now, but again I have not seen this myself, they have added <code>Captcha</code> recently to prevent bots from automating the app via Android emulators since the endpoints are not available outside the app so they are locking them down somehow."}], "owner": {"reputation": 1239, "user_id": 2966445, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/VQtGO.jpg?s=128&g=1", "display_name": "user2966445", "link": "https://stackoverflow.com/users/2966445/user2966445"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1473285380, "creation_date": 1473284669, "last_edit_date": 1473285380, "question_id": 39379469, "link": "https://stackoverflow.com/questions/39379469/how-to-store-smtp-credentials-in-android-app", "title": "How to Store SMTP Credentials in Android App?", "body": "<p>I have a Xamarin Android app that periodically sends an email using MailKit. My question is, what's the best approach to storing credentials for the \"service account\" that sends the messages? </p>\n\n<p>I'm using my own Gmail account credentials, but have concerns about storing them in the app itself (security and if the password needs to be reset).</p>\n\n<p>I'm expecting some backlash over the approach in general, so if there is a completely different way of doing this, I'm open to suggestions.</p>\n\n<p>Thanks</p>\n\n<pre><code>        var message = new MimeMessage();\n        message.From.Add(new MailboxAddress(\"Test Email\", \"noreply@nowhere.com\"));\n        message.To.Add(new MailboxAddress(\"Me\", \"myemailuser@gmail.com\"));\n        message.Subject = \"Test Email\";\n        message.Body = new TextPart(\"plain\")\n        {\n            Text = \"Test Body\"\n        };\n\n        using (var smtpClient = new SmtpClient())\n        {\n            smtpClient.Connect(\"smtp.gmail.com\", 587);\n            smtpClient.AuthenticationMechanisms.Remove(\"XOAUTH2\");\n            smtpClient.Authenticate(\"myemailuser\", \"mypassword\");\n            smtpClient.Send(message);\n            smtpClient.Disconnect(true);\n        } \n</code></pre>\n"}, {"tags": ["c#", "unit-testing", "dependency-injection", "inversion-of-control", "abstraction"], "comments": [{"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1473284537, "post_id": 39379414, "comment_id": 66086770, "body": "At some point a class has to be concrete. Why can&#39;t <b>that</b> implementation of <code>IData</code> know how to return a specific set of <code>ISomeObject</code> objects?"}, {"owner": {"reputation": 799, "user_id": 1548103, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/093ff6e27763909ee2d5a3c19ef1ba56?s=128&d=identicon&r=PG", "display_name": "user1548103", "link": "https://stackoverflow.com/users/1548103/user1548103"}, "reply_to_user": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1473285505, "post_id": 39379414, "comment_id": 66087127, "body": "That could very well be the situation. My understanding was the the goal of IoC and Dependency Injection was to have the consumers only know about the Interface, and not the concrete class, so that I can swap out the concrete class quickly without needing to ever modify the consumer. So if I wanted to replace SomeObject in the future with another class that implements ISomeObject, I could do so without touching Data.cs.   It could very well be that I have gone too deep into the idea of abstracting, and need to tone it back a bit. Perhaps I do need to instantiate SomeObject in Data.cs"}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 1, "creation_date": 1473286277, "post_id": 39379414, "comment_id": 66087391, "body": "Use a factory (<code>ISomeObjectFactory</code>) that takes the reader and returns a <code>ISomeObject</code>. Inject the factory into Data and the factory will know how to construct <code>ISomeObject</code>."}], "answers": [{"comments": [{"owner": {"reputation": 799, "user_id": 1548103, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/093ff6e27763909ee2d5a3c19ef1ba56?s=128&d=identicon&r=PG", "display_name": "user1548103", "link": "https://stackoverflow.com/users/1548103/user1548103"}, "edited": false, "score": 1, "creation_date": 1473291413, "post_id": 39380025, "comment_id": 66088793, "body": "This answer is great and should do the trick! Thank you very much =D"}], "tags": [], "owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "is_accepted": true, "score": 2, "last_activity_date": 1473289010, "last_edit_date": 1473289010, "creation_date": 1473287792, "answer_id": 39380025, "question_id": 39379414, "link": "https://stackoverflow.com/questions/39379414/create-a-list-of-custom-objects-with-inversion-of-control-paradigm/39380025#39380025", "title": "Create a list of custom objects with Inversion of Control paradigm", "body": "<p>You can delegate the creation of the object out to something else;</p>\n\n<pre><code>public interface ISomeObjectFactory {\n    ISomeObject Create(IDataReader reader);\n}\n</code></pre>\n\n<p>which has a single responsibility to create instances of <code>ISomeObject</code></p>\n\n<pre><code>using System.Collections.Generic;\nusing System.Data;\n\npublic interface IDbConnectionFactory {\n    ///&lt;summary&gt;\n    ///  Creates a connection based on the given database name or connection string.\n    ///&lt;/summary&gt;\n    IDbConnection CreateConnection(string nameOrConnectionString);\n}\n\npublic class Data : IData {\n    private IDbConnectionFactory dbConnectionFactory;\n    ISomeObjectFactory someObjectFactory;\n    private string CONNECTION_STRING = \"Connection string here\";\n\n    public Data(IDbConnectionFactory dbConnectionFactory, ISomeObjectFactory objectFactory) {\n        this.dbConnectionFactory = dbConnectionFactory;\n        this.someObjectFactory = objectFactory;\n    }\n\n    public List&lt;ISomeObject&gt; GetSomeObjects() {\n        var objects = new List&lt;ISomeObject&gt;();\n        //do some SQL stuff and return a data reader\n        using (var connnection = dbConnectionFactory.CreateConnection(CONNECTION_STRING)) {\n            using (var command = connnection.CreateCommand()) {\n                //configure command to be executed.\n                command.CommandText = \"SELECT * FROM SOMEOBJECT_TABLE\";\n                connnection.Open();\n                using (var reader = command.ExecuteReader()) {\n                    while (reader.Read()) {\n                        //...Logic to populate item\n                        var someObject = someObjectFactory.Create(reader);\n                        if (someObject != null)\n                            objects.Add(someObject);\n                    }\n                }\n            }\n        }\n\n        return objects;\n    }\n}\n</code></pre>\n\n<p>that way <code>Data</code> is only dependent on abstractions and not on concretions. Those can be determined/configured in the composition root at runtime.</p>\n"}], "owner": {"reputation": 799, "user_id": 1548103, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/093ff6e27763909ee2d5a3c19ef1ba56?s=128&d=identicon&r=PG", "display_name": "user1548103", "link": "https://stackoverflow.com/users/1548103/user1548103"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 39380025, "answer_count": 1, "score": 1, "last_activity_date": 1473289010, "creation_date": 1473284314, "last_edit_date": 1473288272, "question_id": 39379414, "link": "https://stackoverflow.com/questions/39379414/create-a-list-of-custom-objects-with-inversion-of-control-paradigm", "title": "Create a list of custom objects with Inversion of Control paradigm", "body": "<p>I want to adapt Dependency Injection and Inversion of Control into my daily development. Say I have an object type of <code>SomeObject</code> (implements the interface <code>ISomeObject</code>). I have a class which consumes this object called Data which implements the <code>IData</code> interface. </p>\n\n<pre><code>public interface ISomeObject {\n    int ID;\n    string Name;\n    bool IsAwesome;\n\n    void DoSomeStuffIfAwesome();\n}\n\npublic Class SomeObject : ISomeObject {\n    int ID;\n    string Name;\n    bool IsAwesome;\n\n    void DoSomeStuffIfAwesome() { /*stuff happens here*/ }        \n}\n\npublic interface IData {\n    List&lt;ISomeObject&gt; GetSomeObjects();\n}\n\npublic Class Data : IData {\n    List&lt;ISomeObject&gt; GetSomeObjects()\n    {\n        List&lt;ISomeObject&gt; objects = new List&lt;ISomeObject&gt;; // ??? Maybe and cast later?\n\n        //do some SQL stuff and get a SqlDataReader object called reader\n        while(reader.Read()) {\n             //ISomeObject someObj = ???\n             //Read into the someObj.ID, someObj.Name and someObj.IsAwesome fields\n             objects.add(someObj);\n        }\n        return objects;\n    }\n}    \n</code></pre>\n\n<p>The <code>GetSomeObjects()</code> method produces a list of <code>ISomeObject</code> objects. But I don't want <code>Data.cs</code> to have anything related to <code>SomeObject</code> hardcoded into it. I want some form of Dependency Injection to resolve the issue at runtime. What's the best way to handle this? I've considered the following:</p>\n\n<p><strong>1. Pass instance of <code>SomeObject</code> into <code>Data</code>'s constructor.</strong> This way I can get its type with <code>.GetType()</code>, store that into a private <code>System.Type</code> variable in <code>Data.cs</code>, and use <code>Activator.CreateInstance</code> in the loop to create new objects to be added to the list. <code>Data</code> would need to know about the <code>SomeObject</code> class specifically to cast, if I understand it correctly.</p>\n\n<p><strong>2. Pass an instance of my IoC container to <code>Data</code>'s constructor</strong> and just resolve the object type using <code>container.Resolve&lt;ISomeObject&gt;()</code>. This would make unit testing the <code>GetSomeObjects()</code> method difficult without utilizing my IoC container. I've read I shouldn't utilize the IoC container during unit testing, and should manually pass in what I need into methods.</p>\n\n<p><strong>3. Pass an <code>ISomeObject</code> object that has been instantiated as a <code>SomeObject</code></strong> - I would then use that to create the object via some built in method, such as <code>SomeObject.GenerateList(IDataReader reader)</code>.</p>\n"}, {"tags": ["c#", ".net", "process", "f#", "user32"], "comments": [{"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 2, "creation_date": 1473285306, "post_id": 39379366, "comment_id": 66087053, "body": "<a href=\"http://stackoverflow.com/questions/48288/unexpected-behaviour-of-process-mainwindowhandle\">This post</a> indicates that <code>.MainWindowHandle</code> just returns the top most window, maybe the tooltip is causing it to return zero? And also that post is 8 years old so it may be very outdated by now.."}], "owner": {"reputation": 832, "user_id": 4408842, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vuHCi.gif?s=128&g=1", "display_name": "TaterJuice", "link": "https://stackoverflow.com/users/4408842/taterjuice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 342, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473284526, "creation_date": 1473284113, "last_edit_date": 1473284526, "question_id": 39379366, "link": "https://stackoverflow.com/questions/39379366/process-mainwindowhandle-returns-intptr-zero-when-tooltips-are-hovered", "title": "Process.MainWindowHandle returns IntPtr.Zero when Tooltips are hovered", "body": "<p>I have a simple function which works about like this:</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>let possibleParents:Seq&lt;Process&gt; = GetProcessesByExecutableFileName(exeName)\nlet el = match possibleParents with\n            | x when x.Where(fun y -&gt; y.MainWindowHandle &gt; IntPtr.Zero).Count() = 1 -&gt; AutomationElement.FromHandle &lt;| Seq.head possibleParents // Only works if no tooltips or menus are open\n            | x when x.Where(fun y -&gt; y.MainWindowHandle &gt; IntPtr.Zero).Count() &lt; 1 -&gt; AutomationElement.FromHandle &lt;| Win32.FindWindowByProcess exeName //ALWAYS works\n            | x when x.Count() &gt; 1 -&gt; AutomationElement.RootElement // start search from Desktop\n            | _ -&gt; null\n</code></pre>\n\n<p>So, when the getting the Process object from .NET, it returns IntPtr.Zero if there are any menus\\contextmenus, tooltips or comboboxes open. As soon as you move your mouse away from a tooltip, it returns a real IntPtr value.</p>\n\n<p>Why is this? I can understand mdi children &amp; other window hierarchy causing this, but not simply mousing over a tooltip. What does user32.dll imports do to find the Handle that the Process class does differently?</p>\n\n<p>Answers in F#, C# or VB.NET welcome.</p>\n"}, {"tags": ["c#", "scroll", "avalonedit"], "answers": [{"comments": [{"owner": {"reputation": 1078, "user_id": 1594263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34ca22756083b87ea5db8b8481c2b12d?s=128&d=identicon&r=PG", "display_name": "Jim Foye", "link": "https://stackoverflow.com/users/1594263/jim-foye"}, "edited": false, "score": 0, "creation_date": 1474591740, "post_id": 39379291, "comment_id": 66605118, "body": "That works for me, but I have to subtract 1 from the line number. Also, I think it&#39;s a better user experience to set the caret offset to the line you&#39;ve scrolled to."}, {"owner": {"reputation": 896, "user_id": 3723624, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0f0956741d6104ecebac56d6325e47ee?s=128&d=identicon&r=PG&f=1", "display_name": "zaknotzach", "link": "https://stackoverflow.com/users/3723624/zaknotzach"}, "reply_to_user": {"reputation": 1078, "user_id": 1594263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34ca22756083b87ea5db8b8481c2b12d?s=128&d=identicon&r=PG", "display_name": "Jim Foye", "link": "https://stackoverflow.com/users/1594263/jim-foye"}, "edited": false, "score": 0, "creation_date": 1485965883, "post_id": 39379291, "comment_id": 71146935, "body": "It definitely depends on your application, but I like the caret idea. In my case though, I had two editors I wanted somewhat synced (sort of to create floating headers with data in a text file) so the window I was auto-scrolling was read only and no caret needed."}], "tags": [], "owner": {"reputation": 896, "user_id": 3723624, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0f0956741d6104ecebac56d6325e47ee?s=128&d=identicon&r=PG&f=1", "display_name": "zaknotzach", "link": "https://stackoverflow.com/users/3723624/zaknotzach"}, "is_accepted": true, "score": 7, "last_activity_date": 1473283792, "creation_date": 1473283792, "answer_id": 39379291, "question_id": 39379290, "link": "https://stackoverflow.com/questions/39379290/avalonedit-scroll-to-line/39379291#39379291", "title": "AvalonEdit scroll to line", "body": "<p>I ended up figuring out that, since my text was all uniform height, I could just do line height * line# to get the offset. I first tried to do this using <code>(Editor.TextArea.TextView.DocumentHeight / Editor.Document.LineCount)</code>to calculate the line height but that seemed to be slightly off, probably due to some floating point issues, and was increasingly off the mark the farther you went down in the document. But, again since my document is uniform height, I realized I could use the <code>TextView.DefaultLineHeight</code> property and came up with:</p>\n\n<pre><code>double vertOffset = (Editor.TextArea.TextView.DefaultLineHeight) * Line;\nEditor.ScrollToVerticalOffset(vertOffset);\n</code></pre>\n\n<p>This very consistently scrolls to exactly the right place in the document.</p>\n"}, {"comments": [{"owner": {"reputation": 896, "user_id": 3723624, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0f0956741d6104ecebac56d6325e47ee?s=128&d=identicon&r=PG&f=1", "display_name": "zaknotzach", "link": "https://stackoverflow.com/users/3723624/zaknotzach"}, "edited": false, "score": 0, "creation_date": 1474992798, "post_id": 39650973, "comment_id": 66756516, "body": "I needed to do this without moving the Caret. Also I found that methods like this sometimes didn&#39;t have the line I wanted at the top of the screen but just &quot;in view&quot; somewhere."}], "tags": [], "owner": {"reputation": 1078, "user_id": 1594263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34ca22756083b87ea5db8b8481c2b12d?s=128&d=identicon&r=PG", "display_name": "Jim Foye", "link": "https://stackoverflow.com/users/1594263/jim-foye"}, "is_accepted": false, "score": 7, "last_activity_date": 1474592053, "creation_date": 1474592053, "answer_id": 39650973, "question_id": 39379290, "link": "https://stackoverflow.com/questions/39379290/avalonedit-scroll-to-line/39650973#39650973", "title": "AvalonEdit scroll to line", "body": "<p>Another way to do this is to set the caret position and then call BringCaretToView(). In F#:</p>\n\n<pre><code>editor.TextArea.Caret.Offset &lt;- offset\neditor.TextArea.Caret.BringCaretToView()\n</code></pre>\n\n<p>This will scroll the line containing 'offset' into view, but it won't scroll the text in the editor such that this line is now the first visible one. So which approach you take may depend on whether you want the target line to be at the top or not.</p>\n"}], "owner": {"reputation": 896, "user_id": 3723624, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0f0956741d6104ecebac56d6325e47ee?s=128&d=identicon&r=PG&f=1", "display_name": "zaknotzach", "link": "https://stackoverflow.com/users/3723624/zaknotzach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2128, "favorite_count": 0, "accepted_answer_id": 39379291, "answer_count": 2, "score": 2, "last_activity_date": 1474592053, "creation_date": 1473283792, "question_id": 39379290, "link": "https://stackoverflow.com/questions/39379290/avalonedit-scroll-to-line", "title": "AvalonEdit scroll to line", "body": "<p>I am having a lot of trouble getting an AvalonEdit <code>TextEditor</code> to scroll to a specific line. The <code>ScrollTo()</code> behavior is simply to scroll until that line is in the middle of the view. I have tried many different methods found around the internet and SO like getting the offset with </p>\n\n<pre><code>double visualTop = textEditor.TextArea.TextView.GetVisualTopByDocumentLine(line);\n</code></pre>\n\n<p>But each has had its own issues. For example, in the above line I was getting exceptions with the <code>TextView.VisualLines</code>.</p>\n"}, {"tags": ["c#", "visual-studio", "azure-devops", "performance-testing"], "comments": [{"owner": {"reputation": 28250, "user_id": 5475003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed59b990fdc2c28e25f954d1578ce70?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Chen - MSFT", "link": "https://stackoverflow.com/users/5475003/eddie-chen-msft"}, "edited": false, "score": 0, "creation_date": 1473328047, "post_id": 39379175, "comment_id": 66101787, "body": "I can get the same behavior as you and have submit a feedback for this issue on MS connect: <a href=\"https://connect.microsoft.com/VisualStudio/feedback/details/3102026\" rel=\"nofollow noreferrer\">connect.microsoft.com/VisualStudio/feedback/details/3102026</a>"}, {"owner": {"reputation": 21716, "user_id": 2401769, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wkEbw.jpg?s=128&g=1", "display_name": "Matias Cicero", "link": "https://stackoverflow.com/users/2401769/matias-cicero"}, "reply_to_user": {"reputation": 28250, "user_id": 5475003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed59b990fdc2c28e25f954d1578ce70?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Chen - MSFT", "link": "https://stackoverflow.com/users/5475003/eddie-chen-msft"}, "edited": false, "score": 0, "creation_date": 1473344104, "post_id": 39379175, "comment_id": 66112657, "body": "@Eddie-MSFT Glad to hear it&#39;s not something mine. Thanks for the submission."}], "answers": [{"tags": [], "owner": {"reputation": 28250, "user_id": 5475003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed59b990fdc2c28e25f954d1578ce70?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Chen - MSFT", "link": "https://stackoverflow.com/users/5475003/eddie-chen-msft"}, "is_accepted": true, "score": 1, "last_activity_date": 1475142462, "creation_date": 1475142462, "answer_id": 39766956, "question_id": 39379175, "link": "https://stackoverflow.com/questions/39379175/webtestrequest-reportingname-is-ignored-when-using-vs-team-services/39766956#39766956", "title": "WebTestRequest.ReportingName is ignored when using VS Team Services", "body": "<p>This issue will be fixed by 10/16.</p>\n\n<blockquote>\n  <p>Posted by Shiva [MSFT] on 9/28/2016 at 8:59 AM</p>\n  \n  <p>Thanks for reporting this issue. We have fixed the issue and would\n  deploy it by 10/16.</p>\n</blockquote>\n"}], "owner": {"reputation": 21716, "user_id": 2401769, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/wkEbw.jpg?s=128&g=1", "display_name": "Matias Cicero", "link": "https://stackoverflow.com/users/2401769/matias-cicero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 39766956, "answer_count": 1, "score": 8, "last_activity_date": 1475142462, "creation_date": 1473283260, "last_edit_date": 1473284267, "question_id": 39379175, "link": "https://stackoverflow.com/questions/39379175/webtestrequest-reportingname-is-ignored-when-using-vs-team-services", "title": "WebTestRequest.ReportingName is ignored when using VS Team Services", "body": "<p>I have the following method in my custom <code>WebTest</code>:</p>\n\n<pre><code>private WebTestRequest CreateRequest(CommandInput command)\n{\n    WebTestRequest request = new WebTestRequest(URL);\n    request.ReportingName = command.CommandName;\n    request.Method = command.HttpMethod;\n\n    // ...\n\n    return request;\n}\n</code></pre>\n\n<p>On my <code>GetRequestEnumerator</code> I am calling the method like this:</p>\n\n<pre><code>public override IEnumerable&lt;WebTestRequest&gt; GetRequestEnumerator()\n{\n     return new CommandInput[]\n     {\n         new CommandInput() { CommandName = \"configuration\", HttpMethod = \"POST\" },\n         new CommandInput() { CommandName = \"login\", HttpMethod = \"POST\" },\n         new CommandInput() { CommandName = \"quick_view\", HttpMethod = \"GET\" },\n         new CommandInput() { CommandName = \"esign_document\", HttpMethod = \"POST\" }\n     }.Select(CreateRequest).GetEnumerator();\n}\n</code></pre>\n\n<p><strong>Note: The original code is more complicated than this, but it is irrelevant</strong>.</p>\n\n<p>This is working fine when running the load test on my local machine:</p>\n\n<p>You can see that each request is being identified by the value of <code>ReportingName</code> property</p>\n\n<p><a href=\"https://i.stack.imgur.com/mQLOJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mQLOJ.png\" alt=\"Local summary\"></a></p>\n\n<p>However, If I run the load test on Visual Studio Online services, requests are grouped by URL instead of the value on <code>ReportingName</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VGbpD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VGbpD.png\" alt=\"Cloud summary\"></a></p>\n\n<p>Requests are being grouped as <code>command {GET}</code> and <code>command {POST}</code> because the URL is the same for every request on my test case (<code>https://test.xxxx.com/api/command</code>), only differing by HTTP method on some of them.</p>\n\n<p>I searched for hours on the Internet and only managed to find this open thread about it on MSDN:</p>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/silverlight/en-US/1c5a1954-a182-4b04-9a82-b03e148dd843/reporting-name-does-not-show-up-in-page-results-of-online-load-test?forum=TFService\" rel=\"nofollow noreferrer\">Reporting Name does not show up in Page Results of Online Load Test</a></p>\n\n<p>What is happening?</p>\n"}, {"tags": ["c#", "wpf", "entity-framework", "mvvm", "treeview"], "comments": [{"owner": {"reputation": 16641, "user_id": 1744164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c224e326809636f5f5d3841899571e?s=128&d=identicon&r=PG", "display_name": "Sir Rufo", "link": "https://stackoverflow.com/users/1744164/sir-rufo"}, "edited": false, "score": 0, "creation_date": 1473287358, "post_id": 39379151, "comment_id": 66087726, "body": "google search for <i>mvvm wpf treeview</i> -&gt; <a href=\"http://www.codeproject.com/Articles/26288/Simplifying-the-WPF-TreeView-by-Using-the-ViewMode\" rel=\"nofollow noreferrer\">codeproject.com/Articles/26288/&hellip;</a> (first result)"}], "answers": [{"tags": [], "owner": {"reputation": 199, "user_id": 1906313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f387f1c80177de5b224fc4f95c1a7349?s=128&d=identicon&r=PG", "display_name": "Sulieman Mansouri", "link": "https://stackoverflow.com/users/1906313/sulieman-mansouri"}, "is_accepted": false, "score": 0, "last_activity_date": 1473418445, "creation_date": 1473418445, "answer_id": 39409954, "question_id": 39379151, "link": "https://stackoverflow.com/questions/39379151/binding-a-treeview-to-a-graph-of-ef-entities/39409954#39409954", "title": "Binding a TreeView to a graph of EF Entities", "body": "<p>Thanks @Sir Rufo for the Links.</p>\n\n<p>What was missing from my templates is the type of he data that I am binding to. DataType in the HierarchicalDataTemplate is required in order to know to which property I am binding to.</p>\n\n<p>Both suggested solutions define the entities to be bound to the Tree View in the ViewModel.</p>\n\n<p>My model is defined in a different assembly so I ended up referencing my model in my view. This way my view knows about my model, I am pretty sure that I am breaking the MVVM pattern doing this. I didn't like the idea of creating additional identical classes just to provide data-binding for my view.</p>\n\n<p>Here how my code looks like now:</p>\n\n<pre><code>&lt;UserControl x:Class=\"CV.Modules.Views.NavigationTreeView\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:vm=\"clr-namespace:CV.Modules.ViewModels\"\n         xmlns:data=\"clr-namespace:CV.Model;assembly=CV.Model\"\n         xmlns:prism=\"http://prismlibrary.com/\"             \n         prism:ViewModelLocator.AutoWireViewModel=\"True\"&gt;\n\n&lt;UserControl.Resources&gt;\n\n    &lt;HierarchicalDataTemplate ItemsSource=\"{Binding Teachers}\"\n                              DataType=\"{x:Type data:Department}\"&gt;\n        &lt;TextBlock Text=\"{Binding Name}\"/&gt;\n    &lt;/HierarchicalDataTemplate&gt;\n\n    &lt;DataTemplate DataType=\"{x:Type data:Teacher}\"&gt;\n        &lt;TextBlock Text=\"{Binding LastName}\" /&gt;\n    &lt;/DataTemplate&gt;\n&lt;/UserControl.Resources&gt;\n\n&lt;TreeView ItemsSource=\"{Binding Departments}\" Margin=\"5\"/&gt;\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>I am marking the link from SO as the answer because it pointed me to how to answer my question. \nI will edit this answer in the future when I find a solution that doesn't pollute the view with my model entities.\nCheers</p>\n"}], "owner": {"reputation": 199, "user_id": 1906313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f387f1c80177de5b224fc4f95c1a7349?s=128&d=identicon&r=PG", "display_name": "Sulieman Mansouri", "link": "https://stackoverflow.com/users/1906313/sulieman-mansouri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "closed_date": 1473418756, "answer_count": 1, "score": 0, "last_activity_date": 1473418445, "creation_date": 1473283126, "question_id": 39379151, "link": "https://stackoverflow.com/questions/39379151/binding-a-treeview-to-a-graph-of-ef-entities", "closed_reason": "Duplicate", "title": "Binding a TreeView to a graph of EF Entities", "body": "<p>I am working on a small project to learn learning WPF MVVM. Everything was ok until I hit this hurdle: I tried to bind a tree view to an observable collection to show Departments and their Teachers. the data is loaded eagerly so no lazy loading.</p>\n\n<p>here is my view model:</p>\n\n<pre><code>public class NavigationTreeViewModel : BindableBase\n{\n    private CV.Model.Context.CVContext _dbContext;\n\n    public NavigationTreeViewModel()\n    {\n        _dbContext = new Model.Context.CVContext();\n        LoadDepartments();\n    }\n\n    private void LoadDepartments()\n    {\n        var result = _dbContext.Departments.Include(a =&gt; a.Teachers);\n        _departments = new ObservableCollection&lt;Department&gt;(result.ToList());\n    }\n\n    private ObservableCollection&lt;Teacher&gt; _teachers;\n    public ObservableCollection&lt;Teacher&gt; Teachers\n    {\n        get { return _teachers; }\n        set { SetProperty(ref _teachers, value); }\n    }\n\n    private ObservableCollection&lt;Department&gt; _departments;\n    public ObservableCollection&lt;Department&gt; Departments\n    {\n        get { return _departments; }\n        set { SetProperty(ref _departments, value); }\n    }\n\n}\n</code></pre>\n\n<p>I can setup my binding to show the name of the department and the teachers like so:</p>\n\n<pre><code>&lt;UserControl x:Class=\"CV.Modules.Views.NavigationTreeView\"\n         xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n         xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n         xmlns:vm=\"clr-namespace:CV.Modules.ViewModels\"\n         xmlns:prism=\"http://prismlibrary.com/\"             \n         prism:ViewModelLocator.AutoWireViewModel=\"True\"&gt;\n\n&lt;UserControl.DataContext&gt;\n    &lt;vm:NavigationTreeViewModel/&gt;\n&lt;/UserControl.DataContext&gt;\n\n&lt;TreeView ItemsSource=\"{Binding Departments}\" Margin=\"5\"&gt;\n    &lt;TreeView.ItemTemplate&gt;\n        &lt;HierarchicalDataTemplate ItemsSource=\"{Binding Teachers}\"&gt;\n            &lt;TextBlock Text=\"{Binding Name}\"/&gt;\n        &lt;/HierarchicalDataTemplate&gt;\n   &lt;/TreeView.ItemTemplate&gt;\n&lt;/TreeView&gt;\n\n&lt;/UserControl&gt;\n</code></pre>\n\n<p>However this won't work if I want to show the name of the department in the parent entity and the Last Name of the Teachers in the children entities. so I changed the template of the tree view to the resources of the control based on this <a href=\"http://www.codemag.com/article/1401031\" rel=\"nofollow\">article</a>. Here is what I did:</p>\n\n<pre><code>&lt;UserControl.Resources&gt;\n    &lt;DataTemplate x:Key=\"TeacherLevel\"&gt;\n        &lt;TextBlock Text=\"{Binding LastName}\"/&gt;\n    &lt;/DataTemplate&gt;\n    &lt;HierarchicalDataTemplate x:Key=\"DepartmentLevel\"\n                              ItemsSource=\"{Binding Departments}\"\n                              ItemTemplate=\"{StaticResource TeacherLevel}\"&gt;\n        &lt;TextBlock Text=\"{Binding Name}\"/&gt;\n    &lt;/HierarchicalDataTemplate&gt;\n&lt;/UserControl.Resources&gt;\n\n&lt;TreeView ItemTemplate=\"{StaticResource DepartmentLevel}\"\n          ItemsSource=\"{Binding Departments}\"\n          Margin=\"5\"/&gt;\n</code></pre>\n\n<p>This way Only the department's names would show but not the Last Name of the teachers. \nI noticed that no Intellisense is available when trying to access the properties of my entities, the only thing available for me is the properties in my viewModel. In my first binding attempt I can see all the department properties but not in my second binding attempt.</p>\n\n<p><strong>My Question Is this, How do I bind a tree view to a multi-level entity graph showing different properties at each level?</strong></p>\n\n<p>I am missing something very basic here but I can't put my finger on it. Any help would be much appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "asp.net-mvc", "scrapysharp"], "comments": [{"owner": {"reputation": 81, "user_id": 4910069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c7b70775a10ffe8f4292078298157826?s=128&d=identicon&r=PG&f=1", "display_name": "bhs8227", "link": "https://stackoverflow.com/users/4910069/bhs8227"}, "edited": false, "score": 0, "creation_date": 1473283535, "post_id": 39379037, "comment_id": 66086411, "body": "I love how people mark questions with a -1 and give no insight on how to solve an issue.  So helpful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1473291352, "post_id": 39379037, "comment_id": 66088775, "body": "Please note that the model-view-controller tag is for questions about the pattern. There is a specific tag for the ASP.NET-MVC implementation."}, {"owner": {"reputation": 81, "user_id": 4910069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c7b70775a10ffe8f4292078298157826?s=128&d=identicon&r=PG&f=1", "display_name": "bhs8227", "link": "https://stackoverflow.com/users/4910069/bhs8227"}, "edited": false, "score": 0, "creation_date": 1473291954, "post_id": 39379037, "comment_id": 66088937, "body": "Thank you.  I selected MVC wasn&#39;t thinking.  My fault.  I see it is already fixed.  I appreciate that."}, {"owner": {"reputation": 9503, "user_id": 4270650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88ba8368f50d9a96716c7205195df444?s=128&d=identicon&r=PG", "display_name": "Will Ray", "link": "https://stackoverflow.com/users/4270650/will-ray"}, "edited": false, "score": 0, "creation_date": 1473293743, "post_id": 39379037, "comment_id": 66089320, "body": "What are you looking to do with ScrapySharp in a web project? It seems conceptually weird to me have a project which both delivers webpages to clients while also simulating a web browser on the server."}, {"owner": {"reputation": 81, "user_id": 4910069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c7b70775a10ffe8f4292078298157826?s=128&d=identicon&r=PG&f=1", "display_name": "bhs8227", "link": "https://stackoverflow.com/users/4910069/bhs8227"}, "edited": false, "score": 0, "creation_date": 1473296261, "post_id": 39379037, "comment_id": 66089796, "body": "Scrapysharp allows me to easily request pages. Login, Get forms from the page and change form field values and then submit the form.  It also gets the viewstate values from the page in question with out me having to try to figure out how to do the same with httpclient or httpwebclient.  I am having to deal with a third party site that doesn&#39;t have an api.  If some one knows a better way I am open to that too."}, {"owner": {"reputation": 9503, "user_id": 4270650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88ba8368f50d9a96716c7205195df444?s=128&d=identicon&r=PG", "display_name": "Will Ray", "link": "https://stackoverflow.com/users/4270650/will-ray"}, "edited": false, "score": 0, "creation_date": 1473296900, "post_id": 39379037, "comment_id": 66089923, "body": "@bhs8227 Cool! Sounds like it&#39;s meant to be used in a console app for things like UI tests and whatnot. I can&#39;t answer your question but I would suggest that a console app will give you what you need without all the baggage that comes along with an MVC project."}, {"owner": {"reputation": 81, "user_id": 4910069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c7b70775a10ffe8f4292078298157826?s=128&d=identicon&r=PG&f=1", "display_name": "bhs8227", "link": "https://stackoverflow.com/users/4910069/bhs8227"}, "edited": false, "score": 0, "creation_date": 1473297164, "post_id": 39379037, "comment_id": 66089980, "body": "It is very cool.  If it was for my own purposes a console app would be fine.  But I need to add a way to interface with this third party site in an existing asp.net mvc project.  I can&#39;t expect customers to install an intermediate console app to exchange data between the two sites."}], "answers": [{"comments": [{"owner": {"reputation": 483, "user_id": 1216218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UVzth.jpg?s=128&g=1", "display_name": "Axel Prieto", "link": "https://stackoverflow.com/users/1216218/axel-prieto"}, "edited": false, "score": 1, "creation_date": 1478104135, "post_id": 39400209, "comment_id": 68021856, "body": "You saved my day."}], "tags": [], "owner": {"reputation": 81, "user_id": 4910069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c7b70775a10ffe8f4292078298157826?s=128&d=identicon&r=PG&f=1", "display_name": "bhs8227", "link": "https://stackoverflow.com/users/4910069/bhs8227"}, "is_accepted": true, "score": 3, "last_activity_date": 1473368781, "creation_date": 1473368781, "answer_id": 39400209, "question_id": 39379037, "link": "https://stackoverflow.com/questions/39379037/how-do-i-get-scrapysharp-to-work-in-a-mvc-web-app/39400209#39400209", "title": "How do I get scrapysharp to work in a MVC web app?", "body": "<p>Ok so scrapysharp has a NavigateToPageAsync function.  This returns a result as expected.</p>\n\n<p>Form.submit() uses NavigateToPage as well but you can instead use NavigateToPageAsync and pass in the correct parameters to submit the form.</p>\n"}], "owner": {"reputation": 81, "user_id": 4910069, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c7b70775a10ffe8f4292078298157826?s=128&d=identicon&r=PG&f=1", "display_name": "bhs8227", "link": "https://stackoverflow.com/users/4910069/bhs8227"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 1, "accepted_answer_id": 39400209, "answer_count": 1, "score": 2, "last_activity_date": 1510586996, "creation_date": 1473282503, "last_edit_date": 1510586996, "question_id": 39379037, "link": "https://stackoverflow.com/questions/39379037/how-do-i-get-scrapysharp-to-work-in-a-mvc-web-app", "title": "How do I get scrapysharp to work in a MVC web app?", "body": "<p>I successfully have scrapysharp working in a console app.</p>\n\n<p>I created a new MVC web app in VS2013 with no authentication or anything else special.  I used nuget to add ScrapySharp and then have this code in my Home Controller.  I get no response to my pageresult.  Does anyone have any ideas why?  How do I get scrapysharp to work in a MVC web app?</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.Mvc;\nusing ScrapySharp.Html.Forms;\nusing ScrapySharp.Network;\nusing ScrapySharp;\nusing HtmlAgilityPack;\nusing ScrapySharp.Extensions;\n\nnamespace scrapyB.Controllers\n{\n    public class HomeController : Controller\n    {\n        public ActionResult Index()\n        {\n           var  browser = new ScrapingBrowser();\n            browser.AllowAutoRedirect = true;\n            browser.AllowMetaRedirect = true;\n           var pageresult = browser.NavigateToPage(new Uri(\"https://google.com\"));\n           var x = pageresult;\n            return View();\n        }\n\n        public ActionResult About()\n        {\n            ViewBag.Message = \"Your application description page.\";\n\n            return View();\n        }\n\n        public ActionResult Contact()\n        {\n            ViewBag.Message = \"Your contact page.\";\n\n            return View();\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Edit</strong>\nActually I just tried a windows Forms application and NavigateToPage doesn't return a result either.  It's weird but it seems as it only works in a console app.  Does anyone know how to get ScrapySharp to work in something other than a console app?</p>\n"}, {"tags": ["javascript", "c#", "jquery", "asp.net", "popover"], "answers": [{"comments": [{"owner": {"reputation": 2310, "user_id": 1714556, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/tm7Lj.jpg?s=128&g=1", "display_name": "eddie_cat", "link": "https://stackoverflow.com/users/1714556/eddie-cat"}, "edited": false, "score": 0, "creation_date": 1473866089, "post_id": 39379794, "comment_id": 66305524, "body": "I ended up using parts of your solution and changing the popover-content-wrapper to a class instead of an id, then just searching for the next instance of it with on the link&#39;s click event. Thanks for your help :)"}], "tags": [], "owner": {"reputation": 2048, "user_id": 4773983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aed5e8ae9df639b3d0cc5b2d3e9ef733?s=128&d=identicon&r=PG", "display_name": "Enrique Zavaleta", "link": "https://stackoverflow.com/users/4773983/enrique-zavaleta"}, "is_accepted": true, "score": 1, "last_activity_date": 1473286399, "creation_date": 1473286399, "answer_id": 39379794, "question_id": 39378974, "link": "https://stackoverflow.com/questions/39378974/how-can-i-display-a-bootstrap-popover-with-an-html-content-from-a-gridview/39379794#39379794", "title": "How can I display a Bootstrap popover with an html content from a GridView?", "body": "<p>I'm not sure if the problem is that there are more than one <code>$(\"#popover-content-wrapper\")</code>, because if it is in a <code>GridView</code>, I think is normal to have more than one row.</p>\n\n<p>I have an example of how I implment this to show a larger <code>&lt;img&gt;</code> in a popover</p>\n\n<pre><code>&lt;asp:TemplateField&gt;\n    &lt;ItemTemplate&gt;\n            &lt;asp:Image ID=\"imgSignature\" runat=\"server\"  \n                data-img='&lt;%# Eval(\"ImgBase64\")  %&gt;' \n                data-toggle=\"popover\"\n                ImageUrl='ViewLarger.jpg' /&gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:TemplateField&gt;\n\n$('img[data-toggle=popover]').popover({\n    html: true,\n    trigger: 'hover',\n    content: function () {\n        return '&lt;img width=\"250px\" src=\"' + $(this).data('img') + '\" /&gt;';\n    }\n});\n</code></pre>\n\n<p>As you can see, I save the information I want to pass to the popover in a <code>data-X</code> attribute in the trigger element, and in the JS function just place it when appropiate. In your case should be </p>\n\n<pre><code>&lt;asp:TemplateField&gt;\n    &lt;ItemTemplate&gt;\n            &lt;asp:LinkButton ID=\"btnViewRefDrDetails\" \n                            data-toggle=\"popover\"\n                            data-ReferringName='&lt;%# Eval(\"ReferringName\")%&gt;' \n                            data-ProviderSpecialty='&lt;%# Eval(\"ProviderSpecialty\")%&gt;' &gt;\n    &lt;/ItemTemplate&gt;\n&lt;/asp:TemplateField&gt;\n\n$('a[data-toggle=popover]').popover({\n    html: true,\n    trigger: 'hover',\n    content: function () {\n        return '&lt;table&gt;&lt;tr&gt;&lt;td&gt;Provider Name' + $(this).data('ReferringName') + '&lt;/td&gt;&lt;/tr&gt; etc...';\n    }\n});\n</code></pre>\n"}], "owner": {"reputation": 2310, "user_id": 1714556, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/tm7Lj.jpg?s=128&g=1", "display_name": "eddie_cat", "link": "https://stackoverflow.com/users/1714556/eddie-cat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 39379794, "answer_count": 1, "score": 0, "last_activity_date": 1473286399, "creation_date": 1473282226, "question_id": 39378974, "link": "https://stackoverflow.com/questions/39378974/how-can-i-display-a-bootstrap-popover-with-an-html-content-from-a-gridview", "title": "How can I display a Bootstrap popover with an html content from a GridView?", "body": "<p>I have been at this for like two hours now trying various stuff. I can get the popover to display as just a basic title/content, but I haven't found a way to get it to work with HTML and Eval() as the content yet. This is what I'm working with: </p>\n\n<p>JS:</p>\n\n<pre><code>$(function () {\n    $(\"#btnViewRefDrDetails\").popover({\n        html: true,\n        content: function () {\n            return $(\"#popover-content-wrapper\").html();\n        },\n        title: function () {\n            return $(\"#popover-title\").html();\n        },\n        container: 'body'\n    });\n})\n</code></pre>\n\n<p>And the HTML:</p>\n\n<pre><code>&lt;asp:GridView ID=\"gridTOC\" runat=\"server\"\n                &lt;Columns&gt;\n                    &lt;asp:TemplateField HeaderText=\"Ref Dr\" HeaderStyle-HorizontalAlign=\"Left\" ItemStyle-Width=\"15%\"&gt;\n                        &lt;ItemTemplate&gt;\n                            &lt;asp:LinkButton ID=\"btnViewRefDrDetails\" runat=\"server\" Text='&lt;%#Eval(\"ReferringName\") %&gt;' data-toggle=\"popover\"\n                                title=\"Popover Title\" ClientIDMode=\"Static\" OnClientClick=\"return false\" role=\"button\" rel=\"popover\"&gt;\n                            &lt;/asp:LinkButton&gt;\n                            &lt;%--this should be the template for the popover--%&gt;\n                            &lt;div id=\"popover-content-wrapper\" style=\"display: none;\"&gt;\n                                &lt;table&gt;\n                                    &lt;tr&gt;\n                                        &lt;td style=\"white-space: nowrap;\"&gt;&lt;b&gt;Provider Name:&lt;/b&gt;&amp;nbsp;&lt;/td&gt;\n                                        &lt;td&gt;&lt;%# Eval(\"ReferringName\")%&gt;&lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr&gt;\n                                        &lt;td style=\"white-space: nowrap;\"&gt;&lt;b&gt;Provider Specialty:&lt;/b&gt;&amp;nbsp;&lt;/td&gt;\n                                        &lt;td&gt;&lt;%# Eval(\"ProviderSpecialty\")%&gt; &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr&gt;\n                                        &lt;td style=\"white-space: nowrap;\"&gt;&lt;b&gt;Practice Name:&lt;/b&gt;&amp;nbsp;&lt;/td&gt;\n                                        &lt;td&gt;&lt;%# Eval(\"PracticeName\")%&gt;&lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr&gt;\n                                        &lt;td style=\"white-space: nowrap;\"&gt;&lt;b&gt;Practice Address:&lt;/b&gt;&amp;nbsp;&lt;/td&gt;\n                                        &lt;td&gt;&lt;%# Eval(\"PracticeAddress\")%&gt;&lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr&gt;\n                                        &lt;td style=\"white-space: nowrap;\"&gt;&lt;b&gt;Practice City:&lt;/b&gt;&amp;nbsp;&lt;/td&gt;\n                                        &lt;td&gt;&lt;%# Eval(\"PracticeCity\")%&gt; &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr&gt;\n                                        &lt;td style=\"white-space: nowrap;\"&gt;&lt;b&gt;Practice State:&lt;/b&gt;&amp;nbsp;&lt;/td&gt;\n                                        &lt;td&gt;&lt;%# Eval(\"PracticeState\")%&gt; &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr&gt;\n                                        &lt;td style=\"white-space: nowrap;\"&gt;&lt;b&gt;Practice ZIP:&lt;/b&gt;&amp;nbsp;&lt;/td&gt;\n                                        &lt;td&gt;&lt;%# Eval(\"PracticeZip\")%&gt; &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                    &lt;tr&gt;\n                                        &lt;td style=\"white-space: nowrap;\"&gt;&lt;b&gt;Practice Phone:&lt;/b&gt;&amp;nbsp;&lt;/td&gt;\n                                        &lt;td&gt;&lt;%# Eval(\"PracticePhone\")%&gt; &lt;/td&gt;\n                                    &lt;/tr&gt;\n                                &lt;/table&gt;\n                            &lt;/div&gt;\n                            &lt;div id=\"popover-title\" style=\"display: none\"&gt;\n                                &lt;%# Eval(\"ReferringName\")%&gt;\n                            &lt;/div&gt;\n                        &lt;/ItemTemplate&gt;\n                    &lt;/asp:TemplateField&gt;\n                &lt;/Columns&gt;\n            &lt;/asp:GridView&gt;\n</code></pre>\n\n<p>When I click the LinkButton, nothing happens at all. No errors, just nothing. When I just hard code the popover's title and content it works fine. What do?</p>\n"}, {"tags": ["c#", "sql-server", "datetime"], "comments": [{"owner": {"reputation": 3190, "user_id": 2169261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e017d83ccdbfe78e3e9b9a30f944ead5?s=128&d=identicon&r=PG", "display_name": "techspider", "link": "https://stackoverflow.com/users/2169261/techspider"}, "edited": false, "score": 0, "creation_date": 1473282248, "post_id": 39378959, "comment_id": 66085852, "body": "How are you able to add a parameter to <code>ORDER BY</code> clause?"}, {"owner": {"reputation": 362, "user_id": 2878684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SV8fD.jpg?s=128&g=1", "display_name": "OctoCode", "link": "https://stackoverflow.com/users/2878684/octocode"}, "edited": false, "score": 0, "creation_date": 1473282378, "post_id": 39378959, "comment_id": 66085915, "body": "If it&#39;s not sorting properly, maybe you just need to set proper date style."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1473282449, "post_id": 39378959, "comment_id": 66085952, "body": "Pass a date instead of a string and many problems will disappear"}, {"owner": {"reputation": 2894, "user_id": 6599076, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Ajyqg.png?s=128&g=1", "display_name": "BRass", "link": "https://stackoverflow.com/users/6599076/brass"}, "reply_to_user": {"reputation": 3190, "user_id": 2169261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e017d83ccdbfe78e3e9b9a30f944ead5?s=128&d=identicon&r=PG", "display_name": "techspider", "link": "https://stackoverflow.com/users/2169261/techspider"}, "edited": false, "score": 0, "creation_date": 1473282676, "post_id": 39378959, "comment_id": 66086061, "body": "@techspider - the parameters were on the .NET code that inserts the date strings.  The ORDER BY was part of a normal SQL query that I&#39;m executing on this data that .NET is inserting."}, {"owner": {"reputation": 2894, "user_id": 6599076, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Ajyqg.png?s=128&g=1", "display_name": "BRass", "link": "https://stackoverflow.com/users/6599076/brass"}, "reply_to_user": {"reputation": 362, "user_id": 2878684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SV8fD.jpg?s=128&g=1", "display_name": "OctoCode", "link": "https://stackoverflow.com/users/2878684/octocode"}, "edited": false, "score": 0, "creation_date": 1473282767, "post_id": 39378959, "comment_id": 66086109, "body": "@OctoCode - That&#39;s exactly what I was thinking too.  I tried a bunch of style options from the link in my post.  I&#39;m a little surprised that SQL Server doesn&#39;t grab the right time even when converting to a date, but I suppose the time isn&#39;t part of that data type."}, {"owner": {"reputation": 2894, "user_id": 6599076, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Ajyqg.png?s=128&g=1", "display_name": "BRass", "link": "https://stackoverflow.com/users/6599076/brass"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1473282800, "post_id": 39378959, "comment_id": 66086132, "body": "@Plutonix - Agreed - if I could change this legacy code to just use date formats I would."}], "answers": [{"tags": [], "owner": {"reputation": 2894, "user_id": 6599076, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Ajyqg.png?s=128&g=1", "display_name": "BRass", "link": "https://stackoverflow.com/users/6599076/brass"}, "is_accepted": true, "score": 0, "last_activity_date": 1473282344, "creation_date": 1473282344, "answer_id": 39379000, "question_id": 39378959, "link": "https://stackoverflow.com/questions/39378959/sql-server-date-conversion-from-net-datetime-now-tostring/39379000#39379000", "title": "SQL Server Date Conversion from .NET DateTime.Now.ToString", "body": "<p>Wow.  I somehow missed this for the past hour of looking.  It was obvious, but here it is in case someone else stumbles into this.</p>\n\n<p>I don't know SQL Server data types well (obviously).  Using DateTime on that side fixed this issue.</p>\n\n<pre><code>order by CONVERT(DATETIME, DateSent)\n</code></pre>\n"}], "owner": {"reputation": 2894, "user_id": 6599076, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Ajyqg.png?s=128&g=1", "display_name": "BRass", "link": "https://stackoverflow.com/users/6599076/brass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 39379000, "answer_count": 1, "score": 0, "last_activity_date": 1473282344, "creation_date": 1473282174, "question_id": 39378959, "link": "https://stackoverflow.com/questions/39378959/sql-server-date-conversion-from-net-datetime-now-tostring", "title": "SQL Server Date Conversion from .NET DateTime.Now.ToString", "body": "<p>We have a legacy system written in .NET which inserts a simple DateTime into SQL Server (as a string field).  Something like below:</p>\n\n<pre><code>cmd.Parameters.Add(new SqlParameter(\"@dateSent\", DateTime.Now.ToString()));\n</code></pre>\n\n<p>This results in a string like below in the SQL Server database:</p>\n\n<pre><code>9/6/2016 3:00:15 AM\n</code></pre>\n\n<p>I'm simply trying to run some queries in SQL Server and convert this format to a date.  For example, sorting by below:</p>\n\n<pre><code>order by CONVERT(DATE, DateSent)\n</code></pre>\n\n<p>Will get the proper date, but the time format doesn't sort properly.  I've tried a few SQL Server formats <a href=\"https://msdn.microsoft.com/en-us/library/ms187928.aspx\" rel=\"nofollow\">example link here</a> but these don't seem to work.  </p>\n\n<p>I must be missing something obvious?  I would have assumed the default .NET DateTime would very easily convert in SQL Server.</p>\n"}, {"tags": ["c#", "wcf"], "owner": {"reputation": 31, "user_id": 6806444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e3ec8ce95ca2451b00beacf99f14689?s=128&d=identicon&r=PG&f=1", "display_name": "Paragon", "link": "https://stackoverflow.com/users/6806444/paragon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 438, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1473282141, "creation_date": 1473282141, "question_id": 39378946, "link": "https://stackoverflow.com/questions/39378946/cannot-turn-on-includeexceptiondetailinfaults-for-certain-wcf-service", "title": "Cannot turn on includeExceptionDetailInFaults for certain WCF service", "body": "<p>I have a WCF project with two endpoints. One endpoint \"EP1\" shows detailed exceptions in the WCF Test Client but \"EP2\" does not and shows an error message saying:</p>\n\n<p><strong>The server was unable to process the request due to an internal error.  For more information about the error, either turn on IncludeExceptionDetailInFaults (either from ServiceBehaviorAttribute or from the  configuration behavior) on the server in order to send the exception information back to the client</strong></p>\n\n<p>I am wondering why this is? I have set the web.config in the same way as \"EP1\" and on the \"EP2\" web service class I have added:</p>\n\n<pre><code>[ServiceBehavior(IncludeExceptionDetailInFaults = true)]\n</code></pre>\n\n<p>I can't imagine what could be different. I have double checked the class name is definitely correct. Here is the section of the web config:</p>\n\n<pre><code> &lt;system.serviceModel&gt;\n    &lt;services&gt;\n      &lt;service name=\"Portal.EP1\" behaviorConfiguration=\"debug\"&gt;&lt;/service&gt;\n    &lt;service name=\"Portal.EP2\" behaviorConfiguration=\"debug\"&gt;&lt;/service&gt;\n    &lt;/services&gt;\n    &lt;behaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"debug\"&gt;\n          &lt;!-- To avoid disclosing metadata information, set the value below to false before deployment --&gt;\n          &lt;serviceMetadata httpGetEnabled=\"true\"/&gt;\n          &lt;!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information --&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"true\"/&gt;\n        &lt;/behavior&gt;\n     &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n    &lt;serviceHostingEnvironment multipleSiteBindingsEnabled=\"true\" /&gt;\n  &lt;/system.serviceModel&gt;\n</code></pre>\n\n<p>Am I crazy?</p>\n"}, {"tags": ["c#", "generics", "reflection", "delegates", "func"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6996876"}, "edited": false, "score": 0, "creation_date": 1473287902, "post_id": 39378899, "comment_id": 66087897, "body": "Are you creating delegates to speed up some reflection overhead, not really db queries?"}, {"owner": {"reputation": 167, "user_id": 6663852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbd70fb51e5c35e75bc9d305480cace3?s=128&d=identicon&r=PG&f=1", "display_name": "Nigel DH", "link": "https://stackoverflow.com/users/6663852/nigel-dh"}, "edited": false, "score": 1, "creation_date": 1473317000, "post_id": 39378899, "comment_id": 66095407, "body": "yes, it&#39;s to speed up reflection.  I guess it doesn&#39;t matter what I&#39;m doing with the code itself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6996876"}, "edited": false, "score": 0, "creation_date": 1473399495, "post_id": 39378899, "comment_id": 66134366, "body": "Thanks. Well, sometimes putting it into perspective might be useful..."}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 6663852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbd70fb51e5c35e75bc9d305480cace3?s=128&d=identicon&r=PG&f=1", "display_name": "Nigel DH", "link": "https://stackoverflow.com/users/6663852/nigel-dh"}, "edited": false, "score": 0, "creation_date": 1473318012, "post_id": 39379710, "comment_id": 66095948, "body": "Switching to IEnumerable did the trick, many thanks.  A question, though.  Is there a particular gain to using compiled expressions over delegates?  I&#39;m still quite new to c# so the difference, other than how they are technically put together, isn&#39;t clear to me."}, {"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "reply_to_user": {"reputation": 167, "user_id": 6663852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbd70fb51e5c35e75bc9d305480cace3?s=128&d=identicon&r=PG&f=1", "display_name": "Nigel DH", "link": "https://stackoverflow.com/users/6663852/nigel-dh"}, "edited": false, "score": 1, "creation_date": 1473349223, "post_id": 39379710, "comment_id": 66116358, "body": "@NigelDH Compiled expressions essentially reduce to a func delegate, so what you are gaining may only be readability and some modularity if you need to build multiple flavors of delegates.  In some cases it may be faster than CreateDelegate, but you&#39;ll need to profile.  The corresponding CreateDelegate call would be <code>var converted = (Func&lt;IElement, bool, bool, IEnumerable&lt;IConnectionTable&gt;&gt;)Delegate.CreateDelegate(typeo&zwnj;&#8203;f(Func&lt;IElement, bool, bool, IEnumerable&lt;T&gt;&gt;),  \t\tnew MyClass(), generic);</code>"}], "tags": [], "owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "is_accepted": true, "score": 3, "last_activity_date": 1473349951, "last_edit_date": 1473349951, "creation_date": 1473285902, "answer_id": 39379710, "question_id": 39378899, "link": "https://stackoverflow.com/questions/39378899/error-when-binding-generic-method-delegate-signature-or-security-transparency/39379710#39379710", "title": "Error when binding generic method delegate - Signature or Security Transparency", "body": "<p>The reason you are running into difficulties actually has nothing to do with your generic invocation, but rather your return type.  Generic classes do not support covariance, which is essentially what you are trying to accomplish by returning <code>List&lt;IConnectionTable&gt;</code> when using a concrete type that implements <code>IConnectionTable</code>. </p>\n\n<p>A workaround for this is to use a covariant interface collection, such as <code>IEnumerable&lt;T&gt;</code>.  In addition, you need to add an actual instance via the second parameter, since <code>this</code> is probably pointing at the incorrect context.</p>\n\n<pre><code>var converted = (Func&lt;IElement, bool, bool, IEnumerable&lt;IConnectionTable&gt;&gt;)\n    Delegate.CreateDelegate(typeo\u200c\u200bf(Func&lt;IElement, bool, bool, IEnumerable&lt;IConnectionTable&gt;&gt;), new MyClass(), generic);\n</code></pre>\n\n<p>In addition, you might want to consider compiled expressions instead of delegates since they play nicely with your situation and give you more readability and potentially more flexibility.  You will want to profile each methodology and determine which performs better. </p>\n\n<p>The following is a simple cached compiled expression example that correctly outputs \"we got called\" from the compiled expression.</p>\n\n<pre><code>void Main()\n{\n    var key = typeof(ConnectionTypeOne).FullName;\n    Func&lt;IElement, bool, bool, IEnumerable&lt;IConnectionTable&gt;&gt; expr = \n        _cache.ContainsKey(key) ? _cache[key]\n        : CreateConnectionExpression&lt;ConnectionTypeOne&gt;(key);\n\n    expr(new Element(), true, true);\n}\n\nprivate static IDictionary&lt;string, Func&lt;IElement, bool, bool, IEnumerable&lt;IConnectionTable&gt;&gt;&gt; _cache = \n    new Dictionary&lt;string, Func&lt;IElement, bool, bool, IEnumerable&lt;IConnectionTable&gt;&gt;&gt;();\n\nprivate Func&lt;IElement, bool, bool, IEnumerable&lt;IConnectionTable&gt;&gt; CreateConnectionExpression&lt;T&gt;(string connectionType)\n    where T : IConnectionTable\n{\n    // Get the type element from the passed string.\n    Type elementType = Type.GetType(connectionType, true);\n\n    // Create the generic method using that type.\n    MethodInfo method = typeof(MyClass).GetMethod(\"GetConnections\", new Type[] { typeof(IElement), typeof(bool), typeof(bool) });\n    MethodInfo generic = method.MakeGenericMethod(elementType);\n\n    var instance = Expression.Constant(new MyClass());\n    var c1 = Expression.Parameter(typeof(IElement));\n    var c2 = Expression.Parameter(typeof(bool));\n    var c3 = Expression.Parameter(typeof(bool));\n\n    var expr = Expression.Call(instance, generic, c1, c2, c3);\n    Func&lt;IElement, bool, bool, IEnumerable&lt;IConnectionTable&gt;&gt; compiledExpr =\n        (Func&lt;IElement, bool, bool, IEnumerable&lt;IConnectionTable&gt;&gt;)\n            Expression.Lambda(expr, c1, c2, c3).Compile();\n\n    _cache[connectionType] = compiledExpr;\n\n    return compiledExpr;\n}\n\npublic class MyClass \n{\n    public List&lt;T&gt; GetConnections&lt;T&gt;(IElement element, bool getChildren, bool getParents) \n        where T : IConnectionTable, new()\n    {\n        Console.WriteLine(\"we got called\");\n        return new List&lt;T&gt;();\n    }\n}\n\npublic interface IElement { }\npublic interface IConnectionTable { }\n\npublic class Element : IElement { }\npublic class ConnectionTypeOne : IConnectionTable { }\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 6663852, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cbd70fb51e5c35e75bc9d305480cace3?s=128&d=identicon&r=PG&f=1", "display_name": "Nigel DH", "link": "https://stackoverflow.com/users/6663852/nigel-dh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1672, "favorite_count": 0, "accepted_answer_id": 39379710, "answer_count": 1, "score": 1, "last_activity_date": 1473349951, "creation_date": 1473281935, "last_edit_date": 1473318500, "question_id": 39378899, "link": "https://stackoverflow.com/questions/39378899/error-when-binding-generic-method-delegate-signature-or-security-transparency", "title": "Error when binding generic method delegate - Signature or Security Transparency", "body": "<p>I'm using reflection to do some database queries and in creating delegates to speed up the use of reflection a bit I have stumbled upon the following error:</p>\n\n<blockquote>\n  <p>Cannot bind to the target method because its signature or security\n  transparency is not compatible with that of the delegate type. </p>\n</blockquote>\n\n<p>I have two methods which create these delegates, both with similar structures, but one works and the other doesn't.  The only major difference between them is that the one which doesn't work has more parameters and returns a List with a generic type where as the working one only takes a single parameter and returns a single value of a declared type rather than a generic T.  </p>\n\n<p>Here's some example code:</p>\n\n<p><strong>The Method</strong></p>\n\n<pre><code>public List&lt;T&gt; GetConnections&lt;T&gt;(IElement element, bool getChildren, bool getParents) where T : IConnectionTable, new()\n{\n    // do some database stuff and return a List&lt;T&gt; where the constraints on\n    // T follow the method description above.\n}\n</code></pre>\n\n<p><strong>Creating the Delegate</strong></p>\n\n<p>Simplified for clarity</p>\n\n<pre><code>private Func&lt;IElement, bool, bool, List&lt;IConnectionTable&gt;&gt; GetConnectionsDelegate(string connectionType)\n{\n    // Get the type element from the passed string.\n    Type elementType = Type.GetType(connectionType, true);\n\n    // Create the generic method using that type.\n    MethodInfo method = typeof(MyClass).GetMethod(\"GetConnections\", new Type[]{ typeof(IElement), typeof(bool), typeof(bool) });\n    MethodInfo generic = method.MakeGenericMethod(elementType);\n\n    // Create a delegate of the method to speed up subsequent queries.\n    var converted = (Func&lt;IElement, bool, bool, List&lt;IConnectionTable&gt;&gt;)Delegate.CreateDelegate(typeof(Func&lt;IElement, bool, bool, List&lt;IConnectionTable&gt;&gt;), this, generic);\n\n    // the above line is where it dies\n}\n</code></pre>\n\n<p>The actual code saves the delegate into a private static dictionary so I only have to use reflection once.  </p>\n\n<p>If I print out the contents of <em>method</em> and <em>generic</em> it all seems to be correctly converted.</p>\n\n<pre><code>Result StandardOutput:  \n\nSystem.Collections.Generic.List`1[T] GetConnections[T](MyProject.Database.IElement, Boolean, Boolean)\nSystem.Collections.Generic.List`1[MyTestProject.TestConnection] GetConnections[TestConnection](MyProject.Database.IElement, Boolean, Boolean)\n</code></pre>\n\n<p>My assumption here is that the problems lie in the difference between the generic List vs IConnectionTable List return types but making the method return a non-generic list results in a lot of cast errors in the generic method and is kinda wrong to do anyway.  Plus, that code runs fine when tested.  </p>\n\n<p>It shouldn't be the difference between the private and public methods as my other delegate creation methods are the same and work fine (I've also tried changing <em>GetConnectionsDelegate</em> to public and it makes no difference.)</p>\n\n<p>Any help would be much appreciated.</p>\n\n<p>ndh</p>\n"}, {"tags": ["c#", "unit-testing", "asp.net-core", "xunit", "asp.net-core-webapi"], "answers": [{"comments": [{"owner": {"reputation": 1875, "user_id": 1334979, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/79ec09b22ddf683495ea6e01ed5c1184?s=128&d=identicon&r=PG", "display_name": "mesut", "link": "https://stackoverflow.com/users/1334979/mesut"}, "edited": false, "score": 4, "creation_date": 1517407730, "post_id": 39380332, "comment_id": 84083409, "body": "what about if returning dynamic object in ok, for example: Ok(new {token=&quot;&quot;, expiration=DateTime.Now.AddHours(1)};"}, {"owner": {"reputation": 359, "user_id": 1292517, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154354798972178/picture?type=large", "display_name": "Ruben D. Lopez", "link": "https://stackoverflow.com/users/1292517/ruben-d-lopez"}, "edited": false, "score": 0, "creation_date": 1531293312, "post_id": 39380332, "comment_id": 89536111, "body": "Saved my day.  Just to add that I got a warning from RSharper stating &quot;Assert.Equal should be Assert.AreEqual&quot;"}, {"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "edited": false, "score": 0, "creation_date": 1548434017, "post_id": 39380332, "comment_id": 95552742, "body": "It seems that there&#39;s something more to what&#39;s returned. I&#39;m returning <i>IActionResult&lt;List&lt;Donkey&gt;&gt;</i> but when I softly cast the result to <i>List&lt;Donkey&gt;</i> I get <i>null</i> because it&#39;s got included properties and the object seems to be of the type <i>QueryableIncludeable</i> or something like that. Never seen that class before..."}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "reply_to_user": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "edited": false, "score": 0, "creation_date": 1548434217, "post_id": 39380332, "comment_id": 95552855, "body": "@KonradViltersten That is an invalid cast. Check this article in docs <a href=\"https://docs.microsoft.com/en-us/aspnet/core/web-api/action-return-types?view=aspnetcore-2.2#actionresultt-type\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/aspnet/core/web-api/&hellip;</a>"}, {"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "edited": false, "score": 0, "creation_date": 1548448589, "post_id": 39380332, "comment_id": 95559259, "body": "Sorry, I can&#39;t see it in the text. Possibly due to my confusion. I noticed that when I have included something and return an array of such objects that have each one its own inclusion, I had to use that class. Would you be able to elaborate what you meant that the case was invalid, please?"}], "tags": [], "owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "is_accepted": true, "score": 40, "last_activity_date": 1473292144, "last_edit_date": 1473292144, "creation_date": 1473290061, "answer_id": 39380332, "question_id": 39378873, "link": "https://stackoverflow.com/questions/39378873/how-to-get-content-value-in-xunit-when-result-returned-in-iactionresult-type/39380332#39380332", "title": "How to get content value in Xunit when result returned in IActionResult type", "body": "<p>Depends on what you expect returned. From previous example you used an action like this.</p>\n\n<pre><code>[HttpGet(\"{id}\")]\npublic IActionResult Get(string id) {        \n    var r = unitOfWork.Resources.Get(id);\n\n    unitOfWork.Complete();\n\n    Models.Resource result = ConvertResourceFromCoreToApi(r);\n\n    if (result == null) {\n        return NotFound();\n    } else {\n        return Ok(result);\n    }        \n}\n</code></pre>\n\n<p>That method will either return a <code>OkObjectResult</code> or a <code>NotFoundResult</code>. If the expectation of the method under test is for it to return <code>Ok()</code> then you need to cast the result in the test to what you expect and then do your assertions on that</p>\n\n<pre><code>public void GetTest_Given_Id_Should_Return_OkObjectResult_With_Resource() {\n    //Arrange\n    var expected = \"test\";\n    var controller = new ResourcesController(mockDb);\n\n    //Act\n    var actionResult = controller.Get(\"1\");\n\n    //Assert\n    var okObjectResult = actionResult as OkObjectResult;\n    Assert.NotNull(okObjectResult);\n\n    var model = okObjectResult.Value as Models.Resource;\n    Assert.NotNull(model);\n\n    var actual = model.Description;\n    Assert.Equal(expected, actual);\n}\n</code></pre>\n"}], "owner": {"reputation": 439, "user_id": 6506156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/776520070cf7bd06fcf6b577e506465a?s=128&d=identicon&r=PG&f=1", "display_name": "Julie C.", "link": "https://stackoverflow.com/users/6506156/julie-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23376, "favorite_count": 5, "accepted_answer_id": 39380332, "answer_count": 1, "score": 28, "last_activity_date": 1473292144, "creation_date": 1473281834, "last_edit_date": 1473291104, "question_id": 39378873, "link": "https://stackoverflow.com/questions/39378873/how-to-get-content-value-in-xunit-when-result-returned-in-iactionresult-type", "title": "How to get content value in Xunit when result returned in IActionResult type", "body": "<p>I have a unit test project using Xunit and the method we are testing returns <code>IActionResult</code>. </p>\n\n<p>I saw some people suggest using \"NegotiatedContentResult\" to get the content of the <code>IActionResult</code> but that doesn't work in Xunit.</p>\n\n<p>So I wonder how to get the content value of an <code>IActionResult</code> in Xunit?</p>\n\n<p>Test code example is provided below:</p>\n\n<pre><code>public void GetTest()\n{\n    var getTest = new ResourcesController(mockDb);\n\n    var result = getTest.Get(\"1\");\n\n    //Here I want to convert the result to my model called Resource and\n    //compare the attribute Description like below.\n    Resource r = ?? //to get the content value of the IActionResult\n\n    Assert.Equal(\"test\", r.Description);\n}\n</code></pre>\n\n<p>Does anyone know how to do this in XUnit?</p>\n"}, {"tags": ["c#", "ssis", "access-violation"], "answers": [{"tags": [], "owner": {"reputation": 1858, "user_id": 1040437, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c2cea78a2e9da9add2f8988d0f45700?s=128&d=identicon&r=PG", "display_name": "John Zabroski", "link": "https://stackoverflow.com/users/1040437/john-zabroski"}, "is_accepted": true, "score": 0, "last_activity_date": 1492655917, "creation_date": 1492655917, "answer_id": 43509260, "question_id": 39378849, "link": "https://stackoverflow.com/questions/39378849/what-to-do-when-accessviolationexception-in-net-4-app-defies-msdn-documented-be/43509260#43509260", "title": "What to do when AccessViolationException in .NET 4 app defies MSDN documented behavior?", "body": "<p>The root cause is in fact \"air space\" due to crossing runtime environment from .NET 4 to .NET 2.</p>\n\n<p>Also, it turns out SQL Server 2008 R2 SSIS Runtime likely has a double free memory bug in SQL logging subcomponent.</p>\n"}], "owner": {"reputation": 1858, "user_id": 1040437, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0c2cea78a2e9da9add2f8988d0f45700?s=128&d=identicon&r=PG", "display_name": "John Zabroski", "link": "https://stackoverflow.com/users/1040437/john-zabroski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 1, "accepted_answer_id": 43509260, "answer_count": 1, "score": 0, "last_activity_date": 1492655917, "creation_date": 1473281710, "last_edit_date": 1473686360, "question_id": 39378849, "link": "https://stackoverflow.com/questions/39378849/what-to-do-when-accessviolationexception-in-net-4-app-defies-msdn-documented-be", "title": "What to do when AccessViolationException in .NET 4 app defies MSDN documented behavior?", "body": "<p>I have a .NET 4 Application written as a Windows Service, that includes unmanaged components, and is printing an AccessViolationException to my log4net logs, but is not crashing the application.  Everything about this issue sounds impossible.  Below is what I think is happening, and I am wondering what my next steps as the developer should be?  This issue is NOT happening in a parallel replay environment with the same data feed as Production.</p>\n\n<ol>\n<li>The memory corruption issue manifests as an AccessViolationException, with a stack trace blaming SSIS runtime \u201cDTS\u201d.</li>\n<li>DataLoaderWinSvc.exe is a .NET 4 application, registered/running as a Windows Local Service.</li>\n<li>Microsoft changed the CLR in .NET 4 so that AccessViolationException cause the application to crash by default.</li>\n<li>DataLoaderWinSvc.exe, however, does not crash.  This led me to investigate how this could possibly be?</li>\n<li>There is one way to let developers handle the exception in .NET 4, but the DataLoaderWinSvc.exe code is not using the [HandleProcessCorruptedStateExceptions] technique. <a href=\"https://msdn.microsoft.com/en-us/library/system.accessviolationexception(v=vs.110).aspx#Anchor_6\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/system.accessviolationexception(v=vs.110).aspx#Anchor_6</a>:</li>\n</ol>\n\n<blockquote>\n  <p>Starting with the .NET Framework 4, <code>AccessViolationException</code>\n  exceptions thrown by the common language runtime are not handled by\n  the catch statement in a structured exception handler if the exception\n  occurs outside of the memory reserved by the common language runtime.\n  To handle such an <code>AccessViolationException</code> exception, you should apply\n  the <code>HandleProcessCorruptedStateExceptionsAttribute</code> attribute to the\n  method in which the exception is thrown.</p>\n</blockquote>\n\n<ol start=\"6\">\n<li>Based on the DataLoaderWinSvc.txt log4net logs, it is clear that DataLoaderWinSvc.exe IS able to handle this exception despite running as a .NET Framework 4 application, otherwise we wouldn\u2019t have any logging statements and would simply crash.  There is no crash, at all, however.</li>\n<li>By using Process Explorer.exe, I checked to see if maybe somehow the version of the code deployed wasn't using .NET 4 Framework. - This is where I start seeing something suspicious! It turns out that the SSIS runtime DLL, d:\\Program Files (x86)\\Microsoft SQL Server\\120\\SDK\\Assemblies\\Microsoft.SQLServer.ManagedDTS.dll, is a .NET 2.0 assembly.</li>\n<li>It seems like, based on the Process Explorer.exe, that while the Microsoft.SQLServer.ManagedDTS.dll I am calling is a .NET 4 assembly, its actually delegating the work to a CLR v2.0.50727 assembly with a native image (ngen\u2019d assembly).</li>\n<li>If the AccessViolationException is happening in a CLR v2.0.50727 assembly, then that is probably how we are able to catch this supposedly uncatchable exception.</li>\n</ol>\n\n<blockquote>\n  <p>Here is the anonymized stack trace:</p>\n  \n  <p>2016-08-16 20:58:38,207 ERROR: Orchestration: Initialization\n  System.AccessViolationException: Attempted to read or write protected\n  memory. This is often an indication that other memory is corrupt.<br>\n  at Microsoft.SqlServer.Dts.Runtime.Package.Execute()    at\n  DataLoader.Orchestration.DoWork() in\n  D:\\SourceCode\\DataLoader\\Mainline\\Core\\Orchestration.cs:line 198\n  System.AccessViolationException: Attempted to read or write protected\n  memory. This is often an indication that other memory is corrupt.<br>\n  at Microsoft.SqlServer.Dts.Runtime.Package.Execute()    at\n  DataLoader.Orchestration.DoWork() in\n  D:\\SourceCode\\DataLoader\\Mainline\\Core\\Orchestration.cs:line 198</p>\n</blockquote>\n\n<p>And here is roughly a snippet approximating what the code is doing:</p>\n\n<pre><code>public class Orchestration\n{\n  private Application m_DTSApplication;\n  private Package m_DTSPackage;\n\n  public IntradayOrchestration()\n  {\n    InitializeDTSPackage();\n  }\n\n  private void InitiatlizeDTSPackage()\n  {\n    m_DTSPackageLocation = ConfigurationManager.AppSettings[\"DTSPackageLocation\"].ToString();\n    m_DTSPackageConfigLocation = ConfigurationManager.AppSettings[\"DTSPackageConfigLocation\"].ToString();\n\n    m_DTSApplication = new Application();\n    m_DTSApplication.PackagePassword = ConfigurationManager.AppSettings[\"DTSPackagePassword\"];\n\n    m_DTSPackage = m_DTSApplication.LoadPackage(m_DTSPackageLocation, null);\n    m_DTSPackage.ImportConfigurationFile(m_DTSPackageConfigLocation);       \n  }\n\n  private void DoWork()\n  {\n    try\n    {\n      Stopwatch sw = Stopwatch.StartNew();\n      while (true)\n      {\n        sw.Start();\n        DTSExecResult result = m_DTSPackage.Execute();                                           \n        sw.Stop();\n        Logger.ReportInfo(DateTime.Now.ToString() + \"Time taken by dts package= \" + sw.ElapsedMilliseconds.ToString());\n\n        // Check retuns status and check for errors on Job execution\n        if (result != DTSExecResult.Success || m_DTSPackage.Errors != null)\n        {\n          if (m_DTSPackage.Errors != null)\n          {\n            foreach (DtsError error in m_DTSPackage.Errors)\n            {\n              string errorMesg = string.Format(\"Orchestration: SSIS Package [{0}] Error: Code[{1}] Source[{2}] Component[{3}] Description[{4}]\", m_DTSPackage.Name, error.ErrorCode, error.Source, error.SubComponent, error.Description);\n              Logger.ReportError(errorMesg, new ApplicationException(errorMesg));\n            }\n          }\n          else\n          {\n            string errorMesg = string.Format(\"Orchestration: SSIS Package [{0}] did not complete successfully. Return status [{1}]\", m_DTSPackage.Name, result.ToString());\n            Logger.ReportError(errorMesg, new ApplicationException(errorMesg));\n          }\n        }\n        else\n        {\n          Logger.ReportInfo(\n            string.Format(\"Orchestration: SSIS Package [{0}] completed successfully\", m_DTSPackage.Name));\n        }\n     }\n     catch (Exception ex)\n     {\n        Logger.ReportError(\n            string.Format(\"Orchestration: SSIS Package [{0}] completed successfully\", m_DTSPackage.Name));\n     }\n  }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net-mvc", "razor", "asp.net-core-mvc"], "comments": [{"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "edited": false, "score": 1, "creation_date": 1473281772, "post_id": 39378836, "comment_id": 66085648, "body": "I don&#39;t see a problem with this approach. I would prefer to rename the properties to <code>ProductToEdit</code> and <code>ProductList</code> to be more readable :)"}, {"owner": {"reputation": 1368, "user_id": 3743442, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FNcij.jpg?s=128&g=1", "display_name": "Hadee", "link": "https://stackoverflow.com/users/3743442/hadee"}, "edited": false, "score": 0, "creation_date": 1473286060, "post_id": 39378836, "comment_id": 66087323, "body": "What is the problem exactly?! your method or your view?"}], "answers": [{"comments": [{"owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "edited": false, "score": 0, "creation_date": 1473343434, "post_id": 39379554, "comment_id": 66112141, "body": "thanks for this response. I was confused because I wasn&#39;t sure if I would be able to bind a list to a partial and then in the partial be able to get the first item in the list and use it to bind the form in the partial. Please confirm that this is possible."}, {"owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "edited": false, "score": 0, "creation_date": 1473344191, "post_id": 39379554, "comment_id": 66112723, "body": "actually yes, this is my problem. So I have the razor if statement setup but within the form how do I bind the asp.net tag helpers like asp-for=&quot;FirstItem.Id&quot;, asp-for=&quot;FirstItem.Name&quot; and so on. It is forcing me to use the main page model which is IEnumerable."}, {"owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "edited": false, "score": 0, "creation_date": 1473344298, "post_id": 39379554, "comment_id": 66112811, "body": "I think I got it. I need to do asp-for=&quot;First().Name&quot;. Make sense?"}, {"owner": {"reputation": 2203, "user_id": 117000, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1f182510ae4c51df63e11d0b069ad439?s=128&d=identicon&r=PG", "display_name": "Val", "link": "https://stackoverflow.com/users/117000/val"}, "reply_to_user": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "edited": false, "score": 0, "creation_date": 1473444556, "post_id": 39379554, "comment_id": 66159609, "body": "@BlakeRivell Sorry, was super-busy yesterday. I haven&#39;t used the tag helpers, so I don&#39;t know specifically, but it looks like <code>asp-for=&quot;First().Name&quot;</code> should work. Alternately, store a reference to the first item in a local variable, and then refer to that variable directly, something like <code>@{ var firstItem = Model.First(); }</code> and then later <code>asp-for=&quot;firstItem.Name&quot;</code>"}], "tags": [], "owner": {"reputation": 2203, "user_id": 117000, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1f182510ae4c51df63e11d0b069ad439?s=128&d=identicon&r=PG", "display_name": "Val", "link": "https://stackoverflow.com/users/117000/val"}, "is_accepted": true, "score": 1, "last_activity_date": 1473285088, "creation_date": 1473285088, "answer_id": 39379554, "question_id": 39378836, "link": "https://stackoverflow.com/questions/39378836/defining-a-viewmodel-for-a-razor-partial-that-will-either-display-a-form-if-only/39379554#39379554", "title": "Defining a ViewModel for a razor partial that will either display a form if only one and a table if multiple", "body": "<p>It seems simpler to me if the model contains a single property -- call it <code>Products</code> since it's a collection. In the view, test its <code>Count()</code> and either render the form or the table. Binding won't be a problem -- just take the <code>First()</code> item if the <code>Count() == 1</code>.</p>\n\n<p>If you have two properties, what will you do if they both have data? What if the product in the single-value property is different from the first one in the collection? Which one wins?</p>\n\n<p>You can solve these problems by enforcing business rules in the controller or on the model itself -- but yuo can avoid them entirely if you just have a collection.</p>\n"}], "owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 39379554, "answer_count": 1, "score": 0, "last_activity_date": 1488419770, "creation_date": 1473281666, "last_edit_date": 1488419770, "question_id": 39378836, "link": "https://stackoverflow.com/questions/39378836/defining-a-viewmodel-for-a-razor-partial-that-will-either-display-a-form-if-only", "title": "Defining a ViewModel for a razor partial that will either display a form if only one and a table if multiple", "body": "<p>I need to create a Partial View with MVC that will either show a List of items if more than one or an html form if only one.</p>\n\n<p>Should I create a ViewModel specifically for this partial that has the following:</p>\n\n<pre><code>public Product Product { get; set; }\npublic IEnumerable&lt;Product&gt; Product { get; set; }\n</code></pre>\n\n<p>Or would I be better off just sending the list. If I just send the list will I be able to bind the first (and only) item to the form?</p>\n\n<p>The goal is to bind the single product properties to the form if only one and if multiple loop through them and output in an html table.</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 2546, "user_id": 1193647, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/84f5b1550b64da06e7362ad87384e8bc?s=128&d=identicon&r=PG", "display_name": "Kolichikov", "link": "https://stackoverflow.com/users/1193647/kolichikov"}, "edited": false, "score": 3, "creation_date": 1473281743, "post_id": 39378824, "comment_id": 66085632, "body": "Why not just do  <code>FilesToProcess.Where(x=&gt;typeMapping.ContainsKey(x.ExtractTyp&zwnj;&#8203;e)).ForEach(conditio&zwnj;&#8203;n)</code> to filter out the missing keys first?"}, {"owner": {"reputation": 2546, "user_id": 1193647, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/84f5b1550b64da06e7362ad87384e8bc?s=128&d=identicon&r=PG", "display_name": "Kolichikov", "link": "https://stackoverflow.com/users/1193647/kolichikov"}, "edited": false, "score": 0, "creation_date": 1473281949, "post_id": 39378824, "comment_id": 66085726, "body": "Additionally, it looks like Error(x) is a function you&#39;ve defined somewhere.  If I understand your code correctly, you&#39;re just calling it in the ForEach(), and I&#39;m assuming that <code>Error()</code> returns <code>void</code>?  In that case, it might help to specify that you want an action, so replace Error(x) with <code>()=&gt;{Error(x);}</code>"}, {"owner": {"reputation": 618, "user_id": 1859889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/798fa5b67f7d43b2c83a9fdd0e9c9689?s=128&d=identicon&r=PG", "display_name": "just.ru", "link": "https://stackoverflow.com/users/1859889/just-ru"}, "edited": false, "score": 4, "creation_date": 1473282091, "post_id": 39378824, "comment_id": 66085793, "body": "Your <code>iif</code> is not a real ternary operator, it&#39;s just a method call. So its parameters are being calculated before call to <code>iif</code>. That&#39;s why you are getting an exception. Of course, you can avoid it by passing <code>Func&lt;object&gt;</code>, but, as others pointed, there are better ways to solve your problem"}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473282276, "post_id": 39378824, "comment_id": 66085863, "body": "I like this solution, but could I get the Error() method called in this one call if the key doesn&#39;t exist? I mean I could make another call after I guess which negates the ContainsKey() and then call Error() just curious if it can be done in 1 call/chain."}, {"owner": {"reputation": 2022, "user_id": 6196648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Bxcxu.png?s=128&g=1", "display_name": "Mr Anderson", "link": "https://stackoverflow.com/users/6196648/mr-anderson"}, "edited": false, "score": 2, "creation_date": 1473283720, "post_id": 39378824, "comment_id": 66086470, "body": "<code>TryGetValue()</code> is meant for this exact purpose."}], "answers": [{"comments": [{"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473282964, "post_id": 39379099, "comment_id": 66086187, "body": "The iif can go but I like the ternary operator (I was just trying an alternative way of making the ternary operator work with the iff) and if that was able to be inline I think it&#39;s plenty easy to read. Checking keys before access is such a common thing it would be nice if it was streamlined in some way."}, {"owner": {"reputation": 2022, "user_id": 6196648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Bxcxu.png?s=128&g=1", "display_name": "Mr Anderson", "link": "https://stackoverflow.com/users/6196648/mr-anderson"}, "reply_to_user": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473283016, "post_id": 39379099, "comment_id": 66086206, "body": "@user441521 Ok, but the <code>TryGetValue()</code> method is for this exact purpose."}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473283092, "post_id": 39379099, "comment_id": 66086237, "body": "And it requires making another variable and wrapping an if statement and not working in ForEach() as far as I know. Not as streamlined in my view, but it is what it is. foreach it is."}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473283819, "post_id": 39379099, "comment_id": 66086504, "body": "Perhaps something about this idea can become more generic and an extension to Dictionaries. Not exactly what you have but I&#39;m thinking there must be a way to check the key and if not exist call a function and if does exist return it&#39;s value which we then can do something with. It&#39;s not 100% coming to me yet exactly how to do that but something like:  dict.OnError(Error(x)).Try(x.KeyToTry)(x);  or something. I&#39;m thinking in very javascript terms here."}, {"owner": {"reputation": 2022, "user_id": 6196648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Bxcxu.png?s=128&g=1", "display_name": "Mr Anderson", "link": "https://stackoverflow.com/users/6196648/mr-anderson"}, "reply_to_user": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473285153, "post_id": 39379099, "comment_id": 66086989, "body": "@user441521 I figured out what you mean. See my edited answer."}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473285314, "post_id": 39379099, "comment_id": 66087055, "body": "That&#39;s what I&#39;m after, but I&#39;ll take that one step further and have 2 Action&#39;s passed in. The first one will be where you access the dictionary using the key and I&#39;ll try/catch that and if it fails call the 2nd Action which will be the error message. That should be a built-in dictionary function if you ask me."}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473285864, "post_id": 39379099, "comment_id": 66087253, "body": "I got this working but can we streamline it in a generic way more do you think: FilesToProcess.ForEach(x =&gt;                 typeMapping.Try(x.ExtractType,                     x,                     (z) =&gt; typeMapping[x.ExtractType](x),                     (z) =&gt; Error(x)                 )             );"}], "tags": [], "owner": {"reputation": 2022, "user_id": 6196648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Bxcxu.png?s=128&g=1", "display_name": "Mr Anderson", "link": "https://stackoverflow.com/users/6196648/mr-anderson"}, "is_accepted": true, "score": 4, "last_activity_date": 1473285117, "last_edit_date": 1473285117, "creation_date": 1473282867, "answer_id": 39379099, "question_id": 39378824, "link": "https://stackoverflow.com/questions/39378824/checking-a-key-exists-in-a-dictionary-of-actions-before-trying-to-call-it-using/39379099#39379099", "title": "Checking a key exists in a Dictionary of Action&#39;s before trying to call it using ForEach", "body": "<p>Your <code>iif()</code> method is counter-intuitive here, and it seems like an over-use of LINQ. Here is what I would do:</p>\n\n<pre><code>foreach (var file in filesToProcess)\n{\n    Func&lt;IniConfig, object&gt; action;\n    if (typeMapping.TryGetValue(file.ExtractType, out action))\n    {\n        action(file);\n    }\n    else\n    {\n        Error(file);\n    }\n}\n</code></pre>\n\n<p>Makes your code easier to read too :)</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I Have found a generic way to do what you want. First you need to create an extension method for <code>IDictionary&lt;TKey,TVal&gt;</code> that simply returns the default value if a key does not exist:</p>\n\n<pre><code>public static TVal GetValueOrDefault&lt;TKey, TVal&gt;(this IDictionary&lt;TKey, TVal&gt; self, TKey key)\n{\n    TVal ret;\n    self.TryGetValue(key, out ret);\n    return ret;\n}\n</code></pre>\n\n<p>Then you can use the null coalescing (<code>??</code>) operator:</p>\n\n<pre><code>FilesToProcess.ForEach((typeMapping.GetValueOrDefault(x.ExtractType) ?? Error)(x));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473283275, "post_id": 39379162, "comment_id": 66086317, "body": "I don&#39;t see the benefit of this over just doing the foreach loop directly though IF it can&#39;t all be done with a ternary inline to .ForEach()."}, {"owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "reply_to_user": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 1, "creation_date": 1473283458, "post_id": 39379162, "comment_id": 66086388, "body": "@user441521, well then do a normal <code>foreach</code> loop. I think this is more readable, but maybe it&#39;s just a matter of taste."}, {"owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "reply_to_user": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473284349, "post_id": 39379162, "comment_id": 66086706, "body": "@user441521, I edited the answer to fix your problem with <code>iif</code>."}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473284852, "post_id": 39379162, "comment_id": 66086883, "body": "This looks like it might be asking for a dictionary extension that does something similar. Provide what you want to do when they key is there and all is good and provide an error function when it&#39;s not. No need to trap the exception then and it can continue processing. Not sure yet how to get there."}, {"owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "reply_to_user": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473285344, "post_id": 39379162, "comment_id": 66087067, "body": "@user441521, I don&#39;t think you can generalize this use case into something reusable."}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473343890, "post_id": 39379162, "comment_id": 66112463, "body": "Actually I just made an extension to dictionaries where this is possible which is generic: FilesToProcess.ForEach(x =&gt;                 typeMapping.TryTest(                     () =&gt; typeMapping[x.ExtractType](x),                     () =&gt; Error(x)                 )             );"}, {"owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "reply_to_user": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473345127, "post_id": 39379162, "comment_id": 66113445, "body": "@user441521, it seems like there is something missing. How does the <code>TryTest()</code> know which of the two lambdas it should run if it doesn&#39;t know <code>x.ExtractType</code>?"}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473345597, "post_id": 39379162, "comment_id": 66113785, "body": "in the extension the first lambda is ran no matter what. this is the part that you want to do your logic and you make the assumption that the key exists. That call is inside a try/catch in the extension. If that fails (say because the key didn&#39;t exist or any other reason) then it&#39;ll run the second lambda which is the error lambda. It&#39;s different than the iif where the user has to check the key and then decide. It just says use it as if the key exists and let the try/catch be the thing that controls the flow."}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473345919, "post_id": 39379162, "comment_id": 66114030, "body": "This is the usage that I prefer. I don&#39;t want to check if the key exists. I just want to use it and if it doesn&#39;t exist I have an error option if I want to handle it. Maybe I don&#39;t want to handle it so that part could be null (have to test that)"}, {"owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "reply_to_user": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473347068, "post_id": 39379162, "comment_id": 66114860, "body": "@user441521, ok I see. But apart from being less readable this will also be slow if there are a lot of unknown keys, because you are using exceptions for control flow (which is a big no-no, actually)."}, {"owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "edited": false, "score": 0, "creation_date": 1473347542, "post_id": 39379162, "comment_id": 66115178, "body": "Yeah, it&#39;s not ideal. I&#39;m ALL about usage of a language though, when dreaming, and this pattern of just use the dictionary and worry about if a key doesn&#39;t exist in a chained error() function I think is better usage vs pre-checking. I&#39;m not using it in production, just dreaming and a coding challenge to get the usage style working."}], "tags": [], "owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "is_accepted": false, "score": 2, "last_activity_date": 1473348003, "last_edit_date": 1473348003, "creation_date": 1473283202, "answer_id": 39379162, "question_id": 39378824, "link": "https://stackoverflow.com/questions/39378824/checking-a-key-exists-in-a-dictionary-of-actions-before-trying-to-call-it-using/39379162#39379162", "title": "Checking a key exists in a Dictionary of Action&#39;s before trying to call it using ForEach", "body": "<p>Make your life easy and just create a little helper function that does what you want:</p>\n\n<pre><code>private void InvokeProcessor(IniConfig iniConfig)\n{\n    Func&lt;IniConfig, object&gt; processor;\n    if (typeMapping.TryGetValue(x.ExtractType, out processor)\n        processor(iniConfig);\n    else\n        Error(iniConfig);\n}\n</code></pre>\n\n<p>Then use it like so:</p>\n\n<pre><code>FilesToProcess.ForEach(InvokeProcessor);\n</code></pre>\n\n<p>Easy to read and understand. Also faster because the dictionary will only be searched once for each file.</p>\n\n<h2>Edit</h2>\n\n<p>Alright, if you really wanna use that weird <code>iif()</code> thing, here's how to fix it:</p>\n\n<pre><code>object iif(bool expression, Func&lt;object&gt; truePart, Func&lt;object&gt; falsePart)\n    { return expression ? truePart() : falsePart(); }\n</code></pre>\n\n<p>...and how to use it:</p>\n\n<pre><code>FilesToProcess.ForEach(x =&gt; iif(\n    typeMapping.ContainsKey(x.ExtractType), \n    () =&gt; typeMapping[x.ExtractType](x), \n    () =&gt; Error(x)));\n</code></pre>\n\n<p>Basically the evaluation of the 2<sup>nd</sup> and 3<sup>rd</sup> argument of <code>iif()</code> is delayed until one of them is actually needed. In your previous version all arguments were evaluated before the execution of <code>iff()</code> resulting in a call to the dictionary indexer <em>and</em> to <code>Error()</code> every time a <code>IniConfig</code> object was processed.</p>\n\n<p>A word of warning though: if you use this in production then harakiri might be your only way out of the devastating shame that will overcome you a couple years later.</p>\n"}], "owner": {"reputation": 6144, "user_id": 441521, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5bc98cddd5d06b2fd0c07a854e7fe15b?s=128&d=identicon&r=PG", "display_name": "user441521", "link": "https://stackoverflow.com/users/441521/user441521"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 682, "favorite_count": 0, "accepted_answer_id": 39379099, "answer_count": 2, "score": 0, "last_activity_date": 1473348003, "creation_date": 1473281605, "question_id": 39378824, "link": "https://stackoverflow.com/questions/39378824/checking-a-key-exists-in-a-dictionary-of-actions-before-trying-to-call-it-using", "title": "Checking a key exists in a Dictionary of Action&#39;s before trying to call it using ForEach", "body": "<p>I have a dictionary where the key is a string and the value is an Action. I setup mapping of string keys to functions. I then have a list that I call .ForEach() on and inside this I use a value in the list as the key and then call the function associated with it. The issue will come if the key doesn't exist. How can I check this in the .ForEach function? I'd like to use the ternary operator but it doesn't seem to work.</p>\n\n<pre><code>private Dictionary&lt;string, Func&lt;IniConfig, object&gt;&gt; typeMapping = new Dictionary&lt;string, Func&lt;IniConfig, object&gt;&gt;();\n\ntypeMapping[\"MB\"] = ProcessMB;\n\npublic object ProcessMB(IniConfig file)\n{\n    return null;\n}\n\nobject iif(bool expression, object truePart, object falsePart)\n    { return expression ? truePart : falsePart; }\n\nFilesToProcess.ForEach(x =&gt; iif(typeMapping.ContainsKey(x.ExtractType), typeMapping[x.ExtractType](x), Error(x)));\n</code></pre>\n\n<p>This highlights the 2nd parameter in the iif() call with error: Argument 2: cannot convert from 'void' to 'object', and the same thing for the Error(x) part.</p>\n\n<p>So it seems like the ternary operator returns an object? So if I change my Action to a Func and have the return type be object and make my functions return object it compiles, but when I run a test with an invalid key it doesn't go into my Error() function it throws \"The given key was not present in the dictionary\" exception. I would expect it to do the ternary operation and see that typeMapping doesn't have the key and so fail to the Error() function. What am I missing?</p>\n"}, {"tags": ["c#", "azure", "azure-webjobs", "azure-webjobssdk"], "comments": [{"owner": {"reputation": 883, "user_id": 1253154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e09e6361bb7b0a2063aa394fd11ea3d?s=128&d=identicon&r=PG", "display_name": "Dean Goodman", "link": "https://stackoverflow.com/users/1253154/dean-goodman"}, "edited": false, "score": 0, "creation_date": 1473281813, "post_id": 39378734, "comment_id": 66085663, "body": "One simple solution... write some code to manually call <code>ProcessAugustEndowments</code> from your <code>Main()</code> method.  Comment or <code>#ifdef</code> around the <code>host.RunAndBlock()</code> method I expect you have."}, {"owner": {"reputation": 13969, "user_id": 4167200, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/ceLYp.jpg?s=128&g=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4167200/thomas"}, "edited": false, "score": 0, "creation_date": 1473295248, "post_id": 39378734, "comment_id": 66089616, "body": "Is it only one function that is not working or all functions with <code>TimerTrigger</code> ? did you configure your jobhost to use timers <code>config.UseTimers();</code>?"}, {"owner": {"reputation": 887, "user_id": 2226401, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j1n0v.jpg?s=128&g=1", "display_name": "Cami Rodriguez", "link": "https://stackoverflow.com/users/2226401/cami-rodriguez"}, "edited": false, "score": 0, "creation_date": 1473348571, "post_id": 39378734, "comment_id": 66115897, "body": "No, I have some many functions with another TimerTriggers and yes this configure is on my WebJob"}, {"owner": {"reputation": 1930, "user_id": 1639385, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/17ef14f5ad2f5ca0eaa8ce41e9c2a6f4?s=128&d=identicon&r=PG", "display_name": "Ulysses Alves", "link": "https://stackoverflow.com/users/1639385/ulysses-alves"}, "reply_to_user": {"reputation": 883, "user_id": 1253154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e09e6361bb7b0a2063aa394fd11ea3d?s=128&d=identicon&r=PG", "display_name": "Dean Goodman", "link": "https://stackoverflow.com/users/1253154/dean-goodman"}, "edited": false, "score": 0, "creation_date": 1565125195, "post_id": 39378734, "comment_id": 101251977, "body": "@DeanGoodman you can also call the webjob funcion directly itself on the Main method of the Program class of the Job project."}], "answers": [{"comments": [{"owner": {"reputation": 887, "user_id": 2226401, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j1n0v.jpg?s=128&g=1", "display_name": "Cami Rodriguez", "link": "https://stackoverflow.com/users/2226401/cami-rodriguez"}, "edited": false, "score": 0, "creation_date": 1473348517, "post_id": 39385779, "comment_id": 66115861, "body": "Thanks for your answert I will test it! :D"}, {"owner": {"reputation": 17081, "user_id": 6755924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2016daeafc6c9469fde7bab85f8214d6?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Chen", "link": "https://stackoverflow.com/users/6755924/bruce-chen"}, "reply_to_user": {"reputation": 887, "user_id": 2226401, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j1n0v.jpg?s=128&g=1", "display_name": "Cami Rodriguez", "link": "https://stackoverflow.com/users/2226401/cami-rodriguez"}, "edited": false, "score": 0, "creation_date": 1474447639, "post_id": 39385779, "comment_id": 66530588, "body": "Have you resolved this issue? I found this issue could be due to an implicit listener lock for <code>TimerTrigger</code>. You could follow this <a href=\"https://github.com/Azure/azure-webjobs-sdk-extensions/wiki/TimerTrigger\" rel=\"nofollow noreferrer\">tutorial</a> about <code>ListenerLockPeriod</code> for a better understanding of it."}], "tags": [], "owner": {"reputation": 17081, "user_id": 6755924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2016daeafc6c9469fde7bab85f8214d6?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce Chen", "link": "https://stackoverflow.com/users/6755924/bruce-chen"}, "is_accepted": true, "score": 1, "last_activity_date": 1473322323, "creation_date": 1473322323, "answer_id": 39385779, "question_id": 39378734, "link": "https://stackoverflow.com/questions/39378734/debug-azure-webjob-locally/39385779#39385779", "title": "Debug Azure WebJob locally", "body": "<blockquote>\n  <p>I run on Debug the console program and this recognize all functions but I can't trigger any function.</p>\n</blockquote>\n\n<p>Based on your code, I tested it on my side and found that when my firstly debug the application, then I could get the following output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LWtVq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LWtVq.png\" alt=\"enter image description here\"></a></p>\n\n<p>But, when I restarted the application, I found that it would take some time for the function to be triggered. </p>\n\n<p><img src=\"https://i.stack.imgur.com/DQFl1.png\" alt=\"\"></p>\n\n<p>Please make sure that you have installed the latest version packages of \"Microsoft.Azure.WebJobs\" and \"Microsoft.Azure.WebJobs.Extensions\". For more details, you could follow this <a href=\"https://azure.microsoft.com/en-us/blog/extensible-triggers-and-binders-with-azure-webjobs-sdk-1-1-0-alpha1/\" rel=\"nofollow noreferrer\">tutorial</a>.</p>\n\n<p>And please try to reduce the time interval in your <code>TimerTrigger</code> and wait for a period when the job host has started, then try to find out whether the function could be triggered on your side. Here is my code sample, you could refer to it.</p>\n\n<p><strong>Program.cs</strong></p>\n\n<pre><code>static void Main()\n{\n    JobHostConfiguration config = new JobHostConfiguration();\n    // Add Triggers and Binders for Timer Trigger.\n    config.UseTimers();\n    JobHost host = new JobHost(config);\n    //host.RunAndBlock();\n    host.Start();\n    Console.WriteLine(\"[{0}] Job Host started!!!\", DateTime.Now);\n    Console.ReadLine();\n}\n</code></pre>\n\n<p><strong>Function.cs</strong></p>\n\n<pre><code>//Function triggered by a timespan schedule every 5 sec.\npublic static async void ProcessAugustEndowments([TimerTrigger(\"*/5 * * * * *\", RunOnStartup = true)] TimerInfo timerInfo)\n{\n    Console.WriteLine(\"Endowments process tried\");\n    await endowmentNotification();\n}\n\nprivate static async Task endowmentNotification()\n{   \n    //sleep for 2 sec to simulate processing business logic\n    await Task.Delay(TimeSpan.FromSeconds(2));\n}\n</code></pre>\n\n<p>Additionally, if the <code>TimerTrigger</code> could not meet your requirement, you could refer to this official <a href=\"https://azure.microsoft.com/en-us/documentation/articles/web-sites-create-web-jobs/\" rel=\"nofollow noreferrer\">tutorial</a> to create a schedule WebJob, also you could refer to this <a href=\"http://blog.amitapple.com/post/2015/06/scheduling-azure-webjobs/#.V9DT5-Rf2Ag\" rel=\"nofollow noreferrer\">blog</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 13969, "user_id": 4167200, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/ceLYp.jpg?s=128&g=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/4167200/thomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1473371334, "creation_date": 1473371334, "answer_id": 39400714, "question_id": 39378734, "link": "https://stackoverflow.com/questions/39378734/debug-azure-webjob-locally/39400714#39400714", "title": "Debug Azure WebJob locally", "body": "<p>If your functions are not triggered, I presume it is because you didn't configure your <code>JobHost</code> you use <code>TimerTrigger</code>:</p>\n\n<pre><code>var config = new JobHostConfiguration();\nconfig.UseTimers();\n</code></pre>\n\n<p>How the <code>JobHost</code> works with Triggers :</p>\n\n<ul>\n<li><p>When the <code>JobHost</code> starts, it discovers and indexes the functions with some <code>*TriggerAttribute</code>.</p></li>\n<li><p>By Specifying the <code>config.UseTimers();</code> you tell to the <code>JobHost</code> to index functions with <code>TimerTriggerAttribute</code>.</p></li>\n</ul>\n\n<p>This is also valid for others types of triggers like <code>ServiceBusTrigger</code> that need <code>config.UseServiceBus()</code> to work</p>\n"}], "owner": {"reputation": 887, "user_id": 2226401, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j1n0v.jpg?s=128&g=1", "display_name": "Cami Rodriguez", "link": "https://stackoverflow.com/users/2226401/cami-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9284, "favorite_count": 0, "accepted_answer_id": 39385779, "answer_count": 2, "score": 3, "last_activity_date": 1473371334, "creation_date": 1473281204, "question_id": 39378734, "link": "https://stackoverflow.com/questions/39378734/debug-azure-webjob-locally", "title": "Debug Azure WebJob locally", "body": "<p>I've been creating an Azure WebJob, it works aparently fine but I need to create a new function and I need test locally before upload to production site, I run on Debug the console program and this recognize all functions but I can't trigger any function.</p>\n\n<p>Documentation say next trigger is every minute.... (<a href=\"https://github.com/Azure/azure-webjobs-sdk-extensions#timertrigger\" rel=\"nofollow noreferrer\">https://github.com/Azure/azure-webjobs-sdk-extensions#timertrigger</a>)</p>\n\n<p>My code:</p>\n\n<pre><code>public static async void ProcessAugustEndowments([TimerTrigger(\"0 */1 * * * *\", RunOnStartup = true)] TimerInfo timerInfo)\n    {\n        Console.WriteLine(\"Endowments process tried\");\n\n        await endowmentNotification();\n    }\n</code></pre>\n\n<p>Output:\n<a href=\"https://i.stack.imgur.com/tv32f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tv32f.png\" alt=\"Output example\"></a></p>\n"}, {"tags": ["c#", "wpf", "multithreading"], "comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1473280880, "post_id": 39378606, "comment_id": 66085221, "body": "Only the UI thread should update UI elements. If another thread needs to update the UI, it should ask the UI thread to do it. One way to do this is via the <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.invoke(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Dispatcher class</a>."}, {"owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 1, "creation_date": 1473280939, "post_id": 39378606, "comment_id": 66085248, "body": "Or you could use two-way binding mechanism. Bind the textbox to a property on a model, then you can update the model, which will update the textbox automatically."}, {"owner": {"reputation": 32143, "user_id": 4955425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y0RDl.jpg?s=128&g=1", "display_name": "sstan", "link": "https://stackoverflow.com/users/4955425/sstan"}, "edited": false, "score": 0, "creation_date": 1473281496, "post_id": 39378606, "comment_id": 66085526, "body": "The problem with your sample code is that it&#39;s so simplistic, that there is nothing justifying the need to start another thread. If you have a more specific need that explain why you spawn a thread, maybe we can guide you more specifically."}, {"owner": {"reputation": 2230, "user_id": 1497128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QaOX5.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1497128/tom"}, "edited": false, "score": 0, "creation_date": 1473281551, "post_id": 39378606, "comment_id": 66085555, "body": "You need to either use async await or invoke the UI update back to the UI thread using Dispatcher invoke. This was marked as a dupe, which is true. But linked to a WinForm solution, which does not carry over to WPF. The dupe answer should link to a WPF solution."}, {"owner": {"reputation": 518, "user_id": 1920422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s73tr.jpg?s=128&g=1", "display_name": "Fuzhou Hu", "link": "https://stackoverflow.com/users/1920422/fuzhou-hu"}, "reply_to_user": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 1, "creation_date": 1473281700, "post_id": 39378606, "comment_id": 66085612, "body": "@rmcsharry Data binding in WPF is the best thing since sliced bread. It&#39;s well worth the time to learn to use it."}], "answers": [{"tags": [], "owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "is_accepted": true, "score": 0, "last_activity_date": 1473281738, "last_edit_date": 1473281738, "creation_date": 1473281089, "answer_id": 39378707, "question_id": 39378606, "link": "https://stackoverflow.com/questions/39378606/update-ui-thread-from-code/39378707#39378707", "title": "Update UI Thread from code", "body": "<p>What you are trying to do is impossible. Your code runs on in its own thread separate from the UI thread.</p>\n\n<p>You need to learn more about WPF. To get this working there are 2 solutions I know of:</p>\n\n<ol>\n<li>Use a two-way binding to a model property</li>\n<li>Implement a dispatcher</li>\n</ol>\n\n<p>Option 1 is the usual way to do this, so learn about two way bindings. A dispatcher is overkill for what you are trying to do.</p>\n"}], "owner": {"reputation": 13, "user_id": 5265622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b56f056b169c830e9bb05e6f5f0bbde1?s=128&d=identicon&r=PG&f=1", "display_name": "chart328", "link": "https://stackoverflow.com/users/5265622/chart328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "closed_date": 1473281442, "accepted_answer_id": 39378707, "answer_count": 1, "score": -4, "last_activity_date": 1473289283, "creation_date": 1473280699, "last_edit_date": 1473289283, "question_id": 39378606, "link": "https://stackoverflow.com/questions/39378606/update-ui-thread-from-code", "closed_reason": "Duplicate", "title": "Update UI Thread from code", "body": "<p>How should I edit WPF data that exists outside a C# task? I have defined a UI using the standard WPF template. The grid contains only:</p>\n\n<pre><code>&lt;TextBlock x:Name=\"myTextBox\" Text=\"Original Text\" /&gt;\n</code></pre>\n\n<p>In my code I have:</p>\n\n<pre><code>using System.Threading.Tasks;\nusing System.Windows;\n\nnamespace UpdateGUI\n{\n  public partial class MainWindow : Window\n  {\n    private int myInt;\n\n    public MainWindow()\n    {\n      InitializeComponent();\n\n      myInt = 0;\n      Task.Factory.StartNew(() =&gt;\n      {\n        myInt++;\n        myTextBox.Text = \"New Text\";\n      });\n    }\n  }\n}\n</code></pre>\n\n<p>This throws the following exception:</p>\n\n<blockquote>\n  <p>The calling thread cannot access this object because a different thread owns it.</p>\n</blockquote>\n\n<p>Which thread owns myTextBox?  Why don't I see this error when I edit myInt?</p>\n"}, {"tags": ["c#", "jquery", "ajax", "asp.net-mvc"], "answers": [{"tags": [], "owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "is_accepted": true, "score": 0, "last_activity_date": 1473281156, "last_edit_date": 1473281156, "creation_date": 1473280854, "answer_id": 39378651, "question_id": 39378571, "link": "https://stackoverflow.com/questions/39378571/i-want-to-read-values-from-listlong-using-ajax-and-assign-to-different-html-el/39378651#39378651", "title": "I want to read values from List&lt;long&gt; using Ajax and assign to different HTML element", "body": "<p>Your current code is going to return an array like <code>[234,456,768]</code>. Now you do no't know which item in the array is UserCount (<em>well, you know if you look at the server code and find the order. But it is not clearly readable code!</em>)</p>\n\n<p>I suggest you create a simple POCO to represent the data you want to send</p>\n\n<pre><code>public class DashboardVm\n{\n   public long UserCount { set;get;}\n   public long PendingUserCount { set;get;}\n   public long VisiterCount  { set;get;}\n}\n</code></pre>\n\n<p>Have your <code>GetCounter</code> method returns an instance of this instead of the list of long.</p>\n\n<pre><code>public DashboardVm GetCounter()\n{\n    var vm=new DashboardVm();\n    try\n    {\n        using (var db = new DatabaseContext())\n        {\n            vm.UserCount = db.User.Select(x =&gt; x).Count();\n            vm.PendingUserCount = db.User.Count(x =&gt; x.IsApproved == false);\n            // TO DO : Set other property values as well              \n        }\n        return vm;\n    }\n    catch (Exception ex)\n    {\n        // to do : Log the error so you know what went wrong\n        throw;\n    }\n} \n</code></pre>\n\n<p>and return the result of this method call instead of the array.</p>\n\n<pre><code>public ActionResult CounterValues()\n{\n  var vm=GetCounter();\n  return Json(vm, JsonRequestBehavior.AllowGet);\n}   \n</code></pre>\n\n<p>Now in your ajax method's success callback, you can access it like</p>\n\n<pre><code>success : function(data){\n    $('#labeluser').text(data.UserCount);\n    $('#labelpendinguser').text(data.PendingUserCount);\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6409048, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f19c60b06fd0859728566eb046e8ceb?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Kamran", "link": "https://stackoverflow.com/users/6409048/muhammad-kamran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 39378651, "answer_count": 1, "score": -1, "last_activity_date": 1473290658, "creation_date": 1473280527, "last_edit_date": 1473290658, "question_id": 39378571, "link": "https://stackoverflow.com/questions/39378571/i-want-to-read-values-from-listlong-using-ajax-and-assign-to-different-html-el", "title": "I want to read values from List&lt;long&gt; using Ajax and assign to different HTML element", "body": "<p>I want to read the value from <code>List&lt;long&gt;</code>. I have static method which I call in action result method. That method is called by ajax call. I am returning multiple integer values which I want to show in different HTML elements. Here is my code:</p>\n\n<pre><code>public static List&lt;long&gt; GetCounter()\n{\n    try\n    {\n        var listofcounters = new List&lt;long&gt;();\n        using (var db = new DatabaseContext())\n        {\n            var usercount = db.User.Select(x =&gt; x).Count();\n            var usercountpending = db.User.Count(x =&gt; x.IsApproved == false);\n            var visitercounts = db.SiteViewers.Count();\n            var todayvisitscount = db.SiteViewers.Count(x =&gt; x.VistedDate == DateTime.Now);\n            listofcounters.Add(usercount);\n            listofcounters.Add(usercountpending);\n            listofcounters.Add(visitercounts);\n            listofcounters.Add(todayvisitscount);\n            return listofcounters;\n        }\n    }\n    catch (Exception ex)\n    {\n        throw ex;\n    }\n}\n\n\n[HttpGet]\npublic ActionResult CounterValues()\n{\n    try\n    {\n        var listofcounters = SuperUserManager.GetCounter();\n        return Json(listofcounters, JsonRequestBehavior.AllowGet);\n    }\n    catch (Exception ex)\n    {\n        throw ex;\n    }\n}\n</code></pre>\n\n<p>my AJAX call</p>\n\n<pre><code>function UpdateDashboard() {\n    $.ajax({\n        type: \"GET\",\n        url: '../Admin/AdminHome/CounterValues',\n        async: true,\n        success: function (data) {\n            $('#labeluser').text(usercount);\n            $('#labelpendinguser').text(pendinguser);\n        }\n    });\n}\n</code></pre>\n"}, {"tags": ["c#", "winforms", "webbrowser-control"], "comments": [{"owner": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "edited": false, "score": 0, "creation_date": 1473285638, "post_id": 39378539, "comment_id": 66087177, "body": "Is <a href=\"http://stackoverflow.com/a/25050135/1768303\">this</a> what you&#39;re looking for?"}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1473287348, "post_id": 39378539, "comment_id": 66087724, "body": "It doesn&#39;t like you to navigate elsewhere at the <i>exact</i> moment a navigation error occurs.  This is not unusual, the object protects itself against re-entrancy problems.  You have to do it later, after the event is raised and handled.  Standard trick to do so is by using wb_Main.BeginInvoke()."}, {"owner": {"reputation": 1531, "user_id": 1533068, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5g9lz.jpg?s=128&g=1", "display_name": "sfaust", "link": "https://stackoverflow.com/users/1533068/sfaust"}, "edited": false, "score": 0, "creation_date": 1473347801, "post_id": 39378539, "comment_id": 66115364, "body": "noseratio it&#39;s not a script error, I really just want to replace the default error page.  Hans Passant, I was wondering if that was the case which is why I tried storing the error and then looking for another event fired later to actually set it.  I hadn&#39;t thought of BeginInvoke() but I bet that will work...  I will try it in a bit but I bet that will work.  If so do you want to post it as an answer so I can accept it?"}, {"owner": {"reputation": 1531, "user_id": 1533068, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5g9lz.jpg?s=128&g=1", "display_name": "sfaust", "link": "https://stackoverflow.com/users/1533068/sfaust"}, "edited": false, "score": 0, "creation_date": 1473370260, "post_id": 39378539, "comment_id": 66127058, "body": "You are a genius, that worked perfectly.  If you post it as an answer I will accept it..."}, {"owner": {"reputation": 1531, "user_id": 1533068, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5g9lz.jpg?s=128&g=1", "display_name": "sfaust", "link": "https://stackoverflow.com/users/1533068/sfaust"}, "edited": false, "score": 0, "creation_date": 1473710140, "post_id": 39378539, "comment_id": 66236795, "body": "Please post as an answer so I can accept...."}], "owner": {"reputation": 1531, "user_id": 1533068, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/5g9lz.jpg?s=128&g=1", "display_name": "sfaust", "link": "https://stackoverflow.com/users/1533068/sfaust"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 587, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473280794, "creation_date": 1473280369, "last_edit_date": 1473280794, "question_id": 39378539, "link": "https://stackoverflow.com/questions/39378539/replace-winforms-webbrowser-error-message", "title": "Replace WinForms webbrowser error message", "body": "<p>I am using WinForms web browser and I would like to display a custom error html when the page is not valid but I can't figure out how to do it.  I have this little snippet for displaying it:</p>\n\n<pre><code>        if (wb_Main.Document != null)\n        { wb_Main.Document.Write(string.Empty); }\n        wb_Main.DocumentText = html;\n</code></pre>\n\n<p>And I found some code on SO to wrap the WebBrowser in order to get to the navigate error event which seems to be working fine.  However whenever I try to set the html in the error event I get an exception:</p>\n\n<pre><code> System.Runtime.InteropServices.COMException: The requested resource is in use. (Exception from HRESULT: 0x800700AA)\n</code></pre>\n\n<p>With stack trace:</p>\n\n<pre><code>   at System.Windows.Forms.UnsafeNativeMethods.IWebBrowser2.Navigate2(Object&amp; URL, Object&amp; flags, Object&amp; targetFrameName, Object&amp; postData, Object&amp; headers)\n   at System.Windows.Forms.WebBrowser.PerformNavigate2(Object&amp; URL, Object&amp; flags, Object&amp; targetFrameName, Object&amp; postData, Object&amp; headers)\n   at System.Windows.Forms.WebBrowser.set_Url(Uri value)\n   at System.Windows.Forms.WebBrowser.set_DocumentStream(Stream value)\n   at System.Windows.Forms.WebBrowser.set_DocumentText(String value)\n   at RDES.CMI.Revit.CADDBrowser.UC_Browser.wb_Main_NavigateError(Object sender, WebBrowserNavigateErrorEventArgs e) in c:\\RD\\Projects\\16-003 CADD Browser\\Code\\CADDBrowser\\UC_Browser.xaml.cs:line 84\n   at RDES.CMI.Revit.CADDBrowser.WebBrowser2.OnNavigateError(WebBrowserNavigateErrorEventArgs e) in c:\\RD\\Projects\\16-003 CADD Browser\\Code\\CADDBrowser\\WebBrowser2.cs:line 49\n   at RDES.CMI.Revit.CADDBrowser.WebBrowser2.WebBrowser2EventHelper.NavigateError(Object pDisp, Object&amp; url, Object&amp; frame, Object&amp; statusCode, Boolean&amp; cancel) in c:\\RD\\Projects\\16-003 CADD Browser\\Code\\CADDBrowser\\WebBrowser2.cs:line 69\n</code></pre>\n\n<p>I even tried to set an error text variable in the navigate error handler and then wait for the document completed event to re-navigate to the error text but document completed never fires.  The only event I got to fire after the navigate error is the 'status text changed' event which throws the same error when I try to display the error.</p>\n\n<p>I had originally used the WPF browser control which did this very well, but unfortunately the program I'm plugging into seems to have a major issue with the WPF browser (it crashes the program under certain relatively common circumstances).</p>\n\n<p>Is there a way to do this?  I'm feeling a bit stuck...</p>\n\n<p>Here is the code of the wrapper class that I found here in case it's needed:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Security.Permissions;\nusing System.Text;\nusing System.Windows.Forms;\nusing System.Runtime.InteropServices;\n\nnamespace RDES.CMI.Revit.CADDBrowser\n{\n    public class WebBrowser2 : WebBrowser\n    {\n        AxHost.ConnectionPointCookie cookie;\n        WebBrowser2EventHelper helper;\n\n        [PermissionSetAttribute(SecurityAction.LinkDemand, Name = \"FullTrust\")]\n        protected override void CreateSink()\n        {\n            base.CreateSink();\n\n            // Create an instance of the client that will handle the event\n            // and associate it with the underlying ActiveX control.\n            helper = new WebBrowser2EventHelper(this);\n            cookie = new AxHost.ConnectionPointCookie(\n                this.ActiveXInstance, helper, typeof(DWebBrowserEvents2));\n        }\n\n        [PermissionSetAttribute(SecurityAction.LinkDemand, Name = \"FullTrust\")]\n        protected override void DetachSink()\n        {\n            // Disconnect the client that handles the event\n            // from the underlying ActiveX control.\n            if (cookie != null)\n            {\n                cookie.Disconnect();\n                cookie = null;\n            }\n            base.DetachSink();\n        }\n\n        public event WebBrowserNavigateErrorEventHandler NavigateError;\n\n        // Raises the NavigateError event.\n        protected virtual void OnNavigateError(\n            WebBrowserNavigateErrorEventArgs e)\n        {\n            if (this.NavigateError != null)\n            {\n                this.NavigateError(this, e);\n            }\n        }\n\n        // Handles the NavigateError event from the underlying ActiveX \n        // control by raising the NavigateError event defined in this class.\n        private class WebBrowser2EventHelper :\n            StandardOleMarshalObject, DWebBrowserEvents2\n        {\n            private WebBrowser2 parent;\n\n            public WebBrowser2EventHelper(WebBrowser2 parent)\n            {\n                this.parent = parent;\n            }\n\n            public void NavigateError(object pDisp, ref object url,\n                ref object frame, ref object statusCode, ref bool cancel)\n            {\n                // Raise the NavigateError event.\n                this.parent.OnNavigateError(\n                    new WebBrowserNavigateErrorEventArgs(\n                    (String)url, (String)frame, (Int32)statusCode, cancel));\n            }\n        }\n    }\n\n    // Represents the method that will handle the WebBrowser2.NavigateError event.\n    public delegate void WebBrowserNavigateErrorEventHandler(object sender,\n        WebBrowserNavigateErrorEventArgs e);\n\n    // Provides data for the WebBrowser2.NavigateError event.\n    public class WebBrowserNavigateErrorEventArgs : EventArgs\n    {\n        private String urlValue;\n        private String frameValue;\n        private Int32 statusCodeValue;\n        private Boolean cancelValue;\n\n        public WebBrowserNavigateErrorEventArgs(\n            String url, String frame, Int32 statusCode, Boolean cancel)\n        {\n            urlValue = url;\n            frameValue = frame;\n            statusCodeValue = statusCode;\n            cancelValue = cancel;\n        }\n\n        public String Url\n        {\n            get { return urlValue; }\n            set { urlValue = value; }\n        }\n\n        public String Frame\n        {\n            get { return frameValue; }\n            set { frameValue = value; }\n        }\n\n        public Int32 StatusCode\n        {\n            get { return statusCodeValue; }\n            set { statusCodeValue = value; }\n        }\n\n        public Boolean Cancel\n        {\n            get { return cancelValue; }\n            set { cancelValue = value; }\n        }\n    }\n\n    // Imports the NavigateError method from the OLE DWebBrowserEvents2 \n    // interface. \n    [ComImport, Guid(\"34A715A0-6587-11D0-924A-0020AFC7AC4D\"),\n    InterfaceType(ComInterfaceType.InterfaceIsIDispatch),\n    TypeLibType(TypeLibTypeFlags.FHidden)]\n    public interface DWebBrowserEvents2\n    {\n        [DispId(271)]\n        void NavigateError(\n            [In, MarshalAs(UnmanagedType.IDispatch)] object pDisp,\n            [In] ref object URL, [In] ref object frame,\n            [In] ref object statusCode, [In, Out] ref bool cancel);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "list"], "comments": [{"owner": {"reputation": 3410, "user_id": 1740808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21ae98241fa13af9c1dd108ebc9ac5?s=128&d=identicon&r=PG", "display_name": "SergeyS", "link": "https://stackoverflow.com/users/1740808/sergeys"}, "edited": false, "score": 0, "creation_date": 1473280607, "post_id": 39378524, "comment_id": 66085113, "body": "If the second list contains two instances of &quot;abc&quot;, should two instances be removed from first list?"}, {"owner": {"reputation": 483, "user_id": 2631204, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49ab529e2668e8fd0a65c199b2f7207f?s=128&d=identicon&r=PG", "display_name": "be_mi", "link": "https://stackoverflow.com/users/2631204/be-mi"}, "reply_to_user": {"reputation": 3410, "user_id": 1740808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21ae98241fa13af9c1dd108ebc9ac5?s=128&d=identicon&r=PG", "display_name": "SergeyS", "link": "https://stackoverflow.com/users/1740808/sergeys"}, "edited": false, "score": 0, "creation_date": 1473360807, "post_id": 39378524, "comment_id": 66122463, "body": "Yes, exactly. Although I&#39;m not sure, what should happen when there are 4x &quot;abc&quot;. Maybe some kind of error."}], "answers": [{"tags": [], "owner": {"reputation": 4240, "user_id": 5447084, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/931257310275580/picture?type=large", "display_name": "Haytam", "link": "https://stackoverflow.com/users/5447084/haytam"}, "is_accepted": false, "score": 0, "last_activity_date": 1473280836, "creation_date": 1473280836, "answer_id": 39378647, "question_id": 39378524, "link": "https://stackoverflow.com/questions/39378524/c-subtracting-one-list-from-another-or-checking-if-one-list-is-completly-contai/39378647#39378647", "title": "C# subtracting one list from another or checking if one list is completly containt in another list", "body": "<p>I think you should write a custom code for this one, something like this :</p>\n\n<pre><code>private void SubstractList(ref List&lt;string&gt; l1, List&lt;string&gt; l2)\n        {\n            foreach (string s2 in l2)\n            {\n                for (int i = 0; i &lt; l1.Count; i++)\n                {\n                    if (l1[i] == s2)\n                    {\n                        l1.RemoveAt(i);\n                        break;\n                    }\n                }\n            }\n        }\n</code></pre>\n\n<p>You can do better, this is just an example ^^</p>\n"}, {"comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 1, "creation_date": 1473283204, "post_id": 39378652, "comment_id": 66086289, "body": "Side note: if order is important than one would need to use something else than dictionary for final step - i.e. iterate original list and carefully filter out items paying attention how many left."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 4, "last_activity_date": 1473281158, "last_edit_date": 1473281158, "creation_date": 1473280855, "answer_id": 39378652, "question_id": 39378524, "link": "https://stackoverflow.com/questions/39378524/c-subtracting-one-list-from-another-or-checking-if-one-list-is-completly-contai/39378652#39378652", "title": "C# subtracting one list from another or checking if one list is completly containt in another list", "body": "<p><code>Except</code> does not work, because it treats its operands as sets.</p>\n\n<p>One approach to solving this would be creating counts, subtracting them, and then re-creating the list:</p>\n\n<pre><code>// Make word counts for l1 and l2\nvar c1 = l1.GroupBy(x =&gt; x).ToDictionary(g =&gt; g.Key, g =&gt; g.Count());\nvar c2 = l2.GroupBy(x =&gt; x).ToDictionary(g =&gt; g.Key, g =&gt; g.Count());\n// Make a count of the difference between the two\nvar diff = new Dictionary&lt;string,int&gt;();\nforeach (var p in c1) {\n    int sub;\n    if (!c2.TryGetValue(p.Key, out sub)) {\n        sub = 0;\n    }\n    diff[p.Key] = p.Value - sub;\n}\n// Reconstruct the result from counts\nvar res = diff.SelectMany(p =&gt; Enumerable.Repeat(p.Key, p.Value)).ToList();\n</code></pre>\n\n<p>This algorithm is O(M+N)</p>\n\n<p><a href=\"http://ideone.com/sXkIzN\" rel=\"nofollow\">Demo.</a></p>\n"}, {"comments": [{"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 2, "creation_date": 1473283050, "post_id": 39378678, "comment_id": 66086222, "body": "Side note: this will be insanely slow for large lists due to O(n*m) complexity, fine and easy to read for small lists."}, {"owner": {"reputation": 483, "user_id": 2631204, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49ab529e2668e8fd0a65c199b2f7207f?s=128&d=identicon&r=PG", "display_name": "be_mi", "link": "https://stackoverflow.com/users/2631204/be-mi"}, "edited": false, "score": 0, "creation_date": 1473367021, "post_id": 39378678, "comment_id": 66125593, "body": "I did some benchmarking and have to say that for relatively small lists (10 and 10 entries), the first approach is by far the fastest. With lists (200 and 30 entries) the first approach and the version from dasblinkenlight are similar. When the lists get larger, the variant from dasblinkenlight is the fastest. Since I only have less then (10 and 10 entries) the first suggestion from L.B is the right one for me. The second improved version lost in all my tests."}], "tags": [], "owner": {"reputation": 106158, "user_id": 932418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/245e0f0dce8e71cb477b5aa8dff496a6?s=128&d=identicon&r=PG", "display_name": "L.B", "link": "https://stackoverflow.com/users/932418/l-b"}, "is_accepted": true, "score": 6, "last_activity_date": 1473283876, "last_edit_date": 1473283876, "creation_date": 1473280962, "answer_id": 39378678, "question_id": 39378524, "link": "https://stackoverflow.com/questions/39378524/c-subtracting-one-list-from-another-or-checking-if-one-list-is-completly-contai/39378678#39378678", "title": "C# subtracting one list from another or checking if one list is completly containt in another list", "body": "<p>You can write your own extension method <em>MyExcept</em></p>\n\n<pre><code>public static IEnumerable&lt;T&gt; MyExcept&lt;T&gt;(this IEnumerable&lt;T&gt; orgList, IEnumerable&lt;T&gt; toRemove)\n{\n    var list = orgList.ToList();\n    foreach(var x in toRemove)\n    {\n        list.Remove(x);\n    }\n    return list;\n}\n</code></pre>\n\n<p>As per <code>Alexei Levenkov</code>s comment, a little improvement...</p>\n\n<pre><code>public static IEnumerable&lt;T&gt; MyExcept2&lt;T&gt;(this IEnumerable&lt;T&gt; orgList, IEnumerable&lt;T&gt; toRemove)\n{\n    var list = orgList.OrderBy(x =&gt; x).ToList();\n    foreach (var x in toRemove)\n    {\n        var inx = list.BinarySearch(x);\n        if (inx &gt;= 0) list.RemoveAt(inx);\n    }\n    return list;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 712, "user_id": 2928659, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/b4GRn.jpg?s=128&g=1", "display_name": "John Kurtz", "link": "https://stackoverflow.com/users/2928659/john-kurtz"}, "is_accepted": false, "score": 2, "last_activity_date": 1473281184, "creation_date": 1473281184, "answer_id": 39378725, "question_id": 39378524, "link": "https://stackoverflow.com/questions/39378524/c-subtracting-one-list-from-another-or-checking-if-one-list-is-completly-contai/39378725#39378725", "title": "C# subtracting one list from another or checking if one list is completly containt in another list", "body": "<p>The List's Remove method removes the first occurrence of the string in the list:</p>\n\n<pre><code>        List&lt;string&gt; l1 = new List&lt;string&gt; { \"abc\", \"abc\", \"abc\", \"def\" };\n        List&lt;string&gt; l2 = new List&lt;string&gt; { \"abc\", \"abc\" };\n        foreach (string sl2 in l2)\n        {\n            l1.Remove(sl2);\n        }\n</code></pre>\n\n<p>As a result, l1 contains just \"abc\" and \"def\" in this example.</p>\n"}, {"tags": [], "owner": {"reputation": 17274, "user_id": 1945957, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2b691806f42e351ccd9f0505b5f41719?s=128&d=identicon&r=PG", "display_name": "Jeremy Cook", "link": "https://stackoverflow.com/users/1945957/jeremy-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1473281486, "creation_date": 1473281486, "answer_id": 39378796, "question_id": 39378524, "link": "https://stackoverflow.com/questions/39378524/c-subtracting-one-list-from-another-or-checking-if-one-list-is-completly-contai/39378796#39378796", "title": "C# subtracting one list from another or checking if one list is completly containt in another list", "body": "<pre><code>var r = l1.Distinct().Except(l2).ToList();\n</code></pre>\n"}], "owner": {"reputation": 483, "user_id": 2631204, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/49ab529e2668e8fd0a65c199b2f7207f?s=128&d=identicon&r=PG", "display_name": "be_mi", "link": "https://stackoverflow.com/users/2631204/be-mi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4261, "favorite_count": 1, "accepted_answer_id": 39378678, "answer_count": 5, "score": 1, "last_activity_date": 1473283876, "creation_date": 1473280317, "question_id": 39378524, "link": "https://stackoverflow.com/questions/39378524/c-subtracting-one-list-from-another-or-checking-if-one-list-is-completly-contai", "title": "C# subtracting one list from another or checking if one list is completly containt in another list", "body": "<p>How to subtract one list from another?</p>\n\n<pre><code>  List&lt;string&gt; l1 = new List&lt;string&gt; { \"abc\", \"abc\", \"abc\", \"def\" };\n  List&lt;string&gt; l2 = new List&lt;string&gt; { \"abc\" };\n  var r = l1.Except(l2).ToList();\n</code></pre>\n\n<p>Doing this results in r => \"def\"\ninstead of r=> \"abc\", \"abc\", \"def\".\nI mean, the second list only contains \"abc\" one time. So I want to remove only one instance of \"abc\" of the first list.</p>\n\n<p>Btw: Is there a way to check if one list is completely contained in another list?\nMeaning when list1 only contains \"abc\" one time and list2 contains \"abc\" two times, list2 is not contained in list1. <code>Except</code> doesn't work with multiple values. </p>\n"}, {"tags": ["c#", "pointers", "clone"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 3780113, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ByjU0.png?s=128&g=1", "display_name": "SirJosh3917", "link": "https://stackoverflow.com/users/3780113/sirjosh3917"}, "edited": false, "score": 0, "creation_date": 1473280880, "post_id": 39378555, "comment_id": 66085220, "body": "Sorry, my Visual Studio was (and still is) acting super weird and not building. Since it&#39;s acting weird, it built an older version, and since the code I put wasn&#39;t working, it triggered this kind of logic to go on in my brain, and ask a question. I&#39;m terribly sorry to waste your time."}], "tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": false, "score": 3, "last_activity_date": 1473280449, "creation_date": 1473280449, "answer_id": 39378555, "question_id": 39378514, "link": "https://stackoverflow.com/questions/39378514/c-how-to-disable-the-useage-of-pointers-how-to-clone-a-non-cloneable-variable/39378555#39378555", "title": "C# How to disable the useage of pointers (How to clone a non-cloneable variable)", "body": "<blockquote>\n  <p>since C# automatically uses pointers, <code>GettingVariable</code> will automatically be updated on file demand, which is NOT what I want.</p>\n</blockquote>\n\n<p>This is not true.  That code is not using any pointers, and the value in question <em>is</em> copied, and will not observe any changes to that file or the object that is accessing it.</p>\n\n<blockquote>\n  <p>I'd like to be able to clone the int, to disable the pointers use, as well as not having to use an <code>unsafe void</code> (if possible). Since there is no built in int.Clone(), How could I manage this?</p>\n</blockquote>\n\n<p>Use the code you already have.  It already has the semantics you're asking for.</p>\n"}, {"tags": [], "owner": {"reputation": 9793, "user_id": 2391169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47b9c6b03a46672d5698ec565319c072?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/2391169/david"}, "is_accepted": false, "score": 0, "last_activity_date": 1473280819, "creation_date": 1473280819, "answer_id": 39378642, "question_id": 39378514, "link": "https://stackoverflow.com/questions/39378514/c-how-to-disable-the-useage-of-pointers-how-to-clone-a-non-cloneable-variable/39378642#39378642", "title": "C# How to disable the useage of pointers (How to clone a non-cloneable variable)", "body": "<p>Servy is absolutely correct.</p>\n\n<p>To give you a little more background, C# is <em>not</em> \"using pointers\" as you've described - <code>class</code> objects act <em>like</em> double pointers (ie <code>**MyClass myVariable</code>), particularly when dealing with <code>ref</code> and <code>out</code> methods, while <code>struct</code> objects exhibit the semantics described above.</p>\n\n<p>Rather than thinking of all C# as a wrapper around C++, you should familiarize yourself with C# semantics, particularly when you get to the point you've clearly reached. Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 9869, "user_id": 177516, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/G0gqG.jpg?s=128&g=1", "display_name": "MindingData", "link": "https://stackoverflow.com/users/177516/mindingdata"}, "is_accepted": false, "score": 0, "last_activity_date": 1473280849, "creation_date": 1473280849, "answer_id": 39378650, "question_id": 39378514, "link": "https://stackoverflow.com/questions/39378514/c-how-to-disable-the-useage-of-pointers-how-to-clone-a-non-cloneable-variable/39378650#39378650", "title": "C# How to disable the useage of pointers (How to clone a non-cloneable variable)", "body": "<blockquote>\n  <p>and since C# automatically uses pointers, GettingVariable will\n  automatically be updated on file demand, which is NOT what I want.</p>\n</blockquote>\n\n<p>This is where I think you are going wrong. It's because you are using Properties rather than a variable and I assume accessing the property each time, nothing to do with pointers. So for example with this code : </p>\n\n<pre><code>public int FirstLine \n{ \n    get { return Convert.ToInt32(File.ReadAllLines(@\"example.txt\")[0]);\n}\n</code></pre>\n\n<p>Each time you try and get the value of Firstline it is going to run that code. But if you already have the value, it won't change. For example  : </p>\n\n<pre><code>object.FirstLine = 5;\nint firstlineA = object.FirstLine; //Returns 5\nobject.FirstLine = 10;\nint firstLineB = object.FirstLine; //Returns 10\nint firstlineC = firstlineA; //Still returns 5\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 3780113, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ByjU0.png?s=128&g=1", "display_name": "SirJosh3917", "link": "https://stackoverflow.com/users/3780113/sirjosh3917"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1473280849, "creation_date": 1473280301, "last_edit_date": 1473280734, "question_id": 39378514, "link": "https://stackoverflow.com/questions/39378514/c-how-to-disable-the-useage-of-pointers-how-to-clone-a-non-cloneable-variable", "title": "C# How to disable the useage of pointers (How to clone a non-cloneable variable)", "body": "<p><strong>The Problem</strong></p>\n\n<p>Hello stackoverflow. I have ran into a problem.\nEven though C# automatically enables the usage of pointers, which is VERY helpful, I need to clone a non-cloneable variable for a second (an int).</p>\n\n<p><strong>My Code</strong></p>\n\n<p>I have a</p>\n\n<pre><code>public int FirstLine \n{ \n    get { return Convert.ToInt32(File.ReadAllLines(@\"example.txt\")[0]); } \n    set { File.WriteAllLines(@\"example.txt\", new string[1]{ value.ToString() }); } \n}\n</code></pre>\n\n<p>that I'm using to have a variable that's grabbed from a file when accessed to read, and if being accessed to write, it writes the value to the file, to have a variable that updates on demand and saves.</p>\n\n<p>I know that the example code is very \"unsafe\" to speak, I'm just throwing together a rough example of what I'm doing. Somewhere else in my code, I access this variable:</p>\n\n<p><code>int GettingVariable = FirstLine;</code></p>\n\n<p>and since C# automatically uses pointers, <code>GettingVariable</code> will automatically be updated on file demand, which is NOT what I want.</p>\n\n<p><strong>What I'd like as an answer</strong></p>\n\n<p>I'd like to be able to clone the int, to disable the pointers use, as well as not having to use an <code>unsafe void</code> (if possible). Since there is no built in int.Clone(), How could I manage this?</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "interop", "excel-interop"], "comments": [{"owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "edited": false, "score": 0, "creation_date": 1473280082, "post_id": 39378399, "comment_id": 66084905, "body": "Do NOT use excel interop in a asp.net scenario.  <a href=\"https://support.microsoft.com/en-us/kb/257757#kb2\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/257757#kb2</a>       Microsoft does not currently recommend, and does not support, Automation of Microsoft Office applications from any unattended, non-interactive client application or component (including ASP, ASP.NET, DCOM, and NT Services), because Office may exhibit unstable behavior and/or deadlock when Office is run in this environment."}, {"owner": {"reputation": 787, "user_id": 2410631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f4601d7f5da480ab986c5f2330d924?s=128&d=identicon&r=PG", "display_name": "Jaime Macias", "link": "https://stackoverflow.com/users/2410631/jaime-macias"}, "edited": false, "score": 0, "creation_date": 1473280324, "post_id": 39378399, "comment_id": 66085008, "body": "You could try using OpenXML or free third party tools (ClosedXML, NPOI) to generate excel files rather than Excel.Interop which is not recommended."}, {"owner": {"reputation": 532, "user_id": 5791863, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e2a9db605a83c2da83db026cbbc178df?s=128&d=identicon&r=PG&f=1", "display_name": "SJaka", "link": "https://stackoverflow.com/users/5791863/sjaka"}, "edited": false, "score": 0, "creation_date": 1473280838, "post_id": 39378399, "comment_id": 66085202, "body": "Unfortunately, this is what I have to use for now. Can OpenXML/ClosedXML work with .xls files? I&#39;m not handling Excel 2007 (.xlsx) but the older 2003 (.xls) files. Also, I&#39;ve to fill an existing excel file, not create a new one."}, {"owner": {"reputation": 532, "user_id": 5791863, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e2a9db605a83c2da83db026cbbc178df?s=128&d=identicon&r=PG&f=1", "display_name": "SJaka", "link": "https://stackoverflow.com/users/5791863/sjaka"}, "reply_to_user": {"reputation": 787, "user_id": 2410631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f4601d7f5da480ab986c5f2330d924?s=128&d=identicon&r=PG", "display_name": "Jaime Macias", "link": "https://stackoverflow.com/users/2410631/jaime-macias"}, "edited": false, "score": 0, "creation_date": 1473281934, "post_id": 39378399, "comment_id": 66085720, "body": "@JaimeMacias my understanding is that ClosedXML works with .xlsx files."}, {"owner": {"reputation": 787, "user_id": 2410631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94f4601d7f5da480ab986c5f2330d924?s=128&d=identicon&r=PG", "display_name": "Jaime Macias", "link": "https://stackoverflow.com/users/2410631/jaime-macias"}, "edited": false, "score": 0, "creation_date": 1473282071, "post_id": 39378399, "comment_id": 66085782, "body": "You&#39;re right OpenXml/ClosedXml only handle xlsx, NPOI though works with both xls and xlsx"}, {"owner": {"reputation": 21384, "user_id": 214977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/fmJRN.png?s=128&g=1", "display_name": "granadaCoder", "link": "https://stackoverflow.com/users/214977/granadacoder"}, "edited": false, "score": 0, "creation_date": 1473282190, "post_id": 39378399, "comment_id": 66085830, "body": "&quot;Unfortunately, this is what I have to use for now.&quot;.  No, it isn&#39;t.  Do NOT use excel interop in a asp.net scenario.   It doesn&#39;t play well.  Why would you ignore a very direct microsoft recommendation?"}], "owner": {"reputation": 532, "user_id": 5791863, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e2a9db605a83c2da83db026cbbc178df?s=128&d=identicon&r=PG&f=1", "display_name": "SJaka", "link": "https://stackoverflow.com/users/5791863/sjaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 719, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473279786, "creation_date": 1473279786, "question_id": 39378399, "link": "https://stackoverflow.com/questions/39378399/asp-net-excel-interop-error-system-runtime-interopservices-comexception-0x8", "title": "ASP.NET - Excel InterOP Error - System.Runtime.InteropServices.COMException (0x80080005)", "body": "<p>In my ASP.Net web application project, I've to fill up an existing Excel 2003 spreadsheet (.xls) with some data from database and send it to the user/ client. I'm using Excel Interop for this. So far, I've been able to fill up the spreadsheet and open it while running it under debug on Visual Studio 2013/ IIS-Express. </p>\n\n<p>When I publish the same application on IIS running on Windows 2012 and access it over the Internet through a client, although the server does send the file to the client, it is not filled with any data. I checked the server logs and found the following exception getting thrown:</p>\n\n<blockquote>\n  <p>System.Runtime.InteropServices.COMException (0x80080005): </p>\n  \n  <p>Retrieving the COM class factory for component with CLSID\n  {00024500-0000-0000-C000-000000000046} failed due to the following\n  error: 80080005 Server execution failed (Exception from HRESULT:\n  0x80080005 (CO_E_SERVER_EXEC_FAILURE)).    at \n  System.Runtime.Remoting.RemotingServices.AllocateUninitializedObject(RuntimeType\n  objectType) ....</p>\n</blockquote>\n\n<p>I've set the permissions for the website folder to allow the following accounts with full control:</p>\n\n<ul>\n<li>My Account (I'm the owner of the folder)</li>\n<li>Administrator's account</li>\n<li>IIS_IUSRS account</li>\n<li>Network Services</li>\n</ul>\n\n<p>Additionally, while reading about it, I've also set the DCOM config for the Excel application to set following permissions for the above accounts:</p>\n\n<ol>\n<li>Launch and Activation Permissions - Allow Local &amp; Remote Launch and\nActivation</li>\n<li>Access Permissions - Allow Local and Remote Access</li>\n</ol>\n\n<p>The application is set to use windows authentication (identity) and from the client machine, I'm using my account credentials to log into the application.</p>\n\n<p>Here is the code I'm using to fill the Excel spreasheet:</p>\n\n<pre><code>public bool FillExcel()\n        {\n            bool result = false;            \n            try\n            {\n                string newName = \"stage 2.xls\";\n                if (!Directory.Exists(Server.MapPath(\"~\") + @\"\\Files\\xls\\\"))\n                    Directory.CreateDirectory(Server.MapPath(\"~\") + @\"\\Files\\xls\\\");\n                if (System.IO.File.Exists(Server.MapPath(\"~\") + @\"\\Files\\xls\\\" + newName))\n                {\n                    System.IO.File.Delete(Server.MapPath(\"~\") + @\"\\Files\\xls\\\" + newName);\n                }\n                System.IO.File.Copy(Server.MapPath(\"~\") + @\"\\Files\\stage2Copy.xls\", Server.MapPath(\"~\") + @\"\\Files\\xls\\\" + newName);\n\n            List&lt;Sheet1Model&gt; sheet1ModelList = getSheet1Data();    // Model to fill the data from database to be filled into Excel\n\n            Application excelApplication = new Application();\n            Workbook wb = excelApplication.Workbooks.Open(Server.MapPath(\"~\") + @\"\\Files\\xls\\\" + newName, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);\n\n            Worksheet sheet = (Worksheet)wb.Sheets[\"Sheet1\"];\n            sheet.Select(Type.Missing);\n\n            Range excelRange = sheet.UsedRange;\n            int rNumber = 3;\n            string[] firstWorksheetHeaders = GetRange(\"A\" + rNumber + \":HH\" + rNumber + \"\", sheet);\n\n            int rn = 4;     // start from row 4 in Excel\n\n            foreach (Sheet1Model sheetModel in sheet1ModelList)\n            {\n                sheet.Cells[rn, 1] = sheetModel.CustomerName\n                rn++;\n            }\n            String Path = Server.MapPath(\"~\") + @\"Files\\xls\\\" + newName;\n            wb.SaveAs(Path, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlNoChange, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);\n            wb.Close();\n            Marshal.ReleaseComObject(sheet);\n            Marshal.ReleaseComObject(wb);\n            Marshal.ReleaseComObject(excelApplication);\n            result = true;\n            GC.Collect();\n            GC.WaitForPendingFinalizers();\n        }\n        catch (Exception ex)\n        {\n            logger.Info(ex.ToString());                \n        }\n\n        return result;\n    }\n</code></pre>\n\n<p>How can I remove this error and get the excel sheet populated?</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1473279930, "post_id": 39378387, "comment_id": 66084836, "body": "Did you happen to notice WHAT error you got?"}, {"owner": {"reputation": 544, "user_id": 6747696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5485aebdcf30da2ea44e5aad84f7eba9?s=128&d=identicon&r=PG", "display_name": "mbrdev", "link": "https://stackoverflow.com/users/6747696/mbrdev"}, "edited": false, "score": 0, "creation_date": 1473279970, "post_id": 39378387, "comment_id": 66084852, "body": "Your generic method paraneters should be List&lt;T&gt; rather than just T"}, {"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 0, "creation_date": 1473281410, "post_id": 39378387, "comment_id": 66085476, "body": "@user1005310 - You can use the first method proposed by Tanner, due to covariance in IEnumerable&lt;T&gt; this works just fine and there is no need to implement your method as a generic method."}], "answers": [{"comments": [{"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 1, "creation_date": 1473280043, "post_id": 39378437, "comment_id": 66084892, "body": "LINQ works fine with <code>IEnumerable&lt;T&gt;</code>. Why would you require callers to provide a List instead?"}, {"owner": {"reputation": 601, "user_id": 1005310, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/148e08be842f200869db3459cd5e9189?s=128&d=identicon&r=PG", "display_name": "user1005310", "link": "https://stackoverflow.com/users/1005310/user1005310"}, "edited": false, "score": 0, "creation_date": 1473280183, "post_id": 39378437, "comment_id": 66084950, "body": "ok so adding List&lt;T&gt; removed the linq error but to make it work i had to refactor the class as such instead of where T : class     I have to write where T: classA but what if T is classB. How can I write the code to accept classB as well ?"}, {"owner": {"reputation": 3763, "user_id": 4585476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Xqkw.jpg?s=128&g=1", "display_name": "AVK", "link": "https://stackoverflow.com/users/4585476/avk"}, "edited": false, "score": 0, "creation_date": 1473280337, "post_id": 39378437, "comment_id": 66085014, "body": "T as an object itself will accept both <code>classA</code> and <code>ClassB</code>"}, {"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "reply_to_user": {"reputation": 601, "user_id": 1005310, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/148e08be842f200869db3459cd5e9189?s=128&d=identicon&r=PG", "display_name": "user1005310", "link": "https://stackoverflow.com/users/1005310/user1005310"}, "edited": false, "score": 0, "creation_date": 1473280461, "post_id": 39378437, "comment_id": 66085068, "body": "@user1005310 - if there are commonalities between types that the generic code needs to know about then it is best to define an interface and make that interface a constraint on the generic method and have the types implement that interface. It is even better though to adhere to loose coupling, the less your code knows about the types it uses the better and the more flexible it stays."}, {"owner": {"reputation": 601, "user_id": 1005310, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/148e08be842f200869db3459cd5e9189?s=128&d=identicon&r=PG", "display_name": "user1005310", "link": "https://stackoverflow.com/users/1005310/user1005310"}, "edited": false, "score": 0, "creation_date": 1473280761, "post_id": 39378437, "comment_id": 66085168, "body": "Class A and Class B have the same properties effectiveFrom and effectiveTo. Can you point me to an working example ?"}], "tags": [], "owner": {"reputation": 19, "user_id": 6731811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac4a67cbd6583e55f672f2bdfbd5e06?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6731811/fabian"}, "is_accepted": false, "score": 0, "last_activity_date": 1473279952, "creation_date": 1473279952, "answer_id": 39378437, "question_id": 39378387, "link": "https://stackoverflow.com/questions/39378387/generic-method-with-multiple-parameter/39378437#39378437", "title": "Generic method with multiple parameter", "body": "<pre><code>public static bool OpTest&lt;T&gt;(List&lt;T&gt; model, List&lt;T&gt; existingEntities, Guid t) where T : class\n    {\n\n        //  var existingEntities = smRepository.GetStationMapping(t, StatusEnum.ALL); //smRepository.GetStationMapping(t, StatusEnum.ALL);\n\n\n        var ids = existingEntities?.Select(x =&gt; x.Id).Except(model.Select(x =&gt; x.Id)).ToList();\n\n        var check = existingEntities?.Where(o =&gt; ids.Any(c =&gt; c == o.Id &amp;&amp; o.EffectiveTo &gt;= DateTime.Today)).ToList();\n\n\n        check?.AddRange(model);\n\n\n        var dateModel = check.Select(x =&gt; new TimeInterval(x.EffectiveFrom, x.EffectiveTo)).ToList();\n\n\n        return true;\n    }\n</code></pre>\n\n<p>keep your items as list or you cant use linq on it.</p>\n"}, {"comments": [{"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 1, "creation_date": 1473281319, "post_id": 39378597, "comment_id": 66085435, "body": "I would not even suggest the <code>quick and dirty</code> option, the first proposed method does the job just fine."}], "tags": [], "owner": {"reputation": 2565, "user_id": 1108505, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a7e091fdb18efecace362189bc5f0bf5?s=128&d=identicon&r=PG", "display_name": "Tanner Swett", "link": "https://stackoverflow.com/users/1108505/tanner-swett"}, "is_accepted": true, "score": 2, "last_activity_date": 1473280647, "creation_date": 1473280647, "answer_id": 39378597, "question_id": 39378387, "link": "https://stackoverflow.com/questions/39378387/generic-method-with-multiple-parameter/39378597#39378597", "title": "Generic method with multiple parameter", "body": "<p>I see a problem here. You're trying to access members on objects of type <code>T</code>, but <code>T</code> is an unknown type; it's not guaranteed to have the members you're trying to access that. C# doesn't like that.</p>\n\n<p>I see two options here:</p>\n\n<h2>The robust option</h2>\n\n<p>Create an interface, <code>IMyInterface</code>, with the appropriate members. Then write this:</p>\n\n<pre><code>public static bool OpTest(IEnumerable&lt;IMyInterface&gt; model, IEnumerable&lt;IMyInterface&gt; existingEntities, Guid t)\n{\n    List&lt;SomeType&gt; ids = existingEntities?.Select(x =&gt; x.Id).Except(model.Select(x =&gt; x.Id)).ToList();\n    List&lt;IMyInterface&gt; check = existingEntities?.Where(o =&gt; ids.Any(c =&gt; c == o.Id &amp;&amp; o.EffectiveTo &gt;= DateTime.Today)).ToList();\n\n    check?.AddRange(model);\n\n    List&lt;TimeInterval&gt; dateModel = check.Select(x =&gt; new TimeInterval(x.EffectiveFrom, x.EffectiveTo)).ToList();\n\n    return true;\n}\n</code></pre>\n\n<h2>The quick and dirty option</h2>\n\n<p>Use <code>dynamic</code> instead. Note that if you use this, your code will break at runtime if you make any mistakes. If you don't want it to break like that, then don't use this option.</p>\n\n<pre><code>public static bool OpTest(IEnumerable&lt;dynamic&gt; model, IEnumerable&lt;dynamic&gt; existingEntities, Guid t)\n{\n    List&lt;dynamic&gt; ids = existingEntities?.Select(x =&gt; x.Id).Except(model.Select(x =&gt; x.Id)).ToList();\n    List&lt;dynamic&gt; check = existingEntities?.Where(o =&gt; ids.Any(c =&gt; c == o.Id &amp;&amp; o.EffectiveTo &gt;= DateTime.Today)).ToList();\n\n    check?.AddRange(model);\n\n    List&lt;dynamic&gt; dateModel = check.Select(x =&gt; new TimeInterval(x.EffectiveFrom, x.EffectiveTo)).ToList();\n\n    return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 1005310, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/148e08be842f200869db3459cd5e9189?s=128&d=identicon&r=PG", "display_name": "user1005310", "link": "https://stackoverflow.com/users/1005310/user1005310"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 39378597, "answer_count": 2, "score": 0, "last_activity_date": 1473300911, "creation_date": 1473279739, "last_edit_date": 1473300911, "question_id": 39378387, "link": "https://stackoverflow.com/questions/39378387/generic-method-with-multiple-parameter", "title": "Generic method with multiple parameter", "body": "<p>I am trying to write a Generic method for the method CheckResult so that it could be used across different classes. For example, if I have a generic method then the only thing that is going to change is the classname. Here it is ClassA , another method could pass classB. </p>\n\n<pre><code>public bool CheckResult(Guid Id, List&lt;ClassA&gt; model,List&lt;ClassA&gt; existingEntities)\n{\n    var ids = existingEntities?.Select(x =&gt; x.Id).Except(model.Select(x =&gt; x.Id)).ToList();\n    var check = existingEntities?.Where(o =&gt; ids.Any(c =&gt; c == o.Id &amp;&amp; o.EffectiveTo &gt;= DateTime.Today)).ToList();\n    check?.AddRange(model);\n    var dateModel = check.Select(x =&gt; new TimeInterval(x.EffectiveFrom, x.EffectiveTo)).ToList();\n    return true;\n}\n</code></pre>\n\n<p><strong>--------------This is what I was attempting to do---------------------</strong> </p>\n\n<pre><code>public static bool OpTest&lt;T&gt;(T model, T existingEntities, Guid t) where T : class\n{\n    //  var existingEntities = smRepository.GetStationMapping(t, StatusEnum.ALL); //smRepository.GetStationMapping(t, StatusEnum.ALL);\n    var ids = existingEntities?.Select(x =&gt; x.Id).Except(model.Select(x =&gt; x.Id)).ToList();\n    var check = existingEntities?.Where(o =&gt; ids.Any(c =&gt; c == o.Id &amp;&amp; o.EffectiveTo &gt;= DateTime.Today)).ToList();\n    check?.AddRange(model);\n    var dateModel = check.Select(x =&gt; new TimeInterval(x.EffectiveFrom, x.EffectiveTo)).ToList();\n    return true;\n}\n</code></pre>\n\n<p>This is my first time writing generic any help is appreciated. The code is erroring out ?</p>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 0, "creation_date": 1473279603, "post_id": 39378323, "comment_id": 66084676, "body": "What is the datatype of the column DOReviewDate?"}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1473281969, "post_id": 39378323, "comment_id": 66085733, "body": "For troubleshooting purposes, I suggest you write a bit of code to iterate through all the <code>Tables</code>, <code>Rows</code>, and Fields, so you can see what is going on (or you can set a breakpoint and inspect via Watch).  Might be that Table[0] contains a message from T-SQL (e.g. if you forgot to <code>SET NOCOUNT ON</code>)"}, {"owner": {"reputation": 603, "user_id": 1309011, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3db4afcace34f1afa83b2a579c9006b9?s=128&d=identicon&r=PG", "display_name": "Michael McCauley", "link": "https://stackoverflow.com/users/1309011/michael-mccauley"}, "edited": false, "score": 0, "creation_date": 1473346195, "post_id": 39378323, "comment_id": 66114226, "body": "The data type is <b>String</b>.  Also, I have iterated through the full list of columns, and having it kick out data referencing with a DataColumn instead still yields nothing. As for what&#39;s getting returned from the database, I have no real control over that as I didn&#39;t create it, nor do I manage it. I&#39;ll add an edit to my post to show what I attempted."}], "answers": [{"tags": [], "owner": {"reputation": 603, "user_id": 1309011, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3db4afcace34f1afa83b2a579c9006b9?s=128&d=identicon&r=PG", "display_name": "Michael McCauley", "link": "https://stackoverflow.com/users/1309011/michael-mccauley"}, "is_accepted": false, "score": 0, "last_activity_date": 1473694007, "creation_date": 1473694007, "answer_id": 39453844, "question_id": 39378323, "link": "https://stackoverflow.com/questions/39378323/datarow-column-has-value-when-read-one-way-but-not-when-read-a-different-way/39453844#39453844", "title": "DataRow Column Has Value When Read One Way, But Not When Read a Different Way", "body": "<p>I was finally able to locate the stored procedure powering this functionality. It's returning empty values for the columns I need. There's nothing but an empty string designating what to return. So, while I can't seem to find the functionality within the page construction, it looks like there is some sort of join or alternate search pulling the data, and I believe I found the table to pull from. Guess I'll just have to take this initial data returned to me and use it to pull from the other table. Or, I guess, maybe make my own SQL search with a join. Either way, the stored procedure does not itself contain a join to the table I need. This is what was in the stored procedure:</p>\n\n<pre><code>'' as DOReviewDate\n</code></pre>\n"}], "owner": {"reputation": 603, "user_id": 1309011, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3db4afcace34f1afa83b2a579c9006b9?s=128&d=identicon&r=PG", "display_name": "Michael McCauley", "link": "https://stackoverflow.com/users/1309011/michael-mccauley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473694091, "creation_date": 1473279429, "last_edit_date": 1473694091, "question_id": 39378323, "link": "https://stackoverflow.com/questions/39378323/datarow-column-has-value-when-read-one-way-but-not-when-read-a-different-way", "title": "DataRow Column Has Value When Read One Way, But Not When Read a Different Way", "body": "<p>I'm trying to read values from a DataSet in C#/ASP.NET returned from a stored procedure. Normally, the DefaultView from that DataSet is passed into a GridView in an ASP.NET page. in that event, a particular column I'm interested in has a value. However, if I try to read a DataRow and get the column value, it comes through as empty.</p>\n\n<p>For example, this will display a value:</p>\n\n<pre><code>DataSet ds = //////\nDataView dv = ds.Tables[0].DefaultView;\ngrdQuotes.DataSource = dv;\ngrdQuotes.DataBind();\n</code></pre>\n\n<p>This, however, gives me no value:</p>\n\n<pre><code>DataSet ds = //////\nforeach (DataRow row in ds.Tables[0].Rows) {\n    String value1 = (String)row[\"DOReviewDate\"];\n    String value2 = ((Object)row[\"DOReviewDate\"]).ToString();\n    String value3 = row.Field&lt;String &gt;(\"DOReviewDate\");\n}\n</code></pre>\n\n<p>All three variables end up empty.</p>\n\n<p>I'm pretty lost on where to go with this, as it's apparent that there's a value being pulled from the SQL database, otherwise it wouldn't display in the GridView table on the page. Also, I can get the rest of the column values in the row without problem. Interestingly enough, there is one other column exhibiting the same behavior.</p>\n\n<p><strong>-- EDIT --</strong></p>\n\n<p>Attempt to iterate through rows and columns to get data:</p>\n\n<pre><code>StringBuilder sb = new StringBuilder();\nforeach (DataRow row in ds.Tables[0].Rows)\n{\n    StringBuilder r = new StringBuilder();\n    foreach (DataColumn c in ds.Tables[0].Columns)\n    {\n        r.Append(String.Format(\"{0} | \", row[c]));\n    }\n    r.Append(\"END\");\n    sb.AppendLine(r.ToString());\n}\n</code></pre>\n"}, {"tags": ["c#", "bytearray", "xor"], "comments": [{"owner": {"reputation": 3763, "user_id": 4585476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Xqkw.jpg?s=128&g=1", "display_name": "AVK", "link": "https://stackoverflow.com/users/4585476/avk"}, "edited": false, "score": 0, "creation_date": 1473279205, "post_id": 39378200, "comment_id": 66084507, "body": "Just out of curiosity. What is xoring?"}, {"owner": {"reputation": 25889, "user_id": 245183, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78abf6a54b468eea1a39282e705878a8?s=128&d=identicon&r=PG", "display_name": "Ondrej Tucny", "link": "https://stackoverflow.com/users/245183/ondrej-tucny"}, "edited": false, "score": 0, "creation_date": 1473279334, "post_id": 39378200, "comment_id": 66084571, "body": "Please post the code you have tried."}, {"owner": {"reputation": 6413, "user_id": 5555803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4823cf23548ba1e4634ad67e78468e67?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Alikhanov", "link": "https://stackoverflow.com/users/5555803/orkhan-alikhanov"}, "reply_to_user": {"reputation": 3763, "user_id": 4585476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Xqkw.jpg?s=128&g=1", "display_name": "AVK", "link": "https://stackoverflow.com/users/4585476/avk"}, "edited": false, "score": 4, "creation_date": 1473279414, "post_id": 39378200, "comment_id": 66084608, "body": "@AVKNaidu He probably means <a href=\"https://msdn.microsoft.com/en-us/library/zkacc7k1.aspx\" rel=\"nofollow noreferrer\">^</a>"}, {"owner": {"reputation": 27233, "user_id": 745969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72eb73eb2cf8699890e4cfbf3e612601?s=128&d=identicon&r=PG", "display_name": "Tim", "link": "https://stackoverflow.com/users/745969/tim"}, "edited": false, "score": 0, "creation_date": 1473279683, "post_id": 39378200, "comment_id": 66084714, "body": "XOR = Exclusive Or."}, {"owner": {"reputation": 6413, "user_id": 5555803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4823cf23548ba1e4634ad67e78468e67?s=128&d=identicon&r=PG&f=1", "display_name": "Orkhan Alikhanov", "link": "https://stackoverflow.com/users/5555803/orkhan-alikhanov"}, "edited": false, "score": 1, "creation_date": 1473279719, "post_id": 39378200, "comment_id": 66084731, "body": "Your given code do not print ` System.Byte()`"}, {"owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473279722, "post_id": 39378200, "comment_id": 66084732, "body": "yes that&#39;s what I mean ^ I got working formula in excel"}, {"owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473279889, "post_id": 39378200, "comment_id": 66084817, "body": "what I tried well all whats left from my tries and fails"}, {"owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473279902, "post_id": 39378200, "comment_id": 66084825, "body": "BinaryReader br = new BinaryReader(File.OpenRead(path));             br.BaseStream.Position = 0x3E8;            byte[] buffer = br.ReadBytes(1);            int i = 149;"}, {"owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473279951, "post_id": 39378200, "comment_id": 66084845, "body": "uhh made a total mess there"}, {"owner": {"reputation": 106158, "user_id": 932418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/245e0f0dce8e71cb477b5aa8dff496a6?s=128&d=identicon&r=PG", "display_name": "L.B", "link": "https://stackoverflow.com/users/932418/l-b"}, "edited": false, "score": 0, "creation_date": 1473279953, "post_id": 39378200, "comment_id": 66084846, "body": "<code>So can read bytes and display them in text box with this code</code> No this code read <code>CHAR</code> (which is not equal to <code>BYTE</code>)"}, {"owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473280380, "post_id": 39378200, "comment_id": 66085033, "body": "my fault wrong code br.ReadByte.ToInt32(4).ToString(&quot;X&quot;);"}, {"owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473280429, "post_id": 39378200, "comment_id": 66085047, "body": "again wrong br.readint32"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473281657, "post_id": 39378609, "comment_id": 66085593, "body": "well it does job but result is bunch of characters charaters, I was trying to readbytes in decimal not hex or ascii and than xor each one with 149 and get result in format like 1234, will try to look at options and in msdn I could be missing something"}, {"owner": {"reputation": 18008, "user_id": 241605, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01175ac61664b22485bc5b4e46169ccc?s=128&d=identicon&r=PG", "display_name": "Matthew Strawbridge", "link": "https://stackoverflow.com/users/241605/matthew-strawbridge"}, "reply_to_user": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473323408, "post_id": 39378609, "comment_id": 66099033, "body": "Try <code>textBox1.Text = string.Join(&quot;, &quot;, bytes);</code>."}], "tags": [], "owner": {"reputation": 18008, "user_id": 241605, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01175ac61664b22485bc5b4e46169ccc?s=128&d=identicon&r=PG", "display_name": "Matthew Strawbridge", "link": "https://stackoverflow.com/users/241605/matthew-strawbridge"}, "is_accepted": false, "score": 1, "last_activity_date": 1473280707, "creation_date": 1473280707, "answer_id": 39378609, "question_id": 39378200, "link": "https://stackoverflow.com/questions/39378200/read-bytes-into-array-then-xor-the-result-into-a-string/39378609#39378609", "title": "Read bytes into array then xor the result into a string", "body": "<p>You need something like this:</p>\n\n<pre><code>using (var br = new BinaryReader(File.OpenRead(path)))\n{\n    br.BaseStream.Position = 0x1D;\n    byte[] bytes = br.ReadBytes(4);\n\n    for (int i = 0; i &lt; 4; i++)\n    {\n        bytes[i] = (byte)(bytes[i] ^ 149);\n    }\n\n    textBox1.Text = new string(bytes.Select(Convert.ToChar).ToArray());\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1473282270, "post_id": 39378614, "comment_id": 66085858, "body": "Let me know if you have any questions about my post, or if you need any other questions answered.  I noticed that you want the decimal number display of a <code>byte</code>.  Just <code>byte.ToString()</code> will give you the decimal value of the <code>byte</code> object."}, {"owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473283031, "post_id": 39378614, "comment_id": 66086214, "body": "Your answer is helpful and gives me idea what to read more, idea was to read 4 bytes for example 92 3B 48 6B, if I read them by my first try I was not getting it right not even close to it, what I was wanting to get is represent various excel formulas in c#, (BITXOR((HEX2DEC(D6)),149)) so 92 in dec should be 146 and xoring it with 149 should give me 5 and so on and than display it all in textbox like 5555. So will walk thrue your code and will try to manage something"}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "reply_to_user": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473349967, "post_id": 39378614, "comment_id": 66116835, "body": "@domsrt I&#39;m a little confused by your response.  First, your formula doesn&#39;t have balanced parentheses, but I&#39;m assuming you mean &quot;BITXOR((HEX2DEC(D6),149)&quot;.  If that&#39;s the case, I think you&#39;ve confused something.  XORing values doesn&#39;t depend on how the numbers are displayed on your computer.  XOR <i>always</i> <b><i>always</i></b> uses the 1&#39;s and 0&#39;s of the number to compute the answer, regardless of if you&#39;re viewing the number in decimal or hex, or binary, or octal, or base pi, etc.  I think in excel using HEX2DEC(...) <i>may</i> be needed (not sure, but this is my guess) ..."}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "reply_to_user": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473349974, "post_id": 39378614, "comment_id": 66116840, "body": "@domsrt ... because the cell is a string (series of letters), and excel needs to interpret it as a number.  In C# all numbers are numbers.  Don&#39;t confuse the value of a number by how it&#39;s displayed.  EDIT: I&#39;ve confirmed that <a href=\"https://support.office.com/en-us/article/HEX2DEC-function-8c8c3155-9f37-45a5-a3ee-ee5379ef106e\" rel=\"nofollow noreferrer\">HEX2DEC(...)</a> takes quoted values as input, which means a string.  The output is a string, as well, it looks like."}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "reply_to_user": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473350584, "post_id": 39378614, "comment_id": 66117211, "body": "@domsrt I made this <a href=\"https://dotnetfiddle.net/0s4M1i\" rel=\"nofollow noreferrer\">dotnetfiddle</a> in case you wanted to see something that resembles your excel formula in C#.  It turns out that 146 ^ 149 is 7, not 5, like you said in your comment above."}, {"owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "edited": false, "score": 0, "creation_date": 1473523529, "post_id": 39378614, "comment_id": 66179349, "body": "great I run your code just had to add Console.ReadKey(); to keep cmd open and it works like it should, thank you very much for code I will try  to convert it to form application with txt box for input and output"}], "tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": true, "score": 1, "last_activity_date": 1473281658, "last_edit_date": 1592644375, "creation_date": 1473280717, "answer_id": 39378614, "question_id": 39378200, "link": "https://stackoverflow.com/questions/39378200/read-bytes-into-array-then-xor-the-result-into-a-string/39378614#39378614", "title": "Read bytes into array then xor the result into a string", "body": "<p>Welcome to Stack Overflow, the land where dreams come true (if your dreams consist of answering programming questions.).  Since this is your first question, I'll do my best to answer but in the future, try to follow community guidelines to basically show that</p>\n<ol>\n<li>You have tried to solve the problem yourself,</li>\n<li>Post all code that is applicable to your problem, and</li>\n<li>Explicitly say why the code you've posted isn't doing what you'd like it to do</li>\n</ol>\n<p>As a side note, check out <a href=\"https://dotnetfiddle.net/pyIr9K\" rel=\"nofollow noreferrer\">dotnetfiddle.net</a> when you want to make small programs to test out quickly.  Pro tip: don't use excel to debug c# programs ;)</p>\n<h1>Answer: Daily Double</h1>\n<p>OK, I'm going to infer that your question is the following.  Pretty liberal paraphrasing I know, but I'm trying to help you out here</p>\n<blockquote>\n<p>[How can I read 4 bytes from a file at a given file offset, XOR each of those 4 bytes with 0x149, then display those on the screen?]</p>\n</blockquote>\n<p>OK, first place to start is to get a <code>FileStream</code> object I think.  More reading: <a href=\"https://msdn.microsoft.com/en-us/library/yh598w02.aspx\" rel=\"nofollow noreferrer\">what is <code>using</code></a>?</p>\n<pre><code>using (var input = File.OpenRead(path))\n{\n    // somehow seek to file offset\n    // read 4 bytes, and\n    // XOR each byte with 0x149\n    // store results in a List&lt;byte&gt; (or something)\n}\n\n// display result\n</code></pre>\n<p>Alright, to seek a file, you need <a href=\"https://msdn.microsoft.com/en-us/library/system.io.filestream.seek(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>input.Seek(0x1D, SeekOrigin.Begin);</code></a> (Assuming 0x1D from OP is correct).</p>\n<p>To read 4 bytes, do this (see <a href=\"https://msdn.microsoft.com/en-us/library/system.io.filestream.readbyte(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>ReadByte()</code></a> documentation)</p>\n<pre><code>for (var i=0;i&lt;4;i++){\n    var byteThatIsNotRemembered = input.ReadByte();\n}\n</code></pre>\n<p>Now you need to XOR those bytes with</p>\n<pre><code>for (var i=0;i&lt;4;i++){\n    var byteThatIsNotRemembered = input.ReadByte() ^ 0x149;\n}\n</code></pre>\n<p>Finally, save them to a <a href=\"https://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx\" rel=\"nofollow noreferrer\">list</a></p>\n<pre><code>// need to instantiate list somewhere near top\nvar byteList = new List&lt;byte&gt;();\n\n// ... other code that we've written\n\nfor (var i=0;i&lt;4;i++){\n    var byteThatIsRememberedNow = input.ReadByte() ^ 0x149;\n\n    // need to cast to byte because ^ operator creates ints\n    byteList.Add((byte) byteThatIsRememberedNow);\n}\n\n// you'll need to replace this with something for your text box...\n// couldn't figure out from your question\nfor (var i=0;i&lt;byteList.Length;i++){\n    Console.WriteLine(byteList[i]);\n}\n</code></pre>\n<p>All together now...</p>\n<pre><code>// need to instantiate list somewhere near top\nvar byteList = new List&lt;byte&gt;();\n\nusing (var input = File.OpenRead(path))\n{\n    input.Seek(0x1D, SeekOrigin.Begin);\n    for (var i=0;i&lt;4;i++){\n        var byteThatIsRememberedNow = input.ReadByte() ^ 0x149;\n        byteList.Add((byte) byteThatIsRememberedNow);\n    }\n}\n\n// you'll need to replace this with something for your text box...\n// couldn't figure out from your question\nfor (var i=0;i&lt;byteList.Length;i++){\n    Console.WriteLine(byteList[i]);\n}\n</code></pre>\n<p>Here's a similar <a href=\"https://dotnetfiddle.net/pyIr9K\" rel=\"nofollow noreferrer\">dotnetfiddle</a> where I use a string instead of a file to generate a stream.</p>\n<p>Let me know if this was helpful</p>\n"}], "owner": {"reputation": 3, "user_id": 6806281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52dc276a5cdea6771a1731724522681?s=128&d=identicon&r=PG&f=1", "display_name": "dom srt", "link": "https://stackoverflow.com/users/6806281/dom-srt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "accepted_answer_id": 39378614, "answer_count": 2, "score": -3, "last_activity_date": 1473443725, "creation_date": 1473278863, "last_edit_date": 1473443725, "question_id": 39378200, "link": "https://stackoverflow.com/questions/39378200/read-bytes-into-array-then-xor-the-result-into-a-string", "title": "Read bytes into array then xor the result into a string", "body": "<p>I read bytes and display them in a text box with this:</p>\n\n<pre><code>BinaryReader br = new BinaryReader(File.OpenRead(path));\nbr.BaseStream.Position = 0x1D; \ntextBox1.Text = br.ReadInt32().ToString(\"X\");\nbr.Dispose();\n</code></pre>\n\n<p>I need to read 4 bytes then XOR each one with the value 149 and print the results out to the text box. The text box only seems to display \"System.Byte()\"</p>\n\n<p>I've tried this code, but there were many errors, such as not being able to convert a byte to an int:</p>\n\n<pre><code>BinaryReader br = new BinaryReader(File.OpenRead(path));\nbr.BaseStream.Position = 0x3E8;\nbyte[] buffer = br.ReadBytes(4);\nint i = 149;\n</code></pre>\n\n<p>The output should look like this:</p>\n\n<pre><code>result = buffer[0] ^ 149;\nresult2 = buffer[1] ^ 149;\nresult3 = buffer[2] ^ 149;\nresult4 = buffer[3] ^ 149;\n</code></pre>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["c#", "unity3d", "drawing", "paint"], "comments": [{"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 0, "creation_date": 1473280509, "post_id": 39378195, "comment_id": 66085084, "body": "Can you provide an annotated picture indicating what the problem is? I think for visual issues, that kind of information would be really helpful."}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 5108570, "user_type": "registered", "profile_image": "https://graph.facebook.com/1643618989208107/picture?type=large", "display_name": "Edwinke", "link": "https://stackoverflow.com/users/5108570/edwinke"}, "is_accepted": false, "score": 0, "last_activity_date": 1473327052, "last_edit_date": 1473327052, "creation_date": 1473323055, "answer_id": 39386010, "question_id": 39378195, "link": "https://stackoverflow.com/questions/39378195/unity-linerenderer-error/39386010#39386010", "title": "Unity linerenderer error", "body": "<p>I fixed the issue,I just used order in layer,added +1 every time the user choose a color,now it's working fine </p>\n\n<p>Added this to the main script</p>\n\n<pre><code> public static int orderinlayer = 1;\n</code></pre>\n\n<p>And added lineRenderer.sortingOrder = orderinlayer; here</p>\n\n<pre><code> if (Input.GetMouseButtonDown(0))\n        {\n            isMousePressed = true;\n            lineDrawPrefab = GameObject.Instantiate(lineDrawPrefabs) as GameObject;\n            lineRenderer = lineDrawPrefab.GetComponent&lt;LineRenderer&gt;();\n            lineRenderer.sortingOrder = orderinlayer;\n            CheckColor();\n            lineRenderer.SetVertexCount(0);\n        }\n</code></pre>\n\n<p>And from another script what is the color picker i just added  </p>\n\n<pre><code>ScriptLineGameobject.orderinlayer += 1;\n</code></pre>\n\n<p>for each <code>color.Now</code> its working!</p>\n"}], "owner": {"reputation": 59, "user_id": 5108570, "user_type": "registered", "profile_image": "https://graph.facebook.com/1643618989208107/picture?type=large", "display_name": "Edwinke", "link": "https://stackoverflow.com/users/5108570/edwinke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1492904432, "creation_date": 1473278843, "last_edit_date": 1492904432, "question_id": 39378195, "link": "https://stackoverflow.com/questions/39378195/unity-linerenderer-error", "title": "Unity linerenderer error", "body": "<p>I am making a drawing app in Unity and I'm using line renderer. Here's the code, the problem is every time I make new line with another color it's drawing in back of the first color. Can somebody help me out? I just don't know how to fix.</p>\n\n<p>I was thinking about adding a little bit more z position to the line renderer when I switch colors, but I'm not sure it's going to work.</p>\n\n<pre><code>    public GameObject lineDrawPrefabs;\n    public Material black;\n    public Material green1;\n    public Material blue;\n    public Material pink;\n    public Material orange;\n    public Material brown;\n    public Material green2;\n    public Material blue2;\n    public Material yellow;\n    public Material red;\n    public Material white;\n\n    public static string nowcolor;\n    private bool isMousePressed;\n    private GameObject lineDrawPrefab;\n    private LineRenderer lineRenderer;\n    List&lt;Vector3&gt; drawPoints = new List&lt;Vector3&gt;();\n\n   // public static bool pencil;\n\n\n\n    void Start()\n    {\n\n        isMousePressed = false;     \n    }\n\n\n    void Update()\n    {\n      //  if (Input.GetMouseButtonDown(1))\n      //  {\n       //     // delete the LineRenderers when right mouse down\n       //     GameObject[] delete = GameObject.FindGameObjectsWithTag(\"LineDraw\");\n        //    int deleteCount = delete.Length;\n        //    for (int i = deleteCount - 1; i &gt;= 0; i--)\n        //        Destroy(delete[i]);\n      //  }\n\n        if (Input.GetMouseButtonDown(0))\n        {\n            // left mouse down, make a new line renderer\n            isMousePressed = true;\n            lineDrawPrefab = GameObject.Instantiate(lineDrawPrefabs) as GameObject;\n            lineRenderer = lineDrawPrefab.GetComponent&lt;LineRenderer&gt;();\n            CheckColor();\n            lineRenderer.SetVertexCount(0);\n        }\n        else if (Input.GetMouseButtonUp(0))\n        {\n            // left mouse up, stop drawing\n            isMousePressed = false;\n            drawPoints.Clear();\n        }\n\n        if (isMousePressed)\n        {\n            // when the left mouse button pressed\n            // continue to add vertex to line renderer\n            Vector3 mousePos = Camera.main.ScreenToWorldPoint(Input.mousePosition);\n            mousePos.z = -1000;\n            if (!drawPoints.Contains(mousePos))\n            {\n                drawPoints.Add(mousePos);\n                lineRenderer.SetVertexCount(drawPoints.Count);\n                lineRenderer.SetPosition(drawPoints.Count - 1, mousePos);\n            }\n        }\n    }\n\n    public static void deletedrawing() {\n        //     // delete the LineRenderers when right mouse down\n           GameObject[] delete = GameObject.FindGameObjectsWithTag(\"LineDraw\");\n           int deleteCount = delete.Length;\n           for (int i = deleteCount - 1; i &gt;= 0; i--)\n           Destroy(delete[i]);\n    }\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/SbW8U.png\" rel=\"nofollow\">Here is the image,first time I used the black color,then the green</a></p>\n"}, {"tags": ["c#", "c#-4.0", "c#-3.0"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 1, "creation_date": 1473278368, "post_id": 39378060, "comment_id": 66084112, "body": "Why don&#39;t you show what you have tried and what results you did get, and we may be able to help you get the desired results."}, {"owner": {"reputation": 847, "user_id": 1527762, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ef5cb947cf56532475a448b4f8607fce?s=128&d=identicon&r=PG", "display_name": "user1527762", "link": "https://stackoverflow.com/users/1527762/user1527762"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1473279411, "post_id": 39378060, "comment_id": 66084607, "body": "why is this question down voted?"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 3, "creation_date": 1473279415, "post_id": 39378060, "comment_id": 66084609, "body": "&quot;226.4223 =&gt; 226.43&quot; is not rounding by any traditional definition... You may want to clarify that you need non-standard operation."}], "answers": [{"comments": [{"owner": {"reputation": 847, "user_id": 1527762, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ef5cb947cf56532475a448b4f8607fce?s=128&d=identicon&r=PG", "display_name": "user1527762", "link": "https://stackoverflow.com/users/1527762/user1527762"}, "edited": false, "score": 0, "creation_date": 1473279279, "post_id": 39378216, "comment_id": 66084542, "body": "thanks. I get 100.00 instead of 100.0 And the output is a string not a decimal."}, {"owner": {"reputation": 3410, "user_id": 1740808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21ae98241fa13af9c1dd108ebc9ac5?s=128&d=identicon&r=PG", "display_name": "SergeyS", "link": "https://stackoverflow.com/users/1740808/sergeys"}, "reply_to_user": {"reputation": 847, "user_id": 1527762, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ef5cb947cf56532475a448b4f8607fce?s=128&d=identicon&r=PG", "display_name": "user1527762", "link": "https://stackoverflow.com/users/1527762/user1527762"}, "edited": false, "score": 0, "creation_date": 1473279336, "post_id": 39378216, "comment_id": 66084572, "body": "Output of a method is decimal. When showing it to Console it is converted to string. For decimal 100 and 100.0 and 100.00 and 100.00000 are all the same numbers. Only their string representation differs."}, {"owner": {"reputation": 3410, "user_id": 1740808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21ae98241fa13af9c1dd108ebc9ac5?s=128&d=identicon&r=PG", "display_name": "SergeyS", "link": "https://stackoverflow.com/users/1740808/sergeys"}, "reply_to_user": {"reputation": 847, "user_id": 1527762, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ef5cb947cf56532475a448b4f8607fce?s=128&d=identicon&r=PG", "display_name": "user1527762", "link": "https://stackoverflow.com/users/1527762/user1527762"}, "edited": false, "score": 0, "creation_date": 1473279932, "post_id": 39378216, "comment_id": 66084837, "body": "@user1527762 - updated formatting strings to &quot;#.0#&quot;, now it will show 100.0. See more info about formatting strings here <a href=\"https://msdn.microsoft.com/en-us/library/0c899ak8(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/0c899ak8(v=vs.110).aspx</a>"}], "tags": [], "owner": {"reputation": 3410, "user_id": 1740808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21ae98241fa13af9c1dd108ebc9ac5?s=128&d=identicon&r=PG", "display_name": "SergeyS", "link": "https://stackoverflow.com/users/1740808/sergeys"}, "is_accepted": true, "score": 1, "last_activity_date": 1473279852, "last_edit_date": 1473279852, "creation_date": 1473278957, "answer_id": 39378216, "question_id": 39378060, "link": "https://stackoverflow.com/questions/39378060/custom-rounding-decimal-numbers-c/39378216#39378216", "title": "Custom Rounding decimal numbers c#", "body": "<p>Try something like this:</p>\n\n<pre><code>static decimal Round(decimal v)\n{\n    return Math.Ceiling(v * 100) / 100;\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>decimal a = 100.00000M, b = 226.4223M, c = 115.9080M;\n\nConsole.WriteLine(Round(a).ToString(\"#.0#\"));\nConsole.WriteLine(Round(b).ToString(\"#.0#\"));\nConsole.WriteLine(Round(c).ToString(\"#.0#\"));\n</code></pre>\n\n<p>Exercise for the reader: make this method round to any desired number of decimal places after the point (now it is always 2 places after the point).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6806248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tYurG.jpg?s=128&g=1", "display_name": "Ryan C", "link": "https://stackoverflow.com/users/6806248/ryan-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1473279404, "creation_date": 1473279404, "answer_id": 39378317, "question_id": 39378060, "link": "https://stackoverflow.com/questions/39378060/custom-rounding-decimal-numbers-c/39378317#39378317", "title": "Custom Rounding decimal numbers c#", "body": "<p>First of all 226.4223 shouldn't round to 226.43</p>\n\n<p>Secondly if you'd like to try this:</p>\n\n<pre><code>double f = 1234.56789 ; \nConsole.WriteLine ( \"f: {0:#,###.00}\", f );\n</code></pre>\n\n<p>It will print \"f: 1,234.56\"\nThe # will print a number if there is one. The 0 will print up to that amount of numbers. For Example if ###.## was 0.5 it would print 0.5 whereas 000.00 would print 0.50</p>\n"}], "owner": {"reputation": 847, "user_id": 1527762, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ef5cb947cf56532475a448b4f8607fce?s=128&d=identicon&r=PG", "display_name": "user1527762", "link": "https://stackoverflow.com/users/1527762/user1527762"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 1, "accepted_answer_id": 39378216, "answer_count": 2, "score": -2, "last_activity_date": 1473279852, "creation_date": 1473278214, "last_edit_date": 1473279521, "question_id": 39378060, "link": "https://stackoverflow.com/questions/39378060/custom-rounding-decimal-numbers-c", "title": "Custom Rounding decimal numbers c#", "body": "<p>I am looking to do custom rounding decimal numbers like the following</p>\n\n<pre><code>100.0000 =&gt; 100.0\n226.4223 =&gt; 226.43\n115.9080 =&gt; 115.91\n</code></pre>\n\n<p>Both input and output should be decimal numbers.</p>\n\n<p>I have tried using Math.round but that does not give me the desired results. </p>\n\n<p>For example: <code>Math.Round(226.4226, 2)</code> results in 226.42</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["c#", "ios", "asp.net", "cookies", "asp.net-web-api"], "answers": [{"comments": [{"owner": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "edited": false, "score": 0, "creation_date": 1473285031, "post_id": 39379086, "comment_id": 66086943, "body": "Yikes.  It looks like that would have a lot of implications on my application architecture."}, {"owner": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "edited": false, "score": 0, "creation_date": 1473286128, "post_id": 39379086, "comment_id": 66087343, "body": "How about implementing header validation to prevent those attacks?  <a href=\"http://www.asp.net/web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks\" rel=\"nofollow noreferrer\">asp.net/web-api/overview/security/&hellip;</a>"}, {"owner": {"reputation": 182, "user_id": 1920508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43740b9270a206c2d0a9061b4c906be3?s=128&d=identicon&r=PG", "display_name": "Traveler", "link": "https://stackoverflow.com/users/1920508/traveler"}, "reply_to_user": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "edited": false, "score": 0, "creation_date": 1473287044, "post_id": 39379086, "comment_id": 66087639, "body": "if I understood it right, this is for AJAX requests from MVC, server rendered page, not SPA or mobile apps"}, {"owner": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "edited": false, "score": 0, "creation_date": 1473535706, "post_id": 39379086, "comment_id": 66183054, "body": "This is for a SPA with one MVC rendered page, and all other requests via AJAX"}, {"owner": {"reputation": 182, "user_id": 1920508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43740b9270a206c2d0a9061b4c906be3?s=128&d=identicon&r=PG", "display_name": "Traveler", "link": "https://stackoverflow.com/users/1920508/traveler"}, "reply_to_user": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "edited": false, "score": 0, "creation_date": 1473539764, "post_id": 39379086, "comment_id": 66184075, "body": "exactly. Why would you render it on mobile device? I always user token auth in WebAPI, works great for SPA and any other clients."}, {"owner": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "edited": false, "score": 0, "creation_date": 1473540367, "post_id": 39379086, "comment_id": 66184207, "body": "Because I <i>have already implemented</i> forms auth and want to minimize rework as long as I&#39;m not posing a security risk by doing so."}], "tags": [], "owner": {"reputation": 182, "user_id": 1920508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43740b9270a206c2d0a9061b4c906be3?s=128&d=identicon&r=PG", "display_name": "Traveler", "link": "https://stackoverflow.com/users/1920508/traveler"}, "is_accepted": false, "score": 1, "last_activity_date": 1473282796, "creation_date": 1473282796, "answer_id": 39379086, "question_id": 39378009, "link": "https://stackoverflow.com/questions/39378009/webapi-ios-and-forms-auth-can-it-work/39379086#39379086", "title": "WebApi, iOS, and Forms Auth - can it work?", "body": "<p>Well, you can use WebView to handle stuff with cookies, but I would call it very inappropriate way to authenticate api users. Insecure way.</p>\n\n<blockquote>\n  <p>In particular, the MVC portion of your app might use forms authentication, which stores credentials in a cookie. Cookie-based authentication requires the use of anti-forgery tokens, to prevent CSRF attacks. That\u2019s a problem for web APIs, because there is no convenient way for the web API to send the anti-forgery token to the client. (For more background on this issue, see Preventing CSRF Attacks in Web API.) Calling SuppressDefaultHostAuthentication ensures that Web API is not vulnerable to CSRF attacks from credentials stored in cookies.</p>\n</blockquote>\n\n<p>You should use token based methods instead.\n<a href=\"http://www.asp.net/web-api/overview/security/individual-accounts-in-web-api\" rel=\"nofollow\">Consider adding OAuth methods to your middleware</a></p>\n"}], "owner": {"reputation": 10594, "user_id": 899530, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/91eeaa6cfac17cb16f01000388cbfad3?s=128&d=identicon&r=PG", "display_name": "SB2055", "link": "https://stackoverflow.com/users/899530/sb2055"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473282796, "creation_date": 1473277865, "last_edit_date": 1473278761, "question_id": 39378009, "link": "https://stackoverflow.com/questions/39378009/webapi-ios-and-forms-auth-can-it-work", "title": "WebApi, iOS, and Forms Auth - can it work?", "body": "<p>I have a single-page web application that makes AJAX calls to a WebAPI layer to provide all data. The web app authenticates and authorizes endpoints with the following:</p>\n\n<pre><code>WebSecurity.Login(model.Username, model.Password)\n</code></pre>\n\n<p>This way, I can use MembershipProvider to determine who can access what on a per-controller level:</p>\n\n<pre><code>[HttpGet]\n[Route(\"api/adminwork\")]\n[System.Web.Http.Authorize(Roles = \"Administrator\")]\npublic HttpResponseMessage DoWork() {\n    ApiResponseDto result = _adminService.DoAdminWork();\n    return Request.CreateResponse(HttpStatusCode.OK, result);\n}\n</code></pre>\n\n<p>I'm preparing to build an iOS application that will use this same API.  I'm hoping that I can use this mechanism of forms auth + membership provider to attach a cookie to all requests originating from the mobile app, effectively treating requests in the same manner as those coming from the web app (and minimizing my work).</p>\n\n<p>Is there any way to make an iOS application work with ASPX cookies to achieve this? </p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "iis"], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 3850567, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/NEj6M.jpg?s=128&g=1", "display_name": "dumbchemistry", "link": "https://stackoverflow.com/users/3850567/dumbchemistry"}, "edited": false, "score": 0, "creation_date": 1473279285, "post_id": 39378199, "comment_id": 66084546, "body": "I&#39;m able to run the above code if I use IIS Express in Visual Studio (in which case the application is running under the <code>MYNAME\\myname</code> account instead of <code>IIS APPPOOL\\DefaultAppPool</code>) instead of Local IIS and it does appear that PowerPoint is running (albeit in the background), so, unless I&#39;m completely mistaken (which is a definite possibility), shouldn&#39;t it be possible to launch it assuming I have correct permissions?"}, {"owner": {"reputation": 7558, "user_id": 87956, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CA0Ss.jpg?s=128&g=1", "display_name": "Vinay Pandey", "link": "https://stackoverflow.com/users/87956/vinay-pandey"}, "reply_to_user": {"reputation": 363, "user_id": 3850567, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/NEj6M.jpg?s=128&g=1", "display_name": "dumbchemistry", "link": "https://stackoverflow.com/users/3850567/dumbchemistry"}, "edited": false, "score": 0, "creation_date": 1473279707, "post_id": 39378199, "comment_id": 66084725, "body": "Thats is in your local machine probably where you have all the permission, there is huge security implication apart from other hurdles, consider some random application deleting all files or doing similar things if everyone is able to execute system command on client machine. Whereas when client installs activex or others its assumed that client is aware of consequences."}, {"owner": {"reputation": 363, "user_id": 3850567, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/NEj6M.jpg?s=128&g=1", "display_name": "dumbchemistry", "link": "https://stackoverflow.com/users/3850567/dumbchemistry"}, "edited": false, "score": 0, "creation_date": 1473281821, "post_id": 39378199, "comment_id": 66085669, "body": "Thanks, I&#39;ll look into ActiveX. This application will be running on a bunch of different machines each with their own local instance of IIS and won&#39;t be connected to the Internet -- is it still subject to security issues? I know this isn&#39;t implementing best practices and would be better suited for a desktop application, but I inherited this project and am unsure of alternatives at this point in development."}, {"owner": {"reputation": 7558, "user_id": 87956, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CA0Ss.jpg?s=128&g=1", "display_name": "Vinay Pandey", "link": "https://stackoverflow.com/users/87956/vinay-pandey"}, "reply_to_user": {"reputation": 363, "user_id": 3850567, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/NEj6M.jpg?s=128&g=1", "display_name": "dumbchemistry", "link": "https://stackoverflow.com/users/3850567/dumbchemistry"}, "edited": false, "score": 0, "creation_date": 1473286475, "post_id": 39378199, "comment_id": 66087449, "body": "I am not sure why you need appliction installed on local for each end user would be interesting if you could share why you are configuring and deploying applicstion on each machine instead of having 1 instance being accessed by any means of network may be lan if not internet. Anyways have a look at <a href=\"https://social.msdn.microsoft.com/Forums/en-US/a5db03be-3748-4f60-af4e-b3568f7ef851/ensure-window-is-foreground-after-processstart?forum=vblanguage\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a> havent tried myseld but should help."}], "tags": [], "owner": {"reputation": 7558, "user_id": 87956, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/CA0Ss.jpg?s=128&g=1", "display_name": "Vinay Pandey", "link": "https://stackoverflow.com/users/87956/vinay-pandey"}, "is_accepted": false, "score": 0, "last_activity_date": 1473278858, "creation_date": 1473278858, "answer_id": 39378199, "question_id": 39377985, "link": "https://stackoverflow.com/questions/39377985/starting-powerpoint-via-process-start-in-an-asp-net-web-application-results-in/39378199#39378199", "title": "Starting PowerPoint via Process.Start() in an ASP.NET web application results in PowerPoint starting in the background", "body": "<p>Asp.net code runs on server side hence <strong>process.Start();</strong> starts the process on server side, you can use activex object for IE or equivalent for other browsers if you want to open on client side</p>\n"}, {"comments": [{"owner": {"reputation": 363, "user_id": 3850567, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/NEj6M.jpg?s=128&g=1", "display_name": "dumbchemistry", "link": "https://stackoverflow.com/users/3850567/dumbchemistry"}, "edited": false, "score": 0, "creation_date": 1473351129, "post_id": 39379741, "comment_id": 66117518, "body": "Great, that makes sense, thanks for the help! For future readers, I was able to open it using the library from <a href=\"http://stackoverflow.com/a/24122826/3850567\">this</a> answer from the first link @John Wu referenced."}], "tags": [], "owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "is_accepted": true, "score": 1, "last_activity_date": 1473286916, "last_edit_date": 1495535436, "creation_date": 1473286084, "answer_id": 39379741, "question_id": 39377985, "link": "https://stackoverflow.com/questions/39377985/starting-powerpoint-via-process-start-in-an-asp-net-web-application-results-in/39379741#39379741", "title": "Starting PowerPoint via Process.Start() in an ASP.NET web application results in PowerPoint starting in the background", "body": "<p>Problem is that IIS runs under a service account, and you need the PowerPoint process to start as the currently logged on interactive user-- whoever that is.</p>\n\n<p>Maybe try <a href=\"https://stackoverflow.com/questions/4278373/how-to-start-a-process-from-windows-service-into-currently-logged-in-users-sess\">this</a> answer to see if it works with an IIS process as well?  (But instead of <a href=\"https://msdn.microsoft.com/en-us/library/ms682429(VS.85).aspx\" rel=\"nofollow noreferrer\">CreateProcessAsUser</a> maybe use <a href=\"http://weblogs.asp.net/hernandl/startprocessasuser\" rel=\"nofollow noreferrer\">this approach</a>).</p>\n\n<p>Another approach would be to write something completely separate that would run under the current user's <a href=\"http://www.codeproject.com/Articles/290013/Formless-System-Tray-Application\" rel=\"nofollow noreferrer\">system tray</a>, and have it \"listen\" for a signal that is sent by the web application, e.g. open a named pipe or even poll a directory for a file.  For example, your web app could copy a PowerPoint file into an agreed folder, and the tray application would monitor it (using <a href=\"https://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher(v=vs.110).aspx\" rel=\"nofollow noreferrer\">FileSystemWatcher</a>) and automatically open anything it sees in the folder.  The tray app runs as the interactive user so there is no cross-user boundary to overcome.</p>\n"}], "owner": {"reputation": 363, "user_id": 3850567, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/NEj6M.jpg?s=128&g=1", "display_name": "dumbchemistry", "link": "https://stackoverflow.com/users/3850567/dumbchemistry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 39379741, "answer_count": 2, "score": 1, "last_activity_date": 1473286916, "creation_date": 1473277770, "last_edit_date": 1473279462, "question_id": 39377985, "link": "https://stackoverflow.com/questions/39377985/starting-powerpoint-via-process-start-in-an-asp-net-web-application-results-in", "title": "Starting PowerPoint via Process.Start() in an ASP.NET web application results in PowerPoint starting in the background", "body": "<p>I'm going to have an ASP.NET MVC application that will run on many clients, all of which have their own local version of IIS running. I'm trying to open a PowerPoint file with Process.Start(). The PowerPoint is successfully opening (I can see it in Task Manager) but it is running in the background and I would like  it to open in the foreground.</p>\n\n<p>In order to start the application I'm using the following code:</p>\n\n<pre><code>string powerPointPath = @\"C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\POWERPNT.EXE\";\nstring powerPointFilePath = \"\\\"\" + filePath;\n\nProcess powerPoint = new Process();\npowerPoint.StartInfo.FileName = powerPointPath;\npowerPoint.StartInfo.Arguments = \" /S \" + filePath;\npowerPoint.Start();\n</code></pre>\n\n<p>Since I'm using a local instance of IIS, I made sure to grant read permissions for the PowerPoint executable to the <code>IIS APPPOOL\\DefaultAppPool</code> user. Is there any way to ensure that PowerPoint runs in the foreground?</p>\n\n<p><strong>Edit:</strong> I'm able to run this code without an issue when using IIS Express in Visual Studio (in which case the application is using the <code>MYNAME\\myname</code> user permissions) but it does not seem to work equivalently when using Local IIS (i.e. when the application is using the <code>IIS APPPOOL\\DefaultAppPool</code> user).</p>\n"}, {"tags": ["c#", "visual-studio-2015", "nancy"], "answers": [{"comments": [{"owner": {"reputation": 524, "user_id": 2647513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de473566ab716b5ed2b7bcb7b6967fad?s=128&d=identicon&r=PG", "display_name": "user2647513", "link": "https://stackoverflow.com/users/2647513/user2647513"}, "reply_to_user": {"reputation": 7983, "user_id": 527516, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2619ce251c73544ee0e5a8c9034be51f?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/527516/daniel-williams"}, "edited": false, "score": 0, "creation_date": 1473862783, "post_id": 39476965, "comment_id": 66303126, "body": "I would very much appreciate if you&#39;d accept my answer, since it does solve the problem without requiring a re-installation."}], "tags": [], "owner": {"reputation": 524, "user_id": 2647513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de473566ab716b5ed2b7bcb7b6967fad?s=128&d=identicon&r=PG", "display_name": "user2647513", "link": "https://stackoverflow.com/users/2647513/user2647513"}, "is_accepted": false, "score": 3, "last_activity_date": 1552512870, "last_edit_date": 1552512870, "creation_date": 1473792150, "answer_id": 39476965, "question_id": 39377880, "link": "https://stackoverflow.com/questions/39377880/nancy-dynamicdictionary-does-not-contain-a-definition-for-x/39476965#39476965", "title": "Nancy.DynamicDictionary does not contain a definition for X", "body": "<p>I've noticed this strange, inconsistent behavior before as well. I believe the error goes away if you replace <code>v.company_id</code> with <code>v[\"company_id\"]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 7983, "user_id": 527516, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2619ce251c73544ee0e5a8c9034be51f?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/527516/daniel-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1473858631, "creation_date": 1473858631, "answer_id": 39491340, "question_id": 39377880, "link": "https://stackoverflow.com/questions/39377880/nancy-dynamicdictionary-does-not-contain-a-definition-for-x/39491340#39491340", "title": "Nancy.DynamicDictionary does not contain a definition for X", "body": "<p>I re installed visual studio and the issue went away. Not the most satisfying answer, though. </p>\n"}], "owner": {"reputation": 7983, "user_id": 527516, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2619ce251c73544ee0e5a8c9034be51f?s=128&d=identicon&r=PG", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/527516/daniel-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1552512870, "creation_date": 1473277330, "last_edit_date": 1473430199, "question_id": 39377880, "link": "https://stackoverflow.com/questions/39377880/nancy-dynamicdictionary-does-not-contain-a-definition-for-x", "title": "Nancy.DynamicDictionary does not contain a definition for X", "body": "<p>When  running in the VS2015 debugger, just today, never before, in my Routing call, the debugger claims that \"Nancy.DynamicDictionary does not contain a definition for v.company_id\", which is the variable that I defined in the route as such:</p>\n\n<pre><code>Get[\"/companies/{company_id}/connection/validate\"] = v =&gt; Validate( v.company_id );\n</code></pre>\n\n<p>But when I run from the console all is fine.  Running 3 days ago from VS2015 all was fine.  Why on earth is this dynamic being treated differently today?  This has been working for months now.</p>\n\n<p>UPDATE:  I am using VS2015 Community on the machine where this happens.  On other machines with standard VS2015 editions, this works flawlessly.  </p>\n"}, {"tags": ["c#", "casting"], "comments": [{"owner": {"reputation": 1172, "user_id": 1260556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff32afbc0c7555688f3f5906f9962c72?s=128&d=identicon&r=PG", "display_name": "j-u-s-t-i-n", "link": "https://stackoverflow.com/users/1260556/j-u-s-t-i-n"}, "edited": false, "score": 0, "creation_date": 1473277286, "post_id": 39377822, "comment_id": 66083649, "body": "<a href=\"http://stackoverflow.com/questions/2399710/how-to-get-type-of-tkey-and-tvalue-given-a-dictionarytkey-tvalue-type\" title=\"how to get type of tkey and tvalue given a dictionarytkey tvalue type\">stackoverflow.com/questions/2399710/&hellip;</a>"}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1473277382, "post_id": 39377822, "comment_id": 66083688, "body": "Do you want to assume that <code>Get&lt;T&gt;(...)</code> will succeed?  What&#39;s wrong with the code you&#39;ve provided?"}, {"owner": {"reputation": 693, "user_id": 5381090, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/1637535983194467/picture?type=large", "display_name": "Jedi_Maseter_Sam", "link": "https://stackoverflow.com/users/5381090/jedi-maseter-sam"}, "edited": false, "score": 0, "creation_date": 1473277382, "post_id": 39377822, "comment_id": 66083689, "body": "that is not what I am asking.  I don&#39;t want to get the type of the dictionary&#39;s value, I want to get the type of the value within a property."}, {"owner": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "edited": false, "score": 0, "creation_date": 1473277644, "post_id": 39377822, "comment_id": 66083794, "body": "So,  you want something that will <code>return GetType(obj);</code> ?"}, {"owner": {"reputation": 693, "user_id": 5381090, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/1637535983194467/picture?type=large", "display_name": "Jedi_Maseter_Sam", "link": "https://stackoverflow.com/users/5381090/jedi-maseter-sam"}, "edited": false, "score": 0, "creation_date": 1473277731, "post_id": 39377822, "comment_id": 66083842, "body": "We know that all of the objects in the dictionary are of type Property&lt;T&gt;, but we do not know what T is.  Even when I say what T is an error is thrown.  For example, if I change Property&lt;T&gt; Get&lt;T&gt; to Property&lt;string&lt; Get it still fails."}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1473277886, "post_id": 39377822, "comment_id": 66083906, "body": "@Jedi_Maseter_Sam The error message you posted is saying that <code>obj</code> is of type <code>string</code>, and not <code>Property&lt;T&gt;</code>"}, {"owner": {"reputation": 693, "user_id": 5381090, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/1637535983194467/picture?type=large", "display_name": "Jedi_Maseter_Sam", "link": "https://stackoverflow.com/users/5381090/jedi-maseter-sam"}, "edited": false, "score": 0, "creation_date": 1473278037, "post_id": 39377822, "comment_id": 66083971, "body": "woops, I accidentally passed in a string instead of a property&lt;string&gt;"}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1473278900, "post_id": 39377822, "comment_id": 66084377, "body": "@Jedi_Maseter_Sam so did I answer your question?"}, {"owner": {"reputation": 693, "user_id": 5381090, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/1637535983194467/picture?type=large", "display_name": "Jedi_Maseter_Sam", "link": "https://stackoverflow.com/users/5381090/jedi-maseter-sam"}, "edited": false, "score": 0, "creation_date": 1473279068, "post_id": 39377822, "comment_id": 66084454, "body": "halfway. Is there any way to change Get&lt;T&gt;() to just Get()?"}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1473348225, "post_id": 39377822, "comment_id": 66115647, "body": "Short answer, it depends.  If you want a strongly-typed object back from <code>Get()</code> then you need to specify to C# what type you want.  If you&#39;re ok with a <code>Property&lt;object&gt;</code> type or like a <code>Property</code> type where <code>Value</code> would be of type <code>object</code>, then yeah it&#39;s pretty trivial."}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1473349591, "post_id": 39377822, "comment_id": 66116622, "body": "See my updated answer and let me know if this works for you."}], "answers": [{"tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": true, "score": 2, "last_activity_date": 1473349203, "last_edit_date": 1473349203, "creation_date": 1473277848, "answer_id": 39378004, "question_id": 39377822, "link": "https://stackoverflow.com/questions/39377822/c-casting-object-to-class-with-type-argument/39378004#39378004", "title": "C# casting object to class with type argument", "body": "<p>EDIT (for updated post):</p>\n\n<blockquote>\n  <p>Is there a way to get the type by hashing the name with a type?</p>\n</blockquote>\n\n<p>Is something like this what you're going for? <a href=\"https://dotnetfiddle.net/BcbQCS\" rel=\"nofollow\">dotnetfiddle link</a></p>\n\n<pre><code>public interface IProperty\n{\n    object Value { get; }\n    Type TypeOfValue { get; }\n}\n\npublic class Property : IProperty\n{\n    public object Value { get; set; }\n    public Type TypeOfValue { get; set; }\n    public override string ToString() { return TypeOfValue.FullName + \": \" + Value; }\n}\n\npublic class Observable\n{\n    public readonly Dictionary&lt;string, Property&gt; \n        Properties = new Dictionary&lt;string, Property&gt;();\n\n    // use interface so consumer of your property can't mess with the\n    // type or value stored in your dictionary within Observable\n    public IProperty Get(string name)\n    {\n        Property obj;\n        if (Properties.TryGetValue(name, out obj)){\n            return obj;\n        }\n\n        // throw something which makes more sense to you\n        throw new ArgumentException(name + \" does not exist in the dictionary\");\n    }\n\n    // sample of how you'd store these properties\n    public void Set(string name, object val)\n    {\n        if (Properties.ContainsKey(name)){\n            Properties[name].Value = val;\n            Properties[name].TypeOfValue = val.GetType();\n        } else {\n            Properties[name] = new Property {\n                Value = val,\n                TypeOfValue = val.GetType()\n            };\n        }\n    }\n}\n</code></pre>\n\n<p>ORIGINAL ANSWER:</p>\n\n<p>It's possible that you're accidently inserting a <code>string</code> into your dictionary inside of <code>Observable</code> instead of a <code>Property&lt;string&gt;</code>, and if so the problem isn't in the code that you've posted and instead wherever you're inserting a <code>string</code> instead of a <code>Property&lt;string&gt;</code>.</p>\n\n<p>Two solutions if you don't like the invalid cast exception.</p>\n\n<h1>Solution 1: customize the errors your function throws.</h1>\n\n<p>If you'd like to keep the signature of <code>Get&lt;T&gt;(...)</code> I'd recommend some error handling.  The error you're seeing is because the property in your dictionary is of type <code>string</code>, not of type <code>Property&lt;string&gt;</code>.  The following code will give you something to work with for more error handling.</p>\n\n<pre><code>public class Observable\n{\n    public readonly Dictionary&lt;string, object&gt; \n        Properties = new Dictionary&lt;string, object&gt;();\n\n    public Property&lt;T&gt; Get&lt;T&gt;(string name)\n    {\n        object obj;\n        if (Properties.TryGetValue(name, out obj)){\n            try {\n                return (Property&lt;T&gt;) obj;\n            } catch(InvalidCastException){\n                // throw something which makes more sense to you\n                throw new ArgumentException(\"Could not cast the given object to the desired type\");\n            }\n        }\n\n        // throw something which makes more sense to you\n        throw new ArgumentException(name + \" does not exist in the dictionary\");\n    }\n}\n</code></pre>\n\n<h1>Solution 2: return a general <code>object</code></h1>\n\n<pre><code>public class Observable\n{\n    public readonly Dictionary&lt;string, object&gt; \n        Properties = new Dictionary&lt;string, object&gt;();\n\n    public object Get(string name)\n    {\n        object obj;\n        if (Properties.TryGetValue(name, out obj)){\n            return obj;\n        }\n\n        // or do whatever you want when the given key doesn't exist.\n        return null;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 419, "user_id": 2875005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/yHUIh.jpg?s=128&g=1", "display_name": "Davit Karapetyan", "link": "https://stackoverflow.com/users/2875005/davit-karapetyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1473278384, "creation_date": 1473278384, "answer_id": 39378099, "question_id": 39377822, "link": "https://stackoverflow.com/questions/39377822/c-casting-object-to-class-with-type-argument/39378099#39378099", "title": "C# casting object to class with type argument", "body": "<p>Indexers may solve your problem without using additional constructs. \nHave a look if you areI'm not sure if I got you clear, but I'll try to help )\nAs for me the question may be rephrased as follows.\nIs it possible to determine most specific type of the upcasted type.</p>\n\n<p>Here is a code which may help you</p>\n\n<pre><code> public class Employee\n{\n    public int salary { get; set; }\n\n}\n\npublic class Manager : Employee\n{\n\n}\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        Manager man = new Manager();\n        System.Object emp = (object) man;\n        Console.WriteLine(emp.GetType());\n    }\n}\n</code></pre>\n\n<p>The output of the WriteLine operation is \"Project_Name\".Manager so you can see what type was originally allocated in memory. not familiar with them. </p>\n"}], "owner": {"reputation": 693, "user_id": 5381090, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/1637535983194467/picture?type=large", "display_name": "Jedi_Maseter_Sam", "link": "https://stackoverflow.com/users/5381090/jedi-maseter-sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1055, "favorite_count": 0, "accepted_answer_id": 39378004, "answer_count": 2, "score": -2, "last_activity_date": 1473349203, "creation_date": 1473277121, "last_edit_date": 1473278105, "question_id": 39377822, "link": "https://stackoverflow.com/questions/39377822/c-casting-object-to-class-with-type-argument", "title": "C# casting object to class with type argument", "body": "<p>I have a class called Property that stores one value and raises an event if the value changes. There is a different class called Observable that I want to contain a dictionary of properties, and I have an example below.  How can I get the type of a property stored in the dictionary so I can modify the object?</p>\n\n<p>Property Class:</p>\n\n<pre><code>public class Property&lt;T&gt;\n{\n     public T Value { get; set; }\n}\n</code></pre>\n\n<p>Observable Class:</p>\n\n<pre><code>public class Observable\n{\n    public readonly Dictionary&lt;string, object&gt; \n              Properties = new Dictionary&lt;string, object&gt;();\n\n    public Property&lt;T&gt; Get&lt;T&gt;(string name)\n    {\n        object obj;\n        Properties.TryGetValue(name, out obj);\n        return (Property&lt;T&gt;) obj;\n    }\n}\n</code></pre>\n\n<p><strong>EDIT</strong>:  <strike>This is the error I am getting - \nUnhandled Exception: System.InvalidCastException: Unable to cast object of type 'System.String' to type 'ConsoleApplication.Property`1[System.String]'.</strike></p>\n\n<p>Also, if I could get rid of the Get function and replace it with something that does not require knowing the type that would be much better.</p>\n\n<p><strong>Update</strong>: Is there a way to get the type  by hashing the name with a type?</p>\n"}, {"tags": ["c#", "multithreading", "task"], "answers": [{"tags": [], "owner": {"reputation": 3289, "user_id": 1011956, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/WFGdb.jpg?s=128&g=1", "display_name": "corylulu", "link": "https://stackoverflow.com/users/1011956/corylulu"}, "is_accepted": false, "score": 1, "last_activity_date": 1473278012, "last_edit_date": 1473278012, "creation_date": 1473277221, "answer_id": 39377851, "question_id": 39377819, "link": "https://stackoverflow.com/questions/39377819/using-task-with-input-parameters-and-result/39377851#39377851", "title": "Using Task with input parameters and result", "body": "<p>Best option is using a lambda expression like this:</p>\n\n<pre><code>string toggleButtonName = \"hi!\";\nTask&lt;bool&gt; task = Task.Run(() =&gt; delToUse(toggleButtonName));\n</code></pre>\n\n<p>However, be careful about doing so while in a loop. If the variable you are utilizing isn't initialized in the iteration of the loop you ran the task in, it might change and produce unintended results. To avoid issues, reinitialize the variable inside the loop like so:</p>\n\n<pre><code>for(int i = 0; i &lt; 10; i++)\n{\n    // Don't do this!!!!\n    Task&lt;int&gt; task = Task.Run(() =&gt; doStuff(i));\n\n    // Do this!!!\n    string j = i;\n    Task&lt;int&gt; task = Task.Run(() =&gt; doStuff(j));\n}\n</code></pre>\n\n<p>In the first example, <code>doStuff()</code> will resolve <code>i</code> to whatever value it's at when the task is ran, not the value it's at when you called <code>Task.Run()</code>. Copying the value to a variable created in the current scope will resolve this issue, which is what we did in the second example. (Obviously, this doesn't work the same for reference objects)</p>\n\n<p>If you have Resharper installed, it should actually warn you about this if it see's it. </p>\n"}, {"comments": [{"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1473348130, "post_id": 39378142, "comment_id": 66115591, "body": "Any luck?  Does using a method rather than a lambda expression seem OK to you?"}], "tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": false, "score": 0, "last_activity_date": 1473278564, "creation_date": 1473278564, "answer_id": 39378142, "question_id": 39377819, "link": "https://stackoverflow.com/questions/39377819/using-task-with-input-parameters-and-result/39378142#39378142", "title": "Using Task with input parameters and result", "body": "<blockquote>\n  <p>From what I've seen from searching, it looks like Lambda expressions are used most frequently. I never really used them much so I was (at first) trying to find a more verbose way of accomplishing the same thing.</p>\n</blockquote>\n\n<p>Use Lambdas!  But hey, if you don't want to, just use plain-old-boring methods ;)</p>\n\n<pre><code>// :)\ninternal bool DoThisThing_ShouldBeALambda() {\n    string toggleButtonName = \"hi!\";\n    return DoThisThing(toggleButtonName);\n}\n\ninternal bool DoThisThing(string input) {...} // Takes a while.\n\nprivate void toggleButton_Click(object sender, RoutedEventArgs e)\n{\n    Task&lt;bool&gt; task = new Task&lt;bool&gt;(DoThisThing_ShouldBeALambda); \n\n    // ... do other things for a while\n\n    // Task takes a while, don't want to block UI thread, use Task.\n    task.Start();\n\n    // ... keep on going and let Task finish. Maybe check the result, maybe not.        \n}\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 2048267, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/85dbc53bd9071d6fb1dca0f18369b0cc?s=128&d=identicon&r=PG", "display_name": "Jon", "link": "https://stackoverflow.com/users/2048267/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473278564, "creation_date": 1473277117, "question_id": 39377819, "link": "https://stackoverflow.com/questions/39377819/using-task-with-input-parameters-and-result", "title": "Using Task with input parameters and result", "body": "<p>So, I would like to use the new Task class (years ago I would use BackgroundWorker) to do the following but I'm unsure how to get it working. Apologies, I'm rusty...</p>\n\n<pre><code>internal bool DoThisThing(string input) {...} // Takes a while.\n\nprivate void toggleButton_Click(object sender, RoutedEventArgs e)\n{\n    string toggleButtonName = \"hi!\";\n\n    Func&lt;string, bool&gt; delToUse = new Func&lt;string, bool&gt;(DoThisThing); // Delgate of appropriate type\n\n    Task&lt;bool&gt; task = new Task&lt;bool&gt;(delToUse);  // Doesn't like this. Something I can do instead?\n\n    ... // do other things for a while\n\n    // Task takes a while, don't want to block UI thread, use Task.\n    task.Start(toggleButtonName);   // Looks like Start method doesn't allow input parameters for the assigned delegate like this. How can I accomplish something similar?\n\n    ... keep on going and let Task finish. Maybe check the result, maybe not.        \n}\n</code></pre>\n\n<p>Hopefully that makes some sense? </p>\n\n<p>From what I've seen from searching, it looks like Lambda expressions are used most frequently. I never really used them much so I was (at first) trying to find a more verbose way of accomplishing the same thing.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "struct", "udp", "pack"], "answers": [{"comments": [{"owner": {"reputation": 1753, "user_id": 1308706, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/44056bd3665c4e90f18b278bb126d75f?s=128&d=identicon&r=PG", "display_name": "Shatnerz", "link": "https://stackoverflow.com/users/1308706/shatnerz"}, "edited": false, "score": 0, "creation_date": 1473342259, "post_id": 39379913, "comment_id": 66111276, "body": "Thanks this is useful. Can endianness be specified?"}, {"owner": {"reputation": 1148, "user_id": 4062628, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9V2b.jpg?s=128&g=1", "display_name": "John Riehl", "link": "https://stackoverflow.com/users/4062628/john-riehl"}, "reply_to_user": {"reputation": 1753, "user_id": 1308706, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/44056bd3665c4e90f18b278bb126d75f?s=128&d=identicon&r=PG", "display_name": "Shatnerz", "link": "https://stackoverflow.com/users/1308706/shatnerz"}, "edited": false, "score": 0, "creation_date": 1473345881, "post_id": 39379913, "comment_id": 66113994, "body": "It&#39;s a characteristic of the architecture you&#39;re running on...some processors are little-endian, some are big-endian.  You can play it safe by using <code>IPAddress.HostToNetworkOrder()</code> when serializing for transport and <code>IPAddress.NetworkToHostOrder()</code> when deserializing."}], "tags": [], "owner": {"reputation": 1148, "user_id": 4062628, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/N9V2b.jpg?s=128&g=1", "display_name": "John Riehl", "link": "https://stackoverflow.com/users/4062628/john-riehl"}, "is_accepted": true, "score": 2, "last_activity_date": 1473287116, "creation_date": 1473287116, "answer_id": 39379913, "question_id": 39377707, "link": "https://stackoverflow.com/questions/39377707/packing-udp-packet-of-arbitrary-number-of-coordinates/39379913#39379913", "title": "Packing udp packet of arbitrary number of coordinates", "body": "<p>This seems more like a serialization/deserialization task.  The simplest approach is to mark the class with <code>Serializable</code> then use the <code>BinaryFormatter</code> like this:</p>\n\n<pre><code>public class Program\n{\n    public static void Main(string[] args)\n    {\n        var startPacket = new StartPacket();\n        startPacket.len = 3;\n        startPacket.points = new List&lt;double&gt;() { 3.14, 5, -1023.1231311 };\n\n        // serialize into a byte array for Socket.SendTo()\n        var formatter = new BinaryFormatter();\n        var ms = new MemoryStream();\n        formatter.Serialize(ms, startPacket);\n        var bytes = ms.ToArray();\n\n        // assuming we received bytes[] from a socket, deserialize into StartPacket object\n        ms = new MemoryStream(bytes);\n        formatter = new BinaryFormatter();\n        startPacket = (StartPacket)formatter.Deserialize(ms);\n    }\n}\n\n[Serializable()]\npublic struct StartPacket\n{\n    public uint len;\n    public List&lt;double&gt; points;\n}\n</code></pre>\n\n<p>However, this is not very efficient memory-wise--this example generates a 524-byte serialized <code>StartPacket</code>, probably due to the fact that the <code>List&lt;&gt;</code> will have a capacity of more than 3 <code>double</code>s.  Making <code>points</code> an array with the specific size only gets us down to 211 bytes.  Without looking into it, I'd guess that there's a lot of overhead in the serialized version of the struct (like the names and types of variables, etc).  However, if you're not too concerned about the size of the packet, then this might work for you.</p>\n\n<p>If you want something more efficient, then you can add methods to <code>StartPacket</code> like so:</p>\n\n<pre><code>public class Program\n{\n    public static void Main(string[] args)\n    {\n        var startPacket = new StartPacket();\n        startPacket.len = 3;\n        startPacket.points = new List&lt;double&gt; { 3.14, 5, -1023.1231311 };\n\n        // create an array to send through the socket\n        var arr = startPacket.ToArray();\n\n        // create a StartPacket from an array we received from a socket\n        var newStartPacket = StartPacket.FromArray(arr);\n    }\n}\n\npublic struct StartPacket\n{\n    public uint len;\n    public List&lt;double&gt; points;\n\n    public byte[] ToArray()\n    {\n        var arr = BitConverter.GetBytes(len);\n\n        foreach (var point in points)\n        {\n            arr = arr.Concat(BitConverter.GetBytes(point)).ToArray();\n        }\n\n        return arr;\n    }\n\n    public static StartPacket FromArray(byte[] array)\n    {\n        var sp = new StartPacket();\n        sp.len = BitConverter.ToUInt32(array, 0);\n        sp.points = new List&lt;double&gt;();\n\n        for (int i = 0; i &lt; sp.len; i++)\n        {\n            sp.points.Add(BitConverter.ToDouble(array, 4 + i * 8));\n        }\n\n        return sp;\n    }\n}\n</code></pre>\n\n<p>Note that neither of these account for the endianness of the system.  Hope this helps.</p>\n"}], "owner": {"reputation": 1753, "user_id": 1308706, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/44056bd3665c4e90f18b278bb126d75f?s=128&d=identicon&r=PG", "display_name": "Shatnerz", "link": "https://stackoverflow.com/users/1308706/shatnerz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 39379913, "answer_count": 1, "score": 0, "last_activity_date": 1473287116, "creation_date": 1473276599, "last_edit_date": 1473279852, "question_id": 39377707, "link": "https://stackoverflow.com/questions/39377707/packing-udp-packet-of-arbitrary-number-of-coordinates", "title": "Packing udp packet of arbitrary number of coordinates", "body": "<p>So I am getting a variable number of coordinates (latitude and longitude). I want to pack these coordinates in a straight forward way that can be easily sent via UDP and unpacked. How can I go about this with C#?</p>\n\n<p>I'm assuming I declare a <code>struct</code> and then use the built in marshalling to get a byte array to send. How does one do this when there is a variable number of points involved?</p>\n\n<p>Most of my programming experience has been in Python, but I need this to be done in C#, which I have limited experience with.</p>\n\n<p>edit: I'll add some code I was testing out, since I feel like no one responds to just text.</p>\n\n<pre><code>namespace ConsoleApplication1\n{\n    class Testing\n    {\n        static void Main(string[] args)\n        {\n            // Console.WriteLine(\"Starting\");\n\n            // string text = \"Hello\";\n            // byte[] data = Encoding.ASCII.GetBytes(text);\n\n            StartPacket test = new StartPacket();\n            test.len = 3;\n            List&lt;double&gt; points = new List&lt;double&gt;();\n            points.Add(3.14);\n            points.Add(5);\n            points.Add(-1023.1231311);\n            test.points = points;\n\n            byte[] data = StructureToByteArray(test);\n\n            SendUdp(65456, \"192.168.20.100\", data);\n\n       }\n\n        static void SendUdp(int srcPort, string dstIp, byte[] data)\n        {\n            Socket sock = new Socket(AddressFamily.InterNetwork, SocketType.Dgram,\n                                     ProtocolType.Udp);\n            IPAddress dst = IPAddress.Parse(dstIp);\n            IPEndPoint endPoint = new IPEndPoint(dst, srcPort);\n\n            sock.SendTo(data, endPoint);\n        }\n\n        public struct StartPacket\n        {\n            public uint len;\n            public List&lt;double&gt; points;\n        }\n\n        public static byte[] StructureToByteArray(object obj)\n        {\n            int len = Marshal.SizeOf(obj);\n            byte[] arr = new byte[len];\n\n            IntPtr ptr = Marshal.AllocHGlobal(len);\n            Marshal.StructureToPtr(obj, ptr, true);\n            Marshal.Copy(ptr, arr, 0, len);\n            Marshal.FreeHGlobal(ptr);\n            return arr;\n        }\n    }\n}\n</code></pre>\n\n<p>This code fails with:\nType 'ConsoleApplication1.Testing+StartPacket' cannot be marshaled as an unmanaged structure; no meaningful size or offset can be computed.</p>\n"}, {"tags": ["c#", "linq", "sum"], "comments": [{"owner": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 2, "creation_date": 1473277042, "post_id": 39377696, "comment_id": 66083529, "body": "<code>.Select(x =&gt; x)</code> does nothing useful. So your question is basically what is the difference between the first and the second case. right?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6313890"}, "reply_to_user": {"reputation": 25936, "user_id": 2290059, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/o79to.jpg?s=128&g=1", "display_name": "Yacoub Massad", "link": "https://stackoverflow.com/users/2290059/yacoub-massad"}, "edited": false, "score": 0, "creation_date": 1473277149, "post_id": 39377696, "comment_id": 66083577, "body": "Yes @YacoubMassad"}, {"owner": {"reputation": 775, "user_id": 1111790, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/79dc09d34bc431d6226506aafc873c80?s=128&d=identicon&r=PG", "display_name": "Kixoka", "link": "https://stackoverflow.com/users/1111790/kixoka"}, "edited": false, "score": 0, "creation_date": 1473277159, "post_id": 39377696, "comment_id": 66083589, "body": "There doesn&#39;t appear to be a difference.  I tested this in Linqpad and got the same results across the 3 methods."}], "answers": [{"tags": [], "owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1473277207, "creation_date": 1473277207, "answer_id": 39377847, "question_id": 39377696, "link": "https://stackoverflow.com/questions/39377696/difference-between-several-syntax-of-sum-in-linq/39377847#39377847", "title": "Difference between several syntax of Sum() in Linq", "body": "<p>There are subtle differences between each of the three above approaches, although with how you are currently calling each, they should result in the same amounts.</p>\n\n<p><code>decimal Sum1 = Shops.Sum(x =&gt; x.Amount);</code> uses the <code>Func</code> overload to identify the property being summed for the source collection and is used internally while iterating over the source.</p>\n\n<p><code>decimal Sum2 = Shops.Select(x =&gt; x.Amount).Sum();</code> creates a new <code>IEnumerable&lt;T&gt;</code> projection, which is then passed into the <code>.Sum()</code> extension method and internally iterated and summed.</p>\n\n<p><code>decimal Sum3 = Shops.Select(x =&gt; x).Sum(x =&gt; x.Amount);</code> does nothing other than (potentially) create additional overhead and confusion, since it is identical to the first example, while allowing you to create a new projection along the way.  It is essentially useless in this case.</p>\n"}, {"tags": [], "owner": {"reputation": 76753, "user_id": 1026459, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/pv5mS.png?s=128&g=1", "display_name": "Travis J", "link": "https://stackoverflow.com/users/1026459/travis-j"}, "is_accepted": false, "score": -1, "last_activity_date": 1506705932, "last_edit_date": 1506705932, "creation_date": 1473278463, "answer_id": 39378115, "question_id": 39377696, "link": "https://stackoverflow.com/questions/39377696/difference-between-several-syntax-of-sum-in-linq/39378115#39378115", "title": "Difference between several syntax of Sum() in Linq", "body": "<p>There is no difference in the final sum.</p>\n\n<p>The difference is in the composure of the Expression Tree. These are all similar but do execute differently because the expression tree is being built differently.</p>\n\n<p>LINQ works with deferred execution. In this case, it is deferred until the call to <code>Sum</code>. Deferred execution in general works by enumerating an enumerable. The enumerable being built is different in each case.</p>\n\n<ul>\n<li><p><code>Shops.Sum(x =&gt; x.Amount);</code><br>\nIn this scenario, the Enumerable was already built, it is <code>Shops</code>. The call to <code>Sum</code> enumerates the <code>Shops</code> enumerable and for each element adds the value of <code>x.Amount</code>. This value is then returned.</p></li>\n<li><p><code>Shops.Select(x =&gt; x.Amount).Sum();</code><br>\nIn this scenario, the Enumerable being built is a \"projection\" (<code>Select</code>). The projection is going to only take every <code>Amount</code> from each <code>Shop</code> element. Using <code>Sum</code> on this enumerable iterates through each individual amount and adds it. The value is then returned.</p></li>\n<li><p><code>Shops.Select(x =&gt; x).Sum(x =&gt; x.Amount);</code><br>\nThis scenario may be compiled out. <code>Select(x =&gt; x)</code> doesn't actually produce anything different. So this is more than likely the same as the first scenario.</p></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6313890"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 39377847, "answer_count": 2, "score": 0, "last_activity_date": 1506705932, "creation_date": 1473276547, "question_id": 39377696, "link": "https://stackoverflow.com/questions/39377696/difference-between-several-syntax-of-sum-in-linq", "title": "Difference between several syntax of Sum() in Linq", "body": "<p>What is the difference between these three calls of the method Sum in linq ?</p>\n\n<pre><code>decimal Sum1 = Shops.Sum(x =&gt; x.Amount);\ndecimal Sum2 = Shops.Select(x =&gt; x.Amount).Sum();\ndecimal Sum3 = Shops.Select(x =&gt; x).Sum(x =&gt; x.Amount);\n</code></pre>\n"}, {"tags": ["c#", "visual-studio-2010"], "comments": [{"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 0, "creation_date": 1473275719, "post_id": 39377456, "comment_id": 66082892, "body": "You need to include the namespace it&#39;s under by typing <code>using nameSpace</code>. In visual studio when you create a folder it automatically makes a new namespace for you, and I tend to just change the namespace instead of using the auto-generated one. So I assume your Server.cs and Client.cs says this: <code>namespace YourProjectName.Classes</code> because it&#39;s in Classes &quot;folder&quot;; if so you can just erase the <code>.Classes</code> part so the namespace matches."}, {"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 0, "creation_date": 1473275833, "post_id": 39377456, "comment_id": 66082949, "body": "P.s. &quot;proxy&quot;, &quot;packet&quot;, &quot;packet-sniffers&quot; have nothing to do with your question and neither does your title. Your actual question is, &quot;Why am I getting this error: The type or namespace name &#39;Server&#39; could not be found&quot;."}, {"owner": {"reputation": 1, "user_id": 6209549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d24ef26bba7d4744e6865332cd73d3?s=128&d=identicon&r=PG&f=1", "display_name": "misterdesigner", "link": "https://stackoverflow.com/users/6209549/misterdesigner"}, "reply_to_user": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 0, "creation_date": 1473275850, "post_id": 39377456, "comment_id": 66082962, "body": "Awesome, i cant try this till i&#39;m back at home but i&#39;ll give it a shot. My namespace is called ExampleTcpProxy.Classes , if i take out .Classes it will get rid of that error ?  P.s, i just got rid of those tags, thanks :)"}, {"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 0, "creation_date": 1473284937, "post_id": 39377456, "comment_id": 66086912, "body": "It will get rid of the error if the calling code is also inside of the namespace &quot;ExampleTcpProxy&quot;, if not then erasing &quot;.Classes&quot; will not work. You have three options that I know of: 1) include <code>using ExampleTcpProxy.Classes;</code> at the top of your <i>other source file</i> (the one with <code>Form1_Load</code> in it), 2) <i>assuming</i> your <code>Form1_Load</code> is in the <code>ExampleTcpProxy</code> namespace then just erase &quot;.Classes&quot; like was suggested, or 3) change the call to <code>ExampleTcpProxy.Classes.Server server = new ExampleTcpProxy.Classes.Server();</code>. Also google &quot;c# namespaces&quot; for information (MSDN C# Programming Guide)."}, {"owner": {"reputation": 1, "user_id": 6209549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d24ef26bba7d4744e6865332cd73d3?s=128&d=identicon&r=PG&f=1", "display_name": "misterdesigner", "link": "https://stackoverflow.com/users/6209549/misterdesigner"}, "reply_to_user": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 0, "creation_date": 1473337820, "post_id": 39377456, "comment_id": 66107952, "body": "Thank you for your help, what you suggested and explained has helped and fixed my problem, i really appreciate it :)"}], "owner": {"reputation": 1, "user_id": 6209549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d24ef26bba7d4744e6865332cd73d3?s=128&d=identicon&r=PG&f=1", "display_name": "misterdesigner", "link": "https://stackoverflow.com/users/6209549/misterdesigner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473276067, "creation_date": 1473275425, "last_edit_date": 1473276067, "question_id": 39377456, "link": "https://stackoverflow.com/questions/39377456/creating-packet-editor-proxy", "title": "Creating Packet Editor proxy", "body": "<p>so i am actually working on a side project that would listen to packets but i have ran into a roadblock, this might be a st*pid question or error, but i cant seem to bypass it.</p>\n\n<p>In my main form, i am trying to put my server creation code inside my 'Load' Event.</p>\n\n<p>In my project, i have a Server class and Client class.</p>\n\n<pre><code>private void Form1_Load(object sender, EventArgs e)\n{\n    Server server = new Server();\n    server.RemoteAddress = \"your.server.here\";\n    server.RemotePort = 7777;\n\n    server.Start();\n}\n</code></pre>\n\n<p>I am getting an error which states:</p>\n\n<p>\"The type or namespace name 'Server' could not be found.\" does this mean i have referenced it incorrectly ? if so, do i need to include anything ?</p>\n\n<p>within my project, i have a folder created named Classes, inside that folder i have the Server.cs and Client.cs</p>\n\n<p>Any help with this error would be greatly appreciated.</p>\n\n<p>Software: Microsoft Visual Studio 2010 on Windows 7 (Not compatible but works)</p>\n"}, {"tags": ["c#", "jquery", "asp.net", "listview"], "comments": [{"owner": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "edited": false, "score": 0, "creation_date": 1473705291, "post_id": 39377438, "comment_id": 66234324, "body": "I don&#39;t know how to specify a version of jQuery in the header for the StackOverflow <i>Run code snipped</i> tool, so the posted solution doesn&#39;t work here. See the JsFiddle link for a working demo."}], "answers": [{"comments": [{"owner": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "edited": false, "score": 0, "creation_date": 1473297018, "post_id": 39378250, "comment_id": 66089948, "body": "OK. I came across a tutorial that said to use <code>ClientIDMode=&quot;Static&quot;</code>. It didn&#39;t do everything exactly as I did, though. Let me see what removing that does, and I will report back."}, {"owner": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "edited": false, "score": 0, "creation_date": 1473352044, "post_id": 39378250, "comment_id": 66118017, "body": "I changed <code>$(&#39;.listRow&#39;).click</code> section to <code>$(&#39;[id^=listRow_]&#39;).click</code>, verified the <i>alert()</i> messages, got the <code>rowNumber</code> variable, and set those values to my various &quot;td&quot; fields. When the popup box shows, though, all of the textboxes are still empty. :("}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "reply_to_user": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "edited": false, "score": 0, "creation_date": 1473354732, "post_id": 39378250, "comment_id": 66119352, "body": "Updated my answer. It copies the content to the cell to the textboxes and copy them back when the save button is clicked. Although these new values will not be accessible on postback. You might even get a <code>Invalid postback or callback argument</code> exeption."}, {"owner": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "edited": false, "score": 0, "creation_date": 1473372249, "post_id": 39378250, "comment_id": 66127810, "body": "Beautiful! I will update my question with a Fiddle solution from your help."}], "tags": [], "owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "is_accepted": true, "score": 1, "last_activity_date": 1473354422, "last_edit_date": 1473354422, "creation_date": 1473279091, "answer_id": 39378250, "question_id": 39377438, "link": "https://stackoverflow.com/questions/39377438/how-do-i-read-write-listview-itemtemplate-field-using-jquery/39378250#39378250", "title": "How do I read/write ListView ItemTemplate field using jQuery?", "body": "<p>Here is an example.\nAdd a unique class name and ID to the <code>&lt;tr&gt;</code> by using the row index from the ListView.</p>\n\n<pre><code>&lt;tr id=\"listRow_&lt;%# Container.DataItemIndex %&gt;\" class=\"listRow\"&gt;\n</code></pre>\n\n<p>Then the jQuery can bind the onclick event to the row and loop the <code>&lt;span&gt;</code> elements in the table cells.</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n    $(document).ready(function () {\n        $('.listRow').click(function () {\n            //loop al span elements in the td\n            $(this).find('td span').each(function (index, value) {\n                alert($(value).text());\n            });\n            //or use the row number to do stuff and hardcode the elements\n            var rowNumber = this.id.split(\"_\")[1];\n            var lbl1 = \"mainContentPane_listView1_lblMemberEmail_\" + rowNumber;\n            alert($(\"#\" + lbl1).text());\n        });\n    });\n&lt;/script&gt;\n</code></pre>\n\n<p>The problem is that you are using <code>ClientIDMode=\"Static\"</code>. Normally a ListView (and all other controls that loop data to generate content) will create a unique id per row and control within the row. That looks something like this:\n<code>mainContentPane_listView1_lblMemberName_1</code>.</p>\n\n<p>That is why you are getting the errors when using <code>&lt;%=lnkMemberNumber.ClientID%&gt;</code>. It does not exist outside of the ListView and thus is not accessible, even with a static ClientID.</p>\n\n<p>Also enabling <code>ClientIDMode=\"Static\"</code> in a repeater element will result in multiple ID's that are exactly the same and that is not what you want.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n    //set the rowNumber as global variable\n    var rowNumber;\n\n    $(document).ready(function () {\n        $('.listRow').click(function () {\n            //loop al span elements in the td and fill the textboxes\n            $(this).find('td span').each(function (index, value) {\n                if (index == 0) {\n                    $(\"#tdMember\").val($(value).text());\n                } else if (index == 1) {\n                    $(\"#tdName\").val($(value).text());\n                } else if (index == 2) {\n                    $(\"#tdPhone\").val($(value).text());\n                } else if (index == 3) {\n                    $(\"#tdEmail\").val($(value).text());\n                }\n            });\n            //or use the row number to do stuff and hardcode the elements, but we'll use the rowNumber later\n            rowNumber = this.id.split(\"_\")[1];\n            var lbl1 = \"mainContentPane_listView1_lblMemberEmail_\" + rowNumber;\n            var lbl1Text = $(\"#\" + lbl1).text();\n        });\n\n        $('#tdSave').click(function () {\n            $('div.popup_hider').fadeOut(\"slow\");\n            $('div.popup_box').fadeOut(\"slow\");\n\n            //and now we do the reverse, find the row ID with listRow_ + rowNumber and update the values in the cell\n            $('#listRow_' + rowNumber).find('td span').each(function (index, value) {\n                if (index == 0) {\n                    $(value).text($(\"#tdMember\").val());\n                } else if (index == 1) {\n                    $(value).text($(\"#tdName\").val());\n                } else if (index == 2) {\n                    $(value).text($(\"#tdPhone\").val());\n                } else if (index == 3) {\n                    $(value).text($(\"#tdEmail\").val());\n                }\n            });\n        });\n    });\n&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 24508, "user_id": 153923, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/804ed3e25812ea0309fd07bc42bf09c2?s=128&d=identicon&r=PG", "display_name": "jp2code", "link": "https://stackoverflow.com/users/153923/jp2code"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1207, "favorite_count": 1, "accepted_answer_id": 39378250, "answer_count": 1, "score": 0, "last_activity_date": 1473691410, "creation_date": 1473275357, "last_edit_date": 1473691410, "question_id": 39377438, "link": "https://stackoverflow.com/questions/39377438/how-do-i-read-write-listview-itemtemplate-field-using-jquery", "title": "How do I read/write ListView ItemTemplate field using jQuery?", "body": "<p>I have been struggling with this, so I put together a stripped down version to show the problems I am having.</p>\n\n<p>Start with a generic class like the <strong>Member</strong> class shown below:</p>\n\n<pre><code>public class Member\n{\n\n    public Member()\n    {\n        Number = String.Empty;\n        Name = String.Empty;\n        Email = String.Empty;\n        Phone = String.Empty;\n    }\n    public String Number { get; set; }\n    public String Name { get; set; }\n    public String Email { get; set; }\n    public String Phone { get; set; }\n    public String LinkNumber\n    {\n        get\n        {\n            var result = String.Empty;\n            if (!String.IsNullOrEmpty(Number))\n            {\n                result = String.Format(\"&lt;a class=\\\"showpopup\\\" id=\\\"{0}\\\"&gt;{0}&lt;/a&gt;\", Number);\n            }\n            return result;\n        }\n    }\n\n}\n</code></pre>\n\n<p>I want to display that in an ASP.NET Framework 4.6 WebForm using a <a href=\"https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.aspx\" rel=\"nofollow\">ListView</a> control.</p>\n\n<p>ASIDE:<br>\nIs there a JSFiddle tool that works with ASP.NET? I can't get the ASP.NET to render there, so I post the HTML here, in sections.</p>\n\n<p>In the <strong>HEAD</strong> of the document, I have some simple javascript and CSS:</p>\n\n<pre><code>&lt;script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-2.2.4.js\"&gt;&lt;/script&gt;\n&lt;script&gt;\n    $(document).ready(function () {\n        $('div.popup_hider').hide();\n        $('div.popup_box').hide();\n        //on click hide the message and the\n        //on click show the hider div and the message\n        $('.showpopup').click(function () {\n            $('div.popup_hider').fadeIn(\"slow\");\n            $('div.popup_box').fadeIn(\"slow\");\n            $('tdMember').val($('#&lt;%=lnkMemberNumber.ClientID%&gt;').val());\n            $('tdName').val($('#&lt;%=lnkMemberName.ClientID%&gt;').val());\n            $('tdPhone').val($('#&lt;%=lnkMemberPhone.ClientID%&gt;').val());\n            $('tdEmail').val($('#&lt;%=lnkMemberEmail.ClientID%&gt;').val());\n        });\n        $('#tdCancel').click(function () {\n            $('div.popup_hider').fadeOut(\"slow\");\n            $('div.popup_box').fadeOut(\"slow\");\n        });\n        $('#tdSave').click(function () {\n            $('div.popup_hider').fadeOut(\"slow\");\n            $('div.popup_box').fadeOut(\"slow\");\n            $('lnkMemberNumber').val($('tdMember').val());\n            $('lnkMemberName').val($('tdName').val());\n            $('lnkMemberPhone').val($('tdPhone').val());\n            $('lnkMemberEmail').val($('tdEmail').val());\n        });\n    });\n&lt;/script&gt;\n&lt;style&gt;\n    div.popup_box {\n        background-color: #888888;\n        display: table;\n        filter: alpha(opacity=100);\n        border: 1px solid #999999;\n        margin: auto; \n        opacity: 1;\n        position: fixed;\n        z-index: 11;\n        -moz-opacity: 1;\n    }\n    div.popup_hider {\n        background-color: #004392;\n        filter: alpha(opacity=55);\n        height: 100%;\n        left: 0px;\n        opacity: .55;\n        position: fixed;\n        top: 0px;\n        width: 100%;\n        z-index: 10;\n        -moz-opacity:.55;\n    }\n&lt;/style&gt;\n</code></pre>\n\n<p>The controls referenced above are defined in the HTML below:</p>\n\n<pre><code>&lt;body&gt;\n    &lt;form id=\"form1\" runat=\"server\"&gt;\n    &lt;div&gt;\n        &lt;div class=\"popup_hider\"&gt;&lt;/div&gt;\n        &lt;div class=\"popup_box\"&gt;\n            &lt;table&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;Member:&lt;br /&gt;&lt;input type=\"text\" id=\"tdMember\" /&gt;&lt;/td&gt;\n                    &lt;td&gt;Name&lt;br /&gt;&lt;input type=\"text\" id=\"tdName\" /&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;Phone:&lt;br /&gt;&lt;input type=\"tel\" id=\"tdPhone\" /&gt;&lt;/td&gt;\n                    &lt;td&gt;Email:&lt;br /&gt;&lt;input type=\"email\" id=\"tdEmail\" /&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;&lt;a id=\"tdSave\"&gt;Save&lt;/a&gt;&lt;/td&gt;\n                    &lt;td&gt;&lt;a id=\"tdCancel\"&gt;Cancel&lt;/a&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n            &lt;/table&gt;\n        &lt;/div&gt;\n        &lt;asp:ListView ID=\"listView1\" runat=\"server\"&gt;\n            &lt;LayoutTemplate&gt;\n                &lt;table border=\"1\"&gt;\n                    &lt;tr&gt;\n                        &lt;th&gt;&lt;asp:LinkButton runat=\"server\" ID=\"lnkMemberNumber\"&gt;Member&lt;/asp:LinkButton&gt;&lt;/th&gt;\n                        &lt;th&gt;&lt;asp:LinkButton runat=\"server\" ID=\"lnkMemberName\"&gt;Name&lt;/asp:LinkButton&gt;&lt;/th&gt;\n                        &lt;th&gt;&lt;asp:LinkButton runat=\"server\" ID=\"lnkMemberPhone\"&gt;Phone&lt;/asp:LinkButton&gt;&lt;/th&gt;\n                        &lt;th&gt;&lt;asp:LinkButton runat=\"server\" ID=\"lnkMemberEmail\"&gt;Email&lt;/asp:LinkButton&gt;&lt;/th&gt;\n                    &lt;/tr&gt;\n                    &lt;tr id=\"itemPlaceholder\" runat=\"server\" class=\"listview\"&gt;&lt;/tr&gt;\n                &lt;/table&gt;\n            &lt;/LayoutTemplate&gt;\n            &lt;ItemTemplate&gt;\n                &lt;tr&gt;\n                    &lt;td&gt;&lt;asp:Label runat=\"server\" ClientIDMode=\"Static\" ID=\"lblMemberNumber\"&gt;&lt;%#Eval(\"LinkNumber\") %&gt;&lt;/asp:Label&gt;&lt;/td&gt;\n                    &lt;td&gt;&lt;asp:Label runat=\"server\" ClientIDMode=\"Static\" ID=\"lblMemberName\"&gt;&lt;%#Eval(\"Name\") %&gt;&lt;/asp:Label&gt;&lt;/td&gt;\n                    &lt;td&gt;&lt;asp:Label runat=\"server\" ClientIDMode=\"Static\" ID=\"lblMemberPhone\"&gt;&lt;%#Eval(\"Phone\") %&gt;&lt;/asp:Label&gt;&lt;/td&gt;\n                    &lt;td&gt;&lt;asp:Label runat=\"server\" ClientIDMode=\"Static\" ID=\"lblMemberEmail\"&gt;&lt;%#Eval(\"Email\") %&gt;&lt;/asp:Label&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n            &lt;/ItemTemplate&gt;\n        &lt;/asp:ListView&gt;\n    &lt;/div&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>That is how every page I see shows how to access ASP.NET controls with jQuery; however, the ASP.NET controls referenced in the head section are part of the <strong>ItemTemplate</strong>, so are not actually visible inside the HTML:</p>\n\n<pre><code>$('tdMember').val($('#&lt;%=lnkMemberNumber.ClientID%&gt;').val());\n$('tdName').val($('#&lt;%=lnkMemberName.ClientID%&gt;').val());\n$('tdPhone').val($('#&lt;%=lnkMemberPhone.ClientID%&gt;').val());\n$('tdEmail').val($('#&lt;%=lblEmail.ClientID%&gt;').val());\n</code></pre>\n\n<p>If you put that into a Visual Studio 2015 project, you will see Red Squiggly lines that read:</p>\n\n<blockquote>\n  <p>The name 'xxx' does not exist in the current context</p>\n</blockquote>\n\n<p>You get a <strong>Compilation Error</strong> with the same message if you try running it.</p>\n\n<p>So, how can I read (and eventually write) values from a <a href=\"https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.itemtemplate.aspx\" rel=\"nofollow\">ListView ItemTemplate</a> control to HTML using jQuery?</p>\n\n<p>To make this simple, I populated static data in the Page_Load event:</p>\n\n<pre><code>private List&lt;Member&gt; _roster;\n\nprotected void Page_Load(object sender, EventArgs e)\n{\n    if (!IsPostBack)\n    {\n        if (_roster == null)\n        {\n            _roster = new List&lt;Member&gt;();\n            _roster.Add(new Member() { Name = \"John Doe\", Number = \"ABC123\", Email = \"jdoe@email.com\", Phone = \"5551234\" });\n            _roster.Add(new Member() { Name = \"Jane Doe\", Number = \"ABC124\", Email = \"janed@email.com\", Phone = \"5551111\" });\n            _roster.Add(new Member() { Name = \"Jenny\", Number = \"ABC1233\", Email = \"jenny@hotmail.com\", Phone = \"8675309\" });\n        }\n        listView1.DataSource = _roster;\n        listView1.DataBind();\n    }\n}\n</code></pre>\n\n<h2>Solved!</h2>\n\n<p><a href=\"https://jsfiddle.net/jp2code/z7tpuagf/\" rel=\"nofollow\">https://jsfiddle.net/jp2code/z7tpuagf/</a></p>\n\n<p>This should be a working example below. It does not have any ASP.NET in it, but it is what Visual Studio will compile the ASP.NET controls down to.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var rowNumber;\r\n$(document).ready(function () {\r\n    $('div.popup_hider').hide();\r\n    $('div.popup_box').hide();\r\n    $('[id^=listRow_]').click(function () {\r\n        //loop al span elements in the td and fill the textboxes\r\n        $(this).find('td span').each(function (index, value) {\r\n            if (index == 0) {\r\n                $(\"#tdMember\").val($(value).text());\r\n            } else if (index == 1) {\r\n                $(\"#tdName\").val($(value).text());\r\n            } else if (index == 2) {\r\n                $(\"#tdPhone\").val($(value).text());\r\n            } else if (index == 3) {\r\n                $(\"#tdEmail\").val($(value).text());\r\n            }\r\n        });\r\n        // get row number to hardcode the elements\r\n        rowNumber = this.id.split(\"_\")[1];\r\n    });\r\n    //on click hide the message and the\r\n    //on click show the hider div and the message\r\n    $('.showpopup').click(function () {\r\n        $('div.popup_hider').fadeIn(\"slow\");\r\n        $('div.popup_box').fadeIn(\"slow\");\r\n    });\r\n    $('#tdCancel').click(function () {\r\n        $('div.popup_hider').fadeOut(\"slow\");\r\n        $('div.popup_box').fadeOut(\"slow\");\r\n    });\r\n    $('#tdSave').click(function () {\r\n        $('div.popup_hider').fadeOut(\"slow\");\r\n        $('div.popup_box').fadeOut(\"slow\");\r\n        //and now we do the reverse, find the row ID with listRow_ + rowNumber and update the values in the cell\r\n        $('#listRow_' + rowNumber).find('td span').each(function (index, value) {\r\n            if (index == 0) {\r\n                $(value).text($(\"#tdMember\").val());\r\n            } else if (index == 1) {\r\n                $(value).text($(\"#tdName\").val());\r\n            } else if (index == 2) {\r\n                $(value).text($(\"#tdPhone\").val());\r\n            } else if (index == 3) {\r\n                $(value).text($(\"#tdEmail\").val());\r\n            }\r\n        });\r\n    });\r\n});</code></pre>\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>a.fake-link {\r\n  text-decoration: underline;\r\n  cursor: pointer;\r\n}\r\ndiv.popup_box {\r\n  background-color: #888888;\r\n  display: table;\r\n  filter: alpha(opacity=100);\r\n  border: 1px solid #999999;\r\n  margin: auto; \r\n  opacity: 1;\r\n  position: fixed;\r\n  z-index: 11;\r\n  -moz-opacity: 1;\r\n}\r\ndiv.popup_hider {\r\n  background-color: #004392;\r\n  filter: alpha(opacity=55);\r\n  height: 100%;\r\n  left: 0px;\r\n  opacity: .55;\r\n  position: fixed;\r\n  top: 0px;\r\n  width: 100%;\r\n  z-index: 10;\r\n  -moz-opacity:.55;\r\n}</code></pre>\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div&gt;\r\n  &lt;div class=\"popup_hider\" style=\"display: none;\"&gt;&lt;/div&gt;\r\n  &lt;div class=\"popup_box\" style=\"display: none;\"&gt;\r\n    &lt;table&gt;\r\n      &lt;tbody&gt;&lt;tr&gt;\r\n        &lt;td&gt;Member:&lt;br&gt;&lt;input type=\"text\" id=\"tdMember\"&gt;&lt;/td&gt;\r\n        &lt;td&gt;Name&lt;br&gt;&lt;input type=\"text\" id=\"tdName\"&gt;&lt;/td&gt;\r\n      &lt;/tr&gt;\r\n      &lt;tr&gt;\r\n        &lt;td&gt;Phone:&lt;br&gt;&lt;input type=\"tel\" id=\"tdPhone\"&gt;&lt;/td&gt;\r\n        &lt;td&gt;Email:&lt;br&gt;&lt;input type=\"email\" id=\"tdEmail\"&gt;&lt;/td&gt;\r\n      &lt;/tr&gt;\r\n      &lt;tr&gt;\r\n        &lt;td&gt;&lt;a id=\"tdSave\" class=\"fake-link\"&gt;Save&lt;/a&gt;&lt;/td&gt;\r\n        &lt;td&gt;&lt;a id=\"tdCancel\" class=\"fake-link\"&gt;Cancel&lt;/a&gt;&lt;/td&gt;\r\n      &lt;/tr&gt;\r\n    &lt;/tbody&gt;&lt;/table&gt;\r\n  &lt;/div&gt;\r\n  &lt;table border=\"1\"&gt;\r\n    &lt;tbody&gt;&lt;tr&gt;\r\n      &lt;th&gt;&lt;a id=\"listView1_lnkMemberNumber\" href=\"javascript:__doPostBack('listView1$lnkMemberNumber','')\"&gt;Member&lt;/a&gt;&lt;/th&gt;\r\n      &lt;th&gt;&lt;a id=\"listView1_lnkMemberName\" href=\"javascript:__doPostBack('listView1$lnkMemberName','')\"&gt;Name&lt;/a&gt;&lt;/th&gt;\r\n      &lt;th&gt;&lt;a id=\"listView1_lnkMemberPhone\" href=\"javascript:__doPostBack('listView1$lnkMemberPhone','')\"&gt;Phone&lt;/a&gt;&lt;/th&gt;\r\n      &lt;th&gt;&lt;a id=\"listView1_lnkMemberEmail\" href=\"javascript:__doPostBack('listView1$lnkMemberEmail','')\"&gt;Email&lt;/a&gt;&lt;/th&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr id=\"listRow_0\" class=\"listRow\"&gt;\r\n      &lt;td&gt;&lt;a class=\"fake-link\"&gt;&lt;span id=\"listView1_lblMemberNumber_0\" class=\"showpopup\"&gt;ABC123&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\r\n      &lt;td&gt;&lt;span id=\"listView1_lblMemberName_0\"&gt;John Doe&lt;/span&gt;&lt;/td&gt;\r\n      &lt;td&gt;&lt;span id=\"listView1_lblMemberPhone_0\"&gt;5551234&lt;/span&gt;&lt;/td&gt;\r\n      &lt;td&gt;&lt;span id=\"listView1_lblMemberEmail_0\"&gt;jdoe@email.com&lt;/span&gt;&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr id=\"listRow_1\" class=\"listRow\"&gt;\r\n      &lt;td&gt;&lt;a class=\"fake-link\"&gt;&lt;span id=\"listView1_lblMemberNumber_1\" class=\"showpopup\"&gt;ABC124&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\r\n      &lt;td&gt;&lt;span id=\"listView1_lblMemberName_1\"&gt;Jane Doe&lt;/span&gt;&lt;/td&gt;\r\n      &lt;td&gt;&lt;span id=\"listView1_lblMemberPhone_1\"&gt;5551111&lt;/span&gt;&lt;/td&gt;\r\n      &lt;td&gt;&lt;span id=\"listView1_lblMemberEmail_1\"&gt;janed@email.com&lt;/span&gt;&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr id=\"listRow_2\" class=\"listRow\"&gt;\r\n      &lt;td&gt;&lt;a class=\"fake-link\"&gt;&lt;span id=\"listView1_lblMemberNumber_2\" class=\"showpopup\"&gt;ABC321&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\r\n      &lt;td&gt;&lt;span id=\"listView1_lblMemberName_2\"&gt;Jenny&lt;/span&gt;&lt;/td&gt;\r\n      &lt;td&gt;&lt;span id=\"listView1_lblMemberPhone_2\"&gt;8675309&lt;/span&gt;&lt;/td&gt;\r\n      &lt;td&gt;&lt;span id=\"listView1_lblMemberEmail_2\"&gt;jenny@hotmail.com&lt;/span&gt;&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n  &lt;/tbody&gt;&lt;/table&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 2081, "user_id": 3598949, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/oGJ7j.jpg?s=128&g=1", "display_name": "Saadi", "link": "https://stackoverflow.com/users/3598949/saadi"}, "edited": false, "score": 0, "creation_date": 1473275989, "post_id": 39377344, "comment_id": 66083023, "body": "Are you using asp.net default identity database?"}, {"owner": {"reputation": 135, "user_id": 5468938, "user_type": "registered", "accept_rate": 16, "profile_image": "https://graph.facebook.com/10206737589312137/picture?type=large", "display_name": "Tom ", "link": "https://stackoverflow.com/users/5468938/tom"}, "reply_to_user": {"reputation": 2081, "user_id": 3598949, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/oGJ7j.jpg?s=128&g=1", "display_name": "Saadi", "link": "https://stackoverflow.com/users/3598949/saadi"}, "edited": false, "score": 0, "creation_date": 1473278450, "post_id": 39377344, "comment_id": 66084150, "body": "Yes using Identity database"}, {"owner": {"reputation": 1714, "user_id": 1444831, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c04c206740e360b005ef872f0a37c88f?s=128&d=identicon&r=PG", "display_name": "The Jonas Persson", "link": "https://stackoverflow.com/users/1444831/the-jonas-persson"}, "edited": false, "score": 1, "creation_date": 1473279801, "post_id": 39377344, "comment_id": 66084772, "body": "Try Roles.GetRolesForUser();"}], "owner": {"reputation": 135, "user_id": 5468938, "user_type": "registered", "accept_rate": 16, "profile_image": "https://graph.facebook.com/10206737589312137/picture?type=large", "display_name": "Tom ", "link": "https://stackoverflow.com/users/5468938/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473278976, "creation_date": 1473274835, "last_edit_date": 1473278976, "question_id": 39377344, "link": "https://stackoverflow.com/questions/39377344/find-user-role-identity-framework", "title": "Find user role - Identity framework", "body": "<p>how do you find user role within the Master page?\nI have tried the following;</p>\n\n<pre><code>        var user = Session[\"UserRole\"];     \n\n        if (user.role.Any(u =&gt; admin.Contains(u.Role.Name)))\n        {\n            Response.Redirect(\"~/Admin/Admin.aspx\");\n        }\n</code></pre>\n\n<p>I'm trying to find user role within the Master page, but I cannot set the properties</p>\n\n<p>i.e. Model.AspNetRole userrole { get; set; }</p>\n\n<p>Recieving error \"The name get does not exist in current context\"</p>\n\n<p>Full code below, is this the best way to find user role? </p>\n\n<pre><code> public void RedirectClickCall(object sender, EventArgs e)\n    {\n        Model.AspNetRole userrole { get; set; }\n\n        string loginID = HttpContext.Current.User.Identity.GetUserId();\n\n        using ( dbcontext = new ())\n        {\n\n            userrole = (from r in dbcontext.AspNetRoles\n\n                        where r == loginID\n\n                        select r).FirstOrDefault();         \n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "csv"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 3, "creation_date": 1473274887, "post_id": 39377324, "comment_id": 66082483, "body": "What&#39;s on the line with the extra comma? If it&#39;s not quoting fields properly, then <code>Fred Smith, Jr.</code> will be TWO cells in the csv, not one."}, {"owner": {"reputation": 71, "user_id": 6806112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34bf19191ce5d4edb6ba86e71b645c7d?s=128&d=identicon&r=PG&f=1", "display_name": "jimjim", "link": "https://stackoverflow.com/users/6806112/jimjim"}, "reply_to_user": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1473275621, "post_id": 39377324, "comment_id": 66082840, "body": "@MarcB I checked that. But there is no data in the extra column, so I don&#39;t think it&#39;s that."}, {"owner": {"reputation": 422, "user_id": 2002869, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c32d3828f0d333b487b3cfaa5e01772f?s=128&d=identicon&r=PG", "display_name": "Ashutosh Vyas", "link": "https://stackoverflow.com/users/2002869/ashutosh-vyas"}, "edited": false, "score": 0, "creation_date": 1473275670, "post_id": 39377324, "comment_id": 66082864, "body": "Open your csv in any text editor to make sure that the row does not end with a COMMA"}, {"owner": {"reputation": 5909, "user_id": 3562271, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5522cf83767d944faddd6b36c1de179f?s=128&d=identicon&r=PG&f=1", "display_name": "PhillipH", "link": "https://stackoverflow.com/users/3562271/philliph"}, "edited": false, "score": 0, "creation_date": 1473275893, "post_id": 39377324, "comment_id": 66082984, "body": "Can you show the output you get."}, {"owner": {"reputation": 71, "user_id": 6806112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34bf19191ce5d4edb6ba86e71b645c7d?s=128&d=identicon&r=PG&f=1", "display_name": "jimjim", "link": "https://stackoverflow.com/users/6806112/jimjim"}, "reply_to_user": {"reputation": 422, "user_id": 2002869, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c32d3828f0d333b487b3cfaa5e01772f?s=128&d=identicon&r=PG", "display_name": "Ashutosh Vyas", "link": "https://stackoverflow.com/users/2002869/ashutosh-vyas"}, "edited": false, "score": 0, "creation_date": 1473276286, "post_id": 39377324, "comment_id": 66083171, "body": "@AshutoshVyas That was it. I guess I never noticed that in the other CSV files."}, {"owner": {"reputation": 15541, "user_id": 526724, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5fafcd128fb9ba805b41d8770c0345cc?s=128&d=identicon&r=PG", "display_name": "Bradley Uffner", "link": "https://stackoverflow.com/users/526724/bradley-uffner"}, "edited": false, "score": 0, "creation_date": 1473277859, "post_id": 39377324, "comment_id": 66083887, "body": "Have you considered wrapping your fields in quotes?  That should allow for embedded commas, you just need to escape any quotes you actually need in the output."}, {"owner": {"reputation": 71, "user_id": 6806112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34bf19191ce5d4edb6ba86e71b645c7d?s=128&d=identicon&r=PG&f=1", "display_name": "jimjim", "link": "https://stackoverflow.com/users/6806112/jimjim"}, "reply_to_user": {"reputation": 15541, "user_id": 526724, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5fafcd128fb9ba805b41d8770c0345cc?s=128&d=identicon&r=PG", "display_name": "Bradley Uffner", "link": "https://stackoverflow.com/users/526724/bradley-uffner"}, "edited": false, "score": 0, "creation_date": 1473278907, "post_id": 39377324, "comment_id": 66084382, "body": "@BradleyUffner The fields are already wrapped in quotes. I don&#39;t think embedded commas is the problem, because the last column has no data in it, which I noticed when I opened it in Excel and when I opened it in a text editor."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6806112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34bf19191ce5d4edb6ba86e71b645c7d?s=128&d=identicon&r=PG&f=1", "display_name": "jimjim", "link": "https://stackoverflow.com/users/6806112/jimjim"}, "edited": false, "score": 0, "creation_date": 1473360839, "post_id": 39381527, "comment_id": 66122481, "body": "Just for further info, I have tested this on about 200 CSVs I was having problems with and it worked. I decided to write a Python script, since I&#39;m more familiar with that language to remove commas that proceeded the return <code>\\r</code> characters at the end of every line. Works like a charm. If anyone is willing to share a script that does the same thing in C#, I would be very grateful."}], "tags": [], "owner": {"reputation": 422, "user_id": 2002869, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c32d3828f0d333b487b3cfaa5e01772f?s=128&d=identicon&r=PG", "display_name": "Ashutosh Vyas", "link": "https://stackoverflow.com/users/2002869/ashutosh-vyas"}, "is_accepted": true, "score": 0, "last_activity_date": 1473300457, "creation_date": 1473300457, "answer_id": 39381527, "question_id": 39377324, "link": "https://stackoverflow.com/questions/39377324/how-do-i-prevent-the-addition-of-an-extra-column-when-i-write-a-csv-with-c/39381527#39381527", "title": "How do I prevent the addition of an extra column when I write a CSV with C#?", "body": "<p>I would put the same comment as answer for you to mark it.</p>\n\n<blockquote>\n  <p>Open your csv in any text editor to make sure that the row does not\n  end with a COMMA</p>\n</blockquote>\n"}], "owner": {"reputation": 71, "user_id": 6806112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34bf19191ce5d4edb6ba86e71b645c7d?s=128&d=identicon&r=PG&f=1", "display_name": "jimjim", "link": "https://stackoverflow.com/users/6806112/jimjim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 39381527, "answer_count": 1, "score": 0, "last_activity_date": 1473300457, "creation_date": 1473274771, "last_edit_date": 1473276621, "question_id": 39377324, "link": "https://stackoverflow.com/questions/39377324/how-do-i-prevent-the-addition-of-an-extra-column-when-i-write-a-csv-with-c", "title": "How do I prevent the addition of an extra column when I write a CSV with C#?", "body": "<p>I found and tweaked some C# code to remove embedded double quotes from some CSV files. I don't use C# very much, so I'm not sure why the code is adding an extra column to the original CSV. I'm assuming it has something to do with the WriteAllLines method. I printed out the CSV headings:</p>\n\n<pre><code>Index([u'State', u'Birthdate', u'Never Contact Type', u'Opt In Marketing',\n   u'Pref. Contact Type', u'Individual Source', u'Individual Status',\n   u'Individual Sub Type', u'Individual Type', u'Address 1', u'Address 2',\n   u'City', u'Company', u'County', u'Email Address', u'First Name',\n   u'Last Name', u'Mobile Number', u'Home/Main Number', u'Postal Code',\n   u'Salutation', u'Work Number', u'Assigned To', u'Purchase Date',\n   u'Entity Id', u'Event Id', u'Sales Sub Type', u'Sales Type',\n   u'Sales Source', u'Sales Status', u'Tracking Code',\n   u'DMS Deal/RO Number', u'Deal Date', u'Insert Date', u'Update Date',\n   u'Make', u'Model', u'Series', u'Stock Num', u'Style', u'VIN Number',\n   u'Year', u'Unnamed: 42']\n</code></pre>\n\n<p>As you can see there is a last column that is added when I run this:</p>\n\n<pre><code>static void Main(string[] args)\n{\n    string path = @\"some_filepath\";\n    if (Directory.Exists(path))\n    {\n        string[] files = Directory.GetFiles(path);\n\n\n        foreach(string file in files)\n        {\n            if (file.EndsWith(\".csv\"))\n            {\n                var fileContent = File.ReadAllLines(file);\n                var fileContentUpdated = fileContent.Select(x =&gt; new Regex(@\"(?&lt;!^)(?&lt;!\\,)\"\"(?!\\,)(?!$)\").Replace(x, \"'\")).ToArray();\n                File.WriteAllLines(file, fileContentUpdated);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>How do I prevent this from happening?</p>\n"}, {"tags": ["c#", "asp.net", "webforms"], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 1916528, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/303b0a427abf8f0ab3cdb9a1b2aa54ca?s=128&d=identicon&r=PG", "display_name": "user1916528", "link": "https://stackoverflow.com/users/1916528/user1916528"}, "edited": false, "score": 0, "creation_date": 1473282654, "post_id": 39377276, "comment_id": 66086047, "body": "The issue was caused by a random &lt;/div&gt; tag within the update panel."}, {"owner": {"reputation": 2125, "user_id": 6691061, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1219688551388660/picture?type=large", "display_name": "Shannon Holsinger", "link": "https://stackoverflow.com/users/6691061/shannon-holsinger"}, "reply_to_user": {"reputation": 287, "user_id": 1916528, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/303b0a427abf8f0ab3cdb9a1b2aa54ca?s=128&d=identicon&r=PG", "display_name": "user1916528", "link": "https://stackoverflow.com/users/1916528/user1916528"}, "edited": false, "score": 0, "creation_date": 1473283210, "post_id": 39377276, "comment_id": 66086293, "body": "It&#39;s always something like that, right? You&#39;re welcome - glad to help!"}], "tags": [], "owner": {"reputation": 2125, "user_id": 6691061, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1219688551388660/picture?type=large", "display_name": "Shannon Holsinger", "link": "https://stackoverflow.com/users/6691061/shannon-holsinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1473274585, "creation_date": 1473274585, "answer_id": 39377276, "question_id": 39377244, "link": "https://stackoverflow.com/questions/39377244/how-to-convert-value-in-a-hiddenfield-to-an-integer-in-an-asp-net-c-web-forms-a/39377276#39377276", "title": "How to convert value in a hiddenfield to an integer in an asp.net c# web forms application?", "body": "<p>It looks like your hidden field includes a comma. Either figure out where that's coming from and remove it, or use </p>\n\n<pre><code> new_doc_cmd.Parameters.AddWithValue(\"@venIdFk\", hdn_ven_id.Value.Replace(\",\",\"\"));\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 1916528, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/303b0a427abf8f0ab3cdb9a1b2aa54ca?s=128&d=identicon&r=PG", "display_name": "user1916528", "link": "https://stackoverflow.com/users/1916528/user1916528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1428, "favorite_count": 0, "accepted_answer_id": 39377276, "answer_count": 1, "score": 0, "last_activity_date": 1473282570, "creation_date": 1473274485, "last_edit_date": 1495541303, "question_id": 39377244, "link": "https://stackoverflow.com/questions/39377244/how-to-convert-value-in-a-hiddenfield-to-an-integer-in-an-asp-net-c-web-forms-a", "title": "How to convert value in a hiddenfield to an integer in an asp.net c# web forms application?", "body": "<p>I have a hiddenfield titled hdn_ven_id that is populated with the primary key value (integer) when a row in a grid is selected.</p>\n\n<pre><code>protected void rg_vendors_SelectedIndexChanged(object sender, EventArgs e)\n{\n    foreach (GridDataItem item in rg_vendors.SelectedItems)\n    {\n        hdn_ven_id.Value = item[\"venId\"].Text;                \n    }\n}\n</code></pre>\n\n<p>Then I use the value from hdn_ven_id to populate @venIdFk in a SqlCommand.</p>\n\n<pre><code>protected void newDocUpldBtn_Click(object sender, EventArgs e)\n{ ...\n    new_doc_cmd.Parameters.AddWithValue(\"@venIdFk\", hdn_ven_id.Value);\n...}\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>Conversion failed when converting the nvarchar value '81,' to data type int.</p>\n</blockquote>\n\n<p>81 is the correct primary key value, so I know that the correct value is being captured by the hidden field.</p>\n\n<p>I have reviewed several threads like this one (<a href=\"https://stackoverflow.com/questions/12720665/can-not-convert-hiddenfield-to-int32\">Convert HiddenField to Integer</a>) on how to convert the value of the hiddenfield from an nvarchar to an integer.  However,  I can't get the value of the hidden field to go into the database.  If I add </p>\n\n<blockquote>\n  <p>int venidfk = int.Parse(hdn_ven_id.Value);</p>\n</blockquote>\n\n<p>to newDocUpldBtn_Click I get the error \"Input string was not in a correct format\". </p>\n\n<p>How can I convert the hiddenfield value to an integer?</p>\n\n<p>Here is all of newDocUpldBtn_Click:</p>\n\n<pre><code>protected void newDocUpldBtn_Click(object sender, EventArgs e)\n{\n    int venidfk = int.Parse(hdn_ven_id.Value);\n\n    //Save the file to the server and set the full path\n    int i = 0;\n    FileUpload fu = docFU;\n    string filename = fu.FileName;\n    string fnnnoext = System.IO.Path.GetFileNameWithoutExtension(fu.FileName);\n    string fnnextonly = System.IO.Path.GetExtension(fu.FileName);\n\n    if (fu.HasFile)\n    {\n        while (System.IO.File.Exists(Server.MapPath(\"~/Data/\") + filename))\n        {\n            i++;\n            filename = (fnnnoext + \"(\" + i.ToString() + \")\" + fnnextonly);\n        }\n        fu.PostedFile.SaveAs(Server.MapPath(\"~/Data/\") + filename);\n\n        hdn_doc_path.Value = (Server.MapPath(\"~/Data/\") + filename);\n        hdn_doc_path_no_ext.Value = (fnnnoext + \"(\" + i.ToString() + \")\" + fnnextonly);                \n\n        SqlConnection drap_cnxn = new SqlConnection(\"Data Source=WDBSVCPRD01\\\\SVCDB;Initial Catalog=drap;Integrated Security=True\");\n        {\n            SqlCommand new_doc_cmd = new SqlCommand(\"Insert Into docs(docTitle, docType, docContractType, docOrg, docDept, docDesc, PriorContCd, LegCompContId, docUpldDt, docPath, docStat, venIdFk) Values(LTRIM(RTRIM(@docTitle)), LTRIM(RTRIM(@docType)), LTRIM(RTRIM(@docContractType)), LTRIM(RTRIM(@docOrg)), LTRIM(RTRIM(@docDept)), LTRIM(RTRIM(@docDesc)), LTRIM(RTRIM(@PriorContCd)), LTRIM(RTRIM(@LegCompContId)), LTRIM(RTRIM(@docUpldDt)), LTRIM(RTRIM(@docPath)), LTRIM(RTRIM(@docStat)), LTRIM(RTRIM(@venIdFk)))\", drap_cnxn);\n            new_doc_cmd.Parameters.AddWithValue(\"@docTitle\", docTitleTextBox.Text);\n            new_doc_cmd.Parameters.AddWithValue(\"@docType\", docTypeDdl.SelectedValue);\n            new_doc_cmd.Parameters.AddWithValue(\"@docContractType\", docContractTypeDdl.SelectedValue);\n            new_doc_cmd.Parameters.AddWithValue(\"@docOrg\", docOrgDdl.SelectedValue);\n            new_doc_cmd.Parameters.AddWithValue(\"@docDept\", docDeptDdl.SelectedValue);\n            new_doc_cmd.Parameters.AddWithValue(\"@docDesc\", docDescTextBox.Text);\n            new_doc_cmd.Parameters.AddWithValue(\"@PriorContCd\", priorContCdTextBox.Text);\n            new_doc_cmd.Parameters.AddWithValue(\"@LegCompContId\", legCompContIdTextBox.Text);\n            new_doc_cmd.Parameters.AddWithValue(\"@docUpldDt\", DateTime.Now.ToString());\n            new_doc_cmd.Parameters.AddWithValue(\"@docPath\", hdn_doc_path.Value);\n            new_doc_cmd.Parameters.AddWithValue(\"@docStat\", \"4\");\n            new_doc_cmd.Parameters.AddWithValue(\"@venIdFk\", venidfk);\n\n            drap_cnxn.Open();\n            new_doc_cmd.ExecuteNonQuery();\n            drap_cnxn.Close();\n\n            if (IsPostBack)\n            {\n                ven_doc_det_upld_status_lbl.Text = \"Your document was successfully uploaded.\";\n\n                docTitleTextBox.Text = \"\";\n                docTypeDdl.Text = \"\";\n                docContractTypeDdl.SelectedValue = \"\";\n                docOrgDdl.Text = \"\";\n                docDeptDdl.Text = \"\";\n                docDescTextBox.Text = \"\";\n                priorContCdTextBox.Text = \"\";\n                legCompContIdTextBox.Text = \"\";\n                hdn_doc_path.Value = \"\";\n\n                rg_vendors.DataBind();\n                fv_ven_docs.DataBind();\n\n            }\n            else\n            {\n                ven_doc_upld_fail_lbl.Text = \"Your document failed to upload.  Please contact Compliance for assistance.\";\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "arrays", "dll", "struct", "marshalling"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 3, "creation_date": 1473274571, "post_id": 39377215, "comment_id": 66082342, "body": "Add <code>In(), Out()</code> to the marshaling attributes? Also I don&#39;t think you need the <code>ArraySubType</code> and <code>SizeConst</code>."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1473274747, "post_id": 39377215, "comment_id": 66082422, "body": "We can&#39;t see what MyDataStruct looks like and the [MarshalAs] attribute doesn&#39;t do anything interesting.  Nobody ever got fired for being explicit in their declarations, use int GetData([In, Out] MyDataStruct[] data); so the pinvoke marshaller knows that it always has to copy the data back."}, {"owner": {"reputation": 97, "user_id": 5265160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c26bf4672e8ad61f82a96d43b646d3?s=128&d=identicon&r=PG&f=1", "display_name": "user5265160", "link": "https://stackoverflow.com/users/5265160/user5265160"}, "edited": false, "score": 0, "creation_date": 1473275458, "post_id": 39377215, "comment_id": 66082758, "body": "That works like a charm. Thanks very much."}], "owner": {"reputation": 97, "user_id": 5265160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c26bf4672e8ad61f82a96d43b646d3?s=128&d=identicon&r=PG&f=1", "display_name": "user5265160", "link": "https://stackoverflow.com/users/5265160/user5265160"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473274373, "creation_date": 1473274373, "question_id": 39377215, "link": "https://stackoverflow.com/questions/39377215/c-marshal-array-of-structs-to-function-in-c-dll-as-output-parameter", "title": "C# marshal array of structs to function in c dll as output parameter", "body": "<p>I would like to call a function in a c dll, from my c# application, which takes a fixed array of structs as a function argument, and modifies the data.</p>\n\n<pre><code>[DllImport(\"my_c_program.dll\",  CallingConvention=CallingConvention.Cdecl)]\npublic static extern int GetData([MarshalAs(UnmanagedType.LPArray,\n                                            ArraySubType = UnmanagedType.Struct,\n                                            SizeConst=4)]\n                                 MyDataStruct[] myData);\n</code></pre>\n\n<p>I make a call to the function</p>\n\n<pre><code>   MyDataStruct [] myDataArrayOfStructs = new MyDataStruct[4];\n   GetRangingMeasurementData(myDataArrayOfStructs);\n</code></pre>\n\n<p>And can confirm that the function receives the array and modifies the data, however, following completion of the function, the returned array is unchanged.</p>\n\n<p>Can someone please advise what I am doing wrong.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "sql-server", "stored-procedures", "datagridview", "sqlcommandbuilder"], "comments": [{"owner": {"reputation": 3190, "user_id": 2169261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e017d83ccdbfe78e3e9b9a30f944ead5?s=128&d=identicon&r=PG", "display_name": "techspider", "link": "https://stackoverflow.com/users/2169261/techspider"}, "edited": false, "score": 0, "creation_date": 1473276153, "post_id": 39377206, "comment_id": 66083110, "body": "what do you mean by &quot;happen same&quot;?"}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1473279289, "post_id": 39377206, "comment_id": 66084547, "body": "Yes, research SqlDataAdapter on MSDN. There are examples."}, {"owner": {"reputation": 681, "user_id": 5686960, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8ed1f6bfa4e7ecb17577af34fad4c0dc?s=128&d=identicon&r=PG&f=1", "display_name": "Luke", "link": "https://stackoverflow.com/users/5686960/luke"}, "edited": false, "score": 0, "creation_date": 1473318132, "post_id": 39377206, "comment_id": 66096019, "body": "Do some research on SqlDataAdapter and TableAdapters. I haven&#39;t used Tableadapters yet, but I know you can save changes in a DataTable to the database."}, {"owner": {"reputation": 3, "user_id": 5051208, "user_type": "registered", "profile_image": "https://graph.facebook.com/996609543704806/picture?type=large", "display_name": "Ahmed Ramadan", "link": "https://stackoverflow.com/users/5051208/ahmed-ramadan"}, "edited": false, "score": 0, "creation_date": 1473319727, "post_id": 39377206, "comment_id": 66096931, "body": "i mean i want to call method which us stored procedure to insert/ update/delete  data in database and send cells of gridview as parameteres so not by using commandbulider and da update dataset  .."}, {"owner": {"reputation": 9401, "user_id": 276469, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rbsdG.png?s=128&g=1", "display_name": "Crowcoder", "link": "https://stackoverflow.com/users/276469/crowcoder"}, "edited": false, "score": 0, "creation_date": 1473337245, "post_id": 39377206, "comment_id": 66107543, "body": "You don&#39;t have to use CommandBuilder with DataAdapters, in fact, I would recommend they never be used. You can set your own insert, update, delete, select commands that use stored procedures. So go to MSDN and read about it."}], "owner": {"reputation": 3, "user_id": 5051208, "user_type": "registered", "profile_image": "https://graph.facebook.com/996609543704806/picture?type=large", "display_name": "Ahmed Ramadan", "link": "https://stackoverflow.com/users/5051208/ahmed-ramadan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473536617, "creation_date": 1473274339, "last_edit_date": 1473536617, "question_id": 39377206, "link": "https://stackoverflow.com/questions/39377206/could-i-use-stored-procedure-with-command-builder-and-datagridview", "title": "Could I use stored procedure with command builder and datagridview?", "body": "<pre><code>SqlConnection con = new SqlConnection(\"Data source=.;Database=training; \n                                       integrated security =true\");\nDataSet ds = new DataSet();\nSqlDataAdapter da;\n\nprivate void Form1_Load(object sender, EventArgs e)\n{\n    cmd = new SqlCommand(\"select *  from mangers\",con);\n    da = new SqlDataAdapter(cmd );\n    da.Fill(ds, \"1\");\n    dataGridView1.DataSource = ds.Tables[0];\n}\n\nprivate void button1_Click(object sender, EventArgs e)\n{\n    SqlCommandBuilder cmdb = new SqlCommandBuilder(da);\n    da.Update(ds, \"1\");\n}\n</code></pre>\n\n<p>I want to know if I can insert/delete/update in <code>DataGridView</code> then it happen same to database by using stored procedure ? \n<img src=\"https://i.stack.imgur.com/Zvwhd.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "entity-framework"], "comments": [{"owner": {"reputation": 2520, "user_id": 1307262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11e97d5da4ec92d27df4c4fedde3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/1307262/red"}, "edited": false, "score": 5, "creation_date": 1473274314, "post_id": 39377186, "comment_id": 66082215, "body": "Just create a ViewModel that contains both lists and pass it to the View."}, {"owner": {"reputation": 9927, "user_id": 979331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e4108d28226846070db4eabf0c5d882?s=128&d=identicon&r=PG", "display_name": "user979331", "link": "https://stackoverflow.com/users/979331/user979331"}, "reply_to_user": {"reputation": 2520, "user_id": 1307262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11e97d5da4ec92d27df4c4fedde3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/1307262/red"}, "edited": false, "score": 0, "creation_date": 1473274592, "post_id": 39377186, "comment_id": 66082354, "body": "Can I see an example @raderick ?"}, {"owner": {"reputation": 2520, "user_id": 1307262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11e97d5da4ec92d27df4c4fedde3e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/1307262/red"}, "edited": false, "score": 0, "creation_date": 1473274688, "post_id": 39377186, "comment_id": 66082396, "body": "check this question: <a href=\"http://stackoverflow.com/questions/11064316/what-is-viewmodel-in-mvc\" title=\"what is viewmodel in mvc\">stackoverflow.com/questions/11064316/what-is-viewmodel-in-mv&zwnj;&#8203;c</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9927, "user_id": 979331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e4108d28226846070db4eabf0c5d882?s=128&d=identicon&r=PG", "display_name": "user979331", "link": "https://stackoverflow.com/users/979331/user979331"}, "edited": false, "score": 0, "creation_date": 1473276206, "post_id": 39377375, "comment_id": 66083135, "body": "I get an error saying <code>Data could not be found</code> in my new class"}, {"owner": {"reputation": 9927, "user_id": 979331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e4108d28226846070db4eabf0c5d882?s=128&d=identicon&r=PG", "display_name": "user979331", "link": "https://stackoverflow.com/users/979331/user979331"}, "edited": false, "score": 0, "creation_date": 1473276247, "post_id": 39377375, "comment_id": 66083152, "body": "This is what db is <code>private Homefront db = new Homefront();</code>"}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "reply_to_user": {"reputation": 9927, "user_id": 979331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e4108d28226846070db4eabf0c5d882?s=128&d=identicon&r=PG", "display_name": "user979331", "link": "https://stackoverflow.com/users/979331/user979331"}, "edited": false, "score": 0, "creation_date": 1473276264, "post_id": 39377375, "comment_id": 66083158, "body": "What is the type of <code>db.Data.ToList()</code> ? or what was your view strongly typed to earlier ?"}, {"owner": {"reputation": 9927, "user_id": 979331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e4108d28226846070db4eabf0c5d882?s=128&d=identicon&r=PG", "display_name": "user979331", "link": "https://stackoverflow.com/users/979331/user979331"}, "edited": false, "score": 0, "creation_date": 1473276284, "post_id": 39377375, "comment_id": 66083168, "body": "which comes from here <code>public class Homefront : DbContext     {         public DbSet&lt;CentralParkPricing&gt; Data { get; set; }     }</code>"}, {"owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "reply_to_user": {"reputation": 9927, "user_id": 979331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e4108d28226846070db4eabf0c5d882?s=128&d=identicon&r=PG", "display_name": "user979331", "link": "https://stackoverflow.com/users/979331/user979331"}, "edited": false, "score": 0, "creation_date": 1473276337, "post_id": 39377375, "comment_id": 66083210, "body": "Replace <code>Data</code> with <code>CentralParkPricing</code> in the ListViewModel view model. Ex : <code>public IEnumerable&lt;CentralParkPricing&gt; SinglesData</code>"}], "tags": [], "owner": {"reputation": 196067, "user_id": 40521, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8faa5e8a474933dd207c86fb886a7f28?s=128&d=identicon&r=PG", "display_name": "Shyju", "link": "https://stackoverflow.com/users/40521/shyju"}, "is_accepted": true, "score": 4, "last_activity_date": 1473274986, "creation_date": 1473274986, "answer_id": 39377375, "question_id": 39377186, "link": "https://stackoverflow.com/questions/39377186/asp-net-return-multiple-list-to-view/39377375#39377375", "title": "ASP.NET return multiple list to view", "body": "<p>Create a view model with 2 properties.</p>\n\n<p>Assuming <code>db.Data</code> returns a collection of type <code>Data</code></p>\n\n<pre><code>public clas ListViewModel\n{\n  public List&lt;Data&gt; SinglesData { set;get;}\n  public List&lt;Data&gt; TownsData { set;get;}\n}\n</code></pre>\n\n<p>Now use this</p>\n\n<pre><code>public ActionResult Index()\n{\n  var vm=new ListViewModel();\n  vm.SinglesData = db.Data\n                     .Where(a=&gt; a.hidden == false &amp;&amp; a.collection == \"Singles\").ToList();\n  vm.TownsData = db.Data\n                   .Where(b=&gt; b.hidden == false &amp;&amp; b.collection == \"Towns\").ToList();\n  return View(vm);\n}\n</code></pre>\n\n<p>Now make sure your view is strongly  typed to the new view model</p>\n\n<pre><code>@model ListViewModel\n&lt;h2&gt;Singles Data &lt;/h1&gt;\n@foreach(var item in Model.SinglesData)\n{\n  &lt;p&gt;@item.SomeProperty&lt;/p&gt;\n}\n&lt;h2&gt;Towns Data &lt;/h1&gt;\n@foreach(var item in Model.TownsData)\n{\n  &lt;p&gt;@item.SomeProperty&lt;/p&gt;\n}\n</code></pre>\n"}], "owner": {"reputation": 9927, "user_id": 979331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e4108d28226846070db4eabf0c5d882?s=128&d=identicon&r=PG", "display_name": "user979331", "link": "https://stackoverflow.com/users/979331/user979331"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3670, "favorite_count": 1, "accepted_answer_id": 39377375, "answer_count": 1, "score": -1, "last_activity_date": 1473280137, "creation_date": 1473274275, "last_edit_date": 1473280137, "question_id": 39377186, "link": "https://stackoverflow.com/questions/39377186/asp-net-return-multiple-list-to-view", "title": "ASP.NET return multiple list to view", "body": "<p>I am using ASP.NET MVC Entity Framework and I am trying to return two list to one view.</p>\n\n<p>So far I am able to return one list:</p>\n\n<pre><code>public ActionResult Index()\n{\n    return View(db.Data.ToList().Where(model =&gt; model.hidden == false).Where(model =&gt; model.collection == \"Singles\"));\n}\n</code></pre>\n\n<p>I also need to return:</p>\n\n<pre><code>db.Data.ToList().Where(model =&gt; model.hidden == false).Where(model =&gt; model.collection == \"Towns\")\n</code></pre>\n"}, {"tags": ["c#", "dotvvm"], "answers": [{"tags": [], "owner": {"reputation": 1487, "user_id": 1482195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yj1UO.jpg?s=128&g=1", "display_name": "Tom&#225;\u0161 Herceg", "link": "https://stackoverflow.com/users/1482195/tom%c3%a1%c5%a1-herceg"}, "is_accepted": false, "score": 0, "last_activity_date": 1473324958, "creation_date": 1473324958, "answer_id": 39386607, "question_id": 39377120, "link": "https://stackoverflow.com/questions/39377120/dotvvm-authentication-get-null-exception/39386607#39386607", "title": "DotVVM Authentication get null exception", "body": "<p>It looks like the <code>ClaimsIdentity</code> is not initialized correctly, maybe the combination with <code>UserIdentity</code> crashes somewhere inside OWIN Cookie Security Middleware. </p>\n\n<p>We use the following code to initialize it:</p>\n\n<pre><code>var identity = new ClaimsIdentity(new[]\n{\n    new Claim(ClaimTypes.Name, UserName),\n    // add another claims (e.g. for each role)\n},\nCookieAuthenticationDefaults.AuthenticationType);\nContext.OwinContext.Authentication.SignIn(identity);\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 6797505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcd564e683b6a4ed213b5f9716708bcf?s=128&d=identicon&r=PG&f=1", "display_name": "M. Falex", "link": "https://stackoverflow.com/users/6797505/m-falex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473350883, "creation_date": 1473273996, "question_id": 39377120, "link": "https://stackoverflow.com/questions/39377120/dotvvm-authentication-get-null-exception", "title": "DotVVM Authentication get null exception", "body": "<p>When is called method SignIn I get error NullReferenceExepction.</p>\n\n<p>Here is my ViewModel:</p>\n\n<pre><code>public Masterpage1ViewModel() {\n        UserIdentity user = new UserIdentity(\"Admin\");\n        var claimsIdentity = new ClaimsIdentity(user);\n\n        Context.OwinContext.Authentication.SignIn(claimsIdentity);\n  }\n</code></pre>\n\n<p>Here is class for UserIdentity:</p>\n\n<pre><code>public class UserIdentity : IIdentity\n{\n    public string AuthenticationType\n    {\n        get { return DefaultAuthenticationTypes.ApplicationCookie; }\n    }\n\n    public bool IsAuthenticated { get; set; }\n\n    public string Name { get; private set; }\n\n    public UserIdentity(string name)\n    {\n        Name = name;\n    }\n}\n</code></pre>\n\n<p>Also I added to Startup.cs:</p>\n\n<pre><code>app.UseCookieAuthentication(new CookieAuthenticationOptions()\n        {\n            AuthenticationType = DefaultAuthenticationTypes.ApplicationCookie,\n            Provider = new CookieAuthenticationProvider()\n            {\n                OnApplyRedirect = e =&gt; DotvvmAuthenticationHelper.ApplyRedirectResponse(e.OwinContext, e.RedirectUri)\n            }\n        });\n</code></pre>\n"}, {"tags": ["c#", "expression-trees"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1473274457, "post_id": 39377090, "comment_id": 66082286, "body": "This is going to be impossible.  There&#39;ll be no way to distinguish which usages of that type need to be changed and which don&#39;t."}, {"owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "edited": false, "score": 0, "creation_date": 1473274460, "post_id": 39377090, "comment_id": 66082287, "body": "The type parameter of a generic class/method must be known during compile time. So I don&#39;t think this will work unless you also create a new type during runtime."}, {"owner": {"reputation": 7282, "user_id": 468672, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d50a02da3b76cb8654326f15360c57c8?s=128&d=identicon&r=PG", "display_name": "Michael B", "link": "https://stackoverflow.com/users/468672/michael-b"}, "edited": false, "score": 0, "creation_date": 1473275016, "post_id": 39377090, "comment_id": 66082556, "body": "The code will be compiled before usage."}, {"owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "edited": false, "score": 0, "creation_date": 1473281249, "post_id": 39377090, "comment_id": 66085402, "body": "@MichaelB, do you mean the expression will be compiled or the C# program?"}, {"owner": {"reputation": 7282, "user_id": 468672, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d50a02da3b76cb8654326f15360c57c8?s=128&d=identicon&r=PG", "display_name": "Michael B", "link": "https://stackoverflow.com/users/468672/michael-b"}, "edited": false, "score": 0, "creation_date": 1473283695, "post_id": 39377090, "comment_id": 66086464, "body": "The expression will be compiled per usage."}, {"owner": {"reputation": 7282, "user_id": 468672, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d50a02da3b76cb8654326f15360c57c8?s=128&d=identicon&r=PG", "display_name": "Michael B", "link": "https://stackoverflow.com/users/468672/michael-b"}, "edited": false, "score": 0, "creation_date": 1473354046, "post_id": 39377090, "comment_id": 66119022, "body": "I&#39;ve updated with my currently working solution, but it seems super complicated."}], "answers": [{"comments": [{"owner": {"reputation": 7282, "user_id": 468672, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d50a02da3b76cb8654326f15360c57c8?s=128&d=identicon&r=PG", "display_name": "Michael B", "link": "https://stackoverflow.com/users/468672/michael-b"}, "edited": false, "score": 0, "creation_date": 1483454353, "post_id": 41404952, "comment_id": 70097997, "body": "The problem with that is that I needed to take an expression from a user. You can&#39;t pass a generic delegate and the only thing that could have worked would have been a class with a single interface method. The code would also then have to be super generic and you&#39;d lose the ability to use arithmetic operators. My novel solution worked a bit better for what I needed."}, {"owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "reply_to_user": {"reputation": 7282, "user_id": 468672, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d50a02da3b76cb8654326f15360c57c8?s=128&d=identicon&r=PG", "display_name": "Michael B", "link": "https://stackoverflow.com/users/468672/michael-b"}, "edited": false, "score": 0, "creation_date": 1483478350, "post_id": 41404952, "comment_id": 70111388, "body": "Honestly, I think your reasoning is flawed here. You need an expression from the user, why wouldn&#39;t receiving a factory method that is used to generate the said expression undesirable? Again, you&#39;re parameterizing the type which is exactly what generics is designed for. Sure C#&#39;s implementation doesn&#39;t allow use of certain operators, but is that <i>really</i> a problem? There are other ways to represent addition in the expression tree. With a &quot;placeholder&quot; function you could easily rewrite the expression to use actual addition, something query providers already do."}, {"owner": {"reputation": 7282, "user_id": 468672, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d50a02da3b76cb8654326f15360c57c8?s=128&d=identicon&r=PG", "display_name": "Michael B", "link": "https://stackoverflow.com/users/468672/michael-b"}, "edited": false, "score": 0, "creation_date": 1483481748, "post_id": 41404952, "comment_id": 70112908, "body": "For my use case, the limitation of generic code was pretty much making it impossible to do the interesting things users wanted do. Having something that &quot;smelled&quot; like an enum allowed some fairly interesting and novel applications. It also required fewer substitations as I needed an expression tree anyway.  Simply put even basic expressions like <code>x &amp; ~y</code> or <code>x &amp; y == y</code> is much easier to read and write then <code>And(X, Not(y))</code> or <code>Equal(And(x,y),Y)</code>."}], "tags": [], "owner": {"reputation": 112977, "user_id": 390278, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/84715fec547362389d02f5be0ed12814?s=128&d=identicon&r=PG", "display_name": "Jeff Mercado", "link": "https://stackoverflow.com/users/390278/jeff-mercado"}, "is_accepted": false, "score": 1, "last_activity_date": 1483206385, "last_edit_date": 1483206385, "creation_date": 1483151762, "answer_id": 41404952, "question_id": 39377090, "link": "https://stackoverflow.com/questions/39377090/how-can-i-replace-a-type-parameter-in-an-expression-tree/41404952#41404952", "title": "How can I replace a type parameter in an expression tree?", "body": "<p>Modifying an existing expression tree just to change a type used within it seems like a fools errand.  You're going to run into more problems with that particularly if you ever try to do operations on the objects of that type.</p>\n\n<p>But why are you getting all caught up in changing an existing tree?  You're trying to parameterize a type which calls for generics.  Just create a generic method (where the type is your parameter) that returns the desired expression.</p>\n\n<pre><code>Expression&lt;Func&lt;T, object&gt;&gt; CreateConverter&lt;T&gt;() =&gt;\n    (T x) =&gt; EqualityComparer&lt;T&gt;.Default.GetHashCode(x);\n</code></pre>\n\n<p>No need for creating fake placeholder types, the generic type parameter <em>is</em> your placeholder.</p>\n\n<p>If you need this to be pluggable, place the method in an interface and users would provide implementations that do the conversion.</p>\n"}], "owner": {"reputation": 7282, "user_id": 468672, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d50a02da3b76cb8654326f15360c57c8?s=128&d=identicon&r=PG", "display_name": "Michael B", "link": "https://stackoverflow.com/users/468672/michael-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1483206385, "creation_date": 1473273866, "last_edit_date": 1473354325, "question_id": 39377090, "link": "https://stackoverflow.com/questions/39377090/how-can-i-replace-a-type-parameter-in-an-expression-tree", "title": "How can I replace a type parameter in an expression tree?", "body": "<p>I'd like to be able to write a generic expression that a user can use to describe how he wants to do a conversion accross a family of types. </p>\n\n<p>The expression might look something like:</p>\n\n<pre><code>Expression&lt;Func&lt;PlaceHolder,object&gt;&gt; sample = \nx=&gt; (object)EqualityComparer&lt;PlaceHolder&gt;.GetHashCode(x)\n</code></pre>\n\n<p>I would like to convert it into::</p>\n\n<pre><code>Expression&lt;Func&lt;Foo,object&gt;&gt; sample = \nx=&gt; (object)EqualityComparer&lt;Foo&gt;.GetHashCode(x)\n</code></pre>\n\n<p>I can just visit the expression, and replace <code>PlaceHolder</code> parameter with x, but then i can't resolve the generic type call.</p>\n\n<p>The expression is user provided, and you can't assign a generic method to an expression.</p>\n\n<p>The end result is always to return an object and the expression will always be from <code>T=&gt;object</code>. I will compile a new expression for any object that the default rule will replace.</p>\n\n<p>Here is my existing code which works, but it seems very complicated.</p>\n\n<pre><code>// ReSharper disable once InconsistentNaming\n// By design this is supposed to look like a generic parameter.\npublic enum TEnum : long\n{\n}\n\ninternal sealed class EnumReplacer : ExpressionVisitor\n{\n    private Type ReplacePlaceHolder(Type type)\n    {\n        if (type.IsByRef)\n        {\n            return ReplacePlaceHolder(type.GetElementType()).MakeByRefType();\n        }\n\n        if (type.IsArray)\n        {\n            // expressionTrees can only deal with 1d arrays.\n            return ReplacePlaceHolder(type.GetElementType()).MakeArrayType();\n        }\n\n        if (type.IsGenericType)\n        {\n            var typeDef = type.GetGenericTypeDefinition();\n            var args = Array.ConvertAll(type.GetGenericArguments(), t =&gt; ReplacePlaceHolder(t));\n            return typeDef.MakeGenericType(args);\n        }\n\n        if (type == typeof(TEnum))\n        {\n            return _enumParam.Type;\n        }\n\n        return type;\n    }\n\n    private MethodBase ReplacePlaceHolder(MethodBase method)\n    {\n        var newCandidate = method;\n        var currentParams = method.IsGenericMethod ? ((MethodInfo)method).GetGenericMethodDefinition().GetParameters() : method.GetParameters();\n        // ReSharper disable once PossibleNullReferenceException\n        if (method.DeclaringType.IsGenericType)\n        {\n            var newType = ReplacePlaceHolder(method.DeclaringType);\n            var methodCandidates = newType.GetMembers()\n                .OfType&lt;MethodBase&gt;()\n                .Where(x =&gt; x.Name == method.Name\n                            &amp;&amp; x.IsStatic == method.IsStatic\n                            &amp;&amp; x.IsGenericMethod == method.IsGenericMethod).ToArray();\n\n            // grab the first method that wins. Not 100% correct, but close enough. \n            // yes an evil person could define a class like this::\n            // class C&lt;T&gt;{\n            //     public object Foo&lt;T&gt;(T b){return null;}\n            //     public object Foo(PlaceHolderEnum b){return new object();}\n            // }\n            // my code would prefer the former, where as C#6 likes the later.\n            newCandidate = methodCandidates.First(m =&gt; TestParameters(m, currentParams));\n        }\n\n        if (method.IsGenericMethod)\n        {\n            var genericArgs = method.GetGenericArguments();\n            genericArgs = Array.ConvertAll(genericArgs, temp =&gt; ReplacePlaceHolder(temp));\n            newCandidate = ((MethodInfo)newCandidate).GetGenericMethodDefinition().MakeGenericMethod(genericArgs);\n        }\n        return newCandidate;\n    }\n    private Expression ReplacePlaceHolder(MethodBase method, Expression target, ReadOnlyCollection&lt;Expression&gt; arguments)\n    {\n        // no point in not doing this.\n        var newArgs = Visit(arguments);\n\n        if (target != null)\n        {\n            target = Visit(target);\n        }\n\n        var newCandidate = ReplacePlaceHolder(method);\n\n        MethodInfo info = newCandidate as MethodInfo;\n        if (info != null)\n        {\n            return Expression.Call(target, info, newArgs);\n        }\n        return Expression.New((ConstructorInfo)newCandidate, newArgs);\n    }\n\n    private bool TestParameters(MethodBase candidate, ParameterInfo[] currentParams)\n    {\n        var candidateParams = candidate.GetParameters();\n        if (candidateParams.Length != currentParams.Length) return false;\n        for (int i = 0; i &lt; currentParams.Length; i++)\n        {\n            // the names should match.\n            if (currentParams[i].Name != candidateParams[i].Name) return false;\n\n            var curType = currentParams[i].ParameterType;\n            var candidateType = candidateParams[i].ParameterType;\n\n            // Either they are the same generic type arg, or they are the same type after replacements.\n            if (!((curType.IsGenericParameter &amp;&amp;\n                  curType.GenericParameterPosition == candidateType.GenericParameterPosition)\n                  || ReplacePlaceHolder(curType) == candidateType))\n            {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    private readonly ParameterExpression _enumParam;\n\n    public EnumReplacer(ParameterExpression enumParam)\n    {\n        _enumParam = enumParam;\n    }\n\n    protected override Expression VisitParameter(ParameterExpression node)\n    {\n        if (node.Type == typeof(TEnum))\n        {\n            return _enumParam;\n        }\n\n        if (node.Type == typeof(TypeCode))\n        {\n            return Expression.Constant(Type.GetTypeCode(_enumParam.Type));\n        }\n\n        return base.VisitParameter(node);\n    }\n\n    protected override Expression VisitUnary(UnaryExpression node)\n    {\n        if (node.NodeType == ExpressionType.Convert || node.NodeType == ExpressionType.ConvertChecked)\n        {\n            var t = ReplacePlaceHolder(node.Type);\n            // this isn't perfect. The compiler loves inserting random casts. To be protective and offer the most range, TEnum should be a long.\n            var method = node.Method == null ? null : ReplacePlaceHolder(node.Method);\n            return node.NodeType == ExpressionType.ConvertChecked\n                ? Expression.ConvertChecked(Visit(node.Operand), t, (MethodInfo) method)\n                : Expression.Convert(Visit(node.Operand), t, (MethodInfo) method);\n        }\n        if (node.Operand.Type == typeof(TEnum))\n        {\n            var operand = Visit(node.Operand);\n\n            return node.Update(operand);\n        }\n\n        return base.VisitUnary(node);\n    }\n\n    private MemberInfo ReplacePlaceHolder(MemberInfo member)\n    {\n        if (member.MemberType == MemberTypes.Method || member.MemberType == MemberTypes.Constructor)\n        {\n            return ReplacePlaceHolder((MethodBase) member);\n        }\n        var newType = ReplacePlaceHolder(member.DeclaringType);\n        var newMember = newType.GetMembers().First(x =&gt; x.Name == member.Name);\n        return newMember;\n    }\n\n    protected override Expression VisitNewArray(NewArrayExpression node)\n    {\n        var children = Visit(node.Expressions);\n        // Despite returning T[], it expects T.\n        var type = ReplacePlaceHolder(node.Type.GetElementType());\n        return Expression.NewArrayInit(type, children);\n    }\n\n    protected override MemberMemberBinding VisitMemberMemberBinding(MemberMemberBinding node)\n    {\n        var newMember = ReplacePlaceHolder(node.Member);\n        var bindings = node.Bindings.Select(x =&gt; VisitMemberBinding(x));\n        return Expression.MemberBind(newMember, bindings);\n    }\n\n    protected override MemberListBinding VisitMemberListBinding(MemberListBinding node)\n    {\n        var prop = ReplacePlaceHolder(node.Member);\n        var inits = node.Initializers.Select(x =&gt; VisitElementInit(x));\n        return Expression.ListBind(prop, inits);\n    }\n\n    protected override Expression VisitMethodCall(MethodCallExpression node)\n    {\n        return ReplacePlaceHolder(node.Method, node.Object, node.Arguments);\n    }\n\n    protected override MemberAssignment VisitMemberAssignment(MemberAssignment node)\n    {\n        var expr = Visit(node.Expression);\n        var prop = ReplacePlaceHolder(node.Member);\n        return Expression.Bind(prop, expr);\n    }\n\n    protected override ElementInit VisitElementInit(ElementInit node)\n    {\n        var method = ReplacePlaceHolder(node.AddMethod);\n        var args = Visit(node.Arguments);\n        return Expression.ElementInit((MethodInfo)method, args);\n    }\n    protected override Expression VisitNew(NewExpression node)\n    {\n        return ReplacePlaceHolder(node.Constructor, null, node.Arguments);\n    }\n\n    protected override Expression VisitConstant(ConstantExpression node)\n    {\n        // replace typeof expression\n        if (node.Type == typeof(Type) &amp;&amp; (Type)node.Value == typeof(TEnum))\n        {\n            return Expression.Constant(_enumParam.Type);\n        }\n        // explicit usage of default(TEnum) or (TEnum)456\n        if (node.Type == typeof(TEnum))\n        {\n            return Expression.Constant(Enum.ToObject(_enumParam.Type, node.Value));\n        }\n\n        return base.VisitConstant(node);\n    }\n}\n</code></pre>\n\n<p>Usage is like so::</p>\n\n<pre><code>class Program\n{\n    public class Holder\n    {\n        public int Foo { get; set; }\n    }\n    public class Foo&lt;T1,T2&gt; : IEnumerable\n    {\n        public object GenericMethod&lt;TM, TM2&gt;(TM2 blarg) =&gt; blarg.ToString();\n\n        public IList&lt;Foo&lt;T1, T2&gt;&gt; T { get; set; } = new List&lt;Foo&lt;T1, T2&gt;&gt;();\n\n        public T1 Prop { get; set; }\n        public void Add(int i) { }\n        public Holder Holder { get; set; } = new Holder {};\n\n        public IEnumerator GetEnumerator()\n        {\n            throw new NotImplementedException();\n        }\n    }\n\n    public enum LongEnum:ulong\n    {\n    }\n\n    static void Main(string[] args)\n    {\n        Expression&lt;Func&lt;TEnum, TypeCode, object&gt;&gt; evilTest = (x,t) =&gt;\n                TypeCode.UInt64 == t\n                    ? (object)new Dictionary&lt;TEnum, TypeCode&gt;().TryGetValue(checked((x - 407)), out t)\n                    : new Foo&lt;string, TEnum&gt; { Holder = {Foo =6}, T = new []\n                    {\n                        new Foo&lt;string, TEnum&gt;\n                        {\n                            T = {\n                                new Foo&lt;string, TEnum&gt;{1,2,3,4,5,6,7,8,9,10,11,12}\n                            }\n                        },\n                        new Foo&lt;string, TEnum&gt;\n                        {\n                            Prop = $\"What up hello? {args}\"\n                        }\n                    }}.GenericMethod&lt;string, TEnum&gt;(x);\n        Console.WriteLine(evilTest);\n        var p = Expression.Parameter(typeof(LongEnum), \"long\");\n        var expressionBody = new EnumReplacer(p).Visit(evilTest.Body);\n\n        var q = Expression.Lambda&lt;Func&lt;LongEnum, object&gt;&gt;(expressionBody, p);\n        var func =q.Compile();\n        var res = func.Invoke((LongEnum)1234567890123Ul);\n</code></pre>\n"}, {"tags": ["c#", "mongodb"], "answers": [{"comments": [{"owner": {"reputation": 7660, "user_id": 695498, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ee7dba0113ba15076c79d0e9043d7718?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/695498/thomas"}, "edited": false, "score": 0, "creation_date": 1473290993, "post_id": 39379095, "comment_id": 66088710, "body": "would something like collection.UpdateOneAsync(F, U).Result work properly then as it would force the operation to complete? essentially making it a sync operation?"}], "tags": [], "owner": {"reputation": 12489, "user_id": 2597372, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/jQ54P.png?s=128&g=1", "display_name": "BRAHIM Kamel", "link": "https://stackoverflow.com/users/2597372/brahim-kamel"}, "is_accepted": true, "score": 0, "last_activity_date": 1474664370, "last_edit_date": 1474664370, "creation_date": 1473282831, "answer_id": 39379095, "question_id": 39377086, "link": "https://stackoverflow.com/questions/39377086/concurrent-changes-in-async-mongodb-c/39379095#39379095", "title": "Concurrent changes in Async MongoDB (C#)", "body": "<p>I think this not an issue of your query because mongodb guarantee atomicity and concurrency control take a look at this <a href=\"https://docs.mongodb.com/manual/core/write-operations-atomicity/\" rel=\"nofollow\">link</a> for more.</p>\n\n<p>Your issue come from how tasks are scheduled I doubt.\ntake a look at this example if you don't await for the result in <code>Parallel.Invoke</code> your query will not be executed  because  the process will exit before the tasks are executed. so if you add <code>Console.ReadLine()</code>   your process will be blocked which allow mongo to  run tasks  </p>\n\n<pre><code>namespace ConsoleApplication1\n{\n    class Program\n    {\n       static MongoClient mongoClient = new MongoClient();\n        static IMongoDatabase databaseBase = mongoClient.GetDatabase(\"dbTest\", null);\n        static IMongoCollection&lt;A&gt; collection = databaseBase.GetCollection&lt;A&gt;(\"tests\", null);\n        static void Main(string[] args)\n        {\n\n            var a = new A\n            {\n                _id = 1,\n                V1 = 0,\n                V2 = 0\n            };\n\n            Parallel.Invoke( ()=&gt; { var res=UpdateV1(1, 10).Result; },  ()=&gt; { var res =  UpdateV2(1, 20).Result; });\n            //Console.ReadLine(); \n\n\n\n\n        }\n        static async  Task&lt;long&gt; UpdateV1(int id, int V)\n        {\n            var F = Builders&lt;A&gt;.Filter.Eq(a =&gt; a._id, id);\n            var U = Builders&lt;A&gt;.Update.Set(a =&gt; a.V1, V);\n            var result = await collection.UpdateOneAsync(F, U);\n            return result.ModifiedCount;  \n        }\n\n        static async Task&lt;long&gt; UpdateV2(int id, int V)\n        {\n            var F = Builders&lt;A&gt;.Filter.Eq(_ =&gt; _._id, id);\n            var U = Builders&lt;A&gt;.Update.Set(_ =&gt; _.V2, V);\n            var result = await collection.UpdateOneAsync(F, U);\n            return result.ModifiedCount;\n        }\n\n\n    }\n    class A\n    {\n       public  int _id;\n       public   int V1;\n       public  int V2;\n    }\n}\n</code></pre>\n\n<p>May be you  have to  replace <code>UpdateOneAsync</code> with <code>UpdateOne</code> only and see what's happen ? </p>\n"}], "owner": {"reputation": 7660, "user_id": 695498, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ee7dba0113ba15076c79d0e9043d7718?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/695498/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 39379095, "answer_count": 1, "score": 0, "last_activity_date": 1474664370, "creation_date": 1473273843, "question_id": 39377086, "link": "https://stackoverflow.com/questions/39377086/concurrent-changes-in-async-mongodb-c", "title": "Concurrent changes in Async MongoDB (C#)", "body": "<p>Let's assume I have a simple object:</p>\n\n<pre><code>class A\n{\n    int _id;\n    int V1;\n    int V2;\n}\n</code></pre>\n\n<p>and a MongoDB table with a bunch of these:</p>\n\n<p>Now, I have two async update operations defined as such:</p>\n\n<pre><code>void UpdateV1(int id, int V)\n{    \n    var F = Builders&lt;A&gt;.Filter.Eq(_ =&gt; _._id, Id);\n    var U = Builders&lt;A&gt;.Update.Set(_ =&gt; _.V1, V);\n    Mongo.Driver.UpdateOneAsync(F, U);\n}\n\nvoid UpdateV2(int id, int V)\n{    \n    var F = Builders&lt;A&gt;.Filter.Eq(_ =&gt; _._id, Id);\n    var U = Builders&lt;A&gt;.Update.Set(_ =&gt; _.V2, V);\n    Mongo.Driver.UpdateOneAsync(F, U);\n}\n</code></pre>\n\n<p>If I run the following commands:</p>\n\n<pre><code>UpdateV1(1, 10);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>UpdateV2(1, 20);\n</code></pre>\n\n<p>on different threads, but roughly at the same time, what is happening?</p>\n\n<p>Do I get:</p>\n\n<ul>\n<li>A record where only V1 OR V2 has changed?</li>\n<li>A record where both V1 AND V2 have changed?</li>\n</ul>\n\n<p>The reason I am asking this is that we had very weird bug where it would look like the first option is what was happening, but the expected result is obviously the last one.</p>\n\n<p>These problems started to disappeared when we were doing blocking calls, but it could also be a side effect.</p>\n\n<p>This is using the C# driver, everything latest version.</p>\n"}, {"tags": ["c#", "razor", "asp.net-core", "asp.net-core-mvc"], "answers": [{"tags": [], "owner": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "is_accepted": false, "score": 2, "last_activity_date": 1473274279, "creation_date": 1473274279, "answer_id": 39377190, "question_id": 39377058, "link": "https://stackoverflow.com/questions/39377058/posting-multiple-forms-on-mvc-razor-view-with-a-single-view-model/39377190#39377190", "title": "Posting multiple forms on MVC Razor View with a Single View Model", "body": "<p>Your parameter to the POST method needs to be <code>ProductViewModel</code>.</p>\n\n<p>The reason for this is because of the way the properties are named in your HTML:</p>\n\n<pre><code>&lt;input asp-for=\"AViewModel.Name\" class=\"form-control\"/&gt;\n</code></pre>\n\n<p>The model binder takes your serialized form, and sees that you're sending the POST method a value for a property named <code>AViewModel.Name</code>. When your parameter is of type <code>AViewModel</code>, it doesn't find anything, because it's looking for the <em>child property</em> of your parameter type with a name of <code>AViewModel</code>, and then assigning <em>that</em> object's <code>Name</code> property to the value of the input.</p>\n\n<p>If you don't want to make the parameter of each of your POST methods <code>ProductViewModel</code>, then you have one leading alternative: Create Partial Views for your five different forms, and pass in the individual properties from your <code>ProductViewModel</code> as your model for the partial view. This will then eliminate the <code>AViewModel</code> property prefix from your <code>asp-for</code> attribute.</p>\n"}, {"comments": [{"owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "edited": false, "score": 0, "creation_date": 1473274452, "post_id": 39377208, "comment_id": 66082279, "body": "Partial Views is exactly what I need here. Thanks!"}], "tags": [], "owner": {"reputation": 28569, "user_id": 1922568, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/UDzW1.jpg?s=128&g=1", "display_name": "Joe Audette", "link": "https://stackoverflow.com/users/1922568/joe-audette"}, "is_accepted": true, "score": 7, "last_activity_date": 1473274342, "creation_date": 1473274342, "answer_id": 39377208, "question_id": 39377058, "link": "https://stackoverflow.com/questions/39377058/posting-multiple-forms-on-mvc-razor-view-with-a-single-view-model/39377208#39377208", "title": "Posting multiple forms on MVC Razor View with a Single View Model", "body": "<p>I suggest make each form a partial view and pass in only the sub model needed from the parent model</p>\n\n<pre><code> @{await Html.RenderPartialAsync(\"AViewPartial\", Model.AViewModel); }\n</code></pre>\n\n<p>then your inputs in the partial can be changed from</p>\n\n<pre><code>&lt;input asp-for=\"AViewModel.Name\" class=\"form-control\"/&gt;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>&lt;input asp-for=\"Name\" class=\"form-control\"/&gt;\n</code></pre>\n\n<p>which should make it bind correctly by the modelbinder so it gets passed into your action</p>\n"}], "owner": {"reputation": 10797, "user_id": 5678853, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d01c96f03cca4973f6ea3041dce9ab7d?s=128&d=identicon&r=PG&f=1", "display_name": "Blake Rivell", "link": "https://stackoverflow.com/users/5678853/blake-rivell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5413, "favorite_count": 3, "accepted_answer_id": 39377208, "answer_count": 2, "score": 9, "last_activity_date": 1473314668, "creation_date": 1473273708, "last_edit_date": 1473314668, "question_id": 39377058, "link": "https://stackoverflow.com/questions/39377058/posting-multiple-forms-on-mvc-razor-view-with-a-single-view-model", "title": "Posting multiple forms on MVC Razor View with a Single View Model", "body": "<p>I have a razor view that will contain 5 forms. (A, B, C, D, E). Each of these forms has their own ViewModel (AViewModel, BViewModel, CViewModel, DViewModel, EViewModel).</p>\n\n<p>I created a parent ProductViewModel that the page will use as its only ViewModel. Within this ViewModel will be all of the other ViewModels for each form on the page (listed above).</p>\n\n<p><strong>Here is what the ProductViewModel's properties look like:</strong></p>\n\n<pre><code>public AViewModel { get; set; }\npublic BViewModel { get; set; }\npublic CViewModel { get; set; }\npublic DViewModel { get; set; }\npublic EViewModel { get; set; }\n</code></pre>\n\n<p><strong>My razor view looks like the following:</strong></p>\n\n<pre><code>@model MVCApp.ViewModels.ProductViewModel\n\n@{\n    ViewData[\"Title\"] = \"Product Detail\";\n}\n\n&lt;h2&gt;Product Detail&lt;/h2&gt;\n\n&lt;form asp-controller=\"A\" asp-action=\"Save\" data-ajax=\"true\" data-ajax-method=\"POST\"&gt;\n    &lt;div class=\"form-horizontal\"&gt;\n        &lt;h4&gt;Form A&lt;/h4&gt;\n        &lt;hr /&gt;\n        &lt;div asp-validation-summary=\"ModelOnly\" class=\"text-danger\"&gt;&lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label asp-for=\"AViewModel.Name\" class=\"col-md-2 control-label\"&gt;&lt;/label&gt;\n            &lt;div class=\"col-md-10\"&gt;\n                &lt;input asp-for=\"AViewModel.Name\" class=\"form-control\"/&gt;\n                &lt;span asp-validation-for=\"AViewModel.Name\" class=\"text-danger\" /&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label asp-for=\"AViewModel.StartDate\" class=\"col-md-2 control-label\"&gt;&lt;/label&gt;\n            &lt;div class=\"col-md-10\"&gt;\n                &lt;input asp-for=\"AViewModel.StartDate\" class=\"form-control\"/&gt;\n                &lt;span asp-validation-for=\"AViewModel.StartDate\" class=\"text-danger\" /&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;label asp-for=\"AViewModel.EndDate\" class=\"col-md-2 control-label\"&gt;&lt;/label&gt;\n            &lt;div class=\"col-md-10\"&gt;\n                &lt;input asp-for=\"AViewModel.EndDate\" class=\"form-control\"/&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"form-group\"&gt;\n            &lt;div class=\"col-md-offset-2 col-md-10\"&gt;\n                &lt;input type=\"submit\" value=\"Create\" class=\"btn btn-default\" /&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/form&gt;\n\n&lt;div&gt;\n    &lt;a asp-action=\"Index\"&gt;Back to List&lt;/a&gt;\n&lt;/div&gt;\n\n@section Scripts {\n    @{await Html.RenderPartialAsync(\"_ValidationScriptsPartial\");}\n}\n</code></pre>\n\n<p>When the Save button is clicked I end up in the Save (POST) Action Method of the A Controller just as I would expect:</p>\n\n<pre><code>    [HttpPost]\n    [ValidateAntiForgeryToken]\n    public IActionResult Save(AViewModel viewModel)\n    {\n        return Ok();\n    }\n</code></pre>\n\n<p>However, I noticed all of the properties of the viewModel param are empty.</p>\n\n<p>Does this mean I really have to pass the ProductViewModel object as my ViewModel to the Save Action Method for all 5 of these forms where only the ViewModel in scope will be populated and everything else will be null? Or is there a better way?</p>\n"}, {"tags": ["c#", "soap", "acumatica"], "answers": [{"comments": [{"owner": {"reputation": 3193, "user_id": 288360, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgYX5.png?s=128&g=1", "display_name": "Matthew Crews", "link": "https://stackoverflow.com/users/288360/matthew-crews"}, "edited": false, "score": 0, "creation_date": 1474138416, "post_id": 39533060, "comment_id": 66412836, "body": "Thank you for the feedback. We have actually tracked the issue back to customization that was done by a different team. When we removed their customization, this worked perfectly. Thank you for the help."}, {"owner": {"reputation": 3438, "user_id": 624448, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/42c644ac725687434ee77e39fab0d5ff?s=128&d=identicon&r=PG", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/624448/gabriel"}, "reply_to_user": {"reputation": 3193, "user_id": 288360, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgYX5.png?s=128&g=1", "display_name": "Matthew Crews", "link": "https://stackoverflow.com/users/288360/matthew-crews"}, "edited": false, "score": 0, "creation_date": 1474139393, "post_id": 39533060, "comment_id": 66413128, "body": "@MatthewCrews thanks for the update, glad to hear the issue is resolved! Do not hesitate to reach out if you have other questions."}], "tags": [], "owner": {"reputation": 3438, "user_id": 624448, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/42c644ac725687434ee77e39fab0d5ff?s=128&d=identicon&r=PG", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/624448/gabriel"}, "is_accepted": true, "score": 0, "last_activity_date": 1474033495, "creation_date": 1474033495, "answer_id": 39533060, "question_id": 39376809, "link": "https://stackoverflow.com/questions/39376809/acumatica-prepare-replenishment-screen-processall-action-not-working/39533060#39533060", "title": "Acumatica Prepare Replenishment Screen ProcessAll Action not working", "body": "<p>I tested your code and it is working just fine - the system prepares the replenishment plans for the items of the requested warehouse, and the response object contains all the items that would be listed if you opened the Prepare Replenishment screen with the parameters you set. If you want to e-mail me URL and credentials to your site (gmichaud at acumatica) I can take a look to see what's wrong.</p>\n\n<p>Please note that you don't need to explicitly set <code>Commit = true</code> for these two fields (the schema object already has them set to true). I would also recommend to add <code>System.Threading.Thread.Sleep(1000)</code> in your loop to avoid hammering the server with requests while it is processing.</p>\n"}], "owner": {"reputation": 3193, "user_id": 288360, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/JgYX5.png?s=128&g=1", "display_name": "Matthew Crews", "link": "https://stackoverflow.com/users/288360/matthew-crews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 39533060, "answer_count": 1, "score": 1, "last_activity_date": 1474033495, "creation_date": 1473272676, "last_edit_date": 1473434825, "question_id": 39376809, "link": "https://stackoverflow.com/questions/39376809/acumatica-prepare-replenishment-screen-processall-action-not-working", "title": "Acumatica Prepare Replenishment Screen ProcessAll Action not working", "body": "<p>I am on Acumatica 5.30.1672 and am using the SOAP API for Screen IN508000 to try and run the Prepare Replenishment process. I am setting the WarehouseID for where I want to prepare replenishment. The API call is returning the correct InventoryIDs in the <code>response</code> object but when I tell it to ProcessAll, it is not. There is no error, just no processing. I feel like I am missing something trivial here but I just cannot see it. When I do this using the GUI, everything works perfectly.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing AcumaticaTest.AcumaticaWebReference;\n\nnamespace AcumaticaTest\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n\n            Screen context = new Screen();\n            context.CookieContainer = new System.Net.CookieContainer();\n            context.Timeout = 1200000;\n\n            context.Url = \"url to SOAP API Endpoint\";\n            LoginResult lresult = context.Login(\"&lt;username&gt;\", \"&lt;password&gt;\");\n\n\n            IN508000Content IN508000 = context.IN508000GetSchema();\n            context.IN508000Clear();\n\n            var commands = new Command[]\n                                {\n                                        new Value {Value = \"&lt;WarehouseID&gt;\", LinkedCommand = IN508000.Selection.Warehouse, Commit= true },\n                                        new Value {Value = \"false\", LinkedCommand = IN508000.Selection.Me, Commit= true },\n                                        IN508000.ItemsRequiringReplenishment.InventoryID,\n                                        IN508000.Actions.ProcessAll\n                                };\n            var response = context.IN508000Submit(commands);\n\n            var status = context.IN508000GetProcessStatus();\n            while (status.Status == ProcessStatus.InProcess)\n            {\n                status = context.IN508000GetProcessStatus();\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "quartz-scheduler"], "comments": [{"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1473276706, "post_id": 39376807, "comment_id": 66083376, "body": "Maybe this will help <a href=\"http://stackoverflow.com/a/38891315/5836671\">stackoverflow.com/a/38891315/5836671</a>"}, {"owner": {"reputation": 109, "user_id": 1089345, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1f929b4dfa952fb1eda8cfcd966f4d22?s=128&d=identicon&r=PG", "display_name": "user1089345", "link": "https://stackoverflow.com/users/1089345/user1089345"}, "reply_to_user": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1473319122, "post_id": 39376807, "comment_id": 66096587, "body": "NO that was different case."}, {"owner": {"reputation": 32138, "user_id": 5836671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ikeOt.jpg?s=128&g=1", "display_name": "VDWWD", "link": "https://stackoverflow.com/users/5836671/vdwwd"}, "edited": false, "score": 0, "creation_date": 1473326347, "post_id": 39376807, "comment_id": 66100750, "body": "Why would you want to schedule a button click? The code inside the <code>button_click</code> function can be copied to a function that is called by the scheduler: <code>void IJob.Execute(IJobExecutionContext context) { myFunction(); }</code>"}], "owner": {"reputation": 109, "user_id": 1089345, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1f929b4dfa952fb1eda8cfcd966f4d22?s=128&d=identicon&r=PG", "display_name": "user1089345", "link": "https://stackoverflow.com/users/1089345/user1089345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 371, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473280894, "creation_date": 1473272672, "last_edit_date": 1473280894, "question_id": 39376807, "link": "https://stackoverflow.com/questions/39376807/quartz-scheduler-avoid-using-class-file-and-want-to-call-a-method-directly", "title": "Quartz scheduler: avoid using class file and want to call a method directly", "body": "<p>I am using quartz scheduler in my project. I have copy pasted my code below.In this area of code, \n     <code>Type type=typeof(class)</code>,\nI need to call a method like, \n    <code>Type type=typeof(methodname())</code>.\nI dont want to call an external class file. </p>\n\n<pre><code>int JobID = 0;\nJobDetailImpl job = null;\nQuartz.Impl.Triggers.CronTriggerImpl trigger = null;\nISimpleTrigger simpleTrigger = null;\nJobDataMap jobdatamap = new JobDataMap();\nsheduler.Start();\nString cronExpression = \"0 0/1 * * * ?\";\nType type = typeof(TriggerJob1);\njob = new JobDetailImpl(\"Job\" + JobID + \"\", null, type);\ntrigger = new Quartz.Impl.Triggers.CronTriggerImpl(\"Trigger\" + JobID + \"\", \"Job\" + JobID + \"\", cronExpression);\nsheduler.ScheduleJob(job, trigger); \n</code></pre>\n\n<p>TriggerJob1 in the above code is a class file which I created locally. According to quartz scheduler, it has the functionality that scheduler calls at its scheduled time.</p>\n\n<p>why i want to use a method instead of Triggerjob1 class file is:- I am using quartz scheduler in aspx file. I have all functionality written in a button click event. I am going to invoke this button by using scheduler. </p>\n\n<p>I want to use like this. This is my expected behaviour.</p>\n\n<pre><code>Type type = typeof(button_click);\n</code></pre>\n\n<p>I do not want to call this button click from external class file. But the syntax of quartz scheduler advices me to use a class file only.</p>\n\n<p>Kindly help me if anyone know it. If anyone cannot understand me what I am saying, please let me know.</p>\n"}, {"tags": ["c#", "wpf", "xaml", "mahapps.metro"], "comments": [{"owner": {"reputation": 711, "user_id": 6494958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264d6962390eeb5bdefb3f2765b2c2b1?s=128&d=identicon&r=PG&f=1", "display_name": "mechanic", "link": "https://stackoverflow.com/users/6494958/mechanic"}, "edited": false, "score": 0, "creation_date": 1473277536, "post_id": 39376742, "comment_id": 66083746, "body": "Have you tried &lt;Style BasedOn=&quot;...&quot; &gt; ?"}, {"owner": {"reputation": 1094, "user_id": 192577, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62c3f90298efb44714baf9dadd01d8e5?s=128&d=identicon&r=PG", "display_name": "Israel Lopez", "link": "https://stackoverflow.com/users/192577/israel-lopez"}, "reply_to_user": {"reputation": 711, "user_id": 6494958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/264d6962390eeb5bdefb3f2765b2c2b1?s=128&d=identicon&r=PG&f=1", "display_name": "mechanic", "link": "https://stackoverflow.com/users/6494958/mechanic"}, "edited": false, "score": 0, "creation_date": 1473280104, "post_id": 39376742, "comment_id": 66084919, "body": "Yeah, but after that I&#39;m not sure how to get the Style defined in DataGridTextColumn to match.  Tried a bunch of different ways of referencing the Styles in the Resource for MahApps.Metro.Controls, but havent figured it out."}], "answers": [{"tags": [], "owner": {"reputation": 12518, "user_id": 3787557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8CQdx.png?s=128&g=1", "display_name": "jsanalytics", "link": "https://stackoverflow.com/users/3787557/jsanalytics"}, "is_accepted": true, "score": 2, "last_activity_date": 1473288951, "last_edit_date": 1473288951, "creation_date": 1473287354, "answer_id": 39379945, "question_id": 39376742, "link": "https://stackoverflow.com/questions/39376742/apply-styles-to-datagridtextcolumn-with-mahapps-metro/39379945#39379945", "title": "Apply Styles to DataGridTextColumn with MahApps Metro", "body": "<p>Try this:</p>\n\n<p><strong>Style:</strong></p>\n\n<pre><code>&lt;Style x:Key=\"DatagridCellStyle1\" \n       TargetType=\"{x:Type DataGridCell}\" \n       BasedOn=\"{StaticResource {x:Type DataGridCell}}\"&gt;\n    &lt;Setter Property=\"HorizontalAlignment\" Value=\"Center\" /&gt;\n&lt;/Style&gt;\n</code></pre>\n\n<p><strong>XAML:</strong></p>\n\n<pre><code>        &lt;DataGridTextColumn Header=\"DUE\" \n                            Binding=\"{Binding QTYDue}\" \n                            CellStyle=\"{StaticResource DatagridCellStyle1}\" /&gt;\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>            &lt;DataGridTemplateColumn Header=\"DUE\"&gt;\n                &lt;DataGridTemplateColumn.CellTemplate&gt;\n                    &lt;DataTemplate&gt;\n                        &lt;DataGridCell Style=\"{StaticResource DatagridCellStyle1}\"&gt;\n                            &lt;TextBlock Text=\"{Binding QTYDue}\"&gt;&lt;/TextBlock&gt;\n                        &lt;/DataGridCell&gt;\n                    &lt;/DataTemplate&gt;\n                &lt;/DataGridTemplateColumn.CellTemplate&gt;\n            &lt;/DataGridTemplateColumn&gt;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TIvT7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TIvT7.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1094, "user_id": 192577, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62c3f90298efb44714baf9dadd01d8e5?s=128&d=identicon&r=PG", "display_name": "Israel Lopez", "link": "https://stackoverflow.com/users/192577/israel-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 39379945, "answer_count": 1, "score": 1, "last_activity_date": 1473288951, "creation_date": 1473272390, "question_id": 39376742, "link": "https://stackoverflow.com/questions/39376742/apply-styles-to-datagridtextcolumn-with-mahapps-metro", "title": "Apply Styles to DataGridTextColumn with MahApps Metro", "body": "<p>I just tried using the following XAML in my WPF application.</p>\n\n<pre><code>&lt;DataGridTextColumn Header=\"Due\" Binding=\"{Binding QTYDue, Mode=OneWay}\"&gt;\n    &lt;DataGridTextColumn.CellStyle&gt;\n        &lt;Style&gt;\n            &lt;Setter Property=\"FrameworkElement.HorizontalAlignment\" Value=\"Center\" /&gt;\n        &lt;/Style&gt;\n    &lt;/DataGridTextColumn.CellStyle&gt;\n&lt;/DataGridTextColumn&gt;\n</code></pre>\n\n<p>Unfortunately, the behavior is that the previous styling for the control in MahApps Metro is removed. How do I keep the existing style, but just modify this one aspect of it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vFeKr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vFeKr.png\" alt=\"WPF Behavior\"></a></p>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473272852, "post_id": 39376741, "comment_id": 66081568, "body": "I retracted my close vote as too broad with the question of, is the amount of objects animated out for each button consistent and static?"}, {"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "reply_to_user": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473272877, "post_id": 39376741, "comment_id": 66081579, "body": "I understand, its your decision. Still looking for some help. But if many people will vote to close this or delete it, I will be forced to take this down.."}, {"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "reply_to_user": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473272991, "post_id": 39376741, "comment_id": 66081642, "body": "The amount of object wont be more than 6-7 things which will contain Student personal details. Will be static, not dragable ."}, {"owner": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473273187, "post_id": 39376741, "comment_id": 66081732, "body": "So the parts that take a reasonable amount of time, is handling a dynamic number of animated flyout stuff for each button, and handling stuff like z-index depending on how they&#39;re displayed. If you&#39;d like a templated example of how to just make a button make stuff animate out like your example, I could provide that in minutes but complexity beyond that is the type of thing I make a living with. ;)"}, {"owner": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473273445, "post_id": 39376741, "comment_id": 66081832, "body": "PS I believe the style of visualization you&#39;re showing is called node-link diagram. Though I don&#39;t know of any decent free one&#39;s out there for wpf."}, {"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "reply_to_user": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473273833, "post_id": 39376741, "comment_id": 66082008, "body": "Yes please, that would be very helpful to me sir. The temptation of paying you for something complex like that is very high, because it will save me much time, and focus more in the SQL part. how it will create a new button for each student and stuff. But the temptation of not eating only Ramen for the rest of the month is very high too. Maybe by the end of the month when I get my payment might think for something out... But thanks for the template you are going to give me. Thanks a lot!"}, {"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "reply_to_user": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473273991, "post_id": 39376741, "comment_id": 66082079, "body": "PS: there is <a href=\"http://www.graphviz.org/\" rel=\"nofollow noreferrer\">graphviz.org</a> or <a href=\"http://www.dalssoft.com/diagram/\" rel=\"nofollow noreferrer\">dalssoft.com/diagram</a> diagram.net which are open source and free"}, {"owner": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473274000, "post_id": 39376741, "comment_id": 66082084, "body": "Haha no worries man, SO isn&#39;t about paying anybody, it&#39;s about learning while helping others learn, but once something gets into hours well we all have lives on the other side of the screen, and many of us lived off ramen while learning too, including myself. Give me a minute to finish what I&#39;m working on and I&#39;ll plop out something for you. In the interim though, generally folks expect to see any effort of your own first so we both are breaking the status quo a bit lol."}, {"owner": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473274087, "post_id": 39376741, "comment_id": 66082120, "body": "Neither of those are WPF I don&#39;t think but I&#39;ll look again here in a min. :)"}, {"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "reply_to_user": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473276837, "post_id": 39376741, "comment_id": 66083432, "body": "It looks like its really hard for a pro like you.. Imagine what it would take me.."}, {"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "reply_to_user": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1473279537, "post_id": 39376741, "comment_id": 66084653, "body": "@ChrisW. Im trying to make something like this. <a href=\"https://www.youtube.com/watch?v=-FkRzDegzAo\" rel=\"nofollow noreferrer\">youtube.com/watch?v=-FkRzDegzAo</a>"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "edited": false, "score": 0, "creation_date": 1473285476, "post_id": 39379413, "comment_id": 66087121, "body": "You&#39;re a genius Chris! btw, how to do it when click somewhere else, those to close again?"}, {"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "edited": false, "score": 0, "creation_date": 1473285861, "post_id": 39379413, "comment_id": 66087251, "body": "Also, have been unable to edit the text of the button &quot;Boaty McBoatFace&quot;.  I mean, to change the name of the button from a text box. The button to take the value of the text"}, {"owner": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "reply_to_user": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "edited": false, "score": 0, "creation_date": 1473286398, "post_id": 39379413, "comment_id": 66087430, "body": "There&#39;s nothing genius going on here, it&#39;s a pretty minimal example. You can change the text by changing the <code>Content</code> property on the first line. Also like I said, I left out any ExitActions. What you&#39;re trying to do overall can easily become a considerably time consuming thing which honestly I can&#39;t volunteer for at this point in time. This example was just meant to get some creative juices flowing for ya so you could pick up from here. :)"}, {"owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "edited": false, "score": 0, "creation_date": 1473291823, "post_id": 39379413, "comment_id": 66088898, "body": "Its really good, thanks. It gave me the point of the idea how to continue it.  but I have an other question. it is too little to create a new post so was hopping you to help me. How to change the background color of my window? I&#39;m trying to make a random color changer for the background. controlled by a timer, but looks like timer is not in my Tools.. why?"}, {"owner": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "reply_to_user": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "edited": false, "score": 0, "creation_date": 1473299135, "post_id": 39379413, "comment_id": 66090433, "body": "That&#39;s the type of thing I&#39;m sure google could provide some answers for first. Give some things a shot and come on back when run into a blocker with another question. :)"}], "tags": [], "owner": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1473284305, "creation_date": 1473284305, "answer_id": 39379413, "question_id": 39376741, "link": "https://stackoverflow.com/questions/39376741/how-to-make-animations-in-wpf-c/39379413#39379413", "title": "How to make Animations in WPF C#?", "body": "<p>Ya I know what you're trying to accomplish, but like I said it's the type of reason places hire specialty front-end \"devigner\" guys to make that stuff.</p>\n\n<p>So I apologize for the delayed response but I had to get my normal workday stuff out of the way first, and I spent about 15mins on this little example before I head off for the day soon to get you started with an idea or two.</p>\n\n<p>I did however leave out the Exit actions for when Toggle IsChecked=False. There's also a lot of other ways I might do things if it was my project but something like this could eat up most of a day or more real easily (especially depending how cool you make it) so this is just a pseudo example but I hope it helps.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jlEru.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jlEru.gif\" alt=\"enter image description here\"></a></p>\n\n<p><strong>As a ToggleButton template (SUPER SIMPLE CONCEPT EXAMPLE);</strong></p>\n\n<pre><code>&lt;ToggleButton Content=\"Boaty McBoatFace\" HorizontalAlignment=\"Center\" VerticalAlignment=\"Center\"&gt;\n            &lt;ToggleButton.Template&gt;\n                &lt;ControlTemplate TargetType=\"{x:Type ToggleButton}\"&gt;\n                    &lt;ControlTemplate.Resources&gt;\n\n                        &lt;Storyboard x:Key=\"bubbleAnim\"&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Left)\" Storyboard.TargetName=\"bubble1\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.2\" Value=\"55\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Top)\" Storyboard.TargetName=\"bubble1\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.2\" Value=\"55\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Top)\" Storyboard.TargetName=\"bubble2\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.3\" Value=\"55\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Left)\" Storyboard.TargetName=\"bubble3\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.4\" Value=\"210\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Top)\" Storyboard.TargetName=\"bubble3\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.4\" Value=\"55\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Left)\" Storyboard.TargetName=\"bubble4\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.5\" Value=\"210\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Top)\" Storyboard.TargetName=\"bubble4\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.5\" Value=\"133\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Left)\" Storyboard.TargetName=\"bubble5\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.6\" Value=\"210\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Top)\" Storyboard.TargetName=\"bubble5\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.6\" Value=\"205\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Top)\" Storyboard.TargetName=\"bubble6\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.7\" Value=\"205\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;Int32AnimationUsingKeyFrames Storyboard.TargetProperty=\"(Panel.ZIndex)\" Storyboard.TargetName=\"bubble6\"&gt;\n                                &lt;EasingInt32KeyFrame KeyTime=\"0:0:0.7\" Value=\"-5\"/&gt;\n                            &lt;/Int32AnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Left)\" Storyboard.TargetName=\"bubble7\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.8\" Value=\"55\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Top)\" Storyboard.TargetName=\"bubble7\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.8\" Value=\"205\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Left)\" Storyboard.TargetName=\"bubble8\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.9\" Value=\"55\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(Canvas.Top)\" Storyboard.TargetName=\"bubble8\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.9\" Value=\"133\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"bubble1\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.2\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"bubble2\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.3\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"bubble3\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.4\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"bubble4\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.5\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"bubble5\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.6\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"bubble6\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.7\" Value=\"0.985\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"bubble7\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.8\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"bubble8\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.9\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"line1\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.2\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"line2\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.3\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"line3\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.4\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"line4\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.5\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"line5\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.6\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"line6\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.7\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"line7\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.8\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                            &lt;DoubleAnimationUsingKeyFrames Storyboard.TargetProperty=\"(UIElement.Opacity)\" Storyboard.TargetName=\"line8\"&gt;\n                                &lt;EasingDoubleKeyFrame KeyTime=\"0:0:0.9\" Value=\"1\"/&gt;\n                            &lt;/DoubleAnimationUsingKeyFrames&gt;\n                        &lt;/Storyboard&gt;\n\n                    &lt;/ControlTemplate.Resources&gt;\n\n                    &lt;Border Height=\"300\" Width=\"300\"&gt;\n                        &lt;Canvas&gt;\n                            &lt;Canvas.Resources&gt;\n                                &lt;Style TargetType=\"Line\"&gt;\n                                    &lt;Setter Property=\"VerticalAlignment\" Value=\"Center\"/&gt;\n                                    &lt;Setter Property=\"Stroke\" Value=\"Red\"/&gt;\n                                    &lt;Setter Property=\"StrokeThickness\" Value=\"2\"/&gt;\n                                &lt;/Style&gt;\n                                &lt;Style TargetType=\"Border\"&gt;\n                                    &lt;Setter Property=\"Background\" Value=\"White\"/&gt;\n                                    &lt;Setter Property=\"BorderBrush\" Value=\"Purple\"/&gt;\n                                    &lt;Setter Property=\"BorderThickness\" Value=\"3\"/&gt;\n                                    &lt;Setter Property=\"CornerRadius\" Value=\"50\"/&gt;\n                                    &lt;Setter Property=\"Padding\" Value=\"10,5\"/&gt;\n                                &lt;/Style&gt;\n                            &lt;/Canvas.Resources&gt;\n\n                            &lt;Line x:Name=\"line1\" Opacity=\"0\" \n                                      X1=\"75\" Y1=\"75\"\n                                      X2=\"150\" Y2=\"150\"/&gt;\n                            &lt;Line x:Name=\"line2\" Opacity=\"0\"\n                                      X1=\"150\" Y1=\"75\"\n                                      X2=\"150\" Y2=\"150\" Stroke=\"Blue\"/&gt;\n                            &lt;Line x:Name=\"line3\" Opacity=\"0\"\n                                      X1=\"225\" Y1=\"75\"\n                                      X2=\"150\" Y2=\"150\"/&gt;\n                            &lt;Line x:Name=\"line4\" Opacity=\"0\"\n                                      X1=\"225\" Y1=\"150\"\n                                      X2=\"150\" Y2=\"150\" Stroke=\"Blue\"/&gt;\n                            &lt;Line x:Name=\"line5\" Opacity=\"0\"\n                                      X1=\"150\" Y1=\"150\"\n                                      X2=\"75\" Y2=\"225\"/&gt;\n                            &lt;Line x:Name=\"line6\" Opacity=\"0\"\n                                      X1=\"150\" Y1=\"150\"\n                                      X2=\"150\" Y2=\"225\" Stroke=\"Blue\"/&gt;\n                            &lt;Line x:Name=\"line7\" Opacity=\"0\"\n                                      X1=\"150\" Y1=\"150\"\n                                      X2=\"225\" Y2=\"225\"/&gt;\n                            &lt;Line x:Name=\"line8\" Opacity=\"0\"\n                                      X1=\"150\" Y1=\"150\"\n                                      X2=\"75\" Y2=\"150\" Stroke=\"Blue\"/&gt;\n\n\n                            &lt;Border x:Name=\"bubble1\" Opacity=\"0\"\n                                    Canvas.Left=\"133\" Canvas.Top=\"134\"&gt;\n                                &lt;TextBlock Text=\"1\"/&gt;\n                            &lt;/Border&gt;\n\n                            &lt;Border x:Name=\"bubble2\" Opacity=\"0\"\n                                    Canvas.Left=\"133\" Canvas.Top=\"134\"&gt;\n                                &lt;TextBlock Text=\"2\"/&gt;\n                            &lt;/Border&gt;\n\n                            &lt;Border x:Name=\"bubble3\" Opacity=\"0\"\n                                    Canvas.Left=\"133\" Canvas.Top=\"134\"&gt;\n                                &lt;TextBlock Text=\"3\"/&gt;\n                            &lt;/Border&gt;\n\n                            &lt;Border x:Name=\"bubble4\" Opacity=\"0\"\n                                    Canvas.Left=\"133\" Canvas.Top=\"134\"&gt;\n                                &lt;TextBlock Text=\"4\"/&gt;\n                            &lt;/Border&gt;\n\n                            &lt;Border x:Name=\"bubble5\" Opacity=\"0\"\n                                    Canvas.Left=\"133\" Canvas.Top=\"134\"&gt;\n                                &lt;TextBlock Text=\"5\"/&gt;\n                            &lt;/Border&gt;\n\n                            &lt;Border x:Name=\"bubble6\" Opacity=\"0\"\n                                    Canvas.Left=\"133\" Canvas.Top=\"134\"&gt;\n                                &lt;TextBlock Text=\"6\"/&gt;\n                            &lt;/Border&gt;\n\n                            &lt;Border x:Name=\"bubble7\" Opacity=\"0\"\n                                    Canvas.Left=\"133\" Canvas.Top=\"134\"&gt;\n                                &lt;TextBlock Text=\"7\"/&gt;\n                            &lt;/Border&gt;\n\n                            &lt;Border x:Name=\"bubble8\" Opacity=\"0\"\n                                    Canvas.Left=\"133\" Canvas.Top=\"134\"&gt;\n                                &lt;TextBlock Text=\"8\"/&gt;\n                            &lt;/Border&gt;\n\n                            &lt;Border CornerRadius=\"3\" Background=\"{TemplateBinding Background}\"\n                                    Canvas.Left=\"95\" Canvas.Top=\"138\" Padding=\"1\"&gt;\n                                &lt;ContentPresenter /&gt;\n                            &lt;/Border&gt;\n\n\n                        &lt;/Canvas&gt;\n                    &lt;/Border&gt;\n                    &lt;ControlTemplate.Triggers&gt;\n                        &lt;Trigger Property=\"IsChecked\" Value=\"True\"&gt;\n                            &lt;Trigger.EnterActions&gt;\n                                &lt;BeginStoryboard Storyboard=\"{StaticResource bubbleAnim}\"/&gt;\n                            &lt;/Trigger.EnterActions&gt;\n                        &lt;/Trigger&gt;\n                    &lt;/ControlTemplate.Triggers&gt;\n                &lt;/ControlTemplate&gt;\n            &lt;/ToggleButton.Template&gt;\n        &lt;/ToggleButton&gt;\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6679298, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/93f9b2c0e31180395bc9528228f298b3?s=128&d=identicon&r=PG&f=1", "display_name": "berg96", "link": "https://stackoverflow.com/users/6679298/berg96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 39379413, "answer_count": 1, "score": 0, "last_activity_date": 1473284305, "creation_date": 1473272388, "question_id": 39376741, "link": "https://stackoverflow.com/questions/39376741/how-to-make-animations-in-wpf-c", "title": "How to make Animations in WPF C#?", "body": "<p>I am trying to create a similar project with what this guy has made <a href=\"https://www.youtube.com/watch?v=00AzqWdF--s\" rel=\"nofollow noreferrer\">Youtube Video</a></p>\n\n<p>Of course, not that awesome, it is way beyond my skills. But what I am trying to make now is very simple (compared to the video) </p>\n\n<p>this is what I have done so far <a href=\"https://i.stack.imgur.com/S662c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S662c.png\" alt=\"Image 1\"></a></p>\n\n<p>This is what I've made,  With Drag and drop of course, cant figure out how to create a shape (Rectangle or any other shape) in a short distance from the specific button, and then connected with an other shape or something similar. </p>\n\n<p>This what I've done is just when you press the button to show those two Rectangles. </p>\n\n<p>Also, trying to make it in different Angles too. for example like in this pic</p>\n\n<p><a href=\"https://i.stack.imgur.com/UU4jc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UU4jc.png\" alt=\"Image 2\"></a></p>\n\n<p>To give you a better understanding in the project I am making, please read bellow. </p>\n\n<p>This is a school project I am making, I have some data in a database in SQL and want to demonstrate those not in a table or any label, but as in the photos I show you. For example. When the form loads, it gets the first row, and lists items like Name (will be the button) then the other rectangles will be created from the information listed. for example. When you click the Name of the person(button) it will show 2-3 Rectangles(the green rectangles) with the labels of Age, School, Gender or anything else. </p>\n\n<p><a href=\"https://i.stack.imgur.com/W7Ukw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W7Ukw.png\" alt=\"Image 3\"></a> </p>\n\n<p>How can I do this? Is it able to be done? I know its really hard, but can any one refer me in any tutorial for this? What I've searched on google, most of the tutorials are outdated, 6-7 years old. </p>\n\n<p>Thanks for your Consideration</p>\n"}, {"tags": ["c#", "this"], "comments": [{"owner": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "edited": false, "score": 0, "creation_date": 1473272438, "post_id": 39376648, "comment_id": 66081392, "body": "It depends on what you declare your variable as, and what <code>this</code> refers to when you&#39;re trying to assign it to a variable."}, {"owner": {"reputation": 18960, "user_id": 3312, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d66d5925cf7d5fc1375ddfd93335a921?s=128&d=identicon&r=PG", "display_name": "Jesse C. Slicer", "link": "https://stackoverflow.com/users/3312/jesse-c-slicer"}, "edited": false, "score": 1, "creation_date": 1473272774, "post_id": 39376648, "comment_id": 66081531, "body": "Create a constructor in the <code>WindowClass</code> class which takes a <code>MyClass</code> parameter and assigned it to the <code>check</code> member. Then, when you create that class from a <code>MyClass</code> method, pass <code>this</code>, then the explicit assignment is unnecessary."}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 1, "creation_date": 1473273183, "post_id": 39376648, "comment_id": 66081730, "body": "Not very clear what you are asking. Are you asking for different syntax for <code>GUI.MyClass = this</code>? (Side note: you never &quot;assign a class&quot; in C# - maybe &quot;assign instance of the class&quot;... Also title of the post makes absolutely no sense as you can&#39;t assign anything to <code>this</code> at all)"}, {"owner": {"reputation": 1094, "user_id": 1738105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9679830f83045615ac9c28d3884a89e4?s=128&d=identicon&r=PG", "display_name": "Botond Botos", "link": "https://stackoverflow.com/users/1738105/botond-botos"}, "reply_to_user": {"reputation": 18960, "user_id": 3312, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d66d5925cf7d5fc1375ddfd93335a921?s=128&d=identicon&r=PG", "display_name": "Jesse C. Slicer", "link": "https://stackoverflow.com/users/3312/jesse-c-slicer"}, "edited": false, "score": 2, "creation_date": 1473273446, "post_id": 39376648, "comment_id": 66081835, "body": "I assume that your <i>WindowClass</i> instance needs a reference to the <i>MyClass</i> instance. If this is the case, then I think @JesseC.Slicer &#39;s proposal is the way to go. But what do you find complicated about  <code>GUI.Check = this</code>?"}, {"owner": {"reputation": 89, "user_id": 5202021, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s_IA8csRtFg/AAAAAAAAAAI/AAAAAAAAAxE/ytJPgvXE3Fg/photo.jpg?sz=128", "display_name": "Arne Peirs", "link": "https://stackoverflow.com/users/5202021/arne-peirs"}, "reply_to_user": {"reputation": 1094, "user_id": 1738105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9679830f83045615ac9c28d3884a89e4?s=128&d=identicon&r=PG", "display_name": "Botond Botos", "link": "https://stackoverflow.com/users/1738105/botond-botos"}, "edited": false, "score": 0, "creation_date": 1473275206, "post_id": 39376648, "comment_id": 66082649, "body": "I went for the proposal of JesseC.Slicer. @botond.botos I don&#39;t find it complicated, I just wondered if there was a simpler way to do this."}, {"owner": {"reputation": 1094, "user_id": 1738105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9679830f83045615ac9c28d3884a89e4?s=128&d=identicon&r=PG", "display_name": "Botond Botos", "link": "https://stackoverflow.com/users/1738105/botond-botos"}, "edited": false, "score": 0, "creation_date": 1473275880, "post_id": 39376648, "comment_id": 66082978, "body": "Sorry, sometimes my thinking becomes binary: if somebody is looking for a simpler solution I suppose the previous one was complicated :)"}], "answers": [{"tags": [], "owner": {"reputation": 1431, "user_id": 181832, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3783c5da15777937ad9cc34515b2989f?s=128&d=identicon&r=PG", "display_name": "Joy George Kunjikkuru", "link": "https://stackoverflow.com/users/181832/joy-george-kunjikkuru"}, "is_accepted": false, "score": 0, "last_activity_date": 1473272612, "creation_date": 1473272612, "answer_id": 39376795, "question_id": 39376648, "link": "https://stackoverflow.com/questions/39376648/assign-a-class-to-a-this-keyword/39376795#39376795", "title": "Assign a class to a this keyword", "body": "<p>Here seems both the classes require reference of other class. Something similar to keeping reference of children and parent in winforms and WPF. </p>\n\n<p>Here this means its an object more precisely the current. This seems a general practice to hold references each other.</p>\n\n<p>Another mechanism instead of assigning is to inject via constructor.</p>\n"}], "owner": {"reputation": 89, "user_id": 5202021, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s_IA8csRtFg/AAAAAAAAAAI/AAAAAAAAAxE/ytJPgvXE3Fg/photo.jpg?sz=128", "display_name": "Arne Peirs", "link": "https://stackoverflow.com/users/5202021/arne-peirs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1473275100, "creation_date": 1473271944, "last_edit_date": 1473275100, "question_id": 39376648, "link": "https://stackoverflow.com/questions/39376648/assign-a-class-to-a-this-keyword", "title": "Assign a class to a this keyword", "body": "<p>I'm using these two classes in seperate files to open a window in game. It works, but is there a simpler way to do <code>GUI.Check = this</code> without assigning an instance to the other class. Ex. <code>MyClass = this</code></p>\n\n<p>(Sorry for incorrect naming of things)</p>\n\n<pre><code>public class MyClass\n{\n    public WindowClass GUI;\n\n    public void OpenGUI()\n    {\n        if (!GUI.open)\n        {\n            GUI.Check = this;\n            GUI.open = true;\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<pre><code>public class WindowClass\n{\n    public bool open = false;\n    public MyClass Check;\n\n    public void Display()\n    {\n        if (open)\n        {\n            // GUI stuff here\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 5264, "user_id": 953496, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c4d8f39591139d6e0702459139c69cc6?s=128&d=identicon&r=PG", "display_name": "Demodave", "link": "https://stackoverflow.com/users/953496/demodave"}, "edited": false, "score": 0, "creation_date": 1473271759, "post_id": 39376552, "comment_id": 66081085, "body": "Did you try the Form.Closing event? <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.form.closing.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}, {"owner": {"reputation": 10516, "user_id": 2872388, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8a10ec2ce33bfdb3a0c44e39adf3092b?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2872388/steve"}, "edited": false, "score": 0, "creation_date": 1473271939, "post_id": 39376552, "comment_id": 66081180, "body": "I think Closing event is not gonna fire if the user uses End Process. Looks like mission impossible to me"}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1473272066, "post_id": 39376552, "comment_id": 66081244, "body": "Look at <code>OnClosing</code> Event."}, {"owner": {"reputation": 1431, "user_id": 181832, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3783c5da15777937ad9cc34515b2989f?s=128&d=identicon&r=PG", "display_name": "Joy George Kunjikkuru", "link": "https://stackoverflow.com/users/181832/joy-george-kunjikkuru"}, "edited": false, "score": 0, "creation_date": 1473272853, "post_id": 39376552, "comment_id": 66081570, "body": "Try to catch WM_CLOSE or similar WndProc messages. We tried but was not successful. If its an end process from task manager it is not logical to handle it :)"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4221627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d16a757e6c6dec9acfc8382607946240?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/4221627/nate"}, "edited": false, "score": 0, "creation_date": 1473273028, "post_id": 39376660, "comment_id": 66081655, "body": "This line was the key: &quot;this.FormClosing += new System.Windows.Forms.FormClosingEventHandler(this.Form1_Form&zwnj;&#8203;Closing); &quot;  I was only using Form1_FormClosing but it wasn&#39;t exiting out. Thank you!"}], "tags": [], "owner": {"reputation": 1799, "user_id": 5867869, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/M7o7w.jpg?s=128&g=1", "display_name": "RomCoo", "link": "https://stackoverflow.com/users/5867869/romcoo"}, "is_accepted": true, "score": 1, "last_activity_date": 1473274123, "last_edit_date": 1473274123, "creation_date": 1473271984, "answer_id": 39376660, "question_id": 39376552, "link": "https://stackoverflow.com/questions/39376552/end-a-task-if-the-windows-form-is-also-terminated-through-task-manager/39376660#39376660", "title": "End a task if the windows form is also terminated through task manager", "body": "<p>Add a function to the <code>FormClosing</code> event in the Event Properties of your Form or manually:</p>\n\n<pre><code>this.FormClosing += new System.Windows.Forms.FormClosingEventHandler(this.Form1_FormClosing);\n</code></pre>\n\n<p>And then write:</p>\n\n<pre><code>private void Form1_FormClosing(object sender, FormClosingEventArgs e)\n{\n    Application.Exit();\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4221627, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d16a757e6c6dec9acfc8382607946240?s=128&d=identicon&r=PG&f=1", "display_name": "Nate", "link": "https://stackoverflow.com/users/4221627/nate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 39376660, "answer_count": 1, "score": 3, "last_activity_date": 1473274123, "creation_date": 1473271502, "last_edit_date": 1473272152, "question_id": 39376552, "link": "https://stackoverflow.com/questions/39376552/end-a-task-if-the-windows-form-is-also-terminated-through-task-manager", "title": "End a task if the windows form is also terminated through task manager", "body": "<p>I have a login windows form that pops up when I open MS Access. If the user decides to leave, I have a cancel button that closes the application and MS Access:</p>\n\n<pre><code>private void button2_Click(object sender, EventArgs e)\n{\n    Application.Exit();\n}\n</code></pre>\n\n<p>But I also want to add that if the user terminates the windows form, it will also terminate MS Access.</p>\n\n<p>ie., if windowForm terminated, then Application.Exit</p>\n"}, {"tags": ["c#", "dictionary"], "comments": [{"owner": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "edited": false, "score": 4, "creation_date": 1473271886, "post_id": 39376535, "comment_id": 66081152, "body": "I honestly don&#39;t understand your questions"}, {"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 0, "creation_date": 1473271914, "post_id": 39376535, "comment_id": 66081170, "body": "The list of constructors is <a href=\"https://msdn.microsoft.com/en-us/library/6918612z(v=vs.110).aspx\" rel=\"nofollow noreferrer\">here</a>, so the SO answer you linked is saying that it calls the parameterless one to create the object then adds the things to it later, it doesn&#39;t use some other constructor. You are not making a dictionary constructor, parameterless or otherwise (you have a method, not a constructor), and don&#39;t have to think about making one. As for your other question, yes, the Values are instantiated because it runs that code when the <code>.Add()</code> method runs."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 2, "creation_date": 1473271925, "post_id": 39376535, "comment_id": 66081173, "body": "Dictionary already has a constructor. The compiler doesn&#39;t create a new one for you. Nowhere are you calling a collection initializer, which is the subject of your first boldface blockquote from the documentation. I think you have some mistaken assumptions about the meaning of a lot of the terminology here, and you&#39;re going off on some strange tangent based on your misunderstandings."}, {"owner": {"reputation": 1281, "user_id": 6345259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7fabfc9e3344bddedddaac79ba15892c?s=128&d=identicon&r=PG&f=1", "display_name": "monogate", "link": "https://stackoverflow.com/users/6345259/monogate"}, "reply_to_user": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "edited": false, "score": 0, "creation_date": 1473271938, "post_id": 39376535, "comment_id": 66081179, "body": "@Jonesopolis I Simply wanna know if this code: tempDictionary.Add(&quot;LoginView&quot;, new LoginViewModel()); would be executed and call the LoginViewModel constructor even if I did not call the &quot;LoginView&quot; key in any other part of my program."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1473272014, "post_id": 39376535, "comment_id": 66081222, "body": "What does &quot;class initializer&quot; mean to you, in plain English?"}, {"owner": {"reputation": 1281, "user_id": 6345259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7fabfc9e3344bddedddaac79ba15892c?s=128&d=identicon&r=PG&f=1", "display_name": "monogate", "link": "https://stackoverflow.com/users/6345259/monogate"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1473272059, "post_id": 39376535, "comment_id": 66081239, "body": "@EdPlunkett I&#39;ve edited my post to be more specific"}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1473272098, "post_id": 39376535, "comment_id": 66081259, "body": "@monogate The answer to that question is that yes, that <code>LoginViewModel</code> constructor is called right there. That new instance of <code>LoginViewModel</code> is added to your dictionary, whether or not you ever do anything with that dictionary key again. This is not a LINQ-style deferred thing; it&#39;s all happening right then and there."}, {"owner": {"reputation": 4698, "user_id": 461810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49c81c49603fee4d4ea52e30cd8841a8?s=128&d=identicon&r=PG", "display_name": "Dusan", "link": "https://stackoverflow.com/users/461810/dusan"}, "edited": false, "score": 0, "creation_date": 1473272151, "post_id": 39376535, "comment_id": 66081280, "body": "<i>I Simply wanna know if this code:...</i> Of course it will call <code>LoginViewConstructor</code>"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 4, "creation_date": 1473272203, "post_id": 39376535, "comment_id": 66081304, "body": "@monogate it feels you are missing some very basic knowledge about C#... but unclear what exactly. Asking if line of code will be executed at all when it simply written in the code without any conditions around it does not make much sense to me."}, {"owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "edited": false, "score": 0, "creation_date": 1473272234, "post_id": 39376535, "comment_id": 66081314, "body": "<code>&quot;I simply wanna know if this code [...] would be executed&quot;</code> - Why <i>wouldn&#39;t</i> it?  What would prevent that line of code from executing?"}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1473272442, "post_id": 39376535, "comment_id": 66081395, "body": "When you initialize the dictionay yes it will call the construtor of the View Model, if you want the to happen when you access the dictionary instead, you can create a dictionary of Type <code>&lt;string, Func&lt;ViewModel&gt;&gt;</code> and just invoke a func which will return a new ViewModel () =&gt; {new ViewModel();}"}, {"owner": {"reputation": 2230, "user_id": 1497128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QaOX5.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/1497128/tom"}, "edited": false, "score": 0, "creation_date": 1473280716, "post_id": 39376535, "comment_id": 66085152, "body": "Yes, those constructors are getting invoked. Whenever you call <code>new Class()</code> you are invoking the Class&#39; parameterless constructor. If one does not exist, you will get a compilation error. So your first line declares, instantiates and initializes the dictionary. Then, the next 3 lines add 3 <code>KeyValuePair</code>s of <code>string</code>=&gt;<code>ViewModelBase</code> by invoking the 3 constructors for your 3 models and returning an instance of the object to the Dictionary&#39;s <code>Add</code> method, one at a time."}], "answers": [{"tags": [], "owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "is_accepted": false, "score": 1, "last_activity_date": 1473272490, "last_edit_date": 1473272490, "creation_date": 1473271798, "answer_id": 39376622, "question_id": 39376535, "link": "https://stackoverflow.com/questions/39376535/c-how-does-dictionary-work-when-we-initialize-a-class-within-as-a-value/39376622#39376622", "title": "C# How does Dictionary work when we initialize a class within as a value?", "body": "<p><strong>NOTE</strong> When you initialize the dictionay yes it will call the construtor of the View Model, if you want the to happen when you access the dictionary instead, you can create a dictionary of Type <code>&lt;string, Func&lt;ViewModel&gt;&gt;</code> and just invoke an Function which will return a new ViewModel <code>() =&gt; {new ViewModel();}</code></p>\n\n<p>There are a few ways to initialize a dictionary in c#</p>\n\n<ol>\n<li><p>You can use the syntax you are using which will create the dictionary then initialize the values using add.</p>\n\n<pre><code>public static Dictionary&lt;string, ViewModelBase&gt; LoadDictionary()\n{\n    Dictionary&lt;string, ViewModelBase&gt; tempDictionary = new Dictionary&lt;string, ViewModelBase&gt;();\n    tempDictionary.Add(\"LoginView\", new LoginViewModel());\n    tempDictionary.Add(\"SignUpView\", new SignUpViewModel());\n    tempDictionary.Add(\"ContactListView\", new ContactListViewModel());\n    return tempDictionary;\n}\n</code></pre></li>\n<li><p>You can create it using initializers the C#5 and older way would be like this:</p>\n\n<pre><code>public static Dictionary&lt;string, ViewModelBase&gt; LoadDictionary()\n{\n     return new Dictionary&lt;string, ViewModelBase&gt;() { \n         {\"LoginView\", new LoginViewModel()},\n         {\"SignUpView\", new SignUpViewModel()}, \n         {\"ContactListView\", new ContactListViewModel()} \n     };\n}\n</code></pre>\n\n<p><em>Note</em> this is risky because you can initialize a dictionary with the same key which will cause an error</p></li>\n</ol>\n\n<p>This way under the hood calls the Add method what is even more interesting is that you can overload the Add method to modify the way you add things to the dictionary, meaning if you create an overload for Add which takes (int, ViewModelBase) and say you called int.ToString() internally you can use int's in the initializer as well.</p>\n\n<ol start=\"3\">\n<li><p>In C# 6.0 and greater there is a new way to initialize dictionaries which is like this:</p>\n\n<pre><code>Dictionary&lt;string, Customer&gt; cList = new Dictionary&lt;string, Customer&gt;()\n{\n   [\"LoginView\"] = new LoginViewModel(),\n   [\"SignUpView\"] = new SignUpViewModel()\n};\n</code></pre></li>\n</ol>\n\n<p>The benefit of using this way is that if you add an entry to the dictionary with the same value it will override the old value and not cause an error you can find more information on it <a href=\"https://msdn.microsoft.com/en-us/magazine/dn802602.aspx\" rel=\"nofollow\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 175722, "user_id": 328193, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FnwU5.jpg?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/328193/david"}, "is_accepted": true, "score": 0, "last_activity_date": 1473272044, "creation_date": 1473272044, "answer_id": 39376672, "question_id": 39376535, "link": "https://stackoverflow.com/questions/39376535/c-how-does-dictionary-work-when-we-initialize-a-class-within-as-a-value/39376672#39376672", "title": "C# How does Dictionary work when we initialize a class within as a value?", "body": "<blockquote>\n  <p>Does the compiler first creates a constructor (parameterless ctor) and only then add my KeyValuePairs?</p>\n</blockquote>\n\n<p>The compiler doesn't have to <em>create</em> anything.  <code>Dictionary&lt;&gt;</code> has a parameterless constructor, which you're calling here:</p>\n\n<pre><code>new Dictionary&lt;string, ViewModelBase&gt;();\n</code></pre>\n\n<p>You're simply invoking the constructor, passing no parameters, and getting back an instance of a <code>Dictionary&lt;string, ViewModelBase&gt;</code>.</p>\n\n<blockquote>\n  <p>When I add my KeyValuePairs, are the Values also instantiated?</p>\n</blockquote>\n\n<p>They're instantiated, because you're instantiating them:</p>\n\n<pre><code>new LoginViewModel()\n</code></pre>\n\n<p>Like any other constructor, this creates a new instance of the class.</p>\n\n<hr />\n\n<p>Note that none of the code you're showing really has anything to do with class initializers.  An initializer for a collection type (like a <code>Dictionary&lt;&gt;</code>) might look something like this:</p>\n\n<pre><code>Dictionary&lt;string, ViewModelBase&gt; tempDictionary = new Dictionary&lt;string, ViewModelBase&gt;() { \n     {\"LoginView\", new LoginViewModel()},\n     {\"SignUpView\", new SignUpViewModel()}, \n     {\"ContactListView\", new ContactListViewModel()} \n }\n</code></pre>\n\n<p>Which is compiled to essentially the equivalent of what you have:</p>\n\n<pre><code>Dictionary&lt;string, ViewModelBase&gt; tempDictionary = new Dictionary&lt;string, ViewModelBase&gt;();\ntempDictionary.Add(\"LoginView\", new LoginViewModel());\ntempDictionary.Add(\"SignUpView\", new SignUpViewModel());\ntempDictionary.Add(\"ContactListView\", new ContactListViewModel());\n</code></pre>\n\n<p>It's not <em>entirely</em> clear where your confusion is on the subject, but essentially all any of this code does is create instances of objects.</p>\n"}, {"tags": [], "owner": {"reputation": 1094, "user_id": 1738105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9679830f83045615ac9c28d3884a89e4?s=128&d=identicon&r=PG", "display_name": "Botond Botos", "link": "https://stackoverflow.com/users/1738105/botond-botos"}, "is_accepted": false, "score": 0, "last_activity_date": 1473272134, "creation_date": 1473272134, "answer_id": 39376686, "question_id": 39376535, "link": "https://stackoverflow.com/questions/39376535/c-how-does-dictionary-work-when-we-initialize-a-class-within-as-a-value/39376686#39376686", "title": "C# How does Dictionary work when we initialize a class within as a value?", "body": "<p>Yes, the <em>tempDictionary.Add(\"LoginView\", new LoginViewModel());</em> expression will create a new instance of the <em>LoginViewModel</em> class, even if you never tried to access the <em>LoginView</em> key of the <em>tempDictionary</em> dictionary object.</p>\n"}, {"tags": [], "owner": {"reputation": 23466, "user_id": 1786428, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FFtkI.jpg?s=128&g=1", "display_name": "Jonesopolis", "link": "https://stackoverflow.com/users/1786428/jonesopolis"}, "is_accepted": false, "score": 0, "last_activity_date": 1473272200, "creation_date": 1473272200, "answer_id": 39376701, "question_id": 39376535, "link": "https://stackoverflow.com/questions/39376535/c-how-does-dictionary-work-when-we-initialize-a-class-within-as-a-value/39376701#39376701", "title": "C# How does Dictionary work when we initialize a class within as a value?", "body": "<p>Going off your comment:</p>\n\n<blockquote>\n  <p>@Jonesopolis I Simply wanna know if this code: </p>\n</blockquote>\n\n<pre><code>tempDictionary.Add(\"LoginView\", new LoginViewModel()); \n</code></pre>\n\n<blockquote>\n  <p>would be executed and call the LoginViewModel constructor even if I did not call the \"LoginView\" key in any other part of my program.</p>\n</blockquote>\n\n<p>this code is the same as:</p>\n\n<pre><code>var vm = new LoginViewModel();\ntempDictionary.Add(\"LoginView, vm);\n</code></pre>\n\n<p>the expression that constructs the object (<code>new LoginViewModel()</code>) is executed first, then the resulting value is passing into the <code>Add</code> method on the dictionary.  So yes, your object is constructed before being passed into the dictionary.  </p>\n\n<p>You could write a very simple program to have tested this yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": false, "score": 0, "last_activity_date": 1506706019, "last_edit_date": 1592644375, "creation_date": 1473276774, "answer_id": 39377741, "question_id": 39376535, "link": "https://stackoverflow.com/questions/39376535/c-how-does-dictionary-work-when-we-initialize-a-class-within-as-a-value/39377741#39377741", "title": "C# How does Dictionary work when we initialize a class within as a value?", "body": "<blockquote>\n<p>I Simply wanna know if this code:</p>\n<pre><code>tempDictionary.Add(&quot;LoginView&quot;, new LoginViewModel());\n</code></pre>\n<p>would be executed and call the LoginViewModel constructor even if I did not call the &quot;LoginView&quot; key in any other part of my program.</p>\n</blockquote>\n<p>Yep, the constructor is called right then and there in the code.  If you want to lazy load them, you can try the <a href=\"https://msdn.microsoft.com/en-us/library/dd642331(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>Lazy&lt;T&gt;</code></a> class as well.</p>\n<pre><code>var deferredConstructionDict = new Dictionary&lt;string, Lazy&lt;ViewModelBase&gt;&gt;();\ndeferredConstructionDict.Add(&quot;LoginView&quot;, new Lazy&lt;ViewModelBase&gt;(() =&gt; new LoginViewModel()));\ndeferredConstructionDict.Add(&quot;SignUpView&quot;, new Lazy&lt;ViewModelBase&gt;(() =&gt; new SignUpViewModel()));\ndeferredConstructionDict.Add(&quot;ContactListView&quot;, new Lazy&lt;ViewModelBase&gt;(() =&gt; new ContactListViewModel()));\n</code></pre>\n<p>Then get your models by accessing the <code>Value</code> property on your Dictionary values.</p>\n<pre><code>var modelKey = &quot;LoginView&quot;;\nvar myModelFromKey = deferredConstructionDict[modelKey].Value;\n</code></pre>\n<p>ORIGINAL POST:</p>\n<p>I think there's a fundamental misunderstanding in your question that isn't addressed in the other answers.</p>\n<blockquote>\n<p>How does <code>Dictionary</code> work when we initialize a class within as a value?</p>\n</blockquote>\n<p>I believe what you mean by &quot;class within&quot; is that your <code>Dictionary&lt;string, ViewModelBase&gt;</code> type contains a type <code>ViewModelBase</code> as the 2nd generic type.  The <code>Dictionary&lt;T,U&gt;</code> type is a generic type, which has special rules in C#.  C# doesn't call the constructor of the type <code>T</code> or <code>U</code> when it calls the constructor of <code>Dictionary&lt;T, U&gt;</code>, it simply understands the type information about <code>T</code> and about <code>U</code> so that the runtime knows how to deal with the objects stored in the dictionary when you reference them later.</p>\n<p>Basically generic types (in your case I'm referring to <code>string</code> and <code>ViewModelBase</code>) are placeholders for the runtime, and the way C# deals with them is that when a generic is used, the runtime should be able to figure out how to handle them <strong>no matter what type is used</strong> when you create an instance of the generic type.  This means that, even if it did makes sense to do so, the <code>Dictionary&lt;T,U&gt;</code> constructor can't call <code>new ViewModelBase()</code> above because not all types have a constructor!  (<code>ICloneable</code> for instance).  In C#, <a href=\"https://stackoverflow.com/a/31222658/3960399\">a type is simply some information it knows about an object</a> which it uses both at compile and runtime to determine what to do with it.</p>\n<blockquote>\n<p>Does the compiler first creates a constructor (parameterless ctor) and only then add my KeyValuePairs?</p>\n</blockquote>\n<p>Nope.  You write constructors, and you call constructors.  C# calls constructors implicitly only in rare cases (using reflection, for instance).</p>\n"}], "owner": {"reputation": 1281, "user_id": 6345259, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7fabfc9e3344bddedddaac79ba15892c?s=128&d=identicon&r=PG&f=1", "display_name": "monogate", "link": "https://stackoverflow.com/users/6345259/monogate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 39376672, "answer_count": 5, "score": -1, "last_activity_date": 1507093517, "creation_date": 1473271395, "last_edit_date": 1507093517, "question_id": 39376535, "link": "https://stackoverflow.com/questions/39376535/c-how-does-dictionary-work-when-we-initialize-a-class-within-as-a-value", "title": "C# How does Dictionary work when we initialize a class within as a value?", "body": "<p>Assuming I have the following code:</p>\n\n<pre><code>public static Dictionary&lt;string, ViewModelBase&gt; LoadDictionary()\n{\n    Dictionary&lt;string, ViewModelBase&gt; tempDictionary = new Dictionary&lt;string, ViewModelBase&gt;();\n    tempDictionary.Add(\"LoginView\", new LoginViewModel());\n    tempDictionary.Add(\"SignUpView\", new SignUpViewModel());\n    tempDictionary.Add(\"ContactListView\", new ContactListViewModel());\n    return tempDictionary;\n}\n</code></pre>\n\n<p>I refer to this line:</p>\n\n<pre><code>Dictionary&lt;string, ViewModelBase&gt; tempDictionary = new Dictionary&lt;string, ViewModelBase&gt;();\n</code></pre>\n\n<p>Does the compiler first create a constructor (parameterless ctor) and only then add my KeyValuePairs?</p>\n\n<p>If so, how will my parameter ctor would look like (of the LoadDictionary)?</p>\n\n<p>And the most important question relevant to this post is:</p>\n\n<p>When I add my <strong>KeyValuePairs</strong>, are the <strong>Values</strong> also instantiated or do they wait to called and then are instantiated?</p>\n\n<p>I mean to: </p>\n\n<pre><code>new LoginViewModel()\nnew SignUpViewModel()\nnew ContactListViewModel()\n</code></pre>\n\n<p><br></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I Simply want to know if </p>\n\n<pre><code>tempDictionary.Add(\"LoginView\", new LoginViewModel());\n</code></pre>\n\n<p>would be executed and call the LoginViewModel constructor even if I did not call the \"LoginView\" key in any other part of my program.</p>\n"}, {"tags": ["c#", "session"], "comments": [{"owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1473271646, "post_id": 39376495, "comment_id": 66081040, "body": "I don&#39;t understand your first <code>if()</code> check, if <code>HttpContext.Current.Session[&quot;sessionObjects&quot;] == null</code> then you will return that same object casted with the <code>as</code> operator, but since the left side is null you still return <code>null</code>. You need to create a new instance of that object there."}, {"owner": {"reputation": 989, "user_id": 3141617, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/1d29d6696ed89daf5ffaa9f3fa458fe1?s=128&d=identicon&r=PG&f=1", "display_name": "King_Fisher", "link": "https://stackoverflow.com/users/3141617/king-fisher"}, "reply_to_user": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1473271901, "post_id": 39376495, "comment_id": 66081161, "body": "I&#39;m using static class, then why should new instance needed ?"}, {"owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1473272195, "post_id": 39376495, "comment_id": 66081302, "body": "But the property <code>CommonHelper.sessionObjects</code> will return <code>null</code> in the case above. Check that with <code>var sess = CommonHelper.sessionObjects; if(sess == null) Console.WriteLine(&quot;Null reference.&quot;); else Console.WriteLine(&quot;Got non-null.&quot;);</code>."}, {"owner": {"reputation": 989, "user_id": 3141617, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/1d29d6696ed89daf5ffaa9f3fa458fe1?s=128&d=identicon&r=PG&f=1", "display_name": "King_Fisher", "link": "https://stackoverflow.com/users/3141617/king-fisher"}, "reply_to_user": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "edited": false, "score": 0, "creation_date": 1473272757, "post_id": 39376495, "comment_id": 66081526, "body": "Yes you are right, it is coming null. how can I create an instance and use the instance here.@MaximilianGerhardt"}], "answers": [{"tags": [], "owner": {"reputation": 4852, "user_id": 5296568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/25003db0bef370470e0f669a542960f8?s=128&d=identicon&r=PG&f=1", "display_name": "Maximilian Gerhardt", "link": "https://stackoverflow.com/users/5296568/maximilian-gerhardt"}, "is_accepted": true, "score": 3, "last_activity_date": 1473273126, "creation_date": 1473273126, "answer_id": 39376905, "question_id": 39376495, "link": "https://stackoverflow.com/questions/39376495/set-and-get-session-values-in-httpcontext-current-session-in-c/39376905#39376905", "title": "Set and get session values in HttpContext.Current.Session in C#", "body": "<p>Try creating a new instance of the <code>SessionObjects</code> class when the <code>SessionObjects</code> object of the current instance is <code>null</code>.</p>\n\n<pre><code> public static  class CommonHelper\n    {    \n        public static SessionObjects sessionObjects\n        {\n            get\n            {\n                if ((HttpContext.Current.Session[\"sessionObjects\"] == null))\n                    HttpContext.Current.Session.Add(\"sessionObjects\", new SessionObjects()); \n                return HttpContext.Current.Session[\"sessionObjects\"] as SessionObjects;\n            }\n            set { HttpContext.Current.Session[\"sessionObjects\"] = value; }\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 989, "user_id": 3141617, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/1d29d6696ed89daf5ffaa9f3fa458fe1?s=128&d=identicon&r=PG&f=1", "display_name": "King_Fisher", "link": "https://stackoverflow.com/users/3141617/king-fisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13654, "favorite_count": 0, "accepted_answer_id": 39376905, "answer_count": 1, "score": 2, "last_activity_date": 1473273126, "creation_date": 1473271255, "last_edit_date": 1473271782, "question_id": 39376495, "link": "https://stackoverflow.com/questions/39376495/set-and-get-session-values-in-httpcontext-current-session-in-c", "title": "Set and get session values in HttpContext.Current.Session in C#", "body": "<p>I have static class called CommoonHelper.</p>\n\n<pre><code> public static  class CommonHelper\n    {\n\n        public static SessionObjects sessionObjects\n        {\n            get\n            {\n\n                if ((HttpContext.Current.Session[\"sessionObjects\"] == null))\n                {\n\n                    return null;\n                }\n                else\n                {\n                    return HttpContext.Current.Session[\"sessionObjects\"] as SessionObjects;\n                }\n            }\n            set {\n                HttpContext.Current.Session[\"sessionObjects\"] = value;\n            }\n        }\n\n    }\n</code></pre>\n\n<p>In SessionObjects Class, I have defined properties for get /set like below.</p>\n\n<pre><code> public class SessionObjects\n    {\n        public  int UserId { get; set; }\n        public string FirstName { get; set; }\n        public string LastName { get; set; }\n        public string UserName { get; set; }\n        public string DisplayName\n        {\n            get\n            {\n              return  FirstName + \"\" + LastName;\n            }\n        }\n    }\n</code></pre>\n\n<p>When i try to assign an value like below.</p>\n\n<pre><code>CommonHelper.sessionObjects.LastName = \"test\";\n</code></pre>\n\n<p>Its throwing the below exception.</p>\n\n<pre><code>System.NullReferenceException: Object reference not set to an instance of an object.\n</code></pre>\n\n<p>How do i fix this ?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 17586, "user_id": 3482140, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/lSFth.jpg?s=128&g=1", "display_name": "Am_I_Helpful", "link": "https://stackoverflow.com/users/3482140/am-i-helpful"}, "edited": false, "score": 1, "creation_date": 1473271200, "post_id": 39376447, "comment_id": 66080824, "body": "I&#39;m voting to close this question as off-topic and it may be better suited for Code Review SE!"}, {"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1473271241, "post_id": 39376447, "comment_id": 66080850, "body": "Is doing this in an async method an option?"}, {"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 1, "creation_date": 1473271249, "post_id": 39376447, "comment_id": 66080856, "body": "You can&#39;t speed it up, unless you want the code to continue <i>before</i> the spawned process is even done doing whatever it&#39;s doing. Chances are you need to speed up the program you are spawning, or, there&#39;s nothing you can do. Some things take time and you can&#39;t get around that."}, {"owner": {"reputation": 490, "user_id": 2296156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3fd290e1a4daf0251c518a35e2de099?s=128&d=identicon&r=PG", "display_name": "MacWise", "link": "https://stackoverflow.com/users/2296156/macwise"}, "edited": false, "score": 0, "creation_date": 1473271368, "post_id": 39376447, "comment_id": 66080909, "body": "If you don&#39;t need to wait forexit, then don&#39;t call WaitForExit()"}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 2, "creation_date": 1473271479, "post_id": 39376447, "comment_id": 66080959, "body": "You should probably modify the process you&#39;re starting to handle the batch itself instead of spawning a new process for each image"}, {"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 1, "creation_date": 1473271564, "post_id": 39376447, "comment_id": 66081002, "body": "Do you <i>have</i> to wait for each file to finish processing before you can process the next one? If not, you can save the waiting until the after the loop has fired off all the processes."}, {"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1473273060, "post_id": 39376447, "comment_id": 66081675, "body": "You could do a Parallel.ForEach here; it doesn&#39;t seem necessary to run all of the items serially."}], "answers": [{"tags": [], "owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "is_accepted": false, "score": 4, "last_activity_date": 1473271901, "creation_date": 1473271901, "answer_id": 39376641, "question_id": 39376447, "link": "https://stackoverflow.com/questions/39376447/c-using-process-start-efficiently/39376641#39376641", "title": "c# Using Process.start () efficiently", "body": "<p>If you don't <em>have</em> to wait for the previous file to finish before you start the next one, you could try something like this:</p>\n\n<pre><code>// for each file, spawn a task to do your processing\nvar tasks = (from jpegfile in files\n            select Task.Run(() =&gt;\n            {\n                 // set up your process here...\n                 process.Start();\n                 // task won't be done until process exits\n                 process.WaitForExit();\n            }).ToArray();\n// Wait for all the tasks to be done\nTask.WaitAll(tasks);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 4950830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8024ec3c17b06441cdf42dd1c9a53e?s=128&d=identicon&r=PG&f=1", "display_name": "Quant", "link": "https://stackoverflow.com/users/4950830/quant"}, "edited": false, "score": 0, "creation_date": 1473299009, "post_id": 39377152, "comment_id": 66090393, "body": "Parallel.forEach() did the magic, i saw some 25-30% improvement in terms of cpu usage, time taken"}, {"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "reply_to_user": {"reputation": 51, "user_id": 4950830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8024ec3c17b06441cdf42dd1c9a53e?s=128&d=identicon&r=PG&f=1", "display_name": "Quant", "link": "https://stackoverflow.com/users/4950830/quant"}, "edited": false, "score": 0, "creation_date": 1473351608, "post_id": 39377152, "comment_id": 66117788, "body": "@Quant glad to hear it helped. Please consider marking this as the answer if it helped resolve the issue."}, {"owner": {"reputation": 407, "user_id": 86973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f700ff7d6cc95db1acdb5799e2c64175?s=128&d=identicon&r=PG", "display_name": "PRMan", "link": "https://stackoverflow.com/users/86973/prman"}, "edited": false, "score": 0, "creation_date": 1599006229, "post_id": 39377152, "comment_id": 112637428, "body": "You could also replace &quot;delegate (string file)&quot; with &quot;file =&gt;&quot;"}], "tags": [], "owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1473275011, "last_edit_date": 1473275011, "creation_date": 1473274135, "answer_id": 39377152, "question_id": 39376447, "link": "https://stackoverflow.com/questions/39376447/c-using-process-start-efficiently/39377152#39377152", "title": "c# Using Process.start () efficiently", "body": "<p>You could spawn a bunch of tasks and do a Task.WaitAll, as shown in Matt Burland's answer.</p>\n\n<p>A few other options are as follows. (I haven't tested these <em>too</em> thoroughly so you'll probably want to do so). First, you could use an event instead of WaitForExit:</p>\n\n<pre><code>private int counter = 0;\n    int sumOfImages = 10; // Set this to the number of files\n\n    private void ProcessStart(List&lt;string&gt; files)\n    {\n        foreach (string file in files)\n        {\n            Process process = new Process();\n            process.StartInfo.UseShellExecute = false;\n            // You can start any process, HelloWorld is a do-nothing example.\n            process.StartInfo.FileName = \"cmd.exe\";\n            process.StartInfo.Arguments = \"someCommand\";\n            process.StartInfo.CreateNoWindow = true;\n            process.EnableRaisingEvents = true;\n            process.Exited += Process_Exited;\n\n            process.Start();\n        }\n    }\n\n    private void Process_Exited(object sender, EventArgs e)\n    {\n        int result = Interlocked.Increment(ref counter);\n\n        int percentComplete = ((result / sumOfImages) * 100);\n\n        worker.ReportProgress(percentComplete);\n    }\n</code></pre>\n\n<p>You could, if you wanted, put the whole thing on the Thread Pool. I actually like this as an answer - the CPU-bound part of this is creating and starting the processes and that would put that on a background thread so it wouldn't hang your UI. It would eliminate the overhead of waiting for a result, which isn't CPU-bound.</p>\n\n<p>Here's an illustration. Suppose you go to a restaurant with 10 people. When the waiter comes, 9 out of the 10 people are ready to order. The waiter happens to ask that guy for his order first. At this point, everyone at the table could either wait around for him to decide or the waiter can take orders from the 9 other people at the table and come back to the first guy. Odds are it would be rather pointless to bring in an additional waiter to wait for the first guy's order while the original waiter takes the other 9 orders. If absolutely necessary the waiter could take the 9 orders to the kitchen and come back to take the first guy's order.</p>\n\n<p>Point being that if it's just a matter of waiting for results from one of the people bringing in additional waiters isn't necessarily going to give you much of a performance boost.</p>\n\n<p>Obviously in this analogy the waiter is a thread and the people are tasks that need to be accomplished. In the above solution, you have a single waiter (the Thread Pool thread) service all of the people (create all of the processes) and then the people (processes) tell him when they're ready to order (i.e. the process raises the event). He then tells the kitchen their order (raises the ReportProgress event on the Worker).</p>\n\n<p>Another option would be a Parallel.ForEach loop:</p>\n\n<pre><code>private void ProcessStart(List&lt;string&gt; files)\n    {\n        int sumOfImages = files.Count;\n        int count = 0;\n        string command = \"\";\n\n        Parallel.ForEach(files,\n            delegate (string file)\n            {\n                Process process = new Process();\n                process.StartInfo.UseShellExecute = false;\n                // You can start any process, HelloWorld is a do-nothing example.\n                process.StartInfo.FileName = \"cmd.exe\";\n                process.StartInfo.Arguments = command;\n                process.StartInfo.CreateNoWindow = true;\n\n                process.Start();\n\n                process.WaitForExit();\n\n                int result = Interlocked.Increment(ref count);\n\n                int percentComplete = ((result / sumOfImages) * 100);\n\n                worker.ReportProgress(percentComplete);\n            });\n    }\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4950830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a8024ec3c17b06441cdf42dd1c9a53e?s=128&d=identicon&r=PG&f=1", "display_name": "Quant", "link": "https://stackoverflow.com/users/4950830/quant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5155, "favorite_count": 1, "accepted_answer_id": 39377152, "answer_count": 2, "score": 2, "last_activity_date": 1610541352, "creation_date": 1473271030, "last_edit_date": 1523527788, "question_id": 39376447, "link": "https://stackoverflow.com/questions/39376447/c-using-process-start-efficiently", "title": "c# Using Process.start () efficiently", "body": "<p>Below is the piece of code, this piece of code joins two file to generate another file.</p>\n\n<pre><code>foreach (string jpegfile in files)\n{\n    string fileName = jpegfile + \".dcm\";\n    string ConfigFile =GetFileNameWithoutExtension(jpegfile) + \".cfg\";\n    string destFile = System.IO.Path.Combine(DirectoryPath, fileName);\n    string command = \"/C \" + batFileName + \" -C \" + patientConfigFile + \" \" + jpegfile + \" \" + destFile;\n    try\n    {\n        System.Diagnostics.Process process = new System.Diagnostics.Process();\n        process.StartInfo.UseShellExecute = false;\n        // You can start any process, HelloWorld is a do-nothing example.\n        process.StartInfo.FileName = \"cmd.exe\";\n        process.StartInfo.Arguments = command;\n        process.StartInfo.CreateNoWindow = true;\n\n\n        process.Start();\n\n        process.WaitForExit();\n\n        this.counter++;\n\n        // Report progress as a percentage of the total task.\n        int percentComplete =\n        (int)((float)this.counter / (float)form.sumofImages * 100);\n        if (percentComplete &gt; highestPercentageReached)\n        {\n            highestPercentageReached = percentComplete;\n            worker.ReportProgress(percentComplete);\n        }\n\n     }\n     catch (Exception exp)\n     {\n         MessageBoxButtons buttons = MessageBoxButtons.OK;\n         DialogResult result;\n         result = MessageBox.Show(\"Batch File execution error \" + exp, \"Warning\", buttons);\n     }\n}\n</code></pre>\n\n<p>My question is, if i use waitforexit() after start() my code takes good amount of time. How can i speed up the above loop?</p>\n"}, {"tags": ["c#", "nullable"], "comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1473271496, "post_id": 39376424, "comment_id": 66080966, "body": "God forbid duplicates actually get closed as duplicates when people could just be repeating the exact same answer to get more Imaginary Internet Points for accomplishing nothing..."}], "answers": [{"tags": [], "owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "is_accepted": true, "score": 6, "last_activity_date": 1473271053, "creation_date": 1473271053, "answer_id": 39376451, "question_id": 39376424, "link": "https://stackoverflow.com/questions/39376424/best-practice-for-initializing-a-nullable-integer-to-default-value/39376451#39376451", "title": "Best practice for initializing a nullable integer to default value?", "body": "<p>No functional difference.  All three must instantiate an <code>int?</code>, and then since the default is <code>HasValue == false</code>, none of them require a subsequent member assignment.</p>\n"}, {"tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": false, "score": 0, "last_activity_date": 1473271341, "creation_date": 1473271341, "answer_id": 39376520, "question_id": 39376424, "link": "https://stackoverflow.com/questions/39376424/best-practice-for-initializing-a-nullable-integer-to-default-value/39376520#39376520", "title": "Best practice for initializing a nullable integer to default value?", "body": "<p>In your examples the best way to do it is:</p>\n\n<pre><code>int? xPosition = null;\n</code></pre>\n\n<p>However, in different scenarios, the other ways can be better, or even the only possibility. For example, in code that receives data of different types, <code>default</code> is the way to go because the default value depends on the type and it is not always <code>null</code>. For example, if some code may receive <code>int</code> or <code>int?</code>, then you don't know whether the default is zero on <code>null</code>, so using <code>default</code> guarantees that you will get the correct default value.</p>\n\n<p>An example of such scenario can is when using LINQ.</p>\n"}, {"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1473271677, "creation_date": 1473271677, "answer_id": 39376589, "question_id": 39376424, "link": "https://stackoverflow.com/questions/39376424/best-practice-for-initializing-a-nullable-integer-to-default-value/39376589#39376589", "title": "Best practice for initializing a nullable integer to default value?", "body": "<p>These are all equivalent according to the specification:</p>\n\n<p><strong>4.1.10 Nullable types</strong></p>\n\n<blockquote>\n  <p>An instance for which HasValue is false is said to be null. A null instance has an undefined value</p>\n</blockquote>\n\n<p><strong>4.1.2 Default constructors</strong></p>\n\n<p>All value types implicitly declare a public parameterless instance constructor called the default constructor. The default constructor returns a zero-initialized instance known as the default valuefor the value type:</p>\n\n<p>\u2022   For a struct-type, the default value is the value produced by setting all value type fields to their default value and all reference type fields to null.</p>\n\n<p>nullable types are structs and <code>HasValue</code> is a bool with a default value of <code>false</code> so <code>new int?()</code> is null.</p>\n\n<p><strong>5.2 Default values</strong></p>\n\n<p>The default value of a variable depends on the type of the variable and is determined as follows:</p>\n\n<p>\u2022   For a variable of a value-type, the default value is the same as the value computed by the value-type\u2019s default constructor (\u00a74.1.2).</p>\n\n<p>so <code>default(int?)</code> is equivalent to <code>new int?()</code></p>\n"}], "owner": {"reputation": 24277, "user_id": 633438, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/KWSpX.png?s=128&g=1", "display_name": "Sean Anderson", "link": "https://stackoverflow.com/users/633438/sean-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2303, "favorite_count": 0, "accepted_answer_id": 39376451, "answer_count": 3, "score": 5, "last_activity_date": 1473271677, "creation_date": 1473270918, "question_id": 39376424, "link": "https://stackoverflow.com/questions/39376424/best-practice-for-initializing-a-nullable-integer-to-default-value", "title": "Best practice for initializing a nullable integer to default value?", "body": "<p>I ran into some code which is setting a nullable integer like so:</p>\n\n<pre><code>int? xPosition = new int?();\n</code></pre>\n\n<p>This was an unfamiliar syntax for me. I would've expected either of these forms:</p>\n\n<pre><code>int? xPosition = null;\nint? xPosition = default(int?);\n</code></pre>\n\n<p>Are there any functional differences between these three variable declarations?</p>\n"}, {"tags": ["c#", "android", "xamarin"], "comments": [{"owner": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 1, "creation_date": 1473271231, "post_id": 39376381, "comment_id": 66080846, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/26876277/image-xamarin-form\">Image- Xamarin.Form</a>"}, {"owner": {"reputation": 992, "user_id": 854780, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/LRLvY.jpg?s=128&g=1", "display_name": "AndySousa", "link": "https://stackoverflow.com/users/854780/andysousa"}, "reply_to_user": {"reputation": 67998, "user_id": 4984832, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be4bc3e019d1082f7945b8db7ab313c9?s=128&d=identicon&r=PG", "display_name": "SushiHangover", "link": "https://stackoverflow.com/users/4984832/sushihangover"}, "edited": false, "score": 0, "creation_date": 1473271402, "post_id": 39376381, "comment_id": 66080926, "body": "@SushiHangover, this is not a duplicate of that... I have my images in their correct locations (or so I believe I do per the &quot;working with images&quot; documentation)."}, {"owner": {"reputation": 9698, "user_id": 3850012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/50iHw.jpg?s=128&g=1", "display_name": "hvaughan3", "link": "https://stackoverflow.com/users/3850012/hvaughan3"}, "edited": false, "score": 0, "creation_date": 1473271988, "post_id": 39376381, "comment_id": 66081209, "body": "I would suggest deleting all <code>&#47;bin&#47;</code> and <code>&#47;obj&#47;</code> folders in your Forms and Android projects and then completely delete the app from the device. Rebuild the solution and try again. I have found that images do not get copied over if the app is already installed on the device."}, {"owner": {"reputation": 992, "user_id": 854780, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/LRLvY.jpg?s=128&g=1", "display_name": "AndySousa", "link": "https://stackoverflow.com/users/854780/andysousa"}, "reply_to_user": {"reputation": 9698, "user_id": 3850012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/50iHw.jpg?s=128&g=1", "display_name": "hvaughan3", "link": "https://stackoverflow.com/users/3850012/hvaughan3"}, "edited": false, "score": 0, "creation_date": 1473272625, "post_id": 39376381, "comment_id": 66081466, "body": "Thanks @hvaughan3, still no luck.  It seems like this should be easy :-("}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 4793628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db0cc4674301216d6a7d28a60b83d7c8?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmeet Khalsa", "link": "https://stackoverflow.com/users/4793628/gurmeet-khalsa"}, "is_accepted": false, "score": 2, "last_activity_date": 1582921912, "creation_date": 1582921912, "answer_id": 60458858, "question_id": 39376381, "link": "https://stackoverflow.com/questions/39376381/xamarin-local-image-from-file-or-resources/60458858#60458858", "title": "Xamarin local image from file or resources", "body": "<p>Create images folder in Xamarin forms project and then add Image to that folder. \nIn properties for the image, set \"Build Action\" to \"Embedded resource\"</p>\n\n<p>For ex: My project name is XTest.\nPath to image is: XTest/images/pic.jpg</p>\n\n<p><a href=\"https://i.stack.imgur.com/6jear.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6jear.png\" alt=\"Solution explorer showing path\"></a></p>\n\n<p>In you cs file you can now use it like this.</p>\n\n<pre><code>    imgLocal.Source = ImageSource.FromResource(\"XTest.images.pic.jpg\");\n</code></pre>\n"}], "owner": {"reputation": 992, "user_id": 854780, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/LRLvY.jpg?s=128&g=1", "display_name": "AndySousa", "link": "https://stackoverflow.com/users/854780/andysousa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1850, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1582921912, "creation_date": 1473270780, "last_edit_date": 1473271465, "question_id": 39376381, "link": "https://stackoverflow.com/questions/39376381/xamarin-local-image-from-file-or-resources", "title": "Xamarin local image from file or resources", "body": "<p>I cannot get my images to show up in Android at all.  I have tried with ImageSource.FromFile and ImageSource.FromResource.</p>\n\n<p>I have read \"Working with Images\" several times and just don't see what I am doing wrong.</p>\n\n<p>From File Example</p>\n\n<pre><code>        var myImage = new Image() {\n            Aspect = Aspect.AspectFill,\n            Source = ImageSource.FromFile(\"backdrop.jpg\")\n        };\n\n        RelativeLayout layout = new RelativeLayout();\n\n        layout.Children.Add(myImage,\n            Constraint.Constant(0),\n            Constraint.Constant(0),\n            Constraint.RelativeToParent((parent) =&gt; { return parent.Width; }),\n            Constraint.RelativeToParent((parent) =&gt; { return parent.Height; }));\n\n        Content = layout; \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/M9QGO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M9QGO.png\" alt=\"enter image description here\"></a></p>\n\n<p>The Build Action is set to: AndroidResource</p>\n\n<p>I always get the NullReference exception with this path</p>\n\n<p><a href=\"https://i.stack.imgur.com/uznZ8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uznZ8.png\" alt=\"enter image description here\"></a></p>\n\n<p>FromResource example</p>\n\n<pre><code>        var myImage = new Image()\n        {\n            Aspect = Aspect.AspectFill,\n            Source = ImageSource.FromResource(\"TTMD_Mobile.Droid.backdrop.jpg\")\n        };\n\n        RelativeLayout layout = new RelativeLayout();\n\n        layout.Children.Add(myImage,\n            Constraint.Constant(0),\n            Constraint.Constant(0),\n            Constraint.RelativeToParent((parent) =&gt; { return parent.Width; }),\n            Constraint.RelativeToParent((parent) =&gt; { return parent.Height; }));\n\n        Content = layout;\n</code></pre>\n\n<p>The Build Action is set to: Embedded Resource</p>\n\n<p>With the FromResource I don't get any exception, just the image doesn't show.</p>\n\n<p>I am fairly new to Xamarin and Android development, my apologies if this has been addressed, I couldn't find a working solution.</p>\n\n<p>EDIT: I do not believe this is a duplicate of that question, I have my images in their correct locations I believe.</p>\n"}, {"tags": ["c#", "multithreading", "design-patterns", "asp.net-web-api", "mstest"], "answers": [{"comments": [{"owner": {"reputation": 4925, "user_id": 980771, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/08c7dccc1f67be5f7d3b41128932e8bf?s=128&d=identicon&r=PG", "display_name": "The Senator", "link": "https://stackoverflow.com/users/980771/the-senator"}, "edited": false, "score": 0, "creation_date": 1473271836, "post_id": 39376605, "comment_id": 66081127, "body": "Hey matey, thanks for the response. Yeah. In MSTest you actually can&#39;t do async stuff. You <i>have</i> to do a .Wait() or a .Result() so in theory this should work. But it doesn&#39;t stop you from spinning off threads on the test itself that don&#39;t finish after the method."}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "reply_to_user": {"reputation": 4925, "user_id": 980771, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/08c7dccc1f67be5f7d3b41128932e8bf?s=128&d=identicon&r=PG", "display_name": "The Senator", "link": "https://stackoverflow.com/users/980771/the-senator"}, "edited": false, "score": 1, "creation_date": 1473323730, "post_id": 39376605, "comment_id": 66099210, "body": "@thesenator Task returning test method have been supported for years in mstest. Most of my unit tests are of that format and they work just fine. What doesn&#39;t work is starting a thread, not waiting for it to finish and the thread throwing an exception after the original test is finished"}, {"owner": {"reputation": 4925, "user_id": 980771, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/08c7dccc1f67be5f7d3b41128932e8bf?s=128&d=identicon&r=PG", "display_name": "The Senator", "link": "https://stackoverflow.com/users/980771/the-senator"}, "reply_to_user": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "edited": false, "score": 1, "creation_date": 1473327639, "post_id": 39376605, "comment_id": 66101562, "body": "@Voo thank you for that, I&#39;ve learnt something new. I&#39;d tried recently and had missed the &#39;async&#39; keyword from the signature which caused the test runner to dislike it (I should have read the error). So you are absolutely right with the signature &#39;public async Task&#39; rather than my failing &#39;public Task&#39; signature. It still (as you say) leaves the problem that the test runner can&#39;t deal with unfinished threads."}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "reply_to_user": {"reputation": 4925, "user_id": 980771, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/08c7dccc1f67be5f7d3b41128932e8bf?s=128&d=identicon&r=PG", "display_name": "The Senator", "link": "https://stackoverflow.com/users/980771/the-senator"}, "edited": false, "score": 0, "creation_date": 1473628500, "post_id": 39376605, "comment_id": 66203765, "body": "@thesenator Wow never ran into that. How weird and seemingly unnecessary to introduce such a distinction!"}], "tags": [], "owner": {"reputation": 1854, "user_id": 5739282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/79cf06ec3e8d873dccb91e43b6d68d3b?s=128&d=identicon&r=PG", "display_name": "Stephen P.", "link": "https://stackoverflow.com/users/5739282/stephen-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1473271871, "last_edit_date": 1473271871, "creation_date": 1473271743, "answer_id": 39376605, "question_id": 39376374, "link": "https://stackoverflow.com/questions/39376374/one-of-my-integration-tests-is-throwing-an-exception-on-an-alternate-thread-whic/39376605#39376605", "title": "One of my integration tests is throwing an exception on an alternate thread which kills MSTest. What is a good pattern to manage this?", "body": "<p>I don't have the rep to comment, otherwise I would just comment this...</p>\n\n<p>Anyhow, I'm not entirely familiar with MSTest and if it allows async test execution (e.g. like XUnit does).</p>\n\n<p>Are you awaiting in your tests? If not, are you blocking properly using <code>var response = obj.ExecuteAsync().Result</code> or <code>obj.ExecuteAsync.Wait()</code>?</p>\n\n<p>If you are blocking properly, then I'd suspect the <code>using</code> statement is disposing early. If that's the case, you could implement IDisposable which would execute during teardown and dispose of your managed items there.</p>\n"}], "owner": {"reputation": 4925, "user_id": 980771, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/08c7dccc1f67be5f7d3b41128932e8bf?s=128&d=identicon&r=PG", "display_name": "The Senator", "link": "https://stackoverflow.com/users/980771/the-senator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473271871, "creation_date": 1473270767, "question_id": 39376374, "link": "https://stackoverflow.com/questions/39376374/one-of-my-integration-tests-is-throwing-an-exception-on-an-alternate-thread-whic", "title": "One of my integration tests is throwing an exception on an alternate thread which kills MSTest. What is a good pattern to manage this?", "body": "<p>I have a number of integration tests that test my services api's and check responses (http response codes and where applicable the body). The api's themselves are hosted in a webapi service in the azure cloud. My integration tests are a separate project that use my proxy to make restful calls to the webapi and check responses and report back success and failure. The integration tests are subsequently executed using MSTest. Every one of my webapi's use an async await pattern and every one of my proxy calls are async and (as far as I can see) I am await'ing in all cases on my test api calls (indeed, I'm not sure you cannot with MSTest). It seems that on some occasions I receive the dreaded </p>\n\n<pre><code>'The agent process was stopped while the test was running.\n</code></pre>\n\n<p>when some failures occur and from what I can tell this is likely to be one of my integration tests failing on <em>another thread</em> other than the test-runner (a known problem). As a point of reference, I have created an IDisposable style pattern for my test scenarios:</p>\n\n<pre><code>using ( var scenario = new TestScenario() )\n{\n    // do some testing stuff\n}\n</code></pre>\n\n<p>which manages and cleans up downloaded files, manages proxy instances and generally logs information. The question is this: Is there a way to use my existing IDisposable pattern here to try/catch any unhandled exceptions that MSTest seems to not be able to cope with? Or am I stuck with having to wrap every test in a try/catch block of their own and unwrap an AggregateException?</p>\n"}, {"tags": ["c#", "wcf", "iis-8.5", "net.tcp", "windows2012"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6805897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a352e029d16100909058095e663aac01?s=128&d=identicon&r=PG&f=1", "display_name": "klester", "link": "https://stackoverflow.com/users/6805897/klester"}, "edited": false, "score": 0, "creation_date": 1473272650, "post_id": 39376414, "comment_id": 66081475, "body": "Everything works fine until the host is renamed. Same config across all existing servers."}], "tags": [], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "is_accepted": false, "score": 0, "last_activity_date": 1473270893, "creation_date": 1473270893, "answer_id": 39376414, "question_id": 39376343, "link": "https://stackoverflow.com/questions/39376343/wcf-service-slow-after-host-renamed/39376414#39376414", "title": "WCF service slow after host renamed", "body": "<p>Try to increase worker process for the designated application pool. Following is an example for your DefaultAppPool. But you might need to change it for your own app pool which isolate your wcf service.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y1bej.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y1bej.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 6805897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a352e029d16100909058095e663aac01?s=128&d=identicon&r=PG&f=1", "display_name": "klester", "link": "https://stackoverflow.com/users/6805897/klester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473270893, "creation_date": 1473270662, "question_id": 39376343, "link": "https://stackoverflow.com/questions/39376343/wcf-service-slow-after-host-renamed", "title": "WCF service slow after host renamed", "body": "<p>Windows Server 2012 R2 / IIS 8.5 / net.tcp</p>\n\n<p>Trying to replace 2008 R2 in my environment by setting up 2012 R2 servers and copying app folder to new server, create IIS site and create each WCF app under the site. Once ready, test and replace server by renaming hosts.</p>\n\n<p>The WCF time for a single function goes from ~2 seconds to load to ~10 seconds or more after only renaming the host.</p>\n\n<p>Using localsystem for each pool being used. Renaming the 2008 R2 server doesn't show to be effected by a rename. I tried other built-in users with no change.</p>\n\n<p>IIS console shows correct hostname, searched registry for any cached (lsa has cached value that shows correct hostname).</p>\n\n<p>I have 30+ 2012 R2 servers running the same, only difference is they were not renamed after setup.</p>\n"}, {"tags": ["c#", "angularjs", "asp.net-web-api", "async-await"], "comments": [{"owner": {"reputation": 23604, "user_id": 1043198, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/fd794fa557e412eefe8aa19251412df8?s=128&d=identicon&r=PG", "display_name": "Ant P", "link": "https://stackoverflow.com/users/1043198/ant-p"}, "edited": false, "score": 0, "creation_date": 1473269847, "post_id": 39376116, "comment_id": 66080184, "body": "Can&#39;t you narrow the problem down to a smaller code example?"}, {"owner": {"reputation": 269, "user_id": 6442646, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f56f841452113365a25c7e437167835c?s=128&d=identicon&r=PG&f=1", "display_name": "r mk r", "link": "https://stackoverflow.com/users/6442646/r-mk-r"}, "reply_to_user": {"reputation": 23604, "user_id": 1043198, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/fd794fa557e412eefe8aa19251412df8?s=128&d=identicon&r=PG", "display_name": "Ant P", "link": "https://stackoverflow.com/users/1043198/ant-p"}, "edited": false, "score": 0, "creation_date": 1473269982, "post_id": 39376116, "comment_id": 66080239, "body": "sure. the problem is happening in the // Add a record into Candidate Login.  section. I add the code to show the full flow."}, {"owner": {"reputation": 23604, "user_id": 1043198, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/fd794fa557e412eefe8aa19251412df8?s=128&d=identicon&r=PG", "display_name": "Ant P", "link": "https://stackoverflow.com/users/1043198/ant-p"}, "edited": false, "score": 4, "creation_date": 1473270045, "post_id": 39376116, "comment_id": 66080269, "body": "So why do we need all the other code? Strip it back until you have a minimal code snippet that still presents the problem."}], "answers": [{"comments": [{"owner": {"reputation": 4285, "user_id": 90259, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lNSMF.jpg?s=128&g=1", "display_name": "joedotnot", "link": "https://stackoverflow.com/users/90259/joedotnot"}, "edited": false, "score": 0, "creation_date": 1555783015, "post_id": 39376438, "comment_id": 98224809, "body": "so there is a problem with async void ? If you have blogged about it please send me the link"}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "reply_to_user": {"reputation": 4285, "user_id": 90259, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lNSMF.jpg?s=128&g=1", "display_name": "joedotnot", "link": "https://stackoverflow.com/users/90259/joedotnot"}, "edited": false, "score": 0, "creation_date": 1555789740, "post_id": 39376438, "comment_id": 98226449, "body": "@joedotnot: My <a href=\"https://msdn.microsoft.com/en-us/magazine/jj991977.aspx\" rel=\"nofollow noreferrer\">article that introduced the phrase &quot;avoid <code>async void</code>&quot;</a> references this problem: &quot;One subtle trap is passing an async lambda to a method taking an Action parameter; in this case, the async lambda returns void and inherits all the problems of async void methods.&quot;"}], "tags": [], "owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "is_accepted": true, "score": 5, "last_activity_date": 1473270961, "creation_date": 1473270961, "answer_id": 39376438, "question_id": 39376116, "link": "https://stackoverflow.com/questions/39376116/asynchronous-module-completed-while-another-operation-is-pending/39376438#39376438", "title": "Asynchronous module completed while another operation is pending", "body": "<p>This kind of error is commonly caused by <code>async void</code>. And I see one right here:</p>\n\n<pre><code>qbEmpsList.ForEach(async e =&gt;\n{\n  ...\n});\n</code></pre>\n\n<p>You'd probably want to make this into a regular <code>foreach</code>:</p>\n\n<pre><code>foreach (var e in qbEmpsList)\n{\n  ...\n}\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 6442646, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f56f841452113365a25c7e437167835c?s=128&d=identicon&r=PG&f=1", "display_name": "r mk r", "link": "https://stackoverflow.com/users/6442646/r-mk-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "accepted_answer_id": 39376438, "answer_count": 1, "score": 1, "last_activity_date": 1473270961, "creation_date": 1473269738, "last_edit_date": 1473270822, "question_id": 39376116, "link": "https://stackoverflow.com/questions/39376116/asynchronous-module-completed-while-another-operation-is-pending", "title": "Asynchronous module completed while another operation is pending", "body": "<p>I am connecting to the Quickbooks api, download the employees inforamtion and saving it to my local database.  I am using angularjs, webapi to accomplish this. I am  getting the following error when I am saving the info to database. I do see all the functions have async and await. Can some body please help me why I am getting this error. </p>\n\n<p>Error : </p>\n\n<blockquote>\n  <p>Server Error in '/' Application.An asynchronous module or handler completed while an asynchronous operation was still pending.</p>\n</blockquote>\n\n<p>Problem is happening in the below pasted piece of code: </p>\n\n<pre><code> var candidate = await CandidateLoginBL.AddCandidateByEmployeeAsync(new CandidateLoginBO()\n                        {\n                            FirstName = e.GivenName,\n                            MiddleName = e.MiddleName,\n                            LastName = e.FamilyName\n          });\n                        }\n                    });\n</code></pre>\n\n<p>The full flow is as follows :</p>\n\n<p>js :</p>\n\n<pre><code>QuickbookModule.factory('QuickbookService', ['$http', function ($http) {\n\n    return {\n getQuickbooksSync: function () {\n            return $http({\n                url: '/api/QuickbookService/syncQuickbooks',\n                method: 'GET',\n                params: { IdCompany: sessionStorage.CID }\n            });\n        }\n</code></pre>\n\n<p>API Controller : </p>\n\n<pre><code>[HttpGet]\n        [Route(\"syncQuickbooks\")]\n        public async Task&lt;IHttpActionResult&gt; syncQuickbooks(int IdCompany)\n        {\n          var result = await QuickbooksBL.FullQuickbooksSync(IdCompany);\n          return Ok(result);\n        }\n</code></pre>\n\n<p>QuickbooksBL : </p>\n\n<pre><code>     public static async Task&lt;List&lt;IncompleteEmp&gt;&gt; FullQuickbooksSync(int IdCompany)\n            {return await SyncronizeEmps(IdCompany); }\n\n        public static async Task&lt;List&lt;IncompleteEmp&gt;&gt; SyncronizeEmps(int companyId)\n            {                   \n                   ......      \n                    List&lt;EmployeeBO&gt; empList = new List&lt;EmployeeBO&gt;();\n                    await AddToHumanEfits(companyId, inQBEmpsInfo);                       ....    \n                }\n                           return IncompleteEmps;\n            }\n\n\n         public static async Task AddToHumanEfits(int companyId, List&lt;EmployeeQbOnlineBO&gt; qbEmpsList)\n            {                \n                  ....\n                    qbEmpsList.ForEach(async e =&gt;\n                    {  \n\n                            // Add a record into Candidate Login. \n\n                      var candidate = await CandidateLoginBL.AddCandidateByEmployeeAsync(new CandidateLoginBO()\n                        {\n                            FirstName = e.GivenName,\n                            MiddleName = e.MiddleName,\n                            LastName = e.FamilyName              });\n                        }\n                    });    \n            }\n</code></pre>\n\n<p>CandidateContactBL : </p>\n\n<pre><code> public static async Task&lt;CandidateLoginBO&gt; AddCandidateByEmployeeAsync(CandidateLoginBO model)\n        {\n            return await CandidateLoginDAL.AddCandidateByEmployeeAsync(model);\n        }\n</code></pre>\n\n<p>CandidateContactDAL : </p>\n\n<pre><code>public static async Task&lt;CandidateLoginBO&gt; AddCandidateByEmployeeAsync(CandidateLoginBO model)\n        {\n            CandidateLoginBO candidate = new CandidateLoginBO();\n\n                candidate = await GetByUserNameAsync(new CandidateLoginBO() { Email = model.Email });                        candidate = await AddEmployeeAsync(model);                   \n            return candidate;\n        }\n</code></pre>\n"}, {"tags": ["c#", "sql", "insert"], "comments": [{"owner": {"reputation": 1068, "user_id": 4651802, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xGV0b.jpg?s=128&g=1", "display_name": "Stivan", "link": "https://stackoverflow.com/users/4651802/stivan"}, "edited": false, "score": 0, "creation_date": 1473269576, "post_id": 39376049, "comment_id": 66080068, "body": "What is the error"}, {"owner": {"reputation": 1314, "user_id": 5886152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e0f45d92950c218c6256bedede7b90?s=128&d=identicon&r=PG", "display_name": "PhillipXT", "link": "https://stackoverflow.com/users/5886152/phillipxt"}, "edited": false, "score": 1, "creation_date": 1473269943, "post_id": 39376049, "comment_id": 66080223, "body": "Check your parameter names - in the VALUES clause you have <code>1p</code>, and in the parameter statements you have <code>p1</code>."}, {"owner": {"reputation": 21, "user_id": 6803053, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c4975d1f7ec03d39627f9faac754074e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/6803053/andrey"}, "edited": false, "score": 0, "creation_date": 1473270241, "post_id": 39376049, "comment_id": 66080358, "body": "\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043c\u043d\u043e\u0433\u043e\u0448\u0430\u0433\u043e\u0432\u043e\u0439 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 OLE DB. \u041f\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0439 OLE DB. \u0420\u0430\u0431\u043e\u0442\u0430 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430."}, {"owner": {"reputation": 21, "user_id": 6803053, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c4975d1f7ec03d39627f9faac754074e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/6803053/andrey"}, "edited": false, "score": 0, "creation_date": 1473270290, "post_id": 39376049, "comment_id": 66080380, "body": "i remake p1, but have the same problen"}, {"owner": {"reputation": 164, "user_id": 4863076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c5be855c92f06edcfab3b41ee6b971f?s=128&d=identicon&r=PG&f=1", "display_name": "aaron", "link": "https://stackoverflow.com/users/4863076/aaron"}, "edited": false, "score": 0, "creation_date": 1473270436, "post_id": 39376049, "comment_id": 66080448, "body": "Can you add the text of the error to your post? It will make figuring this out much easier."}, {"owner": {"reputation": 21, "user_id": 6803053, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c4975d1f7ec03d39627f9faac754074e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/6803053/andrey"}, "edited": false, "score": 0, "creation_date": 1473270587, "post_id": 39376049, "comment_id": 66080535, "body": "Error -  \t \u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0438 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432\u043e \u0432\u0440\u0435\u043c\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043c\u043d\u043e\u0433\u043e\u0448\u0430\u0433\u043e\u0432\u043e\u0439 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 OLE DB. \u041f\u043e \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432\u0441\u0435\u0445 \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0439 OLE DB. \u0420\u0430\u0431\u043e\u0442\u0430 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430. \u2013 Andrey 5 mins ago"}, {"owner": {"reputation": 164, "user_id": 4863076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c5be855c92f06edcfab3b41ee6b971f?s=128&d=identicon&r=PG&f=1", "display_name": "aaron", "link": "https://stackoverflow.com/users/4863076/aaron"}, "edited": false, "score": 0, "creation_date": 1473270849, "post_id": 39376049, "comment_id": 66080661, "body": "For English speakers, the error text is: PRB: &quot;Multiple-step OLE DB operation generated errors&quot; when opening ADO connection."}], "answers": [{"tags": [], "owner": {"reputation": 164, "user_id": 4863076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c5be855c92f06edcfab3b41ee6b971f?s=128&d=identicon&r=PG&f=1", "display_name": "aaron", "link": "https://stackoverflow.com/users/4863076/aaron"}, "is_accepted": false, "score": 0, "last_activity_date": 1473271553, "creation_date": 1473271553, "answer_id": 39376565, "question_id": 39376049, "link": "https://stackoverflow.com/questions/39376049/ole-database-error/39376565#39376565", "title": "OLE Database error", "body": "<p>I'm pretty sure PhillipXT's comment has the answer here. Your variables in the query string (@1p, etc) don't match the tags you're giving them when you add them as parameters (@p1, etc).</p>\n\n<p>When you add a parameter, it essentially replaces that string in the Command Text with the value you provided. In the case, it will attempt to replace \"@p1\" with the value provided. However, that string does not exist in your command text. In fact, none of your seven parameters match the names in the command text.</p>\n\n<p>It shouldn't matter which location you change the name in, but all seven of those tags must match.</p>\n"}, {"tags": [], "owner": {"reputation": 154, "user_id": 6670690, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-gb9CDCPYHls/AAAAAAAAAAI/AAAAAAAAAB0/J9TSx00GXA4/photo.jpg?sz=128", "display_name": "Subash B", "link": "https://stackoverflow.com/users/6670690/subash-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1473337050, "creation_date": 1473337050, "answer_id": 39390693, "question_id": 39376049, "link": "https://stackoverflow.com/questions/39376049/ole-database-error/39390693#39390693", "title": "OLE Database error", "body": "<p>Try this:</p>\n\n<pre><code>con.Open();\ncom.CommandText = \"insert into GGG (event_id, device_id, parameter_id, parameter_int_id, time_id, clock_id, user_id) values (@p1, @p2, @p3, @p4, @p5, @p6, @p7)\";\ncom.Parameters.AddWithValue(\"@p1\", s.Substring(0, 45));\ncom.Parameters.AddWithValue(\"@p2\", s.Substring(46, 31));\ncom.Parameters.AddWithValue(\"@p3\", s.Substring(77, 41));\ncom.Parameters.AddWithValue(\"@p4\", r.Match(s.Substring(77, 41)));\ncom.Parameters.AddWithValue(\"@p5\", s.Substring(118, 19));\ncom.Parameters.AddWithValue(\"@p6\", s.Substring(118, 8));\ncom.Parameters.AddWithValue(\"@p7\", s.Substring(138, 10));\ncom.ExecuteReader();\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6803053, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c4975d1f7ec03d39627f9faac754074e?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/6803053/andrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1473337050, "creation_date": 1473269479, "last_edit_date": 1473271310, "question_id": 39376049, "link": "https://stackoverflow.com/questions/39376049/ole-database-error", "title": "OLE Database error", "body": "<p>I want remake this string:</p>\n\n<pre><code>string cmdstr = \"INSERT into GGG (event_id, device_id, parameter_id, parameter_int_id, time_id, clock_id, user_id) VALUES ('\" + s.Substring(0, 45) + \"', '\" + s.Substring(46, 31) + \"', '\" + s.Substring(77, 41) + \"', '\" + r.Match(s.Substring(77, 41)) + \"',  '\" + s.Substring(118, 19) + \"', '\" + s.Substring(118, 8) + \"',  '\" + s.Substring(138, 10) + \"')\";\n</code></pre>\n\n<p>where i want use parameters.AddWithValue. But i have error.</p>\n\n<p>It's my new code, with error:</p>\n\n<pre><code>con.Open();\ncom.CommandText = \"insert into GGG (event_id, device_id, parameter_id, parameter_int_id, time_id, clock_id, user_id) values (@1p, @2p, @3p, @4p, @5p, @6p, @7p)\";\ncom.Parameters.AddWithValue(\"@p1\", s.Substring(0, 45));\ncom.Parameters.AddWithValue(\"@p2\", s.Substring(46, 31));\ncom.Parameters.AddWithValue(\"@p3\", s.Substring(77, 41));\ncom.Parameters.AddWithValue(\"@p4\", r.Match(s.Substring(77, 41)));\ncom.Parameters.AddWithValue(\"@p5\", s.Substring(118, 19));\ncom.Parameters.AddWithValue(\"@p6\", s.Substring(118, 8));\ncom.Parameters.AddWithValue(\"@p7\", s.Substring(138, 10));\ncom.ExecuteReader();\n</code></pre>\n"}, {"tags": ["c#", "formatting"], "comments": [{"owner": {"reputation": 8486, "user_id": 4366237, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PeNn9.jpg?s=128&g=1", "display_name": "Umair M", "link": "https://stackoverflow.com/users/4366237/umair-m"}, "edited": false, "score": 1, "creation_date": 1473269693, "post_id": 39376032, "comment_id": 66080120, "body": "get some help from <a href=\"http://www.domyhomework.com\" rel=\"nofollow noreferrer\">domyhomework.com</a>"}, {"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 1, "creation_date": 1473269909, "post_id": 39376032, "comment_id": 66080212, "body": "&quot;From my code, its currently writing them straight down.&quot; -- The code you currently have in <code>PrintReport()</code> is not doing anything other than printing a couple strings. I assume you meant to iterate <code>valueArray</code> in there."}, {"owner": {"reputation": 41, "user_id": 6221362, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1156054047792467/picture?type=large", "display_name": "Jon Butler", "link": "https://stackoverflow.com/users/6221362/jon-butler"}, "edited": false, "score": 0, "creation_date": 1473270186, "post_id": 39376032, "comment_id": 66080338, "body": "i was doing a for loop inside <code>PrintReport()</code> such as <code>for (i = 1; i &lt;= numOfValues; i++)          fileOut.WriteLine(valueArray[i]);</code> but I can&#39;t seem to figure out how to get it to start writing in the next column after it writes the first values in the first column, in 30 rows."}, {"owner": {"reputation": 511, "user_id": 3553128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/OUn59.jpg?s=128&g=1", "display_name": "Meloviz", "link": "https://stackoverflow.com/users/3553128/meloviz"}, "edited": false, "score": 0, "creation_date": 1473272087, "post_id": 39376032, "comment_id": 66081253, "body": "You need to change <code>valueArray</code> to either <code>double[][]</code> and iterate through both arrays for your columns and rows or to a string[] and concatenate the <code>Double.Parse(words[col - 1]) + &quot;\\t&quot;</code>."}, {"owner": {"reputation": 41, "user_id": 6221362, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1156054047792467/picture?type=large", "display_name": "Jon Butler", "link": "https://stackoverflow.com/users/6221362/jon-butler"}, "edited": false, "score": 0, "creation_date": 1473273268, "post_id": 39376032, "comment_id": 66081760, "body": "<code>valueArray[n] = Double.Parse(words[col - 1]);</code> is just putting the values into the array, My problem is within print report. It inputs the correct values, I&#39;m just confused on how to get into rows and columns when printing."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6221362, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1156054047792467/picture?type=large", "display_name": "Jon Butler", "link": "https://stackoverflow.com/users/6221362/jon-butler"}, "edited": false, "score": 0, "creation_date": 1473276582, "post_id": 39377337, "comment_id": 66083311, "body": "okay i get what you did, but that writes the values left to right, and i need to go in ascending order down the columns."}], "tags": [], "owner": {"reputation": 1431, "user_id": 181832, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3783c5da15777937ad9cc34515b2989f?s=128&d=identicon&r=PG", "display_name": "Joy George Kunjikkuru", "link": "https://stackoverflow.com/users/181832/joy-george-kunjikkuru"}, "is_accepted": false, "score": 0, "last_activity_date": 1473274812, "creation_date": 1473274812, "answer_id": 39377337, "question_id": 39376032, "link": "https://stackoverflow.com/questions/39376032/write-array-values-to-file-in-columns-and-rows/39377337#39377337", "title": "write array values to file in columns and rows", "body": "<p>If you are looking for formatting, below is a snippet. It works if there are 30x5 always. Else you need to change the logic. The $\"\" syntax works from C#6.0 only. You need to user string.Format in lower versions. \\t is for spacing.You can adjust by increasing 5 also.   </p>\n\n<pre><code>void Print(double[] valueArray)\n    {\n        for(int row = 0; row &lt;150; row+=5)\n        {\n            Console.WriteLine($\"{valueArray[row],5:N2}\\t{valueArray[row + 1],5:N2}\\t{valueArray[row + 2],5:N2}\\t{valueArray[row + 3],5:N2}\\t{valueArray[row + 4],5:N2}\\t\");\n        }\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 6221362, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1156054047792467/picture?type=large", "display_name": "Jon Butler", "link": "https://stackoverflow.com/users/6221362/jon-butler"}, "is_accepted": false, "score": 0, "last_activity_date": 1473277300, "creation_date": 1473277300, "answer_id": 39377873, "question_id": 39376032, "link": "https://stackoverflow.com/questions/39376032/write-array-values-to-file-in-columns-and-rows/39377873#39377873", "title": "write array values to file in columns and rows", "body": "<pre><code>static void PrintReport()\n{\n  int count;\n  fileOut.WriteLine();\n  fileOut.WriteLine(\"Score       Score       Score       Score       Score\");\n  fileOut.WriteLine(\"-----       -----       -----       -----       -----\");\n  for (int row = 1; row &lt;= numOfRows; row++)\n  {\n    for (int col = 1; col &lt;= numOfCols; col++)\n    {\n      count = row + numOfRows * (col - 1);\n      if (count &lt;= numOfValues)\n        fileOut.Write(\"{0,5:N2}       \", valueArray[count]);\n    }\n    fileOut.WriteLine();\n\n  }\n}\n</code></pre>\n\n<p>this solved my issue</p>\n"}], "owner": {"reputation": 41, "user_id": 6221362, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1156054047792467/picture?type=large", "display_name": "Jon Butler", "link": "https://stackoverflow.com/users/6221362/jon-butler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 204, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473277300, "creation_date": 1473269414, "question_id": 39376032, "link": "https://stackoverflow.com/questions/39376032/write-array-values-to-file-in-columns-and-rows", "title": "write array values to file in columns and rows", "body": "<p>I'm currently stuck on trying to write values input into my array into a file in <code>rows = 30</code> and <code>cols = 5</code> From my code, its currently writing them straight down. How do i fix this?</p>\n\n<p>CODE:</p>\n\n<pre><code>static void PrintReport()\n{\n  fileOut.WriteLine();\n  fileOut.WriteLine(\"Score       Score       Score       Score       Score\");\n  fileOut.WriteLine(\"-----       -----       -----       -----       -----\");\n  fileOut.WriteLine(\"\");\n\n}\n\nstatic void InputValues()\n{\n  int n = 0, row, col;\n  int numOfRows, numOfCols;\n  string[] words;\n\n  words = fileIn.ReadLine().Split(',');\n  numOfRows = Int32.Parse(words[0]);\n  numOfCols = Int32.Parse(words[1]);\n  numOfValues = numOfRows * numOfCols;\n  valueArray = new double[numOfValues + 1];\n  for (row = 1; row &lt;= numOfRows; row++)\n  {\n    words = fileIn.ReadLine().Split(',');\n    for (col = 1; col &lt;= numOfCols; col++)\n    {\n      //n = numOfCols*(row-1) + col; \n      n++;\n      valueArray[n] = Double.Parse(words[col - 1]);\n    }\n  }\n}\n</code></pre>\n\n<p>DESIRED OUTPUT:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NA4rS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NA4rS.jpg\" alt=\"desired output\"></a></p>\n"}, {"tags": ["c#", "automapper"], "comments": [{"owner": {"reputation": 11474, "user_id": 1195056, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pe03k.jpg?s=128&g=1", "display_name": "krillgar", "link": "https://stackoverflow.com/users/1195056/krillgar"}, "edited": false, "score": 0, "creation_date": 1473272310, "post_id": 39375968, "comment_id": 66081341, "body": "Voted to close this question, since in the comments of the accepted answer, OP realized a different error was occurring than the one in the question."}], "answers": [{"comments": [{"owner": {"reputation": 7167, "user_id": 61623, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0614c58792e93e94cd47ebf6d152e1f6?s=128&d=identicon&r=PG", "display_name": "John S", "link": "https://stackoverflow.com/users/61623/john-s"}, "edited": false, "score": 0, "creation_date": 1473269761, "post_id": 39376059, "comment_id": 66080151, "body": "In an attempt to keep my example simple I might have over simplified. Rather then &quot;42&quot; I am doing a Linq query to pull a count of a related object. I m odified the code example accordingly.  Is UseValue still the right option?"}, {"owner": {"reputation": 6959, "user_id": 1229195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f614ed0bbbb720a7b08dabb7998f701?s=128&d=identicon&r=PG", "display_name": "Paul Oliver", "link": "https://stackoverflow.com/users/1229195/paul-oliver"}, "reply_to_user": {"reputation": 7167, "user_id": 61623, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0614c58792e93e94cd47ebf6d152e1f6?s=128&d=identicon&r=PG", "display_name": "John S", "link": "https://stackoverflow.com/users/61623/john-s"}, "edited": false, "score": 0, "creation_date": 1473270054, "post_id": 39376059, "comment_id": 66080277, "body": "Ahh, since I don&#39;t have your source code to try it out, can you use <code>ResolveUsing</code> instead of <code>MapFrom</code>? : <code>.ForMember(dest =&gt; dest.Count, opt =&gt; opt.ResolveUsing(src =&gt; src.Orders.Count()));</code>"}, {"owner": {"reputation": 7167, "user_id": 61623, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0614c58792e93e94cd47ebf6d152e1f6?s=128&d=identicon&r=PG", "display_name": "John S", "link": "https://stackoverflow.com/users/61623/john-s"}, "edited": false, "score": 0, "creation_date": 1473270306, "post_id": 39376059, "comment_id": 66080387, "body": "That throws the same validation error. I&#39;ll see if I can bring in a little bit more code to help make it clearer."}, {"owner": {"reputation": 7167, "user_id": 61623, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0614c58792e93e94cd47ebf6d152e1f6?s=128&d=identicon&r=PG", "display_name": "John S", "link": "https://stackoverflow.com/users/61623/john-s"}, "edited": false, "score": 1, "creation_date": 1473270518, "post_id": 39376059, "comment_id": 66080491, "body": "After some further testing I believe the mappings are correct. The problem lies in a mapping for another entity that is related to Feed. In that entity I am mapping both directions."}], "tags": [], "owner": {"reputation": 6959, "user_id": 1229195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f614ed0bbbb720a7b08dabb7998f701?s=128&d=identicon&r=PG", "display_name": "Paul Oliver", "link": "https://stackoverflow.com/users/1229195/paul-oliver"}, "is_accepted": true, "score": 1, "last_activity_date": 1473272031, "last_edit_date": 1473272031, "creation_date": 1473269521, "answer_id": 39376059, "question_id": 39375968, "link": "https://stackoverflow.com/questions/39375968/create-automapper-mapping-with-calculated-value/39376059#39376059", "title": "Create AutoMapper mapping with calculated value?", "body": "<p>You should use <code>ResolveUsing</code>:</p>\n\n<pre><code>cfg.CreateMap&lt;Feed, FeedVM&gt;()\n   .ForMember(dest =&gt; dest.Count, opt =&gt; opt.ResolveUsing(src =&gt; src.Orders.Count()));\n</code></pre>\n\nUpdate\n\n<p>John indicates in the comment below that the mappings are correct, the problem lies in a mapping for another entity that is related to <code>Feed</code>. In that entity he is mapping both directions.</p>\n"}], "owner": {"reputation": 7167, "user_id": 61623, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0614c58792e93e94cd47ebf6d152e1f6?s=128&d=identicon&r=PG", "display_name": "John S", "link": "https://stackoverflow.com/users/61623/john-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4020, "favorite_count": 0, "accepted_answer_id": 39376059, "answer_count": 1, "score": 2, "last_activity_date": 1473280067, "creation_date": 1473269170, "last_edit_date": 1473280067, "question_id": 39375968, "link": "https://stackoverflow.com/questions/39375968/create-automapper-mapping-with-calculated-value", "title": "Create AutoMapper mapping with calculated value?", "body": "<p>I'm trying to configure a simple AutoMapper mapping from an Entity Framework entity to a view model object. It mostly works but in the view model I have an int field to hold a count. This field does not exist in the source entity.</p>\n\n<pre><code>cfg.CreateMap&lt;Feed, FeedVM&gt;()\n   .ForMember(dest =&gt; dest.Count, opt =&gt; opt.MapFrom(src =&gt; src.Orders.Count()));\n</code></pre>\n\n<p>When I check the validity of the mapping I get the following error message:</p>\n\n<blockquote>\n  <p>The following property on Feed cannot be mapped: </p>\n  \n  <p>Add a custom mapping expression, ignore, add a custom resolver, or modify the destination type Feed.\n  Context:\n  Mapping from type FeedVM to Feed</p>\n</blockquote>\n\n<p>If I understand the Automapper syntax correctly I am mapping from Feed to FeedVM but the error message seems to indicate that I am mapping from FeedVM to Feed.</p>\n\n<p>What should I be doing to map the value 42 to the Count field in FeedVM?</p>\n"}, {"tags": ["c#", "android", "visual-studio-2015", "android-edittext", "textview"], "comments": [{"owner": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "edited": false, "score": 0, "creation_date": 1473270361, "post_id": 39375951, "comment_id": 66080412, "body": "Do you get an error?"}, {"owner": {"reputation": 64, "user_id": 6804030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97d650b5e82d06fd7e874121aa3a9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Azizi Abdul Aziz", "link": "https://stackoverflow.com/users/6804030/muhammad-azizi-abdul-aziz"}, "reply_to_user": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "edited": false, "score": 0, "creation_date": 1473297037, "post_id": 39375951, "comment_id": 66089953, "body": "No error, but the TextView is empty. I can&#39;t view the any text in the TextView"}, {"owner": {"reputation": 64, "user_id": 6804030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97d650b5e82d06fd7e874121aa3a9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Azizi Abdul Aziz", "link": "https://stackoverflow.com/users/6804030/muhammad-azizi-abdul-aziz"}, "reply_to_user": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "edited": false, "score": 0, "creation_date": 1473297837, "post_id": 39375951, "comment_id": 66090116, "body": "@amitairos I just don&#39;t know what is wrong. Is my code correct? Or is there any error somewhere? I&#39;ve tried to search it online, but I couldn&#39;t found anything that can resolves my problem. Thanks in advance"}, {"owner": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "edited": false, "score": 0, "creation_date": 1473299447, "post_id": 39375951, "comment_id": 66090501, "body": "Try putting a breakpoint where you call GetStringExtra and see if you get the string. That will help as a start."}, {"owner": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "edited": false, "score": 0, "creation_date": 1473299574, "post_id": 39375951, "comment_id": 66090525, "body": "Also, please post your full code of everything."}, {"owner": {"reputation": 64, "user_id": 6804030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97d650b5e82d06fd7e874121aa3a9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Azizi Abdul Aziz", "link": "https://stackoverflow.com/users/6804030/muhammad-azizi-abdul-aziz"}, "reply_to_user": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "edited": false, "score": 0, "creation_date": 1473304304, "post_id": 39375951, "comment_id": 66091557, "body": "@amitairos Thank you for your effort to help me. But I just found the solution in youtube. (<a href=\"https://www.youtube.com/watch?v=NtLac9HpHSw\" rel=\"nofollow noreferrer\">youtube.com/watch?v=NtLac9HpHSw</a>) This video does what I wanted and it works like charm. Anyway, thank you so much for your time and effort. Appreciate it a lot.Thanks man!"}, {"owner": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "edited": false, "score": 1, "creation_date": 1473311517, "post_id": 39375951, "comment_id": 66093202, "body": "Do you know what the problem was? It would be nice if you put that as an answer. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 2703, "user_id": 384511, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7590e1885f4e3de32c5fe7e70c172ed7?s=128&d=identicon&r=PG", "display_name": "amitairos", "link": "https://stackoverflow.com/users/384511/amitairos"}, "edited": false, "score": 1, "creation_date": 1473270143, "post_id": 39376030, "comment_id": 66080314, "body": "He&#39;s using Xamarin, in which what he did is acceptable."}, {"owner": {"reputation": 64, "user_id": 6804030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97d650b5e82d06fd7e874121aa3a9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Azizi Abdul Aziz", "link": "https://stackoverflow.com/users/6804030/muhammad-azizi-abdul-aziz"}, "edited": false, "score": 0, "creation_date": 1473297751, "post_id": 39376030, "comment_id": 66090097, "body": "@Aenadon Thank you for your reply. But it is an error for me when I use getText() and setText()"}], "tags": [], "owner": {"reputation": 1545, "user_id": 3673616, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f0c382496484720b042ef26019963a8e?s=128&d=identicon&r=PG&f=1", "display_name": "techfly", "link": "https://stackoverflow.com/users/3673616/techfly"}, "is_accepted": false, "score": 0, "last_activity_date": 1473269393, "creation_date": 1473269393, "answer_id": 39376030, "question_id": 39375951, "link": "https://stackoverflow.com/questions/39375951/i-cannot-change-my-textview-text-in-visual-studio-2015-android/39376030#39376030", "title": "I cannot change my textView text in visual studio 2015 (Android)", "body": "<p>You are trying to edit the Text variable directly, that is not possible. Use getText() and setText() instead.</p>\n\n<p>For example:</p>\n\n<p>Get text</p>\n\n<p><code>String jobNum = jn.getText()</code>;</p>\n\n<p>Set text</p>\n\n<p><code>jn.setText(jobNumber)</code></p>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 1352146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a4498477aad1c5dc92e6a29a644527?s=128&d=identicon&r=PG", "display_name": "Marco Rinaldi", "link": "https://stackoverflow.com/users/1352146/marco-rinaldi"}, "is_accepted": false, "score": 0, "last_activity_date": 1473464322, "creation_date": 1473464322, "answer_id": 39421083, "question_id": 39375951, "link": "https://stackoverflow.com/questions/39375951/i-cannot-change-my-textview-text-in-visual-studio-2015-android/39421083#39421083", "title": "I cannot change my textView text in visual studio 2015 (Android)", "body": "<p>Your error is that you are taken the texts when the Details activity starts, and obviously the text boxes are empty.</p>\n\n<p>Put this:</p>\n\n<pre><code>String jobNum = jn.Text;\nString statusC = sc.Text;\nString statusD = sd.Text;\nString remarks = r.Text;\n</code></pre>\n\n<p>Inside the button click delegate method.</p>\n"}], "owner": {"reputation": 64, "user_id": 6804030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d97d650b5e82d06fd7e874121aa3a9bf?s=128&d=identicon&r=PG&f=1", "display_name": "Muhammad Azizi Abdul Aziz", "link": "https://stackoverflow.com/users/6804030/muhammad-azizi-abdul-aziz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 528, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1549707724, "creation_date": 1473269101, "last_edit_date": 1549707724, "question_id": 39375951, "link": "https://stackoverflow.com/questions/39375951/i-cannot-change-my-textview-text-in-visual-studio-2015-android", "title": "I cannot change my textView text in visual studio 2015 (Android)", "body": "<p>I am very new to Visual Studio. I'm required to create an android app with Visual Studio. I'm using Visual Studio 2015 Community. </p>\n\n<p>Currently I have an android project with 2 activities (details and confirmation). In the details page, there are EditText for the user to input the details and in the confirmation page, a TextView is used to show the user input. </p>\n\n<p>I have done this 2 activities, but when I run it, the confirmation page will be empty. I'm not sure whether my code is right or not.</p>\n\n<p>There are few problems I encounter right now :-</p>\n\n<ul>\n<li>how to get the EditText value and <strong>assign</strong> it to variable</li>\n<li>how to <strong>pass</strong> the value from one activity to another</li>\n<li>how to <strong>read</strong> the value that is passed from the other activity</li>\n<li>how to <strong>change</strong> the TextView text</li>\n</ul>\n\n<blockquote>\n  <p>details.xml</p>\n</blockquote>\n\n<pre><code>&lt;EditText\nandroid:inputType=\"textMultiLine\"\nandroid:id=\"@+id/jobNumber\"\nandroid:layout_height=\"wrap_content\" /&gt;\n\n&lt;EditText\nandroid:inputType=\"textMultiLine\"\nandroid:id=\"@+id/statusCode\"\nandroid:layout_height=\"wrap_content\" /&gt;\n\n&lt;EditText\nandroid:inputType=\"textMultiLine\"\nandroid:id=\"@+id/statusDescription\"\nandroid:layout_height=\"wrap_content\" /&gt;\n\n&lt;EditText\nandroid:inputType=\"textMultiLine\"\nandroid:id=\"@+id/remarks\"\nandroid:layout_height=\"wrap_content\" /&gt;\n</code></pre>\n\n<blockquote>\n  <p>Details.cs</p>\n</blockquote>\n\n<pre><code>protected override void OnCreate(Bundle savedInstanceState)\n{\n    base.OnCreate(savedInstanceState);\n\n    SetContentView(Resource.Layout.DetailsPage);\n\n    EditText jn = FindViewById&lt;EditText&gt;(Resource.Id.jobNumber);\n    EditText sc = FindViewById&lt;EditText&gt;(Resource.Id.statusCode);\n    EditText sd = FindViewById&lt;EditText&gt;(Resource.Id.statusDescription);\n    EditText r = FindViewById&lt;EditText&gt;(Resource.Id.remarks);\n\n    String jobNum = jn.Text;\n    String statusC = sc.Text;\n    String statusD = sd.Text;\n    String remarks = r.Text;\n\n    Button next = FindViewById&lt;Button&gt;(Resource.Id.next);\n\n    next.Click += delegate\n    {\n        Intent act = new Intent(this, typeof(Confirmation));\n\n        act.PutExtra(\"jNum\", jobNum);\n        act.PutExtra(\"SC\", statusC);\n        act.PutExtra(\"SD\", statusD);\n        act.PutExtra(\"R\", remarks);\n\n        StartActivity(act);\n    };\n}\n</code></pre>\n\n<blockquote>\n  <p>confirmation.xml</p>\n</blockquote>\n\n<pre><code>&lt;TextView xmlns:tools=\"http://schemas.android.com/tools\"    \n    android:text=\"Medium Text\"\n    android:textAppearance=\"?android:attr/textAppearanceMedium\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    android:id=\"@+id/textView7\" /&gt;\n&lt;TextView\n    android:text=\"Medium Text\"\n    android:textAppearance=\"?android:attr/textAppearanceMedium\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    android:id=\"@+id/textView8\" /&gt;\n&lt;TextView\n    android:text=\"Medium Text\"\n    android:textAppearance=\"?android:attr/textAppearanceMedium\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    android:id=\"@+id/textView9\" /&gt;\n&lt;TextView\n    android:text=\"Medium Text\"\n    android:textAppearance=\"?android:attr/textAppearanceMedium\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"wrap_content\"\n    android:id=\"@+id/textView10\" /&gt;\n</code></pre>\n\n<blockquote>\n  <p>Confirmation.cs</p>\n</blockquote>\n\n<pre><code>protected override void OnCreate(Bundle savedInstanceState)\n{\n    base.OnCreate(savedInstanceState);\n\n    SetContentView(Resource.Layout.Confirmation);\n\n    String jobNumber = Intent.GetStringExtra(\"jNum\");\n    String statusCode = Intent.GetStringExtra(\"SC\");\n    String statusDescription = Intent.GetStringExtra(\"SD\");\n    String remarks = Intent.GetStringExtra(\"R\");\n\n    TextView jn = FindViewById&lt;TextView&gt;(Resource.Id.textView7b;\n    TextView sc = FindViewById&lt;TextView&gt;(Resource.Id.textView8);\n    TextView sd = FindViewById&lt;TextView&gt;(Resource.Id.textView9);\n    TextView r = FindViewById&lt;TextView&gt;(Resource.Id.textView10);\n\n    jn.Text = jobNumber;\n    sc.Text = statusCode;\n    sd.Text = statusDescription;\n    r.Text = remarks;\n}\n</code></pre>\n\n<p>Please help me, what do I do wrong? <strong>Why the TextView text does not change.</strong> Thank you so much in advance for those who try and solve this problem for me. APPRECIATE IT!</p>\n\n<p>Regards,\nAzizi</p>\n"}, {"tags": ["c#", "jquery", "html", "asp.net-mvc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3559349"}, "edited": false, "score": 0, "creation_date": 1473291686, "post_id": 39375882, "comment_id": 66088864, "body": "Please note that the model-view-controller tag is for questions about the pattern. There is a specific tag for the ASP.NET-MVC implementation."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6073996, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b61a77b6c8701824df873a3e7119d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Andra", "link": "https://stackoverflow.com/users/6073996/andra"}, "edited": false, "score": 0, "creation_date": 1473275812, "post_id": 39376528, "comment_id": 66082937, "body": "I moved the html to the table: &lt;table id=&quot;pt-list&quot;&gt; and do you mean changing my script to this?   $(&#39;#st-list&#39;).append(html).after(&#39;&lt;tr&gt;&#39;);  Sorry this is all new to me."}, {"owner": {"reputation": 33, "user_id": 6073996, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b61a77b6c8701824df873a3e7119d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Andra", "link": "https://stackoverflow.com/users/6073996/andra"}, "edited": false, "score": 0, "creation_date": 1473280952, "post_id": 39376528, "comment_id": 66085255, "body": "Ok, I understand the fiddle. But how do I get my text box and dropdown in there and then bind it to my model?  Thanks for your help!"}], "tags": [], "owner": {"reputation": 19, "user_id": 6731811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ac4a67cbd6583e55f672f2bdfbd5e06?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/6731811/fabian"}, "is_accepted": false, "score": 0, "last_activity_date": 1473271365, "creation_date": 1473271365, "answer_id": 39376528, "question_id": 39375882, "link": "https://stackoverflow.com/questions/39375882/c-mvc-dynamically-adding-row-to-html-table-but-all-fields-in-1-cell/39376528#39376528", "title": "c# MVC Dynamically adding row to HTML Table but all fields in 1 cell", "body": "<p>Take a close look what you are appending your information to.</p>\n\n<pre><code>    &lt;i&gt;\n&lt;script&gt;\n        jQuery(document).ready(function ($) {\n            $('#add-pt').on('click', function () {\n                jQuery.get('/PCN/AddPT').done(function (html) {\n                    $('#pt-list').append(html);\n                });\n            });\n        });\n    &lt;/script&gt;\n&lt;/i&gt;\n</code></pre>\n\n<p>and your html is: </p>\n\n<pre><code>&lt;tr id=\"pt-list\"&gt;\n@Html.EditorForMany(x =&gt; x.ptList, x =&gt; x.Index)\n&lt;/tr&gt;\n</code></pre>\n\n<p>So you are appending the html to a TR element when you want to append something to the table.</p>\n\n<p>use .after()\nand insert a new tr and tds for your values.</p>\n\n<p>And why is there a <code>&lt;i&gt;</code> in your template?\nRemove that!\nA row in a table cannot be italic!</p>\n\n<p>Take a close look at how a table in html should look!</p>\n\n<p><a href=\"http://www.w3schools.com/html/html_tables.asp\" rel=\"nofollow\">http://www.w3schools.com/html/html_tables.asp</a></p>\n"}], "owner": {"reputation": 33, "user_id": 6073996, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3b61a77b6c8701824df873a3e7119d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Andra", "link": "https://stackoverflow.com/users/6073996/andra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2600, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473952267, "creation_date": 1473268864, "last_edit_date": 1473952267, "question_id": 39375882, "link": "https://stackoverflow.com/questions/39375882/c-mvc-dynamically-adding-row-to-html-table-but-all-fields-in-1-cell", "title": "c# MVC Dynamically adding row to HTML Table but all fields in 1 cell", "body": "<p>I am new to c# MVC and need some help. I am using Matt Lunn's example (<a href=\"http://www.mattlunn.me.uk/blog/2014/08/how-to-dynamically-via-ajax-add-new-items-to-a-bound-list-model-in-asp-mvc-net/\" rel=\"nofollow\">http://www.mattlunn.me.uk/blog/2014/08/how-to-dynamically-via-ajax-add-new-items-to-a-bound-list-model-in-asp-mvc-net/</a>) to dynamically add new items to a bound list in an HTML table. But instead of the new items getting added to each <code>&lt;td&gt;</code> they are all added in the first column <code>&lt;td&gt;</code> but I was them spread out in corresponding columns:</p>\n\n<p><kbd><kbd>FY<br>2017</kbd><kbd>ACCOUNT ELEMENT<br>345789</kbd><kbd>POSITION<br>Director</kbd><kbd>JOB TITLE<br>Director of Marketing</kbd></kbd></p>\n\n<p>This is result all in first cell:</p>\n\n<p>New FY box</p>\n\n<p>New AccountElement box</p>\n\n<p>New Position box</p>\n\n<p>New Job Title box</p>\n\n<p>But want this:</p>\n\n<p>New FY Box in 1st cell      |   New Account Element box in 2nd cell    |    New Position box in 3rd cell   |    New Job Title Box in 4th cell</p>\n\n<p>Here is my view:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;i&gt;\n&lt;table&gt;\n        &lt;tr&gt;\n            &lt;th style=\"width:60px\"&gt;FY&lt;/th&gt;\n            &lt;th style=\"width:230px\"&gt;ACCOUNT ELEMENT&lt;/th&gt;\n            &lt;th align=\"center\" style=\"width:50px\"&gt;POSITION # &lt;br /&gt;(IF APPLICABLE)&lt;/th&gt;\n            &lt;th style=\"width:230px\"&gt;JOB TITLE&lt;/th&gt;\n            &lt;th style=\"width:250px\"&gt;DEPT NAME&lt;/th&gt;\n            &lt;th style=\"width:230px\"&gt;JUSTIFICATION FOR PT HOURS&lt;/th&gt;\n            &lt;th style=\"width:100px\"&gt;HOURS &lt;br /&gt;FOR YEAR&lt;/th&gt;\n            &lt;th style=\"width:200px\"&gt;RATE&lt;/th&gt;\n            &lt;th style=\"width:200px\"&gt;TOTAL &lt;br /&gt;BUDGET&lt;/th&gt;\n        &lt;/tr&gt;\n        &lt;tr id=\"pt-list\"&gt;\n            @Html.EditorForMany(x =&gt; x.ptList, x =&gt; x.Index)\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;\n            &lt;td align=\"right\"&gt;@String.Format(\"{0,14:c}\", Model.ptList[0].total_total_budget)&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n        &lt;input type=\"button\" id=\"add-pt\" value=\"Add Part-Time\" /&gt;\n&lt;/i&gt;\n</code></pre>\n\n<p>Script:</p>\n\n<pre><code>&lt;i&gt;\n&lt;script&gt;\n        jQuery(document).ready(function ($) {\n            $('#add-pt').on('click', function () {\n                jQuery.get('/PCN/AddPT').done(function (html) {\n                    $('#pt-list').append(html);\n                });\n            });\n        });\n    &lt;/script&gt;\n&lt;/i&gt;\n</code></pre>\n\n<p>EditorTemplate:</p>\n\n<pre><code>&lt;i&gt;\n@model Budget.Models.PCN.PCN_PT\n\n&lt;tr&gt;\n    &lt;td&gt;\n        @Html.TextBoxFor(x =&gt; x.fy, new { @class = \"form-controlsmaller\" })\n        @Html.ValidationMessageFor(x =&gt; x.fy)\n    &lt;/td&gt;\n    &lt;td&gt;\n        @Html.TextBoxFor(x =&gt; x.account_no, new { @class = \"form-control\" })\n        @Html.ValidationMessageFor(x =&gt; x.account_no)\n    &lt;/td&gt;\n    &lt;td&gt;\n        @Html.TextBoxFor(x =&gt; x.position, new { @class = \"form-controlsmaller\" })\n        @Html.ValidationMessageFor(x =&gt; x.position)\n    &lt;/td&gt;\n    &lt;td&gt;\n        @Html.TextBoxFor(x =&gt; x.job_title, new { @class = \"form-control\" })\n        @Html.ValidationMessageFor(x =&gt; x.job_title)\n    &lt;/td&gt;\n    &lt;td&gt;\n        @Html.TextBoxFor(x =&gt; x.dept_name, new { @class = \"form-control\" })\n        @Html.ValidationMessageFor(x =&gt; x.dept_name)\n    &lt;/td&gt;\n    &lt;td&gt;\n        @Html.TextBoxFor(x =&gt; x.justification, new { @class = \"form-control\" })\n        @Html.ValidationMessageFor(x =&gt; x.justification)\n    &lt;/td&gt;\n    &lt;td&gt;\n        @Html.TextBoxFor(x =&gt; x.hrs_for_yr, \"{0:0.00} \", new { @class = \"form-controlsmaller\" })\n        @Html.ValidationMessageFor(x =&gt; x.hrs_for_yr)\n    &lt;/td&gt;\n    &lt;td&gt;\n        $@Html.TextBoxFor(x =&gt; x.rate, \"{0:0.00} \", new { @class = \"form-controlsmall\" })\n        @Html.ValidationMessageFor(x =&gt; x.rate)\n    &lt;/td&gt;\n    &lt;td&gt;\n        $@Html.TextBoxFor(x =&gt; x.total_budget, \"{0:0.00} \", new { @class = \"form-controltb\" })\n        @Html.ValidationMessageFor(x =&gt; x.total_budget)\n    &lt;/td&gt;\n&lt;/tr&gt;\n&lt;/i&gt;\n</code></pre>\n\n<p>PCN Controller to add New Row:</p>\n\n<pre><code>&lt;i&gt;\n        [OutputCache(NoStore = true, Duration = 0, VaryByParam = \"*\")]\n        public ActionResult AddPT()\n        {\n            var pt = new PCN();\n            pt.ptList.Add(new PCN.PCN_PT());\n\n            return View(pt);\n        }\n&lt;/i&gt;\n</code></pre>\n\n<p>How can I get the input fields displayed in the corresponding column of the table when I click Add Part-Time button?  Any help would be greatly appreciated.</p>\n"}, {"tags": ["c#", "asp.net", "azure", "web", "webmethod"], "comments": [{"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1473269023, "post_id": 39375846, "comment_id": 66079786, "body": "This might be useful <a href=\"https://azure.microsoft.com/en-gb/documentation/articles/web-sites-configure-ssl-certificate/\" rel=\"nofollow noreferrer\">azure.microsoft.com/en-gb/documentation/articles/&hellip;</a>"}, {"owner": {"reputation": 113, "user_id": 4193164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OsS9i.jpg?s=128&g=1", "display_name": "Pietro di Caprio", "link": "https://stackoverflow.com/users/4193164/pietro-di-caprio"}, "reply_to_user": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1473356535, "post_id": 39375846, "comment_id": 66120247, "body": "But i don&#39;t use a custom domain, i use https://&lt;appname&gt;.azurewebsites.net"}], "owner": {"reputation": 113, "user_id": 4193164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OsS9i.jpg?s=128&g=1", "display_name": "Pietro di Caprio", "link": "https://stackoverflow.com/users/4193164/pietro-di-caprio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473268735, "creation_date": 1473268735, "question_id": 39375846, "link": "https://stackoverflow.com/questions/39375846/call-a-webmethod-with-https-url", "title": "Call a WebMethod with HTTPS url", "body": "<p>C# side</p>\n\n<pre><code>[WebMethod]\npublic static string IsLoadComplete()\n{\n    return LoadComplete.ToString();\n}\n</code></pre>\n\n<p>JS side</p>\n\n<pre><code>PageMethods.IsLoadComplete(function (state) {\n    if(state == \"True\")\n    {\n      [...]\n    }\n});\n</code></pre>\n\n<p>if i test running in VS is everything ok.\nWhen i publish on Azure and use HTTPS the \"state\" is always false.</p>\n\n<p>There is something to set to call the WebMethod with HTTPS?</p>\n"}, {"tags": ["c#", "visual-studio-2015"], "comments": [{"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 0, "creation_date": 1473268841, "post_id": 39375833, "comment_id": 66079692, "body": "Are both of the projects (Gamma and Alpha) in the same solution?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 4, "creation_date": 1473268882, "post_id": 39375833, "comment_id": 66079726, "body": "Why are you not using different namespaces, given that these classes conceptually exist in a different space?"}, {"owner": {"reputation": 1788, "user_id": 2033557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b01f4a07ec9019af3c695a46c153b9ab?s=128&d=identicon&r=PG", "display_name": "TheHansinator", "link": "https://stackoverflow.com/users/2033557/thehansinator"}, "reply_to_user": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 0, "creation_date": 1473268960, "post_id": 39375833, "comment_id": 66079758, "body": "@DavidL Yes, they are."}, {"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 4, "creation_date": 1473269037, "post_id": 39375833, "comment_id": 66079789, "body": "Well there&#39;s your problem.  You are trying to build classes with the same names in the same namespace in the same solution.  Why <b><i>wouldn&#39;t</i></b> you expect this to fail?"}, {"owner": {"reputation": 1788, "user_id": 2033557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b01f4a07ec9019af3c695a46c153b9ab?s=128&d=identicon&r=PG", "display_name": "TheHansinator", "link": "https://stackoverflow.com/users/2033557/thehansinator"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1473269076, "post_id": 39375833, "comment_id": 66079809, "body": "@Servy (1) This wasn&#39;t my decision, (2) The code that uses <code>SharedClass</code> is generated."}, {"owner": {"reputation": 1788, "user_id": 2033557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b01f4a07ec9019af3c695a46c153b9ab?s=128&d=identicon&r=PG", "display_name": "TheHansinator", "link": "https://stackoverflow.com/users/2033557/thehansinator"}, "reply_to_user": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 0, "creation_date": 1473269118, "post_id": 39375833, "comment_id": 66079839, "body": "@DavidL Alpha and Beta have both built fine, defined in just the same way, for years. I have only recently added Gamma, and only the project that references Gamma fails to build."}, {"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 0, "creation_date": 1473269162, "post_id": 39375833, "comment_id": 66079858, "body": "@Compynerd255 then the decision was flawed.  If this is supposed to work at all, they would need to be partial classes (which typically they should be if generated anyways).  Most likely you have an issue with your generated code implementation and it is impossible to diagnose properly from what you&#39;ve shown here."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1473269179, "post_id": 39375833, "comment_id": 66079863, "body": "@Compynerd255 Then change the code that generates it to give each one a different namespace.  Clearly you need to, to resolve the ambiguity, and it doesn&#39;t even make sense in the first place for them to all be in the same namespace"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1473269264, "post_id": 39375833, "comment_id": 66079906, "body": "The error message tells you <b>exactly</b> what the problem is and where the error is located. What part of that very clearly written, very precise message is unclear?"}, {"owner": {"reputation": 10321, "user_id": 215552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26bda02894d869c95f620de4b7cd386d?s=128&d=identicon&r=PG", "display_name": "Heretic Monkey", "link": "https://stackoverflow.com/users/215552/heretic-monkey"}, "edited": false, "score": 0, "creation_date": 1473269271, "post_id": 39375833, "comment_id": 66079913, "body": "Did you try all of the answers from that question you linked to? Because sometimes you need to try more than just the accepted one... You can also take a look at <a href=\"http://stackoverflow.com/q/11989983/215552\">this question</a> as it seems very similar."}, {"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "reply_to_user": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "edited": false, "score": 0, "creation_date": 1473269291, "post_id": 39375833, "comment_id": 66079926, "body": "@DavidL partial classes must exist in the same assembly, so they cannot be in different projects."}, {"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "reply_to_user": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1473269520, "post_id": 39375833, "comment_id": 66080032, "body": "@RacilHilan correct.  I never said it would work with the OP&#39;s current setup.  I said that typically that would be the approach for declaring same name same namespace classes.  Why this is even being done in the first place is beyond me."}, {"owner": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1473284141, "post_id": 39375833, "comment_id": 66086616, "body": "All the three projects can easily be built by themselves, it is when you start adding references to more than 1 of them to the same fourth project you get into problems. You say that it &quot;used to reference Alpha&quot;, clearly it still references Alpha so remove that reference and rebuild."}, {"owner": {"reputation": 1788, "user_id": 2033557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b01f4a07ec9019af3c695a46c153b9ab?s=128&d=identicon&r=PG", "display_name": "TheHansinator", "link": "https://stackoverflow.com/users/2033557/thehansinator"}, "reply_to_user": {"reputation": 348226, "user_id": 267, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1b11262da6d1cd26b1b0bc99a2620cee?s=128&d=identicon&r=PG", "display_name": "Lasse V. Karlsen", "link": "https://stackoverflow.com/users/267/lasse-v-karlsen"}, "edited": false, "score": 0, "creation_date": 1473284308, "post_id": 39375833, "comment_id": 66086684, "body": "@LasseV.Karlsen I did remove that reference - I stare at the .csproj file and the reference to Alpha is completely gone and completely replaced by the reference to Gamma, complete with path and GUID. The conceit of this question is if there could be some other process or thing that still remembered the reference somehow."}], "answers": [{"tags": [], "owner": {"reputation": 1854, "user_id": 5739282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/79cf06ec3e8d873dccb91e43b6d68d3b?s=128&d=identicon&r=PG", "display_name": "Stephen P.", "link": "https://stackoverflow.com/users/5739282/stephen-p"}, "is_accepted": false, "score": -1, "last_activity_date": 1473270181, "last_edit_date": 1473270181, "creation_date": 1473269836, "answer_id": 39376140, "question_id": 39375833, "link": "https://stackoverflow.com/questions/39375833/how-do-i-diagnose-and-remove-an-ambiguous-reference-in-c/39376140#39376140", "title": "How do I diagnose and remove an ambiguous reference in C#?", "body": "<p>As what the others in the comments have said, what you are doing is impossible... You cannot have two classes with the exact same name in the exact same namespace (unless they are partials).</p>\n\n<p>You have a few options here:</p>\n\n<ol>\n<li>Use different namespaces</li>\n</ol>\n\n<p>The benefit is that you don't have these collisions and can specify your class instances by their fully qualified namespace.</p>\n\n<p><strong>Alpha:</strong></p>\n\n<pre><code>namespace AlphaNamespace {\n    public class SharedClass {\n        // implement SharedClass using Alpha's backend\n    }\n}\n</code></pre>\n\n<p><strong>Beta:</strong></p>\n\n<pre><code>namespace BetaNamespace {\n    public class SharedClass {\n        // implement SharedClass using Beta's backend\n    }\n}\n</code></pre>\n\n<p><strong>Gamma:</strong></p>\n\n<pre><code>namespace GammaNamespace {\n    public class SharedClass {\n        // implement SharedClass using Gamma's backend\n    }\n}\n</code></pre>\n\n<p>Here, omicron would then use gamma as</p>\n\n<pre><code>var gamma = new GammaNamespace.SharedClass(...)\n</code></pre>\n\n<hr>\n\n<ol start=\"2\">\n<li>Use partials</li>\n</ol>\n\n<p><a href=\"http://www.c-sharpcorner.com/UploadFile/3d39b4/partial-classes-in-C-Sharp-with-real-example/\" rel=\"nofollow\">Partial Class Documentation</a></p>\n\n<p>You'd have to merge projects and change method names to avoid collisions when the compiler melds the two classes together. Doubt this'll work the way you want it to...</p>\n\n<p><strong>Alpha:</strong></p>\n\n<pre><code>namespace SharedNamespace {\n    public partial class SharedClass {\n        // implement SharedClass using Alpha's backend\n    }\n}\n</code></pre>\n\n<p><strong>Beta:</strong></p>\n\n<pre><code>namespace SharedNamespace {\n    public partial class SharedClass {\n        // implement SharedClass using Beta's backend\n    }\n}\n</code></pre>\n\n<p><strong>Gamma:</strong></p>\n\n<pre><code>namespace SharedNamespace {\n    public partial class SharedClass {\n        // implement SharedClass using Gamma's backend\n    }\n}\n</code></pre>\n\n<hr>\n\n<ol start=\"3\">\n<li>Use a strategy pattern (or state pattern with interfaces instead of concrete classes)</li>\n</ol>\n\n<p>Here, you would determine which extension of BaseClass you wish to use (Alpha, Beta, or Gamma) and swap it out either through dependency injection or some sort of logical determination.</p>\n\n<pre><code>namespace SharedNamespace {\n    public class BaseClass{\n        // place method abstractions here\n    }\n}\n\n\nnamespace SharedNamespace {\n    public class AlphaClass : BaseClasse {\n        // implement BaseClass using Alpha's backend\n    }\n}\n\nnamespace SharedNamespace {\n    public class BetaClass : BaseClasse {\n        // implement BaseClass using Beta's backend\n    }\n}\n\nnamespace SharedNamespace {\n    public class GammaClass : BaseClasse {\n        // implement BaseClass using Gamma's backend\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1788, "user_id": 2033557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b01f4a07ec9019af3c695a46c153b9ab?s=128&d=identicon&r=PG", "display_name": "TheHansinator", "link": "https://stackoverflow.com/users/2033557/thehansinator"}, "edited": false, "score": 0, "creation_date": 1473270653, "post_id": 39376156, "comment_id": 66080563, "body": "Yes, that is exactly the purpose - to create two different DLLs with the same signature, in order to do different things. I&#39;ll comment again with a note on build controls, but I can&#39;t seem to find any other than the fact that both are never used together in any project. I should duly note, however, that Beta is a Universal Windows library, which might have an effect on this."}], "tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": false, "score": 0, "last_activity_date": 1473283910, "last_edit_date": 1473283910, "creation_date": 1473269897, "answer_id": 39376156, "question_id": 39375833, "link": "https://stackoverflow.com/questions/39375833/how-do-i-diagnose-and-remove-an-ambiguous-reference-in-c/39376156#39376156", "title": "How do I diagnose and remove an ambiguous reference in C#?", "body": "<p>Classes with the same name can exist in different projects, but they cannot belong to the same namespace.</p>\n\n<p>Since you said that Alpha and Beta have been building successfully and the issue started when added Gamma, I suspect that Alpha and Beta where built separately by disabling one while building the other, and vice versa. Check with somebody in your team who's familiar with how they were built in the past.</p>\n\n<p>I think the reason behind that setup is so you create two dlls (Alpha and Beta) with the same class name, so they can be called and used in the same way. That creates two dlls with the same signature to do different things.</p>\n\n<p>Your message somewhat confirms my suspicion as you get an issue with Alpha and Gamma, but not Beta. I think Beta was disabled in preparation to build Alpha when you added Gamma.</p>\n"}, {"tags": [], "owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "is_accepted": false, "score": 15, "last_activity_date": 1473270662, "creation_date": 1473270662, "answer_id": 39376341, "question_id": 39375833, "link": "https://stackoverflow.com/questions/39375833/how-do-i-diagnose-and-remove-an-ambiguous-reference-in-c/39376341#39376341", "title": "How do I diagnose and remove an ambiguous reference in C#?", "body": "<p>First off, as you probably have realized: <strong>this is a terrible situation to be in</strong>.  If you can possibly avoid having the same named class in the same named namespace in two different assemblies that you reference both of them, <strong>avoid that situation</strong>.  It is strongly indicative of an architectural flaw in your application.  It sounds to me like you should be defining an interface in yet a fourth assembly, and then have all your assemblies agree to use that interface.</p>\n\n<p>However, there <em>is</em> a way to deal with this situation in C#.</p>\n\n<p>When you compile Omicron, you should give Alpha.dll, Beta.dll and Gamma.dll a reference alias:</p>\n\n<pre><code>/reference:AlphaDLL=Alpha.DLL /reference:BetaDLL=Beta.DLL ... etc\n</code></pre>\n\n<p>then inside Omicron you say:</p>\n\n<pre><code>extern alias AlphaDLL;\nextern alias BetaDLL;\nextern alias GammaDLL;\n</code></pre>\n\n<p>In a file, and then later in that file you can say:</p>\n\n<pre><code>AlphaDLL::SharedNamespace.SharedClass\n</code></pre>\n\n<p>in order to disambiguate which one is intended.</p>\n\n<p>But again, <strong>do not get into this situation</strong>.  Instead make an interface that SharedClass implements, and have the Alpha, Beta and Gamma implementations all implement that interface with a class whose name does not conflict.</p>\n"}, {"comments": [{"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1473283630, "post_id": 39378227, "comment_id": 66086441, "body": "That&#39;s exactly what I expected. And no, not a terrible situation to be in. It is a completely valid case as I explained in my answer. The only &quot;terrible&quot; issue is that it seems it is not documented as it is often the case that many teams don&#39;t care to create the proper documentation. In all projects I work on, I create the required guides (for dev, test, and live) and every new developer has to read the dev guides before touching the code. If your team had such rules, you wouldn&#39;t have ended up wasting your time like that. That&#39;s why I gave you my answer from experience."}, {"owner": {"reputation": 1788, "user_id": 2033557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b01f4a07ec9019af3c695a46c153b9ab?s=128&d=identicon&r=PG", "display_name": "TheHansinator", "link": "https://stackoverflow.com/users/2033557/thehansinator"}, "reply_to_user": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1473283838, "post_id": 39378227, "comment_id": 66086513, "body": "@RacilHilan That&#39;s a good point - it does work, as you said, and it does fit very well. I only say this situation is terrible (which is probably an exaggeration) because this sort of system is more difficult to document than something based in the language itself, such as an interface or strategy pattern. Those sorts of things are less subject to Murphy&#39;s Law and thus require less documentation in the first place."}, {"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1473284509, "post_id": 39378227, "comment_id": 66086755, "body": "Yes, I fully agree with that, but we all know that we often find ourselves restricted by some weird requirements coming from an external library, framework, or tool that we have to use in our projects. Or sometimes it&#39;s a good existing code that we don&#39;t want to change much. You said that the code was &quot;generated&quot;, so perhaps your team had resorted to the MS-Build technic for some reason. Anyway, I&#39;m glad that you figured it out."}], "tags": [], "owner": {"reputation": 1788, "user_id": 2033557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b01f4a07ec9019af3c695a46c153b9ab?s=128&d=identicon&r=PG", "display_name": "TheHansinator", "link": "https://stackoverflow.com/users/2033557/thehansinator"}, "is_accepted": false, "score": 1, "last_activity_date": 1473279007, "last_edit_date": 1495542380, "creation_date": 1473279007, "answer_id": 39378227, "question_id": 39375833, "link": "https://stackoverflow.com/questions/39375833/how-do-i-diagnose-and-remove-an-ambiguous-reference-in-c/39378227#39378227", "title": "How do I diagnose and remove an ambiguous reference in C#?", "body": "<p>So, after a little digging with a teammate, I found out that even though a reference to Alpha was not found in the project file itself, one of our <code>.targets</code> files was directing MSBuild to add a project reference to Alpha behind my back:</p>\n\n<pre><code>&lt;Choose&gt;\n    &lt;When Condition=\" &lt;!-- needs beta --&gt; \"&gt;\n        &lt;ItemGroup&gt;\n            &lt;ProjectReference Include=\"$(absdtSln)path\\to\\Beta\"&gt;\n                ...\n            &lt;/ProjectReference&gt;\n        &lt;/ItemGroup&gt;\n    &lt;/When&gt;\n    &lt;Otherwise&gt;\n        &lt;ItemGroup&gt;\n            &lt;ProjectReference Include=\"$(absdtSln)path\\to\\Alpha\"&gt;\n                ...\n            &lt;/ProjectReference&gt;\n        &lt;/ItemGroup&gt;\n    &lt;/Otherwise&gt;\n&lt;/Choose&gt;\n</code></pre>\n\n<p>(This, I assume, is so that projects that reference Alpha and Beta don't have to do so manually, as I was trying to do and was explicitly done on the project I was testing).</p>\n\n<p>I added another case for Gamma and things work now.</p>\n\n<p>(And yes, <a href=\"https://stackoverflow.com/a/39376341/2033557\">@Eric</a>, stuff like this is yet another testament that this is a terrible situation to be in.)</p>\n"}], "owner": {"reputation": 1788, "user_id": 2033557, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b01f4a07ec9019af3c695a46c153b9ab?s=128&d=identicon&r=PG", "display_name": "TheHansinator", "link": "https://stackoverflow.com/users/2033557/thehansinator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1473283910, "creation_date": 1473268698, "last_edit_date": 1495542380, "question_id": 39375833, "link": "https://stackoverflow.com/questions/39375833/how-do-i-diagnose-and-remove-an-ambiguous-reference-in-c", "title": "How do I diagnose and remove an ambiguous reference in C#?", "body": "<p>(Please feel free to suggest a more accurate title to this question.)</p>\n\n<p>In my Visual Studio 2015 solution, I have three projects (let's call them Alpha, Beta, and Gamma) that are more or less the same thing, but differ in that they define different backends. Both of these projects hot-plug a class into the same namespace:</p>\n\n<p><strong>Alpha:</strong></p>\n\n<pre><code>namespace SharedNamespace {\n    public class SharedClass {\n        // implement SharedClass using Alpha's backend\n    }\n}\n</code></pre>\n\n<p><strong>Beta:</strong></p>\n\n<pre><code>namespace SharedNamespace {\n    public class SharedClass {\n        // implement SharedClass using Beta's backend\n    }\n}\n</code></pre>\n\n<p><strong>Gamma:</strong></p>\n\n<pre><code>namespace SharedNamespace {\n    public class SharedClass {\n        // implement SharedClass using Gamma's backend\n    }\n}\n</code></pre>\n\n<p>Several projects use this hot-plugged class, each referencing either Alpha, Beta, or Gamma. One of them (let's call it <strong>Omricon</strong>) used to reference Alpha, but now references Gamma:</p>\n\n<pre><code>// ...\nSharedNamespace.SharedClass sharedClass;\nsharedClass.DoThing();\n// ...\n</code></pre>\n\n<p>When I attempt to build Omricon, however, the C# compiler gives error CS0433:</p>\n\n<pre><code>The type 'SharedClass' exists in both 'Alpha, Version=0.0.0.0 (etc)' \nand 'Gamma, Version=0.0.0.0 (etc)'\n</code></pre>\n\n<p>However, Omricon <em>only</em> references Gamma when it is built - when I go into the project references list, only the reference to Gamma appears. As far as I understand it, Omricon should know <em>nothing</em> about Alpha at all, much less that it defines a class in the same location. Only Omricon fails to build - other projects that use Alpha and Beta work fine, and when I switch Omricon back to using Alpha, it works fine as well!</p>\n\n<p>It appears to me that a reference to Alpha is being maintained, then, somewhere else. How can I find the stray reference to Alpha, wherever it lies in my code, and remove it?</p>\n\n<p>Note that I have tried forcing a full rebuild (as <a href=\"https://stackoverflow.com/a/15772222/2033557\">this answer</a> suggested), and the same error still appears, so it has nothing to do with bad object caching.</p>\n\n<p><strong>EDIT:</strong> clarified second to last paragraph</p>\n"}, {"tags": ["c#", "timer"], "answers": [{"comments": [{"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 1, "creation_date": 1473268494, "post_id": 39375780, "comment_id": 66079525, "body": "I&#39;m new to .net, can you explain why moving the code to a <code>protected void</code> allows it to run on a thread like the timer does?"}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1473268591, "post_id": 39375780, "comment_id": 66079571, "body": "Could I not just do <code>Task.Run(() =&gt; doQuery1(null,null)</code> with the same result?"}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "reply_to_user": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 1, "creation_date": 1473268704, "post_id": 39375780, "comment_id": 66079625, "body": "@Scott You could, but somebody would come along later and waste time figuring out what those nulls meant. Only use event handler methods for event handers. Method that does stuff with no parameters should be <code>MethodThatDoesStuff()</code>."}, {"owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 0, "creation_date": 1473268735, "post_id": 39375780, "comment_id": 66079636, "body": "Makes sense.  Thanks"}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "reply_to_user": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "edited": false, "score": 1, "creation_date": 1473268736, "post_id": 39375780, "comment_id": 66079637, "body": "@Scott You&#39;re missing a using, unless you&#39;re on a lower version of .NET, in which case you need to use <code>System.Threading.Thread</code>."}], "tags": [], "owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "is_accepted": true, "score": 3, "last_activity_date": 1473268522, "last_edit_date": 1473268522, "creation_date": 1473268442, "answer_id": 39375780, "question_id": 39375756, "link": "https://stackoverflow.com/questions/39375756/fire-timer-immediately/39375780#39375780", "title": "Fire timer immediately?", "body": "<pre><code>protected void PerformLongRunningODBCQuery()\n{\n    // ...long running ODBC query stuff. \n}\n\npublic void doQuery1(object source, ElapsedEventArgs e)\n{\n    PerformLongRunningODBCQuery();\n}\n\nprivate void btnQuery1Start_Click(object sender, EventArgs e)\n{\n    query1Timer.Interval = Convert.ToInt32(txtQuery1Interval.Text) * 1000;\n    query1Timer.Enabled = true;\n    Task.Run(() =&gt; PerformLongRunningODBCQuery());\n}\n</code></pre>\n\n<p>That'll be five cents, please. </p>\n"}], "owner": {"reputation": 15494, "user_id": 736893, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7heMQ.png?s=128&g=1", "display_name": "JOATMON", "link": "https://stackoverflow.com/users/736893/joatmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1473, "favorite_count": 0, "accepted_answer_id": 39375780, "answer_count": 1, "score": -1, "last_activity_date": 1473268522, "creation_date": 1473268312, "last_edit_date": 1495540305, "question_id": 39375756, "link": "https://stackoverflow.com/questions/39375756/fire-timer-immediately", "title": "Fire timer immediately?", "body": "<p>I've reviewed <a href=\"https://stackoverflow.com/questions/6924072/how-to-fire-timer-elapsed-event-immediately\">this question</a>, but I'm still having issues.  First off, I cannot find a <code>Timer_Tick</code> or <code>.tick</code> method anywhere.  Secondly, if I just call the Elapsed Event Handler manually it isn't on a separate thread and locks the UI.</p>\n\n<p>Here is how my timers are implemented:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    System.Timers.Timer query1Timer = new System.Timers.Timer();\n    ...\n\n    private void Form1_Load(object sender, EventArgs e)\n    {\n        query1Timer.Elapsed += new ElapsedEventHandler(doQuery1);\n        ...\n\n    public void doQuery1(object source, ElapsedEventArgs e)\n    {\n        //long running ODBC query\n    }\n\n    private void btnQuery1Start_Click(object sender, EventArgs e)\n    {\n        query1Timer.Interval = Convert.ToInt32(txtQuery1Interval.Text) * 1000;\n        query1Timer.Enabled = true;\n    }\n</code></pre>\n\n<p>How can I have <code>btnQuery1Start</code> run the query immediately on the System.Timers thread, just as it would after the first interval?</p>\n"}, {"tags": ["c#", ".net", "com", "ms-office", "comexception"], "comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1473268242, "post_id": 39375682, "comment_id": 66079393, "body": "You running the code in IIS or as a windows service?"}, {"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1473268321, "post_id": 39375682, "comment_id": 66079442, "body": "Can be a lot of things. Main suspects: corrupt installations, missing dependencies and version conflicts and user rights."}], "owner": {"reputation": 20047, "user_id": 166452, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/I26rB.jpg?s=128&g=1", "display_name": "Ignacio Soler Garcia", "link": "https://stackoverflow.com/users/166452/ignacio-soler-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473269357, "creation_date": 1473268004, "last_edit_date": 1473269357, "question_id": 39375682, "link": "https://stackoverflow.com/questions/39375682/what-does-rpc-call-failed-mean-when-executing-documents-open-thru-word-interop", "title": "What does RPC call failed mean when executing Documents.Open thru Word interop", "body": "<p>We are getting error reports from our customers with a </p>\n\n<blockquote>\n  <p>COMException 0x800706BE The remote procedure call failed</p>\n</blockquote>\n\n<p>The code generating this exception is the following one:</p>\n\n<pre><code>   Microsoft.Office.Interop.Word.Documents.Open(Object&amp; FileName, Object&amp; ConfirmConversions, Object&amp; ReadOnly, Object&amp; AddToRecentFiles, Object&amp; PasswordDocument, Object&amp; PasswordTemplate, Object&amp; Revert, Object&amp; WritePasswordDocument, Object&amp; WritePasswordTemplate, Object&amp; Format, Object&amp; Encoding, Object&amp; Visible, Object&amp; OpenAndRepair, Object&amp; DocumentDirection, Object&amp; NoEncodingDialog, Object&amp; XMLTransform)\n</code></pre>\n\n<p>I cannot find information anywhere about what can be the cause of this exception code and I cannot reproduce it in our computers. I can get similar exceptions doing weird things (debugging and stopping it, hanging the process, etc) to Word but not this one.</p>\n\n<p>Does anyone know what can mean / be the cause of this exception?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>More information. The application is a client app running on a Windows 7 computer and the error is intermitent so looks like it is not related with the environment.</p>\n"}, {"tags": ["c#", "configurationmanager"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 3, "creation_date": 1473268063, "post_id": 39375658, "comment_id": 66079313, "body": "most likely the app is reading a different config file. Use procmon to see what its doing"}, {"owner": {"reputation": 71114, "user_id": 567435, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zYyZz.jpg?s=128&g=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/567435/rahul"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1473268142, "post_id": 39375658, "comment_id": 66079341, "body": "absolutely correct @pm100,"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1473268259, "post_id": 39375658, "comment_id": 66079402, "body": "just in case - procmon = <a href=\"https://technet.microsoft.com/en-us/sysinternals/processmonitor\" rel=\"nofollow noreferrer\">technet.microsoft.com/en-us/sysinternals/processmonitor</a>"}, {"owner": {"reputation": 1774, "user_id": 4808901, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/286a1b949d771dda5fdfed96f47971e1?s=128&d=identicon&r=PG", "display_name": "Abdul Mateen Mohammed", "link": "https://stackoverflow.com/users/4808901/abdul-mateen-mohammed"}, "edited": false, "score": 0, "creation_date": 1473268448, "post_id": 39375658, "comment_id": 66079505, "body": "Make sure that you added the app.config file at the right place and you might be having multiple projects, the app.config file should go into the startup project i.e. the one with the presentation layer or the executable one such as a console application, WPF application or an ASP.NET application"}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1473268894, "post_id": 39375658, "comment_id": 66079734, "body": "Firs check whether you have .config in your application directory. If so, check whether you have correct entries that you are looking for."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 8466604, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-psQAylnbVzk/AAAAAAAAAAI/AAAAAAAAAcQ/UH0jNY8tL_c/photo.jpg?sz=128", "display_name": "QSS", "link": "https://stackoverflow.com/users/8466604/qss"}, "is_accepted": false, "score": 0, "last_activity_date": 1524037829, "creation_date": 1524037829, "answer_id": 49894088, "question_id": 39375658, "link": "https://stackoverflow.com/questions/39375658/system-configuration-configurationmanager-appsettings-not-working/49894088#49894088", "title": "System.Configuration.ConfigurationManager.AppSettings not working", "body": "<p>The most likely issue is that you are missing a reference to the System.Configuration.dll.  </p>\n\n<p>Right click on project, add reference to System.Configuration dll and hopefully it will work.</p>\n"}], "owner": {"reputation": 11, "user_id": 5697042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f1d551494a5afd55110ba1383b292cd?s=128&d=identicon&r=PG&f=1", "display_name": "user5697042", "link": "https://stackoverflow.com/users/5697042/user5697042"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3699, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524037829, "creation_date": 1473267858, "question_id": 39375658, "link": "https://stackoverflow.com/questions/39375658/system-configuration-configurationmanager-appsettings-not-working", "title": "System.Configuration.ConfigurationManager.AppSettings not working", "body": "<h2>Below is my app.config file</h2>\n\n\n\n<pre><code>&lt;configuration&gt;\n  &lt;appSettings&gt;\n    &lt;add key=\"input_file\" value=\"D:\\bioen\\Web\\NewUser\\dotnet\\PasswordGenerator\\AutoPassword\\AutoPassword\\Passwords.txt\"/&gt;\n    &lt;add key=\"location\" value=\"sequals\"/&gt;\n  &lt;/appSettings&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<hr>\n\n<p>when I attempt to read this values in a program like what is shown below,\nboth strings are null. Why is this?</p>\n\n<hr>\n\n<pre><code>string path = System.Configuration.ConfigurationManager.AppSettings[\"input_file\"];\nstring location = System.Configuration.ConfigurationManager.AppSettings[\"location\"];\n</code></pre>\n"}, {"tags": ["c#", "c++", "winapi", "audio-capture"], "comments": [{"owner": {"reputation": 2125, "user_id": 6691061, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1219688551388660/picture?type=large", "display_name": "Shannon Holsinger", "link": "https://stackoverflow.com/users/6691061/shannon-holsinger"}, "edited": false, "score": 0, "creation_date": 1473267711, "post_id": 39375591, "comment_id": 66079146, "body": "Yeah - that&#39;s WHY the &quot;majority of applications [you] intend to capture are protected by various anti-cheat systems.&quot; Danged copwrite laws. Who needs &#39;em?"}, {"owner": {"reputation": 64286, "user_id": 868014, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PoaTp.png?s=128&g=1", "display_name": "Roman R.", "link": "https://stackoverflow.com/users/868014/roman-r"}, "edited": false, "score": 0, "creation_date": 1473267906, "post_id": 39375591, "comment_id": 66079243, "body": "You will have to hook. And most likely not just <code>IAudioRenderClient</code> but all audio APIs the applications in question use."}], "owner": {"reputation": 1, "user_id": 6805622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a44b8e7e5879397763ae0c1962e5772e?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/6805622/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "closed_date": 1473267963, "answer_count": 0, "score": 0, "last_activity_date": 1473270540, "creation_date": 1473267535, "last_edit_date": 1495542765, "question_id": 39375591, "link": "https://stackoverflow.com/questions/39375591/capturing-a-single-applications-audio-with-win32", "closed_reason": "Duplicate", "title": "Capturing a single application&#39;s audio with Win32", "body": "<p>How would I go about capturing the audio output of a single application with Win32/C++/C#, whilst avoiding hooking against <code>IAudioRenderClient</code>?</p>\n\n<p>I have only been able to find solutions to capture the whole audio output of the system (or rather, the currently active audio output port / capture device), either through DirectShow or various other Win32 API functions (WASAPI etc.) which were of little help (because I only need a single applications audio output). The only viable solution seemed to be hooking the applications IAudioRenderClient and then calling <code>IAudioRenderClient::GetBuffers()</code> according to <a href=\"https://stackoverflow.com/questions/6084550/capture-audio-of-a-single-application-on-windows-7\">this</a>.</p>\n\n<p>The reason I am trying to avoid this is that a majority of applications I intend to capture are protected by various anti-cheat systems, able to detect the code injection but unable to differentiate it from an actual cheat.</p>\n\n<p>Any pointers towards APIs/API-functions etc. or anything silencing my concerns of false detection would be highly appreciated.</p>\n"}, {"tags": ["c#", "asp.net", "regex", "webforms"], "comments": [{"owner": {"reputation": 230, "user_id": 4149494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3c1be40304bcc4f08110db8d63d3c3f?s=128&d=identicon&r=PG", "display_name": "Morten Toudahl", "link": "https://stackoverflow.com/users/4149494/morten-toudahl"}, "edited": false, "score": 0, "creation_date": 1473267262, "post_id": 39375452, "comment_id": 66078905, "body": "Do you need to be able to change them without recompiling? If not, maybe you could just use a static class with some read only properties?"}, {"owner": {"reputation": 2125, "user_id": 6691061, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1219688551388660/picture?type=large", "display_name": "Shannon Holsinger", "link": "https://stackoverflow.com/users/6691061/shannon-holsinger"}, "edited": false, "score": 0, "creation_date": 1473267299, "post_id": 39375452, "comment_id": 66078925, "body": "You can save them to disk, save them to database, save them in settings, put them in application scope. There are many, many ways to persist those strings. Probably the easiest would be to store them in a text file if you don&#39;t already use a database. This all assumes you need to change them after compile. If not, then use application scope or a public static class."}], "answers": [{"tags": [], "owner": {"reputation": 274, "user_id": 6758819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99046e2c8cf7772367146bb00de77d6b?s=128&d=identicon&r=PG&f=1", "display_name": "sly", "link": "https://stackoverflow.com/users/6758819/sly"}, "is_accepted": true, "score": 1, "last_activity_date": 1473279043, "last_edit_date": 1473279043, "creation_date": 1473278733, "answer_id": 39378175, "question_id": 39375452, "link": "https://stackoverflow.com/questions/39375452/store-regular-expressions-for-use-throughout-web-application/39378175#39378175", "title": "Store regular expressions for use throughout web application", "body": "<p>I typically create a Resources file in the ASP.NET <code>App_GlobalResources</code> folder to centralize all my string constants and then reference the string in the markup. For this example I created a <code>RegexStrings.resx</code> resource file and added a key <code>URL</code> with a value containing your regular expression string:</p>\n\n<pre><code>&lt;asp:TextBox ID=\"UrlTextBox\" runat=\"server\"&gt;&lt;/asp:TextBox&gt;\n&lt;asp:RegularExpressionValidator ID=\"UrlRegEx\" runat=\"server\"     \n                                ErrorMessage=\"Invalid url.\" \n                                ControlToValidate=\"UrlTextBox\"     \n                                ValidationExpression=\"&lt;%$ Resources:RegexStrings, URL %&gt;\" /&gt;\n</code></pre>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/ms227427.aspx\" rel=\"nofollow\">ASP.NET Web Page Resources Overview</a> for details</p>\n"}], "owner": {"reputation": 1109, "user_id": 2706919, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/623320009/picture?type=large", "display_name": "Simon", "link": "https://stackoverflow.com/users/2706919/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 39378175, "answer_count": 1, "score": 1, "last_activity_date": 1473279043, "creation_date": 1473267029, "question_id": 39375452, "link": "https://stackoverflow.com/questions/39375452/store-regular-expressions-for-use-throughout-web-application", "title": "Store regular expressions for use throughout web application", "body": "<p>I have a web application that contains many forms with textbox fields on for dates and URLs etc.</p>\n\n<p>I am using <code>&lt;asp:RegularExpressionValidator&gt;</code> to validate the textbox content and wondered if there was a way I could centrally store the expressions I am using in something like a web.config file so I can easily reference them each time I add a <code>&lt;asp:RegularExpressionValidator&gt;</code>, rather than having to type out the entire regex i.e.</p>\n\n<p><strong>Regex store</strong></p>\n\n<pre><code>string urlRegEx = \"(https?:\\/\\/(?:www\\.|(?!www))[^\\s\\.]+\\.[^\\s]{2,}|www\\.[^\\s]+\\.[^\\s]{2,})\"\n</code></pre>\n\n<p><strong>Web form</strong>   </p>\n\n<pre><code>&lt;asp:RegularExpressionValidator ValidationExpression=urlRegEx&gt;\n&lt;/asp:RegularExpressionValidator&gt;\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c#", "powershell"], "comments": [{"owner": {"reputation": 2268, "user_id": 6421240, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oSaJ0glVrNI/AAAAAAAAAAI/AAAAAAAAAJs/drWVt8fH_8A/photo.jpg?sz=128", "display_name": "Mike Garuccio", "link": "https://stackoverflow.com/users/6421240/mike-garuccio"}, "edited": false, "score": 0, "creation_date": 1473268785, "post_id": 39375405, "comment_id": 66079658, "body": "Not sure if it will solve the problem for you but if your going to have another piece of code pick up the results of the function you should skip piping the results to ft, that cmdlet will change your nice object into an array that is designed for easy viewing in the console but that other code will have trouble dealing with"}, {"owner": {"reputation": 19, "user_id": 6798953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928e13c786404daceb22ed36b3b46e6e?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas A", "link": "https://stackoverflow.com/users/6798953/niklas-a"}, "reply_to_user": {"reputation": 2268, "user_id": 6421240, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oSaJ0glVrNI/AAAAAAAAAAI/AAAAAAAAAJs/drWVt8fH_8A/photo.jpg?sz=128", "display_name": "Mike Garuccio", "link": "https://stackoverflow.com/users/6421240/mike-garuccio"}, "edited": false, "score": 0, "creation_date": 1473275615, "post_id": 39375405, "comment_id": 66082837, "body": "@MikeGaruccio Oh, I just added that for testing. If i remove it, I also have to remove the DisplaymemberBinding from the xaml, otherwise it cant add it to the table. And when I remove that I get the same output in all columns, still all in one row. Every software gets 5 rows: Name, Vendor, Version, PSComputername and RunspaceID. And then the list contiues like that in a single row.. Hope you understand, I can upload a printscreen somewhere if you like."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6798953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928e13c786404daceb22ed36b3b46e6e?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas A", "link": "https://stackoverflow.com/users/6798953/niklas-a"}, "edited": false, "score": 0, "creation_date": 1473275833, "post_id": 39376421, "comment_id": 66082950, "body": "Oh, I just added that for testing. If i remove it, I also have to remove the DisplaymemberBinding from the xaml, otherwise it cant add it to the table. And when I remove that I get the same output in all columns, still all in one row. Every software gets 5 rows: Name, Vendor, Version, PSComputername and RunspaceID. And then the list contiues like that in a single row.. Hope you understand, I can upload a printscreen somewhere if you like."}, {"owner": {"reputation": 1408, "user_id": 747760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c52bcf6ac375075cdf2cc9b7f3870fb?s=128&d=identicon&r=PG", "display_name": "jbsmith", "link": "https://stackoverflow.com/users/747760/jbsmith"}, "reply_to_user": {"reputation": 19, "user_id": 6798953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928e13c786404daceb22ed36b3b46e6e?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas A", "link": "https://stackoverflow.com/users/6798953/niklas-a"}, "edited": false, "score": 0, "creation_date": 1473277218, "post_id": 39376421, "comment_id": 66083617, "body": "I still think &quot; stringBuilder.AppendLine(obj.ToString());&quot; is your main issue."}, {"owner": {"reputation": 19, "user_id": 6798953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928e13c786404daceb22ed36b3b46e6e?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas A", "link": "https://stackoverflow.com/users/6798953/niklas-a"}, "edited": false, "score": 0, "creation_date": 1473278520, "post_id": 39376421, "comment_id": 66084190, "body": "Yes, I guess so.. I&#39;m no C#-pro, do you know any way to make it work like I want?"}, {"owner": {"reputation": 2268, "user_id": 6421240, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oSaJ0glVrNI/AAAAAAAAAAI/AAAAAAAAAJs/drWVt8fH_8A/photo.jpg?sz=128", "display_name": "Mike Garuccio", "link": "https://stackoverflow.com/users/6421240/mike-garuccio"}, "edited": false, "score": 0, "creation_date": 1473348776, "post_id": 39376421, "comment_id": 66116047, "body": "I don&#39;t think the stringbuilder is the problem, from what I&#39;m seeing that&#39;s basically just loading the script file into memory for C# to run, which I&#39;m not sure you need but shouldn&#39;t cause a problem, at least not with the results formatting.  I think I may have found the issue tho, your adding an Out-String to the pipeline, that&#39;s going to take your objects and turn them into a string, does commenting that out help anything?  Also if your not 100% comfortable in C# it may be easier to write the whole thing in powershell? learn-powershell.net has a great tutorial on how to do that with a GUI"}, {"owner": {"reputation": 19, "user_id": 6798953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928e13c786404daceb22ed36b3b46e6e?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas A", "link": "https://stackoverflow.com/users/6798953/niklas-a"}, "reply_to_user": {"reputation": 2268, "user_id": 6421240, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oSaJ0glVrNI/AAAAAAAAAAI/AAAAAAAAAJs/drWVt8fH_8A/photo.jpg?sz=128", "display_name": "Mike Garuccio", "link": "https://stackoverflow.com/users/6421240/mike-garuccio"}, "edited": false, "score": 0, "creation_date": 1473350854, "post_id": 39376421, "comment_id": 66117356, "body": "@MikeGaruccio I just tried commenting that out and it does not work either..  Actually, I already created some powershell-GUI-applications but I want to do this in C#, I want to learn that as well!"}, {"owner": {"reputation": 1408, "user_id": 747760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c52bcf6ac375075cdf2cc9b7f3870fb?s=128&d=identicon&r=PG", "display_name": "jbsmith", "link": "https://stackoverflow.com/users/747760/jbsmith"}, "edited": false, "score": 0, "creation_date": 1473358722, "post_id": 39376421, "comment_id": 66121377, "body": "What if you just return &quot;results&quot; from RunScript instead of collecting those up in a stringbuilder?"}, {"owner": {"reputation": 19, "user_id": 6798953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928e13c786404daceb22ed36b3b46e6e?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas A", "link": "https://stackoverflow.com/users/6798953/niklas-a"}, "edited": false, "score": 0, "creation_date": 1473436651, "post_id": 39376421, "comment_id": 66155624, "body": "@jbsmith As I said, I&#39;m just getting started with c# and I&#39;m kind of dumb when it comes to this.. Can you guide me on where and what to change more exacty?"}], "tags": [], "owner": {"reputation": 1408, "user_id": 747760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c52bcf6ac375075cdf2cc9b7f3870fb?s=128&d=identicon&r=PG", "display_name": "jbsmith", "link": "https://stackoverflow.com/users/747760/jbsmith"}, "is_accepted": false, "score": 0, "last_activity_date": 1473784607, "last_edit_date": 1473784607, "creation_date": 1473270909, "answer_id": 39376421, "question_id": 39375405, "link": "https://stackoverflow.com/questions/39375405/powershell-string-to-listview/39376421#39376421", "title": "Powershell-string to listview", "body": "<p>It looks like you're looping through the PSObject results and appending them to a single StringBuilder. When you're adding the results from RunScript to the SWList items, you're only adding that single string. That's why it's only showing up in one row.</p>\n\n<p>And as Mike indicated in his comment, by using the Format-Table cmdlet at the end of your script you are undoing the nice object properties generated by PowerShell; this is almost certainly what is causing it to show up in a single column.</p>\n\n<p>Here's an example of an updated RunScript method that returns a collection of objects instead of a single string. Note how I changed the method signature to return a Collection of PSObjects instead of just a string. I also commented out the line that adds Out-String to the end of the pipeline. This means that you'll get the raw PSObjects returned from this function. Depending on what script you run, the BaseObject of these PSObjects will be of a different type. You can access the BaseObject property of these PSObjects to get the values you need.</p>\n\n<pre><code>private Collection&lt;PSObject&gt; RunScript(string scriptText)\n    {\n        // create Powershell runspace \n        Runspace runspace = RunspaceFactory.CreateRunspace();\n\n        // open it \n        runspace.Open();\n        runspace.SessionStateProxy.SetVariable(\"ComputerName\", CompnameInput.Text);\n        runspace.SessionStateProxy.SetVariable(\"user\", UserNameInput.Text);\n\n        // create a pipeline and feed it the script text \n        Pipeline pipeline = runspace.CreatePipeline();\n        pipeline.Commands.AddScript(scriptText);\n\n        // add an extra command to transform the script output objects into nicely formatted strings \n        // remove this line to get the actual objects that the script returns. For example, the script \n        // \"Get-Process\" returns a collection of System.Diagnostics.Process instances. \n      //  pipeline.Commands.Add(\"Out-String\");\n\n        // execute the script \n        Collection&lt;PSObject&gt; results = pipeline.Invoke();\n\n        // close the runspace \n        runspace.Close();\n\n        return results;\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 19, "user_id": 6798953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/928e13c786404daceb22ed36b3b46e6e?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas A", "link": "https://stackoverflow.com/users/6798953/niklas-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 634, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473784607, "creation_date": 1473266853, "question_id": 39375405, "link": "https://stackoverflow.com/questions/39375405/powershell-string-to-listview", "title": "Powershell-string to listview", "body": "<p>I have created a C# application that, among other things, should get the installed programs on a remote computer by using powershell code. I can run the code but it only adds the items to a single column in a single row and I'm not able to scroll in it. </p>\n\n<p>Can you tell me how to add each program to a new row, where the headers are: Program, Vendor, Version ?\nHere is the ps1 code:</p>\n\n<pre><code>Invoke-Command -ComputerName $computername -ScriptBlock {\n    $SWInstalled = get-wmiobject Win32_product | select @{Label=\"Program\";Expression={$_.Name}}, version, vendor | Sort-Object Program\n    $SWInstalled | ft\n}\n</code></pre>\n\n<p>Here is the relevant c# code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows;\nusing System.Windows.Controls;\nusing System.Windows.Data;\nusing System.Windows.Documents;\nusing System.Windows.Input;\nusing System.Windows.Media;\nusing System.Windows.Media.Imaging;\nusing System.Windows.Navigation;\nusing System.Windows.Shapes;\nusing System.Collections.ObjectModel;\nusing System.Management.Automation;\nusing System.Management.Automation.Runspaces;\nusing System.IO;\n\nnamespace ClientCheck\n{\n    /// &lt;summary&gt;\n    /// Interaction logic for MainWindow.xaml\n    /// &lt;/summary&gt;\n    public partial class MainWindow : Window\n    {\n        private string RunScript(string scriptText)\n        {\n            // create Powershell runspace \n            Runspace runspace = RunspaceFactory.CreateRunspace();\n\n            // open it \n            runspace.Open();\n            runspace.SessionStateProxy.SetVariable(\"ComputerName\", CompnameInput.Text);\n            runspace.SessionStateProxy.SetVariable(\"user\", UserNameInput.Text);\n\n            // create a pipeline and feed it the script text \n            Pipeline pipeline = runspace.CreatePipeline();\n            pipeline.Commands.AddScript(scriptText);\n\n            // add an extra command to transform the script output objects into nicely formatted strings \n            // remove this line to get the actual objects that the script returns. For example, the script \n            // \"Get-Process\" returns a collection of System.Diagnostics.Process instances. \n            pipeline.Commands.Add(\"Out-String\");\n\n            // execute the script \n            Collection&lt;PSObject&gt; results = pipeline.Invoke();\n\n            // close the runspace \n            runspace.Close();\n\n            // convert the script result into a single string \n            StringBuilder stringBuilder = new StringBuilder();\n            foreach (PSObject obj in results)\n            {\n                stringBuilder.AppendLine(obj.ToString());\n            }\n\n            // return the results of the script that has \n            // now been converted to text \n            return stringBuilder.ToString();\n        }\n        // helper method that takes your script path, loads up the script \n        // into a variable, and passes the variable to the RunScript method \n        // that will then execute the contents \n        private string LoadScript(string filename)\n        {\n            try\n            {\n                // Create an instance of StreamReader to read from our file. \n                // The using statement also closes the StreamReader. \n                using (StreamReader sr = new StreamReader(filename))\n                {\n\n                    // use a string builder to get all our lines from the file \n                    StringBuilder fileContents = new StringBuilder();\n\n                    // string to hold the current line \n                    string curLine;\n\n                    // loop through our file and read each line into our \n                    // stringbuilder as we go along \n                    while ((curLine = sr.ReadLine()) != null)\n                    {\n                        // read each line and MAKE SURE YOU ADD BACK THE \n                        // LINEFEED THAT IT THE ReadLine() METHOD STRIPS OFF \n                        fileContents.Append(curLine + \"\\n\");\n                    }\n\n                    // call RunScript and pass in our file contents \n                    // converted to a string \n                    return fileContents.ToString();\n                }\n            }\n            catch (Exception e)\n            {\n                // Let the user know what went wrong. \n                string errorText = \"The file could not be read:\";\n                errorText += e.Message + \"\\n\";\n                return errorText;\n            }\n\n\n        private void GetSWButton_Click(object sender, RoutedEventArgs e)\n        {\n            SWList.Items.Clear();\n            SWList.Items.Add((RunScript(LoadScript(@\"C:\\Get_Installed_Software.ps1\"))));\n        }\n    }\n}\n</code></pre>\n\n<p>Also, here is the XAML code:</p>\n\n<pre><code>&lt;ListView x:Name=\"SWList\" Height=\"404\" Margin=\"36,169,36,51\" VerticalAlignment=\"Center\" RenderTransformOrigin=\"0.5,0.5\" ScrollViewer.HorizontalScrollBarVisibility=\"Disabled\" BorderThickness=\"0\" Visibility=\"Hidden\" Grid.Row=\"2\"&gt;\n    &lt;ListView.RenderTransform&gt;\n        &lt;TransformGroup&gt;\n            &lt;ScaleTransform/&gt;\n            &lt;SkewTransform AngleX=\"-0.0\"/&gt;\n            &lt;RotateTransform/&gt;\n            &lt;TranslateTransform X=\"0.346\"/&gt;\n        &lt;/TransformGroup&gt;\n    &lt;/ListView.RenderTransform&gt;\n    &lt;ListView.View&gt;\n        &lt;GridView&gt;\n            &lt;GridViewColumn Header=\"Program\" DisplayMemberBinding =\"{Binding 'Program'}\" Width=\"440\"/&gt;\n            &lt;GridViewColumn Header=\"Vendor\" DisplayMemberBinding=\"{Binding 'Vendor'}\" Width=\"281\"/&gt;\n            &lt;GridViewColumn Header=\"Version\" DisplayMemberBinding =\"{Binding 'Version'}\" Width=\"150\"/&gt;\n        &lt;/GridView&gt;\n    &lt;/ListView.View&gt;\n&lt;/ListView&gt;\n</code></pre>\n"}, {"tags": ["c#", "unity3d", "components"], "answers": [{"comments": [{"owner": {"reputation": 1483, "user_id": 6213883, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-Undmv-4m5tk/AAAAAAAAAAI/AAAAAAAAACA/LsFc3HVNVFE/photo.jpg?sz=128", "display_name": "Florian Castelain", "link": "https://stackoverflow.com/users/6213883/florian-castelain"}, "edited": false, "score": 0, "creation_date": 1473267133, "post_id": 39375439, "comment_id": 66078823, "body": "HAAA, Come on! I&#39;m so jgifodgjfoids stupid... thanks!"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 1483, "user_id": 6213883, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-Undmv-4m5tk/AAAAAAAAAAI/AAAAAAAAACA/LsFc3HVNVFE/photo.jpg?sz=128", "display_name": "Florian Castelain", "link": "https://stackoverflow.com/users/6213883/florian-castelain"}, "edited": false, "score": 0, "creation_date": 1473267211, "post_id": 39375439, "comment_id": 66078867, "body": "It&#39;s just a minor mistake. Every beginner will go through stuff like this."}, {"owner": {"reputation": 1483, "user_id": 6213883, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-Undmv-4m5tk/AAAAAAAAAAI/AAAAAAAAACA/LsFc3HVNVFE/photo.jpg?sz=128", "display_name": "Florian Castelain", "link": "https://stackoverflow.com/users/6213883/florian-castelain"}, "edited": false, "score": 0, "creation_date": 1473267462, "post_id": 39375439, "comment_id": 66079007, "body": "Well, that&#39;s a bit akward because I&#39;ve been working 3 months during an internship with UNET (and it works well), so It annoys me a lot doing this mistakes... Will accept your answer, good day!"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "reply_to_user": {"reputation": 1483, "user_id": 6213883, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-Undmv-4m5tk/AAAAAAAAAAI/AAAAAAAAACA/LsFc3HVNVFE/photo.jpg?sz=128", "display_name": "Florian Castelain", "link": "https://stackoverflow.com/users/6213883/florian-castelain"}, "edited": false, "score": 0, "creation_date": 1473267657, "post_id": 39375439, "comment_id": 66079115, "body": "3 months is not long. 1+year is what is considered long. If you spend about a year with Unity, you won&#39;t have problems like that. Happy coding!"}], "tags": [], "owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "is_accepted": true, "score": 2, "last_activity_date": 1473267137, "last_edit_date": 1473267137, "creation_date": 1473266978, "answer_id": 39375439, "question_id": 39375373, "link": "https://stackoverflow.com/questions/39375373/unity3d-ui-text/39375439#39375439", "title": "Unity3d UI text", "body": "<p>Simply replace </p>\n\n<pre><code>AccountsButtons[i].GetComponentInChildren(Text).text = AccountName;\n</code></pre>\n\n<p>with </p>\n\n<pre><code>AccountsButtons[i].GetComponentInChildren&lt;Text&gt;().text = AccountName;\n</code></pre>\n\n<p>That's the <a href=\"https://docs.unity3d.com/ScriptReference/Component.GetComponentInChildren.html\" rel=\"nofollow\">correct</a> syntax. If you have problems like these, you can always look in the Unity's <a href=\"http://docs.unity3d.com/ScriptReference/\" rel=\"nofollow\">documentation</a> and that will help you out.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 6022113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abb74c3fb931b4c1a92630c7d3e34912?s=128&d=identicon&r=PG&f=1", "display_name": "Federico Paredes", "link": "https://stackoverflow.com/users/6022113/federico-paredes"}, "is_accepted": false, "score": 0, "last_activity_date": 1473267460, "creation_date": 1473267460, "answer_id": 39375571, "question_id": 39375373, "link": "https://stackoverflow.com/questions/39375373/unity3d-ui-text/39375571#39375571", "title": "Unity3d UI text", "body": "<p>Try this:</p>\n\n<pre><code>AccountsButtons[i].GetComponentInChildren(typeof(Text)).text = AccountName;\n</code></pre>\n\n<p>The reason:</p>\n\n<p>In C#, all constructors have to be instantiated. In the same way you can't just do something like <code>Vector3 vec = Vector3(0,0,0)</code>, you must append the <code>new</code> keyword to instantiate, so this would look like <code>Vector3 vec = new Vector3(0,0,0)</code>. In your code snippet, you seem to be referencing a class without any sort of instantiation or operator. To fix this, you must use the <a href=\"https://msdn.microsoft.com/en-us/library/58918ffs.aspx\" rel=\"nofollow\">typeof</a> operator to pass the type as a parameter to your GetComponentInChildren method.</p>\n"}], "owner": {"reputation": 1483, "user_id": 6213883, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh6.googleusercontent.com/-Undmv-4m5tk/AAAAAAAAAAI/AAAAAAAAACA/LsFc3HVNVFE/photo.jpg?sz=128", "display_name": "Florian Castelain", "link": "https://stackoverflow.com/users/6213883/florian-castelain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 39375439, "answer_count": 2, "score": 0, "last_activity_date": 1473267460, "creation_date": 1473266729, "last_edit_date": 1473267217, "question_id": 39375373, "link": "https://stackoverflow.com/questions/39375373/unity3d-ui-text", "title": "Unity3d UI text", "body": "<p>I want to change the text of an instantiated button. This button is stored in an array.</p>\n\n<p>But when I try to access the text component, I have issues. Can't understand what I am doing wrong, all sources I've been checking say the same as I did. Bored of uncompleted unity's doc...</p>\n\n<p>Anyway, he is the code:</p>\n\n<pre><code>        foreach (string el in files)\n        {\n            AccountName = System.IO.Path.GetFileName(el);\n            AccountsButtons[i] = Instantiate(Resources.Load(\"Account\") as GameObject);\n            AccountsButtons[i].name = AccountName;\n            AccountsButtons[i].transform.SetParent(MyCanvas.transform, false);\n            AccountsButtons[i].GetComponentInChildren(Text).text = AccountName;\n         }\n</code></pre>\n\n<p>The last line, it tells me that <code>Text</code> is a type, and it's not valid in the given context (says Visual studio).</p>\n\n<p>The error given by Unity's editor is:</p>\n\n<pre><code>error CS0119: Expression denotes a `type', where a `variable', `value' or `method group' was expected\n</code></pre>\n"}, {"tags": ["c#", ".net", "dependency-injection", "servicestack", "inversion-of-control"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 6519101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59f9ac6e89f78d3052636e8763a2f295?s=128&d=identicon&r=PG&f=1", "display_name": "Necroqubus", "link": "https://stackoverflow.com/users/6519101/necroqubus"}, "edited": false, "score": 0, "creation_date": 1473278337, "post_id": 39375692, "comment_id": 66084097, "body": "Thank you, I overlooked the ValidatorCache feature in ServiceStack. I could not find documentation about it. How is it filled? Automatically?  Would be very grateful if you could provide insight in using it."}, {"owner": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "reply_to_user": {"reputation": 311, "user_id": 6519101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59f9ac6e89f78d3052636e8763a2f295?s=128&d=identicon&r=PG&f=1", "display_name": "Necroqubus", "link": "https://stackoverflow.com/users/6519101/necroqubus"}, "edited": false, "score": 0, "creation_date": 1473279034, "post_id": 39375692, "comment_id": 66084437, "body": "It&#39;s automatically populated when <a href=\"https://github.com/ServiceStack/ServiceStack/wiki/Validation#validation-feature\" rel=\"nofollow noreferrer\">Validation Features are registered</a>, the example in answer shows how you can use it."}, {"owner": {"reputation": 311, "user_id": 6519101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59f9ac6e89f78d3052636e8763a2f295?s=128&d=identicon&r=PG&f=1", "display_name": "Necroqubus", "link": "https://stackoverflow.com/users/6519101/necroqubus"}, "edited": false, "score": 0, "creation_date": 1473281606, "post_id": 39375692, "comment_id": 66085576, "body": "Unfortunately when I try to get validator from ValidatorCache I get null even though I did the necessary steps:   1)**Defined validator**   public class TestValidator : BaseValidator&lt;ValidationTestRequest&gt; { .... }   2)    <b>Registered validators</b>   container.RegisterValidators(typeof(AppHost).Assembly);   3) <b>Added Validation Feature</b>   Plugins.Add(new ValidationFeature());"}, {"owner": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "reply_to_user": {"reputation": 311, "user_id": 6519101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59f9ac6e89f78d3052636e8763a2f295?s=128&d=identicon&r=PG&f=1", "display_name": "Necroqubus", "link": "https://stackoverflow.com/users/6519101/necroqubus"}, "edited": false, "score": 1, "creation_date": 1473287723, "post_id": 39375692, "comment_id": 66087851, "body": "@ViestursGribulis Note: you need to inherit from ServiceStack&#39;s built-in <code>AbstractValidator&lt;T&gt;</code>, see the <a href=\"https://github.com/ServiceStack/ServiceStack/wiki/Validation#fluentvalidation-for-request-dtos\" rel=\"nofollow noreferrer\">Validation Example</a>"}, {"owner": {"reputation": 311, "user_id": 6519101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59f9ac6e89f78d3052636e8763a2f295?s=128&d=identicon&r=PG&f=1", "display_name": "Necroqubus", "link": "https://stackoverflow.com/users/6519101/necroqubus"}, "edited": false, "score": 0, "creation_date": 1473330627, "post_id": 39375692, "comment_id": 66103444, "body": "I have BaseValidator&lt;T&gt; that historically inherits from FluentValidation.AbstractValidator&lt;T&gt; but not SeviceStack.FluentValidation.AbstractValidator&lt;T&gt;. Could this cause ValidatorCache not to fill up with Validators?"}, {"owner": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "reply_to_user": {"reputation": 311, "user_id": 6519101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59f9ac6e89f78d3052636e8763a2f295?s=128&d=identicon&r=PG&f=1", "display_name": "Necroqubus", "link": "https://stackoverflow.com/users/6519101/necroqubus"}, "edited": false, "score": 0, "creation_date": 1473339462, "post_id": 39375692, "comment_id": 66109216, "body": "@ViestursGribulis yes, it needs to inherit from ServiceStack&#39;s implementation."}, {"owner": {"reputation": 311, "user_id": 6519101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59f9ac6e89f78d3052636e8763a2f295?s=128&d=identicon&r=PG&f=1", "display_name": "Necroqubus", "link": "https://stackoverflow.com/users/6519101/necroqubus"}, "edited": false, "score": 0, "creation_date": 1473595603, "post_id": 39375692, "comment_id": 66194280, "body": "I see, so I need to rewrite whole legacy code to enable validation via ServiceStack filters. Is there anything I can do other than that?"}, {"owner": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "reply_to_user": {"reputation": 311, "user_id": 6519101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59f9ac6e89f78d3052636e8763a2f295?s=128&d=identicon&r=PG&f=1", "display_name": "Necroqubus", "link": "https://stackoverflow.com/users/6519101/necroqubus"}, "edited": false, "score": 0, "creation_date": 1473596798, "post_id": 39375692, "comment_id": 66194615, "body": "You need to use ServiceStack&#39;s implementation in order to use ServiceStack&#39;s features."}], "tags": [], "owner": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "is_accepted": true, "score": 2, "last_activity_date": 1473270756, "last_edit_date": 1473270756, "creation_date": 1473268062, "answer_id": 39375692, "question_id": 39375321, "link": "https://stackoverflow.com/questions/39375321/resolving-interface-with-generic-type-in-servicestack-request-filter/39375692#39375692", "title": "Resolving interface with generic type in ServiceStack Request filter", "body": "<p>You can resolve the <code>IValidator</code> for a request with <code>ValidatorCache.GetValidator()</code> but you can't throw an Exception in GlobalRequestFilters you'll need to write the Error directly to the response, e.g:</p>\n\n<pre><code>var validator = ValidatorCache.GetValidator(req, dto.GetType());\nusing (validator as IDisposable)\n{\n    var validatorResult = validator.Validate(dto);\n    if (validatorResult.IsValid) return;\n\n    var errorResponse = DtoUtils.CreateErrorResponse(dto, validatorResult.ToErrorResult());\n\n    res.WriteToResponse(req, errorResponse);\n}\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 6519101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/59f9ac6e89f78d3052636e8763a2f295?s=128&d=identicon&r=PG&f=1", "display_name": "Necroqubus", "link": "https://stackoverflow.com/users/6519101/necroqubus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 1, "accepted_answer_id": 39375692, "answer_count": 1, "score": 2, "last_activity_date": 1473270756, "creation_date": 1473266531, "last_edit_date": 1473270505, "question_id": 39375321, "link": "https://stackoverflow.com/questions/39375321/resolving-interface-with-generic-type-in-servicestack-request-filter", "title": "Resolving interface with generic type in ServiceStack Request filter", "body": "<p>My question is - is it possible and if it is - how, to resolve interface in ServiceStack request filter that uses generic type and the type is retrieved dynamically from <strong>DTO</strong> of request. The idea is that I have multiple validators defined in my assembly and they use interface that has a generic type. Example:</p>\n\n<p><code>AddressSaveValidator : BaseValidator&lt;AddressSaveRequest&gt;;</code></p>\n\n<p>My goal is to on request resolve and see if request has a validator that is defined for such request, then validate and then log the results. The only problem is that I don't know how to resolve interface with generic type. This is example of how would I use it:</p>\n\n<pre><code>        RequestFilters.Add((req, res, dto)  =&gt;\n        {\n            var validator = container.Resolve&lt;IValidator&lt;typeof(dto)&gt;&gt;();\n            var  validatorResult = validator.Validate(dto);\n            if(validatorResult.IsValid)\n            {\n                var logger = container.Resolve&lt;ILogger&gt;();\n                var result = logger.LogValidationResults(validationResult);\n                throw ValidationException(result);\n            }\n        });\n</code></pre>\n\n<p>Of course, it does not work.</p>\n"}, {"tags": ["c#", "abstract-methods", "method-hiding"], "comments": [{"owner": {"reputation": 829, "user_id": 2291983, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c7d3ca8b81a66e2dbf197e6e8948a429?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/2291983/max"}, "edited": false, "score": 0, "creation_date": 1473266507, "post_id": 39375263, "comment_id": 66078488, "body": "Even though it&#39;s lacking a <code>virtual</code>, <code>override</code> worked for me in place of <code>new</code>. However, there is still the issue that you&#39;re changing the return type when you&#39;re hiding the base value. You&#39;ll need to change the name or make the subclass return a value of <code>Task</code>."}, {"owner": {"reputation": 2671, "user_id": 2497244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe9a93116327ef2f4d1ff7c44319ceb1?s=128&d=identicon&r=PG&f=1", "display_name": "tobiak777", "link": "https://stackoverflow.com/users/2497244/tobiak777"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1473266647, "post_id": 39375263, "comment_id": 66078558, "body": "@mason I assumed the compiler would pick up the definition on Concrete&lt;T&gt; (I&#39;ve seen that the return type is correctly infered by IntelliSense when I do that - despite the compiler error). So if I understand you correctly the issue is that it is not possible to change the signature when hiding with <code>new</code> ? (I have a sense that I did it in the past,  I might be wrong though)"}, {"owner": {"reputation": 2671, "user_id": 2497244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe9a93116327ef2f4d1ff7c44319ceb1?s=128&d=identicon&r=PG&f=1", "display_name": "tobiak777", "link": "https://stackoverflow.com/users/2497244/tobiak777"}, "reply_to_user": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 0, "creation_date": 1473266916, "post_id": 39375263, "comment_id": 66078715, "body": "@mason here&#39;s a counter example, the signature can be changed with properties : <a href=\"https://dotnetfiddle.net/B4IkHj\" rel=\"nofollow noreferrer\">dotnetfiddle.net/B4IkHj</a> it seems that the issue is related to methods / abstract members somehow"}, {"owner": {"reputation": 2671, "user_id": 2497244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe9a93116327ef2f4d1ff7c44319ceb1?s=128&d=identicon&r=PG&f=1", "display_name": "tobiak777", "link": "https://stackoverflow.com/users/2497244/tobiak777"}, "reply_to_user": {"reputation": 829, "user_id": 2291983, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c7d3ca8b81a66e2dbf197e6e8948a429?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/2291983/max"}, "edited": false, "score": 0, "creation_date": 1473267233, "post_id": 39375263, "comment_id": 66078889, "body": "@Max Thanks for your help but please see my comment to mason, the signature should not need to be the same with <code>new</code> and the <code>new</code> keywords is supposed to work on both methods and properties - <a href=\"https://msdn.microsoft.com/en-us/library/435f1dw2.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/435f1dw2.aspx</a>"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1473267252, "post_id": 39375263, "comment_id": 66078900, "body": "Possibly relevant (duplicate?): <a href=\"http://stackoverflow.com/a/15362589/56778\">stackoverflow.com/a/15362589/56778</a>. Note in particular that the C# language does not allow overloaded methods to differ by return type only."}, {"owner": {"reputation": 2671, "user_id": 2497244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe9a93116327ef2f4d1ff7c44319ceb1?s=128&d=identicon&r=PG&f=1", "display_name": "tobiak777", "link": "https://stackoverflow.com/users/2497244/tobiak777"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1473267451, "post_id": 39375263, "comment_id": 66079002, "body": "@JimMischel Thanks a lot for your help, unfortunately this is not a covariance situation I&#39;m afraid, I&#39;ve just browsed the question but it doesn&#39;t help"}], "answers": [{"comments": [{"owner": {"reputation": 2671, "user_id": 2497244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe9a93116327ef2f4d1ff7c44319ceb1?s=128&d=identicon&r=PG&f=1", "display_name": "tobiak777", "link": "https://stackoverflow.com/users/2497244/tobiak777"}, "edited": false, "score": 0, "creation_date": 1473267755, "post_id": 39375606, "comment_id": 66079173, "body": "I just realized it and came back to this tab to say it - but you said it much better than I would have. I was thinking that : if someone references a <code>Concrete</code> variable as a <code>Base</code> type the abstract member would be undefined. Thanks very much."}], "tags": [], "owner": {"reputation": 213217, "user_id": 41071, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ec0f5be7749c8cc8ccda4a809103f36?s=128&d=identicon&r=PG", "display_name": "svick", "link": "https://stackoverflow.com/users/41071/svick"}, "is_accepted": true, "score": 4, "last_activity_date": 1473267904, "last_edit_date": 1473267904, "creation_date": 1473267613, "answer_id": 39375606, "question_id": 39375263, "link": "https://stackoverflow.com/questions/39375263/cannot-hide-inherited-member-compiler-error/39375606#39375606", "title": "Cannot hide inherited member compiler error", "body": "<p>The problem is that the base method is <code>abstract</code>. A class inheriting from <code>Concrete&lt;T&gt;</code> would <em>have to</em> override <code>Base.Execute()</code>, but it <em>could not</em> override it, because it is hidden by <code>Derived&lt;T&gt;.Execute()</code>. So, <code>Concrete&lt;T&gt;</code> would be an <code>abstract</code> class that can't possibly have any implementation (at least not in C#), at thus it would be useless. So, the C# compiler does not let you write it.</p>\n\n<p>If <code>Base</code> was an interface, you could work around this by using an explicit interface implementation. But there is nothing like explicit base class implementation, so I don't think there is any way to have this kind of code, at least not without renaming one of the two methods.</p>\n"}, {"comments": [{"owner": {"reputation": 213217, "user_id": 41071, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ec0f5be7749c8cc8ccda4a809103f36?s=128&d=identicon&r=PG", "display_name": "svick", "link": "https://stackoverflow.com/users/41071/svick"}, "edited": false, "score": 0, "creation_date": 1473268148, "post_id": 39375626, "comment_id": 66079347, "body": "This class: <code>public class Base {     public Task Execute() =&gt; null;     public Task&lt;int&gt; Execute() =&gt; null; }</code> does not compile with the same error as your <code>Base</code>. But these two classes do: <code>public class Base {     public Task Execute() =&gt; null; }  class Derived : Base {     public new Task&lt;int&gt; Execute() =&gt; null; }</code>. So that part of your reasoning is not correct: such error can be fixed by moving the method to a derived class."}], "tags": [], "owner": {"reputation": 12429, "user_id": 4995012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a300442854f4caef5cd41a7b3084a6e?s=128&d=identicon&r=PG", "display_name": "Fabjan", "link": "https://stackoverflow.com/users/4995012/fabjan"}, "is_accepted": false, "score": 1, "last_activity_date": 1473267724, "creation_date": 1473267724, "answer_id": 39375626, "question_id": 39375263, "link": "https://stackoverflow.com/questions/39375263/cannot-hide-inherited-member-compiler-error/39375626#39375626", "title": "Cannot hide inherited member compiler error", "body": "<p>From MSDN : </p>\n\n<blockquote>\n  <p>An abstract method declaration introduces a new virtual method but\n  does not provide an implementation of that method. Instead,\n  non-abstract derived classes are required to provide their own\n  implementation by overriding that method</p>\n</blockquote>\n\n<p>Well, the reason for this error is how abstractions work in C#, abstraction can be inherited, it can be implemented but it cannot be hidden or replaced by another abstraction.</p>\n\n<p>Besides, consider the code :  </p>\n\n<pre><code>public abstract class Base\n{\n    public abstract Task Execute();\n    public abstract Task&lt;int&gt; Execute();\n}\n</code></pre>\n\n<p>This will not compile, because : </p>\n\n<blockquote>\n  <p>Type 'Base' already defines a member called 'Execute' with the same\n  parameter types</p>\n</blockquote>\n\n<p>So why should it work when we move the second method to a derived abstract class ? </p>\n"}], "owner": {"reputation": 2671, "user_id": 2497244, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fe9a93116327ef2f4d1ff7c44319ceb1?s=128&d=identicon&r=PG&f=1", "display_name": "tobiak777", "link": "https://stackoverflow.com/users/2497244/tobiak777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 1, "accepted_answer_id": 39375606, "answer_count": 2, "score": 2, "last_activity_date": 1473268351, "creation_date": 1473266287, "last_edit_date": 1473268351, "question_id": 39375263, "link": "https://stackoverflow.com/questions/39375263/cannot-hide-inherited-member-compiler-error", "title": "Cannot hide inherited member compiler error", "body": "<p>I'm tring to do :</p>\n\n<pre><code>public abstract class Base\n{\n    public abstract Task Execute(); \n}\n\npublic abstract class Concrete&lt;T&gt; : Base where T : class\n{\n    new public abstract Task&lt;T&gt; Execute();\n}\n</code></pre>\n\n<p>But for some reason I am getting the compiler error :</p>\n\n<blockquote>\n  <p>CS0533 'Concrete.Execute()' hides inherited abstract member 'Program.Base.Execute()</p>\n</blockquote>\n\n<p>I've hidden plenty of members in the past but never met this side case and I'm quite puzzled here. Spent a long time on MSDN and the web but couldn't find anything about this behaviour.</p>\n\n<p>I would really appreciate any insight on the issue.  </p>\n\n<p>Here's <a href=\"https://dotnetfiddle.net/ELjZB6\" rel=\"nofollow\">the fiddle</a>.</p>\n"}, {"tags": ["c#", ".net", "generics", "interface", "xml-deserialization"], "comments": [{"owner": {"reputation": 544, "user_id": 6747696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5485aebdcf30da2ea44e5aad84f7eba9?s=128&d=identicon&r=PG", "display_name": "mbrdev", "link": "https://stackoverflow.com/users/6747696/mbrdev"}, "edited": false, "score": 0, "creation_date": 1473268021, "post_id": 39375230, "comment_id": 66079298, "body": "The issue here is that you are trying to deserialize to an Interface, since an interface is only a contract and not an implementation it will never work. You need to deserialize to a solid type and then cast your result to the interface."}, {"owner": {"reputation": 1265, "user_id": 1620220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b3e76799a8b86c4b29161830c5c510?s=128&d=identicon&r=PG", "display_name": "user1620220", "link": "https://stackoverflow.com/users/1620220/user1620220"}, "edited": false, "score": 0, "creation_date": 1473268152, "post_id": 39375230, "comment_id": 66079348, "body": "How does <code>XmlSerializer</code> even know about the interfaces though, if he&#39;s passing in the class type as the type parameter?"}, {"owner": {"reputation": 27967, "user_id": 1165998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e552055054e7507f0534bf56203fcb08?s=128&d=identicon&r=PG&f=1", "display_name": "David L", "link": "https://stackoverflow.com/users/1165998/david-l"}, "reply_to_user": {"reputation": 1265, "user_id": 1620220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b3e76799a8b86c4b29161830c5c510?s=128&d=identicon&r=PG", "display_name": "user1620220", "link": "https://stackoverflow.com/users/1620220/user1620220"}, "edited": false, "score": 0, "creation_date": 1473268960, "post_id": 39375230, "comment_id": 66079759, "body": "@user1620220 it has nothing to do with <code>ATemplate</code>.  This has everything to do with <code>List&lt;ITemplateItem&gt;</code> and <code>List&lt;ITemplateField&gt;</code>.  This is invalid when deserializing."}, {"owner": {"reputation": 1265, "user_id": 1620220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b3e76799a8b86c4b29161830c5c510?s=128&d=identicon&r=PG", "display_name": "user1620220", "link": "https://stackoverflow.com/users/1620220/user1620220"}, "edited": false, "score": 0, "creation_date": 1473271908, "post_id": 39375230, "comment_id": 66081166, "body": "Have you tried explicitly implementing the interface? And keep the concrete child properties?"}, {"owner": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "reply_to_user": {"reputation": 544, "user_id": 6747696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5485aebdcf30da2ea44e5aad84f7eba9?s=128&d=identicon&r=PG", "display_name": "mbrdev", "link": "https://stackoverflow.com/users/6747696/mbrdev"}, "edited": false, "score": 0, "creation_date": 1473324655, "post_id": 39375230, "comment_id": 66099704, "body": "Thanks @mbrdev - I agree it&#39;s because it can&#39;t deserialize the <code>List&lt;ITemplate..&gt;</code>s etc.  Do you suggest that I put this deserialize method inside each case method, but for the concrete types (still inheriting from the relevant interfaces)? I guess I was just trying to keep it DRY by using one generic method"}, {"owner": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "reply_to_user": {"reputation": 1265, "user_id": 1620220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b3e76799a8b86c4b29161830c5c510?s=128&d=identicon&r=PG", "display_name": "user1620220", "link": "https://stackoverflow.com/users/1620220/user1620220"}, "edited": false, "score": 0, "creation_date": 1473324757, "post_id": 39375230, "comment_id": 66099760, "body": "Thanks for the suggestion @user1620220 - If I do this, however, the concrete classes/children won&#39;t inherit from the <code>ITemplate...</code>s, though? And then I wouldn&#39;t be able to do the foreach loop on each, I think?"}], "owner": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1473266149, "creation_date": 1473266149, "question_id": 39375230, "link": "https://stackoverflow.com/questions/39375230/deserializing-generic-that-implements-interface-with-a-listt-of-interfaces-ne", "title": "Deserializing Generic that implements Interface with a List&lt;T&gt; of Interfaces .NET C#", "body": "<h2>Scenario</h2>\n\n<p>I have some XML come down from a service that I want to deserialize.</p>\n\n<p>Depending on what is returned from the service, the XML can vary slightly (with the element names); but the XML always follows a common structure.</p>\n\n<p>Here is a sample of what the XML might look like:</p>\n\n<pre><code>&lt;ATemplate&gt;\n    &lt;Name&gt;SomeTemplate&lt;/Name&gt;\n    &lt;TemplateItems&gt;\n        &lt;ATemplateItem&gt;\n            &lt;Name&gt;SomeTemplateItem&lt;/Name&gt;\n            &lt;TemplateFields&gt;\n                &lt;ATemplateField&gt;\n                    &lt;Name&gt;SomeTemplateField&lt;/Name&gt;\n                    &lt;Colour&gt;Blue&lt;/Colour&gt;\n                &lt;/ATemplateField&gt;\n                ... more template fields\n            &lt;/TemplateFields&gt;\n        &lt;/ATemplateItem&gt;\n        ... more template items\n    &lt;/TemplateItems&gt;\n&lt;/ATemplate&gt;\n</code></pre>\n\n<p>Using the above XML as an example, I have created a <code>ATemplate</code> class that will deserialize nicely from the XML, using the <code>ATemplateItem</code> and <code>ATemplateField</code> classes accordingly:</p>\n\n<pre><code>public class ATemplate\n{\n    public string Name { get; set; }\n    public List&lt;ATemplateItem&gt; TemplateItems { get; set; }\n}\n\npublic class ATemplateItem\n{\n    public string Name { get; set; }\n    public List&lt;ATemplateField&gt; TemplateFields { get; set; }\n}\n\npublic class ATemplateField\n{\n    public string Name { get; set; }\n    public string Colour { get; set; }\n}\n</code></pre>\n\n<p>I use this code to deserialize:</p>\n\n<pre><code>ATemplate template;\nusing (TextReader reader = new StringReader(xmlString))\n{\n    template = (ATemplate)new XmlSerializer(typeof(ATemplate)).Deserialize(reader);\n}\n</code></pre>\n\n<p>All good, so far.</p>\n\n<hr>\n\n<h2>Curveball</h2>\n\n<p>The same scenario might occur where the XML contains <code>BTemplate</code>, <code>BTemplateItem</code>s and <code>BTemplateField</code>s; still following the structure as above.</p>\n\n<p>So I created other classes for this situation:</p>\n\n<pre><code>public class BTemplate { ... }\npublic class BTemplateItem { ... }\npublic class BTemplateField { ... }\n</code></pre>\n\n<p>And made the relevant classes inherit respectively from <code>ITemplate</code>, <code>ITemplateItem</code> and <code>ITemplateField</code> I created, also:</p>\n\n<h2>Interfaces</h2>\n\n<pre><code>public class ITemplate\n{\n    public string Name { get; set; }\n    public List&lt;ITemplateItem&gt; TemplateItems { get; set; }\n}\n\npublic class ITemplateItem\n{\n    public string Name { get; set; }\n    public List&lt;ITemplateField&gt; TemplateFields { get; set; }\n}\n\npublic class ITemplateField\n{\n    public string Name { get; set; }\n    public string Colour { get; set; }\n}\n</code></pre>\n\n<p>This is so I can then create one function, which is able to loop through the <code>ITemplateItem</code>s and their <code>ITemplateField</code>s and perform some cool stuff:</p>\n\n<pre><code>public void Foo(ITemplate template)\n{\n    foreach (var item in template.TemplateItems)\n    {\n        // do cool stuff\n        foreach (var field in item.TemplateFields)\n        {\n            // do more cool stuff\n        }\n    }\n}\n</code></pre>\n\n<hr>\n\n<h2>Some things to note:</h2>\n\n<ul>\n<li>In the object that contains the XML, I <strong>know</strong> what \"type\" the XML contains - given an Enum I use to identify</li>\n<li>I then use a <code>switch</code> statement to run different methods, depending on the said \"type\"</li>\n</ul>\n\n<hr>\n\n<h2>Generic Method?</h2>\n\n<p>Now, rather than deserializing the XML differently in each of those method cases, I would like to use a Generic method to deserialize.</p>\n\n<p>So I created one, like this:</p>\n\n<pre><code>public ITemplate DeserializeTemplate&lt;T&gt;(string xmlString) where T : ITemplate\n{\n    using (TextReader reader = new StringReader(xmlString))\n    {\n        return (T)new XmlSerializer(typeof(T)).Deserialize(reader);\n    }\n}\n</code></pre>\n\n<p>And call it from within the specific methods like so:</p>\n\n<pre><code>var template = DeserializeTemplate&lt;ATemplate&gt;(xmlString);\n</code></pre>\n\n<p>Then, I can use the <code>ITemplate</code> that it returns, and pass it to <code>Foo(ITemplate template)</code> to go and perform some magic and wizardry.</p>\n\n<hr>\n\n<h2>But...</h2>\n\n<p>No compilation errors, as yet - however I get a RunTime error, because it cannot deserialize an Interface.</p>\n\n<p>I gather this is because it's trying to then deserialize the <code>ITemplate</code>'s <code>TemplateItems</code> as <code>ITemplateItem</code>s.</p>\n\n<h2>Can I do the above?</h2>\n\n<p>My question is:</p>\n\n<p>How can I get around this issue?</p>\n\n<ul>\n<li>Can I use this Generic deserialize method?</li>\n<li>Will I need to treat each one differently in the separate methods?</li>\n<li>Will I need to make the Interface generic also, with the types to expect?</li>\n</ul>\n\n<p>I'm banging my head against the desk, so I really hope you lovely SO people can help.</p>\n\n<p>As always, your comments, answers and suggestions are much appreciated :)</p>\n"}, {"tags": ["c#", ".net", "wpf", "embedded-resource"], "comments": [{"owner": {"reputation": 127444, "user_id": 492405, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SSPGk.png?s=128&g=1", "display_name": "vcsjones", "link": "https://stackoverflow.com/users/492405/vcsjones"}, "edited": false, "score": 1, "creation_date": 1473266031, "post_id": 39375185, "comment_id": 66078257, "body": "Is <code>MyImage</code> in your binding context? What does your model look like? Did you mean to use <code>StaticResource</code> or <code>DynamicResource</code> instead of Binding?"}, {"owner": {"reputation": 40992, "user_id": 40106, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/164ca8ba426bdb10381290b9617d3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "4thSpace", "link": "https://stackoverflow.com/users/40106/4thspace"}, "reply_to_user": {"reputation": 127444, "user_id": 492405, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SSPGk.png?s=128&g=1", "display_name": "vcsjones", "link": "https://stackoverflow.com/users/492405/vcsjones"}, "edited": false, "score": 0, "creation_date": 1473266213, "post_id": 39375185, "comment_id": 66078346, "body": "No - it isn&#39;t in the binding context. I&#39;m pretty sure this is <code>StaticResource</code>."}], "answers": [{"comments": [{"owner": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1473275506, "post_id": 39375299, "comment_id": 66082779, "body": "If the Build Action is Resource, there is no &quot;relative path&quot; that starts with &quot;../&quot;. Actually, it is a <a href=\"https://msdn.microsoft.com/en-us/library/aa970069(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Resource File Pack URI</a> without the <code>pack:&#47;&#47;application:,,,&#47;</code> prefix, which is automatically added by the XAML parser."}, {"owner": {"reputation": 46944, "user_id": 3764814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d02a4923abd2ca6d7593f031e4222c2?s=128&d=identicon&r=PG", "display_name": "Lucas Trzesniewski", "link": "https://stackoverflow.com/users/3764814/lucas-trzesniewski"}, "reply_to_user": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1473282571, "post_id": 39375299, "comment_id": 66086019, "body": "@Clemens you can also use a path relative to the xaml file if the resource is in the same assembly. I used <code>..&#47;</code> to indicate a parent directory."}], "tags": [], "owner": {"reputation": 46944, "user_id": 3764814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d02a4923abd2ca6d7593f031e4222c2?s=128&d=identicon&r=PG", "display_name": "Lucas Trzesniewski", "link": "https://stackoverflow.com/users/3764814/lucas-trzesniewski"}, "is_accepted": true, "score": 3, "last_activity_date": 1473266451, "creation_date": 1473266451, "answer_id": 39375299, "question_id": 39375185, "link": "https://stackoverflow.com/questions/39375185/why-isnt-staticresource-for-image-found-at-runtime/39375299#39375299", "title": "Why isn&#39;t StaticResource for image found at runtime?", "body": "<p>Don't use <code>resx</code> files with WPF, you'd have to add some code to make the interop work. Images in <code>resx</code> files are primarily used for WinForms code.</p>\n\n<p>Set the <em>Build Action</em> to <em>Resource</em> in the file properties:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4s8oN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4s8oN.png\" alt=\"build action\"></a></p>\n\n<p>Then just reference the file directly: <code>&lt;Image Source=\"../../Some/Relative/Path.png\"/&gt;</code></p>\n\n<p>Neither <code>{Binding}</code> nor <code>{StaticResource}</code> is needed there.</p>\n"}], "owner": {"reputation": 40992, "user_id": 40106, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/164ca8ba426bdb10381290b9617d3ea7?s=128&d=identicon&r=PG&f=1", "display_name": "4thSpace", "link": "https://stackoverflow.com/users/40106/4thspace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 39375299, "answer_count": 1, "score": 0, "last_activity_date": 1473266519, "creation_date": 1473265943, "question_id": 39375185, "link": "https://stackoverflow.com/questions/39375185/why-isnt-staticresource-for-image-found-at-runtime", "title": "Why isn&#39;t StaticResource for image found at runtime?", "body": "<p>I've added an image to my Resources.resx file. I reference it like this:</p>\n\n<pre><code>&lt;Image Source=\"{Binding MyImage}\"/&gt;\n</code></pre>\n\n<p>In the designer, I do see a squiggly blue line under the above. It says</p>\n\n<blockquote>\n  <p>The resource \"MyImage\" could not be resolved.</p>\n</blockquote>\n\n<p>At runtime, it throws this error:</p>\n\n<blockquote>\n  <p>Provide value on 'System.Windows.Markup.StaticResourceHolder' threw an\n  exception.</p>\n</blockquote>\n\n<p>Any ideas what I'm doing wrong?</p>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 3763, "user_id": 4585476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Xqkw.jpg?s=128&g=1", "display_name": "AVK", "link": "https://stackoverflow.com/users/4585476/avk"}, "edited": false, "score": 0, "creation_date": 1473268842, "post_id": 39375157, "comment_id": 66079694, "body": "I see no issue with this. Where are your adaptive states xaml? Can you post the complete xaml?"}, {"owner": {"reputation": 524, "user_id": 6805653, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/pSoiV.jpg?s=128&g=1", "display_name": "Shukant Pal", "link": "https://stackoverflow.com/users/6805653/shukant-pal"}, "reply_to_user": {"reputation": 3763, "user_id": 4585476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Xqkw.jpg?s=128&g=1", "display_name": "AVK", "link": "https://stackoverflow.com/users/4585476/avk"}, "edited": false, "score": 0, "creation_date": 1473317299, "post_id": 39375157, "comment_id": 66095567, "body": "Did you see picture using the line (Preview of the application). There is no adaptive states yet? Is it necessary?"}, {"owner": {"reputation": 524, "user_id": 6805653, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/pSoiV.jpg?s=128&g=1", "display_name": "Shukant Pal", "link": "https://stackoverflow.com/users/6805653/shukant-pal"}, "reply_to_user": {"reputation": 3763, "user_id": 4585476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Xqkw.jpg?s=128&g=1", "display_name": "AVK", "link": "https://stackoverflow.com/users/4585476/avk"}, "edited": false, "score": 0, "creation_date": 1473317665, "post_id": 39375157, "comment_id": 66095749, "body": "The XAML is too long to show? But I can tell you that splitview is in a grid."}], "answers": [{"tags": [], "owner": {"reputation": 524, "user_id": 6805653, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/pSoiV.jpg?s=128&g=1", "display_name": "Shukant Pal", "link": "https://stackoverflow.com/users/6805653/shukant-pal"}, "is_accepted": true, "score": 0, "last_activity_date": 1473562452, "creation_date": 1473562452, "answer_id": 39432414, "question_id": 39375157, "link": "https://stackoverflow.com/questions/39375157/splitview-in-grid/39432414#39432414", "title": "SplitView In Grid", "body": "<p>I found the answer. Split view should be the root element the page and grid should be units content.</p>\n"}], "owner": {"reputation": 524, "user_id": 6805653, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/pSoiV.jpg?s=128&g=1", "display_name": "Shukant Pal", "link": "https://stackoverflow.com/users/6805653/shukant-pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 39432414, "answer_count": 1, "score": -1, "last_activity_date": 1473579129, "creation_date": 1473265841, "last_edit_date": 1473579129, "question_id": 39375157, "link": "https://stackoverflow.com/questions/39375157/splitview-in-grid", "title": "SplitView In Grid", "body": "<p>I want my <code>SplitView</code> to be invisible in its compact state. But a large width is taken by it even in the compact state and open state.</p>\n\n<pre><code>&lt;SplitView x:Name=\"svNav\" DisplayMode=\"CompactOverlay\"&gt;\n    &lt;SplitView.Content&gt;\n        &lt;StackPanel Width=\"0\" /&gt;\n    &lt;/SplitView.Content&gt;\n    &lt;SplitView.Pane&gt;\n        &lt;Grid Name=\"lbPane\" Width=\"auto\" VerticalAlignment=\"Stretch\"&gt;\n            &lt;ListView&gt;\n                &lt;TextBlock FontSize=\"24\"&gt;Mode&lt;/TextBlock&gt;\n                &lt;ListViewItem&gt;\n                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                        &lt;TextBlock FontFamily=\"Segoe MDL2 Assets\" VerticalAlignment=\"Center\"&gt;&amp;#xE80F;&lt;/TextBlock&gt;\n                        &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"20,0\"&gt;Standard Mode&lt;/TextBlock&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/ListViewItem&gt;\n                &lt;ListViewItem&gt;\n                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                        &lt;TextBlock FontFamily=\"Segoe MDL2 Assets\" VerticalAlignment=\"Center\"&gt;&amp;#xE1E9;&lt;/TextBlock&gt;\n                        &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"20,0\"&gt;Scientific Mode&lt;/TextBlock&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/ListViewItem&gt;\n                &lt;ListViewItem&gt;\n                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                        &lt;TextBlock FontFamily=\"Segoe MDL2 Assets\" VerticalAlignment=\"Center\"&gt;&amp;#xE117;&lt;/TextBlock&gt;\n                        &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"20,0\"&gt;Converter&lt;/TextBlock&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/ListViewItem&gt;\n                &lt;ListViewItem&gt;\n                    &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                        &lt;TextBlock FontFamily=\"Segoe MDL2 Assets\" VerticalAlignment=\"Center\"&gt;&amp;#xE8EB;&lt;/TextBlock&gt;\n                        &lt;TextBlock VerticalAlignment=\"Center\" Margin=\"20,0\"&gt;Programming Mode&lt;/TextBlock&gt;\n                    &lt;/StackPanel&gt;\n                &lt;/ListViewItem&gt;\n            &lt;/ListView&gt;\n        &lt;/Grid&gt;\n    &lt;/SplitView.Pane&gt;\n&lt;/SplitView&gt;\n</code></pre>\n\n<p>There is a problem in the design. Please look at what can be done to resolve the \n<a href=\"http://i.stack.imgur.com/5Z2H2.png\" rel=\"nofollow\">Preview of application</a></p>\n"}, {"tags": ["c#", "xaml", "mvvm"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 0, "creation_date": 1473269425, "post_id": 39375152, "comment_id": 66079988, "body": "Are you sure the line numbers match where your frame style is defined?  I&#39;m not sure about xamarin, but possibly try using the {x:Type } extension instead of relying on string -&gt; type conversion in the TargetType property?"}, {"owner": {"reputation": 121525, "user_id": 302677, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/01b235a8024b2dd10f427c301c876a0b?s=128&d=identicon&r=PG", "display_name": "Rachel", "link": "https://stackoverflow.com/users/302677/rachel"}, "edited": false, "score": 0, "creation_date": 1473367121, "post_id": 39375152, "comment_id": 66125644, "body": "Are you setting your <code>BackgroundColor</code> from directly in the <code>&lt;Frame&gt;</code> tag? If so, that property will override any triggered or styled values. Another thing to try is maybe use <code>TargetType={x:Type Frame}</code>, occasionally I see the text string fail to resolve into the actual type, so this prevents that."}], "answers": [{"comments": [{"owner": {"reputation": 3763, "user_id": 4585476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Xqkw.jpg?s=128&g=1", "display_name": "AVK", "link": "https://stackoverflow.com/users/4585476/avk"}, "edited": false, "score": 0, "creation_date": 1473268236, "post_id": 39375687, "comment_id": 66079386, "body": "OP Did not mention that boolean property will be changed real time. so NotifyProperty is not required. But Converter is a good option for this scenario. So +1 for that."}], "tags": [], "owner": {"reputation": 735, "user_id": 1118082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49957271a1b04188d5c935a9bd102f51?s=128&d=identicon&r=PG", "display_name": "Jacob Shanley", "link": "https://stackoverflow.com/users/1118082/jacob-shanley"}, "is_accepted": true, "score": 5, "last_activity_date": 1473268025, "creation_date": 1473268025, "answer_id": 39375687, "question_id": 39375152, "link": "https://stackoverflow.com/questions/39375152/xaml-change-frame-background-based-on-binding/39375687#39375687", "title": "XAML Change Frame Background Based on Binding", "body": "<p>Not sure about your trigger problem but I think you should be able to accomplish the color changing by first implementing INotifyPropertyChanged on your Data class like so:</p>\n\n<pre><code>public class Data : INotifyPropertyChanged\n{\n    public string Text { get; set; }\n    public DateTime Date { get; set; }\n\n    private bool _isActive;\n    public bool IsActive \n    {\n        get { return _isActive; }\n        set\n        {\n            if (value == _isActive)\n            {\n                return;\n            }\n\n            _isActive = value;\n\n            NotifyPropertyChanged(\"IsActive\");\n        }\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    public void NotifyPropertyChanged(string propertyName)\n    {\n        if (PropertyChanged != null)\n        {\n            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));\n        }\n    }\n}\n</code></pre>\n\n<p>Then, in your xaml, you should be able to do something like this:</p>\n\n<pre><code>&lt;DataTemplate&gt;\n    &lt;ViewCell&gt;\n        &lt;Frame Background=\"{Binding IsActive, Converter={StaticResource IsActiveToColorConverter}}\" OutlineColor=\"White\" HasShadow=\"False\"&gt;\n             &lt;!-- Data --&gt;\n        &lt;/Frame&gt;\n    &lt;/ViewCell&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n\n<p>Where IsActiveToColorConverter looks something like:</p>\n\n<pre><code>public class IsActiveToColorConverter : IValueConverter\n{\n    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)\n    {\n        var isActive = (bool) value;\n\n        return isActive ? \"Red\" : \"Blue\";\n    }\n\n    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)\n    {\n        throw new NotImplementedException();\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 698, "user_id": 5132661, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/934c87cde0b353a4363bc3bba472e263?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowStack", "link": "https://stackoverflow.com/users/5132661/overflowstack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1815, "favorite_count": 0, "accepted_answer_id": 39375687, "answer_count": 1, "score": 4, "last_activity_date": 1473268025, "creation_date": 1473265820, "question_id": 39375152, "link": "https://stackoverflow.com/questions/39375152/xaml-change-frame-background-based-on-binding", "title": "XAML Change Frame Background Based on Binding", "body": "<p>I have an ObservableCollection which is based on the following class:</p>\n\n<pre><code>public class Data\n{\n    public string Text { get; set; }\n    public DateTime Date { get; set; }\n    public bool IsActive { get; set; }\n}\n</code></pre>\n\n<p>This observablecollection is used and binded as ItemSource for ListView. The following is DataTemplate for displaying data - </p>\n\n<pre><code>&lt;DataTemplate&gt;\n    &lt;ViewCell&gt;\n        &lt;Frame OutlineColor=\"White\" HasShadow=\"False\"&gt;\n             &lt;!-- Data --&gt;\n        &lt;/Frame&gt;\n    &lt;/ViewCell&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n\n<p>Since the ObservableCollection is a collection of Data class which has a <strong>boolean property</strong>, I want to <strong>use it in order to change the frame's background color</strong>: </p>\n\n<ul>\n<li><p>If property IsActive is true - BackgroundColor is Red</p></li>\n<li><p>If property IsActive is false - BackgroundColor is Blue</p></li>\n</ul>\n\n<p>I've looked into implementation of Triggers, however I can't seem to get them working correctly, and I'm not sure what I'm missing.</p>\n\n<p>According to Xamarin Documentation I should be able to do :</p>\n\n<pre><code>&lt;Frame&gt;\n    &lt;Frame.Trigger&gt;\n        &lt;!-- --&gt;\n    &lt;/Frame.Trigger&gt;  \n&lt;/Frame&gt;\n</code></pre>\n\n<p>However that doesn't seem to be possible. Neither is this - </p>\n\n<pre><code>&lt;Frame&gt;\n&lt;Frame.Style&gt;\n    &lt;Style TargetType=\"Frame\"&gt;\n        &lt;Setter Property=\"BackgroundColor\" Value=\"Blue\" /&gt;\n        &lt;Style.Triggers&gt;\n            &lt;DataTrigger Binding=\"{Binding IsActive}\" Value=\"True\"&gt;\n                &lt;Setter Property=\"BackgroundColor\" Value=\"Red\"/&gt;\n            &lt;/DataTrigger&gt;\n        &lt;/Style.Triggers&gt;\n    &lt;/Style&gt;\n&lt;/Frame.Style&gt;\n&lt;/Frame&gt;\n</code></pre>\n\n<p>The code above gives the following error message:</p>\n\n<pre><code>Xamarin.Forms.Xaml.XamlParseException: Position 28:26. The Property TargetType is required to create a Xamarin.Forms.DataTrigger object.\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 0, "creation_date": 1473265959, "post_id": 39375134, "comment_id": 66078224, "body": "It&#39;s still a double. When you do a <code>Console.WriteLine()</code> I&#39;m pretty sure it calls the parameterless <code>ToString()</code> by default, so you can override that by doing <code>Console.WriteLine ( (d+Myd).ToString(&quot;#.#&quot;) );</code> or whatever format you want from either the <a href=\"https://msdn.microsoft.com/en-us/library/dwhawy9k(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Standard Numeric Format Strings</a> or <a href=\"https://msdn.microsoft.com/en-us/library/0c899ak8(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Custom ones</a>."}, {"owner": {"reputation": 3836, "user_id": 4084003, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/pV9Vi.jpg?s=128&g=1", "display_name": "Jones Joseph", "link": "https://stackoverflow.com/users/4084003/jones-joseph"}, "edited": false, "score": 0, "creation_date": 1473265987, "post_id": 39375134, "comment_id": 66078240, "body": "a double with no decimal will return an INT only i suppose when you do Console.WriteLine"}], "answers": [{"tags": [], "owner": {"reputation": 2125, "user_id": 6691061, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/1219688551388660/picture?type=large", "display_name": "Shannon Holsinger", "link": "https://stackoverflow.com/users/6691061/shannon-holsinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1473265933, "creation_date": 1473265933, "answer_id": 39375184, "question_id": 39375134, "link": "https://stackoverflow.com/questions/39375134/how-to-return-double-from-double-plus-double/39375184#39375184", "title": "how to return double from double plus double?", "body": "<p>The value 8 and 8.0 are the same. If you want decimals shown in your results, use a converter like N2 for fixed with 2 SigDig after the decimal. </p>\n\n<pre><code>Console.WriteLine((d+Myd).ToString(\"N2\"));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 5750258, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ee147f2bc59869a5803fc9cce18271f4?s=128&d=identicon&r=PG&f=1", "display_name": "ethan codes", "link": "https://stackoverflow.com/users/5750258/ethan-codes"}, "is_accepted": false, "score": 0, "last_activity_date": 1473267363, "creation_date": 1473267363, "answer_id": 39375545, "question_id": 39375134, "link": "https://stackoverflow.com/questions/39375134/how-to-return-double-from-double-plus-double/39375545#39375545", "title": "how to return double from double plus double?", "body": "<p>Shannon is corret. it is returning a double, but because it is all 0's after the decimal it cuts it off. if you were to do 8.5 + 8 it would return 16.5. If you require one decimal, just use an N1. </p>\n"}], "owner": {"reputation": 11, "user_id": 5485793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d4f74de44feec40632791e038aeeea?s=128&d=identicon&r=PG", "display_name": "G.S", "link": "https://stackoverflow.com/users/5485793/g-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1473267363, "creation_date": 1473265761, "last_edit_date": 1473266018, "question_id": 39375134, "link": "https://stackoverflow.com/questions/39375134/how-to-return-double-from-double-plus-double", "title": "how to return double from double plus double?", "body": "<p>I hava 2 Double variables, and when I sum them it return me int variable.\nbut I want it return Double too.\nWhat should I do?\nThank you!</p>\n\n<p><strong>example:</strong></p>\n\n<pre><code>double d = 4.0;\ndouble Myd = 4.0; \n\nConsole.WriteLine ( d+Myd ); // it returns me 8 but I want 8.0 .\n</code></pre>\n"}]