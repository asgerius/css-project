[{"tags": ["c#", "dependency-injection", "asp.net-core", "asp.net-core-mvc"], "comments": [{"owner": {"reputation": 5261, "user_id": 858757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mMQgQ.png?s=128&g=1", "display_name": "Silvermind", "link": "https://stackoverflow.com/users/858757/silvermind"}, "edited": false, "score": 0, "creation_date": 1553003396, "post_id": 40900414, "comment_id": 97218163, "body": "I know this is an old question, but... You should not dispose the db context inside a service. The db context is automatically disposed by the scope resolver. If you dispose it inside a service, it might be disposed when calling a next service within the same request/scope."}, {"owner": {"reputation": 8055, "user_id": 1461862, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Xk6rm.jpg?s=128&g=1", "display_name": "Mauricio Gracia Gutierrez", "link": "https://stackoverflow.com/users/1461862/mauricio-gracia-gutierrez"}, "edited": false, "score": 1, "creation_date": 1555379619, "post_id": 40900414, "comment_id": 98080744, "body": "Make sure the service(missing class) is added using &#180;services.AddTransient&lt;YourClassOrInterface&gt;();&#180;"}], "answers": [{"comments": [{"owner": {"reputation": 5832, "user_id": 4155665, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7IH7Y.png?s=128&g=1", "display_name": "jleach", "link": "https://stackoverflow.com/users/4155665/jleach"}, "edited": false, "score": 14, "creation_date": 1573467645, "post_id": 40900520, "comment_id": 103879256, "body": "Amazing how easy it is to overlook a single character... thanks!"}, {"owner": {"reputation": 1222, "user_id": 1215999, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/S6Fmu.png?s=128&g=1", "display_name": "m.t.bennett", "link": "https://stackoverflow.com/users/1215999/m-t-bennett"}, "edited": false, "score": 1, "creation_date": 1585195039, "post_id": 40900520, "comment_id": 107679125, "body": "What a champion, recieved this while using <code>HttpContextAccessor</code> class, turns out I needed the <code>IHttpContextAccessor</code>"}, {"owner": {"reputation": 1265, "user_id": 2787567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxMGa.jpg?s=128&g=1", "display_name": "NoloMokgosi", "link": "https://stackoverflow.com/users/2787567/nolomokgosi"}, "edited": false, "score": 1, "creation_date": 1586522495, "post_id": 40900520, "comment_id": 108163312, "body": "So irritated because I waisted more than 30 minutes on this.Worst VS on Mac gives you &quot;donet quit unexpectedly&quot; error. Has to run on terminal to get the correct error, then I bumped into this solution."}, {"owner": {"reputation": 1416, "user_id": 3443552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3761a957bafde55f553663c9fa9ebc7?s=128&d=identicon&r=PG", "display_name": "KMJungersen", "link": "https://stackoverflow.com/users/3443552/kmjungersen"}, "edited": false, "score": 0, "creation_date": 1610486779, "post_id": 40900520, "comment_id": 116148264, "body": "Similarly, I was inadvertently activating the wrong object in <code>Startup.cs</code>.  I had <code>services.AddTransient&lt;FooService, FooService&gt;();</code> instead of <code>services.AddTransient&lt;IFooService, FooService&gt;();</code>.  Those pesky letters LOL. Thanks for pointing me in the right direction!"}, {"owner": {"reputation": 395, "user_id": 5390556, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh3.googleusercontent.com/-Ic29Bnlps7o/AAAAAAAAAAI/AAAAAAAAADA/zGUhLOir7rg/photo.jpg?sz=128", "display_name": "Carrie", "link": "https://stackoverflow.com/users/5390556/carrie"}, "edited": false, "score": 0, "creation_date": 1616779801, "post_id": 40900520, "comment_id": 118119242, "body": "Great explanation, thank you."}], "tags": [], "owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "is_accepted": true, "score": 431, "last_activity_date": 1613125211, "last_edit_date": 1613125211, "creation_date": 1480551113, "answer_id": 40900520, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/40900520#40900520", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>To break down the error message:</p>\n<blockquote>\n<p>Unable to resolve service for type 'WebApplication1.Data.BloggerRepository' while attempting to activate 'WebApplication1.Controllers.BlogController'.</p>\n</blockquote>\n<p>That is saying that your application is trying to create an instance of <code>BlogController</code> but it doesn't know <em>how</em> to create an instance of <code>BloggerRepository</code> to pass into the constructor.</p>\n<p>Now look at your startup:</p>\n<pre><code>services.AddScoped&lt;IBloggerRepository, BloggerRepository&gt;();\n</code></pre>\n<p>That is saying whenever a <code>IBloggerRepository</code> is required, create a <code>BloggerRepository</code> and pass that in.</p>\n<p>However, your controller class is asking for the concrete class <code>BloggerRepository</code> and the dependency injection container doesn't know what to do when asked for that directly.</p>\n<p>I'm guessing you just made a typo, but a fairly common one. So the simple fix is to change your controller to accept something that the DI container <em>does</em> know how to process, in this case, the interface:</p>\n<pre><code>public BlogController(IBloggerRepository repository)\n//                    ^\n//                    Add this!\n{\n    _repository = repository;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 579, "user_id": 1618817, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uU3ol.jpg?s=128&g=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1618817/adrian"}, "is_accepted": false, "score": 15, "last_activity_date": 1493385662, "creation_date": 1493385662, "answer_id": 43681258, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/43681258#43681258", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>Only if anyone have the same situation like me, I am doing a tutorial of EntityFramework with existing database, but when the new database context is created on the models folders, we need to update the context in the startup, but not only in services.AddDbContext but AddIdentity too if you have users authentication      </p>\n\n<pre><code>services.AddDbContext&lt;NewDBContext&gt;(options =&gt;\n                options.UseSqlServer(Configuration.GetConnectionString(\"DefaultConnection\")));\n\nservices.AddIdentity&lt;ApplicationUser, IdentityRole&gt;()\n                .AddEntityFrameworkStores&lt;NewDBContext&gt;()\n                .AddDefaultTokenProviders();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2782, "user_id": 747275, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/nfoVL.jpg?s=128&g=1", "display_name": "riqitang", "link": "https://stackoverflow.com/users/747275/riqitang"}, "is_accepted": false, "score": 34, "last_activity_date": 1512418951, "last_edit_date": 1512418951, "creation_date": 1498580189, "answer_id": 44785226, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/44785226#44785226", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>In my case I was trying to do dependency injection for an object which required constructor arguments. In this case, during Startup I just provided the arguments from the configuration file, for example:</p>\n\n<pre><code>var config = Configuration.GetSection(\"subservice\").Get&lt;SubServiceConfig&gt;();\nservices.AddScoped&lt;ISubService&gt;(provider =&gt; new SubService(config.value1, config.value2));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 291, "user_id": 278290, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f604254178451bdaa1284d01779359b6?s=128&d=identicon&r=PG", "display_name": "thebfactor", "link": "https://stackoverflow.com/users/278290/thebfactor"}, "is_accepted": false, "score": 2, "last_activity_date": 1515429859, "last_edit_date": 1515429859, "creation_date": 1515095700, "answer_id": 48102602, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/48102602#48102602", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>If you are using AutoFac and getting this error, you should add an \"As\" statement to specify the service that the concrete implementation implements.</p>\n\n<p>Ie. you should write:</p>\n\n<pre><code>containerBuilder.RegisterType&lt;DataService&gt;().As&lt;DataService&gt;();\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>containerBuilder.RegisterType&lt;DataService&gt;();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 659, "user_id": 1178375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a572d2ef78442cb60e85c36b90f6190?s=128&d=identicon&r=PG", "display_name": "Omzig", "link": "https://stackoverflow.com/users/1178375/omzig"}, "edited": false, "score": 0, "creation_date": 1592324625, "post_id": 49685788, "comment_id": 110382705, "body": "This is the one i forgot to add. I missed the Injector reference to the service. Needed to .AddTransient&lt;&gt;(); Thank you guys!"}, {"owner": {"reputation": 111, "user_id": 8659250, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4w3Jjzi8TBE/AAAAAAAAAAI/AAAAAAAAAP4/3T9PWbxUWik/photo.jpg?sz=128", "display_name": "Porter Lyman", "link": "https://stackoverflow.com/users/8659250/porter-lyman"}, "edited": false, "score": 0, "creation_date": 1616627868, "post_id": 49685788, "comment_id": 118066024, "body": "Brilliant. My issue was completely forgetting to register a new method in startup.cs. Though in my case, <code>services.AddScoped</code> instead of <code>services.AddTransient</code>."}], "tags": [], "owner": {"reputation": 11927, "user_id": 5550507, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/CA3Wj.jpg?s=128&g=1", "display_name": "Sibeesh Venu", "link": "https://stackoverflow.com/users/5550507/sibeesh-venu"}, "is_accepted": false, "score": 24, "last_activity_date": 1570185658, "last_edit_date": 1570185658, "creation_date": 1522991644, "answer_id": 49685788, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/49685788#49685788", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>I was having a different problem, and yeah the parameterized constructor  for my controller was already added with the correct interface. What I did was something straightforward. I just go to my <code>startup.cs</code> file, where I could see a call to register method.</p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n   services.Register();\n}\n</code></pre>\n\n<p>In my case, this <code>Register</code> method was in a separate class <code>Injector</code>. So I had to add my newly introduced Interfaces there. </p>\n\n<pre><code>public static class Injector\n{\n    public static void Register(this IServiceCollection services)\n    {\n        services.AddTransient&lt;IUserService, UserService&gt;();\n        services.AddTransient&lt;IUserDataService, UserDataService&gt;();\n    }\n}\n</code></pre>\n\n<p>If you see, the parameter to this function is <code>this IServiceCollection</code></p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 20243, "user_id": 633098, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/73ed4ada98edd7d2b842ee5ddc24bf86?s=128&d=identicon&r=PG", "display_name": "silkfire", "link": "https://stackoverflow.com/users/633098/silkfire"}, "is_accepted": false, "score": 6, "last_activity_date": 1531868404, "creation_date": 1531868404, "answer_id": 51391292, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/51391292#51391292", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>I got this issue because of a rather silly mistake. I had forgotten to hook my service configuration procedure to discover controllers automatically in the ASP.NET Core application.</p>\n\n<p>Adding this method solved it:</p>\n\n<pre><code>// Add framework services.\n            services.AddMvc()\n                    .AddControllersAsServices();      // &lt;---- Super important\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 2982195, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b5abbe4138cd3c218496e662d43cb602?s=128&d=identicon&r=PG&f=1", "display_name": "user2982195", "link": "https://stackoverflow.com/users/2982195/user2982195"}, "edited": false, "score": 0, "creation_date": 1588172038, "post_id": 52047414, "comment_id": 108798628, "body": "Solved my problem, because I recognized my services were not in the correct &quot;namespace&quot;."}], "tags": [], "owner": {"reputation": 2560, "user_id": 1666945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9959bb5d32306a8f0dfd231e28be5cf2?s=128&d=identicon&r=PG", "display_name": "hsop", "link": "https://stackoverflow.com/users/1666945/hsop"}, "is_accepted": false, "score": 83, "last_activity_date": 1535406528, "creation_date": 1535406528, "answer_id": 52047414, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/52047414#52047414", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>I ran into this issue because in the dependency injection setup I was missing a dependency of a repository that is a dependency of a controller:</p>\n\n<pre><code>services.AddScoped&lt;IDependencyOne, DependencyOne&gt;();    &lt;-- I was missing this line!\nservices.AddScoped&lt;IDependencyTwoThatIsDependentOnDependencyOne, DependencyTwoThatIsDependentOnDependencyOne&gt;();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 625, "user_id": 750989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b6cf6c4e0fa216452dccc8158bf673f?s=128&d=identicon&r=PG", "display_name": "RaSor", "link": "https://stackoverflow.com/users/750989/rasor"}, "edited": false, "score": 2, "creation_date": 1542288023, "post_id": 52326771, "comment_id": 93520792, "body": "<a href=\"https://docs.microsoft.com/en-us/ef/core/get-started/aspnetcore/existing-db#register-and-configure-your-context-in-startupcs\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/ef/core/get-started/aspnetcore/&hellip;</a>"}], "tags": [], "owner": {"reputation": 111, "user_id": 6929778, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155350925602699/picture?type=large", "display_name": "Warit Taveekarn", "link": "https://stackoverflow.com/users/6929778/warit-taveekarn"}, "is_accepted": false, "score": 10, "last_activity_date": 1536909882, "last_edit_date": 1536909882, "creation_date": 1536909378, "answer_id": 52326771, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/52326771#52326771", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>You need to add a new service for <code>DBcontext</code> in the startup </p>\n\n<p>Default</p>\n\n<pre><code>services.AddDbContext&lt;ApplicationDbContext&gt;(options =&gt;\n                options.UseSqlServer(\n                    Configuration.GetConnectionString(\"DefaultConnection\")));\n</code></pre>\n\n<p>Add this</p>\n\n<pre><code>services.AddDbContext&lt;NewDBContext&gt;(options =&gt;\n                options.UseSqlServer(\n                    Configuration.GetConnectionString(\"NewConnection\")));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 649766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/018d651e26bef315c6fcc7c0bed514b2?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/649766/mike"}, "is_accepted": false, "score": 7, "last_activity_date": 1547564122, "last_edit_date": 1547564122, "creation_date": 1536935349, "answer_id": 52334026, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/52334026#52334026", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>I had to add this line in the ConfigureServices in order to work.</p>\n\n<pre><code>services.AddSingleton&lt;IOrderService, OrderService&gt;();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1481, "user_id": 898358, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/VEX9g.png?s=128&g=1", "display_name": "Rajnikant", "link": "https://stackoverflow.com/users/898358/rajnikant"}, "is_accepted": false, "score": 4, "last_activity_date": 1549135908, "creation_date": 1549135908, "answer_id": 54496742, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/54496742#54496742", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>I was getting below exception</p>\n\n<pre><code>        System.InvalidOperationException: Unable to resolve service for type 'System.Func`1[IBlogContext]' \n        while attempting to activate 'BlogContextFactory'.\\r\\n at \n        Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(Type serviceType, Type implementationType, ISet`1 callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(Type serviceType, Type implementationType, ISet`1 callSiteChain)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, Type serviceType, ISet`1 callSiteChain)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(Type serviceType, ISet`1 callSiteChain)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(Type serviceType, ISet`1 callSiteChain)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(Type serviceType, Type implementationType, ISet`1 callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(Type serviceType, Type implementationType, ISet`1 callSiteChain)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, Type serviceType, ISet`1 callSiteChain)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(Type serviceType, ISet`1 callSiteChain)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(Type serviceType, ISet`1 callSiteChain)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(Type serviceType, ServiceProvider serviceProvider)\\r\\n at System.Collections.Concurrent.ConcurrentDictionaryExtensions.GetOrAdd[TKey, TValue, TArg] (ConcurrentDictionary`2 dictionary, TKey key, Func`3 valueFactory, TArg arg)\\r\\n at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)\\r\\n at Microsoft.Extensions.Internal.ActivatorUtilities.GetService(IServiceProvider sp, Type type, Type requiredBy, Boolean isDefaultParameterRequired)\\r\\n at lambda_method(Closure , IServiceProvider , Object[] )\\r\\n at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.&lt;&gt;c__DisplayClass5_0.&lt;CreateControllerFactory&gt;g__CreateController|0(ControllerContext controllerContext)\\r\\n at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State&amp; next, Scope&amp; scope, Object&amp; state, Boolean&amp; isCompleted)\\r\\n at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()\\r\\n at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextExceptionFilterAsync()\n</code></pre>\n\n<p>Because I wanted register Factory to create instances of DbContext Derived class IBlogContextFactory and use Create method to instantiate instance of Blog Context so that I can use below pattern along with dependency Injection and can also use mocking for unit testing.</p>\n\n<p>the pattern I wanted to use is </p>\n\n<pre><code>public async Task&lt;List&lt;Blog&gt;&gt; GetBlogsAsync()\n        {\n            using (var context = new BloggingContext())\n            {\n                return await context.Blogs.ToListAsync();\n            }\n        }\n</code></pre>\n\n<p>But Instead of new BloggingContext() I want to Inject factory via constructor as in below BlogController class</p>\n\n<pre><code>    [Route(\"blogs/api/v1\")]\n\npublic class BlogController : ControllerBase\n{\n    IBloggingContextFactory _bloggingContextFactory;\n\n    public BlogController(IBloggingContextFactory bloggingContextFactory)\n    {\n        _bloggingContextFactory = bloggingContextFactory;\n    }\n\n    [HttpGet(\"blog/{id}\")]\n    public async Task&lt;Blog&gt; Get(int id)\n    {\n        //validation goes here \n        Blog blog = null;\n        // Instantiage context only if needed and dispose immediately\n        using (IBloggingContext context = _bloggingContextFactory.CreateContext())\n        {\n            blog = await context.Blogs.FindAsync(id);\n        }\n        //Do further processing without need of context.\n        return blog;\n    }\n}\n</code></pre>\n\n<p>here is my service registration code </p>\n\n<pre><code>            services\n            .AddDbContext&lt;BloggingContext&gt;()\n            .AddTransient&lt;IBloggingContext, BloggingContext&gt;()\n            .AddTransient&lt;IBloggingContextFactory, BloggingContextFactory&gt;();\n</code></pre>\n\n<p>and below are my models and factory classes</p>\n\n<pre><code>    public interface IBloggingContext : IDisposable\n{\n    DbSet&lt;Blog&gt; Blogs { get; set; }\n    DbSet&lt;Post&gt; Posts { get; set; }\n}\n\npublic class BloggingContext : DbContext, IBloggingContext\n{\n    public DbSet&lt;Blog&gt; Blogs { get; set; }\n    public DbSet&lt;Post&gt; Posts { get; set; }\n\n    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n    {\n        optionsBuilder.UseInMemoryDatabase(\"blogging.db\");\n        //optionsBuilder.UseSqlite(\"Data Source=blogging.db\");\n    }\n}\n\npublic interface IBloggingContextFactory\n{\n    IBloggingContext CreateContext();\n}\n\npublic class BloggingContextFactory : IBloggingContextFactory\n{\n    private Func&lt;IBloggingContext&gt; _contextCreator;\n    public BloggingContextFactory(Func&lt;IBloggingContext&gt; contextCreator)// This is fine with .net and unity, this is treated as factory function, but creating problem in .netcore service provider\n    {\n        _contextCreator = contextCreator;\n    }\n\n    public IBloggingContext CreateContext()\n    {\n        return _contextCreator();\n    }\n}\n\npublic class Blog\n{\n    public Blog()\n    {\n        CreatedAt = DateTime.Now;\n    }\n\n    public Blog(int id, string url, string deletedBy) : this()\n    {\n        BlogId = id;\n        Url = url;\n        DeletedBy = deletedBy;\n        if (!string.IsNullOrWhiteSpace(deletedBy))\n        {\n            DeletedAt = DateTime.Now;\n        }\n    }\n    public int BlogId { get; set; }\n    public string Url { get; set; }\n    public DateTime CreatedAt { get; set; }\n    public DateTime? DeletedAt { get; set; }\n    public string DeletedBy { get; set; }\n    public ICollection&lt;Post&gt; Posts { get; set; }\n\n    public override string ToString()\n    {\n        return $\"id:{BlogId} , Url:{Url} , CreatedAt : {CreatedAt}, DeletedBy : {DeletedBy}, DeletedAt: {DeletedAt}\";\n    }\n}\n\npublic class Post\n{\n    public int PostId { get; set; }\n    public string Title { get; set; }\n    public string Content { get; set; }\n    public int BlogId { get; set; }\n    public Blog Blog { get; set; }\n}\n</code></pre>\n\n<p><strong>----- To Fix this in .net Core MVC project -- I did below changes on dependency registration</strong></p>\n\n<pre><code>            services\n            .AddDbContext&lt;BloggingContext&gt;()\n            .AddTransient&lt;IBloggingContext, BloggingContext&gt;()\n            .AddTransient&lt;IBloggingContextFactory, BloggingContextFactory&gt;(\n                    sp =&gt; new BloggingContextFactory( () =&gt; sp.GetService&lt;IBloggingContext&gt;())\n                );\n</code></pre>\n\n<p>In short in .net core developer is responsible to inject factory function, which in case of Unity and .Net Framework was taken care of.</p>\n"}, {"tags": [], "owner": {"reputation": 169, "user_id": 10866757, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5wbZBuWciAc/AAAAAAAAAAI/AAAAAAAAA2w/vUhqh59ZBwM/photo.jpg?sz=128", "display_name": "Prakash CS", "link": "https://stackoverflow.com/users/10866757/prakash-cs"}, "is_accepted": false, "score": 11, "last_activity_date": 1577528544, "last_edit_date": 1577528544, "creation_date": 1549532748, "answer_id": 54570424, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/54570424#54570424", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<pre><code>Public void ConfigureServices(IServiceCollection services)\n{\n    services.AddScoped&lt;IEventRepository, EventRepository&gt;();           \n}\n</code></pre>\n\n<p>You forgot to add \"services.AddScoped\" in startup <code>ConfigureServices</code> method.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5852709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36c91b0ad32b5a0adbd3d3f0005aaf1d?s=128&d=identicon&r=PG&f=1", "display_name": "satish madarapu", "link": "https://stackoverflow.com/users/5852709/satish-madarapu"}, "is_accepted": false, "score": 0, "last_activity_date": 1592508151, "last_edit_date": 1592508151, "creation_date": 1554589711, "answer_id": 55554005, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/55554005#55554005", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>I replaced</p>\n\n\n\n<pre><code>services.Add(new ServiceDescriptor(typeof(IMyLogger), typeof(MyLogger)));\n</code></pre>\n\n<p>With</p>\n\n\n\n<pre><code>services.AddTransient&lt;IMyLogger, MyLogger&gt;();\n</code></pre>\n\n<p>And it worked for me.</p>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 10625865, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-r1--x61qyBg/AAAAAAAAAAI/AAAAAAAAIj0/H5QzzvELAHI/photo.jpg?sz=128", "display_name": "Shailesh Tiwari", "link": "https://stackoverflow.com/users/10625865/shailesh-tiwari"}, "is_accepted": false, "score": 3, "last_activity_date": 1555357282, "last_edit_date": 1555357282, "creation_date": 1555351129, "answer_id": 55694873, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/55694873#55694873", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>This issue is because you didn't register the data access component with the interface written for it. Try using as follows</p>\n\n<pre><code>services.AddTransient&lt;IMyDataProvider, MyDataAccess&gt;();`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 147, "user_id": 728724, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e112ba86de25d9a41b40e99416d7b3c?s=128&d=identicon&r=PG", "display_name": "Son", "link": "https://stackoverflow.com/users/728724/son"}, "is_accepted": false, "score": 2, "last_activity_date": 1559630517, "creation_date": 1559630517, "answer_id": 56438604, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/56438604#56438604", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>ohh, Thank @kimbaudi, i followed this tuts</p>\n\n<p><a href=\"https://dotnettutorials.net/lesson/generic-repository-pattern-csharp-mvc/\" rel=\"nofollow noreferrer\">https://dotnettutorials.net/lesson/generic-repository-pattern-csharp-mvc/</a></p>\n\n<p>and got the same error as your. But after read your code i found out my solution was adding </p>\n\n<blockquote>\n  <p>services.AddScoped(IGenericRepository, GenericRepository);</p>\n</blockquote>\n\n<p>into <strong>ConfigureServices</strong> method in StartUp.cs file =)) </p>\n"}, {"tags": [], "owner": {"reputation": 1225, "user_id": 4847565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LeD30.jpg?s=128&g=1", "display_name": "Bhanu Pratap", "link": "https://stackoverflow.com/users/4847565/bhanu-pratap"}, "is_accepted": false, "score": 1, "last_activity_date": 1577197893, "creation_date": 1577197893, "answer_id": 59470238, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/59470238#59470238", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>Add <strong>services.AddSingleton();</strong> in your ConfigureServices method of Startup.cs file of your project.</p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n    {\n        services.AddRazorPages();\n        // To register interface with its concrite type\n        services.AddSingleton&lt;IEmployee, EmployeesMockup&gt;();\n    }\n</code></pre>\n\n<p>For More details please visit this URL : <a href=\"https://www.youtube.com/watch?v=aMjiiWtfj2M\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=aMjiiWtfj2M</a></p>\n\n<p>for All methods (i.e. AddSingleton vs AddScoped vs AddTransient) Please visit this URL: <a href=\"https://www.youtube.com/watch?v=v6Nr7Zman_Y&amp;list=PL6n9fhu94yhVkdrusLaQsfERmL_Jh4XmU&amp;index=44\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=v6Nr7Zman_Y&amp;list=PL6n9fhu94yhVkdrusLaQsfERmL_Jh4XmU&amp;index=44</a>)</p>\n"}, {"tags": [], "owner": {"reputation": 2465, "user_id": 331752, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/026b9f44ffd693a20c0397c0e36fd75c?s=128&d=identicon&r=PG", "display_name": "Sauleil", "link": "https://stackoverflow.com/users/331752/sauleil"}, "is_accepted": false, "score": 2, "last_activity_date": 1582085856, "creation_date": 1582085856, "answer_id": 60292936, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/60292936#60292936", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>I had the same issue and found out that my code was using the injection before it was initialized.</p>\n\n<pre><code>services.AddControllers(); // Will cause a problem if you use your IBloggerRepository in there since it's defined after this line.\nservices.AddScoped&lt;IBloggerRepository, BloggerRepository&gt;();\n</code></pre>\n\n<p>I know it has nothing to do with the question, but since I was sent to this page, I figure out it my be useful to someone else.</p>\n"}, {"tags": [], "owner": {"reputation": 512, "user_id": 10037278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Onat Korucu", "link": "https://stackoverflow.com/users/10037278/onat-korucu"}, "is_accepted": false, "score": 2, "last_activity_date": 1582551962, "creation_date": 1582551962, "answer_id": 60377258, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/60377258#60377258", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>Resolving a service is done even before the class code is reached, so we need to check our dependency injections. </p>\n\n<p>In my case I added</p>\n\n<pre><code>        services.AddScoped&lt;IMeasurementService, MeasurementService&gt;();\n</code></pre>\n\n<p>in StartupExtensions.cs</p>\n"}, {"comments": [{"owner": {"reputation": 1312, "user_id": 1161676, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/016c10f24ddb0f00322399f4e80ce5d2?s=128&d=identicon&r=PG", "display_name": "theITvideos", "link": "https://stackoverflow.com/users/1161676/theitvideos"}, "edited": false, "score": 1, "creation_date": 1597154772, "post_id": 63226851, "comment_id": 112037396, "body": "hey mate! that did it for me. I knew in my case it was this fix."}], "tags": [], "owner": {"reputation": 548, "user_id": 1747356, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1d07494f29f65444527b4cd2b4d6b745?s=128&d=identicon&r=PG", "display_name": "Jitendra Sawant", "link": "https://stackoverflow.com/users/1747356/jitendra-sawant"}, "is_accepted": false, "score": 7, "last_activity_date": 1596446711, "creation_date": 1596446711, "answer_id": 63226851, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/63226851#63226851", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>In my case, .Net Core 3.0 API in\nStartup.cs,\nin method</p>\n<pre><code>public void ConfigureServices(IServiceCollection services)\n</code></pre>\n<p>I had to add</p>\n<pre><code>services.AddScoped&lt;IStateService, StateService&gt;();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5196973, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000541363176/picture?type=large", "display_name": "Shah Zai\u019e", "link": "https://stackoverflow.com/users/5196973/shah-zai%c6%9e"}, "is_accepted": false, "score": 0, "last_activity_date": 1600076759, "creation_date": 1600076759, "answer_id": 63881903, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/63881903#63881903", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>Change BloggerRepository to IBloggerRepository</p>\n"}, {"tags": [], "owner": {"reputation": 869, "user_id": 1024044, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/7bo1J.jpg?s=128&g=1", "display_name": "Sgedda", "link": "https://stackoverflow.com/users/1024044/sgedda"}, "is_accepted": false, "score": 0, "last_activity_date": 1603027338, "last_edit_date": 1603027338, "creation_date": 1603024814, "answer_id": 64413410, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/64413410#64413410", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>I had problems trying to inject from my Program.cs file, by using the <strong>CreateDefaultBuilder</strong> like below, but ended up solving it by skipping the default binder. (see below).</p>\n<pre><code>var host = Host.CreateDefaultBuilder(args)\n.ConfigureWebHostDefaults(webBuilder =&gt;\n{\n    webBuilder.ConfigureServices(servicesCollection =&gt; { servicesCollection.AddSingleton&lt;ITest&gt;(x =&gt; new Test()); });\n    webBuilder.UseStartup&lt;Startup&gt;();\n}).Build();\n</code></pre>\n<p>It seems like the Build should have been done inside of ConfigureWebHostDefaults to get it work, since otherwise the configuration will be skipped, but correct me if I am wrong.</p>\n<p>This approach worked fine:</p>\n<pre><code>var host = new WebHostBuilder()\n.ConfigureServices(servicesCollection =&gt;\n{\n    var serviceProvider = servicesCollection.BuildServiceProvider();\n    IConfiguration configuration = (IConfiguration)serviceProvider.GetService(typeof(IConfiguration));\n    servicesCollection.AddSingleton&lt;ISendEmailHandler&gt;(new SendEmailHandler(configuration));\n})\n.UseStartup&lt;Startup&gt;()\n.Build();\n</code></pre>\n<p>This also shows how to inject an already predefined dependency in .net core (<strong>IConfiguration</strong>) from</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 15089870, "user_type": "registered", "profile_image": "https://graph.facebook.com/1374296922903278/picture?type=large", "display_name": "Nikky", "link": "https://stackoverflow.com/users/15089870/nikky"}, "is_accepted": false, "score": 1, "last_activity_date": 1611740899, "last_edit_date": 1611740899, "creation_date": 1611735021, "answer_id": 65915145, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil/65915145#65915145", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>You might be missing this:</p>\n<pre><code>services.AddScoped&lt;IDependencyTwoThatIsDependentOnDependencyOne, DependencyTwoThatIsDependentOnDependencyOne&gt;();\n</code></pre>\n"}], "owner": {"reputation": 7852, "user_id": 1097123, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93d48a626680f755c5464741d9897e78?s=128&d=identicon&r=PG", "display_name": "kimbaudi", "link": "https://stackoverflow.com/users/1097123/kimbaudi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419750, "favorite_count": 40, "accepted_answer_id": 40900520, "answer_count": 21, "score": 269, "last_activity_date": 1613125211, "creation_date": 1480550363, "last_edit_date": 1517113328, "question_id": 40900414, "link": "https://stackoverflow.com/questions/40900414/asp-net-core-dependency-injection-error-unable-to-resolve-service-for-type-whil", "title": "ASP.NET Core Dependency Injection error: Unable to resolve service for type while attempting to activate", "body": "<p>I created an .NET Core MVC application and use Dependency Injection and Repository Pattern to inject a repository to my controller. However, I am getting an error:</p>\n\n<blockquote>\n  <p>InvalidOperationException: Unable to resolve service for type 'WebApplication1.Data.BloggerRepository' while attempting to activate 'WebApplication1.Controllers.BlogController'.</p>\n</blockquote>\n\n<p><strong>Model (Blog.cs)</strong></p>\n\n<pre><code>namespace WebApplication1.Models\n{\n    public class Blog\n    {\n        public int BlogId { get; set; }\n        public string Url { get; set; }\n    }\n}\n</code></pre>\n\n<p><strong>DbContext (BloggingContext.cs)</strong></p>\n\n<pre><code>using Microsoft.EntityFrameworkCore;\nusing WebApplication1.Models;\n\nnamespace WebApplication1.Data\n{\n    public class BloggingContext : DbContext\n    {\n        public BloggingContext(DbContextOptions&lt;BloggingContext&gt; options)\n            : base(options)\n        { }\n        public DbSet&lt;Blog&gt; Blogs { get; set; }\n    }\n}\n</code></pre>\n\n<p><strong>Repository (IBloggerRepository.cs &amp; BloggerRepository.cs)</strong></p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing WebApplication1.Models;\n\nnamespace WebApplication1.Data\n{\n    internal interface IBloggerRepository : IDisposable\n    {\n        IEnumerable&lt;Blog&gt; GetBlogs();\n\n        void InsertBlog(Blog blog);\n\n        void Save();\n    }\n}\n\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing WebApplication1.Models;\n\nnamespace WebApplication1.Data\n{\n    public class BloggerRepository : IBloggerRepository\n    {\n        private readonly BloggingContext _context;\n\n        public BloggerRepository(BloggingContext context)\n        {\n            _context = context;\n        }\n\n        public IEnumerable&lt;Blog&gt; GetBlogs()\n        {\n            return _context.Blogs.ToList();\n        }\n\n        public void InsertBlog(Blog blog)\n        {\n            _context.Blogs.Add(blog);\n        }\n\n        public void Save()\n        {\n            _context.SaveChanges();\n        }\n\n        private bool _disposed;\n\n        protected virtual void Dispose(bool disposing)\n        {\n            if (!_disposed)\n            {\n                if (disposing)\n                {\n                    _context.Dispose();\n                }\n            }\n            _disposed = true;\n        }\n\n        public void Dispose()\n        {\n            Dispose(true);\n            GC.SuppressFinalize(this);\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Startup.cs (relevant code)</strong></p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n{\n    // Add framework services.\n    services.AddDbContext&lt;BloggingContext&gt;(options =&gt;\n        options.UseSqlServer(Configuration.GetConnectionString(\"DefaultConnection\")));\n\n    services.AddScoped&lt;IBloggerRepository, BloggerRepository&gt;();\n\n    services.AddMvc();\n\n    // Add application services.\n    services.AddTransient&lt;IEmailSender, AuthMessageSender&gt;();\n    services.AddTransient&lt;ISmsSender, AuthMessageSender&gt;();\n}\n</code></pre>\n\n<p><strong>Controller (BlogController.cs)</strong></p>\n\n<pre><code>using System.Linq;\nusing Microsoft.AspNetCore.Mvc;\nusing WebApplication1.Data;\nusing WebApplication1.Models;\n\nnamespace WebApplication1.Controllers\n{\n    public class BlogController : Controller\n    {\n        private readonly IBloggerRepository _repository;\n\n        public BlogController(BloggerRepository repository)\n        {\n            _repository = repository;\n        }\n\n        public IActionResult Index()\n        {\n            return View(_repository.GetBlogs().ToList());\n        }\n\n        public IActionResult Create()\n        {\n            return View();\n        }\n\n        [HttpPost]\n        [ValidateAntiForgeryToken]\n        public IActionResult Create(Blog blog)\n        {\n            if (ModelState.IsValid)\n            {\n                _repository.InsertBlog(blog);\n                _repository.Save();\n                return RedirectToAction(\"Index\");\n            }\n            return View(blog);\n        }\n    }\n}\n</code></pre>\n\n<p>I'm not sure what I'm doing wrong. Any ideas?</p>\n"}, {"tags": ["c#", "winforms"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 4, "creation_date": 1480549566, "post_id": 40900281, "comment_id": 69014358, "body": "You are also new to this SO thing.  Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and take the <a href=\"https://stackoverflow.com/tour\">Tour</a>"}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "edited": false, "score": 0, "creation_date": 1480549576, "post_id": 40900281, "comment_id": 69014361, "body": "\u2190:<code>this.Left -= 10;</code> , \u2192:<code>this.Left += 10;</code> and the same for <code>Top</code>."}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1480549607, "post_id": 40900281, "comment_id": 69014370, "body": "See the <code>Location</code> property."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7233584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a20eaafd58344e947581bff88bccc93?s=128&d=identicon&r=PG&f=1", "display_name": "Elad Tzabari", "link": "https://stackoverflow.com/users/7233584/elad-tzabari"}, "edited": false, "score": 0, "creation_date": 1480591035, "post_id": 40900353, "comment_id": 69030766, "body": "Thank you for that great answer Jim But isnt &quot;this&quot; refer to the button ?"}], "tags": [], "owner": {"reputation": 170, "user_id": 7219335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ffl3f.jpg?s=128&g=1", "display_name": "infmja", "link": "https://stackoverflow.com/users/7219335/infmja"}, "is_accepted": false, "score": 2, "last_activity_date": 1480549930, "creation_date": 1480549930, "answer_id": 40900353, "question_id": 40900281, "link": "https://stackoverflow.com/questions/40900281/how-to-move-a-form-programmatically/40900353#40900353", "title": "How to move a form programmatically?", "body": "<p>Move form to the right:  </p>\n\n<pre><code>private void btnRight_Click(object sender, EventArgs e) {\n     form.Location = new Point(form.Location.X + 10, form.Location.Y);\n}\n</code></pre>\n\n<p>Move form to the left:  </p>\n\n<pre><code>private void btnLeft_Click(object sender, EventArgs e) {\n     form.Location = new Point(form.Location.X - 10, form.Location.Y);\n}  \n</code></pre>\n\n<p>Move form up:  </p>\n\n<pre><code>private void btnUp_Click(object sender, EventArgs e) {\n     form.Location = new Point(form.Location.X, form.Location.Y - 10);\n}  \n</code></pre>\n\n<p>Move form down:  </p>\n\n<pre><code>private void btnDown_Click(object sender, EventArgs e) {\n     form.Location = new Point(form.Location.X, form.Location.Y + 10);\n}  \n</code></pre>\n\n<p>Edit:<br>\nIf by form you mean the main window, just replace every \"form\" in my code with \"this\".</p>\n"}, {"tags": [], "owner": {"reputation": 2777, "user_id": 2946187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HX4Kk.jpg?s=128&g=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/2946187/jim"}, "is_accepted": true, "score": 3, "last_activity_date": 1480551376, "last_edit_date": 1592644375, "creation_date": 1480550576, "answer_id": 40900444, "question_id": 40900281, "link": "https://stackoverflow.com/questions/40900281/how-to-move-a-form-programmatically/40900444#40900444", "title": "How to move a form programmatically?", "body": "<p>To set them individually, use the form's Left (X) or Top (Y) sub property. <strong>Do not</strong> try to implicitly set the X and Y coordinates of the Point structure that represents the form's location, because this contains a copy of the form's coordinates.</p>\n<p>To change form position programmatic by increments, increase or decrease X and Y coordinates</p>\n<ul>\n<li>Left = X</li>\n<li>Top = Y</li>\n</ul>\n<h2>Example button events:</h2>\n<pre><code>private void UpButton_Click(object sender, EventArgs e)    \n{\n    this.Top -= 10;\n}\n\nprivate void DownButton_Click(object sender, EventArgs e)\n{\n    this.Top += 10;\n}\n\nprivate void RightButton_Click(object sender, EventArgs e)\n{\n    this.Left += 10;\n}\n\nprivate void LeftButton_Click(object sender, EventArgs e)\n{\n    this.Left -= 10;\n}\n</code></pre>\n<blockquote>\n<p>To clarify e.g. <code>this.Top -= 10;</code> is short for <code>this.Top = this.Top - 10;</code></p>\n</blockquote>\n<h2>Result:</h2>\n<p><a href=\"https://i.stack.imgur.com/1MOdW.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1MOdW.gif\" alt=\"result\" /></a></p>\n"}], "owner": {"reputation": 37, "user_id": 7233584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a20eaafd58344e947581bff88bccc93?s=128&d=identicon&r=PG&f=1", "display_name": "Elad Tzabari", "link": "https://stackoverflow.com/users/7233584/elad-tzabari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2771, "favorite_count": 1, "closed_date": 1480588177, "accepted_answer_id": 40900444, "answer_count": 2, "score": 2, "last_activity_date": 1480551517, "creation_date": 1480549412, "last_edit_date": 1480551517, "question_id": 40900281, "link": "https://stackoverflow.com/questions/40900281/how-to-move-a-form-programmatically", "closed_reason": "Needs more focus", "title": "How to move a form programmatically?", "body": "<p>I am new in this C# thing and need your help</p>\n\n<p>Currently I have a form with 4 buttons on a form (Up,Down,Left,Right)</p>\n\n<p>I would like to move the form 10 pixels to the direction that was pressed.</p>\n"}, {"tags": ["c#", "android", "xamarin", "xamarin.forms", "android-camera"], "answers": [{"comments": [{"owner": {"reputation": 2388, "user_id": 2039574, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c31927b5d17a5c8297da615c9321aa4?s=128&d=identicon&r=PG&f=1", "display_name": "Euridice01", "link": "https://stackoverflow.com/users/2039574/euridice01"}, "edited": false, "score": 0, "creation_date": 1480554311, "post_id": 40900927, "comment_id": 69015657, "body": "Good point! I also ended up creating an inner class that implements the OnAutoFocus method from the IAutoFocusCallback interface and creating the instance of the class inside camera.AutoFocus()... Just need to test it. That would also work but &quot;this&quot; would be a shorter way of doing the same thing right? Which way is clearer/better practice?"}], "tags": [], "owner": {"reputation": 5513, "user_id": 2913599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098f6fabc851434459585bb8170f950f?s=128&d=identicon&r=PG", "display_name": "jgoldberger - MSFT", "link": "https://stackoverflow.com/users/2913599/jgoldberger-msft"}, "is_accepted": false, "score": 1, "last_activity_date": 1480554009, "creation_date": 1480554009, "answer_id": 40900927, "question_id": 40900263, "link": "https://stackoverflow.com/questions/40900263/tap-to-focus-for-camera-implementation/40900927#40900927", "title": "Tap to focus for camera implementation", "body": "<p>All that happened in the linked Java answer is that they provided the code to run when the OS calls the callback:</p>\n\n<pre><code>camera.autoFocus(new Camera.AutoFocusCallback() {                   \n    @Override\n      public void onAutoFocus(boolean success, Camera camera) {\n           camera.cancelAutoFocus();\n           Parameters params = camera.getParameters();\n           if(params.getFocusMode() != Camera.Parameters.FOCUS_MODE_CONTINUOUS_PICTURE){\n                params.setFocusMode(Camera.Parameters.FOCUS_MODE_CONTINUOUS_PICTURE);\n                camera.setParameters(params);\n        }\n    }\n});\n</code></pre>\n\n<p>the above does not \"call\" the call back, just provides the call back code to run. the OS calls the call back. So in Xamarin, you need to pass in the type that is implementing the <code>IAutoFocusCallback</code> interface, so You should be able to do this I would think since CameraPage is implementing the <code>IAutoFocusCallback</code> interface:</p>\n\n<pre><code>camera.AutoFocus(this); // \"this\" refers to your current CameraPage which implements the interface. \n</code></pre>\n\n<p>the clue here is that when you type the opening parenthesis after <code>camera.AutoFocus</code> the popup shows that you need to pass in a type <code>IAutoFocusCallback</code>, which means any type that implements that interface, so in this case that is \"this\" CameraPage. :-)</p>\n"}, {"comments": [{"owner": {"reputation": 2388, "user_id": 2039574, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c31927b5d17a5c8297da615c9321aa4?s=128&d=identicon&r=PG&f=1", "display_name": "Euridice01", "link": "https://stackoverflow.com/users/2039574/euridice01"}, "edited": false, "score": 0, "creation_date": 1480554798, "post_id": 40900957, "comment_id": 69015769, "body": "For my second question, can you give me an example. I tried textureView.Click += OnTouch;  but &#39;no overload for &#39;OnTouch&#39; matches delegate &#39;EventHandler&#39;. Is there a specific event handler I need to use?"}, {"owner": {"reputation": 2388, "user_id": 2039574, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c31927b5d17a5c8297da615c9321aa4?s=128&d=identicon&r=PG&f=1", "display_name": "Euridice01", "link": "https://stackoverflow.com/users/2039574/euridice01"}, "edited": false, "score": 0, "creation_date": 1480557059, "post_id": 40900957, "comment_id": 69016330, "body": "Thanks blueboyz! That seems to work. The casting is not valid in the CalculateTapArea() @_@ I guess I have to debug that but that means the tap event was registered"}, {"owner": {"reputation": 469, "user_id": 1351913, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/b1aac68475fa428ef4b081d5c6c63682?s=128&d=identicon&r=PG", "display_name": "albilaga", "link": "https://stackoverflow.com/users/1351913/albilaga"}, "reply_to_user": {"reputation": 2388, "user_id": 2039574, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c31927b5d17a5c8297da615c9321aa4?s=128&d=identicon&r=PG&f=1", "display_name": "Euridice01", "link": "https://stackoverflow.com/users/2039574/euridice01"}, "edited": false, "score": 0, "creation_date": 1480557927, "post_id": 40900957, "comment_id": 69016527, "body": "Glad it works. Btw what kind of error In CalculateTapArea()? In that method I don&#39;t think you need to convert float value by using Java.Float"}, {"owner": {"reputation": 2388, "user_id": 2039574, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c31927b5d17a5c8297da615c9321aa4?s=128&d=identicon&r=PG&f=1", "display_name": "Euridice01", "link": "https://stackoverflow.com/users/2039574/euridice01"}, "edited": false, "score": 0, "creation_date": 1480558199, "post_id": 40900957, "comment_id": 69016592, "body": "Fixed the type converter! I&#39;m getting another issue with setparameters but I think it&#39;s because the phone I&#39;m using doesn&#39;t have continue picture, so I need to set it to another supported mode. Going to try that. Thank you!"}, {"owner": {"reputation": 2388, "user_id": 2039574, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c31927b5d17a5c8297da615c9321aa4?s=128&d=identicon&r=PG&f=1", "display_name": "Euridice01", "link": "https://stackoverflow.com/users/2039574/euridice01"}, "edited": false, "score": 0, "creation_date": 1480559784, "post_id": 40900957, "comment_id": 69016976, "body": "I got the focus to work. I am wondeirng though what are GenericParameterAttributes and GenericParameterPosition? I get exceptions for those parameter properties (Although they are catch in the exception and focus still works). Are you familiar with what those properties are? Thanks!"}, {"owner": {"reputation": 469, "user_id": 1351913, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/b1aac68475fa428ef4b081d5c6c63682?s=128&d=identicon&r=PG", "display_name": "albilaga", "link": "https://stackoverflow.com/users/1351913/albilaga"}, "reply_to_user": {"reputation": 2388, "user_id": 2039574, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c31927b5d17a5c8297da615c9321aa4?s=128&d=identicon&r=PG&f=1", "display_name": "Euridice01", "link": "https://stackoverflow.com/users/2039574/euridice01"}, "edited": false, "score": 0, "creation_date": 1480564426, "post_id": 40900957, "comment_id": 69018075, "body": "Nope. Try read some msdn docs in here <a href=\"https://msdn.microsoft.com/en-us/library/system.reflection.genericparameterattributes(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a> Hope it helps"}, {"owner": {"reputation": 1872, "user_id": 3137362, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f6d870a7f09c6f59bfe0dc3a4544b400?s=128&d=identicon&r=PG&f=1", "display_name": "bh_earth0", "link": "https://stackoverflow.com/users/3137362/bh-earth0"}, "edited": false, "score": 0, "creation_date": 1519300370, "post_id": 40900957, "comment_id": 84859507, "body": "camera.AutoFocus(this);    Crashes my app  instead   use parameter.FocusMode =   from here: <a href=\"https://stackoverflow.com/questions/15623944/how-to-autofocus-android-camera-automatically\" title=\"how to autofocus android camera automatically\">stackoverflow.com/questions/15623944/&hellip;</a>"}], "tags": [], "owner": {"reputation": 469, "user_id": 1351913, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/b1aac68475fa428ef4b081d5c6c63682?s=128&d=identicon&r=PG", "display_name": "albilaga", "link": "https://stackoverflow.com/users/1351913/albilaga"}, "is_accepted": true, "score": 2, "last_activity_date": 1480557122, "last_edit_date": 1480557122, "creation_date": 1480554197, "answer_id": 40900957, "question_id": 40900263, "link": "https://stackoverflow.com/questions/40900263/tap-to-focus-for-camera-implementation/40900957#40900957", "title": "Tap to focus for camera implementation", "body": "<p>You can try change</p>\n\n<pre><code>camera.AutoFocus(OnAutoFocus);\n</code></pre>\n\n<p>to </p>\n\n<pre><code>camera.AutoFocus(this);\n</code></pre>\n\n<p>and it will be using OnAutoFocus because it implementation from IAutoFocusCallback.</p>\n\n<p>And for your question about subscribe event you can try to subscribe event in OnElementChanged like this</p>\n\n<pre><code>protected override void OnElementChanged(ElementChangedEventArgs&lt;Xamarin.Forms.Page&gt; e)\n        {\n            base.OnElementChanged(e);\n            if (e.OldElement != null || Element == null)\n            {\n                return;\n            }\n            try\n            {\n                this.SetOnTouchListener(this);\n            }\n            catch (Exception e)\n            {\n\n            }\n\n        }\n</code></pre>\n\n<p>And btw I don't see to use <code>TextureView.ISurfaceTextureListener</code> in this code.</p>\n"}], "owner": {"reputation": 2388, "user_id": 2039574, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0c31927b5d17a5c8297da615c9321aa4?s=128&d=identicon&r=PG&f=1", "display_name": "Euridice01", "link": "https://stackoverflow.com/users/2039574/euridice01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2498, "favorite_count": 0, "accepted_answer_id": 40900957, "answer_count": 2, "score": 0, "last_activity_date": 1480557122, "creation_date": 1480549294, "last_edit_date": 1495541630, "question_id": 40900263, "link": "https://stackoverflow.com/questions/40900263/tap-to-focus-for-camera-implementation", "title": "Tap to focus for camera implementation", "body": "<p>I'm trying to implement a manual focus feature for my camera page so that the user can tap to focus the camera. </p>\n\n<p>I'm following <a href=\"https://stackoverflow.com/questions/17993751/whats-the-correct-way-to-implement-tap-to-focus-for-camera\">this StackOverflow question that's currently written in Java</a> for native Android. I've been converting it to C# for my Xamarin.Forms Android app.</p>\n\n<p>Here's what I have so far: </p>\n\n<pre><code>public class CameraPage : PageRenderer, TextureView.ISurfaceTextureListener, Android.Views.View.IOnTouchListener, IAutoFocusCallback\n{\n    global::Android.Hardware.Camera camera;\n    TextureView textureView;\n\n    public void OnAutoFocus(bool success, Android.Hardware.Camera camera)\n    {\n        var parameters = camera.GetParameters();\n        if (parameters.FocusMode != Android.Hardware.Camera.Parameters.FocusModeContinuousPicture)\n        {\n            parameters.FocusMode = Android.Hardware.Camera.Parameters.FocusModeContinuousPicture;\n\n            if (parameters.MaxNumFocusAreas &gt; 0)\n            {\n                parameters.FocusAreas = null;\n            }\n            camera.SetParameters(parameters);\n            camera.StartPreview();\n        }\n    }\n\n    public bool OnTouch(Android.Views.View v, MotionEvent e)\n    {\n        if (camera != null)\n        {\n            var parameters = camera.GetParameters();\n            camera.CancelAutoFocus();\n            Rect focusRect = CalculateTapArea(e.GetX(), e.GetY(), 1f);\n\n            if (parameters.FocusMode != Android.Hardware.Camera.Parameters.FocusModeAuto)\n            {\n                parameters.FocusMode = Android.Hardware.Camera.Parameters.FocusModeAuto;\n            }\n            if (parameters.MaxNumFocusAreas &gt; 0)\n            {\n                List&lt;Area&gt; mylist = new List&lt;Area&gt;();\n                mylist.Add(new Android.Hardware.Camera.Area(focusRect, 1000));\n                parameters.FocusAreas = mylist;\n            }\n\n            try\n            {\n                camera.CancelAutoFocus();\n                camera.SetParameters(parameters);\n                camera.StartPreview();\n                camera.AutoFocus(OnAutoFocus); //Here is the issue. How do I use the callback? \n            }\n            catch (System.Exception ex)\n            {\n                Console.WriteLine(ex.ToString());\n                Console.Write(ex.StackTrace);\n            }\n            return true;\n        }\n        return false; \n    }\n\n    private Rect CalculateTapArea(object x, object y, float coefficient)\n    {\n        var focusAreaSize = 500;\n        int areaSize = Java.Lang.Float.ValueOf(focusAreaSize * coefficient).IntValue();\n\n        int left = clamp((int)x - areaSize / 2, 0, textureView.Width - areaSize);\n        int top = clamp((int)y - areaSize / 2, 0, textureView.Height - areaSize);\n\n        RectF rectF = new RectF(left, top, left + areaSize, top + areaSize);\n        Matrix.MapRect(rectF);\n\n        return new Rect((int)System.Math.Round(rectF.Left), (int)System.Math.Round(rectF.Top), (int)System.Math.Round(rectF.Right), (int)System.Math.Round(rectF.Bottom));\n    }\n\n    private int clamp(int x, int min, int max)\n    {\n        if (x &gt; max)\n        {\n            return max;\n        }\n        if (x &lt; min)\n        {\n            return min;\n        }\n        return x;\n    }\n}\n</code></pre>\n\n<p>I've managed to convert most of it but I'm not sure how to properly use the AutoFocusCallback here. What should I do to call OnAutoFocus from my OnTouch event like in the java answer I linked above? </p>\n\n<p>After I attached the callback, then all I need to do is subscribe the OnTouch event to my page correct or...? </p>\n\n<p>For example, I tried: </p>\n\n<p><code>textureView.Click += OnTouch;</code> but 'no overload for 'OnTouch' matches delegate 'EventHandler'. Is there a specific event handler I need to use?</p>\n"}, {"tags": ["c#", "winforms", "scrollbar"], "answers": [{"comments": [{"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1480550334, "post_id": 40900345, "comment_id": 69014586, "body": "@HansPassant: It&#39;s how transforms are supposed to work, unless the<code>ScrollBarRenderer</code> resets (temporarily) the transformation matrix."}], "tags": [], "owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "is_accepted": true, "score": 0, "last_activity_date": 1480549905, "last_edit_date": 1480549905, "creation_date": 1480549848, "answer_id": 40900345, "question_id": 40900207, "link": "https://stackoverflow.com/questions/40900207/how-to-set-size-of-winform-scrollbar-arrow-inside-the-rectangle-c/40900345#40900345", "title": "How to set size of Winform Scrollbar Arrow inside the rectangle C#", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/zhc2xxtx(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Graphics.ScaleTransform Method</a> before drawing.</p>\n\n<pre><code>g.ScaleTransform(2, 2);\n</code></pre>\n\n<p>Now you can draw in double size (as an example).</p>\n"}], "owner": {"reputation": 23, "user_id": 1049425, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c398f3c44a634096595a80c71b5c240?s=128&d=identicon&r=PG", "display_name": "Priyam", "link": "https://stackoverflow.com/users/1049425/priyam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 40900345, "answer_count": 1, "score": 0, "last_activity_date": 1480549905, "creation_date": 1480548916, "question_id": 40900207, "link": "https://stackoverflow.com/questions/40900207/how-to-set-size-of-winform-scrollbar-arrow-inside-the-rectangle-c", "title": "How to set size of Winform Scrollbar Arrow inside the rectangle C#", "body": "<p>I am using \"DrawArrowButton\" method in my code and I can set the required size of the rectangle enclosing the Arrow but I cannot size the Arrow itself. My requirement is to increase the arrow height or width touch the rectangle side to side.\nI am using the below code but I do not know how to resize the arrow.</p>\n\n<pre><code>Graphics g;\nRectangle rectLeftDown = new Rectangle(this.SplitterRectangle.Location, new Size(width, height));\nScrollBarArrowButtonState button1State = ScrollBarArrowButtonState.LeftNormal;\nScrollBarRenderer.DrawArrowButton(g, rectLeftDown, button1State);\n</code></pre>\n"}, {"tags": ["c#", "sql", "linq"], "comments": [{"owner": {"reputation": 3435, "user_id": 2324535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfNbQ.jpg?s=128&g=1", "display_name": "Karel Tamayo", "link": "https://stackoverflow.com/users/2324535/karel-tamayo"}, "edited": false, "score": 0, "creation_date": 1480549360, "post_id": 40900060, "comment_id": 69014291, "body": "Are TableA and TableB related somehow? Or they are independent from each-other?"}, {"owner": {"reputation": 53, "user_id": 6539068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41463a20a5026b8e7cc12c3d5f032f29?s=128&d=identicon&r=PG&f=1", "display_name": "Triforce711", "link": "https://stackoverflow.com/users/6539068/triforce711"}, "edited": false, "score": 0, "creation_date": 1480549464, "post_id": 40900060, "comment_id": 69014334, "body": "They are independent."}, {"owner": {"reputation": 6408, "user_id": 5004822, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/55fd7e8e0dc744fc5feada06408b8a07?s=128&d=identicon&r=PG&f=1", "display_name": "SledgeHammer", "link": "https://stackoverflow.com/users/5004822/sledgehammer"}, "edited": false, "score": 0, "creation_date": 1480549722, "post_id": 40900060, "comment_id": 69014407, "body": "If you put partmasterids into a HashSet&lt;int&gt; (assuming PartNumber is an int), the look ups will be faster then using a list. You can just do HashSet&lt;int&gt;(...Distinct()). Try that and see if the performance is better."}, {"owner": {"reputation": 6408, "user_id": 5004822, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/55fd7e8e0dc744fc5feada06408b8a07?s=128&d=identicon&r=PG&f=1", "display_name": "SledgeHammer", "link": "https://stackoverflow.com/users/5004822/sledgehammer"}, "edited": false, "score": 0, "creation_date": 1480549904, "post_id": 40900060, "comment_id": 69014465, "body": "Another idea may be to get rid of the Where clause entirely and use .Except()."}], "answers": [{"tags": [], "owner": {"reputation": 2114, "user_id": 5623232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d415f90d71b25875885b8cfb4ec008?s=128&d=identicon&r=PG", "display_name": "NPras", "link": "https://stackoverflow.com/users/5623232/npras"}, "is_accepted": true, "score": 3, "last_activity_date": 1481856431, "last_edit_date": 1495535367, "creation_date": 1480550624, "answer_id": 40900446, "question_id": 40900060, "link": "https://stackoverflow.com/questions/40900060/linq-to-entities-performance-issue-with-where-and-contains/40900446#40900446", "title": "LINQ to Entities performance issue with Where and Contains", "body": "<p>From what I understand of your question, the equivalent in SQL would be something like</p>\n\n<pre><code>SELECT DISTINCT B.PartNumber AS MissingParts\nFROM TableB as B \nLEFT OUTER JOIN TableA as A ON B.PartNumber = A.PartNumber\nWHERE A.PartNumber IS NULL\n</code></pre>\n\n<p>Run that SQL and measure the time it takes. Without indexes, that's as fast as it's going to get. </p>\n\n<p>Now, if you really have to do it in EF, you'll need to do an equivalent statement, complete with the left join. Based on <a href=\"https://stackoverflow.com/a/5538637/5623232\">this question</a>, it would look something like this</p>\n\n<pre><code>var query = from b in TableB\n        join a in TableA on b.PartNumber equals a.PartNumber into joind\n        from existsInA in joind.DefaultIfEmpty()\n        where existsInA == null\n        select b.PartNumber;\n\nvar missingParts = query.Distinct().ToList();\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6539068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/41463a20a5026b8e7cc12c3d5f032f29?s=128&d=identicon&r=PG&f=1", "display_name": "Triforce711", "link": "https://stackoverflow.com/users/6539068/triforce711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 40900446, "answer_count": 1, "score": 2, "last_activity_date": 1481856431, "creation_date": 1480548127, "last_edit_date": 1480568757, "question_id": 40900060, "link": "https://stackoverflow.com/questions/40900060/linq-to-entities-performance-issue-with-where-and-contains", "title": "LINQ to Entities performance issue with Where and Contains", "body": "<p>Table A has - ID(PK), PartNumber, Code1, Code2</p>\n\n<p>Table B has - InventoryID(PK) PartNumber, Part, and a bunch of other columns.</p>\n\n<p>I need to get everything from Table B where Table B's PartNumber is NOT in Table A.</p>\n\n<p>Example: Table B has PartNumber 123. There is no PartNumber in Table A for 123. Get that row.</p>\n\n<p>What I currently have:</p>\n\n<pre><code>using (SomeEntity context = new SomeEntity())\n{\nvar partmasterids = context.PartsMasters.Select(x =&gt; x.PartNumber).Distinct().ToList();\nvar test = context.Parts.Where(x =&gt; !partmasterids.Contains(x.PartNumber)).ToList();\n}\n</code></pre>\n\n<p>I currently first get and select all the distinct part numbers from Table A.</p>\n\n<p>Then I check Table A and Table B's partnumbers and get each part from Table B where there that part number is not in Table A.</p>\n\n<p>There are about 11,000 records in table B and 200,000 records in table A.\nI should be getting about 9000 parts which are not in table A.</p>\n\n<p>I am running into huge performance issues with that second LINQ statement. If I do a .Take(100), that will even take around 20-30 seconds. Anything above 1000 will take way too long.</p>\n\n<p>Is there a better way to write this LINQ statement?</p>\n"}, {"tags": ["c#", "raspberry-pi", "windows-10-iot-core"], "answers": [{"tags": [], "owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "is_accepted": false, "score": 0, "last_activity_date": 1480570869, "creation_date": 1480570869, "answer_id": 40903363, "question_id": 40899934, "link": "https://stackoverflow.com/questions/40899934/check-if-multiple-buttons-are-pushed-windows-iot-with-raspberry-pi-3b/40903363#40903363", "title": "Check if multiple buttons are pushed Windows IoT with Raspberry PI 3B", "body": "<p>You can use GPIO <code>ValueChanged</code> to catch the button pressed event like this:</p>\n\n<pre><code>    _btnBlue = _gpioController.OpenPin(BTNBLUE);\n    _btnBlue.ValueChanged += btnValueChanged;\n\n    public void btnValueChanged(GpioPin pin, GpioPinValueChangedEventArgs e)\n    {\n        if (_btnBlue.Read() == GpioPinValue.Low)\n        {\n            isBlueButtonPressed = true;\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7213566, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/13d646d35dcb0e48af8f6565383856cb?s=128&d=identicon&r=PG&f=1", "display_name": "imsohateful", "link": "https://stackoverflow.com/users/7213566/imsohateful"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 347, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480570869, "creation_date": 1480547346, "last_edit_date": 1480561939, "question_id": 40899934, "link": "https://stackoverflow.com/questions/40899934/check-if-multiple-buttons-are-pushed-windows-iot-with-raspberry-pi-3b", "title": "Check if multiple buttons are pushed Windows IoT with Raspberry PI 3B", "body": "<p>I'm currently working with the Raspberry PI 3 with Windows 10 IoT and I'm trying to make the game 'Simon Says' in Visual Studio 2015. </p>\n\n<p>Everything is plugged in as followed:\n<a href=\"https://i.stack.imgur.com/oSN6D.png\" rel=\"nofollow noreferrer\">Fritzing image</a></p>\n\n<p>I got the LEDs working but I can't really figure out how to detect when a button is being pressed.</p>\n\n<p>Parts of the source code:</p>\n\n<p>Variables</p>\n\n<pre><code>    private const int BTNRED = 5;\n    private const int BTNBLUE = 6;\n    private const int BTNYELLOW = 13;\n    private const int BTNGREEN = 19;\n\n    private GpioPin _btnRed;\n    private GpioPin _btnBlue;\n    private GpioPin _btnYellow;\n    private GpioPin _btnGreen;\n\n    private Random rnd;\n    private static GpioController _gpioController;\n</code></pre>\n\n<p>Method to recognize when a button is being pressed.</p>\n\n<pre><code>    public static IList&lt;Step&gt; PressedButtons\n    {\n        get\n        {\n            List&lt;Step&gt; returnVal = new List&lt;Step&gt;();\n\n            if (GetMap._btnBlue.Read() == GpioPinValue.High)\n            { returnVal.Add(Step.Blue); }\n            if (GetMap._btnGreen.Read() == GpioPinValue.High)\n            { returnVal.Add(Step.Green); }\n            if (GetMap._btnRed.Read() == GpioPinValue.High)\n            { returnVal.Add(Step.Red); }\n            if (GetMap._btnYellow.Read() == GpioPinValue.High)\n            { returnVal.Add(Step.Yellow); }\n\n            return returnVal;\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// Checks if any of the 4 buttons is pressed.\n    /// &lt;/summary&gt;\n    /// &lt;returns&gt;Returns false if no button is pressed.&lt;/returns&gt;\n    public static bool isButtonPressed\n    {\n        get\n        {\n            if (GetMap._btnBlue.Read() == GpioPinValue.Low)\n            { return true; }\n            if (GetMap._btnGreen.Read() == GpioPinValue.Low)\n            { return true; }\n            if (GetMap._btnRed.Read() == GpioPinValue.Low)\n            { return true; }\n            if (GetMap._btnYellow.Read() == GpioPinValue.Low)\n            { return true; ; }\n\n            return false;\n        }\n    }\n</code></pre>\n\n<p>Assigning the right pins on the GPIO to the corresponding variables</p>\n\n<pre><code>    private GPIOMap()\n    {\n        rnd = new Random();\n        _gpioController = GpioController.GetDefault();\n        if (_gpioController == null) { return; }\n\n        _ledRed = _gpioController.OpenPin(LEDRED);\n        _ledRed.SetDriveMode(GpioPinDriveMode.Output);\n        _ledYellow = _gpioController.OpenPin(LEDYELLOW);\n        _ledYellow.SetDriveMode(GpioPinDriveMode.Output);\n        _ledGreen = _gpioController.OpenPin(LEDGREEN);\n        _ledGreen.SetDriveMode(GpioPinDriveMode.Output);\n        _ledBlue = _gpioController.OpenPin(LEDBLUE);\n        _ledBlue.SetDriveMode(GpioPinDriveMode.Output);\n\n        _btnBlue = _gpioController.OpenPin(BTNBLUE);\n        _btnGreen = _gpioController.OpenPin(BTNGREEN);\n        _btnRed = _gpioController.OpenPin(BTNRED);\n        _btnYellow = _gpioController.OpenPin(BTNYELLOW);\n\n    }\n    private static GPIOMap GPIOMapInstance;\n    public static GPIOMap GetMap\n    {\n        get\n        {\n            if (GPIOMapInstance == null || _gpioController == null)\n            { GPIOMapInstance = new GPIOMap(); }\n            return GPIOMapInstance;\n        }\n    }\n</code></pre>\n\n<p>Run game, where as you can see it should bring me to state 2 whenever a button is being pressed. However this isn't quite the case as the idle animation keeps on going on.</p>\n\n<pre><code>    private void RunGame()\n    {\n        while (_isRunning)\n        {\n            switch (_state)\n            {\n                //Idle state\n                case (0x01):\n                    //If any button is pressed, start the game.\n                    if (GPIOMap.isButtonPressed)\n                    {\n                        _state = 0x02;\n                        Task.Delay(500).Wait();\n                        GPIOMap.PlayStartAnimation();\n                        Task.Delay(1000).Wait();\n                        break;\n                    }\n\n                    //If nothing happens, continue playing the idle animation.\n                    GPIOMap.PlayIdleAnimationOnce();\n\n                    break;\n\n                //Playback state\n                case (0x02):\n                   //Play all the currently existing steps.\n                    for (int i = 0; i &lt;= _gameInstance.TotalSteps; i++)\n                    { GPIOMap.BlinkLight(_gameInstance.GetNextStep(), 500); }\n\n                    //Generate and play a new step.\n                    GPIOMap.BlinkLight(_gameInstance.GetNextStep(), 500);\n\n                    //Switch to the input state.\n                    _state = 0x03;\n                    //Set the start time for the input.\n                    _answerPending = DateTime.UtcNow;\n                    break;\n\n                //Input state\n                case (0x03):\n\n                    if(_gameInstance.CurrentStep &gt; MAXSTEPS)\n                    {\n                        //Win Game\n                        ResetGame();\n                        break;\n                    }\n\n                    //If the player waits too long before answering, lose the game.\n                    if ((DateTime.UtcNow - _answerPending) &gt; _timeout)\n                    {\n                        GPIOMap.ConfirmWrongAnswer();\n                        ResetGame();\n                        break;\n                    }\n\n                    //If there are no more steps to re-trace, go back to playback state.\n                    if (_gameInstance.CurrentStep &gt; _gameInstance.TotalSteps)\n                    { _gameInstance.ResetSteps(); _state = 0x02; break; }\n\n                    //If no buttons are pressed, keep polling.\n                    if (!GPIOMap.isButtonPressed) { break; }\n\n                    IList&lt;Step&gt; pressedButtons = GPIOMap.PressedButtons;\n                    //If anything but one button is pressed, lose the game.\n                    if (pressedButtons.Count != 1)\n                    {\n                        GPIOMap.ConfirmWrongAnswer();\n                        ResetGame();\n                        break;\n                    }\n\n                    if (_gameInstance.VerifyStep(pressedButtons[0]))\n                    {\n                        GPIOMap.BlinkLight(pressedButtons[0], 500);\n                    }\n                    else//Wrong step, end game\n                    {\n                        GPIOMap.ConfirmWrongAnswer();\n                        ResetGame();\n                        break;\n                    }\n                    break;\n            }\n        }\n    }\n</code></pre>\n\n<p>How can I get my source code to recognize when a button is being pressed so I can go to the next state which involves getting user input on the buttons.</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "razor"], "comments": [{"owner": {"reputation": 2320, "user_id": 5062791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17ae265babf339cb720c6448cb671bf?s=128&d=identicon&r=PG&f=1", "display_name": "ColinM", "link": "https://stackoverflow.com/users/5062791/colinm"}, "edited": false, "score": 0, "creation_date": 1480547271, "post_id": 40899882, "comment_id": 69013572, "body": "Two things: ensure the usings are at the top of the view file, and Clean + Build the application and see if the error still appears. Views can behave strangely at times"}, {"owner": {"reputation": 315, "user_id": 6577167, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72c6c471045ef70970581dbc219680d9?s=128&d=identicon&r=PG&f=1", "display_name": "Spider Man", "link": "https://stackoverflow.com/users/6577167/spider-man"}, "reply_to_user": {"reputation": 2320, "user_id": 5062791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17ae265babf339cb720c6448cb671bf?s=128&d=identicon&r=PG&f=1", "display_name": "ColinM", "link": "https://stackoverflow.com/users/5062791/colinm"}, "edited": false, "score": 0, "creation_date": 1480547468, "post_id": 40899882, "comment_id": 69013643, "body": "Yep the using statements are at the top of the file and I did a clean + build in the application. The error still appears."}, {"owner": {"reputation": 20764, "user_id": 233810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/668cc1cf0aac100c08dd986e4633162a?s=128&d=identicon&r=PG", "display_name": "Steve Danner", "link": "https://stackoverflow.com/users/233810/steve-danner"}, "edited": false, "score": 0, "creation_date": 1480552670, "post_id": 40899882, "comment_id": 69015257, "body": "Can you check your project&#39;s target framework/version as well as the supported frameworks of the <code>PagedList</code> package?"}, {"owner": {"reputation": 21842, "user_id": 6378815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/810b57a09174a18f7b91655115ce11a5?s=128&d=identicon&r=PG&f=1", "display_name": "Tetsuya Yamamoto", "link": "https://stackoverflow.com/users/6378815/tetsuya-yamamoto"}, "edited": false, "score": 0, "creation_date": 1480568369, "post_id": 40899882, "comment_id": 69019047, "body": "Check <code>Web.config</code> file inside Views directory to ensure <code>PagedList</code> and <code>PagedList.Mvc</code> namespaces/assembly references enlisted there. Sometimes Razor requires assembly reference to use namespace from DLL file other than local one."}], "owner": {"reputation": 315, "user_id": 6577167, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/72c6c471045ef70970581dbc219680d9?s=128&d=identicon&r=PG&f=1", "display_name": "Spider Man", "link": "https://stackoverflow.com/users/6577167/spider-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 581, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480547045, "creation_date": 1480547045, "question_id": 40899882, "link": "https://stackoverflow.com/questions/40899882/cannot-use-namespace-inside-razor-view-in-asp-net-mvc", "title": "Cannot use namespace inside razor view in asp.net mvc", "body": "<p>I have installed the nuget packages PagedList and PagedList.Mvc in my asp.net mvc application. I can use them inside the controller without any problem.</p>\n\n<pre><code>using PagedList;\nusing PagedList.Mvc;\n</code></pre>\n\n<p>However, I cannot use them in the view:</p>\n\n<pre><code>@using PagedList;\n@using PagedList.Mvc;\n</code></pre>\n\n<p>It gives the red squiggly lines with the following error - </p>\n\n<blockquote>\n  <p>The type of namespace name 'PagedList' could not be found (are you\n  missing a using directive or an assembly reference?)</p>\n</blockquote>\n\n<p>Please help.</p>\n"}, {"tags": ["c#", "azure", "ado.net", "botframework"], "comments": [{"owner": {"reputation": 627, "user_id": 6856458, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--ZrEJ-zJfxU/AAAAAAAAAAI/AAAAAAAAAK0/oPYd4A-f4Gg/photo.jpg?sz=128", "display_name": "Darthchai", "link": "https://stackoverflow.com/users/6856458/darthchai"}, "edited": false, "score": 0, "creation_date": 1480549051, "post_id": 40899841, "comment_id": 69014206, "body": "In your Azure setup, do you also have the database setup that is used by your Entity data model?  Check the app.config for your application to see what it&#39;s using for the connection.  You must also have a database setup in Azure(a sql server database most likely if that&#39;s what your data model is using)"}], "answers": [{"tags": [], "owner": {"reputation": 2037, "user_id": 384585, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7127d88b22518f086edc3f3edc6c24db?s=128&d=identicon&r=PG", "display_name": "Michael Washington", "link": "https://stackoverflow.com/users/384585/michael-washington"}, "is_accepted": false, "score": 1, "last_activity_date": 1480596046, "creation_date": 1480596046, "answer_id": 40910951, "question_id": 40899841, "link": "https://stackoverflow.com/questions/40899841/botframework-ado-net-entity-data-model-stopped-working-since-project-was-publish/40910951#40910951", "title": "BotFramework ADO.Net Entity Data Model stopped working since project was published to Azure", "body": "<p>You need to create a database in Azure. You cannot use a database in your App_Data folder. This article explains how to convert your database:\n<a href=\"http://aihelpwebsite.com/Blog/EntryId/13/Implementing-A-SQL-Server-Database-With-The-Microsoft-Bot-Framework\" rel=\"nofollow noreferrer\">Implementing A SQL Server Database With The Microsoft Bot Framework</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7233476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604829893d538df5f006d82320490490?s=128&d=identicon&r=PG&f=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/7233476/bruno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488022770, "creation_date": 1480546813, "last_edit_date": 1488022770, "question_id": 40899841, "link": "https://stackoverflow.com/questions/40899841/botframework-ado-net-entity-data-model-stopped-working-since-project-was-publish", "title": "BotFramework ADO.Net Entity Data Model stopped working since project was published to Azure", "body": "<p>I built a bot that I tested in my machine with the Bot Framework Channel Emulator.</p>\n\n<p>But now I get an error accessing the ADO.NET Entity Data Model (which didn\u2019t occur when I ran it in my local environment).</p>\n\n<p>I can access the classes but I can't see to get data from the tables.</p>\n\n<p>Publishing the project into Azure is not enough to ensure that the data is accessible?</p>\n"}, {"tags": ["c#", "wpf", "mvvm"], "answers": [{"tags": [], "owner": {"reputation": 5903, "user_id": 1046207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd238ef44734676e8b8fd549f35f0c83?s=128&d=identicon&r=PG", "display_name": "Esoteric Screen Name", "link": "https://stackoverflow.com/users/1046207/esoteric-screen-name"}, "is_accepted": false, "score": 0, "last_activity_date": 1480547400, "creation_date": 1480547400, "answer_id": 40899941, "question_id": 40899691, "link": "https://stackoverflow.com/questions/40899691/cross-updates-between-models-in-mvvm/40899941#40899941", "title": "Cross Updates between Models in MVVM", "body": "<p>Don't fire the PropertyChanged event unless the property has actually changed.</p>\n\n<pre><code>private ClassA _classA;\npublic ClassA classA\n{\n    get\n    {\n        return _classA;\n    }\n    set\n    {\n        if (_classA != value)\n        {\n            _classA = value;\n            if (PropertyChanged != null)\n            {\n                PropertyChanged(this, new PropertyChangedEventArgs(\"ClassA\"));\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>If your update methods actually return a different value every time, then you will need to either break the interdependency, or partition A and B such that they don't trigger each other's updates automatically (example: remove the event handlers and force a user to click a button to trigger simultaneous updates).</p>\n"}, {"tags": [], "owner": {"reputation": 6408, "user_id": 5004822, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/55fd7e8e0dc744fc5feada06408b8a07?s=128&d=identicon&r=PG&f=1", "display_name": "SledgeHammer", "link": "https://stackoverflow.com/users/5004822/sledgehammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1480550021, "creation_date": 1480550021, "answer_id": 40900368, "question_id": 40899691, "link": "https://stackoverflow.com/questions/40899691/cross-updates-between-models-in-mvvm/40900368#40900368", "title": "Cross Updates between Models in MVVM", "body": "<p>VMs should be independent. If you need to communicate between VMs, you can use the messenger pattern to send messages back and forth.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7110276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/833d2adf63d6782f0da6e524a551137a?s=128&d=identicon&r=PG&f=1", "display_name": "littlecloud47", "link": "https://stackoverflow.com/users/7110276/littlecloud47"}, "edited": false, "score": 0, "creation_date": 1480678556, "post_id": 40909981, "comment_id": 69073439, "body": "To be more specific :  It is exactly the Idea I had. If ClassA is a Kind of observableCollection and it can be modified. And at the same time we let the User the Option to work only on a current selected item of that Kind Of Observablecollection what Kind of possibilities do I have? In fact in A propertyGrid the User can Display all the elements available into the Collection then Add, remove, or Rework elements. The other Option he have is to modifiy only the current selected item, these modifications of the current Item influence the Whole elements in the Collection."}], "tags": [], "owner": {"reputation": 8866, "user_id": 5758420, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a47e2744f0e5b6f84407efd06dbee96f?s=128&d=identicon&r=PG&f=1", "display_name": "Haukinger", "link": "https://stackoverflow.com/users/5758420/haukinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1480681841, "last_edit_date": 1480681841, "creation_date": 1480593097, "answer_id": 40909981, "question_id": 40899691, "link": "https://stackoverflow.com/questions/40899691/cross-updates-between-models-in-mvvm/40909981#40909981", "title": "Cross Updates between Models in MVVM", "body": "<p>You update some property in class A and that triggers an update in class B and that (again) triggers an update in class A and so on? If that's the case, something's wrong with your model, and you're not going to solve it by whatever communication you implement between your view models, because your model is never in a stable state but oscillating as the updates happen. Either A or B is always outdated.</p>\n\n<p>If you can remove the oscillation and unify classes A and B into a model that has a stable state, then let view models A and B visualize that state, and update the visualization when the state changes in the model. The view models should update the model and the model should notify all interested view model (perhaps through <code>INotifyPropertyChanged</code>) when its state changes so they can updated themselves.</p>\n\n<p>EDIT: If the user edits the currently selected item, and then modifies the collection by adding or removing other items, just commit the edits to the selected item. If he edits the selected item and then deletes <em>that</em> from the collection, discard the changes... Nevertheless, you have to find a model where changes to one item cannot influence the collection and then have an effect back on the original item.</p>\n"}], "owner": {"reputation": 1, "user_id": 7110276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/833d2adf63d6782f0da6e524a551137a?s=128&d=identicon&r=PG&f=1", "display_name": "littlecloud47", "link": "https://stackoverflow.com/users/7110276/littlecloud47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1480681841, "creation_date": 1480546152, "last_edit_date": 1480680476, "question_id": 40899691, "link": "https://stackoverflow.com/questions/40899691/cross-updates-between-models-in-mvvm", "title": "Cross Updates between Models in MVVM", "body": "<p>when we speak about MVVM we speak about One Model that is used into the View Model to be displayed.\nI have two Models that are dependent from each other. I can't write exactly the whole code because it is a professionnal project but here it is explicit enough</p>\n\n<pre><code>  public MyClass TestClass{\n\n   //The constructor\n   public TestClass(){\n         _classB = new ClassB\n         _classB.PropertyChanged += EventHandlerClassB\n         _classA.PropertyChanged += EventHandlerClassA\n    }\n\n    private ClassB _classB;       \n\n    public ClassB ClassB\n    {\n        get\n        {\n            return _classB;\n        }\n        set\n        {\n            _classB = value;\n            if (PropertyChanged != null)\n            {\n                PropertyChanged(this, new PropertyChangedEventArgs(\"ClassB\"));\n            }\n\n\n    }\n\n    private ClassA _classA\n\n    public ClassA classA\n    {\n        get\n        {\n            return _classA;\n        }\n        set\n        {\n            _classA = value;\n            if (PropertyChanged != null)\n            {\n                PropertyChanged(this, new PropertyChangedEventArgs(\"ClassA\"));\n            }\n        }\n    }\n\n    //the Event Handler\n    private void EventHandlerClassB(object sender, PropertyChangedEventArgs e)\n {\n        if (PropertyChanged != null)\n        {\n            UpdateA();\n            PropertyChanged(this, new PropertyChangedEventArgs(e.PropertyName));\n       }\n\n    private void EventHandlerClassA (object sender, PropertyChangedEventArgs e)\n    {\n        if (PropertyChanged != null)\n        {\n            UpdateB();\n            PropertyChanged(this, new PropertyChangedEventArgs    (e.PropertyName));\n        }    \n\n    }\n\n}\n</code></pre>\n\n<p>Does Anybody have an Idea how to deal such Case? It creates an Infinity Loop.\nIn this case. Every properties from ClassA and From ClassB can Launch an Event with NotifyPropertyChangeEventHandler. </p>\n\n<p>I am gooing into an infinit Loops.</p>\n\n<p>Question Update:</p>\n\n<p>After working on it I would like to be more spefic :\nI have a PropertyGrid that Display two elements \n1) the whole ObservableCollection of Items where you add or remove elements</p>\n\n<p>2) the second elements who is displayed is only an item of \nthatObservableCollection.</p>\n\n<p>XAMl :</p>\n\n<pre><code>&lt;xctk:PropertyGrid x:Name=\"ModelA\" AutoGenerateProperties=\"true\" ShowSortOptions=\"True\" SelectedObject=\"{Binding Path=ModelA, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True, Mode=TwoWay}\" /&gt;\n</code></pre>\n\n<p>And ModelA contains :\n    ObservableCollection WholeAlements;\n    Items selectedItemA;</p>\n\n<p>I can now select every Items from the ObservableCollection, but when modifying selectedItems it should affect the others too. Who to do it? Everything works fine with the ObservableCollection but not with the selectedItemA</p>\n"}, {"tags": ["c#", "linq", "tuples", "c#-7.0"], "comments": [{"owner": {"reputation": 26818, "user_id": 209199, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0b64963e747bf4c8fc20fb379105f204?s=128&d=identicon&r=PG", "display_name": "Cory Nelson", "link": "https://stackoverflow.com/users/209199/cory-nelson"}, "edited": false, "score": 0, "creation_date": 1480546744, "post_id": 40899649, "comment_id": 69013362, "body": "LINQ integration wasn&#39;t very well thought out with C# 7, unfortunately."}], "answers": [{"comments": [{"owner": {"reputation": 213217, "user_id": 41071, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0ec0f5be7749c8cc8ccda4a809103f36?s=128&d=identicon&r=PG", "display_name": "svick", "link": "https://stackoverflow.com/users/41071/svick"}, "edited": false, "score": 1, "creation_date": 1480547023, "post_id": 40899763, "comment_id": 69013463, "body": "Indeed, <a href=\"http://tryroslyn.azurewebsites.net/#b:master/f:r/K4Zwlgdg5gBAygTxAFwKYFsB0AZSBHAbgCgiBjAGwEMQQYARMU5MAewkoCcEB1FjgEyIBvIjDEwAbizD8YAWQAUDJq3ZdeAgNoBdGAHc+/EAEpR4keMuTOMDqhDByyGAF4YAMw4t0+wzEi+AiBmVqHkqM4KfGBQkJTkADQwyByUECBUzGzGrjAAwmwSqBzICgYCpqFVIKjhTDDRsezkxJYAviEwnQooHJCwAPJ9TfFJvf0wACqp6ZmqOQUQRSVKjFlqPH7l/JXiAJAuAHww/KjulI6lPSn9YzfQxsbEbUA==\" rel=\"nofollow noreferrer\">it does not compile with the current Roslyn master</a>."}, {"owner": {"reputation": 3166, "user_id": 2670928, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/sHRwx.jpg?s=128&g=1", "display_name": "Random", "link": "https://stackoverflow.com/users/2670928/random"}, "edited": false, "score": 1, "creation_date": 1480586094, "post_id": 40899763, "comment_id": 69027297, "body": "Thank you. It&#39;s sad that it&#39;s still on a backlog"}], "tags": [], "owner": {"reputation": 59637, "user_id": 61989, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/23d0af63ab371e90fa713a96d3066d59?s=128&d=identicon&r=PG", "display_name": "Patrick McDonald", "link": "https://stackoverflow.com/users/61989/patrick-mcdonald"}, "is_accepted": true, "score": 22, "last_activity_date": 1502370309, "last_edit_date": 1502370309, "creation_date": 1480546451, "answer_id": 40899763, "question_id": 40899649, "link": "https://stackoverflow.com/questions/40899649/does-c-7-allow-to-deconstruct-tuples-in-linq-expressions/40899763#40899763", "title": "Does C# 7 allow to deconstruct tuples in linq expressions", "body": "<p>It seems not.</p>\n\n<p>There's an open issue for this on GitHub: <a href=\"https://github.com/dotnet/roslyn/issues/6877\" rel=\"noreferrer\">https://github.com/dotnet/roslyn/issues/6877</a></p>\n\n<p><strong>Edit</strong></p>\n\n<p>Issue moved to <a href=\"https://github.com/dotnet/csharplang/issues/355\" rel=\"noreferrer\">dotnet/csharplang#355</a></p>\n"}, {"tags": [], "owner": {"reputation": 3585, "user_id": 172315, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/Marnt.jpg?s=128&g=1", "display_name": "Julien Couvreur", "link": "https://stackoverflow.com/users/172315/julien-couvreur"}, "is_accepted": false, "score": 7, "last_activity_date": 1489290576, "creation_date": 1489290576, "answer_id": 42743533, "question_id": 40899649, "link": "https://stackoverflow.com/questions/40899649/does-c-7-allow-to-deconstruct-tuples-in-linq-expressions/42743533#42743533", "title": "Does C# 7 allow to deconstruct tuples in linq expressions", "body": "<p>Deconstruction in Linq queries isn't supported in C# 7.0.</p>\n\n<p>Only three forms of deconstruction made it into C# 7.0 (deconstruction in assignment, in \"foreach\" loop and in \"for\" loop). \nBut when the language design committee considered all the possible places that declare variables (and thus would be candidates for deconstruction) and prioritized them, the deconstruction in \"let\" (and possibly \"from\") clauses were next in line.</p>\n\n<p>Please make sure to leave a note or a thumbs up on <a href=\"https://github.com/dotnet/csharplang/issues/189\" rel=\"noreferrer\">https://github.com/dotnet/csharplang/issues/189</a> if you feel this would be useful.</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 7331261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1ABmD.jpg?s=128&g=1", "display_name": "Nuno Dias", "link": "https://stackoverflow.com/users/7331261/nuno-dias"}, "is_accepted": false, "score": 2, "last_activity_date": 1601463345, "creation_date": 1601463345, "answer_id": 64136109, "question_id": 40899649, "link": "https://stackoverflow.com/questions/40899649/does-c-7-allow-to-deconstruct-tuples-in-linq-expressions/64136109#64136109", "title": "Does C# 7 allow to deconstruct tuples in linq expressions", "body": "<p>You can do something like this:</p>\n<pre><code>public static (string Original, string Translation) Convert(string word)\n{\n    return (&quot;Hello&quot;, &quot;Hello translated&quot;);\n}\nstatic void Main(string[] args)\n{\n    List&lt;string&gt; words = new List&lt;string&gt;();\n    words.Add(&quot;Hello&quot;);\n\n    var result = from word in words\n                    select Convert(word).Translation;\n\n    Console.WriteLine(&quot;Hello, world!&quot; + result.FirstOrDefault());\n}\n</code></pre>\n"}], "owner": {"reputation": 3166, "user_id": 2670928, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/sHRwx.jpg?s=128&g=1", "display_name": "Random", "link": "https://stackoverflow.com/users/2670928/random"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4530, "favorite_count": 3, "accepted_answer_id": 40899763, "answer_count": 3, "score": 30, "last_activity_date": 1601463345, "creation_date": 1480545950, "last_edit_date": 1480546312, "question_id": 40899649, "link": "https://stackoverflow.com/questions/40899649/does-c-7-allow-to-deconstruct-tuples-in-linq-expressions", "title": "Does C# 7 allow to deconstruct tuples in linq expressions", "body": "<p>I'm trying to deconstruct a tuple inside a Linq expression</p>\n\n<pre><code>// somewhere inside another method\nvar result = from word in words\n             let (original, translation) = Convert(word)\n             select original\n</code></pre>\n\n<p>Here is a signature of the method returning a tuple</p>\n\n<pre><code>(string Original, string Translation) Convert(DictionaryWord word)\n{\n    // implementation\n}\n</code></pre>\n\n<p>But it's not a valid syntax. I can only access tuple values without deconstruction:</p>\n\n<pre><code>var result = from word in words\n             let result = GetWord(word, mode)\n             select result.Original\n</code></pre>\n\n<p>Is there a proper way to deconstruct it or it's not supported inside Linq expressions?</p>\n"}, {"tags": ["c#", "winforms", "visual-studio-2010"], "comments": [{"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1480546059, "post_id": 40899604, "comment_id": 69013087, "body": "You can have your array hardcoded in <code>public static class</code> but I suggest you serialize it using json and read it from json file."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1480546070, "post_id": 40899604, "comment_id": 69013092, "body": "why don&#39;t you create a separate static class for the byte[] that you are trying to use.. and create that class so that it will share the same namespace <code>ScrollWave</code>"}, {"owner": {"reputation": 2565, "user_id": 1108505, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a7e091fdb18efecace362189bc5f0bf5?s=128&d=identicon&r=PG", "display_name": "Tanner Swett", "link": "https://stackoverflow.com/users/1108505/tanner-swett"}, "edited": false, "score": 0, "creation_date": 1480554389, "post_id": 40899604, "comment_id": 69015681, "body": "Consider putting your data in a binary file and adding it as a resource. This will give you a <code>byte[]</code> property you can access called <code>Resources.wvSamps</code>. See <a href=\"https://msdn.microsoft.com/en-us/library/3bka19x4(v=vs.100).aspx\" rel=\"nofollow noreferrer\">How to: Add or Remove Resources</a>."}], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 5971508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dea6a989850a606fb1659e1b580860c?s=128&d=identicon&r=PG", "display_name": "Dale H.", "link": "https://stackoverflow.com/users/5971508/dale-h"}, "edited": false, "score": 0, "creation_date": 1480546731, "post_id": 40899707, "comment_id": 69013356, "body": "Ok, sorry, I&#39;m a real noob at Visual Studio, I assume I would create this class in another .cs file and add it to my project. I&#39;m using VS 2010 Express and I have tired and don&#39;t see how to add a file to my project. My learning is by reading Stephens C# Programming with Visual Studio 2010. Thanks for your help, if I can just get past some of this simple stuff I should be on my way."}, {"owner": {"reputation": 3435, "user_id": 2324535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfNbQ.jpg?s=128&g=1", "display_name": "Karel Tamayo", "link": "https://stackoverflow.com/users/2324535/karel-tamayo"}, "reply_to_user": {"reputation": 36, "user_id": 5971508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dea6a989850a606fb1659e1b580860c?s=128&d=identicon&r=PG", "display_name": "Dale H.", "link": "https://stackoverflow.com/users/5971508/dale-h"}, "edited": false, "score": 0, "creation_date": 1480546788, "post_id": 40899707, "comment_id": 69013371, "body": "@DaleH. just right click your project and select Add -&gt; New Item. Then search for class, set a name and click Add button."}], "tags": [], "owner": {"reputation": 3435, "user_id": 2324535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfNbQ.jpg?s=128&g=1", "display_name": "Karel Tamayo", "link": "https://stackoverflow.com/users/2324535/karel-tamayo"}, "is_accepted": false, "score": 1, "last_activity_date": 1480546234, "creation_date": 1480546234, "answer_id": 40899707, "question_id": 40899604, "link": "https://stackoverflow.com/questions/40899604/c-including-large-readonly-arrays-in-windows-forms/40899707#40899707", "title": "C# Including large readonly arrays in Windows Forms", "body": "<p>Just create a new class file named <code>ArrayData.cs</code> for instance and declare your data in that class as a static field:</p>\n\n<pre><code>public static class ArrayData\n{\n    public static byte[] WvSamps = {0x94, 0xa5, 0xca, 0x62, 0x41, 0x28, 0x4c, 0x93, 0x09, 0x42};\n}\n</code></pre>\n\n<p>Then you can use it in your Form:</p>\n\n<pre><code>public partial class Form1 : Form\n{\n    public void DoSomethingWithData()\n    {\n        for(var i = 0; i &lt; ArrayData.WvSamps.Length; i++)\n        {\n            //process your data here...\n        }\n    }\n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 36, "user_id": 5971508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dea6a989850a606fb1659e1b580860c?s=128&d=identicon&r=PG", "display_name": "Dale H.", "link": "https://stackoverflow.com/users/5971508/dale-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480546234, "creation_date": 1480545808, "question_id": 40899604, "link": "https://stackoverflow.com/questions/40899604/c-including-large-readonly-arrays-in-windows-forms", "title": "C# Including large readonly arrays in Windows Forms", "body": "<p>First off I'm new to C# and Windows Forms Programming. I've been a long time C embedded systems programmer.</p>\n\n<p>I'm writing a Winform program that I need to include a large (48Kb) array of readonly data for simulation. I have it at the top of my Form1 class declaration, the problem being it continues for 1500 lines like so before I get to my public Form1() code:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\n\nnamespace ScrollWave\n{\n    public partial class Form1 : Form\n    {\n        readonly byte[] wvSamps = \n        {\n            0x94, 0xa5, 0xca, 0x62, 0x41, 0x28, 0x4c, 0x93, 0x09, 0x42, 0x00, 0x25, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x04, 0x01, 0x40, 0x10, 0x00, 0x00, 0x70, 0x0d, 0x58, 0x3e, 0xc6, 0xd1, 0x07, 0x9c, \n            0x94, 0xa3, 0x8a, 0x62, 0x41, 0x29, 0x4c, 0x94, 0xc9, 0x32, 0x00, 0x24, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x04, 0x01, 0x40, 0x10, 0x00, 0x00, 0x70, 0x0d, 0x58, 0x3e, 0xc6, 0xd2, 0x08, 0x0c, \n</code></pre>\n\n<p>In 'C' I could just include it as an #include file so I didn't have to scroll down 1500 lines to get to the code I'm working on. How can I include large amounts of readonly data without having to put it at the top of my Form1 class declaration so I can avoid scrolling down 1500 lines to get to the code I'm working on? Thx!</p>\n"}, {"tags": ["c#", "report", "rdlc"], "comments": [{"owner": {"reputation": 127, "user_id": 598911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9858cb5055bf5acdbf9f39787c979600?s=128&d=identicon&r=PG", "display_name": "Spots Knight", "link": "https://stackoverflow.com/users/598911/spots-knight"}, "edited": false, "score": 0, "creation_date": 1480545747, "post_id": 40899587, "comment_id": 69012955, "body": "Or is there something else I should be looking at?"}, {"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480545783, "post_id": 40899587, "comment_id": 69012966, "body": "Try to add more details, where are you setting the source of the reports, etc"}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1480545894, "post_id": 40899587, "comment_id": 69013016, "body": "Check the documentation here <a href=\"https://msdn.microsoft.com/en-us/library/ms252067.aspx\" rel=\"nofollow noreferrer\">MSDN Creating Client Reporting</a>"}, {"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480545951, "post_id": 40899587, "comment_id": 69013039, "body": "Are the rdlc files set as Embedded Resource?"}, {"owner": {"reputation": 127, "user_id": 598911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9858cb5055bf5acdbf9f39787c979600?s=128&d=identicon&r=PG", "display_name": "Spots Knight", "link": "https://stackoverflow.com/users/598911/spots-knight"}, "edited": false, "score": 0, "creation_date": 1480546178, "post_id": 40899587, "comment_id": 69013143, "body": "Setting the datasource is the same for all the reports it is just different sql code that runs and that returns the data successfully.   How can I check if they are embedded Resources? I&#39;ve put them in the project folder and added them to the solution the same way I have for all the other reports. But it has been awhile since I&#39;ve had to add a new report so I&#39;m wondering if I missed a step somewhere."}, {"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480546456, "post_id": 40899587, "comment_id": 69013248, "body": "Perhaps there&#39;s a typo, we won&#39;t know, more details would help"}, {"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480546525, "post_id": 40899587, "comment_id": 69013279, "body": "You wonder if you missed a step somewhere, but you don&#39;t show what steps you have taken"}, {"owner": {"reputation": 127, "user_id": 598911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9858cb5055bf5acdbf9f39787c979600?s=128&d=identicon&r=PG", "display_name": "Spots Knight", "link": "https://stackoverflow.com/users/598911/spots-knight"}, "edited": false, "score": 0, "creation_date": 1480546928, "post_id": 40899587, "comment_id": 69013422, "body": "Step 1: Create the RDLC Step 2: Move the RDLC to the project Folder Step 3: Add the file to the Project Step 4: copy existing code to add a new report changing only the Sql being run to populate the data table and the lines of code above Step 5: try to run the report but get the error"}, {"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480547293, "post_id": 40899587, "comment_id": 69013584, "body": "Yeah, well that doesn&#39;t help much, I was expecting you to update your question with more CODE. I&#39;ll move on now."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 598911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9858cb5055bf5acdbf9f39787c979600?s=128&d=identicon&r=PG", "display_name": "Spots Knight", "link": "https://stackoverflow.com/users/598911/spots-knight"}, "edited": false, "score": 0, "creation_date": 1480617586, "post_id": 40900235, "comment_id": 69048244, "body": "Thank you! that is exactly what I was missing. I knew it had to be something simple I was missing. This is the first report I&#39;ve had to add as a new RDLC since upgrading VS. I guess the older version defaulted that value when I imported them."}, {"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480693151, "post_id": 40900235, "comment_id": 69082915, "body": "And that&#39;s exactly what I asked you in the comments above"}, {"owner": {"reputation": 2114, "user_id": 5623232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d415f90d71b25875885b8cfb4ec008?s=128&d=identicon&r=PG", "display_name": "NPras", "link": "https://stackoverflow.com/users/5623232/npras"}, "edited": false, "score": 0, "creation_date": 1480887121, "post_id": 40900235, "comment_id": 69137160, "body": "To be fair, he did then ask how to check if the report&#39;s Embedded, and nobody answered.."}], "tags": [], "owner": {"reputation": 2114, "user_id": 5623232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69d415f90d71b25875885b8cfb4ec008?s=128&d=identicon&r=PG", "display_name": "NPras", "link": "https://stackoverflow.com/users/5623232/npras"}, "is_accepted": true, "score": 2, "last_activity_date": 1480549147, "last_edit_date": 1592644375, "creation_date": 1480549147, "answer_id": 40900235, "question_id": 40899587, "link": "https://stackoverflow.com/questions/40899587/c-the-report-definition-has-not-been-specified/40900235#40900235", "title": "C# the report definition has not been specified", "body": "<p>Select the file in Solution Explorer and open its Properties (<code>Right-click &gt; Properties</code>, or <code>F4</code> or <code>Alt+Enter</code>). Ensure its <em>Build Action</em> is set to <em>Embedded Resource</em></p>\n<p><a href=\"https://i.imgur.com/VNowVKT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.imgur.com/VNowVKT.png\" alt=\"BuildAction\" /></a></p>\n"}], "owner": {"reputation": 127, "user_id": 598911, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9858cb5055bf5acdbf9f39787c979600?s=128&d=identicon&r=PG", "display_name": "Spots Knight", "link": "https://stackoverflow.com/users/598911/spots-knight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2054, "favorite_count": 0, "accepted_answer_id": 40900235, "answer_count": 1, "score": 0, "last_activity_date": 1480549147, "creation_date": 1480545699, "question_id": 40899587, "link": "https://stackoverflow.com/questions/40899587/c-the-report-definition-has-not-been-specified", "title": "C# the report definition has not been specified", "body": "<p>I have a report tool that displays a lot of RDLC reports and I'm trying to add a new one and I can't see what I'm missing. I have the report included in the Project (I see it along with all the other RDLC reports in the Solution exporer).</p>\n\n<p>This code for older reports works fine.</p>\n\n<pre><code>rvReports.LocalReport.ReportEmbeddedResource = \"paylocity.id.eStart.EditSummary.rdlc\";\n</code></pre>\n\n<p>However, this gives me the error that the report definition has not been specified.</p>\n\n<pre><code>rvReports.LocalReport.ReportEmbeddedResource = \"paylocity.id.eStart.EditSummaryByMngr.rdlc\";\n</code></pre>\n\n<p>I've double checked that the case is correct for the file I created. Can someone else see something I'm missing?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 2, "creation_date": 1480545085, "post_id": 40899417, "comment_id": 69012638, "body": "If the constructor was private you could never create the class from another class.  So  you can never start executing anything in the class."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1480545375, "post_id": 40899417, "comment_id": 69012769, "body": "Your question contains its own answer...you ask why the constructor is public, and then note that the code doesn&#39;t compile if it&#39;s private.  The constructor is public because the code wouldn&#39;t compile if it were private, exactly as you noted."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 1, "creation_date": 1480545666, "post_id": 40899417, "comment_id": 69012927, "body": "@jdweng But, you can.  It&#39;s a common enough pattern to have a private constructor with <code>public static</code> factory methods (or properties) to create/fetch instances of the class, or to have private constructors that are only ever called by other (less restrictively scoped) constructors."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1480578412, "post_id": 40899417, "comment_id": 69022960, "body": "Ok, you have to have at least one constructor that is public."}], "answers": [{"tags": [], "owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "is_accepted": false, "score": 0, "last_activity_date": 1480545063, "creation_date": 1480545063, "answer_id": 40899457, "question_id": 40899417, "link": "https://stackoverflow.com/questions/40899417/what-is-the-use-of-a-public-constructor-in-a-private-class/40899457#40899457", "title": "What is the use of a public constructor in a private class", "body": "<p>Because although the type is private and only available to the class it is contained in if you make the constructor private even the containing class could not call it (<em>without using reflection</em>).</p>\n"}, {"tags": [], "owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "is_accepted": false, "score": 0, "last_activity_date": 1480545226, "creation_date": 1480545226, "answer_id": 40899492, "question_id": 40899417, "link": "https://stackoverflow.com/questions/40899417/what-is-the-use-of-a-public-constructor-in-a-private-class/40899492#40899492", "title": "What is the use of a public constructor in a private class", "body": "<p>In adition to the other answers I think is good to remark this about private constructors:</p>\n\n<blockquote>\n  <p>A private constructor is a special instance constructor. It is\n  generally used in classes that contain static members only. If a class\n  has one or more private constructors and no public constructors, other\n  classes (except nested classes) cannot create instances of this class.</p>\n</blockquote>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/kcfb85a6.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/kcfb85a6.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "is_accepted": true, "score": 5, "last_activity_date": 1480548698, "last_edit_date": 1480548698, "creation_date": 1480545282, "answer_id": 40899505, "question_id": 40899417, "link": "https://stackoverflow.com/questions/40899417/what-is-the-use-of-a-public-constructor-in-a-private-class/40899505#40899505", "title": "What is the use of a public constructor in a private class", "body": "<blockquote>\n  <p>Why is it necessary to make the constructor of PrivateClass \"public\" or \"internal\" in order to construct an instance of PrivateClass in the the PublicClass's constructor?</p>\n</blockquote>\n\n<p>The PrivateClass is a nested class of the PublicClass, so the PublicClass has access to it just like any other field, property or method. And just like an <code>object</code> property or field, the access modifiers on the object's ctor, properties and methods are applicable to the PublicClass's access.</p>\n\n<pre><code>public sealed class PublicClass\n{\n    // this is private, but public class has access to it\n    private PrivateClass privateClass;\n\n    public PublicClass()\n    {\n      // can't be called, privateClass's ctor/method is private\n      // privateClass = newPrivateClass();\n\n      // can be called, this static method is public\n      privateClass = PrivateClass.GetInstance();\n\n      // can't be called, it's private\n      // privateClass.DoWork();\n    }\n\n    // this is private, but public class has access to it\n    private sealed class PrivateClass\n    {\n\n        private PrivateClass()\n        {\n        }\n\n        public static PrivateClass GetInstance()\n        {\n          // can be called within the class itself, it has\n          // access to private's (method, fields, properties, ctors)\n          return new PrivateClass();\n        }\n\n        private void DoWork() { }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 4955980, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jGdZi868oWk/AAAAAAAAAAI/AAAAAAAAABE/EviahVBIDfE/photo.jpg?sz=128", "display_name": "Roman Hapatyn", "link": "https://stackoverflow.com/users/4955980/roman-hapatyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1544198394, "last_edit_date": 1544198394, "creation_date": 1480545404, "answer_id": 40899535, "question_id": 40899417, "link": "https://stackoverflow.com/questions/40899417/what-is-the-use-of-a-public-constructor-in-a-private-class/40899535#40899535", "title": "What is the use of a public constructor in a private class", "body": "<p>In this case, you cannot mark it as protected because you use <code>sealed</code> - that means nobody can inherit from this class. To be able to create an instance of a class in this namespace you should use public or internal. You are not able to create this class in other namespaces.</p>\n"}], "owner": {"reputation": 1353, "user_id": 2585366, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/0040b5c5fe6551fce0bca404c31c4d4e?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2585366/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2090, "favorite_count": 0, "accepted_answer_id": 40899505, "answer_count": 4, "score": -1, "last_activity_date": 1544198394, "creation_date": 1480544894, "last_edit_date": 1480545372, "question_id": 40899417, "link": "https://stackoverflow.com/questions/40899417/what-is-the-use-of-a-public-constructor-in-a-private-class", "title": "What is the use of a public constructor in a private class", "body": "<p>I have the following class structure defined:</p>\n\n<pre><code>public sealed class PublicClass\n{\n    private PrivateClass privateClass;\n\n    public PublicClass()\n    {\n        this.privateClass = new PrivateClass();\n    }\n\n    private sealed class PrivateClass\n    {\n        public PrivateClass()\n        {\n        }\n    }\n}\n</code></pre>\n\n<p>Why is it necessary to make the constructor of PrivateClass \"public\" or \"internal\" in order to construct an instance of PrivateClass in the the PublicClass's constructor? Using \"protected\" or \"private\" modifiers on the PrivateClass constructor throw a compilation error.</p>\n"}, {"tags": ["c#", "selenium", "firefox"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 4449969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b05955b856343f9a83648509a7fe7c6a?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4449969/max"}, "edited": false, "score": 0, "creation_date": 1480545651, "post_id": 40899515, "comment_id": 69012916, "body": "So what you are saying is even if the element in &quot;inspect element&quot; does not show display: block, its defaulted to display block and I can look for it?"}, {"owner": {"reputation": 623, "user_id": 7099886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/188dd81ee2e58e254ba83508da122bf0?s=128&d=identicon&r=PG&f=1", "display_name": "Poloq", "link": "https://stackoverflow.com/users/7099886/poloq"}, "reply_to_user": {"reputation": 151, "user_id": 4449969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b05955b856343f9a83648509a7fe7c6a?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4449969/max"}, "edited": false, "score": 0, "creation_date": 1480546031, "post_id": 40899515, "comment_id": 69013076, "body": "No, but if they dont have style attribute in this case, you can use &quot;#pdp_size_select_container:not([style])&quot;"}, {"owner": {"reputation": 1091, "user_id": 7093031, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ba46c1253755506885314396604905ad?s=128&d=identicon&r=PG&f=1", "display_name": "Y-B Cause", "link": "https://stackoverflow.com/users/7093031/y-b-cause"}, "edited": false, "score": 0, "creation_date": 1480546172, "post_id": 40899515, "comment_id": 69013139, "body": "Yup but this is quite brittle: the element might have a style some day (color: red or anything not related to its display)"}], "tags": [], "owner": {"reputation": 623, "user_id": 7099886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/188dd81ee2e58e254ba83508da122bf0?s=128&d=identicon&r=PG&f=1", "display_name": "Poloq", "link": "https://stackoverflow.com/users/7099886/poloq"}, "is_accepted": false, "score": 0, "last_activity_date": 1480547252, "last_edit_date": 1480547252, "creation_date": 1480545321, "answer_id": 40899515, "question_id": 40899310, "link": "https://stackoverflow.com/questions/40899310/selenium-target-element-by-having-and-not-having-a-css-selector/40899515#40899515", "title": "Selenium Target Element by having and not having a css selector", "body": "<p>You can try to check if element have \"display: block;\" in style.\nSo selenium will wait until element will not change display to \"block\". </p>\n\n<p>Css selector will be:</p>\n\n<pre><code>\"#pdp_size_select_container[style*='display: block;']\"\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Better use:</p>\n\n<pre><code>\"#pdp_size_select_container:not([style*='display: none;'])\"\n</code></pre>\n\n<p>This selector will work if style have not display at all. Or use solution from Y-B Cause.</p>\n"}, {"comments": [{"owner": {"reputation": 151, "user_id": 4449969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b05955b856343f9a83648509a7fe7c6a?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4449969/max"}, "edited": false, "score": 0, "creation_date": 1480546588, "post_id": 40899675, "comment_id": 69013305, "body": "Can you put that in terms of (By.?(&quot;&quot;) I am a little new"}, {"owner": {"reputation": 1091, "user_id": 7093031, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ba46c1253755506885314396604905ad?s=128&d=identicon&r=PG&f=1", "display_name": "Y-B Cause", "link": "https://stackoverflow.com/users/7093031/y-b-cause"}, "reply_to_user": {"reputation": 151, "user_id": 4449969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b05955b856343f9a83648509a7fe7c6a?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4449969/max"}, "edited": false, "score": 0, "creation_date": 1480552971, "post_id": 40899675, "comment_id": 69015334, "body": "Of course. This is: <code>By.xpath(&quot;&#47;&#47;div[not(contains(@style, &#39;display: none&#39;))][id=&#39;pdp_size_select_container&#39;]&quot;)</code>"}], "tags": [], "owner": {"reputation": 1091, "user_id": 7093031, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ba46c1253755506885314396604905ad?s=128&d=identicon&r=PG&f=1", "display_name": "Y-B Cause", "link": "https://stackoverflow.com/users/7093031/y-b-cause"}, "is_accepted": false, "score": 0, "last_activity_date": 1480546086, "creation_date": 1480546086, "answer_id": 40899675, "question_id": 40899310, "link": "https://stackoverflow.com/questions/40899310/selenium-target-element-by-having-and-not-having-a-css-selector/40899675#40899675", "title": "Selenium Target Element by having and not having a css selector", "body": "<p>This xpath will show you the buttons that don't have the attribute style='display: none'. </p>\n\n<pre><code>//div[not(contains(@style, 'display: none'))][id='pdp_size_select_container']\n</code></pre>\n\n<p>It will also work will button having several styles, like:</p>\n\n<pre><code>style='display: none; foo: bar; ceci: cel\u00e0'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1358, "user_id": 3820556, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/a7b8a78218a9fcce7916d1ac4ff62406?s=128&d=identicon&r=PG&f=1", "display_name": "Dazed", "link": "https://stackoverflow.com/users/3820556/dazed"}, "is_accepted": false, "score": 0, "last_activity_date": 1480549692, "creation_date": 1480549692, "answer_id": 40900323, "question_id": 40899310, "link": "https://stackoverflow.com/questions/40899310/selenium-target-element-by-having-and-not-having-a-css-selector/40900323#40900323", "title": "Selenium Target Element by having and not having a css selector", "body": "<p>You could use the below method and call it like the below. Then add your next step for what you want it to do once that xpath is displayed correctly.</p>\n\n<pre><code>         WaitForElementToNotExist(\"//myxpath']\",20, SeleniumDriver);\n\n\n         public static void WaitForElementToNotExist(string xpath, int seconds, IWebDriver driver)\n    {\n        WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(seconds));\n        wait.Until&lt;bool&gt;((d) =&gt;\n        {\n            try\n            {\n                // If the find succeeds, the element exists, and\n                // we want the element to *not* exist, so we want\n                // to return true when the find throws an exception.\n                IWebElement element = d.FindElement(By.XPath(xpath));\n                return false;\n            }\n            catch (NoSuchElementException)\n            {\n                return true;\n            }\n        });\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 2608971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681e5a9836c31208478373086b89132b?s=128&d=identicon&r=PG", "display_name": "shivansh", "link": "https://stackoverflow.com/users/2608971/shivansh"}, "is_accepted": false, "score": 0, "last_activity_date": 1480550444, "creation_date": 1480550444, "answer_id": 40900424, "question_id": 40899310, "link": "https://stackoverflow.com/questions/40899310/selenium-target-element-by-having-and-not-having-a-css-selector/40900424#40900424", "title": "Selenium Target Element by having and not having a css selector", "body": "<p>I believe all you need to do is change your wait condition to ElementIsVisible</p>\n\n<p>As long as the effective style of the element is 'display:none', the check would return false.</p>\n\n<pre><code>new WebDriverWait(driver, TimeSpan.FromMinutes(10)).Until(ExpectedConditions.ElementIsVisible((By.Id(\"pdp_size_select_container\"))));\n    IWebElement sizeselect = driver.FindElement(By.Id(\"pdp_size_select_container\"));\n    sizeselect.Click();\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 4449969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b05955b856343f9a83648509a7fe7c6a?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4449969/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 741, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1480550444, "creation_date": 1480544423, "question_id": 40899310, "link": "https://stackoverflow.com/questions/40899310/selenium-target-element-by-having-and-not-having-a-css-selector", "title": "Selenium Target Element by having and not having a css selector", "body": "<p>I want to click a button as soon as it does not have the selector \"style: display-none\"</p>\n\n<pre><code>&lt;div style=\"display: none;\" id=\"pdp_size_select_container\" class=\"select_size float_left\" title=\"Select a Size\"&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Right now, selenium is finding the <strong>button</strong> itself, but it is trying to click and of course nothing happens because it is not available.</p>\n\n<pre><code>new WebDriverWait(driver, TimeSpan.FromMinutes(10)).Until(ExpectedConditions.ElementExists((By.Id(\"pdp_size_select_container\"))));\n        IWebElement sizeselect = driver.FindElement(By.Id(\"pdp_size_select_container\"));\n        sizeselect.Click();\n</code></pre>\n\n<blockquote>\n  <p>I want a way to search for an element that <em>has</em> the ID, and <em>doesn't have</em> the selector style=\"display: none;\".</p>\n</blockquote>\n\n<p>If you are confused, there is a hidden button on the web page. At a certain time, it will be available for you to click. But I am loop checking for that time, and I want to loop check with WEBDRIVERWAIT for the button when its style selector disappears.</p>\n\n<p>This is the code  when it is actually available, wheras above it was the code when it was unavailable.</p>\n\n<pre><code>&lt;div style=\"display: none;\" id=\"pdp_size_select_container\" class=\"select_size float_left\" title=\"Select a Size\"&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["c#", ".net", "entity-framework"], "comments": [{"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480544178, "post_id": 40899185, "comment_id": 69012230, "body": "Create a composite key"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7163772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/t5I7O.jpg?s=128&g=1", "display_name": "Katniss", "link": "https://stackoverflow.com/users/7163772/katniss"}, "edited": false, "score": 0, "creation_date": 1480548399, "post_id": 40899299, "comment_id": 69013952, "body": "Thank you very much :) After your comment I found how to do this"}], "tags": [], "owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "is_accepted": true, "score": 0, "last_activity_date": 1480544377, "creation_date": 1480544377, "answer_id": 40899299, "question_id": 40899185, "link": "https://stackoverflow.com/questions/40899185/table-connecting-other-tables-entity-framework-error-6002-no-primary-key/40899299#40899299", "title": "Table connecting other tables. Entity Framework - error 6002: no primary key", "body": "<p>You can create a primary composite key</p>\n\n<pre><code>public class YourEntity\n{\n [Column(Order = 0), Key, ForeignKey(\"FieldFromAnotherTable_1\")]\n public int FieldFromAnotherTable_1_ID { get; set; }\n\n [Column(Order = 1), Key, ForeignKey(\"FieldFromAnotherTable_2\")]\n public int FieldFromAnotherTable_2_ID { get; set; }\n\n public virtual Type1 FieldFromAnotherTable_1{ get; set; }\n public virtual Type2 FieldFromAnotherTable_2{ get; set; }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 4955980, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jGdZi868oWk/AAAAAAAAAAI/AAAAAAAAABE/EviahVBIDfE/photo.jpg?sz=128", "display_name": "Roman Hapatyn", "link": "https://stackoverflow.com/users/4955980/roman-hapatyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1480544395, "last_edit_date": 1495539940, "creation_date": 1480544395, "answer_id": 40899303, "question_id": 40899185, "link": "https://stackoverflow.com/questions/40899185/table-connecting-other-tables-entity-framework-error-6002-no-primary-key/40899303#40899303", "title": "Table connecting other tables. Entity Framework - error 6002: no primary key", "body": "<p>You can mark those ID`s from other tables with a Key attribute. EF would see this and make a primary key from those columns.</p>\n\n<p>Also, you can read this article <a href=\"https://stackoverflow.com/questions/14873169/creating-composite-key-entity-framework\">Creating Composite Key Entity Framework</a></p>\n"}], "owner": {"reputation": 7, "user_id": 7163772, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/t5I7O.jpg?s=128&g=1", "display_name": "Katniss", "link": "https://stackoverflow.com/users/7163772/katniss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 40899299, "answer_count": 2, "score": 0, "last_activity_date": 1480544395, "creation_date": 1480543948, "question_id": 40899185, "link": "https://stackoverflow.com/questions/40899185/table-connecting-other-tables-entity-framework-error-6002-no-primary-key", "title": "Table connecting other tables. Entity Framework - error 6002: no primary key", "body": "<p>I have got table connecting other tables. Entity Framework wants a primary key. I'd like this table have only ID from other tables without additional primary key. What should I do to fix this error? </p>\n"}, {"tags": ["c#", ".net", "orm", "npoco"], "comments": [{"owner": {"reputation": 4426, "user_id": 4271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Hjl2c.jpg?s=128&g=1", "display_name": "Rikalous", "link": "https://stackoverflow.com/users/4271/rikalous"}, "edited": false, "score": 0, "creation_date": 1480602807, "post_id": 40899139, "comment_id": 69038684, "body": "Check your stored proc - it&#39;s probably returning duplicate rows."}, {"owner": {"reputation": 111, "user_id": 4535039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670ae3046bb7b8a668ee168660fd4541?s=128&d=identicon&r=PG&f=1", "display_name": "LewisW", "link": "https://stackoverflow.com/users/4535039/lewisw"}, "reply_to_user": {"reputation": 4426, "user_id": 4271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Hjl2c.jpg?s=128&g=1", "display_name": "Rikalous", "link": "https://stackoverflow.com/users/4271/rikalous"}, "edited": false, "score": 0, "creation_date": 1480609654, "post_id": 40899139, "comment_id": 69043468, "body": "That would definitely do it, but this row was only returning 1 row.  I found a duplicate property in the PhoneNumber object.  I thought I had looked over this, but I think lack of sleep got me. Thank you for your response!"}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 4535039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670ae3046bb7b8a668ee168660fd4541?s=128&d=identicon&r=PG&f=1", "display_name": "LewisW", "link": "https://stackoverflow.com/users/4535039/lewisw"}, "is_accepted": true, "score": 1, "last_activity_date": 1480609602, "creation_date": 1480609602, "answer_id": 40915631, "question_id": 40899139, "link": "https://stackoverflow.com/questions/40899139/npoco-system-argumentexception-an-item-with-the-same-key-has-already-been-adde/40915631#40915631", "title": "NPOCO &#39;System.ArgumentException: An item with the same key has already been added.&#39;", "body": "<p>I found the issue.  I went back over my PhoneNumber object, which I thought I had looked at previously, but missed a duplicate property.  It appears there was an issue with case-sensitivity and the property name 6 years back.  I removed the duplicate and it's working fine. </p>\n"}], "owner": {"reputation": 111, "user_id": 4535039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670ae3046bb7b8a668ee168660fd4541?s=128&d=identicon&r=PG&f=1", "display_name": "LewisW", "link": "https://stackoverflow.com/users/4535039/lewisw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 40915631, "answer_count": 1, "score": 1, "last_activity_date": 1480609602, "creation_date": 1480543718, "question_id": 40899139, "link": "https://stackoverflow.com/questions/40899139/npoco-system-argumentexception-an-item-with-the-same-key-has-already-been-adde", "title": "NPOCO &#39;System.ArgumentException: An item with the same key has already been added.&#39;", "body": "<p>I am attempting to use NPoco to Query a stored procedure and retrieve a list of Phone numbers.  Below is my code, but my issue is every time dc.QueryStoredProcedure is called I receive an error 'System.ArgumentException: An item with the same key has already been added.' </p>\n\n<p>I have executed the sprocs without fail.  I have attempted Google but I'm unable to find anything regarding Npoco and this error message.  I'm stumped at this point.  I've checked over PhoneNumber object just to be sure there was nothing duplicated.  </p>\n\n<p>Any pointers would be greatly appreciated! Thank you.</p>\n\n<pre><code>    private List&lt;PhoneNumber&gt; GetPhoneNumberFromDL(int? MemberID, int? MemberIDPhoneNumber)\n    {\n        var TheList = new List&lt;PhoneNumber&gt;();\n\n        var parameters = new[] \n            {\n                new Parameter(\"MemberID\", MemberID),\n                new Parameter(\"MemberIDPhoneNumber\", MemberIDPhoneNumber)\n\n            };\n\n\n       using (var dc = this._DataProvider.AlphaDatabase())\n\n            {\n               var results = dc.QueryStoredProcedure&lt;PhoneNumber&gt;(\"phone_num_GET\", parameters);\n\n               TheList.AddRange(results);\n\n               return TheList;\n            }\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "visual-studio", "listview", "drag-and-drop"], "owner": {"reputation": 11, "user_id": 7233122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a0f1bd7b9de36d73028a864c0af5c9?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kinney", "link": "https://stackoverflow.com/users/7233122/daniel-kinney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480543538, "creation_date": 1480543538, "question_id": 40899098, "link": "https://stackoverflow.com/questions/40899098/drag-and-drop-list-item-from-one-listview-to-another-and-update-in-database-depe", "title": "Drag and Drop List Item from one ListView to another and update in database depending on where item is dropped", "body": "<p>Attempting to create a Storyboard in which user stories (list item) can be dragged and dropped from one ListView to another. Depending on which ListView the item is dropped into, the item's status is then updated in database.</p>\n\n<p>Below are the data sources for each list view. Items from database displayed in corresponding ListView based on the status field. Status can be one of four: NULL, Started, Blocked, Completed</p>\n\n<pre><code>    &lt;asp:SqlDataSource ID=\"return_stories\" runat=\"server\" ConnectionString='&lt;%$ ConnectionStrings:Scrumdog_Millionaire.Properties.Settings.DB_CONN %&gt;'\n            SelectCommand=\"SELECT stories.storyID, stories.sprintID, stories.story_name, stories.status, users.first_name FROM stories INNER JOIN users ON stories.userID = users.userID WHERE stories.status IS NULL\"&gt;\n        &lt;/asp:SqlDataSource&gt; \n\n        &lt;asp:SqlDataSource ID=\"return_started_stories\" runat=\"server\" ConnectionString='&lt;%$ ConnectionStrings:Scrumdog_Millionaire.Properties.Settings.DB_CONN %&gt;'\n            SelectCommand=\"SELECT stories.storyID, stories.sprintID, stories.story_name, stories.status, users.first_name FROM stories INNER JOIN users ON stories.userID = users.userID WHERE stories.status='Started'\"&gt;\n        &lt;/asp:SqlDataSource&gt; \n\n        &lt;asp:SqlDataSource ID=\"return_blocked_stories\" runat=\"server\" ConnectionString='&lt;%$ ConnectionStrings:Scrumdog_Millionaire.Properties.Settings.DB_CONN %&gt;'\n            SelectCommand=\"SELECT stories.storyID, stories.sprintID, stories.story_name, stories.status, stories.blocked_description, users.first_name FROM stories INNER JOIN users ON stories.userID = users.userID WHERE stories.status='Blocked'\"&gt;\n        &lt;/asp:SqlDataSource&gt; \n\n         &lt;asp:SqlDataSource ID=\"return_complete_stories\" runat=\"server\" ConnectionString='&lt;%$ ConnectionStrings:Scrumdog_Millionaire.Properties.Settings.DB_CONN %&gt;'\n            SelectCommand=\"SELECT stories.storyID, stories.sprintID, stories.story_name, stories.status, stories.blocked_description, users.first_name FROM stories INNER JOIN users ON stories.userID = users.userID WHERE stories.status='Completed'\"&gt;\n        &lt;/asp:SqlDataSource&gt; \n</code></pre>\n\n<p>Example of one of the ListViews:</p>\n\n<pre><code>    &lt;div class=\"pure-u-1 pure-u-md-1-3\"&gt;\n        &lt;div class=\"pricing-table pricing-table-biz pricing-table-selected\"&gt;\n            &lt;div class=\"pricing-table-header\"&gt;\n                &lt;h2&gt;Started&lt;/h2&gt;\n            &lt;/div&gt;\n\n            &lt;ul class=\"pricing-table-list\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\" dropzone=\"true\" data-autodividers=\"true\"&gt;\n\n                &lt;asp:ListView ID=\"display_started_stories\" runat=\"server\" DataSourceID=\"return_started_stories\"&gt;\n                &lt;EmptyDataTemplate&gt;\n                    &lt;span&gt;Currently no stories for this sprint with status set to 'Started'.&lt;/span&gt;\n                &lt;/EmptyDataTemplate&gt;\n                &lt;ItemTemplate&gt;\n                     &lt;div class=\"block\" style=\"width: 150px; background-color: lightgreen; padding: 10px; margin: 10px\" draggable=\"true\" ondragstart=\"dragStart(event)\"&gt;\n                    &lt;li&gt;\n                         &lt;asp:Label Text='&lt;%# String.Format(\"&lt;b&gt;Task:&lt;/b&gt;{0}  &lt;b&gt;Assigned To:&lt;/b&gt; {1}\", Eval(\"story_name\"), Eval(\"first_name\")) %&gt;' runat=\"server\" ID=\"story_startedlabel\" draggable=\"true\" ondragstart=\"dragStart(event)\"/&gt;\n                    &lt;/li&gt;\n                   &lt;/div&gt;\n                &lt;/ItemTemplate&gt;\n            &lt;/asp:ListView&gt;\n                &lt;/ul&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>Using javascript I have so far been able to drag items between lists however I am unsure how to trigger an update method in code behind file. Also uncertain whether best option is to use ondrop or ondragenter Event.</p>\n\n<pre><code>        &lt;script&gt;\n    function dragStart(event) {\n        event.dataTransfer.setData(\"text/plain\", event.target.id);\n        document.getElementById(\"demo\").innerHTML = \"Started to drag the selected story\";\n    }\n\n    function allowDrop(event) {\n        event.preventDefault();\n    }\n\n    function drop(event) {\n        event.preventDefault();\n        var data = event.dataTransfer.getData(\"text/plain\");\n        event.target.appendChild(document.getElementById(data));\n        document.getElementById(\"demo\").innerHTML = \"The story was dropped\";\n        document.getElementById(\"story_blockedlabel\").ondragleave();\n    }\n    function myFunction(variable) {\n        var s = document.getElementById(variable);\n        s.value = \"Started\";\n    }\n    myFunction(\"story_blockedlabel\");\n&lt;/script&gt;\n</code></pre>\n\n<p>First time using stackoverflow so I apologize in advance if my description is too vague. Any help would be much appreciated or another suggestions on how to achieve this functionality would be much appreciated.<a href=\"https://i.stack.imgur.com/wKI4R.png\" rel=\"nofollow noreferrer\">Image of current HTML when rendered</a></p>\n"}, {"tags": ["c#", "validation", "fluentvalidation", "object-graph"], "comments": [{"owner": {"reputation": 1376, "user_id": 3728624, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/nXbZm.jpg?s=128&g=1", "display_name": "Edgars Pivovarenoks", "link": "https://stackoverflow.com/users/3728624/edgars-pivovarenoks"}, "edited": false, "score": 0, "creation_date": 1481092132, "post_id": 40899009, "comment_id": 69229220, "body": "I created code sample so discussion is a bit easier, check it out it&#39;s just basic building blocks."}], "answers": [{"tags": [], "owner": {"reputation": 1376, "user_id": 3728624, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/nXbZm.jpg?s=128&g=1", "display_name": "Edgars Pivovarenoks", "link": "https://stackoverflow.com/users/3728624/edgars-pivovarenoks"}, "is_accepted": false, "score": 0, "last_activity_date": 1481092094, "creation_date": 1481092094, "answer_id": 41010825, "question_id": 40899009, "link": "https://stackoverflow.com/questions/40899009/alternate-way-to-validate-grandchild-object-in-aggregate/41010825#41010825", "title": "Alternate way to validate grandchild object in aggregate?", "body": "<p>I tried to put together your case in code, so we could work on it and find a solution. </p>\n\n<pre><code>using FluentValidation;\nnamespace FluentDemo\n{\n    class Program\n    {\n        static void Main(string[] args) \n        {\n            // TODO\n        }\n    }\n    class A\n    {\n        public string MyProperty { get; set; }\n    }\n    class B\n    {\n        public string OtherProperty { get; set; }\n        public A A { get; set; }\n    }\n    class C\n    {\n        public string DifferentProperty { get; set; }\n        public B B { get; set; }\n    }\n    class AValidator : AbstractValidator&lt;A&gt;\n    {\n        public AValidator()\n        {\n            RuleFor(a =&gt; a.MyProperty)\n                .NotNull(); \n        }\n    }\n    class BValidator : AbstractValidator&lt;B&gt;\n    {\n        public BValidator(IValidator&lt;A&gt; aValidator)\n        {\n            RuleFor(b =&gt; b.OtherProperty)\n                .NotNull();\n\n            RuleFor(b =&gt; b.A)\n                .SetValidator(aValidator);\n        }\n    }\n    class CValidator : AbstractValidator&lt;C&gt;\n    {\n        public CValidator(IValidator&lt;B&gt; bValidator)\n        {\n            RuleFor(c =&gt; c.DifferentProperty)\n                .NotNull();\n\n            RuleFor(c =&gt; c.B)\n                .SetValidator(bValidator);\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 14634, "user_id": 64348, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/h3b3u.png?s=128&g=1", "display_name": "Kit", "link": "https://stackoverflow.com/users/64348/kit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1481092094, "creation_date": 1480543241, "last_edit_date": 1495541324, "question_id": 40899009, "link": "https://stackoverflow.com/questions/40899009/alternate-way-to-validate-grandchild-object-in-aggregate", "title": "Alternate way to validate grandchild object in aggregate?", "body": "<p>I have a graph of objects more than two levels deep. It represents an entity with children and grandchildren (an <a href=\"http://martinfowler.com/bliki/DDD_Aggregate.html\" rel=\"nofollow noreferrer\">aggregate</a>):</p>\n\n<pre><code>A \u2192 B \u2192 C\n</code></pre>\n\n<p>I want to validate at all levels of the graph. I know I can access <strong>A</strong> when validating <strong>B</strong> using an overload of <a href=\"https://stackoverflow.com/questions/7701612/fluentvalidation-validating-across-multiple-properties/7718901#7718901\"><code>Must()</code></a> or using a <code>Custom()</code> rule. I haven't figured out how to use these two techniques for accessing <strong>A</strong> from <strong>C</strong>'s validator because there appears to be no context for that.</p>\n\n<p>The only way I was able to do what I wanted was to create a new object that is a flattened representation. In other words create a wrapper that places <strong>A</strong> and <strong>C</strong> on the same level, which allows me to use the <code>Must()</code> overload on <strong>C</strong> to get to <strong>A</strong> on the pseudo-parent <strong>Wrapper</strong>.</p>\n\n<pre><code>Wrapper \u2192 A \u2192 B \u2192 C\n        \u2192 C\n</code></pre>\n\n<p>The problem is that I have to create yet another validator (for <strong>Wrapper</strong> in this case). I'd prefer to keep all my validation logic for a particular thing together.</p>\n\n<p>Is there another way?</p>\n"}, {"tags": ["c#", "linq", "list"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1480543137, "post_id": 40898936, "comment_id": 69011765, "body": "Use two variables instead of one.  You have Items = Items.Where(.....) so you are loosing the original data.  Make the output variable a different name."}, {"owner": {"reputation": 27488, "user_id": 1778465, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NxIPr.jpg?s=128&g=1", "display_name": "Get Off My Lawn", "link": "https://stackoverflow.com/users/1778465/get-off-my-lawn"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1480543249, "post_id": 40898936, "comment_id": 69011815, "body": "Then how do I apply that to the original items?"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1480543804, "post_id": 40898936, "comment_id": 69012072, "body": "You can&#39;t have your cake and eat it too.  You can&#39;t keep the old values and the new value in a single variable unless you add another property which is set when a match is found."}], "answers": [{"tags": [], "owner": {"reputation": 35505, "user_id": 1394631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ajAkr.jpg?s=128&g=1", "display_name": "octavioccl", "link": "https://stackoverflow.com/users/1394631/octavioccl"}, "is_accepted": true, "score": 3, "last_activity_date": 1480543307, "creation_date": 1480543307, "answer_id": 40899031, "question_id": 40898936, "link": "https://stackoverflow.com/questions/40898936/apply-a-callback-to-a-list-of-items-with-linq/40899031#40899031", "title": "Apply a callback to a list of items with LINQ", "body": "<p>I think you could do this:</p>\n\n<pre><code> Items= Items.Select(e=&gt;query(e)?callback(e):e).ToList();\n</code></pre>\n"}], "owner": {"reputation": 27488, "user_id": 1778465, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NxIPr.jpg?s=128&g=1", "display_name": "Get Off My Lawn", "link": "https://stackoverflow.com/users/1778465/get-off-my-lawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 40899031, "answer_count": 1, "score": 1, "last_activity_date": 1480543307, "creation_date": 1480542927, "question_id": 40898936, "link": "https://stackoverflow.com/questions/40898936/apply-a-callback-to-a-list-of-items-with-linq", "title": "Apply a callback to a list of items with LINQ", "body": "<p>I am trying to modify the items in a list based on whether or not they match a LINQ Where query.</p>\n\n<p>I tried doing it this way:</p>\n\n<pre><code>class Collection&lt;T&gt; {\n\n    public List&lt;T&gt; Items { get; private set; }\n\n    public Collection&lt;T&gt; Modify(Func&lt;T, bool&gt; query, Func&lt;T, T&gt; callback) {\n        Items = Items.Where(query).Select(callback).ToList();\n        return this;\n    }\n}\n</code></pre>\n\n<p>But this removes items from the list if it doesn't match. I would like to just skip over the item, and leave it in the list. How can I accomplish this?</p>\n"}, {"tags": ["c#", "uwp", "win-universal-app", "windows-10", "windows-10-universal"], "comments": [{"owner": {"reputation": 973, "user_id": 5677420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/wwFge.jpg?s=128&g=1", "display_name": "Thomas Schneiter", "link": "https://stackoverflow.com/users/5677420/thomas-schneiter"}, "edited": false, "score": 0, "creation_date": 1480578405, "post_id": 40898930, "comment_id": 69022957, "body": "Just using <code>ApplicationView.PreferredLaunchViewSize = new Size { Height = 550, Width = 360 };</code> and             <code>ApplicationView.PreferredLaunchWindowingMode = ApplicationViewWindowingMode.PreferredLaunchViewSize;</code> in the MainPage Constructor works fine for me."}, {"owner": {"reputation": 1470, "user_id": 5902558, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e4fd0f1c33e1f57fad38a48a1551a1de?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Bedford", "link": "https://stackoverflow.com/users/5902558/michael-bedford"}, "reply_to_user": {"reputation": 973, "user_id": 5677420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/wwFge.jpg?s=128&g=1", "display_name": "Thomas Schneiter", "link": "https://stackoverflow.com/users/5677420/thomas-schneiter"}, "edited": false, "score": 0, "creation_date": 1480579497, "post_id": 40898930, "comment_id": 69023485, "body": "There must be something else that is blocking or preventing this. I am not sure what it could be. It does not work in my project but i can confirm your findings, if i create a new project it does work."}], "answers": [{"comments": [{"owner": {"reputation": 1470, "user_id": 5902558, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e4fd0f1c33e1f57fad38a48a1551a1de?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Bedford", "link": "https://stackoverflow.com/users/5902558/michael-bedford"}, "edited": false, "score": 0, "creation_date": 1480580176, "post_id": 40905482, "comment_id": 69023807, "body": "Thank you for the answer, it is one of the things listed in my post that i tried. it does not work. there must be something else in my app that is conflicting."}, {"owner": {"reputation": 1470, "user_id": 5902558, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e4fd0f1c33e1f57fad38a48a1551a1de?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Bedford", "link": "https://stackoverflow.com/users/5902558/michael-bedford"}, "edited": false, "score": 2, "creation_date": 1480614176, "post_id": 40905482, "comment_id": 69046358, "body": "Marking this answer as correct because it is the correct way to do what I needed to do. However, in my case, it was not working when I would debug. I did a full clean and rebuild and now it works. That said, I also noticed that it may not work on the first launch but on all subsequent launches, it will respect your screen size request."}, {"owner": {"reputation": 112, "user_id": 1647674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f076ddd108df1b38cbb03cb4a76657f?s=128&d=identicon&r=PG", "display_name": "Stephen Naughton", "link": "https://stackoverflow.com/users/1647674/stephen-naughton"}, "edited": false, "score": 0, "creation_date": 1583733656, "post_id": 40905482, "comment_id": 107202522, "body": "Yes, it did not work the first time you debug after making the change!"}, {"owner": {"reputation": 758, "user_id": 5585996, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/95590d8605a0729c242444f9ec843779?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgiG", "link": "https://stackoverflow.com/users/5585996/georgig"}, "edited": false, "score": 0, "creation_date": 1587728281, "post_id": 40905482, "comment_id": 108629948, "body": "Guys, that would never work the first time. Reason is simple - In order to correctly set the ViewSize, you need to have PreferredLaunchWindowingMode  as PreferredLaunchViewSize. The problem is, that is Auto by default. Setting it to a different value works ONLY for the next launches. That means for the current launch you&#39;re stuck with Auto and can&#39;t resize."}], "tags": [], "owner": {"reputation": 1378, "user_id": 6152542, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/604416256387309/picture?type=large", "display_name": "Jet  Chopper", "link": "https://stackoverflow.com/users/6152542/jet-chopper"}, "is_accepted": true, "score": 0, "last_activity_date": 1480579612, "creation_date": 1480579612, "answer_id": 40905482, "question_id": 40898930, "link": "https://stackoverflow.com/questions/40898930/windows-10-universal-app-screen-size-on-launch-not-working/40905482#40905482", "title": "Windows 10 Universal app screen size on launch not working", "body": "<p>You should set minimum window size if it's less than default</p>\n\n<pre><code>            ApplicationView.GetForCurrentView().SetPreferredMinSize(new Size { Width = 400, Height = 600});\n            ApplicationView.PreferredLaunchViewSize = new Size(400, 600);\n            ApplicationView.PreferredLaunchWindowingMode = ApplicationViewWindowingMode.PreferredLaunchViewSize;\n</code></pre>\n\n<p>Call this in <strong>App.xaml.cs</strong> before <strong>Window.Current.Activate();</strong></p>\n"}], "owner": {"reputation": 1470, "user_id": 5902558, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e4fd0f1c33e1f57fad38a48a1551a1de?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Bedford", "link": "https://stackoverflow.com/users/5902558/michael-bedford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 1, "accepted_answer_id": 40905482, "answer_count": 1, "score": 0, "last_activity_date": 1480579612, "creation_date": 1480542893, "question_id": 40898930, "link": "https://stackoverflow.com/questions/40898930/windows-10-universal-app-screen-size-on-launch-not-working", "title": "Windows 10 Universal app screen size on launch not working", "body": "<p>I had read a ton about setting the app window size on launch. Basically, my app is launching full screen everytime. I want to restrict it to a pre-defined size when it launches. However, nothing seems to be working. Here is what I have done so far:</p>\n\n<ol>\n<li><p>I have put the following:</p>\n\n<pre><code>var desiredSize = new Size(400, 600);\nApplicationView.GetForCurrentView().ExitFullScreenMode();\nApplicationView.GetForCurrentView().SetPreferredMinSize(desiredSize);\nApplicationView.PreferredLaunchViewSize = desiredSize;\nApplicationView.PreferredLaunchWindowingMode = ApplicationViewWindowingMode.PreferredLaunchViewSize;\n</code></pre></li>\n</ol>\n\n<p>And have tried that snippet in first the constructor for MainPage.xaml.cs (which didn't work), then just above</p>\n\n<pre><code>Window.Current.Activate();     \n</code></pre>\n\n<p>In App.xaml.cs which also didn't work. Based on some reading, I also tried adding:</p>\n\n<pre><code>ApplicationView.GetForCurrentView().TryResizeView(desiredSize);\n</code></pre>\n\n<p>Both after Window.Current.Activate in App.xaml.cs and at the end of the constructor in MainPage.xaml.cs.</p>\n\n<p>I did notice that in MainPage.xaml.cs, I could do:</p>\n\n<pre><code> this.Width = 400;\n this.Height = 600;\n</code></pre>\n\n<p>And that does work to size the MainPage frame within the window properly but the overall Window stays the same size.</p>\n\n<p>I can manually drag the window to the size I want after it launches but I want it so simply just launch this size everytime. What am I missing?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "rest", "rally"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7112575, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7851f30fe48e4d26fff3af2b2bbde963?s=128&d=identicon&r=PG&f=1", "display_name": "Sumanth Maddirala", "link": "https://stackoverflow.com/users/7112575/sumanth-maddirala"}, "edited": false, "score": 0, "creation_date": 1480611819, "post_id": 40901436, "comment_id": 69044914, "body": "Thanks Sir. . I am also looking into adding diverse attachment types to a user story. (.jpeg, .java, .sql, ....) Any hints on how you would go about doing that?"}, {"owner": {"reputation": 8320, "user_id": 728184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DuDCb.jpg?s=128&g=1", "display_name": "Kyle Morse", "link": "https://stackoverflow.com/users/728184/kyle-morse"}, "reply_to_user": {"reputation": 101, "user_id": 7112575, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7851f30fe48e4d26fff3af2b2bbde963?s=128&d=identicon&r=PG&f=1", "display_name": "Sumanth Maddirala", "link": "https://stackoverflow.com/users/7112575/sumanth-maddirala"}, "edited": false, "score": 0, "creation_date": 1480633450, "post_id": 40901436, "comment_id": 69056185, "body": "The content all has to be base64 encoded, so really you just need to set the  Name and ContentType correctly and you should be good to go."}, {"owner": {"reputation": 101, "user_id": 7112575, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7851f30fe48e4d26fff3af2b2bbde963?s=128&d=identicon&r=PG&f=1", "display_name": "Sumanth Maddirala", "link": "https://stackoverflow.com/users/7112575/sumanth-maddirala"}, "edited": false, "score": 0, "creation_date": 1483982167, "post_id": 40901436, "comment_id": 70311839, "body": "Hello Kyle: Any idea on how to upload a collection of attachments and associate with a user story. I am trying to iterate over a directory that contains my attachments, and converting each attachment to base64. I am just stuck on how to upload each attachment within my directory to the user story."}, {"owner": {"reputation": 8320, "user_id": 728184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DuDCb.jpg?s=128&g=1", "display_name": "Kyle Morse", "link": "https://stackoverflow.com/users/728184/kyle-morse"}, "reply_to_user": {"reputation": 101, "user_id": 7112575, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7851f30fe48e4d26fff3af2b2bbde963?s=128&d=identicon&r=PG&f=1", "display_name": "Sumanth Maddirala", "link": "https://stackoverflow.com/users/7112575/sumanth-maddirala"}, "edited": false, "score": 0, "creation_date": 1483985581, "post_id": 40901436, "comment_id": 70313765, "body": "If you had it working for a single attachment it should be exactly the same for each file you&#39;re looping over.  There is no way to add multiple attachments at the same time in one request..."}], "tags": [], "owner": {"reputation": 8320, "user_id": 728184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DuDCb.jpg?s=128&g=1", "display_name": "Kyle Morse", "link": "https://stackoverflow.com/users/728184/kyle-morse"}, "is_accepted": true, "score": 3, "last_activity_date": 1480557821, "creation_date": 1480557821, "answer_id": 40901436, "question_id": 40898886, "link": "https://stackoverflow.com/questions/40898886/rally-c-is-it-possible-to-create-a-new-user-story-along-with-an-attachment-a/40901436#40901436", "title": "Rally C#: Is it possible to create a new user story along with an attachment? (Avoiding to query for the user-story reference)", "body": "<p>You should already have what you need to associate it from the create result:</p>\n\n<pre><code>myAttachment[\"Artifact\"] = createUserStory.Reference;\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7112575, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7851f30fe48e4d26fff3af2b2bbde963?s=128&d=identicon&r=PG&f=1", "display_name": "Sumanth Maddirala", "link": "https://stackoverflow.com/users/7112575/sumanth-maddirala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 40901436, "answer_count": 1, "score": 2, "last_activity_date": 1480557821, "creation_date": 1480542772, "last_edit_date": 1495535437, "question_id": 40898886, "link": "https://stackoverflow.com/questions/40898886/rally-c-is-it-possible-to-create-a-new-user-story-along-with-an-attachment-a", "title": "Rally C#: Is it possible to create a new user story along with an attachment? (Avoiding to query for the user-story reference)", "body": "<p>Please be patient I have already gone through the example from: <a href=\"https://stackoverflow.com/questions/11388652/how-to-add-an-attachment-to-a-user-story-using-rally-rest-net\">How to Add an Attachment to a User Story using Rally REST .NET</a></p>\n\n<p>However the sample code requires a query to identify the newest user story reference. The sample illustrates how to add an attachment to an existing user story. I would like to accomplish: Creating a new user story along with an attachment.</p>\n\n<p>Here is my method.</p>\n\n<pre><code>        public void createUsWithAttachment(string workspace, string project, \n                    string userStoryName, string userStoryDescription){\n\n        //Authenticate with Rally \n        this.EnsureRallyIsAuthenticated();\n\n        //UserStory Setup\n        DynamicJsonObject toCreate = new DynamicJsonObject();\n        toCreate[RallyField.workSpace] = workspace;\n        toCreate[RallyField.project] = project;\n        toCreate[RallyField.name] = userStoryName;\n        toCreate[RallyField.description] = userStoryDescription;\n\n        //get the image reference - assume that this is where the image lives after being downloaded from Outlook\n        String imageFilePath = \"C:\\\\Users\\\\secret\\\\...\";\n        String imageFileName = \"file.png\";\n        String fullImageFile = imageFilePath + imageFileName;\n        Image myImage = Image.FromFile(fullImageFile);\n\n        // Convert Image to Base64 format\n        string imageBase64String = imageToBase64(myImage, System.Drawing.Imaging.ImageFormat.Png);\n\n        // Length calculated from Base64String converted back\n        var imageNumberBytes = Convert.FromBase64String(imageBase64String).Length;\n\n        // DynamicJSONObject for AttachmentContent\n        DynamicJsonObject myAttachmentContent = new DynamicJsonObject();\n        myAttachmentContent[\"Content\"] = imageBase64String;\n\n        try\n        {\n            //create user story\n            CreateResult createUserStory = _api.Create(RallyField.hierarchicalRequirement, toCreate);\n\n            //create attachment\n            CreateResult myAttachmentContentCreateResult = _api.Create(\"AttachmentContent\", myAttachmentContent);\n            String myAttachmentContentRef = myAttachmentContentCreateResult.Reference;\n            Console.WriteLine(\"Created: \" + myAttachmentContentRef);\n\n            // DynamicJSONObject for Attachment Container\n            DynamicJsonObject myAttachment = new DynamicJsonObject();\n            //Note the below commented line\n            /*myAttachment[\"Artifact\"] = ;*/ \n            myAttachment[\"Content\"] = myAttachmentContentRef;\n            myAttachment[\"Name\"] = \"AttachmentFromREST.png\";\n            myAttachment[\"Description\"] = \"Attachment Desc\";\n            myAttachment[\"ContentType\"] = \"image/png\";\n            myAttachment[\"Size\"] = imageNumberBytes;\n\n            //create attachment\n            CreateResult myAttachmentCreateResult = _api.Create(\"Attachment\", myAttachment);\n        }\n        catch (WebException e)\n        {\n            Console.WriteLine(e.Message);\n        }\n    }\n</code></pre>\n\n<p>In the above commented line I need to get a reference to the created user story which I can do, but that would require another method to fetch the user story which I have.\nHowever I am wondering if this can be accomplished a different way similar to how we can create a user story with the dynamicJsonObject staging.\nI was thinking something like this would work, but I am having a tough time.</p>\n\n<pre><code>        DynamicJsonObject toCreate = new DynamicJsonObject();\n        toCreate[RallyField.workSpace] = workspace;\n        toCreate[RallyField.project] = project;\n        toCreate[RallyField.name] = userStoryName;\n        toCreate[RallyField.description] = userStoryDescription;\n        toCreate[\"Content\"] = imageToBase64;\n        CreateResult createUserStory = _api.Create(RallyField.hierarchicalRequirement, toCreate);\n</code></pre>\n\n<p>My above assumption is not going as planned and I was wondering if there is a way to create a new user story with an attachment, without having to query for the userstory reference as neatly illustrated in the example from the link provided. \nThanks and credit to the author from the example in the link.</p>\n"}, {"tags": ["c#", "file", "stream", "filestream", "binaryformatter"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1480543015, "post_id": 40898828, "comment_id": 69011706, "body": "Any write stream you must flush() and close() otherwise you can loose data."}, {"owner": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 1, "creation_date": 1480543163, "post_id": 40898828, "comment_id": 69011773, "body": "Calling <code>new FileStream()</code> with the <code>Create</code> FileMode option immediately replaces your existing file with a blank one. I&#39;m having some trouble deciphering the rest of your program, but you possibly only want to create the stream inside the &quot;save&quot; handler, that way the file is never created <i>or overwritten</i> if they hit &quot;No don&#39;t save&quot;. Once you call <code>New FileStream( .. FileMode.Create ...)</code> your existing file gets blasted."}, {"owner": {"reputation": 169, "user_id": 5525633, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5d82a5ce8640effbce0c67d78df081f5?s=128&d=identicon&r=PG&f=1", "display_name": "AustinC", "link": "https://stackoverflow.com/users/5525633/austinc"}, "reply_to_user": {"reputation": 1659, "user_id": 5095502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13e54dcf3ba6b94fd63bb61af1704ce1?s=128&d=identicon&r=PG", "display_name": "Quantic", "link": "https://stackoverflow.com/users/5095502/quantic"}, "edited": false, "score": 0, "creation_date": 1480544223, "post_id": 40898828, "comment_id": 69012251, "body": "@Quantic You&#39;re right, I was not aware of that. It makes sense now that I think about it though, since it&#39;s essentially creating a new file with the same name. I moved the stream declarations to the FormClosing method right before the save method is called, and now it functions perfectly. Thank you for your help."}, {"owner": {"reputation": 870071, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1480546537, "post_id": 40898828, "comment_id": 69013286, "body": "That is not it, FileStream is unusual and still flushes its buffer when you dispose.  The code is quite clumsy, there is no obvious reason to open the file early.  Other than writing to it while the user is interacting with the UI.  So clicking No will leave partial data in the file.  The Q+D workaround is to delete the files.  Do keep in mind that overwriting is not a good idea since clicking No will leave the user without any data."}], "owner": {"reputation": 169, "user_id": 5525633, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5d82a5ce8640effbce0c67d78df081f5?s=128&d=identicon&r=PG&f=1", "display_name": "AustinC", "link": "https://stackoverflow.com/users/5525633/austinc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480542523, "creation_date": 1480542523, "question_id": 40898828, "link": "https://stackoverflow.com/questions/40898828/stream-dispose-method-and-fillaccess-write-issue", "title": "Stream.Dispose() method and FillAccess.Write Issue(?)", "body": "<p>I'm writing a program using what I understand is a flat-file database. In my program, I deserialize a set of objects which I will be working with in the program, and load those objects into a list. </p>\n\n<pre><code>            using (FileStream IStreamRead = new FileStream(Directory.GetCurrentDirectory() + itemFileName, FileMode.Open, FileAccess.Read))\n        {\n            if (IStreamRead.Length &gt; 0)\n                itemRecords = bformatter.Deserialize(IStreamRead) as List&lt;Record&gt;;\n        }\n        using (FileStream CStreamRead = new FileStream(Directory.GetCurrentDirectory() + clinicFileName, FileMode.Open, FileAccess.Read))\n        {\n            if (CStreamRead.Length &gt; 0)\n                clinicNames = bformatter.Deserialize(CStreamRead) as List&lt;String&gt;;\n        }\n</code></pre>\n\n<p>Output stream delcaration (used to overwrite to the file):</p>\n\n<pre><code>        Istream = new FileStream(Directory.GetCurrentDirectory() + itemFileName, FileMode.Create, FileAccess.Write);\n        Cstream = new FileStream(Directory.GetCurrentDirectory() + clinicFileName, FileMode.Create, FileAccess.Write);\n</code></pre>\n\n<p>At the end of the program (when the user exits the application), I execute a Save method:</p>\n\n<pre><code>        private void saveToolStripMenuItem_Click(object sender, EventArgs e)\n    {\n        //save the state of all record objects, as well as clinic names\n        if (itemRecords.Count &gt; 0)\n            bformatter.Serialize(Istream, itemRecords);\n        if (clinicNames.Count &gt; 0)\n            bformatter.Serialize(Cstream, clinicNames);\n    }\n</code></pre>\n\n<p>The save method is called in the FormClosing event handler to ensure all objects are saved, but the user is prompted as well if any changes have been made.</p>\n\n<pre><code>        private void mainForm_FormClosing(object sender, FormClosingEventArgs e)\n    {\n        if (dataEdited)\n        {\n            DialogResult dialogResult = MessageBox.Show(\"Would you like to save your edits?\", \"Warning\", MessageBoxButtons.YesNo, MessageBoxIcon.Warning);\n            if (dialogResult == DialogResult.Yes)\n            {\n                saveToolStripMenuItem_Click(sender, e as EventArgs);\n                Istream.Dispose();\n                Cstream.Dispose();\n            }\n            else\n            {\n                Istream.Dispose();\n                Cstream.Dispose();\n            }\n        }\n        else\n        {\n            Istream.Dispose();\n            Cstream.Dispose();\n        }\n    }\n</code></pre>\n\n<p>The issue I'm running into is that information in the file is being deleted (or at least it seems that way) if I choose not to save the file. For example, I'll open up the application already having one clinic name saved in the clinic name file, but if I then close the application without saving, the clinic name will not be there the next time the application is opened. Is there something that happens when the stream is disposed which might cause this?</p>\n"}, {"tags": ["c#", "binary-search-tree"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 3, "creation_date": 1480542112, "post_id": 40898719, "comment_id": 69011262, "body": "This is too much information.  Please boil this down to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, and define <i>specifically</i> what it is you&#39;d like us to help you with."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1480542117, "post_id": 40898719, "comment_id": 69011266, "body": "Tree searches usually requires a recursive method or a push/pop method."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1480542204, "post_id": 40898719, "comment_id": 69011300, "body": "There are three possibilities for the result of <code>CompareTo: &lt; 0 , &gt; 0 or = 0</code>. You need to check all three to decide whether to stop the search successfully (on 0) or to search the left or right subtrees. At the moment your test for <code>item &gt; tree root</code> is within the test for <code>item &lt; tree root</code> which it should not be."}, {"owner": {"reputation": 921, "user_id": 2715671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UidHT.png?s=128&g=1", "display_name": "Kelson Ball", "link": "https://stackoverflow.com/users/2715671/kelson-ball"}, "edited": false, "score": 0, "creation_date": 1480542244, "post_id": 40898719, "comment_id": 69011319, "body": "Is your code compiling? If it is, what behavior do you get?"}, {"owner": {"reputation": 1126, "user_id": 5527199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qnkLm.jpg?s=128&g=1", "display_name": "Luke Kot-Zaniewski", "link": "https://stackoverflow.com/users/5527199/luke-kot-zaniewski"}, "edited": false, "score": 0, "creation_date": 1480542260, "post_id": 40898719, "comment_id": 69011327, "body": "your second if block  will never get called because its contained in an if block that precludes it from being true."}, {"owner": {"reputation": 39, "user_id": 4601199, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6ec51669834ce62e1b0c43c763c0480?s=128&d=identicon&r=PG&f=1", "display_name": "JavaScriptGrasshopper", "link": "https://stackoverflow.com/users/4601199/javascriptgrasshopper"}, "edited": false, "score": 0, "creation_date": 1480542976, "post_id": 40898719, "comment_id": 69011687, "body": "@rory.apI Apologise, I felt the classes I added were a critical component in term of understanding my code."}, {"owner": {"reputation": 39, "user_id": 4601199, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6ec51669834ce62e1b0c43c763c0480?s=128&d=identicon&r=PG&f=1", "display_name": "JavaScriptGrasshopper", "link": "https://stackoverflow.com/users/4601199/javascriptgrasshopper"}, "reply_to_user": {"reputation": 921, "user_id": 2715671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UidHT.png?s=128&g=1", "display_name": "Kelson Ball", "link": "https://stackoverflow.com/users/2715671/kelson-ball"}, "edited": false, "score": 0, "creation_date": 1480543010, "post_id": 40898719, "comment_id": 69011703, "body": "@KelsonBall Indeed it is, if I remove both the Contains and Remove method, complies and runs as expected."}, {"owner": {"reputation": 39, "user_id": 4601199, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6ec51669834ce62e1b0c43c763c0480?s=128&d=identicon&r=PG&f=1", "display_name": "JavaScriptGrasshopper", "link": "https://stackoverflow.com/users/4601199/javascriptgrasshopper"}, "reply_to_user": {"reputation": 1126, "user_id": 5527199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qnkLm.jpg?s=128&g=1", "display_name": "Luke Kot-Zaniewski", "link": "https://stackoverflow.com/users/5527199/luke-kot-zaniewski"}, "edited": false, "score": 0, "creation_date": 1480543053, "post_id": 40898719, "comment_id": 69011728, "body": "@LucasKot-Zaniewski Thank you for your insight and I will take that into account."}], "answers": [{"comments": [{"owner": {"reputation": 921, "user_id": 2715671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UidHT.png?s=128&g=1", "display_name": "Kelson Ball", "link": "https://stackoverflow.com/users/2715671/kelson-ball"}, "edited": false, "score": 0, "creation_date": 1480542830, "post_id": 40898855, "comment_id": 69011616, "body": "Item probably needs passed to the recursive calls. That&#39;s why I asked OP if his code was compiling :/"}, {"owner": {"reputation": 790, "user_id": 6061721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-McuUUypxZX8/AAAAAAAAAAI/AAAAAAAAABk/GgDkjrgVm0k/photo.jpg?sz=128", "display_name": "Libby", "link": "https://stackoverflow.com/users/6061721/libby"}, "reply_to_user": {"reputation": 921, "user_id": 2715671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UidHT.png?s=128&g=1", "display_name": "Kelson Ball", "link": "https://stackoverflow.com/users/2715671/kelson-ball"}, "edited": false, "score": 0, "creation_date": 1480542902, "post_id": 40898855, "comment_id": 69011655, "body": "Good call @KelsonBall. I have edited the post to reflect these changes."}, {"owner": {"reputation": 39, "user_id": 4601199, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6ec51669834ce62e1b0c43c763c0480?s=128&d=identicon&r=PG&f=1", "display_name": "JavaScriptGrasshopper", "link": "https://stackoverflow.com/users/4601199/javascriptgrasshopper"}, "reply_to_user": {"reputation": 921, "user_id": 2715671, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/UidHT.png?s=128&g=1", "display_name": "Kelson Ball", "link": "https://stackoverflow.com/users/2715671/kelson-ball"}, "edited": false, "score": 0, "creation_date": 1480543141, "post_id": 40898855, "comment_id": 69011766, "body": "@KelsonBall Sorry for the late reply, I have answered your question."}, {"owner": {"reputation": 39, "user_id": 4601199, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6ec51669834ce62e1b0c43c763c0480?s=128&d=identicon&r=PG&f=1", "display_name": "JavaScriptGrasshopper", "link": "https://stackoverflow.com/users/4601199/javascriptgrasshopper"}, "edited": false, "score": 0, "creation_date": 1480543287, "post_id": 40898855, "comment_id": 69011831, "body": "@Libby Thank you for your answer, however, I have stumbled across an error &quot;Operator &#39;==&#39; cannot be applied to operands of type &#39;T&#39; and &#39;T&#39;."}, {"owner": {"reputation": 1126, "user_id": 5527199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qnkLm.jpg?s=128&g=1", "display_name": "Luke Kot-Zaniewski", "link": "https://stackoverflow.com/users/5527199/luke-kot-zaniewski"}, "edited": false, "score": 0, "creation_date": 1480543297, "post_id": 40898855, "comment_id": 69011836, "body": "I upvoted but what&#39;s the point of the last <code>return false</code> and the second if statement? why not just add an else to the last if block?"}, {"owner": {"reputation": 790, "user_id": 6061721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-McuUUypxZX8/AAAAAAAAAAI/AAAAAAAAABk/GgDkjrgVm0k/photo.jpg?sz=128", "display_name": "Libby", "link": "https://stackoverflow.com/users/6061721/libby"}, "edited": false, "score": 0, "creation_date": 1480543397, "post_id": 40898855, "comment_id": 69011885, "body": "The return false is if the item you are looking for is not in the tree. But now that I think about it, the first if statement should take care of that. The second if statement checks if the node you are currently looking at is the item that you are looking for"}, {"owner": {"reputation": 1126, "user_id": 5527199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qnkLm.jpg?s=128&g=1", "display_name": "Luke Kot-Zaniewski", "link": "https://stackoverflow.com/users/5527199/luke-kot-zaniewski"}, "edited": false, "score": 0, "creation_date": 1480543516, "post_id": 40898855, "comment_id": 69011934, "body": "probably a good idea...plus there is the whole problem of using == with generic type."}, {"owner": {"reputation": 790, "user_id": 6061721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-McuUUypxZX8/AAAAAAAAAAI/AAAAAAAAABk/GgDkjrgVm0k/photo.jpg?sz=128", "display_name": "Libby", "link": "https://stackoverflow.com/users/6061721/libby"}, "reply_to_user": {"reputation": 1126, "user_id": 5527199, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qnkLm.jpg?s=128&g=1", "display_name": "Luke Kot-Zaniewski", "link": "https://stackoverflow.com/users/5527199/luke-kot-zaniewski"}, "edited": false, "score": 0, "creation_date": 1480543561, "post_id": 40898855, "comment_id": 69011950, "body": "Yes @LucasKot-Zaniewski, your solution is much cleaner :)"}], "tags": [], "owner": {"reputation": 790, "user_id": 6061721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-McuUUypxZX8/AAAAAAAAAAI/AAAAAAAAABk/GgDkjrgVm0k/photo.jpg?sz=128", "display_name": "Libby", "link": "https://stackoverflow.com/users/6061721/libby"}, "is_accepted": false, "score": 3, "last_activity_date": 1480543521, "last_edit_date": 1480543521, "creation_date": 1480542623, "answer_id": 40898855, "question_id": 40898719, "link": "https://stackoverflow.com/questions/40898719/c-binary-search-tree-contains-is-present-method/40898855#40898855", "title": "C# - Binary Search Tree Contains/Is Present Method", "body": "<p>To check if a node is in the tree, you have a few options:</p>\n\n<ol>\n<li>The node you want is in the left sub-tree</li>\n<li>The node you want is in the right sub-tree</li>\n<li>The node you want is where you are right now</li>\n</ol>\n\n<p>So your <code>Contains</code> method should look more like this:</p>\n\n<pre><code>public Boolean Contains(T item, ref Node&lt;T&gt; tree)\n{\n       if (tree == null)\n       {\n            return false;\n       }\n\n       if (tree.data == item)\n       {\n           return true;\n       }  \n\n\n       if (item.CompareTo(tree.Data) &lt; 0)\n       {\n            return Contains(item, ref tree.Left);\n       }\n       if (item.CompareTo(tree.Data) &gt; 0)\n       {\n            return Contains(item, ref tree.Right);\n       }\n  }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1064, "user_id": 1909501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bpH0j.png?s=128&g=1", "display_name": "janith1024", "link": "https://stackoverflow.com/users/1909501/janith1024"}, "edited": false, "score": 1, "creation_date": 1535165968, "post_id": 52013572, "comment_id": 90977969, "body": "add description and say how you solution help to solve the problem :)"}], "tags": [], "owner": {"reputation": 1, "user_id": 8807735, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4wVdtX3Xv6M/AAAAAAAAAAI/AAAAAAAAD3M/0Atn15MGm1s/photo.jpg?sz=128", "display_name": "Yayati Trivedi", "link": "https://stackoverflow.com/users/8807735/yayati-trivedi"}, "is_accepted": false, "score": 0, "last_activity_date": 1535164660, "creation_date": 1535164660, "answer_id": 52013572, "question_id": 40898719, "link": "https://stackoverflow.com/questions/40898719/c-binary-search-tree-contains-is-present-method/52013572#52013572", "title": "C# - Binary Search Tree Contains/Is Present Method", "body": "<pre><code>public static bool Contains(Node root, int value)\n {\n    if(root == null)\n        return false;\n    if(root.Value == value)\n        return true;\n    if(value &lt; root.Value)\n        return Contains( root.Left,value);\n    else\n        return Contains( root.Right,value);\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4601199, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6ec51669834ce62e1b0c43c763c0480?s=128&d=identicon&r=PG&f=1", "display_name": "JavaScriptGrasshopper", "link": "https://stackoverflow.com/users/4601199/javascriptgrasshopper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2647, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1535164660, "creation_date": 1480541992, "question_id": 40898719, "link": "https://stackoverflow.com/questions/40898719/c-binary-search-tree-contains-is-present-method", "title": "C# - Binary Search Tree Contains/Is Present Method", "body": "<p>I'm really struggling to get this method to work, I was wondering if you could help me out. I've been using the ref keyword, so I'll keep using it. I've been searching the web and it's been some help, but I've tried everything I can possibly think of. Both my count and height methods work, however, I'm just really struggling to get this Contain method to work. Many examples on the web have showed both  a public and private method of contains (I understand as to why) but I'm sure it could be done within one method? Surely, right? Also, please ignore the RemoveItem method, unless you wish to give me a head-start, that's at your discretion. I know it's tricky as I've looked up on it earlier during the week. </p>\n\n<p>Node class-</p>\n\n<pre><code>    class Node&lt;T&gt; where T : IComparable\n{\n    private T data;\n    public Node&lt;T&gt; Left, Right;\n\n    public Node(T item)\n    {\n        data = item;\n        Left = null;\n        Right = null;\n    }\n    public T Data\n    {\n        set { data = value; }\n        get { return data; }\n    }\n\n}\n</code></pre>\n\n<p>BinTree Class-</p>\n\n<pre><code> class BinTree&lt;T&gt; where T : IComparable\n{\n    protected Node&lt;T&gt; root;\n\n    public BinTree()  //creates an empty tree\n    {\n        root = null;\n    }\n    public BinTree(Node&lt;T&gt; node)  //creates a tree with node as the root\n    {\n        root = node;\n    }\n   //I've deleted my preOrder, inOrder and postOrder methods just to save you some time\n\n}\n</code></pre>\n\n<p>BSTree Class-</p>\n\n<pre><code> class BSTree&lt;T&gt; : BinTree&lt;T&gt; where T : IComparable\n{  \n    public BSTree()\n    {\n        root = null;\n    }\n\n    private void insertItem(T item, ref Node&lt;T&gt; tree)\n    {\n        if (tree == null)\n        {\n            tree = new Node&lt;T&gt;(item);\n\n        }\n\n        else if (item.CompareTo(tree.Data) &lt; 0)\n        {\n            insertItem(item, ref tree.Left);\n        }\n\n        else if (item.CompareTo(tree.Data) &gt; 0)\n            insertItem(item, ref tree.Right);\n    }\n\n    public void InsertItem(T item)\n    {\n        insertItem(item, ref root);\n    }\n\n    public int Height(ref Node&lt;T&gt; tree)\n    //Return the max level of the tree\n    {\n        if (tree == null)\n\n            return 0;\n        return (1 + Math.Max(Height(ref tree.Left), Height(ref tree.Right)));\n    }\n\n\n    public int Count(ref Node&lt;T&gt; tree)\n    //Return the number of nodes in the tree\n    {\n        int counter = 0;\n\n        if (tree == null)\n        {\n            return 0;\n        }\n        else if (tree.Left != null)\n        {\n            counter += Count(ref tree.Left);\n            counter++;\n        }\n\n        if (tree.Right != null)\n        {\n            counter += Count(ref tree.Right);\n            counter++;\n        }\n        return counter;\n    }\n\n\n\n    public Boolean Contains(T item, ref Node&lt;T&gt; tree)\n    //Return true if the item is contained in the BSTree, false       //otherwise.\n    {\n       if (tree == null)\n        {\n            return false;\n        }\n\n\n\n       if (item.CompareTo(tree.Data) &lt; 0)\n        {\n            return Contains(ref tree.Left);\n\n\n            if (item.CompareTo(tree.Data) &gt; 0)\n            {\n                return Contains(ref tree.Right);\n                return true;\n            }\n        }\n  }\n\n    public void RemoveItem(T item) \n    {\n    }\n\n}\n</code></pre>\n\n<p>Thank you in advance. </p>\n"}, {"tags": ["c#", "android", "sqlite", "xamarin", "local-database"], "comments": [{"owner": {"reputation": 516, "user_id": 2340813, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EbSuk.png?s=128&g=1", "display_name": "MikeOscarEcho", "link": "https://stackoverflow.com/users/2340813/mikeoscarecho"}, "edited": false, "score": 0, "creation_date": 1480543488, "post_id": 40898645, "comment_id": 69011920, "body": "I&#39;m not entirely sure but have you looked at the SQLCipher component for Xamarin Android? There&#39;s some sample code on the Component&#39;s page that may be of interest to you."}, {"owner": {"reputation": 93, "user_id": 5555736, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-Bgc0EwS5-Xs/AAAAAAAAAAI/AAAAAAAAEOs/UZzr_02vC34/photo.jpg?sz=128", "display_name": "Yousif Garabet", "link": "https://stackoverflow.com/users/5555736/yousif-garabet"}, "reply_to_user": {"reputation": 516, "user_id": 2340813, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EbSuk.png?s=128&g=1", "display_name": "MikeOscarEcho", "link": "https://stackoverflow.com/users/2340813/mikeoscarecho"}, "edited": false, "score": 0, "creation_date": 1480543923, "post_id": 40898645, "comment_id": 69012127, "body": "Dear @MikeOscarEcho I just want to open db protected by password, I don&#39;t like to encrypt my db"}, {"owner": {"reputation": 5513, "user_id": 2913599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098f6fabc851434459585bb8170f950f?s=128&d=identicon&r=PG", "display_name": "jgoldberger - MSFT", "link": "https://stackoverflow.com/users/2913599/jgoldberger-msft"}, "edited": false, "score": 3, "creation_date": 1480555146, "post_id": 40898645, "comment_id": 69015864, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1381264/password-protect-a-sqlite-db-is-it-possible\">Password Protect a SQLite DB. Is it possible?</a>"}, {"owner": {"reputation": 12502, "user_id": 85606, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3265b175095f31c8290d110f8588201f?s=128&d=identicon&r=PG", "display_name": "Prashant Cholachagudda", "link": "https://stackoverflow.com/users/85606/prashant-cholachagudda"}, "reply_to_user": {"reputation": 5513, "user_id": 2913599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098f6fabc851434459585bb8170f950f?s=128&d=identicon&r=PG", "display_name": "jgoldberger - MSFT", "link": "https://stackoverflow.com/users/2913599/jgoldberger-msft"}, "edited": false, "score": 1, "creation_date": 1480569843, "post_id": 40898645, "comment_id": 69019525, "body": "What do you mean by password protected? Do you need password to open the DB? Then refer @jgoldberger &#39;s comment above"}, {"owner": {"reputation": 93, "user_id": 5555736, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-Bgc0EwS5-Xs/AAAAAAAAAAI/AAAAAAAAEOs/UZzr_02vC34/photo.jpg?sz=128", "display_name": "Yousif Garabet", "link": "https://stackoverflow.com/users/5555736/yousif-garabet"}, "reply_to_user": {"reputation": 5513, "user_id": 2913599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/098f6fabc851434459585bb8170f950f?s=128&d=identicon&r=PG", "display_name": "jgoldberger - MSFT", "link": "https://stackoverflow.com/users/2913599/jgoldberger-msft"}, "edited": false, "score": 0, "creation_date": 1480614543, "post_id": 40898645, "comment_id": 69046556, "body": "Dear @jgoldberger I think it&#39;s a little bit different from my project  check my code then if you can help me? my file.db3 is protected by a password so I couldn&#39;t open it!! but when I remove the password from my file.db3 then it works perfectly"}], "owner": {"reputation": 93, "user_id": 5555736, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-Bgc0EwS5-Xs/AAAAAAAAAAI/AAAAAAAAEOs/UZzr_02vC34/photo.jpg?sz=128", "display_name": "Yousif Garabet", "link": "https://stackoverflow.com/users/5555736/yousif-garabet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 506, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480541642, "creation_date": 1480541642, "question_id": 40898645, "link": "https://stackoverflow.com/questions/40898645/how-to-read-data-from-local-protected-sqlite-db-in-xamarin-android", "title": "how to read data from local protected SQLite DB in Xamarin - Android", "body": "<p>I have the below 2 functions for reading data from existing SQLite DB and it works correct, but my questions is how can I read from the existing Protected SQLite DB with Password? </p>\n\n<pre><code>        private string GetSQLiteDBPath()\n    {\n        return Path.Combine(DB_PATH, DB_NAME);\n    }\n      public override SQLiteDatabase WritableDatabase\n    {\n        get\n        {\n            return CreateSQLiteDB();\n        }\n    }\n\n    private SQLiteDatabase CreateSQLiteDB()\n    {\n        SQLiteDatabase sqliteDB = null;\n        string path = GetSQLiteDBPath();\n        Stream streamSQLite = null;\n        FileStream streamWriter = null;\n        Boolean isSQLiteInit = false;\n        try\n        {\n            if (File.Exists(path))\n                isSQLiteInit = true;\n            else\n            {\n                streamSQLite = context.Resources.OpenRawResource(Resource.Raw.DBStore);\n                streamWriter = new FileStream(path, FileMode.OpenOrCreate, FileAccess.Write);\n                if (streamSQLite != null &amp;&amp; streamWriter != null)\n                {\n                    if (CopySQLiteDB(streamSQLite, streamWriter))\n                        isSQLiteInit = true;\n                }\n            }\n            if (isSQLiteInit)\n                sqliteDB = SQLiteDatabase.OpenDatabase(path, null, DatabaseOpenFlags.OpenReadonly);\n        }\n        catch { }\n        return sqliteDB;\n    }\n</code></pre>\n"}, {"tags": ["c#", ".net", "amazon-web-services", "amazon-s3", "dotnet-httpclient"], "comments": [{"owner": {"reputation": 2454, "user_id": 2607840, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/odHBN.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/2607840/cameron"}, "edited": false, "score": 1, "creation_date": 1480541878, "post_id": 40898598, "comment_id": 69011154, "body": "Do you have a code sample to give us more of what you&#39;re working with?"}, {"owner": {"reputation": 86, "user_id": 3314699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3e05942abcff3028cf320144b55c78?s=128&d=identicon&r=PG&f=1", "display_name": "Zertuk", "link": "https://stackoverflow.com/users/3314699/zertuk"}, "reply_to_user": {"reputation": 2454, "user_id": 2607840, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/odHBN.jpg?s=128&g=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/2607840/cameron"}, "edited": false, "score": 0, "creation_date": 1480542170, "post_id": 40898598, "comment_id": 69011287, "body": "updated the OP to add the code"}], "answers": [{"tags": [], "owner": {"reputation": 332, "user_id": 853509, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8c7895cdbdec7489f6f6828b642238aa?s=128&d=identicon&r=PG", "display_name": "capcom923", "link": "https://stackoverflow.com/users/853509/capcom923"}, "is_accepted": false, "score": 0, "last_activity_date": 1596121776, "creation_date": 1596121776, "answer_id": 63176119, "question_id": 40898598, "link": "https://stackoverflow.com/questions/40898598/net-httpclient-get-request-very-slow-after-100-seconds-idle/63176119#63176119", "title": ".NET HttpClient GET request very slow after ~100 seconds idle", "body": "<p>The default idle timeout is about 1-2 mins. After that, the client has to re handshake with the server. So, you will find that it will be slow after 100s.</p>\n<p>You could use socket handler to extend the idle timeout.</p>\n<pre><code>var socketsHandler = new SocketsHttpHandler\n{\n      PooledConnectionIdleTimeout = TimeSpan.FromHours(27),//Actually 5 mins can be idle at maximum. Note that timeouts longer than the TCP timeout may be ignored if no keep-alive TCP message is set at the transport level.\n      MaxConnectionsPerServer = 10\n};\nclient = new HttpClient(socketsHandler);\n</code></pre>\n<p>As you can see, although I set the idle timeout to 27 hours, but actually it just keep 5 mins alive.</p>\n<p>So, finally I just call the target endpoint using the same HttpClient every 1 min. In this case, there is always an established connection. You could use netstat to check that. It works fine.</p>\n"}], "owner": {"reputation": 86, "user_id": 3314699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e3e05942abcff3028cf320144b55c78?s=128&d=identicon&r=PG&f=1", "display_name": "Zertuk", "link": "https://stackoverflow.com/users/3314699/zertuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 739, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1596121776, "creation_date": 1480541493, "last_edit_date": 1480542747, "question_id": 40898598, "link": "https://stackoverflow.com/questions/40898598/net-httpclient-get-request-very-slow-after-100-seconds-idle", "title": ".NET HttpClient GET request very slow after ~100 seconds idle", "body": "<p>The first request or a request after idling roughly 100 seconds is very slow and takes 15-30 seconds.  Any request without idling takes less than a second.  I am fine with the first request taking time, just not the small idle time causing the slowdown.</p>\n\n<p>The slowdown is not unique to the client, if I keep making requests on one client then it stays quick on the other.  Only when all are idle for 100 seconds does it slowdown.</p>\n\n<p>Here are some changes that I have tried:</p>\n\n<ul>\n<li>Setting <strong>HttpClient</strong> to a singleton and not disposing it using a using() block</li>\n<li>Setting <strong>ServicePointManager.MaxServicePointIdleTime</strong> to a higher value since by default it is 100 seconds.  Since the time period is the same as mine I thought this was the issue but it did not solve it.</li>\n<li>Setting a higher <strong>ServicePointManager.DefaultConnectionLimit</strong></li>\n<li>Default proxy settings set via web.config</li>\n<li>using <strong>await</strong> instead of <strong>httpClient.SendAsync(request).Result</strong></li>\n</ul>\n\n<p>It is not related to IIS application pool recycling since the default there is set to 20mn and the rest of the application remains quick.</p>\n\n<p>The requests are to a web service which communicates with AWS S3 to get files.  I am at a loss for ideas at this point and all my research has led me to the above points that I already tried.  Any ideas would be appreciated!</p>\n\n<p>Here is the method:\n`</p>\n\n<pre><code>//get httpclient singleton or create\nvar httpClient = HttpClientProvider.FileServiceHttpClient;\nvar queryString = string.Format(\"?key={0}\", key);\n\nvar request = new HttpRequestMessage(HttpMethod.Get, queryString);\n\nvar response = httpClient.SendAsync(request).Result;\nif (response.IsSuccessStatusCode)\n{\n\n    var metadata = new Dictionary&lt;string, string&gt;();\n    foreach (var header in response.Headers)\n    {\n        //grab tf headers\n        if (header.Key.StartsWith(_metadataHeaderPrefix))\n        {\n            metadata.Add(header.Key.Substring(_metadataHeaderPrefix.Length), header.Value.First());\n        }\n    }\n\n    var virtualFile = new VirtualFile\n    {\n        QualifiedPath = key,\n        FileStream = response.Content.ReadAsStreamAsync().Result,\n        Metadata = metadata\n    };\n    return virtualFile;\n}\nreturn null;\n</code></pre>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480541432, "post_id": 40898557, "comment_id": 69010912, "body": "I tried this on DotNetFiddle and it returns true"}, {"owner": {"reputation": 963, "user_id": 847769, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c557b37457d2312d0dda15e9006881b?s=128&d=identicon&r=PG", "display_name": "Yaman", "link": "https://stackoverflow.com/users/847769/yaman"}, "reply_to_user": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480541496, "post_id": 40898557, "comment_id": 69010948, "body": "@Tuco Have you tried on real .NET application ?"}, {"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 1, "creation_date": 1480541527, "post_id": 40898557, "comment_id": 69010964, "body": "DotNetFiddle runs real .NET"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "edited": false, "score": 4, "creation_date": 1480541564, "post_id": 40898557, "comment_id": 69010981, "body": "It&#39;s true more often than not"}, {"owner": {"reputation": 127444, "user_id": 492405, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SSPGk.png?s=128&g=1", "display_name": "vcsjones", "link": "https://stackoverflow.com/users/492405/vcsjones"}, "edited": false, "score": 1, "creation_date": 1480541748, "post_id": 40898557, "comment_id": 69011080, "body": "Even a slow machine can do this. <code>DateTime</code> does not have near the resolution to make it even close to unique."}], "answers": [{"tags": [], "owner": {"reputation": 3813, "user_id": 5588197, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206610955445736/picture?type=large", "display_name": "Jan Paolo Go", "link": "https://stackoverflow.com/users/5588197/jan-paolo-go"}, "is_accepted": true, "score": 19, "last_activity_date": 1480541525, "creation_date": 1480541525, "answer_id": 40898610, "question_id": 40898557, "link": "https://stackoverflow.com/questions/40898557/datetime-now-retrieval-speed/40898610#40898610", "title": "DateTime.Now retrieval speed", "body": "<p>Yes.</p>\n\n<blockquote>\n  <p>The resolution of this property depends on the system timer, which is\n  approximately 15 milliseconds on Windows systems.As a result, repeated\n  calls to the Now property in a short time interval, such as in a loop,\n  may return the same value.</p>\n</blockquote>\n\n<p>source: <a href=\"https://msdn.microsoft.com/en-us/library/system.datetime.now(v=vs.110).aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/system.datetime.now(v=vs.110).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "is_accepted": false, "score": 8, "last_activity_date": 1480541624, "creation_date": 1480541624, "answer_id": 40898634, "question_id": 40898557, "link": "https://stackoverflow.com/questions/40898557/datetime-now-retrieval-speed/40898634#40898634", "title": "DateTime.Now retrieval speed", "body": "<p>I just ran this script in LINQPad:</p>\n\n<pre><code>Enumerable.Range(1, 1000).Select(i =&gt; DateTime.Now == DateTime.Now).ToList()\n</code></pre>\n\n<p>After the first element, all the others are true. I'm guessing there's some latency involved in the first couple of calls to <code>DateTime.Now</code> which causes the check to often return false the first time you run it in a given application.</p>\n\n<p>But yes, that expression can (and often does) return true.</p>\n"}], "owner": {"reputation": 963, "user_id": 847769, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c557b37457d2312d0dda15e9006881b?s=128&d=identicon&r=PG", "display_name": "Yaman", "link": "https://stackoverflow.com/users/847769/yaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 1, "accepted_answer_id": 40898610, "answer_count": 2, "score": 10, "last_activity_date": 1480541624, "creation_date": 1480541341, "question_id": 40898557, "link": "https://stackoverflow.com/questions/40898557/datetime-now-retrieval-speed", "title": "DateTime.Now retrieval speed", "body": "<p>Is there any chance that this statement would return true</p>\n\n<pre><code>DateTime.Now == DateTime.Now\n</code></pre>\n\n<p>can a very fast machine return true for this statement, I tried on several machines and its always false ?</p>\n"}, {"tags": ["c#", "wcf", "azure-service-fabric", "stateless", "suffix"], "comments": [{"owner": {"reputation": 10811, "user_id": 5946937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a686518049226b2b0f0bbb1f334978e?s=128&d=identicon&r=PG&f=1", "display_name": "LoekD", "link": "https://stackoverflow.com/users/5946937/loekd"}, "edited": false, "score": 1, "creation_date": 1480577916, "post_id": 40898532, "comment_id": 69022755, "body": "did you follow the steps described here? <a href=\"https://msdn.microsoft.com/en-us/library/ms734772(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms734772(v=vs.110).aspx</a>"}, {"owner": {"reputation": 431, "user_id": 2065000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a4e3f6832ebc4756fe5c1f8c98572f0?s=128&d=identicon&r=PG", "display_name": "J. Abrahamsson", "link": "https://stackoverflow.com/users/2065000/j-abrahamsson"}, "reply_to_user": {"reputation": 10811, "user_id": 5946937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a686518049226b2b0f0bbb1f334978e?s=128&d=identicon&r=PG&f=1", "display_name": "LoekD", "link": "https://stackoverflow.com/users/5946937/loekd"}, "edited": false, "score": 0, "creation_date": 1481208425, "post_id": 40898532, "comment_id": 69291699, "body": "Thanks for the idea. It pushed me into the right way I think, even if it wasn&#39;t the answer... Might post the solution I used shortly."}], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 2065000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a4e3f6832ebc4756fe5c1f8c98572f0?s=128&d=identicon&r=PG", "display_name": "J. Abrahamsson", "link": "https://stackoverflow.com/users/2065000/j-abrahamsson"}, "is_accepted": true, "score": 0, "last_activity_date": 1481725073, "creation_date": 1481725073, "answer_id": 41144833, "question_id": 40898532, "link": "https://stackoverflow.com/questions/40898532/stateless-wcf-service-listener-on-same-port/41144833#41144833", "title": "Stateless WCF service listener on same port", "body": "<p>Ok, here is how I did this:</p>\n\n<p>I build a base class</p>\n\n<pre><code>public class StatelessServiceBase : StatelessService\n{\n    .\n    .\n    .\n\n    protected ICommunicationListener CreateListener(StatelessServiceContext context, object service, string interfaceName, AuthenticationInspector inspector = null)\n    {\n        Uri baseUri = new Uri($\"{Util.GetBaseServerAddress()}{service.GetType().Name}\");\n        ServiceHost serviceHost = new ServiceHost(service.GetType(), baseUri);\n        this.AddServiceEndpoint(serviceHost, service, interfaceName, inspector);\n        return new ServiceHostCommunicationListener(serviceHost, baseUri.AbsoluteUri);\n    }\n\n    private void AddServiceEndpoint(ServiceHost serviceHost, object service, string interfaceName, AuthenticationInspector inspector)\n    {\n        var binding = new WSHttpBinding(SecurityMode.None);\n        binding.SendTimeout = new TimeSpan(0, 10, 0);\n        binding.ReceiveTimeout = new TimeSpan(0, 10, 0);\n        binding.MaxBufferPoolSize = 2147483647;\n        binding.MaxReceivedMessageSize = 2147483647;\n        binding.ReaderQuotas = new System.Xml.XmlDictionaryReaderQuotas\n        {\n            MaxDepth = 2147483647,\n            MaxStringContentLength = 2147483647,\n            MaxArrayLength = 2147483647,\n            MaxBytesPerRead = 2147483647,\n            MaxNameTableCharCount = 2147483647\n        };\n\n        if (inspector == null)\n        {\n            serviceHost.AddServiceEndpoint(service.GetType().GetInterface(interfaceName), binding, string.Empty);\n        }\n        else\n        {\n            serviceHost.AddServiceEndpoint(service.GetType().GetInterface(interfaceName), binding, string.Empty).Behaviors.Add(inspector);\n        }\n    }\n}\n</code></pre>\n\n<p>And then I called the CreateListener from the stateless service class:</p>\n\n<pre><code>internal class MyStatelessService : StatelessServiceBase\n{\n    public MyStatelessService(StatelessServiceContext context)\n        : base(context)\n    {\n    }\n\n    protected override IEnumerable&lt;ServiceInstanceListener&gt; CreateServiceInstanceListeners()\n    {\n        yield return new ServiceInstanceListener(context =&gt;\n                 this.CreateListener(context, new MyService(), \"IMyService\", new AuthenticationInspector()));\n    }\n}\n</code></pre>\n\n<p>And the Settings.xml looked like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;Settings xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://schemas.microsoft.com/2011/01/fabric\"&gt;\n  &lt;Section Name=\"Configuration\"&gt;\n    &lt;Parameter Name=\"BaseServerAddress\" Value=\"http://localhost:9000/\"/&gt;\n  &lt;/Section&gt;\n&lt;/Settings&gt;\n</code></pre>\n\n<p>Together with the reader function:</p>\n\n<pre><code>public class Util\n{\n    internal static string GetBaseServerAddress()\n    {\n        var configurationPackage = FabricRuntime.GetActivationContext().GetConfigurationPackageObject(\"Config\");\n\n        var baseServerAddress =\n            configurationPackage.Settings.Sections[\"Configuration\"].Parameters[\"BaseServerAddress\"];\n\n        return baseServerAddress.Value;\n    }\n}\n</code></pre>\n\n<p>Adding multiple services in service fabric and... Working like a charm! :)</p>\n"}], "owner": {"reputation": 431, "user_id": 2065000, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4a4e3f6832ebc4756fe5c1f8c98572f0?s=128&d=identicon&r=PG", "display_name": "J. Abrahamsson", "link": "https://stackoverflow.com/users/2065000/j-abrahamsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 41144833, "answer_count": 1, "score": 0, "last_activity_date": 1481725073, "creation_date": 1480541270, "question_id": 40898532, "link": "https://stackoverflow.com/questions/40898532/stateless-wcf-service-listener-on-same-port", "title": "Stateless WCF service listener on same port", "body": "<p>We have a situation where we have been using ordinary windows service based on WCF where we host a number of listeners on the same address, port with just additional suffix on the address, such as:</p>\n\n<pre><code>http://localhost:9000/&lt;listener1_name&gt;/\nhttp://localhost:9000/&lt;listener2_name&gt;/\nhttp://localhost:9000/&lt;listener3_name&gt;/\nhttp://localhost:9000/&lt;listener4_name&gt;/\n</code></pre>\n\n<p>However, now that we like to move over to asuze by using service fabric we like to take it step by step.\nAnd one of the step is to move this windows service into the Service Fabric environment...</p>\n\n<p>What I fail to do is as you might realise, to setup a number of stateless services that listen to the same port, but with different suffix.</p>\n\n<p>I thought that the <code>PathSuffix</code> attribute in the <code>EndPoint</code> would do the trick, but I get only one of the services up and running. The others states clearly that the port is already taken.</p>\n\n<p>Hoped this would work:</p>\n\n<pre><code>&lt;Resources&gt;\n  &lt;Endpoints&gt;\n    &lt;Endpoint Name=\"WcfService1Endpoint\" Protocol=\"tcp\" Port=\"9000\" PathSuffix=\"Service1ListenerName\" /\n  &lt;Endpoints&gt;\n&lt;/Resources&gt;\n</code></pre>\n\n<p>and then in the next:</p>\n\n<pre><code>&lt;Resources&gt;\n  &lt;Endpoints&gt;\n    &lt;Endpoint Name=\"WcfService2Endpoint\" Protocol=\"tcp\" Port=\"9000\" PathSuffix=\"Service2ListenerName\" /&gt;\n  &lt;Endpoints&gt;\n&lt;/Resources&gt;\n</code></pre>\n\n<p>Etc, etc... </p>\n\n<p>Is there any other way to solve my situation, or do I need to change the whole structure now?</p>\n\n<p>Hoping someone out there has solved this!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", ".net", "excel"], "comments": [{"owner": {"reputation": 10665, "user_id": 1288589, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/9ACqB.jpg?s=128&g=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/1288589/greg"}, "edited": false, "score": 0, "creation_date": 1480544564, "post_id": 40898518, "comment_id": 69012390, "body": "The short answer, yes you can detect and even modify the cell.  But to create conditional logic to account for a lot of what you speak, will be a pain."}], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 6856458, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--ZrEJ-zJfxU/AAAAAAAAAAI/AAAAAAAAAK0/oPYd4A-f4Gg/photo.jpg?sz=128", "display_name": "Darthchai", "link": "https://stackoverflow.com/users/6856458/darthchai"}, "is_accepted": true, "score": 1, "last_activity_date": 1480551044, "creation_date": 1480551044, "answer_id": 40900511, "question_id": 40898518, "link": "https://stackoverflow.com/questions/40898518/can-you-programatically-detect-text-colors-in-an-excel-doc-and-modify-only-cells/40900511#40900511", "title": "Can you programatically detect text colors in an excel doc and modify only cells with text of a specific color and font style?", "body": "<p>Before retrieving you can check like below:</p>\n\n<pre><code> if (excelWorkSheet.Range[\"E\"].Font.Strikethrough == true &amp;&amp; excelWorkSheet.Range[\"E\"].Interior.Color = 255)\n            excelWorkSheet.Range[\"E\"].Value == \"\";\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7226534, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/98e5ec8bcfa233c61ceed9ec13fc23a3?s=128&d=identicon&r=PG&f=1", "display_name": "LifeOf0sAnd1s", "link": "https://stackoverflow.com/users/7226534/lifeof0sand1s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 40900511, "answer_count": 1, "score": 2, "last_activity_date": 1480551044, "creation_date": 1480541215, "question_id": 40898518, "link": "https://stackoverflow.com/questions/40898518/can-you-programatically-detect-text-colors-in-an-excel-doc-and-modify-only-cells", "title": "Can you programatically detect text colors in an excel doc and modify only cells with text of a specific color and font style?", "body": "<p>I have a requirement where an excel document needs to be scrubbed based on multiple rules; one of those is to programatically delete all cells with red text and strikethrough font style in a given column. Once you access your excel doc in C# using the Microsoft.Office.Interop.Excel library, is there a way to detect what color a cell's text is and font style applied, and delete the cell if its text is red with strikethrough style?</p>\n\n<pre><code>public static void GetExcelFile() {\n        //Establish COM Objects\n        Excel.Application excelApp = new Excel.Application();\n        Excel.Workbook excelWorkBook = excelApp.Workbooks.Open(@\"\\MyExcelBook.xlsx\");\n        Excel._Worksheet excelWorkSheet = excelWorkBook.Sheet[1];\n        Excel.Range excelRange = excelWorkSheet.UsedRange;\n\n        //Retrieve Column E\n        object[] columnE = excelWorkSheet.Range[\"E\"].Values2;\n\n        //Scrub Column E\n        //Remove expired codes (signified by red font and strikethrough)\n\n        //Remove  Whitespace\n        string trColumnE = columnE.ToString();\n        string[] strColumnE = trColumnE.Replace(\" \", \"\").Split(',');\n</code></pre>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 2, "creation_date": 1480541310, "post_id": 40898436, "comment_id": 69010840, "body": "Do you have any other GameObject called <code>Frog</code> in your scene? Look carefully... Also, please include the complete code of how you are using it in the Update function"}, {"owner": {"reputation": 1073, "user_id": 403887, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e1fa746450f557cff1c59e7bd5154413?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/403887/tom"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1480541601, "post_id": 40898436, "comment_id": 69010995, "body": "The code stops at <code>if (controller.isGrounded) {</code> in Update."}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1480541724, "post_id": 40898436, "comment_id": 69011062, "body": "You can put the update function in your question"}, {"owner": {"reputation": 1073, "user_id": 403887, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e1fa746450f557cff1c59e7bd5154413?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/403887/tom"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1480541804, "post_id": 40898436, "comment_id": 69011116, "body": "Updated the question"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1480541888, "post_id": 40898436, "comment_id": 69011163, "body": "That&#39; your whole Update function code? controller variable is not being accessed/assigned from another function? Finally, did you import any model from any 3D software?"}, {"owner": {"reputation": 1073, "user_id": 403887, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e1fa746450f557cff1c59e7bd5154413?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/403887/tom"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1480542017, "post_id": 40898436, "comment_id": 69011218, "body": "Updated code for more clarity. Object is from an FBX. If I restart Unity, everything works. It then randomly brings up the missingexception."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1480542180, "post_id": 40898436, "comment_id": 69011291, "body": "Instead of using <code>GameObject.Find(&quot;Frog&quot;)</code> try using <code>GameObject.FindWithTag(&quot;Frog&quot;)</code> and add the tag &quot;Frog&quot; to the frog object."}, {"owner": {"reputation": 1073, "user_id": 403887, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e1fa746450f557cff1c59e7bd5154413?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/403887/tom"}, "edited": false, "score": 0, "creation_date": 1480542334, "post_id": 40898436, "comment_id": 69011358, "body": "Adding the tag worked... so why is this happening?"}], "answers": [{"comments": [{"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1480542610, "post_id": 40898830, "comment_id": 69011502, "body": "Just like I asked if OP had two GameObjects named &quot;Frog&quot;. That was never answered."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1480542657, "post_id": 40898830, "comment_id": 69011530, "body": "@Programmer considering he responded with <code>GameObject.FindWithTag(&quot;Frog&quot;)</code> fixing the problem in the comments when I asked him about that I think the implied answer to your question is &quot;Yes I do have two things named Frog&quot;"}, {"owner": {"reputation": 103866, "user_id": 3785314, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/sh4Al.png?s=128&g=1", "display_name": "Programmer", "link": "https://stackoverflow.com/users/3785314/programmer"}, "edited": false, "score": 0, "creation_date": 1480542794, "post_id": 40898830, "comment_id": 69011604, "body": "OP responded with <code>if (controller.isGrounded) {</code> on that question but yes, this is the fix for the problem."}, {"owner": {"reputation": 1073, "user_id": 403887, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e1fa746450f557cff1c59e7bd5154413?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/403887/tom"}, "edited": false, "score": 0, "creation_date": 1480542816, "post_id": 40898830, "comment_id": 69011612, "body": "<a href=\"http://i.imgur.com/Vfwb9L5.jpg\" rel=\"nofollow noreferrer\">Here&#39;s the rub</a> I do not have another GameObject named <code>Frog</code>"}, {"owner": {"reputation": 1073, "user_id": 403887, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e1fa746450f557cff1c59e7bd5154413?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/403887/tom"}, "edited": false, "score": 0, "creation_date": 1480544457, "post_id": 40898830, "comment_id": 69012354, "body": "Now it stopped working after I was tweaking params in Animator. There must be something wrong with the FBX file."}], "tags": [], "owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "is_accepted": true, "score": 4, "last_activity_date": 1480542526, "creation_date": 1480542526, "answer_id": 40898830, "question_id": 40898436, "link": "https://stackoverflow.com/questions/40898436/getcomponent-returning-null/40898830#40898830", "title": "GetComponent returning null", "body": "<p>Instead of using <code>GameObject.Find(\"Frog\")</code> try using <code>GameObject.FindWithTag(\"Frog\")</code> and add the tag \"Frog\" to the frog object.</p>\n\n<p>The reason you are having this happen is somehow, somewhere, a 2nd object named \"Frog\" is added to the scene. When this happens Unity will randomly pick one of the two objects it found, this will cause it to work sometimes but not other times.</p>\n\n<p>By switching to a tag you make it more likely that the object will be identified uniquely.</p>\n"}], "owner": {"reputation": 1073, "user_id": 403887, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/e1fa746450f557cff1c59e7bd5154413?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/403887/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2091, "favorite_count": 0, "accepted_answer_id": 40898830, "answer_count": 1, "score": 3, "last_activity_date": 1480542526, "creation_date": 1480540907, "last_edit_date": 1480541903, "question_id": 40898436, "link": "https://stackoverflow.com/questions/40898436/getcomponent-returning-null", "title": "GetComponent returning null", "body": "<p>In both Unity 5.4/5.5, I'm having an issue with GetComponent not returning the CharacterController of my GameObject for some reason. After I restart Unity, it works again.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WOO34.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WOO34.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>_MAIN runs this script:</p>\n\n<pre><code>private GameObject frog;\nprivate CharacterController controller;\n\nvoid Start () {\n    frog = GameObject.Find (\"Frog\");\n    controller = frog.GetComponent&lt;CharacterController&gt; ();\n\n    Debug.Log(controller); // returns null\n}\n\nvoid Update () {\n    if (controller.isGrounded) {\n        // error is thrown\n    }\n}\n</code></pre>\n\n<p>After the <code>controller</code> is referenced in Update, I get the error:</p>\n\n<blockquote>\n  <p>MissingComponentException: There is no 'CharacterController' attached to the \"Frog\" game object,</p>\n</blockquote>\n\n<p>FYI, <code>frog</code> is returning the GameObject just fine.</p>\n"}, {"tags": ["c#", ".net", "windows", "visual-studio", "user-interface"], "comments": [{"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 0, "creation_date": 1480541089, "post_id": 40898380, "comment_id": 69010731, "body": "You should try to create something first and come back with specific issues as you encounter them. You seem to have an idea already; Have you not tried it out? What are you struggling with?"}, {"owner": {"reputation": 31, "user_id": 7121296, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f2bf7c8f4680555eb7dfd0ebd1c432f?s=128&d=identicon&r=PG&f=1", "display_name": "Avendor7", "link": "https://stackoverflow.com/users/7121296/avendor7"}, "reply_to_user": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 0, "creation_date": 1480557909, "post_id": 40898380, "comment_id": 69016524, "body": "@DangerZone I was mostly concerned with whether that idea (custom control) was good or not and what the best practices are for this situation. I don&#39;t really want to spend the time working on something only to find won&#39;t work and there was a better way from the beginning."}], "owner": {"reputation": 31, "user_id": 7121296, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2f2bf7c8f4680555eb7dfd0ebd1c432f?s=128&d=identicon&r=PG&f=1", "display_name": "Avendor7", "link": "https://stackoverflow.com/users/7121296/avendor7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480540713, "creation_date": 1480540713, "last_edit_date": 1592644375, "question_id": 40898380, "link": "https://stackoverflow.com/questions/40898380/dynamic-form-with-resizing-in-c-net", "title": "Dynamic form with resizing in C# .net", "body": "<p>As a learning project in C# .net I am re-creating a <a href=\"https://extensions.gnome.org/extension/1078/twitchlive-panel/\" rel=\"nofollow noreferrer\">Gnome 3 plugin</a> for seeing who of the streamers you follow on Twitch is live. I have the settings form done, I am now working on the interface that is viewed from a click on the taskbar.</p>\n<p><a href=\"https://i.stack.imgur.com/hswOJ.png\" rel=\"nofollow noreferrer\">This is a rough image of what I want the interface to look like.</a> When two or more streamers are live the interface would add another block and resize the form vertically similar to the menu for selecting a Wifi network in Windows.</p>\n<p>What would be the best way for me to complete this?</p>\n<p>My current thought is to maybe create a custom control and just place those inside a FlowLayoutPanel with some kind of code to change the vertical size of the form to match the added entries. Maybe this can be done without a custom control and be done with code inside a FlowLayoutPanel? I'm not too sure.</p>\n<p>Ideally I would also have a click event in the panel for each streamer so I could then open a browser to their channel. A slight highlight would also be a plus (maybe change the background colour based on mouse hover).</p>\n<p>Thanks in advance for any suggestions!</p>\n"}, {"tags": ["c#", "excel"], "comments": [{"owner": {"reputation": 2064, "user_id": 6489036, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3c1c530c3d4afd8e5e0302cdc5edc236?s=128&d=identicon&r=PG&f=1", "display_name": "rbr94", "link": "https://stackoverflow.com/users/6489036/rbr94"}, "edited": false, "score": 0, "creation_date": 1480541069, "post_id": 40898372, "comment_id": 69010726, "body": "Probably the values are not seen as <code>string</code>? It seems that they are somehow converted to numeric type."}, {"owner": {"reputation": 23, "user_id": 7233053, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LO_emtkry34/AAAAAAAAAAI/AAAAAAAAAHI/lnWnXsse_rU/photo.jpg?sz=128", "display_name": "Amr Alshazli", "link": "https://stackoverflow.com/users/7233053/amr-alshazli"}, "reply_to_user": {"reputation": 2064, "user_id": 6489036, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3c1c530c3d4afd8e5e0302cdc5edc236?s=128&d=identicon&r=PG&f=1", "display_name": "rbr94", "link": "https://stackoverflow.com/users/6489036/rbr94"}, "edited": false, "score": 0, "creation_date": 1480541178, "post_id": 40898372, "comment_id": 69010779, "body": "any Idea how to prevent that without hard-coding the Excel?"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 1, "creation_date": 1480543572, "post_id": 40898372, "comment_id": 69011961, "body": "Add <code>IMEX=1</code> to your <code>Extended Properties</code> section to treat all columns as text columns.  Without it the data type is inferred by the Jet provider (sometimes incorrectly)"}, {"owner": {"reputation": 23, "user_id": 7233053, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LO_emtkry34/AAAAAAAAAAI/AAAAAAAAAHI/lnWnXsse_rU/photo.jpg?sz=128", "display_name": "Amr Alshazli", "link": "https://stackoverflow.com/users/7233053/amr-alshazli"}, "edited": false, "score": 0, "creation_date": 1480544046, "post_id": 40898372, "comment_id": 69012176, "body": "D Stanley, correct , Thank you, can you post it and i will mark it as answer"}, {"owner": {"reputation": 23, "user_id": 7233053, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LO_emtkry34/AAAAAAAAAAI/AAAAAAAAAHI/lnWnXsse_rU/photo.jpg?sz=128", "display_name": "Amr Alshazli", "link": "https://stackoverflow.com/users/7233053/amr-alshazli"}, "edited": false, "score": 0, "creation_date": 1480544769, "post_id": 40898372, "comment_id": 69012469, "body": "D Stanley, it worked fine , but when I made the list start with 15 number first, it didn&#39;t work."}, {"owner": {"reputation": 23, "user_id": 7233053, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LO_emtkry34/AAAAAAAAAAI/AAAAAAAAAHI/lnWnXsse_rU/photo.jpg?sz=128", "display_name": "Amr Alshazli", "link": "https://stackoverflow.com/users/7233053/amr-alshazli"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1480545133, "post_id": 40898372, "comment_id": 69012656, "body": "It seems like making both <b>HDR=NO</b>  and <b>IMEX=1</b> in your <b>Extended Properties</b> will fix the problem.   Thanks @DStanley"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1480545184, "post_id": 40898372, "comment_id": 69012681, "body": "If your data does not have a header row then yes <code>HDR=NO</code> is appropriate."}, {"owner": {"reputation": 23, "user_id": 7233053, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LO_emtkry34/AAAAAAAAAAI/AAAAAAAAAHI/lnWnXsse_rU/photo.jpg?sz=128", "display_name": "Amr Alshazli", "link": "https://stackoverflow.com/users/7233053/amr-alshazli"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1480546503, "post_id": 40898372, "comment_id": 69013269, "body": "how about if a data with header, what do you recommend @DStanley"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1480546537, "post_id": 40898372, "comment_id": 69013287, "body": "@AmrAlshazli <code>HDR=YES</code>"}, {"owner": {"reputation": 23, "user_id": 7233053, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LO_emtkry34/AAAAAAAAAAI/AAAAAAAAAHI/lnWnXsse_rU/photo.jpg?sz=128", "display_name": "Amr Alshazli", "link": "https://stackoverflow.com/users/7233053/amr-alshazli"}, "reply_to_user": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1480546804, "post_id": 40898372, "comment_id": 69013377, "body": "@DStanley but it will only work on up to 8 rows, if all 8 are numbers, the problem will happen again."}], "answers": [{"tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": true, "score": 0, "last_activity_date": 1480545314, "creation_date": 1480545314, "answer_id": 40899514, "question_id": 40898372, "link": "https://stackoverflow.com/questions/40898372/c-issue-while-importing-excel-sheets/40899514#40899514", "title": "C# Issue while importing Excel sheets", "body": "<p>Use <code>IMEX=1</code> in your extended properties to treat all columns as text values.  Without it, the Jet provider will infer a data type based on whatever type the majority of the values in that column is, which may not be correct.</p>\n\n<p>Secondly, since your data does not have a header row, you should use <code>HDR=NO</code> in your extended properties as well.</p>\n"}], "owner": {"reputation": 23, "user_id": 7233053, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LO_emtkry34/AAAAAAAAAAI/AAAAAAAAAHI/lnWnXsse_rU/photo.jpg?sz=128", "display_name": "Amr Alshazli", "link": "https://stackoverflow.com/users/7233053/amr-alshazli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "accepted_answer_id": 40899514, "answer_count": 1, "score": 2, "last_activity_date": 1480545314, "creation_date": 1480540680, "question_id": 40898372, "link": "https://stackoverflow.com/questions/40898372/c-issue-while-importing-excel-sheets", "title": "C# Issue while importing Excel sheets", "body": "<p>I've searched the internet for this and couldn't really find a question like it.I am coding an application that takes data from Excel and view it.\nAll of my tests were correct, but suddenly I found that Importing a column  that contains set of numbers in a row then letters will result in not showing the fields that contain those letters at all</p>\n\n<pre><code>PathConn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" + FilePath + \";Extended Properties=\\\"Excel 8.0;HDR=Yes;\\\";\";\n\n        OleDbConnection conn = new OleDbConnection(PathConn);\n        System.Data.DataTable dtSchema = new System.Data.DataTable();\n\n        conn.Open();\n        dtSchema = conn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, new object[] { null, null, null, \"TABLE\" });\n        string Sheet1 = dtSchema.Rows[0].Field&lt;string&gt;(\"TABLE_NAME\");\n\n        conn.Close();\n        OleDbDataAdapter myDataAdapter = new OleDbDataAdapter(\"Select * from [\" + Sheet1 + \"]\", conn);\n        DataSet ds = new DataSet();\n        myDataAdapter.Fill(ds);\n</code></pre>\n\n<p>the first dataset is the regular result</p>\n\n<pre>\n7841\n7847s\n2344\n2262\n7738\nJD32916\nJD329161\nJD318161\nJD31716\nJD7643\nJD21116\n7194\n</pre>\n\n<p>the second dataset is the problematic result (notice that I removed the 's' from \"7847s\")</p>\n\n<pre>\n7841\n7847\n2344\n2262\n7738\n\n\n\n\n\n\n7194\n</pre>\n\n<p>as you can see, all the fields with letters in them just disappeared,\nit only happens where there are 5 or more consecutive fields with no letters in them. example (2nd number from the top contains 's' to prevent that error from happening)  </p>\n"}, {"tags": ["c#", "asp.net", "entity-framework", "entity-framework-core"], "answers": [{"comments": [{"owner": {"reputation": 2763, "user_id": 4901556, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/WwVta.jpg?s=128&g=1", "display_name": "RyeGuy", "link": "https://stackoverflow.com/users/4901556/ryeguy"}, "edited": false, "score": 2, "creation_date": 1480541986, "post_id": 40898681, "comment_id": 69011203, "body": "You are the man! Just ran it and got an error on the Child class as well. I am going to use this example moving forward. Thank You!"}, {"owner": {"reputation": 527, "user_id": 3324478, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/f478a3646c4b163a9628e863660d6c99?s=128&d=identicon&r=PG&f=1", "display_name": "kiml42", "link": "https://stackoverflow.com/users/3324478/kiml42"}, "edited": false, "score": 19, "creation_date": 1527863567, "post_id": 40898681, "comment_id": 88301935, "body": "Probably worth mentioning that this is on the DBContext, rather than the Attends object, in case that&#39;s not obvious to anyone else."}, {"owner": {"reputation": 1612, "user_id": 1955268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNvCE.jpg?s=128&g=1", "display_name": "Priyank Panchal", "link": "https://stackoverflow.com/users/1955268/priyank-panchal"}, "edited": false, "score": 6, "creation_date": 1565176756, "post_id": 40898681, "comment_id": 101268170, "body": "Any idea why this cannot be done using annotation? Why are we forced to use fluent API?"}, {"owner": {"reputation": 59348, "user_id": 522663, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/OKOEw.png?s=128&g=1", "display_name": "Jonathan Wood", "link": "https://stackoverflow.com/users/522663/jonathan-wood"}, "reply_to_user": {"reputation": 1612, "user_id": 1955268, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hNvCE.jpg?s=128&g=1", "display_name": "Priyank Panchal", "link": "https://stackoverflow.com/users/1955268/priyank-panchal"}, "edited": false, "score": 0, "creation_date": 1590085145, "post_id": 40898681, "comment_id": 109553972, "body": "@PriyankPanchal: Because Microsoft <i>improved</i> things. Apparently, it worked just fine before Core."}], "tags": [], "owner": {"reputation": 50111, "user_id": 1077309, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/yghA4.jpg?s=128&g=1", "display_name": "Sampath", "link": "https://stackoverflow.com/users/1077309/sampath"}, "is_accepted": true, "score": 176, "last_activity_date": 1594826100, "last_edit_date": 1594826100, "creation_date": 1480541772, "answer_id": 40898681, "question_id": 40898365, "link": "https://stackoverflow.com/questions/40898365/asp-net-add-migration-composite-primary-key-error-how-to-use-fluent-api/40898681#40898681", "title": "ASP.NET add migration &#39;composite primary key error&#39; how to use fluent API", "body": "<p>On <strong>EF core ..</strong></p>\n<blockquote>\n<p>Composite keys can only be configured using the Fluent API -\nconventions will never setup a composite key and you can not use Data\nAnnotations to configure one.</p>\n</blockquote>\n<p>Here is the <strong>Fluent API</strong> version :</p>\n<p><em><strong>Note:</strong></em> This is just an example. Please adjust it according to your use case.</p>\n<pre><code>// (In the DbContext subclass)\nprotected override void OnModelCreating(ModelBuilder modelBuilder)\n{\n    modelBuilder.Entity&lt;Attends&gt;()\n        .HasKey(c =&gt; new { c.FarmerSS, c. HotelID });\n}\n</code></pre>\n<p>You can read more about it here : <a href=\"https://docs.microsoft.com/en-us/ef/core/modeling/keys?tabs=fluent-api\" rel=\"noreferrer\"><strong>composite key</strong></a></p>\n"}], "owner": {"reputation": 2763, "user_id": 4901556, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/WwVta.jpg?s=128&g=1", "display_name": "RyeGuy", "link": "https://stackoverflow.com/users/4901556/ryeguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40639, "favorite_count": 11, "accepted_answer_id": 40898681, "answer_count": 1, "score": 78, "last_activity_date": 1594826100, "creation_date": 1480540661, "last_edit_date": 1480541812, "question_id": 40898365, "link": "https://stackoverflow.com/questions/40898365/asp-net-add-migration-composite-primary-key-error-how-to-use-fluent-api", "title": "ASP.NET add migration &#39;composite primary key error&#39; how to use fluent API", "body": "<p>Hello I am in the process of creating a Web Application and have already installed both the <em>Microsoft.entityFrameworkCore</em> and <em>Microsoft.entityFrameworkCore.Tools</em>.</p>\n\n<p>During the process of executing an add-migration in the package manager console I get an error </p>\n\n<p>\"<strong>System.InvalidOperationException: Entity type 'Attends' has composite primary key defined with data annotations. To set composite primary key, use fluent API</strong>\"</p>\n\n<p>Here is my code in the entity folder.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel.DataAnnotations;\nusing System.ComponentModel.DataAnnotations.Schema;\nusing System.Linq;\nusing System.Threading.Tasks;\n\nnamespace _3241_farmDb.Entities\n{\n\n    public class Farm\n    {\n        [Required, MaxLength(30)]\n        [Key]\n        public string FarmName { get; set; }\n        [Required, MaxLength(15)]\n        public string FarmCity { get; set; }\n        [Required, MaxLength(9)]\n        public string FarmerSSN { get; set; }\n    }\n    public class Farmer\n    {\n        [Required, MaxLength(9)]\n        [Key]\n        public int SS { get; set; }\n        [Required, MaxLength(9)]\n        public string Fname { get; set; }\n        [Required, MaxLength(15)]\n        public string Lname { get; set; }\n        [Required, MaxLength(15)]\n        public string CityName { get; set; }\n        [Required, MaxLength(15)]\n        public string Address { get; set; }\n        [Required, MaxLength(30)]\n        public string BoardPositionName { get; set; }\n    }\n    public class Child\n    {\n        [Required, MaxLength(9)]\n        [Key]\n        public int FarmerSS { get; set; }\n        [Required, MaxLength(15)]\n        [Key]\n        public string Fname { get; set; }\n        [Required, MaxLength(15)]\n        [Key]\n        public string Lname { get; set; }\n        [Required]\n        public int Age { get; set; }\n    }\n    public class Attends\n    {\n\n        [Key, Column(Order = 1)]\n        public int FarmerSS { get; set; }\n        [Key, Column(Order = 2)]\n        public int HotelID { get; set; }\n        [Required, MaxLength(15)]\n        public string BoardPosition { get; set; }\n    }\n\n    public class Livestock\n    {\n        [Required, MaxLength(15)]\n        public int LivestockID { get; set; }\n        [Required, MaxLength(15)]\n        public string LivestockType { get; set; }\n    }\n    public class Farm_Houses\n    {\n        [Required, MaxLength(15)]\n        [Key]\n        public int LivestockID { get; set; }\n        [Required, MaxLength(15)]\n        public string FarmName { get; set; }\n    }\n    public class Crops\n    {\n        [Required, MaxLength(15)]\n        [Key]\n        public int CropID { get; set; }\n        [Required, MaxLength(15)]\n        public string CropName { get; set; }\n    }\n}\n</code></pre>\n\n<p>How do I adjust it to set the composite key properly?</p>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 1, "creation_date": 1480541806, "post_id": 40898321, "comment_id": 69011118, "body": "If all relevant objects have colliders, you can retrieve them with <a href=\"https://docs.unity3d.com/ScriptReference/Physics.OverlapSphere.html\" rel=\"nofollow noreferrer\"><code>Physics.OverlapSphere()</code></a>."}, {"owner": {"reputation": 105, "user_id": 7233137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-GszHHJiasHk/AAAAAAAAAAI/AAAAAAAAABk/Ig_CO_denEY/photo.jpg?sz=128", "display_name": "Peyton", "link": "https://stackoverflow.com/users/7233137/peyton"}, "reply_to_user": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 0, "creation_date": 1480542434, "post_id": 40898321, "comment_id": 69011406, "body": "what if they are not overlapping with the box collider of the grenade though? Serlite"}, {"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 0, "creation_date": 1480542519, "post_id": 40898321, "comment_id": 69011451, "body": "That&#39;s not how <code>OverlapSphere()</code> works - you specify a position (probably where your grenade is) and a radius, and it checks for all colliders within that spherical area."}, {"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 0, "creation_date": 1480542882, "post_id": 40898321, "comment_id": 69011644, "body": "Happy to help out! I&#39;ve put all the information together into a proper answer - if you&#39;re satisfied with it, you can accept it by clicking the checkmark next to it and your question will be marked as solved. (Welcome to Stack Overflow, by the way.)"}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 7219335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ffl3f.jpg?s=128&g=1", "display_name": "infmja", "link": "https://stackoverflow.com/users/7219335/infmja"}, "edited": false, "score": 0, "creation_date": 1483621662, "post_id": 40898901, "comment_id": 70176745, "body": "This is way better than my approach... didn&#39;t know about this until I had to use it in my own game and searched for a specific function which does that. Ended up using the Physics.OverlapSphere function."}], "tags": [], "owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "is_accepted": true, "score": 2, "last_activity_date": 1480542809, "creation_date": 1480542809, "answer_id": 40898901, "question_id": 40898321, "link": "https://stackoverflow.com/questions/40898321/what-is-the-best-way-to-determine-if-there-are-any-gameobjects-inside-a-certain/40898901#40898901", "title": "What is the best way to determine if there are any GameObjects inside a certain area", "body": "<p>If all the objects you want to detect have colliders attached to them, you can use <a href=\"https://docs.unity3d.com/ScriptReference/Physics.OverlapSphere.html\" rel=\"nofollow noreferrer\"><code>Physics.OverlapSphere()</code></a>. Just supply it a position and a radius to retrieve all colliders within a spherical area:</p>\n\n<pre><code>Collider[] hitColliders = Physics.OverlapSphere(grenadePosition, explosionRadius);\n</code></pre>\n\n<p>Then you can loop through them and apply damage as needed. Hope this helps! Let me know if you have any questions.</p>\n"}, {"tags": [], "owner": {"reputation": 170, "user_id": 7219335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ffl3f.jpg?s=128&g=1", "display_name": "infmja", "link": "https://stackoverflow.com/users/7219335/infmja"}, "is_accepted": false, "score": 2, "last_activity_date": 1480549232, "creation_date": 1480549232, "answer_id": 40900255, "question_id": 40898321, "link": "https://stackoverflow.com/questions/40898321/what-is-the-best-way-to-determine-if-there-are-any-gameobjects-inside-a-certain/40900255#40900255", "title": "What is the best way to determine if there are any GameObjects inside a certain area", "body": "<p>I think the best way to approach this is, as you already said, to have the objects in an array.<br>\nI would set the tag \"Enemy\" for the enemies and then loop through all gameobjects which are tagged with \"Enemy\".  </p>\n\n<pre><code>foreach(GameObject gameObj in GameObject.FindGameObjectsWithTag(\"Enemy\") {\n     // check if the current gameObj is in a certain range of your grenade object\n}\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 7233137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-GszHHJiasHk/AAAAAAAAAAI/AAAAAAAAABk/Ig_CO_denEY/photo.jpg?sz=128", "display_name": "Peyton", "link": "https://stackoverflow.com/users/7233137/peyton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 40898901, "answer_count": 2, "score": 1, "last_activity_date": 1534867775, "creation_date": 1480540503, "last_edit_date": 1534867775, "question_id": 40898321, "link": "https://stackoverflow.com/questions/40898321/what-is-the-best-way-to-determine-if-there-are-any-gameobjects-inside-a-certain", "title": "What is the best way to determine if there are any GameObjects inside a certain area", "body": "<p>I'm making a game in which I know would want to embed grenades. What would be the best way to find all game objects within a certain radius from the grenade before it explodes? I have already seen that one way is too have all enemies/opponents in an array and then loop through the array to see how many would be within a certain area but I was wondering if there would be a better way to approach this.</p>\n\n<p>Edit:</p>\n\n<p>Hello, please if you see this, vote this question up for some reason I was banned for a fine question which only got 1-. (most likely because it was my first question so my account was very susceptible to being banned) It originally said it was only a 1 day ban but apparently not as it has been two days already....</p>\n"}, {"tags": ["c#", "unity3d", "unity5"], "answers": [{"comments": [{"owner": {"reputation": 194, "user_id": 1422934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89dcdf6eb57142e25ce2320f484b9fbc?s=128&d=identicon&r=PG", "display_name": "Sindri J&#243;elsson", "link": "https://stackoverflow.com/users/1422934/sindri-j%c3%b3elsson"}, "edited": false, "score": 0, "creation_date": 1480583657, "post_id": 40901893, "comment_id": 69025683, "body": "I was sick at home and bored."}, {"owner": {"reputation": 194, "user_id": 1422934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89dcdf6eb57142e25ce2320f484b9fbc?s=128&d=identicon&r=PG", "display_name": "Sindri J&#243;elsson", "link": "https://stackoverflow.com/users/1422934/sindri-j%c3%b3elsson"}, "reply_to_user": {"reputation": 1201, "user_id": 2642226, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e9d5fa09e256c4f848594193348bd502?s=128&d=identicon&r=PG", "display_name": "Andrio", "link": "https://stackoverflow.com/users/2642226/andrio"}, "edited": false, "score": 0, "creation_date": 1480588343, "post_id": 40901893, "comment_id": 69028950, "body": "@Andrio The new 5.5 version of Unity has added this functionality, I&#39;ve updated my answer to mention it."}], "tags": [], "owner": {"reputation": 194, "user_id": 1422934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89dcdf6eb57142e25ce2320f484b9fbc?s=128&d=identicon&r=PG", "display_name": "Sindri J&#243;elsson", "link": "https://stackoverflow.com/users/1422934/sindri-j%c3%b3elsson"}, "is_accepted": true, "score": 6, "last_activity_date": 1509374789, "last_edit_date": 1592644375, "creation_date": 1480561031, "answer_id": 40901893, "question_id": 40898310, "link": "https://stackoverflow.com/questions/40898310/get-name-of-next-scene-in-build-settings-in-unity3d/40901893#40901893", "title": "Get name of next Scene in build settings in Unity3D?", "body": "<p>As of Unity 5.5 this should work, if you are on an earlier version see below.</p>\n<p>The most straightforward approach most people would try first is to use <a href=\"https://docs.unity3d.com/ScriptReference/SceneManagement.SceneManager.GetSceneByBuildIndex.html\" rel=\"nofollow noreferrer\"><code>SceneManager.GetSceneByBuildIndex(buildIndex)</code></a> because it returns a <code>Scene</code> object with a name property.</p>\n<p>However... the documentation for it mentions:</p>\n<blockquote>\n<p>This method will return a valid Scene if a scene has been added to the build settings at the given build index AND the scene is loaded. If it has not been loaded yet the SceneManager cannot return a valid Scene.</p>\n</blockquote>\n<p>But all is not lost because there is also <a href=\"https://docs.unity3d.com/ScriptReference/SceneManagement.SceneUtility.GetScenePathByBuildIndex.html\" rel=\"nofollow noreferrer\"><code>SceneUtility.GetScenePathByBuildIndex(buildIndex)</code></a> which doesn't depend on the scene being already loaded. It returns a project relative path to the scene which we can extract a scene-name from.</p>\n<pre><code>public static class SceneUtilityEx\n{\n    public static string GetNextSceneName()\n    {\n        var nextSceneIndex = SceneManager.GetActiveScene().buildIndex + 1;\n\n        if (nextSceneIndex &lt; SceneManager.sceneCountInBuildSettings)\n        {\n            return GetSceneNameByBuildIndex(nextSceneIndex);\n        }\n\n        return string.Empty;\n    }\n\n    public static string GetSceneNameByBuildIndex(int buildIndex)\n    {\n        return GetSceneNameFromScenePath(SceneUtility.GetScenePathByBuildIndex(buildIndex));\n    }\n\n    private static string GetSceneNameFromScenePath(string scenePath)\n    {\n        // Unity's asset paths always use '/' as a path separator\n        var sceneNameStart = scenePath.LastIndexOf(&quot;/&quot;, StringComparison.Ordinal) + 1;\n        var sceneNameEnd = scenePath.LastIndexOf(&quot;.&quot;, StringComparison.Ordinal);\n        var sceneNameLength = sceneNameEnd - sceneNameStart;\n        return scenePath.Substring(sceneNameStart, sceneNameLength);\n    }\n}\n</code></pre>\n<p>Edit: The section below is included for historical reasons, it is only applicable to Unity 5.4 and some earlier versions.</p>\n<p>Yes, unfortunately you are right, but...You're in luck!</p>\n<p>I created a plugin/asset for that after reading your question, it's three small scripts and it should 'just work' and using it is literally just one line of code:</p>\n<pre><code>var buildSceneRecords = BuildScenes.Records;\n</code></pre>\n<p>The records contain the name, path and index for the scenes in the editor build settings.</p>\n<p>You can get it here: <a href=\"https://github.com/sindrijo/unity3d-runtime-buildscenes\" rel=\"nofollow noreferrer\">https://github.com/sindrijo/unity3d-runtime-buildscenes</a></p>\n"}], "owner": {"reputation": 1201, "user_id": 2642226, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e9d5fa09e256c4f848594193348bd502?s=128&d=identicon&r=PG", "display_name": "Andrio", "link": "https://stackoverflow.com/users/2642226/andrio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2676, "favorite_count": 0, "accepted_answer_id": 40901893, "answer_count": 1, "score": 1, "last_activity_date": 1509374789, "creation_date": 1480540462, "question_id": 40898310, "link": "https://stackoverflow.com/questions/40898310/get-name-of-next-scene-in-build-settings-in-unity3d", "title": "Get name of next Scene in build settings in Unity3D?", "body": "<p>So, what I want to do seems like it should be extraordinarily simple. I need to grab the <em>name</em> (not load it) of the next scene, as listed in the build settings.</p>\n\n<p>I thought I had a simple solution by doing something like this:</p>\n\n<pre><code>int currentIndex = SceneManager.GetActiveScene().buildIndex;\nstring nextSceneName = SceneManager.GetSceneAt(currentIndex + 1).name\n</code></pre>\n\n<p>But apparently that \"GetSceneAt\" doesn't apply to the scenes in the build settings, instead it's for some kind of internal list that the SceneManager has.</p>\n\n<p>All my google searches bring up solutions based on a specific naming order for your scenes, or exporting the list of scenes to a file before building (a list that manually needs to be exported), etc. I can't imagine such a simple problem requires such a complex solution, which is why I'm asking for myself.</p>\n\n<p>How can I just grab the name of the next scene in the build settings?</p>\n"}, {"tags": ["c#", "wpf", "xaml", "data-binding", "wpfdatagrid"], "comments": [{"owner": {"reputation": 2640, "user_id": 1470467, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/FSgVL.jpg?s=128&g=1", "display_name": "Karmacon", "link": "https://stackoverflow.com/users/1470467/karmacon"}, "reply_to_user": {"reputation": 109436, "user_id": 1136211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd80cd7d5927902f3af471fa0353836?s=128&d=identicon&r=PG", "display_name": "Clemens", "link": "https://stackoverflow.com/users/1136211/clemens"}, "edited": false, "score": 0, "creation_date": 1480540942, "post_id": 40898239, "comment_id": 69010669, "body": "@Clemens Thanks, noted. This code is a condensed summary of my actual program, in which the DataGrid&#39;s source is a separate object than the UserControl&#39;s DataContext. But regardless, all good points."}, {"owner": {"reputation": 1429, "user_id": 4507394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e389bea9cee09eec2cef1f58b5ac580?s=128&d=identicon&r=PG&f=1", "display_name": "esiprogrammer", "link": "https://stackoverflow.com/users/4507394/esiprogrammer"}, "edited": false, "score": 0, "creation_date": 1480541128, "post_id": 40898239, "comment_id": 69010752, "body": "why don&#39;t you call <code>setData</code> on <code>Window.Loaded</code> event for first time."}, {"owner": {"reputation": 2640, "user_id": 1470467, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/FSgVL.jpg?s=128&g=1", "display_name": "Karmacon", "link": "https://stackoverflow.com/users/1470467/karmacon"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 1, "creation_date": 1480541164, "post_id": 40898239, "comment_id": 69010769, "body": "@EdPlunkett Sorry, I forgot to include that in this code. But yes, I have set the binding to one way"}, {"owner": {"reputation": 2640, "user_id": 1470467, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/FSgVL.jpg?s=128&g=1", "display_name": "Karmacon", "link": "https://stackoverflow.com/users/1470467/karmacon"}, "reply_to_user": {"reputation": 1429, "user_id": 4507394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e389bea9cee09eec2cef1f58b5ac580?s=128&d=identicon&r=PG&f=1", "display_name": "esiprogrammer", "link": "https://stackoverflow.com/users/4507394/esiprogrammer"}, "edited": false, "score": 0, "creation_date": 1480541376, "post_id": 40898239, "comment_id": 69010881, "body": "@esiprogrammer I&#39;m not sure what you mean, but let me clarify. I have multiple instances of the component, all of which are not in view by default. Once a user presses a button, the component is created and the grid is populated with the data. In other words, the data is already stored well in advance before the it is displayed in the component."}, {"owner": {"reputation": 1429, "user_id": 4507394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e389bea9cee09eec2cef1f58b5ac580?s=128&d=identicon&r=PG&f=1", "display_name": "esiprogrammer", "link": "https://stackoverflow.com/users/4507394/esiprogrammer"}, "edited": false, "score": 0, "creation_date": 1480541632, "post_id": 40898239, "comment_id": 69011013, "body": "I guess the problem might be setting <code>DataContext</code> of the view. that&#39;s why ur provided code-behind is working. where do you set <code>DataContext</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 2640, "user_id": 1470467, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/FSgVL.jpg?s=128&g=1", "display_name": "Karmacon", "link": "https://stackoverflow.com/users/1470467/karmacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1480543091, "creation_date": 1480543091, "answer_id": 40898980, "question_id": 40898239, "link": "https://stackoverflow.com/questions/40898239/datagrid-selectedindex-binding-wont-work-in-xaml/40898980#40898980", "title": "Datagrid SelectedIndex binding won&#39;t work in XAML", "body": "<p>My original question was missing a piece of info that was causing the issue.\nIt seems there's a WPF bug when the binding source is a static link. If I move the <code>DataIndex</code> property into the component's DataContext, then it will work correctly.</p>\n\n<p>I'm not going to do this however, because the data is shared between multiple instances. I don't need to have multiple instances of the data, only the component. Therefor, I will just right it off as a Microsoft bug, and use the code-behind work around.</p>\n\n<p>I will leave the question open tho, in case anyone has a solution for this bug.</p>\n"}], "owner": {"reputation": 2640, "user_id": 1470467, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/FSgVL.jpg?s=128&g=1", "display_name": "Karmacon", "link": "https://stackoverflow.com/users/1470467/karmacon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 570, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480615266, "creation_date": 1480540162, "last_edit_date": 1480615266, "question_id": 40898239, "link": "https://stackoverflow.com/questions/40898239/datagrid-selectedindex-binding-wont-work-in-xaml", "title": "Datagrid SelectedIndex binding won&#39;t work in XAML", "body": "<p>Question summary: Is there a way in XAML to ensure that my DataGrid component is fully loaded before it initiates a binding on the SelectedIndex property?</p>\n\n<hr/>\n\n<p>My ViewModel is set up like this. I'm using MVVM-light to notify the view of changes. I pass the new model to <code>SetData()</code> whenever the it gets updated from the server.</p>\n\n<pre><code>public class MyViewModel : ViewModelBase\n{\n    public void SetData(DataModel model)\n    {                \n        Data = model.Data; //Array of 75 DataObjects\n        DataIndex = model.Index; //int between 0 and 74\n    }\n\n    // Array to Bind to Datagrid ItemsSource\n    public DataObject[] Data \n    {\n        get { return _data; }\n        private set\n        {\n            if (_data!= value)\n            {\n                _data= value;\n                RaisePropertyChanged(\"Data\");\n            }\n        }\n    }\n    private DataObject[] _data;\n\n    // Int to Bind to Datagrid SelectedIndex\n    public int DataIndex\n    {\n        get { return _index; }\n        private set\n        {\n            if (_index != value)\n            {\n                _index = value;\n                RaisePropertyChanged(\"DataIndex\");\n            }\n        }\n    }\n    private int _index;\n}\n</code></pre>\n\n<p>The view looks like this:</p>\n\n<pre><code>&lt;Application.Resources&gt;\n    &lt;ResourceDictionary&gt;\n        &lt;core:ViewModelLocator x:Key=\"Locator\" /&gt;\n    &lt;/ResourceDictionary&gt;\n&lt;/Application.Resources&gt;\n\n&lt;DataGrid ItemsSource=\"{Binding MyViewModel.Data, Source={StaticResource Locator}}\"\n          SelectedIndex=\"{Binding MyViewModel.DataIndex, Source={StaticResource Locator}, Mode=OneWay}\"\n          AutoGenerateColumns=\"True\"/&gt;\n</code></pre>\n\n<p>My issue is that none of the rows are selected on my DataGrid. All the data shows up in the grid correctly but the row does not get selected. I've checked the properties and confirmed that the Array length is 75 and <code>DataIndex</code> is an int between 0 and 74.</p>\n\n<hr/>\n\n<p>It seems the reason is because the DataGrid hasn't finished loading when the binding is set. I can prove this by initializing the binding after the component is loaded. In this case, everything works as expected and my selected item is displayed correctly:</p>\n\n<pre><code>&lt;DataGrid x:Name=\"MyDataGrid\" Loaded=\"OnDataGridLoaded\"\n          ItemsSource=\"{Binding MyViewModel.Data, Source={StaticResource Locator}}\"\n          AutoGenerateColumns=\"True\"/&gt;\n\nprivate void OnDataGridLoaded(object sender, RoutedEventArgs e)\n{\n    Binding b = new Binding(\"DataIndex\");\n    b.Source = Locator.MyViewModel.Data;\n    MyDataGrid.SetBinding(DataGrid.SelectedIndexProperty, b);\n}\n</code></pre>\n\n<p>I'd prefer not to have to do it like this because, you know, code-behind. So is there a way to fix this using only XAML? Here is what I've tried so far (none of which worked for me):</p>\n\n<ul>\n<li>Binding SelectedIndex to an <code>int</code> property on my ViewModel (as shown above)</li>\n<li>Binding SelectedItem to a <code>DataObject</code> property on my ViewModel (same result)</li>\n<li>Binding SelectedValue and SelectedPath to a property of my <code>DataObject</code> (This actually worked, for the first instance only. The problem is I have multiple instances of this Datagrid component, and for some reason this only works on the first instance)</li>\n<li>Binding to an ObservableCollection instead of an Array (tried all 3 of the above methods with an ObservableCollection and got the same results for each)</li>\n<li>Delaying the change notification by wrapping it in a call to <code>Dispatcher.Invoke</code>. This doesn't help because the component is not immediately in view.</li>\n<li>Creating the binding in XAML and then updating the target in the Loaded function. <code>MyDataGrid.GetBindingExpression(DataGrid.SelectedIndexProperty).UpdateTarget();</code></li>\n</ul>\n"}, {"tags": ["c#", ".net", "parallel-processing", "task-parallel-library", "task"], "comments": [{"owner": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1480540603, "post_id": 40898231, "comment_id": 69010454, "body": "Try adding a Sleep in the main thread as well after you&#39;ve acquired <code>lockB</code>."}, {"owner": {"reputation": 364, "user_id": 1765725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47d847285f20a0c4e29bad849df6ea8b?s=128&d=identicon&r=PG", "display_name": "Stalli", "link": "https://stackoverflow.com/users/1765725/stalli"}, "reply_to_user": {"reputation": 37143, "user_id": 517852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XmOJ.jpg?s=128&g=1", "display_name": "Mike Zboray", "link": "https://stackoverflow.com/users/517852/mike-zboray"}, "edited": false, "score": 0, "creation_date": 1480540905, "post_id": 40898231, "comment_id": 69010642, "body": "10/10 results are deadlocks. Why is it so? I thougt it should be some diversity."}], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 1765725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47d847285f20a0c4e29bad849df6ea8b?s=128&d=identicon&r=PG", "display_name": "Stalli", "link": "https://stackoverflow.com/users/1765725/stalli"}, "edited": false, "score": 0, "creation_date": 1480540632, "post_id": 40898291, "comment_id": 69010470, "body": "Thank you for answer. And the order of output isn&#39;t guaranteed as well? I just get only B-A, A-B and never A-B, B-A. Maybe I need to try more to get other result..."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 364, "user_id": 1765725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47d847285f20a0c4e29bad849df6ea8b?s=128&d=identicon&r=PG", "display_name": "Stalli", "link": "https://stackoverflow.com/users/1765725/stalli"}, "edited": false, "score": 0, "creation_date": 1480540926, "post_id": 40898291, "comment_id": 69010656, "body": "@Stalli While it&#39;s <i>technically</i> possible for the created task to end up running to completion first, in any practical sense, that is impossible, so you are unlikely to ever see that ordering."}, {"owner": {"reputation": 364, "user_id": 1765725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47d847285f20a0c4e29bad849df6ea8b?s=128&d=identicon&r=PG", "display_name": "Stalli", "link": "https://stackoverflow.com/users/1765725/stalli"}, "edited": false, "score": 0, "creation_date": 1480541116, "post_id": 40898291, "comment_id": 69010743, "body": "Does it mean that main thread is usually goes first from the moment of task running?"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 364, "user_id": 1765725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47d847285f20a0c4e29bad849df6ea8b?s=128&d=identicon&r=PG", "display_name": "Stalli", "link": "https://stackoverflow.com/users/1765725/stalli"}, "edited": false, "score": 0, "creation_date": 1480541196, "post_id": 40898291, "comment_id": 69010787, "body": "@Stalli Typically.  It&#39;s already running, while it&#39;s <i>possible</i> for the thread scheduler to stop it just after scheduling a new thread to run, it&#39;s not particularly <i>likely</i> that it ends up being stopped right at that exact moment."}, {"owner": {"reputation": 364, "user_id": 1765725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47d847285f20a0c4e29bad849df6ea8b?s=128&d=identicon&r=PG", "display_name": "Stalli", "link": "https://stackoverflow.com/users/1765725/stalli"}, "edited": false, "score": 0, "creation_date": 1480541300, "post_id": 40898291, "comment_id": 69010837, "body": "Thank you very much, Servy."}], "tags": [], "owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "is_accepted": true, "score": 2, "last_activity_date": 1480540379, "creation_date": 1480540379, "answer_id": 40898291, "question_id": 40898231, "link": "https://stackoverflow.com/questions/40898231/task-deadlock-doesnt-occur/40898291#40898291", "title": "Task deadlock doesn&#39;t occur", "body": "<p>The code isn't guaranteed to deadlock.  There is a race condition as to whether or not it will deadlock.  If the newly started task manages to grab the first lock before the main thread goes on to grab that same lock, then the code deadlocks, if (as is no doubt happening for you) the first thread manages to get both locks before the worker thread does anything, then there is no deadlock.</p>\n"}], "owner": {"reputation": 364, "user_id": 1765725, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/47d847285f20a0c4e29bad849df6ea8b?s=128&d=identicon&r=PG", "display_name": "Stalli", "link": "https://stackoverflow.com/users/1765725/stalli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 40898291, "answer_count": 1, "score": 0, "last_activity_date": 1480540379, "creation_date": 1480540130, "last_edit_date": 1592644375, "question_id": 40898231, "link": "https://stackoverflow.com/questions/40898231/task-deadlock-doesnt-occur", "title": "Task deadlock doesn&#39;t occur", "body": "<p>I found this example in the book. And it's written that this code leads to deadlock. But I don't get it and don't understand why it should be?\nI always get</p>\n<blockquote>\n<p>\u201cLocked B and A\u201d</p>\n<p>\u201cLocked A and B\u201d</p>\n</blockquote>\n<pre><code>static void Main()\n{\n    object lockA = new object();\n    object lockB = new object();\n    var up = Task.Run(() =&gt;\n    {\n        lock (lockA)\n        {\n            Thread.Sleep(1000);\n            lock (lockB)\n            {\n                Console.WriteLine(\u201cLocked A and B\u201d);\n            }\n        }\n    });\n\n    lock (lockB)\n    {\n        lock (lockA)\n        {\n            Console.WriteLine(\u201cLocked B and A\u201d);\n        }\n    }\n\n    up.Wait();\n    Console.ReadLine();\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "multithreading", "visual-studio"], "comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1480540852, "post_id": 40898167, "comment_id": 69010610, "body": "Where in your code do you use the <code>Thread.Priority</code> property. You need to show the code between what you have here and that call."}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1480540953, "post_id": 40898167, "comment_id": 69010674, "body": "Also, in your linked bug report, if you scroll down to the bottom you will see the error had nothing to do with threads, it was because the program could not acccess the <code>libuv</code> library."}, {"owner": {"reputation": 66, "user_id": 7233062, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hNRNvXxhntQ/AAAAAAAAAAI/AAAAAAAAAJY/PkhUesXT4B4/photo.jpg?sz=128", "display_name": "Oussama melki", "link": "https://stackoverflow.com/users/7233062/oussama-melki"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1480541226, "post_id": 40898167, "comment_id": 69010801, "body": "@Scott Chamberlain Thank you for the response. I do not use any <code>Thread.Priority</code> in my code."}, {"owner": {"reputation": 26725, "user_id": 213550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cyZ5c.jpg?s=128&g=1", "display_name": "VMAtm", "link": "https://stackoverflow.com/users/213550/vmatm"}, "edited": false, "score": 0, "creation_date": 1480597311, "post_id": 40898167, "comment_id": 69034823, "body": "Use <code>ex.ToString()</code> to get full information about exception"}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 7233062, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hNRNvXxhntQ/AAAAAAAAAAI/AAAAAAAAAJY/PkhUesXT4B4/photo.jpg?sz=128", "display_name": "Oussama melki", "link": "https://stackoverflow.com/users/7233062/oussama-melki"}, "is_accepted": true, "score": 0, "last_activity_date": 1480781327, "creation_date": 1480781327, "answer_id": 40949753, "question_id": 40898167, "link": "https://stackoverflow.com/questions/40898167/thread-is-dead-priority-cannot-be-accessed/40949753#40949753", "title": "thread is dead priority cannot be accessed", "body": "<p>Actually I was not able to trace the error, and by a certain miracle it's not there any more. The only thing that I've changed is here :</p>\n\n<pre><code>BlockingCollection&lt;double[]&gt; flowData = new BlockingCollection&lt;double[]&gt;(1);\n</code></pre>\n\n<p>Declaring my data as BlockingCollection and then use it like that in my consumer :</p>\n\n<pre><code>double[] dataToProcess = flowData.Take();\n</code></pre>\n\n<p>and like that in my producer :</p>\n\n<pre><code>flowData.TryAdd(data.GetRawData());\n</code></pre>\n\n<p>I think that the fact that my data was not protected against thread race condition generated the error. Even if I am not using any Thread Priority in my code, having better protection of my shared data was the solution to get rid of my error.</p>\n\n<p>Sorry guys, it's not the greatest explanation but at least I don't have the error anymore. Thank you for your help.</p>\n"}], "owner": {"reputation": 66, "user_id": 7233062, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hNRNvXxhntQ/AAAAAAAAAAI/AAAAAAAAAJY/PkhUesXT4B4/photo.jpg?sz=128", "display_name": "Oussama melki", "link": "https://stackoverflow.com/users/7233062/oussama-melki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 40949753, "answer_count": 1, "score": 0, "last_activity_date": 1480781327, "creation_date": 1480539880, "question_id": 40898167, "link": "https://stackoverflow.com/questions/40898167/thread-is-dead-priority-cannot-be-accessed", "title": "thread is dead priority cannot be accessed", "body": "<p>I'm developing an application using some multithreading.</p>\n\n<p>I have a thread that produces some data each 200ms (vibration data from an acquisition device). And each time i reacieve the data I start several tasks to do stuff. On my development PC there is no error. But when I deploy the project on a less powerful tablet I have the following message appearing several times :</p>\n\n<blockquote>\n  <p>thread is dead. priority cannot be accessed.</p>\n</blockquote>\n\n<p>Here is my code :</p>\n\n<pre><code>private void myCallback1Axis(IAsyncResult ar)\n        {\n            GC.Collect();\n            try\n            {\n                if (runningTask == ar.AsyncState)\n                {\n                    data = reader.EndReadWaveform(ar); // GET THE DATA\n\n                    // LAUNCH FFTs' THREADS\n                    CancellationToken ct = cts.Token;\n                    task1 = System.Threading.Tasks.Task.Factory.StartNew(() =&gt;\n                    {\n                        try\n                        {\n                            if (ct.IsCancellationRequested)\n                            {\n                                Console.WriteLine(\"Task {0}: Cancelling\", task1.Id);\n                                return;\n                            }\n                            Console.WriteLine(\"Task {0}: {1}/2 In progress\", task1.Id, 1);\n                            ConsumeToFFT(new FFT_Parameters(data.GetRawData(), overlap1, (int)Fmax1,\n                                NbLines1, HP, avg1, window1, switchFreqUnit1.Value, swVelo.Value));\n                        }\n                        catch (OperationCanceledException)\n                        {\n                            // Any clean up code goes here.\n                            Console.WriteLine(\"Task {0}: Cancelling\", task1.Id);\n                            //throw; // To ensure that the calling code knows the task was cancelled.\n                        }\n                        catch (Exception)\n                        {\n                            // Clean up other stuff\n                            //throw; // If the calling code also needs to know.\n                        }\n\n                    }, ct);\n            }\n            catch (DaqException ex)\n            {\n                MessageBox.Show(ex.Message);\n                runningTask = null;\n                myTask.Dispose();\n            }\n        }\n</code></pre>\n\n<p>I read that I have to :</p>\n\n<blockquote>\n  <p>Put threads into background before starting (<a href=\"https://github.com/aspnet/KestrelHttpServer/issues/644\" rel=\"nofollow noreferrer\">here</a>)</p>\n</blockquote>\n\n<p>But nothing more. I'm stuck with those messages and I can not trace them. Any ideas how can I fix this? </p>\n\n<p>Thank you very much.</p>\n\n<p>(I'm using c#, visual studio, .net 4.0)</p>\n"}, {"tags": ["c#", "json", "json.net"], "comments": [{"owner": {"reputation": 19, "user_id": 6879292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491d560c4d9a23428a730384153c59a1?s=128&d=identicon&r=PG&f=1", "display_name": "2Shae", "link": "https://stackoverflow.com/users/6879292/2shae"}, "edited": false, "score": 0, "creation_date": 1480584270, "post_id": 40898153, "comment_id": 69026059, "body": "HI volks, I was able to solve it with addiing the rootobject into a List&lt;&gt;                                                                                         List&lt;RootObject&gt; root = Newtonsoft.Json.JsonConvert.DeserializeObject&lt;List&lt;RootObjec&zwnj;&#8203;t&gt;&gt;(jSon);"}, {"owner": {"reputation": 2777, "user_id": 2946187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HX4Kk.jpg?s=128&g=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/2946187/jim"}, "edited": false, "score": 0, "creation_date": 1480604755, "post_id": 40898153, "comment_id": 69040140, "body": "the idea is that you mark one answer from the below as accepted (in case there is one correct and/or helped you the most), so this question is marked as solved for the community."}], "answers": [{"tags": [], "owner": {"reputation": 1429, "user_id": 4507394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e389bea9cee09eec2cef1f58b5ac580?s=128&d=identicon&r=PG&f=1", "display_name": "esiprogrammer", "link": "https://stackoverflow.com/users/4507394/esiprogrammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1480548913, "last_edit_date": 1480548913, "creation_date": 1480540237, "answer_id": 40898255, "question_id": 40898153, "link": "https://stackoverflow.com/questions/40898153/json-deserialization/40898255#40898255", "title": "Json Deserialization", "body": "<p>Your Json string is an array of object because it starts with <code>[]</code> so you need to Deserialize it to list of <code>RootObject</code>.</p>\n\n<pre><code>var jobject = JsonConvert.DeserializeObject&lt;List&lt;RootObject&gt;&gt;(value);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2777, "user_id": 2946187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HX4Kk.jpg?s=128&g=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/2946187/jim"}, "edited": false, "score": 0, "creation_date": 1480604498, "post_id": 40900166, "comment_id": 69039936, "body": "You having a bad day, downvoter ? <i>Use your downvotes whenever you encounter an egregiously sloppy, no-effort-expended post, or an answer that is clearly and perhaps dangerously incorrect.</i> ... otherwise, you are using it the wrong way. Or an explanation would be at minimum useful."}, {"owner": {"reputation": 19, "user_id": 6879292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491d560c4d9a23428a730384153c59a1?s=128&d=identicon&r=PG&f=1", "display_name": "2Shae", "link": "https://stackoverflow.com/users/6879292/2shae"}, "edited": false, "score": 1, "creation_date": 1480606004, "post_id": 40900166, "comment_id": 69041048, "body": "Hi Jim,thx a lot for you suggestions, it works properly. I&#180;ve adjusted the property names etc.. Thx!"}, {"owner": {"reputation": 33898, "user_id": 131809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ccbfb318718602f838caf25020bd4cc8?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/131809/alex"}, "edited": false, "score": 0, "creation_date": 1480608280, "post_id": 40900166, "comment_id": 69042607, "body": "Sorry, I was in the middle of commenting. I&#39;m not having a bad day, more a busy day. I downvoted because your answer annotated the two answers already given. It&#39;s better to suggest edits to an answer, rather than answer again. That being said, downvoting both our answers in revenge is a direct contravention of the rules, and I&#39;ve reported it as such."}, {"owner": {"reputation": 33898, "user_id": 131809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ccbfb318718602f838caf25020bd4cc8?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/131809/alex"}, "edited": false, "score": 0, "creation_date": 1480608893, "post_id": 40900166, "comment_id": 69042989, "body": "... i do realise i&#39;m being hypocritical here, as my answer is also technically a duplicate (albeit by about 10 seconds). Hence, the deletion of my answer"}], "tags": [], "owner": {"reputation": 2777, "user_id": 2946187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HX4Kk.jpg?s=128&g=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/2946187/jim"}, "is_accepted": false, "score": 1, "last_activity_date": 1480548718, "creation_date": 1480548718, "answer_id": 40900166, "question_id": 40898153, "link": "https://stackoverflow.com/questions/40898153/json-deserialization/40900166#40900166", "title": "Json Deserialization", "body": "<blockquote>\n  <p>Cannot deserialize the current JSON array (e.g. [1,2,3]) into type 'TCookRestWrapper.Models.RootObject' ....</p>\n</blockquote>\n\n<p>Indicates that you are trying to deserialize an array to one object, more precisely <code>RootObject</code> You can clearly see that the JSON you have, starts with <code>[</code> and ends with <code>]</code>. Which means it is an array.</p>\n\n<p>While the correct answer simply would be, deserialize to a type of <code>List&lt;RootObject&gt;</code>:</p>\n\n<pre><code>var jobject = JsonConvert.DeserializeObject&lt;List&lt;RootObject&gt;&gt;(value);\n</code></pre>\n\n<h3>Property Naming Guidelines</h3>\n\n<p>Guidelines and good practice is to name your properties by some meaning and use pascal case.</p>\n\n<p>To do this when you deal with the JSON you provided is really simple and can be realized easily with attributes like in the next class.</p>\n\n<p><em>(Note: I changed the property name Permission to Permissions, since it can hold more the one.)</em> </p>\n\n<pre><code>public class Customer\n{\n    [JsonProperty(\"CUSTOMERNO\")]\n    public string CustomerNo { get; set; }\n\n    [JsonProperty(\"BUSINESSAREA\")]\n    public string BusinessArea { get; set; }\n\n    [JsonProperty(\"FIRSTNAME\")]\n    public string FirstName { get; set; }\n\n    [JsonProperty(\"LASTNAME\")]\n    public string LastName { get; set; }\n\n    [JsonProperty(\"GENDER\")]\n    public int Gender { get; set; }\n}\n\npublic class Permission\n{\n    [JsonProperty(\"EMAIL\")]\n    public string Email { get; set; }\n\n    [JsonProperty(\"TYPE\")]\n    public string Type { get; set; }\n\n    [JsonProperty(\"VALUE\")]\n    public int Value { get; set; }\n\n    [JsonProperty(\"STATUS\")]\n    public string Status { get; set; }\n\n    [JsonProperty(\"DATAORIGIN\")]\n    public string DataOrigin { get; set; }\n\n    [JsonProperty(\"PERMISSIONDATE\")]\n    public string PermissionDate { get; set; }\n\n    [JsonProperty(\"CHANGEDATE\")]\n    public string ChangeDate { get; set; }\n}\n\npublic class RootObject\n{\n    [JsonProperty(\"CUSTOMER\")]\n    public Customer Customer { get; set; }\n\n    [JsonProperty(\"PERMISSION\")]\n    public List&lt;Permission&gt; Permissions { get; set; }\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6879292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/491d560c4d9a23428a730384153c59a1?s=128&d=identicon&r=PG&f=1", "display_name": "2Shae", "link": "https://stackoverflow.com/users/6879292/2shae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1480548913, "creation_date": 1480539824, "last_edit_date": 1480543664, "question_id": 40898153, "link": "https://stackoverflow.com/questions/40898153/json-deserialization", "title": "Json Deserialization", "body": "<p>I need some help deserializing this JSON.</p>\n\n<p>I'm using newtonsoft to deserialize the JSON:</p>\n\n<p>This is how my JSON is looking:</p>\n\n<pre><code>[  \n  {  \n  \"CUSTOMER\":{  \n     \"CUSTOMERNO\":\"ABC123\",\n     \"BUSINESSAREA\":\"A\",\n     \"FIRSTNAME\":\"B\",\n     \"LASTNAME\":\"Goos\",\n     \"GENDER\":1\n  },\n  \"PERMISSION\":[  \n     {  \n        \"EMAIL\":\"bg@123.com\",\n        \"TYPE\":\"ALL\",\n        \"VALUE\":1,\n        \"STATUS\":\"test\",\n        \"DATAORIGIN\":\"CUBA\",\n        \"PERMISSIONDATE\":\"2016-11-30 00:00:00\",\n        \"CHANGEDATE\":\"2016-11-30 00:00:00\"\n     },\n     {  \n        \"EMAIL\":\"bg@346.com\",\n        \"TYPE\":\"NECC\",\n        \"VALUE\":0,\n        \"STATUS\":\"test2\",\n        \"DATAORIGIN\":\"CUBA\",\n        \"PERMISSIONDATE\":\"2016-10-30 00:00:00\",\n        \"CHANGEDATE\":\"2016-10-30 00:00:00\"\n       }\n     ]\n   }\n ]\n</code></pre>\n\n<p>Here my Model:</p>\n\n<pre><code>public class CUSTOMER\n{\n    public string CUSTOMERNO { get; set; }\n    public string BUSINESSAREA { get; set; }\n    public string FIRSTNAME { get; set; }\n    public string LASTNAME { get; set; }\n    public int GENDER { get; set; }\n}\n\npublic class PERMISSION\n{\n    public string EMAIL { get; set; }\n    public string TYPE { get; set; }\n    public int VALUE { get; set; }\n    public string STATUS { get; set; }\n    public string DATAORIGIN { get; set; }\n    public string PERMISSIONDATE { get; set; }\n    public string CHANGEDATE { get; set; }\n}\n\npublic class RootObject\n{\n    public CUSTOMER CUSTOMER { get; set; }\n    public List&lt;PERMISSION&gt; PERMISSION { get; set; }\n}\n</code></pre>\n\n<p>When I deserialize the JSON with this code:</p>\n\n<pre><code>var jobject = JsonConvert.DeserializeObject&lt;RootObject&gt;(value);\n</code></pre>\n\n<p>I'm receiving following error:</p>\n\n<blockquote>\n  <p>Cannot deserialize the current JSON array (e.g. [1,2,3]) into type\n  'TCookRestWrapper.Models.RootObject' because the type requires a JSON\n  object (e.g. {\"name\":\"value\"}) to deserialize correctly. To fix this\n  error either change the JSON to a JSON object (e.g. {\"name\":\"value\"})\n  or change the deserialized type to an array or a type that implements\n  a collection interface (e.g. ICollection, IList) like List that can\n  be deserialized from a JSON array. JsonArrayAttribute can also be\n  added to the type to force it to deserialize from a JSON array. Path\n  '', line 1, position 1.</p>\n</blockquote>\n\n<p>I\u00b4ll appreciate any idea how to solve it.</p>\n"}, {"tags": ["c#", "mysql", "entity-framework", "ef-code-first"], "answers": [{"comments": [{"owner": {"reputation": 1032, "user_id": 672308, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43be0a24a058f07dbdbb30167e19f95d?s=128&d=identicon&r=PG", "display_name": "Brian Tacker", "link": "https://stackoverflow.com/users/672308/brian-tacker"}, "edited": false, "score": 0, "creation_date": 1480690239, "post_id": 40900090, "comment_id": 69080979, "body": "I had actually tried this after I posted the question, unfortunately it does not work in my case because I need the EF property to be a string but this column type is only compatible with byte[]"}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "reply_to_user": {"reputation": 1032, "user_id": 672308, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43be0a24a058f07dbdbb30167e19f95d?s=128&d=identicon&r=PG", "display_name": "Brian Tacker", "link": "https://stackoverflow.com/users/672308/brian-tacker"}, "edited": false, "score": 0, "creation_date": 1480700426, "post_id": 40900090, "comment_id": 69087466, "body": "Well, if it&#39;s binary, then it isn&#39;t a string -- it&#39;s bytes -- so that part makes sense in a strongly-typed environment.  What about <code>VARCHAR(100) COLLATE utf8_bin</code>?  That should be a case-sensitive string."}, {"owner": {"reputation": 1032, "user_id": 672308, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43be0a24a058f07dbdbb30167e19f95d?s=128&d=identicon&r=PG", "display_name": "Brian Tacker", "link": "https://stackoverflow.com/users/672308/brian-tacker"}, "edited": false, "score": 0, "creation_date": 1480708832, "post_id": 40900090, "comment_id": 69091474, "body": "That works fine if Im creating the table manually, but Im looking for a way to do it using EntityFramework"}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "reply_to_user": {"reputation": 1032, "user_id": 672308, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43be0a24a058f07dbdbb30167e19f95d?s=128&d=identicon&r=PG", "display_name": "Brian Tacker", "link": "https://stackoverflow.com/users/672308/brian-tacker"}, "edited": false, "score": 1, "creation_date": 1480709678, "post_id": 40900090, "comment_id": 69091839, "body": "Possibly -- &quot;you can&#39;t&quot; -- random google find: <a href=\"https://github.com/aspnet/EntityFramework/issues/2779\" rel=\"nofollow noreferrer\">github.com/aspnet/EntityFramework/issues/2779</a> may or may not be applicable.  From my perspective as a DBA, ORMs are generally really good at making simple things difficult or impossible. The notion that this &quot;isn&#39;t a very common requirement&quot; strikes me as rather ludicrous, sort of like saying &quot;<code>VARCHAR</code> with a length other than 255 isn&#39;t a very common requirement.&quot;"}], "tags": [], "owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "is_accepted": false, "score": 1, "last_activity_date": 1480548294, "creation_date": 1480548294, "answer_id": 40900090, "question_id": 40898118, "link": "https://stackoverflow.com/questions/40898118/create-a-varchar-binary-column-in-mysql-with-entity-framework-codefirst/40900090#40900090", "title": "Create a VARCHAR BINARY column in MySQL with Entity Framework Codefirst", "body": "<blockquote>\n  <p>I dont want to mark the entire database or table as case-sensitive using collation</p>\n</blockquote>\n\n<p>Well, no, that doesn't make sense, but you should be able to do it on the column, using an appropriate collation, e.g.:</p>\n\n<pre><code>VARCHAR(100) COLLATE utf8_bin\n</code></pre>\n\n<p>Or just...</p>\n\n<pre><code>VARBINARY(100)\n</code></pre>\n\n<p>...is perfectly valid in MySQL (though I have no idea about whether EF will handle it correctly).</p>\n\n<p><a href=\"http://dev.mysql.com/doc/refman/5.7/en/binary-varbinary.html\" rel=\"nofollow noreferrer\">http://dev.mysql.com/doc/refman/5.7/en/binary-varbinary.html</a></p>\n"}], "owner": {"reputation": 1032, "user_id": 672308, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43be0a24a058f07dbdbb30167e19f95d?s=128&d=identicon&r=PG", "display_name": "Brian Tacker", "link": "https://stackoverflow.com/users/672308/brian-tacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 621, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480548294, "creation_date": 1480539659, "last_edit_date": 1592644375, "question_id": 40898118, "link": "https://stackoverflow.com/questions/40898118/create-a-varchar-binary-column-in-mysql-with-entity-framework-codefirst", "title": "Create a VARCHAR BINARY column in MySQL with Entity Framework Codefirst", "body": "<p>I have an application that is using EntityFramework Code First to create the database if it doesnt exist. And Im using MySQL for the database engine.</p>\n<p>I have a table where one of the Key columns needs to be Case-Sensitive. I dont want to mark the entire database or table as case-sensitive using collation, so the best way to do it (that I know of) is to mark the column as <strong>BINARY</strong>.</p>\n<p>Does anyone know how to do this using Code First? I tried doing:</p>\n<pre><code>[Column(TypeName = &quot;varchar(100) BINARY&quot;)]\n</code></pre>\n<p>but it doesn't like that, the first time I access the DB Model I get</p>\n<blockquote>\n<p>An exception of type 'System.InvalidOperationException' occurred in EntityFramework.dll but was not handled in user code</p>\n<p>Additional information: Sequence contains no matching element</p>\n</blockquote>\n<p>Maybe I should just do an <strong>ALTER TABLE</strong> after the database is created?</p>\n"}, {"tags": ["c#", "dependency-injection", "asp.net-web-api2"], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 5762545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea74e4a3069ca8578f9156e78589fea5?s=128&d=identicon&r=PG&f=1", "display_name": "Swetha", "link": "https://stackoverflow.com/users/5762545/swetha"}, "is_accepted": false, "score": 0, "last_activity_date": 1480540869, "last_edit_date": 1480540869, "creation_date": 1480540407, "answer_id": 40898298, "question_id": 40898084, "link": "https://stackoverflow.com/questions/40898084/how-to-create-a-dependency-injection-using-microsoft-asp-net-webapi/40898298#40898298", "title": "How to create a Dependency Injection using Microsoft Asp.net WebApi", "body": "<p>You should instead pass the IRepository as a parameter to the constructor\nSet the field _repo of type IRepository to the value of the parameter passed.</p>\n\n<pre><code>public ContextGoneBase (IRepository repository){ //Constructor\n\n  _repo = repository; \n\n}\n</code></pre>\n\n<p>.And then use an IOC container like Unity to instantiate the controller with the right parameters.For example after you install Unity using nuget you will have a UnityConfig class file and there you can register your repository type.For example if your repository is of type Repository then </p>\n\n<pre><code> public static class UnityConfig\n        {\n            public static void RegisterComponents()\n            {\n\n// register all your components with the container here\n            // it is NOT necessary to register your controllers\n\n            // e.g. container.RegisterType&lt;ITestService, TestService&gt;();\n                var container = new UnityContainer();\n                container.RegisterType&lt;IRepository,Repository&gt;();\n\n                GlobalConfiguration.Configuration.DependencyResolver = new UnityDependencyResolver(container);\n            }\n        }\n</code></pre>\n\n<p>Now in Global.asax call this method:</p>\n\n<pre><code> protected void Application_Start()\n        {\n\n            UnityConfig.RegisterComponents();\n\n        }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3796130"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480540869, "creation_date": 1480539509, "question_id": 40898084, "link": "https://stackoverflow.com/questions/40898084/how-to-create-a-dependency-injection-using-microsoft-asp-net-webapi", "title": "How to create a Dependency Injection using Microsoft Asp.net WebApi", "body": "<p>I have a little experience working with Dependency Injection using Xamarin.Forms, but not in WebApi, What I want is send data through my Interface and execute inside of my Class which is implementing that Interface, there's what I have :</p>\n\n<pre><code>public interface IRepository\n{\n    IHttpActionResult SendContext(user user);\n    IHttpActionResult GetContextData(int id);\n}\n\npublic class ContextGoneBase : ApiController,IRepository\n{\n    public  IHttpActionResult GetContextData(int id)\n    {\n        try\n        {\n            using (var context = new GoneContext())\n            {\n                var result = context.user.Where(a =&gt; a.id_user == id).Select(w =&gt;\n                new { w.user_name, w.cellphone_number, w.user_kind, w.CEP, w.area.area_name, w.district, w.city.city_name, w.city.state.state_name });\n                var list = result.ToList();\n\n                if (list != null)\n                {\n                    return Ok(list);\n                }\n                else\n                {\n                    return BadRequest();\n                }\n            }\n        }\n        catch (Exception)\n        {\n            return BadRequest();\n        }\n    }\n</code></pre>\n\n<p>And Inside of my controller I was trying to do something like that:</p>\n\n<pre><code>[Route(\"86538505\")]\n    public IHttpActionResult GetData(int id, IRepository repo)\n    {\n        this._repo = repo;\n        var result = _repo.GetContextData(id);\n        return result;\n    }\n</code></pre>\n\n<p>But, it fails! Thanks!</p>\n"}, {"tags": ["c#", ".net", "reflection"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 1, "creation_date": 1480539510, "post_id": 40897888, "comment_id": 69009865, "body": "Consider <code>private Controller CreatePersonController() { return new PersonController(); }</code>, and then <code>Resolve(new Func&lt;Controller&gt;[] { CreatePersonController })</code>. Determining that <code>CreatePersonController</code> <i>really</i> returns <code>PersonController</code> requires diving into the method body, it isn&#39;t available from the method signature. And your anonymous functions work like that <code>CreatePersonController</code>. It&#39;s not impossible for simple enough bodies, but it&#39;s <i>very</i> difficult, I strongly recommend looking for another approach."}, {"owner": {"reputation": 5881, "user_id": 1226568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9719051130e332ffe997958cfb935e0?s=128&d=identicon&r=PG", "display_name": "MaYaN", "link": "https://stackoverflow.com/users/1226568/mayan"}, "edited": false, "score": 0, "creation_date": 1480539565, "post_id": 40897888, "comment_id": 69009901, "body": "Yes, it seems I need to rethink the API. Thanks for the explanation."}, {"owner": {"reputation": 6408, "user_id": 5004822, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/55fd7e8e0dc744fc5feada06408b8a07?s=128&d=identicon&r=PG&f=1", "display_name": "SledgeHammer", "link": "https://stackoverflow.com/users/5004822/sledgehammer"}, "edited": false, "score": 0, "creation_date": 1480539733, "post_id": 40897888, "comment_id": 69009991, "body": "You can do what you want with reflection by using expression trees... just getting the syntax to work correctly... stand by"}, {"owner": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "edited": false, "score": 0, "creation_date": 1480540322, "post_id": 40897888, "comment_id": 69010300, "body": "@MaYaN Did you check my answer? <a href=\"http://stackoverflow.com/a/40898012/411632\">stackoverflow.com/a/40898012/411632</a> Isn&#39;t this what you&#39;re looking for?"}, {"owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "edited": false, "score": 0, "creation_date": 1480540864, "post_id": 40897888, "comment_id": 69010621, "body": "You don&#39;t need to rethink your approach, at least not on the grounds of this. I&#39;ve shown with an example that you can achieve what you want extremely easily, using expression trees."}], "answers": [{"comments": [{"owner": {"reputation": 5881, "user_id": 1226568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9719051130e332ffe997958cfb935e0?s=128&d=identicon&r=PG", "display_name": "MaYaN", "link": "https://stackoverflow.com/users/1226568/mayan"}, "edited": false, "score": 0, "creation_date": 1480539425, "post_id": 40898040, "comment_id": 69009816, "body": "Yes, I am trying to avoid creating an instance, to get the type."}, {"owner": {"reputation": 27104, "user_id": 3185569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177ae94ca98997a0ae4acd38db6ff47?s=128&d=identicon&r=PG&f=1", "display_name": "Zein Makki", "link": "https://stackoverflow.com/users/3185569/zein-makki"}, "reply_to_user": {"reputation": 5881, "user_id": 1226568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9719051130e332ffe997958cfb935e0?s=128&d=identicon&r=PG", "display_name": "MaYaN", "link": "https://stackoverflow.com/users/1226568/mayan"}, "edited": false, "score": 3, "creation_date": 1480539468, "post_id": 40898040, "comment_id": 69009837, "body": "@MaYaN This is impossible in the way you&#39;re doing it. You can never know what the method would return unless you run it ! Think of the method having multiple if statements, of check if the current second is even or odd and then returning a different object based on that."}], "tags": [], "owner": {"reputation": 27104, "user_id": 3185569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177ae94ca98997a0ae4acd38db6ff47?s=128&d=identicon&r=PG&f=1", "display_name": "Zein Makki", "link": "https://stackoverflow.com/users/3185569/zein-makki"}, "is_accepted": true, "score": 8, "last_activity_date": 1480540066, "last_edit_date": 1480540066, "creation_date": 1480539349, "answer_id": 40898040, "question_id": 40897888, "link": "https://stackoverflow.com/questions/40897888/how-can-i-get-the-return-type-of-a-funct-using-reflection/40898040#40898040", "title": "How can I get the return type of a Func&lt;T&gt; using reflection?", "body": "<p>Each method has a return type stored in the assembly, you specified that your methods' return type is <code>Controller</code>. This is the only thing that is guaranteed as an information (<em>That is what we know without executing the method - Also at compile time</em>)</p>\n\n<p>So we know that the method should return <code>Controller</code> or anything that derive from that. We can never know what is the run-time type until we actually call that method.</p>\n\n<p>As an example, what if the method has a code like:</p>\n\n<pre><code>var factories = new Func&lt;Controller&gt;[] {\n    () =&gt;\n    {\n        if ( DateTime.Now.Second % 2 == 0 )\n            return new OrderController();\n        else\n            return new PersonController();\n    }\n};\n</code></pre>\n\n<hr>\n\n<p>If you need to get the run-time type of the object returned, then you need to:</p>\n\n<pre><code>var controllerInstance = x();\nConsole.WriteLine(controllerInstance.GetType().Name);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58863, "user_id": 1875256, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/no10d.jpg?s=128&g=1", "display_name": "Ehsan Sajjad", "link": "https://stackoverflow.com/users/1875256/ehsan-sajjad"}, "is_accepted": false, "score": 2, "last_activity_date": 1480539475, "creation_date": 1480539475, "answer_id": 40898073, "question_id": 40897888, "link": "https://stackoverflow.com/questions/40897888/how-can-i-get-the-return-type-of-a-funct-using-reflection/40898073#40898073", "title": "How can I get the return type of a Func&lt;T&gt; using reflection?", "body": "<p>This is how it works, when you are instantiating your array, you are specifying that it would be storing <code>Func</code> objects of type <code>Controller</code>, now you are instantiating the sub types objects inside the array of <code>Func</code>, the Resolve, does not know what is the actual type unless you call <code>GetType()</code> to determine the actual type of it, it just knows that the <code>T</code> will be of type <code>Controller</code> because of the constraint i.e <code>where T : Controller</code></p>\n"}, {"comments": [{"owner": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "edited": false, "score": 0, "creation_date": 1480542252, "post_id": 40898137, "comment_id": 69011324, "body": "+1 It&#39;s a good approach. Expression trees provide enough info to configure service and implementations... unless OP would want to also use covariance on <code>TResult</code> and conditionally return controllers upcasted to a less specialized controller type"}], "tags": [], "owner": {"reputation": 26917, "user_id": 1892179, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/umfON.jpg?s=128&g=1", "display_name": "Theodoros Chatzigiannakis", "link": "https://stackoverflow.com/users/1892179/theodoros-chatzigiannakis"}, "is_accepted": false, "score": 6, "last_activity_date": 1480542035, "last_edit_date": 1480542035, "creation_date": 1480539765, "answer_id": 40898137, "question_id": 40897888, "link": "https://stackoverflow.com/questions/40897888/how-can-i-get-the-return-type-of-a-funct-using-reflection/40898137#40898137", "title": "How can I get the return type of a Func&lt;T&gt; using reflection?", "body": "<p>Lambdas in C# get their type based on the expression they are assigned to. For example, this:</p>\n\n<pre><code>Func&lt;string, string&gt; d = x =&gt; x;\n</code></pre>\n\n<p>Makes the lambda <code>x =&gt; x</code> a <code>string =&gt; string</code> function, on the grounds that this is what the variable <code>d</code> expects.</p>\n\n<p>Why is this relevant? Because in the following code, you're creating a similar expectation for the following lambdas:</p>\n\n<pre><code>var factories = new Func&lt;Controller&gt;[] {\n    () =&gt; new PersonController(),\n    () =&gt; new OrderController()\n};\n</code></pre>\n\n<p>The expectation is that these lambdas are of the <code>Func&lt;Controller&gt;</code> type. If the compiler was looking at the lambda bodies for the type, it would arrive at a different conclusion, specifically that one is a <code>Func&lt;PersonController&gt;</code> and the other is a <code>Func&lt;OrderController&gt;</code>, both of which are kinds of <code>Func&lt;Controller&gt;</code>. But the compiler doesn't look at the body for the type, it looks at the variable and the \"variable\" in this case is the array slot.</p>\n\n<p>Thus, the compiler will generate these delegates not as these methods:</p>\n\n<pre><code>PersonController Delegate1()\n{\n    return new PersonController();\n}\n\nOrderController Delegate2()\n{\n    return new OrderController();\n}\n</code></pre>\n\n<p>But as these methods:</p>\n\n<pre><code>Controller Delegate1()\n{\n    return new PersonController();\n}\n\nController Delegate2()\n{\n    return new OrderController();\n}\n</code></pre>\n\n<p>Therefore, by the time these delegates are inserted into the array, only the type information of the signatures remain, while the actual type information of the lambda bodies is lost.</p>\n\n<p>But there is one way to maintain the information about the lambda bodies, and then inspect that information instead of the delegate signatures. You can use of <em>expression trees</em>, which are a way to tell the compiler to treat code as data and essentially generate tree objects that <em>represent</em> the lambda, instead of the actual method that <em>implements</em> the lambda.</p>\n\n<p>Their syntax is nearly identical to that of lambdas:</p>\n\n<pre><code>var factories = new Expression&lt;Func&lt;Controller&gt;&gt;[] {\n    () =&gt; new PersonController(),\n    () =&gt; new OrderController()\n};\n</code></pre>\n\n<p>The difference is that now these objects aren't functions, but rather representations of functions. You can traverse those representation and very easily find the type of their top-level expression:</p>\n\n<pre><code>var t0 = factories[0].Body.Type; // this is equal to typeof(PersonController)\nvar t1 = factories[1].Body.Type; // this is equal to typeof(OrderController)\n</code></pre>\n\n<p>Finally, you can also turn these representations into actual functions, if you also intend to run them:</p>\n\n<pre><code>Func&lt;Controller&gt;[] implementations = factories.Select(x =&gt; x.Compile()).ToArray();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 58724, "user_id": 411632, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/41e7ea21270a6079bb14d6d60ec75d8a?s=128&d=identicon&r=PG", "display_name": "Mat&#237;as Fidemraizer", "link": "https://stackoverflow.com/users/411632/mat%c3%adas-fidemraizer"}, "edited": false, "score": 0, "creation_date": 1480542129, "post_id": 40898190, "comment_id": 69011270, "body": "BTW, even when @SledgeHammer wants me out of this Q&amp;A (and many others :D), maybe the OP isn&#39;t trying to implement an actual IoC container, but it&#39;s just a test code to understand how it works. It&#39;s true that OP approach is very limited, but if OP guarantees that the whole factories will be of the final controller types, as test code, it should work..."}], "tags": [], "owner": {"reputation": 10433, "user_id": 1002908, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/5e02c5c35a6b1479ccc24368a2e085a9?s=128&d=identicon&r=PG", "display_name": "Rob Lyndon", "link": "https://stackoverflow.com/users/1002908/rob-lyndon"}, "is_accepted": false, "score": 3, "last_activity_date": 1480539985, "creation_date": 1480539985, "answer_id": 40898190, "question_id": 40897888, "link": "https://stackoverflow.com/questions/40897888/how-can-i-get-the-return-type-of-a-funct-using-reflection/40898190#40898190", "title": "How can I get the return type of a Func&lt;T&gt; using reflection?", "body": "<p>The problem is that the same <code>T</code> has to apply to every type in your array. In</p>\n\n<pre><code>private void Resolve&lt;T&gt;(Func&lt;T&gt;[] controllerFactories) where T : Controller\n{\n    Array.ForEach(controllerFactories, x =&gt; \n    {\n        // This returns Controller instead of the child class\n        Console.WriteLine(x.Method.ReturnType);\n        var controllerInstance = x();\n    });\n}\n</code></pre>\n\n<p>what is your <code>T</code>? Is it <code>PersonController</code>? Is it <code>OrderController</code>? To make it fit your use case, it can only be a class that is a superclass of both <code>PersonController</code> and <code>OrderController</code>, while being a subclass of <code>Controller</code>. Therefore <code>T</code> can only be one class: <code>Controller</code> (assuming the two classes don't have a common base class that extends <code>Controller</code>). There is no point in making this class generic. It is exactly the same as this:</p>\n\n<pre><code>private void Resolve(Func&lt;Controller&gt;[] controllerFactories)\n{\n    Array.ForEach(controllerFactories, x =&gt; \n    {\n        Console.WriteLine(x.Method.ReturnType);\n        var controllerInstance = x();\n    });\n}\n</code></pre>\n\n<p>Instead of an array of <code>Func&lt;Controller&gt;</code> instances, it may make more sense to pass in a dictionary keyed on your return type:</p>\n\n<pre><code>var factories = new Dictionary&lt;Type, Func&lt;Controller&gt;&gt; {\n    [typeof(PersonController)] = () =&gt; new PersonController(),\n    [typeof(OrderController)] = () =&gt; new OrderController()\n};\n</code></pre>\n\n<p>An instance of <code>Func&lt;Controller&gt;</code> simply does not contain enough information to determine the type of its return value on its own: not without evaluating it. And even if you evaluate it, remember that a function is a black box. Just because it returns a <code>PersonController</code> once doesn't mean that it won't return an <code>OrderController</code> the next time you invoke it.</p>\n"}], "owner": {"reputation": 5881, "user_id": 1226568, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f9719051130e332ffe997958cfb935e0?s=128&d=identicon&r=PG", "display_name": "MaYaN", "link": "https://stackoverflow.com/users/1226568/mayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4352, "favorite_count": 1, "accepted_answer_id": 40898040, "answer_count": 4, "score": 8, "last_activity_date": 1480543928, "creation_date": 1480538812, "last_edit_date": 1592644375, "question_id": 40897888, "link": "https://stackoverflow.com/questions/40897888/how-can-i-get-the-return-type-of-a-funct-using-reflection", "title": "How can I get the return type of a Func&lt;T&gt; using reflection?", "body": "<p>I have the following type hierarchy:</p>\n<pre><code>public abstract class Controller {}\npublic sealed class PersonController : Controller {}\npublic sealed class OrderController : Controller {}\n</code></pre>\n<p>I also have a method that resolves the instance of a given type on demand (think of it as a layman's <em>IOC</em>):</p>\n<pre><code>private void Resolve&lt;T&gt;(Func&lt;T&gt;[] controllerFactories) where T : Controller\n{\n    Array.ForEach(controllerFactories, x =&gt; \n    {\n        // This returns Controller instead of the child class\n        // I need to know the actual type so that I can do other stuff\n        // before resolving the instance.\n        Console.WriteLine(x.Method.ReturnType);\n        var controllerInstance = x();\n    });\n}\n</code></pre>\n<p>I need to figure out the type of <code>T</code> in <code>Func&lt;T&gt;</code> but when I try:</p>\n<pre><code>void Main()\n{\n    var factories = new Func&lt;Controller&gt;[] {\n        () =&gt; new PersonController(),\n        () =&gt; new OrderController()\n    };\n    \n    Resolve(factories);\n}\n</code></pre>\n<p>I get <code>Controller</code> instead of the <code>PersonController</code> and <code>OrderController</code>.</p>\n<p>Any ideas?</p>\n<h2>Update:</h2>\nI thank everyone for providing such detailed answers and examples. They prompted me to rethink the <em>API</em> and here is what I finally came up with which serves what I wanted to accomplish:\n<pre><code>public interface IResolver&lt;T&gt;\n{\n    void Register&lt;TKey&gt;(Func&lt;TKey&gt; factory) where TKey : T;\n    T Resolve(Type type);\n    void ResolveAll();\n}\n\npublic sealed class ControllerResolver : IResolver&lt;Controller&gt;\n{\n    private Dictionary&lt;Type, Func&lt;Controller&gt;&gt; _factories = new Dictionary&lt;Type, Func&lt;Controller&gt;&gt;();\n        \n    public void Register&lt;TKey&gt;(Func&lt;TKey&gt; factory) where TKey : Controller\n    {\n        _factories.Add(typeof(TKey), factory);\n    }\n    \n    public Controller Resolve(Type type) =&gt; _factories[type]();\n\n    public void ResolveAll()\n    {\n        foreach (var pair in _factories)\n        {\n            // Correctly outputs what I want\n            Console.WriteLine(pair.Value.Method.ReturnType);            \n        }\n    }\n}\n</code></pre>\n<p>And here are some usage examples:</p>\n<pre><code>void Main()\n{\n    var resolver = new ControllerResolver();\n    resolver.Register(() =&gt; new PersonController());\n    resolver.Register(() =&gt; new OrderController());   \n    \n    resolver.ResolveAll();\n    resolver.Resolve(typeof(PersonController));\n}\n</code></pre>\n"}, {"tags": ["c#", "methods"], "comments": [{"owner": {"reputation": 27104, "user_id": 3185569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177ae94ca98997a0ae4acd38db6ff47?s=128&d=identicon&r=PG&f=1", "display_name": "Zein Makki", "link": "https://stackoverflow.com/users/3185569/zein-makki"}, "edited": false, "score": 0, "creation_date": 1480538472, "post_id": 40897760, "comment_id": 69009280, "body": "Where do you define <code>CreateJuice</code> and <code>AddOrange</code>? You don&#39;t show the class name. You showed things that don&#39;t matter and hidden things that matter."}, {"owner": {"reputation": 1018, "user_id": 379024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cda615d5189bcde6eb99958f11e06fc?s=128&d=identicon&r=PG", "display_name": "Jason Massey", "link": "https://stackoverflow.com/users/379024/jason-massey"}, "edited": false, "score": 0, "creation_date": 1480538508, "post_id": 40897760, "comment_id": 69009307, "body": "Since AddOranges is a staic method you need to preface it with the name of the class.  So if the class is Fruit, then calling Fruit.AddOranges() would return your list."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 4, "creation_date": 1480538628, "post_id": 40897760, "comment_id": 69009373, "body": "&quot;AddOranges does not exist in the current context&quot; -- Maybe if you called it by its actual name, <code>AddOrange()</code>? That is, assuming that&#39;s not a typo from typing up the question. If it is, then look at the <code>classname.method()</code> suggestion above."}], "answers": [{"tags": [], "owner": {"reputation": 5975, "user_id": 187365, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/CIlaX.jpg?s=128&g=1", "display_name": "Fran", "link": "https://stackoverflow.com/users/187365/fran"}, "is_accepted": false, "score": 0, "last_activity_date": 1480538503, "creation_date": 1480538503, "answer_id": 40897798, "question_id": 40897760, "link": "https://stackoverflow.com/questions/40897760/calling-a-method-c/40897798#40897798", "title": "Calling a method, C#", "body": "<p>you need to qualify the method call with the class name since it's static</p>\n\n<pre><code>var totalSum = OrangeJuice.CreateJuice(OrangeJuice.AddOranges());\n</code></pre>\n\n<p>I'm assuming they are in the same class.</p>\n"}], "owner": {"reputation": 65, "user_id": 7116287, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5dc878d09083bc8e020ccc794c11e44b?s=128&d=identicon&r=PG&f=1", "display_name": "LittleBird", "link": "https://stackoverflow.com/users/7116287/littlebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1480540158, "creation_date": 1480538357, "last_edit_date": 1480539260, "question_id": 40897760, "link": "https://stackoverflow.com/questions/40897760/calling-a-method-c", "title": "Calling a method, C#", "body": "<p>I can't get it to work! When I type this code in main to call the method \"CreateJuice\":</p>\n\n<pre><code>var totalSum = OrangeJuice.CreateJuice(AddOranges());\n</code></pre>\n\n<p>I get this error: The name AddOranges does not exist in the current context. I need help calling my method.</p>\n\n<p>How can I call my CreateJuice method?</p>\n"}, {"tags": ["c#", "unity3d", "rotation"], "comments": [{"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 0, "creation_date": 1480543630, "post_id": 40897629, "comment_id": 69011992, "body": "Can you show a screenshot of your hierarchy, just so it&#39;s clear to readers exactly what the situation is? I may know how to approach a solution, but I don&#39;t want to base it on false assumptions."}, {"owner": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "reply_to_user": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 0, "creation_date": 1480547045, "post_id": 40897629, "comment_id": 69013470, "body": "Thanks for helping Serlite, I just update the OP with screenshot."}, {"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 0, "creation_date": 1480548737, "post_id": 40897629, "comment_id": 69014079, "body": "All right. One additional clarification - when you say the moon should always be facing &quot;up&quot;, it sounds like you mean &quot;up&quot; relative to the planet&#39;s surface. Is this correct? Or do you mean &quot;up&quot; in the world space?"}, {"owner": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "reply_to_user": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 0, "creation_date": 1480549728, "post_id": 40897629, "comment_id": 69014410, "body": "Yes, you are correct it&#39;s up relative to the planet&#39;s surface.  See I couldn&#39;t even articulate that LOL."}], "answers": [{"comments": [{"owner": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "edited": false, "score": 0, "creation_date": 1480554265, "post_id": 40900592, "comment_id": 69015649, "body": "Thanks Serlite, I&#39;m trying it now.  Looks like an elegant solution and thanks for breaking it down.   It seems to be working, but looks like it&#39;s going in the opposite direction.  It&#39;s probably something I&#39;m doing.  I&#39;ll be back..."}, {"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "reply_to_user": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "edited": false, "score": 0, "creation_date": 1480554705, "post_id": 40900592, "comment_id": 69015750, "body": "@Valerie Hm, weird. Make sure the moon is translated positively along its local z-axis, not negatively - otherwise it will end up on the opposite side of the planet using this approach."}, {"owner": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "edited": false, "score": 0, "creation_date": 1480554998, "post_id": 40900592, "comment_id": 69015828, "body": "Thanks, that&#39;s what I think.  I&#39;m updated the OP with better screen shot showing hierarchy"}, {"owner": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "edited": false, "score": 0, "creation_date": 1480555802, "post_id": 40900592, "comment_id": 69016034, "body": "You mention making sure my moon is translated positively along it&#39;s local z-axis.  How do I make sure?  I&#39;ve checked the inspector and everything is 0,0,0 as far as rotation."}, {"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "reply_to_user": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "edited": false, "score": 0, "creation_date": 1480555932, "post_id": 40900592, "comment_id": 69016061, "body": "What I mean is that the x and y translation values should be 0, and the z value should be a positive value (high enough that your moon is positioned over top of the planet). The rotation doesn&#39;t really matter for the moon."}, {"owner": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "edited": false, "score": 0, "creation_date": 1480556169, "post_id": 40900592, "comment_id": 69016123, "body": "That did it.  The moon had x and z = 0 and y was changed so that the moon was above the planet.  Perfect!!  Can&#39;t believe it thanks so much."}, {"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "reply_to_user": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "edited": false, "score": 0, "creation_date": 1480556201, "post_id": 40900592, "comment_id": 69016129, "body": "Super! Glad to help out, it was an interesting problem to solve."}], "tags": [], "owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "is_accepted": true, "score": 2, "last_activity_date": 1480552120, "last_edit_date": 1480552120, "creation_date": 1480551643, "answer_id": 40900592, "question_id": 40897629, "link": "https://stackoverflow.com/questions/40897629/how-do-i-rotate-an-object-to-a-specific-position-around-another-object-essenti/40900592#40900592", "title": "How do I rotate an object to a specific position around another object? (Essentially orbiting to specified position)", "body": "<p>You've already made things a lot easier by nesting your moon inside an empty transform. If it's properly set up*, this means you won't have to directly manipulate the moon's <code>transform</code> - you just need to rotate the container object until it faces the target position.</p>\n\n<p>*<em>By this, I mean the container object is at (0, 0, 0) relative to the planet, and the moon is only locally translated along the z-axis so it lines up with the container's <code>transform.forward</code> vector.</em></p>\n\n<p>The problem is easier to approach if we break it down into smaller steps:</p>\n\n<ul>\n<li><strong>Determining the target direction the container needs to face.</strong> We can get this by just subtracting the container's position from the target position.</li>\n<li><strong>Calculating the required rotation for the container to face the target direction.</strong> This is a good place for <a href=\"https://docs.unity3d.com/ScriptReference/Quaternion.LookRotation.html\" rel=\"nofollow noreferrer\"><code>Quaternion.LookRotation()</code></a>.</li>\n<li><strong>Rotating the container until its direction matches the target direction.</strong> <a href=\"https://docs.unity3d.com/ScriptReference/Quaternion.Lerp.html\" rel=\"nofollow noreferrer\"><code>Quaternion.Lerp()</code></a> can be used to achieve this.</li>\n</ul>\n\n<p>Here's how you might implement these steps:</p>\n\n<pre><code>Quaternion targetRotation;\nQuaternion startRotation;\nfloat progress = 1;\n\nvoid SetTargetPosition(Vector3 position)\n{\n    // Calculating the target direction\n    Vector3 targetDir = position - dummy.transform.position;\n\n    // Calculating the target rotation for the container, based on the target direction\n    targetRotation = Quaternion.LookRotation(targetDir);\n    startRotation = dummy.transform.rotation;\n\n    // Signal the rotation to start\n    progress = 0;\n}\n\nvoid Update()\n{\n    if (progress &lt; 1)\n    {\n        // If a rotation is occurring, increment the progress according to time\n        progress += Time.deltaTime;\n\n        // Then, use the progress to determine the container's current rotation\n        dummy.transform.rotation = Quaternion.Lerp(startRotation, targetRotation, progress);\n    }\n}\n</code></pre>\n\n<p><em>Note: If the moon is rotating too quickly (it will currently complete the rotation in ~1 second), just add less to <code>progress</code> every frame, eg. Divide it by a factor.</em></p>\n\n<p>As long as the container is centered in the planet, the moon should remain a constant distance away from the surface at all times, and by this method will always keep a consistent \"up\" direction relative to the planet's surface.</p>\n\n<p>Hope this helps! Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 627, "user_id": 574623, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fa11710815efc0d28f1ada75a41631?s=128&d=identicon&r=PG", "display_name": "Valerie", "link": "https://stackoverflow.com/users/574623/valerie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "accepted_answer_id": 40900592, "answer_count": 1, "score": 0, "last_activity_date": 1480555053, "creation_date": 1480537905, "last_edit_date": 1480555053, "question_id": 40897629, "link": "https://stackoverflow.com/questions/40897629/how-do-i-rotate-an-object-to-a-specific-position-around-another-object-essenti", "title": "How do I rotate an object to a specific position around another object? (Essentially orbiting to specified position)", "body": "<p>I have a planet and a moon. The moon is parented to a dummy object, which is located at the center of the planet (essentially 0,0,0). The moon is free to rotate around (to any position on) the planet. It should maintain a constant distance from the planet.</p>\n\n<p>I have a specific point in mind that I want to rotate the moon to, though it needs to stay upright.  That is, the moon should consistently point \"up\" relative to the planet's surface. Basically it's like a \"moveTo\" script only in my case the moon should \"rotate\" around the planet until it reaches the point I'm looking for.</p>\n\n<p>Here's what I have so far, though I can't work out the correct logic to use:</p>\n\n<pre><code>Vector3 targetDir = moveToPos - moon.transform.position;\n\nfloat angle = Vector3.Angle( targetDir, moon.transform.up );\n\ndummy.transform.RotateAround (moveToPos, moon.transform.up, angle);\n</code></pre>\n\n<p>Am I thinking of this correctly?  Once I get this working, I'd like to feed the moon different <code>Vector3</code> positions and have the moon rotate to them on the surface of the planet. I have searched for something similar but can't find what I'm looking for.</p>\n\n<p>The marker displayed in this screenshot should say \"Rotate here\", but this is essentially what my scene looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IfLih.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IfLih.png\" alt=\"Marker shows where the moon should be moved\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/HsGhJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HsGhJ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "entity-framework", "ef-code-first", "ef-fluent-api"], "comments": [{"owner": {"reputation": 5537, "user_id": 6197785, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/PwBYM.jpg?s=128&g=1", "display_name": "mshwf", "link": "https://stackoverflow.com/users/6197785/mshwf"}, "edited": false, "score": 0, "creation_date": 1480539169, "post_id": 40897609, "comment_id": 69009664, "body": "Why didn&#39;t you call <code>SaveChanges</code> in the <code>Seed</code> method?"}, {"owner": {"reputation": 241, "user_id": 7232907, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3Wj5UNYhwDI/AAAAAAAAAAI/AAAAAAAAAFc/A0UPk7U60Ug/photo.jpg?sz=128", "display_name": "Bille", "link": "https://stackoverflow.com/users/7232907/bille"}, "reply_to_user": {"reputation": 5537, "user_id": 6197785, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/PwBYM.jpg?s=128&g=1", "display_name": "mshwf", "link": "https://stackoverflow.com/users/6197785/mshwf"}, "edited": false, "score": 0, "creation_date": 1481281203, "post_id": 40897609, "comment_id": 69324268, "body": "i dont need to. Ive got it working now, and i never use save changes :)"}], "answers": [{"tags": [], "owner": {"reputation": 3435, "user_id": 2324535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfNbQ.jpg?s=128&g=1", "display_name": "Karel Tamayo", "link": "https://stackoverflow.com/users/2324535/karel-tamayo"}, "is_accepted": true, "score": 0, "last_activity_date": 1480544641, "last_edit_date": 1480544641, "creation_date": 1480544255, "answer_id": 40899269, "question_id": 40897609, "link": "https://stackoverflow.com/questions/40897609/seeding-code-first-fluent-api-database-ef-code-first-issues/40899269#40899269", "title": "seeding code first fluent api database EF code-first issues", "body": "<p>Well, you're having all this errors because you've created circular required dependencies between your entities and now the database doesn't know how to insert them properly.</p>\n\n<p>You'll need then to loose your model a bit so one of the required properties becomes optional and then you'll be able to seed your database correctly.</p>\n\n<p>Let's say you set the Department as optional in your User entity. </p>\n\n<p>At the moment you are letting EF to generate your foreign key as you're not defining it on your OnModelCreating method.</p>\n\n<p>So start by exposing your foreign key on your user:</p>\n\n<pre><code>public class User : AbstractEntity\n{\n    public int? DepartmentId { get; set; }\n}\n</code></pre>\n\n<p>Note that I've set it as nullable so we can now define this relationship as optional:</p>\n\n<pre><code>protected override void OnModelCreating(DbModelBuilder modelBuilder)\n{\n    modelBuilder.Entity&lt;User&gt;()\n        .HasOptional(u =&gt; u.Department)\n        .WithMany(d =&gt; d.Users)\n        .HasForeignKey(x =&gt; x.DepartmentId)\n        .WillCascadeOnDelete(false);\n}\n</code></pre>\n\n<p>Ensure you initialize your Users property on Department's constructor so you don't get a NullReferenceException trying to add users to the departments:</p>\n\n<pre><code>public Department()\n{\n    Users = new List&lt;User&gt;();    \n}\n</code></pre>\n\n<p>Create a new migration and update your database. Then you can use this initializer:</p>\n\n<pre><code>public class DBInitializer : DropCreateDatabaseAlways&lt;FravaerContext&gt;\n{\n    protected override void Seed(FravaerContext context)\n    {\n        //create the users first\n        //save the users in a list so later we can create the departments\n        var users = new List&lt;User&gt;();\n\n        for (var i = 1; i &lt;= 4; i++)\n        {\n            var user = new User\n            {\n                Id = i,\n                Absences = new List&lt;Absence&gt;(),\n                Email = $\"chief{i}@chief.dk\",\n                FirstName = $\"Chief{i}\",\n                LastName = $\"Chiefsen{i}\",\n                Password = \"admin\",\n                UserName = \"user\" + i,\n                Role = Role.DepartmentChief\n            };\n            users.Add(user);\n            context.Users.Add(user);\n        }\n\n        //create one department for each user (with that user as the chief)\n        var departmentId = 1;\n\n        //save the departments so later we can seed them with users\n        var departments = new List&lt;Department&gt;();\n        foreach (var user in users)\n        {\n            var d = new Department\n            {\n                Id = departmentId++,\n                DepartmentChief = user\n            };\n\n            departments.Add(d);\n            context.Departments.Add(d);\n        }\n\n        //seeed the departments with users\n        foreach (var department in departments)\n        {\n            //add 5 users to each department\n            for (var i = 1; i &lt; 5; i++)\n            {\n                var user = new User\n                {\n                    Absences = new List&lt;Absence&gt;(),\n                    Email = $\"user{department.Id}{i}@user.dk\",\n                    FirstName = $\"User{department.Id}{i}\",\n                    LastName = $\"Username{department.Id}{i}\",\n                    Password = \"user\",\n                    UserName = \"\" + department.Id + i,\n                    Role = Role.DepartmentChief\n                };\n                department.Users.Add(user);\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>What I've done here is decompose the seeding task into smaller pieces, so I first create the chief users (with no department), later I create the departments with the previously created users and lastly the users for each departments.</p>\n\n<p>The advantage of this method is that you have full control over how many users, departments and chiefs you create.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 241, "user_id": 7232907, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3Wj5UNYhwDI/AAAAAAAAAAI/AAAAAAAAAFc/A0UPk7U60Ug/photo.jpg?sz=128", "display_name": "Bille", "link": "https://stackoverflow.com/users/7232907/bille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 40899269, "answer_count": 1, "score": 0, "last_activity_date": 1480586766, "creation_date": 1480537835, "last_edit_date": 1480586766, "question_id": 40897609, "link": "https://stackoverflow.com/questions/40897609/seeding-code-first-fluent-api-database-ef-code-first-issues", "title": "seeding code first fluent api database EF code-first issues", "body": "<p>im having trouble seeding and creating a database matching my needs.\nI have 2 entities; User and Department.\nA User requires a department, and a department can have many users, but at the same time, a Department requires a single user to be its DepartmentChief.\nI can figure out how i can set this up, every attempt has resulted in exceptions of various kind.</p>\n\n<hr>\n\n<p>Here is my <strong>context</strong>:</p>\n\n<pre><code>public class FravaerContext : DbContext\n{\n    public FravaerContext() : base(\"name=DefaultConnection\")\n    {\n        Database.SetInitializer(new DBInitializer());\n    }\n\n\n    protected override void OnModelCreating(DbModelBuilder modelBuilder)\n    {\n        modelBuilder.Entity&lt;User&gt;().HasRequired&lt;Department&gt;(u =&gt; u.Department).WithMany(d =&gt; d.Users).WillCascadeOnDelete(false);\n        modelBuilder.Entity&lt;Department&gt;().HasRequired(d =&gt; d.DepartmentChief);\n\n        //modelBuilder.Entity&lt;Absence&gt;().HasRequired&lt;User&gt;(a =&gt; a.User).WithMany(u =&gt; u.Absences).WillCascadeOnDelete(false);\n        base.OnModelCreating(modelBuilder);\n    }\n\n    public DbSet&lt;Absence&gt; Absences { get; set; }\n    public DbSet&lt;Department&gt; Departments { get; set; }\n    public DbSet&lt;User&gt; Users { get; set; }\n\n}\n\npublic class DBInitializer : DropCreateDatabaseAlways&lt;FravaerContext&gt;\n{\n    protected override void Seed(FravaerContext context)\n    {\n        for (int i = 1; i &lt;= 4; i++)\n        {\n            User chief = new User() {Id = i, Absences = new List&lt;Absence&gt;(), Email = $\"chief{i}@chief.dk\", FirstName = $\"Chief{i}\",LastName = $\"Chiefsen{i}\",Password = \"admin\",UserName = \"\"+i,Role = Role.DepartmentChief};\n\n            Department d = new Department() {Id = i, Users = new List&lt;User&gt;() { chief }, DepartmentChief = chief };\n\n\n            chief.Department = d;\n\n            context.Departments.Add(d);\n        }\n        base.Seed(context);\n    }\n}\n</code></pre>\n\n<p>And my <strong>entities</strong> (AbstractEntity only provides Id to entity-classes):</p>\n\n<pre><code>  public class Department : AbstractEntity\n{\n    public List&lt;User&gt; Users { get; set; }\n    public User DepartmentChief { get; set; }\n\n}\n\npublic class User : AbstractEntity\n{\n    public string FirstName { get; set; }\n    public string LastName { get; set; }\n    public string UserName { get; set; }\n    public string Password { get; set; }\n    public string Email { get; set; }\n    public List&lt;Absence&gt; Absences { get; set; }\n    public Department Department { get; set; }\n    public Role Role { get; set; }\n\n}\n</code></pre>\n"}, {"tags": ["c#", "graphics"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1480537770, "post_id": 40897555, "comment_id": 69008864, "body": "Use the Paint event and get rid of <code>CreateGraphics</code> and the Graphics object"}, {"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 1, "creation_date": 1480537847, "post_id": 40897555, "comment_id": 69008926, "body": "And use a Timer instead of <code>Thread.Sleep</code>."}, {"owner": {"reputation": 8041, "user_id": 1771817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/zeTmI.jpg?s=128&g=1", "display_name": "adv12", "link": "https://stackoverflow.com/users/1771817/adv12"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1480537883, "post_id": 40897555, "comment_id": 69008952, "body": "Do as @Plutonix says, and use Invalidate() to force a repaint.  Also, never sleep the UI thread."}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1480538065, "post_id": 40897555, "comment_id": 69009059, "body": "It would be <i>very difficult</i> to do any research on this using SO posts and not have already encountered this advice"}, {"owner": {"reputation": 19, "user_id": 6736702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7KKrOqidQw/AAAAAAAAAAI/AAAAAAAAADo/fcyaq-KjpeU/photo.jpg?sz=128", "display_name": "RageSkilln", "link": "https://stackoverflow.com/users/6736702/rageskilln"}, "edited": false, "score": 0, "creation_date": 1480538224, "post_id": 40897555, "comment_id": 69009132, "body": "But how can I do that?"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1480538333, "post_id": 40897555, "comment_id": 69009205, "body": "Do <i>what</i>?  Search SO for good code / the right way to paint?"}, {"owner": {"reputation": 19, "user_id": 6736702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7KKrOqidQw/AAAAAAAAAAI/AAAAAAAAADo/fcyaq-KjpeU/photo.jpg?sz=128", "display_name": "RageSkilln", "link": "https://stackoverflow.com/users/6736702/rageskilln"}, "edited": false, "score": 0, "creation_date": 1480539268, "post_id": 40897555, "comment_id": 69009735, "body": "I searched for it but nothing helped me. so I ask no here."}, {"owner": {"reputation": 8041, "user_id": 1771817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/zeTmI.jpg?s=128&g=1", "display_name": "adv12", "link": "https://stackoverflow.com/users/1771817/adv12"}, "edited": false, "score": 0, "creation_date": 1480541980, "post_id": 40897555, "comment_id": 69011201, "body": "@RageSkilln, <a href=\"http://stackoverflow.com/questions/30419493/drawing-glitches-when-using-creategraphics-rather-than-paint-event-handler-for-c\">here</a> is a Q&amp;A that may help you."}, {"owner": {"reputation": 19, "user_id": 6736702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7KKrOqidQw/AAAAAAAAAAI/AAAAAAAAADo/fcyaq-KjpeU/photo.jpg?sz=128", "display_name": "RageSkilln", "link": "https://stackoverflow.com/users/6736702/rageskilln"}, "edited": false, "score": 0, "creation_date": 1480542439, "post_id": 40897555, "comment_id": 69011407, "body": "Ok but how can help me the paint event when the user doesnt draw anything or do the code looks like"}], "owner": {"reputation": 19, "user_id": 6736702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-j7KKrOqidQw/AAAAAAAAAAI/AAAAAAAAADo/fcyaq-KjpeU/photo.jpg?sz=128", "display_name": "RageSkilln", "link": "https://stackoverflow.com/users/6736702/rageskilln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 357, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480537961, "creation_date": 1480537642, "last_edit_date": 1480537961, "question_id": 40897555, "link": "https://stackoverflow.com/questions/40897555/c-picturebox-graphic-flickering", "title": "C# - PictureBox Graphic flickering", "body": "<p>I try to make an animated Ball like PingPong, it is working but there are the graphic flickerings. I searched throw the web nothing helped me. I have double buffered the form and I tried it with Drawing with bitmaps but then the Ball wont show.\nHere my Code for the ball animation:</p>\n\n<pre><code>        protected PictureBox pictureBox;\n    protected Graphics graphics;\n    //\n    public MoveBall(PictureBox pictureBox)\n    {\n        this.pictureBox = pictureBox;\n        graphics = pictureBox.CreateGraphics();\n    }\n    //\n    public void AnimateBall(List&lt;Point&gt; positions, Ball ball)\n    {\n        foreach (Point point in positions)\n        {\n            graphics.FillEllipse(new SolidBrush(pictureBox.BackColor), new Rectangle(ball.Position.X - Convert.ToInt32(Convert.ToDouble(ball.Width) * 0.5), ball.Position.Y - Convert.ToInt32(Convert.ToDouble(ball.Height) * 0.5), ball.Width, ball.Height));\n            ball.Position = point;\n            graphics.FillEllipse(new SolidBrush(ball.Color), new Rectangle(point.X - Convert.ToInt32(Convert.ToDouble(ball.Width) * 0.5), point.Y - Convert.ToInt32(Convert.ToDouble(ball.Height) * 0.5), ball.Width, ball.Height));\n            Thread.Sleep(1);\n        }\n    }\n</code></pre>\n"}, {"tags": ["c#", "asp.net-web-api"], "comments": [{"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1480537755, "post_id": 40897554, "comment_id": 69008857, "body": "Can you access your endpoint methods from the browser?"}, {"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1480537826, "post_id": 40897554, "comment_id": 69008909, "body": "Maybe a <code>CORS</code> issue?"}, {"owner": {"reputation": 3095, "user_id": 3545438, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a7e318fc7a4e748e9be04ea7b03341e7?s=128&d=identicon&r=PG", "display_name": "Matthew Flynn", "link": "https://stackoverflow.com/users/3545438/matthew-flynn"}, "edited": false, "score": 0, "creation_date": 1480537888, "post_id": 40897554, "comment_id": 69008959, "body": "What do you have in your startup.cs or global.asax file?"}, {"owner": {"reputation": 557, "user_id": 1330150, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/379c9008f1ba764dae1d02e7e5c72221?s=128&d=identicon&r=PG", "display_name": "Daryl1976", "link": "https://stackoverflow.com/users/1330150/daryl1976"}, "edited": false, "score": 0, "creation_date": 1480539251, "post_id": 40897554, "comment_id": 69009728, "body": "It&#39;s definitely not a CORS issue, because I&#39;m accessing the endpoint directly through Fiddler -- on the local I get the JSON data, but on remote server, I got {&quot;Message&quot;:&quot;Authorization has been denied for this request.&quot;}.  I have updated my question with the code from global.asax"}, {"owner": {"reputation": 17933, "user_id": 1249641, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/36f92eb927954a52eeb1331e494f4897?s=128&d=identicon&r=PG&f=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/1249641/marco"}, "edited": false, "score": 0, "creation_date": 1480539855, "post_id": 40897554, "comment_id": 69010060, "body": "Please verify, that you have anonymous access enabled under Authentication in your remote IIS."}, {"owner": {"reputation": 557, "user_id": 1330150, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/379c9008f1ba764dae1d02e7e5c72221?s=128&d=identicon&r=PG", "display_name": "Daryl1976", "link": "https://stackoverflow.com/users/1330150/daryl1976"}, "edited": false, "score": 0, "creation_date": 1480540129, "post_id": 40897554, "comment_id": 69010196, "body": "Yes AnonymousAuthentication is set to enabled for this website in remote IIS"}], "owner": {"reputation": 557, "user_id": 1330150, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/379c9008f1ba764dae1d02e7e5c72221?s=128&d=identicon&r=PG", "display_name": "Daryl1976", "link": "https://stackoverflow.com/users/1330150/daryl1976"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480544743, "creation_date": 1480537637, "last_edit_date": 1480544743, "question_id": 40897554, "link": "https://stackoverflow.com/questions/40897554/webapi-always-returning-401-on-remote-server", "title": "Webapi always returning 401 on remote server", "body": "<p>I have created an api using webapi 2 that is configured as below</p>\n\n<pre><code>public static void Register(HttpConfiguration config)\n        {\n\n             config.Routes.MapHttpRoute(\n                name: \"ControllerAndAction\",\n                routeTemplate: \"api/{controller}/{action}\"\n            );\n\n\n\n            config.Routes.MapHttpRoute(\n                name: \"DefaultApi\",\n                routeTemplate: \"api/{controller}/{id}\",\n                defaults: new { id = RouteParameter.Optional }\n            );\n\n            config.EnableSystemDiagnosticsTracing();\n            config.Filters.Add(new AuthorizeAPIRequest());\n            config.Filters.Add(new AddCorsHeader());\n            config.MessageHandlers.Add(new EncodingDelegateHandler());\n\n        }\n</code></pre>\n\n<p>It works fine locally. However when I put it on a remote server, all requests return a 401 unauthorized error.  However, the bin files and web.config files are exactly the same.  Digging deeper, I added tracing to the remote server, and uncovered the following</p>\n\n<pre><code>w3wp.exe Information: 0 : Operation=AuthorizeAPIRequest.OnAuthorizationAsync, Status=401 (Unauthorized)\nw3wp.exe Information: 0 : Operation=askTheExpertController.ExecuteAsync, Status=401 (Unauthorized)\nw3wp.exe Information: 0 : Operation=EncodingDelegateHandler.SendAsync, Status=401 (Unauthorized)\n</code></pre>\n\n<p>Essentially, the request is not even allowed authorization into the authorization method on the remote server! Locally the trace log looks as follows</p>\n\n<pre><code>w3wp.exe Information: 0 : Operation=AuthorizeAPIRequest.OnAuthorizationAsync\nw3wp.exe Information: 0 : Message='Parameter 'values' bound to the value 'LifespeakUserAdmin.Models.LifespeakAssetQueryValues'', Operation=ModelBinderParameterBinding.ExecuteBindingAsync\nw3wp.exe Information: 0 : Message='Model state is valid. Values: values=LifespeakUserAdmin.Models.LifespeakAssetQueryValues', Operation=HttpActionBinding.ExecuteBindingAsync\n</code></pre>\n\n<p>I have verified the both the dll and the webconfig files on both the local and remote servers are identical.  What else could be accounting for this? Is there any way to 'force' the application to allow access to these methods?</p>\n\n<p><strong>UPDATE: I was able to get this to work simply by changing the hostname binding in IIS.  The host was using the TLD .rocks -- when I changed it to .com. It magically worked -- they're both pointing to the same site, so not sure why this would be the case</strong></p>\n"}, {"tags": ["c#", "sql", "wpf", "ms-access"], "comments": [{"owner": {"reputation": 18731, "user_id": 37710, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/80b9bce2ab2ae2602d75894c966b4fa5?s=128&d=identicon&r=PG", "display_name": "n8wrl", "link": "https://stackoverflow.com/users/37710/n8wrl"}, "edited": false, "score": 1, "creation_date": 1480537722, "post_id": 40897549, "comment_id": 69008840, "body": "Can you show us a sample of what company.getImage() returns?"}, {"owner": {"reputation": 2298, "user_id": 6709604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0e089029eb5143d6a404f975e275d6?s=128&d=identicon&r=PG&f=1", "display_name": "SS_DBA", "link": "https://stackoverflow.com/users/6709604/ss-dba"}, "edited": false, "score": 1, "creation_date": 1480537957, "post_id": 40897549, "comment_id": 69009001, "body": "What is the datatype for the image column? What is the exact error?"}, {"owner": {"reputation": 73, "user_id": 7232928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0be9e9c5dd72fdcf1bb3b087463e9d9?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Merz", "link": "https://stackoverflow.com/users/7232928/alex-merz"}, "edited": false, "score": 0, "creation_date": 1480538154, "post_id": 40897549, "comment_id": 69009102, "body": "Datatype has been both short text and long text, and the it will normally return something like &quot;Q:\\Database\\Profiles\\ProfilePhotos\\depp.jpg&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7232928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0be9e9c5dd72fdcf1bb3b087463e9d9?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Merz", "link": "https://stackoverflow.com/users/7232928/alex-merz"}, "edited": false, "score": 0, "creation_date": 1480538371, "post_id": 40897686, "comment_id": 69009226, "body": ".... Have to love it when you over think the easiest solution, thank you so much, will mark as answer when I can."}, {"owner": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "edited": false, "score": 1, "creation_date": 1480538402, "post_id": 40897686, "comment_id": 69009238, "body": "Oh, the amount of times I&#39;ve had to &quot;escape&quot; column names in SQL when writing out scripts. Particularly the <code>Key</code> and <code>Value</code> ones... Good answer, Steve :)"}, {"owner": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "edited": false, "score": 1, "creation_date": 1480538560, "post_id": 40897686, "comment_id": 69009334, "body": "If only I could +1 twice! Genuinely good to see SO members going the extra mile to look at things deeper than just the original question - by that, I mean the extra note about using properties."}], "tags": [], "owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "is_accepted": true, "score": 4, "last_activity_date": 1480538647, "last_edit_date": 1480538647, "creation_date": 1480538112, "answer_id": 40897686, "question_id": 40897549, "link": "https://stackoverflow.com/questions/40897549/error-when-trying-to-save-file-path-to-database/40897686#40897686", "title": "Error when trying to save file path to database", "body": "<p>Image is a reserved word in MS-Access Database Engine. You cannot use it as is in a query like yours. You need to encapsulate it between square brackets (or better change that field name to avoid similar problems in future)</p>\n\n<pre><code>....., [Image]) VALUES (.....\n</code></pre>\n\n<p>If you are aware of the problems caused by string concatenations then I really suggest you to switch as soon as possible to a Parameterized Query. (For example, what do you think will happen if your company.getDescription returns a value containing single quote?)</p>\n\n<p>Another important advice that I feel to give is to abandon the java-like  attitude to return properties of a class using get/set prefixed methods. One of the most distinguished feature of C# are properties. Use them.</p>\n\n<pre><code>public class Company\n{\n    public string Description {get;set;}\n    public string Phone {get;set;}\n    .... and so on...\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7232928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0be9e9c5dd72fdcf1bb3b087463e9d9?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Merz", "link": "https://stackoverflow.com/users/7232928/alex-merz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 40897686, "answer_count": 1, "score": 4, "last_activity_date": 1480538647, "creation_date": 1480537619, "question_id": 40897549, "link": "https://stackoverflow.com/questions/40897549/error-when-trying-to-save-file-path-to-database", "title": "Error when trying to save file path to database", "body": "<p>I'm having an issue when I try to save a file path into Microsoft access DB, when I remove the image location from the below code, everything runs fine, as soon as I try to save a file path I get a syntax error... </p>\n\n<p>below is the query...</p>\n\n<pre><code>string query = \"INSERT INTO Company(companyName, phone, website, address, companyType, description, image) VALUES('\" + \n            company.getName() + \"','\" + company.getPhone() + \"','\" +  company.getWebsite() + \"','\" +  \n            company.getAddress() + \"','\" + company.getType() + \"','\" + company.getDescription() + \"','\" +\n            company.getImage() + \"')\";\n</code></pre>\n\n<p>I know my code is open to sql injection but I will fix that at a later state, I have also tried parametrized queries to see if that would help the issue but it does not..</p>\n\n<p>I've also tried replacing \"\\\" with \"/\"</p>\n\n<p>Any help would be appreciated as this is really annoying me...</p>\n"}, {"tags": ["c#", "visual-studio", "app-config"], "comments": [{"owner": {"reputation": 796419, "user_id": 34397, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/7deca8ec973c3c0875e9a36e1e3e2c44?s=128&d=identicon&r=PG", "display_name": "SLaks", "link": "https://stackoverflow.com/users/34397/slaks"}, "edited": false, "score": 2, "creation_date": 1480537604, "post_id": 40897523, "comment_id": 69008779, "body": "Read the InnerException."}, {"owner": {"reputation": 19654, "user_id": 92837, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1375f202e61682cc4963295f4b0430dc?s=128&d=identicon&r=PG", "display_name": "Sathyajith Bhat", "link": "https://stackoverflow.com/users/92837/sathyajith-bhat"}, "edited": false, "score": 0, "creation_date": 1480589122, "post_id": 40897523, "comment_id": 69029513, "body": "that connection string seems wrong."}, {"owner": {"reputation": 1209, "user_id": 1109687, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1cafb319119aa952f770ffbce6db2128?s=128&d=identicon&r=PG", "display_name": "ksg91", "link": "https://stackoverflow.com/users/1109687/ksg91"}, "edited": false, "score": 1, "creation_date": 1480590179, "post_id": 40897523, "comment_id": 69030223, "body": "That <code>&amp;quot;</code> shouldn&#39;t be there. It should be quotation itself in connection string part."}], "owner": {"reputation": 142, "user_id": 1557592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d15pt.jpg?s=128&g=1", "display_name": "Karan Raj Baruah", "link": "https://stackoverflow.com/users/1557592/karan-raj-baruah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1480589108, "creation_date": 1480537530, "last_edit_date": 1480589108, "question_id": 40897523, "link": "https://stackoverflow.com/questions/40897523/debugging-app-config-file-in-vs2015", "title": "Debugging app.config file in VS2015", "body": "<p>While executing the c# project on VS 2015, the following exception shows up:</p>\n\n<blockquote>\n  <p>An unhandled exception of type 'System.TypeInitializationException'\n  occurred in EntityFramework.dll</p>\n  \n  <p>Additional information: The type initializer for\n  'System.Data.Entity.Internal.AppConfig' threw an exception.</p>\n</blockquote>\n\n<p>Here is the app.config file:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt; &lt;configuration&gt;  \n&lt;configSections&gt;\n    &lt;section name=\"entityFramework\" type=\"System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection,\nEntityFramework, Version=5.0.0.0, Culture=neutral,\nPublicKeyToken=b77a5c561934e089\" requirePermission=\"false\" /&gt;\n    &lt;!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 --&gt;   &lt;/configSections&gt; \n&lt;connectionStrings&gt;\n    &lt;add name=\"project_dbEntities\" connectionString=\"metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;provider=MySql.Data.MySqlClient;provider\nconnection string=&amp;quot;server=localhost;user\nid=root;password=rootpass;persistsecurityinfo=True;database=project_db&amp;quot;\"\nproviderName=\"System.Data.EntityClient\" /&gt;   &lt;/connectionStrings&gt;  \n&lt;startup&gt;\n    &lt;supportedRuntime version=\"v4.0\" sku=\".NETFramework,Version=v4.5\" /&gt;   &lt;/startup&gt;   &lt;entityFramework&gt;\n    &lt;defaultConnectionFactory type=\"System.Data.Entity.Infrastructure.LocalDbConnectionFactory,\nEntityFramework\"&gt;\n      &lt;parameters&gt;\n        &lt;parameter value=\"v13.0\" /&gt;\n      &lt;/parameters&gt;\n    &lt;/defaultConnectionFactory&gt;\n    &lt;providers&gt;\n      &lt;provider invariantName=\"System.Data.SqlClient\" type=\"System.Data.Entity.SqlServer.SqlProviderServices,\nEntityFramework.SqlServer\" /&gt;\n    &lt;/providers&gt;   &lt;/entityFramework&gt;\n\n&lt;/configuration&gt;\n</code></pre>\n"}, {"tags": ["c#", "c++", "shell", "windows-7-x64", "taskbar"], "comments": [{"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1480537594, "post_id": 40897522, "comment_id": 69008774, "body": "you shouldn&#39;t be using .net for shell extensions."}, {"owner": {"reputation": 22481, "user_id": 162167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/MIM9R.jpg?s=128&g=1", "display_name": "Will Marcouiller", "link": "https://stackoverflow.com/users/162167/will-marcouiller"}, "reply_to_user": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1480538368, "post_id": 40897522, "comment_id": 69009224, "body": "@DanielA.White: I don&#39;t mind to use either .NET or native C++, as long as it works. Both ways are feasible, according to the articles provided in the link with the question&#39;s body. Besides, starting from .NET 4, since more than one CLR can be loaded side by side, it is doable in .NET, although not recommended. In the end, the fourth link states being native C++ code, and it doesn&#39;t do much good either."}, {"owner": {"reputation": 22481, "user_id": 162167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/MIM9R.jpg?s=128&g=1", "display_name": "Will Marcouiller", "link": "https://stackoverflow.com/users/162167/will-marcouiller"}, "reply_to_user": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 0, "creation_date": 1480538652, "post_id": 40897522, "comment_id": 69009390, "body": "@ScottChamberlain: I don&#39;t care. I need to do it per customer&#39;s request. It&#39;s doable, and I wanna do it."}, {"owner": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1480538672, "post_id": 40897522, "comment_id": 69009403, "body": "i vaguely remember microsoft removing support for these in windows 7"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 174103, "user_id": 23528, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1595024881f1df4af9e2280926fb6272?s=128&d=identicon&r=PG", "display_name": "Daniel A. White", "link": "https://stackoverflow.com/users/23528/daniel-a-white"}, "edited": false, "score": 0, "creation_date": 1480538839, "post_id": 40897522, "comment_id": 69009488, "body": "@DanielA.White <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd378460%28v=vs.85%29.aspx#deskbands\" rel=\"nofollow noreferrer\">it looks like it is still supported</a>, just that they want you to use thumbnail toolbar where possible instead."}], "owner": {"reputation": 22481, "user_id": 162167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/MIM9R.jpg?s=128&g=1", "display_name": "Will Marcouiller", "link": "https://stackoverflow.com/users/162167/will-marcouiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "closed_date": 1480538736, "answer_count": 0, "score": 0, "last_activity_date": 1480537514, "creation_date": 1480537514, "last_edit_date": 1495540381, "question_id": 40897522, "link": "https://stackoverflow.com/questions/40897522/how-and-where-to-register-a-desk-band-in-the-registry", "closed_reason": "Duplicate", "title": "How and where to register a desk-band in the registry?", "body": "<p>Prior to this question, I asked this one:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/40438889/how-to-add-a-form-to-windows-7-taskbar\">How to add a form to Windows 7 taskbar?</a></li>\n</ol>\n\n<p>I tried with the Code Project source code, which I can't make it work on the Windows Shell Taskbar either.</p>\n\n<ol start=\"2\">\n<li><a href=\"https://www.codeproject.com/articles/2219/extending-explorer-with-band-objects-using-net-and\" rel=\"nofollow noreferrer\">Extending Explorer with Band Objects using .NET and Windows Forms</a></li>\n</ol>\n\n<p>I also tried using the EZShellExtensions.NET library trial, which seems to work fine with Internet Explorer, but I can't have it on the Windows Shell.</p>\n\n<ol start=\"3\">\n<li><a href=\"http://www.ssware.com/ezshell/ezshell.htm\" rel=\"nofollow noreferrer\">EZShellExtensions.Net v2013</a></li>\n</ol>\n\n<p>Then, there's this GitHub native code in C++ which I gave a try by downloading and compiling it, and it doesn't look like it works either.</p>\n\n<ol start=\"4\">\n<li><a href=\"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/winui/shell/shellextensibility/deskbands\" rel=\"nofollow noreferrer\">Windows-classic-samples/Samples/Win7Samples/winui/shell/shellextensibility/deskbands/</a></li>\n</ol>\n\n<p>Notice that when implementing the IDeskBand interface, I did implement the IDeskBand2 as well because I need it to work on Windows 7.</p>\n\n<p>Any other useful information may be provided upon request since I really don't know what to provide as useful information other than what is already in.</p>\n\n<p>I know there's a slight difference between an ExplorerBar and a ToolBar, and that is where to register it. I've been working on this for days, I just can't make it.</p>\n\n<p>So, <strong>where to register a desk-band in the registry to make it appear as a Toolbar option in the Taskbar contextual menu of Windows 7?</strong></p>\n"}, {"tags": ["c#", ".net-core"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1480542293, "post_id": 40897461, "comment_id": 69011340, "body": "You can interface with DllImport into an executable or dll which doesn&#39;t require the dependencies."}, {"owner": {"reputation": 30694, "user_id": 143919, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f992f5923160ab4fef2c2981369cbbed?s=128&d=identicon&r=PG", "display_name": "Dismissile", "link": "https://stackoverflow.com/users/143919/dismissile"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1480601679, "post_id": 40897461, "comment_id": 69037828, "body": "@jdweng that&#39;s not really what I&#39;m looking for at all."}, {"owner": {"reputation": 3274, "user_id": 1639515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Js0Iq.jpg?s=128&g=1", "display_name": "Jaya", "link": "https://stackoverflow.com/users/1639515/jaya"}, "edited": false, "score": 0, "creation_date": 1480728397, "post_id": 40897461, "comment_id": 69097883, "body": "My understanding if we were to use a core nugetpackage in a  full .net (net4.5/46/461) lib is to target that particular framework under <code>framework{}</code> in your <code>project.json</code> file. So it needs to have <code>net542</code> under frameworks section"}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 0, "creation_date": 1480734502, "post_id": 40897461, "comment_id": 69098789, "body": "Most of them should work as just type forwarders on .NET Framework, which you can safely keep."}], "answers": [{"comments": [{"owner": {"reputation": 30694, "user_id": 143919, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f992f5923160ab4fef2c2981369cbbed?s=128&d=identicon&r=PG", "display_name": "Dismissile", "link": "https://stackoverflow.com/users/143919/dismissile"}, "edited": false, "score": 0, "creation_date": 1480775294, "post_id": 40943346, "comment_id": 69107442, "body": "This isn&#39;t true at all. .net 4.5.2 implements netstandard1.2. They are essentially the next iteration of portable class libraries. If I don&#39;t need to use features from the full .net framework then I shouldn&#39;t need to target it. I can install the netstandard1.2 package into my 4.5.2 application, my only concern is seeing a huge list of dependencies that get added because of this."}, {"owner": {"reputation": 3274, "user_id": 1639515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Js0Iq.jpg?s=128&g=1", "display_name": "Jaya", "link": "https://stackoverflow.com/users/1639515/jaya"}, "reply_to_user": {"reputation": 30694, "user_id": 143919, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f992f5923160ab4fef2c2981369cbbed?s=128&d=identicon&r=PG", "display_name": "Dismissile", "link": "https://stackoverflow.com/users/143919/dismissile"}, "edited": false, "score": 0, "creation_date": 1480787769, "post_id": 40943346, "comment_id": 69111097, "body": "True, <i>I may be wrong :(</i>, but I was under the same impression reading their docs that said <code>.net 4.5.1</code> implements <code>netstandard1.2</code>  here <a href=\"https://docs.microsoft.com/en-us/dotnet/articles/standard/library\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/articles/standard/library</a> and so on., but ran into a similar situation when I created my Lib and uploaded it our ProGet Server to be used across all platforms, and when I added it to .net framework lib , it was trying to download System.Collections etc and took for ever crashing VS, so then did target that framework and uploaded a new pkg, I didnt see the same again, so suggested the same. Am sorry, if am mistaken"}, {"owner": {"reputation": 1862, "user_id": 3671357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/333e3cea32cd17ff2007d131df336061?s=128&d=identicon&r=PG", "display_name": "TerribleDev", "link": "https://stackoverflow.com/users/3671357/terribledev"}, "edited": false, "score": 0, "creation_date": 1480808654, "post_id": 40943346, "comment_id": 69117281, "body": "if a library targets netstandard1.2 you can use it in any .net 4.5.1+ apps"}, {"owner": {"reputation": 3274, "user_id": 1639515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Js0Iq.jpg?s=128&g=1", "display_name": "Jaya", "link": "https://stackoverflow.com/users/1639515/jaya"}, "edited": false, "score": 0, "creation_date": 1480840773, "post_id": 40943346, "comment_id": 69123151, "body": "Yup got that wrong,However I did say that one needs to include 452 in the project.json file - please read my answer above ^^ to avoid the dependency downloads or atleast that it did go away in my case"}], "tags": [], "owner": {"reputation": 3274, "user_id": 1639515, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Js0Iq.jpg?s=128&g=1", "display_name": "Jaya", "link": "https://stackoverflow.com/users/1639515/jaya"}, "is_accepted": false, "score": 0, "last_activity_date": 1480728792, "creation_date": 1480728792, "answer_id": 40943346, "question_id": 40897461, "link": "https://stackoverflow.com/questions/40897461/using-a-netstandard-1-2-library-in-4-5-2/40943346#40943346", "title": "using a .netstandard 1.2 library in 4.5.2", "body": "<p>From my understanding if we were to use a core nugetpackage in a  full .net (net4.5/451/452/46/461) lib - one needs to target that particular framework under <code>framework{}</code> in your <code>project.json</code> file. </p>\n\n<p>So it needs to have <code>net542</code> under frameworks section. For e.g. The dapper library (ORM) that is compatible with both full .net framework and core has its project.json with all the frameworks it is targeting as follows: <a href=\"https://github.com/StackExchange/dapper-dot-net/blob/61e965eed900355e0dbd27771d6469248d798293/Dapper/project.json\" rel=\"nofollow noreferrer\">https://github.com/StackExchange/dapper-dot-net/blob/61e965eed900355e0dbd27771d6469248d798293/Dapper/project.json</a> . So from my understanding hence I could reference dapper on both my core and .net web apps.</p>\n"}, {"tags": [], "owner": {"reputation": 1862, "user_id": 3671357, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/333e3cea32cd17ff2007d131df336061?s=128&d=identicon&r=PG", "display_name": "TerribleDev", "link": "https://stackoverflow.com/users/3671357/terribledev"}, "is_accepted": true, "score": 5, "last_activity_date": 1480808576, "creation_date": 1480808576, "answer_id": 40953784, "question_id": 40897461, "link": "https://stackoverflow.com/questions/40897461/using-a-netstandard-1-2-library-in-4-5-2/40953784#40953784", "title": "using a .netstandard 1.2 library in 4.5.2", "body": "<p>If you look carefully the System.Collections package should not contain any DLL's for the .net full framework. I believe instead it just refers to System.Collections as a framework reference. You are still getting the almost empty nuget package because you have a dependency on the NETStandard.Library package, and that defines various api required to implement the library. The extra packages shouldn't actually do anything on the full framework.</p>\n\n<p>If it bothers you (for me it doesn't) You can get around it by being more explicit about your dependencies. </p>\n\n<p>For example:</p>\n\n<pre><code>{\n    \"version\": \"1.0.0-*\",\n\n    \"frameworks\": {\n        \"net452\" : {},\n        \"netstandard1.2\": { \n         \"dependencies\": {\n          \"NETStandard.Library\": \"1.6.1\"\n         },\n       }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 30694, "user_id": 143919, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f992f5923160ab4fef2c2981369cbbed?s=128&d=identicon&r=PG", "display_name": "Dismissile", "link": "https://stackoverflow.com/users/143919/dismissile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2509, "favorite_count": 0, "accepted_answer_id": 40953784, "answer_count": 2, "score": 4, "last_activity_date": 1480808576, "creation_date": 1480537316, "question_id": 40897461, "link": "https://stackoverflow.com/questions/40897461/using-a-netstandard-1-2-library-in-4-5-2", "title": "using a .netstandard 1.2 library in 4.5.2", "body": "<p>I have created a .netstandard 1.2 library, which is compatible with .net 4.5.2.\nIn my library I'm referencing NetStandard.Library 1.6:</p>\n\n<pre><code>{\n    \"version\": \"1.0.0-*\",\n    \"dependencies\": {\n        \"NETStandard.Library\": \"1.6.1\"\n    },\n\n    \"frameworks\": {\n        \"netstandard1.2\": { }\n    }\n}\n</code></pre>\n\n<p>I created a NuGet package from this using dotnet pack and Installed it on my NuGet server. I created a simple console application that targets .NET Framework 4.5.2. I try installing the above NuGet package and I get a huge list of dependencies that it needs to install:</p>\n\n<pre><code>Microsoft.NETCore.Platforms.1.1.0\nSystem.Collections.4.3.0\nSystem.Collections.Concurrent.4.3.0\n... snip\nNETStandard.Library.1.6.0\nMyPackage.1.0.0\n</code></pre>\n\n<p>I'm assuming the reason I see all these packages is because I depend on the metapackage NETStandard.Library, but is there a way to install this into a full .net framework 4.5.2 project without getting all of those packages added? Should I just add framework net452 to my library even though I don't have any conditional compilation that I need to perform?</p>\n"}, {"tags": ["c#", "windows-runtime", "windows-phone-8.1"], "comments": [{"owner": {"reputation": 1739, "user_id": 6719881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EonwB.png?s=128&g=1", "display_name": "Zhendong Wu - MSFT", "link": "https://stackoverflow.com/users/6719881/zhendong-wu-msft"}, "edited": false, "score": 0, "creation_date": 1480585484, "post_id": 40897457, "comment_id": 69026847, "body": "Checking @Rudy huyn&#39;s <a href=\"http://www.rudyhuyn.com/blog/2012/01/12/additional-tiles-disappear-by-themselves/\" rel=\"nofollow noreferrer\">blog</a>, &quot;When creating a secondary Tile, the <code>BackgroundImage</code> and the <code>BackBackgroundImage</code> images must be created using a local resource.&quot; And the <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/hh465398.aspx\" rel=\"nofollow noreferrer\">guideline for developers</a> mentions that you should not change the name of your tile&#39;s default image asset once your app is published. If Windows cannot find the expected image, it will display a blank tile."}, {"owner": {"reputation": 2296, "user_id": 1638290, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2f4fa14def3eb466687431780cf12741?s=128&d=identicon&r=PG", "display_name": "theMaxx", "link": "https://stackoverflow.com/users/1638290/themaxx"}, "reply_to_user": {"reputation": 1739, "user_id": 6719881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EonwB.png?s=128&g=1", "display_name": "Zhendong Wu - MSFT", "link": "https://stackoverflow.com/users/6719881/zhendong-wu-msft"}, "edited": false, "score": 0, "creation_date": 1483043563, "post_id": 40897457, "comment_id": 69975912, "body": "It seems also that adding a share target removes the app&#39;s pinned tiles."}, {"owner": {"reputation": 2296, "user_id": 1638290, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2f4fa14def3eb466687431780cf12741?s=128&d=identicon&r=PG", "display_name": "theMaxx", "link": "https://stackoverflow.com/users/1638290/themaxx"}, "reply_to_user": {"reputation": 1739, "user_id": 6719881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EonwB.png?s=128&g=1", "display_name": "Zhendong Wu - MSFT", "link": "https://stackoverflow.com/users/6719881/zhendong-wu-msft"}, "edited": false, "score": 0, "creation_date": 1484838994, "post_id": 40897457, "comment_id": 70683339, "body": "And also changing the app&#39;s capabilities removes the app&#39;s pinned tiles."}], "answers": [{"comments": [{"owner": {"reputation": 2296, "user_id": 1638290, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2f4fa14def3eb466687431780cf12741?s=128&d=identicon&r=PG", "display_name": "theMaxx", "link": "https://stackoverflow.com/users/1638290/themaxx"}, "edited": false, "score": 0, "creation_date": 1489833664, "post_id": 41676331, "comment_id": 72851225, "body": "Thanks for clarifying this."}], "tags": [], "owner": {"reputation": 4225, "user_id": 3766231, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VUfPd.png?s=128&g=1", "display_name": "iam.Carrot", "link": "https://stackoverflow.com/users/3766231/iam-carrot"}, "is_accepted": true, "score": 2, "last_activity_date": 1484570720, "last_edit_date": 1484570720, "creation_date": 1484569243, "answer_id": 41676331, "question_id": 40897457, "link": "https://stackoverflow.com/questions/40897457/how-to-keep-secondary-tiles-from-disappearing/41676331#41676331", "title": "How to Keep Secondary Tiles from Disappearing?", "body": "<p>Yes, this is an issue I faced too while I was working on them.</p>\n\n<h2>The Reason for the issue:</h2>\n\n<p>sometimes when you make some changes in the code, visual studio realizes that your code would change a lot app flow because of which it removes the app and then redeploys it (retaining the app local storage data).</p>\n\n<h2>What actually happens:</h2>\n\n<p>Because the app was removed and then redeployed the tiles are removed as the application no longer exists in the system and then after it's redeploys you'll need to re-pin the tiles to the start. </p>\n\n<h2>How do you get it solved:</h2>\n\n<p>So basically once you stop redeploying your solution and start using the app like it's downloaded from the store (i.e) after release , the secondary tiles would not get removed. </p>\n\n<h2>To summarize:</h2>\n\n<p>It's only because the visual studio redeploys you app that the secondary tiles get unpinned. You would have noticed it doesn't happen everytime, it just happens a few times when you change a lot of things.</p>\n"}], "owner": {"reputation": 2296, "user_id": 1638290, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2f4fa14def3eb466687431780cf12741?s=128&d=identicon&r=PG", "display_name": "theMaxx", "link": "https://stackoverflow.com/users/1638290/themaxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 41676331, "answer_count": 1, "score": 1, "last_activity_date": 1484570720, "creation_date": 1480537285, "question_id": 40897457, "link": "https://stackoverflow.com/questions/40897457/how-to-keep-secondary-tiles-from-disappearing", "title": "How to Keep Secondary Tiles from Disappearing?", "body": "<p>I have an app for Windows Phone (8.1 using C# WinRT) that can pin secondary tiles to the user's start screen.  It works well so far, and is almost fully functional.</p>\n\n<p>Sometimes after working on the app and making many changes, and then debugging or deploying the app to the actual physical phone device using Visual Studio, all of the tiles currently pinned by the app are removed or disappear.</p>\n\n<p>If the app's main tile is pinned, this is also removed.  The app's user selected settings seem to still be saved on the phone.</p>\n\n<p>For example it seems that changing the app's images and logos used for the visual assets in the app manifest will cause the tiles to disappear, which would make sense I guess for the main tile, but why cause the secondary tiles to also be removed?</p>\n\n<p>What specific kinds of changes will cause the app's secondary pinned tiles to disappear?</p>\n\n<p>Is there a way to prevent it from happening?</p>\n"}, {"tags": ["c#", "streamreader"], "comments": [{"owner": {"reputation": 26838, "user_id": 135769, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Pghgx.jpg?s=128&g=1", "display_name": "3Dave", "link": "https://stackoverflow.com/users/135769/3dave"}, "edited": false, "score": 1, "creation_date": 1480537702, "post_id": 40897424, "comment_id": 69008828, "body": "For one thing, you need to escape your backslashes in the string literal, or flag the string as raw."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7135412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16c24e5fa44736846a0e5c4057b192fd?s=128&d=identicon&r=PG&f=1", "display_name": "koss", "link": "https://stackoverflow.com/users/7135412/koss"}, "edited": false, "score": 0, "creation_date": 1480598713, "post_id": 40897481, "comment_id": 69035738, "body": "thanks for the support, the problem is that now he reads all the lines after the &quot;check&quot;, would that crash occurs just find an empty line, I tried to insert:       if ((readingTargetSection) &amp;&amp; (line != &quot;\\&quot;&quot;))  but not work"}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1480599010, "post_id": 40897481, "comment_id": 69035959, "body": "Of course, <code>readingTargetSection</code> must be reset after every line which is <i>not</i> <code>check</code>. Like <code>readingTargetSection = (line == check)</code>."}, {"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1480619025, "post_id": 40897481, "comment_id": 69048995, "body": "You did say <i>//need here read all line after &quot;check&quot;</i> in the question. If you want to stop reading on a blank line, see my edit."}], "tags": [], "owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "is_accepted": false, "score": 2, "last_activity_date": 1480618969, "last_edit_date": 1480618969, "creation_date": 1480537391, "answer_id": 40897481, "question_id": 40897424, "link": "https://stackoverflow.com/questions/40897424/read-line-after-specific-line/40897481#40897481", "title": "Read Line after specific line", "body": "<p>You can use a boolean to keep track of whether you're in the right place:</p>\n\n<p>Here I'm assuming that a blank line indicates the end of the section.</p>\n\n<pre><code>bool readingTargetSection = false;\nforeach (string line in File.ReadLines(_path))  \n{\n    if (readingTargetSection)\n    {\n        if (line.Trim() == \"\") {\n            // or just break out of the loop\n            readingTargetSection = false;\n        }\n        else {\n            // read the line\n        }\n    }       \n    else if (line == check)\n    {\n        readingTargetSection = true;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 194, "user_id": 1422934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89dcdf6eb57142e25ce2320f484b9fbc?s=128&d=identicon&r=PG", "display_name": "Sindri J&#243;elsson", "link": "https://stackoverflow.com/users/1422934/sindri-j%c3%b3elsson"}, "is_accepted": false, "score": 1, "last_activity_date": 1480539601, "creation_date": 1480539601, "answer_id": 40898108, "question_id": 40897424, "link": "https://stackoverflow.com/questions/40897424/read-line-after-specific-line/40898108#40898108", "title": "Read Line after specific line", "body": "<p>LINQ can be used here.</p>\n\n<pre><code>private void btnReplace_Click(object sender, EventArgs e)\n{\n    // The '@' marks the string as a verbatim string.\n    string check = @\"[HKEY_CURRENT_USER\\SOFTWARE\\Thingamahoochie\\WinMerge\\Settings-Bar1]\";\n\n    var linesAfterCheck = File.ReadLines(_path)\n    .SkipWhile(l =&gt; l != check) // Skip until check\n    .Skip(1); // Skip line containing check\n\n    foreach (string line in linesAfterCheck)  \n    {\n        // Code\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7135412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16c24e5fa44736846a0e5c4057b192fd?s=128&d=identicon&r=PG&f=1", "display_name": "koss", "link": "https://stackoverflow.com/users/7135412/koss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 900, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1480618969, "creation_date": 1480537169, "last_edit_date": 1480598696, "question_id": 40897424, "link": "https://stackoverflow.com/questions/40897424/read-line-after-specific-line", "title": "Read Line after specific line", "body": "<p>I'm trying to do so that I can read all the lines that are present after the \"check\", I tried with StreamReader or clicli while and for, without being able to move to the next line, the same line is always read.</p>\n\n<p>below is an example .txt file extracted, in the file there are many registry keys.</p>\n\n<p>TXTFile</p>\n\n<pre><code>Windows Registry Editor Version 5.00\n\n\n//BEFORE MORE key\n\n[HKEY_CURRENT_USER\\SOFTWARE\\Thingamahoochie\\WinMerge\\Settings-Bar1]\n\"BarID\"=dword:00008033\n\"Visible\"=dword:00000000\n\"XPos\"=dword:fffffffe\n\"YPos\"=dword:fffffffe\n\"Docking\"=dword:00000001\n\"MRUDockID\"=dword:00000000\n\"MRUDockLeftPos\"=dword:00000000\n\"MRUDockTopPos\"=dword:00000000\n\"MRUDockRightPos\"=dword:0000070c\n\"MRUDockBottomPos\"=dword:000000f5\n\"MRUFloatStyle\"=dword:00002004\n\"MRUFloatXPos\"=dword:80000000\n\"MRUFloatYPos\"=dword:00000000\n\n//MORE KEY AFTER\n</code></pre>\n\n<p>code</p>\n\n<pre><code>private void btnReplace_Click(object sender, EventArgs e)\n{\n     string check = \"[HKEY_CURRENT_USER\\SOFTWARE\\Thingamahoochie\\WinMerge\\Settings-Bar1]\";\n\n     foreach (string line in File.ReadLines(_path))\n     {\n         if(line == check)\n         {\n            //need here read all line after \"check\"\n\n         }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "android"], "comments": [{"owner": {"reputation": 824, "user_id": 1010034, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Hl1et.jpg?s=128&g=1", "display_name": "pulekies", "link": "https://stackoverflow.com/users/1010034/pulekies"}, "edited": false, "score": 0, "creation_date": 1480539514, "post_id": 40897412, "comment_id": 69009869, "body": "Is this using xamarin? If so maybe update the question and tags to reflect that."}], "answers": [{"tags": [], "owner": {"reputation": 824, "user_id": 1010034, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Hl1et.jpg?s=128&g=1", "display_name": "pulekies", "link": "https://stackoverflow.com/users/1010034/pulekies"}, "is_accepted": false, "score": 0, "last_activity_date": 1480539243, "creation_date": 1480539243, "answer_id": 40898011, "question_id": 40897412, "link": "https://stackoverflow.com/questions/40897412/c-draw-doesnt-make-drawing/40898011#40898011", "title": "C# Draw doesn&#39;t make drawing", "body": "<p>You never initialized <code>punt</code>, so it is throwing an exception when it first tries to access it in <code>tekenoog</code>.</p>\n\n<p>I tried this on my machine and it worked after I modified the <code>punt</code> declaration to:</p>\n\n<pre><code>private PointF punt = new PointF();\n</code></pre>\n\n<p>Hope this helps!</p>\n\n<p><a href=\"https://i.stack.imgur.com/oaUOh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oaUOh.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 7196512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/982f0f4295429947c7a68d684e7bb147?s=128&d=identicon&r=PG&f=1", "display_name": "F.W.", "link": "https://stackoverflow.com/users/7196512/f-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1480539243, "creation_date": 1480537127, "last_edit_date": 1480537420, "question_id": 40897412, "link": "https://stackoverflow.com/questions/40897412/c-draw-doesnt-make-drawing", "title": "C# Draw doesn&#39;t make drawing", "body": "<p>I'm trying to make an app with eyes that follows your finger.\nHowever, when I load my app, the drawing doesn't appear.\nIt loads the purple background just fine, but seems to stop there.\nCan anyone tell me why this is happening?</p>\n\n<pre><code>using Android.App;\nusing Android.Widget;\nusing Android.OS;\nusing Android.Graphics;\nusing Android.Views;\nusing Android.Content;\nusing Android.Content.PM;\nusing System;\n\n\nnamespace BewegendeOgen\n{\n[Activity(Label = \"BewegendeOgen\", MainLauncher = true, Icon = \"@drawable/icon\", ScreenOrientation = ScreenOrientation.Landscape)]\npublic class MainActivity : Activity\n{\n    OgenView ogen;\n\n\n    protected override void OnCreate(Bundle bundle)\n    {\n        base.OnCreate(bundle);\n        ogen = new OgenView(this);\n\n\n        this.SetContentView(ogen);\n    }\n}\n\npublic class OgenView : View\n\n{\n    public OgenView(Context c) : base(c)\n    { this.Touch += RaakAan;\n      this.SetBackgroundColor(Color.Purple);\n\n    }\n\n    PointF punt;\n    public void RaakAan(object o, TouchEventArgs tea)\n    {\n     float xas = tea.Event.GetX();\n     float yas = tea.Event.GetY();\n        this.punt = new PointF(xas, yas);\n        this.Invalidate();\n\n        this.Invalidate();\n    }\n\n\nprotected override void OnDraw(Canvas canvas)\n    {\n        base.OnDraw(canvas);\n\n        this.tekenoog(canvas, 200);\n        this.tekenoog(canvas, -200);\n\n\n    }\n\n    public void tekenoog(Canvas canvas, int a)\n    {    //this is the drawing\n        base.OnDraw(canvas);\n        float radius, x1, x2, y;\n        radius = 200;\n        x1 = this.Width / 3;\n        y = this.Height / 2;\n        x2 = x1 * 2;\n\n        Paint verf;\n        verf = new Paint();\n\n        verf.Color = Color.White;\n        canvas.DrawCircle(x1 + a, y, radius, verf);\n\n\n        float dx, g, e, f, d, ex, ey, radiusiris, irisx1, irisy1;\n        dx = punt.X - x1;\n        g = punt.Y - y;\n        radiusiris = 20;\n        e = radius - radiusiris;\n        f = (float)Math.Sqrt(dx * dx + g * g);\n        d = f - e;\n        ex = dx * e / d;\n        ey = (float)Math.Sqrt(e * e - ex * ex);\n        irisx1 = x1 + ex;\n        irisy1 = y - ey;\n\n        verf.Color = Color.CornflowerBlue;\n        canvas.DrawCircle(irisx1, irisy1, radiusiris, verf);\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["c#", "generics"], "comments": [{"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1480537445, "post_id": 40897370, "comment_id": 69008692, "body": "if you want to pass <code>Type</code> simply use <code>KeyValuePair&lt;Type, string&gt;</code>. why method has to be generic?"}, {"owner": {"reputation": 1165, "user_id": 6923568, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89172520aaa3d342c5c7ffe7176ec29d?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/6923568/mat"}, "edited": false, "score": 0, "creation_date": 1480537780, "post_id": 40897370, "comment_id": 69008874, "body": "What I understand is you want <code>T</code> in <code>CreateNew&lt;T&gt;</code> to implement <code>IMessage</code>. If that&#39;s right, you could just use change all generics to <code>IMessage</code>: <code>public class Client&lt;IMessage&gt; : IClient</code> and <code>public IClient CreateNew&lt;IMessage&gt;(KeyValuePair&lt;IMessage, string&gt; urlInfo)</code>"}, {"owner": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1480537821, "post_id": 40897370, "comment_id": 69008904, "body": "let me ask in another way. What <code>Type</code> and <code>IMessage</code> have in common?"}, {"owner": {"reputation": 4393, "user_id": 3691973, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/iytIc.jpg?s=128&g=1", "display_name": "Necoras", "link": "https://stackoverflow.com/users/3691973/necoras"}, "reply_to_user": {"reputation": 1165, "user_id": 6923568, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89172520aaa3d342c5c7ffe7176ec29d?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/6923568/mat"}, "edited": false, "score": 0, "creation_date": 1480537945, "post_id": 40897370, "comment_id": 69008994, "body": "@Mat I tried that initially, but then my factory method must accept an instance of IMessage, not the Type IMessage. I don&#39;t have an IMessage to provide it, and creating an empty one just to pull the Type back out seems wrong, assuming that it works."}, {"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1480538049, "post_id": 40897370, "comment_id": 69009043, "body": "Unless T is derived from <code>List&lt;IMessage&gt;</code> that cast is not going to work."}, {"owner": {"reputation": 4393, "user_id": 3691973, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/iytIc.jpg?s=128&g=1", "display_name": "Necoras", "link": "https://stackoverflow.com/users/3691973/necoras"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1480538139, "post_id": 40897370, "comment_id": 69009094, "body": "@M.kazem Akhgary Hrm. I&#39;ll try architecting it that way. I&#39;ll report back. Thanks for the possible new angle."}, {"owner": {"reputation": 4393, "user_id": 3691973, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/iytIc.jpg?s=128&g=1", "display_name": "Necoras", "link": "https://stackoverflow.com/users/3691973/necoras"}, "reply_to_user": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1480538239, "post_id": 40897370, "comment_id": 69009143, "body": "@Nkosi Yes, I&#39;m aware of that. Such is the risk with reflection. I&#39;ll just have to handle those errors cleanly. I should have complete control over what kinds of Messages I&#39;m polling for though, so it shouldn&#39;t be a problem."}, {"owner": {"reputation": 1165, "user_id": 6923568, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89172520aaa3d342c5c7ffe7176ec29d?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/6923568/mat"}, "edited": false, "score": 0, "creation_date": 1480538817, "post_id": 40897370, "comment_id": 69009474, "body": "@Necoras what would <code>Type</code> be in <code>KeyValuePair&lt;Type, string&gt;</code>, in a concrete example ?"}, {"owner": {"reputation": 4393, "user_id": 3691973, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/iytIc.jpg?s=128&g=1", "display_name": "Necoras", "link": "https://stackoverflow.com/users/3691973/necoras"}, "reply_to_user": {"reputation": 1165, "user_id": 6923568, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89172520aaa3d342c5c7ffe7176ec29d?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/6923568/mat"}, "edited": false, "score": 0, "creation_date": 1480539090, "post_id": 40897370, "comment_id": 69009618, "body": "@Mat Something like an EmailMessage. The External Client in question is currently only used for Amazon SQS queues, though it could conceivably hook up to any Queuing system. Those messages would then be converted by GetNextMessage() into internal IMessages (ex: EmailMessage) for processing a Message Handler which takes a specific type of IMessage (ex: EmailMessageHandler)."}, {"owner": {"reputation": 4393, "user_id": 3691973, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/iytIc.jpg?s=128&g=1", "display_name": "Necoras", "link": "https://stackoverflow.com/users/3691973/necoras"}, "reply_to_user": {"reputation": 16598, "user_id": 4767498, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-u6daZXYwzxs/AAAAAAAAAAI/AAAAAAAAABI/0xXoH0XUtkc/photo.jpg?sz=128", "display_name": "M.kazem Akhgary", "link": "https://stackoverflow.com/users/4767498/m-kazem-akhgary"}, "edited": false, "score": 0, "creation_date": 1480539921, "post_id": 40897370, "comment_id": 69010088, "body": "@M.kazem Akhgary Your suggestion does seem to work. At the very least, it compiles and doesn&#39;t break my unit tests which weren&#39;t testing the factory. I still need to write the factory tests, so there&#39;s still some verification to be done there. I&#39;m glad to have a functional solution, but it definitely feels less elegant to pass in the parameter via a KVP rather than making the Client Generic. Thanks for the suggestion; if you write it up as an answer I&#39;ll mark it as such once I&#39;ve got the requisite unit tests passing."}, {"owner": {"reputation": 1165, "user_id": 6923568, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89172520aaa3d342c5c7ffe7176ec29d?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/6923568/mat"}, "edited": false, "score": 0, "creation_date": 1480540169, "post_id": 40897370, "comment_id": 69010219, "body": "@Necoras That logic just won&#39;t work; you can&#39;t expect <code>Type</code> to be a subclass of <code>IMessage</code>. I still believe that changing every generics to <code>IMessage</code> is a solution, even if it&#39;s not pretty. The reason is that you could be passing Any <code>Type</code> in your <code>KeyValuePair</code>, and like I said in my first sentence, at compile time the program can&#39;t tell if it&#39;s Really an <code>IMessage</code>. Sadly, I think you&#39;ll have to redesign that factory method."}, {"owner": {"reputation": 1165, "user_id": 6923568, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/89172520aaa3d342c5c7ffe7176ec29d?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/6923568/mat"}, "edited": false, "score": 0, "creation_date": 1480540456, "post_id": 40897370, "comment_id": 69010372, "body": "Or like M.kazem Akhgary said, remove generics altogether from it. Depends on how you want to call the method."}], "owner": {"reputation": 4393, "user_id": 3691973, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/iytIc.jpg?s=128&g=1", "display_name": "Necoras", "link": "https://stackoverflow.com/users/3691973/necoras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480536976, "creation_date": 1480536976, "question_id": 40897370, "link": "https://stackoverflow.com/questions/40897370/how-do-i-create-a-generic-factory-which-receives-a-type", "title": "How do I create a generic Factory which receives a Type?", "body": "<p>I'm trying to create a factory method (sort of; It actually polls a remote service) which takes in a generic of type <code>T</code> which is an interface of type <code>IMessage</code> and returns a <code>List&lt;IMessage&gt;</code>. So the code would look something like:</p>\n\n<pre><code>public class Client&lt;T&gt; : IClient where T: Type, IMessage\n{\n\n  public Client(IExternalClient client, string url)\n  {\n    this.client = client;\n    this.queueUrl = queueUrl;\n  }\n\n  public List&lt;IMessage&gt; GetNextMessage()\n  {\n    var message = new Message();\n    return (T)Activator.CreateInstance(typeof(T), message);\n  }\n}\n</code></pre>\n\n<p>Unfortunately, when I run into problems when I try to create a new client:</p>\n\n<pre><code>var Foo = new Client&lt;BarMessage&gt;(new ExternalClient(), url);\n</code></pre>\n\n<p>gives me the error </p>\n\n<blockquote>\n  <p>The type BarMessage cannot be used as type parameter 'T' in the\n  generic type or method 'Client'. There is no implicit reference\n  conversion from 'BarMessage' to 'System.Type'</p>\n</blockquote>\n\n<p>If I modify my class declaration to:</p>\n\n<pre><code>public class Client&lt;T&gt; : IClient where T: IMessage\n</code></pre>\n\n<p>Then a direct call to the constructor compiles. However, then my factory method breaks down as I am passing in the <code>IMessage</code> Type rather than an instance of <code>IMessage</code>.</p>\n\n<pre><code>public class ClientFactory : Dictionary&lt;string, Func&lt;IClient&gt;&gt;, IClientFactory\n{\n    public IClient CreateNew&lt;T&gt;(KeyValuePair&lt;T, string&gt; urlInfo) where T : IMessage\n    {\n        return new Client&lt;T&gt;(new ExternalClient(), urlInfo.Value);\n    }\n}\n</code></pre>\n\n<p>When I call my factory method:</p>\n\n<pre><code>clientFactory.CreateNew(urlInfo)\n</code></pre>\n\n<p>where urlInfo is a <code>KeyValuePair&lt;Type,string&gt;</code> containing a Type and a URL (the two pieces of information necessary, in addition to the External Client to create my Client) I get the compile time error</p>\n\n<blockquote>\n  <p>The type 'System.Type' cannot be used as parameter 'T' in the generic type or method \n  IClientFactory.CreateNew)'. There is no implicit reference\n  conversion from 'System.Type' to 'IMessage'.</p>\n</blockquote>\n\n<p>I have a feeling I'm bumping up against a covariance problem, but if so I don't know enough to diagnose it. Is what I'm trying to do possible in C# (and I just have a syntax or design problem), or am I trying to do something the language doesn't support?</p>\n"}, {"tags": ["c#", "wpf", "recursion", "hierarchical-trees"], "comments": [{"owner": {"reputation": 243, "user_id": 1791571, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a77310753060c2c36633398744fec05d?s=128&d=identicon&r=PG", "display_name": "rune711", "link": "https://stackoverflow.com/users/1791571/rune711"}, "edited": false, "score": 0, "creation_date": 1480537133, "post_id": 40897269, "comment_id": 69008542, "body": "I&#39;m confused by &quot;when navigate to the next record keeps tree structure from the previous record, i want to clear Tree-view when i navigate to another record.&quot;  Are you saying that you want the user to expand a node and this refreshes the whole tree?  If this is the case then that would likely be very confusing to the end user."}, {"owner": {"reputation": 49, "user_id": 7204052, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b79016a386b9054a8de1ee405cc0e971?s=128&d=identicon&r=PG&f=1", "display_name": "afri", "link": "https://stackoverflow.com/users/7204052/afri"}, "reply_to_user": {"reputation": 243, "user_id": 1791571, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a77310753060c2c36633398744fec05d?s=128&d=identicon&r=PG", "display_name": "rune711", "link": "https://stackoverflow.com/users/1791571/rune711"}, "edited": false, "score": 0, "creation_date": 1480537584, "post_id": 40897269, "comment_id": 69008769, "body": "@rune711  let say i have two record <code>500100</code> and <code>500101</code>. while i am on <code>500100</code> i clicked <code>button4</code> and that will show me the <code>partId</code> value of this record in <code>Treeview1</code>  and i clicked <code>Next</code> button to navigate to the next record and lets say the next record is  <code>500101</code> when i click <code>button4</code> again that give me both treevalue of 500100`` and <code>500101</code>. does that make sense?"}, {"owner": {"reputation": 49, "user_id": 7204052, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b79016a386b9054a8de1ee405cc0e971?s=128&d=identicon&r=PG&f=1", "display_name": "afri", "link": "https://stackoverflow.com/users/7204052/afri"}, "reply_to_user": {"reputation": 243, "user_id": 1791571, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a77310753060c2c36633398744fec05d?s=128&d=identicon&r=PG", "display_name": "rune711", "link": "https://stackoverflow.com/users/1791571/rune711"}, "edited": false, "score": 0, "creation_date": 1480537878, "post_id": 40897269, "comment_id": 69008949, "body": "@rune711 i added image of the treeView at the bottom of my question. that might help"}], "owner": {"reputation": 49, "user_id": 7204052, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b79016a386b9054a8de1ee405cc0e971?s=128&d=identicon&r=PG&f=1", "display_name": "afri", "link": "https://stackoverflow.com/users/7204052/afri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 555, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480537846, "creation_date": 1480536608, "last_edit_date": 1480537846, "question_id": 40897269, "link": "https://stackoverflow.com/questions/40897269/how-can-i-create-hierarchical-tree-structure-using-recursive-data-from-the-datab", "title": "How can i create hierarchical Tree Structure using recursive data from the database", "body": "<p>I want to populate hierarchical Tree Structure using recursive data from the database using button_click event</p>\n\n<p>I have the following record in the table. </p>\n\n<pre><code>bomItem          partId\n500101            100200\n500101            500100\n500101            100280\n500100            320255\n\nI want to show Tree as shown below\n   500101\n     +----100200\n     +----500100\n           +----300255\n     +----100280\n</code></pre>\n\n<p>// Note: <code>bomItem</code> is the parent and <code>partId</code> is the child fields</p>\n\n<p>The problem i am having:</p>\n\n<ol>\n<li><p>when navigate to the next record keeps tree structure from the previous record, i want to clear Tree-view when i navigate to another record.</p></li>\n<li><p>To show the full tree structure i have to populate the child's first</p></li>\n</ol>\n\n<p>Here is the code i used</p>\n\n<p>//button click event</p>\n\n<pre><code>private void button4_Click(object sender, EventArgs e)\n        {\n\n            _command = new SqlCommand(\"SELECT * FROM [BOMDETAIL] where bomItem= '\" + int.Parse(bomItemTextBox.Text) + \"' and bomRev= '\" + bomRevComboBox.Text + \"'\", _connection);\n            _adapter = new SqlDataAdapter(_command);\n            _adapter.Fill(objdataset);\n            _connection.Close(); \n\n            try\n            {\n                TreeNode node = new TreeNode(bomItemTextBox.Text);\n\n                filltree(node, int.Parse(bomItemTextBox.Text), objdataset);\n\n                treeView2.Nodes.Add(node);\n\n                //dataGridView1.DataSource = objdataset.Tables[0];\n            }\n            catch (Exception c)\n            {\n\n                MessageBox.Show(c.ToString());\n            }\n        }\n</code></pre>\n\n<p>//filetree()</p>\n\n<pre><code> private void filltree(TreeNode parentnode, int parentid, DataSet dataset)\n\n        {\n\n            // Fill Tree Function to poplulate treeeview control\n\n            String str = null;\n            try\n            {\n\n\n                foreach (DataRow row in dataset.Tables[0].Rows)\n                {\n                    if (Convert.ToInt32(row[\"bomItem\"]) == parentid)\n                    {\n                        str = row[\"partId\"].ToString();\n                        TreeNode new_parent_node = parentnode.Nodes.Add(str);\n                        int parent_id = Convert.ToInt32(row[\"partId\"]);\n                        filltree(new_parent_node, parent_id, dataset);\n                    }\n\n                }\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.ToString());\n            }\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/hnduT.png\" rel=\"nofollow noreferrer\">Image describing problem No 1</a></p>\n"}, {"tags": ["c#", "database", "entity-framework"], "comments": [{"owner": {"reputation": 1803, "user_id": 4138626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1e2b3bd90af8405c5f090855527f4675?s=128&d=identicon&r=PG&f=1", "display_name": "RizJa", "link": "https://stackoverflow.com/users/4138626/rizja"}, "edited": false, "score": 0, "creation_date": 1480536802, "post_id": 40897251, "comment_id": 69008373, "body": "You&#39;ll need to set up the junction table yourself (StaffSchedules) and run a 1:M relation to that table from both Staff and Schedules. You can configure the mappings using fluent API in your context file."}], "answers": [{"comments": [{"owner": {"reputation": 1494, "user_id": 5696931, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BzW0r.jpg?s=128&g=1", "display_name": "Rasmus Rajje Josefsson", "link": "https://stackoverflow.com/users/5696931/rasmus-rajje-josefsson"}, "edited": false, "score": 0, "creation_date": 1480540344, "post_id": 40897538, "comment_id": 69010313, "body": "This creates Staff,  StaffSchedule and Schedules. What am I doing wrong now?"}, {"owner": {"reputation": 1494, "user_id": 5696931, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BzW0r.jpg?s=128&g=1", "display_name": "Rasmus Rajje Josefsson", "link": "https://stackoverflow.com/users/5696931/rasmus-rajje-josefsson"}, "edited": false, "score": 0, "creation_date": 1480543620, "post_id": 40897538, "comment_id": 69011985, "body": "Posted a picture of what i mean, don&#39;t know if i&#39;m thinking wrong now but"}, {"owner": {"reputation": 1803, "user_id": 4138626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1e2b3bd90af8405c5f090855527f4675?s=128&d=identicon&r=PG&f=1", "display_name": "RizJa", "link": "https://stackoverflow.com/users/4138626/rizja"}, "reply_to_user": {"reputation": 1494, "user_id": 5696931, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BzW0r.jpg?s=128&g=1", "display_name": "Rasmus Rajje Josefsson", "link": "https://stackoverflow.com/users/5696931/rasmus-rajje-josefsson"}, "edited": false, "score": 0, "creation_date": 1480563821, "post_id": 40897538, "comment_id": 69017918, "body": "Updated the answer. Hope that helps."}, {"owner": {"reputation": 1803, "user_id": 4138626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1e2b3bd90af8405c5f090855527f4675?s=128&d=identicon&r=PG&f=1", "display_name": "RizJa", "link": "https://stackoverflow.com/users/4138626/rizja"}, "reply_to_user": {"reputation": 1494, "user_id": 5696931, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BzW0r.jpg?s=128&g=1", "display_name": "Rasmus Rajje Josefsson", "link": "https://stackoverflow.com/users/5696931/rasmus-rajje-josefsson"}, "edited": false, "score": 0, "creation_date": 1480601029, "post_id": 40897538, "comment_id": 69037352, "body": "Did this work for you? If so, mark it as the answer, thanks."}], "tags": [], "owner": {"reputation": 1803, "user_id": 4138626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1e2b3bd90af8405c5f090855527f4675?s=128&d=identicon&r=PG&f=1", "display_name": "RizJa", "link": "https://stackoverflow.com/users/4138626/rizja"}, "is_accepted": true, "score": 2, "last_activity_date": 1480625179, "last_edit_date": 1480625179, "creation_date": 1480537563, "answer_id": 40897538, "question_id": 40897251, "link": "https://stackoverflow.com/questions/40897251/many-to-many-with-addition-fields-entity-framework/40897538#40897538", "title": "Many to many with addition fields, Entity Framework", "body": "<p>Add a class like so:</p>\n\n<pre><code>public class StaffSchedule\n{\n    public int StaffId { get; set; }\n    public int ScheduleId { get; set; }\n    public virtual Staff Staff { get; set; }\n    public virtual Schedule Schedule { get; set; }\n\n    public DateTime Date { get; set; }\n}\n</code></pre>\n\n<p>Modify your Staff and Schedule classes:</p>\n\n<pre><code>public class Schedule\n{\n    public int Id { get; set; }\n    //Other Fields\n    public ICollection&lt;StaffSchedule&gt; StaffSchedules { get; set; }\n}\n\npublic class Staff\n{\n    public int Id { get; set; }\n    //Other Fields\n    public ICollection&lt;StaffSchedule&gt; StaffSchedules { get; set; }\n}\n</code></pre>\n\n<p>And lastly, in your context file (OnModelCreating method):</p>\n\n<pre><code>modelBuilder.Entity&lt;Staff&gt;().HasKey(x =&gt; x.Id);\nmodelBuilder.Entity&lt;Schedule&gt;().HasKey(x =&gt; x.Id);\n\nmodelBuilder.Entity&lt;StaffSchedule&gt;().HasKey(x =&gt;\n    new\n    {\n        x.StaffId,\n        x.ScheduleId\n    });\n\nmodelBuilder.Entity&lt;StaffSchedule&gt;()\n    .HasRequired(x =&gt; x.Staff)\n    .WithMany(x =&gt; x.StaffSchedules)\n    .HasForeignKey(x =&gt; x.StaffId);\n\nmodelBuilder.Entity&lt;StaffSchedule&gt;()\n    .HasRequired(x =&gt; x.Schedule)\n    .WithMany(x =&gt; x.StaffSchedules)\n    .HasForeignKey(x =&gt; x.ScheduleId);\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Looks like you actually wanted this:</p>\n\n<pre><code>public class Patient\n{\n    public int Id { get; set; }\n    public string Name { get; set; }\n}\n\npublic class Staff\n{\n    public int Id { get; set; }\n    public string Name { get; set; }\n}\n\npublic class Schedule\n{\n    public int Id { get; set; }\n    public DateTime Date { get; set; }\n\n    public int PatientId { get; set; }\n    public int StaffId { get; set; }\n\n    [ForeignKey(\"PatientId\")]\n    public virtual Patient Patient { get; set; }\n    [ForeignKey(\"StaffId\")]\n    public virtual Staff Staff { get; set; }\n}\n</code></pre>\n"}], "owner": {"reputation": 1494, "user_id": 5696931, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BzW0r.jpg?s=128&g=1", "display_name": "Rasmus Rajje Josefsson", "link": "https://stackoverflow.com/users/5696931/rasmus-rajje-josefsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 40897538, "answer_count": 1, "score": 0, "last_activity_date": 1480625179, "creation_date": 1480536552, "last_edit_date": 1480542951, "question_id": 40897251, "link": "https://stackoverflow.com/questions/40897251/many-to-many-with-addition-fields-entity-framework", "title": "Many to many with addition fields, Entity Framework", "body": "<p>How could I map a custom many to many relationship with addition fields? In this case DateTime in Schedule. </p>\n\n<p><strong>Problem now is it creates a new table named StaffSchedules</strong>  </p>\n\n<pre><code>public class Schedule\n{\n    public int Id { get; set; }\n    public DateTime DateTime { get; set; }\n\n    public List&lt;Staff&gt; Staff { get; set; }\n    public int StaffId { get; set; }\n\n    public Patient Patient { get; set; }\n    public int PatientId { get; set; }\n}\n\npublic class Staff\n{\n    public int Id { get; set; }\n    public string FirstName { get; set; }\n\n    public List&lt;Schedule&gt; Schedules { get; set; }\n}\n</code></pre>\n\n<p>... </p>\n\n<pre><code>public DbSet&lt;Schedule&gt; Schedules { get; set; }\npublic DbSet&lt;Staff&gt; Staff { get; set; }\n</code></pre>\n\n<p><strong>Desired outcome:</strong>\n<a href=\"https://i.stack.imgur.com/8Qlzj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8Qlzj.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "twitter-bootstrap", "twitter", "twitterizer"], "owner": {"reputation": 3905, "user_id": 3784238, "user_type": "registered", "accept_rate": 26, "profile_image": "https://lh3.googleusercontent.com/-5TiQ_Wr94Kg/AAAAAAAAAAI/AAAAAAAAAUg/N0Pp2l_1mdM/photo.jpg?sz=128", "display_name": "Erica Stockwell-Alpert", "link": "https://stackoverflow.com/users/3784238/erica-stockwell-alpert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480536551, "creation_date": 1480536405, "last_edit_date": 1480536551, "question_id": 40897212, "link": "https://stackoverflow.com/questions/40897212/twitterizer-twitter-search-not-returning-all-the-tweets-it-should", "title": "Twitterizer twitter search not returning all the tweets it should", "body": "<p>I'm have a twitter component on my site which uses a service to retrieve tweets. It allows for filtering by hashtags. However, it's not retrieving all the tweets that it should. </p>\n\n<pre><code>SearchOptions searchOptions = new SearchOptions { NumberPerPage = pageSize };\n\nOAuthTokens tokens = new OAuthTokens()\n{\n    AccessToken = \"xxx\",\n    AccessTokenSecret = \"xxx\",\n    ConsumerKey = \"xxx\",\n    ConsumerSecret = \"xxx\"\n};\n\nTwitterResponse&lt;TwitterSearchResultCollection&gt; twitterResponse = Twitterizer.TwitterSearch.Search(tokens, twitterQuery, searchOptions);\n</code></pre>\n\n<p>The <code>twitterQuery</code> I'm using is \"from:myTwitterAccount #exampleHashtag\". It's getting one result. However, if I go to twitter and paste that query into the search bar, there is a long list of results. </p>\n\n<p>Is there a problem with Twitterizer? The only option that I have set is NumberPerPage, and that's set to 3, and other hashtags return more than 1 result. Why would some tweets show up in the twitter search but on get retrieved by my code?</p>\n"}, {"tags": ["c#", "sql-server", "combobox"], "comments": [{"owner": {"reputation": 2298, "user_id": 6709604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0e089029eb5143d6a404f975e275d6?s=128&d=identicon&r=PG&f=1", "display_name": "SS_DBA", "link": "https://stackoverflow.com/users/6709604/ss-dba"}, "edited": false, "score": 0, "creation_date": 1480536117, "post_id": 40897095, "comment_id": 69008033, "body": "Is there a <code>Unique Constraint</code> on the <code>Teacher</code> table for that column?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6874839"}, "reply_to_user": {"reputation": 2298, "user_id": 6709604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0e089029eb5143d6a404f975e275d6?s=128&d=identicon&r=PG&f=1", "display_name": "SS_DBA", "link": "https://stackoverflow.com/users/6709604/ss-dba"}, "edited": false, "score": 0, "creation_date": 1480536169, "post_id": 40897095, "comment_id": 69008052, "body": "No i haven&#39;t added any such kind of option for that table. I created that table using ERD and not from query."}, {"owner": {"reputation": 2298, "user_id": 6709604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0e089029eb5143d6a404f975e275d6?s=128&d=identicon&r=PG&f=1", "display_name": "SS_DBA", "link": "https://stackoverflow.com/users/6709604/ss-dba"}, "edited": false, "score": 0, "creation_date": 1480536288, "post_id": 40897095, "comment_id": 69008109, "body": "Why are you putting all of your metroComboBox1 values into the 3 different ID fields. I thought you had 3 different combo boxes?"}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1480536329, "post_id": 40897095, "comment_id": 69008134, "body": "Why are you creating a DataTable then ignoring it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6874839"}, "edited": false, "score": 0, "creation_date": 1480536425, "post_id": 40897095, "comment_id": 69008187, "body": "First combobox is bound with Department table. Second Combo box is bound with Course table and 3rd with Semester table. And i have made a foreign key with teacher table and then i am inserting record for teacher."}, {"owner": {"reputation": 2298, "user_id": 6709604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0e089029eb5143d6a404f975e275d6?s=128&d=identicon&r=PG&f=1", "display_name": "SS_DBA", "link": "https://stackoverflow.com/users/6709604/ss-dba"}, "edited": false, "score": 1, "creation_date": 1480536474, "post_id": 40897095, "comment_id": 69008206, "body": "But your code says different. All of them have <code>metroComboBox1</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6874839"}, "edited": false, "score": 0, "creation_date": 1480536483, "post_id": 40897095, "comment_id": 69008212, "body": "Forget Datatable it&#39;s of no use here. I will just remove it from code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6874839"}, "edited": false, "score": 0, "creation_date": 1480536596, "post_id": 40897095, "comment_id": 69008273, "body": "The constrainst error is still there. I just didn&#39;t update it sorry for that. Now i have edited it."}, {"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 1, "creation_date": 1480536664, "post_id": 40897095, "comment_id": 69008303, "body": "Well, the error is telling you, you do have a constraint on that table."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6874839"}, "edited": false, "score": 0, "creation_date": 1480536734, "post_id": 40897095, "comment_id": 69008339, "body": "How can i remove that constraint? I am a beginner so please tell me."}], "owner": {"user_type": "does_not_exist", "display_name": "user6874839"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480536543, "creation_date": 1480535972, "last_edit_date": 1480536543, "question_id": 40897095, "link": "https://stackoverflow.com/questions/40897095/bounded-combobox-consraint-value-error-when-inserting", "title": "Bounded Combobox consraint value error when inserting", "body": "<p>I have binded 3 comboboxes separately to 3 different tables. Whenever i select value for metroComboBox2, it gives me this error  \"Column 'Cor_ID' is constrained to be unique.  Value '103' is already present.\" I don't why this error is coming. What is the cause for this error?</p>\n\n<pre><code>con = new SqlConnection(constr);\n        con.Open();\n        DataTable dt = new DataTable();\n        String query = \"Insert into Teacher (ID,Name,FName,Age,Qualification,Dep_ID,Cor_ID,Sem_ID,Password) VALUES(@ID,@Name,@FName,@Age,@Qualification,@Dep_ID,@Cor_ID,@Sem_ID,@Password)\";\n\n        cmd = new SqlCommand(query, con);\n\n\n        cmd.Parameters.AddWithValue(\"@ID\", metroTextBox1.Text);\n        cmd.Parameters.AddWithValue(\"@Name\", metroTextBox2.Text);\n        cmd.Parameters.AddWithValue(\"@FName\", metroTextBox3.Text);\n        cmd.Parameters.AddWithValue(\"@Age\", metroTextBox4.Text);\n        cmd.Parameters.AddWithValue(\"@Qualification\", metroTextBox5.Text);\n        cmd.Parameters.AddWithValue(\"@Dep_ID\", metroComboBox1.GetItemText(metroComboBox1.SelectedItem));\n        cmd.Parameters.AddWithValue(\"@Cor_ID\", metroComboBox2.GetItemText(metroComboBox2.SelectedItem));\n        cmd.Parameters.AddWithValue(\"@Sem_ID\", metroComboBox3.GetItemText(metroComboBox3.SelectedItem));\n        cmd.Parameters.AddWithValue(\"@Password\", metroTextBox7.Text);\n\n        cmd.ExecuteNonQuery();\n        con.Close();\n        MessageBox.Show(\"Record Inserted\");\n}\n</code></pre>\n"}, {"tags": ["c#", "sql-server", "type-conversion", "decimal"], "comments": [{"owner": {"reputation": 94, "user_id": 7200776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aJfkq.png?s=128&g=1", "display_name": "Donnie", "link": "https://stackoverflow.com/users/7200776/donnie"}, "edited": false, "score": 1, "creation_date": 1480537861, "post_id": 40897057, "comment_id": 69008938, "body": "You can use the <code>SqlDecimal</code> constructor with the decimal type directly. Like this  <code>SqlDecimal sqlDecimal = new SqlDecimal(d);</code>."}, {"owner": {"reputation": 1918, "user_id": 854899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a3d9ab05641d0ee52000e0535cc4b51?s=128&d=identicon&r=PG", "display_name": "Noah", "link": "https://stackoverflow.com/users/854899/noah"}, "reply_to_user": {"reputation": 94, "user_id": 7200776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aJfkq.png?s=128&g=1", "display_name": "Donnie", "link": "https://stackoverflow.com/users/7200776/donnie"}, "edited": false, "score": 0, "creation_date": 1480537914, "post_id": 40897057, "comment_id": 69008977, "body": "I can, but then it doesn&#39;t validate the trailing zero problem I mentioned, below in a comment. This throws an error and will work: SqlDecimal.ConvertToPrecScale(new SqlDecimal(value), precision, scale);"}], "answers": [{"comments": [{"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 0, "creation_date": 1480536758, "post_id": 40897209, "comment_id": 69008355, "body": "<code>Decimal.GetBits</code> returns an <code>int[]</code>, not an <code>Int32</code>"}, {"owner": {"reputation": 1918, "user_id": 854899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a3d9ab05641d0ee52000e0535cc4b51?s=128&d=identicon&r=PG", "display_name": "Noah", "link": "https://stackoverflow.com/users/854899/noah"}, "edited": false, "score": 0, "creation_date": 1480537447, "post_id": 40897209, "comment_id": 69008693, "body": "Worth a shot, breaking that out into its own line still resulted in an exception being thrown from the SqlDecimal constructor."}], "tags": [], "owner": {"reputation": 11, "user_id": 6462258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43502195dcd6fce7fe13a09416a7dd3c?s=128&d=identicon&r=PG&f=1", "display_name": "Andy McLaughlin", "link": "https://stackoverflow.com/users/6462258/andy-mclaughlin"}, "is_accepted": false, "score": 0, "last_activity_date": 1480536395, "creation_date": 1480536395, "answer_id": 40897209, "question_id": 40897057, "link": "https://stackoverflow.com/questions/40897057/testing-differences-between-sqldecimal-and-c-decimal/40897209#40897209", "title": "Testing differences between SqlDecimal and C# Decimal", "body": "<p>My guess is that <code>Decimal.GetBits(d)</code> is overflowing the Int32 return type.\nTry doing just <code>Int32 bits = Decimal.GetBits(d)</code> and see if it throws the same error.</p>\n"}, {"comments": [{"owner": {"reputation": 1918, "user_id": 854899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a3d9ab05641d0ee52000e0535cc4b51?s=128&d=identicon&r=PG", "display_name": "Noah", "link": "https://stackoverflow.com/users/854899/noah"}, "edited": false, "score": 0, "creation_date": 1480537681, "post_id": 40897221, "comment_id": 69008813, "body": "SqlDecimal&#39;s constructor takes in an int array, not a byte array, but this likely is the reason. The problem with just passing a decmial in is that the trailing zeros on the decimal c# decimal are flexible, where as in sql server they are always padded, leading to overflow issues on the output."}, {"owner": {"reputation": 1918, "user_id": 854899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a3d9ab05641d0ee52000e0535cc4b51?s=128&d=identicon&r=PG", "display_name": "Noah", "link": "https://stackoverflow.com/users/854899/noah"}, "edited": false, "score": 0, "creation_date": 1480537866, "post_id": 40897221, "comment_id": 69008942, "body": "Ah, ok, so not messing with the bits myself does work, I just have to set the precision and scale after. Thank you! SqlDecimal.ConvertToPrecScale(new SqlDecimal(value), precision, scale);"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "reply_to_user": {"reputation": 1918, "user_id": 854899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a3d9ab05641d0ee52000e0535cc4b51?s=128&d=identicon&r=PG", "display_name": "Noah", "link": "https://stackoverflow.com/users/854899/noah"}, "edited": false, "score": 0, "creation_date": 1480537957, "post_id": 40897221, "comment_id": 69009002, "body": "Yes that would work, however you should not need to create a <code>SqlDecimal</code> directly.  The SQL provider should implicitly convert your <code>decimal</code> value for you.  If you have a case where you <i>need</i> to create a <code>SqlDecimal</code> then that should work."}], "tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": true, "score": 1, "last_activity_date": 1505415644, "last_edit_date": 1505415644, "creation_date": 1480536462, "answer_id": 40897221, "question_id": 40897057, "link": "https://stackoverflow.com/questions/40897057/testing-differences-between-sqldecimal-and-c-decimal/40897221#40897221", "title": "Testing differences between SqlDecimal and C# Decimal", "body": "<p>The return of <code>Decimal.GetBits</code> is not compatible with the <code>SqlDecimal</code>'s constructor parameter.  </p>\n\n<p><code>Decimal.GetBits</code> returns an array that represents the exact structure of the decimal, which includes the 96-bit scaled integer value and 8 bits for the exponent (plus 1 sign bit and 27 unused bits).</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/4atwkb98(v=vs.110).aspx\" rel=\"nofollow noreferrer\"><code>SqlDecimal</code> constructor</a> that you are using takes an <code>int</code> array that represents \"The 128-bit unsigned integer that provides the value of the new SqlDecimal.\" - NOT the <em>represenatation</em> of that decimal value.  The <code>scale</code> parameter determines what the <em>actual</em> value of the decimal will be.</p>\n\n<p>So you are effectively passing in a different value than the constructor expects.  The .NET decimal equivalent of 10.3m is</p>\n\n<pre><code>0000000001100111-0000000000000000-0000000000000000-10000000000000000\n</code></pre>\n\n<p>Where <code>1100111</code> is the binary equivalent of 103, and <code>1</code> is the scale.</p>\n\n<p>The integer equivalent of that binary value is more than 13 digits long, which is why you get an overflow when passing it to the SqlDecimal constructor.</p>\n\n<p>I would not play around with bit-fiddling and instead just use the raw <code>decimal</code> value, letting SQL convert it to the right precision and scale automatically.  </p>\n\n<blockquote>\n  <p>I'm trying to validate that a decimal in c# will fit into a db column decimal.</p>\n</blockquote>\n\n<p>Well, the largest value that will fit into a <code>DECIMAL(13,10)</code> is <code>999.9999999999</code>, which is well below the maximum value of a <code>decimal</code>. So no, you can't store <em>any</em> C# decimal value in a <code>DECIMAL(13,10)</code> SQL column.</p>\n\n<p>(technically I think you can store <code>9999999999999</code> by dropping the precision, but even that is well below the maximum value of a <code>decimal</code>).</p>\n"}], "owner": {"reputation": 1918, "user_id": 854899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a3d9ab05641d0ee52000e0535cc4b51?s=128&d=identicon&r=PG", "display_name": "Noah", "link": "https://stackoverflow.com/users/854899/noah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 739, "favorite_count": 0, "accepted_answer_id": 40897221, "answer_count": 2, "score": 1, "last_activity_date": 1505415644, "creation_date": 1480535825, "question_id": 40897057, "link": "https://stackoverflow.com/questions/40897057/testing-differences-between-sqldecimal-and-c-decimal", "title": "Testing differences between SqlDecimal and C# Decimal", "body": "<p>I'm trying to validate that a decimal in c# will fit into a db column decimal. The SqlDecimal object allows you to pass in a precision and scale as well as the decimal bits to the constructor. I know the size of the column and so before we write the data I check each input so I can produce business required output.</p>\n\n<p>In this case we are storing a percent, so the precision is <strong>13</strong> and the scale is <strong>10</strong>. I have a testing harness that I've condensed below into a unti test for SO. This sample is throwing an Arithmetic Overflow error on the SqlDecimal constructor line:</p>\n\n<pre><code>    [TestMethod]\n    public void TestDecimalFits()\n    {\n        decimal d = 10.3m;\n        SqlDecimal sqlDecimal = new SqlDecimal(13, 10, d &gt;= 0, Decimal.GetBits(d));\n        Assert.AreEqual(d, sqlDecimal.Value);\n    }\n</code></pre>\n\n<p>Does anyone know why this blows up?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "asp.net-mvc", "pdf"], "comments": [{"owner": {"reputation": 28367, "user_id": 1678148, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb1aee4193fab0cdc8ccd3ca950c038e?s=128&d=identicon&r=PG", "display_name": "Darren Wainwright", "link": "https://stackoverflow.com/users/1678148/darren-wainwright"}, "edited": false, "score": 0, "creation_date": 1480535814, "post_id": 40897027, "comment_id": 69007874, "body": "I imagine you will need to loop over each page of your PDF and convert them into separate images."}, {"owner": {"reputation": 342, "user_id": 3159792, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f58a0cf5b792c68ebe7450163f824f37?s=128&d=identicon&r=PG&f=1", "display_name": "user3159792", "link": "https://stackoverflow.com/users/3159792/user3159792"}, "reply_to_user": {"reputation": 28367, "user_id": 1678148, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb1aee4193fab0cdc8ccd3ca950c038e?s=128&d=identicon&r=PG", "display_name": "Darren Wainwright", "link": "https://stackoverflow.com/users/1678148/darren-wainwright"}, "edited": false, "score": 0, "creation_date": 1480536481, "post_id": 40897027, "comment_id": 69008210, "body": "images.Read(data,settings); produces 2 objects (which is the same number of pages in the PDF im converting) but both have the same size. i don&#39;t know if that line reads the first page or it reads the entire document. Plus the foreach loop is supposed to loop through all the objects in images. so im confused actually :/"}, {"owner": {"reputation": 28367, "user_id": 1678148, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb1aee4193fab0cdc8ccd3ca950c038e?s=128&d=identicon&r=PG", "display_name": "Darren Wainwright", "link": "https://stackoverflow.com/users/1678148/darren-wainwright"}, "edited": false, "score": 0, "creation_date": 1480538295, "post_id": 40897027, "comment_id": 69009186, "body": "In your loop you have <code>image.Write(convertedFile, MagickFormat.Png);</code> - is this not writing the full PDF thus just 1 page. So each image is the same converted file. I see nothing where you write just a single pages data - i don&#39;t know the library, just what i see in your code."}, {"owner": {"reputation": 342, "user_id": 3159792, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f58a0cf5b792c68ebe7450163f824f37?s=128&d=identicon&r=PG&f=1", "display_name": "user3159792", "link": "https://stackoverflow.com/users/3159792/user3159792"}, "reply_to_user": {"reputation": 28367, "user_id": 1678148, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb1aee4193fab0cdc8ccd3ca950c038e?s=128&d=identicon&r=PG", "display_name": "Darren Wainwright", "link": "https://stackoverflow.com/users/1678148/darren-wainwright"}, "edited": false, "score": 0, "creation_date": 1480579149, "post_id": 40897027, "comment_id": 69023311, "body": "convertedFile.Flush(); convertedFile.Dispose(); worked for me :) thanks everyone :D"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4753257, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPeO8.png?s=128&g=1", "display_name": "Khaled Roohai", "link": "https://stackoverflow.com/users/4753257/khaled-roohai"}, "is_accepted": false, "score": 0, "last_activity_date": 1504688133, "last_edit_date": 1504688133, "creation_date": 1504688051, "answer_id": 46070788, "question_id": 40897027, "link": "https://stackoverflow.com/questions/40897027/imagemagick-net-only-renders-first-page-of-a-pdf-file-in-asp-net-mvc/46070788#46070788", "title": "ImageMagick.NET only renders first page of a PDF file in ASP.NET MVC?", "body": "<p>change your code this below:</p>\n\n<pre><code>    [HttpPost]\n    public ActionResult UploadPdf(HttpPostedFileBase file)\n    {\n        MemoryStream target = new MemoryStream();\n        file.InputStream.CopyTo(target);\n        byte[] data = target.ToArray();\n\n\n        MagickReadSettings settings = new MagickReadSettings();\n        settings.Density = new Density(300, 300);\n\n        List&lt;ImageModel&gt; model = new List&lt;ImageModel&gt;();\n        using (MagickImageCollection images = new MagickImageCollection())\n        {\n            images.Read(data,settings); // Read PDF file\n            foreach (MagickImage image in images)\n            {\n                MemoryStream convertedFile = new MemoryStream();\n                ImageModel innerModle = new ImageModel();\n                image.Write(convertedFile, MagickFormat.Png);\n                byte[] data2 = convertedFile.ToArray();\n                innerModle.Image = data2;\n                model.Add(innerModle);                     \n           }                 \n        }                         \n        return View(model);\n    }\n</code></pre>\n"}], "owner": {"reputation": 342, "user_id": 3159792, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f58a0cf5b792c68ebe7450163f824f37?s=128&d=identicon&r=PG&f=1", "display_name": "user3159792", "link": "https://stackoverflow.com/users/3159792/user3159792"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 865, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504688133, "creation_date": 1480535709, "last_edit_date": 1480546428, "question_id": 40897027, "link": "https://stackoverflow.com/questions/40897027/imagemagick-net-only-renders-first-page-of-a-pdf-file-in-asp-net-mvc", "title": "ImageMagick.NET only renders first page of a PDF file in ASP.NET MVC?", "body": "<p>I'm trying to convert a PDF file into an image, however i only get the first page converted.\nHeres what i have.\nCode behind:</p>\n\n<pre><code> [HttpPost]\n        public ActionResult UploadPdf(HttpPostedFileBase file)\n        {\n            MemoryStream target = new MemoryStream();\n            file.InputStream.CopyTo(target);\n            byte[] data = target.ToArray();\n\n\n            MagickReadSettings settings = new MagickReadSettings();\n            settings.Density = new Density(300, 300);\n            MemoryStream convertedFile = new MemoryStream();\n            List&lt;ImageModel&gt; model = new List&lt;ImageModel&gt;();\n            using (MagickImageCollection images = new MagickImageCollection())\n            {\n                images.Read(data,settings); // Read PDF file\n                foreach (MagickImage image in images)\n                {\n                    ImageModel innerModle = new ImageModel();\n                    image.Write(convertedFile, MagickFormat.Png);\n                    byte[] data2 = convertedFile.ToArray();\n                    innerModle.Image = data2;\n                    model.Add(innerModle);                     \n               }                 \n            }                         \n            return View(model);\n        }\n</code></pre>\n\n<p>View model:</p>\n\n<pre><code> public class ImageModel\n    {\n        public byte[] Image{ get; set; }\n    }\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>@model List&lt;DocumentViewerPoc.Models.ImageModel&gt;\n@foreach (var item in Model)\n{\n    var base64 = Convert.ToBase64String(item.Image);\n    var imgSrc = String.Format(\"data:image/gif;base64,{0}\", base64);\n    &lt;img src=\"@imgSrc\" /&gt;\n}\n</code></pre>\n\n<p>I tried using  <code>convertedFile.Flush();</code>but that didn't do it for me. what am i missing here?\nthanks :)</p>\n"}, {"tags": ["c#", "wpf", "stack", "panel", "stackpanel"], "comments": [{"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480535889, "post_id": 40896994, "comment_id": 69007912, "body": "Do your list items (or their content, etc.) have a fixed width, or does everything stretch to fill its parent? If you show us the XAML we can come up with a better guess about what&#39;s wrong with it."}, {"owner": {"reputation": 3631, "user_id": 3596441, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/eOkgD.jpg?s=128&g=1", "display_name": "The One", "link": "https://stackoverflow.com/users/3596441/the-one"}, "edited": false, "score": 0, "creation_date": 1480536341, "post_id": 40896994, "comment_id": 69008141, "body": "Show the XAML......"}, {"owner": {"reputation": 3172, "user_id": 6726592, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6xIeo.jpg?s=128&g=1", "display_name": "Roxy&#39;Pro", "link": "https://stackoverflow.com/users/6726592/roxypro"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480537155, "post_id": 40896994, "comment_id": 69008549, "body": "@Ed Plunkett I made edit, there is full code."}, {"owner": {"reputation": 3172, "user_id": 6726592, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6xIeo.jpg?s=128&g=1", "display_name": "Roxy&#39;Pro", "link": "https://stackoverflow.com/users/6726592/roxypro"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480537185, "post_id": 40896994, "comment_id": 69008565, "body": "@EdPlunkett I made edit, there is full code.."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 2, "creation_date": 1480537414, "post_id": 40896994, "comment_id": 69008677, "body": "Sorry, I can&#39;t make any sense of that. You should use XAML."}, {"owner": {"reputation": 3172, "user_id": 6726592, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6xIeo.jpg?s=128&g=1", "display_name": "Roxy&#39;Pro", "link": "https://stackoverflow.com/users/6726592/roxypro"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480537636, "post_id": 40896994, "comment_id": 69008795, "body": "@Ed plunkett well by that, we can see that this is made from 2 stack panels, one contains image and name, and another one(right one) contains only quantity, x1,x2 etc.. and their width is fixed, because its passed to pathod which is creating this panels.. so its problem, to keep stack panels fixed?"}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480537795, "post_id": 40896994, "comment_id": 69008886, "body": "@Roxy&#39;Pro Don&#39;t fix the width. Maybe do a Grid with two columns, Width=Auto and Width=*."}, {"owner": {"reputation": 3172, "user_id": 6726592, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6xIeo.jpg?s=128&g=1", "display_name": "Roxy&#39;Pro", "link": "https://stackoverflow.com/users/6726592/roxypro"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480537895, "post_id": 40896994, "comment_id": 69008965, "body": "@EdPlunkett Than I should work with XAML more than with code behind and we might achieve someting like that.."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480537951, "post_id": 40896994, "comment_id": 69008998, "body": "It&#39;s much, much less awful to do it with XAML. Still awful, granted."}], "owner": {"reputation": 3172, "user_id": 6726592, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6xIeo.jpg?s=128&g=1", "display_name": "Roxy&#39;Pro", "link": "https://stackoverflow.com/users/6726592/roxypro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480537127, "creation_date": 1480535594, "last_edit_date": 1480537127, "question_id": 40896994, "link": "https://stackoverflow.com/questions/40896994/how-to-prevent-vertical-scroll-bar-to-lap-my-stack-panels-wpf", "title": "How to prevent vertical scroll bar to lap my stack panels wpf", "body": "<p>I am wondering how could I prevent vertical scroll bar from lapping my stack panels.</p>\n\n<p>I am working on small wpf app where customers can add articles(drinks) to a something like cart, and when user click on article its added to the right part of window in stack panel, this is how it looks a like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sJsxQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sJsxQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>But I have problem when I add more than lets say 5-6 items to my stack panel, than vertical scroll bar is appearing and this is what's happening (notice vertical scroll bar to the right) its laping \"x1\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/1xbsk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1xbsk.png\" alt=\"enter image description here\"></a></p>\n\n<p>How could I prevent this guy? Is it possible to move content to the left or something like that without laping my items/articles ...</p>\n\n<p>If the code of how I add items to stackPanel is needed, I will post it in a sec?</p>\n\n<p>HERE IS MY FULL CODE ABOUT THIS PART:</p>\n\n<pre><code>  public MyDrinksPanel(int id, int groupID, double price,double priceHappy, string text, int fontSize, int numberSize, int buttonWidth, int buttonHeight, int margin, Thickness border, byte[] image)\n            : base()\n        {\n            this.Width = buttonWidth+90;\n            this.Height = buttonHeight;\n            image.Source =  GetimageFromByte(image);\n\n            ID = id;\n            groupID = groupID;\n            price = price;\n            priceHappy = priceHappy;\n            DugmePanel.HorizontalAlignment = HorizontalAlignment.Center;\n            DugmePanel.VerticalAlignment = VerticalAlignment.Center;\n            DugmePanel.Orientation = Orientation.Horizontal;\n            DugmePanel.MaxWidth = DugmePanel.Width = buttonWidth;\n            //DugmePanel.Height = 70;\n            DugmePanel.Height = DugmePanel.MaxHeight = this.Height;\n            BrushConverter MyBrush = new BrushConverter();\n\n            DugmePanel.Background = (Brush)MyBrush.ConvertFrom(\"#50000000\");\n\n\n\n            _image.Width = 120;\n\n            _image.Height = buttonHeight;\n            _image.HorizontalAlignment = HorizontalAlignment.Left;\n            _image.VerticalAlignment = VerticalAlignment.Center;\n\n\n            BrushConverter MyBrush2 = new BrushConverter();\n\n\n\n            RightNumberPanel.HorizontalAlignment = HorizontalAlignment.Right;\n            RightNumberPanel.VerticalAlignment = VerticalAlignment.Center;\n            RightNumberPanel.Orientation = Orientation.Horizontal;\n            RightNumberPanel.Width = RightNumberPanel.MaxWidth = this.Width - DugmePanel.Width;\n            RightNumberPanel.Height = RightNumberPanel.MaxHeight = this.Height;\n            NumberLabel.FontFamily = Util.Font; //new System.Windows.Media.FontFamily(\"HelveticaNeueLTStd-Bd.otf#Helvetica Neue LT Std\");\n\n\n            ArticleNameLabel.VerticalContentAlignment = VerticalAlignment.Center;\n            ArticleNameLabel.HorizontalContentAlignment = HorizontalAlignment.Left;\n            ArticleNameLabel.FontSize = fontSize;\n\n            ArticleNameLabel.Foreground = System.Windows.Media.Brushes.White;\n\n            ArticleNameLabel.MaxWidth = _image.Width+45; //- 3;\n            ArticleNameLabel.FontFamily = Util.Font;//new System.Windows.Media.FontFamily(\"HelveticaNeueLTStd-Bd.otf#Helvetica Neue LT Std\");\n\n\n\n            NumberLabel.Height = NumberLabel.MaxHeight = this.Height;\n            NumberLabel.FontSize = numberSize;\n            NumberLabel.Margin = new Thickness(0, 0, 0, 0);\n            NumberLabel.VerticalAlignment = VerticalAlignment.Center;\n            NumberLabel.HorizontalAlignment = HorizontalAlignment.Right;\n            NumberLabel.HorizontalContentAlignment = HorizontalAlignment.Right;\n            NumberLabel.Foreground= System.Windows.Media.Brushes.White;\n            NumberLabel.FontWeight = FontWeights.Bold;\n            BrushConverter MyBrush3 = new BrushConverter();\n\n            NumberLabel.Background = (Brush)MyBrush3.ConvertFrom(\"#83D744\");\n            NumberLabel.Foreground = new SolidColorBrush(Colors.Black);\n\n\n\n            ArticleNameLabel.Content = text;\n            NumberLabel.Content = \"x1\";\n\n            DugmePanel.Children.Add(image);\n            DugmePanel.Children.Add(ArticleNameLabel);\n            RightNumberPanel.Children.Add(NumberLabel);\n\n            Rectangle rct = new Rectangle();\n            rct.Fill = System.Windows.Media.Brushes.White;\n            rct.HorizontalAlignment = System.Windows.HorizontalAlignment.Stretch;\n            rct.Height = 2;\n\n\n            //rct.Width = 100;\n\n            _animations = new DoubleAnimation(numberSize, numberSize + 15, new Duration(new TimeSpan(0, 0, 0, 0, 300)));\n\n            _animations.AutoReverse = true;\n\n            this.Margin = border;\n            this.Orientation = Orientation.Horizontal;\n            StackPanel spNew = new StackPanel();\n            spNew.HorizontalAlignment = System.Windows.HorizontalAlignment.Stretch;\n\n            spNew.Orientation = System.Windows.Controls.Orientation.Horizontal;\n\n            spNew.Children.Add(DugmePanel);\n            spNew.Children.Add(RightNumberPanel);\n            StackPanel spNew2 = new StackPanel();\n            spNew2.Orientation = System.Windows.Controls.Orientation.Vertical;\n\n            spNew2.Children.Add(spNew);\n\n            this.Children.Add(spNew2);\n\n        }\n</code></pre>\n\n<p>I dont have a lot about XAML HERE:\nThis is only part:</p>\n\n<pre><code>&lt;ScrollViewer x:Name=\"ScrollerOnTheRight\" Margin=\"0,0,0,60\" HorizontalScrollBarVisibility=\"Disabled\" Grid.Row=\"1\" Grid.Column=\"2\" VerticalScrollBarVisibility=\"Auto\" HorizontalAlignment=\"Stretch\" VerticalAlignment=\"Stretch\"&gt;\n            &lt;StackPanel Grid.Row=\"1\" x:Name=\"stackRacun\" Grid.Column=\"2\"/&gt;\n        &lt;/ScrollViewer&gt;\n</code></pre>\n\n<p>Thanks guys,\nCheers</p>\n"}, {"tags": ["c#", "html", "excel", "html-select"], "owner": {"reputation": 49, "user_id": 7164321, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbc1e4ed52c1b6c74ad6689f0feaeedd?s=128&d=identicon&r=PG&f=1", "display_name": "BigBucks", "link": "https://stackoverflow.com/users/7164321/bigbucks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480536313, "creation_date": 1480535546, "last_edit_date": 1480536313, "question_id": 40896982, "link": "https://stackoverflow.com/questions/40896982/using-dropdownlists-to-pull-data-from-excel-spreadsheet", "title": "Using dropdownlists to pull data from Excel spreadsheet", "body": "<p>Is there a way that I can use an excel spreadsheet that would then feed into my html / c# program. I have as many as 10 dropdownlists(DDL) that all have different values(example: {Ram [8, 16, 32, 64]} and another being {City[HSV, DAL, SLC, DNV]}, hard-coded into them in the html layer. Those DDL's names and values represent data that is in an excel spreadsheet. I need to write code that pulls certain data from the spreadsheet if and only if that particular value was selected within the DDL. ALL of the things I have tried looking through try to get me to import the spreadsheet and use it like a spreadsheet inside a panel or something. I need to have a way that lets me tinker with it more like a database. I need to be able to write functions/statements that operate like SQL Queries. Thank you for taking the time to read this and your attempt at helping me out.</p>\n\n<p>HTML</p>\n\n<pre><code>&lt;%@ Page Language=\"C#\" AutoEventWireup=\"true\" CodeBehind=\"Find.aspx.cs\" Inherits=\"VirginiaCollege.Find\" %&gt;\n\n&lt;!DOCTYPE html&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head runat=\"server\"&gt;\n&lt;title&gt;&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form id=\"form1\" runat=\"server\"&gt;\n&lt;div&gt;\n\n    &lt;asp:Panel ID=\"Panel1\" runat=\"server\" BorderColor=\"White\" BorderStyle=\"None\"&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;asp:Label ID=\"Label11\" runat=\"server\" Text=\"Select what type of user you are...\"&gt;&lt;/asp:Label&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;asp:DropDownList ID=\"DropDownList1\" runat=\"server\"&gt;                \n            &lt;asp:ListItem&gt;IT Admin&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Executive Management&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Academic Director&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Teachers&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Students&lt;/asp:ListItem&gt;\n        &lt;/asp:DropDownList&gt;\n\n\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;asp:Button ID=\"btSubmitUserType\" runat=\"server\" BorderStyle=\"Ridge\" Text=\"Submit Selection\" BackColor=\"#CCCCCC\" OnClick=\"btSubmitUserType_Click\" /&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;            \n\n\n    &lt;/asp:Panel&gt;\n\n    &lt;asp:Panel ID=\"Panel6\" runat=\"server\" Visible=\"false\" &gt;\n\n        &lt;asp:Label ID=\"lblEnterPsWrd\" runat=\"server\" Text=\"Please enter the password\"&gt;&lt;/asp:Label&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;asp:TextBox ID=\"tbPassword\" runat=\"server\" placeholder=\"Password\" &gt;    &lt;/asp:TextBox&gt;\n        &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n        &lt;asp:Label ID=\"Label12\" runat=\"server\" Text=\"Password = Admin\"&gt;&lt;/asp:Label&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;asp:Button ID=\"btnSubmitUserTypePsWrd\" runat=\"server\" BorderStyle=\"Ridge\" Text=\"Submit Password\" BackColor=\"#CCCCCC\" OnClick=\"btSubmitUserTypePsWrd_Click\" /&gt;\n\n\n\n    &lt;/asp:Panel&gt;\n\n    &lt;asp:Panel ID=\"Panel7\" runat=\"server\" Visible=\"false\" &gt;\n\n        &lt;asp:Label ID=\"lblEnterPsWrd2\" runat=\"server\" Text=\"Please enter the password\"&gt;&lt;/asp:Label&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;asp:TextBox ID=\"tbPassword2\" runat=\"server\" placeholder=\"Password\" &gt;&lt;/asp:TextBox&gt;\n        &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n        &lt;asp:Label ID=\"Label13\" runat=\"server\" Text=\"Password = Director\"&gt;&lt;/asp:Label&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;asp:Button ID=\"btnSubmitUserTypePsWrd2\" runat=\"server\" BorderStyle=\"Ridge\" Text=\"Submit Password\" BackColor=\"#CCCCCC\" OnClick=\"btSubmitUserTypePsWrd2_Click\" /&gt;\n\n\n\n    &lt;/asp:Panel&gt;\n\n    &lt;asp:Panel ID=\"Panel8\" runat=\"server\" Visible=\"false\" &gt;\n\n        &lt;asp:Label ID=\"lblEnterPsWrd3\" runat=\"server\" Text=\"Please enter the password\"&gt;&lt;/asp:Label&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;asp:TextBox ID=\"tbPassword3\" runat=\"server\" placeholder=\"Password\" &gt;&lt;/asp:TextBox&gt;\n        &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;\n        &lt;asp:Label ID=\"Label14\" runat=\"server\" Text=\"Password = Student\"&gt;&lt;/asp:Label&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;asp:Button ID=\"btnSubmitUserTypePsWrd3\" runat=\"server\" BorderStyle=\"Ridge\" Text=\"Submit Password\" BackColor=\"#CCCCCC\" OnClick=\"btSubmitUserTypePsWrd3_Click\" /&gt;\n\n\n\n    &lt;/asp:Panel&gt;\n\n    &lt;asp:Panel ID=\"Panel2\" runat=\"server\" Visible=\"false\"&gt;\n\n        &lt;asp:CheckBox ID=\"cbCity\" runat=\"server\" Text=\"City\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbComputerType\" runat=\"server\" Text=\"Computer Type\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbDepartment\" runat=\"server\" Text=\"Department\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbRoomNumber\" runat=\"server\" Text=\"Room Number\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbComputerPosition\" runat=\"server\" Text=\"Computer Postition\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbGraphicsCard\" runat=\"server\" Text=\"Graphics Card\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbRAM\" runat=\"server\" Text=\"RAM\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbProgram\" runat=\"server\" Text=\"Program\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbInstallDate\" runat=\"server\" Text=\"Install Date\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbExperationDate\" runat=\"server\" Text=\"Experation Date\" /&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n\n\n        &lt;br /&gt;\n        &lt;asp:Button ID=\"Button1\" runat=\"server\" OnClick=\"Button1_Click\" Text=\"Submit Search Criteria\" /&gt;\n\n\n    &lt;/asp:Panel&gt;\n\n    &lt;asp:Panel ID=\"Panel3\" runat=\"server\" Visible=\"false\"&gt;\n\n\n        &lt;asp:CheckBox ID=\"cbComputerType2\" runat=\"server\" Text=\"Computer Type\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbDepartment2\" runat=\"server\" Text=\"Department\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbRoomNumber2\" runat=\"server\" Text=\"Room Number\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbGraphicsCard2\" runat=\"server\" Text=\"Graphics Card\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbRAM2\" runat=\"server\" Text=\"RAM\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbProgram2\" runat=\"server\" Text=\"Program\" /&gt;\n        &lt;br /&gt;\n        &lt;br /&gt;\n\n        &lt;br /&gt;\n        &lt;asp:Button ID=\"Button2\" runat=\"server\" OnClick=\"Button2_Click\" Text=\"Submit Search Criteria\" /&gt;\n\n    &lt;/asp:Panel&gt;\n\n    &lt;asp:Panel ID=\"Panel4\" runat=\"server\" Visible=\"false\"&gt;\n\n        &lt;asp:CheckBox ID=\"cbComputerType3\" runat=\"server\" Text=\"Computer Type\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbGraphicsCard3\" runat=\"server\" Text=\"Department\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbRAM3\" runat=\"server\" Text=\"Room Number\" /&gt;\n        &lt;br /&gt;\n        &lt;asp:CheckBox ID=\"cbProgram3\" runat=\"server\" Text=\"Graphics Card\" /&gt;\n        &lt;br /&gt;\n\n\n        &lt;br /&gt;\n        &lt;asp:Button ID=\"Button3\" runat=\"server\" OnClick=\"Button3_Click\" Text=\"Submit Search Criteria\" /&gt;\n\n    &lt;/asp:Panel&gt;\n\n\n\n\n    &lt;br /&gt;\n    &lt;br /&gt;\n    &lt;br /&gt;\n    &lt;asp:Panel ID=\"Panel5\" runat=\"server\" Visible=\"false\" HorizontalAlign=\"Left\"&gt;\n\n        &lt;asp:Label ID=\"Label1\" runat=\"server\" Text=\"Select City...\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlCity\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;HSV&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;DAL&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;&lt;/asp:ListItem&gt;\n        &lt;/asp:DropDownList&gt;\n\n        &lt;br /&gt;\n\n        &lt;asp:Label ID=\"Label2\" runat=\"server\" Text=\"Select Computer Type\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlComputerType\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;CSTU&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;CAD&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Staff&lt;/asp:ListItem&gt;\n        &lt;/asp:DropDownList&gt;\n\n        &lt;br /&gt;\n\n        &lt;asp:Label ID=\"Label3\" runat=\"server\" Text=\"Select Department\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlDepartment\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;3D Imaging&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Accounting&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Business&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Recruiting&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Management&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Teaching&lt;/asp:ListItem&gt;\n        &lt;/asp:DropDownList&gt;\n\n        &lt;br /&gt;\n\n        &lt;asp:Label ID=\"Label4\" runat=\"server\" Text=\"Select Room Number\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlRoomNumber\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;1&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;2&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;3&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;4&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;5&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;6&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;7&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;8&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;9&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;10&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;11&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;12&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;13&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;14&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;15&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;16&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;17&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;18&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;19&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;20&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;21&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;22&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;23&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;24&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;25&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;26&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;27&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;28&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;29&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;30&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;31&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;32&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;33&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;34&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;35&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;36&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;37&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;38&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;&lt;/asp:ListItem&gt;\n        &lt;/asp:DropDownList&gt;\n\n        &lt;br /&gt;\n\n        &lt;asp:Label ID=\"Label5\" runat=\"server\" Text=\"Select Computer Position\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlComputerPosition\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;1&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;2&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;3&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;4&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;5&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;6&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;7&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;8&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;9&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;10&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;11&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;12&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;13&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;14&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;15&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;16&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;17&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;18&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;19&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;20&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;21&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;22&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;23&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;24&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;25&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;26&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;27&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;28&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;29&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;30&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;31&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;32&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;33&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;34&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;35&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;36&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;37&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;38&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;39&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;40&lt;/asp:ListItem&gt;\n        &lt;/asp:DropDownList&gt;\n\n        &lt;br /&gt;\n\n        &lt;asp:Label ID=\"Label6\" runat=\"server\" Text=\"Select Graphics Card\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlGraphicsCard\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;Dell Nvidia Tesla K40 GPU Computing Processor&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Dell 6 GB Nvidia Tesla K20X GPU Computing Processor&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Dell 2 GB Nvidia Quadro K620 Graphics Card&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Nvidia Quadro K6000 SDI I/O&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;VisionTek CryoVenom R9 290&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Nvidia GeForce GTX 780&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;AMD Radeon R9 295X2&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;AMD Radeon R9 290&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;MSI R9 280X Gaming 3G&lt;/asp:ListItem&gt;\n        &lt;/asp:DropDownList&gt;\n\n        &lt;br /&gt;\n\n        &lt;asp:Label ID=\"Label7\" runat=\"server\" Text=\"Select RAM\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlRAM\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;8&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;16&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;32&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;64&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;128&lt;/asp:ListItem&gt;\n        &lt;/asp:DropDownList&gt;\n\n        &lt;br /&gt;\n\n        &lt;asp:Label ID=\"Label8\" runat=\"server\" Text=\"Select Program\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlProgram\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;Xara Photo &amp; Graphic 2013&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Real-time 3D Character&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Autodesk Inventor&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Autodesk AutoCAD 2015&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Autodesk AutoCAD 2014&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Autodesk AutoCAD 2013&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Autodesk AutoCAD 2012&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Autodesk AutoCAD 2011&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Autodesk AutoCAD 2010&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;QuickBooks 2017&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;QuickBooks !=2017&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Visual Studio 2015&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Visual Studio 2016&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Visual Studio 2017&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Visual Studio 2013&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Visual Studio 2012&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Visual Studio 2011&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Visual Studio 2010&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Visual Studio 2009&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Visual Studio 2014&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;Office suite&lt;/asp:ListItem&gt;\n        &lt;/asp:DropDownList&gt;\n\n        &lt;br /&gt;\n\n        &lt;asp:Label ID=\"Label9\" runat=\"server\" Text=\"Select Software Install Date\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlSoftInstalDate\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;JUN 2009&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;MAY 2010&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;JUN 2011&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;DEC 2012&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;DEC 2013&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;JAN 2014&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;JAN 2015&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;FEB 2015&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;JUL 2016&lt;/asp:ListItem&gt;\n\n        &lt;/asp:DropDownList&gt;\n\n        &lt;br /&gt;\n\n        &lt;asp:Label ID=\"Label10\" runat=\"server\" Text=\"Select Software Expire Date\" Visible=\"False\"&gt;&lt;/asp:Label&gt;\n        &lt;asp:DropDownList ID=\"ddlSoftExpDate\" runat=\"server\" Visible=\"False\"&gt;\n            &lt;asp:ListItem&gt;DEC 2013&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;DEC 2014&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;MAY 2015&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;DEC 2015&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;JAN 2016&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;JAN 2017&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;NOV 2018&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;DEC 2018&lt;/asp:ListItem&gt;\n            &lt;asp:ListItem&gt;DEC 2019&lt;/asp:ListItem&gt;\n\n\n        &lt;/asp:DropDownList&gt;\n\n\n\n    &lt;/asp:Panel&gt;\n\n    &lt;asp:Panel ID=\"Panel40\" runat=\"server\" Visible=\"False\"&gt;&lt;/asp:Panel&gt;\n\n    &lt;asp:CheckBoxList ID=\"CheckBoxList20\" runat=\"server\"&gt;&lt;/asp:CheckBoxList&gt;\n\n    &lt;asp:Panel ID=\"Panel50\" runat=\"server\" Visible=\"False\"&gt;&lt;/asp:Panel&gt;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&lt;/div&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>C#</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\n\nnamespace VirginiaCollege\n{\npublic partial class Find : System.Web.UI.Page\n{\n    protected void Page_Load(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void btSubmitUserType_Click(object sender, EventArgs e)\n    {\n        if (DropDownList1.SelectedItem.Text == \"IT Admin\" )\n        {\n            Panel6.Visible = true;\n            Panel1.Visible = false;\n        }\n\n        else if (DropDownList1.SelectedItem.Text == \"Executive Management\" )\n        {\n            Panel6.Visible = true;\n            Panel1.Visible = false;\n        }\n\n        else if (DropDownList1.SelectedItem.Text == \"Academic Director\")\n        {\n            Panel7.Visible = true;\n            Panel1.Visible = false;\n        }\n\n        else if (DropDownList1.SelectedItem.Text == \"Teachers\")\n        {\n            Panel8.Visible = true;\n            Panel1.Visible = false;\n        }\n\n        else if (DropDownList1.SelectedItem.Text == \"Students\")\n        {\n            Panel8.Visible = true;\n            Panel1.Visible = false;\n        }\n\n    }\n\n    protected void btSubmitUserTypePsWrd_Click(object sender, EventArgs e)\n    {\n        if (tbPassword.Text == \"Admin\")\n        {\n            Panel2.Visible = true;\n            Panel1.Visible = false;\n            Panel6.Visible = false;\n        }           \n\n    }\n\n    protected void btSubmitUserTypePsWrd2_Click(object sender, EventArgs e)\n    {\n        if (tbPassword2.Text == \"Director\")\n        {\n            Panel3.Visible = true;\n            Panel1.Visible = false;\n            Panel7.Visible = false;\n        }\n\n    }\n\n    protected void btSubmitUserTypePsWrd3_Click(object sender, EventArgs e)\n    {\n        if (tbPassword3.Text == \"Student\")\n        {\n            Panel4.Visible = true;\n            Panel1.Visible = false;\n            Panel8.Visible = false;\n        }\n\n    }\n\n\n    protected void Button1_Click(object sender, EventArgs e)\n    {\n        if (cbCity.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label1.Visible = true;\n            DropDownList2.Visible = true;\n        }\n        if (cbComputerType.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label2.Visible = true;\n            DropDownList3.Visible = true;\n        }\n\n        if (cbDepartment.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label2.Visible = true;\n            DropDownList3.Visible = true;\n        }\n        if (cbRoomNumber.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label3.Visible = true;\n            DropDownList4.Visible = true;\n        }\n        if (cbComputerPosition.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label4.Visible = true;\n            DropDownList5.Visible = true;\n        }\n\n        if (cbGraphicsCard.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label5.Visible = true;\n            DropDownList6.Visible = true;\n        }\n\n        if (cbRAM.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label6.Visible = true;\n            DropDownList7.Visible = true;\n        }\n\n        if (cbProgram.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label7.Visible = true;\n            DropDownList8.Visible = true;\n        }\n\n        if (cbInstallDate.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label8.Visible = true;\n            DropDownList9.Visible = true;\n        }\n\n        if (cbExperationDate.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label9.Visible = true;\n            DropDownList10.Visible = true;\n        }         \n\n    }\n\n    protected void Button2_Click(object sender, EventArgs e)\n    {\n\n        if (cbComputerType2.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label1.Visible = true;\n            DropDownList2.Visible = true;\n        }\n\n        if (cbDepartment2.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label2.Visible = true;\n            DropDownList3.Visible = true;\n        }\n\n        if (cbRoomNumber2.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label3.Visible = true;\n            DropDownList4.Visible = true;\n        }\n\n        if (cbGraphicsCard2.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label5.Visible = true;\n            DropDownList6.Visible = true;\n        }\n\n        if (cbRAM2.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label6.Visible = true;\n            DropDownList7.Visible = true;\n        }\n\n        if (cbProgram2.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label7.Visible = true;\n            DropDownList8.Visible = true;\n        }\n    }\n\n    protected void Button3_Click(object sender, EventArgs e)\n    {\n        if (cbComputerType3.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label1.Visible = true;\n            DropDownList2.Visible = true;\n        }\n\n        if (cbGraphicsCard3.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label5.Visible = true;\n            DropDownList6.Visible = true;\n        }\n\n        if (cbRAM3.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label6.Visible = true;\n            DropDownList7.Visible = true;\n        }\n\n        if (cbProgram3.Checked == true)\n        {\n\n            Panel5.Visible = true;\n            Panel2.Visible = false;\n            Label7.Visible = true;\n            DropDownList8.Visible = true;\n        }\n    }\n\n    protected void CheckBoxList1_SelectedIndexChanged(object sender, EventArgs e)\n    {\n\n    }\n}\n}\n</code></pre>\n"}, {"tags": ["c#", "asp.net", "gridview"], "comments": [{"owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "edited": false, "score": 0, "creation_date": 1482418584, "post_id": 40896923, "comment_id": 69773658, "body": "Were you able to solve your problem?"}], "answers": [{"tags": [], "owner": {"reputation": 12772, "user_id": 490374, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8c174feb69caed3f5ba5fd68d9ab3c63?s=128&d=identicon&r=PG", "display_name": "Ann L.", "link": "https://stackoverflow.com/users/490374/ann-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1480540131, "creation_date": 1480540131, "answer_id": 40898232, "question_id": 40896923, "link": "https://stackoverflow.com/questions/40896923/why-gridview-records-are-showing-two-times-in-a-single-gridview/40898232#40898232", "title": "Why GRIDVIEW records are showing two times in a single gridview?", "body": "<p>For your duplicate record concern:  there's a property on <code>GridView</code> controls called <code>AutoGenerateColumns</code>.  It defaults to <code>true</code>.  </p>\n\n<p>When it is true, all the columns/fields/properties in the data source will automatically appear as columns in the results.  If you then add columns, those columns will appear in addition to (and after) the ones that are automatically generated.</p>\n\n<p>This is easy to fix:  change the <code>AutoGenerateColumns</code> property to <code>false</code>:</p>\n\n<pre><code>&lt;asp:GridView ID=\"GridView1\" runat=\"server\"\n     OnRowDataBound=\"GridView1_RowDataBound\"       \n     AutoGenerateColumns=\"false\"&gt;&lt;/asp:GridView&gt;\n</code></pre>\n\n<p>If other problems are occurring, ask a separate question for those.</p>\n"}], "owner": {"reputation": 1, "user_id": 7207072, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8a219f3d3a5d42add0a5a0c1c923702f?s=128&d=identicon&r=PG&f=1", "display_name": "mohamed faisal", "link": "https://stackoverflow.com/users/7207072/mohamed-faisal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 575, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480540266, "creation_date": 1480535345, "last_edit_date": 1480540266, "question_id": 40896923, "link": "https://stackoverflow.com/questions/40896923/why-gridview-records-are-showing-two-times-in-a-single-gridview", "title": "Why GRIDVIEW records are showing two times in a single gridview?", "body": "<p>I have 3 tasks:</p>\n\n<ol>\n<li>Records should not repeat as showing like that image. <a href=\"https://i.stack.imgur.com/GBecZ.png\" rel=\"nofollow noreferrer\">output</a></li>\n<li>When I click the button, It has to fetch the entire row records and the index of that particular row,</li>\n<li>After clicking that button, I have to insert some records in the next row where user click the button.</li>\n</ol>\n\n<p>For example: Totally 10 rows of records is in gridview. If user click second row button, it has to fetch the entire row details, index value of row and then insert 5 five rows of records from third row.</p>\n\n<p>This is my code:\nSample.aspx</p>\n\n<pre><code>&lt;asp:GridView ID=\"GridView1\" runat=\"server\" OnRowDataBound=\"GridView1_RowDataBound\"&gt;&lt;/asp:GridView&gt;\n</code></pre>\n\n<p>Sample.aspx.cs</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n    {\n        if (!this.IsPostBack)\n        {\n            BoundField bfield = new BoundField();\n            bfield.HeaderText = \"Name\";\n            bfield.DataField = \"Name\";\n            GridView1.Columns.Add(bfield);\n\n            TemplateField tfield = new TemplateField();\n            tfield.HeaderText = \"Country\";\n            GridView1.Columns.Add(tfield);\n\n            tfield = new TemplateField();\n            tfield.HeaderText = \"Id\";\n            GridView1.Columns.Add(tfield);\n            //BindGrid();\n        }\n        this.BindGrid();\n    }\n\nprivate void BindGrid()\n    {\n        DataTable dt = new DataTable();\n        dt.Columns.AddRange(new DataColumn[3] { new DataColumn(\"Id\", typeof(int)),\n                    new DataColumn(\"Name\", typeof(string)),\n                    new DataColumn(\"Country\",typeof(string)) });\n        dt.Rows.Add(1, \"John Hammond\", \"United States\");\n        dt.Rows.Add(2, \"Mudassar Khan\", \"India\");\n        dt.Rows.Add(3, \"Suzanne Mathews\", \"France\");\n        dt.Rows.Add(4, \"Robert Schidner\", \"Russia\");\n        GridView1.DataSource = dt;\n        GridView1.DataBind();\n    }\n\n    protected void btnRefresh_Click(object sender, EventArgs e)\n    {\n\n    }\n\n    protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)\n    {\n        if (e.Row.RowType == DataControlRowType.DataRow)\n        {\n            TextBox txtCountry = new TextBox();\n            txtCountry.ID = \"txtCountry\";\n            txtCountry.Text = (e.Row.DataItem as DataRowView).Row[\"Country\"].ToString();\n            e.Row.Cells[1].Controls.Add(txtCountry);\n\n            Button lnkView = new Button();\n            lnkView.ID = \"lnkView\";\n            lnkView.Text = (e.Row.DataItem as DataRowView).Row[\"Id\"].ToString();\n            lnkView.Click += ViewDetails;\n            lnkView.CommandArgument = (e.Row.DataItem as DataRowView).Row[\"Id\"].ToString();\n            e.Row.Cells[2].Controls.Add(lnkView);\n        }\n    }\n\n    protected void ViewDetails(object sender, EventArgs e)\n    {\n        Button lnkView = (sender as Button);\n        GridViewRow row = (lnkView.NamingContainer as GridViewRow);\n        string id = lnkView.CommandArgument;\n        string name = row.Cells[0].Text;\n        string country = (row.FindControl(\"txtCountry\") as TextBox).Text;\n        ClientScript.RegisterStartupScript(this.GetType(), \"alert\", \"alert('Id: \" + id + \" Name: \" + name + \" Country: \" + country + \"')\", true);\n    }\n</code></pre>\n\n<p>The most important thing is: I should get index of that row and insert the records between two records. </p>\n"}, {"tags": ["c#", "com", "ninject", "com-interop", "vbide"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480550578, "post_id": 40899107, "comment_id": 69014658, "body": "Assemblies loaded from different locations... could <code>Rubberduck.VBEditor.dll</code> be screwing things up... edge case 1 seems like a real possibility here."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480553327, "post_id": 40899107, "comment_id": 69015424, "body": "It sounds odd to say it, but could this stem from us using Microsoft&#39;s interop PIAs libraries instead of generating our own @Mat&#39;sMug? Shot in the dark. <a href=\"https://www.mztools.com/articles/2012/MZ2012011.aspx\" rel=\"nofollow noreferrer\">mztools.com/articles/2012/MZ2012011.aspx</a>"}, {"owner": {"reputation": 4105, "user_id": 3806634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9Sis.jpg?s=128&g=1", "display_name": "Carlos Quintero", "link": "https://stackoverflow.com/users/3806634/carlos-quintero"}, "edited": false, "score": 1, "creation_date": 1480582764, "post_id": 40899107, "comment_id": 69025160, "body": "I didn&#39;t see it last night, but now I see that after calling handler.Invoke you are not calling Marshal.ReleaseComObject on the ctrl .NET-side RCW that you are receiving from the COM side in the Target_Click event handler. That&#39;s a leak. Or if the CommandBarButton wrapper that receives it as parameter does call it in a Dispose method, you should call its Dispose method in the event handler rather than leaving it floating until the next garbage collection."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480625287, "post_id": 40899107, "comment_id": 69052395, "body": "Good catch! Coincidentally I had a clean exit right after taking care of that one... but it was a coincidence, crashed all the same on next attempt. I&#39;m rather encouraged by the fact that there&#39;s <i>sometimes</i> a clean exit... and after <a href=\"https://github.com/rubberduck-vba/Rubberduck/commit/9e80e2dc02a56ac3056c72b7ff5453dd43e5cf72\" rel=\"nofollow noreferrer\">changing the event to an explicit <code>add&#47;remove</code> implementation</a> I haven&#39;t seen that <code>InvalidCastException</code> anymore. Oh, and confirming case 1 isn&#39;t a possibility, too; only one assembly in the solution is referencing that dll. Feels like trying to fish with bare hands..."}], "tags": [], "owner": {"reputation": 4105, "user_id": 3806634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9Sis.jpg?s=128&g=1", "display_name": "Carlos Quintero", "link": "https://stackoverflow.com/users/3806634/carlos-quintero"}, "is_accepted": true, "score": 5, "last_activity_date": 1480543573, "creation_date": 1480543573, "answer_id": 40899107, "question_id": 40896893, "link": "https://stackoverflow.com/questions/40896893/cleaning-up-commandbar-buttons/40899107#40899107", "title": "Cleaning up CommandBar buttons", "body": "<p>I may be wrong, but I don't think InvalidCastException is because some COM object is gone, you would receive \u201cCOM object that has been separated from its underlying RCW cannot be used\u201d in that case. InvalidCastException means what it means, that a type cannot be converted to another type, and that can happen not only in the obvious case that the types full names are different, but also I have seen it in edge cases such as</p>\n\n<p>1) The type full names are the same, but come from different assemblies or even from the same assembly that somehow was loaded twice from different locations. Example: case 1 mentioned in <a href=\"http://www.visualstudioextensibility.com/2016/07/11/isolating-net-based-add-ins-for-the-vba-editor-with-com-shims/\" rel=\"nofollow noreferrer\">Isolating .NET-based add-ins for the VBA editor with COM Shims</a></p>\n\n<p>2) The type full names are the same but have been loaded in different CLRs (2.0 / 4.0) in the same process. Example: <a href=\"http://www.visualstudioextensibility.com/2016/09/09/the-strange-case-of-system-invalidcastexception-unable-to-cast-com-object-of-type-system-__comobject-to-class-type-system-windows-forms-usercontrol-showing-toolwindow/\" rel=\"nofollow noreferrer\">The strange case of System.InvalidCastException (\u201cUnable to cast COM object of type \u2018System.__ComObject\u2019 to class type System.Windows.Forms.UserControl\u201d) showing toolwindow</a></p>\n\n<p>I'd suggest to get the full type name/assembly names/CLR of the types being cast. Adding a temporary reference to Microsoft.VisualBasic reference allows you to use Microsoft.VisualBasic.Information.TypeName(object) to get the actual type behind a __ComObject.</p>\n"}], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 40899107, "answer_count": 1, "score": 7, "last_activity_date": 1480543573, "creation_date": 1480535220, "question_id": 40896893, "link": "https://stackoverflow.com/questions/40896893/cleaning-up-commandbar-buttons", "title": "Cleaning up CommandBar buttons", "body": "<p>I have an issue with my COM add-in that has been dragging for months, and I can't figure out why.</p>\n\n<p>The <code>IDTExtensibility2</code> implementation has been peer reviewed by Carlos Quintero (the guy behind MZ-Tools) already, and deemed correct.</p>\n\n<p>Per his recommendations the <code>OnBeginShutdown</code> implementation sets a flag that's checked in <code>OnDisconnection</code>, to ensure <code>ShutdownAddIn</code> only runs once (some VBE host applications don't call <code>OnBeginShutdown</code>, that's why):</p>\n\n<pre><code>public void OnBeginShutdown(ref Array custom)\n{\n    _isBeginShutdownExecuted = true;\n    ShutdownAddIn();\n}\n</code></pre>\n\n<p>My add-in uses Ninject for DI/IoC, and my <code>ShutdownAddIn</code> method boils down to calling <code>Dispose</code> on the Ninject <code>IKernel</code> instance, and then releasing all COM objects with <code>Marshal.ReleaseComObject</code>:</p>\n\n<pre><code>private void ShutdownAddIn()\n{\n    if (_kernel != null)\n    {\n        _kernel.Dispose();\n        _kernel = null;\n    }\n    _ide.Release();\n    _isInitialized = false;\n}\n</code></pre>\n\n<p>I cannot think of an earlier time to run this code. Yet, when <code>Dispose</code> runs on my commandbar and menu wrappers, I'm getting an <code>InvalidCastException</code> in <code>StopEvents</code> when the commandbar/menus try to dismantle their controls:</p>\n\n<pre><code>public void HandleEvents()\n{\n    // register the unmanaged click events\n    ((Microsoft.Office.Core.CommandBarButton)Target).Click += Target_Click;\n}\n\npublic void StopEvents()\n{\n    // unregister the unmanaged click events\n    ((Microsoft.Office.Core.CommandBarButton)Target).Click -= Target_Click;\n}\n\npublic event EventHandler&lt;CommandBarButtonClickEventArgs&gt; Click;\nprivate void Target_Click(Microsoft.Office.Core.CommandBarButton ctrl, ref bool cancelDefault)\n{\n    // handle the unmanaged click events and fire a managed event for managed code to handle\n    var handler = Click;\n    if (handler == null)\n    {\n        return;\n    }\n    var args = new CommandBarButtonClickEventArgs(new CommandBarButton(ctrl));\n    handler.Invoke(this, args);\n    cancelDefault = args.Cancel;\n}\n</code></pre>\n\n<p>The <code>InvalidCastException</code> says that it can't cast to <code>IConnectionPoint</code> - and what I've found is that the reason for this is because when this code runs, my <code>Target</code> (the wrapped <code>__ComObject</code>) is gone already, and I'm left with an invalid pointer and a lingering reference to a COM object that no longer exists.</p>\n\n<p>If I catch all exceptions thrown during my teardown process (I have more exceptions stemming from the same root problem, when I try to <code>Delete</code> the buttons and menus), the host application closes but the host process remains - and then I have to kill it from <em>Task Manager</em>. This behavior is consistent with a memory leak caused by not-removed click handlers I think.</p>\n\n<hr>\n\n<p>Is there a more robust way I can deal with adding/removing event handlers for a <code>Microsoft.Office.Core.CommandBarButton</code> wrapper? Why would my wrapped COM objects be already \"gone\" when <code>OnBeginShutdown</code> runs, if I haven't released them yet?</p>\n"}, {"tags": ["c#", "string", "syntax", "settings", "stringcollection"], "answers": [{"comments": [{"owner": {"reputation": 623, "user_id": 7211268, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d89e0ff1ef10a21b96c7ba9f8dd0a3a2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/7211268/j-doe"}, "edited": false, "score": 0, "creation_date": 1480536631, "post_id": 40896905, "comment_id": 69008288, "body": "can you expand a bit on what you mean by &quot;You need to replace as string[] with your exact data type.&quot;. Isn&#39;t it string?"}, {"owner": {"reputation": 27104, "user_id": 3185569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177ae94ca98997a0ae4acd38db6ff47?s=128&d=identicon&r=PG&f=1", "display_name": "Zein Makki", "link": "https://stackoverflow.com/users/3185569/zein-makki"}, "reply_to_user": {"reputation": 623, "user_id": 7211268, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d89e0ff1ef10a21b96c7ba9f8dd0a3a2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/7211268/j-doe"}, "edited": false, "score": 0, "creation_date": 1480536825, "post_id": 40896905, "comment_id": 69008385, "body": "What is the exact type of your settings value ? Custom array of string ? Or a normal <code>StringCollection</code> ?"}, {"owner": {"reputation": 623, "user_id": 7211268, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d89e0ff1ef10a21b96c7ba9f8dd0a3a2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/7211268/j-doe"}, "edited": false, "score": 0, "creation_date": 1480537276, "post_id": 40896905, "comment_id": 69008612, "body": "Normal <code>StringCollection</code>"}, {"owner": {"reputation": 27104, "user_id": 3185569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177ae94ca98997a0ae4acd38db6ff47?s=128&d=identicon&r=PG&f=1", "display_name": "Zein Makki", "link": "https://stackoverflow.com/users/3185569/zein-makki"}, "reply_to_user": {"reputation": 623, "user_id": 7211268, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d89e0ff1ef10a21b96c7ba9f8dd0a3a2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/7211268/j-doe"}, "edited": false, "score": 0, "creation_date": 1480537923, "post_id": 40896905, "comment_id": 69008985, "body": "@J.Doe Do you have problems with the above edited answer ?"}, {"owner": {"reputation": 623, "user_id": 7211268, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d89e0ff1ef10a21b96c7ba9f8dd0a3a2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/7211268/j-doe"}, "edited": false, "score": 0, "creation_date": 1480538000, "post_id": 40896905, "comment_id": 69009026, "body": "error converting settings property to string collection :( Fixed it by removing properties so you&#39;re left with: <code>var prop = Properties.Settings.Default[&quot;meas&quot; + i] as System.Collections.Specialized.StringCollection</code>"}, {"owner": {"reputation": 27104, "user_id": 3185569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177ae94ca98997a0ae4acd38db6ff47?s=128&d=identicon&r=PG&f=1", "display_name": "Zein Makki", "link": "https://stackoverflow.com/users/3185569/zein-makki"}, "reply_to_user": {"reputation": 623, "user_id": 7211268, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d89e0ff1ef10a21b96c7ba9f8dd0a3a2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/7211268/j-doe"}, "edited": false, "score": 0, "creation_date": 1480538242, "post_id": 40896905, "comment_id": 69009145, "body": "@J.Doe I just tried the above code and it works. Are you sure you defined the system settings are <code>System.Collections.Specialized.StringCollection</code>.. Can you edit your question and show how do you define your settings ?"}, {"owner": {"reputation": 623, "user_id": 7211268, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d89e0ff1ef10a21b96c7ba9f8dd0a3a2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/7211268/j-doe"}, "edited": false, "score": 0, "creation_date": 1480538301, "post_id": 40896905, "comment_id": 69009188, "body": "Yup work for me now just the properties was throwing it off"}], "tags": [], "owner": {"reputation": 27104, "user_id": 3185569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177ae94ca98997a0ae4acd38db6ff47?s=128&d=identicon&r=PG&f=1", "display_name": "Zein Makki", "link": "https://stackoverflow.com/users/3185569/zein-makki"}, "is_accepted": true, "score": 2, "last_activity_date": 1480537957, "last_edit_date": 1480537957, "creation_date": 1480535264, "answer_id": 40896905, "question_id": 40896827, "link": "https://stackoverflow.com/questions/40896827/how-to-access-an-indexed-string-from-a-string-collection-saved-in-settings/40896905#40896905", "title": "How to access an indexed string from a string collection saved in settings?", "body": "<p>Maybe passing the item name and casting result to <code>StringCollection</code> would help:</p>\n\n<pre><code>for (int i = 19; i &gt;= 0; i--)\n{\n    var prop = Properties.Settings.Default[\"meas\" + i] as StringCollection;\n    prop[5] = \"\";\n}\nProperties.Settings.Default.Save();\n</code></pre>\n\n<p>You need to replace <code>as string[]</code> with your exact data type. But the above solves your issue of accessing the item by name.</p>\n"}], "owner": {"reputation": 623, "user_id": 7211268, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d89e0ff1ef10a21b96c7ba9f8dd0a3a2?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/7211268/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 40896905, "answer_count": 1, "score": 0, "last_activity_date": 1480537957, "creation_date": 1480534928, "question_id": 40896827, "link": "https://stackoverflow.com/questions/40896827/how-to-access-an-indexed-string-from-a-string-collection-saved-in-settings", "title": "How to access an indexed string from a string collection saved in settings?", "body": "<p>I have a few arrays of strings in my settings labelled meas1, meas2, meas3 etc...</p>\n\n<p>If I want to set the 6th item in each string collection to \"\", how would I do that? Below is my broken code of  failed attempt:</p>\n\n<pre><code>for (int i = 19; i &gt;= 0; i--)\n{\n    Properties.Settings.Default[\"meas\" + i][5] = \"\";\n}\n</code></pre>\n\n<p>I know I could do <code>Properties.Settings.Default.meas1[5] = \"\";</code> but I want I have a lot of meas that I need to do so a for loop would be preferred. </p>\n"}, {"tags": ["c#", "entity-framework", "linq", "sqlite", "entity-framework-6"], "comments": [{"owner": {"reputation": 18826, "user_id": 40868, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6191322922ecb29b38339db6d65f56ac?s=128&d=identicon&r=PG", "display_name": "Fredou", "link": "https://stackoverflow.com/users/40868/fredou"}, "edited": false, "score": 0, "creation_date": 1480535211, "post_id": 40896802, "comment_id": 69007541, "body": "what is the sql being generated? look online to see how to get the sql query"}, {"owner": {"reputation": 50111, "user_id": 1077309, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/yghA4.jpg?s=128&g=1", "display_name": "Sampath", "link": "https://stackoverflow.com/users/1077309/sampath"}, "edited": false, "score": 1, "creation_date": 1480536022, "post_id": 40896802, "comment_id": 69007980, "body": "can you show the records of db ? and are your referring correct db ?"}, {"owner": {"reputation": 41, "user_id": 7082238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb90ba65842e3f016c0409ebe840129?s=128&d=identicon&r=PG&f=1", "display_name": "Dessa", "link": "https://stackoverflow.com/users/7082238/dessa"}, "reply_to_user": {"reputation": 50111, "user_id": 1077309, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/yghA4.jpg?s=128&g=1", "display_name": "Sampath", "link": "https://stackoverflow.com/users/1077309/sampath"}, "edited": false, "score": 0, "creation_date": 1480537242, "post_id": 40896802, "comment_id": 69008593, "body": "@sampath <a href=\"http://i.imgur.com/s9N7WyP.png\" rel=\"nofollow noreferrer\">i.imgur.com/s9N7WyP.png</a>"}, {"owner": {"reputation": 50111, "user_id": 1077309, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/yghA4.jpg?s=128&g=1", "display_name": "Sampath", "link": "https://stackoverflow.com/users/1077309/sampath"}, "edited": false, "score": 0, "creation_date": 1480537650, "post_id": 40896802, "comment_id": 69008801, "body": "are your referring correct db ?"}, {"owner": {"reputation": 41, "user_id": 7082238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb90ba65842e3f016c0409ebe840129?s=128&d=identicon&r=PG&f=1", "display_name": "Dessa", "link": "https://stackoverflow.com/users/7082238/dessa"}, "reply_to_user": {"reputation": 50111, "user_id": 1077309, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/yghA4.jpg?s=128&g=1", "display_name": "Sampath", "link": "https://stackoverflow.com/users/1077309/sampath"}, "edited": false, "score": 0, "creation_date": 1480538593, "post_id": 40896802, "comment_id": 69009349, "body": "@sampath I only have one DB, and I am getting results from it, just not the entirety of the wanted results"}, {"owner": {"reputation": 3435, "user_id": 2324535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfNbQ.jpg?s=128&g=1", "display_name": "Karel Tamayo", "link": "https://stackoverflow.com/users/2324535/karel-tamayo"}, "edited": false, "score": 1, "creation_date": 1480539229, "post_id": 40896802, "comment_id": 69009716, "body": "I&#39;ve been unable to reproduce this behavior with a brand new DbContext and minimal data. I get the pokemon and the encounters as expected. There has to be something else in the code you&#39;re not showing. The code you&#39;ve posted is OK and the order in which you&#39;re doing the operation although is not optimal, does generate the same sql."}, {"owner": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1480539988, "post_id": 40896802, "comment_id": 69010121, "body": "Which database brand is this? Any information on SQL provider middleware?"}, {"owner": {"reputation": 41, "user_id": 7082238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb90ba65842e3f016c0409ebe840129?s=128&d=identicon&r=PG&f=1", "display_name": "Dessa", "link": "https://stackoverflow.com/users/7082238/dessa"}, "reply_to_user": {"reputation": 93252, "user_id": 861716, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb1a28030a6da0e72693e36c77eb3cd6?s=128&d=identicon&r=PG", "display_name": "Gert Arnold", "link": "https://stackoverflow.com/users/861716/gert-arnold"}, "edited": false, "score": 0, "creation_date": 1480540834, "post_id": 40896802, "comment_id": 69010603, "body": "@GertArnold It&#39;s SQLite."}, {"owner": {"reputation": 41, "user_id": 7082238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb90ba65842e3f016c0409ebe840129?s=128&d=identicon&r=PG&f=1", "display_name": "Dessa", "link": "https://stackoverflow.com/users/7082238/dessa"}, "reply_to_user": {"reputation": 3435, "user_id": 2324535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfNbQ.jpg?s=128&g=1", "display_name": "Karel Tamayo", "link": "https://stackoverflow.com/users/2324535/karel-tamayo"}, "edited": false, "score": 0, "creation_date": 1480541616, "post_id": 40896802, "comment_id": 69011000, "body": "@KarelTamayo Hmm, going thru this on Debug, the object is complete with a full list of encounters as it should be, so it looks like I&#39;ve been asking the wrong question.  The new question for me has to do with &quot;what happens to the rest of these encounters between &#39;return currentPokemon&#39; and receiving the JSONified object on my javascript frontend?&quot; (which definitely does have only one encounter listed) Thank you for your help."}, {"owner": {"reputation": 3435, "user_id": 2324535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfNbQ.jpg?s=128&g=1", "display_name": "Karel Tamayo", "link": "https://stackoverflow.com/users/2324535/karel-tamayo"}, "edited": false, "score": 0, "creation_date": 1480544344, "post_id": 40896802, "comment_id": 69012296, "body": "@Dessa yeap. That in fact is another question. Your&#39;e welcome."}], "answers": [{"comments": [{"owner": {"reputation": 18826, "user_id": 40868, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6191322922ecb29b38339db6d65f56ac?s=128&d=identicon&r=PG", "display_name": "Fredou", "link": "https://stackoverflow.com/users/40868/fredou"}, "edited": false, "score": 0, "creation_date": 1480535130, "post_id": 40896861, "comment_id": 69007496, "body": "first or default would be done on the pokemon result, not the encounter"}, {"owner": {"reputation": 41, "user_id": 7082238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb90ba65842e3f016c0409ebe840129?s=128&d=identicon&r=PG&f=1", "display_name": "Dessa", "link": "https://stackoverflow.com/users/7082238/dessa"}, "edited": false, "score": 0, "creation_date": 1480535423, "post_id": 40896861, "comment_id": 69007657, "body": "What Fredou said.  Omitting <code>.FirstOrDefault()</code> just returns an array of length 1 of Pokemon, which is pointless, because I&#39;m only ever looking to get 1 Pokemon.  As for what I&#39;m looking for, It&#39;s a single pokemon with a list of all associated encounters for that pokemon.  In plain english, I want to ask &quot;Who is pokemon #10&quot; and get &quot;Pokemon 10 is Caterpie, and you can find Caterpie in the following places: (list of places).&quot;  Adding <code>.ToList()</code> at the end of this results in a list of encounters, but no Pokemon."}, {"owner": {"reputation": 7852, "user_id": 1097123, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93d48a626680f755c5464741d9897e78?s=128&d=identicon&r=PG", "display_name": "kimbaudi", "link": "https://stackoverflow.com/users/1097123/kimbaudi"}, "edited": false, "score": 0, "creation_date": 1480535518, "post_id": 40896861, "comment_id": 69007705, "body": "How about var currentPokemon = _context.Pokemon                                      .Where(mon =&gt; mon.Id == id)                                      .Include(mon =&gt; mon.Encounters)                                      .FirstOrDefault().Select(p =&gt; p.Encounters);"}, {"owner": {"reputation": 1990, "user_id": 4317297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c23b4c8f841aa661a28391aec996660b?s=128&d=identicon&r=PG&f=1", "display_name": "Riwen", "link": "https://stackoverflow.com/users/4317297/riwen"}, "edited": false, "score": 0, "creation_date": 1480535865, "post_id": 40896861, "comment_id": 69007901, "body": "You cannot call <code>.Select()</code> on a Pokemon object which was returned by <code>.FirstOrDefault()</code>"}, {"owner": {"reputation": 7852, "user_id": 1097123, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93d48a626680f755c5464741d9897e78?s=128&d=identicon&r=PG", "display_name": "kimbaudi", "link": "https://stackoverflow.com/users/1097123/kimbaudi"}, "reply_to_user": {"reputation": 18826, "user_id": 40868, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6191322922ecb29b38339db6d65f56ac?s=128&d=identicon&r=PG", "display_name": "Fredou", "link": "https://stackoverflow.com/users/40868/fredou"}, "edited": false, "score": 0, "creation_date": 1480536177, "post_id": 40896861, "comment_id": 69008056, "body": "@Fredou and @Riwen - You&#39;re right. Now that I think about it, <code>var currentPokemon = _context.Pokemon.Include(mon =&gt; mon.Encounters).FirstOrDefault(p =&gt; p.Id = id);</code> should return the first Pokemon with a list of Encounters. you should be able to access the Encounters using <code>currentPokemon.Encounters</code>. Correct?"}], "tags": [], "owner": {"reputation": 7852, "user_id": 1097123, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93d48a626680f755c5464741d9897e78?s=128&d=identicon&r=PG", "display_name": "kimbaudi", "link": "https://stackoverflow.com/users/1097123/kimbaudi"}, "is_accepted": false, "score": 0, "last_activity_date": 1480535068, "creation_date": 1480535068, "answer_id": 40896861, "question_id": 40896802, "link": "https://stackoverflow.com/questions/40896802/ef6-linq-query-include-only-returning-first-entry-of-child-table/40896861#40896861", "title": "EF6 Linq Query .Include only returning first entry of child table", "body": "<p>I think its because you are calling <code>.FirstOrDefault()</code>, which is only getting the first item. Can you omit that and add <code>.ToList()</code>? Also, <code>var currentPokemon</code> doesn't seem like a good variable name. You said you want a list of Encounters, right? How about <code>var pokemonEncounters</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 797, "user_id": 4738253, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/728785693886282/picture?type=large", "display_name": "Douglas Gandini", "link": "https://stackoverflow.com/users/4738253/douglas-gandini"}, "is_accepted": false, "score": 0, "last_activity_date": 1480542013, "creation_date": 1480542013, "answer_id": 40898727, "question_id": 40896802, "link": "https://stackoverflow.com/questions/40896802/ef6-linq-query-include-only-returning-first-entry-of-child-table/40898727#40898727", "title": "EF6 Linq Query .Include only returning first entry of child table", "body": "<p>I think that the problem is the way that you set the relationship using ForeignKey and InverseProperty.</p>\n\n<p>Try to rewrite to something like:</p>\n\n<pre><code>[Table(\"Pokemon\")]\npublic class Pokemon\n{\n    public int Id { get; set; }\n    public string Name { get; set; }\n\n    [InverseProperty(\"Pokemon\")]\n    public ICollection&lt;Encounter&gt; Encounters { get; set; }\n\n}\n\n[Table(\"Enconters\")]\npublic class Encounter\n{\n    public int Id { get; set; }\n\n    public int PokemonId { get; set; }\n\n    [ForeignKey(\"PokemonId\")]\n    public Pokemon Pokemon { get; set; }\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 7082238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb90ba65842e3f016c0409ebe840129?s=128&d=identicon&r=PG&f=1", "display_name": "Dessa", "link": "https://stackoverflow.com/users/7082238/dessa"}, "edited": false, "score": 0, "creation_date": 1480543071, "post_id": 40898773, "comment_id": 69011744, "body": "Yep, found a json serialization error in the output."}, {"owner": {"reputation": 41, "user_id": 7082238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb90ba65842e3f016c0409ebe840129?s=128&d=identicon&r=PG&f=1", "display_name": "Dessa", "link": "https://stackoverflow.com/users/7082238/dessa"}, "edited": false, "score": 0, "creation_date": 1480609107, "post_id": 40898773, "comment_id": 69043122, "body": "Okay, so the issue was that the JSON serializer detected a self-referencing loop (because Pokemon referred to Encounters, and Encounters referred back to pokemon) and threw an error in the Debug output (which I missed repeatedly) to avoid going into an infinite loop.  The solution to THIS issue is here:  <a href=\"http://stackoverflow.com/questions/17313632/self-referencing-loop-detected-getting-back-data-from-webapi-to-the-browser\" title=\"self referencing loop detected getting back data from webapi to the browser\">stackoverflow.com/questions/17313632/&hellip;</a>"}], "tags": [], "owner": {"reputation": 41, "user_id": 7082238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb90ba65842e3f016c0409ebe840129?s=128&d=identicon&r=PG&f=1", "display_name": "Dessa", "link": "https://stackoverflow.com/users/7082238/dessa"}, "is_accepted": false, "score": 0, "last_activity_date": 1480542206, "creation_date": 1480542206, "answer_id": 40898773, "question_id": 40896802, "link": "https://stackoverflow.com/questions/40896802/ef6-linq-query-include-only-returning-first-entry-of-child-table/40898773#40898773", "title": "EF6 Linq Query .Include only returning first entry of child table", "body": "<p>My apologies, I've been looking to the wrong places for my answer.  After stepping through this in a debugger, I can see that my Pokemon query does indeed return the desired result:  A pokemon with many encounters attached.  My problem seems to be elsewhere (specifically: the JSONified object I'm seeing come through to my web front-end truncates the encounters array to contain only the first result).</p>\n\n<p>I'll post a new question with the correct problem and link to it from here when it's figured out.</p>\n"}], "owner": {"reputation": 41, "user_id": 7082238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cb90ba65842e3f016c0409ebe840129?s=128&d=identicon&r=PG&f=1", "display_name": "Dessa", "link": "https://stackoverflow.com/users/7082238/dessa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 910, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1480542206, "creation_date": 1480534837, "last_edit_date": 1480540981, "question_id": 40896802, "link": "https://stackoverflow.com/questions/40896802/ef6-linq-query-include-only-returning-first-entry-of-child-table", "title": "EF6 Linq Query .Include only returning first entry of child table", "body": "<p>I would like to retrieve a list of Encounters for a Given Pokemon, as a Pokemon can be encountered in many places, so I've been trying many variants of</p>\n\n<pre><code>var currentPokemon = _context.Pokemon\n                                     .Where(mon =&gt; mon.Id == id)\n                                     .Include(mon =&gt; mon.Encounters)\n                                     .FirstOrDefault();\n</code></pre>\n\n<p>With the result being a Pokemon object with all of the relevant data, but only the FIRST encounter being retrieved and put into a collection resulting in this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wQv2w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wQv2w.png\" alt=\"enter image description here\"></a></p>\n\n<p>Looking at the database, there are about 20 encounters for caterpie, and I'd like access to all of them, but only ever just get the one.</p>\n\n<p>What the Pokemon class looks like (irrelevant fields omitted):</p>\n\n<pre><code>[Table(\"pokemon\")]\npublic partial class Pokemon {\n    public Pokemon()\n    {\n        Encounters = new HashSet&lt;Encounters&gt;();\n    }\n    [Column(\"id\")]\n    public long Id { get; set; }\n    [Required]\n    [Column(\"identifier\", TypeName = \"VARCHAR(79)\")]\n    public string Identifier { get; set; }\n    .\n    .\n    .\n\n    [InverseProperty(\"Pokemon\")]\n    public virtual ICollection&lt;Encounters&gt; Encounters { get; set; }\n }\n</code></pre>\n\n<p>What Encounters looks like:</p>\n\n<pre><code>public partial class Encounters {\n    .\n    .\n    .\n    [ForeignKey(\"PokemonId\")]\n    [InverseProperty(\"Encounters\")]\n    public virtual Pokemon Pokemon { get; set; }\n}\n</code></pre>\n\n<p><strong>Db data :</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/dmtc4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dmtc4.png\" alt=\"enter image description here\"></a></p>\n\n<p>What am I misunderstanding here?</p>\n"}, {"tags": ["c#", "windows", "file"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7181475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z-zmn70aqgQ/AAAAAAAAAAI/AAAAAAAAARI/aKaAlHUPaBk/photo.jpg?sz=128", "display_name": "Hyblocker", "link": "https://stackoverflow.com/users/7181475/hyblocker"}, "edited": false, "score": 0, "creation_date": 1520501149, "post_id": 40896835, "comment_id": 85344269, "body": "Oh. That&#39;s embarrasing"}], "tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": true, "score": 6, "last_activity_date": 1480534959, "creation_date": 1480534959, "answer_id": 40896835, "question_id": 40896767, "link": "https://stackoverflow.com/questions/40896767/system-io-ioexception/40896835#40896835", "title": "System.IO.IOException", "body": "<p>That's because the second argument in <a href=\"https://msdn.microsoft.com/en-us/library/9706cfs5(v=vs.110).aspx\" rel=\"noreferrer\">File.Copy</a> is the destination <em>file path</em> not the destination <em>folder path</em>.</p>\n\n<p>You can construct the destination file name from your input folder like this:</p>\n\n<pre><code>File.Copy(srcPath, \n    Path.Combine(landscapebox.Text, Path.GetFileName(srcPath)), true);\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7181475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-z-zmn70aqgQ/AAAAAAAAAAI/AAAAAAAAARI/aKaAlHUPaBk/photo.jpg?sz=128", "display_name": "Hyblocker", "link": "https://stackoverflow.com/users/7181475/hyblocker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 40896835, "answer_count": 1, "score": 0, "last_activity_date": 1480534959, "creation_date": 1480534735, "last_edit_date": 1480534945, "question_id": 40896767, "link": "https://stackoverflow.com/questions/40896767/system-io-ioexception", "title": "System.IO.IOException", "body": "<p>I trying to copy a file from a temporary directory to a folder which a user chooses. I am using C#, and the folder that I'm using is empty.</p>\n\n<p>The code i'm using is:</p>\n\n<pre><code>File.Copy(srcPath, landscapebox.Text, true);\n</code></pre>\n\n<p><code>srcPath</code> is a temporary folder</p>\n\n<p><code>landscapebox</code> is a text box which will have a directory inputted into it. It should look like:</p>\n\n<pre><code>\"C:\\Users\\####\\Folder\\Folder\"\n</code></pre>\n\n<p>But instead I get:</p>\n\n<pre><code>An unhandled exception of type 'System.IO.IOException' occurred in mscorlib.dll\n\nAdditional information: The target file \"C:\\Users\\###\\Desktop\\####\\TestFolder\" is a directory, not a file.\n</code></pre>\n\n<p>Help! I don't know what I'm doing wrong!</p>\n"}, {"tags": ["c#", "wpf", "xaml", "tabcontrol"], "comments": [{"owner": {"reputation": 189551, "user_id": 5233410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XAODw.png?s=128&g=1", "display_name": "Nkosi", "link": "https://stackoverflow.com/users/5233410/nkosi"}, "edited": false, "score": 0, "creation_date": 1480536167, "post_id": 40896760, "comment_id": 69008051, "body": "Set the selected index to the index of the newly created tab. Show how you add the tab to the control. after adding it. get it&#39;s index and then set the index of the tabcontrol to that"}, {"owner": {"reputation": 4163, "user_id": 3968276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294d8aafc7c28a0bae99df972396cf73?s=128&d=identicon&r=PG", "display_name": "Petter Hesselberg", "link": "https://stackoverflow.com/users/3968276/petter-hesselberg"}, "edited": false, "score": 0, "creation_date": 1481277927, "post_id": 40896760, "comment_id": 69322219, "body": "Hint: StackOverflow posts support images. Using that feature saves one click for the people who might help you."}], "owner": {"reputation": 5, "user_id": 6000298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d900a3df0796f3f8305689daef986c57?s=128&d=identicon&r=PG&f=1", "display_name": "RainMan", "link": "https://stackoverflow.com/users/6000298/rainman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485003199, "creation_date": 1480534718, "last_edit_date": 1485003199, "question_id": 40896760, "link": "https://stackoverflow.com/questions/40896760/xaml-make-newly-created-tab-selected-by-default", "title": "XAML Make newly created tab selected by default?", "body": "<p>Within my main window when I create a new table the tab is not selected. Because of this the view does not display until I select my tab.</p>\n\n<p>Here is an image of the newly created tab after I click the view report button. Below is the content template i am using.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DuMUr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DuMUr.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>&lt;DataTemplate x:Key=\"ReportContentTemplate\"&gt;\n    &lt;TabControl Margin=\"4\" IsSynchronizedWithCurrentItem=\"True\" ItemsSource=\"{Binding}\"&gt;\n        &lt;TabControl.ItemTemplate&gt;\n            &lt;DataTemplate&gt;\n                &lt;DockPanel&gt;\n                    &lt;ContentPresenter Content=\"{Binding Path=DisplayName}\" VerticalAlignment=\"Center\"&gt;&lt;/ContentPresenter&gt;\n                    &lt;Button Content=\"X\" Command=\"{Binding Path=CloseCommand}\" Cursor=\"Hand\" Height=\"16\" Width=\"16\" Margin=\"4,0,0,0\" FontWeight=\"Bold\" FontFamily=\"Courier\" FontSize=\"9\" DockPanel.Dock=\"Right\"/&gt;\n                &lt;/DockPanel&gt;\n            &lt;/DataTemplate&gt;\n        &lt;/TabControl.ItemTemplate&gt;\n    &lt;/TabControl&gt;\n&lt;/DataTemplate&gt;\n</code></pre>\n"}, {"tags": ["c#", "xaml", "user-controls", "uwp"], "answers": [{"tags": [], "owner": {"reputation": 14820, "user_id": 5506161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iLSYt.jpg?s=128&g=1", "display_name": "Jay Zuo", "link": "https://stackoverflow.com/users/5506161/jay-zuo"}, "is_accepted": false, "score": 0, "last_activity_date": 1480583361, "creation_date": 1480583361, "answer_id": 40906501, "question_id": 40896755, "link": "https://stackoverflow.com/questions/40896755/horizontalsnappointstype-in-uwp-scrollviewer-usercontrol-not-set/40906501#40906501", "title": "HorizontalSnapPointsType in UWP ScrollViewer UserControl not set", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.scrollviewer.horizontalsnappointstype.aspx\" rel=\"nofollow noreferrer\">ScrollViewer.HorizontalSnapPointsType property</a> declares how manipulation behavior reacts to the snap points along the horizontal axis. And as it is declared in the <strong>Remarks</strong>, this property works for panning actions:</p>\n\n<blockquote>\n  <p>For panning actions, there are often natural stopping places. Snap points provide a way to indicate where these places are. Then, when a user swipes, the manipulation result favors that natural point using behavior as expressed by a <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.snappointstype.aspx\" rel=\"nofollow noreferrer\"><strong>SnapPointsType</strong></a> value.</p>\n</blockquote>\n\n<p>More specifically, this property applies in Touch mode. Ref the \"Panning behaviors\" section of <a href=\"https://msdn.microsoft.com/en-us/windows/uwp/input-and-devices/guidelines-for-panning\" rel=\"nofollow noreferrer\">Guidelines for panning</a>:</p>\n\n<blockquote>\n  <p>Panning with the swipe gesture introduces inertia behavior into the interaction when the touch contact is lifted. With inertia, the content continues to pan until some distance threshold is reached without direct input from the user. Use snap points to modify this inertia behavior.</p>\n</blockquote>\n\n<p>However, in you code, you've disabled horizontal scroll and used buttons to scroll, so snap points won't work and setting <code>HorizontalSnapPointsType</code> property won't have any  effect.</p>\n"}], "owner": {"reputation": 3, "user_id": 4817028, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/b3b1e8529b0f3105129aec0a52c5e386?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Davidson", "link": "https://stackoverflow.com/users/4817028/jason-davidson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 361, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480583361, "creation_date": 1480534709, "question_id": 40896755, "link": "https://stackoverflow.com/questions/40896755/horizontalsnappointstype-in-uwp-scrollviewer-usercontrol-not-set", "title": "HorizontalSnapPointsType in UWP ScrollViewer UserControl not set", "body": "<p>I've created a UserControl that contains a ScrollViewer, a StackPanel and two buttons. I've disabled the horizontal scroll bar and want to use the buttons to scroll. But when I set HorizontalSnapPointsType inside of the control it doesn't work. If I add the ScrollViewer directly into my main xaml the property is set. The other properties like HorizontalScrollBarVisibility and HorizontalScrollMode are set properly so I'm not sure what the issue is. I've included xaml below.</p>\n\n<pre><code>&lt;UserControl\nx:Class=\"TestApp.Controls.CarouselScrollViewer\"\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nxmlns:local=\"using:TestApp.Controls\"\nxmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\nxmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\nmc:Ignorable=\"d\"\nd:DesignHeight=\"300\"\nd:DesignWidth=\"400\"&gt;\n\n&lt;Grid&gt;\n    &lt;ScrollViewer x:Name=\"ScrollViewer\"\n            HorizontalScrollBarVisibility=\"Hidden\" \n            HorizontalScrollMode=\"Disabled\"\n            VerticalScrollBarVisibility=\"Hidden\"\n            VerticalScrollMode=\"Disabled\"\n            HorizontalSnapPointsType=\"Mandatory\"&gt;\n        &lt;ContentPresenter x:Name=\"Content\" Content=\"{x:Bind ScrollViewerContent}\" /&gt;\n    &lt;/ScrollViewer&gt;\n    &lt;Button VerticalAlignment=\"Center\" HorizontalAlignment=\"Left\" Content=\"LEFT\" Background=\"White\" Click=\"LeftButton_OnClick\" Name=\"BtnLeft\"/&gt;\n    &lt;Button VerticalAlignment=\"Center\" HorizontalAlignment=\"Right\" Content=\"RIGHT\" Background=\"White\" Click=\"RightButton_OnClick\" Name=\"BtnRight\"/&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n\n<p>And then the xaml that's calling the control.</p>\n\n<pre><code>&lt;Page\nx:Class=\"TestApp.MainPage\"\nxmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\nxmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\nxmlns:local=\"using:TestApp\"\nxmlns:controls=\"using:TestApp.Controls\"\nxmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\nxmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\nmc:Ignorable=\"d\"&gt;\n\n&lt;Grid Background=\"{ThemeResource ApplicationPageBackgroundThemeBrush}\"&gt;\n    &lt;controls:CarouselScrollViewer SegmentWidth=\"400\"&gt;\n        &lt;controls:CarouselScrollViewer.ScrollViewerContent&gt;\n            &lt;StackPanel Orientation=\"Horizontal\"&gt;\n                &lt;Image Source=\"Assets/cole_anne.png\" Height=\"300\" Width=\"400\" Stretch=\"UniformToFill\" Margin=\"5\" /&gt;\n                &lt;Image Source=\"Assets/icecream.JPG\" Height=\"300\" Width=\"400\" Stretch=\"UniformToFill\" Margin=\"5\" /&gt;\n                &lt;Image Source=\"Assets/jibby_hotdog.png\" Height=\"300\" Width=\"400\" Stretch=\"UniformToFill\" Margin=\"5\" /&gt;\n                &lt;Image Source=\"Assets/andy_courtney_norah.png\" Height=\"300\" Width=\"400\" Stretch=\"UniformToFill\" Margin=\"5\" /&gt;\n                &lt;Image Source=\"Assets/boating.JPG\" Height=\"300\" Width=\"400\" Stretch=\"UniformToFill\" Margin=\"5\" /&gt;\n                &lt;Image Source=\"Assets/dev.jpg\" Height=\"300\" Width=\"400\" Stretch=\"UniformToFill\" Margin=\"5\" /&gt;\n                &lt;Image Source=\"Assets/moir_crab.jpg\" Height=\"300\" Width=\"400\" Stretch=\"UniformToFill\" Margin=\"5\" /&gt;\n                &lt;Image Source=\"Assets/MoirJudLindsayIlgaboating.jpg\" Height=\"300\" Width=\"400\" Stretch=\"UniformToFill\" Margin=\"5\" /&gt;\n            &lt;/StackPanel&gt;\n        &lt;/controls:CarouselScrollViewer.ScrollViewerContent&gt;\n    &lt;/controls:CarouselScrollViewer&gt;\n&lt;/Grid&gt;\n</code></pre>\n\n<p></p>\n"}, {"tags": ["c#", "pdf", "webbrowser-control", "32bit-64bit"], "comments": [{"owner": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1480535019, "post_id": 40896746, "comment_id": 69007444, "body": "Have you installed all updates? Also, make sure the latest version of Adobe Reader is installed and includes support for 64 bit <a href=\"https://support.microsoft.com/en-us/kb/2935492\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/2935492</a>"}, {"owner": {"reputation": 285, "user_id": 3718361, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/79Rls.jpg?s=128&g=1", "display_name": "Deetz", "link": "https://stackoverflow.com/users/3718361/deetz"}, "reply_to_user": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "edited": false, "score": 0, "creation_date": 1480536315, "post_id": 40896746, "comment_id": 69008129, "body": "We are not using Adobe Reader.  We are using Acrobat DC Pro. I couldn&#39;t locate a 64 bit version."}], "answers": [{"tags": [], "owner": {"reputation": 285, "user_id": 3718361, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/79Rls.jpg?s=128&g=1", "display_name": "Deetz", "link": "https://stackoverflow.com/users/3718361/deetz"}, "is_accepted": true, "score": 0, "last_activity_date": 1480542084, "creation_date": 1480542084, "answer_id": 40898748, "question_id": 40896746, "link": "https://stackoverflow.com/questions/40896746/cannot-open-pdf-document-from-c-webbrowser-control/40898748#40898748", "title": "Cannot open PDF document from C# webbrowser control", "body": "<p>It was indeed the architecture.  I've built it as 32 bit and it works beautifully.</p>\n"}], "owner": {"reputation": 285, "user_id": 3718361, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/79Rls.jpg?s=128&g=1", "display_name": "Deetz", "link": "https://stackoverflow.com/users/3718361/deetz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 40898748, "answer_count": 1, "score": 0, "last_activity_date": 1480542084, "creation_date": 1480534664, "last_edit_date": 1480539639, "question_id": 40896746, "link": "https://stackoverflow.com/questions/40896746/cannot-open-pdf-document-from-c-webbrowser-control", "title": "Cannot open PDF document from C# webbrowser control", "body": "<p>I have a SharePoint site with a document library, which opens pdf's in Adobe Acrobat (in Internet Explorer).  I would like to have the same functionality in a C# <code>WebBrowser</code> control, but when I click on the link to the document, I get the message:</p>\n\n<blockquote>\n  <p>There is a problem with adobe acrobat / reader. if it is running, please exit and try again. (9:9).</p>\n</blockquote>\n\n<p>I've searched and several people have had the same problem, which they blamed on building with mixed architecture, and claimed building in 32 bit would fix it.</p>\n\n<p>If at all possible though, I need to have both 32 and 64 bit fuctionality.  Is there any way to get this to work?</p>\n"}, {"tags": ["c#", "web-services", "soap", "service", "soaphttpclientprotocol"], "comments": [{"owner": {"reputation": 11204, "user_id": 1236217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vZwn9.png?s=128&g=1", "display_name": "Namphibian", "link": "https://stackoverflow.com/users/1236217/namphibian"}, "edited": false, "score": 0, "creation_date": 1480552637, "post_id": 40896740, "comment_id": 69015250, "body": "Just moving my comment to an answer. See below."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4566281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1769bc6c058b5eb009e4834aecdc6f62?s=128&d=identicon&r=PG&f=1", "display_name": "Samurai2083", "link": "https://stackoverflow.com/users/4566281/samurai2083"}, "edited": false, "score": 0, "creation_date": 1480728271, "post_id": 40900895, "comment_id": 69097856, "body": "I appreciate your comment and the information you provided here. I do understand that the dynamic between a SOAP server and client is, and should be, conformed to a contract, it doesn&#39;t adhere to the design I&#39;m trying to implement. At the end of the day, my intent is to provide a front-end interface for admins to &quot;set-up&quot; the contract properties needed to communicate with a variety of 3rd party entities. I&#39;m looking for the ability to administrate a service contract through a front-end interface so changes down the road won&#39;t require time from a developer to change and compile contracts."}, {"owner": {"reputation": 83, "user_id": 4566281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1769bc6c058b5eb009e4834aecdc6f62?s=128&d=identicon&r=PG&f=1", "display_name": "Samurai2083", "link": "https://stackoverflow.com/users/4566281/samurai2083"}, "edited": false, "score": 0, "creation_date": 1480728984, "post_id": 40900895, "comment_id": 69097965, "body": "Our clients require the portals we provide to them to communicate with 3rd party services. The forms filled out on our portals are sent to these 3rd party services via SOAP. The idea is for our portals to be unconcerned with who or what these other services are, trusting that the administration side will properly construct service profiles that correctly establish the contract rules. Then, when a form is submitted, the backend will build the contract with the necessary models filled with the form data, then submitted to the service. That is why &#39;object&#39; is needed. Nothing is strongly typed."}, {"owner": {"reputation": 11204, "user_id": 1236217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vZwn9.png?s=128&g=1", "display_name": "Namphibian", "link": "https://stackoverflow.com/users/1236217/namphibian"}, "reply_to_user": {"reputation": 83, "user_id": 4566281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1769bc6c058b5eb009e4834aecdc6f62?s=128&d=identicon&r=PG&f=1", "display_name": "Samurai2083", "link": "https://stackoverflow.com/users/4566281/samurai2083"}, "edited": false, "score": 1, "creation_date": 1480731306, "post_id": 40900895, "comment_id": 69098311, "body": "You need an ESB server that is exactly what it does. Forgot dynamic think decoupled. Go research ESB&#39;s and Enterprise Integration Patterns. This problem has been solved and there is open source and commercial products available that will do what you are trying to achieve. Will edit my answer with details once my flu subsides. I love and hate my kids..."}, {"owner": {"reputation": 11204, "user_id": 1236217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vZwn9.png?s=128&g=1", "display_name": "Namphibian", "link": "https://stackoverflow.com/users/1236217/namphibian"}, "reply_to_user": {"reputation": 83, "user_id": 4566281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1769bc6c058b5eb009e4834aecdc6f62?s=128&d=identicon&r=PG&f=1", "display_name": "Samurai2083", "link": "https://stackoverflow.com/users/4566281/samurai2083"}, "edited": false, "score": 1, "creation_date": 1480731385, "post_id": 40900895, "comment_id": 69098323, "body": "Also search for the . Net equivalent of Apache cxf. I do this in Java a lot but had a lesser fun time in .Net in certain areas."}], "tags": [], "owner": {"reputation": 11204, "user_id": 1236217, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vZwn9.png?s=128&g=1", "display_name": "Namphibian", "link": "https://stackoverflow.com/users/1236217/namphibian"}, "is_accepted": true, "score": 1, "last_activity_date": 1480553813, "creation_date": 1480553813, "answer_id": 40900895, "question_id": 40896740, "link": "https://stackoverflow.com/questions/40896740/how-can-i-create-a-soap-request-from-an-object-type/40900895#40900895", "title": "How can I create a SOAP request from an object type?", "body": "<p>Your description of the system you are implementing is not quite clear to me. You mention that you will send \n\"dynamic\" requests to a SOAP server? Or are you creating some service with \"dynamic\" operations. Those details are a little muddy for me however I scribbled down some thoughts.</p>\n\n<p>In short you are opening a world of pain for yourself if you want to do this in SOAP. REST might be a better fit as it does not have a WSDL but if you are using WADL, RAML and these emerging standards your milage may vary. I am not going to try and even answer the technical question for you but try to make you see why this is a one way ticket to maintenance hell. </p>\n\n<p>This implementation really breaks SOA concepts(particularly Standardized service contract), which might not be applicable in your case as just implementing a dynamic WSDL with unknown content disqualifies the architecture as NOT SOA. This also contradicts the whole point of having a WSDL. The WSDL is a interface definition in XML. Thus dynamic service would require a dynamic interface which then qualifies it as NOT an interface. Thus when you use the object type as a parameter the WSDL and interface does not match up. </p>\n\n<p>When other system consume your SOAP services they will do so based on a published WSDL. If the WSDL changes their programs will break as the definition or WSDL does not match the data types they have generated. A service that works on HTTP and gets requests and sends replies and that does not have a WSDL is NOT a SOAP service it is a XML based service using HTTP ports. They are fundamentally different. Does your service provider i.e. SOAP service you are requesting data from not have a WSDL? If not these are not the droids you are looking for :)</p>\n\n<p>An interface is a agreed upon contract that applications can use to query  a service. Essentially you are talking about structured vs unstructured data objects(at least at run time). </p>\n\n<p>If you want this type of pattern you need to look at a publish subscribe architecture something like MQTT which is lightweight to use, or another example would be JMS with topics.</p>\n\n<p>If you are consuming a web service which you mention there WILL be a WSDL which your .Net application can use to generate the datatypes and associated C# classes. The classes will include both the data being transmitted and the operations exposed on the service. </p>\n\n<p>In official SOAP worlds there is no such thing as a dynamic service as it breaks the whole paradigm of we agree as server and client to communicate via this form of XML during operations.</p>\n"}], "owner": {"reputation": 83, "user_id": 4566281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1769bc6c058b5eb009e4834aecdc6f62?s=128&d=identicon&r=PG&f=1", "display_name": "Samurai2083", "link": "https://stackoverflow.com/users/4566281/samurai2083"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1634, "favorite_count": 0, "accepted_answer_id": 40900895, "answer_count": 1, "score": 1, "last_activity_date": 1480553813, "creation_date": 1480534647, "last_edit_date": 1480535379, "question_id": 40896740, "link": "https://stackoverflow.com/questions/40896740/how-can-i-create-a-soap-request-from-an-object-type", "title": "How can I create a SOAP request from an object type?", "body": "<p>Let me first describe what my intention is, then go into my question.</p>\n\n<p>I\u2019m trying to build a system that communicates to a SOAP service where the SOAP request is somewhat unknown at runtime. Ultimately what I need to do is generate a SOAP request from unknown objects. I\u2019ll be dynamically creating objects from scratch with the appropriate attributes and properties, then pass that to my service \u201crequest\u201d method to be sent to the SOAP service. Here is the code I\u2019ve been working with and then the error I\u2019m receiving.</p>\n\n<p>SOAP Client:</p>\n\n<pre><code>/// &lt;summary&gt;\n/// GOSService proxy class\n/// &lt;/summary&gt;\n[DebuggerStepThroughAttribute()]\n[DesignerCategoryAttribute(\"code\")]\n[WebServiceBindingAttribute(Name = \"ServiceSoapBinding\", Namespace = \"service.domain.com\", ConformsTo = WsiProfiles.None)]\n[SoapRpcService(RoutingStyle = SoapServiceRoutingStyle.RequestElement)]\npublic partial class TestService : SoapHttpClientProtocol\n{\n    /// &lt;summary&gt;\n    /// Initializes a new instance of the TestService class.\n    /// &lt;/summary&gt;\n    public TestService()\n    {\n        this.Url = \"https://restsv01.domain.com/ServiceTest/services/TestService\";\n        ServicePointManager.Expect100Continue = true;\n        ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;\n        ServicePointManager.ServerCertificateValidationCallback = new RemoteCertificateValidationCallback(OnRemoteCertificateValidationCallback);\n    }\n\n    /// &lt;summary&gt;\n    /// Verifies the remote Secure Sockets Layer (SSL) certificate used for authentication.\n    /// &lt;/summary&gt;\n    /// &lt;param name=\"sender\"&gt;An object that contains state information for this validation.&lt;/param&gt;\n    /// &lt;param name=\"certificate\"&gt;The certificate used to authenticate the remote party.&lt;/param&gt;\n    /// &lt;param name=\"chain\"&gt;The chain of certificate authorities associated with the remote certificate.&lt;/param&gt;\n    /// &lt;param name=\"sslPolicyErrors\"&gt;One or more errors associated with the remote certificate.&lt;/param&gt;\n    /// &lt;returns&gt;A Boolean value that determines whether the specified certificate is accepted for authentication.&lt;/returns&gt;\n    private bool OnRemoteCertificateValidationCallback(Object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)\n    {\n        return true;\n    }\n\n    /// &lt;summary&gt;\n    /// \n    /// &lt;/summary&gt;\n    /// &lt;param name=\"order\"&gt;&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    [SoapRpcMethodAttribute(\"\", RequestNamespace = \"service.domain.com\", ResponseNamespace = \"service.domain.com\")]\n    [SampleSoap.LoggerSoapExtensionAttribute]\n    [return: SoapElementAttribute(\"requestReturn\")]\n    public object request(object parm)\n    {\n        object[] results = this.Invoke(\"request\", new object[] { parm });\n        return ((object)(results[0]));\n    }}\n</code></pre>\n\n<p>Test Model:\n(There won't be any pre-defined models, they will be dynamically generated. But for testing purposes, I'm using this model to test with)</p>\n\n<pre><code>    [SerializableAttribute()]\n    [DebuggerStepThroughAttribute()]\n    [DesignerCategoryAttribute(\"code\")]\n    [SoapTypeAttribute(Namespace = \"http://entity.domain.com\")]\n    public class ParentNode\n    {\n        private string nameField = \"1\";\n        [SoapElementAttribute(IsNullable = true)]\n        public string Name\n        {\n            get { return this.nameField; }\n            set { this.nameField = value; }\n        }\n    }\n</code></pre>\n\n<p>Test Call Code:</p>\n\n<pre><code>        Services.Soap.Models.ParentNode parent = new Services.Soap.Models.ParentNode();\n        parent.Name = \"John Doe\";\n        Services.Soap.TestService service = new Services.Soap.TestService();\n        object resp = service.request(parent);\n</code></pre>\n\n<p>When I run this code, an error occurs at this line:</p>\n\n<pre><code>object[] results = this.Invoke(\"request\", new object[] { parm });\n</code></pre>\n\n<p>This is the error:</p>\n\n<blockquote>\n  <p>The type Services.Soap.Models+ParentNode was not expected. Use the\n  XmlInclude or SoapInclude attribute to specify types that are not\n  known statically.</p>\n</blockquote>\n\n<p>Now, if I change the parameter of the service \u201crequest\u201d method to a strong type, the request builds fine and is passed to the SOAP service, like so.</p>\n\n<pre><code>public object request(ParentNode parm)\n</code></pre>\n\n<p>I\u2019ve tried probably 50 things to get this to work, including passing the Type as a parameter to the request method and creating a \u201cdynamic\u201d instance of the object to pass. </p>\n\n<pre><code>    public object request(object parm, Type t)\n    {\n        dynamic converted = Convert.ChangeType(parm, t);\n\n        object[] results = this.Invoke(\"request\", new object[] { converted });\n        return ((object)(results[0]));\n    } \n</code></pre>\n\n<p>This didn\u2019t work because \u201cconverted\u201d was still considered an object type.</p>\n\n<p>I\u2019ve also tried intercepting the soap envelope in the \u201cGetWriterForMessage\u201d method so I can build my own envelope, but I wasn\u2019t able to make use of that.</p>\n\n<p>So my question is, how can I get the SOAP request to build successfully with a parameter type of object? Is there maybe another approach I should take to make my architecture work correctly?</p>\n"}, {"tags": ["c#", "sql-server", "deployment", ".net-3.5"], "comments": [{"owner": {"reputation": 3136, "user_id": 1683270, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/E3XL5.jpg?s=128&g=1", "display_name": "ahmed abdelqader", "link": "https://stackoverflow.com/users/1683270/ahmed-abdelqader"}, "edited": false, "score": 1, "creation_date": 1480534589, "post_id": 40896698, "comment_id": 69007234, "body": "Check the connection string, and remote sql server connection."}, {"owner": {"reputation": 1, "user_id": 7232590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5437ea3cefc8b7e754a3c2d60b3e39?s=128&d=identicon&r=PG&f=1", "display_name": "SylvainJ", "link": "https://stackoverflow.com/users/7232590/sylvainj"}, "reply_to_user": {"reputation": 3136, "user_id": 1683270, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/E3XL5.jpg?s=128&g=1", "display_name": "ahmed abdelqader", "link": "https://stackoverflow.com/users/1683270/ahmed-abdelqader"}, "edited": false, "score": 0, "creation_date": 1480535267, "post_id": 40896698, "comment_id": 69007562, "body": "The connection string and remote server are the same with the EXE file on a network share or on a local drive. @ahmed abdelqader"}, {"owner": {"reputation": 3136, "user_id": 1683270, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/E3XL5.jpg?s=128&g=1", "display_name": "ahmed abdelqader", "link": "https://stackoverflow.com/users/1683270/ahmed-abdelqader"}, "edited": false, "score": 0, "creation_date": 1480535685, "post_id": 40896698, "comment_id": 69007800, "body": "what is the authentication mode ? is it windows, or SQL Server mixed mode ?"}, {"owner": {"reputation": 1, "user_id": 7232590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5437ea3cefc8b7e754a3c2d60b3e39?s=128&d=identicon&r=PG&f=1", "display_name": "SylvainJ", "link": "https://stackoverflow.com/users/7232590/sylvainj"}, "reply_to_user": {"reputation": 3136, "user_id": 1683270, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/E3XL5.jpg?s=128&g=1", "display_name": "ahmed abdelqader", "link": "https://stackoverflow.com/users/1683270/ahmed-abdelqader"}, "edited": false, "score": 0, "creation_date": 1480536941, "post_id": 40896698, "comment_id": 69008451, "body": "Using Windows Authentication @ahmed abdelqader"}, {"owner": {"reputation": 3136, "user_id": 1683270, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/E3XL5.jpg?s=128&g=1", "display_name": "ahmed abdelqader", "link": "https://stackoverflow.com/users/1683270/ahmed-abdelqader"}, "edited": false, "score": 0, "creation_date": 1480537322, "post_id": 40896698, "comment_id": 69008642, "body": "I think this is the issue, change its Authentication  to be mixed mode. waiting ur feedback."}, {"owner": {"reputation": 1, "user_id": 7232590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5437ea3cefc8b7e754a3c2d60b3e39?s=128&d=identicon&r=PG&f=1", "display_name": "SylvainJ", "link": "https://stackoverflow.com/users/7232590/sylvainj"}, "reply_to_user": {"reputation": 3136, "user_id": 1683270, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/E3XL5.jpg?s=128&g=1", "display_name": "ahmed abdelqader", "link": "https://stackoverflow.com/users/1683270/ahmed-abdelqader"}, "edited": false, "score": 0, "creation_date": 1480537678, "post_id": 40896698, "comment_id": 69008812, "body": "This is not the problem here. We are usingIntegratedSecurity = true here. Also, Windows authentication is working fine when the EXE is local."}], "owner": {"reputation": 1, "user_id": 7232590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5437ea3cefc8b7e754a3c2d60b3e39?s=128&d=identicon&r=PG&f=1", "display_name": "SylvainJ", "link": "https://stackoverflow.com/users/7232590/sylvainj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480536523, "creation_date": 1480534466, "last_edit_date": 1480536523, "question_id": 40896698, "link": "https://stackoverflow.com/questions/40896698/connecting-to-sql-server-from-exe-file-on-shared-drive", "title": "Connecting to SQL Server from EXE file on shared drive", "body": "<p>Our software uses a <code>SqlConnection</code> object to get data from SQL Server. It is running fine for many sites, but for one specific user - it cannot connect to the server. I get an exception:</p>\n\n<blockquote>\n  <p>A network-related or instance-specific error occurred while\n  establishing a connection to SQL Server.</p>\n</blockquote>\n\n<p>On this PC the executable file is located on a shared drive. If we copy the executable to a local drive (the desktop) and run it from there, the connection is successful.</p>\n\n<p>Here is what I use to connect to SQL Server:</p>\n\n<pre><code>System.Data.SqlClient.SqlConnectionStringBuilder builder = new System.Data.SqlClient.SqlConnectionStringBuilder();\n\nbuilder.DataSource = SQLServerName;\nbuilder.InitialCatalog = SQLDBName;\nbuilder.WorkstationID = SQLServerName;\nbuilder.PacketSize = 4096;\nbuilder.IntegratedSecurity = true;\nbuilder.PersistSecurityInfo = true;\nbuilder.ApplicationName = \"App\";\nbuilder.MultipleActiveResultSets = true;\n\nusing (SqlConnection myDbConn = new SqlConnection())\n{\n    myDbConn.ConnectionString = builder.ConnectionString;\n\n    try\n    {\n        myDbConn.Open();\n\n        if (myDbConn.State != System.Data.ConnectionState.Open)\n        {\n            myDbConn.Close();\n            return false;\n        }\n\n        myDbConn.Close();\n    }\n    catch (Exception e)\n    {\n        MessageBox.Show(e.Message);\n        myDbConn.Close();\n        return false;\n    }\n}\n\nreturn true;\n</code></pre>\n\n<p>We have this problem only for a specific user on a specific PC (running Windows 7). I can't figure why moving the program from a network drive to a local drive would change its behavior. I tried adding trust assemblies full control over the shared drive with no results.</p>\n"}, {"tags": ["c#", ".net"], "comments": [{"owner": {"reputation": 12853, "user_id": 2878550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvO6l.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2878550/dmitry"}, "edited": false, "score": 0, "creation_date": 1480534057, "post_id": 40896552, "comment_id": 69007006, "body": "Try to change the order of <code>.Select()</code> and <code>.Where()</code> calls and add <code>.FirstOrDefault()</code>: <code>return EnumerateDevices().Where(...).Select(...).FirstOrDefault()</code>"}, {"owner": {"reputation": 58863, "user_id": 1875256, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/no10d.jpg?s=128&g=1", "display_name": "Ehsan Sajjad", "link": "https://stackoverflow.com/users/1875256/ehsan-sajjad"}, "edited": false, "score": 1, "creation_date": 1480534099, "post_id": 40896552, "comment_id": 69007025, "body": "you need : <code>return EnumerateDevices().Where(x =&gt; x.Attributes.ProductId == devicePID).Select(x =&gt; x.Path)</code> but this will still not compile as your method return type is <code>string</code> not <code>IEnumerable&lt;string&gt;</code>"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1480535381, "post_id": 40896552, "comment_id": 69007634, "body": "read the linq chain from left to right."}, {"owner": {"reputation": 309, "user_id": 1686300, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/07035700acafeee6de9d4705a182ef55?s=128&d=identicon&r=PG", "display_name": "nobby", "link": "https://stackoverflow.com/users/1686300/nobby"}, "reply_to_user": {"reputation": 12853, "user_id": 2878550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvO6l.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2878550/dmitry"}, "edited": false, "score": 0, "creation_date": 1480535662, "post_id": 40896552, "comment_id": 69007784, "body": "@Dmitry Yes, as Alberto pointed out below, that was the issue. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1991, "user_id": 1592756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72037bf7577e9d669b41f7a7e1d02b82?s=128&d=identicon&r=PG", "display_name": "Josh Part", "link": "https://stackoverflow.com/users/1592756/josh-part"}, "edited": false, "score": 0, "creation_date": 1480534273, "post_id": 40896626, "comment_id": 69007106, "body": "There&#39;s still a problem here: OP&#39;s function returns a <code>string</code> but this code returns a collection of strings"}, {"owner": {"reputation": 7404, "user_id": 702048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9273917a7e0d4d2bb5cefd6a8bf27179?s=128&d=identicon&r=PG&f=1", "display_name": "Alberto Solano", "link": "https://stackoverflow.com/users/702048/alberto-solano"}, "reply_to_user": {"reputation": 1991, "user_id": 1592756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72037bf7577e9d669b41f7a7e1d02b82?s=128&d=identicon&r=PG", "display_name": "Josh Part", "link": "https://stackoverflow.com/users/1592756/josh-part"}, "edited": false, "score": 0, "creation_date": 1480534451, "post_id": 40896626, "comment_id": 69007166, "body": "@JoshPart Thanks for the remark! I was just editing the query, it should be fine now!"}, {"owner": {"reputation": 309, "user_id": 1686300, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/07035700acafeee6de9d4705a182ef55?s=128&d=identicon&r=PG", "display_name": "nobby", "link": "https://stackoverflow.com/users/1686300/nobby"}, "edited": false, "score": 1, "creation_date": 1480535624, "post_id": 40896626, "comment_id": 69007755, "body": "@Alberto Solano Thanks. that did it!"}], "tags": [], "owner": {"reputation": 7404, "user_id": 702048, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9273917a7e0d4d2bb5cefd6a8bf27179?s=128&d=identicon&r=PG&f=1", "display_name": "Alberto Solano", "link": "https://stackoverflow.com/users/702048/alberto-solano"}, "is_accepted": true, "score": 3, "last_activity_date": 1480534354, "last_edit_date": 1480534354, "creation_date": 1480534183, "answer_id": 40896626, "question_id": 40896552, "link": "https://stackoverflow.com/questions/40896552/syntax-to-conditionally-retrieve-list-member/40896626#40896626", "title": "Syntax to Conditionally Retrieve List Member", "body": "<p>That's because you want first the paths (a string collection), with the <code>Select()</code>, and then filtering your collection, with the <code>Where()</code>, where you don't have any <code>Attributes</code> property.</p>\n\n<p>Your LINQ query should apply first your filter and then select the path of the object you're looking for:</p>\n\n<pre><code>return EnumerateDevices().Where(x =&gt; x.Attributes.ProductId == devicePID).Select(x =&gt; x.Path).SingleOrDefault();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1200, "user_id": 3776432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ok5Z1.jpg?s=128&g=1", "display_name": "Aar&#243;nBC.", "link": "https://stackoverflow.com/users/3776432/aar%c3%b3nbc"}, "is_accepted": false, "score": 0, "last_activity_date": 1480535544, "creation_date": 1480535544, "answer_id": 40896979, "question_id": 40896552, "link": "https://stackoverflow.com/questions/40896552/syntax-to-conditionally-retrieve-list-member/40896979#40896979", "title": "Syntax to Conditionally Retrieve List Member", "body": "<p>Based on this part of your question:</p>\n\n<blockquote>\n  <p>if one of the devices matches my desired VID and PID, get and return\n  the full path to the device... but I can't seem to figure out the syntax to then return the path to <strong><em>that same matching device</em></strong>.</p>\n</blockquote>\n\n<p>You could change the method to something like this:</p>\n\n<pre><code>public static string IsConnected(string deviceVID, string devicePID)\n{\n   //This line will look for the desired device and return it. \n   //If there is no match device will be null.\n   var device = EnumerateDevices()\n            .FirstOrDefault(x =&gt; x.VID == deviceVID &amp;&amp; x.PID == devicePID);\n\n   return device != null ? device.Path : \"False\";\n}\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 1686300, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/07035700acafeee6de9d4705a182ef55?s=128&d=identicon&r=PG", "display_name": "nobby", "link": "https://stackoverflow.com/users/1686300/nobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 40896626, "answer_count": 2, "score": 1, "last_activity_date": 1480535544, "creation_date": 1480533853, "last_edit_date": 1480534119, "question_id": 40896552, "link": "https://stackoverflow.com/questions/40896552/syntax-to-conditionally-retrieve-list-member", "title": "Syntax to Conditionally Retrieve List Member", "body": "<p>I'm working with some open-source C# code for a USB HID library that I'm trying to modify. My C# (and OOP in general) are VERY rusty, so forgive the basic question. </p>\n\n<p>The premise is simple: check for enumerated HID devices, and if one of the devices matches my desired VID and PID, get and return the full path to the device. The first part (checking for a match) work fine, but I can't seem to figure out the syntax to then return the path to that same matching device. </p>\n\n<pre><code> public static string IsConnected(string deviceVID, string devicePID)\n {\n      if (EnumerateDevices().Any(x =&gt; x.VID == deviceVID &amp;&amp; x.PID == devicePID))   \n      {\n          return EnumerateDevices().Select(x =&gt; x.Path).Where(x =&gt; x.Attributes.ProductId == devicePID); \n      }\n      else\n      {  \n         return \"False\"; \n      }\n }\n</code></pre>\n\n<p>VS15 complains that \"'string' does not contain a definition for 'Attributes' and no extension method 'Attributes' accepting a first argument of type 'string' could be found\".</p>\n\n<p>I get this, looks like Where accepts ints only. Is there something else in the .NET framework Enumerable class that would work like I'd like? Or an easier way to do this?  </p>\n"}, {"tags": ["c#", "arrays", "x509certificate"], "answers": [{"comments": [{"owner": {"reputation": 456, "user_id": 1130841, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b493e949557f5640bafa1fe10a14f780?s=128&d=identicon&r=PG", "display_name": "exomic", "link": "https://stackoverflow.com/users/1130841/exomic"}, "edited": false, "score": 0, "creation_date": 1480534938, "post_id": 40896796, "comment_id": 69007400, "body": "I will give it a try but I&#39;m trying to create the certificate from the program.exe&#39;s certificate."}, {"owner": {"reputation": 456, "user_id": 1130841, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b493e949557f5640bafa1fe10a14f780?s=128&d=identicon&r=PG", "display_name": "exomic", "link": "https://stackoverflow.com/users/1130841/exomic"}, "edited": false, "score": 0, "creation_date": 1480535651, "post_id": 40896796, "comment_id": 69007777, "body": "Looks like the method is able to find the signature in the whole program.exe in the form of an byte[]. It was much easier than expected. Thanks!"}], "tags": [], "owner": {"reputation": 44007, "user_id": 941240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SCC3P.jpg?s=128&g=1", "display_name": "Wiktor Zychla", "link": "https://stackoverflow.com/users/941240/wiktor-zychla"}, "is_accepted": true, "score": 1, "last_activity_date": 1480534814, "creation_date": 1480534814, "answer_id": 40896796, "question_id": 40896541, "link": "https://stackoverflow.com/questions/40896541/c-getting-a-x509certificate-from-exe-file-stored-as-byte-array/40896796#40896796", "title": "C# Getting a X509Certificate from exe file stored as byte array", "body": "<p>I am not sure this is your concern but of course you can create a cert instance from byte array using the constructor</p>\n\n<pre><code>new X509Certificate2(byte[])\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms148413(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/ms148413(v=vs.110).aspx</a></p>\n"}], "owner": {"reputation": 456, "user_id": 1130841, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b493e949557f5640bafa1fe10a14f780?s=128&d=identicon&r=PG", "display_name": "exomic", "link": "https://stackoverflow.com/users/1130841/exomic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 40896796, "answer_count": 1, "score": 0, "last_activity_date": 1480534814, "creation_date": 1480533817, "last_edit_date": 1480534369, "question_id": 40896541, "link": "https://stackoverflow.com/questions/40896541/c-getting-a-x509certificate-from-exe-file-stored-as-byte-array", "title": "C# Getting a X509Certificate from exe file stored as byte array", "body": "<p>I'm currently doing some code optimization (and trying to stop security software from blocking the generated tempFile.exe) in my auto-updater project. Basically the auto-updater.exe is downloading the latest version of program.exe and was saving it to C:\\Temp\\, check the md5 and the exe signature for security verification and then if all passed we override the program.exe located in the C:\\Program File\\directory.</p>\n\n<p>I optimized the project to download the program.exe into a byte[] (to avoid creating a temporary file in C:\\temp). I'm able to check the md5 of the byte[] as well but trying to check the exe's signature is where I'm getting stuck. </p>\n\n<p>When I was creating the temporary file in C:\\temp I was able to create a X509Certificate using the X509Certificate.CreateFromSignedFile(\"C:\\temp\\program.exe\") method but there's no method accepting a byte[] instead of the file path.</p>\n\n<pre><code> X509Certificate2 theCertificate;\n try\n {\n     X509Certificate theSigner = X509Certificate.CreateFromSignedFile(pathToFile);\n     theCertificate = new X509Certificate2(theSigner);\n }\n catch (Exception ex)\n {\n     Console.WriteLine(\"No digital signature found in: \" + pathToFile);\n     Console.WriteLine(\"Signature check ex: \" + ex);\n     return false;\n }\n\n// This section will check that the certificate is from a trusted authority IE not self-signed\n  var theCertificateChain = new X509Chain();\n  theCertificateChain.ChainPolicy.RevocationFlag = X509RevocationFlag.ExcludeRoot;\n  theCertificateChain.ChainPolicy.RevocationMode = X509RevocationMode.Online;\n  theCertificateChain.ChainPolicy.UrlRetrievalTimeout = new TimeSpan(0, 1, 0);\n  theCertificateChain.ChainPolicy.VerificationFlags = X509VerificationFlags.NoFlag;\n\n  bool chainIsValid = theCertificateChain.Build(theCertificate);\n\n  if (chainIsValid)\n  {\n        // Valid signature...\n  }\n</code></pre>\n\n<p>Do you have any suggestion to verify the downloaded program.exe's signature using the byte[] ?</p>\n"}, {"tags": ["c#", "sorting"], "comments": [{"owner": {"reputation": 20705, "user_id": 5174469, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/cXyx5.jpg?s=128&g=1", "display_name": "Mong Zhu", "link": "https://stackoverflow.com/users/5174469/mong-zhu"}, "edited": false, "score": 0, "creation_date": 1480533935, "post_id": 40896511, "comment_id": 69006951, "body": "any code to offer? or do you sort by hand?"}], "answers": [{"tags": [], "owner": {"reputation": 254, "user_id": 1331924, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8c09fb300d41767e89df20de4abd6942?s=128&d=identicon&r=PG", "display_name": "alemus", "link": "https://stackoverflow.com/users/1331924/alemus"}, "is_accepted": true, "score": 0, "last_activity_date": 1480537461, "creation_date": 1480537461, "answer_id": 40897505, "question_id": 40896511, "link": "https://stackoverflow.com/questions/40896511/issue-sorting-datagrid-by-dates/40897505#40897505", "title": "Issue sorting datagrid by dates", "body": "<p>Realizing this is not an answer, but the short of it was a faulty method was being called in an insanely huge and complex code base.</p>\n\n<p>I changed the code to perform the sort as follows</p>\n\n<pre><code>long dateLeft = CustomClass.EventDate.DateLong.Value;\nlong dateRight = CustomClass.EventDate.DateLong.Value;\nreturn dateLeft.CompareTo(dateRight);\npublic int CompareTo(Int64 value) {\n\n        if (m_value &lt; value) return -1; \n        if (m_value &gt; value) return 1; \n        return 0;\n    } \n</code></pre>\n\n<p>EventDate is a parameter in my class and m_value is a declared internal long.  It was originally using a custom class on the Date, that apparently needs some tweaking.</p>\n"}], "owner": {"reputation": 254, "user_id": 1331924, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8c09fb300d41767e89df20de4abd6942?s=128&d=identicon&r=PG", "display_name": "alemus", "link": "https://stackoverflow.com/users/1331924/alemus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 40897505, "answer_count": 1, "score": -2, "last_activity_date": 1480537461, "creation_date": 1480533710, "question_id": 40896511, "link": "https://stackoverflow.com/questions/40896511/issue-sorting-datagrid-by-dates", "title": "Issue sorting datagrid by dates", "body": "<p>I have a data grid with dates displayed as Sep-14-2016 format.\nI am searching for records with same last name.</p>\n\n<p>I have set of four records with the following dates:  Sep-07-2016, Sep-14-2016, Sep-15-2016, Sep-20-2016</p>\n\n<p>I have a second set of four records with dates Sep-14-2016, Sep-15-2016, Sep-16-2016, Sep-17-2016.</p>\n\n<p>When I sort the first set, all of the records will sort either ASC or Desc.\nHowever, the second set only the first and last record in the set sort.</p>\n\n<p>Same database, datatype and background code. </p>\n\n<p>I am at a loss for why the sorts are not working correctly.</p>\n"}, {"tags": ["c#", "entity-framework"], "answers": [{"comments": [{"owner": {"reputation": 5752, "user_id": 875708, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b3bba7f16d6a0f40b9961e32a8168642?s=128&d=identicon&r=PG", "display_name": "akd", "link": "https://stackoverflow.com/users/875708/akd"}, "edited": false, "score": 0, "creation_date": 1480535845, "post_id": 40896724, "comment_id": 69007890, "body": "Thanks yes I guess this is the best way to implement this. But still not happy to end up with 2 tables in database to hold pictures.."}, {"owner": {"reputation": 5752, "user_id": 875708, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b3bba7f16d6a0f40b9961e32a8168642?s=128&d=identicon&r=PG", "display_name": "akd", "link": "https://stackoverflow.com/users/875708/akd"}, "edited": false, "score": 0, "creation_date": 1480536540, "post_id": 40896724, "comment_id": 69008238, "body": "and in the context class I should add 2 dbset one for SchoolPicture and one for StudentPicture is that right?"}, {"owner": {"reputation": 15339, "user_id": 642579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jJpEP.png?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/642579/markus"}, "reply_to_user": {"reputation": 5752, "user_id": 875708, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b3bba7f16d6a0f40b9961e32a8168642?s=128&d=identicon&r=PG", "display_name": "akd", "link": "https://stackoverflow.com/users/875708/akd"}, "edited": false, "score": 0, "creation_date": 1480536862, "post_id": 40896724, "comment_id": 69008415, "body": "Yes, you&#39;d need to add two DbSets, but you only need to add these if you want to access the pictures directly; in my sample, I&#39;ve only added the DbSets for School and Student. The advantage of having two separate entities is that you cannot assign a SchoolPicture to a Student by accident."}, {"owner": {"reputation": 5752, "user_id": 875708, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b3bba7f16d6a0f40b9961e32a8168642?s=128&d=identicon&r=PG", "display_name": "akd", "link": "https://stackoverflow.com/users/875708/akd"}, "edited": false, "score": 0, "creation_date": 1480537320, "post_id": 40896724, "comment_id": 69008641, "body": "Thanks for the answer.yes Now the  StudentPictures and SchoolPictures tables are created in the database. And the annoying bit is they both share the same attributes such as Description, Url, DateAdded etc. Thanks."}], "tags": [], "owner": {"reputation": 15339, "user_id": 642579, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jJpEP.png?s=128&g=1", "display_name": "Markus", "link": "https://stackoverflow.com/users/642579/markus"}, "is_accepted": true, "score": 1, "last_activity_date": 1480535268, "last_edit_date": 1480535268, "creation_date": 1480534565, "answer_id": 40896724, "question_id": 40896497, "link": "https://stackoverflow.com/questions/40896497/how-to-model-one-to-many-relationship-pointing-to-same-entity-from-different-ent/40896724#40896724", "title": "How to Model One to Many relationship pointing to same entity from different entities in EF", "body": "<p>If a picture cannot be shared among a school and a student, you could create separate entities for the two picture types. The best way to do this is to create a base class and derived classes for each specific picture type:</p>\n\n<pre><code>public abstract class Picture \n{\n    public int Id { get; set; }\n    // ...\n}\npublic class SchoolPicture : Picture\n{\n    // ...\n}\npublic class StudentPicture : Picture\n{\n    // ...\n}\n</code></pre>\n\n<p>Then the School entity references the SchoolPicture and the Student entity references the StudentPicture:</p>\n\n<pre><code>public class School\n{\n    // ...\n    public virtual ICollection&lt;SchoolPicture&gt; Pictures {get;set;}\n}\npublic class Student\n{\n    // ...\n    public virtual ICollection&lt;StudentPicture&gt; Pictures {get;set;}\n}\n</code></pre>\n\n<p>This way, two separate tables are created for the pictures with only a single foreign key to the corresponding parent entity: </p>\n\n<p><a href=\"https://i.stack.imgur.com/PE4WQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PE4WQ.png\" alt=\"Created model\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 5752, "user_id": 875708, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b3bba7f16d6a0f40b9961e32a8168642?s=128&d=identicon&r=PG", "display_name": "akd", "link": "https://stackoverflow.com/users/875708/akd"}, "edited": false, "score": 0, "creation_date": 1480536053, "post_id": 40896789, "comment_id": 69007998, "body": "So imagine that I have added 5 different entities the picture collection. which means that any time I add a picture Pictures table 4 of the foreign keys must be set to null as those are not related at all. This does not sound good to me. I go for the polymorphism as @Markus described."}, {"owner": {"reputation": 7852, "user_id": 1097123, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93d48a626680f755c5464741d9897e78?s=128&d=identicon&r=PG", "display_name": "kimbaudi", "link": "https://stackoverflow.com/users/1097123/kimbaudi"}, "reply_to_user": {"reputation": 5752, "user_id": 875708, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b3bba7f16d6a0f40b9961e32a8168642?s=128&d=identicon&r=PG", "display_name": "akd", "link": "https://stackoverflow.com/users/875708/akd"}, "edited": false, "score": 0, "creation_date": 1480536540, "post_id": 40896789, "comment_id": 69008239, "body": "Ah yes, got it! Yes, @Markus solution would handle that"}], "tags": [], "owner": {"reputation": 7852, "user_id": 1097123, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/93d48a626680f755c5464741d9897e78?s=128&d=identicon&r=PG", "display_name": "kimbaudi", "link": "https://stackoverflow.com/users/1097123/kimbaudi"}, "is_accepted": false, "score": 0, "last_activity_date": 1480534796, "creation_date": 1480534796, "answer_id": 40896789, "question_id": 40896497, "link": "https://stackoverflow.com/questions/40896497/how-to-model-one-to-many-relationship-pointing-to-same-entity-from-different-ent/40896789#40896789", "title": "How to Model One to Many relationship pointing to same entity from different entities in EF", "body": "<p>In your Student model, you are saying there is a one-to-many relationship between Student and Picture. Same thing with your School model. So EF adds a foreign key to Picture for both Student and School model. That is the expected behavior.</p>\n\n<blockquote>\n  <p>It doesn't look right to me to have those foreign keys in the Pictures\n  table.</p>\n</blockquote>\n\n<p>Based on your Student and School model, I expect EF to add 2 foreign keys to Picture (StudentId and SchoolId). How should it look to you?</p>\n\n<blockquote>\n  <p>In the future if another entity needs to have list of Pictures then\n  which means another foreign key property in the Pictures table.</p>\n</blockquote>\n\n<p>If you create another model that contains <code>ICollection &lt;Picture&gt; Pictures { get; set; }</code> as a property, then yes, that would create another foreign key in Picture. But if you omit it, it won't.</p>\n\n<p>I'm not sure what you are expecting. Can you elaborate?</p>\n"}], "owner": {"reputation": 5752, "user_id": 875708, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/b3bba7f16d6a0f40b9961e32a8168642?s=128&d=identicon&r=PG", "display_name": "akd", "link": "https://stackoverflow.com/users/875708/akd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 40896724, "answer_count": 2, "score": 0, "last_activity_date": 1480535268, "creation_date": 1480533658, "question_id": 40896497, "link": "https://stackoverflow.com/questions/40896497/how-to-model-one-to-many-relationship-pointing-to-same-entity-from-different-ent", "title": "How to Model One to Many relationship pointing to same entity from different entities in EF", "body": "<p>I have an entity as Student</p>\n\n<pre><code>public class Student{\n\n..\n\n public ICollection&lt;Picture&gt; Pictures {get;set;}\n</code></pre>\n\n<p>}</p>\n\n<p>And School entity</p>\n\n<pre><code>public class School{\n\n..\n\npublic ICollection&lt;Picture&gt; Pictures {get;set;}\n}\n</code></pre>\n\n<p>When I create this model and run the migrations I can see that  in Pictures table in the database 2 foreign key properties have been created as StudentId and SchoolId. </p>\n\n<p>It doesn't look right to me to have those foreign keys in the Pictures table.</p>\n\n<p>In the future if another entity needs to have list of Pictures then which means another foreign key property in the Pictures table.</p>\n\n<p>How can I change this behavior in the code first model? Or this is the correct approach? </p>\n"}, {"tags": ["c#", "excel", "worksheet"], "answers": [{"tags": [], "owner": {"reputation": 7168, "user_id": 6842716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cxds5.png?s=128&g=1", "display_name": "JohnG", "link": "https://stackoverflow.com/users/6842716/johng"}, "is_accepted": false, "score": 0, "last_activity_date": 1480584042, "last_edit_date": 1480584042, "creation_date": 1480583441, "answer_id": 40906528, "question_id": 40896479, "link": "https://stackoverflow.com/questions/40896479/get-names-of-tabs-in-excel-workbook-and-use-just-one/40906528#40906528", "title": "Get names of tabs in Excel workbook and use just one", "body": "<p>If you do not know \u201cwhere\u201d the worksheet is located in the workbook, you can loop through each sheet and check either the sheet name, or as you say \u201ctext in cellA1\u201d.</p>\n\n<p>Checking the text in cell A1\u2026 I am not sure how you would know if the sheet was the proper one by looking at the first cell. What if all sheets have a value in the first cell? And what would that cell contain? Would the cell contain text that says \u201cthis is the correct sheet\u201d? So I am assuming that this workbook only has one sheet with data, and the other sheets are empty.</p>\n\n<p>Looping through the sheets in the workbook is relatively easy, however if you do not know what the name of the sheet is, then it may be difficult to identify the proper sheet. Using my assumption (above) of only one sheet with data, then you can check each sheet to see how many rows of data each sheet has. Then the one with more than 1 row of data is the sheet you are looking for. If the other sheets have data also, then this won\u2019t work and you are going to have to identify the target sheet some other way.</p>\n\n<p>If you DO KNOW the name of the worksheet, then you are good to go. In your case you stated that the worksheet was \u201cSheet3\u201d but may not be in the 3rd index of the worksheets in the workbook. In this case you can reference the sheet by name as you asked with:</p>\n\n<pre><code>Worksheet target = workbook.Sheets[\u201cSheet3\u201d];\n</code></pre>\n\n<p>If <code>target</code> returns null, then the worksheet named \u201cSheet3\u201d does not exist. If target is not null, then you have found the worksheet and it can be referenced by the <code>target</code> Worksheet variable.</p>\n\n<p>From what you described, if the sheet is always named \u201dSheet3\u201d then simply use:</p>\n\n<pre><code>if (SheetExist(workbook, \"Sheet3\"))\n{\n  Worksheet myWS = workbook.Sheets[\"Sheet3\"];\n  if (myWS.Cells[1,1].Value != null)\n    Console.WriteLine(\"\\nCell[1,1] of sheet3: \" + myWS.Cells[1, 1].Value.ToString() + \"\\n\");\n  else\n    Console.WriteLine(\"\\nCell[1,1] of sheet3 is Null/has no value\");\n}\nelse\n{\n   //Console.WriteLine(\"Worksheet NOT found!\");\n   // sheet named \"Sheet3\" does not exist in the workbook\n}\n</code></pre>\n\n<p>Below is a method that you can use to see if a \"worksheet\" with the supplied name \u201csheetName\u201d exist in the given \u201dworkbook.\u201d If you need the index of the worksheet you could change this to return the index or -1 if it does not exist. </p>\n\n<pre><code>private static bool SheetExist(Excel.Workbook workbook, string sheetName)\n{\n  Worksheet target = workbook.Sheets[sheetName];\n  if (target != null)\n  {\n    //Console.WriteLine(\"Worksheet found!\");\n    return true;\n  }\n  else\n  {\n    //Console.WriteLine(\"Worksheet NOT found!\");\n    return false;\n  }\n</code></pre>\n\n<p>A method that loops through all the sheets and checks the number of rows with data using the \u201cUsedRange\u201d function. This also identifies the index of the worksheet in the workbook.</p>\n\n<pre><code>private static void LoopThruAllSheets(Workbook workbook)\n{\n  Sheets allWorkSheets = workbook.Worksheets;\n  foreach (Worksheet curWS in allWorkSheets)\n  {\n    Console.WriteLine(\"Worksheet : at index \" + curWS.Index + \" name: \" + curWS.Name.ToString() + \" UsedRange.Rows.Count: \" + curWS.UsedRange.Rows.Count.ToString());\n  }\n}\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 133, "user_id": 7054019, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8e137e6d072b0c9ed64e0c73fb29a4b0?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/7054019/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1480584042, "creation_date": 1480533597, "last_edit_date": 1480533980, "question_id": 40896479, "link": "https://stackoverflow.com/questions/40896479/get-names-of-tabs-in-excel-workbook-and-use-just-one", "title": "Get names of tabs in Excel workbook and use just one", "body": "<p>I've got an Excel workbook, and needed to read data from the third (and final) worksheet in that workbook. I used old code that scanned through all worksheets, but modified it to jump to the third worksheet:</p>\n\n<pre><code>foreach (var worksheet in Workbook.Worksheets(excelInput).skip(2))\n</code></pre>\n\n<p>This took me to the third worksheet, my code would execute, and everything was fine.</p>\n\n<p>Now, the client is sending either a three-tabbed Workbook with the sheet I need elsewhere (either 1st or 2nd tab), or they're sending a four-tabbed Workbook, and the sheet I need could be anywhere.</p>\n\n<p>Is there a way to choose the one-and-only sheet that I need by either finding the name of the tab, or the text in cell A1, and using that worksheet and that worksheet only?</p>\n\n<p>Thanks very much in advance!</p>\n"}, {"tags": ["c#", ".net", "wpf", "asynchronous", "async-await"], "comments": [{"owner": {"reputation": 4769, "user_id": 688357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e3626fc691f53efdb3245996a0509c8?s=128&d=identicon&r=PG&f=1", "display_name": "William Xifaras", "link": "https://stackoverflow.com/users/688357/william-xifaras"}, "edited": false, "score": 1, "creation_date": 1480535533, "post_id": 40896458, "comment_id": 69007713, "body": "You do realize Wait is a blocking call?"}, {"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "reply_to_user": {"reputation": 4769, "user_id": 688357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e3626fc691f53efdb3245996a0509c8?s=128&d=identicon&r=PG&f=1", "display_name": "William Xifaras", "link": "https://stackoverflow.com/users/688357/william-xifaras"}, "edited": false, "score": 0, "creation_date": 1480539763, "post_id": 40896458, "comment_id": 69010008, "body": "I do and I know this is a problem. So how can I make it non blocking considering the calling method (OnNavigatingFrom) cannot return until operation is completed?"}, {"owner": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "edited": false, "score": 0, "creation_date": 1480540347, "post_id": 40896458, "comment_id": 69010314, "body": "If <i>(and only if)</i> the <code>OnNavigatingFrom</code> method is an event handler, you can set it as a <code>public async void</code> (thanks to reading a lot of literature by Stephen Cleary). Which will allow you to use <code>await</code>. E.g. <code>await DoSomethingAsync();</code>. The calling method will not return until the awaited task is complete"}, {"owner": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "edited": false, "score": 0, "creation_date": 1480540475, "post_id": 40896458, "comment_id": 69010382, "body": "Might be of some use?: <a href=\"http://blog.stephencleary.com/2012/02/async-and-await.html\" rel=\"nofollow noreferrer\">blog.stephencleary.com/2012/02/async-and-await.html</a>"}, {"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "reply_to_user": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "edited": false, "score": 0, "creation_date": 1480585781, "post_id": 40896458, "comment_id": 69027078, "body": "@GeoffJames You are right when you say the calling method will not return until the task is complete. However, the navigation is executed immediately, without waiting for the function returns. I think the reason is that Modern UI for WPF template frame navigation does not wait for completion. Any ideas?"}, {"owner": {"reputation": 56341, "user_id": 1768303, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Eypxz.jpg?s=128&g=1", "display_name": "noseratio", "link": "https://stackoverflow.com/users/1768303/noseratio"}, "edited": false, "score": 0, "creation_date": 1480589908, "post_id": 40896458, "comment_id": 69030038, "body": "@IgorKondrasovas, it appears you have here two mutually exclusive requirements: 1) <code>OnNavigatingFrom</code> must not return until the task has completed 2) The UI shouldn&#39;t be blocked. Think about it this way: if the UI isn&#39;t blocked, what kind of UI actions would you allow a user to take (while the task is still pending)? Can the user continue using menus, etc? Or exit the app? The only way to &quot;marry&quot; these two requirements together without blocking is to introduce a nested message loop, but this is almost never a good idea. Related: <a href=\"http://stackoverflow.com/a/20891625/1768303\">stackoverflow.com/a/20891625/1768303</a>."}, {"owner": {"reputation": 2826, "user_id": 6240567, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/654a8cca486758a5db347b9db603eb41?s=128&d=identicon&r=PG", "display_name": "Geoff James", "link": "https://stackoverflow.com/users/6240567/geoff-james"}, "edited": false, "score": 0, "creation_date": 1480594698, "post_id": 40896458, "comment_id": 69033153, "body": "@IgorKondrasovas -- with the template/API you&#39;re using, is it possible to have an &quot;OnNavigatingBack&quot; event or similar? How exactly are you navigating back? Is there your own back button with a command that you execute to do this? Or is it a hardware back/built-in back button that you have no control over?"}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1480608504, "post_id": 40896458, "comment_id": 69042766, "body": "@IgorKondrasovas the correct pattern in your case is Commands. A command that executes an operation then navigates to a specific page upon completion. If you want to hand-code this, your View should be calling a method in your ViewModel or code-behind that executes the operation and <i>then</i> navigates to a new page"}, {"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "reply_to_user": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1480684477, "post_id": 40896458, "comment_id": 69077073, "body": "@PanagiotisKanavos I am curently working on exactly this approach. First I cancel the navigation, start my async command that will show some visuals to notify user about the operation progress. When the command is complete, I use an injected NavigationService in my viewmodel to navigate back (not cancelling at this time)."}], "answers": [{"comments": [{"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 0, "creation_date": 1480539596, "post_id": 40896899, "comment_id": 69009916, "body": "await the task does not work, because the calling method will not wait for completion before navigating back."}, {"owner": {"reputation": 7199, "user_id": 2385218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1da27354c3389d229f58bffc5b28a11?s=128&d=identicon&r=PG", "display_name": "sellotape", "link": "https://stackoverflow.com/users/2385218/sellotape"}, "reply_to_user": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 1, "creation_date": 1480539805, "post_id": 40896899, "comment_id": 69010031, "body": "Using await means the event handler will not return until the awaited task is complete, but the UI will be free to continue on.  Using Wait() (or any other blocking mechanism) will block the UI.  You can&#39;t have it both ways.  Perhaps you can set a flag after the await finishes, which other code in the UI thread detects?"}, {"owner": {"reputation": 7199, "user_id": 2385218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1da27354c3389d229f58bffc5b28a11?s=128&d=identicon&r=PG", "display_name": "sellotape", "link": "https://stackoverflow.com/users/2385218/sellotape"}, "reply_to_user": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 0, "creation_date": 1480540671, "post_id": 40896899, "comment_id": 69010489, "body": "Otherwise can&#39;t you just do what you want to do after the await finishes in the event handler?"}], "tags": [], "owner": {"reputation": 7199, "user_id": 2385218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1da27354c3389d229f58bffc5b28a11?s=128&d=identicon&r=PG", "display_name": "sellotape", "link": "https://stackoverflow.com/users/2385218/sellotape"}, "is_accepted": false, "score": 0, "last_activity_date": 1480535238, "last_edit_date": 1495540423, "creation_date": 1480535238, "answer_id": 40896899, "question_id": 40896458, "link": "https://stackoverflow.com/questions/40896458/execute-async-command-before-navigating-back/40896899#40896899", "title": "Execute async command before navigating back", "body": "<p>Just <code>await</code> the <code>Task</code> instead of using <code>.Wait()</code>.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/9110472/using-async-await-on-net-4\">Using async-await on .net 4</a> for how to await in .NET 4.0</p>\n"}, {"comments": [{"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 1, "creation_date": 1480539491, "post_id": 40896901, "comment_id": 69009854, "body": "This does not work, because OnNavigatingFrom is an event handler and simply adding the async on the method header will not make any differenct. The page will navigate back immediately."}, {"owner": {"reputation": 88791, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "reply_to_user": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 1, "creation_date": 1480608429, "post_id": 40896901, "comment_id": 69042714, "body": "@IgorKondrasovas that&#39;s a matter of using the correct event. Using <code>await</code> is the correct way to await an asynchronous operation. You are simply using the wrong event/pattern. Instead of <i>navigating</i> you should be using a command that navigates to the new page upon completion"}, {"owner": {"reputation": 11114, "user_id": 402366, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/43074670e3a479a1d3ae5242ce00819e?s=128&d=identicon&r=PG", "display_name": "Paulo Morgado", "link": "https://stackoverflow.com/users/402366/paulo-morgado"}, "edited": false, "score": 0, "creation_date": 1480635204, "post_id": 40896901, "comment_id": 69056747, "body": "The first form will immediately post the execution of <code>MyCommandAsync</code> to the thread pool and return while the second will run on the UI thread until it reaches the first incomplete awaitable."}], "tags": [], "owner": {"reputation": 21585, "user_id": 2410379, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/X2Tci.jpg?s=128&g=1", "display_name": "David Pine", "link": "https://stackoverflow.com/users/2410379/david-pine"}, "is_accepted": false, "score": 2, "last_activity_date": 1480535244, "creation_date": 1480535244, "answer_id": 40896901, "question_id": 40896458, "link": "https://stackoverflow.com/questions/40896458/execute-async-command-before-navigating-back/40896901#40896901", "title": "Execute async command before navigating back", "body": "<p>Here is what you need to do:</p>\n\n<pre><code>public void OnNavigatingFrom(NavigatingCancelEventArgs e)\n{\n    // Fire and forget.\n    Task.Run(() =&gt; MyCommandAsync());\n}\n</code></pre>\n\n<p>The above is a fire and forget approach, instead it is preferred to use <code>async</code> and <code>await</code>:</p>\n\n<pre><code>public async void OnNavigatingFrom(NavigatingCancelEventArgs e)\n{\n    await MyCommandAsync();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 0, "creation_date": 1482413980, "post_id": 41228710, "comment_id": 69770611, "body": "What you suggest is what I am doing. The problem is that this &quot;navigate back&quot; method (OnNavigatingFrom) my page executes does not wait for async operations, where the &quot;please wait&quot; UI would be shown while operation is going. What I end up doing is cancel the navigation, do my async stuff and then navigate back from my ViewModel when operation is complete."}, {"owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "reply_to_user": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "edited": false, "score": 0, "creation_date": 1482422139, "post_id": 41228710, "comment_id": 69776090, "body": "@IgorKondrasovas: Yes, that is what you have to do. <code>OnNavigatingFrom</code> <i>can&#39;t</i> wait - it&#39;s not supposed to wait - it doesn&#39;t make sense to try to make it wait."}], "tags": [], "owner": {"reputation": 372457, "user_id": 263693, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/52827072e9a78ef98ee77a56abda920b?s=128&d=identicon&r=PG", "display_name": "Stephen Cleary", "link": "https://stackoverflow.com/users/263693/stephen-cleary"}, "is_accepted": true, "score": 2, "last_activity_date": 1482171759, "creation_date": 1482171759, "answer_id": 41228710, "question_id": 40896458, "link": "https://stackoverflow.com/questions/40896458/execute-async-command-before-navigating-back/41228710#41228710", "title": "Execute async command before navigating back", "body": "<blockquote>\n  <p>one page needs to execute an async command before it navigates back to another page</p>\n</blockquote>\n\n<p>This is the problem. User interfaces are not asynchronous, period. You can't just stick an asynchronous operation into the mix while the UI is doing a transition.</p>\n\n<p>Think about it this way: as a user, if you decide to navigate back, and there's a network hiccup or something and the program freezes for a few seconds while navigating back, that's a bad user experience, right? The UI simply can't wait for asynchronous work during an update.</p>\n\n<p>What you can do is do the work <em>before</em> the user is <em>allowed</em> to navigate back. You can, for example, capture the user's intent to navigate back and show some kind of \"please wait\" UI while the operation is going, and then after the operation completes do the <em>actual</em> navigation.</p>\n"}, {"tags": [], "owner": {"reputation": 709, "user_id": 2726117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26f91cc661899356f268681130ca8a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Enny", "link": "https://stackoverflow.com/users/2726117/enny"}, "is_accepted": false, "score": 0, "last_activity_date": 1508488310, "creation_date": 1508488310, "answer_id": 46845220, "question_id": 40896458, "link": "https://stackoverflow.com/questions/40896458/execute-async-command-before-navigating-back/46845220#46845220", "title": "Execute async command before navigating back", "body": "<p>Use <strong>OnNavigatingFrom</strong> to do your stuff. <strong>e.Cancel</strong> prevent going back. Use Frame.GoBack() after your operation has finished.</p>\n\n<pre><code>protected override async void OnNavigatingFrom(NavigatingCancelEventArgs e)\n{\n    if (Current.HasModifications())\n    {\n        e.Cancel = true;\n        await Current.Save().ContinueWith((t) =&gt;\n        {\n            //Go Back after the Operation has finished\n            Frame.GoBack();\n        }, TaskScheduler.FromCurrentSynchronizationContext());\n    }\n    else\n    {\n        base.OnNavigatingFrom(e);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1321, "user_id": 2556812, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/14e613f8f6122f43d4af285de0deef51?s=128&d=identicon&r=PG", "display_name": "Igor Kondrasovas", "link": "https://stackoverflow.com/users/2556812/igor-kondrasovas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 41228710, "answer_count": 4, "score": 0, "last_activity_date": 1508488310, "creation_date": 1480533535, "last_edit_date": 1495539944, "question_id": 40896458, "link": "https://stackoverflow.com/questions/40896458/execute-async-command-before-navigating-back", "title": "Execute async command before navigating back", "body": "<p>I am using <a href=\"https://github.com/firstfloorsoftware/mui\" rel=\"nofollow noreferrer\">Modern UI for WPF</a> template in a .NET 4.0 app where one page needs to execute an async command before it navigates back to another page. At the same time, UI thread must be unlocked while command is running. If I do this:</p>\n\n<pre><code>    public void OnNavigatingFrom(FirstFloor.ModernUI.Windows.Navigation.NavigatingCancelEventArgs e)\n    {\n        TaskEx.Run(() =&gt;\n            {\n                //Replace Sleep call by the async command execution\n                System.Threading.Thread.Sleep(5000);\n            }).Wait();}\n</code></pre>\n\n<p>The OnNavigatingFrom waits before navigating back, but the UI is blocked during this time.</p>\n\n<p>Any ideas on how to execute the async code in a different context and make OnNavigatingFrom runs \"synchronously\"?</p>\n\n<p>EDIT: There is a <a href=\"https://stackoverflow.com/questions/20682991/storyboard-completed-and-onnavigatingfrom-how-to-do-animation-correctly\">similar thread</a> with a workaround and no conclusive answer. </p>\n"}, {"tags": ["c#", "asp.net", "cultureinfo", "parallel.foreach"], "comments": [{"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "edited": false, "score": 2, "creation_date": 1480533739, "post_id": 40896455, "comment_id": 69006868, "body": "Culture can be stored as a thread local. If you changed the culture of the active thread it does not affect thread pool threads."}], "answers": [{"comments": [{"owner": {"reputation": 2628, "user_id": 842865, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Q51F6.jpg?s=128&g=1", "display_name": "MeanGreen", "link": "https://stackoverflow.com/users/842865/meangreen"}, "edited": false, "score": 0, "creation_date": 1480597725, "post_id": 40897055, "comment_id": 69035107, "body": "Thanks for the answer! You are correct. Unfortunately this application is still using 4.0 with no option to change this before the next release. I resolved to setting the culture settings just inside the loop. Appreciated!"}, {"owner": {"reputation": 4877, "user_id": 553825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/87f04a9e81b3d62aab4de5ca63156abc?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Bahrami", "link": "https://stackoverflow.com/users/553825/ali-bahrami"}, "reply_to_user": {"reputation": 2628, "user_id": 842865, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Q51F6.jpg?s=128&g=1", "display_name": "MeanGreen", "link": "https://stackoverflow.com/users/842865/meangreen"}, "edited": false, "score": 0, "creation_date": 1480597937, "post_id": 40897055, "comment_id": 69035252, "body": "Your&#39;re welcome, As you said you can set culture thread inside the loop."}], "tags": [], "owner": {"reputation": 4877, "user_id": 553825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/87f04a9e81b3d62aab4de5ca63156abc?s=128&d=identicon&r=PG&f=1", "display_name": "Ali Bahrami", "link": "https://stackoverflow.com/users/553825/ali-bahrami"}, "is_accepted": true, "score": 7, "last_activity_date": 1480536188, "last_edit_date": 1480536188, "creation_date": 1480535817, "answer_id": 40897055, "question_id": 40896455, "link": "https://stackoverflow.com/questions/40896455/why-does-parallel-foreach-change-the-culture-of-its-threads/40897055#40897055", "title": "Why does Parallel.ForEach change the culture of its threads?", "body": "<p>It's because you've set culture for the <strong>CurrentThread</strong>. <code>Parallel.ForEach</code> will create a new <code>Task</code> for every iteration, which they will have the default culture.</p>\n\n<p>In .NET 4.5, you can use the <code>CultureInfo.DefaultThreadCurrentCulture</code> property to change the culture of an <code>AppDomain</code> ( set the culture for all threads ). </p>\n\n<p>(<a href=\"https://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.defaultthreadcurrentculture(v=vs.110).aspx\" rel=\"noreferrer\">CultureInfo.DefaultThreadCurrentCulture on msdn</a>)</p>\n"}], "owner": {"reputation": 2628, "user_id": 842865, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Q51F6.jpg?s=128&g=1", "display_name": "MeanGreen", "link": "https://stackoverflow.com/users/842865/meangreen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 0, "accepted_answer_id": 40897055, "answer_count": 1, "score": 5, "last_activity_date": 1480536188, "creation_date": 1480533526, "question_id": 40896455, "link": "https://stackoverflow.com/questions/40896455/why-does-parallel-foreach-change-the-culture-of-its-threads", "title": "Why does Parallel.ForEach change the culture of its threads?", "body": "<p>Today I came across a strange phenomenon I can't really explain. There's a webpage with a number of rows in a gridview, which need to be saved to the database and to an XML file one by one. I ended up using a <code>Parallel.ForEach</code>, as there is no relation between the rows, so they can be executed independently. The code is basically this:</p>\n\n<pre><code>        Parallel.ForEach(gvWithData.Rows.Cast&lt;GridViewRow&gt;(), row =&gt;\n        {\n            if (row.RowType == DataControlRowType.DataRow)\n            {\n                    // do some logic and stuff...\n                    var type = new Object { ... };\n\n                    // save to the database\n                    type.Save();\n\n                    // retrieve the saved item from the database again\n                    //  since we need some autoincrement values from the db\n                    var typeAfterSave = TypeManager.GetFromDb();\n\n                    // create a custom XML from the object\n                    XmlManager.CreateXml(typeAfterSave);\n                }\n            }\n</code></pre>\n\n<p>Why on earth would this code work any different when I replace the <code>Parallel.ForEach</code> with a good old <code>foreach</code> and <strong>I change nothing else</strong>?</p>\n\n<p>The difference is that the culture in which the XML is created in the first case is different from the second case, and I have not the slightest clue why.</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["c#", "rabbitmq", "masstransit"], "comments": [{"owner": {"reputation": 177, "user_id": 1034047, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5c17285df741b593c153ca0243d83e0a?s=128&d=identicon&r=PG", "display_name": "sagar", "link": "https://stackoverflow.com/users/1034047/sagar"}, "edited": false, "score": 0, "creation_date": 1480533692, "post_id": 40896431, "comment_id": 69006835, "body": "Which version of MassTransit are you using?"}, {"owner": {"reputation": 2541, "user_id": 152517, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b72bc0a41400c43cc4d89c8ec174ec89?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/152517/andy"}, "reply_to_user": {"reputation": 177, "user_id": 1034047, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5c17285df741b593c153ca0243d83e0a?s=128&d=identicon&r=PG", "display_name": "sagar", "link": "https://stackoverflow.com/users/1034047/sagar"}, "edited": false, "score": 0, "creation_date": 1480535381, "post_id": 40896431, "comment_id": 69007633, "body": "I&#39;m using MassTransit 3.4.1"}, {"owner": {"reputation": 16298, "user_id": 1882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e12b6dc468379c7067c55f2fa609c37?s=128&d=identicon&r=PG", "display_name": "Chris Patterson", "link": "https://stackoverflow.com/users/1882/chris-patterson"}, "edited": false, "score": 0, "creation_date": 1480542852, "post_id": 40896431, "comment_id": 69011629, "body": "You are right to keep the bus alive for the life of the process. It should not be transient. It should also reconnect once the broker becomes available."}, {"owner": {"reputation": 16298, "user_id": 1882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e12b6dc468379c7067c55f2fa609c37?s=128&d=identicon&r=PG", "display_name": "Chris Patterson", "link": "https://stackoverflow.com/users/1882/chris-patterson"}, "edited": false, "score": 1, "creation_date": 1480543018, "post_id": 40896431, "comment_id": 69011708, "body": "And the bus keeps a temporary endpoint alive and connected to RabbitMQ. Are you sure your host name is failing over properly on the F5? We have the same setup in production and it fails over the second we drop the primary node."}, {"owner": {"reputation": 2541, "user_id": 152517, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b72bc0a41400c43cc4d89c8ec174ec89?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/152517/andy"}, "edited": false, "score": 0, "creation_date": 1480600425, "post_id": 40896431, "comment_id": 69036926, "body": "Our F5 is using a health monitor that checks every 5 seconds, so maybe this is the problem?  It&#39;s looking for an HTTP 200 while accessing <a href=\"https://myrabbithost.mycompany.com:15671/api/\" rel=\"nofollow noreferrer\">myrabbithost.mycompany.com:15671/api</a>.  How do you have your health monitor set up Chris?  I&#39;m new to F5.  Can you share what you&#39;re doing for your health monitor?  By the way thanks for creating MassTransit and TopShelf - very nice working with such quality free tools!!"}, {"owner": {"reputation": 2541, "user_id": 152517, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b72bc0a41400c43cc4d89c8ec174ec89?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/152517/andy"}, "edited": false, "score": 0, "creation_date": 1480708306, "post_id": 40896431, "comment_id": 69091217, "body": "This post accurately describes what I&#39;m seeing: <a href=\"https://groups.google.com/forum/#!topic/masstransit-discuss/DGcjpL-iInM\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/masstransit-discuss/DGcjpL-i&zwnj;&#8203;InM</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2541, "user_id": 152517, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b72bc0a41400c43cc4d89c8ec174ec89?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/152517/andy"}, "is_accepted": false, "score": 0, "last_activity_date": 1481062695, "creation_date": 1481062695, "answer_id": 41005988, "question_id": 40896431, "link": "https://stackoverflow.com/questions/40896431/masstransit-how-to-handle-rabbitmq-going-down/41005988#41005988", "title": "MassTransit how to handle RabbitMQ going down", "body": "<p>These client crashes were happening because I was using Task.Wait() like this:</p>\n\n<pre><code>Task.Run(() =&gt; bus.Publish(new TestMessage { Id = num })).Wait();\n</code></pre>\n\n<p>instead of this:</p>\n\n<pre><code>Task.Run(() =&gt; bus.Publish(new TestMessage { Id = num }));\n</code></pre>\n\n<p>Without the .Wait(), the clients stay up even when RabbitMQ goes down.  Now the issue is that any messages sent while RabbitMQ was going down but before the F5 fails over to the secondary node are lost.</p>\n"}], "owner": {"reputation": 2541, "user_id": 152517, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b72bc0a41400c43cc4d89c8ec174ec89?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/152517/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1382, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1481062695, "creation_date": 1480533438, "last_edit_date": 1480540045, "question_id": 40896431, "link": "https://stackoverflow.com/questions/40896431/masstransit-how-to-handle-rabbitmq-going-down", "title": "MassTransit how to handle RabbitMQ going down", "body": "<p>What is the proper way to configure MassTransit to be fault tolerant in order to handle intermittent RabbitMQ connectivity issues or RabbitMQ completely going down?  I've set up a RabbitMQ cluster between 2 different machines and configured HA so that everything is mirrored.  I also have an F5 load balancer set up in active/passive mode so that all traffic is directed to a primary node, but if the health check fails, it fails over to the secondary node.  I'm hoping that any client connections after such a failover will continue to succeed, but I'm running into trouble here.  When I stop RabbitMQ on the primary node, the client application starts logging a bunch of MassTransit errors that look like:</p>\n\n<pre><code>RabbitMQ connection failed: Connect failed: myrabbithost.mycompany.com:5671/\n</code></pre>\n\n<p>These errors occur even if no activity is happening - no Publish, Client.Request, etc.  Eventually the errors stop due to MassTransit apparently given up on the connection, and the client app crashes.  In looking at the MassTransit source, I think it's RabbitMqReceiveTransport.Receive that's generating these errors inside the \"RetryUntilCancelled\" method.  It looks it's using an internal ConnectionRetryPolicy, so is there something that can be configured there?</p>\n\n<p>I'm instantiating my bus instance in Global.asax, starting it and keeping it around in memory as long as IIS is up, and I don't know if this is an issue or not; in looking at the documentation for MassTransit using Unity container, it looks like the recommended practice is to allow Unity to default to using the TransientLifetimeManager so that bus instances will be torn down and re-created each time the container resolves it.</p>\n"}, {"tags": ["c#", "ssl", "google-analytics"], "owner": {"reputation": 45, "user_id": 1205363, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/b6569b6ee877f285c02345dd817d7e74?s=128&d=identicon&r=PG", "display_name": "gary_z", "link": "https://stackoverflow.com/users/1205363/gary-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 668, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480533218, "creation_date": 1480533218, "question_id": 40896376, "link": "https://stackoverflow.com/questions/40896376/tls-1-1-and-tls-1-2-with-google-apis", "title": "TLS 1.1 and TLS 1.2 with Google APIs", "body": "<p>I have been using the Google .NET APIs in reporting applications for years; no problem.</p>\n\n<p>Now my organization is enforcing servers use only TLS 1.1 and TLS 1.2 without exception, and that has broken the applications; the error messages say that the client and server do not share a common algorithm.</p>\n\n<p>Is there any possibility for these libraries to use TLS 1.1 or 1.2?  Is there any setting that the Google Account administrator can change?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#", "event-handling", "devexpress"], "answers": [{"tags": [], "owner": {"reputation": 6181, "user_id": 1805640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa93e24ac27e3da387c28f8672b73fac?s=128&d=identicon&r=PG", "display_name": "nempoBu4", "link": "https://stackoverflow.com/users/1805640/nempobu4"}, "is_accepted": true, "score": 0, "last_activity_date": 1480679814, "creation_date": 1480679814, "answer_id": 40931695, "question_id": 40896347, "link": "https://stackoverflow.com/questions/40896347/how-to-override-wndproc-in-a-non-settable-control/40931695#40931695", "title": "How to override wndProc in a non settable control", "body": "<p><code>RepositoryItemTextEdit</code> class is used to hold the properties for in-place instance of <code>TextEdit</code> class. Technically <code>TextEdit</code> class is box which holds the instance of <code>TextBoxMaskBox</code> class. <code>TextBoxMaskBox</code> class is inherited from <code>System.Windows.Forms.TextBox</code> class.<br>\nSo, you can create your own <code>RepositoryItemTextEdit</code>, <code>TextEdit</code> and <code>TextBoxMaskBox</code> descendants and override <code>WndProc</code> method in your own <code>TextBoxMaskBox</code> descendant.<br>\nHere is example:</p>\n\n<pre><code>[UserRepositoryItem(\"RegisterPasteHandlerEdit\")]\npublic class RepositoryItemPasteHandlerEdit : RepositoryItemTextEdit\n{\n    static RepositoryItemPasteHandlerEdit()\n    {\n        RegisterPasteHandlerEdit();\n    }\n\n    static private readonly object EventPaste;\n\n    public const string CustomEditName = \"PasteHandlerEdit\";\n\n    public RepositoryItemPasteHandlerEdit() { }\n\n    public override string EditorTypeName =&gt; CustomEditName;\n\n    public static void RegisterPasteHandlerEdit()\n    {\n        Image img = null;\n        EditorRegistrationInfo.Default.Editors.Add(new EditorClassInfo(CustomEditName, typeof(PasteHandlerEdit), typeof(RepositoryItemPasteHandlerEdit), typeof(TextEditViewInfo), new TextEditPainter(), true, img));\n    }\n\n    public override void Assign(RepositoryItem item)\n    {\n        BeginUpdate();\n        try\n        {\n            base.Assign(item);\n            var source = item as RepositoryItemPasteHandlerEdit;\n            if (source == null) return;\n\n            Events.AddHandler(EventPaste, source.Events[EventPaste]);\n        }\n        finally\n        {\n            EndUpdate();\n        }\n    }\n\n    public event PasteEventHandler OnPaste\n    {\n        add\n        {\n            Events.AddHandler(EventPaste, value);\n        }\n        remove\n        {\n            Events.RemoveHandler(EventPaste, value);\n        }\n    }\n\n    protected internal void RaiseOnPaste(PasteEventArgs e)\n    {\n        if (IsLockEvents)\n            return;\n\n        var handler = (PasteEventHandler)Events[EventPaste];\n        handler?.Invoke(GetEventSender(), e);\n    }\n}\n\n[ToolboxItem(true)]\npublic class PasteHandlerEdit : TextEdit\n{\n    static PasteHandlerEdit()\n    {\n        RepositoryItemPasteHandlerEdit.RegisterPasteHandlerEdit();\n    }\n\n    public PasteHandlerEdit() { }\n\n    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]\n    public new RepositoryItemPasteHandlerEdit Properties =&gt; base.Properties as RepositoryItemPasteHandlerEdit;\n\n    public override string EditorTypeName =&gt; RepositoryItemPasteHandlerEdit.CustomEditName;\n\n    protected override TextBoxMaskBox CreateMaskBoxInstance() =&gt; new PasteHandlerMaskBox(this);\n\n    protected override void CreateMaskBox()\n    {\n        base.CreateMaskBox();\n\n        var pasteHandlerMaskBox = MaskBox as PasteHandlerMaskBox;\n        pasteHandlerMaskBox.OnPaste += PasteHandlerMaskBox_OnPaste;\n    }\n\n    private void PasteHandlerMaskBox_OnPaste(object sender, PasteEventArgs e) =&gt; Properties.RaiseOnPaste(e);\n}\n\npublic class PasteHandlerMaskBox : TextBoxMaskBox\n{\n    private const int WM_PASTE = 0x0302;\n\n    public PasteHandlerMaskBox(TextEdit ownerEdit) : base(ownerEdit) { }\n\n    public event PasteEventHandler OnPaste;\n\n    protected override void WndProc(ref Message msg)\n    {\n        if (msg.Msg == WM_PASTE)\n        {\n            var e = new PasteEventArgs();\n\n            OnPaste?.Invoke(this, e);\n\n            if (e.Cancel)\n                return;\n        }\n\n        base.WndProc(ref msg);\n    }\n}\n\npublic class PasteEventArgs : CancelEventArgs\n{\n    public PasteEventArgs() { }\n    public PasteEventArgs(bool cancel) : base(cancel) { }\n\n    public string Text =&gt; Clipboard.GetText();\n}\n\npublic delegate void PasteEventHandler(object sender, PasteEventArgs e);\n</code></pre>\n\n<p>In this example the <code>OnPaste</code> event is added to <code>RepositoryItemPasteHandlerEdit</code> class. You can use this:</p>\n\n<pre><code>private void repositoryItemPasteHandlerEdit1_OnPaste(object sender, PasteEventArgs e)\n{\n    MessageBox.Show(e.Text);\n\n    if (...) // Perform some checks.\n        e.Cancel = true;\n}\n</code></pre>\n"}], "owner": {"reputation": 3852, "user_id": 2516160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q1kcX.jpg?s=128&g=1", "display_name": "jean", "link": "https://stackoverflow.com/users/2516160/jean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 40931695, "answer_count": 1, "score": 0, "last_activity_date": 1480837002, "creation_date": 1480533145, "last_edit_date": 1592644375, "question_id": 40896347, "link": "https://stackoverflow.com/questions/40896347/how-to-override-wndproc-in-a-non-settable-control", "title": "How to override wndProc in a non settable control", "body": "<p>I have a <code>XtraGrid</code> and some columns can get masked depending on the value of another column.<br />\nI managed to achieve it by seting the mask in the editor in the <code>CustomRowCellEdit</code> event.</p>\n<p>Snipet below:</p>\n<pre><code>private void myGridView_CustomRowCellEdit(object sender, CustomRowCellEditEventArgs e)\n{\n    if (e.Column.FieldName == &quot;MyTargetField&quot;)\n    {\n        GridView gv = sender as GridView;\n        var typeValue = gv.GetRowCellValue(e.RowHandle, gv.Columns[&quot;MaskOrNotDependsOnThisField&quot;]);\n\n        if (typeValue == DynamicMask)\n        {\n\n            var maskToApply = GetMaskForThisValue(gv.GetRowCellValue(e.RowHandle, gv.Columns[&quot;MyTargetField&quot;]));\n\n            RepositoryItemTextEdit riMaskedTextEdit = new RepositoryItemTextEdit();\n            riMaskedTextEdit.Mask.MaskType = MaskType.Simple;\n            riMaskedTextEdit.Mask.UseMaskAsDisplayFormat = true;\n            riMaskedTextEdit.Mask.SaveLiteral = false;\n            riMaskedTextEdit.Mask.EditMask = maskToApply;\n            e.RepositoryItem = riMaskedTextEdit;\n            //riMaskedTextEdit.KeyDown += EditorKeyDownDinamicMask;\n        }\n    }\n}\n</code></pre>\n<p>It worked like a charm but some masks can be dynamic (hey I don't make the requeriments!).<br />\nSo I uncomment that event handler line and created a <code>KeyDownEventHandler</code>.</p>\n<p>Let's say my mask changes as user keeps typing like:</p>\n<blockquote>\n<p>999.999 for 6 digits</p>\n<p>999.999-9 for 7 digits</p>\n<p>999.(999)/99 for 8 digits</p>\n</blockquote>\n<p>Note I need to use KeyDown because the mask can prevent the ValueChanged event to fire.<br />\nI handled the keydown and managed to put this thing to work fine.</p>\n<p>Question is:<strong>How to handle Paste events?</strong>\n(from both keyboard and mouse paste events)</p>\n<p>I know how to override <strong>wndProc</strong> in a control, I already did it a few times before.<br />\nProblem here is <code>RepositoryItemTextEdit</code> class is not a control with a wndProc to override.<br />\nI digged a bit and found the above class has a</p>\n<pre><code>public TextEdit OwnerEdit { get; }\n</code></pre>\n<p>And that is the real guy handling the events.<br />\nUnfortunately devxpress left it as a non settable member.</p>\n<p>Right now user cannot replace the 999.999 value with a 999.999-9 in copy paste because the mask truncates the pasted value.<br />\nNote it also prevents the ValueChaged event to fire</p>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480533327, "post_id": 40896343, "comment_id": 69006594, "body": "Are you sure the <code>MenuItem</code> has the <code>DataContext</code> you think it has? Try <code>Command=&quot;{Binding ClickCommand, PresentationTraceSources.TraceLevel=High}&quot;</code> and observe the VS Output pane for trace information. That&#39;s the first thing to try."}, {"owner": {"reputation": 11, "user_id": 7232578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837767c57a8476958c7a5f7a581040fe?s=128&d=identicon&r=PG&f=1", "display_name": "DAufderh", "link": "https://stackoverflow.com/users/7232578/daufderh"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480562278, "post_id": 40896343, "comment_id": 69017545, "body": "The DataContext is on the Window not the MenuItem.  Because this is a dynamically loaded XAML I have no way of telling what&#39;s in it.  However the point here is to enable access to certain properties (which I have working) and certain actions (which I don&#39;t have working) through bindings.  I will try the PresentationTraceSources.TraceLevel=High and see what that turns up"}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480562790, "post_id": 40896343, "comment_id": 69017669, "body": "What do you mean &quot;Action&quot;? How and where is ClickCommand defined? Anyway MenuItems aren&#39;t in the visual tree so they don&#39;t inherit the window&#39;s DataContext. This is likely to be the issue with that binding."}, {"owner": {"reputation": 11, "user_id": 7232578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837767c57a8476958c7a5f7a581040fe?s=128&d=identicon&r=PG&f=1", "display_name": "DAufderh", "link": "https://stackoverflow.com/users/7232578/daufderh"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480563960, "post_id": 40896343, "comment_id": 69017950, "body": "@EdPlunkett This is what I&#39;m trying to figure out.  I want to call a function within my app when a Button is clicked or a MenuItem is selected.  I&#39;ve been looking at this link:  <a href=\"https://msdn.microsoft.com/en-us/library/ms752070(v=vs.110).aspx\" rel=\"nofollow noreferrer\">MS Docs</a> but it throws an exception when trying to setup the Window.CommandBinding.  I presume I want either the Command or Click properties, but that&#39;s where I can&#39;t get the bindings to work.  So far TraceLevel=High has not helped."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480564139, "post_id": 40896343, "comment_id": 69017990, "body": "Please share your definition of ClickCommand. It should be a property of your viewmodel -- whatever SomeStringProperty is a property of. But ClickCommand must return an object that implements ICommand."}, {"owner": {"reputation": 11, "user_id": 7232578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837767c57a8476958c7a5f7a581040fe?s=128&d=identicon&r=PG&f=1", "display_name": "DAufderh", "link": "https://stackoverflow.com/users/7232578/daufderh"}, "reply_to_user": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480565031, "post_id": 40896343, "comment_id": 69018236, "body": "@EdPlunkett See the answer below.  Your suggestion for setting the TraceLevel saved the day."}, {"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 0, "creation_date": 1480565091, "post_id": 40896343, "comment_id": 69018255, "body": "Nice. It&#39;s never what you think it is."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7232578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837767c57a8476958c7a5f7a581040fe?s=128&d=identicon&r=PG&f=1", "display_name": "DAufderh", "link": "https://stackoverflow.com/users/7232578/daufderh"}, "is_accepted": false, "score": 1, "last_activity_date": 1480564989, "last_edit_date": 1495542629, "creation_date": 1480564989, "answer_id": 40902443, "question_id": 40896343, "link": "https://stackoverflow.com/questions/40896343/c-dynamically-loaded-xaml-files-and-command-bindings/40902443#40902443", "title": "C# Dynamically Loaded XAML Files and Command Bindings", "body": "<p>Setting <code>PresentationTraceSources.TraceLevel=High</code> was the key...  I had tried about 100 things previously and got nowhere.  However with the TraceLevel set, I went back to this posts suggestion:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12422945/how-to-bind-wpf-button-to-a-command-in-viewmodelbase\">How to bind WPF button to a command in ViewModelBase?</a></p>\n\n<p>With the TraceLevel set I could clearly see things working except that I was using an older xaml file on disk as a test.  It was manually setting the DataContext for the MenuItem and thus overriding the one that contained the command I was trying to invoke.</p>\n"}], "owner": {"reputation": 11, "user_id": 7232578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837767c57a8476958c7a5f7a581040fe?s=128&d=identicon&r=PG&f=1", "display_name": "DAufderh", "link": "https://stackoverflow.com/users/7232578/daufderh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480564989, "creation_date": 1480533138, "question_id": 40896343, "link": "https://stackoverflow.com/questions/40896343/c-dynamically-loaded-xaml-files-and-command-bindings", "title": "C# Dynamically Loaded XAML Files and Command Bindings", "body": "<p>I'm currently using the following code to load and eventually display xaml files off disk:</p>\n\n<pre><code>StreamReader mysr = new StreamReader(absFile);\nWindow window = XamlReader.Load(mysr.BaseStream) as Window;\nwindow.DataContext = SomeViewModel;\n</code></pre>\n\n<p>I am then able to do bindings in for text and other elements by accessing the properties on the view model like this:</p>\n\n<pre><code>&lt;Label Content=\"{Binding Path=SomeStringProperty}\" ... /&gt;\n</code></pre>\n\n<p>I can even setup converters for things like loading images or changing booleans to visibility values.  What I can't get working is a binding that causes a button click or a menu item selection to call code within view model (or any other class in my application for that matter).  I'd like the MenuItem to look something like this:</p>\n\n<pre><code>&lt;MenuItem Command=\"{Binding Path=ClickCommand}\" CommandParameter=\"Some Parameter\" Header=\"Some Menu Item\" /&gt;\n</code></pre>\n\n<p>Where this menuItem would call \"ClickCommand\" in my code when selected.  Assuming this is done through some ICommand implementation I'd also like the ability to implement the \"CanExecute\" function as well, but I'd live without that if need be.</p>\n\n<p>I've searched for hours, tried everything imaginable and can't get anything to work.  I either get incredibly obscure exceptions or totally silent failure (meaning nothing happens when I click the menu item).  Can somebody provide an example with both the xaml code and backing C# classes that can do this?</p>\n\n<p>Right now the only thing I can think to do is walk the window elements using a VisualTreeHelper or some such and manually add the command bindings in based on some Name property convention.  I know this can be made to work as I did a quick prototype of it, but there has to be a better way.  </p>\n\n<p>Thanks\nDave</p>\n"}, {"tags": ["c#", ".net", "drawstring"], "comments": [{"owner": {"reputation": 35506, "user_id": 424129, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/067763e25885a77061483ece2443c527?s=128&d=identicon&r=PG&f=1", "display_name": "15ee8f99-57ff-4f92-890c-b56153", "link": "https://stackoverflow.com/users/424129/15ee8f99-57ff-4f92-890c-b56153"}, "edited": false, "score": 2, "creation_date": 1480533016, "post_id": 40896235, "comment_id": 69006433, "body": "I think you&#39;re going to need to split the string into words, call <a href=\"https://msdn.microsoft.com/en-us/library/6xe5hazb%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\"><code>GraphicsMeasureString()</code></a>, and do it the hard way. Not <i>too</i> hard, really. Given a list of tuples <code>{ word, wordRect }</code>, it&#39;s a simple loop to fit the text."}, {"owner": {"reputation": 3571, "user_id": 2018731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134baab491cb1a3ebff752e5ea96dcaa?s=128&d=identicon&r=PG", "display_name": "RogerN", "link": "https://stackoverflow.com/users/2018731/rogern"}, "edited": false, "score": 2, "creation_date": 1480533598, "post_id": 40896235, "comment_id": 69006766, "body": "I think you need to look at <code>Graphics.MeasureCharacterRanges</code> to see which words will need to be truncated.  This function can be used to calculate box coordinates for groups of characters in your string (e.g. each word). If you try to use multiple calls to <code>Graphics.MeasureString</code> then I&#39;m afraid the results won&#39;t be accurate enough due to kerning."}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 2929848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xDJbX.png?s=128&g=1", "display_name": "Trey", "link": "https://stackoverflow.com/users/2929848/trey"}, "edited": false, "score": 0, "creation_date": 1480533112, "post_id": 40896327, "comment_id": 69006482, "body": "If you need a code example I can whip something up, I&#39;m just in the middle of a project at work, so I&#39;m being a tad lazy."}, {"owner": {"reputation": 296, "user_id": 6932865, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28cbd1fa231a19e77eb72c1885064471?s=128&d=identicon&r=PG&f=1", "display_name": "Jaked222", "link": "https://stackoverflow.com/users/6932865/jaked222"}, "edited": false, "score": 0, "creation_date": 1480533868, "post_id": 40896327, "comment_id": 69006921, "body": "I&#39;ll try this out and post my solution if it works, or ask for a sample from you. Thanks"}, {"owner": {"reputation": 404, "user_id": 2929848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xDJbX.png?s=128&g=1", "display_name": "Trey", "link": "https://stackoverflow.com/users/2929848/trey"}, "reply_to_user": {"reputation": 296, "user_id": 6932865, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28cbd1fa231a19e77eb72c1885064471?s=128&d=identicon&r=PG&f=1", "display_name": "Jaked222", "link": "https://stackoverflow.com/users/6932865/jaked222"}, "edited": false, "score": 0, "creation_date": 1480534255, "post_id": 40896327, "comment_id": 69007095, "body": "Anytime, I love graphics! Have a great day."}, {"owner": {"reputation": 296, "user_id": 6932865, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28cbd1fa231a19e77eb72c1885064471?s=128&d=identicon&r=PG&f=1", "display_name": "Jaked222", "link": "https://stackoverflow.com/users/6932865/jaked222"}, "edited": false, "score": 0, "creation_date": 1480535898, "post_id": 40896327, "comment_id": 69007917, "body": "An example would be great actually. Assume that we don&#39;t want to cut off words, so rather than going char by char in the string, we&#39;d want to go word by word (splitting by spaces). I have a TextInfo model that contains getters for each box&#39;s x,y, height, width. I also have a TextInfo[] called textParameters. So textParameters[0].width will give you the first textbox&#39;s width. You can use any sample text, font, and fontsize."}, {"owner": {"reputation": 296, "user_id": 6932865, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28cbd1fa231a19e77eb72c1885064471?s=128&d=identicon&r=PG&f=1", "display_name": "Jaked222", "link": "https://stackoverflow.com/users/6932865/jaked222"}, "edited": false, "score": 0, "creation_date": 1480537323, "post_id": 40896327, "comment_id": 69008643, "body": "Actually looks like i got it."}, {"owner": {"reputation": 404, "user_id": 2929848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xDJbX.png?s=128&g=1", "display_name": "Trey", "link": "https://stackoverflow.com/users/2929848/trey"}, "reply_to_user": {"reputation": 296, "user_id": 6932865, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28cbd1fa231a19e77eb72c1885064471?s=128&d=identicon&r=PG&f=1", "display_name": "Jaked222", "link": "https://stackoverflow.com/users/6932865/jaked222"}, "edited": false, "score": 0, "creation_date": 1480538599, "post_id": 40896327, "comment_id": 69009353, "body": "Well I made an example, but you got it already.  That&#39;s OK, my code was not exactly production ready :-)"}], "tags": [], "owner": {"reputation": 404, "user_id": 2929848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xDJbX.png?s=128&g=1", "display_name": "Trey", "link": "https://stackoverflow.com/users/2929848/trey"}, "is_accepted": false, "score": 1, "last_activity_date": 1480533072, "creation_date": 1480533072, "answer_id": 40896327, "question_id": 40896235, "link": "https://stackoverflow.com/questions/40896235/graphics-drawstring-to-multiple-rectangles/40896327#40896327", "title": "Graphics.DrawString to multiple rectangles", "body": "<p>OK, what you would have to do is loop through each char in the string, and concatenate to a final string..\nso basically foreach (char c in mystring)...\nthen using measurestring, you check to see if the string is over the box length, if it is, start on the next rect...</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/6xe5hazb(v=vs.110).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/6xe5hazb(v=vs.110).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 296, "user_id": 6932865, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28cbd1fa231a19e77eb72c1885064471?s=128&d=identicon&r=PG&f=1", "display_name": "Jaked222", "link": "https://stackoverflow.com/users/6932865/jaked222"}, "is_accepted": true, "score": 0, "last_activity_date": 1480540926, "last_edit_date": 1480540926, "creation_date": 1480536602, "answer_id": 40897267, "question_id": 40896235, "link": "https://stackoverflow.com/questions/40896235/graphics-drawstring-to-multiple-rectangles/40897267#40897267", "title": "Graphics.DrawString to multiple rectangles", "body": "<p>This is what I have. It does what I described. Thanks for the answers.       </p>\n\n<pre><code>    public void DrawStringInTextboxes(string text, Graphics g)\n    {\n\n        String drawString = text;\n\n        PrivateFontCollection fontCollection = new PrivateFontCollection();\n        fontCollection.AddFontFile(System.Web.Hosting.HostingEnvironment.MapPath(\"~/Content/Fonts/Squidgingtons.ttf\"));\n        var squidingtonsFontFamily = fontCollection.Families[0];\n        Font squidingtons = new Font(squidingtonsFontFamily, textParameters[0].MaxFontSize);\n        Font drawFont = new Font(\"Arial\", 60);\n        SolidBrush drawBrush = new SolidBrush(Color.Black);\n\n        StringFormat drawFormat = new StringFormat();\n        drawFormat.Alignment = StringAlignment.Center;\n\n        char[] delimiterChars = { ' ' };\n        string[] words = drawString.Split(delimiterChars);\n        string finalString = \"\";\n        int textBoxIndex = 0;\n\n        foreach (string word in words)\n        {\n            //set the dimensions for the first textbox and create a rectangle with those specifications.\n            float x = textParameters[textBoxIndex].Left;\n            float y = textParameters[textBoxIndex].Top;\n            float width = textParameters[textBoxIndex].Width;\n            float height = textParameters[textBoxIndex].Height;\n            RectangleF Rect = new RectangleF(x, y, width, height);\n            //if the current finalString + the next word fits in the current box, add the word to finalString.\n            if (g.MeasureString(finalString + word + \" \", squidingtons).Width &lt; textParameters[textBoxIndex].Width) \n            {     \n                finalString = finalString + \" \" + word;\n                //if this is the last word, print the finalString and we are done.\n                if (word == words[words.Length - 1])\n                {\n                    g.DrawString(finalString, squidingtons, drawBrush, Rect, drawFormat);\n                    break;\n                }\n\n            }\n            //the current finalString + next word did not fit in the box. Draw what we have to the first box.\n            else {\n                g.DrawString(finalString, squidingtons, drawBrush, Rect, drawFormat);\n                //Hold onto the word that didnt fit. It will be the first word of the next box.\n                finalString = word;\n                if (textBoxIndex +1 &gt;= textParameters.Length)\n                {\n                    //if we are out of textboxes, we are done.\n                    break;\n                }\n                else\n                {\n                    //move on to the next textbox. The loop begins again with new specifications set for the textbox.\n                    textBoxIndex++;\n                }\n            }\n\n        }\n        squidingtons.Dispose();\n        drawBrush.Dispose();\n        drawFont.Dispose();\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3571, "user_id": 2018731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134baab491cb1a3ebff752e5ea96dcaa?s=128&d=identicon&r=PG", "display_name": "RogerN", "link": "https://stackoverflow.com/users/2018731/rogern"}, "is_accepted": false, "score": 1, "last_activity_date": 1480537388, "creation_date": 1480537388, "answer_id": 40897479, "question_id": 40896235, "link": "https://stackoverflow.com/questions/40896235/graphics-drawstring-to-multiple-rectangles/40897479#40897479", "title": "Graphics.DrawString to multiple rectangles", "body": "<p>This solution uses the <code>StringFormat</code>'s settings to ensure that each call to DrawString only draws the words that fit.  Then, <code>Graphics.MeasureCharacterRanges</code> calculates the words that don't fit into the rectangle, and the remaining text overflows into the next layout rectangle.</p>\n\n<p>You might need to customize how the input string is split into words.  Right now I'm just splitting it apart at whitespace boundaries.</p>\n\n<pre><code>using System.Text.RegularExpressions;\nusing System.Drawing;\n\n/// &lt;summary&gt;\n/// Draw a string using one or more layout rectangles.  Words which don't fit will overflow into the next layout rectangle.\n/// &lt;/summary&gt;\nprivate static void DrawOverflowString(Graphics graphics, string drawString, RectangleF[] layoutRectangles, StringAlignment alignment)\n{\n    var drawFont = new Font(\"Arial\", 16.0f);\n    var black = new SolidBrush(Color.Black);\n    var format = new StringFormat()\n    {\n        Alignment = alignment,\n        Trimming = StringTrimming.Word,\n        FormatFlags = StringFormatFlags.LineLimit\n    };\n    var wordRegex = new Regex(\"[^\\\\s]+\");\n    string remainingText = drawString;\n    foreach (var layoutRect in layoutRectangles)\n    {\n        // Draw everything that will fit into this text box\n        graphics.DrawString(remainingText, drawFont, black, layoutRect, format);\n\n        // calculate which words did not fit\n        var wordMatches = wordRegex.Matches(remainingText);\n        var ranges = wordMatches.OfType&lt;Match&gt;().Select(x =&gt; new CharacterRange(x.Index, x.Length)).ToArray();\n        format.SetMeasurableCharacterRanges(ranges);\n        var wordRegions = graphics.MeasureCharacterRanges(remainingText, drawFont, layoutRect, format);\n\n        var allfit = true;\n        for (int i = 0; i &lt; wordRegions.Length; i++)\n        {\n            if (wordRegions[i].GetBounds(graphics).Width == 0.0f)\n            {\n                allfit = false;\n                remainingText = remainingText.Substring(wordMatches[i].Index);\n                break;\n            }\n        }\n\n        if (allfit)\n            break;\n    }\n\n    drawFont.Dispose();\n    black.Dispose();\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 404, "user_id": 2929848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xDJbX.png?s=128&g=1", "display_name": "Trey", "link": "https://stackoverflow.com/users/2929848/trey"}, "is_accepted": false, "score": 1, "last_activity_date": 1480538514, "creation_date": 1480538514, "answer_id": 40897803, "question_id": 40896235, "link": "https://stackoverflow.com/questions/40896235/graphics-drawstring-to-multiple-rectangles/40897803#40897803", "title": "Graphics.DrawString to multiple rectangles", "body": "<pre><code>        protected override void OnPaint(PaintEventArgs e)\n    {\n        // Call the OnPaint method of the base class.\n        base.OnPaint(e);\n        List&lt;Rectanglestring&gt; testrecs = new List&lt;Rectanglestring&gt;();\n        testrecs.Add(new Rectanglestring { targetrect = new Rectangle(0, 12, 40, 12), whattodraw = \"\" });\n        testrecs.Add(new Rectanglestring {targetrect= new Rectangle(0, 25, 35, 12),whattodraw=\"\" });\n        testrecs.Add(new Rectanglestring { targetrect = new Rectangle(0, 35, 35, 12), whattodraw = \"\" });\n        testrecs.Add(new Rectanglestring { targetrect = new Rectangle(0, 45, 35, 12), whattodraw = \"\" });\n        testrecs.Add(new Rectanglestring { targetrect = new Rectangle(0, 65, 35, 12), whattodraw = \"\" });\n        testrecs.Add(new Rectanglestring { targetrect = new Rectangle(0, 85, 35, 12), whattodraw = \"\" });\n        testrecs.Add(new Rectanglestring { targetrect = new Rectangle(0, 95, 55, 12), whattodraw = \"\" });\n        string mystringtofit = \"This is just an example\";\n\n        foreach (Rectanglestring rect in testrecs)\n        {\n            for (int i = 0; i &lt; mystringtofit.Length; i++)\n            {\n                if (mystringtofit[i] == ' ' &amp;&amp; rect.whattodraw.Length &gt; 0) break;\n                if (mystringtofit[i] == ' ') continue;\n                string teststring = rect.whattodraw + mystringtofit[i];\n                SizeF stringSize = stringSize = e.Graphics.MeasureString(teststring, new Font(\"Ariel\", 12));\n                if (stringSize.Width &gt;= rect.targetrect.Width) break;\n                rect.whattodraw += mystringtofit[i];\n\n\n            }\n\n            mystringtofit = mystringtofit.Substring(rect.whattodraw.Length);\n            if (mystringtofit.StartsWith(\" \"))\n            {\n                mystringtofit = mystringtofit.Substring(1);\n            }\n            e.Graphics.DrawString(rect.whattodraw, Font, new SolidBrush(ForeColor), rect.targetrect);\n        }\n        // Call methods of the System.Drawing.Graphics object.\n\n    }\n    public class Rectanglestring\n    {\n       public Rectangle targetrect = new Rectangle();\n       public string whattodraw = \"\";\n    }\n</code></pre>\n"}], "owner": {"reputation": 296, "user_id": 6932865, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/28cbd1fa231a19e77eb72c1885064471?s=128&d=identicon&r=PG&f=1", "display_name": "Jaked222", "link": "https://stackoverflow.com/users/6932865/jaked222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1462, "favorite_count": 0, "accepted_answer_id": 40897267, "answer_count": 4, "score": 0, "last_activity_date": 1480540926, "creation_date": 1480532725, "question_id": 40896235, "link": "https://stackoverflow.com/questions/40896235/graphics-drawstring-to-multiple-rectangles", "title": "Graphics.DrawString to multiple rectangles", "body": "<p>I am trying to write a function that needs to draw a string to an image. The image has anywhere from 1-5 textboxes, which each have a x,y, width, and height. These details are defined in an XML file which I am parsing, so I have access to these for each box. </p>\n\n<p>My question is whether or not I can use the graphics.DrawString (or a similar) method to do this easily. The sample function below will create a rectangle with specified x,y, width, height, and then draw a string within. If the string doesn't fit, it truncates. </p>\n\n<pre><code>    public void DrawStringRectangleFormat(Graphics g)\n    {\n        // Create string to draw.\n        String drawString = \"Sample Text is too long to fit into this tiny lil rectangle area right here\";\n\n        // Create font and brush.\n        Font drawFont = new Font(\"Arial\", 16);\n        SolidBrush drawBrush = new SolidBrush(Color.Black);\n\n        // Create rectangle for drawing.\n        float x = 150.0F;\n        float y = 150.0F;\n        float width = 200.0F;\n        float height = 50.0F;\n        RectangleF drawRect = new RectangleF(x, y, width, height);\n\n        // Set format of string.\n        StringFormat drawFormat = new StringFormat();\n        drawFormat.Alignment = StringAlignment.Center;\n\n        // Draw string to screen.\n        g.DrawString(drawString, drawFont, drawBrush, drawRect, drawFormat);\n    }\n</code></pre>\n\n<p>What I want instead of this, is rather than truncating, it will stop at the last fitting word, and go to the next rectangle(textbox). This way I can use all the available textboxes. </p>\n\n<p>Is there a method already made to do this? Otherwise I will need to implement my own drawString method. </p>\n"}, {"tags": ["c#", "multithreading", "thread-safety", "async-await", "fluent-assertions"], "answers": [{"tags": [], "owner": {"reputation": 26725, "user_id": 213550, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cyZ5c.jpg?s=128&g=1", "display_name": "VMAtm", "link": "https://stackoverflow.com/users/213550/vmatm"}, "is_accepted": true, "score": 2, "last_activity_date": 1480605186, "last_edit_date": 1480605186, "creation_date": 1480604497, "answer_id": 40913873, "question_id": 40896183, "link": "https://stackoverflow.com/questions/40896183/fluent-assertions-shouldraisepropertychangefor-does-not-work-for-async-tasks/40913873#40913873", "title": "Fluent-ASsertions ShouldRaisePropertyChangeFor does not work for async Tasks?", "body": "<p>Yes, the things is like you said: <code>await</code> pauses the execution of current method and create a state machine to get back to the method after the <code>Delay</code> is done. But the caller (a UnitTest engine) doesn't expect your tests to be asynchronous and simply ends the execution, which leads to the disposal of the objects.</p>\n\n<p>Stephen Cleary wrote a brilliant <a href=\"https://msdn.microsoft.com/en-us/magazine/dn818493.aspx\" rel=\"nofollow noreferrer\">MSDN article about Unit testing and <code>async/await</code> keywords</a>, you probably should move your code out to the method returning the <code>Task</code> and wait for all of it in test, something like this:</p>\n\n<pre><code>async Task Testing()\n{\n    await Task.Delay(100);\n    this.notifyCount.Should().Be(1);\n    this.simpleNotify.ShouldRaisePropertyChangeFor(x =&gt; x.Count);\n}\n\n[TestMethod]\npublic async Task TestMethod1()\n{\n    await Testing();\n}\n</code></pre>\n\n<p>but this still may fail as the logic after <code>await</code> may execute after the disposable being disposed.</p>\n"}, {"tags": [], "owner": {"reputation": 7805, "user_id": 1107580, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/dXu86.jpg?s=128&g=1", "display_name": "Iain Smith", "link": "https://stackoverflow.com/users/1107580/iain-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1516639527, "last_edit_date": 1516639527, "creation_date": 1516120683, "answer_id": 48285923, "question_id": 40896183, "link": "https://stackoverflow.com/questions/40896183/fluent-assertions-shouldraisepropertychangefor-does-not-work-for-async-tasks/48285923#48285923", "title": "Fluent-ASsertions ShouldRaisePropertyChangeFor does not work for async Tasks?", "body": "<p>Looks like version 5.0.0 will include support for Async tests with monitoring. </p>\n\n<p>This <a href=\"https://github.com/fluentassertions/fluentassertions/issues/477\" rel=\"nofollow noreferrer\">Issue</a> was raised and the <a href=\"https://github.com/fluentassertions/fluentassertions/pull/625\" rel=\"nofollow noreferrer\">work completed</a> just waiting on the documentation to be <a href=\"https://github.com/fluentassertions/fluentassertions/issues/592\" rel=\"nofollow noreferrer\">updated</a> and version 5.0.0 to be released.</p>\n\n<p>But for the time being there is a prerelease with the code changes <a href=\"https://github.com/fluentassertions/fluentassertions/releases/tag/5.0.0-beta.2\" rel=\"nofollow noreferrer\">5.0.0-beta2</a> can get it from the prerelease versions on NuGet</p>\n\n<p>From the change log:</p>\n\n<blockquote>\n  <p>{Breaking} Replaced the old thread-unsafe MonitorEvents API with a new\n  Monitor extension method that will return a thread-safe monitoring\n  scope that exposes methods like Should().Raise() and metadata such as\n  OccurredEvents and MonitoredEvents</p>\n</blockquote>\n\n<p>So the code with the updated NuGet will look like this:</p>\n\n<pre><code>[TestInitialize]\npublic void TestSetup()\n{\n    this.notifyCount = 0;\n    this.simpleNotify = new SimpleNotify();\n    this.simpleNotify.PropertyChanged += SimpleNotify_PropertyChanged;\n\n    Thread thread = new Thread(this.bumpCount)\n    {\n        IsBackground = true,\n        Name = @\"My Background Thread\",\n        Priority = ThreadPriority.Normal\n    };\n    thread.Start();\n}\n\n[TestMethod]\npublic async Task TestMethod1()\n{\n    using (var MonitoredSimpleNotify = this.simpleNotify.Monitor())\n    {\n        await Task.Delay(100);\n        this.notifyCount.Should().Be(1);\n        MonitoredSimpleNotify.Should().RaisePropertyChangeFor(x =&gt; x.Count); // New API for Monitoring\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 164, "user_id": 5001169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e9f3a6c9c85498a84e306f2e81f2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Bemis", "link": "https://stackoverflow.com/users/5001169/jason-bemis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 1, "accepted_answer_id": 40913873, "answer_count": 2, "score": 2, "last_activity_date": 1516639527, "creation_date": 1480532572, "last_edit_date": 1480648993, "question_id": 40896183, "link": "https://stackoverflow.com/questions/40896183/fluent-assertions-shouldraisepropertychangefor-does-not-work-for-async-tasks", "title": "Fluent-ASsertions ShouldRaisePropertyChangeFor does not work for async Tasks?", "body": "<p>I have a simple class that implements <code>INotifyPropertyChanged</code>, I invoke the property change on another thread, and I had a pretty hard time getting <code>FluentAsserts</code> to see that the <code>propertyChanged</code> was invoked.  It does not seem to happen if I use a <code>Task.Delay</code> in an <code>async Task</code> method.  But it does if I just sleep the thread.</p>\n\n<p>The <code>SimpleNotify</code> class:</p>\n\n<pre><code>namespace FluentAssertPropertyThreads\n{\n    class SimpleNotify : System.ComponentModel.INotifyPropertyChanged\n    {\n        public event System.ComponentModel.PropertyChangedEventHandler PropertyChanged;\n        private void onChange(string name)\n        {\n            this.PropertyChanged?.Invoke(this, new System.ComponentModel.PropertyChangedEventArgs(name));\n        }\n\n        private int count = 0;\n        public int Count\n        {\n            get\n            {\n                return this.count;\n            }\n\n            set\n            {\n                if (this.count != value)\n                {\n                    this.count = value;\n                    this.onChange(nameof(this.Count));\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>and here are my unit tests:</p>\n\n<pre><code>using FluentAssertions;\nusing Microsoft.VisualStudio.TestTools.UnitTesting;\nusing System;\nusing System.Threading;\nusing System.Threading.Tasks;\n\nnamespace FluentAssertPropertyThreads\n{\n    [TestClass]\n    public class UnitTest1\n    {\n        private SimpleNotify simpleNotify;\n        private int notifyCount;\n        private void bumpCount()\n        {\n            this.simpleNotify.Count++;\n        }\n\n        private void SimpleNotify_PropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)\n        {\n            SimpleNotify simpleNotify = sender as SimpleNotify;\n            if (simpleNotify == null)\n            {\n                throw new ArgumentNullException(nameof(sender), \"sender should be \" + nameof(SimpleNotify));\n            }\n\n            if (e.PropertyName.Equals(nameof(SimpleNotify.Count), StringComparison.InvariantCultureIgnoreCase))\n            {\n                this.notifyCount++;\n            }\n        }\n\n        [TestInitialize]\n        public void TestSetup()\n        {\n            this.notifyCount = 0;\n            this.simpleNotify = new SimpleNotify();\n            this.simpleNotify.PropertyChanged += SimpleNotify_PropertyChanged;\n            this.simpleNotify.MonitorEvents();\n\n            Thread thread = new Thread(this.bumpCount)\n            {\n                IsBackground = true,\n                Name = @\"My Background Thread\",\n                Priority = ThreadPriority.Normal\n            };\n            thread.Start();\n        }\n\n        [TestMethod]\n        public async Task TestMethod1()\n        {\n            await Task.Delay(100);\n            this.notifyCount.Should().Be(1);        //this passes, so I know that my notification has be executed.\n            this.simpleNotify.ShouldRaisePropertyChangeFor(x =&gt; x.Count);       //but this fails, saying that I need to be monitoring the events (which I am above)\n        }\n\n        [TestMethod]\n        public void TestMethod2()\n        {\n            Thread.Sleep(100);\n            this.notifyCount.Should().Be(1);        //this passes, so I know that my notification has be executed.\n            this.simpleNotify.ShouldRaisePropertyChangeFor(x =&gt; x.Count);       //this passes as I expected\n        }\n    }\n}\n</code></pre>\n\n<p>The exact error is:</p>\n\n<blockquote>\n  <p>System.InvalidOperationException: Object  is not being monitored for events or has already been garbage collected. Use the MonitorEvents() extension method to start monitoring events.</p>\n</blockquote>\n\n<p>I don't see how <code>MonitorEvents</code> would care if I use await or <code>Thread.Sleep</code>.  What am I missing? I get that <code>await</code> leaves the method and comes back in, whereas <code>Thread.Sleep</code> does not. </p>\n\n<p>So when it leaves the <code>TestMethod1</code> during the await, it is hitting a dispose on an object that <code>FluentAsserts</code> is using to track the properties? Could it? Should it?  </p>\n"}, {"tags": ["c#", "postgresql", "npgsql"], "comments": [{"owner": {"reputation": 202711, "user_id": 1197518, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cjKiP.png?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/1197518/steve"}, "edited": false, "score": 2, "creation_date": 1480532257, "post_id": 40896076, "comment_id": 69006031, "body": "Parameters cannot be used for fields or table names. They are used to express values for where clause or for values in insert/update"}], "answers": [{"comments": [{"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 3, "creation_date": 1480533016, "post_id": 40896274, "comment_id": 69006434, "body": "You&#39;ve just introduce a <i>gigantic</i> security vulnerability."}, {"owner": {"reputation": 673, "user_id": 5328504, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1657292367861472/picture?type=large", "display_name": "user5328504", "link": "https://stackoverflow.com/users/5328504/user5328504"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 2, "creation_date": 1480533224, "post_id": 40896274, "comment_id": 69006534, "body": "It all depends on what you&#39;re feeding to your parameter. Using a computer isa &quot;gigantic security vulnerability&quot; by itself. I dont see people panicking. It is a feature. Not a vulnerability. Please chill out"}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 1, "creation_date": 1480533855, "post_id": 40896274, "comment_id": 69006914, "body": "Since apparently you don&#39;t care at all about security, and consider it something not worth even considering, why don&#39;t you reply with your full name, bank account numbers, social security number (or other applicable tax ID), full address, all credit count numbers, and billing addresses for those numbers.  Don&#39;t worry about posting all of that publicly, it&#39;s not a vulnerability."}, {"owner": {"reputation": 15476, "user_id": 1104979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289c98242aae94f44939bf6544f70ebc?s=128&d=identicon&r=PG", "display_name": "Nick Barnes", "link": "https://stackoverflow.com/users/1104979/nick-barnes"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1480537701, "post_id": 40896274, "comment_id": 69008827, "body": "@Servy: Not every piece of dynamic SQL is a security flaw. Something like <code>&quot;SELECT * FROM &quot; + (someCondition ? &quot;a&quot; : &quot;b&quot;)</code> will never be a problem. You&#39;re only in trouble if you substitute values derived from user input."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 15476, "user_id": 1104979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289c98242aae94f44939bf6544f70ebc?s=128&d=identicon&r=PG", "display_name": "Nick Barnes", "link": "https://stackoverflow.com/users/1104979/nick-barnes"}, "edited": false, "score": 0, "creation_date": 1480538329, "post_id": 40896274, "comment_id": 69009203, "body": "@NickBarnes And yet this isn&#39;t using a fixed whitelist of values.  It&#39;s accepting an arbitrary value."}, {"owner": {"reputation": 15476, "user_id": 1104979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289c98242aae94f44939bf6544f70ebc?s=128&d=identicon&r=PG", "display_name": "Nick Barnes", "link": "https://stackoverflow.com/users/1104979/nick-barnes"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1480543401, "post_id": 40896274, "comment_id": 69011890, "body": "@Servy: We have no idea where this value is coming from. There&#39;s not a lot of context here..."}, {"owner": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "reply_to_user": {"reputation": 15476, "user_id": 1104979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289c98242aae94f44939bf6544f70ebc?s=128&d=identicon&r=PG", "display_name": "Nick Barnes", "link": "https://stackoverflow.com/users/1104979/nick-barnes"}, "edited": false, "score": 0, "creation_date": 1480543555, "post_id": 40896274, "comment_id": 69011949, "body": "@NickBarnes So, given that, don&#39;t you think suggesting something that&#39;s <i>enormously</i> dangerous unless you know, with certainty, that the input is in a whitelist of safe content, is unwise given that you don&#39;t have any idea whether or not the user is in that <i>very</i> specific situation?"}, {"owner": {"reputation": 673, "user_id": 5328504, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1657292367861472/picture?type=large", "display_name": "user5328504", "link": "https://stackoverflow.com/users/5328504/user5328504"}, "reply_to_user": {"reputation": 193178, "user_id": 1159478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cdc1819fb4534da6c044b03b7ec38fe?s=128&d=identicon&r=PG", "display_name": "Servy", "link": "https://stackoverflow.com/users/1159478/servy"}, "edited": false, "score": 0, "creation_date": 1480863920, "post_id": 40896274, "comment_id": 69129158, "body": "@Servy, it would be easier if you suggest something instead of just attacking something that has already ben discussed until the end in the community. Now, for the OP: Yeah, dont feed your stored procedure with dynamic sql stuff coming from user input. /and if you do, make sure you protect yourself from sql injection attacks."}], "tags": [], "owner": {"reputation": 673, "user_id": 5328504, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1657292367861472/picture?type=large", "display_name": "user5328504", "link": "https://stackoverflow.com/users/5328504/user5328504"}, "is_accepted": false, "score": 0, "last_activity_date": 1480532912, "creation_date": 1480532912, "answer_id": 40896274, "question_id": 40896076, "link": "https://stackoverflow.com/questions/40896076/the-parameters-dont-pass-to-the-function/40896274#40896274", "title": "The parameters don&#39;t pass to the function", "body": "<p>You can pass a tablename as a parameter using dynamic sql. Notice it is generally not recomended.</p>\n\n<p>Your sql should be a string, then you concatenate the received table name and then execute str sql string</p>\n\n<pre><code>.....create procedure etc etc etc .......\n\n/* Build Transact-SQL String with parameter value */\nSET @SQLQuery = 'SELECT * FROM ' + myTable \n/* Execute Transact-SQL String */\nEXECUTE(@SQLQuery)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 404, "user_id": 2929848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xDJbX.png?s=128&g=1", "display_name": "Trey", "link": "https://stackoverflow.com/users/2929848/trey"}, "is_accepted": false, "score": 0, "last_activity_date": 1480533524, "creation_date": 1480533524, "answer_id": 40896451, "question_id": 40896076, "link": "https://stackoverflow.com/questions/40896076/the-parameters-dont-pass-to-the-function/40896451#40896451", "title": "The parameters don&#39;t pass to the function", "body": "<p>I MAY be full of sh*t here.. but I thought the param had to start with \"@\" IE \"@tablename\", also make sure \"resource\" is a string, not a class/whatever...</p>\n"}], "owner": {"reputation": 355, "user_id": 6051306, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/eb0c9f8aa103cabcaa421fd5c7be195d?s=128&d=identicon&r=PG&f=1", "display_name": "user190794", "link": "https://stackoverflow.com/users/6051306/user190794"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1480533524, "creation_date": 1480532164, "question_id": 40896076, "link": "https://stackoverflow.com/questions/40896076/the-parameters-dont-pass-to-the-function", "title": "The parameters don&#39;t pass to the function", "body": "<pre><code>this.command.CommandText = \"\\\"GetForeignKeysTable\\\"\";\nthis.command.CommandType = CommandType.StoredProcedure;\nthis.command.Parameters.AddWithValue(\"tableName\", resource);\nFKDataTable.Load(this.command.ExecuteReader());\n</code></pre>\n\n<p>On the fourth line I get an error: GetForeignKeysTable(tableName := text) doesn't exist. PosrtgresSQL:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION \"GetForeignKeysTable\"(tableName text)\nRETURNS TABLE (\"FKFieldName\" integer, \"PKTableName\" text) AS $$\nBEGIN\n RETURN QUERY SELECT \"Id\", \"FIO\" FROM tableName;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre>\n"}, {"tags": ["c#", "linq", "lambda"], "answers": [{"tags": [], "owner": {"reputation": 3170, "user_id": 630284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TMKok.png?s=128&g=1", "display_name": "SQLMason", "link": "https://stackoverflow.com/users/630284/sqlmason"}, "is_accepted": false, "score": 0, "last_activity_date": 1480533086, "last_edit_date": 1480533086, "creation_date": 1480532303, "answer_id": 40896109, "question_id": 40896075, "link": "https://stackoverflow.com/questions/40896075/unity-c-linq-firsordefault/40896109#40896109", "title": "unity c# linq firsordefault", "body": "<p>You are looking for the <a href=\"https://msdn.microsoft.com/en-us/library/bb340482(v=vs.110).aspx\" rel=\"nofollow noreferrer\">FirstOrDefault</a> (default usually <code>null</code>) object in your <code>cardinalDirections</code> collection where the function <code>IsDirection</code> (which returns a bool) with the parameters <code>currentSwipe</code> and the item from the collection returns true.</p>\n\n<p>Think of <code>dir =&gt;</code> as declaring a variable <code>dir</code> for each object in the collection and then you're doing something with it.  For instance, <code>dir =&gt; dir.value == 'somevalue'</code> would also be correct.</p>\n\n<p>If there are two or more objects that meet the criteria, you'll get the first object in the collection.  If there are no objects that meet the criteria, you'll get the default value (<code>null</code> as mentioned above).</p>\n\n<p>To be more familiar with the syntax, please read about <a href=\"https://msdn.microsoft.com/en-us/library/bb397687.aspx\" rel=\"nofollow noreferrer\">lambda expressions</a> as provided by <strong>@BviLLe_Kid</strong>.</p>\n"}], "owner": {"reputation": 1, "user_id": 2735565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/860a8e79eaf22a13ae5371a3921ff253?s=128&d=identicon&r=PG&f=1", "display_name": "zenith", "link": "https://stackoverflow.com/users/2735565/zenith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480533086, "creation_date": 1480532162, "last_edit_date": 1480532537, "question_id": 40896075, "link": "https://stackoverflow.com/questions/40896075/unity-c-linq-firsordefault", "title": "unity c# linq firsordefault", "body": "<p>Please explain this line of code. I'm newbie and I  can't get it\nwhat does this mean: <code>(dir =&gt; IsDirection(currentSwipe, dir.Value))</code></p>\n\n<pre><code>var swipeDir = cardinalDirections.FirstOrDefault(dir =&gt; IsDirection(currentSwipe, dir.Value));\n</code></pre>\n\n<p><a href=\"https://forum.unity3d.com/threads/swipe-in-all-directions-touch-and-mouse.165416/page-2#post-2741253\" rel=\"nofollow noreferrer\">https://forum.unity3d.com/threads/swipe-in-all-directions-touch-and-mouse.165416/page-2#post-2741253</a></p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 25, "user_id": 7142474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dd7cc48fcb3c31ac914a9107d5a865?s=128&d=identicon&r=PG&f=1", "display_name": "astrength", "link": "https://stackoverflow.com/users/7142474/astrength"}, "edited": false, "score": 0, "creation_date": 1480532119, "post_id": 40896032, "comment_id": 69005949, "body": "this goes above the logout_click public partial class PatientProfileWindow : Window     {         public PatientProfileWindow(string username, List&lt;User&gt; Users)         {             InitializeComponent();             User user = new User();             User currentUser = user.GetLoggedInUser(username, Users);             userDoctorName.Content = currentUser.Doctor;   //add this once making changes to exclude doctors             userName.Content = currentUser.Name;             userWeight.Content = currentUser.Weight;             userHeight.Content = currentUser.Height;         }"}, {"owner": {"reputation": 20705, "user_id": 5174469, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/cXyx5.jpg?s=128&g=1", "display_name": "Mong Zhu", "link": "https://stackoverflow.com/users/5174469/mong-zhu"}, "edited": false, "score": 2, "creation_date": 1480532356, "post_id": 40896032, "comment_id": 69006075, "body": "there is an <a href=\"http://stackoverflow.com/posts/40896032/edit\">edit</a> button below your post. You can use it to add code and further information to your post."}, {"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 1, "creation_date": 1480532391, "post_id": 40896032, "comment_id": 69006102, "body": "are you familiar with Property&#39;s as well as how to create a utils class that can hold the information that you are wanting to do.. this is not that difficult you need to read up on Variables, and Auto Properties as well also read about .ShowDialalog and how to pass back the variables so that they can always be assigned as well as available when closing your other forms"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3094087"}, "edited": false, "score": 0, "creation_date": 1480532450, "post_id": 40896032, "comment_id": 69006133, "body": "look into the event aggregator for prism, or roll out your own, its not hard. Look into PubSub design pattern and observer pattern. For the most part you&#39;re gonna want to essentially send the message from one view to another"}, {"owner": {"reputation": 20705, "user_id": 5174469, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/cXyx5.jpg?s=128&g=1", "display_name": "Mong Zhu", "link": "https://stackoverflow.com/users/5174469/mong-zhu"}, "edited": false, "score": 1, "creation_date": 1480532568, "post_id": 40896032, "comment_id": 69006202, "body": "you could also look up <code>static</code> classes and visibility of variables within the same <code>namespace</code>"}], "answers": [{"comments": [{"owner": {"reputation": 62224, "user_id": 26160, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a3624c469abe7881d44f3d3eba5c019?s=128&d=identicon&r=PG", "display_name": "JoshBerke", "link": "https://stackoverflow.com/users/26160/joshberke"}, "edited": false, "score": 1, "creation_date": 1480533299, "post_id": 40896342, "comment_id": 69006573, "body": "Don&#39;t use a field hide it behind a property. Global fields will eventually bite you"}], "tags": [], "owner": {"reputation": 673, "user_id": 5328504, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1657292367861472/picture?type=large", "display_name": "user5328504", "link": "https://stackoverflow.com/users/5328504/user5328504"}, "is_accepted": true, "score": 1, "last_activity_date": 1480533133, "creation_date": 1480533133, "answer_id": 40896342, "question_id": 40896032, "link": "https://stackoverflow.com/questions/40896032/how-can-i-pass-a-variable-across-windows-so-that-it-can-be-used-in-every-window/40896342#40896342", "title": "How can I pass a variable across windows so that it can be used in every window or just make it visible to my entire program?", "body": "<p>There are many ways to do this. What you are looking for is a good old static class.</p>\n\n<p>create some class</p>\n\n<pre><code>public static class MySharedData {\n public static string UserID =\"\";\n}\n</code></pre>\n\n<p>and the you can use in your code\nMyShaderData.UserID = \"123\" or whatever. Notice this class does not need (nor should in this case) be instantiated)</p>\n"}, {"tags": [], "owner": {"reputation": 62224, "user_id": 26160, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2a3624c469abe7881d44f3d3eba5c019?s=128&d=identicon&r=PG", "display_name": "JoshBerke", "link": "https://stackoverflow.com/users/26160/joshberke"}, "is_accepted": false, "score": 2, "last_activity_date": 1480533237, "creation_date": 1480533237, "answer_id": 40896378, "question_id": 40896032, "link": "https://stackoverflow.com/questions/40896032/how-can-i-pass-a-variable-across-windows-so-that-it-can-be-used-in-every-window/40896378#40896378", "title": "How can I pass a variable across windows so that it can be used in every window or just make it visible to my entire program?", "body": "<p>There are many ways to skin this cat. Some better then others. </p>\n\n<p><strong>Simple Static Utility Class</strong></p>\n\n<pre><code>public static class Utils\n{\n     public static string Username{get;set;}\n}\n</code></pre>\n\n<p>You can use this class from any of your forms to set or get the data.</p>\n\n<p><strong>DI Container</strong></p>\n\n<p>Another approach is to use a DI container. I'm not sure about how to wire up a DI container, but you could pass in the dependencies you need</p>\n\n<p><strong>IPrincipal</strong>\nYou can set the current principal on the thread:</p>\n\n<pre><code>System.Threading.Thread.CurrentPrincipal=new System.Security.Principal.GenericPrincipal(new System.Security.Principal.GenericIdentity(\"josh\"),null)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7142474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58dd7cc48fcb3c31ac914a9107d5a865?s=128&d=identicon&r=PG&f=1", "display_name": "astrength", "link": "https://stackoverflow.com/users/7142474/astrength"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 40896342, "answer_count": 2, "score": 2, "last_activity_date": 1480533237, "creation_date": 1480531997, "last_edit_date": 1480532237, "question_id": 40896032, "link": "https://stackoverflow.com/questions/40896032/how-can-i-pass-a-variable-across-windows-so-that-it-can-be-used-in-every-window", "title": "How can I pass a variable across windows so that it can be used in every window or just make it visible to my entire program?", "body": "<p>My program is a fitness tracker. I can get the user logged in but once that happens need to pass the users information across windows so that their username(their unique identifier) can be used to track information properly in their file.</p>\n\n<p>login window code</p>\n\n<pre><code>public partial class UserLoginWindow : Window\n{\n    public UserLoginWindow()\n    {\n        InitializeComponent();\n    }\n\n    private void LogIn_Click(object sender, RoutedEventArgs e)\n    {\n        //loads users from file into a list we can use to search for individual user information\n        DataManagement loadUserList = new DataManagement();\n        List&lt;User&gt; Users = loadUserList.ReadUsers();\n\n        string username = Convert.ToString(userUsername.Text);\n        string password = Convert.ToString(userPassword.Text);\n\n        //checks to see if the username and password match a saved profile and allows access to\n        //profile window if the user login is valid\n        User user = new User();\n        bool allowLogin = user.UserLogIn(username, password, Users);\n        if (allowLogin == true)\n        {\n            //returns the user we are using to here so that we know \n            //what user we need to personalize the profile for\n            PatientProfileWindow patientWindow = new PatientProfileWindow(username, Users);\n            patientWindow.Show();\n            this.Close();\n        }\n        else\n        {   \n            MessageBox.Show(\"LogIn Failed. Please Try Again\");\n            userUsername.Clear();\n            userPassword.Clear();\n        }\n    }\n\n    private void CreateNewAccount_Click(object sender, RoutedEventArgs e)\n    {\n        //opens window for user to create new profile\n        CreateNewProfileWindow createProfile = new CreateNewProfileWindow();\n        createProfile.Show();\n        this.Close();\n    }\n}\n</code></pre>\n\n<p>profile window(one of the windows i want to pass the logged in users information to)</p>\n\n<pre><code>public partial class PatientProfileWindow : Window\n{\n    public PatientProfileWindow(string username, List&lt;User&gt; Users)\n    {\n        InitializeComponent();\n        User user = new User();\n        User currentUser = user.GetLoggedInUser(username, Users);\n        userDoctorName.Content = currentUser.Doctor;   //add this once making changes to exclude doctors\n        userName.Content = currentUser.Name;\n        userWeight.Content = currentUser.Weight;\n        userHeight.Content = currentUser.Height;\n    }\n\n    private void logOut_Click(object sender, RoutedEventArgs e)\n    {\n        UserLoginWindow login = new UserLoginWindow();\n        login.Show();\n        this.Close();\n    }\n\n    private void trackActivity_Click(object sender, RoutedEventArgs e)\n    {\n        TrackActivityWindow activityWindow = new TrackActivityWindow();\n        activityWindow.Show();\n        this.Close();\n    }\n\n    private void trackNutritionalIntake_Click(object sender, RoutedEventArgs e)\n    {\n        TrackNutritionalIntakeWindow intakeWindow = new TrackNutritionalIntakeWindow();\n        intakeWindow.Show();\n        this.Hide();\n    }\n\n    private void button_Click(object sender, RoutedEventArgs e)\n    {\n        EditProfileWindow editProfile = new EditProfileWindow();\n        editProfile.Show();\n        this.Hide();\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "encryption"], "comments": [{"owner": {"reputation": 5995, "user_id": 283895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/526z2.png?s=128&g=1", "display_name": "tgolisch", "link": "https://stackoverflow.com/users/283895/tgolisch"}, "edited": false, "score": 0, "creation_date": 1480541977, "post_id": 40896016, "comment_id": 69011200, "body": "How is the text sent to the server?  Is it WCF or is this a web app?  Is the client a web page or winforms or WCF?"}], "answers": [{"tags": [], "owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "is_accepted": false, "score": 0, "last_activity_date": 1480545742, "creation_date": 1480545742, "answer_id": 40899596, "question_id": 40896016, "link": "https://stackoverflow.com/questions/40896016/the-server-can-not-receive-encrypted-text-by-rsa-in-client-server-application/40899596#40899596", "title": "The server can not receive encrypted text by RSA in client/server application", "body": "<p>You can't just convert binary data to an ASCII string and hope that all the character encodings match up.  It just doesn't work like that.</p>\n\n<p>Send the encrypted data as a <code>byte[]</code>. E.g.:</p>\n\n<pre><code>networkStream.Write(encryptedtext, 0, encryptedtext.Length);\n</code></pre>\n\n<p>You'll need to make the same change on the server side.</p>\n\n<p>If you <strong>really</strong> want to send the data as a string (which I don't understand why you would want to), you can convert to base64 encoding instead of ASCII, which will be preserved properly:</p>\n\n<pre><code>string b64Str = Convert.ToBase64String(encryptedtext);\n</code></pre>\n\n<p>Also, using <code>encryptedtext</code> as your variable name for a <code>byte[]</code> is super misleading.  You should change that.  You should also not be using RSA to send payloads and instead just send a symmetric key.  But if we were going to talk about that, you should really just be using TLS over an <code>SslStream</code>.</p>\n"}], "owner": {"reputation": 148, "user_id": 6709224, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1715efeb8b97332ebfc69d458de6da7?s=128&d=identicon&r=PG&f=1", "display_name": "sara", "link": "https://stackoverflow.com/users/6709224/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480545742, "creation_date": 1480531943, "last_edit_date": 1480541878, "question_id": 40896016, "link": "https://stackoverflow.com/questions/40896016/the-server-can-not-receive-encrypted-text-by-rsa-in-client-server-application", "title": "The server can not receive encrypted text by RSA in client/server application", "body": "<p>I am using RSA to encrypted text and then send the encrypted text to a server.  My problem is the server is unable to decrypt the text because the server can not read encrypted text correctly.\nMy code in the client is :</p>\n\n<pre><code>byte[] plaintext;\nbyte[] encryptedtext=new byte[128];\nplaintext = ByteConverter.GetBytes(\"hello\");\nencryptedtext = Encryption(plaintext, RSAA.ExportParameters(false), false);\ntextBox10.Text = ByteConverter.GetString(encryptedtext);\n\nbyte[] bytesToSend = ASCIIEncoding.ASCII.GetBytes(textBox10.Text);\nnetworkStream.Write(bytesToSend, 0, bytesToSend.Length);\n</code></pre>\n\n<p>my code in server :</p>\n\n<pre><code>byte[] buffer = new byte[handlerSocket.ReceiveBufferSize];\ndataReceived = Encoding.ASCII.GetString(buffer, 0, buffer.Length);\nbyte[] encryptedtext=new byte[128] ;\n//   dataReceived = ByteConverter.GetBytes(dataReceived);\nencryptedtext = ByteConverter.GetBytes(dataReceived);\nbyte[] decryptedtex = Decryption(encryptedtext, RSA.ExportParameters(true), false);\nif(decryptedtex!=null)\n    textBox4.Text = ByteConverter.GetString(decryptedtex);\n</code></pre>\n\n<p>output :</p>\n\n<p>In client, the encrypted text : \n<code>\u5345\uf979\u40a7\uebff\uc9a0\uf70d\u6de6\u71fa\ueaad\u25d3\u339c\u10d6\uffb7\ud07a\ufffd\u3b27\u1da5\uc23f\ue26b\ub474\ua589\u243d\ub135\u054f\u61fe\ucd4c\u6458\u4651\uc6d0\ud02e\u6b52\ufffd\uc208\u9b16\u59c8\ue829\u3ad1\ue7ff\u9913\u8c9c\u01c5\u624b\ue82e\u844f\u3ed0\u3ebf\u28e8\ua1d1\u6a7f\u6701\u7e71\ufffd\u4627\u6b8d\u3c99\u39b1\u47fd\u8eae\u1ed2\u149b\u9209\u5ae1\uee6b\uc9df</code></p>\n\n<p>but when the encrypted text is received by the server, it looks like:\n<code>?????????????????????????????????????????????????????????</code>\nand the server can not decrypt the text.</p>\n\n<p>NOTE : the server has the correct information to decrypt the text (public key, private key ....)</p>\n\n<p>So how I can solve this problem ?</p>\n"}, {"tags": ["c#", "string", "for-loop", "foreach"], "comments": [{"owner": {"reputation": 17565, "user_id": 955076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd632c95781102806beec8c4020e269b?s=128&d=identicon&r=PG", "display_name": "MethodMan", "link": "https://stackoverflow.com/users/955076/methodman"}, "edited": false, "score": 0, "creation_date": 1480532124, "post_id": 40895945, "comment_id": 69005952, "body": "you can do this using a single line of code to check Upper then use the same single line of code and change it to check Lower  <code>var cnt = YourString.Count(c =&gt; Char.IsUpper(c))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7127899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed38378f1565a56a58a30fb8683ac803?s=128&d=identicon&r=PG&f=1", "display_name": "R. Jacobs", "link": "https://stackoverflow.com/users/7127899/r-jacobs"}, "edited": false, "score": 0, "creation_date": 1480531991, "post_id": 40895984, "comment_id": 69005884, "body": "That is exactly what I have in my program, have you tested this and seen result? I&#39;m just getting 0&#39;s."}], "tags": [], "owner": {"reputation": 183792, "user_id": 1749403, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/g0aFU.png?s=128&g=1", "display_name": "Sajeetharan", "link": "https://stackoverflow.com/users/1749403/sajeetharan"}, "is_accepted": false, "score": 0, "last_activity_date": 1480532526, "last_edit_date": 1480532526, "creation_date": 1480531837, "answer_id": 40895984, "question_id": 40895945, "link": "https://stackoverflow.com/questions/40895945/c-counting-the-number-of-upper-and-lower-case-letters-in-a-string/40895984#40895984", "title": "C# Counting the number of upper and lower case letters in a string", "body": "<pre><code>  string text = \"This is Sample\";\n  int upcount = 0;\n  int lowcount = 0;\n  for (int i = 0; i &lt; text.Length; i++)\n  {\n   if (char.IsUpper(text[i])) upcount++;\n   if (char.IsLower(text[i])) lowcount++;\n  }\n  Console.Write(upcount);\n  Console.Write(lowcount);\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>In your case change it like this,</p>\n\n<pre><code>if (char.IsUpper(sentence[i]))\n{\n    upperCaseLetters++;\n}\nelse (char.IsLower(sentence[i]))\n{\n    lowerCaseLetters++;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6505611"}, "is_accepted": false, "score": 1, "last_activity_date": 1480531979, "creation_date": 1480531979, "answer_id": 40896030, "question_id": 40895945, "link": "https://stackoverflow.com/questions/40895945/c-counting-the-number-of-upper-and-lower-case-letters-in-a-string/40896030#40896030", "title": "C# Counting the number of upper and lower case letters in a string", "body": "<p>You're only going to hit a single one of those conditions each time through the loop, so if your first two conditions cover every possibility (which is pretty likely, since that covers all vowels and all consonants!) you never reach your third and fourth blocks.</p>\n"}, {"comments": [{"owner": {"reputation": 5391, "user_id": 5525311, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hzYIS.png?s=128&g=1", "display_name": "Grizzly", "link": "https://stackoverflow.com/users/5525311/grizzly"}, "edited": false, "score": 0, "creation_date": 1480532497, "post_id": 40896038, "comment_id": 69006165, "body": "does the OP even need the <code>else if</code> to check for lower case?  If the letter is not UpperCase then obviously it will be LowerCase.. so that just needs to be an else statement."}, {"owner": {"reputation": 12853, "user_id": 2878550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvO6l.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2878550/dmitry"}, "reply_to_user": {"reputation": 5391, "user_id": 5525311, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hzYIS.png?s=128&g=1", "display_name": "Grizzly", "link": "https://stackoverflow.com/users/5525311/grizzly"}, "edited": false, "score": 0, "creation_date": 1480532633, "post_id": 40896038, "comment_id": 69006236, "body": "@BviLLe_Kid What if the <code>sentence[i]</code> is not a letter? For instance, a space or a punctuation char."}, {"owner": {"reputation": 5391, "user_id": 5525311, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hzYIS.png?s=128&g=1", "display_name": "Grizzly", "link": "https://stackoverflow.com/users/5525311/grizzly"}, "edited": false, "score": 0, "creation_date": 1480532725, "post_id": 40896038, "comment_id": 69006283, "body": "I can understand that, but this sounds like a homework assignment so I doubt that the string would contain numbers (I know what assume means), but the OP didn&#39;t state that they would have to account for anything besides letters."}, {"owner": {"reputation": 12853, "user_id": 2878550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvO6l.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2878550/dmitry"}, "reply_to_user": {"reputation": 5391, "user_id": 5525311, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hzYIS.png?s=128&g=1", "display_name": "Grizzly", "link": "https://stackoverflow.com/users/5525311/grizzly"}, "edited": false, "score": 0, "creation_date": 1480533027, "post_id": 40896038, "comment_id": 69006439, "body": "@BviLLe_Kid You could ask the OP about assumptions. But IMO it has nothing to do with the OP&#39;s question."}], "tags": [], "owner": {"reputation": 12853, "user_id": 2878550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RvO6l.jpg?s=128&g=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2878550/dmitry"}, "is_accepted": false, "score": 4, "last_activity_date": 1480532025, "creation_date": 1480532025, "answer_id": 40896038, "question_id": 40895945, "link": "https://stackoverflow.com/questions/40895945/c-counting-the-number-of-upper-and-lower-case-letters-in-a-string/40896038#40896038", "title": "C# Counting the number of upper and lower case letters in a string", "body": "<p>You don't need <code>else</code> before</p>\n\n<pre><code>else if (char.IsUpper(sentence[i]))\n</code></pre>\n\n<p>Because you have two <strong>independent</strong> sets of conditions:</p>\n\n<ol>\n<li>Vowel / Consonant</li>\n<li>UpperCase / LowerCase</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 7127899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed38378f1565a56a58a30fb8683ac803?s=128&d=identicon&r=PG&f=1", "display_name": "R. Jacobs", "link": "https://stackoverflow.com/users/7127899/r-jacobs"}, "edited": false, "score": 0, "creation_date": 1480532151, "post_id": 40896045, "comment_id": 69005965, "body": "You are a star! Haha such a simple fix. Thank you,"}], "tags": [], "owner": {"reputation": 14884, "user_id": 315689, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/GkAk0.png?s=128&g=1", "display_name": "dana", "link": "https://stackoverflow.com/users/315689/dana"}, "is_accepted": true, "score": 1, "last_activity_date": 1480532156, "last_edit_date": 1480532156, "creation_date": 1480532060, "answer_id": 40896045, "question_id": 40895945, "link": "https://stackoverflow.com/questions/40895945/c-counting-the-number-of-upper-and-lower-case-letters-in-a-string/40896045#40896045", "title": "C# Counting the number of upper and lower case letters in a string", "body": "<p>You have a chain of <code>if</code>/<code>else</code> statements and the first condition that is matched (either the vowels or consonants) will prevent any future conditions from being matched.  Break the <code>if</code>/<code>else</code> chain into 2 chains:</p>\n\n<ul>\n<li>Vowels vs Consonants</li>\n<li>Uppercase vs Lowercase</li>\n</ul>\n\n<p>See updated code below:</p>\n\n<pre><code>    public void Calculate()\n    {\n        foreach(string sentence in sentenceList)\n        {\n            sentences++;\n\n            for (int i = 0; i &lt; sentence.Length; i++)\n            {\n                if (vowelsArray.Contains(sentence[i]))\n                {\n                    vowels++;\n                }\n                else if (consonantsArray.Contains(sentence[i]))\n                {\n                    consonants++;\n                }\n\n                // the else was removed here!\n                if (char.IsUpper(sentence[i]))\n                {\n                    upperCaseLetters++;\n                }\n                else if (char.IsLower(sentence[i]))\n                {\n                    lowerCaseLetters++;\n                }\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5391, "user_id": 5525311, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/hzYIS.png?s=128&g=1", "display_name": "Grizzly", "link": "https://stackoverflow.com/users/5525311/grizzly"}, "is_accepted": false, "score": 0, "last_activity_date": 1480532427, "last_edit_date": 1480532427, "creation_date": 1480532079, "answer_id": 40896052, "question_id": 40895945, "link": "https://stackoverflow.com/questions/40895945/c-counting-the-number-of-upper-and-lower-case-letters-in-a-string/40896052#40896052", "title": "C# Counting the number of upper and lower case letters in a string", "body": "<p>I have tested this using <a href=\"https://dotnetfiddle.net/NRvHLU\" rel=\"nofollow noreferrer\">dotnetfiddle</a></p>\n\n<p>But here is the code that worked for me:</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\n\npublic class Program\n{\n    public static void Main()\n    {\n        int upper = 0;\n        int lower = 0;\n\n        string upperLowerCase = \"This Is A Test\";\n\n        char[] splitString = upperLowerCase.ToCharArray();\n\n        for(int i = 0; i &lt; splitString.Length; i++)\n        {\n            if(char.IsUpper(splitString[i]))\n            {\n                upper++;    \n            }\n            else\n            {\n                lower++;    \n            }\n\n        }\n\n        Console.WriteLine(\"Total Upper Case Letters: \" + upper.ToString());\n        Console.WriteLine(\"Total Lower Case Letters: \" +lower.ToString());\n    }\n}\n\n// Output\n// Total Upper Case Letters: 4\n// Total Lower Case Letters: 10\n</code></pre>\n\n<p>But in your case you need to separate conditional statements.  One to check for vowels or consonants and the other to check the case of the letter.</p>\n\n<p>So this:</p>\n\n<pre><code>else if (char.IsUpper(sentence[i]))\n{\n    upperCaseLetters++;\n}\nelse if (char.IsLower(sentence[i]))\n{\n    lowerCaseLetters++;\n}\n</code></pre>\n\n<p>Needs to be changed to:</p>\n\n<pre><code>if (char.IsUpper(sentence[i]))\n{\n    upperCaseLetters++;\n}\nelse\n{\n    lowerCaseLetters++;\n}\n</code></pre>\n\n<p>I hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 6045903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3e385e32c97598af4bd39f157ba95?s=128&d=identicon&r=PG&f=1", "display_name": "uonlyYOLOonce", "link": "https://stackoverflow.com/users/6045903/uonlyyoloonce"}, "is_accepted": false, "score": 0, "last_activity_date": 1480532652, "creation_date": 1480532652, "answer_id": 40896205, "question_id": 40895945, "link": "https://stackoverflow.com/questions/40895945/c-counting-the-number-of-upper-and-lower-case-letters-in-a-string/40896205#40896205", "title": "C# Counting the number of upper and lower case letters in a string", "body": "<p>Slightly faster version based on Sajeetharan's answer</p>\n\n<pre><code> string text = \"This is Sample\";\n  int upcount = 0;\n  int lowcount = 0;\n  for (int i = 0; i &lt; text.Length; i++)\n  {\n  if (text[i]&gt;64 &amp;&amp; text[i]&lt;91) upcount++;\n   else if (text[i]&gt;96 &amp;&amp; text[i]&lt;123) lowcount++;\n  }\n  Console.Write(upcount);\n  Console.Write(lowcount);\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7127899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed38378f1565a56a58a30fb8683ac803?s=128&d=identicon&r=PG&f=1", "display_name": "R. Jacobs", "link": "https://stackoverflow.com/users/7127899/r-jacobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2151, "favorite_count": 0, "accepted_answer_id": 40896045, "answer_count": 6, "score": 0, "last_activity_date": 1480532652, "creation_date": 1480531669, "question_id": 40895945, "link": "https://stackoverflow.com/questions/40895945/c-counting-the-number-of-upper-and-lower-case-letters-in-a-string", "title": "C# Counting the number of upper and lower case letters in a string", "body": "<p>Hi I've been asked to do a task which calculates the number of vowels, consonants, upper and lower case letters in a string.</p>\n\n<p>I'm having trouble working out upper and lower case letters in a string.\nI can successfully count the number of vowels and constants but upper and lower case letters seems to be a pain.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>    public void Calculate()\n    {\n        foreach(string sentence in sentenceList)\n        {\n            sentences++;\n\n            for (int i = 0; i &lt; sentence.Length; i++)\n            {\n                if (vowelsArray.Contains(sentence[i]))\n                {\n                    vowels++;\n                }\n                else if (consonantsArray.Contains(sentence[i]))\n                {\n                    consonants++;\n                }\n                else if (char.IsUpper(sentence[i]))\n                {\n                    upperCaseLetters++;\n                }\n                else if (char.IsLower(sentence[i]))\n                {\n                    lowerCaseLetters++;\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>The value for the upper and lower case letters is 0. (It shouldn't be)</p>\n\n<p>Any suggestions? Thanks!</p>\n"}, {"tags": ["c#", "asp.net", "tcpclient", "asp.net-4.0", "netstream"], "comments": [{"owner": {"reputation": 12613, "user_id": 2312877, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0510f99ab1ac9f932e34c2081745d710?s=128&d=identicon&r=PG", "display_name": "Kritner", "link": "https://stackoverflow.com/users/2312877/kritner"}, "edited": false, "score": 1, "creation_date": 1480531590, "post_id": 40895904, "comment_id": 69005646, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4660142/what-is-a-nullreferenceexception-and-how-do-i-fix-it\">What is a NullReferenceException, and how do I fix it?</a>"}, {"owner": {"reputation": 12613, "user_id": 2312877, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0510f99ab1ac9f932e34c2081745d710?s=128&d=identicon&r=PG", "display_name": "Kritner", "link": "https://stackoverflow.com/users/2312877/kritner"}, "edited": false, "score": 0, "creation_date": 1480531679, "post_id": 40895904, "comment_id": 69005709, "body": "your privates are only getting initialized when not a post back, once it&#39;s a postback they&#39;re null references.  Why not just initialize them in the area where they&#39;re actually used?"}, {"owner": {"reputation": 163, "user_id": 3923111, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4104f50ba881f5de6cf5c0766819cc59?s=128&d=identicon&r=PG&f=1", "display_name": "Athylus", "link": "https://stackoverflow.com/users/3923111/athylus"}, "reply_to_user": {"reputation": 12613, "user_id": 2312877, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0510f99ab1ac9f932e34c2081745d710?s=128&d=identicon&r=PG", "display_name": "Kritner", "link": "https://stackoverflow.com/users/2312877/kritner"}, "edited": false, "score": 0, "creation_date": 1480534878, "post_id": 40895904, "comment_id": 69007365, "body": "Because that did not work, the connection won&#39;t be broken. A new connection with the house will be made every time a command is given. You can close 2 windows, set 5 lamps and set a  heater. Or is that not a bad thing, to establish a connection so often? I just figured only once would be better."}], "owner": {"reputation": 163, "user_id": 3923111, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4104f50ba881f5de6cf5c0766819cc59?s=128&d=identicon&r=PG&f=1", "display_name": "Athylus", "link": "https://stackoverflow.com/users/3923111/athylus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480531480, "creation_date": 1480531480, "question_id": 40895904, "link": "https://stackoverflow.com/questions/40895904/nullrefexc-on-netstream-tcpclient", "title": "NullRefExc on netStream &amp; tcpClient", "body": "<p>I am making a website in ASP.NET 4.0. Currently I am coding the aspx.cs file. Only on the first time connecting to my page, I want to establish a connection to a TcpClient and open a NetStream. Then on every postback I want to send data to the TcpClient. What happens is that I get a NullReferenceException on my netStream variable when I try to check whether I can write to it.</p>\n\n<p>Code:</p>\n\n<pre><code>public partial class Domos : System.Web.UI.Page\n{\n    TcpClient tcpClient;\n    NetworkStream netStream;\n\n    protected void Page_Load(object sender, EventArgs e)\n    {\n        if (Page.IsPostBack)\n        {\n\n        }\n        else\n        {\n            tcpClient = new TcpClient(\"localhost\", 11000);\n            netStream = tcpClient.GetStream();\n        }\n    }\n\n    private void InteractHouse(string command)\n    {\n        //TcpClient tcpClient = new TcpClient(\"localhost\", 11000);\n        //NetworkStream netStream = tcpClient.GetStream();\n\n        if(netStream.CanWrite)\n        {\n            Byte[] sendBytes = Encoding.UTF8.GetBytes(command + \" \\n\");\n            netStream.Write(sendBytes, 0, sendBytes.Length);\n        }\n        else\n        {\n            tcpClient.Close();\n            netStream.Close();\n        }\n\n        if(netStream.CanRead)\n        {\n            byte[] bytes = new byte[tcpClient.ReceiveBufferSize];\n\n            netStream.Read(bytes, 0, (int)tcpClient.ReceiveBufferSize);\n\n            string returndata = Encoding.UTF8.GetString(bytes);\n        }\n        else\n        {\n            tcpClient.Close();\n            netStream.Close();\n            return;\n        }\n\n        netStream.Close();\n        tcpClient.Close();\n    }\n\n    protected void btn_raamLinksDicht_Click(object sender, EventArgs e)\n    {\n        InteractHouse(\"window 0 close\");\n    }\n}\n</code></pre>\n\n<p>During debugging, I noticed that before I get to my method InteractHouse, first the debugger goes to my MasterPage.Master.Cs and runs the page_load method which does nothing at the time of writing. Once I get to InteractHouse method, the debugger doesn't have any references to my variables tcpClient and netStream. However I want the connection to uniquely load on only my page Domos (House).</p>\n\n<p>Am I looking at it from the wrong point of view? I appreciate any help.</p>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 1, "creation_date": 1480531849, "post_id": 40895812, "comment_id": 69005801, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/833943/watermark-hint-text-placeholder-textbox-in-wpf\">Watermark / hint text / placeholder TextBox in WPF</a>"}, {"owner": {"reputation": 19848, "user_id": 1090206, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/BVW9D.jpg?s=128&g=1", "display_name": "Chris W.", "link": "https://stackoverflow.com/users/1090206/chris-w"}, "edited": false, "score": 0, "creation_date": 1480534204, "post_id": 40895812, "comment_id": 69007076, "body": "I retracted my close vote once I realized you&#39;re taking your example from a <a href=\"https://stackoverflow.com/questions/39213504/how-to-apply-cuebanner-for-a-textbox-in-xaml\">previous answer</a> of mine. Do you just want to make it disabled IF value = not null?"}, {"owner": {"reputation": 39, "user_id": 4779783, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/85aef085feaf7804f15dcd6c996cbd72?s=128&d=identicon&r=PG&f=1", "display_name": "Van", "link": "https://stackoverflow.com/users/4779783/van"}, "edited": false, "score": 0, "creation_date": 1480538894, "post_id": 40895812, "comment_id": 69009523, "body": "I just wanted to bind the text.  I figured out by just putting the bind at the top of the &lt;text text=[bind value] &gt;"}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 4779783, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/85aef085feaf7804f15dcd6c996cbd72?s=128&d=identicon&r=PG&f=1", "display_name": "Van", "link": "https://stackoverflow.com/users/4779783/van"}, "is_accepted": false, "score": 0, "last_activity_date": 1480540366, "last_edit_date": 1480540366, "creation_date": 1480538712, "answer_id": 40897865, "question_id": 40895812, "link": "https://stackoverflow.com/questions/40895812/how-can-i-set-hint-text-cue-banner-in-a-text-box-when-its-empty-or-null-and/40897865#40897865", "title": "How can I set hint text (cue banner) in a text box when it&#39;s empty or null, and disable if it&#39;s not empty or null?", "body": "<p>Never mind I figured out.</p>\n\n<p>I could set the textbox binding like:</p>\n\n<pre><code>&lt;TextBox Text=\"{Binding SelectedItem.FirstName,\n                        UpdateSourceTrigger=PropertyChanged}\"\n         Grid.Row=\"1\"&gt;\n</code></pre>\n\n<p>I didn't know you could do that if you had an opening and closing <code>&lt;textbox&gt;</code> and <code>&lt;/textbox&gt;</code> tags.</p>\n\n<p>I thought you could only do it if the <code>textbox</code> has a self-closing tag (<code>&lt;textbox /&gt;</code>).</p>\n\n<p>Sorry for the silly question.</p>\n"}], "owner": {"reputation": 39, "user_id": 4779783, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/85aef085feaf7804f15dcd6c996cbd72?s=128&d=identicon&r=PG&f=1", "display_name": "Van", "link": "https://stackoverflow.com/users/4779783/van"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 856, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480540412, "creation_date": 1480531161, "last_edit_date": 1480540412, "question_id": 40895812, "link": "https://stackoverflow.com/questions/40895812/how-can-i-set-hint-text-cue-banner-in-a-text-box-when-its-empty-or-null-and", "title": "How can I set hint text (cue banner) in a text box when it&#39;s empty or null, and disable if it&#39;s not empty or null?", "body": "<p>I'm new to xaml and not sure how databind works.  I'm trying to enable hint text when my text box is null.  But I'm not sure how the data bind work to disable it when it's not null.</p>\n\n<p>Here is a solution I found that works to get my hint text.  How do this code to work to disable it if my first name textbox has a value?</p>\n\n<pre><code>&lt;TextBox Grid.Row=\"1\"&gt;\n    &lt;TextBox.Style&gt;\n        &lt;Style TargetType=\"TextBox\" xmlns:sys=\"clr-namespace:System;assembly=mscorlib\"&gt;\n            &lt;Style.Resources&gt;\n                &lt;VisualBrush x:Key=\"CueBannerBrush\" AlignmentX=\"Left\" AlignmentY=\"Center\" Stretch=\"None\"&gt;\n                    &lt;VisualBrush.Visual&gt;\n                        &lt;Label Content=\"First Name\" Foreground=\"LightGray\" /&gt;\n                    &lt;/VisualBrush.Visual&gt;\n                &lt;/VisualBrush&gt;\n            &lt;/Style.Resources&gt;\n            &lt;Style.Triggers&gt;\n                &lt;Trigger Property=\"Text\" Value=\"{x:Static sys:String.Empty}\"&gt;\n                    &lt;Setter Property=\"Background\" Value=\"{StaticResource CueBannerBrush}\" /&gt;\n                &lt;/Trigger&gt;\n                &lt;Trigger Property=\"Text\" Value=\"{x:Null}\"&gt; \n                    &lt;Setter Property=\"Background\" Value=\"{StaticResource CueBannerBrush}\" /&gt;\n                &lt;/Trigger&gt;\n                &lt;Trigger Property=\"IsKeyboardFocused\" Value=\"True\"&gt;\n                    &lt;Setter Property=\"Background\" Value=\"White\" /&gt;\n                &lt;/Trigger&gt;\n            &lt;/Style.Triggers&gt;\n        &lt;/Style&gt;\n    &lt;/TextBox.Style&gt;\n\n    &lt;TextBox.Template&gt;\n        &lt;ControlTemplate&gt;\n            &lt;TextBox Text=\"{Binding SelectedItem.FirstName,UpdateSourceTrigger=PropertyChanged}\"/&gt;\n        &lt;/ControlTemplate&gt;\n    &lt;/TextBox.Template&gt;\n&lt;/TextBox&gt;\n</code></pre>\n"}, {"tags": ["c#", "visual-studio", "resharper", "stylecop", "code-cleanup"], "answers": [{"tags": [], "owner": {"reputation": 679, "user_id": 532517, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a9caa0529ee9a9262b6118b42c172927?s=128&d=identicon&r=PG&f=1", "display_name": "H.Wolper", "link": "https://stackoverflow.com/users/532517/h-wolper"}, "is_accepted": false, "score": 1, "last_activity_date": 1487769008, "creation_date": 1487769008, "answer_id": 42392431, "question_id": 40895806, "link": "https://stackoverflow.com/questions/40895806/how-to-use-stylecop-rules-to-clean-up-using-resharper/42392431#42392431", "title": "How to use StyleCop rules to clean-up using resharper", "body": "<p>You can try using StyleCop - Resharper Ultimate Extention:\n<a href=\"https://i.stack.imgur.com/rzR4m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rzR4m.png\" alt=\"StyleeCop - Resharper Ultimate Extention\"></a></p>\n\n<p>Resharper -> Extension Manager</p>\n"}], "owner": {"reputation": 1475, "user_id": 1149731, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/8LoVN.jpg?s=128&g=1", "display_name": "Vladislav Furdak", "link": "https://stackoverflow.com/users/1149731/vladislav-furdak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487769008, "creation_date": 1480531149, "question_id": 40895806, "link": "https://stackoverflow.com/questions/40895806/how-to-use-stylecop-rules-to-clean-up-using-resharper", "title": "How to use StyleCop rules to clean-up using resharper", "body": "<p>How can i make clean-up with <code>ReSharper</code> using <code>Settings.StyleCop</code> file as a rules ?\nI can't do it using only <code>ReSharper</code> clean-up settings.\nI use <code>Visual Studio</code> 2013 and 2015.</p>\n"}, {"tags": ["c#", "unity3d"], "comments": [{"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 1, "creation_date": 1480531406, "post_id": 40895789, "comment_id": 69005539, "body": "Er...if your <code>NodeType</code> class doesn&#39;t inherit from <a href=\"https://docs.unity3d.com/ScriptReference/Object.html\" rel=\"nofollow noreferrer\"><code>UnityEngine.Object</code></a>, you can&#39;t use it in <code>Object.Instantiate()</code>. And since you&#39;re trying to convert it to a <code>GameObject</code> afterwards, shouldn&#39;t the object you pass into <code>Instantiate()</code> also be of type <code>GameObject</code> (eg. A prefab)?"}, {"owner": {"reputation": 145, "user_id": 5181055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e531343a4bb328d9050bb8b73adf663?s=128&d=identicon&r=PG&f=1", "display_name": "ParagonTime", "link": "https://stackoverflow.com/users/5181055/paragontime"}, "reply_to_user": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "edited": false, "score": 0, "creation_date": 1480532314, "post_id": 40895789, "comment_id": 69006055, "body": "I&#39;m afraid that I&#39;ve lost you a bit - Your correct I failed to have NodeType Inherit correctly and fixed that which solved the error but within my inspector I can&#39;t add prefabs nor does my string appear properly."}, {"owner": {"reputation": 2480, "user_id": 3183423, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/4GQVY.jpg?s=128&g=1", "display_name": "Nika Kasradze", "link": "https://stackoverflow.com/users/3183423/nika-kasradze"}, "edited": false, "score": 1, "creation_date": 1480533242, "post_id": 40895789, "comment_id": 69006549, "body": "no, I&#39;m pretty sure your original setup was correct. instead of having <code>NodeType</code> inherit from <code>UnityEngine.Object</code> just instatiate <code>nodeTypes [Random.Range (0, nodeTypes.Length)].hexGridTiles</code>"}, {"owner": {"reputation": 145, "user_id": 5181055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e531343a4bb328d9050bb8b73adf663?s=128&d=identicon&r=PG&f=1", "display_name": "ParagonTime", "link": "https://stackoverflow.com/users/5181055/paragontime"}, "edited": false, "score": 0, "creation_date": 1480533967, "post_id": 40895789, "comment_id": 69006969, "body": "Yeah that fixed it thank you for that. If you want post that as the answer and I&#39;ll put it as accepted otherwise I&#39;ll just answer it and quote you. Thanks!"}, {"owner": {"reputation": 11125, "user_id": 1387174, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c4cb458658b24227da74b4dea41075?s=128&d=identicon&r=PG", "display_name": "Serlite", "link": "https://stackoverflow.com/users/1387174/serlite"}, "reply_to_user": {"reputation": 2480, "user_id": 3183423, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/4GQVY.jpg?s=128&g=1", "display_name": "Nika Kasradze", "link": "https://stackoverflow.com/users/3183423/nika-kasradze"}, "edited": false, "score": 0, "creation_date": 1480534526, "post_id": 40895789, "comment_id": 69007194, "body": "@NikaKasradze Oh, that makes sense - I assumed he was trying to instantiate an object with the <code>NodeType</code> script attached to it, so I was approaching the problem with a different interpretation."}, {"owner": {"reputation": 2480, "user_id": 3183423, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/4GQVY.jpg?s=128&g=1", "display_name": "Nika Kasradze", "link": "https://stackoverflow.com/users/3183423/nika-kasradze"}, "edited": false, "score": 0, "creation_date": 1480534700, "post_id": 40895789, "comment_id": 69007293, "body": "I can&#39;t convert it to an answer, so I guess you can just answer it &#175;_(\u30c4)_/&#175;"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 5181055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e531343a4bb328d9050bb8b73adf663?s=128&d=identicon&r=PG&f=1", "display_name": "ParagonTime", "link": "https://stackoverflow.com/users/5181055/paragontime"}, "is_accepted": true, "score": 0, "last_activity_date": 1480536032, "creation_date": 1480536032, "answer_id": 40897111, "question_id": 40895789, "link": "https://stackoverflow.com/questions/40895789/unity-c-instantiating-a-game-object-for-a-hex-grid-is-giving-me-the-error-can/40897111#40897111", "title": "Unity C# - Instantiating a game Object for a hex grid is giving me the error Cannot convert from CustomClass to UnityEngine.Object?", "body": "<p>The credit to this answer goes to Nika Kasradze I'm just posting it here for finality. </p>\n\n<p>Nodetype needed to be instantiated as </p>\n\n<p>nodeTypes [Random.Range (0, nodeTypes.Length)].hexGridTiles</p>\n"}], "owner": {"reputation": 145, "user_id": 5181055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e531343a4bb328d9050bb8b73adf663?s=128&d=identicon&r=PG&f=1", "display_name": "ParagonTime", "link": "https://stackoverflow.com/users/5181055/paragontime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 40897111, "answer_count": 1, "score": 0, "last_activity_date": 1534867818, "creation_date": 1480531105, "last_edit_date": 1534867818, "question_id": 40895789, "link": "https://stackoverflow.com/questions/40895789/unity-c-instantiating-a-game-object-for-a-hex-grid-is-giving-me-the-error-can", "title": "Unity C# - Instantiating a game Object for a hex grid is giving me the error Cannot convert from CustomClass to UnityEngine.Object?", "body": "<p>I have two scripts one that generate's a hex map and the other that provides the name and prefab. Within my MapGen script im getting the error </p>\n\n<blockquote>\n  <p>Argument 1: cannot convert from 'NodeType' to 'UnityEngine.Object'\n  (CS1503) (Assembly-CSharp)</p>\n</blockquote>\n\n<p>Here's the code of the first script</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections.Generic;\n\n\npublic class NodeMng : MonoBehaviour {\n\n\n    public int height; \n    public int width;\n    private float MapSizeY;\n    private float MapSizeX;\n\n\n    public GameObject selectedUnit; \n    public GameObject[] hexGridTiles;\n    public NodeType[] nodeTypes;\n\n\n\n    void Start () \n    {\n        mapGeneration();\n    }\n\n    public void mapGeneration (){\n\n\n        for (MapSizeY = 0; MapSizeY &lt; height; MapSizeY = MapSizeY + 0.88f)\n        {\n            bool doOffset = false; \n            for(MapSizeX = 0; MapSizeX &lt; width; MapSizeX = MapSizeX + 0.769f )\n            {\n                float offset = doOffset ? 0.451f : 0f; \n                MapSizeY = MapSizeY + offset; \n                Vector3 spawnPoint = new Vector3(MapSizeX, MapSizeY, 0); \n\n\n                var groundNode = (GameObject)Instantiate (nodeTypes [Random.Range (0, nodeTypes.Length)], spawnPoint, Quaternion.identity);\n\n\n                groundNode.name = \"Hex_\" + MapSizeX + \"_\" + MapSizeY; \n                groundNode.transform.SetParent(transform, true); \n                ClickableTile ct = groundNode.GetComponent&lt;ClickableTile&gt;(); \n                ct.tileX = MapSizeX;\n                ct.tileY = MapSizeY;\n                ct.map = this;\n\n                MapSizeY = MapSizeY - offset;\n                doOffset = !doOffset; //! sets to true\n            }\n        }\n    }\n\n}\n</code></pre>\n\n<p>And heres the code for the second script</p>\n\n<pre><code>using UnityEngine;\nusing System.Collections;\n\n[System.Serializable]\npublic class NodeType{\n\n    public string name;\n    public GameObject hexGridTiles;\n\n\n\n\n}\n</code></pre>\n\n<p>The error is on the following line</p>\n\n<pre><code>var groundNode = (GameObject)Instantiate (nodeTypes [Random.Range (0, nodeTypes.Length)], spawnPoint, Quaternion.identity);\n</code></pre>\n\n<p>When I change nodeTypes to hexGridTiles it works perfectly fine but in this case I need it to attach a string Value to each prefab for path-finding down the line so I'm not sure what this error is trying to tell me any help is much appreciated.</p>\n\n<p>For clarity here's a screenshot of what I'm talking about</p>\n\n<p><a href=\"https://i.stack.imgur.com/cjH0W.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cjH0W.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "json", "json.net", "deserialization"], "comments": [{"owner": {"reputation": 1406, "user_id": 3924743, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KZLkt.png?s=128&g=1", "display_name": "Dispersia", "link": "https://stackoverflow.com/users/3924743/dispersia"}, "edited": false, "score": 1, "creation_date": 1480531242, "post_id": 40895752, "comment_id": 69005456, "body": "This isn&#39;t valid json. You have both a string and an integer in the same array. Does the type matter and do you know the type that&#39;s supposed to be at the first place?"}, {"owner": {"reputation": 287, "user_id": 3978248, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/cdSp6.jpg?s=128&g=1", "display_name": "Baker1562", "link": "https://stackoverflow.com/users/3978248/baker1562"}, "edited": false, "score": 0, "creation_date": 1480531302, "post_id": 40895752, "comment_id": 69005487, "body": "Thats the output from next url : <a href=\"https://translate.googleapis.com/translate_a/single?client=gtx&amp;sl=es&amp;tl=en&amp;dt=t&amp;q=Hola\" rel=\"nofollow noreferrer\">translate.googleapis.com/translate_a/&hellip;</a>"}, {"owner": {"reputation": 1406, "user_id": 3924743, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KZLkt.png?s=128&g=1", "display_name": "Dispersia", "link": "https://stackoverflow.com/users/3924743/dispersia"}, "edited": false, "score": 2, "creation_date": 1480531511, "post_id": 40895752, "comment_id": 69005603, "body": "I would suggest going to their new api: <a href=\"https://cloud.google.com/translate/docs/translating-text#translate-translate-text-protocol\" rel=\"nofollow noreferrer\">cloud.google.com/translate/docs/&hellip;</a> that json is not valid and looks very unstable."}, {"owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "reply_to_user": {"reputation": 1406, "user_id": 3924743, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KZLkt.png?s=128&g=1", "display_name": "Dispersia", "link": "https://stackoverflow.com/users/3924743/dispersia"}, "edited": false, "score": 1, "creation_date": 1480541387, "post_id": 40895752, "comment_id": 69010884, "body": "@Dispersia: JSON does not require that the types of items in an array all have the same type. If anything is wrong with the JSON, it&#39;s the presence of empty elements in the array. JavaScript initialization notation allows this, and creates an array with no entries at the given indices, but I&#39;m not sure the actual JSON spec allows it. If you do <code>JSON.stringify([[[&quot;Hello&quot;,&quot;Hola&quot;,,,1]],,&quot;es&quot;])</code>, you get <code>&quot;[[[&quot;Hello&quot;,&quot;Hola&quot;,null,null,1]],null,&quot;es&quot;]&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 16951, "user_id": 2147652, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WqlGm.jpg?s=128&g=1", "display_name": "mybirthname", "link": "https://stackoverflow.com/users/2147652/mybirthname"}, "edited": false, "score": 0, "creation_date": 1480531744, "post_id": 40895933, "comment_id": 69005739, "body": "Okay it looks like this is valid json :) Good catch"}, {"owner": {"reputation": 1406, "user_id": 3924743, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KZLkt.png?s=128&g=1", "display_name": "Dispersia", "link": "https://stackoverflow.com/users/3924743/dispersia"}, "reply_to_user": {"reputation": 16951, "user_id": 2147652, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/WqlGm.jpg?s=128&g=1", "display_name": "mybirthname", "link": "https://stackoverflow.com/users/2147652/mybirthname"}, "edited": false, "score": 0, "creation_date": 1480531898, "post_id": 40895933, "comment_id": 69005826, "body": "@mybirthname it&#39;s still not valid, however jsonconvert creates an array of plain objects by doing this, so this could be volatile if the type changes (which the array is of different types, so who knows what else it may or may not return). But I upvote simply due to it answers the question to the best of our knowledge."}], "tags": [], "owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "is_accepted": true, "score": 3, "last_activity_date": 1480531612, "creation_date": 1480531612, "answer_id": 40895933, "question_id": 40895752, "link": "https://stackoverflow.com/questions/40895752/show-deserialize-json-in-string/40895933#40895933", "title": "Show/Deserialize JSON in string", "body": "<p>Using JSON.NET, for example, you can do this:</p>\n\n<pre><code>var jsonObject = JsonConvert.DeserializeObject&lt;JArray&gt;(\"[[[\\\"Hello\\\",\\\"Hola\\\",,,1]],,\\\"es\\\"]\");\nstring value = (string)((JValue)jsonObject[0][0][0]).Value;\nConsole.WriteLine(value);\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 3978248, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/cdSp6.jpg?s=128&g=1", "display_name": "Baker1562", "link": "https://stackoverflow.com/users/3978248/baker1562"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 40895933, "answer_count": 1, "score": -1, "last_activity_date": 1480531612, "creation_date": 1480531017, "question_id": 40895752, "link": "https://stackoverflow.com/questions/40895752/show-deserialize-json-in-string", "title": "Show/Deserialize JSON in string", "body": "<p>I have the next JSON</p>\n\n<pre><code>[[[\"Hello\",\"Hola\",,,1]],,\"es\"]\n</code></pre>\n\n<p>How can i get only the first object, in this case \"Hello\"?</p>\n"}, {"tags": ["c#", "linq"], "comments": [{"owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "edited": false, "score": 0, "creation_date": 1480530359, "post_id": 40895528, "comment_id": 69004965, "body": "For <a href=\"https://msdn.microsoft.com/en-us/library/bb534803(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Where</a> you need to pass it a <code>Func&lt;TSource,\u2002bool&gt;</code> which is not what your <code>query</code> is."}, {"owner": {"reputation": 34313, "user_id": 121309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a620f1f95441b8bde0e6c2c5140581d?s=128&d=identicon&r=PG", "display_name": "Hans Ke\ufb06ing", "link": "https://stackoverflow.com/users/121309/hans-ke%ef%ac%86ing"}, "edited": false, "score": 0, "creation_date": 1480530750, "post_id": 40895528, "comment_id": 69005189, "body": "When you do <code>c = items.Where(query);</code>, you are not filling the collection but (trying to) create a new one. See Rene Vogt&#39;s answer for a solution."}], "answers": [{"tags": [], "owner": {"reputation": 39990, "user_id": 5528593, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7JPcT.png?s=128&g=1", "display_name": "Ren&#233; Vogt", "link": "https://stackoverflow.com/users/5528593/ren%c3%a9-vogt"}, "is_accepted": true, "score": 9, "last_activity_date": 1480530366, "creation_date": 1480530366, "answer_id": 40895585, "question_id": 40895528, "link": "https://stackoverflow.com/questions/40895528/list-does-not-contain-a-definition-for-where/40895585#40895585", "title": "&#39;List&#39; does not contain a definition for &#39;Where&#39;", "body": "<p><code>List&lt;T&gt;</code> is not <code>IQueryable&lt;T&gt;</code> but <code>IEnumerable&lt;T&gt;</code>. For the <code>Where</code> extension for <code>IEnumerable&lt;T&gt;</code> you can only pass a delegate not an expression.</p>\n\n<p>I guess you want something like that:</p>\n\n<pre><code>public Collection&lt;T&gt; Filter(Func&lt;T, bool&gt; query) // only the lambda, NO expression\n{\n    Collection&lt;T&gt; c = new Collection&lt;T&gt;(items.Where(query).ToList());\n    return c;\n}\n</code></pre>\n\n<p>Note that <code>Where</code> only returns an <code>IEnumerable&lt;T&gt;</code> but not an <code>Collection&lt;T&gt;</code>. So you need to convert <code>c</code> to a <code>List&lt;T&gt;</code> and pass this to the constructor of <code>Collection&lt;T&gt;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 42405, "user_id": 1250301, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e757934cd08da0be2cc08517e86e2cab?s=128&d=identicon&r=PG", "display_name": "Matt Burland", "link": "https://stackoverflow.com/users/1250301/matt-burland"}, "is_accepted": false, "score": 2, "last_activity_date": 1480531130, "creation_date": 1480531130, "answer_id": 40895796, "question_id": 40895528, "link": "https://stackoverflow.com/questions/40895528/list-does-not-contain-a-definition-for-where/40895796#40895796", "title": "&#39;List&#39; does not contain a definition for &#39;Where&#39;", "body": "<p>If you absolutely must use an expression, there are a couple of things you could do. You can do something like this:</p>\n\n<pre><code>public ICollection&lt;T&gt; Filter(Expression&lt;Func&lt;T, bool&gt;&gt; query) {     \n    return items.AsQueryable().Where(query).ToList();\n}\n</code></pre>\n\n<p>Converting you <code>IList</code> to a <code>Queryable</code> or you could do this:</p>\n\n<pre><code>public ICollection&lt;T&gt; Filter(Expression&lt;Func&lt;T, bool&gt;&gt; query) {     \n    return items.Where(query.Compile()).ToList();\n}\n</code></pre>\n\n<p>Compiling your expression to a <code>Func&lt;T, bool&gt;</code></p>\n"}], "owner": {"reputation": 27488, "user_id": 1778465, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NxIPr.jpg?s=128&g=1", "display_name": "Get Off My Lawn", "link": "https://stackoverflow.com/users/1778465/get-off-my-lawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15009, "favorite_count": 1, "accepted_answer_id": 40895585, "answer_count": 2, "score": 10, "last_activity_date": 1480531130, "creation_date": 1480530162, "last_edit_date": 1495542267, "question_id": 40895528, "link": "https://stackoverflow.com/questions/40895528/list-does-not-contain-a-definition-for-where", "title": "&#39;List&#39; does not contain a definition for &#39;Where&#39;", "body": "<p>I am trying to create a method where I can pass a <code>Linq</code> expression as a parameter to return a new list of items.</p>\n\n<p>Currently I am doing this (<a href=\"https://stackoverflow.com/questions/1299534/linq-passing-lambda-expression-as-parameter-to-be-executed-and-returned-by-meth\">based off this answer</a>):</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Linq.Expressions;\n\nclass Collection&lt;T&gt; {\n\n    List&lt;T&gt; items = new List&lt;T&gt;();\n\n    public Collection&lt;T&gt; Filter(Expression&lt;Func&lt;T, bool&gt;&gt; query) {\n        Collection&lt;T&gt; c = new Collection&lt;T&gt;();\n        c = items.Where(query);\n        return c;\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>'List' does not contain a definition for 'Where' and the best extension method overload 'Queryable.Where(IQueryable, Expression>)' requires a receiver of type 'IQueryable'</p>\n</blockquote>\n\n<p>I am not exactly sure what to do here to fix this.</p>\n"}, {"tags": ["javascript", "c#", "jquery", "asp.net"], "answers": [{"tags": [], "owner": {"reputation": 398, "user_id": 1892310, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4mB6j.jpg?s=128&g=1", "display_name": "Ranga Dewasinghe", "link": "https://stackoverflow.com/users/1892310/ranga-dewasinghe"}, "is_accepted": true, "score": 1, "last_activity_date": 1480530662, "creation_date": 1480530662, "answer_id": 40895658, "question_id": 40895471, "link": "https://stackoverflow.com/questions/40895471/asp-javascript-checkboxlist-capture-selected-value-to-label-text/40895658#40895658", "title": "ASP JavaScript - CheckBoxList - Capture selected value to Label.Text", "body": "<p>Your setLabelText9() method should be changed following way to read multiple selected value.</p>\n\n<pre><code>        var indexes = []; \n        $('#&lt;%=txtCaregiverHelper.ClientID%&gt; :selected').each(function(i, selected){ \n          indexes[i] = $(selected).val(); \n        });\n        $('#&lt;%=Label286.ClientID%&gt;').html(indexes.join(\" \"));\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 1289621, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/c97c160d66e603442e1ddf3c72f743f9?s=128&d=identicon&r=PG", "display_name": "RazorSharp", "link": "https://stackoverflow.com/users/1289621/razorsharp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 40895658, "answer_count": 1, "score": 0, "last_activity_date": 1480530662, "creation_date": 1480529931, "question_id": 40895471, "link": "https://stackoverflow.com/questions/40895471/asp-javascript-checkboxlist-capture-selected-value-to-label-text", "title": "ASP JavaScript - CheckBoxList - Capture selected value to Label.Text", "body": "<p>I need some help.I have a checkboxlist below. </p>\n\n<pre><code>&lt;asp:Label ID=\"Label107\" runat=\"server\" Text=\"General Patient Teaching Methods Used/Information Given (Check all that apply)\" CssClass=\"rdbBlock\"&gt;&lt;/asp:Label&gt;\n                                    &lt;asp:CheckBoxList ID=\"CheckBoxList6\" runat=\"server\" CssClass=\"rdbBlock\"&gt;\n                                        &lt;asp:ListItem Text=\"&amp;nbsp;&amp;nbsp;&lt;span style=font-weight:normal;&gt;Patient/Caregiver observed&lt;/span&gt;\" Value=\"Patient/Caregiver observed\"&gt;&lt;/asp:ListItem&gt;\n                                        &lt;asp:ListItem Text=\"&amp;nbsp;&amp;nbsp;&lt;span style=font-weight:normal;&gt;Disease process&lt;/span&gt;\" Value=\"Disease process\"&gt;&lt;/asp:ListItem&gt;\n                                        &lt;asp:ListItem Text=\"&amp;nbsp;&amp;nbsp;&lt;span style=font-weight:normal;&gt;Nursing visit frequecy&lt;/span&gt;\" Value=\"ursing visit frequecy\"&gt;&lt;/asp:ListItem&gt;\n                                        &lt;asp:ListItem Text=\"&amp;nbsp;&amp;nbsp;&lt;span style=font-weight:normal;&gt;Supply management&lt;/span&lt;\" Value=\"Supply management\"&gt;&lt;/asp:ListItem&gt;\n                                        &lt;asp:ListItem Text=\"&amp;nbsp;&amp;nbsp;&lt;span style=font-weight:normal;&gt;Emergency Procedures&lt;/span&gt;\" Value=\"Emergency Procedures\"&gt;&lt;/asp:ListItem&gt;\n                                        &lt;asp:ListItem Text=\"&amp;nbsp;&amp;nbsp;&lt;span style=font-weight:normal;&gt;24 phone number&lt;/span&gt;\" Value=\"24 phone number\"&gt;&lt;/asp:ListItem&gt;\n                                        &lt;asp:ListItem Text=\"&amp;nbsp;&amp;nbsp;&lt;span style=font-weight:normal;&gt;Right/Responsibility&lt;/span&gt;\" Value=\"Right/Responsibility\"&gt;&lt;/asp:ListItem&gt;\n                                        &lt;asp:ListItem Text=\"&amp;nbsp;&amp;nbsp;&lt;span style=font-weight:normal;&gt;Reviewed infusion admission packet&lt;/span&gt;\" Value=\"Reviewed infusion admission packet\"&gt;&lt;/asp:ListItem&gt;\n                                    &lt;/asp:CheckBoxList&gt;\n</code></pre>\n\n<p>What I want to do is grab the values from the selected ListItems and set the values to a label. I want to use JavaScript/JQuery, but I can't figure it out. </p>\n\n<p>Here is what I use on TextBoxes and it works, but textboxes don't have multiple selection items to collect.</p>\n\n<blockquote>\n  <p>YES - VERY IMPORTANT - NO POST BACK!!!!</p>\n</blockquote>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n                                        function setLabelText9(e) {\n                                            e.preventDefault();  // To prevent postback\n                                            var txtValue = $('#&lt;%=txtCaregiverHelper.ClientID%&gt;').val();\n                                            $('#&lt;%=Label286.ClientID%&gt;').html(txtValue);\n                                        }\n                                        function getLabelText9(e) {\n                                            e.preventDefault(); // To prevent postback\n                                            alert($('#&lt;%=Label286.ClientID%&gt;').html());\n                                        }\n                                    &lt;/script&gt;\n</code></pre>\n\n<p>Desired result:\nIf CheckBoxList ListItem (using index) 0, 3, 5 are checked, set label to selected value from index 0, 3, 5. I can concat some values together so it looks right with spaces and punctuation. I just need the help on the javascript/jquery code to collect all the values and store them in the label text. </p>\n\n<p>thank you</p>\n"}, {"tags": ["c#", "arrays", "object"], "comments": [{"owner": {"reputation": 14263, "user_id": 1255873, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dZChN.jpg?s=128&g=1", "display_name": "Abion47", "link": "https://stackoverflow.com/users/1255873/abion47"}, "edited": false, "score": 5, "creation_date": 1480530020, "post_id": 40895446, "comment_id": 69004795, "body": "You want to use a class, not an array."}, {"owner": {"reputation": 5532, "user_id": 1980359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef38527ea758efa70dab3e7f6f3996d0?s=128&d=identicon&r=PG", "display_name": "Jite", "link": "https://stackoverflow.com/users/1980359/jite"}, "edited": false, "score": 0, "creation_date": 1480530026, "post_id": 40895446, "comment_id": 69004800, "body": "You are storing empty <code>strings</code> in that array..?"}, {"owner": {"reputation": 2777, "user_id": 2946187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HX4Kk.jpg?s=128&g=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/2946187/jim"}, "edited": false, "score": 1, "creation_date": 1480530176, "post_id": 40895446, "comment_id": 69004877, "body": "<i>&quot;I&#39;m not supposed to use list&quot;</i> ... is this a school homework exercise?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "edited": false, "score": 0, "creation_date": 1480531385, "post_id": 40895686, "comment_id": 69005529, "body": "Thank you for respondidng, but my problem was to add that other array to my array. It&#39;s a windows forms application but it doesnt matter. Or am i supposed to use a jagged array which hold other arrays?                                                        private const int maxNumOfElements = 50; private Class[] theList = new Class[maxNumOfElements];                          this is the array I want to save."}, {"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "reply_to_user": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "edited": false, "score": 0, "creation_date": 1480531542, "post_id": 40895686, "comment_id": 69005624, "body": "Ok let me clarify, I&#39;ll update the answer.  So you have Array1, and you need to copy it into Array2 only?  Sorry, the &quot;not supposed to use a list&quot; comment confused me initially.  Can you clarify, the &quot;create another array that holds that array, a name, desciption and a category&quot; part?  That looks to me like it&#39;s asking for a class, not an array."}, {"owner": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "edited": false, "score": 0, "creation_date": 1480531821, "post_id": 40895686, "comment_id": 69005786, "body": "Sorry, &quot;You want to use a class, not an array.&quot; \u2013 Abion47. Guess that&#39;s what I&#39;m trying to say. Array of objects."}, {"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "reply_to_user": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "edited": false, "score": 0, "creation_date": 1480532243, "post_id": 40895686, "comment_id": 69006025, "body": "Ok, before I rework this, just to make sure.  You&#39;re wanting a starting array  (I&#39;ll call it Array1) with 3 objects, Name, Description, and Category.  With this array, you want to create a second array (Array2) containing Name, Description, Category, and Array1?"}, {"owner": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "edited": false, "score": 0, "creation_date": 1480533314, "post_id": 40895686, "comment_id": 69006584, "body": "nevermind, sorry for wasting your time, I will just fail this assignment."}, {"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "reply_to_user": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "edited": false, "score": 0, "creation_date": 1480534796, "post_id": 40895686, "comment_id": 69007337, "body": "Nah don&#39;t give up.  This is called requirements gathering.  It&#39;s a huge step in your future career...  We just need to get to where I understand what you need clearly, and I&#39;ll help you out.  Don&#39;t lose hope, we&#39;ll get it..  Tell me what inputs you have, and what outputs you want for starters... Input is an array, output is an array, correct?"}, {"owner": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "edited": false, "score": 0, "creation_date": 1480535200, "post_id": 40895686, "comment_id": 69007537, "body": "If you have an array of reference types, i.e. objects, you create the array first and then create each element of the array.  For instance, if you have array of Recipes (as in the RecipeManager), to add a Recipe object in the array or save one at any position, the Recipeobject must have been created using the keyword new, in addition to that the array itself is created: o Create the array:  private Recipe[] recipeArray = new Recipe[maxItems];o recipeArray[index] = new Recipe(maxIngredients);"}, {"owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "reply_to_user": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "edited": false, "score": 0, "creation_date": 1480535430, "post_id": 40895686, "comment_id": 69007663, "body": "Ok, I think that was enough to get us there.  Take a look at this question, see if the answer also answers yours.  I&#39;ll check back to see if you need further help: <a href=\"http://stackoverflow.com/questions/29528886/adding-collection-to-listbox\" title=\"adding collection to listbox\">stackoverflow.com/questions/29528886/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "edited": false, "score": 0, "creation_date": 1480536176, "post_id": 40895686, "comment_id": 69008054, "body": "I guess its the same assignment, however he is using a list and his question isnt answered. Did you understand &quot;array of reference&quot; which was describred above? ^^"}], "tags": [], "owner": {"reputation": 1285, "user_id": 2171052, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4523551e31af1516a685ef1ff1f889eb?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2171052/aaron"}, "is_accepted": false, "score": 1, "last_activity_date": 1480530735, "creation_date": 1480530735, "answer_id": 40895686, "question_id": 40895446, "link": "https://stackoverflow.com/questions/40895446/how-to-save-an-object-in-an-array/40895686#40895686", "title": "How to save an object in an array", "body": "<p>Although this appears to be homework, I was once where you are.  Here is a full example in a c# winforms app, if I understand your requirement correctly:</p>\n\n<pre><code>namespace WindowsFormsApplication2\n{\npublic partial class Form1 : Form\n{\n    public Form1()\n    {\n        string[] test = new string[] { \"Test Name\",\"Test Description\",\"Test Category\"};\n        MyClass oClass = new MyClass();\n        oClass.MyArray = test;\n\n        Console.WriteLine(\"Name: \" + oClass.MyName + Environment.NewLine +\n            \"Description: \" + oClass.MyDescription + Environment.NewLine +\n            \"Category: \" + oClass.MyCategory);\n    }\n}\n class MyClass\n{\n    private string _myName;\n\n    public string MyName\n    {\n        get { return _myName; }\n        set { _myName = value; }\n    }\n\n    private string _myDesc;\n\n    public string MyDescription\n    {\n        get { return _myDesc; }\n        set { _myDesc = value; }\n    }\n    private string _myCat;\n\n    public string MyCategory\n    {\n        get { return _myCat; }\n        set { _myCat = value; }\n    }\n    private string[] _myArr;\n\n    public string[] MyArray\n    {\n        get { return _myArr; }\n        set {\n            _myArr = value;\n            MyName = value[0];\n            MyDescription = value[1];\n            MyCategory = value[2];\n        }\n    }\n\n\n}\n</code></pre>\n\n<p>}</p>\n\n<p>output</p>\n\n<p>Name: Test Name</p>\n\n<p>Description: Test Description</p>\n\n<p>Category: Test Category</p>\n"}], "owner": {"reputation": 1, "user_id": 7232358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e666678e60f2d3b2b41a1335a9a27a7?s=128&d=identicon&r=PG&f=1", "display_name": "Ina Kraemer", "link": "https://stackoverflow.com/users/7232358/ina-kraemer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1583, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1480532075, "creation_date": 1480529834, "last_edit_date": 1480532075, "question_id": 40895446, "link": "https://stackoverflow.com/questions/40895446/how-to-save-an-object-in-an-array", "title": "How to save an object in an array", "body": "<p>I have created a program and in one form i created an array that saves textbox-strings. Now i want to create another array that holds that array, a name, desciption and a category. I'm not supposed to use list, I think. Well the problem for med is to save the object in the second array.</p>\n\n<pre><code>    private const int maxNumOfElements = 50;\n    private myClass[] theList = new myClass[maxNumOfElements];\n</code></pre>\n"}, {"tags": ["c#", "asp.net", ".net", "azure", "azure-storage-blobs"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5436557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/528382e4f6e11738e0f7438934066263?s=128&d=identicon&r=PG&f=1", "display_name": "Walaa El Kerdy", "link": "https://stackoverflow.com/users/5436557/walaa-el-kerdy"}, "edited": false, "score": 0, "creation_date": 1480601914, "post_id": 40903543, "comment_id": 69038008, "body": "Thank you for your answer. Does that happen when trying to use DownloadText() from multiple AJAX calls simultaneously?"}, {"owner": {"reputation": 22308, "user_id": 7005159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550c3427cedf0d13b6d2b03bf25a793f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Sun - MSFT", "link": "https://stackoverflow.com/users/7005159/tom-sun-msft"}, "reply_to_user": {"reputation": 31, "user_id": 5436557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/528382e4f6e11738e0f7438934066263?s=128&d=identicon&r=PG&f=1", "display_name": "Walaa El Kerdy", "link": "https://stackoverflow.com/users/5436557/walaa-el-kerdy"}, "edited": false, "score": 0, "creation_date": 1480656963, "post_id": 40903543, "comment_id": 69062258, "body": "If the resource is accessed or changed by multiple apps, please have a try to make sure the orginal files are not changed."}], "tags": [], "owner": {"reputation": 22308, "user_id": 7005159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550c3427cedf0d13b6d2b03bf25a793f?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Sun - MSFT", "link": "https://stackoverflow.com/users/7005159/tom-sun-msft"}, "is_accepted": false, "score": 4, "last_activity_date": 1480571808, "creation_date": 1480571808, "answer_id": 40903543, "question_id": 40895434, "link": "https://stackoverflow.com/questions/40895434/the-remote-server-returned-an-error-412-the-condition-specified-using-http-co/40903543#40903543", "title": "The remote server returned an error: (412) The condition specified using HTTP conditional header(s) is not met..", "body": "<p>According to the error message, it seems that blob content has been changed when try to download the blob content. The ETag of the blob will be changed automatically if the blob is changed. Please have a try to use the following code to check and figure it out. More detail info about the storage conditional operations, please refer to the <a href=\"https://www.microsoftpressstore.com/articles/article.aspx?p=2224058&amp;seqNum=12\" rel=\"nofollow noreferrer\">document</a>.  </p>\n\n<pre><code>       CloudAppendBlob appendBlob = container.GetAppendBlobReference(\"myAppendBlob\");\n        appendBlob.FetchAttributes();\n        var etag = appendBlob.Properties.ETag;\n        try\n        {\n            appendBlob.DownloadText(Encoding.UTF8, AccessCondition.GenerateIfMatchCondition(etag));\n        }\n        catch (Exception)\n        {\n            appendBlob.FetchAttributes();\n            var updateEtag = appendBlob.Properties.ETag;\n            Console.WriteLine($\"Original:{etag},Updated:{updateEtag}\");\n            //To Do list\n            //appendBlob.DownloadText(Encoding.UTF8, AccessCondition.GenerateIfMatchCondition(updateEtag));\n        }\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5436557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/528382e4f6e11738e0f7438934066263?s=128&d=identicon&r=PG&f=1", "display_name": "Walaa El Kerdy", "link": "https://stackoverflow.com/users/5436557/walaa-el-kerdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2688, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1480571808, "creation_date": 1480529813, "question_id": 40895434, "link": "https://stackoverflow.com/questions/40895434/the-remote-server-returned-an-error-412-the-condition-specified-using-http-co", "title": "The remote server returned an error: (412) The condition specified using HTTP conditional header(s) is not met..", "body": "<p>I am trying to download the content of an Azure Append Blob using DownloadText(). The function is throwing an exception occasionally:</p>\n\n<p>The remote server returned an error: (412) The condition specified using HTTP conditional header(s) is not met.. </p>\n\n<p>Although I did not write any code to manage concurrency, so the default 'Last Wins' logic should be applied. The blob storage is being accessed from a Web App and API but only throwing this exception in the web app occasionally. </p>\n"}, {"tags": ["c#", "multithreading", "performance", "parallel-processing"], "comments": [{"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 3, "creation_date": 1480529852, "post_id": 40895385, "comment_id": 69004702, "body": "Simply put: Parallel is not always faster. Creating and maintaining multiple threads has some overhead cost (and will be especially noticeable on smaller scale tasks)."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7232356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d52353de96ecca62c2f0d86c031556f?s=128&d=identicon&r=PG&f=1", "display_name": "hagard", "link": "https://stackoverflow.com/users/7232356/hagard"}, "edited": false, "score": 0, "creation_date": 1480537785, "post_id": 40896553, "comment_id": 69008880, "body": "thanks for your attention. i change code and calculate time in thread method ,now parallel running time is too smaller than serial computing."}, {"owner": {"reputation": 31, "user_id": 7232356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d52353de96ecca62c2f0d86c031556f?s=128&d=identicon&r=PG&f=1", "display_name": "hagard", "link": "https://stackoverflow.com/users/7232356/hagard"}, "edited": false, "score": 0, "creation_date": 1480537945, "post_id": 40896553, "comment_id": 69008995, "body": "public void thread1()         {              time2 = Stopwatch.StartNew();             for (int k = 0; k &lt; Len; k = k + 2)             {                 string sr1 =chars[k].ToString();                 pchars[k] = sr1.ToUpper();             }              time2.Stop();         }         public void thread2()         {              time3 = Stopwatch.StartNew();             for (int q = 1; q &lt; Len; q = q + 2)             {                 string sr2 = chars[q].ToString();                 pchars[q] = sr2.ToUpper();             }             time3.Stop();         }"}, {"owner": {"reputation": 31, "user_id": 7232356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d52353de96ecca62c2f0d86c031556f?s=128&d=identicon&r=PG&f=1", "display_name": "hagard", "link": "https://stackoverflow.com/users/7232356/hagard"}, "edited": false, "score": 0, "creation_date": 1480538134, "post_id": 40896553, "comment_id": 69009089, "body": "is this method( using thread method) correct for parallel computing??"}, {"owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "reply_to_user": {"reputation": 31, "user_id": 7232356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d52353de96ecca62c2f0d86c031556f?s=128&d=identicon&r=PG&f=1", "display_name": "hagard", "link": "https://stackoverflow.com/users/7232356/hagard"}, "edited": false, "score": 0, "creation_date": 1480541402, "post_id": 40896553, "comment_id": 69010893, "body": "@hagard I&#39;m not sitting in front of an IDE but that looks more accurate."}], "tags": [], "owner": {"reputation": 10385, "user_id": 4032703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8imMA.png?s=128&g=1", "display_name": "EJoshuaS - Reinstate Monica", "link": "https://stackoverflow.com/users/4032703/ejoshuas-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1480534234, "last_edit_date": 1480534234, "creation_date": 1480533854, "answer_id": 40896553, "question_id": 40895385, "link": "https://stackoverflow.com/questions/40895385/code-for-parallel-programming-c-and-running-time/40896553#40896553", "title": "Code for parallel programming c# and running time", "body": "<p>A few points here: first, as DangerZone indicated in the comments, adding threads has some overhead, so you need to make sure that whatever you're doing on the thread is actually CPU-intensive enough to justify the overhead of the threads. In this case, it looks like it's not.</p>\n\n<p>Secondly, the following test is completely invalid:</p>\n\n<pre><code>    var time2 = Stopwatch.StartNew();\n    Thread t1 = new Thread(new ThreadStart(thread1));\n    Thread t2 = new Thread(new ThreadStart(thread2));\n    t1.Start();\n    t2.Start();\n    time2.Stop();\n</code></pre>\n\n<p>All you're actually measuring here is how long it takes to create and start the threads, not how long it actually takes to complete the tasks the threads are actually running.</p>\n\n<p>Third, for this kind of \"one-time\" task where you're just doing something once and then throwing it away, you probably want to use Task.Run or the thread pool.</p>\n"}], "owner": {"reputation": 31, "user_id": 7232356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d52353de96ecca62c2f0d86c031556f?s=128&d=identicon&r=PG&f=1", "display_name": "hagard", "link": "https://stackoverflow.com/users/7232356/hagard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 40896553, "answer_count": 1, "score": 1, "last_activity_date": 1480569619, "creation_date": 1480529659, "last_edit_date": 1480569619, "question_id": 40895385, "link": "https://stackoverflow.com/questions/40895385/code-for-parallel-programming-c-and-running-time", "title": "Code for parallel programming c# and running time", "body": "<p>For compare running time in parallel and serial computing mode,i convert a word with lowercase characters to uppercase .For parallel mode ,i run 2 threads and get running time for it.\nNow running time in parallel is greater than serial.\nWhat is wrong in my code???</p>\n\n<pre><code>    public void thread1()\n    {\n\n        for (int k = 0; k &lt; Len; k = k + 2)\n        {\n            string sr1 =chars[k].ToString();\n            pchars[k] = sr1.ToUpper();\n        }\n    }\n    public void thread2()\n    {\n        for (int q = 1; q &lt; Len; q = q + 2)\n        {\n            string sr2 = chars[q].ToString();\n            pchars[q] = sr2.ToUpper();\n        }\n    }\n\n    private void button2_Click(object sender, EventArgs e)\n    {   \n        read_array();\n        var time2 = Stopwatch.StartNew();\n        Thread t1 = new Thread(new ThreadStart(thread1));\n        Thread t2 = new Thread(new ThreadStart(thread2));\n        t1.Start();\n        t2.Start();\n        time2.Stop();\n        lbl1.Text = (time2.Elapsed.TotalMilliseconds).ToString(\"ms\");\n        Thread.Sleep(1);\n\n    }\n\n\n\n}\n</code></pre>\n"}]