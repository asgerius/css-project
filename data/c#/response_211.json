[{"tags": ["c#"], "comments": [{"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 1, "creation_date": 1548288043, "post_id": 54337464, "comment_id": 95492092, "body": "<code>StringBuilder</code> is not thread-safe (this impacts <code>builder</code> and <code>reverseS</code>). This code is not correct."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548288149, "post_id": 54337464, "comment_id": 95492117, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8831385/is-nets-stringbuilder-thread-safe\">Is .NET&#39;s StringBuilder thread-safe</a>"}, {"owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "edited": false, "score": 0, "creation_date": 1548288158, "post_id": 54337464, "comment_id": 95492119, "body": "If you are just experimenting, then you can ignore this comment, but in terms of performance this code will perform much worse than simple synchronous code. <b>Parallelism != better performance</b>"}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548288217, "post_id": 54337464, "comment_id": 95492129, "body": "It will perform slower, yes. But it also is not reliable (i.e. it won&#39;t always work) - which is far worse."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548288378, "post_id": 54337464, "comment_id": 95492164, "body": "<code>StringBuilder reverseS = new StringBuilder(s.Length);</code> You should use <code>s.Length + words.Length</code> as the capacity (not <code>s.Length</code>)."}, {"owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "edited": false, "score": 1, "creation_date": 1548288378, "post_id": 54337464, "comment_id": 95492165, "body": "By the way, even if it was thread-safe, then your letters would be in random order."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548288800, "post_id": 54337464, "comment_id": 95492259, "body": "Why do you want to optimise the code? How fast is it? How fast do you need it to be?"}], "answers": [{"tags": [], "owner": {"reputation": 4662, "user_id": 1613406, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AmV4Z.png?s=128&g=1", "display_name": "opewix", "link": "https://stackoverflow.com/users/1613406/opewix"}, "is_accepted": false, "score": 0, "last_activity_date": 1548290790, "creation_date": 1548290790, "answer_id": 54337845, "question_id": 54337464, "link": "https://stackoverflow.com/questions/54337464/how-to-use-inner-parallel-loop-within-parallel-foreach-c/54337845#54337845", "title": "How to use Inner Parallel loop within Parallel.Foreach c#?", "body": "<p>I see you have to reverse the chars but keep word positions. I don't know how good is the code below in comparison to your solution, so you can have some performance tests.</p>\n\n<p>The idea is to reverse the words in array in the main thread and start a parallel one if we encounter a very long word.</p>\n\n<pre><code>private void Reverse()\n{\n    const int extremelyLongWordLength = 100000;\n\n    var tasks = new List&lt;Task&gt;();\n    var wordStart = 0;\n    var arr = \"Hello how are you\".ToCharArray();\n    for (var i = 0; i &lt; arr.Length; i++)\n    {\n        if (arr[i] == ' ')\n        {\n            var wordEnd = i - 1;\n            if (wordEnd - wordStart &gt;= extremelyLongWordLength)\n            {\n                tasks.Add(ReverseWordAsTask(arr, wordStart, wordEnd));\n            }\n            else\n            {\n                ReverseWord(arr, wordStart, wordEnd);\n            }\n\n            wordStart = i + 1;\n        }\n    }\n\n    if (wordStart != arr.Length - 1)\n    {\n        if (arr.Length - 1 - wordStart &gt; extremelyLongWordLength)\n        {\n            tasks.Add(ReverseWordAsTask(arr, wordStart, arr.Length - 1));\n        }\n        else\n        {\n            ReverseWord(arr, wordStart, arr.Length - 1);\n        }\n    }\n\n    Task.WaitAll(tasks.ToArray());\n\n    var modifiedString = new string(arr);\n}\n\nprivate static Task ReverseWordAsTask(char[] arr, int start, int end)\n{\n    return Task.Run(() =&gt;\n    {\n        var halfWordIndex = start + (end - start) / 2;\n        for (var i = start; i &lt; halfWordIndex; i++)\n        {\n            var temp = arr[i];\n            var opposite = end - (i - start);\n            arr[i] = arr[opposite];\n            arr[opposite] = temp;\n        }\n    });\n}\n\nprivate static void ReverseWord(char[] arr, int start, int end)\n{\n    var halfWordIndex = start + (end - start) / 2;\n    for (var i = start; i &lt; halfWordIndex; i++)\n    {\n        var temp = arr[i];\n        var opposite = end - (i - start);\n        arr[i] = arr[opposite];\n        arr[opposite] = temp;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 421, "user_id": 10318265, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uN-LhLExWVs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNeUw0oCDQqh4EK_zMS4HichOk1Lg/mo/photo.jpg?sz=128", "display_name": "Prawn Hongs", "link": "https://stackoverflow.com/users/10318265/prawn-hongs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548290790, "creation_date": 1548287787, "question_id": 54337464, "link": "https://stackoverflow.com/questions/54337464/how-to-use-inner-parallel-loop-within-parallel-foreach-c", "title": "How to use Inner Parallel loop within Parallel.Foreach c#?", "body": "<p>I am trying to optimize my code, I want to call Parallel.For inside a Parallel.ForEach(). I am not sure how can I do so. If I do see that the results are not correct. My code reverses the word within a sentence.</p>\n\n<p>changed that for loop and it works.</p>\n\n<p>for (int i = word.Length - 1; i >= 0; i--)</p>\n\n<p>Here is my original code which fails.</p>\n\n<pre><code>    public string Test()\n    {\n        string s = \"Hello how are you\";\n\n        if (s.Length &gt; 0)\n        {\n            StringBuilder reverseS = new StringBuilder(s.Length);\n            string[] words = s.Split(' ');\n\n            Parallel.ForEach(words, word =&gt;\n            {\n                StringBuilder builder = new StringBuilder(word.Length);\n                Parallel.For(0, word.Length - 1, i =&gt;\n                //for (int i = word.Length - 1; i &gt;= 0; i--)\n                {\n                    builder.Append(word[i]);\n                });\n                reverseS.Append(builder);\n                reverseS.Append(\" \");\n            });\n\n            return reverseS.ToString();\n        }\n\n        else\n        {\n            return \"\";\n        }\n    }\n</code></pre>\n\n<p>olleH woh era uoy </p>\n"}, {"tags": ["c#", "visual-studio", "winforms"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1548286791, "post_id": 54337347, "comment_id": 95491840, "body": "Hook the OnClick or Changed event of the checkbox, and loop through the listview items, setting the checkbox in each item to checked."}, {"owner": {"reputation": 103049, "user_id": 3110834, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/777326f9f1ab58d98d927662f028944e?s=128&d=identicon&r=PG", "display_name": "Reza Aghaei", "link": "https://stackoverflow.com/users/3110834/reza-aghaei"}, "edited": false, "score": 0, "creation_date": 1548316420, "post_id": 54337347, "comment_id": 95499359, "body": "<a href=\"https://stackoverflow.com/a/35790015/3110834\">How to Add a Checkbox to a List View Column Header in c# Winform App?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "is_accepted": true, "score": 4, "last_activity_date": 1548287363, "creation_date": 1548287363, "answer_id": 54337428, "question_id": 54337347, "link": "https://stackoverflow.com/questions/54337347/how-to-make-one-checkbox-make-all-checboxes-checked-in-listview-c/54337428#54337428", "title": "How to make one checkbox make all checboxes checked in Listview C#", "body": "<p>Using a Button Click:</p>\n\n<pre><code>private void button1_Click(object sender, EventArgs e)\n{ \n   for (int i = 0; i &lt; listView1.Items.Count; i++)\n  {\n    listView1.Items[i].Checked = true;\n  }\n}\n</code></pre>\n\n<p>Clicking on the Column Header you can use the <code>listView1_ColumnClick(object sender, ColumnClickEventArgs e)</code> event.</p>\n"}, {"tags": [], "owner": {"reputation": 4662, "user_id": 1613406, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AmV4Z.png?s=128&g=1", "display_name": "opewix", "link": "https://stackoverflow.com/users/1613406/opewix"}, "is_accepted": false, "score": 3, "last_activity_date": 1548287532, "creation_date": 1548287532, "answer_id": 54337444, "question_id": 54337347, "link": "https://stackoverflow.com/questions/54337347/how-to-make-one-checkbox-make-all-checboxes-checked-in-listview-c/54337444#54337444", "title": "How to make one checkbox make all checboxes checked in Listview C#", "body": "<p>In case you have a separate \"Select All\" checkbox for selecting all items you can have code like:</p>\n\n<pre><code>private void cbSelectAll_CheckedChanged(object sender, EventArgs e)\n{\n    foreach (ListViewItem listViewItem in listView.Items)\n    {\n        listViewItem.Checked = cbSelectAll.Checked;\n    }\n}\n</code></pre>\n\n<p>If you want to check all items by clicking on any of list view item, then you have to subscribe to <code>ItemChecked</code> event of a list view:</p>\n\n<pre><code>private void listView_ItemChecked(object sender, ItemCheckedEventArgs e)\n{\n    foreach (ListViewItem listViewItem in listView.Items)\n    {\n        listViewItem.Checked = e.Item.Checked;\n    }\n}\n</code></pre>\n\n<p>PS: To display checkbox above list items set the <code>CheckBoxes</code> flag to <code>true</code></p>\n"}], "owner": {"reputation": 669, "user_id": 10892074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LT8aS.png?s=128&g=1", "display_name": "Vepth", "link": "https://stackoverflow.com/users/10892074/vepth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "accepted_answer_id": 54337428, "answer_count": 2, "score": 4, "last_activity_date": 1548287532, "creation_date": 1548286705, "question_id": 54337347, "link": "https://stackoverflow.com/questions/54337347/how-to-make-one-checkbox-make-all-checboxes-checked-in-listview-c", "title": "How to make one checkbox make all checboxes checked in Listview C#", "body": "<p>I am making quarantine and I have <code>listView</code> for showcase of all viruses, and I added checkbox to listview in Header Column (I don't know if I can add checkbox in header column). I added separate column with checkboxes.</p>\n\n<p>I want that checkbox in header when it's checked that all checkboxes in viewlist items are checked.</p>\n\n<p>I hope somebody can help. Thanks!</p>\n"}, {"tags": ["c#", "json", "json.net", "standards"], "answers": [{"comments": [{"owner": {"reputation": 4574, "user_id": 5838198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cacc39652dd5853658fbc9d2825b02e?s=128&d=identicon&r=PG&f=1", "display_name": "Siavas", "link": "https://stackoverflow.com/users/5838198/siavas"}, "edited": false, "score": 0, "creation_date": 1548288615, "post_id": 54337368, "comment_id": 95492220, "body": "OP seems to ask about best practices instead of a way of handling the current JSON payload. Your solution integrates smoothly with the current state but should we not try making that part better too as it is feasible in this case?"}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "reply_to_user": {"reputation": 4574, "user_id": 5838198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cacc39652dd5853658fbc9d2825b02e?s=128&d=identicon&r=PG&f=1", "display_name": "Siavas", "link": "https://stackoverflow.com/users/5838198/siavas"}, "edited": false, "score": 0, "creation_date": 1548288682, "post_id": 54337368, "comment_id": 95492229, "body": "@Siavas In what way is the JSON and my code not &quot;best practice&quot;? (and thanks for the DV)"}, {"owner": {"reputation": 520, "user_id": 2744721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L3dF1.png?s=128&g=1", "display_name": "Kyle Barnes", "link": "https://stackoverflow.com/users/2744721/kyle-barnes"}, "edited": false, "score": 1, "creation_date": 1548288845, "post_id": 54337368, "comment_id": 95492270, "body": "This is a great answer and fixes my problem given the providers current API.  However, I will still be asking for them to change the JSON to a more acceptable format.  Can anyone verify that the above JSON breaks with the standard?  <b>Is there a standard?</b>"}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "reply_to_user": {"reputation": 520, "user_id": 2744721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L3dF1.png?s=128&g=1", "display_name": "Kyle Barnes", "link": "https://stackoverflow.com/users/2744721/kyle-barnes"}, "edited": false, "score": 1, "creation_date": 1548288904, "post_id": 54337368, "comment_id": 95492283, "body": "@KyleBarnes There is no &quot;standard&quot;, and the JSON is perfectly reasonable. Personally i wouldn&#39;t ask for it to be changed."}, {"owner": {"reputation": 4574, "user_id": 5838198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cacc39652dd5853658fbc9d2825b02e?s=128&d=identicon&r=PG&f=1", "display_name": "Siavas", "link": "https://stackoverflow.com/users/5838198/siavas"}, "reply_to_user": {"reputation": 520, "user_id": 2744721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L3dF1.png?s=128&g=1", "display_name": "Kyle Barnes", "link": "https://stackoverflow.com/users/2744721/kyle-barnes"}, "edited": false, "score": 0, "creation_date": 1548288910, "post_id": 54337368, "comment_id": 95492286, "body": "Have elaborated on this in my answer (thanks too). Your code would best practice if that API could not be changed, but as @KyleBarnes mentioned, it can so making it more coherent by removing the packages numbers would do better."}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "reply_to_user": {"reputation": 4574, "user_id": 5838198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cacc39652dd5853658fbc9d2825b02e?s=128&d=identicon&r=PG&f=1", "display_name": "Siavas", "link": "https://stackoverflow.com/users/5838198/siavas"}, "edited": false, "score": 0, "creation_date": 1548289028, "post_id": 54337368, "comment_id": 95492315, "body": "@Siavas But there is <i>nothing wrong with the JSON</i>. I have seen and used this format of data many times."}, {"owner": {"reputation": 4574, "user_id": 5838198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cacc39652dd5853658fbc9d2825b02e?s=128&d=identicon&r=PG&f=1", "display_name": "Siavas", "link": "https://stackoverflow.com/users/5838198/siavas"}, "reply_to_user": {"reputation": 520, "user_id": 2744721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L3dF1.png?s=128&g=1", "display_name": "Kyle Barnes", "link": "https://stackoverflow.com/users/2744721/kyle-barnes"}, "edited": false, "score": 0, "creation_date": 1548289441, "post_id": 54337368, "comment_id": 95492396, "body": "@KyleBarnes there are standards for JSON format such as for <a href=\"https://www.odata.org/documentation/odata-version-2-0/json-format/\" rel=\"nofollow noreferrer\">OData</a> protocol, a standardised way of creating RESTful APIs backed by Microsoft, but in your case there seems not to be any restriction. It is still better to consider <b>best practices</b> as that API slightly defies YAGNI and DRY principles. One could argue this is an overkill for such scenario but it would surely help your API provider write better code in the future."}], "tags": [], "owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "is_accepted": true, "score": 7, "last_activity_date": 1548286812, "creation_date": 1548286812, "answer_id": 54337368, "question_id": 54337307, "link": "https://stackoverflow.com/questions/54337307/is-it-correct-to-include-data-as-a-key-name-in-json/54337368#54337368", "title": "Is it correct to include data as a key name in JSON?", "body": "<p>You can do this using a <code>Dictionary&lt;&gt;</code>, for example:</p>\n\n<pre><code>public partial class Rootobject\n{\n    public string Company { get; set; }\n    public Dictionary&lt;string, Package&gt; Packages { get; set; }\n}\n\npublic partial class Package\n{\n    public string Code { get; set; }\n    public string Name { get; set; }\n    public long Price { get; set; }\n}\n</code></pre>\n\n<p>And deserialise like this:</p>\n\n<pre><code>var result = JsonConvert.DeserializeObject&lt;Rootobject&gt;(json);\n</code></pre>\n\n<p>And use it like this:</p>\n\n<pre><code>foreach (var element in result.Packages)\n{\n    Console.WriteLine($\"Package: {element.Key} has name {element.Value.Name}\");\n}\n</code></pre>\n\n<p>Which would output:</p>\n\n<pre><code>Package: $package1 has name Foo\nPackage: $package2 has name Bar\nPackage: $package3 has name Another\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 0, "creation_date": 1548287145, "post_id": 54337379, "comment_id": 95491922, "body": "This would throw an exception as a <code>List&lt;&gt;</code> requires an array element."}, {"owner": {"reputation": 4574, "user_id": 5838198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cacc39652dd5853658fbc9d2825b02e?s=128&d=identicon&r=PG&f=1", "display_name": "Siavas", "link": "https://stackoverflow.com/users/5838198/siavas"}, "reply_to_user": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 0, "creation_date": 1548288315, "post_id": 54337379, "comment_id": 95492151, "body": "It would, but as OP is able to ask the API provider to change his JSON structure this would be a neater way of sending and storing these objects."}, {"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 0, "creation_date": 1548288344, "post_id": 54337379, "comment_id": 95492157, "body": "But there is no need to change the JSON, see my answer."}], "tags": [], "owner": {"reputation": 4574, "user_id": 5838198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cacc39652dd5853658fbc9d2825b02e?s=128&d=identicon&r=PG&f=1", "display_name": "Siavas", "link": "https://stackoverflow.com/users/5838198/siavas"}, "is_accepted": false, "score": -1, "last_activity_date": 1548288201, "last_edit_date": 1548288201, "creation_date": 1548286941, "answer_id": 54337379, "question_id": 54337307, "link": "https://stackoverflow.com/questions/54337307/is-it-correct-to-include-data-as-a-key-name-in-json/54337379#54337379", "title": "Is it correct to include data as a key name in JSON?", "body": "<p>Having such duplicated classes would reduce the reusability of your code significantly. This can better be achieved with a list of packages instead:</p>\n\n<pre><code>public class Rootobject\n{\n    public string company { get; set; }\n    public List&lt;Package&gt; packages { get; set; }\n}\n</code></pre>\n\n<p>And your Package class:</p>\n\n<pre><code>public class Package\n{\n    public string code { get; set; }\n    public string name { get; set; }\n    public int price { get; set; }\n} \n</code></pre>\n\n<p>This will allow to have many <code>Package</code> objects for one company. The only drawback is that you have to ask for changing it to an array there as well, but for considering best practices that would do best as package numbers do not seem to be required. Ideally you would have JSON payload received as:</p>\n\n<pre><code>{\n      \"company\": \"ABC Inc.\",\n      \"packages\": [\n        {\n          \"name\": \"Foo\",\n          \"price\": 1000\n        },\n        {\n          \"name\": \"Bar\",\n          \"price\": 2000\n        },\n        {\n          \"name\": \"Another\",\n          \"price\": 3000\n        }\n    ]\n}\n</code></pre>\n\n<p>And maybe get an Id as well if <code>name</code> is not unique.</p>\n"}], "owner": {"reputation": 520, "user_id": 2744721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L3dF1.png?s=128&g=1", "display_name": "Kyle Barnes", "link": "https://stackoverflow.com/users/2744721/kyle-barnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 54337368, "answer_count": 2, "score": 4, "last_activity_date": 1548288201, "creation_date": 1548286397, "question_id": 54337307, "link": "https://stackoverflow.com/questions/54337307/is-it-correct-to-include-data-as-a-key-name-in-json", "title": "Is it correct to include data as a key name in JSON?", "body": "<p>I am consuming an API that is providing a JSON payload.  One of the properities in the JSON is actually a data element, thus I'm unable to de-serialize the payload without adding additional classes.</p>\n\n<p>Here is the JSON:</p>\n\n<pre><code>{\n      \"company\": \"ABC Inc.\",\n      \"packages\": {\n          \"$package1\": {\n          \"code\": \"$package1\",\n          \"name\": \"Foo\",\n          \"price\": 1000\n        },\n        \"$package2\": {\n          \"code\": \"$package2\",\n          \"name\": \"Bar\",\n          \"price\": 2000\n        },\n        \"$package3\": {\n          \"code\": \"$package3\",\n          \"name\": \"Another\",\n          \"price\": 3000\n        }\n    }\n}\n</code></pre>\n\n<p>I am able to serialize using Newtonsoft.Json with the following classes:</p>\n\n<pre><code>public class Rootobject\n{\n    public string company { get; set; }\n    public Packages packages { get; set; }\n}\n\npublic class Packages\n{\n    public Package1 package1 { get; set; }\n    public Package2 package2 { get; set; }\n    public Package3 package3 { get; set; }\n}\n\npublic class Package1\n{\n    public string code { get; set; }\n    public string name { get; set; }\n    public int price { get; set; }\n}\n\npublic class Package2\n{\n    public string code { get; set; }\n    public string name { get; set; }\n    public int price { get; set; }\n}\n\npublic class Package3\n{\n    public string code { get; set; }\n    public string name { get; set; }\n    public int price { get; set; }\n} \n</code></pre>\n\n<p>Using this approach I can de-serialize using Newtonsoft.Json, but if \"package4\" is added later, then it requires me to make a code change.</p>\n\n<p>Should I push back on the developer of this API and insist on an array of packages, rather than how it is currently implemented?</p>\n"}, {"tags": ["c#", "html", ".net"], "comments": [{"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 1, "creation_date": 1548286250, "post_id": 54337216, "comment_id": 95491704, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2861/\">Options for HTML Scraping</a>?"}, {"owner": {"reputation": 183, "user_id": 1420841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/VXOlH.jpg?s=128&g=1", "display_name": "wbail", "link": "https://stackoverflow.com/users/1420841/wbail"}, "edited": false, "score": 1, "creation_date": 1548286287, "post_id": 54337216, "comment_id": 95491716, "body": "Tip: You need to try before asking. Try to write some code, and then you ask."}, {"owner": {"reputation": 1, "user_id": 10958515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1a42ce9d2ff4b3d9d3222bf98d136c?s=128&d=identicon&r=PG&f=1", "display_name": "SwordA", "link": "https://stackoverflow.com/users/10958515/sworda"}, "edited": false, "score": 0, "creation_date": 1548286817, "post_id": 54337216, "comment_id": 95491846, "body": "thing is, i dont even know how to start it..."}, {"owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "edited": false, "score": 0, "creation_date": 1548286866, "post_id": 54337216, "comment_id": 95491859, "body": "Ask your Java friends to work it out with you in pseudocode."}], "answers": [{"tags": [], "owner": {"reputation": 4662, "user_id": 1613406, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AmV4Z.png?s=128&g=1", "display_name": "opewix", "link": "https://stackoverflow.com/users/1613406/opewix"}, "is_accepted": false, "score": 0, "last_activity_date": 1548286479, "creation_date": 1548286479, "answer_id": 54337312, "question_id": 54337216, "link": "https://stackoverflow.com/questions/54337216/how-to-take-information-from-text-on-a-website-and-transfer-into-string-variable/54337312#54337312", "title": "How to take information from text on a website and transfer into string variable in C#", "body": "<p>I can suggest you to try <a href=\"https://github.com/jamietre/CsQuery\" rel=\"nofollow noreferrer\">CsQuery</a> package. You can install it with Nuget. It uses jQuery syntax to query html elements. </p>\n\n<p>See example:</p>\n\n<pre><code>using (var client = new WebClient())\n{\n    var pageHtml = client.DownloadString(\"https://shop.tcgplayer.com/...\");\n    var page = new CQ(pageHtml);\n    var priceText = page.Find(\"dl.product__market-price &gt; dd\").Text().Trim();\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10958515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1a42ce9d2ff4b3d9d3222bf98d136c?s=128&d=identicon&r=PG&f=1", "display_name": "SwordA", "link": "https://stackoverflow.com/users/10958515/sworda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1548286479, "creation_date": 1548285783, "question_id": 54337216, "link": "https://stackoverflow.com/questions/54337216/how-to-take-information-from-text-on-a-website-and-transfer-into-string-variable", "title": "How to take information from text on a website and transfer into string variable in C#", "body": "<p>I'm trying to pull the price text from <a href=\"https://shop.tcgplayer.com/productcatalog/product/show?newSearch=false&amp;ProductType=All&amp;IsProductNameExact=false&amp;ProductName=mountain\" rel=\"nofollow noreferrer\">this</a> for example, and insert it into a string variable in my project. I know from my Java friends that something along the lines of BufferedReader would do it, but I don't know what that means in Java, or what I would need in  C#.</p>\n"}, {"tags": ["c#", "asp.net-core", "asp.net-apicontroller"], "comments": [{"owner": {"reputation": 94444, "user_id": 1663001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBllQ.jpg?s=128&g=1", "display_name": "DavidG", "link": "https://stackoverflow.com/users/1663001/davidg"}, "edited": false, "score": 0, "creation_date": 1548286042, "post_id": 54337180, "comment_id": 95491649, "body": "<a href=\"https://www.strathweb.com/2018/02/exploring-the-apicontrollerattribute-and-its-features-for-asp-net-core-mvc-2-1/\" rel=\"nofollow noreferrer\">strathweb.com/2018/02/&hellip;</a>"}, {"owner": {"reputation": 6569, "user_id": 2309376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BddLg.png?s=128&g=1", "display_name": "Simply Ged", "link": "https://stackoverflow.com/users/2309376/simply-ged"}, "edited": false, "score": 1, "creation_date": 1548286250, "post_id": 54337180, "comment_id": 95491705, "body": "<a href=\"https://docs.microsoft.com/en-us/aspnet/core/web-api/?view=aspnetcore-2.2#annotation-with-apicontroller-attribute\" rel=\"nofollow noreferrer\">Official MS Docs</a>"}], "owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548285506, "creation_date": 1548285506, "question_id": 54337180, "link": "https://stackoverflow.com/questions/54337180/whats-apicontroller-attribute-good-for-precisely-especially-outside-of-develop", "title": "What&#39;s ApiController attribute good for precisely (especially outside of development)?", "body": "<p>I've seen the attribute <code>[ApiController]</code> being suggested in the template. I gto curious what's it good for because, as far I understand, my API is already recognized as an API due to <code>[Route(...)]</code> attribute. So I've checked <a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.apicontrollerattribute?view=aspnetcore-2.2\" rel=\"nofollow noreferrer\">the docs</a> telling me that it provides me with</p>\n\n<blockquote>\n  <p>features and behavior targeted at improving the developer experience for building APIs</p>\n</blockquote>\n\n<p>Well... What exactly are those features (haven't missed them previously so I'm curious what issue that attribute resolves).</p>\n\n<p>Also, I wonder if there's a point to have that attribute if we're outside the context of development, i.e. does it make any difference to add it to a pre-existing project that already runs in the production needing no maintenance.</p>\n"}, {"tags": ["c#", "object", "unity3d", "button", "camera"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 10908471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/861913003f006a077c9ca26edbb64594?s=128&d=identicon&r=PG&f=1", "display_name": "Karen", "link": "https://stackoverflow.com/users/10908471/karen"}, "edited": false, "score": 0, "creation_date": 1548287527, "post_id": 54337373, "comment_id": 95491997, "body": "Thanks, I made some progress so I&#39;ll go ahead and update my question above!"}, {"owner": {"reputation": 546, "user_id": 2139679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d487ed147b53832e540efd50b110bf64?s=128&d=identicon&r=PG", "display_name": "Soraphis", "link": "https://stackoverflow.com/users/2139679/soraphis"}, "reply_to_user": {"reputation": 89, "user_id": 10908471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/861913003f006a077c9ca26edbb64594?s=128&d=identicon&r=PG&f=1", "display_name": "Karen", "link": "https://stackoverflow.com/users/10908471/karen"}, "edited": false, "score": 0, "creation_date": 1548289102, "post_id": 54337373, "comment_id": 95492325, "body": "i&#39;ve edited my answer a bit, which might lead you in the right direction"}, {"owner": {"reputation": 89, "user_id": 10908471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/861913003f006a077c9ca26edbb64594?s=128&d=identicon&r=PG&f=1", "display_name": "Karen", "link": "https://stackoverflow.com/users/10908471/karen"}, "edited": false, "score": 0, "creation_date": 1548290134, "post_id": 54337373, "comment_id": 95492523, "body": "Ah ok, good to know. I&#39;m having some trouble figuring out how to set the position for 1st camera view though; I thought that setting &quot;transform.position&quot; to the &quot;player.transform.position&quot; would do the trick, but I seem to be too zoomed in on something (all I see is a blue blob). Any suggestions?"}], "tags": [], "owner": {"reputation": 546, "user_id": 2139679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d487ed147b53832e540efd50b110bf64?s=128&d=identicon&r=PG", "display_name": "Soraphis", "link": "https://stackoverflow.com/users/2139679/soraphis"}, "is_accepted": false, "score": 2, "last_activity_date": 1548289055, "last_edit_date": 1548289055, "creation_date": 1548286871, "answer_id": 54337373, "question_id": 54337168, "link": "https://stackoverflow.com/questions/54337168/how-can-i-implement-a-1st-person-camera-view/54337373#54337373", "title": "How can I implement a 1st person camera view?", "body": "<p>Well, while it might be okay for such a small tutorial: \nyou should not use the GUI and OnGUI stuff for ingame UI. unity released in version 4.6 (years ago) a better UI system.</p>\n\n<p>you could have 2 cameras, one for 3rd person one for 1st person. when pressing one of your buttons, you disable one camera and enable the other.</p>\n\n<hr>\n\n<p>based on your edit:</p>\n\n<p>you currently have 2 bool variables there, one for \"firstPerson\" one for \"thirdPerson\", thats redundant.</p>\n\n<p>what do you do if both are true? or both are false? just have one variable e.g. \"thirdPerson\" true -> use 3rd person, false -> use 1st person.</p>\n\n<p>also i see that you have decided to change the cameras position instead of using 2 cameras. this is also is a possible way to accomplish your goal</p>\n"}, {"tags": [], "owner": {"reputation": 396, "user_id": 8992563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20363bcb7f67b6bfc11d8bdb1d53f62a?s=128&d=identicon&r=PG", "display_name": "TehMightyPotato", "link": "https://stackoverflow.com/users/8992563/tehmightypotato"}, "is_accepted": true, "score": 1, "last_activity_date": 1548341939, "last_edit_date": 1548341939, "creation_date": 1548338480, "answer_id": 54348400, "question_id": 54337168, "link": "https://stackoverflow.com/questions/54337168/how-can-i-implement-a-1st-person-camera-view/54348400#54348400", "title": "How can I implement a 1st person camera view?", "body": "<p>You can use a single camera and change its position based on which viewing angle should be active. Try to attatch <strong>two empty objects</strong> as <strong>children</strong> to your player object and add a reference to them in your script (your camera also needs to be a child of your player for this to work). Then drag &amp; drop them from the hierarchy to the inspector and just <strong>switch between those positions</strong> like so:</p>\n\n<pre><code>public Transform firstPersonPosition;\npublic Transform thirdPersonPosition;\npublic Camera camera;\n\nprivate void GoFirstPerson()\n{\n    camera.transform.position = firstPersonPosition.position;\n}\nprivate void GoThirdPerson()\n{\n    camera.transform.position = thirdPersonPosition.position;\n}\n</code></pre>\n\n<p>You can basically use them as \"waypoints\" for your camera to jump to.</p>\n\n<p>//Edit: \nIf you are having problems with understanding how your code affects your GameObjects during Play Mode just switch to <strong>Scene View</strong> during play and look at your objects and where they are in the scene. I bet your first person camera is somewhere in your player model because you set its position to your players position.</p>\n"}], "owner": {"reputation": 89, "user_id": 10908471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/861913003f006a077c9ca26edbb64594?s=128&d=identicon&r=PG&f=1", "display_name": "Karen", "link": "https://stackoverflow.com/users/10908471/karen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 54348400, "answer_count": 2, "score": 0, "last_activity_date": 1548341939, "creation_date": 1548285420, "last_edit_date": 1548287680, "question_id": 54337168, "link": "https://stackoverflow.com/questions/54337168/how-can-i-implement-a-1st-person-camera-view", "title": "How can I implement a 1st person camera view?", "body": "<p>I'm following this tutorial right now: <a href=\"https://unity3d.com/learn/tutorials/projects/roll-ball-tutorial/moving-camera?playlist=17141\" rel=\"nofollow noreferrer\">https://unity3d.com/learn/tutorials/projects/roll-ball-tutorial/moving-camera?playlist=17141</a></p>\n\n<p>I've managed to implement a 3rd person camera view button, but I'm having trouble figuring out how to do the same for a 1st person camera view. Below is a camera control script that I attached to the main camera:</p>\n\n<pre><code>using System.Collections;\nusing System.Collections.Generic;\nusing UnityEngine;\n\npublic class cameraControls : MonoBehaviour\n{\n    public GameObject player;\n    private Vector3 offset;\n    public bool thirdPerson;\n    public bool firstPerson;\n\n    void OnGUI()\n    {\n        // 3rd person camera view\n        if (GUI.Button(new Rect(20, 50, 140, 40), \"3rd Person Camera\"))\n        {\n            thirdPerson = true;\n        }\n\n        // 1st person camera view\n        if (GUI.Button(new Rect(20, 110, 140, 40), \"1st Person Camera\"))\n        {\n            firstPerson = false;\n        }\n    }\n\n    // Start is called before the first frame update\n    void Start()\n    {\n        offset = transform.position - player.transform.position;\n    }\n\n    // Update is called once per frame\n    void Update()\n    {\n        if (thirdPerson == true)\n        {\n            transform.position = player.transform.position + offset;\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", "design-patterns"], "answers": [{"comments": [{"owner": {"reputation": 2488, "user_id": 1181621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a821f84e0c6278e65c7ab7ea35142efb?s=128&d=identicon&r=PG", "display_name": "Alex Buyny", "link": "https://stackoverflow.com/users/1181621/alex-buyny"}, "edited": false, "score": 0, "creation_date": 1548321070, "post_id": 54338460, "comment_id": 95501655, "body": "I read the above code like Discount <code>IS</code> Event, Membership <code>IS</code> Discount... To me, discount is not an event, its a rule to calculate the final price for a user."}, {"owner": {"reputation": 2488, "user_id": 1181621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a821f84e0c6278e65c7ab7ea35142efb?s=128&d=identicon&r=PG", "display_name": "Alex Buyny", "link": "https://stackoverflow.com/users/1181621/alex-buyny"}, "edited": false, "score": 0, "creation_date": 1548324968, "post_id": 54338460, "comment_id": 95504004, "body": "Also, to construct <code>Membership</code> you need an event which looks strange from domain point of view."}, {"owner": {"reputation": 10753, "user_id": 1371329, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/oqbUC.png?s=128&g=1", "display_name": "jaco0646", "link": "https://stackoverflow.com/users/1371329/jaco0646"}, "reply_to_user": {"reputation": 2488, "user_id": 1181621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a821f84e0c6278e65c7ab7ea35142efb?s=128&d=identicon&r=PG", "display_name": "Alex Buyny", "link": "https://stackoverflow.com/users/1181621/alex-buyny"}, "edited": false, "score": 1, "creation_date": 1548346651, "post_id": 54338460, "comment_id": 95517398, "body": "Don&#39;t get hung up on the names. <code>Discount</code> is just a decorator interface. If you&#39;d like to call it <code>DiscountedEvent</code> or <code>DiscountedEventWrapper</code> that&#39;s fine too. The question is tagged <code>design-patterns</code>. I recommend looking up the <code>Decorator</code> pattern, particularly the example from Head First Design Patterns. I think you&#39;ll find the structure of this code is remarkably similar to the example in the book."}, {"owner": {"reputation": 6640, "user_id": 155899, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/DmDhW.jpg?s=128&g=1", "display_name": "nfplee", "link": "https://stackoverflow.com/users/155899/nfplee"}, "edited": false, "score": 0, "creation_date": 1548532347, "post_id": 54338460, "comment_id": 95577333, "body": "Thanks, I&#39;ve been reading up on the Decorator pattern and this looks like the way to go."}], "tags": [], "owner": {"reputation": 10753, "user_id": 1371329, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/oqbUC.png?s=128&g=1", "display_name": "jaco0646", "link": "https://stackoverflow.com/users/1371329/jaco0646"}, "is_accepted": true, "score": 1, "last_activity_date": 1548296170, "creation_date": 1548296170, "answer_id": 54338460, "question_id": 54337166, "link": "https://stackoverflow.com/questions/54337166/event-price-to-have-a-membership-discount-when-events-are-unaware-of-membership/54338460#54338460", "title": "Event price to have a membership discount when events are unaware of membership", "body": "<p>I think you're on the right track with adding an interface to the Events module. I would name the interface <code>Discount</code>, since that is the domain concept you need to create. <code>Membership</code> should implement <code>Discount</code>. This relationship is consistent with the desired direction of dependency from Memberships to Events.</p>\n\n<p>In terms of an actual design pattern, I am reminded of the <code>Decorator</code> example from Head First Design Patterns, where condiments compose beverages. To apply the metaphor here: Events are the beverages and Memberships are the condiments.</p>\n\n<p>Here is some Java/pseudocode of how it might be implemented.</p>\n\n<pre><code>public class Main {\n    public static void main(String... args) {\n        Event goldenFoo = new GoldMembership(new FooEvent());\n        System.out.println(goldenFoo.eventCost());\n    }\n    interface Event {\n        String eventName();\n        double eventCost();\n    }\n    interface Discount extends Event {\n        default double discountValue() { return 0.0; }\n        default double discountPercent() { return 0.0; }\n    }\n    interface Membership extends Discount {\n        String membershipName();\n    }\n    static class FooEvent implements Event {\n        @Override public String eventName() { return \"FOO\"; }\n        @Override public double eventCost() { return 100; }\n    }\n    static class GoldMembership implements Membership {\n        private final Event event;\n        GoldMembership(Event event) {\n            this.event = event;\n        }\n        @Override public String eventName() { return event.eventName(); }\n        @Override public double eventCost() { return event.eventCost() - event.eventCost() * discountPercent(); }\n        @Override public String membershipName() { return \"GOLD\"; }\n        @Override public double discountPercent() { return 0.30; }\n    }\n}\n</code></pre>\n\n<p>Of course you can split up these classes into multiple modules. The design offers a lot of flexibility to extend in three different directions: <code>Event</code>, <code>Discount</code>, <code>Membership</code>, and to compose the domain models in different ways.</p>\n"}, {"tags": [], "owner": {"reputation": 2488, "user_id": 1181621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a821f84e0c6278e65c7ab7ea35142efb?s=128&d=identicon&r=PG", "display_name": "Alex Buyny", "link": "https://stackoverflow.com/users/1181621/alex-buyny"}, "is_accepted": false, "score": 1, "last_activity_date": 1548324618, "creation_date": 1548324618, "answer_id": 54344067, "question_id": 54337166, "link": "https://stackoverflow.com/questions/54337166/event-price-to-have-a-membership-discount-when-events-are-unaware-of-membership/54344067#54344067", "title": "Event price to have a membership discount when events are unaware of membership", "body": "<p>I'd look at introducing <code>EventRegistration</code> entity into the equation. Event itself has only base price, but the registration is something that people actually pay for.</p>\n\n<p>To construct <code>EventRegistration</code>, you will need an Event and User (who may have membership)</p>\n\n<p>I'd also introduce a <code>EventDiscount</code> entity as well, as its a separate domain concept.  And finally, <code>EventRegistrationPricingService</code> will be responsible for getting the final price for the registration and know about all discounts (regardless of the module where they are implemented). </p>\n\n<p>Something like:</p>\n\n<pre><code>public interface IEventRegistrationDiscount(){\n\n   &lt;MoneyType&gt; GetDiscountedPrice(EventRegistration registration);\n   bool IsApplicable(EventRegistration registration);\n}\n\npublic class MembershipDiscount: IEventRegistrationDiscount {\n\n    public MembershipDiscount(int percentage){\n        this.percentage = percentage;\n    }\n\n    public bool IsApplicable(EventRegistration registration){\n        return registration.User.HasMembership;\n    }\n\n    public &lt;MoneyType&gt; GetDiscountedPrice(EventRegistration registration) {\n        if (IsApplicable(registration)){\n            //your real discounting logic here\n            return new MoneyType(registration.Event.Cost*(100-percentage)/100);\n        }\n    }\n}\n\npublic class EventRegistrationPricingService\n{\n  private IEnumerable&lt;IEventDiscount&gt; discounts;\n\n  public EventDiscountService(IEnumerable&lt;IEventDiscount&gt; discounts){\n\n      this.discounts = discounts;\n  }\n\n  public &lt;MoneyType&gt; GetPrice(EventRegistration registration){\n      var applicableDiscounts = discounts.Select(x =&gt; x.IsApplicable(registration));\n      var bestDiscount = applicableDiscounts.FirstOrDefault(); \n\n\n// if you got many possible discounts then you need to figure out what is the \"best\" one\n          //there could be more logic than just discounts\n          return bestDiscount != null ? bestDiscount.GetDiscountedPrice(registration) : registration.Event.Cost;\n      }\n    }\n</code></pre>\n\n<p>Note: <code>MoneyType</code> is a type that you use for money. It should be a special type that will know how to deal with rounding at least. There are a few examples of those on the web.</p>\n"}], "owner": {"reputation": 6640, "user_id": 155899, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/DmDhW.jpg?s=128&g=1", "display_name": "nfplee", "link": "https://stackoverflow.com/users/155899/nfplee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 54338460, "answer_count": 2, "score": 0, "last_activity_date": 1548324618, "creation_date": 1548285394, "last_edit_date": 1548323973, "question_id": 54337166, "link": "https://stackoverflow.com/questions/54337166/event-price-to-have-a-membership-discount-when-events-are-unaware-of-membership", "title": "Event price to have a membership discount when events are unaware of membership", "body": "<p>I have a bit of a design pattern issue. Say I have a module called \"Events\" which has the following class:</p>\n\n<pre><code>public class Event {\n    public string Name { get; set; }\n    public decimal Cost { get; set; }\n}\n</code></pre>\n\n<p>Now say I have another module called \"Membership\" which has a dependency on this module. This is a basic membership module where if someone subscribes to a membership they will receive a discount on the cost of the events.</p>\n\n<p>The problem I have is how do I get the correct event cost in the Events module taking into account the discount when the Events module has no knowledge of the Membership module.</p>\n\n<p>One idea I have come up with is to add a service in the Events module, e.g.:</p>\n\n<pre><code>public interface IEventCost {\n    decimal GetCost(Event @event);\n}\n</code></pre>\n\n<p>Then I would implement this in the Membership module. However every time I display the event's cost I would then have to inject the service and call the GetCost method passing in the event. I'm not sure I like this idea and I was wondering if there was a design pattern to handle this scenario.</p>\n\n<p>I'd really appreciate the help.</p>\n"}, {"tags": ["c#", "unity3d"], "answers": [{"tags": [], "owner": {"reputation": 546, "user_id": 2139679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d487ed147b53832e540efd50b110bf64?s=128&d=identicon&r=PG", "display_name": "Soraphis", "link": "https://stackoverflow.com/users/2139679/soraphis"}, "is_accepted": false, "score": 0, "last_activity_date": 1548285879, "creation_date": 1548285879, "answer_id": 54337237, "question_id": 54337079, "link": "https://stackoverflow.com/questions/54337079/how-do-i-access-other-elements-in-my-predefined-structured-object-in-c-unity/54337237#54337237", "title": "How do I access other elements in my predefined structured object in C#/Unity?", "body": "<blockquote>\n  <p>My question is, how do I access other elements of my structure such as health, calories, etc, inside my collision script?</p>\n</blockquote>\n\n<p>you can't. but you can solve it like this:</p>\n\n<p>in your CollisionScript, change the <code>GameObject PrefabFood</code> to your scriptable object <code>FOODS food</code></p>\n\n<p>then in this class you can access things like so:</p>\n\n<pre><code>food.preFabFood // is the prefab\nfood.health // is the health variable\n</code></pre>\n\n<hr>\n\n<p>it seams like you're quite new to coding and i'd suggest learning the basics before, because this is basic programming and isn't really unity or even c# related.</p>\n"}, {"comments": [{"owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "reply_to_user": {"reputation": 5, "user_id": 9512695, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9512695", "link": "https://stackoverflow.com/users/9512695/user9512695"}, "edited": false, "score": 0, "creation_date": 1548382811, "post_id": 54337509, "comment_id": 95530908, "body": "@user9512695 As a side note, the standard naming conventions for classes is PascalCase, that is, <code>Foods</code> not <code>FOODS</code>. You&#39;re free to do whatever you like, but it makes your code easier for other people to understand (as well as more descriptive naming, such as <code>FoodStats</code> or <code>FoodProperties</code>)."}], "tags": [], "owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "is_accepted": false, "score": 1, "last_activity_date": 1548288181, "creation_date": 1548288181, "answer_id": 54337509, "question_id": 54337079, "link": "https://stackoverflow.com/questions/54337079/how-do-i-access-other-elements-in-my-predefined-structured-object-in-c-unity/54337509#54337509", "title": "How do I access other elements in my predefined structured object in C#/Unity?", "body": "<h1>You have two problems.</h1>\n\n<p>1) The properties are <code>private</code>, meaning that they aren't visible to other classes. The default visibility on member fields <a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/access-modifiers#class-and-struct-member-accessibility\" rel=\"nofollow noreferrer\">is private</a>.</p>\n\n<p>2) The properties aren't in a script attached to your prefab.</p>\n\n<p>Fixing #2 (as Soraphis) suggests is <em>sort of</em> the right thing to do, however, you would want to remove the <code>public GameObject preFabFood;</code> field from your <code>FOODS</code> class if you're attaching the <code>FOODS</code> class to the prefab instance (as you don't need to carry a copy of the instantiated object <em>with</em> the instantiation). Just keep this in mind as you adjust your code (the code you posted looks like one script, but I suspect its supposed to be more than one, and should in fact be at least 2).</p>\n\n<p>As for fixing #1, you have to make them public <em>or</em> access them from the same script. If you directly attach your <code>FOODS</code> class to your instantiated prefab and that the <code>FOODS</code> class contains the <code>OnCollisionEnter2D</code> method, then everything's fine.</p>\n\n<p>But as I suspect you've got <em>two</em> classes that you're showing here, you'll need to do this:</p>\n\n<pre><code>public int health;\npublic int calories;\npublic float height;\npublic float width;\n</code></pre>\n\n<p>And then use a <code>GetComponent()</code> call from to get the one script from the other. e.g.</p>\n\n<pre><code>FOODS foods = this.gameObject.GetComponent&lt;FOODS&gt;(); //gets the FOODS script attached to this game object.\n//Functionally identical to GetComponent&lt;FOODS&gt;();\nint hp = foods.health; //etc\n</code></pre>\n\n<p>Note that you should call <code>GetComponent</code> as little as possible, because it has a non-zero overhead, so caching the result as soon as possible (e.g. you could do it in <code>Start()</code> instead of every time at the top of <code>OnCollisionEnter2D</code>), but this is more of a general \"be careful\" flag, as over-use can cause frame rate issues.</p>\n"}], "owner": {"reputation": 5, "user_id": 9512695, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9512695", "link": "https://stackoverflow.com/users/9512695/user9512695"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548288181, "creation_date": 1548284810, "last_edit_date": 1548285457, "question_id": 54337079, "link": "https://stackoverflow.com/questions/54337079/how-do-i-access-other-elements-in-my-predefined-structured-object-in-c-unity", "title": "How do I access other elements in my predefined structured object in C#/Unity?", "body": "<p>I made a predefined object called FOOD. Inside is a GameObject that points to a PreFab GameObject. That GameObject is also attached to a collision script. My question is, how do I access other elements of my structure such as health, calories, etc, inside my collision script?</p>\n\n<pre><code>public class FOODS: ScriptableObject\n{\npublic GameObject preFabFood; \n//points to a prefab object that is attached to a collision script\n\nint health;\nint calories;\nfloat height;\nfloat width;\n}\n\n//this is the script that is attached to the GameObject preFabFood\nvoid OnCollisionEnter2D(Collision2D c)\n{\n    //how do I access elements such as height, weight, etc?\n}\n</code></pre>\n"}, {"tags": ["c#", "c#-4.0"], "comments": [{"owner": {"reputation": 1, "user_id": 10958455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1f7ee983cfc317b9c5c07b01058c3a?s=128&d=identicon&r=PG&f=1", "display_name": "Iqra", "link": "https://stackoverflow.com/users/10958455/iqra"}, "reply_to_user": {"reputation": 60839, "user_id": 301857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4KmT.jpg?s=128&g=1", "display_name": "Grant Winney", "link": "https://stackoverflow.com/users/301857/grant-winney"}, "edited": false, "score": 0, "creation_date": 1548284907, "post_id": 54337016, "comment_id": 95491324, "body": "to avoid typing again i copy pasted and forgot to change that part. thankyouu!! but i still cant find a proper code for datetimepicker and radio button to get back properly. what do you think i can add there?"}], "answers": [{"tags": [], "owner": {"reputation": 4662, "user_id": 1613406, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AmV4Z.png?s=128&g=1", "display_name": "opewix", "link": "https://stackoverflow.com/users/1613406/opewix"}, "is_accepted": true, "score": 0, "last_activity_date": 1548285799, "creation_date": 1548285799, "answer_id": 54337218, "question_id": 54337016, "link": "https://stackoverflow.com/questions/54337016/code-to-bring-back-datetimepicker-radiobutton-from-datagridveiw-to-edit/54337218#54337218", "title": "code to bring back DateTimePicker, radiobutton from DataGridVeiw to edit", "body": "<p><code>DateTimePicker</code> control accepts a <code>DateTime</code> value, you can assign it this way:</p>\n\n<pre><code>myDateTimePicker.Value = DateTime.Now;\nmyDateTimePicker.Value = new DateTime(2019, 1, 24);\nmyDateTimePicker.Value = DateTime.Parse(dataScreen.SelectedRows[0].Cells[2].Value);\n</code></pre>\n\n<p><code>CheckBox</code> control accepts a <code>boolean</code> value:</p>\n\n<pre><code>myCheckBox.Checked = true;\nmyCheckBox.Checked = false;\ncbMale.Checked = dataScreen.SelectedRows[0].Cells[1].Value == \"Male\";\ncbFemale.Checked = dataScreen.SelectedRows[0].Cells[1].Value == \"Female\";\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10958455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1f7ee983cfc317b9c5c07b01058c3a?s=128&d=identicon&r=PG&f=1", "display_name": "Iqra", "link": "https://stackoverflow.com/users/10958455/iqra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 54337218, "answer_count": 1, "score": -1, "last_activity_date": 1548285799, "creation_date": 1548284456, "last_edit_date": 1548285090, "question_id": 54337016, "link": "https://stackoverflow.com/questions/54337016/code-to-bring-back-datetimepicker-radiobutton-from-datagridveiw-to-edit", "title": "code to bring back DateTimePicker, radiobutton from DataGridVeiw to edit", "body": "<p>Cant figure out code for bringing back datetimepickers value and radiobuttons value to edit. what can i add there?</p>\n\n<p>help would be really appreciated have a deadline in the morning >_&lt;</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>   private void btnEdit_Click(object sender, EventArgs e)\r\n        {\r\n            if (dataScreen.SelectedRows.Count &gt; 0) // make sure user select at least 1 row \r\n            {\r\n                name = dataScreen.SelectedRows[0].Cells[0].Value + string.Empty;\r\n                Gender = dataScreen.SelectedRows[0].Cells[1].Value + string.Empty;\r\n                DateOfBirth = dataScreen.SelectedRows[0].Cells[2].Value + string.Empty;\r\n                Address = dataScreen.SelectedRows[0].Cells[3].Value + string.Empty;\r\n                MedicalHistory = dataScreen.SelectedRows[0].Cells[4].Value + string.Empty;\r\n                BloodType = dataScreen.SelectedRows[0].Cells[5].Value + string.Empty;\r\n\r\n                txtName.Text = name; txtAddress.Text = Address;\r\n                txtMedicalHistory.Text = MedicalHistory;\r\n                txtBloodType.Text = BloodType;\r\n\r\n            }\r\n\r\n            \r\n        }</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>here</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "edited": false, "score": 0, "creation_date": 1548284147, "post_id": 54336880, "comment_id": 95491098, "body": "Are you trying to pattern match a <code>Task&lt;object&gt;</code> (where <code>T</code> is unknown until runtime)?"}, {"owner": {"reputation": 1785, "user_id": 1834787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c06bd5ac140ad017a995d6aa83cd8aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Node.JS", "link": "https://stackoverflow.com/users/1834787/node-js"}, "reply_to_user": {"reputation": 13234, "user_id": 561113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af8b050fcc50ffb8de47e6704660aa98?s=128&d=identicon&r=PG", "display_name": "Xiaoy312", "link": "https://stackoverflow.com/users/561113/xiaoy312"}, "edited": false, "score": 0, "creation_date": 1548284276, "post_id": 54336880, "comment_id": 95491137, "body": "Yes, it is known at runtime"}], "answers": [{"tags": [], "owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "is_accepted": false, "score": 6, "last_activity_date": 1548283938, "creation_date": 1548283938, "answer_id": 54336915, "question_id": 54336880, "link": "https://stackoverflow.com/questions/54336880/c-pattern-match-taskt-and-get-its-value/54336915#54336915", "title": "C# pattern match Task&lt;T&gt; and get it&#39;s value", "body": "<p>The <em>simplest</em> approach would be to use dynamic typing:</p>\n\n<pre><code>dynamic obj = new Task&lt;string&gt;(); // etc\nobject result = obj.Result;\n</code></pre>\n\n<p>You could always check whether <code>obj</code> is a <code>Task</code> of some kind first (using the non-generic <code>Task</code> base class). If you really, really want to guard against a user-defined subclass of <code>Task</code> other than <code>Task&lt;T&gt;</code>, you could do everything via reflection yourself - but it'll be a lot more work.</p>\n\n<p>I'm not generally fond of dynamic typing, and I'd try to avoid getting into this situation in the first place if possible, but that should work fine.</p>\n"}, {"comments": [{"owner": {"reputation": 1785, "user_id": 1834787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c06bd5ac140ad017a995d6aa83cd8aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Node.JS", "link": "https://stackoverflow.com/users/1834787/node-js"}, "edited": false, "score": 0, "creation_date": 1548299514, "post_id": 54337573, "comment_id": 95494406, "body": "Exactly what I was looking for. Thank you"}], "tags": [], "owner": {"reputation": 30188, "user_id": 3218692, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/4pA4T.jpg?s=128&g=1", "display_name": "Yeldar Kurmangaliyev", "link": "https://stackoverflow.com/users/3218692/yeldar-kurmangaliyev"}, "is_accepted": true, "score": 1, "last_activity_date": 1548288666, "creation_date": 1548288666, "answer_id": 54337573, "question_id": 54336880, "link": "https://stackoverflow.com/questions/54336880/c-pattern-match-taskt-and-get-its-value/54337573#54337573", "title": "C# pattern match Task&lt;T&gt; and get it&#39;s value", "body": "<p>Assuming that you know the generic type of task, you can use reflection to get the value of <code>Result</code> property:</p>\n\n<pre><code>Type knownInRuntimeType = ...; // e.g., Task&lt;string&gt; or Task&lt;IEnumerable&lt;int&gt;&gt;\nTask task = ...; // e.g., Task&lt;string&gt; or Task&lt;IEnumerable&lt;int&gt;&gt;\n\n// result is string or IEnumerable&lt;int&gt;\nobject result = knownInRuntimeType.GetProperty(\"Result\").GetValue(task);\n</code></pre>\n\n<p>If your <code>knownInRuntimeType</code> is actually not a type of task, but a type of result (i.e. <code>string</code> or <code>IEnumerable&lt;int&gt;</code>), then you need to construct a generic type:</p>\n\n<pre><code>Type knownInRuntimeResultType = ...; // string or IEnumerable&lt;int&gt;\nType taskType = typeof(Task&lt;&gt;).MakeGenericType(knownInRuntimeResultType); \nTask task = ...; // e.g., Task&lt;string&gt; or Task&lt;IEnumerable&lt;int&gt;&gt;    \n\n// result is string or IEnumerable&lt;int&gt;\nobject result = taskType.GetProperty(\"Result\").GetValue(task);    \n</code></pre>\n"}], "owner": {"reputation": 1785, "user_id": 1834787, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c06bd5ac140ad017a995d6aa83cd8aeb?s=128&d=identicon&r=PG&f=1", "display_name": "Node.JS", "link": "https://stackoverflow.com/users/1834787/node-js"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 54337573, "answer_count": 2, "score": 2, "last_activity_date": 1548288666, "creation_date": 1548283739, "question_id": 54336880, "link": "https://stackoverflow.com/questions/54336880/c-pattern-match-taskt-and-get-its-value", "title": "C# pattern match Task&lt;T&gt; and get it&#39;s value", "body": "<p>I am wondering how to pattern match a <code>Task&lt;T&gt;</code>. More specifically given variable of static type <code>object</code> how to get its <code>Result</code> property.</p>\n\n<p>Basically, give:</p>\n\n<pre><code>object obj = new Task&lt;string&gt;() // or maybe Task&lt;IEnumerable&lt;...&gt;&gt;\n\nobject result = obj... // obj.Result?\n</code></pre>\n"}, {"tags": ["c#", "servicestack", "servicestack-text"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1548283828, "post_id": 54336865, "comment_id": 95490974, "body": "Well, do you think it is meaningful that CsvWriter throws an IndexOutOfRangeException when checking for escape characters? If you think it is meaningful -&gt; no bug. If you think it is not meaningful -&gt; quite likely a bug."}], "answers": [{"comments": [{"owner": {"reputation": 790, "user_id": 148084, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7894204263df5892ff73ab7f733ae198?s=128&d=identicon&r=PG", "display_name": "Arian Kulp", "link": "https://stackoverflow.com/users/148084/arian-kulp"}, "edited": false, "score": 1, "creation_date": 1548285303, "post_id": 54337034, "comment_id": 95491434, "body": "Thank you very much for your prompt response.  Also, thanks for all you do with ServiceStack!"}], "tags": [], "owner": {"reputation": 134328, "user_id": 85785, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/1257196ff88132651f94ac85f662c038?s=128&d=identicon&r=PG", "display_name": "mythz", "link": "https://stackoverflow.com/users/85785/mythz"}, "is_accepted": true, "score": 4, "last_activity_date": 1548284554, "creation_date": 1548284554, "answer_id": 54337034, "question_id": 54336865, "link": "https://stackoverflow.com/questions/54336865/indexoutofrangeexception-in-csvwriter/54337034#54337034", "title": "IndexOutOfRangeException in CsvWriter", "body": "<p>The <code>IndexOutOfRangeException</code> should now be resolved from <a href=\"https://github.com/ServiceStack/ServiceStack.Text/commit/36313cfa5544cfc345bd1bfd030e27676d292bc4\" rel=\"nofollow noreferrer\">this commit</a>.</p>\n\n<p>This change is available from v5.4.1 that's now <a href=\"https://docs.servicestack.net/myget\" rel=\"nofollow noreferrer\">available on MyGet</a>.</p>\n"}], "owner": {"reputation": 790, "user_id": 148084, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7894204263df5892ff73ab7f733ae198?s=128&d=identicon&r=PG", "display_name": "Arian Kulp", "link": "https://stackoverflow.com/users/148084/arian-kulp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 54337034, "answer_count": 1, "score": 2, "last_activity_date": 1548284554, "creation_date": 1548283688, "question_id": 54336865, "link": "https://stackoverflow.com/questions/54336865/indexoutofrangeexception-in-csvwriter", "title": "IndexOutOfRangeException in CsvWriter", "body": "<p>I'm getting a <code>System.IndexOutOfRangeException</code> while trying to serialize a dataset of dynamic objects.  It's not any single row since I've tested it with each individual row (there are only four in my example).  It's happening in the <code>CsvWriter.HasAnyEscapeChars</code> function.  The exact stack trace is:</p>\n\n<pre><code>   at ServiceStack.Text.CsvWriter.HasAnyEscapeChars(String value)\n   at ServiceStack.TextExtensions.ToCsvField(Object text)\n   at ServiceStack.Text.CsvDictionaryWriter.WriteObjectRow(TextWriter writer, IEnumerable`1 row)\n   at ServiceStack.Text.CsvDictionaryWriter.Write(TextWriter writer, IEnumerable`1 records)\n   at ServiceStack.Text.CsvWriter`1.Write(TextWriter writer, IEnumerable`1 records)\n   at ServiceStack.Text.CsvSerializer`1.WriteObject(TextWriter writer, Object value)\n   at ServiceStack.Text.CsvSerializer.SerializeToStream[T](T value, Stream stream)\n   at &lt;my code&gt;\n</code></pre>\n\n<p>It looks (from the source code) that <code>HasAnyEscapeChars</code> needs to add a guard against an empty string since the reference to value[0] will fail there, though I'm not seeing how that would actually happen in actual usage.</p>\n\n<pre><code>public static bool HasAnyEscapeChars(string value)\n{\n  return CsvConfig.EscapeStrings.Any(value.Contains)\n     || value[0] == JsWriter.ListStartChar\n     || value[0] == JsWriter.MapStartChar;\n}\n</code></pre>\n\n<p>Is there something I need to do to sanitize my data or is it a bug?</p>\n"}, {"tags": ["c#", ".net", "botframework"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6704483, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f15e461e29c2d12b441e96a8d465318?s=128&d=identicon&r=PG&f=1", "display_name": "AmatuerCoder101", "link": "https://stackoverflow.com/users/6704483/amatuercoder101"}, "edited": false, "score": 0, "creation_date": 1548288743, "post_id": 54337352, "comment_id": 95492243, "body": "Thank you I was unaware of this limitation. No to try think of a work around/new approach."}, {"owner": {"reputation": 32375, "user_id": 185859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f734ebbdfb504c718edd0c7d4d3874?s=128&d=identicon&r=PG", "display_name": "Drew Marsh", "link": "https://stackoverflow.com/users/185859/drew-marsh"}, "reply_to_user": {"reputation": 39, "user_id": 6704483, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f15e461e29c2d12b441e96a8d465318?s=128&d=identicon&r=PG&f=1", "display_name": "AmatuerCoder101", "link": "https://stackoverflow.com/users/6704483/amatuercoder101"}, "edited": false, "score": 2, "creation_date": 1548289249, "post_id": 54337352, "comment_id": 95492359, "body": "I can give you one, but it&#39;s FUGLY: hand in the <code>DialogSet</code> where the dialog you want to invoke lives to the constructor of your <code>ComponentDialog</code> and where you&#39;re calling <code>ReplaceDialogAsync</code> now, instead call <code>CreateContextAsync</code> on that <code>DialogSet</code>, then use the resulting <code>DialogContext</code> instance and call <code>ReplaceDialogAsync</code> via that. \ud83d\ude31 It <i>should</i> work, I&#39;m so sorry I&#39;m even suggesting this though. \ud83d\ude2d"}], "tags": [], "owner": {"reputation": 32375, "user_id": 185859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f734ebbdfb504c718edd0c7d4d3874?s=128&d=identicon&r=PG", "display_name": "Drew Marsh", "link": "https://stackoverflow.com/users/185859/drew-marsh"}, "is_accepted": true, "score": 1, "last_activity_date": 1548286735, "creation_date": 1548286735, "answer_id": 54337352, "question_id": 54336689, "link": "https://stackoverflow.com/questions/54336689/botframework-v4-replacedialogasync-a-dialog-with-an-id-of-x-wasnt-found/54337352#54337352", "title": "botframework v4: ReplaceDialogAsync A dialog with an id of &#39;X&#39; wasn&#39;t found", "body": "<p>I'm going to make an educated guess that the call to <code>ReplaceDialogAsync</code> that you show above is being made from within a <code>ComponentDialog</code>. Is that right?</p>\n\n<p>If so, dialogs that are children of <code>ComponentDialogs</code> cannot invoke dialogs <em>outside of</em> that <code>ComponentDialog</code>. This is a limitation in the current version (currently 4.2) and a solution is being considered that would lift this restriction. </p>\n\n<p>If this sounds like it matches your scenario, <a href=\"https://github.com/Microsoft/BotBuilder/issues/5242\" rel=\"nofollow noreferrer\">please visit this issue in GitHub</a> and upvote it to make your voice heard that this is something you'd like to see addressed in a future release.</p>\n"}], "owner": {"reputation": 39, "user_id": 6704483, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f15e461e29c2d12b441e96a8d465318?s=128&d=identicon&r=PG&f=1", "display_name": "AmatuerCoder101", "link": "https://stackoverflow.com/users/6704483/amatuercoder101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 54337352, "answer_count": 1, "score": 1, "last_activity_date": 1548286735, "creation_date": 1548282583, "question_id": 54336689, "link": "https://stackoverflow.com/questions/54336689/botframework-v4-replacedialogasync-a-dialog-with-an-id-of-x-wasnt-found", "title": "botframework v4: ReplaceDialogAsync A dialog with an id of &#39;X&#39; wasn&#39;t found", "body": "<p>I have a working bot using a fixed waterfall flow and single dialog however I wish to expand the bot to have multiple different dialogs that will be switched between depending on user inputs. The dialogs I am using have been tested individually and work separate from each other. The first working dialog allows users to chose between 4 options which should then open different dialogs depending on the chosen option.</p>\n\n<p>Within my currently working dialog I am attempting to switch to another dialog using the following line.</p>\n\n<pre><code>return await stepContext.ReplaceDialogAsync(\"QnaMakerQueryDialog\");\n</code></pre>\n\n<p>The documentation for ReplaceDialogAsync states \" Ends the active dialog and starts a new dialog in its place. This is particularly useful for creating loops or redirecting to another dialog.\" which sounds exactly like what I am trying to do however I get the error \"A dialog with an id of 'QnaMakerQueryDialog' wasn't found.\" I would expect the Dialog to start from the begining of the QnaMakerQueryDialog however it simply throws the above error and continues within the current dialog.</p>\n"}, {"tags": ["c#", "automapper"], "comments": [{"owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1548284581, "post_id": 54336673, "comment_id": 95491219, "body": "After setting up the mapping for the dictionary, you&#39;ve overwritten AutoMappers internal Dictionary mapper.  You&#39;ll notice that <code>_dt</code> will be case-insensitive however no values are mapped because now I doesn&#39;t know how to map <a href=\"https://stackoverflow.com/questions/5995167/mapping-dictionaries-with-automapper\"><code>KeyValuePair</code> because it&#39;s setters are readonly.</a>  That being said I haven&#39;t had much luck getting the KeyValuePair mapping working."}, {"owner": {"reputation": 1124, "user_id": 1421578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c124be67330058eeddbe7a1514813b?s=128&d=identicon&r=PG", "display_name": "oflahero", "link": "https://stackoverflow.com/users/1421578/oflahero"}, "reply_to_user": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "edited": false, "score": 0, "creation_date": 1548285054, "post_id": 54336673, "comment_id": 95491363, "body": "That&#39;s the issue Erik; you can get yourself a case-insensitive mapped dictionary, but it&#39;s empty. At that rate, you&#39;d be better off rolling your own mapper altogether. So I was just wondering if there was some crafty AutoMapper method that I&#39;ve overlooked :)"}, {"owner": {"reputation": 2267, "user_id": 1811700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8938c81a7f3dd237566b2fc541e1c8a8?s=128&d=identicon&r=PG", "display_name": "Lucian Bargaoanu", "link": "https://stackoverflow.com/users/1811700/lucian-bargaoanu"}, "edited": false, "score": 1, "creation_date": 1548310801, "post_id": 54336673, "comment_id": 95497046, "body": "You should map into an existing dictionary which you create with StringComparer.OrdinalIgnoreCase."}, {"owner": {"reputation": 1124, "user_id": 1421578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c124be67330058eeddbe7a1514813b?s=128&d=identicon&r=PG", "display_name": "oflahero", "link": "https://stackoverflow.com/users/1421578/oflahero"}, "reply_to_user": {"reputation": 2267, "user_id": 1811700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8938c81a7f3dd237566b2fc541e1c8a8?s=128&d=identicon&r=PG", "display_name": "Lucian Bargaoanu", "link": "https://stackoverflow.com/users/1811700/lucian-bargaoanu"}, "edited": false, "score": 0, "creation_date": 1548322891, "post_id": 54336673, "comment_id": 95502752, "body": "@LucianBargaoanu: but I want it to happen automatically - say, the Dictionary is a property of another mapped object. I&#39;d like the mapping to automatically happen for the Dictionary property without having to specify it manually. If possible, I understand it may not be."}, {"owner": {"reputation": 2267, "user_id": 1811700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8938c81a7f3dd237566b2fc541e1c8a8?s=128&d=identicon&r=PG", "display_name": "Lucian Bargaoanu", "link": "https://stackoverflow.com/users/1811700/lucian-bargaoanu"}, "edited": false, "score": 0, "creation_date": 1548324633, "post_id": 54336673, "comment_id": 95503801, "body": "Yes, that&#39;s the idea. But you have to provide the dictionary instance yourself. Pass an existing destination, set UseDestinationValue for that property, MapFrom new dictionary. There are options. Better than the answer bellow."}, {"owner": {"reputation": 1124, "user_id": 1421578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c124be67330058eeddbe7a1514813b?s=128&d=identicon&r=PG", "display_name": "oflahero", "link": "https://stackoverflow.com/users/1421578/oflahero"}, "edited": false, "score": 0, "creation_date": 1548325446, "post_id": 54336673, "comment_id": 95504279, "body": "I never want to pass an existing DIctionary destination though - that&#39;s the point. Unless it gets created in a lambda somehow as specified somewhere in the configuration. Otherwise I&#39;d be quicker just writing my own mapper for this case!"}, {"owner": {"reputation": 2267, "user_id": 1811700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8938c81a7f3dd237566b2fc541e1c8a8?s=128&d=identicon&r=PG", "display_name": "Lucian Bargaoanu", "link": "https://stackoverflow.com/users/1811700/lucian-bargaoanu"}, "edited": false, "score": 0, "creation_date": 1548327258, "post_id": 54336673, "comment_id": 95505420, "body": "Of course. But I think you should be reading the docs."}, {"owner": {"reputation": 1124, "user_id": 1421578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c124be67330058eeddbe7a1514813b?s=128&d=identicon&r=PG", "display_name": "oflahero", "link": "https://stackoverflow.com/users/1421578/oflahero"}, "edited": false, "score": 0, "creation_date": 1548328580, "post_id": 54336673, "comment_id": 95506205, "body": "I tried, but gave up after spending as much time as I would have just rolling my own mapper. Your comprehension must be better than mine!"}, {"owner": {"reputation": 1124, "user_id": 1421578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c124be67330058eeddbe7a1514813b?s=128&d=identicon&r=PG", "display_name": "oflahero", "link": "https://stackoverflow.com/users/1421578/oflahero"}, "edited": false, "score": 0, "creation_date": 1548328867, "post_id": 54336673, "comment_id": 95506374, "body": "I just think &#39;create DIctionary &amp; KeyValuePair mappings&#39; -&gt; &#39;do explicit DIctionary mapping&#39; -&gt; &#39;create destination model&#39; -&gt; &#39;set destination Dictionary with mapped value&#39; -&gt; &#39;do destination mapping with UseDestinationValue set for the dictionary property&#39; - is far more laborious than it&#39;s worth. YMMV."}, {"owner": {"reputation": 2267, "user_id": 1811700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8938c81a7f3dd237566b2fc541e1c8a8?s=128&d=identicon&r=PG", "display_name": "Lucian Bargaoanu", "link": "https://stackoverflow.com/users/1811700/lucian-bargaoanu"}, "edited": false, "score": 0, "creation_date": 1548329521, "post_id": 54336673, "comment_id": 95506753, "body": "And I completely agree, but without some research, I don&#39;t see how you could understand how it&#39;s done."}], "answers": [{"comments": [{"owner": {"reputation": 1124, "user_id": 1421578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c124be67330058eeddbe7a1514813b?s=128&d=identicon&r=PG", "display_name": "oflahero", "link": "https://stackoverflow.com/users/1421578/oflahero"}, "edited": false, "score": 0, "creation_date": 1548339919, "post_id": 54337163, "comment_id": 95513079, "body": "Not working for me I&#39;m afraid Erik, either in fiddle or VS. Compiler complains that it can&#39;t convert between IEnumerable&lt;KeyValuePair&lt;string,TestClassModel&gt;&gt; and Dictionary&lt;string,TestClassModel&gt; in the &#39;new Dictionary(...) &#39; constructor call."}, {"owner": {"reputation": 1124, "user_id": 1421578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c124be67330058eeddbe7a1514813b?s=128&d=identicon&r=PG", "display_name": "oflahero", "link": "https://stackoverflow.com/users/1421578/oflahero"}, "edited": false, "score": 0, "creation_date": 1548339986, "post_id": 54337163, "comment_id": 95513114, "body": "I tried  .ConstructUsing(src =&gt; new Dictionary&lt;string, TestClassModel&gt;                     (Mapper.Map&lt;IEnumerable&lt;KeyValuePair&lt;string, TestClassModel&gt;&gt;&gt;(src).ToDictionary(                        s =&gt; s.Key, v =&gt; v.Value                         ),                      StringComparer.OrdinalIgnoreCase), which satisfies the compiler, but at runtime a &#39;no coercion operator is defined for...&#39; error is thrown. Never mind, don&#39;t want to spend too much time on this anyway!"}], "tags": [], "owner": {"reputation": 48290, "user_id": 209259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bSPBw.jpg?s=128&g=1", "display_name": "Erik Philips", "link": "https://stackoverflow.com/users/209259/erik-philips"}, "is_accepted": false, "score": 1, "last_activity_date": 1548285386, "creation_date": 1548285386, "answer_id": 54337163, "question_id": 54336673, "link": "https://stackoverflow.com/questions/54336673/how-can-i-pass-a-constructor-parameter-to-an-implicit-dictionary-mapping-using-a/54337163#54337163", "title": "How can I pass a constructor parameter to an implicit Dictionary mapping using AutoMapper?", "body": "<p>I did get it working, but not sure why it doesn't work on DotNetFiddle.  If I run it in my own app it works just fine.  I left in other things I tested for.</p>\n\n<pre><code>  Mapper.Initialize(cfg =&gt;\n  {\n    cfg.CreateMap&lt;TestClass, TestClassModel&gt;()\n      .ForMember(d =&gt; d._F1, s =&gt; s.MapFrom(o =&gt; o.F1));\n\n    cfg.CreateMap&lt;KeyValuePair&lt;string, TestClass&gt;, KeyValuePair&lt;string, TestClassModel&gt;&gt;()\n      .ConstructUsing(x =&gt; new KeyValuePair&lt;string, TestClassModel&gt;(x.Key, Mapper.Map&lt;TestClassModel&gt;(x.Value)));\n\n    cfg.CreateMap(typeof(Dictionary&lt;,&gt;), typeof(Dictionary&lt;string, TestClassModel&gt;))\n      //.ForCtorParam(\"collection\", opt =&gt; opt.MapFrom(src =&gt; Mapper.Map&lt;IEnumerable&lt;KeyValuePair&lt;string, TestClassModel&gt;&gt;&gt;(src)))\n      //.ForCtorParam(\"comparer\", opt =&gt; opt.MapFrom(src =&gt; StringComparer.OrdinalIgnoreCase));\n      .ConstructUsing(src =&gt; new Dictionary&lt;string, TestClassModel&gt;(Mapper.Map&lt;IEnumerable&lt;KeyValuePair&lt;string, TestClassModel&gt;&gt;&gt;(src), StringComparer.OrdinalIgnoreCase));\n  });\n</code></pre>\n\n<p>If you're going to run this in any type of real environment I highly recommend using the <a href=\"http://docs.automapper.org/en/stable/Static-and-Instance-API.html\" rel=\"nofollow noreferrer\">instanced type of automapper</a>.</p>\n"}], "owner": {"reputation": 1124, "user_id": 1421578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1c124be67330058eeddbe7a1514813b?s=128&d=identicon&r=PG", "display_name": "oflahero", "link": "https://stackoverflow.com/users/1421578/oflahero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1548285386, "creation_date": 1548282491, "question_id": 54336673, "link": "https://stackoverflow.com/questions/54336673/how-can-i-pass-a-constructor-parameter-to-an-implicit-dictionary-mapping-using-a", "title": "How can I pass a constructor parameter to an implicit Dictionary mapping using AutoMapper?", "body": "<p>Let's say I have a <code>TestClass</code> to <code>TestClassModel</code> mapping.</p>\n\n<p>Without any other mappings declared, I can already map a <code>Dictionary&lt;string,TestClass&gt;</code> to a <code>Dictionary&lt;string,TestClassModel&gt;</code>.</p>\n\n<p>Imagine though that the <code>Dictionary&lt;string,TestClass&gt;</code> had been initialized using <code>new Dictionary&lt;string,TestClass&gt;(StringComparer.OrdinalIgnoreCase)</code>. This allows case-insensitive lookups.</p>\n\n<p>How can the StringComparer.OrdinalIgnoreCase constructor parameter be preserved in the mapped Dictionary? I've tried an explicit Dictionary->Dictionary mapping with <code>.ForCtorParam</code>, but that just results in an empty destination Dictionary (as you would then have to add KeyValuePair mappings.)</p>\n\n<p>Fiddle: <a href=\"https://dotnetfiddle.net/KYQNWT\" rel=\"nofollow noreferrer\">https://dotnetfiddle.net/KYQNWT</a></p>\n"}, {"tags": ["c#", "iis", "asp.net-core", "kestrel"], "comments": [{"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1548282545, "post_id": 54336648, "comment_id": 95490573, "body": "What is the actual line where you got this exception?"}, {"owner": {"reputation": 1, "user_id": 10958354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fb37c446487e2d701df2edcf6b231b8?s=128&d=identicon&r=PG", "display_name": "tirrellcotton", "link": "https://stackoverflow.com/users/10958354/tirrellcotton"}, "reply_to_user": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "edited": false, "score": 0, "creation_date": 1548283325, "post_id": 54336648, "comment_id": 95490811, "body": "The &quot;services.AddDbContext&quot; line"}, {"owner": {"reputation": 1534, "user_id": 6210699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/247b4cf307285aa72632d5b321cf246b?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio Atanache", "link": "https://stackoverflow.com/users/6210699/mauricio-atanache"}, "edited": false, "score": 1, "creation_date": 1548284308, "post_id": 54336648, "comment_id": 95491153, "body": "Can you please share how your appsettings.json file looks like with some mock values?"}, {"owner": {"reputation": 256, "user_id": 7900036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc197b6aa1ca72b6c5bacd47a895f450?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/7900036/john"}, "edited": false, "score": 0, "creation_date": 1548334614, "post_id": 54336648, "comment_id": 95509673, "body": "could you please share the startup.cs and the program.cs code to trace."}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 4014205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ooQZu_d9E_I/AAAAAAAAAAI/AAAAAAAAPgg/oxYhIbWPRkQ/photo.jpg?sz=128", "display_name": "Mohsin Aboobacker", "link": "https://stackoverflow.com/users/4014205/mohsin-aboobacker"}, "is_accepted": false, "score": 0, "last_activity_date": 1548284503, "creation_date": 1548284503, "answer_id": 54337024, "question_id": 54336648, "link": "https://stackoverflow.com/questions/54336648/asp-net-core-2-2-error-when-setting-up-dbcontext-works-in-kestrel-not-in-iis-e/54337024#54337024", "title": "ASP.NET Core 2.2 error when setting up DBContext (works in Kestrel, not in IIS Express)", "body": "<p>If your environment is set as development, dotnet gets connection string from appsettings.development.json.</p>\n\n<p>Make sure you have set connection string there as well.</p>\n"}, {"tags": [], "owner": {"reputation": 1534, "user_id": 6210699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/247b4cf307285aa72632d5b321cf246b?s=128&d=identicon&r=PG&f=1", "display_name": "Mauricio Atanache", "link": "https://stackoverflow.com/users/6210699/mauricio-atanache"}, "is_accepted": false, "score": 1, "last_activity_date": 1548284585, "creation_date": 1548284585, "answer_id": 54337041, "question_id": 54336648, "link": "https://stackoverflow.com/questions/54336648/asp-net-core-2-2-error-when-setting-up-dbcontext-works-in-kestrel-not-in-iis-e/54337041#54337041", "title": "ASP.NET Core 2.2 error when setting up DBContext (works in Kestrel, not in IIS Express)", "body": "<p>I'm not sure how your appsettings.json looks like, but you should have a section in your json file like this :</p>\n\n<pre><code>\"ConnectionStrings\": {\n    \"DefaultDatabase\": \"&lt;Your connection string&gt;\"\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10958354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fb37c446487e2d701df2edcf6b231b8?s=128&d=identicon&r=PG", "display_name": "tirrellcotton", "link": "https://stackoverflow.com/users/10958354/tirrellcotton"}, "is_accepted": true, "score": 0, "last_activity_date": 1548343057, "last_edit_date": 1548343057, "creation_date": 1548341247, "answer_id": 54349302, "question_id": 54336648, "link": "https://stackoverflow.com/questions/54336648/asp-net-core-2-2-error-when-setting-up-dbcontext-works-in-kestrel-not-in-iis-e/54349302#54349302", "title": "ASP.NET Core 2.2 error when setting up DBContext (works in Kestrel, not in IIS Express)", "body": "<p>Looks like the problem was in my <strong>Program.cs</strong> file.  I had copied some code I used from a .NET Core 2.1 project</p>\n\n<pre><code>WebHost.CreateDefaultBuilder(args)\n     .UseContentRoot(Directory.GetCurrentDirectory())\n     .UseWebRoot(Directory.GetCurrentDirectory() + \"\\\\wwwroot\") // THIS LINE FIXES STATIC FILES ON PROD\n     .UseIISIntegration()\n     .UseStartup&lt;Startup&gt;();\n</code></pre>\n\n<p>Once I edited it to remove the <strong>Directory.GetCurrentDirectory()</strong> code it works.  </p>\n\n<pre><code>WebHost.CreateDefaultBuilder(args)\n     .UseIISIntegration()\n     .UseStartup&lt;Startup&gt;();\n</code></pre>\n\n<p>Now I'll have to test on the server to see if it still works.  Thanks for the responses.</p>\n"}], "owner": {"reputation": 1, "user_id": 10958354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fb37c446487e2d701df2edcf6b231b8?s=128&d=identicon&r=PG", "display_name": "tirrellcotton", "link": "https://stackoverflow.com/users/10958354/tirrellcotton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 54349302, "answer_count": 3, "score": 0, "last_activity_date": 1548343057, "creation_date": 1548282366, "question_id": 54336648, "link": "https://stackoverflow.com/questions/54336648/asp-net-core-2-2-error-when-setting-up-dbcontext-works-in-kestrel-not-in-iis-e", "title": "ASP.NET Core 2.2 error when setting up DBContext (works in Kestrel, not in IIS Express)", "body": "<p>I have a  .Net Core 2.2 web project where I set up the dbcontext connections in the <strong>Startup.cs</strong> file:</p>\n\n<pre><code>services.AddDbContext&lt;FirmDirectoryContext&gt;(options =&gt;  \n              options.UseSqlServer(Configuration.GetConnectionString(\"DefaultDatabase\")));\n</code></pre>\n\n<p>When I run this is Kestrel it works, but if I try to run it using IIS Express I get the following:</p>\n\n<blockquote>\n  <p><em>{System.ArgumentNullException: Value cannot be null. Parameter name: connectionString</em></p>\n</blockquote>\n\n<p>The connection string is obviously set in the <strong>appsettings.json</strong> file, or Kestrel would fail as well?</p>\n"}, {"tags": ["c#", "wpf", "dependency-properties", "dependencyobject"], "comments": [{"owner": {"reputation": 573, "user_id": 3273247, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/100000049632169/picture?type=large", "display_name": "nulltron", "link": "https://stackoverflow.com/users/3273247/nulltron"}, "edited": false, "score": 0, "creation_date": 1548282523, "post_id": 54336621, "comment_id": 95490570, "body": "Couldn&#39;t you use inheritance <code>public class MyDependencyObject : DependencyObject{}</code> and then just override the field you want with a read-only version? <code>public override readonly string MyString</code> can&#39;t get to an IDE atm so not sure if this is super helpful"}, {"owner": {"reputation": 23633, "user_id": 168179, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/IKF01.jpg?s=128&g=1", "display_name": "Mark A. Donohoe", "link": "https://stackoverflow.com/users/168179/mark-a-donohoe"}, "reply_to_user": {"reputation": 573, "user_id": 3273247, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/100000049632169/picture?type=large", "display_name": "nulltron", "link": "https://stackoverflow.com/users/3273247/nulltron"}, "edited": false, "score": 0, "creation_date": 1548282585, "post_id": 54336621, "comment_id": 95490585, "body": "Yes, but how do you override a dependency property? Remember the CLR accessors for a DP are exactly just that... accessors.  They don&#39;t stop you from setting the values in other ways (e.g. SetValue, etc.)"}, {"owner": {"reputation": 573, "user_id": 3273247, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/100000049632169/picture?type=large", "display_name": "nulltron", "link": "https://stackoverflow.com/users/3273247/nulltron"}, "edited": false, "score": 0, "creation_date": 1548282716, "post_id": 54336621, "comment_id": 95490634, "body": "@MarquelV damn you&#39;re right. Could you do something like this? <code>public string MyString =&gt; base.MyString</code>?"}, {"owner": {"reputation": 23633, "user_id": 168179, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/IKF01.jpg?s=128&g=1", "display_name": "Mark A. Donohoe", "link": "https://stackoverflow.com/users/168179/mark-a-donohoe"}, "reply_to_user": {"reputation": 573, "user_id": 3273247, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/100000049632169/picture?type=large", "display_name": "nulltron", "link": "https://stackoverflow.com/users/3273247/nulltron"}, "edited": false, "score": 0, "creation_date": 1548282978, "post_id": 54336621, "comment_id": 95490720, "body": "Again, that&#39;s just POCO properties, not DP properties.  You register a DP property specifically as normal or as read-only.  That&#39;s why I don&#39;t think you can change it."}, {"owner": {"reputation": 573, "user_id": 3273247, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/100000049632169/picture?type=large", "display_name": "nulltron", "link": "https://stackoverflow.com/users/3273247/nulltron"}, "edited": false, "score": 0, "creation_date": 1548283370, "post_id": 54336621, "comment_id": 95490824, "body": "From what I&#39;ve been reading I think you&#39;re right... apologies for not being useful"}, {"owner": {"reputation": 23633, "user_id": 168179, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/IKF01.jpg?s=128&g=1", "display_name": "Mark A. Donohoe", "link": "https://stackoverflow.com/users/168179/mark-a-donohoe"}, "reply_to_user": {"reputation": 573, "user_id": 3273247, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/100000049632169/picture?type=large", "display_name": "nulltron", "link": "https://stackoverflow.com/users/3273247/nulltron"}, "edited": false, "score": 0, "creation_date": 1548308874, "post_id": 54336621, "comment_id": 95496409, "body": "No worries.  They say if you have to try really hard to get something to work, chances are there&#39;s an easier way you&#39;re not considering."}, {"owner": {"reputation": 1300, "user_id": 9250153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f3d55650526a7e58bb9739dda4a0cff?s=128&d=identicon&r=PG&f=1", "display_name": "Alex.Wei", "link": "https://stackoverflow.com/users/9250153/alex-wei"}, "edited": false, "score": 0, "creation_date": 1548310604, "post_id": 54336621, "comment_id": 95496980, "body": "I don&#39;t think there is a &#39;common&#39; way to do that. Accessibility is a feature of a dependency property, and is not belong to property metadata that can be override. But dependency property handle accessibility in a very simple way, if you only use subclass, you can still change is by reflecting through some pravite members."}], "owner": {"reputation": 23633, "user_id": 168179, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/IKF01.jpg?s=128&g=1", "display_name": "Mark A. Donohoe", "link": "https://stackoverflow.com/users/168179/mark-a-donohoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548282233, "creation_date": 1548282233, "question_id": 54336621, "link": "https://stackoverflow.com/questions/54336621/can-you-subclass-a-dependencyobject-changing-a-currently-read-write-property-in", "title": "Can you subclass a DependencyObject, changing a currently-read/write property into a read-only property in the subclass?", "body": "<p>Title says it all.  Not thinking this is possible due to the way DependencyProperties work, but figured I'd ask.  Can you change a read-write property to a read-only property in a subclass?</p>\n"}, {"tags": ["c#", "extension-methods"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 3, "creation_date": 1548282769, "post_id": 54336612, "comment_id": 95490651, "body": "I suppose it is a feature that wasn&#39;t implemented because it has a cost to implement, but no value since (as you point out) there&#39;s no good reason to call an extension method from within the class its extending."}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 1, "creation_date": 1548283555, "post_id": 54336612, "comment_id": 95490885, "body": "But it&#39;s not &quot;static to the base class&quot;. It&#39;s not <i>anything</i> in the base class, as far as the CLR is concerned. It&#39;s a static member of a static class. Answer coming..."}], "answers": [{"tags": [], "owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "is_accepted": true, "score": 3, "last_activity_date": 1548283788, "last_edit_date": 1592644375, "creation_date": 1548283788, "answer_id": 54336888, "question_id": 54336612, "link": "https://stackoverflow.com/questions/54336612/accessing-extension-method-within-extended-type/54336888#54336888", "title": "Accessing extension method within extended type?", "body": "<p>Firstly, I'll note that there are perfectly good reasons to call extension methods on <code>this</code>. For example, you might be writing a collection class and want to use LINQ within it. Nothing wrong with that. Now, in terms of the question:</p>\n<blockquote>\n<p>Why did I have to qualify the extension method since modern compilers remove the need for qualifying fields, properties, and methods with the this keyword?</p>\n</blockquote>\n<p>It's not a matter of the modernity of the compiler - it's about what the language specification says. From <a href=\"https://www.ecma-international.org/publications/standards/Ecma-334.htm\" rel=\"nofollow noreferrer\">ECMA-334</a>, section 12.7.6.3:</p>\n<blockquote>\n<p>In a method invocation (\u00a712.6.6.2) of one of the forms</p>\n<pre><code>expr . identifier ( )\nexpr . identifier ( args )\nexpr . identifier &lt; typeargs &gt; ( )\nexpr . identifier &lt; typeargs &gt; ( args )\n</code></pre>\n<p>if the normal processing of the invocation finds no applicable methods, an attempt is made to process the construct as an extension method invocation. If expr or any of the args has compile-time type <code>dynamic</code>, extension methods will not apply.</p>\n</blockquote>\n<p>A method call of the form <code>Method()</code> is <em>not</em> in one of those forms, as there's no <code>expr</code>.</p>\n<p>So the compiler's just obeying the rules of the specification. As for why it's designed that way, that's slightly different. I don't know the details of this (although I can see if they're in one of the annotated versions of the spec) but I suspect that the fact that <code>Foo()</code> can either refer to an instance method or a static method in the current class or any of the base classes makes the whole thing a little trickier. (As of C# 6 it could also be a static method in any of the methods imported by a <code>using static</code> directive, mind you...)</p>\n"}], "owner": {"reputation": 2334, "user_id": 9893154, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5vkTj.jpg?s=128&g=1", "display_name": "\u30bf\u30b3\u30b9", "link": "https://stackoverflow.com/users/9893154/%e3%82%bf%e3%82%b3%e3%82%b9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 54336888, "answer_count": 1, "score": 1, "last_activity_date": 1548283788, "creation_date": 1548282198, "last_edit_date": 1548283129, "question_id": 54336612, "link": "https://stackoverflow.com/questions/54336612/accessing-extension-method-within-extended-type", "title": "Accessing extension method within extended type?", "body": "<p>I've been refactoring some old code lately and a lot of methods are useful as extension methods to foundational types such as <code>double</code>, <code>float</code>, <code>int</code>, <code>string</code>, etc. However, as I pitter-patted along making great progress, a thought occurred to me. There are multiple ways to access an extension method. Let's create a container class called <code>Extensions</code> and add a basic extension method (at first), and a dummy class we shall call <code>Dummy</code> with a simple method that utilizes our extension method called <code>DoIt</code>.</p>\n\n<pre><code>public static class Extensions {\n    public static double ToRadians(this double degrees) =&gt; degrees * Math.PI / 180.0;\n}\npublic class Dummy {\n    public void DoIt() {\n        double radians = Extensions.ToRadians(45.0);\n        double degrees = 90.0;\n        radians = degrees.ToRadians();\n    }\n}\n</code></pre>\n\n<p>Not the most elegant example, but it demonstrates the widely known access to extension methods. Now lets create an idiotic and pointless extension called <code>WasteOfTime</code> for our <code>Dummy</code> class, but within the <code>Extensions</code> class.</p>\n\n<p><strong>I'm not to sure why you would do this, but for the sake of the question, let's do it!</strong></p>\n\n<pre><code>public static class Extensions {\n    ...\n    public static void WasteOfTime(this Dummy dummy) { }\n    ...\n}\n</code></pre>\n\n<p>Alright, now we have this perfect little method that should have just been placed in the <code>Dummy</code> class. Well, since extension methods work off of instances of types, you should be able to call <code>WasteOfTime</code> from the <code>Dummy</code> class' special method called <code>DoIt</code>.</p>\n\n<pre><code>public void DoIt() {\n    ...\n    WasteOfTime();\n    ...\n}\n</code></pre>\n\n<p>Oh, but wait, you can't do that! The method couldn't be found! Let's qualify it with the <code>this</code> keyword!</p>\n\n<pre><code>this.WasteOfTime();\n</code></pre>\n\n<p>That's better, it compiles! It works! It is a waste of time! Cool!</p>\n\n<hr>\n\n<h2>Important Note</h2>\n\n<p>I would <strong>NOT</strong> consider actually doing this, but out of curiosity I gave it a try. If you can give a valid example as to why this would ever be a good idea, feel free to share, but I believe it is one of those; <strong><em>what were you thinking</em></strong> types of implementations.</p>\n\n<hr>\n\n<h2>The Question</h2>\n\n<p>Why did I have to qualify the extension method since modern compilers remove the need for qualifying fields, properties, and methods with the <code>this</code> keyword?</p>\n\n<p>The only thing I can think of is that the extension method is technically static to the base class.</p>\n"}, {"tags": ["c#", ".net", "asp.net-web-api"], "comments": [{"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1548282905, "post_id": 54336578, "comment_id": 95490701, "body": "Here is a good explanation for those options right from the <a href=\"https://docs.microsoft.com/en-us/aspnet/core/web-api/action-return-types?view=aspnetcore-2.2\" rel=\"nofollow noreferrer\">MSDN</a>."}, {"owner": {"reputation": 2204, "user_id": 8744999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5a358087b8a9e7f9ace69d7af8b74700?s=128&d=identicon&r=PG", "display_name": "DonkeyBanana", "link": "https://stackoverflow.com/users/8744999/donkeybanana"}, "reply_to_user": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1548285596, "post_id": 54336578, "comment_id": 95491536, "body": "@RacilHilan Great link. I missed that when I googled. Please repost your comment as an answer, adding some explanation, just a little. I&#39;d gladly accept it."}], "answers": [{"tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": true, "score": 30, "last_activity_date": 1548441293, "creation_date": 1548441293, "answer_id": 54371053, "question_id": 54336578, "link": "https://stackoverflow.com/questions/54336578/cant-decide-between-taskiactionresult-iactionresult-and-actionresultthing/54371053#54371053", "title": "Can&#39;t decide between Task&lt;IActionResult&gt;, IActionResult and ActionResult&lt;Thing&gt;", "body": "<p>Here is a quick comparison of the different return options:</p>\n\n<h2>Specific type</h2>\n\n<pre><code>public Thing Get() {\n    return Ok(Context.Things);\n}\n</code></pre>\n\n<p>This is OK if the action will always return one possible type. However, most actions may return exceptions (i.e. status codes other than 200) that have different types.</p>\n\n<h2>IActionResult type</h2>\n\n<p>This solves the problem above as the <code>IActionResult</code> return type covers different return types.</p>\n\n<pre><code>public IActionResult Get() {\n    Thing thing = Context.Things;\n    if (thing == null)\n        return NotFound();\n    else\n        return Ok(thing);\n}\n</code></pre>\n\n<p>For asynchronous action, use <code>Task&lt;IActionResult&gt;</code>:</p>\n\n<pre><code>public async Task&lt;IActionResult&gt; Get() {\n    Thing thing = await Context.Things;\n    if (thing == null)\n        return NotFound();\n    else\n        return Ok(thing);\n}\n</code></pre>\n\n<h2>ActionResult type</h2>\n\n<p>ASP.NET Core 2.1 introduced the <code>ActionResult&lt;T&gt;</code> return type which offers the following benefits over the <code>IActionResult</code> type:</p>\n\n<p>1- The action's expected return type is inferred from the <code>T</code> in <code>ActionResult&lt;T&gt;</code>. If you decorate your action with the <code>[ProducesResponseType]</code> attribute, you no longer need to explicitly specify its <code>Type</code> property. For example, you can simply use <code>[ProducesResponseType(200)]</code> instead of <code>[ProducesResponseType(200, Type = typeof(Thing))]</code>.</p>\n\n<p>2- <code>T</code> converts to <code>ObjectResult</code>, which means <code>return new ObjectResult(T);</code> is simplified to <code>return T;</code>.</p>\n\n<pre><code>public ActionResult&lt;Thing&gt; Get() {\n    Thing thing = Context.Things;\n    if (thing == null)\n        return NotFound();\n    else\n        return thing;\n}\n</code></pre>\n\n<p>For asynchronous action, use <code>Task&lt;ActionResult&lt;T&gt;&gt;</code>:</p>\n\n<pre><code>public async Task&lt;ActionResult&lt;Thing&gt;&gt; Get() {\n    Thing thing = await Context.Things;\n    if (thing == null)\n        return NotFound();\n    else\n        return thing;\n}\n</code></pre>\n\n<p>For more details, you can refer to the MSDN page <a href=\"https://docs.microsoft.com/en-us/aspnet/core/web-api/action-return-types?view=aspnetcore-2.2\" rel=\"noreferrer\">Controller action return types in ASP.NET Core Web API</a>.</p>\n"}], "owner": {"reputation": 2204, "user_id": 8744999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5a358087b8a9e7f9ace69d7af8b74700?s=128&d=identicon&r=PG", "display_name": "DonkeyBanana", "link": "https://stackoverflow.com/users/8744999/donkeybanana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6791, "favorite_count": 3, "accepted_answer_id": 54371053, "answer_count": 1, "score": 14, "last_activity_date": 1548446018, "creation_date": 1548281967, "last_edit_date": 1548446018, "question_id": 54336578, "link": "https://stackoverflow.com/questions/54336578/cant-decide-between-taskiactionresult-iactionresult-and-actionresultthing", "title": "Can&#39;t decide between Task&lt;IActionResult&gt;, IActionResult and ActionResult&lt;Thing&gt;", "body": "<p>While I do understand the concept of <code>Task</code>, <code>ActionResult</code>, etc. I still feel unsure which would be most intuitive to type in a controller if nothing else is specified.</p>\n\n<p>Taking consideration to be as explicit with a type returned, I should go like this:</p>\n\n<pre><code>[HttpGet] public ActionResult&lt;Thing&gt; Get()\n{\n  return Ok(Context.Things);\n}\n</code></pre>\n\n<p>However, going for a generic type of API paradigm I should use this:</p>\n\n<pre><code>[HttpGet] public IActionResult Get()\n{\n  return Ok(Context.Things);\n}\n</code></pre>\n\n<p>Finally, respecting the asynchronous nature of the API philosophy I should apply the following:</p>\n\n<pre><code>[HttpGet] public Task&lt;IActionResult&gt; Get()\n{\n  return Ok(Context.Things);\n}\n</code></pre>\n\n<p>I can't decide between which is most appropriate in a general, green-field scenario. The first two work seemingly. Intuitively, I'd prefer to go with the third one but since it didn't work (the conversion isn't valid), I got worried that perhaps I'm barking up the wrong binary tree.</p>\n\n<p>Not sure at all how to google it and I'm obtaining all kinds of examples. Uncertain how to judge which ones are of relevance, I prefer to ask.</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 1, "creation_date": 1548282127, "post_id": 54336569, "comment_id": 95490431, "body": "Your loop goes as follows: If the current number in the iteration is an even number then print it. Otherwise, if the current number is odd, print it as well. So, essentially your loop prints the number when it is even, and it prints the number when it is odd. To solve your problem, you should ask yourself: <b>When</b> should it print even number, when should it not print even numbers? And in the same manner: <b>When</b> should it print odd numbers, when should it not print odd numbers..."}, {"owner": {"reputation": 29, "user_id": 10572911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4977586a23a94928f19fe48f466318d0?s=128&d=identicon&r=PG&f=1", "display_name": "pijoborde", "link": "https://stackoverflow.com/users/10572911/pijoborde"}, "edited": false, "score": 0, "creation_date": 1548282211, "post_id": 54336569, "comment_id": 95490457, "body": "So would a return or break statement solve that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1548282274, "post_id": 54336569, "comment_id": 95490488, "body": "Perhaps, perhaps not. Depends on how you will write your code precisely. (I assume you know what <code>return</code> and <code>break</code> do.)"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10572911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4977586a23a94928f19fe48f466318d0?s=128&d=identicon&r=PG&f=1", "display_name": "pijoborde", "link": "https://stackoverflow.com/users/10572911/pijoborde"}, "edited": false, "score": 0, "creation_date": 1548282763, "post_id": 54336694, "comment_id": 95490650, "body": "That helps immensely! Thank you!"}], "tags": [], "owner": {"reputation": 11186, "user_id": 266978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/936f8c28b401a914224af1e0e9891633?s=128&d=identicon&r=PG", "display_name": "Baltasarq", "link": "https://stackoverflow.com/users/266978/baltasarq"}, "is_accepted": true, "score": 3, "last_activity_date": 1551026195, "last_edit_date": 1551026195, "creation_date": 1548282599, "answer_id": 54336694, "question_id": 54336569, "link": "https://stackoverflow.com/questions/54336569/even-odd-loop-counting-with-modulus/54336694#54336694", "title": "Even/Odd loop counting with Modulus", "body": "<p>Your loop should be replaced with:</p>\n\n<pre><code>        for (i = miny; i &lt;= maxy; i++)\n        {\n            bool isEven = ( i  % 2 ) == 0;\n\n            if ( isEven &amp;&amp; oddeveninp == 1\n              || !isEven  &amp;&amp; oddeveninp == 2 )\n            {\n                Console.WriteLine( i );\n            }\n        }\n</code></pre>\n\n<p>The main matter is that you write the number to the console if the number is even, or if the number is odd. Since any number will be odd or even, this means that you'll always print <code>i</code>.</p>\n\n<p>The key point here is that you have to print the number when it is even <strong>and</strong> the user chose to print even numbers. Conversely, you have to print the number when it is odd <strong>and</strong> the user chose to print odd numbers.</p>\n\n<p>Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 283, "user_id": 8839621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c369a0fe291fbcd80d90207b4bb4ca?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ma\u0142ek", "link": "https://stackoverflow.com/users/8839621/adam-ma%c5%82ek"}, "is_accepted": false, "score": 0, "last_activity_date": 1548284212, "creation_date": 1548284212, "answer_id": 54336972, "question_id": 54336569, "link": "https://stackoverflow.com/questions/54336569/even-odd-loop-counting-with-modulus/54336972#54336972", "title": "Even/Odd loop counting with Modulus", "body": "<p>You can take advantage of fact, that odd and even numbers appears alternated, so you can setup initial value for i and increment it's value by 2 each iteration.</p>\n\n<pre><code>if (miny % 2 != oddeveninp -1)\n    miny++;\nfor (var i = miny; i &lt;= maxy; i+=2)\n{\n    Console.WriteLine(i);\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10572911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4977586a23a94928f19fe48f466318d0?s=128&d=identicon&r=PG&f=1", "display_name": "pijoborde", "link": "https://stackoverflow.com/users/10572911/pijoborde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 54336694, "answer_count": 2, "score": 1, "last_activity_date": 1551026195, "creation_date": 1548281914, "question_id": 54336569, "link": "https://stackoverflow.com/questions/54336569/even-odd-loop-counting-with-modulus", "title": "Even/Odd loop counting with Modulus", "body": "<p>I am trying to create code that asks the user if want to enter in numbers. Then it asks if they want the numbers displayed as even or odds, and taking a high and low for starting and end points.</p>\n\n<pre><code>public void RunExercise()\n    {\n        int runthroughs = 0;\n\n        Console.WriteLine(\"Greetings, User!\\nWelcome to the NumberPrinter!\");\n        Console.WriteLine(\"Do you want to quit (1), or print numbers (2)?\");\n        int userinp = int.Parse(Console.ReadLine());\n\n        while (userinp != 1)\n        {\n            runthroughs = runthroughs + 1;\n\n            Console.WriteLine(\"Do you want to print even (1) or odd (2) numbers?\");\n            int oddeveninp = int.Parse(Console.ReadLine());\n\n            if (oddeveninp == 1 || oddeveninp == 2)\n            Console.WriteLine(\"Please enter a maximum value:\");\n            int maxy = int.Parse(Console.ReadLine());\n            Console.WriteLine(\"Now enter a minimum value:\");\n            int miny = int.Parse(Console.ReadLine());\n            Console.WriteLine(\"Highest number? {0}\", maxy);\n            Console.WriteLine(\"Lowest number? {0}\", miny);\n            int i;\n            for (i = miny; i &lt;= maxy; i++)\n            {\n                if (i % 2 == 0)\n                {\n                    Console.WriteLine(i+ \" \");\n                }\n                else if (i % 2 == 1)\n                {\n                    Console.WriteLine(i + \" \");\n                }\n            }\n       }\n   }\n</code></pre>\n\n<p>As it stands now, it prints out the entire array of numbers regardless of if the user prompted for only odd or only even.</p>\n"}, {"tags": ["c#", "dynamics-crm", "fetchxml", "dynamics-crm-365"], "comments": [{"owner": {"reputation": 16340, "user_id": 1569689, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/21d698866fd3dfd4c566b5688ee99166?s=128&d=identicon&r=PG", "display_name": "James Wood", "link": "https://stackoverflow.com/users/1569689/james-wood"}, "edited": false, "score": 0, "creation_date": 1548327613, "post_id": 54336535, "comment_id": 95505645, "body": "&quot;This is clearly unsafe and a terrible way to do this.&quot; - Why?"}, {"owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "reply_to_user": {"reputation": 16340, "user_id": 1569689, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/21d698866fd3dfd4c566b5688ee99166?s=128&d=identicon&r=PG", "display_name": "James Wood", "link": "https://stackoverflow.com/users/1569689/james-wood"}, "edited": false, "score": 0, "creation_date": 1548374726, "post_id": 54336535, "comment_id": 95529248, "body": "See my response to your proposed answer below!  Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "edited": false, "score": 0, "creation_date": 1548284116, "post_id": 54336812, "comment_id": 95491086, "body": "Maybe - but in an abundance of caution I need to say &quot;no&quot;.  I am working on an integration and there is nothing to stop a third-party user from (sloppily) creating custom entities (which I need to be able to deal with) that could in theory have attributes named with the pattern &quot;entityName + id&quot; that are not actually the primary entity attribute.  I can&#39;t risk that error condition.  Thanks though."}, {"owner": {"reputation": 3492, "user_id": 4416512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bPAgK.jpg?s=128&g=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/4416512/aron"}, "reply_to_user": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "edited": false, "score": 0, "creation_date": 1548284490, "post_id": 54336812, "comment_id": 95491204, "body": "Good point. If you want to push it, for out of the box entities, you are assured that &#39;logicalName&#39; + &quot;id&quot; will not be a custom field. So, for entities that do not contain &quot;_&quot; or start with &quot;msdyn&quot;, the hacked method would generally be safe. That being said, when I encountered a similar issue I also reluctantly concluded that retrieving the metadata was the way to go."}, {"owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "edited": false, "score": 0, "creation_date": 1548285799, "post_id": 54336812, "comment_id": 95491597, "body": "So frustrating, because of course the server does (or easily could) know the primary key when it is in the context of executing the query."}, {"owner": {"reputation": 1576, "user_id": 5758348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55cc33cdaa4847876a93af89e88422e5?s=128&d=identicon&r=PG", "display_name": "Federico Jousset", "link": "https://stackoverflow.com/users/5758348/federico-jousset"}, "edited": false, "score": 1, "creation_date": 1548321574, "post_id": 54336812, "comment_id": 95501950, "body": "I don&#39;t think it&#39;s possible to manually create fields with the &quot;entityName + id&quot; format (D365 creates it automatically when you create the entity), so I&#39;d say you&#39;re safe if you append the &quot;id&quot;. If you still don&#39;t want to take this path, I&#39;d query the metadata and save it in a cache to avoid the extra service call every time."}, {"owner": {"reputation": 3492, "user_id": 4416512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bPAgK.jpg?s=128&g=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/4416512/aron"}, "edited": false, "score": 0, "creation_date": 1548331291, "post_id": 54336812, "comment_id": 95507737, "body": "Good point that the system sets the primary key field. Though, we could still create a lookup field named &quot;entityName + id&quot;.  If there&#39;s a custom entity named <code>new_request</code> for which you create a lookup on the Account, that lookup could be called <code>new_requestid</code>. But, comparing the token before &quot;id&quot; to the entity&#39;s name would easily distinguish this as a lookup field on the Account... another point for the &quot;hacked&quot; approach. I also agree that caching the metadata could help."}], "tags": [], "owner": {"reputation": 3492, "user_id": 4416512, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bPAgK.jpg?s=128&g=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/4416512/aron"}, "is_accepted": false, "score": 1, "last_activity_date": 1548283335, "creation_date": 1548283335, "answer_id": 54336812, "question_id": 54336535, "link": "https://stackoverflow.com/questions/54336535/how-to-generically-get-enumerated-set-of-entity-records-by-primary-id-with-dynam/54336812#54336812", "title": "How to generically get enumerated set of entity records by primary id with Dynamics 365 XRM Tooling SDK", "body": "<p>Since the \"hacked\" method should work the vast majority of the time, perhaps try the \"hacked\" method first by appending <code>id</code> to the entity name. If that fails, retrieve the entity metadata to get the primaryId. </p>\n"}, {"comments": [{"owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "edited": false, "score": 0, "creation_date": 1548374618, "post_id": 54349342, "comment_id": 95529214, "body": "Following your link, here is the verbiage:  &quot;Remarks The value is usually &lt;entity logical name&gt; + \u201cid\u201d.&quot;  This use of &quot;usually&quot; sure sounds like Microsoft going out of their way to avoid making a contracted commitment!  Sadly I need to count on that.  I&#39;ll query and cache the metadata.  Thanks for the thought though."}, {"owner": {"reputation": 5159, "user_id": 663627, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Oush1.png?s=128&g=1", "display_name": "jasonscript", "link": "https://stackoverflow.com/users/663627/jasonscript"}, "edited": false, "score": 0, "creation_date": 1549949509, "post_id": 54349342, "comment_id": 96078152, "body": "It&#39;s definitely possible to change the name of the primary name attribute when creating new entities. I&#39;ve come across that exact scenario before"}], "tags": [], "owner": {"reputation": 16340, "user_id": 1569689, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/21d698866fd3dfd4c566b5688ee99166?s=128&d=identicon&r=PG", "display_name": "James Wood", "link": "https://stackoverflow.com/users/1569689/james-wood"}, "is_accepted": false, "score": 0, "last_activity_date": 1548341357, "creation_date": 1548341357, "answer_id": 54349342, "question_id": 54336535, "link": "https://stackoverflow.com/questions/54336535/how-to-generically-get-enumerated-set-of-entity-records-by-primary-id-with-dynam/54349342#54349342", "title": "How to generically get enumerated set of entity records by primary id with Dynamics 365 XRM Tooling SDK", "body": "<p>The primary key is set by CRM when the entity is created, and it follows the format of \"entity name\" + \"id\", <a href=\"https://docs.microsoft.com/en-us/previous-versions/dynamics-crm2011/developers-guide/gg307568(v%3Dcrm.5)\" rel=\"nofollow noreferrer\">following this format isn't a hack</a>.</p>\n\n<p>If you arn't happy with that I would use the metadata service to retrieve the details once in bulk.</p>\n\n<pre><code>RetrieveAllEntitiesRequest request = new RetrieveAllEntitiesRequest()\n{\n    EntityFilters = EntityFilters.Entity,\n    RetrieveAsIfPublished = true\n};\n\nRetrieveAllEntitiesResponse response = (RetrieveAllEntitiesResponse)_serviceProxy.Execute(request);\n\nforeach (EntityMetadata currentEntity in response.EntityMetadata)\n{\n    currentEntity.PrimaryIdAttribute\n}\n</code></pre>\n\n<p>I'm not quite sure what the concern with doing this, presumably you are making multiple service calls for each entity, one extra metadata call won't hurt. As for expecting the server to 'just know' this information; it would probably have to query the metadata tables anyway.</p>\n\n<p>Finally, if someone has to supply you with entity names, you could also ask for the primary key field.</p>\n"}], "owner": {"reputation": 2091, "user_id": 2092621, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/895a73fa1eeab98198ffdcaae9c9fa4f?s=128&d=identicon&r=PG", "display_name": "Stephan G", "link": "https://stackoverflow.com/users/2092621/stephan-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548341357, "creation_date": 1548281756, "last_edit_date": 1548341314, "question_id": 54336535, "link": "https://stackoverflow.com/questions/54336535/how-to-generically-get-enumerated-set-of-entity-records-by-primary-id-with-dynam", "title": "How to generically get enumerated set of entity records by primary id with Dynamics 365 XRM Tooling SDK", "body": "<p>I am attempting to write a generic method that given any Dynamics 365 entity name and a set of IDs (GUIDS) will respond with a set of entity records matching that enumerated set.  My frustration is that there doesn't seem to be an efficient way to get the API to simply use the \"primary ID key\" without getting it first from metadata, another (seemingly unnecessary) round trip.</p>\n\n<p>Consider the following (Hacked) method:</p>\n\n<pre><code>    public EntityCollection HackedFetchEntityRecordsById(IOrganizationService orgSvc, string entityName, IEnumerable&lt;Guid&gt; primaryEntityAttributeIds)\n    {\n        // Defacto HACK for getting primary entity attribute\n        string primaryEntityAttribute = $\"{entityName}id\";\n\n        StringBuilder sb = new StringBuilder();\n\n        foreach (Guid guid in primaryEntityAttributeIds)\n        {\n            sb.AppendLine($@\"&lt;value&gt;{guid}&lt;/value&gt;\");\n        }\n\n        string fetchXml = $@\"\n                    &lt;fetch mapping='logical'&gt;\n                        &lt;entity name='{entityName}'&gt;\n                            &lt;no-attrs /&gt;\n                            &lt;filter&gt;\n                                &lt;condition attribute='{primaryEntityAttribute}' operator='in'&gt;\n                                    {sb}\n                                &lt;/condition&gt;\n                            &lt;/filter&gt;\n                        &lt;/entity&gt;\n                    &lt;/fetch&gt; \";\n\n        return orgSvc.RetrieveMultiple(new FetchExpression(fetchXml));\n    }\n</code></pre>\n\n<p>Note that here I am simply using a defacto standard I have observed, in that it seems Microsoft has chosen to name primary id attributes on entities with the entity name followed by the string \"id\".  This is clearly unsafe and a terrible way to do this.</p>\n\n<p>I can do it the \"right\" way but it is inefficient:</p>\n\n<pre><code>    public EntityCollection InefficientFetchEntityRecordsById(IOrganizationService orgSvc, string entityName, IEnumerable&lt;Guid&gt; primaryEntityAttributeIds)\n    {\n        // \"Correct\" but inefficient way of getting primary entity attribute\n        string primaryEntityAttribute = ((RetrieveEntityResponse) orgSvc.Execute(new RetrieveEntityRequest\n        {\n            LogicalName = entityName\n        })).EntityMetadata.PrimaryIdAttribute;\n\n        StringBuilder sb = new StringBuilder();\n\n        foreach (Guid guid in primaryEntityAttributeIds)\n        {\n            sb.AppendLine($@\"&lt;value&gt;{guid}&lt;/value&gt;\");\n        }\n\n        string fetchXml = $@\"\n                    &lt;fetch mapping='logical'&gt;\n                        &lt;entity name='{entityName}'&gt;\n                            &lt;no-attrs /&gt;\n                            &lt;filter&gt;\n                                &lt;condition attribute='{primaryEntityAttribute}' operator='in'&gt;\n                                    {sb}\n                                &lt;/condition&gt;\n                            &lt;/filter&gt;\n                        &lt;/entity&gt;\n                    &lt;/fetch&gt; \";\n\n        return orgSvc.RetrieveMultiple(new FetchExpression(fetchXml));\n    }\n</code></pre>\n\n<p>Note that in this case, I need to make a separate service call (with all the overhead that entails) to get the entity metadata in order to discern what the primary attribute is.  Yuck.</p>\n\n<p>I would like to do something like the following (fantasy/not working) method:</p>\n\n<pre><code>    public EntityCollection FantasyFetchEntityRecordsById(IOrganizationService orgSvc, string entityName, IEnumerable&lt;Guid&gt; primaryEntityAttributeIds)\n    {\n        StringBuilder sb = new StringBuilder();\n\n        foreach (Guid guid in primaryEntityAttributeIds)\n        {\n            sb.AppendLine($@\"&lt;value&gt;{guid}&lt;/value&gt;\");\n        }\n\n        // ILLEGAL XML - made up element \"primaryEntityAttribute\"\n        string fetchXml = $@\"\n                    &lt;fetch mapping='logical'&gt;\n                        &lt;entity name='{entityName}'&gt;\n                            &lt;no-attrs /&gt;\n                            &lt;filter&gt;\n                                &lt;primaryEntityAttribute operator='in'&gt;\n                                    {sb}\n                                &lt;/primaryEntityAttribute&gt;\n                            &lt;/filter&gt;\n                        &lt;/entity&gt;\n                    &lt;/fetch&gt; \";\n\n        return orgSvc.RetrieveMultiple(new FetchExpression(fetchXml));\n    }\n</code></pre>\n\n<p>I would be very happy to use some other implementation of QueryBase in the RetrieveMultiple service.</p>\n"}, {"tags": ["c#", "sql", "sql-server", "sql-server-ce"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 3, "creation_date": 1548281671, "post_id": 54336480, "comment_id": 95490268, "body": "You could declare a uniqueidentifier in your code as a variable, insert it and then cast it to a varchar in your select so you can use ExecuteScalar."}, {"owner": {"reputation": 15914, "user_id": 1127428, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pSzU4.jpg?s=128&g=1", "display_name": "Dale K", "link": "https://stackoverflow.com/users/1127428/dale-k"}, "edited": false, "score": 0, "creation_date": 1548282134, "post_id": 54336480, "comment_id": 95490434, "body": "Or you can always generate a new guid in C# as that is one benefit of using guids - they can be created in the DB or the App since they are globally unique."}, {"owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "edited": false, "score": 0, "creation_date": 1548282257, "post_id": 54336480, "comment_id": 95490478, "body": "One of the core features of the <code>GUID</code> is that you can generate it from anywhere you want. That&#39;s contrary to the auto-increment identifiers which can only be generated by the database. So I suggest that you make use of that feature and generate your <code>GUID</code>s in your C# code, then no need to bother with returning generated IDs from the database. Honestly, when I see code that generate the <code>GUID</code> at the database, I always wonder why <code>GUID</code> was used in the first place because auto-increment integers would perform better in that case. But there are rare exceptions."}], "answers": [{"comments": [{"owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "edited": false, "score": 0, "creation_date": 1548282634, "post_id": 54336555, "comment_id": 95490606, "body": "Unfortunately it does not work in SQL-Compact. But I keep trying"}, {"owner": {"reputation": 15914, "user_id": 1127428, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/pSzU4.jpg?s=128&g=1", "display_name": "Dale K", "link": "https://stackoverflow.com/users/1127428/dale-k"}, "reply_to_user": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "edited": false, "score": 0, "creation_date": 1548283226, "post_id": 54336555, "comment_id": 95490792, "body": "@juergend - see the comments under your question about generating the guid in code."}, {"owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "edited": false, "score": 0, "creation_date": 1548283308, "post_id": 54336555, "comment_id": 95490807, "body": "Only if there is no other way. I would have to refactor 10k code lines."}], "tags": [], "owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "is_accepted": false, "score": 5, "last_activity_date": 1548281834, "creation_date": 1548281834, "answer_id": 54336555, "question_id": 54336480, "link": "https://stackoverflow.com/questions/54336480/getting-back-a-uniqueidentifier-from-an-inserted-record/54336555#54336555", "title": "Getting back a uniqueidentifier from an inserted record", "body": "<p>Here is how you could do it using a variable.</p>\n\n<pre><code>declare @GUID uniqueidentifier = newid()\n\ninsert (YourColumns)\nvalues(@GUID)\n\nselect convert(varchar(36), @GUID) as MyKey\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1548339475, "post_id": 54337155, "comment_id": 95512820, "body": "And even if it did SCOPE_IDENTITY would be much better."}, {"owner": {"reputation": 103, "user_id": 251873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4191c9924763ea84df713ef0a3deb3?s=128&d=identicon&r=PG", "display_name": "IanCaz", "link": "https://stackoverflow.com/users/251873/iancaz"}, "edited": false, "score": 0, "creation_date": 1548363038, "post_id": 54337155, "comment_id": 95525347, "body": "Ah, I misinterpreted the uniqueidentifier as unique key/identity."}], "tags": [], "owner": {"reputation": 103, "user_id": 251873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4191c9924763ea84df713ef0a3deb3?s=128&d=identicon&r=PG", "display_name": "IanCaz", "link": "https://stackoverflow.com/users/251873/iancaz"}, "is_accepted": false, "score": -3, "last_activity_date": 1548285310, "creation_date": 1548285310, "answer_id": 54337155, "question_id": 54336480, "link": "https://stackoverflow.com/questions/54336480/getting-back-a-uniqueidentifier-from-an-inserted-record/54337155#54337155", "title": "Getting back a uniqueidentifier from an inserted record", "body": "<p>Your best bet is to use <code>@@IDENTITY</code> in combination with a select statement.</p>\n\n<p>Pass this as your SQL command:</p>\n\n<pre><code>  insert into myTable ( col1, col2, ...) values ( 'val1', 'val2', ...);SELECT @@IDENTITY;\n</code></pre>\n\n<p>This essentially inserts the value, then immediately (in the same session) calls for the most recently created identity, which would be the one you just inserted.</p>\n\n<p>Then in your code:\n<code>\n  int iResult = (int)sqlCommand.ExecuteScalar()\n</code></p>\n"}, {"comments": [{"owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "edited": false, "score": 0, "creation_date": 1548309647, "post_id": 54338444, "comment_id": 95496665, "body": "<code>declare</code> is not supported in SQL-Compact"}], "tags": [], "owner": {"reputation": 884, "user_id": 2597716, "user_type": "registered", "profile_image": "https://graph.facebook.com/783385849/picture?type=large", "display_name": "Mathew Paxinos", "link": "https://stackoverflow.com/users/2597716/mathew-paxinos"}, "is_accepted": false, "score": 0, "last_activity_date": 1548296003, "creation_date": 1548296003, "answer_id": 54338444, "question_id": 54336480, "link": "https://stackoverflow.com/questions/54336480/getting-back-a-uniqueidentifier-from-an-inserted-record/54338444#54338444", "title": "Getting back a uniqueidentifier from an inserted record", "body": "<p>Just realised that this is a duplicate of the answer of @Sean Langem I am leaving it up because it does add more detail which may be useful to the OP.</p>\n\n<hr>\n\n<p>This is perhaps not the most elegant solution (that being to generate the GUID in the application), however I believe that it should resolve your issue.  Please note that I have only tested this against SQL Server, not SQL Compact.</p>\n\n<p>Use ExecuteScalar() to return your ID, however convert it to a string (varchar) in the stored procedure, then back to a GUID in your application.</p>\n\n<p>The below example is a very simple one for demonstration purposes, and the code is in VB.Net and does not ensure the connection is closed, handle exceptions, etc. </p>\n\n<p>Sample Stored procedure returning a UNIQUEIDENTIFER Value as VARCHAR:</p>\n\n<pre><code>CREATE PROCEDURE test\nAS \n\n    DECLARE @id uniqueidentifier\n    SET @id = NEWID()\n\n    SELECT CONVERT(VARCHAR(38), @id)\nGO\n</code></pre>\n\n<p>Sample .Net code to call the database and retrieve the String, then convert to guid.</p>\n\n<pre><code>Sub main()\n\n    Dim id As Guid\n    Dim stringId As String\n\n    Using con As New SqlConnection(\"Server=&lt;server&gt;;Database=&lt;DB&gt;;Trusted_Connection=True;\")\n        Using cmd As New SqlCommand(\"test\", con)\n            cmd.CommandType = Data.CommandType.StoredProcedure\n\n            con.Open()\n            stringId = cmd.ExecuteScalar()\n        End Using\n    End Using\n\n    id = New Guid(stringId)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36579, "user_id": 183934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6458cf59b73b593fa9c9c8194f0a3b15?s=128&d=identicon&r=PG", "display_name": "ErikEJ", "link": "https://stackoverflow.com/users/183934/erikej"}, "is_accepted": true, "score": 1, "last_activity_date": 1548312747, "creation_date": 1548312747, "answer_id": 54340872, "question_id": 54336480, "link": "https://stackoverflow.com/questions/54336480/getting-back-a-uniqueidentifier-from-an-inserted-record/54340872#54340872", "title": "Getting back a uniqueidentifier from an inserted record", "body": "<p>There is no way to do that with SQL Server Compact.</p>\n\n<p>If you must use GUIDs, the only way is to create the GUID on the client, not ask the database engine for the generated value.</p>\n"}], "owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 54340872, "answer_count": 4, "score": 0, "last_activity_date": 1548312747, "creation_date": 1548281464, "question_id": 54336480, "link": "https://stackoverflow.com/questions/54336480/getting-back-a-uniqueidentifier-from-an-inserted-record", "title": "Getting back a uniqueidentifier from an inserted record", "body": "<p>I develop a C# app that can switch between 2 databases - SQL-Server and a local SQL-Compact DB.</p>\n\n<p>When inserting something I want to get back the inserted ID which is a <code>uniqueidentifier</code>. </p>\n\n<p><code>ExecuteScalar()</code> does not work for <code>uniqueidentifier</code>. Only when using <code>output inserted.id</code>.</p>\n\n<p>But <code>output inserted.id</code> is not supported by SQL-Compact.</p>\n\n<p>Is there a way to get back a <code>uniqueidentifier</code> in both databases? </p>\n"}, {"tags": ["c#", "asp.net", ".net", "viewstate", "session-management"], "comments": [{"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 1, "creation_date": 1548281892, "post_id": 54336432, "comment_id": 95490341, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18451882/viewstate-verification-failed-reason-the-viewstate-supplied-failed-integrity-c\">Viewstate verification failed. Reason: The viewstate supplied failed integrity check.</a>"}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 1, "creation_date": 1548281903, "post_id": 54336432, "comment_id": 95490346, "body": "Consider setting up an mcve (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>). Create a minimal template application and add the bare minimum of code to reproduce the problem."}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 2, "creation_date": 1548282259, "post_id": 54336432, "comment_id": 95490480, "body": "Read my comments again. I&#39;m predicting you won&#39;t get much help this way. It&#39;s time for a new approach."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548282722, "post_id": 54336432, "comment_id": 95490636, "body": "Please show us the contents of your web.config file."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548282755, "post_id": 54336432, "comment_id": 95490646, "body": "Do you really need <code>ViewState</code>? How hard would it be to change your app to not require it?"}, {"owner": {"reputation": 55, "user_id": 10430043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe07551eab095b162a9be4cfe256b61f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Simboliq", "link": "https://stackoverflow.com/users/10430043/b-simboliq"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548282867, "post_id": 54336432, "comment_id": 95490684, "body": "@mjwills i never used it at all! as i said that I recently had this issue, but in the past 3 years i never got this issue till i changed the login approach"}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1548411472, "post_id": 54336432, "comment_id": 95540441, "body": "Writing an .aspx Form without ViewState is pretty difficult, if not impossible. It is the backbone of WebForms."}], "owner": {"reputation": 55, "user_id": 10430043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe07551eab095b162a9be4cfe256b61f?s=128&d=identicon&r=PG&f=1", "display_name": "B.Simboliq", "link": "https://stackoverflow.com/users/10430043/b-simboliq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1548282561, "creation_date": 1548281261, "last_edit_date": 1548282561, "question_id": 54336432, "link": "https://stackoverflow.com/questions/54336432/is-changing-sessionid-causing-this-error-viewstate-verification-failed-reason", "title": "Is changing SessionId causing this error &quot;Viewstate verification failed. Reason: The viewstate supplied failed integrity check.&quot;", "body": "<p>I built a site that's running on a two load-balanced servers (web-farm), after a while I had to do the following:</p>\n\n<p>at the login page, when the user enters user-name and pass, if the user is valid then I'm abandoning the session and creating a new one as follows:</p>\n\n<pre><code>protected void btnLogin_Click(object sender, EventArgs e)\n        {\n            var Token = Guid.Empty;\n            try\n            {\n                if (IsValidCaptcha())\n                {\n                    string email = txtEmail.Text.Trim();\n                    string pw = txtPassword.Text.Trim();                      \n\n                    AbandonSession();//Delete any existing sessions\n                    var newSessionId = CreateSessionId(HttpContext.Current); //Create a new SessionId\n                    SetSessionId(HttpContext.Current, newSessionId);\n\n                    Token = SecureLogin.Login(email, pw, LangCode);\n\n                }\n                else\n                {\n                    lblMsg.Style.Add(\"display\", \"block\");\n                }\n            }\n            catch (Exception)\n            {\n                Token = Guid.Empty;\n                lblMsg.Style.Add(\"display\", \"block\");\n            }\n\n            if (Token != Guid.Empty)\n            {\n                Response.Redirect($\"HiddenPage.aspx?token={Token.ToString()}\", false);\n            }\n            else\n            {\n                lblMsg.Style.Add(\"display\", \"block\");\n            }\n\n        }\n\n\nprotected void AbandonSession()\n        {\n            Session.Clear();\n            Session.Abandon();\n            Session.RemoveAll();\n            if (Request.Cookies[\"ASP.NET_SessionId\"] != null)\n            {\n                Response.Cookies[\"ASP.NET_SessionId\"].Value = string.Empty;\n                Response.Cookies[\"ASP.NET_SessionId\"].Expires = DateTime.Now.AddMonths(-20);\n            }\n            if (Request.Cookies[\"__AntiXsrfToken\"] != null)\n            {\n                Response.Cookies[\"__AntiXsrfToken\"].Value = string.Empty;\n                Response.Cookies[\"__AntiXsrfToken\"].Expires = DateTime.Now.AddMonths(-20);\n            }\n        }\n\n        private string CreateSessionId(HttpContext httpContext)\n        {\n            var manager = new SessionIDManager();\n\n            string newSessionId = manager.CreateSessionID(httpContext);\n\n            return newSessionId;\n        }\n\n        public void SetSessionId(HttpContext httpContext, string newSessionId)\n        {\n            try\n            {\n                var manager = new SessionIDManager();\n\n                manager.SaveSessionID(httpContext, newSessionId, out bool redirected, out bool cookieAdded);\n            }\n            catch(Exception ex)\n            {\n                SmtpMailer.SendMsg(ex.Message + ex.StackTrace + ex.InnerException, \"\", \"\");\n            }\n\n        }\n</code></pre>\n\n<p>This is one of the requirements for the site and I can't change it at all (changing the session after login to the site).</p>\n\n<p>after applying this approach, I started getting this error almost in every page in the site (every now and then).</p>\n\n<pre><code>Event code: 4009  \n        Event message: Viewstate verification failed. \n        Reason: The viewstate supplied failed integrity check.  \n        Event time: 1/22/2019 2:53:36 PM  \n        Event time (UTC): 1/22/2019 7:53:36 PM  \n        Event ID: 5ffacfa116224c9f8f516ead8a89cc55  \n        Event sequence: 378  \n        Event occurrence: 1  \n        Event detail code: 50203    \n        Application information: \n        Application domain: /LM/W3SVC/2/ROOT-1-131926597583461452 \n        Trust level: Full \n        Application Virtual Path: / \n        Application Path: ........... \n        Machine name: ..............    Process information: \n        Process ID: 6624 \n        Process name: w3wp.exe \n        Account name: IIS APPPOOL\\..............    Request information: \n        Request URL: ............../qConsole/CampaignGroup-Launch.aspx\n        Request path: /qConsole/CampaignGroup-Launch.aspx \n        User host address: .............. \n        User:  \n        Is authenticated: False \n        Authentication Type:  \n        Thread account name: IIS APPPOOL\\..............\n</code></pre>\n\n<p>I double checked (a) the machine key /decryption key is the same on both servers in load balancing, and (b) that they are not set to auto generate</p>\n\n<p>and also I added this code to Global.asax </p>\n\n<pre><code>protected void Session_Start(object sender, EventArgs e)\n        {\n            Session.Timeout = 60;\n        }\n</code></pre>\n\n<p>and I have this set in the web.config file</p>\n\n<pre><code>&lt;sessionState timeout=\"25\" /&gt;\n</code></pre>\n\n<p>I have a feeling that the issue I'm having revolves around the feature I added (creating new sessionId after the login page), any ideas or thoughts are really appreciated.</p>\n\n<h1>Update:</h1>\n\n<p>i tried this and it didn't solve at all</p>\n\n<h1><a href=\"https://stackoverflow.com/questions/18451882/viewstate-verification-failed-reason-the-viewstate-supplied-failed-integrity-c\">Viewstate verification failed. Reason: The viewstate supplied failed integrity check.</a></h1>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548282709, "post_id": 54336408, "comment_id": 95490630, "body": "So with GetObject Access application is already open and visible?"}, {"owner": {"reputation": 139, "user_id": 7439802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9449ac29b85b098ddfaf3c7005d975d?s=128&d=identicon&r=PG", "display_name": "Miroslav Javorsk&#253;", "link": "https://stackoverflow.com/users/7439802/miroslav-javorsk%c3%bd"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1548318907, "post_id": 54336408, "comment_id": 95500559, "body": "Well, yes, so setting the .Visible property to true is not really needed, but what&#39;s a bigger problem for me is that I can&#39;t call Application.DoCmd.SetWarnings(false) to prevent showing errors in a dialog form. If I was able to call SetWarnings(false), all problems Access might encounter would be thrown as an Exception, and that&#39;s something I can process in my program with try&amp;catch block."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 7439802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9449ac29b85b098ddfaf3c7005d975d?s=128&d=identicon&r=PG", "display_name": "Miroslav Javorsk&#253;", "link": "https://stackoverflow.com/users/7439802/miroslav-javorsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1548416739, "post_id": 54342127, "comment_id": 95543112, "body": "So basically such instance (started using the exe file) is useless - at least for me. Anyway thank you very much for pointing this out. In the meantime I discovered that I can use the CLSID of the app in order to create a new instance of specific Access version which perfectly suits my needs."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 139, "user_id": 7439802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9449ac29b85b098ddfaf3c7005d975d?s=128&d=identicon&r=PG", "display_name": "Miroslav Javorsk&#253;", "link": "https://stackoverflow.com/users/7439802/miroslav-javorsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1548417114, "post_id": 54342127, "comment_id": 95543274, "body": "Well, you can do about 99.9% of all operations with an instance started by opening the exe. Some operations (like making the window invisible) are somewhat more difficult since you can&#39;t use the COM method for it and need to use WinAPI instead. Also, you don&#39;t need to hard-code CLSIDs to open a specific version, you can just use the version number on proper installations, e.g. <code>CreateObject(&quot;Access.Application.16&quot;)</code> to open the 2016 version or <code>CreateObject(&quot;Access.Application.14&quot;)</code> to open the 2010 version."}, {"owner": {"reputation": 139, "user_id": 7439802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9449ac29b85b098ddfaf3c7005d975d?s=128&d=identicon&r=PG", "display_name": "Miroslav Javorsk&#253;", "link": "https://stackoverflow.com/users/7439802/miroslav-javorsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1548419376, "post_id": 54342127, "comment_id": 95544401, "body": "Yes, but I had troubles with that .Version suffix so I will play a little bit with CLSIDs. Also it&#39;s true that I can do almost anything with such instance, but it get a little bit tricker with Access as Access is disabling any VBA content when run as .UserControl = False. I would have to build a script for clicking the Options... button in TopBar, then hitting the &quot;Allow&quot; checkbox and clicking the OK button - unless there&#39;s a simpler solution I don&#39;t know about."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 139, "user_id": 7439802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9449ac29b85b098ddfaf3c7005d975d?s=128&d=identicon&r=PG", "display_name": "Miroslav Javorsk&#253;", "link": "https://stackoverflow.com/users/7439802/miroslav-javorsk%c3%bd"}, "edited": false, "score": 0, "creation_date": 1548419744, "post_id": 54342127, "comment_id": 95544577, "body": "Nope, if VBA is disabled your options are suddenly very limited, now I understand your <i>basically useless</i> statement, you don&#39;t have many options then. You can of course modify the registry to add the location your Access database resides at as a trusted location, but then you might get red-flagged for potentially malicious activity, messing with the trust center registry is not recommended."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1548317933, "creation_date": 1548317933, "answer_id": 54342127, "question_id": 54336408, "link": "https://stackoverflow.com/questions/54336408/you-entered-an-expression-that-has-an-invalid-reference-to-the-property-visible/54342127#54342127", "title": "You entered an expression that has an invalid reference to the property Visible (Access.Application)", "body": "<p>This is expected behavior.</p>\n\n<p>Once <code>UserControl</code> has been set to True, both <code>UserControl</code> and <code>Visible</code> are read-only and True.</p>\n\n<p>You can work around this by testing if <code>UserControl</code> is true:</p>\n\n<pre><code>If(!accessApp.UserControl){accessApp.Visible = True;}\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 7439802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9449ac29b85b098ddfaf3c7005d975d?s=128&d=identicon&r=PG", "display_name": "Miroslav Javorsk&#253;", "link": "https://stackoverflow.com/users/7439802/miroslav-javorsk%c3%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 0, "accepted_answer_id": 54342127, "answer_count": 1, "score": 0, "last_activity_date": 1572632179, "creation_date": 1548281119, "last_edit_date": 1572632179, "question_id": 54336408, "link": "https://stackoverflow.com/questions/54336408/you-entered-an-expression-that-has-an-invalid-reference-to-the-property-visible", "title": "You entered an expression that has an invalid reference to the property Visible (Access.Application)", "body": "<p>When I create COM object instance of Access application using <code>Interaction.CreateObject(\"Access.Application\")</code>, then I am able to \"use all features of Access\" like setting <code>.Visible = true</code> or <code>.UserControl = true</code>, but when I start Access using EXE file and then when I am trying to get \"attached\" to that instance of Access using <code>Interaction.GetObject(null, \"Access.Application\")</code>, I am not able to perform <code>.Visible = true</code> nor <code>.UserControl = true</code>, because it throws an error:</p>\n\n<blockquote>\n  <p>you entered an expression that has an invalid reference to the property Visible</p>\n</blockquote>\n\n<p>I don't understand what's going on.</p>\n\n<p>Anyway, this is the code I am testing this with:</p>\n\n<pre><code>using System;\nusing System.Threading;\nusing Microsoft.VisualBasic;\n\nnamespace Test1\n{\n    class Program\n    {\n        const string TEST_DB_PATH = @\"C:\\Users\\Administrator\\Documents\\db1.accdb\";\n\n        public static void Main(string[] args)\n        {\n            dynamic accessApp = null;\n            try {\n                accessApp = Interaction.GetObject(null, \"Access.Application\");\n            } catch (Exception e) {\n                accessApp = Interaction.CreateObject(\"Access.Application\");\n            }\n\n            Console.WriteLine(\"accessApp: \" + accessApp);\n            Console.WriteLine(\"Version: \" + accessApp.Version);\n\n            accessApp.Visible = true;\n            accessApp.OpenCurrentDatabase(TEST_DB_PATH);\n            Thread.Sleep(750);\n            accessApp.CloseCurrentDatabase();\n            accessApp.Quit();\n\n            /*\n            Console.Write(\"Press any key to continue . . . \");\n            Console.ReadKey(true);\n            */\n        }\n    }\n}\n</code></pre>\n\n<p>So as said, when I create new instance of Access using the <code>CreateObject</code>, everything works. With <code>GetObject</code> COM object I can perform <code>OpenCurrentDatabase</code>, but I cannot perform <code>.Visible = true</code>, etc.</p>\n\n<p>Windows 7 x64 Pro SP1, tried with Access 2007 and 2016 - same result on both versions.</p>\n"}, {"tags": ["c#", "sql", "asp.net-mvc", "react-boilerplate"], "owner": {"reputation": 51, "user_id": 8546123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ae75b2b55a05f821c7e7b2518884b2?s=128&d=identicon&r=PG&f=1", "display_name": "Ribu", "link": "https://stackoverflow.com/users/8546123/ribu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548318418, "creation_date": 1548281088, "last_edit_date": 1548318418, "question_id": 54336395, "link": "https://stackoverflow.com/questions/54336395/invalidoperationexception-unable-to-resolve-service-for-type-boilerplate-web-a", "title": "InvalidOperationException: Unable to resolve service for type &#39;Boilerplate.Web.App.Models.DevOnBoardTaskContext&#39; while attempting to activate ~", "body": "<p>I am working on Boilerplate.web.app template to create basic CRUD application.</p>\n\n<p>I am using DB first approach. So, first I created the database, then cloned <a href=\"https://github.com/ParvezMirani/Boilerplate.Web.App\" rel=\"nofollow noreferrer\">https://github.com/ParvezMirani/Boilerplate.Web.App</a> in Visual Studio 2017, installed npm packages.</p>\n\n<p>Linked the database by running the custom command in npm console:</p>\n\n<pre><code>Scaffold-DbContext \"Server=(localdb)\\mssqllocaldb;Database=Blogging;Trusted_Connection=True;\" Microsoft.EntityFrameworkCore.SqlServer -OutputDir Models\n</code></pre>\n\n<p>It has successfully imported the model classes from db using above command. (Entity framework was not compatible with the template so used this step instead).</p>\n\n<p>I added a new controller \"customers\" to implement CRUD.</p>\n\n<p>Now when I run the project in browser, I am able to see the index page of homeController in boilerplate template but not of the custom customersController that comes from the table in database that I made.</p>\n\n<p>I get the following error when I try to open customers page in url:</p>\n\n<blockquote>\n  <p>InvalidOperationException: Unable to resolve service for type\n  'Boilerplate.Web.App.Models.DevOnBoardTaskContext' while attempting to\n  activate 'Boilerplate.Web.App.Controllers.CustomersController'.</p>\n</blockquote>\n\n<p>There is a warning shown in context class in models as:\n #warning To protect potentially sensitive information in your connection string, you should move it out of source code. See <a href=\"http://go.microsoft.com/fwlink/?LinkId=723263\" rel=\"nofollow noreferrer\">http://go.microsoft.com/fwlink/?LinkId=723263</a> for guidance on storing connection strings.</p>\n\n<pre><code>    `// *****DevOnBoardTaskContext.cs******`\n        using System;\n        using Microsoft.EntityFrameworkCore;\n        using Microsoft.EntityFrameworkCore.Metadata;\n\n        namespace Boilerplate.Web.App.Models\n        {\n            public partial\n\n class DevOnBoardTaskContext : DbContext\n        {\n            public DevOnBoardTaskContext()\n            {\n            }\n\n            public DevOnBoardTaskContext(DbContextOptions&lt;DevOnBoardTaskContext&gt; options)\n                : base(options)\n            {\n            }\n\n            public virtual DbSet&lt;Customer&gt; Customer { get; set; }\n            public virtual DbSet&lt;Product&gt; Product { get; set; }\n            public virtual DbSet&lt;Sales&gt; Sales { get; set; }\n            public virtual DbSet&lt;Store&gt; Store { get; set; }\n\n            protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\n            {\n                if (!optionsBuilder.IsConfigured)\n                {\n    #warning To protect potentially sensitive information in your connection string, you should move it out of source code. See http://go.microsoft.com/fwlink/?LinkId=723263 for guidance on storing connection strings.\n                    optionsBuilder.UseSqlServer(\"Server=RIBU\\\\SQLEXPRESS;Database=DevOnBoardTask;Trusted_Connection=True;\");\n                }\n            }\n\n            protected override void OnModelCreating(ModelBuilder modelBuilder)\n            {\n                modelBuilder.Entity&lt;Customer&gt;(entity =&gt;\n                {\n                    entity.Property(e =&gt; e.Address)\n                        .IsRequired()\n                        .HasMaxLength(50);\n\n                    entity.Property(e =&gt; e.Name)\n                        .IsRequired()\n                        .HasMaxLength(50);\n                });\n\n                modelBuilder.Entity&lt;Product&gt;(entity =&gt;\n                {\n                    entity.Property(e =&gt; e.Name)\n                        .IsRequired()\n                        .HasMaxLength(50);\n                });\n\n                modelBuilder.Entity&lt;Sales&gt;(entity =&gt;\n                {\n                    entity.Property(e =&gt; e.DateSold).HasColumnType(\"date\");\n\n                    entity.HasOne(d =&gt; d.Customer)\n                        .WithMany(p =&gt; p.Sales)\n                        .HasForeignKey(d =&gt; d.CustomerId)\n                        .OnDelete(DeleteBehavior.ClientSetNull)\n                        .HasConstraintName(\"FK_Sales_Customer\");\n\n                    entity.HasOne(d =&gt; d.Product)\n                        .WithMany(p =&gt; p.Sales)\n                        .HasForeignKey(d =&gt; d.ProductId)\n                        .OnDelete(DeleteBehavior.ClientSetNull)\n                        .HasConstraintName(\"FK_Sales_Product\");\n\n                    entity.HasOne(d =&gt; d.Store)\n                        .WithMany(p =&gt; p.Sales)\n                        .HasForeignKey(d =&gt; d.StoreId)\n                        .OnDelete(DeleteBehavior.ClientSetNull)\n                        .HasConstraintName(\"FK_Sales_Store\");\n                });\n\n                modelBuilder.Entity&lt;Store&gt;(entity =&gt;\n                {\n                    entity.Property(e =&gt; e.Address)\n                        .IsRequired()\n                        .HasMaxLength(50);\n\n                    entity.Property(e =&gt; e.Name)\n                        .IsRequired()\n                        .HasMaxLength(50);\n                });\n            }\n        }\n    }\n</code></pre>\n\n<p>CustomersController.cs </p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.AspNetCore.Mvc.Rendering;\nusing Microsoft.EntityFrameworkCore;\nusing Boilerplate.Web.App.Models;\n\nnamespace Boilerplate.Web.App.Controllers\n{\n    public class CustomersController : Controller\n    {\n        private readonly DevOnBoardTaskContext _context;\n\n        public CustomersController(DevOnBoardTaskContext context)\n        {\n            _context = context;\n        }\n\n        // GET: Customers\n        public async Task&lt;IActionResult&gt; Index()\n        {\n            return View(await _context.Customer.ToListAsync());\n        }\n\n        // GET: Customers/Details/5\n        public async Task&lt;IActionResult&gt; Details(int? id)\n        {\n            if (id == null)\n            {\n                return NotFound();\n            }\n\n            var customer = await _context.Customer\n                .FirstOrDefaultAsync(m =&gt; m.Id == id);\n            if (customer == null)\n            {\n                return NotFound();\n            }\n\n            return View(customer);\n        }\n\n        // GET: Customers/Create\n        public IActionResult Create()\n        {\n            return View();\n        }\n\n        // POST: Customers/Create\n        // To protect from overposting attacks, please enable the specific properties you want to bind to, for \n        // more details see http://go.microsoft.com/fwlink/?LinkId=317598.\n        [HttpPost]\n        [ValidateAntiForgeryToken]\n        public async Task&lt;IActionResult&gt; Create([Bind(\"Id,Name,Address\")] Customer customer)\n        {\n            if (ModelState.IsValid)\n            {\n                _context.Add(customer);\n                await _context.SaveChangesAsync();\n                return RedirectToAction(nameof(Index));\n            }\n            return View(customer);\n        }\n\n        // GET: Customers/Edit/5\n        public async Task&lt;IActionResult&gt; Edit(int? id)\n        {\n            if (id == null)\n            {\n                return NotFound();\n            }\n\n            var customer = await _context.Customer.FindAsync(id);\n            if (customer == null)\n            {\n                return NotFound();\n            }\n            return View(customer);\n        }\n\n        // POST: Customers/Edit/5\n        // To protect from overposting attacks, please enable the specific properties you want to bind to, for \n        // more details see http://go.microsoft.com/fwlink/?LinkId=317598.\n        [HttpPost]\n        [ValidateAntiForgeryToken]\n        public async Task&lt;IActionResult&gt; Edit(int id, [Bind(\"Id,Name,Address\")] Customer customer)\n        {\n            if (id != customer.Id)\n            {\n                return NotFound();\n            }\n\n            if (ModelState.IsValid)\n            {\n                try\n                {\n                    _context.Update(customer);\n                    await _context.SaveChangesAsync();\n                }\n                catch (DbUpdateConcurrencyException)\n                {\n                    if (!CustomerExists(customer.Id))\n                    {\n                        return NotFound();\n                    }\n                    else\n                    {\n                        throw;\n                    }\n                }\n                return RedirectToAction(nameof(Index));\n            }\n            return View(customer);\n        }\n\n        // GET: Customers/Delete/5\n        public async Task&lt;IActionResult&gt; Delete(int? id)\n        {\n            if (id == null)\n            {\n                return NotFound();\n            }\n\n            var customer = await _context.Customer\n                .FirstOrDefaultAsync(m =&gt; m.Id == id);\n            if (customer == null)\n            {\n                return NotFound();\n            }\n\n            return View(customer);\n        }\n\n        // POST: Customers/Delete/5\n        [HttpPost, ActionName(\"Delete\")]\n        [ValidateAntiForgeryToken]\n        public async Task&lt;IActionResult&gt; DeleteConfirmed(int id)\n        {\n            var customer = await _context.Customer.FindAsync(id);\n            _context.Customer.Remove(customer);\n            await _context.SaveChangesAsync();\n            return RedirectToAction(nameof(Index));\n        }\n\n        private bool CustomerExists(int id)\n        {\n            return _context.Customer.Any(e =&gt; e.Id == id);\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Ew7LU.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Could someone please help me resolve it. Many Thanks!</p>\n"}, {"tags": ["c#", "sendgrid-api-v3"], "comments": [{"owner": {"reputation": 601, "user_id": 1005310, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/148e08be842f200869db3459cd5e9189?s=128&d=identicon&r=PG", "display_name": "user1005310", "link": "https://stackoverflow.com/users/1005310/user1005310"}, "reply_to_user": {"reputation": 74735, "user_id": 82586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HfVKA.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/82586/james"}, "edited": false, "score": 0, "creation_date": 1548711874, "post_id": 54336360, "comment_id": 95632458, "body": "I am using  API key instead of username and password"}], "answers": [{"tags": [], "owner": {"reputation": 74735, "user_id": 82586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HfVKA.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/82586/james"}, "is_accepted": true, "score": 0, "last_activity_date": 1548289911, "last_edit_date": 1548289911, "creation_date": 1548281759, "answer_id": 54336536, "question_id": 54336360, "link": "https://stackoverflow.com/questions/54336360/sendgrid-v3-connect-using-username-and-password/54336536#54336536", "title": "SendGrid V3 connect using username and password", "body": "<p>As per the <a href=\"https://sendgrid.com/docs/API_Reference/Web_API_v3/How_To_Use_The_Web_API_v3/authentication.html\" rel=\"nofollow noreferrer\">docs</a>, an API key is the recommended approach for the V3 API, it doesn't explicitly state it doesn't support Basic authentication so if you could try setting the <code>Authorization</code> header directly (headers can be passed into the client as options). However, I'd strongly advise just using an API key, it's a much more secure mechanism.</p>\n\n<p>FWIW Basic authentication is considered legacy and should only be used for V2.</p>\n"}], "owner": {"reputation": 601, "user_id": 1005310, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/148e08be842f200869db3459cd5e9189?s=128&d=identicon&r=PG", "display_name": "user1005310", "link": "https://stackoverflow.com/users/1005310/user1005310"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 54336536, "answer_count": 1, "score": 0, "last_activity_date": 1548289911, "creation_date": 1548280928, "question_id": 54336360, "link": "https://stackoverflow.com/questions/54336360/sendgrid-v3-connect-using-username-and-password", "title": "SendGrid V3 connect using username and password", "body": "<p>How can I use SendGrid.SendGridClient to connect using username and password.</p>\n\n<p>There are lot of examples given using how to connect with API Key.</p>\n\n<p>But if I want to connect with username and password. How do i achieve that ?</p>\n\n<p>I am using sendgrid 9.10.0</p>\n\n<p>Any help ?</p>\n"}, {"tags": ["c#", "windows"], "comments": [{"owner": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "edited": false, "score": 3, "creation_date": 1548280910, "post_id": 54336298, "comment_id": 95489993, "body": "Take a look at <a href=\"https://docs.microsoft.com/en-us/windows/configuration/kiosk-single-app\" rel=\"nofollow noreferrer\">Kiosk Mode</a>. I imagine you&#39;re trying to do something like that."}, {"owner": {"reputation": 46070, "user_id": 1410664, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/vGygm.gif?s=128&g=1", "display_name": "Caius Jard", "link": "https://stackoverflow.com/users/1410664/caius-jard"}, "edited": false, "score": 1, "creation_date": 1548281036, "post_id": 54336298, "comment_id": 95490054, "body": "Internet kiosks etc often do this by removing keys from the keyboard, so there literally isn\u2019t a way to press Ctrl-alt-del for example"}], "owner": {"reputation": 1762, "user_id": 8517948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7162a76e25e66131b177eb41d6b4d301?s=128&d=identicon&r=PG&f=1", "display_name": "LW001", "link": "https://stackoverflow.com/users/8517948/lw001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548280492, "creation_date": 1548280492, "question_id": 54336298, "link": "https://stackoverflow.com/questions/54336298/how-to-stop-a-user-from-switching-desktops", "title": "How to stop a user from switching Desktops", "body": "<p>So I want to create a program that stops the user (Only me, this isn't a virus) from moving away from it at all. Now I can already keep a window in Focus and covering the full screen but if someone has multiple Desktops opened they can switch to another one, open Task Manager and get rid of the program which is what I'm trying to avoid. (Trust me, it isn't a virus)</p>\n\n<p>Now I've tried using <a href=\"https://stackoverflow.com/a/33572224/8517948\">this solution</a> and copying it into my WPF Window's Constructor but it does literally nothing whether I use Windows + Tab or Ctrl + Windows + Arrow Keys to switch Desktops.</p>\n\n<p>How would I best go about keeping that window on the screen no matter what happens?</p>\n"}, {"tags": ["c#", ".net", "amazon-web-services", "amazon-s3"], "answers": [{"comments": [{"owner": {"reputation": 5942, "user_id": 1250033, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8c3281b37c80c7b50a8e9b575499097?s=128&d=identicon&r=PG", "display_name": "rae1", "link": "https://stackoverflow.com/users/1250033/rae1"}, "edited": false, "score": 0, "creation_date": 1548303230, "post_id": 54336720, "comment_id": 95495073, "body": "I&#39;m actually looking for a way to run the query <b>server-side</b> so that <code>ListObjects</code> returns a pattern-matching set of keys. I&#39;d like to avoid retrieving all files <i>and then</i> filter them."}, {"owner": {"reputation": 8058, "user_id": 401096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aqDc7.jpg?s=128&g=1", "display_name": "bwest", "link": "https://stackoverflow.com/users/401096/bwest"}, "reply_to_user": {"reputation": 5942, "user_id": 1250033, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8c3281b37c80c7b50a8e9b575499097?s=128&d=identicon&r=PG", "display_name": "rae1", "link": "https://stackoverflow.com/users/1250033/rae1"}, "edited": false, "score": 0, "creation_date": 1548305518, "post_id": 54336720, "comment_id": 95495539, "body": "The --query param on the CLI filters the result set on output, similar to what would happen with JmesPath.NET. It doesn&#39;t affect what the API call returns. The only request parameters available to reduce the result set are prefix and delimiter, which essentially help you group things logically like a folder structure does in a file storage engine. Unless your use case can be handled by those parameters, you&#39;re stuck with filtering on the output side."}, {"owner": {"reputation": 5942, "user_id": 1250033, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8c3281b37c80c7b50a8e9b575499097?s=128&d=identicon&r=PG", "display_name": "rae1", "link": "https://stackoverflow.com/users/1250033/rae1"}, "edited": false, "score": 1, "creation_date": 1548346447, "post_id": 54336720, "comment_id": 95517280, "body": "Oh, I see. I&#39;ll refactor things to work post-retrieval then. \ud83d\udc4d Could you update your answer to include that last bit?"}], "tags": [], "owner": {"reputation": 8058, "user_id": 401096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/aqDc7.jpg?s=128&g=1", "display_name": "bwest", "link": "https://stackoverflow.com/users/401096/bwest"}, "is_accepted": true, "score": 1, "last_activity_date": 1548347430, "last_edit_date": 1548347430, "creation_date": 1548282746, "answer_id": 54336720, "question_id": 54336209, "link": "https://stackoverflow.com/questions/54336209/how-to-filter-pattern-match-files-on-retrieval-from-aws-s3-using-net-aws-sdk/54336720#54336720", "title": "How To Filter, Pattern-Match Files on Retrieval from AWS S3 using .NET AWS SDK?", "body": "<p>The AWS CLI uses <a href=\"http://jmespath.org/\" rel=\"nofollow noreferrer\">JMESPath</a> for query expressions. There is a .NET port called <a href=\"https://github.com/jdevillard/JmesPath.Net\" rel=\"nofollow noreferrer\">JmesPath.NET</a> that is compatible with the same API and is well-maintained. You could use the SDK to retrieve the result set, and then filter it with JmesPath.NET expressions. It's available as a <a href=\"https://www.nuget.org/packages/JmesPath.Net/\" rel=\"nofollow noreferrer\">NuGet package</a> too.</p>\n\n<p>The <code>--query</code> param on the CLI filters the result set on output, similar to what would happen with JmesPath.NET. It doesn't affect what the API call returns. The only request parameters available to reduce the result set are <code>prefix</code> and <code>delimiter</code>, which group things logically like a folder structure does in a file storage engine. Unless your use case can be handled by those parameters, you're stuck with filtering on the output side.</p>\n"}], "owner": {"reputation": 5942, "user_id": 1250033, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8c3281b37c80c7b50a8e9b575499097?s=128&d=identicon&r=PG", "display_name": "rae1", "link": "https://stackoverflow.com/users/1250033/rae1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 54336720, "answer_count": 1, "score": 2, "last_activity_date": 1548347430, "creation_date": 1548280048, "last_edit_date": 1548346586, "question_id": 54336209, "link": "https://stackoverflow.com/questions/54336209/how-to-filter-pattern-match-files-on-retrieval-from-aws-s3-using-net-aws-sdk", "title": "How To Filter, Pattern-Match Files on Retrieval from AWS S3 using .NET AWS SDK?", "body": "<p>When using the <code>ListObjects</code> request (.NET AWS SDK), is there a way to only list files where the key matches a given pattern? Or, more broadly, is there a way to query files from <code>S3</code> based on their key using any request type from the .NET AWS SDK?</p>\n\n<p>I'm aware of the <a href=\"https://stackoverflow.com/questions/27274996/filter-s3-list-objects-results-to-find-a-key-matching-a-pattern\"><code>--query</code> param, available on AWS CLI</a>, but I'm not able to find an equivalent method on .NET.</p>\n\n<p>I'm looking for a way to run the query <strong>server-side</strong> so that <code>ListObjects</code> returns a pattern-matching set of keys. I'd like to avoid retrieving all files <code>and then</code> filter them.</p>\n"}, {"tags": ["c#", "wav", "naudio"], "comments": [{"owner": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "edited": false, "score": 0, "creation_date": 1548280009, "post_id": 54336107, "comment_id": 95489629, "body": "There is no <code>volume</code> property of a Wave file.  The current playback volume can be adjusted but it has no effect on the file."}, {"owner": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "edited": false, "score": 0, "creation_date": 1548280213, "post_id": 54336107, "comment_id": 95489699, "body": "Note: the post you have linked to, does not talk about volume and it indicates clearly in the accepted answer: <i>&quot;...the following two lines of code <b>will create a zero-length stream of PCM 16 bit</b> and...&quot;</i>"}, {"owner": {"reputation": 191, "user_id": 3954696, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3bF97.jpg?s=128&g=1", "display_name": "B Minster", "link": "https://stackoverflow.com/users/3954696/b-minster"}, "reply_to_user": {"reputation": 5203, "user_id": 1760479, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/gFcMy.jpg?s=128&g=1", "display_name": "David Tansey", "link": "https://stackoverflow.com/users/1760479/david-tansey"}, "edited": false, "score": 0, "creation_date": 1548280749, "post_id": 54336107, "comment_id": 95489925, "body": "@DavidTansey How can the volume of a file be manipulated then? Audio file manipulation software like Cool Edit allows for that sort of thing. I&#39;m trying to recreate that functionality."}, {"owner": {"reputation": 45124, "user_id": 7532, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/db4b131b1b1519a5a22f84b1e8737f9b?s=128&d=identicon&r=PG", "display_name": "Mark Heath", "link": "https://stackoverflow.com/users/7532/mark-heath"}, "edited": false, "score": 0, "creation_date": 1549281313, "post_id": 54336107, "comment_id": 95833938, "body": "Why are you using a <code>WaveFormatConversionStream</code>? You could just pass the reader into <code>WaveFileWriter.CreateWaveFile16</code>"}], "owner": {"reputation": 191, "user_id": 3954696, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/3bF97.jpg?s=128&g=1", "display_name": "B Minster", "link": "https://stackoverflow.com/users/3954696/b-minster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548279622, "creation_date": 1548279622, "question_id": 54336107, "link": "https://stackoverflow.com/questions/54336107/naudio-error-when-adjusting-volume-of-wave-file", "title": "NAudio error when adjusting volume of wave file", "body": "<p><strong>Desired Outcome: Allow users to manipulate the volume of an audio file.</strong></p>\n\n<p>I am trying to adjust the volume property of a wave file by creating a new file and adjusting the volume property. Each attempt has caused a different issue.</p>\n\n<p>The following results in a <code>AcmNotPossible calling acmStreamOpen</code> error:</p>\n\n<pre><code>WaveFormat target = new WaveFormat(8000, 16, 1);\nvar reader = new AudioFileReader(textBox2.Text);\nreader.Volume = 0.5f;\n\nusing (WaveFormatConversionStream str = new WaveFormatConversionStream(target, reader))\n{\n    WaveFileWriter.CreateWaveFile(textBox2.Text, str);\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/13628145/acmnotpossible-calling-acmstreamopen-naudio\">This post</a> suggested getting around the problem by <code>RawSourceWaveStream</code> but it keeps creating a file with a length of 0:00. I have tried passing an int as an argument for the <code>MemoryStream</code> with the same result and no way to assign a new value to the volume property.</p>\n"}, {"tags": ["c#", "wpf", "xaml", "namespaces", "datacontext"], "comments": [{"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 0, "creation_date": 1548280046, "post_id": 54336106, "comment_id": 95489642, "body": "The designer has a (deserved) terrible reputation for false positives on errors. If your program runs, you just have to ignore it."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1548280085, "post_id": 54336106, "comment_id": 95489654, "body": "Oh.  This is in the designer?  Rebuild your project.  If that doesn&#39;t work, restart Visual Studio and rebuild your project.  Failing that, try changing ViewModel to lower case, as in <code>xmlns:viewModel</code>."}, {"owner": {"reputation": 25, "user_id": 10923157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4317ec5efa96e3b6fa1beda7ab6de042?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Miller", "link": "https://stackoverflow.com/users/10923157/bill-miller"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1548280316, "post_id": 54336106, "comment_id": 95489741, "body": "@RobertHarvey - Rebuilding did not help, but I changed to lower case and restarted Visual Studio - now it works. Many thanks. Really a but in the designer..."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1548280699, "post_id": 54336106, "comment_id": 95489906, "body": "The reason this might have been an issue is because <code>ViewModel</code> (in upper case) appears in your namespace declarations."}, {"owner": {"reputation": 25, "user_id": 10923157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4317ec5efa96e3b6fa1beda7ab6de042?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Miller", "link": "https://stackoverflow.com/users/10923157/bill-miller"}, "edited": false, "score": 0, "creation_date": 1548280765, "post_id": 54336106, "comment_id": 95489934, "body": "I see that sounds reasonable..."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 10923157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4317ec5efa96e3b6fa1beda7ab6de042?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Miller", "link": "https://stackoverflow.com/users/10923157/bill-miller"}, "is_accepted": true, "score": 0, "last_activity_date": 1548280410, "creation_date": 1548280410, "answer_id": 54336284, "question_id": 54336106, "link": "https://stackoverflow.com/questions/54336106/datacontext-class-not-found-in-xaml-designer-while-everything-looks-fine/54336284#54336284", "title": "DataContext class not found in XAML Designer (while everything looks fine)", "body": "<p>As adivsed by @RobertHarvey in a comment, I changed to lowercase and restarted Visual Studio. Now it works.</p>\n\n<p>Just rebuilding the solution did not help (I tried that earlier).</p>\n"}], "owner": {"reputation": 25, "user_id": 10923157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4317ec5efa96e3b6fa1beda7ab6de042?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Miller", "link": "https://stackoverflow.com/users/10923157/bill-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 54336284, "answer_count": 1, "score": 0, "last_activity_date": 1548280410, "creation_date": 1548279619, "question_id": 54336106, "link": "https://stackoverflow.com/questions/54336106/datacontext-class-not-found-in-xaml-designer-while-everything-looks-fine", "title": "DataContext class not found in XAML Designer (while everything looks fine)", "body": "<p>I am trying to set my datacontext in the XAML file via</p>\n\n<pre><code>&lt;Window x:Class=\"LocationScout.SettingsDeleteWindow\"\n    xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"\n    xmlns:d=\"http://schemas.microsoft.com/expression/blend/2008\"\n    xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"\n    xmlns:ViewModel=\"clr-namespace:LocationScout.ViewModel\"\n    mc:Ignorable=\"d\"\n    Title=\"Delete\" Height=\"315\" Width=\"350\" \n    WindowStartupLocation=\"CenterScreen\"&gt;\n\n&lt;Window.DataContext&gt;\n    &lt;ViewModel:SettingsDeleteDisplayItem/&gt;\n&lt;/Window.DataContext&gt;\n</code></pre>\n\n<p>The XAML editor, however, shows the error \"The name \"SettingsDeleteDisplayItem\" does not exist in the namespace \"clr-namespace:LocationScout.ViewModel\".</p>\n\n<p>The view model class looks fine for me:</p>\n\n<pre><code>namespace LocationScout.ViewModel\n{\n    public class SettingsDeleteDisplayItem : BaseObservableObject\n    {\n         private long _countryAreaCountToDelete;\n\n         public long CountryAreaCountToDelete\n         {\n            get =&gt; _countryAreaCountToDelete;\n            set\n            {\n                _countryAreaCountToDelete = value;\n                OnPropertyChanged();\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Building the solution works fine without error. Any idea? Many thanks.</p>\n"}, {"tags": ["c#", "asp.net-core", ".net-core", "in-memory-database"], "answers": [{"comments": [{"owner": {"reputation": 2204, "user_id": 8744999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5a358087b8a9e7f9ace69d7af8b74700?s=128&d=identicon&r=PG", "display_name": "DonkeyBanana", "link": "https://stackoverflow.com/users/8744999/donkeybanana"}, "edited": false, "score": 0, "creation_date": 1548282215, "post_id": 54336282, "comment_id": 95490458, "body": "The examples concentrate on the usage of in-memory DB for testing. How would I go about to make it available in my controller during a manual test-run? I understand that I should use a constructor like <code>public MyClass(MyDbContext c)</code> but how do I make it work? I can register it using DI as a scoped service (or possibly singelton) but it feels like there&#39;s more to be done that the guide doesn&#39;t tell."}, {"owner": {"reputation": 28433, "user_id": 1565525, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2e3a5d0911464ffa3d7ac48475cf98d?s=128&d=identicon&r=PG", "display_name": "Fabio", "link": "https://stackoverflow.com/users/1565525/fabio"}, "reply_to_user": {"reputation": 2204, "user_id": 8744999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5a358087b8a9e7f9ace69d7af8b74700?s=128&d=identicon&r=PG", "display_name": "DonkeyBanana", "link": "https://stackoverflow.com/users/8744999/donkeybanana"}, "edited": false, "score": 0, "creation_date": 1548318034, "post_id": 54336282, "comment_id": 95500158, "body": "@DonkeyBanana, after installing InMemory Nuget package you will be able to register DbConext in the Startup with <code>.UseInMemoryDatabase(databaseName: &quot;something&quot;)</code> option"}], "tags": [], "owner": {"reputation": 36762, "user_id": 869621, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7ab9817b53b7e7b0e735528bc9c2372?s=128&d=identicon&r=PG", "display_name": "Kevin Gosse", "link": "https://stackoverflow.com/users/869621/kevin-gosse"}, "is_accepted": true, "score": 3, "last_activity_date": 1548280400, "creation_date": 1548280400, "answer_id": 54336282, "question_id": 54336085, "link": "https://stackoverflow.com/questions/54336085/how-do-i-emulate-a-database-in-memory-only-lasting-during-the-runtime/54336282#54336282", "title": "How do I emulate a database in memory only lasting during the runtime?", "body": "<p>Entity Framework Core provides a in-memory database. It's initially designed for unit-tests, but it can be used for other purposes. </p>\n\n<p>The full documentation is available here: <a href=\"https://docs.microsoft.com/en-us/ef/core/providers/in-memory/\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/ef/core/providers/in-memory/</a></p>\n\n<pre><code>[TestMethod]\npublic void Add_writes_to_database()\n{\n    var options = new DbContextOptionsBuilder&lt;BloggingContext&gt;()\n        .UseInMemoryDatabase(databaseName: \"Add_writes_to_database\")\n        .Options;\n\n    // Run the test against one instance of the context\n    using (var context = new BloggingContext(options))\n    {\n        var service = new BlogService(context);\n        service.Add(\"http://sample.com\");\n    }\n\n    // Use a separate instance of the context to verify correct data was saved to database\n    using (var context = new BloggingContext(options))\n    {\n        Assert.AreEqual(1, context.Blogs.Count());\n        Assert.AreEqual(\"http://sample.com\", context.Blogs.Single().Url);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2204, "user_id": 8744999, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5a358087b8a9e7f9ace69d7af8b74700?s=128&d=identicon&r=PG", "display_name": "DonkeyBanana", "link": "https://stackoverflow.com/users/8744999/donkeybanana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 54336282, "answer_count": 1, "score": 1, "last_activity_date": 1548280400, "creation_date": 1548279529, "question_id": 54336085, "link": "https://stackoverflow.com/questions/54336085/how-do-i-emulate-a-database-in-memory-only-lasting-during-the-runtime", "title": "How do I emulate a database in memory only lasting during the runtime?", "body": "<p>I'd like to emulate a database operations using <em>DbContext</em> and use EF to operate on my models but without an actual database being installed. Is it possible (fairly easily) in .NET Core (version 2.2 if it makes any difference)?</p>\n\n<p>I've read about <em>AddXxxInMemory</em> methods but only in the context of Identity Server. Eventually I'll have a persistent data source but on occasion, I'd like to have a faked one just in memory, populate it by a seed and not rely on an external DB being installed.</p>\n\n<p>Is that possible at all? My googling created mostly confusion and drowned in the guides on how to connect to SQL Server and for some weird reason also links to IMDB.</p>\n"}, {"tags": ["c#", "asp.net", "excel", "epplus", "asp.net-4.5"], "comments": [{"owner": {"reputation": 238, "user_id": 10484567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688702dc4b153c0874e43e6a6e84e84?s=128&d=identicon&r=PG&f=1", "display_name": "Gnbrkm41", "link": "https://stackoverflow.com/users/10484567/gnbrkm41"}, "edited": false, "score": 0, "creation_date": 1548279232, "post_id": 54335917, "comment_id": 95489293, "body": "I personally have never had a chance to parse DateTime but how about using DateTime.ParseExact method? it seems that you can specify the format of the input."}, {"owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548279303, "post_id": 54335917, "comment_id": 95489322, "body": "@mjwills the data with PM works well. but PM is not related, changing the Times (with or without AM/PM) does not make difference for others."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548279421, "post_id": 54335917, "comment_id": 95489381, "body": "It would be awesome if you could provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and a xlsx file that repros the issue, so we can run it on our end."}, {"owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "reply_to_user": {"reputation": 238, "user_id": 10484567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688702dc4b153c0874e43e6a6e84e84?s=128&d=identicon&r=PG&f=1", "display_name": "Gnbrkm41", "link": "https://stackoverflow.com/users/10484567/gnbrkm41"}, "edited": false, "score": 0, "creation_date": 1548279502, "post_id": 54335917, "comment_id": 95489416, "body": "@Gnbrkm41 same error."}, {"owner": {"reputation": 238, "user_id": 10484567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688702dc4b153c0874e43e6a6e84e84?s=128&d=identicon&r=PG&f=1", "display_name": "Gnbrkm41", "link": "https://stackoverflow.com/users/10484567/gnbrkm41"}, "edited": false, "score": 0, "creation_date": 1548279522, "post_id": 54335917, "comment_id": 95489422, "body": "Could you tell me what the system local culture is, as well? I&#39;m assuming en-GB, but just to confirm."}, {"owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "reply_to_user": {"reputation": 238, "user_id": 10484567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688702dc4b153c0874e43e6a6e84e84?s=128&d=identicon&r=PG&f=1", "display_name": "Gnbrkm41", "link": "https://stackoverflow.com/users/10484567/gnbrkm41"}, "edited": false, "score": 0, "creation_date": 1548279624, "post_id": 54335917, "comment_id": 95489461, "body": "@Gnbrkm41 en-gb. Other DateTimeStyles also I&#39;ve tried, no luck."}, {"owner": {"reputation": 238, "user_id": 10484567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688702dc4b153c0874e43e6a6e84e84?s=128&d=identicon&r=PG&f=1", "display_name": "Gnbrkm41", "link": "https://stackoverflow.com/users/10484567/gnbrkm41"}, "edited": false, "score": 0, "creation_date": 1548279845, "post_id": 54335917, "comment_id": 95489553, "body": "Just wondering, how does the parsed DateTime look like at row 3?"}, {"owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "reply_to_user": {"reputation": 238, "user_id": 10484567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688702dc4b153c0874e43e6a6e84e84?s=128&d=identicon&r=PG&f=1", "display_name": "Gnbrkm41", "link": "https://stackoverflow.com/users/10484567/gnbrkm41"}, "edited": false, "score": 0, "creation_date": 1548280111, "post_id": 54335917, "comment_id": 95489664, "body": "@Gnbrkm41 when System.Globalization.DateTimeStyles.AdjustToUniversal (Same as DateTimeStyles.None) used as datetimestyle, It is: 2018-06-04 6:07:00 PM  (others are not working)"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1548280566, "post_id": 54335917, "comment_id": 95489847, "body": "You say <i>Yet, Row 4 looks different than the others for some reason. This is not important a lot tho</i>.  Well, it probably <i>is</i> important: rows 2, 3, 5 are Strings, that just happen to look like dates (if you assume dd/mm/yyyy).  Row 4 is a date, and I it might actually be 4th June, not 6th April, depending on your locale (not the custom date format)"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4014205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ooQZu_d9E_I/AAAAAAAAAAI/AAAAAAAAPgg/oxYhIbWPRkQ/photo.jpg?sz=128", "display_name": "Mohsin Aboobacker", "link": "https://stackoverflow.com/users/4014205/mohsin-aboobacker"}, "edited": false, "score": 0, "creation_date": 1548279928, "post_id": 54336157, "comment_id": 95489597, "body": "I tested with your date use cases and it did parse well."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1548280056, "post_id": 54336157, "comment_id": 95489645, "body": "Please post answers and not questions."}, {"owner": {"reputation": 49, "user_id": 4014205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ooQZu_d9E_I/AAAAAAAAAAI/AAAAAAAAPgg/oxYhIbWPRkQ/photo.jpg?sz=128", "display_name": "Mohsin Aboobacker", "link": "https://stackoverflow.com/users/4014205/mohsin-aboobacker"}, "edited": false, "score": 0, "creation_date": 1548280386, "post_id": 54336157, "comment_id": 95489767, "body": "Parse successfull: 20/03/2018 12:00:00 AM  This is what was consoled."}, {"owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "edited": false, "score": 0, "creation_date": 1548280919, "post_id": 54336157, "comment_id": 95489998, "body": "Thank you, actually your answer is correct as well. Just I couldn&#39;t find appropriate culture, my bad, creator of excel is not following en-US apparently. THanks!"}, {"owner": {"reputation": 238, "user_id": 10484567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688702dc4b153c0874e43e6a6e84e84?s=128&d=identicon&r=PG&f=1", "display_name": "Gnbrkm41", "link": "https://stackoverflow.com/users/10484567/gnbrkm41"}, "reply_to_user": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "edited": false, "score": 0, "creation_date": 1548281451, "post_id": 54336157, "comment_id": 95490190, "body": "@ErayBalkanli Excel did nothing wrong there, the way date/time is represented in text differs by regions (MM-dd-yyyy in US, dd-MM-yyyy in EU, yyyy-MM-dd in some places). Excel formatted the given datetime according to the user&#39;s PC locale, which in your case was UK&#39;s MM-dd-yyyy format. That&#39;s why there is a <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">standard</a> regarding date/time formatting."}], "tags": [], "owner": {"reputation": 49, "user_id": 4014205, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ooQZu_d9E_I/AAAAAAAAAAI/AAAAAAAAPgg/oxYhIbWPRkQ/photo.jpg?sz=128", "display_name": "Mohsin Aboobacker", "link": "https://stackoverflow.com/users/4014205/mohsin-aboobacker"}, "is_accepted": false, "score": 1, "last_activity_date": 1548279977, "last_edit_date": 1548279977, "creation_date": 1548279829, "answer_id": 54336157, "question_id": 54335917, "link": "https://stackoverflow.com/questions/54335917/datetime-conversion-is-not-working-while-reading-dates-from-excel-where-day-12/54336157#54336157", "title": "DateTime conversion is not working while reading dates from excel where Day &gt; 12", "body": "<p>Please use an appropriate culture.</p>\n\n<pre><code>var originalDate = \"6/4/18 6:07 PM\";\nDateTime parsedDate;\n\nvar culture = System.Globalization.CultureInfo.CreateSpecificCulture(\"en-AU\");\nvar styles = System.Globalization.DateTimeStyles.None;\nif (!DateTime.TryParse(originalDate, culture, styles, out parsedDate))\n{\n       Console.WriteLine(parsedDate);\n}\n\n        Console.WriteLine($\"Parse successfull: {parsedDate}\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 238, "user_id": 10484567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688702dc4b153c0874e43e6a6e84e84?s=128&d=identicon&r=PG&f=1", "display_name": "Gnbrkm41", "link": "https://stackoverflow.com/users/10484567/gnbrkm41"}, "edited": false, "score": 0, "creation_date": 1548281029, "post_id": 54336305, "comment_id": 95490051, "body": "or alternatively, save the datetime accordingly to <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow noreferrer\">ISO 8601 standard</a>. :)"}], "tags": [], "owner": {"reputation": 238, "user_id": 10484567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e688702dc4b153c0874e43e6a6e84e84?s=128&d=identicon&r=PG&f=1", "display_name": "Gnbrkm41", "link": "https://stackoverflow.com/users/10484567/gnbrkm41"}, "is_accepted": true, "score": 2, "last_activity_date": 1548280562, "creation_date": 1548280562, "answer_id": 54336305, "question_id": 54335917, "link": "https://stackoverflow.com/questions/54335917/datetime-conversion-is-not-working-while-reading-dates-from-excel-where-day-12/54336305#54336305", "title": "DateTime conversion is not working while reading dates from excel where Day &gt; 12", "body": "<p>It appears that CultureInfo.InvariantCulture does not like to receive strings in that particular format. I believe it's related to the fact that in the US date is written in MM/dd/yyyy order whereas in Europe it is written in dd/MM/yyyy (which includes the UK, and Australia).</p>\n\n<p>If that's the case, <code>20/03/2010 13:58</code> would have been parsed as 3rd day of 20th month, 2010, which does not make any sense.</p>\n\n<p>I believe using `new CultureInfo(\"en-gb\") instead of CultureInfo.InvariantCulture would be better choice here.</p>\n"}], "owner": {"reputation": 6890, "user_id": 1761307, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/QQQps.jpg?s=128&g=1", "display_name": "Eray Balkanli", "link": "https://stackoverflow.com/users/1761307/eray-balkanli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 54336305, "answer_count": 2, "score": 0, "last_activity_date": 1548280562, "creation_date": 1548278828, "last_edit_date": 1548279763, "question_id": 54335917, "link": "https://stackoverflow.com/questions/54335917/datetime-conversion-is-not-working-while-reading-dates-from-excel-where-day-12", "title": "DateTime conversion is not working while reading dates from excel where Day &gt; 12", "body": "<p>This is my first 5 rows in my XLSX file:</p>\n\n<p><a href=\"https://i.stack.imgur.com/h3Iy1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h3Iy1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note that the format for the <code>ResLastCallDate</code> column is <code>CustomFormat-&gt;dd/mm/yyyy hh:mm:ss</code>. Yet, Row 4 looks different than the others for some reason. This is not important a lot tho, the important part is that the XLSX file is being uploaded to my asp.net 4.5 web page where I read the data via EPPlus. However, when I am reading ResLastCallDate column, I am receiving an error. See the code below:</p>\n\n<pre><code>System.Globalization.CultureInfo provider = System.Globalization.CultureInfo.InvariantCulture;\nif (!DateTime.TryParse(dr[\"ResLastCallDate\"].ToString(),provider, System.Globalization.DateTimeStyles.AssumeLocal, out resLastCallDate))\n{\n     Msg = Msg + string.Format(\"Row {0}: ResLastCallDate is not date ({1}).\\n\", r, dr[\"ResLastCallDate\"].ToString());\n}\n...\ntxtDebug.Text = Msg;\n</code></pre>\n\n<p>I have tried not to use a provider, other DateTimeStyles, none of them worked, except Row 4 in the excel always been read correctly. See the output:</p>\n\n<pre><code>Row 0: ResLastCallDate is not date (20/03/2018 13:58)\nRow 1: ResLastCallDate is not date (20/03/2018 13:58)\nRow 3: ResLastCallDate is not date (15/03/2018 20:25)\n</code></pre>\n\n<p>So Row 2 (which equals ClientID=3621) works but others not for a reason. I've tried General and Date formats in the excel for those cells, still not working. What else I can do to handle this issue? Any help would be appreciated.</p>\n\n<p>EDIT: When I convert it to dr[\"ResLastCallDate\"].ToString() only (no provider I use), it works on my local machine, but when I publish to the server it does not work (same error message received)</p>\n"}, {"tags": ["c#", ".net", "thread-safety"], "comments": [{"owner": {"reputation": 3811, "user_id": 574130, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f5ef61cd993e3fe28bb681b0ebf340c0?s=128&d=identicon&r=PG", "display_name": "Ben Cameron", "link": "https://stackoverflow.com/users/574130/ben-cameron"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548279360, "post_id": 54335905, "comment_id": 95489354, "body": "I didn&#39;t actually get feedback on my solution. It was all done on paper. Now I;m trying it on a PC at home."}, {"owner": {"reputation": 1238, "user_id": 3401554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1403940254/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/3401554/ben"}, "edited": false, "score": 0, "creation_date": 1548279610, "post_id": 54335905, "comment_id": 95489453, "body": "You&#39;re not scheduling your order. Each call to Cancel you&#39;re creating a new Order, so they&#39;re inherently threadsafe because they&#39;re separate objects. For this to be a meaningful test you need to create a new order, schedule it, then cancel it twice, and handle that cancellation in a threadsafe manner (i.e., handle the fact it may already be canceled, or in the process of being cancelled)."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548279695, "post_id": 54335905, "comment_id": 95489493, "body": "<code>_timer = new Timer(x =&gt; { action(); }, null, timeToGo, Timeout.InfiniteTimeSpan);</code> What happens if two threads execute that line in quick succession? Does perhaps one of the timers not fire? How would that differ if your <code>_timer</code> variable contained a list / set of timers?"}, {"owner": {"reputation": 3811, "user_id": 574130, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f5ef61cd993e3fe28bb681b0ebf340c0?s=128&d=identicon&r=PG", "display_name": "Ben Cameron", "link": "https://stackoverflow.com/users/574130/ben-cameron"}, "reply_to_user": {"reputation": 1238, "user_id": 3401554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1403940254/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/3401554/ben"}, "edited": false, "score": 0, "creation_date": 1548279995, "post_id": 54335905, "comment_id": 95489623, "body": "@Ben - I have edited the Program. Is this what you mean?"}, {"owner": {"reputation": 1238, "user_id": 3401554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1403940254/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/3401554/ben"}, "edited": false, "score": 0, "creation_date": 1548279995, "post_id": 54335905, "comment_id": 95489624, "body": "Oh, the Cancel method calls schedule? So you&#39;re scheduling a cancellation? Or is what you&#39;ve done so far wrong? Either way, the fact you&#39;re operating on separate Order means you won&#39;t have any clashes."}, {"owner": {"reputation": 3811, "user_id": 574130, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f5ef61cd993e3fe28bb681b0ebf340c0?s=128&d=identicon&r=PG", "display_name": "Ben Cameron", "link": "https://stackoverflow.com/users/574130/ben-cameron"}, "edited": false, "score": 0, "creation_date": 1548280090, "post_id": 54335905, "comment_id": 95489656, "body": "The cancel sets up the sheduler to do the cancel."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "reply_to_user": {"reputation": 1238, "user_id": 3401554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1403940254/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/3401554/ben"}, "edited": false, "score": 0, "creation_date": 1548280120, "post_id": 54335905, "comment_id": 95489665, "body": "@Ben The fact there is only a single <code>Timer</code> variable suggests there may be an ability for a later <code>Schedule</code> call to effectively disable an earlier <code>Schedule</code> call."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 1, "creation_date": 1548280194, "post_id": 54335905, "comment_id": 95489696, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5904636/best-way-to-create-a-run-once-time-delayed-function-in-c-sharp\">Best way to create a &quot;run-once&quot; time delayed function in C#</a>"}, {"owner": {"reputation": 1238, "user_id": 3401554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1403940254/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/3401554/ben"}, "edited": false, "score": 0, "creation_date": 1548280228, "post_id": 54335905, "comment_id": 95489707, "body": "@BenCameron Yes, now you&#39;re dealing with the same object. Now you need to be able to handle that order being scheduled to be canceled twice at exactly the same time."}, {"owner": {"reputation": 3811, "user_id": 574130, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f5ef61cd993e3fe28bb681b0ebf340c0?s=128&d=identicon&r=PG", "display_name": "Ben Cameron", "link": "https://stackoverflow.com/users/574130/ben-cameron"}, "reply_to_user": {"reputation": 1238, "user_id": 3401554, "user_type": "registered", "profile_image": "https://graph.facebook.com/1403940254/picture?type=large", "display_name": "Ben", "link": "https://stackoverflow.com/users/3401554/ben"}, "edited": false, "score": 0, "creation_date": 1548280295, "post_id": 54335905, "comment_id": 95489735, "body": "@Ben - sorry I don&#39;t understand what you mean?"}, {"owner": {"reputation": 2312, "user_id": 6330636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KwL7RaFztwM/AAAAAAAAAAI/AAAAAAAAADg/34eEeb890LE/photo.jpg?sz=128", "display_name": "Filip Cordas", "link": "https://stackoverflow.com/users/6330636/filip-cordas"}, "edited": false, "score": 0, "creation_date": 1548280682, "post_id": 54335905, "comment_id": 95489900, "body": "Did they put something else that you didn&#39;t mention thread safe how? Nothing in this whole code will produce a bug if you run it in multiple threads and the _timer is useless. Was there something else in the question that you forgot to mention?"}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "reply_to_user": {"reputation": 2312, "user_id": 6330636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KwL7RaFztwM/AAAAAAAAAAI/AAAAAAAAADg/34eEeb890LE/photo.jpg?sz=128", "display_name": "Filip Cordas", "link": "https://stackoverflow.com/users/6330636/filip-cordas"}, "edited": false, "score": 0, "creation_date": 1548280971, "post_id": 54335905, "comment_id": 95490019, "body": "@FilipCordas What do you mean by the timer being useless?"}, {"owner": {"reputation": 3811, "user_id": 574130, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f5ef61cd993e3fe28bb681b0ebf340c0?s=128&d=identicon&r=PG", "display_name": "Ben Cameron", "link": "https://stackoverflow.com/users/574130/ben-cameron"}, "edited": false, "score": 0, "creation_date": 1548281006, "post_id": 54335905, "comment_id": 95490046, "body": "The only parts I was actually given were the order and answer stub. I&#39;ve written the scheduler as part of soling it at home."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1548282079, "post_id": 54335905, "comment_id": 95490415, "body": "Remember, &quot;it runs and passes my tests&quot; is not strong evidence for the proposition &quot;my code is thread safe under all possible legal combinations of processor, jitter and compiler behaviours&quot;. To know that a piece of multithreaded code is safe requires a <i>logical proof</i> that the memory model of the language <i>enforces</i> that the code meets its postconditions."}, {"owner": {"reputation": 3811, "user_id": 574130, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f5ef61cd993e3fe28bb681b0ebf340c0?s=128&d=identicon&r=PG", "display_name": "Ben Cameron", "link": "https://stackoverflow.com/users/574130/ben-cameron"}, "edited": false, "score": 0, "creation_date": 1548282309, "post_id": 54335905, "comment_id": 95490501, "body": "So I&#39;m trying to take what they gave me, make it thread unsafe so then I can make it thread safe."}, {"owner": {"reputation": 2312, "user_id": 6330636, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KwL7RaFztwM/AAAAAAAAAAI/AAAAAAAAADg/34eEeb890LE/photo.jpg?sz=128", "display_name": "Filip Cordas", "link": "https://stackoverflow.com/users/6330636/filip-cordas"}, "edited": false, "score": 1, "creation_date": 1548283016, "post_id": 54335905, "comment_id": 95490739, "body": "&quot; I&#39;ve written the scheduler as part of soling it at home&quot; Well that makes things make more sense. Do you have the actual text of the assignment. Because I think you missed some things in the question."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1548283618, "post_id": 54335905, "comment_id": 95490913, "body": "One of the problems with this question is that it is completely unclear what operations are permitted. For example, the order class has public, non-volatile, writable fields and one of them is larger than int. So, are we worried about torn reads and writes to that field?  Nothing prevents them.  All of this code is a mass of bad practices that could lead to threading problems; it&#39;s hard to know how to make it right because we don&#39;t know what the person asking the question considers to be a possible misuse."}], "owner": {"reputation": 3811, "user_id": 574130, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/f5ef61cd993e3fe28bb681b0ebf340c0?s=128&d=identicon&r=PG", "display_name": "Ben Cameron", "link": "https://stackoverflow.com/users/574130/ben-cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1548281358, "creation_date": 1548278792, "last_edit_date": 1548281358, "question_id": 54335905, "link": "https://stackoverflow.com/questions/54335905/understanding-c-threading-interview-question", "title": "Understanding C# threading interview question", "body": "<p>I was recently asked a thread safety question in a c# interview. I didn't get it quite right.\nI'm am trying to understand it now.\nHere's the question...</p>\n\n<p>Given a basic Order class...</p>\n\n<pre><code>using System;\n\nnamespace OrderThreadTest\n{\n    public class Order\n    {\n        public TimeSpan CancelTime;\n        public int Id;\n    }\n}\n</code></pre>\n\n<p>Given a simple schedule class stub however I have implemented it to test at home...</p>\n\n<pre><code>using System;\nusing System.Threading;\n\nnamespace OrderThreadTest\n{\n    public class Scheduler : IDisposable\n    {\n        private Timer _timer;\n\n        public IDisposable Schedule(Order order, Action action)\n        {\n            var current = DateTime.Now;\n            var timeToGo = order.CancelTime - current.TimeOfDay;\n\n            _timer = new Timer(x =&gt; { action(); }, null, timeToGo, Timeout.InfiniteTimeSpan);\n\n            return this;\n        }\n\n        public void Dispose()\n        {\n        }\n    }\n}\n</code></pre>\n\n<p>How do you ensure that the Cancel method in the worker class is thread safe?\nMy answer is the commented out pieces</p>\n\n<pre><code>using System;\n\nnamespace OrderThreadTest\n{\n    public class Answer\n    {\n        private readonly Scheduler _scheduler;\n        private object _myLock = new object();\n        private Order _order;\n\n        public Answer(Scheduler scheduler)\n        {\n            _scheduler = scheduler;\n        }\n\n        public void Cancel(Order order)\n        {\n            //  lock (_myLock)\n            //  {\n            // _order = order;\n            //  var result =\n            _scheduler.Schedule(order, () =&gt;\n            {\n                //if (order.Equals(_order))\n                //{\n                Console.WriteLine(\"Canceled: \" + order.Id);\n                order = null;\n                //}\n            });\n            //  }\n        }\n    }\n}\n</code></pre>\n\n<p>My first question in understanding this is how can I cause an example of a second thread setting the passed in Order and changing a earlier timer?\nFor example cause a thread data clash.</p>\n\n<p>I have tried like this but it always seems to run as expected...</p>\n\n<pre><code>using System;\n\nnamespace OrderThreadTest\n{\n    internal class Program\n    {\n        private static void Main(string[] args)\n        {\n            var a1 = new Answer(new Scheduler());\n\n            var o = new Order\n                {Id = 1, CancelTime = new TimeSpan(DateTime.Now.Hour, DateTime.Now.Minute, DateTime.Now.Second + 5)};\n\n            a1.Cancel(o);\n\n            a1.Cancel(o);\n\n            Console.ReadLine();\n        }\n    }\n}\n</code></pre>\n\n<p>How do I repro the problem that I am meant to solve here?</p>\n"}, {"tags": ["c#", "wpf", "unity3d"], "comments": [{"owner": {"reputation": 1235, "user_id": 2904349, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mHGIp.jpg?s=128&g=1", "display_name": "jbltx", "link": "https://stackoverflow.com/users/2904349/jbltx"}, "edited": false, "score": 1, "creation_date": 1588182450, "post_id": 54335893, "comment_id": 108804711, "body": "I was wondering if have any issues with the focus of the Unity window ? I have basically the same code as you (using WindowsFormsHost) but if I click on other controls in my WPF application, Unity will loose focus and i am unable to retrieve it by clicking on the Unity host (mouse is fine, but not keyboard)."}, {"owner": {"reputation": 77, "user_id": 2686455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6c23a4548a732f53ab473ecdebac03?s=128&d=identicon&r=PG&f=1", "display_name": "user2686455", "link": "https://stackoverflow.com/users/2686455/user2686455"}, "reply_to_user": {"reputation": 1235, "user_id": 2904349, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mHGIp.jpg?s=128&g=1", "display_name": "jbltx", "link": "https://stackoverflow.com/users/2904349/jbltx"}, "edited": false, "score": 0, "creation_date": 1588678890, "post_id": 54335893, "comment_id": 108984801, "body": "@mickaelb91 Sorry for the late reply; I think I eventually fixed that issue by doing something like <code>MainWPFWindow.Activated += (o, e) =&gt; { ActivateUnityWindow(); };</code> (where <code>MainWPFWindow</code> is your WPF window or wherever your Unity window is embedded. It may also be neccessary to call <code>ActivateUnityWindow()</code> with a small delay after the window (re)activation event, maybe ~100 ms."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 2686455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6c23a4548a732f53ab473ecdebac03?s=128&d=identicon&r=PG&f=1", "display_name": "user2686455", "link": "https://stackoverflow.com/users/2686455/user2686455"}, "edited": false, "score": 0, "creation_date": 1548371147, "post_id": 54336428, "comment_id": 95528320, "body": "The <code>WindowsFormsHost</code> approach did the trick, even if it does unfortunately require adding the WinForms reference. (The <code>HwndHost</code> method didn&#39;t seem worth the extra effort, at least based on the MS examples.) Thanks!"}], "tags": [], "owner": {"reputation": 1768, "user_id": 6611411, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vzcah-HHpDs/AAAAAAAAAAI/AAAAAAAAAE8/6CTd8nTt8VM/photo.jpg?sz=128", "display_name": "Leo Bartkus", "link": "https://stackoverflow.com/users/6611411/leo-bartkus"}, "is_accepted": true, "score": 2, "last_activity_date": 1548281223, "creation_date": 1548281223, "answer_id": 54336428, "question_id": 54335893, "link": "https://stackoverflow.com/questions/54335893/embed-unity3d-app-inside-wpf-without-having-it-take-up-the-whole-window/54336428#54336428", "title": "Embed Unity3D app inside WPF *without* having it take up the whole window", "body": "<p>Use a <code>WindowsFormsHost</code> or <code>HwndHost</code> control in your WPF.   The hwnd is in the host control's <code>Handle</code> property.   So you can change this line to put Unity in just the host control.</p>\n\n<pre><code>process.StartInfo.Arguments = \"-parentHWND \" + hwndHost.Handle.ToInt32() + \" \" + Environment.CommandLine;\n</code></pre>\n\n<p>And remove the code that gets the hwnd for the floating frame</p>\n\n<pre><code>HwndSource source = (HwndSource)HwndSource.FromVisual(p);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 2576644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xf9p1.png?s=128&g=1", "display_name": "JoachimAlly", "link": "https://stackoverflow.com/users/2576644/joachimally"}, "is_accepted": false, "score": 1, "last_activity_date": 1612273667, "last_edit_date": 1612273667, "creation_date": 1612192665, "answer_id": 65995250, "question_id": 54335893, "link": "https://stackoverflow.com/questions/54335893/embed-unity3d-app-inside-wpf-without-having-it-take-up-the-whole-window/65995250#65995250", "title": "Embed Unity3D app inside WPF *without* having it take up the whole window", "body": "<p>The problem with the above solution is that <strong>getting focus on the Unity-exe</strong> seems to be not possible. So yes, I was able to load the exe on a certain cell of a certain user control of a certain WPF application, but could not click on anything in the Unity-frame.</p>\n<p>I spent the whole day searching for a solution and can now come with a solution, that is in my opinion cleaner and also solves the problem with the focus.</p>\n<p>I describe what you can do in steps:</p>\n<ol>\n<li><a href=\"https://docs.unity3d.com/Manual/CommandLineArguments.html\" rel=\"nofollow noreferrer\">Documentation of Unity</a> : In here, it is explained how you can embed a Unity-exe in a Winforms control. There is even a .zip-file &quot;EmbeddedWindow.zip&quot; where you can download example code. Copy the essential files out of the Container <a href=\"https://i.stack.imgur.com/XGbHX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XGbHX.png\" alt=\"enter image description here\" /></a> .</li>\n</ol>\n<p>Form1.cs contains exactly the code as in <a href=\"https://stackoverflow.com/a/44059700\">this question</a>.</p>\n<pre><code>public partial class Form1: Form\n    {\n        [DllImport(&quot;User32.dll&quot;)]\n        private static extern bool MoveWindow(IntPtr handle, int x, int y, int width, int height, bool redraw);\n\n        internal delegate int WindowEnumProc(IntPtr hwnd, IntPtr lparam);\n\n        [DllImport(&quot;user32.dll&quot;)]\n        internal static extern bool EnumChildWindows(IntPtr hwnd, WindowEnumProc func, IntPtr lParam);\n\n        [DllImport(&quot;user32.dll&quot;)]\n        private static extern int SendMessage(IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam);\n\n        private Process process;\n        private IntPtr unityHWND = IntPtr.Zero;\n\n        private const int WM_ACTIVATE = 0x0006;\n        private readonly IntPtr WA_ACTIVE = new IntPtr(1);\n        private readonly IntPtr WA_INACTIVE = new IntPtr(0);\n\n        public Form1()\n        {\n            InitializeComponent();\n\n            TopLevel = false;\n\n            try\n            {\n                process = new Process();\n                process.StartInfo.FileName = &quot;[INSERT_FILE_NAME_OF_YOUR_EXE].exe&quot;;\n                process.StartInfo.Arguments = &quot;-parentHWND &quot; + panel1.Handle.ToInt32() + &quot; &quot; + Environment.CommandLine;\n                process.StartInfo.UseShellExecute = true;\n                process.StartInfo.CreateNoWindow = true;\n\n                process.Start();\n\n                process.WaitForInputIdle();\n                // Doesn't work for some reason ?!\n                //unityHWND = process.MainWindowHandle;\n                EnumChildWindows(panel1.Handle, WindowEnum, IntPtr.Zero);\n\n                unityHWNDLabel.Text = &quot;Unity HWND: 0x&quot; + unityHWND.ToString(&quot;X8&quot;);\n            }\n            catch (Exception ex)\n            {\n                MessageBox.Show(ex.Message + &quot;.\\nCheck if Container.exe is placed next to Child.exe.&quot;);\n            }\n        }\n\n        private void ActivateUnityWindow()\n        {\n            SendMessage(unityHWND, WM_ACTIVATE, WA_ACTIVE, IntPtr.Zero);\n        }\n\n        private void DeactivateUnityWindow()\n        {\n            SendMessage(unityHWND, WM_ACTIVATE, WA_INACTIVE, IntPtr.Zero);\n        }\n\n        private int WindowEnum(IntPtr hwnd, IntPtr lparam)\n        {\n            unityHWND = hwnd;\n            ActivateUnityWindow();\n            return 0;\n        }\n\n        private void panel1_Resize(object sender, EventArgs e)\n        {\n            MoveWindow(unityHWND, 0, 0, panel1.Width, panel1.Height, true);\n            ActivateUnityWindow();\n        }\n\n        // Close Unity application\n        private void Form1_FormClosed(object sender, FormClosedEventArgs e)\n        {\n            try\n            {\n                process.CloseMainWindow();\n\n                Thread.Sleep(1000);\n                while (process.HasExited == false)\n                    process.Kill();\n            }\n            catch (Exception)\n            {\n            }\n        }\n\n        private void Form1_Activated(object sender, EventArgs e)\n        {\n            ActivateUnityWindow();\n        }\n\n        private void Form1_Deactivate(object sender, EventArgs e)\n        {\n            DeactivateUnityWindow();\n        }\n    }\n</code></pre>\n<ol start=\"2\">\n<li>Do not forget to have a look in &quot;Form1.cs&quot;, it is possible that the exe you want to update is not &quot;Child.exe&quot;, so if it is another one, just edit the string in the code. <code>process.StartInfo.FileName = &quot;[INSERT_FILE_NAME_OF_YOUR_EXE].exe&quot;;</code> Also check &quot;SelectablePanel.cs&quot;, where the setting of Selectable to true is essential. This SelectablePanel is used in the <code>Form1.Designer.cs</code> .</li>\n</ol>\n<blockquote>\n<p><strong>The left panel1 of the SplitContainer is a SelectablePanel</strong> instead of a Panel !</p>\n</blockquote>\n<pre><code>    class SelectablePanel : Panel\n    {\n        public SelectablePanel()\n        {\n            this.SetStyle(ControlStyles.Selectable, true);\n            this.TabStop = true;\n        }\n    }\n</code></pre>\n<p>Please also note that in the constructor of the Winforms-control, I needed to set <code>Toplevel = false;</code> . This was not mentioned in the example of Unity but is needed to avoid an exception when you embed it in your WPF application.</p>\n<ol start=\"3\">\n<li>Go to your WPF Application and make a User Control that will contain your Winforms-Control. Make a control similar to what is done in <a href=\"https://github.com/Microsoft/WPF-Samples/tree/master/Migration%20and%20Interoperability/HostingWfInWPF\" rel=\"nofollow noreferrer\">this link</a> . In this example, you have a Grid named <code>Grid_To_Embed_Winforms_Control_In</code> and a small piece of code-behind, like the underlying code.</li>\n</ol>\n<pre><code>public partial class WPF_User_Control: UserControl \n\n{ \n    public bool Already_Loaded = false;\n\n    public WPF_User_Control()\n    {\n        InitializeComponent();\n    }\n\n    private void On_Load(object sender, RoutedEventArgs e)\n    {\n        if (!Already_Loaded)\n        {\n            // Create the interop host control.\n            var host =\n                new WindowsFormsHost();\n\n            // Embed the Winforms Control\n            host.Child = new Embed_Unity_Exe_Winforms_Control();\n\n            // Add the interop host control to the Grid\n            // control's collection of child controls.\n            Grid_To_Embed_Winforms_Control_In.Children.Add(host);\n            Already_Loaded = true;\n        }\n    }\n}  \n\n</code></pre>\n<ol start=\"4\">\n<li>Do not forget to add <code>using System.Windows.Forms.Integration;</code> on top. Please note that I added the <code>boolean Already Loaded</code> to make sure that when the viewport changes (you want to view another page of your WPF application) the process is not started again. In my complete solution, I make use of Microsoft Dependency Injection and this control is in a viewmodel which is added as a singleton. In this way, I only start the process once.</li>\n</ol>\n<p>So this is it, this worked for me.</p>\n<p>What is better than other solutions I saw while googling:</p>\n<ul>\n<li>The resizing is working better and done &quot;automatically&quot;, I did not need to invoke a resize-method myself (except for the one in Form1.cs) .</li>\n<li>I can also have control and focus over the Unity.</li>\n</ul>\n<p>PS: If you want to make it look nicer and more &quot;embedded&quot;, you can do the following things with the Winform-control:</p>\n<ul>\n<li>Select splitcontainer1 and go to Properties</li>\n<li>Set BorderStyle to 'None'</li>\n<li>Set Panel2Collapsed to 'True'</li>\n</ul>\n"}], "owner": {"reputation": 77, "user_id": 2686455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6c23a4548a732f53ab473ecdebac03?s=128&d=identicon&r=PG&f=1", "display_name": "user2686455", "link": "https://stackoverflow.com/users/2686455/user2686455"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2054, "favorite_count": 1, "accepted_answer_id": 54336428, "answer_count": 2, "score": 1, "last_activity_date": 1612273667, "creation_date": 1548278752, "last_edit_date": 1548279364, "question_id": 54335893, "link": "https://stackoverflow.com/questions/54335893/embed-unity3d-app-inside-wpf-without-having-it-take-up-the-whole-window", "title": "Embed Unity3D app inside WPF *without* having it take up the whole window", "body": "<p>I am trying to adapt the code posted in this question:\n<a href=\"https://stackoverflow.com/a/44059700\">https://stackoverflow.com/a/44059700</a></p>\n\n<p>to allow me to embed a Unity3D app inside a WPF app.</p>\n\n<p>This is my slightly edited version:</p>\n\n<pre><code>namespace WPFWithUnity\n{\npublic partial class Page1 : Page\n{\n    [DllImport(\"User32.dll\")]\n    static extern bool MoveWindow(IntPtr handle, int x, int y, int width, int height, bool redraw);\n\n    internal delegate int WindowEnumProc(IntPtr hwnd, IntPtr lparam);\n    [DllImport(\"user32.dll\")]\n    internal static extern bool EnumChildWindows(IntPtr hwnd, WindowEnumProc func, IntPtr lParam);\n\n    [DllImport(\"user32.dll\")]\n    static extern int SendMessage(IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam);\n\n    private Process process;\n    private IntPtr unityHWND = IntPtr.Zero;\n\n    private const int WM_ACTIVATE = 0x0006;\n    private readonly IntPtr WA_ACTIVE = new IntPtr(1);\n    private readonly IntPtr WA_INACTIVE = new IntPtr(0);\n\n    Frame p = MainWindow.Instance.floatingFrame;\n\n    bool initialized = false;\n\n    public Page1()\n    {\n        InitializeComponent();\n\n        MainWindow.Instance.MainWindowClosing += Application_Exit;\n\n        System.Windows.Threading.DispatcherTimer dispatcherTimer = new System.Windows.Threading.DispatcherTimer();\n        dispatcherTimer.Tick += attemptInit;\n        dispatcherTimer.Interval = new TimeSpan(0, 0, 1);\n        dispatcherTimer.Start();\n\n    }\n\n    void attemptInit(object sender, EventArgs e) {\n\n        if (initialized)\n            return;\n\n        HwndSource source = (HwndSource)HwndSource.FromVisual(p);\n\n        Console.WriteLine(\"attempting to get handle...\");\n\n        if (source == null) {\n            Console.WriteLine(\"Failed to get handle source\");\n            return;\n        }\n\n        IntPtr hWnd = source.Handle;\n\n        try\n        {\n            process = new Process();\n            process.StartInfo.FileName = \"Child.exe\";\n            process.StartInfo.Arguments = \"-parentHWND \" + hWnd.ToInt32() + \" \" + Environment.CommandLine;\n            process.StartInfo.UseShellExecute = true;\n            process.StartInfo.CreateNoWindow = true;\n\n            process.Start();\n\n            process.WaitForInputIdle();\n            // Doesn't work for some reason ?!\n            //unityHWND = process.MainWindowHandle;\n            EnumChildWindows(hWnd, WindowEnum, IntPtr.Zero);\n\n            //unityHWNDLabel.Text = \"Unity HWND: 0x\" + unityHWND.ToString(\"X8\");\n            Console.WriteLine(\"Unity HWND: 0x\" + unityHWND.ToString(\"X8\"));\n\n            panel1_Resize(this, EventArgs.Empty);\n\n            initialized = true;\n        }\n        catch (Exception ex)\n        {\n            MessageBox.Show(ex.Message + \".\\nCheck if Container.exe is placed next to UnityGame.exe.\");\n        }\n    }\n\n    private void ActivateUnityWindow()\n    {\n        SendMessage(unityHWND, WM_ACTIVATE, WA_ACTIVE, IntPtr.Zero);\n    }\n\n    private void DeactivateUnityWindow()\n    {\n        SendMessage(unityHWND, WM_ACTIVATE, WA_INACTIVE, IntPtr.Zero);\n    }\n\n    private int WindowEnum(IntPtr hwnd, IntPtr lparam)\n    {\n        unityHWND = hwnd;\n        ActivateUnityWindow();\n        return 0;\n    }\n\n    private void panel1_Resize(object sender, EventArgs e)\n    {\n        MoveWindow(unityHWND, 0, 0, (int)p.Width, (int)p.Height, true);\n        Console.WriteLine(\"RESIZED UNITY WINDOW TO: \" + (int)p.Width + \"x\" + (int)p.Height);\n        ActivateUnityWindow();\n    }\n\n    // Close Unity application\n    private void Application_Exit(object sender, EventArgs e)\n    {\n        try\n        {\n            process.CloseMainWindow();\n\n            Thread.Sleep(1000);\n            while (!process.HasExited)\n                process.Kill();\n        }\n        catch (Exception)\n        {\n\n        }\n    }\n\n    private void Form1_Activated(object sender, EventArgs e)\n    {\n        ActivateUnityWindow();\n    }\n\n    private void Form1_Deactivate(object sender, EventArgs e)\n    {\n        DeactivateUnityWindow();\n    }\n}\n}\n</code></pre>\n\n<p>And here is the relevant part of the XAML:</p>\n\n<pre><code>&lt;Frame Name=\"floatingFrame\" Grid.Row=\"15\" Grid.RowSpan=\"5\" Grid.Column=\"0\" Grid.ColumnSpan=\"2\" Width=\"640\" Height=\"480\" Margin=\"100,0,0,0\" Panel.ZIndex=\"100\" Source=\"Page1.xaml\"/&gt;\n</code></pre>\n\n<p>Really, the only difference is that I'm trying to use a WPF Page inside a Frame instead of a WinForms panel (trying to avoid WinForms). The embedded Unity app starts up fine...except that it takes up the whole window (i.e. you can't see any of the WPF controls anymore).</p>\n\n<p><strong>So, the question:</strong>\nHow do I get the Unity app to only stay inside the WPF page (which is inside a Frame)?</p>\n\n<p><a href=\"https://i.stack.imgur.com/1w8u8.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>(The Y of this XY problem would be that I'm just trying to create a 3D graphics display of something inside a WPF app.)</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["c#", "image", ".net-core"], "answers": [{"comments": [{"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "edited": false, "score": 1, "creation_date": 1548278903, "post_id": 54335841, "comment_id": 95489129, "body": "It seem rather random that <i>System.Drawing.Printing</i> is there by default but <i>System.Drawing.Image</i> needs to be nugotten (newgot? gotten by nuget? nugetgot?)... Also a clearer documentation of that would be of help."}, {"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "edited": false, "score": 0, "creation_date": 1548278949, "post_id": 54335841, "comment_id": 95489154, "body": "Also, a quick validation of my assumption - that&#39;s the right class to manage images, right? I can store that junk using EF directly to the DB. Correct?"}, {"owner": {"reputation": 938, "user_id": 4380513, "user_type": "registered", "profile_image": "https://graph.facebook.com/553865196/picture?type=large", "display_name": "Zakk Diaz", "link": "https://stackoverflow.com/users/4380513/zakk-diaz"}, "edited": false, "score": 1, "creation_date": 1548279100, "post_id": 54335841, "comment_id": 95489229, "body": "It&#39;s not that weird. System.Drawing.Common, like the description says, gives access to GDI+ graphics. This had to be rewritten from classic .net to .net core, and is not part of the .net core build but rather an extension since .net core is meant to be minimum necessary components. I can&#39;t speak for the .Printing namespace but this is absolutely correct."}, {"owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "reply_to_user": {"reputation": 90360, "user_id": 61164, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/782a1ccf1b45f8dbb5116f950d61f661?s=128&d=identicon&r=PG", "display_name": "Erik Funkenbusch", "link": "https://stackoverflow.com/users/61164/erik-funkenbusch"}, "edited": false, "score": 0, "creation_date": 1548280269, "post_id": 54335841, "comment_id": 95489722, "body": "@ErikFunkenbusch That was very well-worded. May I suggest that you copy in your comment as a paragraph of the accepted answer? It would make it even more great. And then we can remove the comments."}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 0, "creation_date": 1548280610, "post_id": 54335841, "comment_id": 95489863, "body": "A link to the original Microsoft announcement will make it clear <a href=\"https://blogs.msdn.microsoft.com/dotnet/2017/11/16/announcing-the-windows-compatibility-pack-for-net-core/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/dotnet/2017/11/16/&hellip;</a>"}], "tags": [], "owner": {"reputation": 34657, "user_id": 732221, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/C5p6I.jpg?s=128&g=1", "display_name": "Martin Zikmund", "link": "https://stackoverflow.com/users/732221/martin-zikmund"}, "is_accepted": true, "score": 32, "last_activity_date": 1548316949, "last_edit_date": 1548316949, "creation_date": 1548278512, "answer_id": 54335841, "question_id": 54335778, "link": "https://stackoverflow.com/questions/54335778/cant-find-image-class-in-system-drawing-under-net-core-2-2/54335841#54335841", "title": "Can&#39;t find Image class in System.Drawing under .NET Core 2.2", "body": "<p>Try installing the <code>System.Drawing.Common</code> NuGet package. This contains <code>Image</code> and other related types like <code>Bitmap</code>.</p>\n\n<pre><code>PM&gt; Install-Package System.Drawing.Common\n</code></pre>\n\n<p>You can also install using the NuGet Package Manager UI accessible by right-clicking the solution in <strong>Solution Explorer</strong> and choosing <strong>Manage NuGet Packages...</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/rqKxi.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/rqKxi.png\" alt=\"System.Drawing.Common\"></a></p>\n\n<p>Adding a clarification comment from <a href=\"https://stackoverflow.com/users/1525840/konrad-viltersten\"><strong>@KonradViltersten</strong></a>:</p>\n\n<blockquote>\n  <p>Traditionally, <code>System.Drawing</code> was included in the full .NET Framework,\n  but not .NET Core because <code>System.Drawing</code> was based on Windows drawing\n  methods. .NET core was designed to be platform independent and thus\n  did not include anything that was platform specific (like drawing).\n  Because this functionality is so requested, MS released a separate assembly that could be installed to provide the functionality</p>\n</blockquote>\n"}], "owner": {"reputation": 27684, "user_id": 1525840, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e1d7083d88bd7d8eedea825a941dae57?s=128&d=identicon&r=PG", "display_name": "Konrad Viltersten", "link": "https://stackoverflow.com/users/1525840/konrad-viltersten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10548, "favorite_count": 2, "accepted_answer_id": 54335841, "answer_count": 1, "score": 9, "last_activity_date": 1548338868, "creation_date": 1548278221, "last_edit_date": 1548279713, "question_id": 54335778, "link": "https://stackoverflow.com/questions/54335778/cant-find-image-class-in-system-drawing-under-net-core-2-2", "title": "Can&#39;t find Image class in System.Drawing under .NET Core 2.2", "body": "<p>According to <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.drawing.image?view=netcore-2.2\" rel=\"noreferrer\">the docs</a>, there's supposed to be a class for thumbnail handling in the namespace <code>System.Drawing</code>. I want to create a model that has an image as a property and then save it to a database. However, when I try the code below, I get an error that the class isn't found in that namespace, regardless of the docs stating otherwise.</p>\n\n<pre><code>using System.Drawing;\npublic class Donkey\n{\n  public Image Image { get;set; }\n}\n</code></pre>\n\n<p>What am I missing?!</p>\n\n<p>I've googled it but only found <a href=\"https://stackoverflow.com/questions/40892189/net-core-and-system-drawing\">old posts</a> and <a href=\"https://code.msdn.microsoft.com/How-to-save-Image-to-978a7b0b\" rel=\"noreferrer\">examples that seem not to work</a>.</p>\n"}, {"tags": ["javascript", "c#", "asp.net", "ajax", "entity-framework"], "comments": [{"owner": {"reputation": 2010, "user_id": 3034193, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/iUvK1.png?s=128&g=1", "display_name": "DaniDev", "link": "https://stackoverflow.com/users/3034193/danidev"}, "edited": false, "score": 0, "creation_date": 1548279671, "post_id": 54335745, "comment_id": 95489482, "body": "1. &quot;i can see before the save changes is made that the values have indeed changed&quot; where are you seing this? 2. In your changeDepartmentActionResult(string id) method it does not appear that you  have applied any new values to be saved?"}, {"owner": {"reputation": 999, "user_id": 5185389, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8c63dbf6d7df7773c3757322d70486b7?s=128&d=identicon&r=PG&f=1", "display_name": "DevilSuichiro", "link": "https://stackoverflow.com/users/5185389/devilsuichiro"}, "edited": false, "score": 0, "creation_date": 1548317237, "post_id": 54335745, "comment_id": 95499775, "body": "Why do you disable AutoDetectChanges twice and never enable it again? What happens in an exception case? Also, what happens to the context instance?"}], "answers": [{"tags": [], "owner": {"reputation": 1969, "user_id": 6208915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66d12a46b70b55620f35c08c7db5d696?s=128&d=identicon&r=PG&f=1", "display_name": "Gabor", "link": "https://stackoverflow.com/users/6208915/gabor"}, "is_accepted": true, "score": 0, "last_activity_date": 1548297080, "creation_date": 1548297080, "answer_id": 54338561, "question_id": 54335745, "link": "https://stackoverflow.com/questions/54335745/save-changes-function-not-properly-updating-the-database/54338561#54338561", "title": "Save changes function not properly updating the database", "body": "<p>It seems that you are modifying an entity while auto detecting changes are disabled.</p>\n\n<p>If it is intentional then you should inform the context that the entity has been changed.</p>\n\n<p>I assume that <code>MOADEntities</code> is derived from <code>DbContext</code>. So instead of this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>if (request.GovernmentEnrollment == true)\n{\n    request.GovernmentEnrollment = false;\n    request.ManagedCare = true;\n    moadEntities.SaveChanges();\n}\nelse\n{\n    request.ManagedCare = false;\n    request.GovernmentEnrollment = true;\n    moadEntities.SaveChanges();\n}\n</code></pre>\n\n<p>I would try this:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>// Simplify the if..else block\nrequest.ManagedCare = request.GovernmentEnrollment;\nrequest.GovernmentEnrollment = !request.GovernmentEnrollment;\n\n// Notifying the context that the 'request' entity has been modified.\n// EntityState enum is under System.Data.Entity namespace\nmoadEntities.Entry(request).State = EntityState.Modified;\n\n// Now we can save the changes.\nmoadEntities.SaveChanges();\n</code></pre>\n"}], "owner": {"reputation": 355, "user_id": 1333874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8eee4593af2f768d7e15a35fab14ad3?s=128&d=identicon&r=PG", "display_name": "Justin Le", "link": "https://stackoverflow.com/users/1333874/justin-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 54338561, "answer_count": 1, "score": 1, "last_activity_date": 1548300918, "creation_date": 1548278062, "last_edit_date": 1548300918, "question_id": 54335745, "link": "https://stackoverflow.com/questions/54335745/save-changes-function-not-properly-updating-the-database", "title": "Save changes function not properly updating the database", "body": "<p>So, I have a button that triggers a javascript function, that calls an AJAX request, that calls an actionresult that should update my database.</p>\n\n<p><strong>Javascript Call</strong></p>\n\n<pre class=\"lang-js prettyprint-override\"><code>function changeDepartment() {\n\n    // Initiate and value variables,\n    var id = $('#requestId').val();\n    var user = $('#contactUser').val();\n    // Bind variables to data object\n    var data = { id: id }\n    // Ajax call with data.\n    $.ajax({\n        url: '@Url.Action(\"changeDepartmentActionResult\", \"ManageRequestResearch\")',\n        type: \"POST\",\n        dataType: 'json',\n        data: data,\n        success: function (data, textStatus, XmlHttpRequest) {\n\n            var name = data.name;\n\n            window.location.href = '@Url.Action(\"Index\", \"ManageRequestResearch\")';\n            $('#btn-input').val('');\n        },\n        error: function (jqXHR, textStatus, errorThrown) {\n            alert(\"responseText: \" + jqXHR.responseText);\n        }\n    });\nalert(data);\n</code></pre>\n\n<p>And then, I have the action result:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>[HttpPost]\npublic ActionResult changeDepartmentActionResult(string id)\n{\n    var moadEntities = new MOADEntities();\n    moadEntities.Configuration.AutoDetectChangesEnabled = false;\n    var researchBusiness = new ResearchRequestBusiness(moadEntities);\n    var request = researchBusiness.FetchRequestById(Convert.ToInt32(id));\n\n    var directoryObject = GetActiveDirectoryObject(request.Requestor);\n    var requstorDisplayName = directoryObject != null ? directoryObject.DisplayName : request.RequestorFullName;\n    var researchRequestFileBusiness = new ResearchRequestFilesBusiness(moadEntities);\n    var requestFiles = researchRequestFileBusiness.FetchFilesByRequestId(Convert.ToInt32(id));\n\n    var viewModel = new ManageSelectedRequestResearchViewModel()\n    {\n        RequestDetails = request,\n        RequestActivity = request.tbl_ResearchRequestActivity.Select(d =&gt; d).ToList(),\n        Files = requestFiles\n    };\n\n    moadEntities.Configuration.AutoDetectChangesEnabled = false;\n\n\n    if (request.GovernmentEnrollment == true)\n    {\n        request.GovernmentEnrollment = false;\n        request.ManagedCare = true;\n        moadEntities.SaveChanges();\n    }\n    else\n    {\n        request.ManagedCare = false;\n        request.GovernmentEnrollment = true;\n        moadEntities.SaveChanges();\n    }\n\n    return Json(\"Status changed successfully\", JsonRequestBehavior.AllowGet);\n}\n</code></pre>\n\n<p>From what I have observed, it returns the right record, it makes the changes properly, and it hits the Context.SaveChanges();\nwhen debugging -- i can see before the save changes is made that the values have indeed changed, however--inside the database, no changes are saved.</p>\n\n<p>In addition, i have checked to see that the connection strings are valid.</p>\n\n<p>Any idea what may be causing this?\nThanks ahead of time!</p>\n"}, {"tags": ["c#", "json", "list", "dictionary", "deserialization"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 1628636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ja3Qy.jpg?s=128&g=1", "display_name": "Ta\u015fy&#252;rek G&#246;k\u015fah", "link": "https://stackoverflow.com/users/1628636/ta%c5%9fy%c3%bcrek-g%c3%b6k%c5%9fah"}, "edited": false, "score": 0, "creation_date": 1548320035, "post_id": 54336090, "comment_id": 95501117, "body": "I tried this also but; Cannot deserialize the current JSON object (e.g. {&quot;name&quot;:&quot;value&quot;}) into type &#39;System.Collections.Generic.List`1[System.String]&#39; because the type requires a JSON array (e.g. [1,2,3]) to deserialize correctly. To fix this error either change the JSON to a JSON array (e.g. [1,2,3]) or change the deserialized type so that it is a normal .NET type (e.g. not a primitive type like integer, not a collection type like an array or List) that can be deserialized from a JSON object. JsonObjectAttribute can also be added to the type to force it to deserialize from a JSON object."}, {"owner": {"reputation": 596, "user_id": 1998204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tREdm.jpg?s=128&g=1", "display_name": "hanoldaa", "link": "https://stackoverflow.com/users/1998204/hanoldaa"}, "reply_to_user": {"reputation": 159, "user_id": 1628636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ja3Qy.jpg?s=128&g=1", "display_name": "Ta\u015fy&#252;rek G&#246;k\u015fah", "link": "https://stackoverflow.com/users/1628636/ta%c5%9fy%c3%bcrek-g%c3%b6k%c5%9fah"}, "edited": false, "score": 1, "creation_date": 1548332485, "post_id": 54336090, "comment_id": 95508391, "body": "Hmm, your comment makes it sound like the error your getting is because you&#39;re still trying to deserialize to <code>List&lt;string&gt;</code> and not <code>Dictionary&lt;string, List&lt;string&gt;&gt;</code>. I have no problem deserializing a dictionary of lists. See my edit above for a more robust example."}, {"owner": {"reputation": 159, "user_id": 1628636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ja3Qy.jpg?s=128&g=1", "display_name": "Ta\u015fy&#252;rek G&#246;k\u015fah", "link": "https://stackoverflow.com/users/1628636/ta%c5%9fy%c3%bcrek-g%c3%b6k%c5%9fah"}, "edited": false, "score": 0, "creation_date": 1548334211, "post_id": 54336090, "comment_id": 95509394, "body": "Ahh. Thank you :)"}, {"owner": {"reputation": 596, "user_id": 1998204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tREdm.jpg?s=128&g=1", "display_name": "hanoldaa", "link": "https://stackoverflow.com/users/1998204/hanoldaa"}, "reply_to_user": {"reputation": 159, "user_id": 1628636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ja3Qy.jpg?s=128&g=1", "display_name": "Ta\u015fy&#252;rek G&#246;k\u015fah", "link": "https://stackoverflow.com/users/1628636/ta%c5%9fy%c3%bcrek-g%c3%b6k%c5%9fah"}, "edited": false, "score": 0, "creation_date": 1548336813, "post_id": 54336090, "comment_id": 95511105, "body": "If that answered the question, would you mind marking as answered?"}, {"owner": {"reputation": 159, "user_id": 1628636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ja3Qy.jpg?s=128&g=1", "display_name": "Ta\u015fy&#252;rek G&#246;k\u015fah", "link": "https://stackoverflow.com/users/1628636/ta%c5%9fy%c3%bcrek-g%c3%b6k%c5%9fah"}, "edited": false, "score": 0, "creation_date": 1548337238, "post_id": 54336090, "comment_id": 95511378, "body": "I&#39;m not familiar with stackoverflow. I was looking for it but couldnt found. Now i found where to mark. Thank you again."}], "tags": [], "owner": {"reputation": 596, "user_id": 1998204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tREdm.jpg?s=128&g=1", "display_name": "hanoldaa", "link": "https://stackoverflow.com/users/1998204/hanoldaa"}, "is_accepted": true, "score": 5, "last_activity_date": 1548332506, "last_edit_date": 1548332506, "creation_date": 1548279547, "answer_id": 54336090, "question_id": 54335744, "link": "https://stackoverflow.com/questions/54335744/cant-deserialize-dictionarystring-liststring-unexpected-character-encounte/54336090#54336090", "title": "Can&#39;t Deserialize Dictionary&lt;string, List&lt;string&gt;&gt; Unexpected character encountered while parsing value", "body": "<p>You're trying to deserialize the json for a <code>Dictionary&lt;string, List&lt;string&gt;&gt;</code> into a <code>string</code>. Try this instead:</p>\n\n<pre><code>var gg = JsonConvert.DeserializeObject&lt;Dictionary&lt;string, List&lt;string&gt;&gt;(ss);\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I tested the following and had no issues:</p>\n\n<pre><code>public void Test()\n{\n    test = new Dictionary&lt;string, List&lt;string&gt;&gt;();\n    test.Add(\"1\", new List&lt;string&gt;() { \"a\", \"b\", \"c\" });\n    test.Add(\"2\", new List&lt;string&gt;() { \"a\", \"b\", \"c\" });\n    test.Add(\"3\", new List&lt;string&gt;() { \"a\", \"b\", \"c\" });\n    test.Add(\"4\", new List&lt;string&gt;() { \"a\", \"b\", \"c\" });\n    test.Add(\"5\", new List&lt;string&gt;() { \"a\", \"b\", \"c\" });\n\n    string json = JsonConvert.SerializeObject(test, Formatting.Indented);\n    Dictionary&lt;string, List&lt;string&gt;&gt; deserialized = JsonConvert.DeserializeObject&lt;Dictionary&lt;string, List&lt;string&gt;&gt;&gt;(json);\n}\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 1628636, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ja3Qy.jpg?s=128&g=1", "display_name": "Ta\u015fy&#252;rek G&#246;k\u015fah", "link": "https://stackoverflow.com/users/1628636/ta%c5%9fy%c3%bcrek-g%c3%b6k%c5%9fah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 54336090, "answer_count": 1, "score": 0, "last_activity_date": 1548332506, "creation_date": 1548278058, "last_edit_date": 1548320199, "question_id": 54335744, "link": "https://stackoverflow.com/questions/54335744/cant-deserialize-dictionarystring-liststring-unexpected-character-encounte", "title": "Can&#39;t Deserialize Dictionary&lt;string, List&lt;string&gt;&gt; Unexpected character encountered while parsing value", "body": "<p>I've a dictionary. </p>\n\n<pre><code>Dictionary&lt;string, List&lt;string&gt;&gt;\n</code></pre>\n\n<p>I serialized this object by using this line;</p>\n\n<pre><code>var ss = JsonConvert.SerializeObject(objDic, Formatting.Indented);\n</code></pre>\n\n<p><strong>JSON is Valid!</strong></p>\n\n<pre><code>{\n  \"keywords a\": [\n    \"keywords analytics,\",\n    \"keywords abstract,\",\n    \"keywords amazon,\",\n    \"keywords anywhere,\",\n    \"keywords adwords,\",\n    \"keywords architecture,\",\n    \"keywords apa,\",\n    \"keywords app store,\",\n    \"keywords and seo,\",\n    \"keywords armor,\"\n  ],\n  \"keywords b\": [\n    \"keywords book,\",\n    \"keywords bidding,\",\n    \"keywords broad match,\",\n    \"keywords blog,\",\n    \"keywords business,\",\n    \"keywords book pdf,\",\n    \"keywords by country,\",\n    \"keywords by industry,\",\n    \"keywords bridge,\",\n    \"keywords bidding strategy,\"\n  ],\n  \"keywords c\": [\n    \"keywords creator,\",\n    \"reserved keywords c,\",\n    \"keywords c#,\",\n    \"keywords combo list,\",\n    \"keywords cv,\",\n    \"keywords checker,\",\n    \"keywords check,\",\n    \"keywords css,\",\n    \"keywords computer,\",\n    \"keywords consulting resume,\"\n  ],\n  \"keywords d\": [\n    \"keywords definition,\",\n    \"keywords density checker,\",\n    \"keywords definition in c,\",\n    \"keywords density,\",\n    \"keywords dublin,\",\n    \"keywords density formula,\",\n    \"keywords digital marketing,\",\n    \"keywords design,\",\n    \"keywords def,\",\n    \"keywords database,\"\n  ],\n  \"keywords e\": [\n    \"keywords everywhere,\",\n    \"keywords explorer,\",\n    \"keywords ekleme,\",\n    \"keywords everywhere chrome,\",\n    \"keywords essay,\",\n    \"english keywords,\"\n  ],\n  \"keywords f\": [\n    \"keywords finder,\",\n    \"keywords for amazon,\",\n    \"keywords for fluency intermediate pdf,\",\n    \"keywords for fluency pre intermediate pdf,\",\n    \"keywords for youtube,\",\n    \"keywords for slayer leecher,\",\n    \"keywords for seo,\",\n    \"keywords for present perfect,\",\n    \"keywords for resume,\",\n    \"keywords for generator,\"\n  ],\n  \"keywords g\": [\n    \"keywords generator,\",\n    \"keywords google,\",\n    \"keywords google seo,\",\n    \"keywords google play,\",\n    \"keywords google analytics,\",\n    \"keywords google adwords tool,\",\n    \"keywords google adwords,\",\n    \"keywords gwent,\",\n    \"keywords good,\",\n    \"keywords google free,\"\n  ],\n  \"keywords h\": [\n    \"keywords html,\",\n    \"keywords history,\",\n    \"keywords how to seo,\",\n    \"keywords human resources,\",\n    \"keywords high cpc,\",\n    \"keywords how many,\",\n    \"keywords hearthstone,\",\n    \"keywords how to write,\",\n    \"keywords hq,\",\n    \"keywords halloween,\"\n  ],\n  \"keywords i\": [\n    \"keywords io,\",\n    \"keywords international,\",\n    \"keywords in java,\",\n    \"keywords in c,\",\n    \"keywords in python,\",\n    \"keywords imdb,\",\n    \"keywords in html,\",\n    \"keywords in sql,\",\n    \"keywords index medicus,\",\n    \"keywords in seo,\"\n  ],\n  \"keywords j\": [\n    \"keywords java,\",\n    \"keywords javascript,\",\n    \"keywords jobs,\",\n    \"keywords journal,\",\n    \"keywords job search,\",\n    \"keywords john patrick leary,\",\n    \"keywords jewelry,\",\n    \"keywords japan,\",\n    \"keywords jeet,\",\n    \"keywords job application,\"\n  ],\n  \"keywords k\": [\n    \"keywords kullan\u0131m\u0131,\",\n    \"keywords kindle,\",\n    \"keywords kdp,\",\n    \"keywords key words,\",\n    \"keywords kotlin,\",\n    \"keywords keywords tool,\",\n    \"keywords kostenlos finden,\",\n    \"custom keywords katalon,\",\n    \"keywords. try more general keywords,\",\n    \"how are negative keywords different from other keywords,\"\n  ],\n  \"keywords l\": [\n    \"keywords list,\",\n    \"keywords latex,\",\n    \"keywords linkedin,\",\n    \"keywords lightroom,\",\n    \"keywords localization,\",\n    \"keywords like as like and is are often used when what type of context clue is used,\",\n    \"keywords leary,\",\n    \"keywords logo,\",\n    \"keywords length seo,\",\n    \"keywords list in java,\"\n  ],\n  \"keywords m\": [\n    \"keywords meta,\",\n    \"keywords mesh,\",\n    \"keywords meta tag,\",\n    \"keywords maker,\",\n    \"keywords meaning,\",\n    \"keywords montreal,\",\n    \"keywords marketing,\",\n    \"keywords minecraft,\",\n    \"keywords mysql,\",\n    \"keywords magic the gathering,\"\n  ],\n  \"keywords n\": [\n    \"keywords ne demek,\",\n    \"keywords nedir,\",\n    \"keywords nas\u0131l yaz\u0131l\u0131r,\",\n    \"keywords nas\u0131l olmal\u0131,\",\n    \"keywords netflix,\",\n    \"keywords netflix slayer leecher,\",\n    \"keywords neil patel,\",\n    \"keywords nature,\",\n    \"keywords number of searches,\",\n    \"keywords node js,\"\n  ],\n  \"keywords o\": [\n    \"keywords or key words,\",\n    \"keywords olu\u015fturucu,\",\n    \"keywords of present simple,\",\n    \"keywords of past continuous,\",\n    \"keywords of present continuous,\",\n    \"keywords of present perfect,\",\n    \"keywords on youtube,\",\n    \"keywords of java,\",\n    \"keywords of c++,\",\n    \"keywords of mysql,\"\n  ],\n  \"keywords p\": [\n    \"keywords planner,\",\n    \"keywords present perfect,\",\n    \"keywords past continuous,\",\n    \"keywords present continuous,\",\n    \"keywords present simple,\",\n    \"keywords past simple,\",\n    \"keywords present perfect continuous,\",\n    \"keywords past perfect,\",\n    \"keywords planner tool,\",\n    \"keywords planner google,\"\n  ],\n  \"keywords q\": [\n    \"keywords qa,\",\n    \"keywords quality score,\",\n    \"keywords quotes,\",\n    \"keywords questions,\",\n    \"keywords quizlet,\",\n    \"keywords que es,\",\n    \"keywords quality assurance,\",\n    \"keywords que son,\",\n    \"keywords que es en espa\u00f1ol,\",\n    \"keywords quantitative research,\"\n  ],\n  \"keywords r\": [\n    \"keywords research,\",\n    \"keywords resume,\",\n    \"keywords research tool,\",\n    \"keywords ranking,\",\n    \"keywords research google,\",\n    \"keywords research paper,\",\n    \"keywords research free,\",\n    \"keywords revealer,\",\n    \"keywords related to books,\",\n    \"keywords related to bpo,\"\n  ],\n  \"keywords s\": [\n    \"keywords studios,\",\n    \"keywords seo,\",\n    \"keywords search,\",\n    \"keywords studios ek\u015fi,\",\n    \"keywords studios katowice,\",\n    \"keywords slayer leecher,\",\n    \"keyword shitter,\"\n  ],\n  \"keywords t\": [\n    \"keywords tool,\",\n    \"keywords tool youtube,\",\n    \"keywords t\u00fcrk\u00e7e anlam\u0131,\",\n    \"keywords tool google,\",\n    \"keywords tools google,\",\n    \"keywords tool adwords,\",\n    \"keywords tool google adwords,\",\n    \"keywords trend google,\",\n    \"keywords travel,\",\n    \"keywords target audience,\"\n  ],\n  \"keywords u\": [\n    \"keywords used in exception handling,\",\n    \"keywords used in java,\",\n    \"keywords used in python,\",\n    \"keywords used in exception handling in c++,\",\n    \"keywords upsc,\",\n    \"keywords usage test,\",\n    \"keywords used in c++,\",\n    \"keywords used,\",\n    \"keywords used in resume,\",\n    \"keywords used by recruiters,\"\n  ],\n  \"keywords v\": [\n    \"keywords volume checker,\",\n    \"keywords vs tags,\",\n    \"keywords vs key words,\",\n    \"keywords vs reserved words,\",\n    \"keywords vs search terms,\",\n    \"keywords vision ias,\",\n    \"keywords video,\",\n    \"keywords value,\",\n    \"keywords vs adwords,\",\n    \"keywords vmc,\"\n  ],\n  \"keywords w\": [\n    \"keywords wrapper,\",\n    \"keywords with peter and jane,\",\n    \"keywords wordpress,\",\n    \"keywords website,\",\n    \"keywords williams,\",\n    \"keywords wikipedia,\",\n    \"keywords with high cpc,\",\n    \"keywords with ladybird,\",\n    \"keywords with +,\",\n    \"keywords wordstream,\"\n  ],\n  \"keywords x\": [\n    \"keywords xing,\",\n    \"keywords xtreme,\",\n    \"keywords xenapp,\",\n    \"keywords xenapp 6.5,\",\n    \"keywords xhtml,\",\n    \"keywords xmp,\",\n    \"keywords xml,\",\n    \"top keywords xing,\",\n    \"adobe bridge keywords xml,\",\n    \"pdf keywords xmp,\"\n  ],\n  \"keywords y\": [\n    \"keywords youtube,\",\n    \"keywords yoast seo,\",\n    \"keywords youtube videos,\",\n    \"keywords yoga,\",\n    \"keywords yoast,\",\n    \"keywords yii2,\",\n    \"keywords your searches used,\",\n    \"keywords youtube channel,\",\n    \"keywords youtube tags,\",\n    \"keywords youtube free,\"\n  ]\n}\n</code></pre>\n\n<p>the next line is this.</p>\n\n<pre><code>var gg = JsonConvert.DeserializeObject&lt;string&gt;(ss);\n</code></pre>\n\n<p>In that line im getting error like below.</p>\n\n<blockquote>\n  <p>Unexpected character encountered while parsing value: {. Path '', line\n  1, position 1.</p>\n</blockquote>\n\n<p>Ok. I tried this also.</p>\n\n<pre><code>var gg = JsonConvert.DeserializeObject&lt;List&lt;string&gt;&gt;(ss);\n</code></pre>\n\n<p>Attention to <code>List&lt;string&gt;.</code></p>\n\n<p>And im getting this error.</p>\n\n<blockquote>\n  <p>Cannot deserialize the current JSON object (e.g. {\"name\":\"value\"})\n  into type 'System.Collections.Generic.List`1[System.String]' because\n  the type requires a JSON array (e.g. [1,2,3]) to deserialize\n  correctly. To fix this error either change the JSON to a JSON array\n  (e.g. [1,2,3]) or change the deserialized type so that it is a normal\n  .NET type (e.g. not a primitive type like integer, not a collection\n  type like an array or List) that can be deserialized from a JSON\n  object. JsonObjectAttribute can also be added to the type to force it\n  to deserialize from a JSON object.</p>\n</blockquote>\n\n<p>I want to deserialize the code you saw above back to <code>Dictionary&lt;string, List&lt;string&gt;&gt;</code> </p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["c#", "oop", "polymorphism"], "comments": [{"owner": {"reputation": 11522, "user_id": 120753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8mz8N.jpg?s=128&g=1", "display_name": "Babak Naffas", "link": "https://stackoverflow.com/users/120753/babak-naffas"}, "edited": false, "score": 5, "creation_date": 1548277859, "post_id": 54335676, "comment_id": 95488685, "body": "Why are you using <code>new</code> instead of making the base method <code>virtual</code> and overriding in the subclass?"}, {"owner": {"reputation": 167, "user_id": 7815139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30777bda1da37743acabf97cd0a8dc59?s=128&d=identicon&r=PG&f=1", "display_name": "T. Grumser", "link": "https://stackoverflow.com/users/7815139/t-grumser"}, "reply_to_user": {"reputation": 11522, "user_id": 120753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8mz8N.jpg?s=128&g=1", "display_name": "Babak Naffas", "link": "https://stackoverflow.com/users/120753/babak-naffas"}, "edited": false, "score": 0, "creation_date": 1548278168, "post_id": 54335676, "comment_id": 95488807, "body": "@BabakNaffas because i don&#39;t completely undestrood the virtual identifier."}, {"owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "edited": false, "score": 1, "creation_date": 1548278235, "post_id": 54335676, "comment_id": 95488844, "body": "<code>virtual</code> in difference to <code>abstract</code> means: The method already has an implementation in the parent class but can be overwritten anyway or extended using <code>base.method</code>"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1548283719, "post_id": 54335676, "comment_id": 95490950, "body": "You&#39;ve said both &quot;it is overridden&quot; and &quot;it is new&quot;.  But &quot;overridden&quot; and &quot;new&quot; are opposites.  If you don&#39;t understand that fact, then stop programming, understand that fact, and then start over with a correct understanding."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 1, "creation_date": 1548283835, "post_id": 54335676, "comment_id": 95490978, "body": "Imagine that every virtual method declares a &quot;slot&quot;, and every override puts a different method in that slot, and every &quot;new&quot; makes a new slot.  Now do you see why &quot;override&quot; and &quot;new&quot; are opposites?  &quot;override&quot; means &quot;change the value of this slot&quot;, and &quot;new&quot; means &quot;leave the old slot unchanged and make a new slot&quot;.  You need to understand how this works if you are going to be successful programming in C#."}], "answers": [{"tags": [], "owner": {"reputation": 11522, "user_id": 120753, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8mz8N.jpg?s=128&g=1", "display_name": "Babak Naffas", "link": "https://stackoverflow.com/users/120753/babak-naffas"}, "is_accepted": false, "score": 1, "last_activity_date": 1548308499, "last_edit_date": 1548308499, "creation_date": 1548278670, "answer_id": 54335875, "question_id": 54335676, "link": "https://stackoverflow.com/questions/54335676/is-there-a-way-to-call-the-most-subclass-implementation-of-a-method/54335875#54335875", "title": "Is there a way to call the most subclass implementation of a method?", "body": "<p>What you're asking about is polymorphism. In your scenario, you can achieve this by providing a default implementation in your abstract class (as a virtual method) and them allowing each sub-class to provide their own implementation by overriding the method.</p>\n\n<p>In <code>SpaceshipController</code>, change  <code>protected void updateSpaceshipMovement()</code> to <code>protected virtual void updateSpaceshipMovement()</code>. This is telling the compiler to use this default implementation for SpaceshipController and any subclasses.</p>\n\n<p>In your subclass, change <code>protected new void updatePlayerMovement()</code> to <code>protected override void updatePlayerMovement()</code>. This is telling the compiler to use this modified implementation for this particular class. </p>\n\n<pre><code>protected override void updatePlayerMovement(){\n  base.updatePlayerMovement(); //you can also call the parent implementation first if you so choose.\n  //now perform the actions specific to this sub class.\n\n}\n</code></pre>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/abstract-and-sealed-classes-and-class-members\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/abstract-and-sealed-classes-and-class-members</a>.</li>\n<li><a href=\"https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/polymorphism\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/polymorphism</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 7815139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30777bda1da37743acabf97cd0a8dc59?s=128&d=identicon&r=PG&f=1", "display_name": "T. Grumser", "link": "https://stackoverflow.com/users/7815139/t-grumser"}, "edited": false, "score": 0, "creation_date": 1548333439, "post_id": 54335912, "comment_id": 95508947, "body": "In my case <code>spaceshipController</code> has a lot of already implemented methods so it can&#39;t be an interface, but thankls for your detailed answer. It explained it very well."}, {"owner": {"reputation": 24396, "user_id": 18192, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/c939f58c5869fead24efafcec0056914?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/18192/brian"}, "edited": false, "score": 0, "creation_date": 1548352043, "post_id": 54335912, "comment_id": 95520440, "body": "I recommend cleaning up your definitions of <code>virtual</code> and <code>abstract</code>.  As written, it is not immediately obvious whether &quot;The method already has an implementation in the parent class but can be overwritten anyway or extended using base.method&quot; is describing a virtual modifier on a base class or a parent class."}], "tags": [], "owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "is_accepted": true, "score": 3, "last_activity_date": 1548360098, "last_edit_date": 1548360098, "creation_date": 1548278806, "answer_id": 54335912, "question_id": 54335676, "link": "https://stackoverflow.com/questions/54335676/is-there-a-way-to-call-the-most-subclass-implementation-of-a-method/54335912#54335912", "title": "Is there a way to call the most subclass implementation of a method?", "body": "<p>To answer the question:</p>\n\n<blockquote>\n  <p>No, not the way you implemented this.</p>\n</blockquote>\n\n<p>How should the base class know that there is somewhere an inherited class which has a method that overwrites its method and should be called instead?</p>\n\n<hr>\n\n<p>You have to properly inherit (<code>override</code>) the method using the <code>virtual</code> keyword. For showing the difference I also added an <code>abstract</code> method.</p>\n\n<pre><code>public abstract class SpaceshipController \n{\n    // already has an implementation but might be extended or overruled\n    protected virtual void updateSpaceshipMovement()\n    {\n        // do something general\n    }\n\n    // does not have an implementation -&gt; HAS to be implemented by subclass\n    protected abstract void Something();\n}\n</code></pre>\n\n<p>If there are no <code>abstract</code> methods you might not even have to make the base class <code>abstract</code> at all.</p>\n\n<p>Now in the subclass <code>override</code> the <code>virtual</code> method. (And implement the <code>abstract</code> ones.)</p>\n\n<pre><code>public class ExampleController : SpaceshipController \n{\n    // I don't have to implement updateSpaceshipMovement\n    // but I want to extend or overwrite it\n    protected override void updateSpaceshipMovement()\n    {\n        // optional: anyway execute base code\n        base.updateSpaceshipMovement();\n\n        // do other stuff\n    }\n\n    // I have to implement this\n    protected override void Something()\n    {\n        // do something\n    }\n}\n</code></pre>\n\n<ul>\n<li><p><a href=\"https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/virtual\" rel=\"nofollow noreferrer\"><strong><code>virtual</code></strong></a> means:<br>\nThe method already has an implementation in the base class but can be overwritten anyway or extended using <code>base.method()</code></p></li>\n<li><p><a href=\"https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/abstract\" rel=\"nofollow noreferrer\"><strong><code>abstract</code></strong></a> means:<br>\nThere is no implementation in the base class => has to be implemented by the subclass.</p></li>\n</ul>\n\n<hr>\n\n<p>In the case that all subclasses should have their own implementation and not use <code>base.updateSpaceshipMovement</code> at all maybe an <a href=\"https://docs.microsoft.com/dotnet/csharp/language-reference/keywords/interface\" rel=\"nofollow noreferrer\">interface</a> might even be better:</p>\n\n<pre><code>public interface ISpaceshipController\n{\n    void updateSpaceshipMovement();\n}\n</code></pre>\n\n<p>An <code>interface</code> could be kind of explained as an <code>abstract class</code> which contains <strong>only</strong> <code>abstract</code> methods, <strong>BUT</strong> one class later can implement <strong>multiple</strong> interfaces which makes it a very mighty tool.</p>\n\n<p>Implement it e.g. like </p>\n\n<pre><code>public class ExampleController : MonoBehaviour, ISpaceshipController\n{\n    // I have to implement this to fulfill the interface implementation\n    public void updateSpaceshipMovement()\n    {\n        // do stuff\n    }\n} \n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 7815139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/30777bda1da37743acabf97cd0a8dc59?s=128&d=identicon&r=PG&f=1", "display_name": "T. Grumser", "link": "https://stackoverflow.com/users/7815139/t-grumser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 54335912, "answer_count": 2, "score": -1, "last_activity_date": 1548360098, "creation_date": 1548277711, "last_edit_date": 1548307983, "question_id": 54335676, "link": "https://stackoverflow.com/questions/54335676/is-there-a-way-to-call-the-most-subclass-implementation-of-a-method", "title": "Is there a way to call the most subclass implementation of a method?", "body": "<p>In my game i'm making in unity i have an abstract superclass <code>SpaceshipController</code> and it contains an implemented method <code>protected void updateSpaceshipMovement()</code>. For every spaceship there is a subclass and in some of them the method is overriden (<code>protected new void updatePlayerMovement()</code>). The method when called in the superclass uses the implementation of <code>SpaceshipController</code> and i wanted to know if theres a way to call the implementation in the subclasses when the method is called in the superclasses code.</p>\n"}, {"tags": ["c#", "generics", "delegates"], "comments": [{"owner": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1548277707, "post_id": 54335628, "comment_id": 95488609, "body": "Is your return value always a property of your control and return always a string ? if yes have you taken a look at reflection ?"}, {"owner": {"reputation": 2442, "user_id": 481143, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8e76b3cf3e815c8d81139db06fea8e74?s=128&d=identicon&r=PG", "display_name": "Rolan", "link": "https://stackoverflow.com/users/481143/rolan"}, "reply_to_user": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1548277905, "post_id": 54335628, "comment_id": 95488702, "body": "For this particular function, yes, the return type will always be a string.  I haven&#39;t taken a look at reflection, but I&#39;ll check the docs.  Was there anything in particular that you think it could be used for here?"}, {"owner": {"reputation": 6829, "user_id": 5649561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xNgLZ.jpg?s=128&g=1", "display_name": "Vadim Martynov", "link": "https://stackoverflow.com/users/5649561/vadim-martynov"}, "edited": false, "score": 0, "creation_date": 1548278135, "post_id": 54335628, "comment_id": 95488795, "body": "ok, your code looks fine, so, what is your question? what is your problem?"}, {"owner": {"reputation": 2442, "user_id": 481143, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8e76b3cf3e815c8d81139db06fea8e74?s=128&d=identicon&r=PG", "display_name": "Rolan", "link": "https://stackoverflow.com/users/481143/rolan"}, "reply_to_user": {"reputation": 6829, "user_id": 5649561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xNgLZ.jpg?s=128&g=1", "display_name": "Vadim Martynov", "link": "https://stackoverflow.com/users/5649561/vadim-martynov"}, "edited": false, "score": 0, "creation_date": 1548278315, "post_id": 54335628, "comment_id": 95488874, "body": "@VadimMartynov I&#39;m running into an error which states that I cannot convert ComboBoxValue to System.Func&lt;Control, string&gt;  .  Which I assume means I&#39;ve done something not quite kosher."}, {"owner": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1548278348, "post_id": 54335628, "comment_id": 95488888, "body": "@Rolan i did put an answer covering an example with reflection. Obviously i covered an example with <code>String</code> type but you can make different ones handling other types"}, {"owner": {"reputation": 2442, "user_id": 481143, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8e76b3cf3e815c8d81139db06fea8e74?s=128&d=identicon&r=PG", "display_name": "Rolan", "link": "https://stackoverflow.com/users/481143/rolan"}, "reply_to_user": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "edited": false, "score": 0, "creation_date": 1548278432, "post_id": 54335628, "comment_id": 95488926, "body": "@Franck Thanks, I&#39;ll give it a shot."}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "edited": false, "score": 1, "creation_date": 1548279371, "post_id": 54335628, "comment_id": 95489361, "body": "Strictly speaking, you have an object that is supposed to expose a property called <code>Text</code> that returns a <code>string</code>. This sounds like an interface to me. One way of going about this would be to create such interface (e.g. <code>IControlWithText</code>), then create your own derived <code>TextBox</code> and <code>ComboBox</code> classes that implement it, then use those instead and pass them around using the interface type. This obviously may be overkill, depending on what you are doing."}], "answers": [{"tags": [], "owner": {"reputation": 4083, "user_id": 2748412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EZ1jT.png?s=128&g=1", "display_name": "Franck", "link": "https://stackoverflow.com/users/2748412/franck"}, "is_accepted": false, "score": 0, "last_activity_date": 1548278157, "creation_date": 1548278157, "answer_id": 54335766, "question_id": 54335628, "link": "https://stackoverflow.com/questions/54335628/how-can-i-pass-delegates-to-a-function-for-generic-delegates/54335766#54335766", "title": "How can I pass delegates to a function for generic delegates?", "body": "<p>Using reflection is pretty easy. What you do is use the type of the class to retrieve their properties. Then you request the value of that property on an object and you got the value.</p>\n\n<p>here a quick simple reflection. What it does is get the type of the object, request the property named <code>SelectedValue</code> then query the <code>combobox</code> object to retrieve the value and finally convert as string.</p>\n\n<pre><code>var combobox = this.cboUnitType;\nvar value = combobox.GetType().GetProperty(\"SelectedValue\").GetValue(combobox ).ToString();\n</code></pre>\n\n<p>Here the same thing made into a function and quite generic plus has possible error handling</p>\n\n<pre><code>private string GetValue(object obj, string property)\n{\n    var value = \"\";\n\n    try\n    {\n        value = obj.GetType().GetProperty(property).GetValue(obj).ToString();\n    }\n    catch { }\n\n    return value;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2442, "user_id": 481143, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8e76b3cf3e815c8d81139db06fea8e74?s=128&d=identicon&r=PG", "display_name": "Rolan", "link": "https://stackoverflow.com/users/481143/rolan"}, "edited": false, "score": 0, "creation_date": 1548279795, "post_id": 54335943, "comment_id": 95489533, "body": "Yeah, I see what you mean with regard to the issue of clarity.  I was thinking it would be an easy way to pass generic functions which could be executed on some fields (I&#39;m doing some custom validation stuff), but it doesn&#39;t look like that&#39;s a simple thing to do.  It looks like your approach will work for what I need to do, though. Thanks."}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "reply_to_user": {"reputation": 2442, "user_id": 481143, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8e76b3cf3e815c8d81139db06fea8e74?s=128&d=identicon&r=PG", "display_name": "Rolan", "link": "https://stackoverflow.com/users/481143/rolan"}, "edited": false, "score": 0, "creation_date": 1548279977, "post_id": 54335943, "comment_id": 95489613, "body": "@Rolan: As someone who reviews <i>way</i> too much code in a day, don&#39;t underestimate the value of <i>clarity</i>!"}], "tags": [], "owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "is_accepted": true, "score": 2, "last_activity_date": 1548279876, "last_edit_date": 1548279876, "creation_date": 1548278974, "answer_id": 54335943, "question_id": 54335628, "link": "https://stackoverflow.com/questions/54335628/how-can-i-pass-delegates-to-a-function-for-generic-delegates/54335943#54335943", "title": "How can I pass delegates to a function for generic delegates?", "body": "<p>Here's a cleaner (and clearer) version of your original code.  It doesn't use any reflection, generics or ToString calls.  Instead, it uses a <em>pattern matching</em> switch statement:</p>\n\n<pre><code>public static string ReturnText(Control control)\n{\n    switch (control)\n    {\n        case TextBox tb:\n            return tb.Text;\n        case ComboBox cb:\n            return cb.SelectedText;\n        //etc.\n        default: return string.Empty;\n    }\n}\n</code></pre>\n\n<p>By the way, your use of the name <em><code>controller</code></em> for a variable of type <code>Control</code> is misleading; controller has real meaning in other contexts.</p>\n\n<p>An alternative would be to create a <code>Dictionary&lt;Type, Func&lt;Control, string&gt;&gt;</code> where an entry would look like <code>{typeof(Textbox), c=&gt;((TextBox)c).Text}</code>, but I think that would be a lot less clear than just using a switch like I've shown.</p>\n\n<p><strong>One other thing:</strong> You could make this function an <em>extension method</em> on the <code>Control</code> type (by putting it in a static class and putting the keyword <code>this</code> before <code>Control</code> in the parameter list).  I'd probably rename it <code>GetTextValue</code>.  At that point, you could just say <code>var textValue = anyControl.GetTextValue();</code> for any control on your page.  Unfortunately, there isn't an <code>extension property</code> yet in C#</p>\n"}], "owner": {"reputation": 2442, "user_id": 481143, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/8e76b3cf3e815c8d81139db06fea8e74?s=128&d=identicon&r=PG", "display_name": "Rolan", "link": "https://stackoverflow.com/users/481143/rolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54335943, "answer_count": 2, "score": 0, "last_activity_date": 1548279876, "creation_date": 1548277456, "question_id": 54335628, "link": "https://stackoverflow.com/questions/54335628/how-can-i-pass-delegates-to-a-function-for-generic-delegates", "title": "How can I pass delegates to a function for generic delegates?", "body": "<p>I have a function to return relevant text from various windows controls.<br>\nI was hoping to be able to create something a little more elegant, and less static.\nHere's code that functions the way I want it to:</p>\n\n<pre><code>    public string returnText(Control controller)\n    {\n        string bob = controller.GetType().Name.ToString();\n        if (bob == \"TextBox\")\n            return ((TextBox)controller).Text;\n        else if (bob == \"ComboBox\")\n            return ((ComboBox)controller).SelectedValue.ToString();\n        else\n            return \"Invalid Object\";\n    }\n</code></pre>\n\n<p>What I'd like to do is something like this:</p>\n\n<p>Calling code:</p>\n\n<pre><code>        TextBoxValue del = x =&gt; x.Text;\n        ComboBoxValue com = x =&gt; x.SelectedValue.ToString();\n        bob.returnText2(this.cboUnitType, com);\n        bob.returnText2(this.txtCurbAdj, del);\n</code></pre>\n\n<p>Function:</p>\n\n<pre><code>    public string returnText2&lt;T&gt;(T controller, Func&lt;T, string&gt; lambda )\n    {\n        return lambda(controller);\n    }\n</code></pre>\n\n<p>I'm guessing I'm doing the generic side of things wrong, but I haven't been able to figure out the right way to do it.\nOr maybe I'm completely out to lunch here.</p>\n"}, {"tags": ["c#", "api", "restsharp", "dotnet-httpclient"], "comments": [{"owner": {"reputation": 1, "user_id": 1738406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/850e4d15c1912ebc2a16c2efbc91d026?s=128&d=identicon&r=PG", "display_name": "chwolfe", "link": "https://stackoverflow.com/users/1738406/chwolfe"}, "edited": false, "score": 1, "creation_date": 1548278735, "post_id": 54335598, "comment_id": 95489064, "body": "<a href=\"https://stackoverflow.com/questions/21805541/how-can-i-convert-this-net-restsharp-code-to-microsoft-net-http-httpclient-code?rq=1\">Take a look at the following Q&amp;A</a>"}, {"owner": {"reputation": 5, "user_id": 10930564, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VVy75RFfVmE/AAAAAAAAAAI/AAAAAAAAAAg/7sF9dOe5Vbw/photo.jpg?sz=128", "display_name": "Alex Eberly", "link": "https://stackoverflow.com/users/10930564/alex-eberly"}, "reply_to_user": {"reputation": 32179, "user_id": 62600, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/122fffb7bc691c8e7e5e5b2308517257?s=128&d=identicon&r=PG", "display_name": "Todd Menier", "link": "https://stackoverflow.com/users/62600/todd-menier"}, "edited": false, "score": 0, "creation_date": 1548434308, "post_id": 54335598, "comment_id": 95552889, "body": "@ToddMenier I have upvoted your answer, but due to the fact that I have less than 15 reputation, it is not publicly displayed"}, {"owner": {"reputation": 32179, "user_id": 62600, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/122fffb7bc691c8e7e5e5b2308517257?s=128&d=identicon&r=PG", "display_name": "Todd Menier", "link": "https://stackoverflow.com/users/62600/todd-menier"}, "edited": false, "score": 0, "creation_date": 1548446229, "post_id": 54335598, "comment_id": 95558411, "body": "No problem, I appreciate you accepting it :)"}], "answers": [{"tags": [], "owner": {"reputation": 434, "user_id": 8515291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1cd95ac6ca6228c9f4c251613f1e891?s=128&d=identicon&r=PG&f=1", "display_name": "curious.netter", "link": "https://stackoverflow.com/users/8515291/curious-netter"}, "is_accepted": false, "score": 0, "last_activity_date": 1549314615, "last_edit_date": 1549314615, "creation_date": 1548281354, "answer_id": 54336452, "question_id": 54335598, "link": "https://stackoverflow.com/questions/54335598/need-help-converting-my-restsharp-code-to-use-httpclient-instead/54336452#54336452", "title": "Need help converting my RestSharp code to use HttpClient instead", "body": "<p>I think you are missing first parameter in the method PostAsync i.e. requestUri=Client.BaseAddress (see my implementation below).</p>\n\n<p>Try with this first, if did not work, read below.  I have a little different implementation where I passed <code>client.BaseAddress</code> as first parameter and I am passing my content as ByteArrayContent. In my case I have to pass my content as \"application/x-www-form-urlencoded\" excerpt of my code: </p>\n\n<pre><code>        var buffer = Encoding.UTF8.GetBytes(content);\n        var byteContent = new ByteArrayContent(buffer);\n        //as I can't send JSON, probably, you can skip as it's already JSON\n        byteContent.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue(\"application/x-www-form-urlencoded\");  \n       //requestUri=client.BaseAddress          \n        await client.PostAsync(requestUri, byteContent).ConfigureAwait(false); \n</code></pre>\n\n<p>We have somewhat different need but I think you are pretty close. If it does not help, write me I will share my code. After reading the comment, I would like to share how I have made my HttpClient. The code is as it is:</p>\n\n<pre><code> using (var client = CreateMailClientForPOST($\"{BaseUrl}/\"))\n        {\n           //removed code, you can call above code as method like\n           var response= await client.DoThingAsAsync($\"{client.BaseAddress}, content\").ConfigureAwait(false);\n        }\n\nprotected HttpClient CreateMailClientForPOST(string resource)\n    {\n        var handler = new HttpClientHandler();\n        if (handler.SupportsAutomaticDecompression)\n        {\n            handler.AutomaticDecompression = System.Net.DecompressionMethods.GZip | System.Net.DecompressionMethods.Deflate;\n        }\n\n        var client = new HttpClient(handler)\n        {\n\n            BaseAddress = new Uri($\"https://api.address.com/rest/{resource}\")\n        };\n        return client;\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 10930564, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VVy75RFfVmE/AAAAAAAAAAI/AAAAAAAAAAg/7sF9dOe5Vbw/photo.jpg?sz=128", "display_name": "Alex Eberly", "link": "https://stackoverflow.com/users/10930564/alex-eberly"}, "edited": false, "score": 0, "creation_date": 1548345672, "post_id": 54349621, "comment_id": 95516807, "body": "This solution worked perfectly!  Out of curiosity, is there any reason why appending the URI in var response is any better than including it all in the BaseAddress?"}, {"owner": {"reputation": 32179, "user_id": 62600, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/122fffb7bc691c8e7e5e5b2308517257?s=128&d=identicon&r=PG", "display_name": "Todd Menier", "link": "https://stackoverflow.com/users/62600/todd-menier"}, "reply_to_user": {"reputation": 5, "user_id": 10930564, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VVy75RFfVmE/AAAAAAAAAAI/AAAAAAAAAAg/7sF9dOe5Vbw/photo.jpg?sz=128", "display_name": "Alex Eberly", "link": "https://stackoverflow.com/users/10930564/alex-eberly"}, "edited": false, "score": 0, "creation_date": 1548357090, "post_id": 54349621, "comment_id": 95522677, "body": "Well, for one thing, you already have a <code>BaseAddress</code> and a relative endpoint in 2 pieces, which fits the <code>HttpClient</code> usage pattern of &quot;create client with base address, call specific endpoint&quot; perfectly, so why concat them? But more importantly, if you were to reuse the same client to call different endpoints (<a href=\"https://aspnetmonsters.com/2016/08/2016-08-27-httpclientwrong/\" rel=\"nofollow noreferrer\">which you should do as much as possible</a>), it&#39;s set up well to do that."}], "tags": [], "owner": {"reputation": 32179, "user_id": 62600, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/122fffb7bc691c8e7e5e5b2308517257?s=128&d=identicon&r=PG", "display_name": "Todd Menier", "link": "https://stackoverflow.com/users/62600/todd-menier"}, "is_accepted": true, "score": 0, "last_activity_date": 1548343297, "last_edit_date": 1548343297, "creation_date": 1548342246, "answer_id": 54349621, "question_id": 54335598, "link": "https://stackoverflow.com/questions/54335598/need-help-converting-my-restsharp-code-to-use-httpclient-instead/54349621#54349621", "title": "Need help converting my RestSharp code to use HttpClient instead", "body": "<p>I think you got stung by <a href=\"https://stackoverflow.com/questions/23438416/why-is-httpclient-baseaddress-not-working\">this issue</a>. In short, the URI in <code>client.BaseAddress</code> needs a slash at the end of it.</p>\n\n<p>However, I wouldn't simply add it, I'd consider doing it a little different. Presumably your <code>BaseUrl</code> already has a trailing slash, given you're appending <code>\"auth/GetToken\"</code> to it. I'd do it this way:</p>\n\n<pre><code>client.BaseAddress = new Uri(BaseUrl);\n...\nvar response = await client.PostAsync(\"auth/GetToken\", content);\n</code></pre>\n\n<p>As you can see, <code>HttpClient</code> fits very cleanly with how your code is already set up, i.e. you have a \"base\" address with a trailing slash and you want to append to it for a specific call.</p>\n\n<p>That should get you un-stuck to this point. The next thing you'll need to tackle is deserializing the JSON response so you can get the token out of it. It's similar to how you did it in RestSharp, except that <code>response.Content</code> is not a string in the <code>HttpClient</code> world, so you need one more step to get that:</p>\n\n<pre><code>var json = await response.Content.ReadAsStringAsync();\nGetTokenResults g = JsonConvert.DeserializeObject&lt;GetTokenResults&gt;(json);\nreturn g.Token;\n</code></pre>\n\n<p>Last thing you'll need to do to get this to compile is change the method signature to:</p>\n\n<pre><code>public async Task&lt;string&gt; GetTokenAsync\n</code></pre>\n\n<p>One final note: you are now in the async world, and that's a good thing, but you need to know how to use it correctly or you could end up with deadlocks and other mysterious bugs. In short, <a href=\"https://blog.stephencleary.com/2012/07/dont-block-on-async-code.html\" rel=\"nofollow noreferrer\">don't block on async code</a> by calling <code>.Result</code> or <code>.Wait()</code> anywhere up the call stack. That's by far most common mistake people make. Use <code>async/await</code> <em>all the way down</em>.</p>\n"}], "owner": {"reputation": 5, "user_id": 10930564, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VVy75RFfVmE/AAAAAAAAAAI/AAAAAAAAAAg/7sF9dOe5Vbw/photo.jpg?sz=128", "display_name": "Alex Eberly", "link": "https://stackoverflow.com/users/10930564/alex-eberly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2638, "favorite_count": 0, "accepted_answer_id": 54349621, "answer_count": 2, "score": 0, "last_activity_date": 1549314615, "creation_date": 1548277351, "last_edit_date": 1548327737, "question_id": 54335598, "link": "https://stackoverflow.com/questions/54335598/need-help-converting-my-restsharp-code-to-use-httpclient-instead", "title": "Need help converting my RestSharp code to use HttpClient instead", "body": "<p>Due to the fact that I need to convert this C# dll into a tlp file to be called from Visual Basic 6, I need avoid using external dependencies.  I have used RestSharp to consume a WebAPI by doing the following (working):</p>\n\n<pre><code>using RestSharp;\nusing Newtonsoft.Json;\n\n..\n\npublic string GetToken (string Key, string Password) {\n\n  var client = new RestClient (BaseUrl + \"auth/GetToken\");\n  var request = new RestRequest (Method.POST);\n  request.AddHeader (\"cache-control\", \"no-cache\");\n  request.AddHeader (\"Content-Type\", \"application/json\");\n  Dictionary&lt;string, string&gt; data = new Dictionary&lt;string, string&gt; {\n    { \"APIKey\", Key },\n    { \"APIPassword\", Password }\n};\nvar dataJSON = JsonConvert.SerializeObject (data);\nrequest.AddParameter (\"undefined\", dataJSON, ParameterType.RequestBody);\n\nIRestResponse response = client.Execute (request);\n\nGetTokenResults g = JsonConvert.DeserializeObject&lt;GetTokenResults&gt; (response.Content); \n\nreturn g.Token;\n}\n</code></pre>\n\n<p>where GetTokenResults was a struct that contained a declaration for the string Token.  I want to achieve this same functionality without using RestSharp.  Here is my unsuccessful attempt:</p>\n\n<pre><code>using System.Net.Http;\nusing System.Net.Http.Headers;\n\n..\n\npublic async void GetToken (string Key, string Password) {\n\n  var client = new HttpClient ( );\n  client.DefaultRequestHeaders.Accept.Clear ( );\n  client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue (\"application/json\"));\n  client.BaseAddress = new Uri (BaseUrl + \"auth/GetToken\");\n\n  Dictionary&lt;string, string&gt; data = new Dictionary&lt;string, string&gt; {\n  { \"APIKey\", Key },\n  { \"APIPassword\", Password }\n};\n  var dataJSON = JsonConvert.SerializeObject (data);\n\n  var content = new StringContent (dataJSON, Encoding.UTF8, \"application/json\");\n\n  var response = await client.PostAsync (\"\", content);\n\n}\n</code></pre>\n\n<p>I am unclear on how to achieve the same results (send API key and password, return token as string) using HttpClient as I did using RestSharp earlier.  Anything that can point me in the right direction is greatly appreciated!</p>\n"}, {"tags": ["c#", "asp.net-core"], "comments": [{"owner": {"reputation": 4869, "user_id": 3829417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/93c7e7ffaa757fcc153d952443adfaa0?s=128&d=identicon&r=PG&f=1", "display_name": "GregH", "link": "https://stackoverflow.com/users/3829417/gregh"}, "edited": false, "score": 0, "creation_date": 1548279011, "post_id": 54335541, "comment_id": 95489187, "body": "what was your second migration supposed to be adding. it&#39;s hard to tell why things don&#39;t show up if we don&#39;t know what is supposed to show up. might be helpful if you post your models at the time the first migration was created and then post was you added that shouldve been included in the second migration"}, {"owner": {"reputation": 139, "user_id": 9927520, "user_type": "registered", "profile_image": "https://graph.facebook.com/102412523961202/picture?type=large", "display_name": "\u0412\u0438\u0442\u0430\u043b\u0438\u0439 \u0428\u0435\u0431\u0430\u043d\u0438\u0446", "link": "https://stackoverflow.com/users/9927520/%d0%92%d0%b8%d1%82%d0%b0%d0%bb%d0%b8%d0%b9-%d0%a8%d0%b5%d0%b1%d0%b0%d0%bd%d0%b8%d1%86"}, "reply_to_user": {"reputation": 4869, "user_id": 3829417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/93c7e7ffaa757fcc153d952443adfaa0?s=128&d=identicon&r=PG&f=1", "display_name": "GregH", "link": "https://stackoverflow.com/users/3829417/gregh"}, "edited": false, "score": 0, "creation_date": 1548282757, "post_id": 54335541, "comment_id": 95490648, "body": "@GregH The first migration involved the <code>Users: UserIdentity</code> model and its context. After the update-daatabase was executed, 8 tables were added to the database. It is conceived that the migration should add 3 tables to the database, but the migration is generated empty."}, {"owner": {"reputation": 912, "user_id": 793558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec129715a153ae501c71261a1fe7d10d?s=128&d=identicon&r=PG", "display_name": "alans", "link": "https://stackoverflow.com/users/793558/alans"}, "edited": false, "score": 0, "creation_date": 1548289364, "post_id": 54335541, "comment_id": 95492377, "body": "If you&#39;re doing a many-to-many relationship between Group and Products, you&#39;ll need to map the relationships to the junction table."}], "answers": [{"tags": [], "owner": {"reputation": 4869, "user_id": 3829417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/93c7e7ffaa757fcc153d952443adfaa0?s=128&d=identicon&r=PG&f=1", "display_name": "GregH", "link": "https://stackoverflow.com/users/3829417/gregh"}, "is_accepted": true, "score": 3, "last_activity_date": 1548291252, "last_edit_date": 1548291252, "creation_date": 1548290748, "answer_id": 54337837, "question_id": 54335541, "link": "https://stackoverflow.com/questions/54335541/cant-add-migration/54337837#54337837", "title": "Can&#39;t add migration", "body": "<p>Took me a bit to spot your issue. Your <code>DbSet</code>s need to have getters and setters for EntityFramework to be able to locate the models so that it can generate the needed migration. </p>\n\n<p>You should change:</p>\n\n<pre><code>public DbSet&lt;Products&gt; products;\npublic DbSet&lt;Groups&gt; groups;\npublic DbSet&lt;GropsAndProducts&gt; gropsAndProducts;\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>public DbSet&lt;Products&gt; products { get; set; }\npublic DbSet&lt;Groups&gt; groups { get; set; }\npublic DbSet&lt;GropsAndProducts&gt; gropsAndProducts { get; set; }\n</code></pre>\n\n<p>Note that by convention, <code>DbSet</code> property names are normally upper cased (i.e: <code>Products</code> instead of <code>products</code>). Another thing to point out is you can simplify your <code>GropsAndProducts</code> (please fix the spelling!) model by changing it to:</p>\n\n<pre><code>public class GropsAndProducts\n{\n    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]\n    [Key]\n    public int Id { get; set; }\n    public int ProductId { get; set; }\n    public int GroupId { get; set; }\n\n    public Groups Group { get; set; }\n    public Products Product { get; set; }\n}\n</code></pre>\n\n<p>The foreign key annotation isn't necessary if you follow EF naming conventions (The <code>Group</code> navigation property's foreign key is <code>GroupId</code>). The property name <code>Groups</code> probably doesn't make as much sense anyway since the property is only holding a single <code>Group</code></p>\n"}], "owner": {"reputation": 139, "user_id": 9927520, "user_type": "registered", "profile_image": "https://graph.facebook.com/102412523961202/picture?type=large", "display_name": "\u0412\u0438\u0442\u0430\u043b\u0438\u0439 \u0428\u0435\u0431\u0430\u043d\u0438\u0446", "link": "https://stackoverflow.com/users/9927520/%d0%92%d0%b8%d1%82%d0%b0%d0%bb%d0%b8%d0%b9-%d0%a8%d0%b5%d0%b1%d0%b0%d0%bd%d0%b8%d1%86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 54337837, "answer_count": 1, "score": 0, "last_activity_date": 1548291252, "creation_date": 1548277154, "last_edit_date": 1548288427, "question_id": 54335541, "link": "https://stackoverflow.com/questions/54335541/cant-add-migration", "title": "Can&#39;t add migration", "body": "<p>Models:  <code>GropsAndProducts</code>, <code>Groups</code>, <code>Products</code>:</p>\n\n<pre><code>    public class GropsAndProducts\n    {\n        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]\n        [Key]\n        public int Id { get; set; }\n        [ForeignKey(\"Products\")]\n        public int ProductId { get; set; }\n        [ForeignKey(\"Groups\")]\n        public int GroupId { get; set; }\n\n        public Groups Groups { get; set; }\n        public Products Products { get; set; }\n    }\n\n    public class Groups\n    {\n        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]\n        [Key]\n        public int Id { get; set; }\n        [Required]\n        public string Title { get; set; }\n        [Required]\n        public string Discription { get; set; }\n        public List&lt;GropsAndProducts&gt; groupAndProducts { get; set; }\n    }\n    public class Products\n    {\n        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]\n        [Key]\n        public int Id { get; set; }\n        [Required]\n        public string Title { get; set; }\n        [Required]\n        public string Unit { get; set; }\n        [Required]\n        public int Count { get; set; }\n        [Required]\n        public int Price { get; set; }\n        [Required]\n        public int Discount { get; set; }\n        public string Discription { get; set; }\n        public List&lt;GropsAndProducts&gt; groupAndProducts { get; set; }\n    }\n</code></pre>\n\n<p>Context:</p>\n\n<pre><code>using Microsoft.EntityFrameworkCore;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing MySite.Models;\nusing System.Data;\n\nnamespace MySite.Data\n{\n    public class DbProductsAndGroupsContext : DbContext\n    {\n        public DbProductsAndGroupsContext(DbContextOptions&lt;DbProductsAndGroupsContext&gt; option) \n            : base (option)\n        {\n\n        }\n\n        public DbSet&lt;Products&gt; products;\n        public DbSet&lt;Groups&gt; groups;\n        public DbSet&lt;GropsAndProducts&gt; gropsAndProducts;\n    }\n}\n</code></pre>\n\n<p>Startup configuration:</p>\n\n<pre><code>public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddDbContext&lt;DbProductsAndGroupsContext&gt;(option =&gt; \n            option.UseMySql(\n                Configuration.GetConnectionString(\"DefaultConnection\"), x=&gt; x.MigrationsHistoryTable(\"__MyMigrationsHistory\", \"mySchema\"))\n                );\n            services.AddDbContext&lt;DbUserContex&gt;(options =&gt;\n                options.UseMySql(\n                    Configuration.GetConnectionString(\"DefaultConnection\")));\n            services.AddDefaultIdentity&lt;Users&gt;()\n                .AddEntityFrameworkStores&lt;DbUserContex&gt;();\n            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);\n</code></pre>\n\n<p>Now the problem is:</p>\n\n<p>The first migration (From <code>UserIdentity</code>) was performed normally (that is, a new database was created as well as tables with records). But after I created the second context and try to execute the command (in the package manager) \u02bbEntityFrameworkCore \\ Add-Migration -name: asdf -context: DbProductsAndGroupsContext`, then ** blank ** migration is added. Why can it be like that ??? I will be glad to any information.</p>\n"}, {"tags": ["c#", "asp.net-core"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1548277795, "post_id": 54335522, "comment_id": 95488644, "body": "No, you can use ASP.NET Core Identity but you should use JWT instead of Cookies"}, {"owner": {"reputation": 915, "user_id": 7927549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ad415578278ca4ed73179224ac7c99?s=128&d=identicon&r=PG&f=1", "display_name": "Axelly", "link": "https://stackoverflow.com/users/7927549/axelly"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1548277810, "post_id": 54335522, "comment_id": 95488654, "body": "@CamiloTerevinto Why?"}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1548278080, "post_id": 54335522, "comment_id": 95488775, "body": "Because a Web API should not care what the client is, and you have to hack stuff to make cookies work either in JavaScript or in mobile apps"}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 1, "creation_date": 1548278214, "post_id": 54335522, "comment_id": 95488831, "body": "Add not to mention cookies expose your api to XSRF attacks"}], "answers": [{"comments": [{"owner": {"reputation": 915, "user_id": 7927549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ad415578278ca4ed73179224ac7c99?s=128&d=identicon&r=PG&f=1", "display_name": "Axelly", "link": "https://stackoverflow.com/users/7927549/axelly"}, "edited": false, "score": 0, "creation_date": 1548277793, "post_id": 54335636, "comment_id": 95488643, "body": "Does it require to do something additional in compare to &quot;normal&quot; MVC when it comes to setting up that auth on backend?"}], "tags": [], "owner": {"reputation": 263, "user_id": 5715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3abd3a9b2ecfc7207b2317f34150c2b?s=128&d=identicon&r=PG", "display_name": "Shane Bauer", "link": "https://stackoverflow.com/users/5715/shane-bauer"}, "is_accepted": false, "score": 1, "last_activity_date": 1548277497, "creation_date": 1548277497, "answer_id": 54335636, "question_id": 54335522, "link": "https://stackoverflow.com/questions/54335522/is-it-possible-to-use-asp-net-core-identity-cookie-based-for-securing-webapi/54335636#54335636", "title": "Is it possible to use ASP.NET Core Identity (cookie based) for securing WebAPI?", "body": "<p>Yes, it's possible. Some JS libraries require you to enable the passing of cookies, though. Axios, for example, requires you to set withCredentials: true.</p>\n"}, {"comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1548278037, "post_id": 54335729, "comment_id": 95488757, "body": "Using JWT is not close at all to using OAuth"}, {"owner": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1548278071, "post_id": 54335729, "comment_id": 95488772, "body": "@CamiloTerevinto So what? You can use JWT as well as OAuth."}, {"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1548278151, "post_id": 54335729, "comment_id": 95488802, "body": "What makes you think using Tokens is similar to OAuth? OAuth can be used with tokens or cookies as you see fit, that point makes no sense at all"}, {"owner": {"reputation": 1052, "user_id": 2915577, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/747a80a0980c3b090b0f976e33c299a9?s=128&d=identicon&r=PG&f=1", "display_name": "Umair Anwaar", "link": "https://stackoverflow.com/users/2915577/umair-anwaar"}, "edited": false, "score": 0, "creation_date": 1606201396, "post_id": 54335729, "comment_id": 114883325, "body": "@Alexander can you share any example to work together, cookie authentication and token both work as expected?"}], "tags": [], "owner": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "is_accepted": false, "score": 0, "last_activity_date": 1606817651, "last_edit_date": 1606817651, "creation_date": 1548277981, "answer_id": 54335729, "question_id": 54335522, "link": "https://stackoverflow.com/questions/54335522/is-it-possible-to-use-asp-net-core-identity-cookie-based-for-securing-webapi/54335729#54335729", "title": "Is it possible to use ASP.NET Core Identity (cookie based) for securing WebAPI?", "body": "<p>You can use either cookie authentication or token based authentication and even both if you want. It depends on your needs.</p>\n<p>In javascript you can send both cookies and authorization headers to authorize.</p>\n"}, {"tags": [], "owner": {"reputation": 7701, "user_id": 4242590, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d63ce25a0e288a36cd7df62d0d54a19?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertK", "link": "https://stackoverflow.com/users/4242590/albertk"}, "is_accepted": false, "score": 0, "last_activity_date": 1548278641, "creation_date": 1548278641, "answer_id": 54335866, "question_id": 54335522, "link": "https://stackoverflow.com/questions/54335522/is-it-possible-to-use-asp-net-core-identity-cookie-based-for-securing-webapi/54335866#54335866", "title": "Is it possible to use ASP.NET Core Identity (cookie based) for securing WebAPI?", "body": "<blockquote>\n  <p>Is it possible to use that default AspNetCore's Identity with WebAPI?</p>\n</blockquote>\n\n<p>Yes. It will work very similar like it works in the default <code>Asp.Net Mvc</code> template.  Your <code>AccountController</code> may look like this:</p>\n\n<pre><code>public class AccountController : Controller\n{\n    private readonly SignInManager&lt;ApplicationUser&gt; _signInManager;\n    public AccountController(SignInManager&lt;ApplicationUser&gt; signInManager)\n    {\n        _signInManager = signInManager;\n    }\n\n    public async Task&lt;IActionResult&gt; Login(string login, string password)\n    {\n        var result = await _signInManager.PasswordSignInAsync(login, password, true, lockoutOnFailure: false);\n\n        if (result.Succeeded)\n        { \n            //process successful result\n        }\n        else\n        {\n            //process failed result\n        }\n    }\n}\n</code></pre>\n\n<p><code>SignInManager&lt;&gt;.PasswordSignInAsync()</code> will assign necessary cookies to process authentication.</p>\n"}, {"tags": [], "owner": {"reputation": 2407, "user_id": 6683525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5acbf5ba06acd29815cf4678de449656?s=128&d=identicon&r=PG&f=1", "display_name": "Sasan", "link": "https://stackoverflow.com/users/6683525/sasan"}, "is_accepted": false, "score": 0, "last_activity_date": 1548323661, "creation_date": 1548323661, "answer_id": 54343775, "question_id": 54335522, "link": "https://stackoverflow.com/questions/54335522/is-it-possible-to-use-asp-net-core-identity-cookie-based-for-securing-webapi/54343775#54343775", "title": "Is it possible to use ASP.NET Core Identity (cookie based) for securing WebAPI?", "body": "<p>From a technical point of view Cookie is just a http header just like the Authorization header, so you can protect your API with cookie.</p>\n\n<p>As a matter of fact if your API is just serving a SPA on the same domain, cookie is a better and safer option.</p>\n\n<p>Token base authentication is for scenarios where an API is serving multiple clients on different domains with different access levels. It makes sense to separate the authentication server from API server in those cases.</p>\n\n<p>I recommend reading these articles:</p>\n\n<p><a href=\"https://dev.to/darraghor/be-careful-of-the-jwt-hype-train-3e81\" rel=\"nofollow noreferrer\">Be careful of the JWT hype train</a></p>\n\n<p><a href=\"https://dev.to/rdegges/please-stop-using-local-storage-1i04\" rel=\"nofollow noreferrer\">Please Stop Using Local Storage</a></p>\n"}], "owner": {"reputation": 915, "user_id": 7927549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93ad415578278ca4ed73179224ac7c99?s=128&d=identicon&r=PG&f=1", "display_name": "Axelly", "link": "https://stackoverflow.com/users/7927549/axelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1385, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1606817651, "creation_date": 1548277066, "last_edit_date": 1548277272, "question_id": 54335522, "link": "https://stackoverflow.com/questions/54335522/is-it-possible-to-use-asp-net-core-identity-cookie-based-for-securing-webapi", "title": "Is it possible to use ASP.NET Core Identity (cookie based) for securing WebAPI?", "body": "<p>I think I'm having a little misconception that </p>\n\n<p><code>Identity = only MVC - returning Views</code></p>\n\n<p>and<code>WebAPI =&gt; you gotta go for token-ish way of authentication like JWT</code></p>\n\n<p>So, I'd want to ask</p>\n\n<p><code>Is it possible to use that default AspNetCore's Identity with WebAPI?</code></p>\n\n<p>Or maybe I should ask <code>Is javascript post/get attaching Cookies to it?</code></p>\n"}, {"tags": ["c#", "json"], "comments": [{"owner": {"reputation": 2567, "user_id": 1418154, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/18f0f1b20e7332cbfa4c01dd8170032e?s=128&d=identicon&r=PG", "display_name": "CrnaStena", "link": "https://stackoverflow.com/users/1418154/crnastena"}, "edited": false, "score": 0, "creation_date": 1548277491, "post_id": 54335494, "comment_id": 95488529, "body": "Brackets indicate array, so it seems that is expected. You will have to create mydata to be a list/array/enumerable. Can you show us what mydata is?"}], "answers": [{"comments": [{"owner": {"reputation": 2567, "user_id": 1418154, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/18f0f1b20e7332cbfa4c01dd8170032e?s=128&d=identicon&r=PG", "display_name": "CrnaStena", "link": "https://stackoverflow.com/users/1418154/crnastena"}, "edited": false, "score": 0, "creation_date": 1548277726, "post_id": 54335616, "comment_id": 95488617, "body": "yes that should do it. although it might be better to declare mydata as an array."}], "tags": [], "owner": {"reputation": 7701, "user_id": 4242590, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d63ce25a0e288a36cd7df62d0d54a19?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertK", "link": "https://stackoverflow.com/users/4242590/albertk"}, "is_accepted": false, "score": 1, "last_activity_date": 1548277411, "creation_date": 1548277411, "answer_id": 54335616, "question_id": 54335494, "link": "https://stackoverflow.com/questions/54335494/json-post-is-invalid-unless-is-wrapped-in-brackets/54335616#54335616", "title": "Json post is invalid unless is wrapped in brackets", "body": "<p>Try this:</p>\n\n<pre><code>var response = await client.PostAsJsonAsync(requesturi, new[] { mydata } );\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12764, "user_id": 648723, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XMmlf.jpg?s=128&g=1", "display_name": "Arian", "link": "https://stackoverflow.com/users/648723/arian"}, "is_accepted": false, "score": -1, "last_activity_date": 1548277515, "creation_date": 1548277515, "answer_id": 54335638, "question_id": 54335494, "link": "https://stackoverflow.com/questions/54335494/json-post-is-invalid-unless-is-wrapped-in-brackets/54335638#54335638", "title": "Json post is invalid unless is wrapped in brackets", "body": "<p>That's becuase standard of <code>JSON</code>. you should search on the internet first:</p>\n\n<p><a href=\"https://jsonlint.com/\" rel=\"nofollow noreferrer\">https://jsonlint.com/</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/6201529/how-do-i-turn-a-c-sharp-object-into-a-json-string-in-net/6201609\">How do I turn a C# object into a JSON string in .NET?</a></p>\n\n<p><a href=\"https://www.c-sharpcorner.com/article/working-with-json-in-C-Sharp/\" rel=\"nofollow noreferrer\">Working With JSON in C#</a></p>\n"}], "owner": {"reputation": 65, "user_id": 882060, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f0cec8370f1e04282ac1fa5ae4389f3b?s=128&d=identicon&r=PG", "display_name": "John Sheridan", "link": "https://stackoverflow.com/users/882060/john-sheridan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548277515, "creation_date": 1548276942, "last_edit_date": 1548277109, "question_id": 54335494, "link": "https://stackoverflow.com/questions/54335494/json-post-is-invalid-unless-is-wrapped-in-brackets", "title": "Json post is invalid unless is wrapped in brackets", "body": "<p>In my code i send a post to rest service such as:</p>\n\n<pre><code>var response = await client.PostAsJsonAsync(requesturi, mydata);\n</code></pre>\n\n<p>mydata collection is translated to Json   by PostAsJsonAsyn as:</p>\n\n<pre><code>{\n    \"queryid\" : \"GetNames\",\n    \"@StartDate\" : \"1/1/2019\",\n    \"@EndDate\" : \" \"2/1/2019\"\n}\n</code></pre>\n\n<p>However the server return Http 400 reponse unless the jason object is wrapped in brackets (tested in Postman)</p>\n\n<pre><code>[\n   {\n       \"queryid\" : \"GetNames\",\n       \"@StartDate\" : \"1/1/2019\",\n       \"@EndDate\" : \" \"2/1/2019\"\n   }\n]\n</code></pre>\n\n<p>Is there any way to add the brackets to json object passed by PostAsJasonAsyn  method</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c#"], "answers": [{"comments": [{"owner": {"reputation": 1791, "user_id": 2455744, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HLXwn.jpg?s=128&g=1", "display_name": "CBC_NS", "link": "https://stackoverflow.com/users/2455744/cbc-ns"}, "edited": false, "score": 0, "creation_date": 1548277174, "post_id": 54335490, "comment_id": 95488410, "body": "This would work, but the problem is the property who&#39;s value needs obtained is dynamic.  &quot;someProperty&quot; changes.  I&#39;ll add an update for clarity"}, {"owner": {"reputation": 23752, "user_id": 1118978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2rloq.jpg?s=128&g=1", "display_name": "Dervi\u015f Kay\u0131mba\u015f\u0131o\u011flu", "link": "https://stackoverflow.com/users/1118978/dervi%c5%9f-kay%c4%b1mba%c5%9f%c4%b1o%c4%9flu"}, "reply_to_user": {"reputation": 1791, "user_id": 2455744, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HLXwn.jpg?s=128&g=1", "display_name": "CBC_NS", "link": "https://stackoverflow.com/users/2455744/cbc-ns"}, "edited": false, "score": 0, "creation_date": 1548277421, "post_id": 54335490, "comment_id": 95488504, "body": "I updated my answer. please check it and IF you need another update I will do it accordingly"}], "tags": [], "owner": {"reputation": 23752, "user_id": 1118978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2rloq.jpg?s=128&g=1", "display_name": "Dervi\u015f Kay\u0131mba\u015f\u0131o\u011flu", "link": "https://stackoverflow.com/users/1118978/dervi%c5%9f-kay%c4%b1mba%c5%9f%c4%b1o%c4%9flu"}, "is_accepted": true, "score": 2, "last_activity_date": 1548277387, "last_edit_date": 1548277387, "creation_date": 1548276925, "answer_id": 54335490, "question_id": 54335448, "link": "https://stackoverflow.com/questions/54335448/how-to-get-value-from-complex-jobject-c/54335490#54335490", "title": "How to get value from complex JObject? c#", "body": "<p>fastest and easiest way is to use dynamic</p>\n\n<pre><code>dynamic dyn = await GetStep(message.EventId);\nvar myValue = dyn.Document.Process.Data.someProperty ;\n</code></pre>\n\n<p>Alternatively you can use JPath</p>\n\n<pre><code>var process = JObject.Parse(JsonConvert.SerializeObject(myObj));\nJToken acme = o.SelectToken(\"$..someProperty\"); // &lt;-- less safe (multiple matches may occur)\n</code></pre>\n"}], "owner": {"reputation": 1791, "user_id": 2455744, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HLXwn.jpg?s=128&g=1", "display_name": "CBC_NS", "link": "https://stackoverflow.com/users/2455744/cbc-ns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 54335490, "answer_count": 1, "score": 0, "last_activity_date": 1548277387, "creation_date": 1548276758, "last_edit_date": 1548277246, "question_id": 54335448, "link": "https://stackoverflow.com/questions/54335448/how-to-get-value-from-complex-jobject-c", "title": "How to get value from complex JObject? c#", "body": "<p>I'm trying to see if there is an easier way to get a value by property name from JObject.</p>\n\n<p>EDIT: \"someProperty\" in this case is a dynamic string property which changes.  In the below example, the property happens to fall under that token path.</p>\n\n<pre><code>// Convert object to Json, then to JObject\nvar process = JObject.Parse(JsonConvert.SerializeObject(myObj));\n\n// This seems highly uncessary, but it works\nvar myValue = process[\"Document\"][\"Process\"][\"Data\"][\"someProperty\"];\n\n// When I do the following I get null\nvar myValue = process[\"someProperty\"].Value&lt;string&gt;();\n\n// This also returns null\nvar myValue = process.GetValue(\"someProperty\");\n</code></pre>\n"}, {"tags": ["c#", "string", "replace", "string-formatting", "stringbuilder"], "comments": [{"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 0, "creation_date": 1548276976, "post_id": 54335440, "comment_id": 95488332, "body": "There is probably already a library for this, have you searched NuGet or GitHub?"}, {"owner": {"reputation": 828, "user_id": 7667946, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f9fc29466bc93772bc7e90fd2f6d4b1e?s=128&d=identicon&r=PG&f=1", "display_name": "kristech", "link": "https://stackoverflow.com/users/7667946/kristech"}, "edited": false, "score": 0, "creation_date": 1548277176, "post_id": 54335440, "comment_id": 95488411, "body": "String.Replace is an efficient way to go about it. It will not slow the code down at all. I&#39;d say, since that&#39;s what you know, use that. As long as the program works and works efficiently, this should be your goal."}, {"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 1, "creation_date": 1548277668, "post_id": 54335440, "comment_id": 95488589, "body": "<a href=\"https://www.nuget.org/packages/StringTokenFormatter/\" rel=\"nofollow noreferrer\">nuget.org/packages/StringTokenFormatter</a> and <a href=\"https://www.nuget.org/packages/SmartFormat.NET/2.3.1.1\" rel=\"nofollow noreferrer\">nuget.org/packages/SmartFormat.NET/2.3.1.1</a> are 2 that came up in my search. There are probably more..."}], "answers": [{"comments": [{"owner": {"reputation": 2196, "user_id": 3433232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0170269937c80a352c776b4ed5e3c1f7?s=128&d=identicon&r=PG&f=1", "display_name": "basti12354", "link": "https://stackoverflow.com/users/3433232/basti12354"}, "edited": false, "score": 0, "creation_date": 1548277781, "post_id": 54335547, "comment_id": 95488638, "body": "Thanks, do you know if this is more efficient than using replace multiple times? (it&#39;s embarrassing that we have used this wrong ;)"}, {"owner": {"reputation": 3797, "user_id": 3194005, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/500059610/picture?type=large", "display_name": "Derrick Moeller", "link": "https://stackoverflow.com/users/3194005/derrick-moeller"}, "reply_to_user": {"reputation": 2196, "user_id": 3433232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0170269937c80a352c776b4ed5e3c1f7?s=128&d=identicon&r=PG&f=1", "display_name": "basti12354", "link": "https://stackoverflow.com/users/3433232/basti12354"}, "edited": false, "score": 0, "creation_date": 1548277945, "post_id": 54335547, "comment_id": 95488714, "body": "It&#39;s unlikely string building on any scale is going to be a performance issue, it&#39;s certainly going to be many many times faster then the database lookup. I would recommend <code>String.Format</code> because it&#39;s concise and easily readable. I imagine most programmers would prefer to see that over <code>.Replace().Replace().Replace()</code>"}], "tags": [], "owner": {"reputation": 3797, "user_id": 3194005, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/500059610/picture?type=large", "display_name": "Derrick Moeller", "link": "https://stackoverflow.com/users/3194005/derrick-moeller"}, "is_accepted": true, "score": 4, "last_activity_date": 1548279179, "last_edit_date": 1548279179, "creation_date": 1548277176, "answer_id": 54335547, "question_id": 54335440, "link": "https://stackoverflow.com/questions/54335440/should-we-use-string-format-or-string-replace-in-c/54335547#54335547", "title": "Should we use String.format or String.replace in C#?", "body": "<p>You can simply store the string format in the database, the order of the variables doesn't need to be consistent?</p>\n\n<p><strong>SQL Database</strong></p>\n\n<pre><code>\"You have an offer for {0} from {1}. They would pay {2}.\"\n\"{1} would like to buy {0} for {2}.\"\n</code></pre>\n\n<p>You could even leave out arguments if you wanted.</p>\n\n<pre><code>\"{1} would like to buy {0}, they would like to discuss pricing.\"\n</code></pre>\n\n<p><strong>c#</strong></p>\n\n<pre><code>string format = GetStringFromDatabase(someIdentifier);\nstring message = String.Format(format, PlayerName, Offerclub, Offer);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2196, "user_id": 3433232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0170269937c80a352c776b4ed5e3c1f7?s=128&d=identicon&r=PG&f=1", "display_name": "basti12354", "link": "https://stackoverflow.com/users/3433232/basti12354"}, "edited": false, "score": 3, "creation_date": 1548277546, "post_id": 54335622, "comment_id": 95488544, "body": "But we don&#39; t know the strings in our code. We read them from our database.  (Our first attempt was to make a class, with different functions, that gave us back the strings. We used string interpolation. Then we realized that this is no good option, because the users can&#39;t create contents/strings by themselves and we have to update our app every time we create a few more strings in this class.)"}, {"owner": {"reputation": 63, "user_id": 9883178, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211602052982349/picture?type=large", "display_name": "adrianex03", "link": "https://stackoverflow.com/users/9883178/adrianex03"}, "edited": false, "score": 0, "creation_date": 1548277848, "post_id": 54335622, "comment_id": 95488678, "body": "Do you already try storing the data that you read from the DataBase into a variable to then reuse it?"}, {"owner": {"reputation": 7909, "user_id": 202179, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xibo7.jpg?s=128&g=1", "display_name": "Ivan I\u010din", "link": "https://stackoverflow.com/users/202179/ivan-i%c4%8din"}, "reply_to_user": {"reputation": 2196, "user_id": 3433232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0170269937c80a352c776b4ed5e3c1f7?s=128&d=identicon&r=PG&f=1", "display_name": "basti12354", "link": "https://stackoverflow.com/users/3433232/basti12354"}, "edited": false, "score": 0, "creation_date": 1548285307, "post_id": 54335622, "comment_id": 95491435, "body": "@basti12354 this syntax above is just a syntactic sugar for String.Format. So at least don&#39;t downvote it."}, {"owner": {"reputation": 2196, "user_id": 3433232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0170269937c80a352c776b4ed5e3c1f7?s=128&d=identicon&r=PG&f=1", "display_name": "basti12354", "link": "https://stackoverflow.com/users/3433232/basti12354"}, "reply_to_user": {"reputation": 7909, "user_id": 202179, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xibo7.jpg?s=128&g=1", "display_name": "Ivan I\u010din", "link": "https://stackoverflow.com/users/202179/ivan-i%c4%8din"}, "edited": false, "score": 0, "creation_date": 1548286319, "post_id": 54335622, "comment_id": 95491730, "body": "@IvanI\u010din I know. Have you read my question? I think I can not use this syntax in my case, do I? nevertheless the downvote is not from me ;) (He is trying to help me, I see no point to downvote his answear even though I think I can&#39;t use this in my case."}, {"owner": {"reputation": 7909, "user_id": 202179, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xibo7.jpg?s=128&g=1", "display_name": "Ivan I\u010din", "link": "https://stackoverflow.com/users/202179/ivan-i%c4%8din"}, "reply_to_user": {"reputation": 2196, "user_id": 3433232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0170269937c80a352c776b4ed5e3c1f7?s=128&d=identicon&r=PG&f=1", "display_name": "basti12354", "link": "https://stackoverflow.com/users/3433232/basti12354"}, "edited": false, "score": 1, "creation_date": 1548286779, "post_id": 54335622, "comment_id": 95491836, "body": "@basti12354 I&#39;ve read, you asked whether to use String.Format or something else. If String.Format works then this above works too as there it is the same thing just written in different way."}, {"owner": {"reputation": 2196, "user_id": 3433232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0170269937c80a352c776b4ed5e3c1f7?s=128&d=identicon&r=PG&f=1", "display_name": "basti12354", "link": "https://stackoverflow.com/users/3433232/basti12354"}, "reply_to_user": {"reputation": 7909, "user_id": 202179, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/xibo7.jpg?s=128&g=1", "display_name": "Ivan I\u010din", "link": "https://stackoverflow.com/users/202179/ivan-i%c4%8din"}, "edited": false, "score": 0, "creation_date": 1548287519, "post_id": 54335622, "comment_id": 95491994, "body": "@IvanI\u010din Are you sure about that? I import strings from a database, so I dont have a string with quotes. I have something like that string var = GetStringFromDB(); There is no way for me to use string interpolation in this case?"}, {"owner": {"reputation": 63, "user_id": 9883178, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211602052982349/picture?type=large", "display_name": "adrianex03", "link": "https://stackoverflow.com/users/9883178/adrianex03"}, "edited": false, "score": 0, "creation_date": 1564146155, "post_id": 54335622, "comment_id": 100945471, "body": "You can use those strings too     var X = &quot;Hello&quot;"}], "tags": [], "owner": {"reputation": 63, "user_id": 9883178, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211602052982349/picture?type=large", "display_name": "adrianex03", "link": "https://stackoverflow.com/users/9883178/adrianex03"}, "is_accepted": false, "score": -1, "last_activity_date": 1548277445, "creation_date": 1548277445, "answer_id": 54335622, "question_id": 54335440, "link": "https://stackoverflow.com/questions/54335440/should-we-use-string-format-or-string-replace-in-c/54335622#54335622", "title": "Should we use String.format or String.replace in C#?", "body": "<p>There's a better and easy way to make those strings. You can try using this example:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>string result = $\"{value1} blalbal...- {value2}blabla... {value3}\";\n</code></pre>\n\n<p>This \"$\" symbol allows you to insert the variables directly.</p>\n"}], "owner": {"reputation": 2196, "user_id": 3433232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0170269937c80a352c776b4ed5e3c1f7?s=128&d=identicon&r=PG&f=1", "display_name": "basti12354", "link": "https://stackoverflow.com/users/3433232/basti12354"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 1, "accepted_answer_id": 54335547, "answer_count": 2, "score": 2, "last_activity_date": 1548279179, "creation_date": 1548276720, "question_id": 54335440, "link": "https://stackoverflow.com/questions/54335440/should-we-use-string-format-or-string-replace-in-c", "title": "Should we use String.format or String.replace in C#?", "body": "<p>we are trying to create a app that shows the user messages.\nHere are some example messages:</p>\n\n<ul>\n<li>\"You have an offer for {PlayerName} from {Offerclub}. They would pay {Offer}\".</li>\n<li>\"{Offerclub} would like to buy {Playername} for {Offer}\".</li>\n</ul>\n\n<p>We are getting these strings from our database.\n(Our first attempt was to make a class, with different functions, that gave us back the strings. We used string interpolation. Then we realized that this is no good option, because the users can't create contents/strings by themselves and we have to update our app every time we create a few more strings in this class.)</p>\n\n<p>The options we know:</p>\n\n<ol>\n<li><p>String.format: something like that: </p>\n\n<p>string result = string.Format(\"{1} blalbal...- {2}blabla... {3}\", value1, value2, value3);</p></li>\n</ol>\n\n<p>The problem here: We want to use strings with different positions of the input like in our examples. Sometimes the first one is the playername, sometimes it is the clubname...</p>\n\n<ol start=\"2\">\n<li>String.replace: We thought about fixed placeholder names and would then use replace to make our changes.</li>\n<li>String Builder: We thought to simply concenate our strings. We would first read them from the database and use String.split to create an array of the strings.</li>\n</ol>\n\n<p>Questions:</p>\n\n<ul>\n<li>Are there better options? (We are talking about some messages. Maybe a few hundred messages in the worst case) We would prefer to use String.replace because it sounds like the easiest solution.</li>\n</ul>\n"}, {"tags": ["c#", "winforms", "printing"], "comments": [{"owner": {"reputation": 387, "user_id": 2052524, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9a27f6e90e0363a28e6d92c5c317bdcf?s=128&d=identicon&r=PG", "display_name": "bmurrell30", "link": "https://stackoverflow.com/users/2052524/bmurrell30"}, "reply_to_user": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 0, "creation_date": 1548425477, "post_id": 54335420, "comment_id": 95547760, "body": "tag deleted. my mistake."}], "answers": [{"tags": [], "owner": {"reputation": 387, "user_id": 2052524, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9a27f6e90e0363a28e6d92c5c317bdcf?s=128&d=identicon&r=PG", "display_name": "bmurrell30", "link": "https://stackoverflow.com/users/2052524/bmurrell30"}, "is_accepted": true, "score": 0, "last_activity_date": 1548688433, "creation_date": 1548688433, "answer_id": 54404912, "question_id": 54335420, "link": "https://stackoverflow.com/questions/54335420/how-can-i-print-a-tabcontrol-page-in-winforms/54404912#54404912", "title": "How can I print a TabControl page in Winforms?", "body": "<p>Turns out this was a PEBKAC error: I had added the PrintDocument object to my form, but I had neglected to actually wire up the PrintPage event within the PrintDocument. Once I did that, the form printed correctly.</p>\n"}], "owner": {"reputation": 387, "user_id": 2052524, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9a27f6e90e0363a28e6d92c5c317bdcf?s=128&d=identicon&r=PG", "display_name": "bmurrell30", "link": "https://stackoverflow.com/users/2052524/bmurrell30"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 54404912, "answer_count": 1, "score": 0, "last_activity_date": 1548688433, "creation_date": 1548276642, "last_edit_date": 1548425460, "question_id": 54335420, "link": "https://stackoverflow.com/questions/54335420/how-can-i-print-a-tabcontrol-page-in-winforms", "title": "How can I print a TabControl page in Winforms?", "body": "<p>I'm trying to print the selected page of a winforms tabcontrol, but no matter what I do all I get is a blank page.</p>\n\n<p>I have this code to capture and print a screenshot of a windows form using a PrintDocument control; I'd like to do something similar to this.</p>\n\n<pre><code>    private void CaptureScreen()\n    {\n        Graphics myGraphics = this.CreateGraphics();\n        Size s = this.Size;\n        memoryImage = new Bitmap(s.Width, s.Height, myGraphics);\n        Graphics memoryGraphics = Graphics.FromImage(memoryImage);\n        memoryGraphics.CopyFromScreen(this.Location.X, this.Location.Y, 0, 0, s);\n    }\n\n    private void printDocument1_PrintPage(object sender, PrintPageEventArgs e)\n    {\n        Bitmap newImage = new Bitmap(memoryImage, new Size(Convert.ToInt32(memoryImage.Width / 1.25), Convert.ToInt32(memoryImage.Height / 1.25)));\n        newImage.RotateFlip(RotateFlipType.Rotate90FlipNone);\n        e.Graphics.DrawImage(newImage, 0, 0);\n    }\n\n    private void printBtn_Click(object sender, EventArgs e)\n    {\n        PrintDialog myPrintDialog = new PrintDialog();\n        if (myPrintDialog.ShowDialog() == DialogResult.OK)\n        {\n            CaptureScreen();\n            printDocument1.Print();\n        }\n    }  \n</code></pre>\n\n<p>I have tried changing the object referenced in the CaptureScreen function to the tab page, as opposed to the overall windows form; I've tried figuring out how to use the PrintDialog object's \"PrintVisual\" function, but that only seems to work in WPF projects, which this isn't. Does anyone know how to make this work?</p>\n"}, {"tags": ["c#", "image-processing"], "comments": [{"owner": {"reputation": 20047, "user_id": 166452, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/I26rB.jpg?s=128&g=1", "display_name": "Ignacio Soler Garcia", "link": "https://stackoverflow.com/users/166452/ignacio-soler-garcia"}, "edited": false, "score": 0, "creation_date": 1548276584, "post_id": 54335391, "comment_id": 95488202, "body": "The file format probably does not support these numbers of indexed colours so that&#39;s why you can&#39;t do that."}, {"owner": {"reputation": 3, "user_id": 10461927, "user_type": "registered", "profile_image": "https://graph.facebook.com/1886262588123366/picture?type=large", "display_name": "Caio Cabral", "link": "https://stackoverflow.com/users/10461927/caio-cabral"}, "reply_to_user": {"reputation": 20047, "user_id": 166452, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/I26rB.jpg?s=128&g=1", "display_name": "Ignacio Soler Garcia", "link": "https://stackoverflow.com/users/166452/ignacio-soler-garcia"}, "edited": false, "score": 0, "creation_date": 1548276927, "post_id": 54335391, "comment_id": 95488322, "body": "I only what to convert the image to an another image with the number of colors I want and the PixelFormat have to be indexed"}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1548280654, "post_id": 54335391, "comment_id": 95489886, "body": "Can you please re-write this with proper grammar and terminology?"}, {"owner": {"reputation": 3, "user_id": 10461927, "user_type": "registered", "profile_image": "https://graph.facebook.com/1886262588123366/picture?type=large", "display_name": "Caio Cabral", "link": "https://stackoverflow.com/users/10461927/caio-cabral"}, "edited": false, "score": 0, "creation_date": 1548353242, "post_id": 54335391, "comment_id": 95521000, "body": "Sorry, I&#39;m brazilian and I&#39;m learning how to speak in english too.."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10461927, "user_type": "registered", "profile_image": "https://graph.facebook.com/1886262588123366/picture?type=large", "display_name": "Caio Cabral", "link": "https://stackoverflow.com/users/10461927/caio-cabral"}, "edited": false, "score": 0, "creation_date": 1548353218, "post_id": 54336616, "comment_id": 95520988, "body": "Is too hard.. :("}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "reply_to_user": {"reputation": 3, "user_id": 10461927, "user_type": "registered", "profile_image": "https://graph.facebook.com/1886262588123366/picture?type=large", "display_name": "Caio Cabral", "link": "https://stackoverflow.com/users/10461927/caio-cabral"}, "edited": false, "score": 0, "creation_date": 1548353441, "post_id": 54336616, "comment_id": 95521098, "body": "There are <a href=\"https://www.codeproject.com/Articles/66341/A-Simple-Yet-Quite-Powerful-Palette-Quantizer-in-C\" rel=\"nofollow noreferrer\">examples</a> available."}, {"owner": {"reputation": 3, "user_id": 10461927, "user_type": "registered", "profile_image": "https://graph.facebook.com/1886262588123366/picture?type=large", "display_name": "Caio Cabral", "link": "https://stackoverflow.com/users/10461927/caio-cabral"}, "edited": false, "score": 0, "creation_date": 1549474132, "post_id": 54336616, "comment_id": 95918150, "body": "Thanks So Much @NetMage DistinctSelectionQuantizer Work for me! I using Unity3D, and work very well!"}], "tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": true, "score": 0, "last_activity_date": 1548282213, "creation_date": 1548282213, "answer_id": 54336616, "question_id": 54335391, "link": "https://stackoverflow.com/questions/54335391/how-can-i-change-a-bitmap-image-to-x-count-of-colors-indexed-in-image/54336616#54336616", "title": "How can I change a bitmap image to &quot;X&quot; count of colors indexed in image", "body": "<p>I don't believe Windows has any <a href=\"https://en.wikipedia.org/wiki/Color_quantization\" rel=\"nofollow noreferrer\">color quantization</a> algorithms included - you would have to implement one yourself, such as <a href=\"http://www.ece.mcmaster.ca/~xwu/cq.c\" rel=\"nofollow noreferrer\">Wu's algorithm</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 10461927, "user_type": "registered", "profile_image": "https://graph.facebook.com/1886262588123366/picture?type=large", "display_name": "Caio Cabral", "link": "https://stackoverflow.com/users/10461927/caio-cabral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 54336616, "answer_count": 1, "score": 0, "last_activity_date": 1548353399, "creation_date": 1548276469, "last_edit_date": 1548353399, "question_id": 54335391, "link": "https://stackoverflow.com/questions/54335391/how-can-i-change-a-bitmap-image-to-x-count-of-colors-indexed-in-image", "title": "How can I change a bitmap image to &quot;X&quot; count of colors indexed in image", "body": "<p>I'm developing an application that crops an image to a width and height people can change, but I want it can save the image with the number of colors people want, for example: I pick an image .png, crop to 102x96 and then save with the number of indexed colors I want.</p>\n\n<p>I have tried a lot of things, but I can't save with the number of colors I want.. I only can save in an indexed default format like 1bpp, 4bpp or 8bpp.</p>\n\n<pre><code>//this function will save the image\npublic void SaveFile()\n{\n\n    string extensions = \"png\";\n\n    string path = FileBrowser.SaveFile(\"Save File\", \"\", \"MyFile\", extensions);\n\n    Debug.Log(\"Save file: \" + path);\npathz = path;\n\nSystem.Drawing.Image.GetThumbnailImageAbort callback =\n new System.Drawing.Image.GetThumbnailImageAbort(ThumbnailCallback);\nSystem.Drawing.Bitmap image = new Bitmap(pathh);\n//Bitmap clone = image.Clone(new Rectangle(0, 0, image.Width, image.Height), PixelFormat.Format8bppIndexed);\n//here I crop the file\nSystem.Drawing.Image pThumbnail = image.GetThumbnailImage(int.Parse(x.text), int.Parse(y.text), callback, new System.IntPtr());\n\n\nBitmap xx = pThumbnail.Clone() as Bitmap;\n    //here I save\nxx.Save(pathz);\n\n  // this place is the way I tried to put it in indexed color\n // Bitmap Result = xx.Clone(new System.Drawing.Rectangle(0, 0, xx.Width, xx.Height), System.Drawing.Imaging.PixelFormat.Format8bppIndexed);\n// Bitmap Result2 = Result.Clone(new System.Drawing.Rectangle(0, 0, xx.Width, xx.Height), System.Drawing.Imaging.PixelFormat.Format8bppIndexed);\n\n}\n</code></pre>\n\n<p>The final file was saved with the crop, but I can't make this final image with e.g. 32 colors, or 64 colors, or 16 colors.</p>\n"}, {"tags": ["c#", "excel", "xml", "ms-access", "connection"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548277514, "post_id": 54335367, "comment_id": 95488534, "body": "Exactly how did you make the connection?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548277728, "post_id": 54335367, "comment_id": 95488619, "body": "<code>xl&#47;connections.xml</code> has the connection information"}, {"owner": {"reputation": 949, "user_id": 5533446, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e92f23f6811a8faa0911c3406f28403b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnG79", "link": "https://stackoverflow.com/users/5533446/johng79"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1548279059, "post_id": 54335367, "comment_id": 95489210, "body": "thanks @TimWilliams. There is no file path information there, or in any of the xml files, but Excel complains if I move it; moreover, when I  go to the &quot;Advanced Editor&quot; via the &quot;Power Query Editor&quot; I see the file path there! There is however a huge string of letters, numbers and symbols in customxml/item1.xml could this contain the information encoded?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1548287168, "post_id": 54335367, "comment_id": 95491928, "body": "OK - that sounds like Power Pivot (which I don&#39;t have installed).  I tested using &quot;Data &gt;&gt; From Access&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 949, "user_id": 5533446, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e92f23f6811a8faa0911c3406f28403b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnG79", "link": "https://stackoverflow.com/users/5533446/johng79"}, "is_accepted": false, "score": 0, "last_activity_date": 1548381289, "creation_date": 1548381289, "answer_id": 54357965, "question_id": 54335367, "link": "https://stackoverflow.com/questions/54335367/programmatically-obtain-connection-parameters-to-connected-database-in-excel-fil/54357965#54357965", "title": "Programmatically obtain connection parameters to connected database in Excel Files", "body": "<p>Crediting this to my work colleagues and their research and dev work:</p>\n\n<p><em>\" Microsoft Excel 2016 has a new, built-in functionality called \"Get &amp; Transform\". It is also known as PowerQuery.\n It suppports a) querying data from files, databases, web services &amp; custom sources and b) transforming these.\n Also, because it can combine data from multiple sources, it is called Mashups. \n While the user typically specifies this in easy to use user interface, the source, query and transformations\n are stored in form of a new programming language called M.\"</em></p>\n\n<p>We have found the filepath in the form of 'M', and encoded in <code>customxml/item1.xml</code>, and we can obtain and edit it programmatically.</p>\n"}], "owner": {"reputation": 949, "user_id": 5533446, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e92f23f6811a8faa0911c3406f28403b?s=128&d=identicon&r=PG&f=1", "display_name": "JohnG79", "link": "https://stackoverflow.com/users/5533446/johng79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594026769, "creation_date": 1548276369, "last_edit_date": 1594026769, "question_id": 54335367, "link": "https://stackoverflow.com/questions/54335367/programmatically-obtain-connection-parameters-to-connected-database-in-excel-fil", "title": "Programmatically obtain connection parameters to connected database in Excel Files", "body": "<ul>\n<li>I have connected to data in an Access database file table </li>\n<li>I can see the path to the Access database file from within Excel's Advanced editor.</li>\n<li>I cannot find this information manually searching the xml files from the unzipped excel workbook file.</li>\n</ul>\n\n<p>(btw, I created the connection via: Data (tab) -> Get and Transform Data (Section) -> Get Data (Button) -> From Database -> From Microsoft Access Database.</p>\n\n<p><strong>How/Where is this Access database <em>file path</em> information stored?</strong></p>\n\n<p><strong>How can I obtain(/edit) this <em>Access database file path</em> information programmatically; namely in C#?</strong></p>\n\n<p>When unzipping the workbook, I cannot find the file path anywhere; for example: in xl/connections.xml there is:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\r\n&lt;connections xmlns:xr16=\"http://schemas.microsoft.com/office/spreadsheetml/2017/revision16\" mc:Ignorable=\"xr16\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"&gt;\r\n&lt;connection id=\"1\" saveData=\"1\" background=\"1\" refreshedVersion=\"6\" type=\"5\" description=\"Connection to the 'Qry_PagesByProject' query in the workbook.\" name=\"Query - Qry_PagesByProject\" keepAlive=\"1\" xr16:uid=\"{97DDFE32-F190-4840-8AD9-C2456C0D5FAF}\"&gt;\r\n&lt;dbPr command=\"SELECT * FROM [Qry_PagesByProject]\" connection=\"Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=Qry_PagesByProject;Extended Properties=\"\"\"/&gt;\r\n&lt;/connection&gt;\r\n&lt;/connections&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>...but no mention of the Access database file path.</p>\n\n<ul>\n<li>If I move the Access database file, the workbook then complains and cannot update the data in the worksheet.</li>\n</ul>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c#", "clr", "autofac"], "comments": [{"owner": {"reputation": 619, "user_id": 2623538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhR1w.jpg?s=128&g=1", "display_name": "NaDeR Star", "link": "https://stackoverflow.com/users/2623538/nader-star"}, "edited": false, "score": 0, "creation_date": 1548276893, "post_id": 54335221, "comment_id": 95488312, "body": "It Causes when compiling 64 bit project and use it from a 32 bit environment.Check your IIS and project to be same 64 or 32, update your application to .net 4.0 or 4.5 because that exception is obsolete and check it you are not using unmanaged library, check threadpool objects and try to disable concurrent garbage collection, at all it&#39;s thrown when a fatal error detecting in  execution of clr... and don&#39;t blame me for my bad english"}, {"owner": {"reputation": 3477, "user_id": 7232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d22d8454d54ce0e8e04840b6eeb1b79f?s=128&d=identicon&r=PG", "display_name": "camainc", "link": "https://stackoverflow.com/users/7232/camainc"}, "reply_to_user": {"reputation": 619, "user_id": 2623538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhR1w.jpg?s=128&g=1", "display_name": "NaDeR Star", "link": "https://stackoverflow.com/users/2623538/nader-star"}, "edited": false, "score": 0, "creation_date": 1548277959, "post_id": 54335221, "comment_id": 95488721, "body": "@NaDeRStar thanks for the advice. I would never blame you for bad English, I&#39;m sure your English is better than my Farsi :-)  I&#39;m using .Net 4.6.2 in all projects, I have my web startup project set to use IIS 64 bit, and I&#39;m running on a 64 bit OS (Windows 10)."}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 1, "creation_date": 1550526957, "post_id": 54335221, "comment_id": 96293428, "body": "If you found a solution to the problem, please place it as an answer in the form below, rather than inside the question."}, {"owner": {"reputation": 3477, "user_id": 7232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d22d8454d54ce0e8e04840b6eeb1b79f?s=128&d=identicon&r=PG", "display_name": "camainc", "link": "https://stackoverflow.com/users/7232/camainc"}, "edited": false, "score": 0, "creation_date": 1550595099, "post_id": 54335221, "comment_id": 96322521, "body": "Thanks E_net4. Done."}], "answers": [{"tags": [], "owner": {"reputation": 3477, "user_id": 7232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d22d8454d54ce0e8e04840b6eeb1b79f?s=128&d=identicon&r=PG", "display_name": "camainc", "link": "https://stackoverflow.com/users/7232/camainc"}, "is_accepted": true, "score": 0, "last_activity_date": 1550595071, "creation_date": 1550595071, "answer_id": 54771212, "question_id": 54335221, "link": "https://stackoverflow.com/questions/54335221/system-executionengineexception-in-dbcontext-constructor/54771212#54771212", "title": "System.ExecutionEngineException in DBContext Constructor", "body": "<p>This came down to a known bug in the CLR and is scheduled to be fixed in 4.8 framework build. The workaround was to add the following to my Machine.config file:</p>\n\n<pre><code>&lt;configuration&gt;\n        &lt;runtime&gt;\n          &lt;disableNativeImageLoad&gt;\n            &lt;assemblyIdentity name=\"netstandard\" /&gt;\n          &lt;/disableNativeImageLoad&gt;\n        &lt;/runtime&gt;\n    &lt;/configuration&gt;\n</code></pre>\n\n<p><a href=\"https://github.com/dotnet/coreclr/issues/22137\" rel=\"nofollow noreferrer\">https://github.com/dotnet/coreclr/issues/22137</a></p>\n"}], "owner": {"reputation": 3477, "user_id": 7232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d22d8454d54ce0e8e04840b6eeb1b79f?s=128&d=identicon&r=PG", "display_name": "camainc", "link": "https://stackoverflow.com/users/7232/camainc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 54771212, "answer_count": 1, "score": -1, "last_activity_date": 1550595071, "creation_date": 1548275694, "last_edit_date": 1550526891, "question_id": 54335221, "link": "https://stackoverflow.com/questions/54335221/system-executionengineexception-in-dbcontext-constructor", "title": "System.ExecutionEngineException in DBContext Constructor", "body": "<p>I know this is a very vague error, but I've posted on the EF Core and CLR git repositories, and they have no idea. I wonder if this might have something to do with dependency injection (I'm using AutoFac).</p>\n\n<p>The error happens about every other time I start a new debugging session. It happens in the constructor of my class which inherits from DbContext, when I am passing the DbContextOptions down to the base.</p>\n\n<p><strong>Exception:</strong></p>\n\n<p>Exception Type: System.ExecutionEngineException</p>\n\n<p>Exception Message=\"Exception of type 'System.ExecutionEngineException' was thrown.\"</p>\n\n<p>Stack trace: Empty</p>\n\n<pre><code>protected WinsDbContextBase(DbContextOptions options, ICurrentUserContext userContext)\n    : base(options) &lt;=== the error occurs on this line\n    {\n... other code here ...\n    }\n</code></pre>\n\n<p>I know this is not really enough to go on, but I'm posting this here in hopes that maybe someone else has experienced this and can give me a clue as to where to start digging. </p>\n\n<p><strong>Edit:</strong> This came down to a known bug in the CLR and is scheduled to be fixed in 4.8 framework build. The workaround was to add the following to my Machine.config file:</p>\n\n<pre><code>&lt;configuration&gt;\n        &lt;runtime&gt;\n          &lt;disableNativeImageLoad&gt;\n            &lt;assemblyIdentity name=\"netstandard\" /&gt;\n          &lt;/disableNativeImageLoad&gt;\n        &lt;/runtime&gt;\n    &lt;/configuration&gt;\n</code></pre>\n\n<p><a href=\"https://github.com/dotnet/coreclr/issues/22137\" rel=\"nofollow noreferrer\">https://github.com/dotnet/coreclr/issues/22137</a></p>\n"}, {"tags": ["c#", "microsoft-graph-api", "microsoft-teams"], "comments": [{"owner": {"reputation": 27872, "user_id": 105518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e47ca9372faad8084cbaf9f90c6a75?s=128&d=identicon&r=PG", "display_name": "Marc LaFleur", "link": "https://stackoverflow.com/users/105518/marc-lafleur"}, "edited": false, "score": 0, "creation_date": 1548276441, "post_id": 54335179, "comment_id": 95488132, "body": "Have you gone through Admin Consent for these scopes?"}, {"owner": {"reputation": 123, "user_id": 2494444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac63000995c9d3e0148e816f1704fde8?s=128&d=identicon&r=PG", "display_name": "user2494444", "link": "https://stackoverflow.com/users/2494444/user2494444"}, "reply_to_user": {"reputation": 27872, "user_id": 105518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e47ca9372faad8084cbaf9f90c6a75?s=128&d=identicon&r=PG", "display_name": "Marc LaFleur", "link": "https://stackoverflow.com/users/105518/marc-lafleur"}, "edited": false, "score": 0, "creation_date": 1548276887, "post_id": 54335179, "comment_id": 95488311, "body": "Hi Marc, thanks for quick reply. Can you please elaborate on your comment. Bit confused about Admin Consent here. Where do I set this? Any documentation to understand this better?"}], "answers": [{"comments": [{"owner": {"reputation": 27872, "user_id": 105518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e47ca9372faad8084cbaf9f90c6a75?s=128&d=identicon&r=PG", "display_name": "Marc LaFleur", "link": "https://stackoverflow.com/users/105518/marc-lafleur"}, "reply_to_user": {"reputation": 123, "user_id": 2494444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac63000995c9d3e0148e816f1704fde8?s=128&d=identicon&r=PG", "display_name": "user2494444", "link": "https://stackoverflow.com/users/2494444/user2494444"}, "edited": false, "score": 1, "creation_date": 1548281044, "post_id": 54335753, "comment_id": 95490060, "body": "I&#39;m glad to hear it. If this answer helped, be and mark it as the answer so future readers know what worked and what didn&#39;t."}, {"owner": {"reputation": 123, "user_id": 2494444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac63000995c9d3e0148e816f1704fde8?s=128&d=identicon&r=PG", "display_name": "user2494444", "link": "https://stackoverflow.com/users/2494444/user2494444"}, "edited": false, "score": 0, "creation_date": 1548290429, "post_id": 54335753, "comment_id": 95492580, "body": "I think my settings were fine, just that i added new permissions that required fresh sign in and fresh consent!"}], "tags": [], "owner": {"reputation": 27872, "user_id": 105518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e47ca9372faad8084cbaf9f90c6a75?s=128&d=identicon&r=PG", "display_name": "Marc LaFleur", "link": "https://stackoverflow.com/users/105518/marc-lafleur"}, "is_accepted": false, "score": 2, "last_activity_date": 1548278088, "creation_date": 1548278088, "answer_id": 54335753, "question_id": 54335179, "link": "https://stackoverflow.com/questions/54335179/call-to-ms-teams-graph-api-from-bot-code-results-in-403-request-forbidden/54335753#54335753", "title": "Call to MS Teams Graph API from bot code results in 403 Request Forbidden", "body": "<p>Before you can use certain permission scopes, you need to first obtain \"Admin Consent\". Note that this is a different process than the \"User Consent\". Admin Consent precedes User Consent and is effectively an Administrator saying \"sure, users in my tenant can accept the scopes your app is asking for\". You may find this article on <a href=\"https://massivescale.com/microsoft-v2-endpoint-user-vs-admin/\" rel=\"nofollow noreferrer\">understanding the difference between User and Admin Consent</a> helpful. </p>\n\n<p>How you execute Admin Consent depends a bit on your application. If you're a multi-tenant app (i.e. your app gets used by different organizations) then you need to provide a specific URI to each tenant's Admin to kick off the process. For this process, I'd suggest taking a look at <a href=\"https://massivescale.com/microsoft-v2-endpoint-admin-consent/\" rel=\"nofollow noreferrer\">Obtaining Administrative Consent for your application</a>.</p>\n\n<p>If you're a single-tenant application (i.e. an internal enterprise app) then things are a little simpler. The tenant Admin can simply click the \"Grant consent\" option from the application registration page in the <a href=\"https://ms.portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredAppsPreview\" rel=\"nofollow noreferrer\">Azure portal</a> (it's found on the \"API Permissions\" page for your app). </p>\n"}], "owner": {"reputation": 123, "user_id": 2494444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac63000995c9d3e0148e816f1704fde8?s=128&d=identicon&r=PG", "display_name": "user2494444", "link": "https://stackoverflow.com/users/2494444/user2494444"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548278088, "creation_date": 1548275508, "last_edit_date": 1548276401, "question_id": 54335179, "link": "https://stackoverflow.com/questions/54335179/call-to-ms-teams-graph-api-from-bot-code-results-in-403-request-forbidden", "title": "Call to MS Teams Graph API from bot code results in 403 Request Forbidden", "body": "<p>I have a bot with Cortana channel added to it. I have configured Cortana connected account to get access token to Graph APIs. My bot code is using this token to call MS Teams APIs. </p>\n\n<p>Cortana properly invokes my skill bot and prompts for user sign in. After a successful sign in, I have verified in the code that I am getting access token. Using this token, when my bot code makes a call to <code>https://graph.microsoft.com/v1.0/me/joinedTeams</code>, I get the response: </p>\n\n<pre><code>{\n  StatusCode: 403, \n  ReasonPhrase: 'Forbidden', \n  Version: 1.1, \n  Content: System.Net.Http.StreamContent, \n  Headers: {  \n      Transfer-Encoding: chunked  \n      request-id: b1f83dda-1ce4-4660-9950-d890123f5b27  \n      client-request-id: b1f83dda-1ce4-4660-9950-d890123f5b27  \n      x-ms-ags-diagnostic: {\n          \"ServerInfo\":{\n              \"DataCenter\":\"West US\",\n              \"Slice\":\"SliceC\",\n              \"Ring\":\"5\",\n              \"ScaleUnit\":\"003\",\n              \"Host\":\"AGSFE_IN_4\",\n              \"ADSiteName\":\"WUS\"\n            }\n        }  \n        Duration: 43.0296  \n        Strict-Transport-Security: max-age=31536000  \n        Cache-Control: private  \n        Date: Wed, 23 Jan 2019 20:13:33 GMT  \n        Content-Type: application/json\n    }\n}\n</code></pre>\n\n<p>I have set following permissions in the scope of Cortana channel Oauth Settings as well as in-app in the Azure portal:</p>\n\n<ul>\n<li><code>Mail.Read</code> </li>\n<li><code>Mail.Send</code> </li>\n<li><code>openid</code> </li>\n<li><code>profile</code> </li>\n<li><code>User.Read</code> </li>\n<li><code>User.ReadBasic.All</code> </li>\n<li><code>User.Read.All</code> </li>\n<li><code>User.ReadWrite.All</code> </li>\n<li><code>Group.Read.All</code> </li>\n<li><code>Group.ReadWrite.All</code> (Delegated + Application)</li>\n</ul>\n\n<p>The same call through graph explorer with same sign in credentials returns me a list of my joined Teams. </p>\n\n<p>What am I missing here? How do I debug this further?</p>\n\n<p><a href=\"https://i.stack.imgur.com/eNXxJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eNXxJ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c#", "list"], "comments": [{"owner": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 0, "creation_date": 1548275531, "post_id": 54335147, "comment_id": 95487766, "body": "You&#39;ve laid out the requirements, but what&#39;s your actual question? What are you having trouble with?"}, {"owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "edited": false, "score": 0, "creation_date": 1548275719, "post_id": 54335147, "comment_id": 95487846, "body": "In your example, there are three 0s in a row (indices 2, 3, and 4). Does this mean you add 100+200 (indices 2 and 3) and 200+100 (indices 3 and 4)? Or are you supposed to add all three together?"}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "reply_to_user": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "edited": false, "score": 1, "creation_date": 1548276534, "post_id": 54335147, "comment_id": 95488176, "body": "@Forty3 The sample outputs are hidden right at the end of the code sample."}, {"owner": {"reputation": 45, "user_id": 6582754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d55fe0a04c400f67d867984b168ac164?s=128&d=identicon&r=PG&f=1", "display_name": "AutoEng", "link": "https://stackoverflow.com/users/6582754/autoeng"}, "reply_to_user": {"reputation": 4114, "user_id": 2957232, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/XicNR.jpg?s=128&g=1", "display_name": "Broots Waymb", "link": "https://stackoverflow.com/users/2957232/broots-waymb"}, "edited": false, "score": 0, "creation_date": 1548277765, "post_id": 54335147, "comment_id": 95488630, "body": "@BrootsWaymb, There are two lists. One has elements 1,1,0,0,0,1 and the second list as elements 200,300,100,200,100,350. I have to compare the list1 element at index with the next index element. if they are same then add elements at same indexes in list 2 and save in some other list. input list and output list are there in code section at top and bottom."}, {"owner": {"reputation": 45, "user_id": 6582754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d55fe0a04c400f67d867984b168ac164?s=128&d=identicon&r=PG&f=1", "display_name": "AutoEng", "link": "https://stackoverflow.com/users/6582754/autoeng"}, "reply_to_user": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "edited": false, "score": 0, "creation_date": 1548278451, "post_id": 54335147, "comment_id": 95488937, "body": "@Forty3 all three together"}, {"owner": {"reputation": 45, "user_id": 6582754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d55fe0a04c400f67d867984b168ac164?s=128&d=identicon&r=PG&f=1", "display_name": "AutoEng", "link": "https://stackoverflow.com/users/6582754/autoeng"}, "edited": false, "score": 0, "creation_date": 1548279200, "post_id": 54335147, "comment_id": 95489280, "body": "Sorry for that, this will require me to install package which if at all I do for getting this result its ok for now. But this small piece of code integrates and runs in a large code across the globe on different PC so it has to be always backward compatible."}, {"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548281367, "post_id": 54335147, "comment_id": 95490160, "body": "You could always copy the MoreLINQ code into your project if you want to avoid referencing the DLL. <a href=\"https://github.com/morelinq/MoreLINQ/blob/master/MoreLinq/GroupAdjacent.cs\" rel=\"nofollow noreferrer\">github.com/morelinq/MoreLINQ/blob/master/MoreLinq/&hellip;</a> I&#39;ll leave it with you to decide on the licensing implications of that decision. Thanks for the upvote!"}], "answers": [{"tags": [], "owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "is_accepted": false, "score": 0, "last_activity_date": 1548276196, "last_edit_date": 1592644375, "creation_date": 1548276196, "answer_id": 54335328, "question_id": 54335147, "link": "https://stackoverflow.com/questions/54335147/compare-a-element-and-next-element-in-a-list-if-they-are-same-then-add-correspo/54335328#54335328", "title": "compare a element and next element in a list, if they are same then add corresponding index elements value in second list", "body": "<p>If you are willing to use <a href=\"https://www.nuget.org/packages/morelinq/\" rel=\"nofollow noreferrer\">MoreLinq</a>, I'd suggest starting with:</p>\n<pre><code>var result = signalTrans.Zip(time, (signalEntry, timeEntry) =&gt; new { signalEntry, timeEntry })\n    .GroupAdjacent(z =&gt; z.signalEntry)\n    .Select(z =&gt; new { signal = z.Key, totalTime = z.Sum(y =&gt; y.timeEntry) });\n\nvar indexes = result.Select(z =&gt; z.signal).ToList();\nvar totalTimes = result.Select(z =&gt; z.totalTime).ToList();\n</code></pre>\n<p><code>Zip</code>is used to zip together the two lists together - so you have an <code>IEnumerable</code> of an anonymous type containing data from both lists.\n<code>GroupAdjacent</code> then groups together adjacent entries from <code>signalTrans</code>.\n<code>Sum</code> then adds up the <code>time</code> entries.</p>\n<p>This results in the output you specify in your question:</p>\n<blockquote>\n<p>output list1 -&gt; 1,0,1</p>\n<p>output list2 -&gt; 500,400,350</p>\n</blockquote>\n"}], "owner": {"reputation": 45, "user_id": 6582754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d55fe0a04c400f67d867984b168ac164?s=128&d=identicon&r=PG&f=1", "display_name": "AutoEng", "link": "https://stackoverflow.com/users/6582754/autoeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1548276196, "creation_date": 1548275397, "question_id": 54335147, "link": "https://stackoverflow.com/questions/54335147/compare-a-element-and-next-element-in-a-list-if-they-are-same-then-add-correspo", "title": "compare a element and next element in a list, if they are same then add corresponding index elements value in second list", "body": "<p>There are two lists. One has elements 1,1,0,0,0,1 and the second list as elements 200,300,100,200,100,350. I have to compare the list1 element at index with the next index element. if they are same then add elements at same indexes in list 2 and save in some other list. </p>\n\n<pre><code>input list1 -&gt; 1,1,0,0,0,1\ninput list2 -&gt; 200,300,100,200,100,350\n\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace ConsoleApplication1\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n            List&lt;int&gt; signalTrans = new List&lt;int&gt;();\n            List&lt;double&gt; time = new List&lt;double&gt;();\n\n            List&lt;double&gt; timeSorted = new List&lt;double&gt;();\n            List&lt;int&gt; signalTransSorted = new List&lt;int&gt;();\n\n            signalTrans.Add(1);\n            signalTrans.Add(1);\n            signalTrans.Add(0);\n            signalTrans.Add(0);\n            signalTrans.Add(0);\n            signalTrans.Add(1);\n\n            time.Add(200);\n            time.Add(300);\n            time.Add(100);\n            time.Add(200);\n            time.Add(100);\n            time.Add(350);\n\n            int i;\n            double k;\n\n            for (i = 0; i &lt; signalTrans.Count(); i++)\n            {\n                if ((i + 1) &lt; signalTrans.Count())\n                {\n                    if (signalTrans[i + 1] == signalTrans[i])\n                    {\n                        k = time[i + 1] + time[i];\n                        signalTransSorted.Add(signalTrans[i]);\n                        timeSorted.Add(k);\n                    }\n                    else\n                    {\n                        continue;\n                    }\n\n                }\n\n            }\n        }\n    }\n}\n\n\noutput list1 -&gt; 1,0,1 \noutput list2 -&gt; 500,400,350\n</code></pre>\n"}, {"tags": ["c#", "discord", "discord.net"], "comments": [{"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 0, "creation_date": 1548275169, "post_id": 54335056, "comment_id": 95487619, "body": "The emoji is likely just a Unicode code point, and you should be comparing to that"}, {"owner": {"reputation": 33, "user_id": 9813413, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jack Nutting", "link": "https://stackoverflow.com/users/9813413/jack-nutting"}, "reply_to_user": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 0, "creation_date": 1548275481, "post_id": 54335056, "comment_id": 95487747, "body": "@BradleyDotNET where would I find the unicode information for it, and how would I represent it?"}, {"owner": {"reputation": 483, "user_id": 1623136, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/db68ee7aed505585e8eb1a03ed211b44?s=128&d=identicon&r=PG", "display_name": "Bruno", "link": "https://stackoverflow.com/users/1623136/bruno"}, "edited": false, "score": 0, "creation_date": 1548276615, "post_id": 54335056, "comment_id": 95488209, "body": "You can get information about emojis from the unicode.org site. For example: here&#39;s some info about the <a href=\"https://unicode.org/emoji/charts/emoji-list.html#1f330\" rel=\"nofollow noreferrer\">chestnut</a> emoji"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9813413, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jack Nutting", "link": "https://stackoverflow.com/users/9813413/jack-nutting"}, "edited": false, "score": 0, "creation_date": 1548277672, "post_id": 54335506, "comment_id": 95488593, "body": "I&#39;m not sure why I didn&#39;t think of this tbh, worked excellently"}], "tags": [], "owner": {"reputation": 139, "user_id": 10952264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/991a4cd63da791a44b083ccc5f1bb424?s=128&d=identicon&r=PG&f=1", "display_name": "thebear8", "link": "https://stackoverflow.com/users/10952264/thebear8"}, "is_accepted": false, "score": 1, "last_activity_date": 1548277007, "creation_date": 1548277007, "answer_id": 54335506, "question_id": 54335056, "link": "https://stackoverflow.com/questions/54335056/how-to-use-a-discord-emoji-in-a-c-if-statement/54335506#54335506", "title": "How to use a Discord emoji in a C# if statement", "body": "<p>You could add a breakpoint at the if Statement\nand see what is passed to your funnction as the item string and then use that in your if Statement instead of \":chestnut:\".\nHope that helps.</p>\n"}, {"tags": [], "owner": {"reputation": 483, "user_id": 1623136, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/db68ee7aed505585e8eb1a03ed211b44?s=128&d=identicon&r=PG", "display_name": "Bruno", "link": "https://stackoverflow.com/users/1623136/bruno"}, "is_accepted": true, "score": 2, "last_activity_date": 1548277324, "creation_date": 1548277324, "answer_id": 54335589, "question_id": 54335056, "link": "https://stackoverflow.com/questions/54335056/how-to-use-a-discord-emoji-in-a-c-if-statement/54335589#54335589", "title": "How to use a Discord emoji in a C# if statement", "body": "<p>The following should work. Just copy/paste the emojis into double-quotes. They're characters after all.</p>\n\n<pre><code>[Command(\"buy\")]\npublic async Task Buy(string item)\n{\n    if (item == \"\ud83c\udf30\" || item == \"\ud83d\udc8d\" || item == \"\ud83c\udf4a\" || item == \"\ud83c\udf69\" || item == \"\u26cf\")\n    {\n        await ReplyAsync($\"{item} purchased!\");\n    }\n    else\n    {\n        await ReplyAsync(\"Please enter of of the correct item emojis in order to \n        purchase\");\n    }\n}\n</code></pre>\n\n<p>This solution assumes that the <code>item</code> variable is coming through as an emoji itself</p>\n"}], "owner": {"reputation": 33, "user_id": 9813413, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jack Nutting", "link": "https://stackoverflow.com/users/9813413/jack-nutting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 54335589, "answer_count": 2, "score": 1, "last_activity_date": 1548277324, "creation_date": 1548274907, "question_id": 54335056, "link": "https://stackoverflow.com/questions/54335056/how-to-use-a-discord-emoji-in-a-c-if-statement", "title": "How to use a Discord emoji in a C# if statement", "body": "<p>I'm making a shop command for my bot, with the chestnut, ring, tangerine, doughnut and pick emojis in it as a test run. When I try to input the :chestnut: emoji as the item to purchase, it will save it as 'item', but it doesn't seem to be the same as \":chestnut:\" in the if statement</p>\n\n<pre><code>[Command(\"buy\")]\npublic async Task Buy(string item)\n{\n    if (item == \":chestnut:\" || item == \":ring:\" || item == \":tangerine:\" || item == \":doughnut:\" || item == \":pick:\")\n    {\n        await ReplyAsync($\"{item} purchased!\");\n    }\n    else\n    {\n        await ReplyAsync(\"Please enter of of the correct item emojis in order to purchase\");\n    }\n}\n</code></pre>\n\n<p>I've tried with the other emojis as well, and I still get the response from the else area</p>\n"}, {"tags": ["c#", "c#-4.0"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10940499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlQ8j.jpg?s=128&g=1", "display_name": "some beginner in prog", "link": "https://stackoverflow.com/users/10940499/some-beginner-in-prog"}, "edited": false, "score": 0, "creation_date": 1548275494, "post_id": 54335088, "comment_id": 95487756, "body": "oh! i get it i deleted &quot;dataScreen.DataSource = table;&quot; and added &quot;dataScreen.Rows.Add(name, Gender, DateOfBirth, Address, MedicalHistory);&quot;  and it works  thanks"}], "tags": [], "owner": {"reputation": 651, "user_id": 1968723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c932b3f3ecb247a2483f9183ab2c0df8?s=128&d=identicon&r=PG", "display_name": "Frankely Diaz", "link": "https://stackoverflow.com/users/1968723/frankely-diaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1548275054, "creation_date": 1548275054, "answer_id": 54335088, "question_id": 54334991, "link": "https://stackoverflow.com/questions/54334991/how-to-bring-back-selected-rows-from-datagridview-to-textbox/54335088#54335088", "title": "How to bring back selected rows from datagridview to TextBox", "body": "<p>It looks like you replace the DataSource of your dataScreen with the value of your table when you click on save. </p>\n\n<pre><code> dataScreen.DataSource = table;\n</code></pre>\n\n<p>That is what's replacing the value of dataScreen.DataSource.</p>\n\n<p>Depending on what you are trying to do you might want to add that row to the table before you update your dataScreen.DataSource.</p>\n"}], "owner": {"reputation": 1, "user_id": 10940499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlQ8j.jpg?s=128&g=1", "display_name": "some beginner in prog", "link": "https://stackoverflow.com/users/10940499/some-beginner-in-prog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548278755, "creation_date": 1548274612, "last_edit_date": 1548278755, "question_id": 54334991, "link": "https://stackoverflow.com/questions/54334991/how-to-bring-back-selected-rows-from-datagridview-to-textbox", "title": "How to bring back selected rows from datagridview to TextBox", "body": "<p>I'm having a problem understanding what code I can use bring back selected rows from data grid view to the text boxes to edit. I think we will use something like <code>dataScreen.SelectedRows</code> something maybe </p>\n\n<p>What code can I use?</p>\n\n<p>DataSource = datagridview (to make it easier to understand)</p>\n\n<pre><code>namespace HospitalManagementSystem\n{\n    public partial class Form1 : Form\n    {         \n         DataTable table = new DataTable();\n\n         public string name { get; set; }\n         public string Gender { get; set; }\n         public string DateOfBirth { get; set; }\n         public string Address { get; set; }\n         public string MedicalHistory { get; set; }\n         public string BloodType { get; set; }\n\n         public Form1()\n         {\n             InitializeComponent();\n         }\n\n         private void btnExit_Click(object sender, EventArgs e)\n         {\n             this.Close();\n         }\n\n         private void Form1_Load(object sender, EventArgs e)\n         {\n              dataScreen.Rows.Add(\"Iqra\", \"Female\", 20, 721797684, \"praha 6\", \"Migraine\", \"Blood Type O+\");\n         }\n\n         private void radioButton_Male_CheckedChanged(object sender, EventArgs e)\n         {\n              Gender = \"Male\";\n         }\n\n         private void radioButton_Female_CheckedChanged(object sender, EventArgs e)\n         {\n              Gender = \"Female\";\n         }\n\n         private void btnSave_Click(object sender, EventArgs e)\n         {\n              name = txtName.Text;\n              DateOfBirth = Date_dob.Value.ToString();\n              Address = txtAddress.Text;\n              MedicalHistory = txtMedicalHistory.Text;\n              BloodType = txtBloodType.Text;\n\n              if (radioButton_Female.Checked)\n                  Gender = \"Female\";\n              else if (radioButton_Male.Checked)\n                  Gender = \"Male\";\n\n              dataScreen.Rows.Add(name, Gender, DateOfBirth, Address, MedicalHistory);\n         }\n     }\n}\n</code></pre>\n"}, {"tags": ["c#", "xamarin.uwp"], "comments": [{"owner": {"reputation": 429, "user_id": 5346438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9782988ddeb34c2783e6c6b3f2d3f1fc?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Mitterbauer", "link": "https://stackoverflow.com/users/5346438/mario-mitterbauer"}, "edited": false, "score": 0, "creation_date": 1548274282, "post_id": 54334848, "comment_id": 95487279, "body": "which version are you using? related: <a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.applicationmodel.activation.iactivatedeventargs\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/uwp/api/&hellip;</a>"}, {"owner": {"reputation": 75, "user_id": 3693290, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e105b1cceccf58ad1d2c502859e20812?s=128&d=identicon&r=PG&f=1", "display_name": "user3693290", "link": "https://stackoverflow.com/users/3693290/user3693290"}, "reply_to_user": {"reputation": 429, "user_id": 5346438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9782988ddeb34c2783e6c6b3f2d3f1fc?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Mitterbauer", "link": "https://stackoverflow.com/users/5346438/mario-mitterbauer"}, "edited": false, "score": 0, "creation_date": 1548274715, "post_id": 54334848, "comment_id": 95487447, "body": "Version\t10.0.17134 Build 17134 So I should be plenty late enuff"}, {"owner": {"reputation": 429, "user_id": 5346438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9782988ddeb34c2783e6c6b3f2d3f1fc?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Mitterbauer", "link": "https://stackoverflow.com/users/5346438/mario-mitterbauer"}, "edited": false, "score": 0, "creation_date": 1548274790, "post_id": 54334848, "comment_id": 95487471, "body": "also implemented the sdk for the required version?"}, {"owner": {"reputation": 75, "user_id": 3693290, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e105b1cceccf58ad1d2c502859e20812?s=128&d=identicon&r=PG&f=1", "display_name": "user3693290", "link": "https://stackoverflow.com/users/3693290/user3693290"}, "reply_to_user": {"reputation": 429, "user_id": 5346438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9782988ddeb34c2783e6c6b3f2d3f1fc?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Mitterbauer", "link": "https://stackoverflow.com/users/5346438/mario-mitterbauer"}, "edited": false, "score": 0, "creation_date": 1548275180, "post_id": 54334848, "comment_id": 95487624, "body": "Where would I look for this info? It&#39;s .Net framework 4.6.2 but I dodn&#39;t think that is what you are asking..."}, {"owner": {"reputation": 429, "user_id": 5346438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9782988ddeb34c2783e6c6b3f2d3f1fc?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Mitterbauer", "link": "https://stackoverflow.com/users/5346438/mario-mitterbauer"}, "edited": false, "score": 0, "creation_date": 1548275446, "post_id": 54334848, "comment_id": 95487736, "body": "best explanation: <a href=\"https://docs.microsoft.com/en-us/windows/uwp/updates-and-versions/choose-a-uwp-version\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/uwp/updates-and-versions/&hellip;</a>"}, {"owner": {"reputation": 75, "user_id": 3693290, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e105b1cceccf58ad1d2c502859e20812?s=128&d=identicon&r=PG&f=1", "display_name": "user3693290", "link": "https://stackoverflow.com/users/3693290/user3693290"}, "reply_to_user": {"reputation": 429, "user_id": 5346438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9782988ddeb34c2783e6c6b3f2d3f1fc?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Mitterbauer", "link": "https://stackoverflow.com/users/5346438/mario-mitterbauer"}, "edited": false, "score": 0, "creation_date": 1548276850, "post_id": 54334848, "comment_id": 95488291, "body": "There doesn&#39;t appear to be a value in the  .csproj file to edit. Looking at Project properies doesn&#39;t show a minimum or target version. I&#39;m so lost..."}, {"owner": {"reputation": 429, "user_id": 5346438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9782988ddeb34c2783e6c6b3f2d3f1fc?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Mitterbauer", "link": "https://stackoverflow.com/users/5346438/mario-mitterbauer"}, "edited": false, "score": 0, "creation_date": 1548277158, "post_id": 54334848, "comment_id": 95488404, "body": "you installed the version for UWP or the default one?"}, {"owner": {"reputation": 75, "user_id": 3693290, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e105b1cceccf58ad1d2c502859e20812?s=128&d=identicon&r=PG&f=1", "display_name": "user3693290", "link": "https://stackoverflow.com/users/3693290/user3693290"}, "reply_to_user": {"reputation": 429, "user_id": 5346438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9782988ddeb34c2783e6c6b3f2d3f1fc?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Mitterbauer", "link": "https://stackoverflow.com/users/5346438/mario-mitterbauer"}, "edited": false, "score": 0, "creation_date": 1548277280, "post_id": 54334848, "comment_id": 95488446, "body": "This isn&#39;t my project on a machine that isn&#39;t mine. New job. Appreciate your patience. I have checked a VS 2017 does have the UWP stuff installed. What version - how do I check?"}, {"owner": {"reputation": 429, "user_id": 5346438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9782988ddeb34c2783e6c6b3f2d3f1fc?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Mitterbauer", "link": "https://stackoverflow.com/users/5346438/mario-mitterbauer"}, "edited": false, "score": 0, "creation_date": 1548441767, "post_id": 54334848, "comment_id": 95556515, "body": "sorry for the late response: <a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.management.deployment.packagemanager.findpackageforuser\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/uwp/api/&hellip;</a>"}], "owner": {"reputation": 75, "user_id": 3693290, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e105b1cceccf58ad1d2c502859e20812?s=128&d=identicon&r=PG&f=1", "display_name": "user3693290", "link": "https://stackoverflow.com/users/3693290/user3693290"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548357531, "creation_date": 1548273893, "last_edit_date": 1548357531, "question_id": 54334848, "link": "https://stackoverflow.com/questions/54334848/cant-use-iactivatedeventargs", "title": "Can&#39;t use IActivatedEventArgs", "body": "<p>I can't use <code>IActivatedEventArgs</code>  in a <code>UWP</code> to get command line options</p>\n\n<p>because I have no reference to <code>Windows.ApplicationModel.Activation</code></p>\n\n<p>because I have no <code>Windows.ApplicationModel.Activation.dll</code> anywhere on the machine</p>\n\n<p>So where should this .dll be so I can add it to my assemblies?</p>\n\n<p>If it isn't there - how do I get it there?</p>\n\n<p>UPDATE: This project does not appear to be a UWP project after all - it appears to be a Xamarin project that has had everything but UWP stripped out. And I'm guessing you don't get Windows.ApplicationModel.Activation in Xamarin. Forgive my ignorance.</p>\n"}, {"tags": ["c#", "event-handling", "drawing"], "comments": [{"owner": {"reputation": 77042, "user_id": 719186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f03c0b63844ced274fae4110267fe640?s=128&d=identicon&r=PG", "display_name": "LarsTech", "link": "https://stackoverflow.com/users/719186/larstech"}, "edited": false, "score": 1, "creation_date": 1548273267, "post_id": 54334667, "comment_id": 95486863, "body": "Use the Paint event of the control you are trying to paint on."}, {"owner": {"reputation": 48588, "user_id": 3152130, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RqxLT.jpg?s=128&g=1", "display_name": "TaW", "link": "https://stackoverflow.com/users/3152130/taw"}, "edited": false, "score": 0, "creation_date": 1548273900, "post_id": 54334667, "comment_id": 95487143, "body": "The code belongs in th Paint event. The button should do <code>targetControlOrForm.Invalidate();</code>"}, {"owner": {"reputation": 20646, "user_id": 22437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/H4s3Z.jpg?s=128&g=1", "display_name": "Dour High Arch", "link": "https://stackoverflow.com/users/22437/dour-high-arch"}, "edited": false, "score": 0, "creation_date": 1548278807, "post_id": 54334667, "comment_id": 95489089, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49991039/how-to-draw-shapes-in-winforms\">How to draw shapes in WinForms</a>"}], "owner": {"reputation": 29, "user_id": 10957736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZHPLSJ9MuS0/AAAAAAAAAAI/AAAAAAAAFPM/QOm1PTq0Ubc/photo.jpg?sz=128", "display_name": "Space Kek", "link": "https://stackoverflow.com/users/10957736/space-kek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556787845, "creation_date": 1548273075, "question_id": 54334667, "link": "https://stackoverflow.com/questions/54334667/is-it-possible-to-have-graphics-as-a-button-click-action", "title": "Is it possible to have Graphics as a button_click action?", "body": "<p>I'm trying to make a program that draws circles with random colors and sizes when you click a button, but my code doesn't want to use graphics in the EventArgs and if I use System.Windows.PaintEventHandler it doesn't work as a button click.</p>\n\n<p>I've already tried to change it to use the painteventhandler in the designer of the form but it had to convert to eventhandler.</p>\n\n<pre><code>private void Button1_Click(object sender, EventArgs e)\n    {\n        Random randm = new Random();\n        int rand_rood = randm.Next(1, 257);\n        int rand_groen = randm.Next(1, 257);\n        int rand_blauw = randm.Next(1, 257);\n        int rand_x = randm.Next(1, 501);\n        int rand_y = randm.Next(1, 501);\n        int rand_width = randm.Next(1, 501);\n        int rand_height = randm.Next(1, 501);\n        Graphics l = e.Graphics;\n        Pen p = new Pen(Color.FromArgb(rand_rood, rand_groen, rand_blauw));\n        e.Graphics.DrawEllipse(p, rand_x, rand_y, rand_width, rand_height);\n</code></pre>\n\n<p>(in the form designer)\n    this.button1.Click += Button1_Click;</p>\n\n<p>I want my graphics to work in my button event.</p>\n"}, {"tags": ["c#", "vb.net", "pipe", "operator-keyword", "equivalent"], "comments": [{"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 4, "creation_date": 1548273209, "post_id": 54334653, "comment_id": 95486845, "body": "The VB equivalent is <code>Or</code>.  <code>Or</code> will do a bitwise OR of two integral values.  And, like C#&#39;s <code>|</code>, it will do a non-short-cutting OR operation between two Booleans.  And, to be complete, the VB equivalent of C#&#39;s short-cutting OR (<code>||</code>) is <code>OrElse</code>"}, {"owner": {"reputation": 22110, "user_id": 7444103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcyKP.jpg?s=128&g=1", "display_name": "Jimi", "link": "https://stackoverflow.com/users/7444103/jimi"}, "edited": false, "score": 3, "creation_date": 1548273222, "post_id": 54334653, "comment_id": 95486851, "body": "<a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/or-operator\" rel=\"nofollow noreferrer\">Or Operator</a>."}, {"owner": {"reputation": 983, "user_id": 1208914, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/67ff6e6827062a0b8b8e0d2c1a645dc0?s=128&d=identicon&r=PG", "display_name": "stormCloud", "link": "https://stackoverflow.com/users/1208914/stormcloud"}, "edited": false, "score": 1, "creation_date": 1548273240, "post_id": 54334653, "comment_id": 95486853, "body": "Type into Google \u201cc# to vb converter\u201d"}, {"owner": {"reputation": 16713, "user_id": 48910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5ce4658498bca7a7e2c2ab9607d664?s=128&d=identicon&r=PG", "display_name": "Meta-Knight", "link": "https://stackoverflow.com/users/48910/meta-knight"}, "edited": false, "score": 0, "creation_date": 1548275563, "post_id": 54334653, "comment_id": 95487778, "body": "Why the downvotes, the question seems perfectly legit to me..."}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "reply_to_user": {"reputation": 16713, "user_id": 48910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5ce4658498bca7a7e2c2ab9607d664?s=128&d=identicon&r=PG", "display_name": "Meta-Knight", "link": "https://stackoverflow.com/users/48910/meta-knight"}, "edited": false, "score": 0, "creation_date": 1548276563, "post_id": 54334653, "comment_id": 95488191, "body": "@Meta-Knight if I was a betting guy I would say because it&#39;s already been answered before here on SO in one form or another, a quick Google search will show exactly the OP what is is etc..."}, {"owner": {"reputation": 16713, "user_id": 48910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5ce4658498bca7a7e2c2ab9607d664?s=128&d=identicon&r=PG", "display_name": "Meta-Knight", "link": "https://stackoverflow.com/users/48910/meta-knight"}, "reply_to_user": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1548278642, "post_id": 54334653, "comment_id": 95489021, "body": "@&#199;&#246;\u0111\u011bx\u011b\u0155: Not that easy to find relevant results by searching for special characters (<code>|</code>) or  common words (<code>Or</code>) in Google, also if it&#39;s a duplicate it should be simply closed as duplicate ;-) I couldn&#39;t find a duplicate question with a quick search altough I&#39;m sure there is one too."}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "reply_to_user": {"reputation": 16713, "user_id": 48910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5ce4658498bca7a7e2c2ab9607d664?s=128&d=identicon&r=PG", "display_name": "Meta-Knight", "link": "https://stackoverflow.com/users/48910/meta-knight"}, "edited": false, "score": 0, "creation_date": 1548279419, "post_id": 54334653, "comment_id": 95489379, "body": "@Meta-Knight true, but then again you shouldn&#39;t just be putting in just that character, you&#39;ll get a lot of miss-leads <code>Is there an equivalent C# pipe in VB.Net?</code> seems to be more of a question that would have better hits."}], "answers": [{"comments": [{"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 1, "creation_date": 1548274116, "post_id": 54334695, "comment_id": 95487212, "body": "Could you please expand on your answer to include specifics as what <code>Or</code> does, this would back your answer with more useful information."}, {"owner": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "reply_to_user": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1548275658, "post_id": 54334695, "comment_id": 95487818, "body": "@&#199;&#246;\u0111\u011bx\u011b\u0155 Updated my answer."}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1548275865, "post_id": 54334695, "comment_id": 95487915, "body": "@Alexander Thanks, this helps other that may come across this answer to help them."}], "tags": [], "owner": {"reputation": 6733, "user_id": 7775908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ebbc43d25626d0bf3783211f0b8d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7775908/alexander"}, "is_accepted": true, "score": 8, "last_activity_date": 1548275688, "last_edit_date": 1548275688, "creation_date": 1548273194, "answer_id": 54334695, "question_id": 54334653, "link": "https://stackoverflow.com/questions/54334653/is-there-an-equivalent-of-c%c2%b4s-operator-in-vb-net/54334695#54334695", "title": "Is there an equivalent of C#&#180;s | operator in VB.Net?", "body": "<p>The equivalent is <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/or-operator\" rel=\"noreferrer\"><code>Or</code></a>.</p>\n\n<pre><code>InheritanceFlags.ObjectInherit Or InheritanceFlags.ContainerInherit\n</code></pre>\n\n<p>It will perform bitwise \"or\" operation between operands. </p>\n\n<p>For example if you have the following enumeration</p>\n\n<p>C#:</p>\n\n<pre><code>enum Values\n{\n    None = 0,\n    Odd = 1,\n    Even = 2,\n    All = 3\n}\n</code></pre>\n\n<p>VB:</p>\n\n<pre><code>Enum Values\n    None = 0\n    Odd = 1\n    Even = 2\n    All = 3\nEnd Enum\n</code></pre>\n\n<p>The result of <code>Values.Odd | Values.Even</code> (<code>Values.Odd Or Values.Even</code>) is <code>Values.All</code>. This is because <code>Odd = 1</code>  is <code>01</code> in binary representation and <code>Even = 2</code> is <code>10</code> and <code>01 or 10</code> equals <code>11</code> which is <code>3 (All)</code>.</p>\n"}], "owner": {"reputation": 81, "user_id": 9435663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ba553ef4f64c17445912eec0de6e01?s=128&d=identicon&r=PG&f=1", "display_name": "T. P. ", "link": "https://stackoverflow.com/users/9435663/t-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 54334695, "answer_count": 1, "score": 0, "last_activity_date": 1548275688, "creation_date": 1548273018, "question_id": 54334653, "link": "https://stackoverflow.com/questions/54334653/is-there-an-equivalent-of-c%c2%b4s-operator-in-vb-net", "title": "Is there an equivalent of C#&#180;s | operator in VB.Net?", "body": "<p>Is there an equivalent of the C#'s pipe operator (|) in VB.Net?</p>\n\n<p>I have some code from here <a href=\"https://stackoverflow.com/questions/9108399/how-to-grant-full-permission-to-a-file-created-by-my-application-for-all-users\">How to grant full permission to a file created by my application for ALL users?</a></p>\n\n<p>It is in C# and i want to convert it to VB.Net. I am at this point so far (VS says there is an error: | InheritanceFlags.ContainerInherit):</p>\n\n<pre><code>Sub ZugriffsrechteEinstellen()\n\n    Dim dInfo As New DirectoryInfo(strPfadSpracheINI)\n    Dim dSecurity As New DirectorySecurity\n\n    dSecurity = dInfo.GetAccessControl()\n    dSecurity.AddAccessRule(New FileSystemAccessRule(New SecurityIdentifier(WellKnownSidType.WorldSid, Nothing), FileSystemRights.FullControl, InheritanceFlags.ObjectInherit | InheritanceFlags.ContainerInherit, PropagationFlags.NoPropagateInherit, AccessControlType.Allow))\n\n    dInfo.SetAccessControl(dSecurity)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#"], "comments": [{"owner": {"reputation": 619, "user_id": 2623538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhR1w.jpg?s=128&g=1", "display_name": "NaDeR Star", "link": "https://stackoverflow.com/users/2623538/nader-star"}, "edited": false, "score": 0, "creation_date": 1548273317, "post_id": 54334632, "comment_id": 95486889, "body": "Add reference to <code>System.Net.Http.Formatting.dll</code> and try to add this line to your code <code>System.Net.ServicePointManager.Expect100Continue = false;</code>"}, {"owner": {"reputation": 1161, "user_id": 124658, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/d140e80b383a2072a376d352f1315e2d?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/124658/craig"}, "reply_to_user": {"reputation": 619, "user_id": 2623538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhR1w.jpg?s=128&g=1", "display_name": "NaDeR Star", "link": "https://stackoverflow.com/users/2623538/nader-star"}, "edited": false, "score": 0, "creation_date": 1548278351, "post_id": 54334632, "comment_id": 95488890, "body": "Ok I will try that."}], "answers": [{"comments": [{"owner": {"reputation": 1161, "user_id": 124658, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/d140e80b383a2072a376d352f1315e2d?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/124658/craig"}, "edited": false, "score": 0, "creation_date": 1548278382, "post_id": 54334743, "comment_id": 95488908, "body": "Ok, I will try that."}], "tags": [], "owner": {"reputation": 23752, "user_id": 1118978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2rloq.jpg?s=128&g=1", "display_name": "Dervi\u015f Kay\u0131mba\u015f\u0131o\u011flu", "link": "https://stackoverflow.com/users/1118978/dervi%c5%9f-kay%c4%b1mba%c5%9f%c4%b1o%c4%9flu"}, "is_accepted": true, "score": 1, "last_activity_date": 1548273370, "creation_date": 1548273370, "answer_id": 54334743, "question_id": 54334632, "link": "https://stackoverflow.com/questions/54334632/why-console-app-works-but-web-app-doesnt-for-httpresponsemessage/54334743#54334743", "title": "Why console app works but web app doesn&#39;t for HttpResponseMessage?", "body": "<p>I guess you have blocking issue on your <code>Async</code> method call due to Synchronization Context.</p>\n\n<p>try with</p>\n\n<pre><code>HttpResponseMessage response = await client.PostAsJsonAsync(tokenEndpoint,\n    jsonLoginPayload).ConfigureAwait(false);\n</code></pre>\n"}], "owner": {"reputation": 1161, "user_id": 124658, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/d140e80b383a2072a376d352f1315e2d?s=128&d=identicon&r=PG", "display_name": "Craig", "link": "https://stackoverflow.com/users/124658/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 54334743, "answer_count": 1, "score": 0, "last_activity_date": 1548273370, "creation_date": 1548272941, "question_id": 54334632, "link": "https://stackoverflow.com/questions/54334632/why-console-app-works-but-web-app-doesnt-for-httpresponsemessage", "title": "Why console app works but web app doesn&#39;t for HttpResponseMessage?", "body": "<p>I am using the exact same code base in a console application as I am in a web application.  Everything works fine until I get to this call in the web application:</p>\n\n<pre><code>// Send a request asynchronously, continue when complete\nHttpResponseMessage response = await client.PostAsJsonAsync(tokenEndpoint, jsonLoginPayload);\n</code></pre>\n\n<p>The console application returns with a response but in the web application it never comes back.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c#", "performance"], "comments": [{"owner": {"reputation": 681, "user_id": 6763830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IClZL.jpg?s=128&g=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6763830/max"}, "edited": false, "score": 0, "creation_date": 1548276048, "post_id": 54334626, "comment_id": 95487988, "body": "May be try to use Dictionary&lt;string, DocumentSearchResult&gt;, where string is document name. Then for the merge, foreach via secondary results and only add a record if no key exists in the primary search results.  For the second portion do the same -- foreach loop with removal if they key exists in another dictionary. That should be faster, I believe, because Dictionary uses hashes to access elements/find keys."}, {"owner": {"reputation": 789, "user_id": 4659089, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9bdb9f0ba256952e98888bfd549c715b?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/4659089/john"}, "reply_to_user": {"reputation": 681, "user_id": 6763830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IClZL.jpg?s=128&g=1", "display_name": "Max", "link": "https://stackoverflow.com/users/6763830/max"}, "edited": false, "score": 0, "creation_date": 1548276819, "post_id": 54334626, "comment_id": 95488278, "body": "Thanks for the pointer.  I&#39;ll begin to look at this as a solution."}], "owner": {"reputation": 789, "user_id": 4659089, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9bdb9f0ba256952e98888bfd549c715b?s=128&d=identicon&r=PG&f=1", "display_name": "john", "link": "https://stackoverflow.com/users/4659089/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548272930, "creation_date": 1548272930, "question_id": 54334626, "link": "https://stackoverflow.com/questions/54334626/merging-two-lists-of-objects-based-on-an-attribute", "title": "Merging two Lists of objects based on an attribute", "body": "<p>I have this class defined:</p>\n\n<pre><code>public class DocumentSearchResult\n    {\n        public string RowCount { get; set; }\n        public string TotalRows { get; set; }\n        public Int64 DocumentQueryExecutionTimeMS { get; set; }\n        public string DocumentPath { get; set; }\n        public string DocumentName { get; set; }\n        public string DocumentTitle { get; set; }\n        public string DocumentSize { get; set; }\n        public string DocumentAuthor { get; set; }\n        public string DocumentDescription { get; set; }\n        public string DocumentFileExtension { get; set; }\n        public double DocumentRank { get; set; }\n        public Int64 DocumentDocId { get; set; }\n        public Int64 DocumentWorkId { get; set; }\n        public string DocumentWrite { get; set; }\n        public string DocumentParentLink { get; set; }\n        public string DocumentLastModifiedDate { get; set; }\n        public string DocumentFileType { get; set; }\n        public string DocumentSummary { get; set; }\n        public string DocumentLibrary { get; set; }\n\n        //These next set of properties are used for Viewing the results in embedded or preview\n        public string DocumentRedirectedEmbededURL { get; set; }\n        public string DocumentRedirectPreviewURL { get; set; }\n        public string DocumentRedirectURL { get; set; }\n        //These two properties are needed to show how the results were gathered MetaData-Content and the folder path location in Ember of the file\n        public string SearchSource { get; set; }\n        public string FolderPath { get; set; }\n</code></pre>\n\n<p>I get data from two different sources and fill in this class with the appropriate information.  Now the client wants the option to include both sets of data and return one response eliminating duplicates, and the other option is to find the matching records from one list that are in the other list and return only the items that appear in both lists.  So the first option is an AND merge to include all results from both lists but don't show duplicates.  The other is an OR merge where the results must be in both lists trimming all records that don't match.</p>\n\n<p>So to merge the list or combine the list I created this function:</p>\n\n<pre><code>public List&lt;DocumentSearchResult&gt; StitchMetaDataAndContent(List&lt;DocumentSearchResult&gt; metaDataResults, List&lt;DocumentSearchResult&gt; contentResults, bool merge = false)\n    {\n        if (merge)\n        {\n            List&lt;DocumentSearchResult&gt; stitchedContent;\n            stitchedContent = metaDataResults.Union(contentResults).ToList();\n            foreach(DocumentSearchResult docX in stitchedContent)\n            {\n                docX.RowCount = (metaDataResults.Count + contentResults.Count).ToString();\n            }\n            return stitchedContent;\n        }\n        else\n        {\n           metaDataResults.RemoveAll(x =&gt; !contentResults.Any(y =&gt; y.DocumentName == x.DocumentName));\n            foreach(DocumentSearchResult docX in metaDataResults)\n            {\n                docX.RowCount = metaDataResults.ToString();\n            }\n            return metaDataResults;\n        }\n    }\n</code></pre>\n\n<p>For the merge portion I use the Union operator to merge the content into the results.  This appears to be working, but I am having problems stripping out the duplicates.  I need to strip the duplicates based on the DocumentName property for both sets.  This is the only data in the record that is guaranteed to be identical between the two sets.   </p>\n\n<p>In the second it appears the RemoveAll is working using the DocumentName (I continue to test this to make sure), and stripping all the files in the metaDataResult list that aren't in the contentResults list, but I am concerned this will slow as the lists increase.  It is possible that the metaDataResults could be 10,000 and I know that some searches on the contentResults can be over 150K results.  Is the RemoveAll the best approach to this?  Is there a quicker way someone can point me to that may speed up performance?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "azure", "azure-functions", "azure-eventhub"], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 8764412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40269045bb263d31ef71df3051c326b0?s=128&d=identicon&r=PG&f=1", "display_name": "Arduino", "link": "https://stackoverflow.com/users/8764412/arduino"}, "edited": false, "score": 0, "creation_date": 1548274221, "post_id": 54334782, "comment_id": 95487257, "body": "That was exactly it, thanks!! By the way, is the Timestamp column mandatory or can I choose to remove it?"}, {"owner": {"reputation": 283, "user_id": 8839621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c369a0fe291fbcd80d90207b4bb4ca?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ma\u0142ek", "link": "https://stackoverflow.com/users/8839621/adam-ma%c5%82ek"}, "reply_to_user": {"reputation": 319, "user_id": 8764412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40269045bb263d31ef71df3051c326b0?s=128&d=identicon&r=PG&f=1", "display_name": "Arduino", "link": "https://stackoverflow.com/users/8764412/arduino"}, "edited": false, "score": 0, "creation_date": 1548275016, "post_id": 54334782, "comment_id": 95487560, "body": "PartitionKey, RowKey and Timestamp are mandatory, but i think timestamp is automatically populated"}], "tags": [], "owner": {"reputation": 283, "user_id": 8839621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c369a0fe291fbcd80d90207b4bb4ca?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ma\u0142ek", "link": "https://stackoverflow.com/users/8839621/adam-ma%c5%82ek"}, "is_accepted": true, "score": 1, "last_activity_date": 1548273540, "creation_date": 1548273540, "answer_id": 54334782, "question_id": 54334577, "link": "https://stackoverflow.com/questions/54334577/set-columns-in-azure-eventhubtrigger-function-app/54334782#54334782", "title": "Set columns in Azure EventHubTrigger Function app", "body": "<p>I'm not sure if I understood You correctly, but You want to have output with 3 properties:\nPartitionKey, RowKey and Area?</p>\n\n<p>If yes, then try to define new class for output and use it to return data:</p>\n\n<pre><code>public static void Run(DataPoint myIoTHubMessage, out OutPutData outputTable, TraceWriter log)\n{\n   log.Info($\"C# IoT Hub trigger function processed a message: {myIoTHubMessage}\");\n\n    outputTable = new OutPutData\n    {\n        PartitionKey = myIoTHubMessage.cameraName,\n        RowKey = myIoTHubMessage.dateTime,\n        Area = myIoTHubMessage.area\n    };\n}\n\npublic class DataPoint : TableEntity\n{\n   public string cameraName { get; set; }\n   public string dateTime { get; set; }\n   public double Area { get; set; }\n}\n\npublic class OutPutData : TableEntity\n{\n   public double Area { get; set; }\n}\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 8764412, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40269045bb263d31ef71df3051c326b0?s=128&d=identicon&r=PG&f=1", "display_name": "Arduino", "link": "https://stackoverflow.com/users/8764412/arduino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 54334782, "answer_count": 1, "score": 0, "last_activity_date": 1548274153, "creation_date": 1548272700, "last_edit_date": 1548274153, "question_id": 54334577, "link": "https://stackoverflow.com/questions/54334577/set-columns-in-azure-eventhubtrigger-function-app", "title": "Set columns in Azure EventHubTrigger Function app", "body": "<p>I'd like to set the first two columns of an Azure Table (PartitionKey and RowKey) based on some variables I'm sending to the IoT Hub but I'm unsure how given my low familiarity with C#. My current code is the following:</p>\n\n<pre><code>#r \"Microsoft.WindowsAzure.Storage\"\n\nusing System;\nusing Microsoft.WindowsAzure.Storage.Table;\n\npublic static void Run(DataPoint myIoTHubMessage, out DataPoint outputTable, TraceWriter log)\n{\n   log.Info($\"C# IoT Hub trigger function processed a message: {myIoTHubMessage}\");\n\n   myIoTHubMessage.PartitionKey = DateTime.Now.ToString(\"dd-MM-yyyy\");\n   myIoTHubMessage.RowKey = DateTime.Now.ToString(\"HH:mm:ss\");\n\n   outputTable = myIoTHubMessage;\n}\n\npublic class DataPoint : TableEntity\n{\n   public string cameraName { get; set; }\n   public string dateTime { get; set; }\n   public double Area { get; set; }\n}\n</code></pre>\n\n<p>Here I managed to set these rows to the current date and time, but my will is to set them to other variables received, such as <code>cameraName</code> and <code>dateTime</code> for instance, without duplicating them (I managed to do that with the following two lines, but that just duplicates columns):</p>\n\n<pre><code>   myIoTHubMessage.PartitionKey = myIoTHubMessage.cameraName;\n   myIoTHubMessage.RowKey = myIoTHubMessage.dateTime;\n</code></pre>\n\n<p>Is there any way to have just the 3 variables as columns?</p>\n"}, {"tags": ["c#", "json", "dictionary", "unity3d"], "comments": [{"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1548273129, "post_id": 54334572, "comment_id": 95486810, "body": "JSON is not XML. See <a href=\"https://stackoverflow.com/a/6620173/880990\">this answer</a> to <a href=\"https://stackoverflow.com/questions/6620165/how-can-i-parse-json-with-c\">How can I parse JSON with C#?</a>"}, {"owner": {"reputation": 2811, "user_id": 8417363, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/hO0vR.png?s=128&g=1", "display_name": "Jimenemex", "link": "https://stackoverflow.com/users/8417363/jimenemex"}, "edited": false, "score": 0, "creation_date": 1548277031, "post_id": 54334572, "comment_id": 95488354, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/34043384/easiest-way-to-parse-json-response\">Easiest way to parse JSON response</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1578, "user_id": 342842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98efa40198faaa312c6465b969f1fae?s=128&d=identicon&r=PG", "display_name": "Immersive", "link": "https://stackoverflow.com/users/342842/immersive"}, "edited": false, "score": 0, "creation_date": 1548333070, "post_id": 54334722, "comment_id": 95508720, "body": "When using <code>JsonUtility</code>, I was pretty sure you only need to implement the fields that you want access to and unmapped JSON is ignored.  Is this not so? (Admittedly, I&#39;ve only really used <code>FromJsonOverwrite()</code>)"}, {"owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "reply_to_user": {"reputation": 1578, "user_id": 342842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a98efa40198faaa312c6465b969f1fae?s=128&d=identicon&r=PG", "display_name": "Immersive", "link": "https://stackoverflow.com/users/342842/immersive"}, "edited": false, "score": 0, "creation_date": 1548340021, "post_id": 54334722, "comment_id": 95513133, "body": "@Immersive I didn&#39;t find this in the docs. It only claims the other way round that <code>If a field of the object is not present in the JSON representation, that field will be left unchanged.</code> but it doesn&#39;t metnion fields that are present in the JSON but not in the object."}], "tags": [], "owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "is_accepted": false, "score": 2, "last_activity_date": 1548312436, "last_edit_date": 1548312436, "creation_date": 1548273298, "answer_id": 54334722, "question_id": 54334572, "link": "https://stackoverflow.com/questions/54334572/unity-convert-www-text-to-dictionary-in-order-to-access-value/54334722#54334722", "title": "Unity convert www.text to dictionary in order to access value?", "body": "<p>What you get there is a <a href=\"https://en.wikipedia.org/wiki/JSON\" rel=\"nofollow noreferrer\">JSON</a> string not an XML</p>\n\n<pre><code>{\n    \"coord\":{\n        \"lon\":-118.24,\n        \"lat\":34.05\n    },\n    \"weather\":[\n        {\n            \"id\":800,\n            \"main\":\"Clear\",\n            \"description\":\"clear sky\",\n            \"icon\":\"01d\"\n        }\n    ],\n    \"base\":\"stations\",\n    \"main\":{\n        \"temp\":290.19,\n        \"pressure\":1027,\n        \"humidity\":17,\n        \"temp_min\":288.15,\n        \"temp_max\":292.55\n    },\n    \"visibility\":16093,\n    \"wind\":{\n        \"speed\":1.27,\n        \"deg\":20.0024\n    },\n    \"clouds\":{\n        \"all\":1\n    },\n    \"dt\":1548269880,\n    \"sys\":{\n        \"type\":1,\"id\":3694,\n        \"message\":0.0038,\n        \"country\":\"US\",\n        \"sunrise\":1548255306,\n        \"sunset\":1548292515\n    },\n    \"id\":5368361,\n    \"name\":\"Los Angeles\",\n    \"cod\":200\n} \n</code></pre>\n\n<p>If you want to access only one or some few values of that JSON you should use the <a href=\"http://wiki.unity3d.com/index.php/SimpleJSON\" rel=\"nofollow noreferrer\">SimpleJSON</a> (simply place all required scripts somewhere in your <code>Assets</code>) and do something like</p>\n\n<pre><code>var N = JSON.Parse(www.text);\n\nvar weather = N[\"weather\"];\n</code></pre>\n\n<p>and than since <code>weather</code> is an array (<code>[...]</code>) access the single values like e.g.</p>\n\n<pre><code>var id = weather[0][\"id\"];\n</code></pre>\n\n<p>Carefull however because this SimpleJson \"hides\" incorrect indexes and strings by simply returning <code>null</code> instead of throwing an exception. This makes debugging a bit harder sometimes (but could also be changed within the code of the JSON class code).</p>\n\n<hr>\n\n<p>There is also e.g. <a href=\"https://docs.unity3d.com/Manual/JSONSerialization.html\" rel=\"nofollow noreferrer\">Unity's <code>JsonUtility</code></a> but it requires that you implement the entire class which is represented by the JSON string. If you do not need all values this might be a lot of overhead when dealing with huge JSONs. </p>\n\n<p>If you need them however (assuming simple types here no <code>enum</code> etc):</p>\n\n<pre><code>[Serializable]\npublic class JsonData\n{\n    public Coord coord;\n    public Weather[] weather;\n    public string base;\n    public Main main;\n    public int visibility;\n    public Wind wind;\n    public Clouds clouds;\n    public int dt;\n    public Sys sys;\n    public int id;\n    public string name;\n    public int cod;\n}\n\n[Serializable]\npublic class Coord\n{\n    public float lon;\n    public float lat;\n}\n\n[Serializable]\npublic class Weather\n{\n    public int id;\n    public string main;\n    public string description;\n    public string icon;\n}\n\n[Serializable]\npublic class Main\n{\n    public float temp;\n    public int pressure;\n    public int humidity;\n    public float temp_min;\n    public float temp_max;\n}\n\n[Serializable]\npublic class Wind \n{\n    public float speed;\n    public float deg;\n}\n\n[Serializable]\npublic class Clouds\n{\n    public int all;\n}\n\n[Serializable]\npublic class Sys\n{\n    public int type;\n    public int id;\n    public float message;\n    public string country;\n    public int sunrise;\n    public int sunset;\n}\n</code></pre>\n\n<p>and than do</p>\n\n<pre><code>var wholeData = JsonUtility.FromJson&lt;JsonData&gt;(www.text);\nvar weather = wholeData.weather;\nvar id = weather.id;\n</code></pre>\n"}], "owner": {"reputation": 6403, "user_id": 3781199, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/1NpEm.png?s=128&g=1", "display_name": "skyguy", "link": "https://stackoverflow.com/users/3781199/skyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548312436, "creation_date": 1548272688, "question_id": 54334572, "link": "https://stackoverflow.com/questions/54334572/unity-convert-www-text-to-dictionary-in-order-to-access-value", "title": "Unity convert www.text to dictionary in order to access value?", "body": "<p>Ok, I have this that does work trying to fetch weather data - this returns the string version of this dictionary:</p>\n\n<pre><code>Loaded following XML {\"coord\":{\"lon\":-118.24,\"lat\":34.05},\"weather\":[{\"id\":800,\"main\":\"Clear\",\"description\":\"clear sky\",\"icon\":\"01d\"}],\"base\":\"stations\",\"main\":{\"temp\":290.19,\"pressure\":1027,\"humidity\":17,\"temp_min\":288.15,\"temp_max\":292.55},\"visibility\":16093,\"wind\":{\"speed\":1.27,\"deg\":20.0024},\"clouds\":{\"all\":1},\"dt\":1548269880,\"sys\":{\"type\":1,\"id\":3694,\"message\":0.0038,\"country\":\"US\",\"sunrise\":1548255306,\"sunset\":1548292515},\"id\":5368361,\"name\":\"Los Angeles\",\"cod\":200}\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>string url = \"http://api.openweathermap.org/data/2.5/weather?lat=34.05&amp;lon=-118.24&amp;APPID=33710eba6d9c76286241d779ac1a6d9c\";\n\n        WWW www = new WWW(url);\n        yield return www;\n        if (www.error == null)\n        {\n\n            Debug.Log(\"Loaded following XML \" + www.text);\n</code></pre>\n\n<p>I want to get the description under \"weather\" but cant figure out how. Select single node does not work:</p>\n\n<pre><code>print(xmlDoc.SelectSingleNode(\"cities/list/item/weather/description/@value\").InnerText);\n</code></pre>\n\n<p>What can I do here?</p>\n"}, {"tags": ["c#", "asp.net-core", "entity-framework-core"], "comments": [{"owner": {"reputation": 619, "user_id": 2623538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhR1w.jpg?s=128&g=1", "display_name": "NaDeR Star", "link": "https://stackoverflow.com/users/2623538/nader-star"}, "edited": false, "score": 3, "creation_date": 1548272722, "post_id": 54334526, "comment_id": 95486654, "body": "If you update from older EF.. just use <code>OnModelCreating(ModelBuilder modelBuilder)</code>"}, {"owner": {"reputation": 157412, "user_id": 5202563, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mKKQ.png?s=128&g=1", "display_name": "Ivan Stoev", "link": "https://stackoverflow.com/users/5202563/ivan-stoev"}, "edited": false, "score": 0, "creation_date": 1548275677, "post_id": 54334526, "comment_id": 95487829, "body": "And remove all <code>using System.Data.Entity;</code> to avoid unexpected errors by mixing EF6 and EF Core methods with the same name. And before you get the next error, please note that EF Core has different APIs, for instance there is no <code>HasRequired</code> / <code>HasOptional</code> etc. fluent API for relationships (in EF Core the method is called <code>HasOne</code>). There are also many other differences."}, {"owner": {"reputation": 43, "user_id": 10423160, "user_type": "registered", "profile_image": "https://graph.facebook.com/2173949476159634/picture?type=large", "display_name": "Armen Armenakyan", "link": "https://stackoverflow.com/users/10423160/armen-armenakyan"}, "edited": false, "score": 0, "creation_date": 1548324768, "post_id": 54334526, "comment_id": 95503893, "body": "thank you very much for amazing support"}], "answers": [{"comments": [{"owner": {"reputation": 22234, "user_id": 5928070, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/u5lN9.jpg?s=128&g=1", "display_name": "TanvirArjel", "link": "https://stackoverflow.com/users/5928070/tanvirarjel"}, "reply_to_user": {"reputation": 43, "user_id": 10423160, "user_type": "registered", "profile_image": "https://graph.facebook.com/2173949476159634/picture?type=large", "display_name": "Armen Armenakyan", "link": "https://stackoverflow.com/users/10423160/armen-armenakyan"}, "edited": false, "score": 0, "creation_date": 1548324760, "post_id": 54339050, "comment_id": 95503888, "body": "Great to hear that. Welcome!"}], "tags": [], "owner": {"reputation": 22234, "user_id": 5928070, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/u5lN9.jpg?s=128&g=1", "display_name": "TanvirArjel", "link": "https://stackoverflow.com/users/5928070/tanvirarjel"}, "is_accepted": true, "score": 4, "last_activity_date": 1548301230, "creation_date": 1548301230, "answer_id": 54339050, "question_id": 54334526, "link": "https://stackoverflow.com/questions/54334526/no-suitable-method-found-to-override-onmodelcreating/54339050#54339050", "title": "No suitable method found to override OnModelCreating()", "body": "<p>After looking your code it seems that you you have upgraded your application from <code>ASP.NET MVC</code> to <code>ASP.NET Core</code> but its still referencing ASP.NET MVC libraries.</p>\n\n<p>Remove <code>using System.Data.Entity</code> and replace <code>DbModelBuilder</code> with <code>ModelBuilder</code> and also rewrite the <code>one-to-many</code> configuration as follows:</p>\n\n<pre><code>using Microsoft.AspNetCore.Identity;\nusing Microsoft.AspNetCore.Identity.EntityFrameworkCore;\nusing Microsoft.EntityFrameworkCore;\n\nnamespace MVCOurselves.Models\n{\n    public class MVCOurselvesContext : IdentityDbContext\n    {\n        public DbSet&lt;Student&gt; Students { get; set; }\n        public DbSet&lt;Grade&gt; Grades { get; set; }\n\n        public MVCOurselvesContext (DbContextOptions&lt;MVCOurselvesContext&gt; \noptions)\n            : base(options)\n        {\n        }\n\n        protected override void OnModelCreating(ModelBuilder \nmodelBuilder)\n        {\n            // configures one-to-many relationship\n            modelBuilder.Entity&lt;Grades&gt;()\n                        .HasMany(g =&gt; g.Students)\n                        .WithOne(s =&gt; s.Grade)\n                        .HasForeignKey(s =&gt; s.GradeId);\n        }\n\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10423160, "user_type": "registered", "profile_image": "https://graph.facebook.com/2173949476159634/picture?type=large", "display_name": "Armen Armenakyan", "link": "https://stackoverflow.com/users/10423160/armen-armenakyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4222, "favorite_count": 0, "accepted_answer_id": 54339050, "answer_count": 1, "score": 4, "last_activity_date": 1548325900, "creation_date": 1548272426, "last_edit_date": 1548325900, "question_id": 54334526, "link": "https://stackoverflow.com/questions/54334526/no-suitable-method-found-to-override-onmodelcreating", "title": "No suitable method found to override OnModelCreating()", "body": "<p>When I try to override <code>OnModelCreating</code> virtual function it says no suitable method found to override. I'm pretty sure that I've installed all necessary Entity Framework packages</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Data.Entity;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing Microsoft.AspNetCore.Identity.EntityFrameworkCore;\nusing Microsoft.EntityFrameworkCore;\n\nnamespace MVCOurselves.Models\n{\n    public class MVCOurselvesContext : IdentityDbContext\n    {\n        public System.Data.Entity.DbSet&lt;Student&gt; Student { get; set; }\n        public System.Data.Entity.DbSet&lt;Grade&gt; Grades { get; set; }\n\n        public MVCOurselvesContext (DbContextOptions&lt;MVCOurselvesContext&gt; options)\n            : base(options)\n        {\n        }\n\n        protected override void OnModelCreating(DbModelBuilder modelBuilder)\n        {\n            // configures one-to-many relationship\n            modelBuilder.Entity&lt;Student&gt;()\n                .HasRequired&lt;Grade&gt;(s =&gt; s.Grade)\n                .WithMany(g =&gt; g.Students)\n                .HasForeignKey&lt;int&gt;(s =&gt; s.Id);\n        }\n\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c#", "valueinjecter"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1548275512, "post_id": 54334519, "comment_id": 95487762, "body": "I don&#39;t see any examples on the ValueInjector page that address collections of records.  All of their examples inject a single object."}, {"owner": {"reputation": 64537, "user_id": 112100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/06b8cf11a06476f630eabd53c8ac11a6?s=128&d=identicon&r=PG", "display_name": "Omu", "link": "https://stackoverflow.com/users/112100/omu"}, "edited": false, "score": 0, "creation_date": 1548578110, "post_id": 54334519, "comment_id": 95585007, "body": "<code>mapper.Map</code> could do what you need, but you&#39;ll have to use <code>Mapper.AddMap</code> first; or map each object in a for loop and add it to the list; (by default it will only map properties with the exact same name and type)"}], "answers": [{"comments": [{"owner": {"reputation": 240, "user_id": 7793817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8722ecd77d416e7ca57cf2fd49348ece?s=128&d=identicon&r=PG&f=1", "display_name": "Alvin", "link": "https://stackoverflow.com/users/7793817/alvin"}, "edited": false, "score": 0, "creation_date": 1548335544, "post_id": 54336884, "comment_id": 95510283, "body": "I tried both the solutions and still getting null for all properties. Is there any configuration that needs to be done?"}], "tags": [], "owner": {"reputation": 6179, "user_id": 1691980, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/979c4577100103dc214bf0b1a9da657d?s=128&d=identicon&r=PG", "display_name": "Bruno Caceiro", "link": "https://stackoverflow.com/users/1691980/bruno-caceiro"}, "is_accepted": false, "score": 1, "last_activity_date": 1548283773, "creation_date": 1548283773, "answer_id": 54336884, "question_id": 54334519, "link": "https://stackoverflow.com/questions/54334519/valueinjecter-not-binding-properties-correctly/54336884#54336884", "title": "ValueInjecter not binding properties correctly", "body": "<p>I think the  ValueInjector only allows the injection a single object, however you can do this.</p>\n\n<pre><code>   IEnumerable&lt;SourceModel&gt; data = GetDataFromDB();\nIList&lt;DestinationModel&gt; finalAnswer = categoryList\n    .Select(x =&gt; new DestinationModel().InjectFrom(x)).Cast&lt;DestinationModel&gt;()\n    .ToList();\n</code></pre>\n\n<p>Or do a foreach and inject each object:</p>\n\n<pre><code>foreach (var a in data)\n{\n    finalAnswer.InjectFrom(a);\n}\n</code></pre>\n"}], "owner": {"reputation": 240, "user_id": 7793817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8722ecd77d416e7ca57cf2fd49348ece?s=128&d=identicon&r=PG&f=1", "display_name": "Alvin", "link": "https://stackoverflow.com/users/7793817/alvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548283773, "creation_date": 1548272397, "last_edit_date": 1548275254, "question_id": 54334519, "link": "https://stackoverflow.com/questions/54334519/valueinjecter-not-binding-properties-correctly", "title": "ValueInjecter not binding properties correctly", "body": "<p>I am having trouble getting SourceModel data getting mapped to DestinationModel data. The DestinationModel has complex object type. Although the name matches but I don't see any data getting bind correctly. I am new to ValueInjector and as per my understanding this is what I have tried. </p>\n\n<pre><code>public class SourceModel\n{\n    [Column(\"ctr_shname\")]\n    public string CtrShname { get; set; }\n\n    [Column(\"reg_name\")]\n    public string RegName { get; set; }\n\n    [Column(\"Male\")]\n    public Int64 Male { get; set; }\n\n    [Column(\"Female\")]\n    public Int64 Female { get; set; }\n\n    [Column(\"Single\")]\n    public Int64 Single { get; set; }\n\n    [Column(\"Married\")]\n    public Int64 Married { get; set; }\n\n    [Column(\"Divorced\")]\n    public Int64 Divorced { get; set; }\n\n    [Column(\"Separated\")]\n    public Int64 Separated { get; set; }\n\n    [Column(\"Widowed\")]\n    public Int64 Widowed { get; set; }\n}\n\npublic class DestinationModel\n{\n    public string CtrShname { get; set; }\n    public string RegName { get; set; }\n    public Gender Genders { get; set; }\n    public MaritalStatus MaritalStatuses { get; set; }\n}\n\npublic class Gender\n{\n    public Int64 Male { get; set; }\n    public Int64 Female { get; set; }\n}\n\npublic class MaritalStatus\n{\n    public Int64 Single { get; set; }\n    public Int64 Married { get; set; }\n    public Int64 Divorced { get; set; }\n    public Int64 Separated { get; set; }\n    public Int64 Widowed { get; set; }\n}\n</code></pre>\n\n<p>And this is my code to map.</p>\n\n<pre><code>// get data from DB (row count 123)\nIEnumerable&lt;SourceModel&gt; data = GetDataFromDB();\nList&lt;DestinationModel&gt; finalAnswer = new List&lt;DestinationModel&gt;();\n\n// Try 1: all properties are null for all 123 records\nfinalAnswer.InjectFrom(data);\n\n// Try 2: Zero count. Nothing gets binds\nvar mapper1 = new MapperInstance();\nfinalAnswer = mapper1.Map&lt;List&lt;DestinationModel&gt;&gt;(data);\n</code></pre>\n\n<p>Please help how do I correctly map?</p>\n"}, {"tags": ["c#", "cybersource"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3953872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f0925279804a8b93f43589747c37094?s=128&d=identicon&r=PG", "display_name": "Digiman", "link": "https://stackoverflow.com/users/3953872/digiman"}, "edited": false, "score": 0, "creation_date": 1552714037, "post_id": 54353479, "comment_id": 97125352, "body": "This samples is very simple and not fully functional. I tried to use API to download reports and it didn&#39;t work. Also almost all logic related on internal logger, console and other things that don&#39;t need to be inside library. Because of this i created a form for main library and maybe can do some basic updates. Also it would be great to get source for CyberSource.Authorization library for .NET. Looks like all of them has bad design and implementation. I am very sad to see this in such big product, maybe even serious. Very strange... :("}], "tags": [], "owner": {"reputation": 319, "user_id": 7423671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8799429ce39329a6aadd57cd391c462c?s=128&d=identicon&r=PG&f=1", "display_name": "Will H", "link": "https://stackoverflow.com/users/7423671/will-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1548355617, "creation_date": 1548355617, "answer_id": 54353479, "question_id": 54334493, "link": "https://stackoverflow.com/questions/54334493/creating-http-signature-for-cybersource-integration/54353479#54353479", "title": "Creating HTTP Signature for CyberSource integration", "body": "<p>I would add this as a comment, but I don't have enough reputation yet. I don't know what is wrong with your code, but here is pre-built CyberSource C# client that can be used to request a Flex key - <a href=\"https://github.com/CyberSource/cybersource-rest-samples-csharp\" rel=\"nofollow noreferrer\">https://github.com/CyberSource/cybersource-rest-samples-csharp</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4864255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b91cadd38da2a5ff84198228b513ebc?s=128&d=identicon&r=PG&f=1", "display_name": "sarn", "link": "https://stackoverflow.com/users/4864255/sarn"}, "is_accepted": false, "score": 1, "last_activity_date": 1554069780, "last_edit_date": 1554069780, "creation_date": 1554068941, "answer_id": 55445763, "question_id": 54334493, "link": "https://stackoverflow.com/questions/54334493/creating-http-signature-for-cybersource-integration/55445763#55445763", "title": "Creating HTTP Signature for CyberSource integration", "body": "<p>If I'm too late to the game for the OP, I hope my response will be helpful to others who are facing a similar issue.  Although my sample is POSTing to the PAYMENT method, the same issue applies in that I could not get my Digest and Signature hashes in the request header to match the examples and thus getting nothing but a 401 Unauthorized response from CyberSource.</p>\n\n<p>Simple answer is to use the \"official\" C# hashing functions that can found here: \n<a href=\"https://developer.cybersource.com/api/developer-guides/dita-gettingstarted/GenerateHeader/httpSignatureAuthentication.html#id191TE000FUI_id1925AC001Y4\" rel=\"nofollow noreferrer\">https://developer.cybersource.com/api/developer-guides/dita-gettingstarted/GenerateHeader/httpSignatureAuthentication.html#id191TE000FUI_id1925AC001Y4</a></p>\n\n<p>Still, you may not get the same hash when you compare your code to your example unless the body payload of what you're comparing is minified and the body payload of your example is minified as well.  I suspect that this is due to the differences in the final hash when comparing hashes to the two message bodies that may have the same content but differ in indentations, spacing, line-breaks, etc..  One small extra space throws the final hash off. But I assure you it's irrelevant that your hash differs from the example you are comparing against as long as your code is hashing the message body correctly.  Since the Digest hash is most likely being used to verify that the body of the request has not been tempered with.</p>\n\n<p>I have my working sample code here: <a href=\"https://github.com/sarn1/example-cybersource-csharp-api-rest\" rel=\"nofollow noreferrer\">https://github.com/sarn1/example-cybersource-csharp-api-rest</a> and a detailed explanation link there.</p>\n"}], "owner": {"reputation": 1, "user_id": 10957196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21328e8b8d2d1814d3797d47b554067b?s=128&d=identicon&r=PG&f=1", "display_name": "Fuzzy", "link": "https://stackoverflow.com/users/10957196/fuzzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1554069780, "creation_date": 1548272319, "last_edit_date": 1548693553, "question_id": 54334493, "link": "https://stackoverflow.com/questions/54334493/creating-http-signature-for-cybersource-integration", "title": "Creating HTTP Signature for CyberSource integration", "body": "<p>I'm trying to get my product to connect to CyberSource with C#, however I'm having trouble.</p>\n\n<p>In short, I'm trying to reproduce the Java code <a href=\"http://apps.cybersource.com/library/documentation/dev_guides/hosted_flex/0_4_0/html/wwhelp/wwhimpl/common/html/wwhelp.htm#href=custom_server_integration.html&amp;single=true\" rel=\"nofollow noreferrer\">here</a> and essentially translate it in <code>C#</code>.</p>\n\n<p>I end up with different results than they do.</p>\n\n<p>Things I have commented out I have also tried.\n</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Net;\nusing System.Security.Cryptography;\nusing System.Text;\n\nnamespace encoder\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n\n            string body = \"{\\n \\\"encryptionType\\\": \\\"RsaOaep\\\",\"\n+\"\\n \\\"targetOrigin\\\": \\\"https://example.com\\\"\\n}\";\n            Console.WriteLine(body);\n            string _merchantId = \"merchant\";\n            string keyID = \"01dbbc88-0736-4d31-94ed-7b84579731b2\";\n            string secret = \"SXQgaXMgc2hhcmVkIHNlY3JldA==\";\n            string url = \"https://apitest.cybersource.com/flex/v1/keys\";\n\n            //HashAlgorithm digester = new SHA256CryptoServiceProvider();\n            //byte[] digest = digester.ComputeHash(Encoding.UTF8.GetBytes(body));\n            //string value = string.Format(\"SHA-256={0}\", System.Convert.ToBase64String(digest));\n\n            byte[] bytes = Encoding.UTF8.GetBytes(body);\n            SHA256Managed hashstring = new SHA256Managed();\n            byte[] digest = hashstring.ComputeHash(bytes);\n            string value = string.Format(\"SHA-256={0}\", System.Convert.ToBase64String(digest));\n\n            Console.WriteLine(\"Digest: \" + value);\n            Console.ReadLine();\n            string todaysDate = DateTime.Now.ToString(\"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'\");\n            //string todaysDate = \"Mon, 01 Jan 2018 00:00:00 GMT\";\n            Console.WriteLine(\"Current Time: \" + todaysDate);\n\n            Dictionary&lt;string, string&gt; signedHeaders = new Dictionary&lt;string, string&gt;();\n            signedHeaders.Add(\"host\", \"apitest.cybersource.com\");\n            signedHeaders.Add(\"date\", todaysDate);\n            signedHeaders.Add(\"(request-target)\", \"post /flex/va/keys/\");\n            signedHeaders.Add(\"digest\", value);\n            //signedHeaders.Add(\"digest\", \"SHA-256=fRDzptXm4RRRD3pC/eoIBoHShRzjRAf7Xkj18upMtI8=\");\n            //signedHeaders.Add(\"digest\", \"SHA-256=YljtibTei+du4xVIDxMr3HBsyLAEDuiYaag9TcU9jHA=\");\n            signedHeaders.Add(\"v-c-merchant-id\", _merchantId);\n\n            Console.WriteLine(\"Signed Headers: \" + signedHeaders);\n            Console.ReadLine();\n\n            StringBuilder signatureString = new StringBuilder();\n            StringBuilder headersString = new StringBuilder();\n\n            foreach (KeyValuePair&lt;string, string&gt; s in signedHeaders)\n            {\n                signatureString.Append('\\n').Append(s.Key).Append(\": \").Append(s.Value);\n                headersString.Append(' ').Append(s.Key);\n            }\n            signatureString.Remove(0, 1);\n            headersString.Remove(0, 1);\n\n\n            HMACSHA256 sha256HMAC = new HMACSHA256(System.Convert.FromBase64String(secret));\n            sha256HMAC.Initialize();\n\n            StringBuilder signature = new StringBuilder();\n            byte[] hashBytes = sha256HMAC.ComputeHash(Encoding.UTF8.GetBytes(signatureString.ToString()));\n            signature.Append(\"keyid=\\\"\").Append(keyID)\n                .Append(\"\\\", \").Append(\"algorithm=\\\"HmacSHA256\\\", \")\n                .Append(\"headers=\\\"\").Append(headersString).Append(\"\\\", \")\n                .Append(\"digest: signature=\\\"\").Append(System.Convert.ToBase64String(hashBytes)).Append(\"\\\"\");\n\n            Console.WriteLine(\"Signature: \" + signature);\n            Console.ReadLine();\n\n\n            System.Net.ServicePointManager.SecurityProtocol = System.Net.SecurityProtocolType.Tls12;\n            HttpWebRequest myHttpWebRequest = (HttpWebRequest)WebRequest.Create(url);\n            myHttpWebRequest.Method = \"POST\";\n            myHttpWebRequest.ContentType = \"application/json\";\n            myHttpWebRequest.Headers[\"v-c-merchant-id\"] = _merchantId;\n            myHttpWebRequest.Host = \"apitest.cybersource.com\";\n            //myHttpWebRequest.Headers[\"v-c-date\"] = DateTime.Now.ToString();\n            myHttpWebRequest.Timeout = 30000;  //' 30 second timeout'\n            myHttpWebRequest.KeepAlive = false;\n            myHttpWebRequest.Date = DateTime.Now;\n            //myHttpWebRequest.Date = new DateTime(2018, 1, 1, 0, 0, 0);\n\n            string strResponse = string.Empty;\n\n            byte[] myBytes;\n            using (Stream myOutputStream = myHttpWebRequest.GetRequestStream())\n            {\n                myBytes = System.Text.Encoding.ASCII.GetBytes(body);\n                myOutputStream.Write(myBytes, 0, myBytes.Length);\n                myOutputStream.Close();\n            }\n\n            //http://msdn.microsoft.com/en-us/library/system.net.webresponse.getresponsestream%28v=vs.71%29.aspx\n            using (WebResponse myWebResponse = myHttpWebRequest.GetResponse())\n            {\n                Stream RecieveStream = myWebResponse.GetResponseStream();\n                Encoding encode = Encoding.UTF8;\n                StreamReader readStream = new StreamReader(RecieveStream, encode);\n\n                strResponse = readStream.ReadToEnd();\n\n            }\n\n            Console.WriteLine(\"Response: \" + strResponse);\n            Console.ReadLine();\n        }\n\n    }\n</code></pre>\n\n<p>I should get a response back from CyberSource, but I keep getting a <code>401 unauthorized error</code>.</p>\n\n<p>I also notice that the very first console.writeline gets a very different digest of <code>SHA-256=lJooQmwcasZC4okGe61dGdcdlE672vGi5x0D/vmcZx8=</code>. <br>\nI should get <code>SHA-256=YljtibTei+du4xVIDxMr3HBsyLAEDuiYaag9TcU9jHA=</code>.</p>\n\n<p><em>UPDATE</em></p>\n\n<p>I should also add that we are unable to use the CyberSource SDK as we cannot use ILMerge to merge with our DLL.</p>\n\n<p><em>Thanks!</em></p>\n"}, {"tags": ["c#", "arrays", "char"], "comments": [{"owner": {"reputation": 23752, "user_id": 1118978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2rloq.jpg?s=128&g=1", "display_name": "Dervi\u015f Kay\u0131mba\u015f\u0131o\u011flu", "link": "https://stackoverflow.com/users/1118978/dervi%c5%9f-kay%c4%b1mba%c5%9f%c4%b1o%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1548272264, "post_id": 54334445, "comment_id": 95486463, "body": "do you obliged to use character shifting with for loop? or can you use LINQ query?"}, {"owner": {"reputation": 57478, "user_id": 1783619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/9BIvl.png?s=128&g=1", "display_name": "BradleyDotNET", "link": "https://stackoverflow.com/users/1783619/bradleydotnet"}, "edited": false, "score": 0, "creation_date": 1548272424, "post_id": 54334445, "comment_id": 95486515, "body": "Sounds like you need to swap the two characters, not just assign"}, {"owner": {"reputation": 41, "user_id": 10957584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d139c22bc3b769f1580b2a2a23cdb10?s=128&d=identicon&r=PG&f=1", "display_name": "Miel Elhorst", "link": "https://stackoverflow.com/users/10957584/miel-elhorst"}, "edited": false, "score": 0, "creation_date": 1548272575, "post_id": 54334445, "comment_id": 95486588, "body": "If possible, I&#39;d like to use a for loop, yes. I just started programming, haven&#39;t heard of LINQ yet..."}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1548272903, "post_id": 54334445, "comment_id": 95486725, "body": "What you are going to want to do is reach inside the array, pull out &quot;the first to last character&quot; (which seems to be the &quot;second last&quot; one), put it in a variable for later.  Then loop, from the back to the front, (skipping the last character and the first character) and copying the (n-1) character into the (n) spot.  When you are finished, plunk that second last character you put aside into the second spot.  Don&#39;t forget that everything is 0-based (which works very well when looping from 0 to n-1, but is very weird in the other direction."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 1, "creation_date": 1548273147, "post_id": 54334445, "comment_id": 95486823, "body": "Store the second-last element (element n-1; <code>e</code>) in a temp variable. Use a single call of  <code>Array.Copy</code> to move the elements 1,...,n-2. Place the element in the temp variable in array slot #1. Done..."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1548273399, "post_id": 54334445, "comment_id": 95486931, "body": "I recommend that beginner programmers solve this problem on paper first; actually get a piece of paper and a pencil and an eraser, write out the array on the page, and then simulate the operations you need to perform. <b>Carefully write down every little step you do along the way</b>, and then carefully translate that algorithm into code."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 2, "creation_date": 1548273453, "post_id": 54334445, "comment_id": 95486955, "body": "Also: <b>break yourself of the habit of using ++ inside another expression right now</b>.  It does nothing for you except make your algorithm harder to understand and harder to get right."}, {"owner": {"reputation": 41, "user_id": 10957584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d139c22bc3b769f1580b2a2a23cdb10?s=128&d=identicon&r=PG&f=1", "display_name": "Miel Elhorst", "link": "https://stackoverflow.com/users/10957584/miel-elhorst"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1548274204, "post_id": 54334445, "comment_id": 95487251, "body": "Thank you for the advice @EricLippert :)"}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1548279063, "post_id": 54334445, "comment_id": 95489213, "body": "Does the variable need to be an array? If you plan to move elements around like this, you might be better off using a <code>List&lt;char&gt;</code> which will shift the other elements when you <a href=\"https://stackoverflow.com/questions/10110872/c-sharp-listint-how-to-insert-a-new-value-in-between-two-values\">add</a> or <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.list-1.remove?view=netframework-4.7.2\" rel=\"nofollow noreferrer\">remove</a>. Or use a temp list and <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.toarray?view=netframework-4.7.2\" rel=\"nofollow noreferrer\">convert it back to an array</a> after you&#39;re done moving things."}], "answers": [{"comments": [{"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1548273132, "post_id": 54334647, "comment_id": 95486814, "body": "@meilelhorst: This is exactly what I described in my comment.  See if you can figure out how to do this from the comment without looking at this code."}, {"owner": {"reputation": 41, "user_id": 10957584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d139c22bc3b769f1580b2a2a23cdb10?s=128&d=identicon&r=PG&f=1", "display_name": "Miel Elhorst", "link": "https://stackoverflow.com/users/10957584/miel-elhorst"}, "reply_to_user": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 1, "creation_date": 1548273625, "post_id": 54334647, "comment_id": 95487021, "body": "@Flydog57 Thank you both! I was wondering if going from back to front would make a difference, and I&#39;m happy to see it does. I will try to re-write the code a couple of times myself so I can understand it better ;)"}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "reply_to_user": {"reputation": 41, "user_id": 10957584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d139c22bc3b769f1580b2a2a23cdb10?s=128&d=identicon&r=PG&f=1", "display_name": "Miel Elhorst", "link": "https://stackoverflow.com/users/10957584/miel-elhorst"}, "edited": false, "score": 0, "creation_date": 1548276583, "post_id": 54334647, "comment_id": 95488199, "body": "@MielElhorst: If you follow Eric Lippert&#39;s advice (to do it first on paper), you will see that the way to make this work (on paper) is to start at the end and work backwards.  If you start at the beginning, you have don&#39;t have any &quot;empty slots&quot; to put your newly moved character, whereas, if you start at the end, you can move it into the most recently vacated spot."}], "tags": [], "owner": {"reputation": 16713, "user_id": 48910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5ce4658498bca7a7e2c2ab9607d664?s=128&d=identicon&r=PG", "display_name": "Meta-Knight", "link": "https://stackoverflow.com/users/48910/meta-knight"}, "is_accepted": false, "score": 2, "last_activity_date": 1548272995, "creation_date": 1548272995, "answer_id": 54334647, "question_id": 54334445, "link": "https://stackoverflow.com/questions/54334445/how-to-move-everything-up-one-spot-in-an-array-c/54334647#54334647", "title": "How to move everything up one spot in an array? C#", "body": "<ol>\n<li>Start from the end rather than the start so that you don't copy over characters that you already changed.</li>\n<li>I don't think you intended to use \"++\" inside your loop. This changes the value of t and is not needed.</li>\n</ol>\n\n<p>Here is the resulting code:</p>\n\n<pre><code>if (myArray.Length &gt; 3)\n{\n    char savechar = myArray[myArray.Length - 2];\n    for (int t = myArray.Length - 2; t &gt; 1; t--)\n    {\n        myArray[t] = myArray[t-1];\n    }\n    myArray[1] = savechar;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1907, "user_id": 636509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0c7ffce123e90970fe76ec3a48ed20?s=128&d=identicon&r=PG", "display_name": "TommyN", "link": "https://stackoverflow.com/users/636509/tommyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1548273226, "creation_date": 1548273226, "answer_id": 54334702, "question_id": 54334445, "link": "https://stackoverflow.com/questions/54334445/how-to-move-everything-up-one-spot-in-an-array-c/54334702#54334702", "title": "How to move everything up one spot in an array? C#", "body": "<p>This gives the required result. Note that there are no length checks since I'm using your sample input. And no effort to make it efficient ;)</p>\n\n<pre><code>var list = \"abcdef\".ToCharArray().ToList();    \nvar item = list.ElementAt(list.Count - 2);\nlist.RemoveAt(list.Count - 2);\nlist.Insert(1, item);\nvar reordered = string.Join(string.Empty, list);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 584, "user_id": 4750010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Telsq.jpg?s=128&g=1", "display_name": "Kristoffer Lerb&#230;k Pedersen", "link": "https://stackoverflow.com/users/4750010/kristoffer-lerb%c3%a6k-pedersen"}, "is_accepted": false, "score": 1, "last_activity_date": 1548273620, "creation_date": 1548273620, "answer_id": 54334804, "question_id": 54334445, "link": "https://stackoverflow.com/questions/54334445/how-to-move-everything-up-one-spot-in-an-array-c/54334804#54334804", "title": "How to move everything up one spot in an array? C#", "body": "<p>Here's my take:</p>\n\n<pre><code>for (int i = 1; i &lt; input.Length - 1; i++)\n{\n  var temp = input[i];\n  input[i] = input[input.Length - 2];\n  input[input.Length - 2] = temp;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2496, "user_id": 3512524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d86f158f96941fef8bb311262cf3ad0e?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Skowronek", "link": "https://stackoverflow.com/users/3512524/krzysztof-skowronek"}, "is_accepted": false, "score": 0, "last_activity_date": 1548274061, "creation_date": 1548274061, "answer_id": 54334878, "question_id": 54334445, "link": "https://stackoverflow.com/questions/54334445/how-to-move-everything-up-one-spot-in-an-array-c/54334878#54334878", "title": "How to move everything up one spot in an array? C#", "body": "<p>this will work only for strings, but it works:</p>\n\n<pre><code>    var text = \"abcdef\";\n    var shifted = text.First() + text.Substring(text.Length - 2, 1) + text.Substring(0, text.Length - 2) + text.Last();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6829, "user_id": 5649561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xNgLZ.jpg?s=128&g=1", "display_name": "Vadim Martynov", "link": "https://stackoverflow.com/users/5649561/vadim-martynov"}, "is_accepted": false, "score": 0, "last_activity_date": 1548277408, "last_edit_date": 1548277408, "creation_date": 1548274132, "answer_id": 54334894, "question_id": 54334445, "link": "https://stackoverflow.com/questions/54334445/how-to-move-everything-up-one-spot-in-an-array-c/54334894#54334894", "title": "How to move everything up one spot in an array? C#", "body": "<p>Here is an universal algorytm to cycle shift <code>array</code> by <code>shiftCount</code> elements and skip <code>skippedElements</code> at the start and at the end of <code>array</code>:</p>\n\n<pre><code>var array = new char[] {'a', 'b', 'c', 'd', 'e', 'f'};\n\nvar skippedElements = 1;\nvar shiftCount = 1;\nbool shiftLeft = true;\nif (shiftLeft)\n{\n    // shift left\n    Array.Reverse(array, skippedElements, shiftCount);\n    Array.Reverse(array, skippedElements + shiftCount, array.Length - skippedElements * 2 - shiftCount);\n    Array.Reverse(array, skippedElements, array.Length - skippedElements - shiftCount);\n\n}\nelse\n{\n    // shift right\n    Array.Reverse(array, skippedElements, array.Length - skippedElements * 2);\n    Array.Reverse(array, skippedElements + shiftCount,  array.Length - skippedElements * 2 - shiftCount);\n    Array.Reverse(array, skippedElements, shiftCount);\n}\n</code></pre>\n\n<p>It's modification for <a href=\"https://thejeshvenkata.github.io/HTMLPages/program-for-array-rotation-continued-reversal-algorithm.html\" rel=\"nofollow noreferrer\">Reversal algorithm for array rotation</a>. It works for <code>skippedElements &gt; 0</code>. it does not require additional variables or memory.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 10897855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c96f3a040fb49ff1d44ca6d7349b83b?s=128&d=identicon&r=PG&f=1", "display_name": "NPCampbell", "link": "https://stackoverflow.com/users/10897855/npcampbell"}, "is_accepted": false, "score": 1, "last_activity_date": 1548275112, "creation_date": 1548275112, "answer_id": 54335098, "question_id": 54334445, "link": "https://stackoverflow.com/questions/54334445/how-to-move-everything-up-one-spot-in-an-array-c/54335098#54335098", "title": "How to move everything up one spot in an array? C#", "body": "<p>Using Array.Copy:</p>\n\n<pre><code>if (myArray.Length &gt; 3)\n{\n    char savechar = myArray[myArray.Length - 2];\n    Array.Copy(myArray, 1, myArray, 2, myArray.Length - 3);\n    myArray[1] = savechar;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 135520, "user_id": 1715579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/4B4y1.png?s=128&g=1", "display_name": "p.s.w.g", "link": "https://stackoverflow.com/users/1715579/p-s-w-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1548352443, "creation_date": 1548352443, "answer_id": 54352721, "question_id": 54334445, "link": "https://stackoverflow.com/questions/54334445/how-to-move-everything-up-one-spot-in-an-array-c/54352721#54352721", "title": "How to move everything up one spot in an array? C#", "body": "<p>For what it's worth, I'd probably go with <a href=\"https://stackoverflow.com/a/54335098/1715579\">NPCampbell's <code>Array.Copy</code> solution</a> if this were a production system, but for the sake of demonstration (and just a little code-golf fun) here's a solution using Linq:</p>\n\n<pre><code>var n = myArray.Length - 1;\nvar newArray = myArray.Select((_, i) =&gt; myArray[i % n &gt; 0 ? (i &gt; 1 ? i : n) - 1 : i]).ToArray();\n</code></pre>\n\n<p>It's not the most performant option and definitely not the very readable, but it works.</p>\n"}], "owner": {"reputation": 41, "user_id": 10957584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d139c22bc3b769f1580b2a2a23cdb10?s=128&d=identicon&r=PG&f=1", "display_name": "Miel Elhorst", "link": "https://stackoverflow.com/users/10957584/miel-elhorst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "answer_count": 7, "score": 4, "last_activity_date": 1548352443, "creation_date": 1548272106, "question_id": 54334445, "link": "https://stackoverflow.com/questions/54334445/how-to-move-everything-up-one-spot-in-an-array-c", "title": "How to move everything up one spot in an array? C#", "body": "<p>I'm trying to make a method that moves every character in between the first and last character in an array up one spot. Also, the first to last character has to 'move' to the second spot in the array ([1]). in short, I want 'abcdef' to become 'aebcdf'.\nThis is what I came up with:</p>\n\n<pre><code>                if (myArray.Length &gt; 3)\n            {\n                char savechar = myArray[myArray.Length - 2];\n                for (int t = 1; t &lt; (myArray.Length - 2); t++)\n                {\n                    myArray[t++] = myArray[t];\n                }\n                myArray[1] = savechar;\n            }\n</code></pre>\n\n<p>Problem here is, it just moves the second character to the end, instead of moving all characters up one spot. (I know why it does that, I just don't know how I can fix this)\nSomeone help?</p>\n"}, {"tags": ["c#", "jquery", "asp.net-mvc-5"], "comments": [{"owner": {"reputation": 619, "user_id": 2623538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhR1w.jpg?s=128&g=1", "display_name": "NaDeR Star", "link": "https://stackoverflow.com/users/2623538/nader-star"}, "edited": false, "score": 1, "creation_date": 1548271828, "post_id": 54334338, "comment_id": 95486274, "body": "Your hidden inputs got same id... &quot;msg&quot;"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "edited": false, "score": 1, "creation_date": 1548271841, "post_id": 54334338, "comment_id": 95486278, "body": "Side note: invalid HTML (with duplicate IDs) can produce undefined results just fine... Please decide if you have HTML/jQuery question (and show HTML instead of CSHTML) or C#/CSHTML (than you need to show some C# code too)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10607827, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WnKs6NBrlV4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAj_xqvY_5wdpZTg4lJ09FhVA5hMA/mo/photo.jpg?sz=128", "display_name": "ts_10607827", "link": "https://stackoverflow.com/users/10607827/ts-10607827"}, "reply_to_user": {"reputation": 1, "user_id": 10957645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yUhXhjwWAp0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPpC0skg6ycs2Na5WB8IlarI8KX4w/mo/photo.jpg?sz=128", "display_name": "Adhi", "link": "https://stackoverflow.com/users/10957645/adhi"}, "edited": false, "score": 0, "creation_date": 1548321079, "post_id": 54334699, "comment_id": 95501660, "body": "@Adhi which part is not working for you? If you describe in more words I can help you"}], "tags": [], "owner": {"reputation": 1, "user_id": 10607827, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-WnKs6NBrlV4/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAj_xqvY_5wdpZTg4lJ09FhVA5hMA/mo/photo.jpg?sz=128", "display_name": "ts_10607827", "link": "https://stackoverflow.com/users/10607827/ts-10607827"}, "is_accepted": false, "score": 0, "last_activity_date": 1548322134, "last_edit_date": 1548322134, "creation_date": 1548273220, "answer_id": 54334699, "question_id": 54334338, "link": "https://stackoverflow.com/questions/54334338/how-to-access-value-from-foreach-loop-for-hidden-input/54334699#54334699", "title": "How To Access Value From Foreach Loop For Hidden Input?", "body": "<p>As mentioned in comments you have same id \"msg\". \nInstead of using multiple id's I would suggest you to use a class \"msg\" for input instead.</p>\n\n<p>If it's important that you match like u did with table row then input with id msg:</p>\n\n<pre><code>$(\"tr\").find('input#msg').val();\n</code></pre>\n\n<p>The equivalent would be</p>\n\n<pre><code>$(\"tr &gt; input.msg\").val();\n</code></pre>\n\n<p>If you want to access a specific hidden input you can access like:</p>\n\n<pre><code>$(\"tr &gt; input.msg\")[1].value;\n</code></pre>\n\n<p>To show you how it works I created a dotnetfiddle for you. Maybe the problem you facing is that you missed to create a table tag surrounding your code to work properly otherwise you cannot have a table row...\n<a href=\"https://dotnetfiddle.net/Jt7KGp\" rel=\"nofollow noreferrer\">https://dotnetfiddle.net/Jt7KGp</a></p>\n"}, {"tags": [], "owner": {"reputation": 369, "user_id": 10799102, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O6uW5cY_hZ8/AAAAAAAAAAI/AAAAAAAAO_0/Y9gY5YJqYr8/photo.jpg?sz=128", "display_name": "Vitor Kevin", "link": "https://stackoverflow.com/users/10799102/vitor-kevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1548278908, "creation_date": 1548278908, "answer_id": 54335927, "question_id": 54334338, "link": "https://stackoverflow.com/questions/54334338/how-to-access-value-from-foreach-loop-for-hidden-input/54335927#54335927", "title": "How To Access Value From Foreach Loop For Hidden Input?", "body": "<p>Remove the <strong>id</strong> and put <strong>class</strong>, cause id is unique in the html  and\nclass can repeat the class name in any elements</p>\n\n<pre><code> @foreach (var item in Model)\n    {\n    &lt;tr&gt;\n        &lt;input type=\"hidden\" class=\"msg\" value=\"1\" /&gt;\n        @Html.HiddenFor(x =&gt; item.studentid, new { @id = \"studentidforRejectectionadmission\" })\n        &lt;td&gt;@Html.DisplayFor(modelItem =&gt; item.fullname)&lt;/td&gt;\n        &lt;td&gt;@Html.DisplayFor(modelItem =&gt; item.classname)&lt;/td&gt;\n    &lt;/tr&gt;\n    }\n</code></pre>\n\n<blockquote>\n  <p>now you can access the input value by the jquery eloquent selector</p>\n</blockquote>\n\n<pre><code>let val = $(\"tr\").find('.msg').eq(0).val();\nconsole.log(val);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10957645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yUhXhjwWAp0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPpC0skg6ycs2Na5WB8IlarI8KX4w/mo/photo.jpg?sz=128", "display_name": "Adhi", "link": "https://stackoverflow.com/users/10957645/adhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 944, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548322134, "creation_date": 1548271589, "question_id": 54334338, "link": "https://stackoverflow.com/questions/54334338/how-to-access-value-from-foreach-loop-for-hidden-input", "title": "How To Access Value From Foreach Loop For Hidden Input?", "body": "<p>Here I am trying to get the value form hidden type input<code>&lt;input type=\"hidden\" id=\"msg\" value=\"1\" /&gt;</code> which is inside the foreach loop and inside the table row using jquery. But my script returns nothing.<br>\nSO any assistance with my approach will be a great help.\n<br><br>\nBelow is my html<br></p>\n\n<pre><code>@foreach (var item in Model)\n{\n&lt;tr&gt;\n    &lt;input type=\"hidden\" id=\"msg\" value=\"1\" /&gt;\n    @Html.HiddenFor(x =&gt; item.studentid, new { @id = \"studentidforRejectectionadmission\" })\n    &lt;td&gt;@Html.DisplayFor(modelItem =&gt; item.fullname)&lt;/td&gt;\n    &lt;td&gt;@Html.DisplayFor(modelItem =&gt; item.classname)&lt;/td&gt;\n&lt;/tr&gt;\n}\n</code></pre>\n\n<p><br><br>\nBelow is my script for  accessing value<br></p>\n\n<pre><code>$(\"tr\").find('input#msg').val();\n</code></pre>\n"}, {"tags": ["c#", ".net", ".net-core", "pinvoke"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1548271718, "post_id": 54334232, "comment_id": 95486224, "body": "What is <code>_Bool</code>"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1548271774, "post_id": 54334232, "comment_id": 95486252, "body": "Is there any math going on in the DLL that would overflow a 32-bit integer? Though, I suppose that would show up in the command line test, too"}, {"owner": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1548271964, "post_id": 54334232, "comment_id": 95486324, "body": "Can the dll log debug info, or can you attach a C debugger to the .net app to see what is happening in the dll?"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1548272168, "post_id": 54334232, "comment_id": 95486424, "body": "Seems difficult to believe. Do you have a small reproducing project?"}, {"owner": {"reputation": 998, "user_id": 451693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8171bfdcb7636a38687da2ad75f2c497?s=128&d=identicon&r=PG", "display_name": "9ee1", "link": "https://stackoverflow.com/users/451693/9ee1"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1548272392, "post_id": 54334232, "comment_id": 95486500, "body": "@PhilM I don&#39;t see any operations in the C DLL that would cause it to overflow and like you say if it did, it should show up in the C command line app as well. I can modify the C code to print debug info and rebuild and see."}, {"owner": {"reputation": 998, "user_id": 451693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8171bfdcb7636a38687da2ad75f2c497?s=128&d=identicon&r=PG", "display_name": "9ee1", "link": "https://stackoverflow.com/users/451693/9ee1"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1548272430, "post_id": 54334232, "comment_id": 95486518, "body": "@SimonMourier Yes, I have a small reproducing app. What is the best way to share that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 1, "creation_date": 1548272475, "post_id": 54334232, "comment_id": 95486536, "body": "Is your <code>_Bool</code> really based on <code>bool</code> and not <code>BOOL</code>? Please look here to understand the differences in marshalling the &quot;native&quot; <code>bool</code> and <code>BOOL</code>: <a href=\"https://blogs.msdn.microsoft.com/jaredpar/2008/10/14/pinvoke-and-bool-or-should-i-say-bool/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/jaredpar/2008/10/14/&hellip;</a> (<code>bool</code> is a C++ data type, whereas <code>BOOL</code> is a different data type declared by the Windows API)"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1548274684, "post_id": 54334232, "comment_id": 95487430, "body": "Any where you can post a .zip. or if the important part is just a .cs, post it to pastebin.bin for example"}, {"owner": {"reputation": 998, "user_id": 451693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8171bfdcb7636a38687da2ad75f2c497?s=128&d=identicon&r=PG", "display_name": "9ee1", "link": "https://stackoverflow.com/users/451693/9ee1"}, "edited": false, "score": 0, "creation_date": 1548276559, "post_id": 54334232, "comment_id": 95488190, "body": "@elgonzo So when I did a <code>sizeof(_Bool)</code>, it says its 1 byte. I am confused by the C spec though cause it says <code>_Bool</code> should be large enough to store <code>0</code> and <code>1</code> but it also says it should &quot;correspond to the standard unsigned integer types&quot;. You might be onto something though because when I changed the signature of the C function to return a <code>int32_t</code> instead of ` <code>_Bool</code>, the problem goes away. So something is blowing up in the marshaling I think."}, {"owner": {"reputation": 998, "user_id": 451693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8171bfdcb7636a38687da2ad75f2c497?s=128&d=identicon&r=PG", "display_name": "9ee1", "link": "https://stackoverflow.com/users/451693/9ee1"}, "reply_to_user": {"reputation": 1619, "user_id": 7864413, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208517922736756/picture?type=large", "display_name": "Phil M", "link": "https://stackoverflow.com/users/7864413/phil-m"}, "edited": false, "score": 0, "creation_date": 1548276747, "post_id": 54334232, "comment_id": 95488251, "body": "@PhilM So I debugged the C DLL from the C# app and the correct value is being returned by the C function. But it looks like marshaling (see my previous comment) to .NET is where the problem is."}, {"owner": {"reputation": 998, "user_id": 451693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8171bfdcb7636a38687da2ad75f2c497?s=128&d=identicon&r=PG", "display_name": "9ee1", "link": "https://stackoverflow.com/users/451693/9ee1"}, "edited": false, "score": 0, "creation_date": 1548277532, "post_id": 54334232, "comment_id": 95488539, "body": "@elgonzo The article you posted put me on the right track! If I annotate my C# P/Invoke signature with <code>[return: MarshalAs(UnmanagedType.I1)]</code> the problem goes away! Though I don&#39;t know why since both <code>sizeof(_Bool)</code> in C and <code>sizeof(bool)</code> in C# == 1 byte and I positive my <code>_Bool</code> is based on <code>bool</code> and not <code>BOOL</code>."}, {"owner": {"reputation": 998, "user_id": 451693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8171bfdcb7636a38687da2ad75f2c497?s=128&d=identicon&r=PG", "display_name": "9ee1", "link": "https://stackoverflow.com/users/451693/9ee1"}, "reply_to_user": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1548277619, "post_id": 54334232, "comment_id": 95488575, "body": "@SimonMourier Thank you but I got it working, albeit without really understanding why the solution works :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 0, "creation_date": 1548279290, "post_id": 54334232, "comment_id": 95489319, "body": "@9ee1, the explanation is in the article i linked. Long story short, C has no <code>bool</code> data type. <code>bool</code> is a C++ data type. Since the Windows API (Win32 API) is based on C (not C++), it defines its own <code>BOOL</code> data type which is 4 bytes long. The .NET marshaller <b>by default</b> marshalls the C# bool to/from the Windows API <code>BOOL</code> (4 bytes) when p/invoking, unless specifically intstructed to do differently ;-)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "is_accepted": true, "score": 3, "last_activity_date": 1548280441, "last_edit_date": 1548280441, "creation_date": 1548279821, "answer_id": 54336154, "question_id": 54334232, "link": "https://stackoverflow.com/questions/54334232/p-invoke-c-p-invoking-a-c-function-returns-different-values-depending-on-platf/54336154#54336154", "title": "P/Invoke: C# P/Invoking a C Function Returns Different Values Depending on Platform (X86 vs. X64)?", "body": "<p>From the discussion in the comments, it became clear that the problem was caused by the native function returning a <code>_Bool</code> value, with the type <code>_Bool</code> having a byte size of 1.</p>\n\n<p>However, by default the .NET marshaller marshalls a C# <code>bool</code> to and from the Windows API data type <code>BOOL</code>, which has a byte size of 4 (also <a href=\"https://blogs.msdn.microsoft.com/jaredpar/2008/10/14/pinvoke-and-bool-or-should-i-say-bool/\" rel=\"nofollow noreferrer\">see here</a>).</p>\n\n<p>To correctly marshall the single-byte <code>_Bool</code> value, the marshaller needs to be explicitly instructed to marshall the C# <code>bool</code> value as a single byte:</p>\n\n<pre><code>[DllImport(\"capstone\", CallingConvention = CallingConvention.Cdecl)]\n[return: MarshalAs(UnmanagedType.I1)]\ninternal static extern bool cs_support(int queryOption);\n</code></pre>\n"}], "owner": {"reputation": 998, "user_id": 451693, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8171bfdcb7636a38687da2ad75f2c497?s=128&d=identicon&r=PG", "display_name": "9ee1", "link": "https://stackoverflow.com/users/451693/9ee1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 54336154, "answer_count": 1, "score": 0, "last_activity_date": 1548280441, "creation_date": 1548271127, "last_edit_date": 1548273173, "question_id": 54334232, "link": "https://stackoverflow.com/questions/54334232/p-invoke-c-p-invoking-a-c-function-returns-different-values-depending-on-platf", "title": "P/Invoke: C# P/Invoking a C Function Returns Different Values Depending on Platform (X86 vs. X64)?", "body": "<p>I feel ridiculous asking this question but I have a problem I've been looking at for hours now and I can't for the life of me figure out what is wrong.</p>\n\n<p>I have the following function signature defined in a C DLL:</p>\n\n<pre><code>__declspec(dllexport) _Bool __cdecl cs_support(int query);\n</code></pre>\n\n<p>I created the following P/Invoke signature equivalent in an internal class:</p>\n\n<pre><code>[DllImport(\"capstone\", CallingConvention = CallingConvention.Cdecl)]\ninternal static extern bool cs_support(int queryOption);\n</code></pre>\n\n<p>The internal class is defined in a .NET project that builds 2 assemblies, 1 for .NET Framework and one for .NET Core.</p>\n\n<p>I create a small .NET command line application that loads both the .NET assembly and the C DLL and calls the function as follows:</p>\n\n<pre><code>var isSupported = NativeImport.cs_support(65503);\n</code></pre>\n\n<p>Now here is what is interesting that I can't figure out. When I call the function once if the application targets X86 and once if it targets X64 (hence either the X86 or X64 versions of the C DLL are loaded), I get different values! What is even more bizarre is the X64 version returns the correct value while the X86 version does not!</p>\n\n<p>I have access to the source code of the C DLL and it has no processor directives to return different values for the same inpuut based on target platform. The C code is actually very straight forward should return the same value for the same input regardless of the target platform.</p>\n\n<p>In addition, when I create a small C command line app to test, the same correct values are returned regardless of the target platform.</p>\n\n<p>So it seems that only when the C DLL is loaded by a .NET and P/Invoked do I see this behavior!</p>\n\n<p>So my question is, why is this happening? Is there some weird P/Invoke behavior that would cause this that I would have to watch out for?</p>\n\n<p>I am running on Windows 10 64 Bit if that matters.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "uwp", "log4net", "xml-configuration"], "comments": [{"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1548271893, "post_id": 54334136, "comment_id": 95486302, "body": "I suspect it isn&#39;t loading your configuration.  Test this by inserting a bunch of garbage into the XML.  Where is your XML configuration located relative to the project?  Can you share more of the configuration as well?"}, {"owner": {"reputation": 1342, "user_id": 919700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8a56d6e5177348776169e5f3d9099232?s=128&d=identicon&r=PG", "display_name": "Cristiano Ghersi", "link": "https://stackoverflow.com/users/919700/cristiano-ghersi"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1548273676, "post_id": 54334136, "comment_id": 95487044, "body": "I updated the question with the relevant code. Note: if I update the conversionPattern in the XML e.g. to &quot;%date - %message%newline&quot;, I can see this change reflected in the logs."}, {"owner": {"reputation": 302, "user_id": 7924641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec7052c8fa1d7db231e6b6cb64636d8?s=128&d=identicon&r=PG&f=1", "display_name": "Bite", "link": "https://stackoverflow.com/users/7924641/bite"}, "edited": false, "score": 0, "creation_date": 1548319305, "post_id": 54334136, "comment_id": 95500744, "body": "I checked its source code,  It should be default behavior. See <a href=\"https://github.com/apache/logging-log4net/blob/master/src/Core/LogImpl.cs#L414\" rel=\"nofollow noreferrer\">github.com/apache/logging-log4net/blob/master/src/Core/&hellip;</a> If you do not want this format, you need to change its source code and compile a custom version for your project."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "reply_to_user": {"reputation": 302, "user_id": 7924641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec7052c8fa1d7db231e6b6cb64636d8?s=128&d=identicon&r=PG&f=1", "display_name": "Bite", "link": "https://stackoverflow.com/users/7924641/bite"}, "edited": false, "score": 0, "creation_date": 1548338538, "post_id": 54334136, "comment_id": 95512190, "body": "@Bite <code>If you do not want this format, you need to change its source code and compile a custom version for your project</code>  Uh, no, log4net is configurable.  I&#39;m guessing you have never used a logging framework.  It would be useless if you couldn&#39;t change the defaults!"}, {"owner": {"reputation": 1342, "user_id": 919700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8a56d6e5177348776169e5f3d9099232?s=128&d=identicon&r=PG", "display_name": "Cristiano Ghersi", "link": "https://stackoverflow.com/users/919700/cristiano-ghersi"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1548365784, "post_id": 54334136, "comment_id": 95526468, "body": "@Amy how can I configure correctly my app then?"}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1548365811, "post_id": 54334136, "comment_id": 95526480, "body": "I don&#39;t know, I see nothing immediately wrong with your code, but its been a few years since I last used log4net.  If I knew the answer to that, I would have answered your question."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "reply_to_user": {"reputation": 302, "user_id": 7924641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec7052c8fa1d7db231e6b6cb64636d8?s=128&d=identicon&r=PG&f=1", "display_name": "Bite", "link": "https://stackoverflow.com/users/7924641/bite"}, "edited": false, "score": 0, "creation_date": 1548383497, "post_id": 54334136, "comment_id": 95531015, "body": "@Bite You don&#39;t do that.  You use configuration to change how log4net behaves.   In this case, it is the appenders, not the loggers, that needs to be configured.  This is central to any modern .Net logging framework&#39;s architecture.  Please follow any log4net tutorial, or any NLog tutorial.  Again, it is <i>completely</i> unnecessary to use inheritance or modify the source code of log4net to achieve a change in how the appender&#39;s work."}, {"owner": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1548383786, "post_id": 54334136, "comment_id": 95531079, "body": "@CristianoGhersi Can you add your entire log4net configuration to the question?  It&#39;s apparently ignoring your appender and using a default."}, {"owner": {"reputation": 1342, "user_id": 919700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8a56d6e5177348776169e5f3d9099232?s=128&d=identicon&r=PG", "display_name": "Cristiano Ghersi", "link": "https://stackoverflow.com/users/919700/cristiano-ghersi"}, "reply_to_user": {"reputation": 30819, "user_id": 47589, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16703987f5d8e44af08a28f4942ec0f1?s=128&d=identicon&r=PG", "display_name": "Rainbow Dash", "link": "https://stackoverflow.com/users/47589/rainbow-dash"}, "edited": false, "score": 0, "creation_date": 1548692713, "post_id": 54334136, "comment_id": 95623175, "body": "@Amy I added the full content of the Log4net config file"}], "owner": {"reputation": 1342, "user_id": 919700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/8a56d6e5177348776169e5f3d9099232?s=128&d=identicon&r=PG", "display_name": "Cristiano Ghersi", "link": "https://stackoverflow.com/users/919700/cristiano-ghersi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1548692686, "creation_date": 1548270728, "last_edit_date": 1548692686, "question_id": 54334136, "link": "https://stackoverflow.com/questions/54334136/avoid-printing-the-logger-name-in-log4net", "title": "Avoid printing the logger name in log4net", "body": "<p>I am using log4net in an UWP app.</p>\n\n<p>my config file is the following:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;log4net debug=\"false\"&gt;\n    &lt;appender name=\"Console\" type=\"log4net.Appender.DebugAppender\"&gt;\n        &lt;layout type=\"log4net.Layout.PatternLayout\"&gt;\n            &lt;conversionPattern value=\"%date - %message%newline\" /&gt;\n        &lt;/layout&gt;\n    &lt;/appender&gt;\n\n    &lt;appender name=\"LocalStorageFile\" type=\"MyProject.LocalStorageFileAppender, MyProject\"&gt;\n        &lt;layout type=\"log4net.Layout.PatternLayout\"&gt;\n            &lt;conversionPattern value=\"%date - %message%newline\" /&gt;\n        &lt;/layout&gt;\n    &lt;/appender&gt;\n\n    &lt;root&gt;\n        &lt;level value=\"INFO\" /&gt;\n        &lt;appender-ref ref=\"Console\" /&gt;\n        &lt;appender-ref ref=\"LocalStorageFile\" /&gt;\n    &lt;/root&gt;\n&lt;/log4net&gt;\n</code></pre>\n\n<p>Since this is an UWP app, I need to manually load the XML file with the following method:</p>\n\n<pre><code>private static async Task ConfigureLog4Net()\n{\n    // config for log4net:\n    Uri uri = new Uri(\"ms-appx:///log4netConfig.xml\");\n    StorageFile sampleFile = await StorageFile.GetFileFromApplicationUriAsync(uri);\n    var logRepository = LogManager.GetRepository(Assembly.GetEntryAssembly());\n    using (Stream s = await sampleFile.OpenStreamForReadAsync())\n    {\n        log4net.Config.XmlConfigurator.Configure(logRepository, s);\n    }\n    Logger log = new Logger(typeof(AppConfigReader));\n    log.InfoFormat(\"Log is configured\");\n}\n</code></pre>\n\n<p>However, in my log there is always the fully qualified name of the logger, like this example:</p>\n\n<pre><code>MyCorp.Controls.MyView:2019-01-23 10:38:32,434 - log test here\n</code></pre>\n\n<p>How can I configure log4net to see a log like this instead (without the logger name):</p>\n\n<pre><code>2019-01-23 10:38:32,434 - log test here\n</code></pre>\n"}, {"tags": ["c#", "epplus"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10955466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015125558e21a57c1e8169013866fae5?s=128&d=identicon&r=PG&f=1", "display_name": "kalle", "link": "https://stackoverflow.com/users/10955466/kalle"}, "edited": false, "score": 0, "creation_date": 1548399546, "post_id": 54351288, "comment_id": 95535004, "body": "I actually tried exactly this, but it would not work, it still couldn&#39;t handle my delimiter value.  I ended up specifying the delimiter as &#164; so I will have to pray that nobody uses this character."}, {"owner": {"reputation": 13, "user_id": 10955466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015125558e21a57c1e8169013866fae5?s=128&d=identicon&r=PG&f=1", "display_name": "kalle", "link": "https://stackoverflow.com/users/10955466/kalle"}, "edited": false, "score": 0, "creation_date": 1548400273, "post_id": 54351288, "comment_id": 95535289, "body": "Let&#39;s say Firstname contained kalle;fdsf, fdsf would be put in the next column anyway. Maybe its a bug in the lib?"}, {"owner": {"reputation": 1976, "user_id": 9772793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b5b22eb58da1abc14257e380c09c0f?s=128&d=identicon&r=PG&f=1", "display_name": "DanB", "link": "https://stackoverflow.com/users/9772793/danb"}, "reply_to_user": {"reputation": 13, "user_id": 10955466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015125558e21a57c1e8169013866fae5?s=128&d=identicon&r=PG&f=1", "display_name": "kalle", "link": "https://stackoverflow.com/users/10955466/kalle"}, "edited": false, "score": 0, "creation_date": 1548449950, "post_id": 54351288, "comment_id": 95559769, "body": "I post the full code I have in mind.  I can&#39;t figure out why this is an issue with delimiter."}, {"owner": {"reputation": 1976, "user_id": 9772793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b5b22eb58da1abc14257e380c09c0f?s=128&d=identicon&r=PG&f=1", "display_name": "DanB", "link": "https://stackoverflow.com/users/9772793/danb"}, "reply_to_user": {"reputation": 13, "user_id": 10955466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015125558e21a57c1e8169013866fae5?s=128&d=identicon&r=PG&f=1", "display_name": "kalle", "link": "https://stackoverflow.com/users/10955466/kalle"}, "edited": false, "score": 0, "creation_date": 1548698280, "post_id": 54351288, "comment_id": 95626294, "body": "I just tested it right now.  It works without any issue;"}], "tags": [], "owner": {"reputation": 1976, "user_id": 9772793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b5b22eb58da1abc14257e380c09c0f?s=128&d=identicon&r=PG&f=1", "display_name": "DanB", "link": "https://stackoverflow.com/users/9772793/danb"}, "is_accepted": false, "score": 0, "last_activity_date": 1548698169, "last_edit_date": 1548698169, "creation_date": 1548347405, "answer_id": 54351288, "question_id": 54334081, "link": "https://stackoverflow.com/questions/54334081/how-to-add-a-row-of-data-with-epplus-when-delimiter-can-occur-inside-the-cells/54351288#54351288", "title": "How to add a row of data with EPPlus when delimiter can occur inside the cells?", "body": "<p>Why not use cell by cell?</p>\n\n<pre><code>foreach (Attendee item in context.Attendees.Include(attendee =&gt; attendee.Tags))\n{\n    int column = 1;\n    worksheet.Cells[counter, column++].Value = item.Id;\n    worksheet.Cells[counter, column++].Value = item.FirstName;\n    worksheet.Cells[counter++, column++].Value = item.LastName;\n}\n</code></pre>\n\n<p><strong>edit - full code</strong></p>\n\n<pre><code>public void Export()\n    {\n        using (ExcelPackage excel = new ExcelPackage())\n        {\n            excel.Workbook.Worksheets.Add(\"Worksheet1\");\n            var headerRow = new List&lt;string[]&gt;()\n            {\n                new string[] { \"Id\", \"FirstName\", \"LastName\",  }\n            };\n            // Determine the header range (e.g. A1:D1)\n            string headerRange = \"A1:\" + Char.ConvertFromUtf32(headerRow[0].Length + 64) + \"1\";\n            var worksheet = excel.Workbook.Worksheets[\"Worksheet1\"];\n            worksheet.Cells[headerRange].LoadFromArrays(headerRow);\n            worksheet.DefaultColWidth = 20.0;\n\n            var counter = 2;\n\n            foreach (Attendee item in context.Attendees.Include(attendee =&gt; attendee.Tags))\n            {\n                int column = 1;\n                worksheet.Cells[counter, column++].Value = item.Id;\n                worksheet.Cells[counter, column++].Value = item.FirstName;\n                worksheet.Cells[counter++, column++].Value = item.LastName;\n            }\n\n            //Create the response\n            Response.Clear();\n            Response.ContentEncoding = Encoding.UTF8;\n            Response.HeaderEncoding = Encoding.UTF8;\n            Response.Charset = Encoding.UTF8.WebName;\n            Response.ContentType = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\n            Response.AddHeader(\"Content-Disposition\", \"attachment; filename=people.xlsx\");\n            Response.BinaryWrite(excel.GetAsByteArray()); \n            Response.Flush(); \n            Response.End();\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 512, "user_id": 1390375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6785176b939ea950c43d5ef64de4902e?s=128&d=identicon&r=PG", "display_name": "user1390375", "link": "https://stackoverflow.com/users/1390375/user1390375"}, "is_accepted": false, "score": 0, "last_activity_date": 1557294821, "creation_date": 1557294821, "answer_id": 56034345, "question_id": 54334081, "link": "https://stackoverflow.com/questions/54334081/how-to-add-a-row-of-data-with-epplus-when-delimiter-can-occur-inside-the-cells/56034345#56034345", "title": "How to add a row of data with EPPlus when delimiter can occur inside the cells?", "body": "<p>There is the ascii \"VTAB\" character (chr(11), 0x0B), that is probably safe to use as your delimiter, as you'll probably otherwise never encounter it outside of this :)</p>\n\n<p>How many people really know how to hold down the ALT key (in Windows) and type \"0011\" on the keypad to enter that control character?</p>\n"}], "owner": {"reputation": 13, "user_id": 10955466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/015125558e21a57c1e8169013866fae5?s=128&d=identicon&r=PG&f=1", "display_name": "kalle", "link": "https://stackoverflow.com/users/10955466/kalle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 598, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1557294821, "creation_date": 1548270418, "question_id": 54334081, "link": "https://stackoverflow.com/questions/54334081/how-to-add-a-row-of-data-with-epplus-when-delimiter-can-occur-inside-the-cells", "title": "How to add a row of data with EPPlus when delimiter can occur inside the cells?", "body": "<p>I'm having problems when my data contains my delmiter value, that the cells will be populated in the wrong place. </p>\n\n<p>I'm exporting and importing excel data from my application. Below is a working snippet of my export. I've set my delimiter to be ';' but it causes issues if any of my properties value contains this character. Therefore I am wondering if there is a better way to load data which would allow me to use my delimiter value inside the cells. </p>\n\n<pre><code> public void Export()\n        {\n            using (ExcelPackage excel = new ExcelPackage())\n            {\n                excel.Workbook.Worksheets.Add(\"Worksheet1\");\n                var headerRow = new List&lt;string[]&gt;()\n                {\n                    new string[] { \"Id\", \"FirstName\", \"LastName\",  }\n                };\n                // Determine the header range (e.g. A1:D1)\n                string headerRange = \"A1:\" + Char.ConvertFromUtf32(headerRow[0].Length + 64) + \"1\";\n                var worksheet = excel.Workbook.Worksheets[\"Worksheet1\"];\n                worksheet.Cells[headerRange].LoadFromArrays(headerRow);\n                worksheet.DefaultColWidth = 20.0;\n\n                //TODO examine delimiter \n                var counter = 2;\n                var format = new OfficeOpenXml.ExcelTextFormat();\n                format.Delimiter = ';';\n                //format.TextQualifier = '\"';\n                format.DataTypes = new[] { eDataTypes.String };\n\n                foreach (Attendee item in context.Attendees.Include(attendee =&gt; attendee.Tags))\n                {\n                    worksheet.Cells[counter++, 1].LoadFromText($\"{item.Id};{item.FirstName};{item.LastName}\", format);\n                }\n\n                //Create the response\n                Response.Clear();\n                Response.ContentEncoding = Encoding.UTF8;\n                Response.HeaderEncoding = Encoding.UTF8;\n                Response.Charset = Encoding.UTF8.WebName;\n                Response.ContentType = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\n                Response.AddHeader(\"Content-Disposition\", \"attachment; filename=people.xlsx\");\n                Response.BinaryWrite(excel.GetAsByteArray()); \n                Response.Flush(); \n                Response.End();\n               }\n        }\n</code></pre>\n\n<p>This works but if any of my fields contain ';' I will have problems. Is there some archaic delimiter value I can use or perhaps a more secure way to load my data? I could probably write two nested for loops and call load cell on every cell but that would be rather ugly as I have about 15 columns/fields in my real code. I cannot load from collection either as there are some fields that I don't want to show and they end up in the wrong order.</p>\n"}, {"tags": ["c#", "class", "unity3d", "serialization", "editor"], "answers": [{"comments": [{"owner": {"reputation": 527, "user_id": 9977758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f093d9d5b8e4ef87e83e7b655c5a8e3?s=128&d=identicon&r=PG&f=1", "display_name": "SagiZiv", "link": "https://stackoverflow.com/users/9977758/sagiziv"}, "edited": false, "score": 0, "creation_date": 1548275693, "post_id": 54334774, "comment_id": 95487837, "body": "I got the same results....  is there another difference except the byte[] m_Arr;?"}, {"owner": {"reputation": 355, "user_id": 8557668, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wvLqVWEOBR0/AAAAAAAAAAI/AAAAAAAAALM/OdDI0OiWT1E/photo.jpg?sz=128", "display_name": "Dmitri Veselov", "link": "https://stackoverflow.com/users/8557668/dmitri-veselov"}, "reply_to_user": {"reputation": 527, "user_id": 9977758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f093d9d5b8e4ef87e83e7b655c5a8e3?s=128&d=identicon&r=PG&f=1", "display_name": "SagiZiv", "link": "https://stackoverflow.com/users/9977758/sagiziv"}, "edited": false, "score": 0, "creation_date": 1548303319, "post_id": 54334774, "comment_id": 95495088, "body": "oh, excuse me, I framed it. You can substitute any serializable values there. The main thing is that the field would be public, I also corrected &quot;SoldierEditor: Editor&quot; and placed this script in a folder called &quot;Editor&quot; I will add that if you want to see the Weapon class in the inspector, then you also need to make it serializable."}, {"owner": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "edited": false, "score": 0, "creation_date": 1548312968, "post_id": 54334774, "comment_id": 95497817, "body": "if using <a href=\"https://docs.unity3d.com/ScriptReference/SerializeField.html\" rel=\"nofollow noreferrer\"><code>[SerializeField]</code></a> the field doesn&#39;t have to be <code>public</code>. Or the other way round: if a field is <code>public</code> it is serialized anyway and doesn&#39;t need <code>[SerializeField]</code>"}, {"owner": {"reputation": 355, "user_id": 8557668, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wvLqVWEOBR0/AAAAAAAAAAI/AAAAAAAAALM/OdDI0OiWT1E/photo.jpg?sz=128", "display_name": "Dmitri Veselov", "link": "https://stackoverflow.com/users/8557668/dmitri-veselov"}, "reply_to_user": {"reputation": 46970, "user_id": 7111561, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/SNnq7.png?s=128&g=1", "display_name": "derHugo", "link": "https://stackoverflow.com/users/7111561/derhugo"}, "edited": false, "score": 0, "creation_date": 1548320383, "post_id": 54334774, "comment_id": 95501279, "body": "@derHugo  yes,([SerializeField] whith public) it&#39;s redundancy. <a href=\"https://answers.unity.com/questions/549814/using-serializefield-vs-public.html\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 355, "user_id": 8557668, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wvLqVWEOBR0/AAAAAAAAAAI/AAAAAAAAALM/OdDI0OiWT1E/photo.jpg?sz=128", "display_name": "Dmitri Veselov", "link": "https://stackoverflow.com/users/8557668/dmitri-veselov"}, "is_accepted": false, "score": 1, "last_activity_date": 1548273508, "creation_date": 1548273508, "answer_id": 54334774, "question_id": 54334042, "link": "https://stackoverflow.com/questions/54334042/serializable-class-is-not-shown-in-custom-inspector/54334774#54334774", "title": "Serializable class is not shown in custom inspector", "body": "<p>It works for me</p>\n\n<p>My Class:</p>\n\n<pre><code>[Serializable]\npublic class Skills\n{\n    [SerializeField]\n    public byte[] m_Arr;\n}\n</code></pre>\n\n<p>My Data ScriptableObject:</p>\n\n<pre><code>[CreateAssetMenu(fileName = \"New Character\", menuName =\n\"Characters/Soldier\")]\npublic class SoldierData : ScriptableObject\n{\n    //public Weapon weapon;\n    public float life = 100;\n    public bool autoAttack = true;\n    public Skills skills = new Skills();\n}\n</code></pre>\n\n<p>And finally my custom editor:</p>\n\n<pre><code>[CustomEditor(typeof(SoldierData))]\npublic class SoldierEditor : Editor\n{\n    private SerializedProperty life, autoAttack, skills/*, weapon*/;\n    private bool showBaseProperties = true, showWeaponProperties = false;\n\n    private void OnEnable()\n    {\n        life = serializedObject.FindProperty(\"life\");\n        autoAttack = serializedObject.FindProperty(\"autoAttack\");\n        skills = serializedObject.FindProperty(\"skills\");\n        //weapon = serializedObject.FindProperty(\"weapon\");\n    }\n    public override void OnInspectorGUI()\n    {\n        showBaseProperties = EditorGUILayout.Foldout(showBaseProperties, \"Basic settings:\");\n        if (showBaseProperties)\n        {\n            base.OnInspectorGUI();\n        }\n        serializedObject.Update();\n        showWeaponProperties = EditorGUILayout.Foldout(showWeaponProperties, \"Weapon settings\");\n        if (showWeaponProperties)\n        {\n            EditorGUILayout.PropertyField(autoAttack);\n            EditorGUILayout.PropertyField(life);\n        }\n        EditorGUILayout.PropertyField(skills);\n        serializedObject.ApplyModifiedProperties();\n    }\n}\n</code></pre>\n\n<p>uncomment weapon\nadd: put SoldierEditor in folder named \"Editor\"</p>\n"}], "owner": {"reputation": 527, "user_id": 9977758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f093d9d5b8e4ef87e83e7b655c5a8e3?s=128&d=identicon&r=PG&f=1", "display_name": "SagiZiv", "link": "https://stackoverflow.com/users/9977758/sagiziv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1566, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548316944, "creation_date": 1548270235, "question_id": 54334042, "link": "https://stackoverflow.com/questions/54334042/serializable-class-is-not-shown-in-custom-inspector", "title": "Serializable class is not shown in custom inspector", "body": "<p>I am creating custom inspector for my ScriptableObjects in unity, and I have noticed that my Serializable class's properties aren't displayed</p>\n\n<p>I have created a simple script to hold a character data, and one of it fields is a Serializable class. If I don't use custom inspector I can see the class in the inspector, but if I try to make one it automatically just displayes the field name in foldout view, and when I unfold it, it is empty.</p>\n\n<p>My Class:</p>\n\n<pre><code>using UnityEngine;\n[System.Serializable]\npublic class Skills\n{\n    [SerializeField, Tooltip(\"This character agility level\")]\n    private byte agility, strength;\n\n}\n</code></pre>\n\n<p>My Data ScriptableObject:</p>\n\n<pre><code>using UnityEngine;\nusing Weapons.ScriptableObjects;\nnamespace Characters.ScriptableObjects\n{\n     [CreateAssetMenu(fileName = \"New Character\", menuName \n\"Characters/Soldier\")]\n    public class SoldierData : CharacterData\n    {\n        public Weapon weapon;\n        public float life = 100;\n        public bool autoAttack = true;\n        public Skills skills = new Skills();\n    }\n}\n</code></pre>\n\n<p>And finally my custom editor:</p>\n\n<pre><code>using UnityEditor;\nnamespace Characters.CustomEditors\n{\n    [CustomEditor(typeof(ScriptableObjects.SoldierData))]\n    public class SoldierEditor : CharacterEditor\n    {\n        private SerializedProperty life, autoAttack, skills, weapon;\n        private bool showBaseProperties = true, showWeaponProperties = false;\n\n        private new void OnEnable()\n        {\n            base.OnEnable();\n            life = serializedObject.FindProperty(\"life\");\n            autoAttack = serializedObject.FindProperty(\"autoAttack\");\n            skills = serializedObject.FindProperty(\"skills\");\n            weapon = serializedObject.FindProperty(\"weapon\");\n        }\n        public override void OnInspectorGUI()\n        {\n            showBaseProperties = EditorGUILayout.Foldout(showBaseProperties, \"Basic settings:\");\n            if (showBaseProperties)\n            {\n                base.OnInspectorGUI();\n            }\n            serializedObject.Update();\n            showWeaponProperties = EditorGUILayout.Foldout(showWeaponProperties, \"Weapon settings\");\n            if (showWeaponProperties)\n            {\n                EditorGUILayout.PropertyField(autoAttack);\n                EditorGUILayout.PropertyField(life);\n            }\n            EditorGUILayout.PropertyField(skills);\n            serializedObject.ApplyModifiedProperties();\n            }\n        }\n    }\n</code></pre>\n\n<p>I want to see my Skills class's properties in the custom inspector</p>\n"}, {"tags": ["c#", "asp.net-mvc-5", "datatables"], "comments": [{"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1548278085, "post_id": 54334007, "comment_id": 95488779, "body": "This questions is very broad, Make a get page method, pass in the page and the page size... Use Server Side Processing and pass the query parameters in"}, {"owner": {"reputation": 115, "user_id": 2359206, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bbcb65e08ba69062394b29410b5d03ac?s=128&d=identicon&r=PG", "display_name": "Braden", "link": "https://stackoverflow.com/users/2359206/braden"}, "reply_to_user": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1548343304, "post_id": 54334007, "comment_id": 95515176, "body": "How is this question broad? It&#39;s actually quite specific....how to pass skip, take, page numbers, and show number of records per page parameters to JQuery DataTables."}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1548346064, "post_id": 54334007, "comment_id": 95517027, "body": "it&#39;s too broad because you&#39;ve presented us with a problem in which to fully answer, a user would need to 1. Write the architecture for paging (Since you only support get all). 2. Research or have prior knowledge of JQuery DataTables. 3. Write the client side  requests and create an architecture for storing the paging variables."}, {"owner": {"reputation": 115, "user_id": 2359206, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bbcb65e08ba69062394b29410b5d03ac?s=128&d=identicon&r=PG", "display_name": "Braden", "link": "https://stackoverflow.com/users/2359206/braden"}, "reply_to_user": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1548352479, "post_id": 54334007, "comment_id": 95520660, "body": "The architecture for paging is already supported by DataTables. Server paging - with respect to DataTables library - that doesn&#39;t max out the memory is the issue I am facing."}, {"owner": {"reputation": 16389, "user_id": 1938988, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GPf1K.jpg?s=128&g=1", "display_name": "johnny 5", "link": "https://stackoverflow.com/users/1938988/johnny-5"}, "edited": false, "score": 0, "creation_date": 1548353458, "post_id": 54334007, "comment_id": 95521103, "body": "this issue is your pulling everything from the db in repository (anti) pattern you need to change to expose a function which accepts skip and take and use it on the iqueryable instead of ienumerable"}], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 7526211, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208744003660923/picture?type=large", "display_name": "Wilmar Arias", "link": "https://stackoverflow.com/users/7526211/wilmar-arias"}, "is_accepted": false, "score": 0, "last_activity_date": 1548282388, "creation_date": 1548282388, "answer_id": 54336657, "question_id": 54334007, "link": "https://stackoverflow.com/questions/54334007/how-to-use-skip-and-take-with-jquery-datatables-and-generic-method/54336657#54336657", "title": "How to use Skip() and Take() with JQuery DataTables and generic method", "body": "<blockquote>\n  <p>You can resolve this in many ways but I gonna give you a link many\n  give some inspiration to how you kan resolve your problem ,  I'm my\n  last solution I only create a model like this </p>\n  \n  <p>Interface IDatatables  where T: class {    string request URL{get;\n  set; }</p>\n  \n  <p>ICollection Columns    Button Edit {get; set;}<br>\n  Button Edit {get; set;}  Ect..</p>\n  \n  <p>}</p>\n  \n  <p>In the your ActionResult you need to build a class that matches the\n  request parameters of datatables  Here is some links that you can find\n  some inspiration for your integration with datatables \n  <a href=\"https://www.c-sharpcorner.com/article/using-datatables-grid-with-asp-net-mvc/\" rel=\"nofollow noreferrer\">https://www.c-sharpcorner.com/article/using-datatables-grid-with-asp-net-mvc/</a>\n  <a href=\"https://gist.github.com/OllieJones/7448933cc85ee740e990383e4fded412\" rel=\"nofollow noreferrer\">https://gist.github.com/OllieJones/7448933cc85ee740e990383e4fded412</a></p>\n</blockquote>\n"}], "owner": {"reputation": 115, "user_id": 2359206, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/bbcb65e08ba69062394b29410b5d03ac?s=128&d=identicon&r=PG", "display_name": "Braden", "link": "https://stackoverflow.com/users/2359206/braden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 745, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548282388, "creation_date": 1548270068, "question_id": 54334007, "link": "https://stackoverflow.com/questions/54334007/how-to-use-skip-and-take-with-jquery-datatables-and-generic-method", "title": "How to use Skip() and Take() with JQuery DataTables and generic method", "body": "<p>I have a view in ASP.NET MVC 5 that returns all records of an entity at once, 40,000+ records. (Lazy loading is enabled so it returns even more data than just that.) I always receive an out of memory exception, as expected. So I need to limit the data displayed but keep all of the data available to display when the page is changed or a search is performed. </p>\n\n<p>This is the generic method that queries the datasource to retrieve the results. <code>Manager.AllAsync</code> is a generic Entity Framework method that queries an entity supplied through the <code>TEntity</code>:</p>\n\n<pre><code>public async Task&lt;ActionResult&gt; DataTableAsync&lt;TEntity&gt;(AlertModel alert, string viewName = null) where TEntity : class\n    {\n        // get data\n        var data = (from a in await Manager.AllAsync&lt;TEntity&gt;()\n                    select a).ToList();\n\n       // create model with alert\n        var response = new TableModel&lt;TEntity&gt; \n        {\n            Alert = alert,\n            Data = data\n        };\n\n        // return partial data view\n       return  PartialView(viewName ?? $\"_{typeof(TEntity).Name}Table\", response);\n\n    }\n</code></pre>\n\n<p>Here is the definition of <code>TableModel</code></p>\n\n<pre><code>public class TableModel&lt;TEntity&gt;\n{\n    /// &lt;summary&gt;\n    /// Alert for the model.\n    /// &lt;/summary&gt;\n    public AlertModel Alert { get; set; }\n\n    /// &lt;summary&gt;\n    /// Data from the database.\n    /// &lt;/summary&gt;\n    public IList&lt;TEntity&gt; Data { get; set; }\n}\n</code></pre>\n\n<p>Here is the definition of <code>AllAsync</code></p>\n\n<pre><code> public virtual async Task&lt;IList&lt;T&gt;&gt; AllAsync&lt;T&gt;() where T : class\n    {\n        try\n        {\n            return await Context.Set&lt;T&gt;().ToListAsync();\n        }\n        catch (ArgumentNullException ex)\n        {\n            throw new InvalidOperationException($\"Invalid state: {typeof(T).Name} DbSet is null.\", ex);\n        }\n    }\n</code></pre>\n\n<p>Then the view just iterates over the records using a <code>foreach</code>. </p>\n\n<p>This is how the generic DataTables JavaScript is configured:</p>\n\n<pre><code>function makeDataTable(id) {\nvar selector = '#' + id;\n$(selector).DataTable({\n    order: [],\n    search: {\n        smart: false\n    },\n    stateSave: true,\n    deferRender: true,\n    columnDefs: [{\n        targets: 'no-sort',\n        orderable: false\n    },\n    {\n        targets: 'date-col',\n        type: 'date',\n        orderSequence: [\n            'desc',\n            'asc'\n        ]\n    }],\n    lengthMenu: [\n        [10, 15, 20, -1],\n        [10, 15, 20, 'All']\n    ]\n});\n$(selector).width('100%');\n}\n</code></pre>\n\n<p>I'm not sure how the DataTables <code>Show</code> option communicates with the method to display only so many at once, or how to <code>Show All</code> without running into the <code>out of memory</code> exception. I know DataTables has <a href=\"https://datatables.net/manual/server-side\" rel=\"nofollow noreferrer\">Server Side Processing</a> but the way the data is retrieved now is Linq to Entities (from the data source method). I have found some articles that explain what I should do <a href=\"http://technotipstutorial.blogspot.com/2017/11/part-49-pagination-using-skip-and-take.html\" rel=\"nofollow noreferrer\">Like this one for example</a> but this one returns a <code>JsonResult</code>. Would it be easier to make this method not so generic?</p>\n"}, {"tags": ["c#", "asp.net", "asp.net-mvc", "rotativa"], "answers": [{"comments": [{"owner": {"reputation": 9927, "user_id": 979331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e4108d28226846070db4eabf0c5d882?s=128&d=identicon&r=PG", "display_name": "user979331", "link": "https://stackoverflow.com/users/979331/user979331"}, "edited": false, "score": 0, "creation_date": 1548276482, "post_id": 54335034, "comment_id": 95488149, "body": "I do not want to use BuildFile, it does not work on my server."}], "tags": [], "owner": {"reputation": 4090, "user_id": 190042, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5ZXq7.jpg?s=128&g=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/190042/jonathan"}, "is_accepted": true, "score": 1, "last_activity_date": 1548274802, "creation_date": 1548274802, "answer_id": 54335034, "question_id": 54333944, "link": "https://stackoverflow.com/questions/54333944/asp-net-get-bytes-of-application-pdf-attachment/54335034#54335034", "title": "ASP.NET Get bytes of application/pdf attachment", "body": "<p>It looks like you should be able to call <code>BuildFile</code> on the output from <code>ViewAsPdf</code>, like this:</p>\n\n<pre><code>public ActionResult RedBluePDF(string community, string procedure) \n{ \n   var model = new GeneratePDFModel(); \n   var pdf= new Rotativa.ViewAsPdf(\"GeneratePDF\", model){\n        FileName = \"TestViewAsPdf.pdf\"\n   }\n   var bytes = pdf.BuildFile(); // byte array\n   // do what you want with the byte array here\n}\n</code></pre>\n"}], "owner": {"reputation": 9927, "user_id": 979331, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2e4108d28226846070db4eabf0c5d882?s=128&d=identicon&r=PG", "display_name": "user979331", "link": "https://stackoverflow.com/users/979331/user979331"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 54335034, "answer_count": 1, "score": 0, "last_activity_date": 1548274802, "creation_date": 1548269831, "question_id": 54333944, "link": "https://stackoverflow.com/questions/54333944/asp-net-get-bytes-of-application-pdf-attachment", "title": "ASP.NET Get bytes of application/pdf attachment", "body": "<p>I have this url: <a href=\"https://example.com/getPDF/Index\" rel=\"nofollow noreferrer\">https://example.com/getPDF/Index</a></p>\n\n<p>This method returns an attached application/pdf via Rotativa</p>\n\n<pre><code>public ActionResult RedBluePDF(string community, string procedure) \n{ \n     var model = new GeneratePDFModel(); \n     return new Rotativa.ViewAsPdf(\"GeneratePDF\", model){\n          FileName = \"TestViewAsPdf.pdf\"\n     }\n}\n</code></pre>\n\n<p>My Question is how would I call this method and get the bytes from application/pdf file? I do not want to generate the PDF and get the BuildFile method provided by Rotativa to get the bytes.</p>\n"}, {"tags": ["c#", "xaml", "xamarin", "xamarin.forms", "xamarin.ios"], "answers": [{"tags": [], "owner": {"reputation": 6179, "user_id": 1691980, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/979c4577100103dc214bf0b1a9da657d?s=128&d=identicon&r=PG", "display_name": "Bruno Caceiro", "link": "https://stackoverflow.com/users/1691980/bruno-caceiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1548270399, "creation_date": 1548270399, "answer_id": 54334076, "question_id": 54333941, "link": "https://stackoverflow.com/questions/54333941/xamarin-form-backgroundimage-for-content-page-its-not-getting-stretch/54334076#54334076", "title": "Xamarin Form:-BackgroundImage for content page it&#39;s not getting stretch", "body": "<p>You can use a CustomRenderer to set the background image (Adapt to your PageName and namespaces. I've used this to fill images in iOS pages.</p>\n\n<pre><code>[assembly: ExportRenderer(typeof(Forms.TestPage), typeof(.iOS.Renderers.TestPage))]\nnamespace Mindflow.Gamification.Mercedes.iOS.Renderers\n{\n    public class TestPage : PageRenderer\n    {\n        protected override void OnElementChanged(VisualElementChangedEventArgs e)\n        {\n            base.OnElementChanged(e);\n\n            if (e.OldElement != null || Element == null)\n            {\n                return;\n            }\n\n\n            var page = e.NewElement as Mindflow.Gamification.Forms.Pages.Game.GamePage;\n\n            UIGraphics.BeginImageContext(View.Frame.Size);\n            UIImage i = UIImage.FromFile(page.BackgroundImage);\n            i = i.Scale(View.Frame.Size);\n\n            View.BackgroundColor = UIColor.FromPatternImage(i);\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 9382782, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OTiISNneDGU/AAAAAAAAAAI/AAAAAAAAADM/e6y5MNzeV0o/photo.jpg?sz=128", "display_name": "OD Applications", "link": "https://stackoverflow.com/users/9382782/od-applications"}, "edited": false, "score": 0, "creation_date": 1580452883, "post_id": 54339936, "comment_id": 106109491, "body": "I think this is a better answer. Considering most of us are using grids and not empty pages. :)"}], "tags": [], "owner": {"reputation": 1077, "user_id": 7432494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pDl4z.jpg?s=128&g=1", "display_name": "FabriBertani", "link": "https://stackoverflow.com/users/7432494/fabribertani"}, "is_accepted": false, "score": 1, "last_activity_date": 1580456572, "last_edit_date": 1580456572, "creation_date": 1548308061, "answer_id": 54339936, "question_id": 54333941, "link": "https://stackoverflow.com/questions/54333941/xamarin-form-backgroundimage-for-content-page-its-not-getting-stretch/54339936#54339936", "title": "Xamarin Form:-BackgroundImage for content page it&#39;s not getting stretch", "body": "<p>Instead of doing a custom renderer, you can use a grid layout, due the grid layout can manage z-index, so you can place the image beneath the content. Like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;ContentPage\n    xmlns=\"http://xamarin.com/schemas/2014/forms\"\n    xmlns:x=\"http://schemas.microsoft.com/winfx/2009/xaml\"\n    x:Class=\"Demo.Welcome\"&gt;\n    &lt;Grid&gt;\n        &lt;Image\n            Aspect=\"AspectFill\"\n            Source=\"bg.png\" /&gt;\n        &lt;ScrollView&gt;\n            &lt;!--\n                ...\n                Your content here\n                ...\n            --&gt;\n        &lt;/ScrollView&gt;\n    &lt;/Grid&gt;\n&lt;/ContentPage&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 10937160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e82073b6c02ed71b7a325728b9af953?s=128&d=identicon&r=PG&f=1", "display_name": "Daxa Varsani", "link": "https://stackoverflow.com/users/10937160/daxa-varsani"}, "is_accepted": false, "score": 1, "last_activity_date": 1548314777, "creation_date": 1548314777, "answer_id": 54341344, "question_id": 54333941, "link": "https://stackoverflow.com/questions/54333941/xamarin-form-backgroundimage-for-content-page-its-not-getting-stretch/54341344#54341344", "title": "Xamarin Form:-BackgroundImage for content page it&#39;s not getting stretch", "body": "<pre><code> &lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;ContentPage xmlns=\"http://xamarin.com/schemas/2014/forms\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2009/xaml\"\n             x:Class=\"Demo.Welcome\"&gt;\n  &lt;ContentPage.Content&gt;\n      &lt;AbsoluteLayout&gt;\n         &lt;Image Source=\"bg.png\" AbsoluteLayout.LayoutBounds=\"1.,1.,1,1\"  AbsoluteLayout.LayoutFlags=\"All\" Aspect=\"Fill\"/&gt;          \n      &lt;/AbsoluteLayout&gt;\n  &lt;/ContentPage.Content&gt;\n&lt;/ContentPage&gt;\n</code></pre>\n"}], "owner": {"reputation": 620, "user_id": 2409617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KxMIC.jpg?s=128&g=1", "display_name": "Pratius Dubey", "link": "https://stackoverflow.com/users/2409617/pratius-dubey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1406, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1580456572, "creation_date": 1548269814, "question_id": 54333941, "link": "https://stackoverflow.com/questions/54333941/xamarin-form-backgroundimage-for-content-page-its-not-getting-stretch", "title": "Xamarin Form:-BackgroundImage for content page it&#39;s not getting stretch", "body": "<p>I have added simple BackgroundImage for content page it's working perfect on all devices. But issue is only on <strong>IOS IPhone XS MAX</strong> image is not getting stretch.And also there is not option for Aspect for backgroundImage.</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;ContentPage xmlns=\"http://xamarin.com/schemas/2014/forms\"\n             xmlns:x=\"http://schemas.microsoft.com/winfx/2009/xaml\"\n             x:Class=\"Demo.Welcome\"\n             BackgroundImage=\"bg.png\"&gt;\n\n  &lt;ContentPage.Content&gt;\n\n  &lt;/ContentPage.Content&gt;\n&lt;/ContentPage&gt;\n</code></pre>\n\n<p>Note- I have checked image rotation and pixel are perfect.</p>\n\n<p>What should I do?</p>\n"}, {"tags": ["c#"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2819245"}, "edited": false, "score": 2, "creation_date": 1548271270, "post_id": 54333925, "comment_id": 95486033, "body": "Use <code>List&lt;string&gt;</code>. Don&#39;t use <code>ArrayList</code> unless you enjoy making your life harder..."}, {"owner": {"reputation": 2476, "user_id": 9668530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zL8vN.jpg?s=128&g=1", "display_name": "Alex Leo", "link": "https://stackoverflow.com/users/9668530/alex-leo"}, "edited": false, "score": 0, "creation_date": 1548271363, "post_id": 54333925, "comment_id": 95486075, "body": "I Could have not made a better statement. Thanks  @elgonzo"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "edited": false, "score": 0, "creation_date": 1548270857, "post_id": 54334096, "comment_id": 95485865, "body": "There is no method for Intersect"}, {"owner": {"reputation": 2476, "user_id": 9668530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zL8vN.jpg?s=128&g=1", "display_name": "Alex Leo", "link": "https://stackoverflow.com/users/9668530/alex-leo"}, "reply_to_user": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "edited": false, "score": 0, "creation_date": 1548270899, "post_id": 54334096, "comment_id": 95485882, "body": "you need the using System.Linq; statement"}, {"owner": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "edited": false, "score": 0, "creation_date": 1548271138, "post_id": 54334096, "comment_id": 95485976, "body": "I added and not working my arraylist: public ArrayList arraylistone = new ArrayList();"}, {"owner": {"reputation": 2476, "user_id": 9668530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zL8vN.jpg?s=128&g=1", "display_name": "Alex Leo", "link": "https://stackoverflow.com/users/9668530/alex-leo"}, "reply_to_user": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "edited": false, "score": 0, "creation_date": 1548271215, "post_id": 54334096, "comment_id": 95486009, "body": "ArrayList doesn&#39;t have .Intersect method. What we are suggesting  is to use a List&lt;T&gt;  System.Collections.Generic;"}], "tags": [], "owner": {"reputation": 2476, "user_id": 9668530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zL8vN.jpg?s=128&g=1", "display_name": "Alex Leo", "link": "https://stackoverflow.com/users/9668530/alex-leo"}, "is_accepted": false, "score": 2, "last_activity_date": 1548270515, "creation_date": 1548270515, "answer_id": 54334096, "question_id": 54333925, "link": "https://stackoverflow.com/questions/54333925/check-all-strings-in-arraylist-contains-in-other-arraylist/54334096#54334096", "title": "Check all strings in arraylist contains in other arraylist", "body": "<p>You could use Enumerable.Intersect. </p>\n\n<pre><code>        var listA = new List&lt;string&gt; { \"Name\", \"Item\" };\n        var listB = new List&lt;string&gt; { \"Name\", \"Item\",\"Count\" };\n\n        var c = listA.Intersect(listB).ToList();\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "edited": false, "score": 0, "creation_date": 1548270845, "post_id": 54334101, "comment_id": 95485857, "body": "How can I get Join from Linq?"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "reply_to_user": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "edited": false, "score": 0, "creation_date": 1548270904, "post_id": 54334101, "comment_id": 95485884, "body": "@Slinidy: Add a using statement at the top: <code>using System.Linq;</code>"}, {"owner": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "edited": false, "score": 0, "creation_date": 1548270988, "post_id": 54334101, "comment_id": 95485918, "body": "I added and not working my arraylist:         public ArrayList arraylistone = new ArrayList();"}, {"owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "reply_to_user": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "edited": false, "score": 1, "creation_date": 1548271176, "post_id": 54334101, "comment_id": 95485992, "body": "You need to cast your <code>ArrayList</code> to an <code>Array</code> first: <code>arraylistone.ToArray()</code>."}], "tags": [], "owner": {"reputation": 6496, "user_id": 4190402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q82KR.jpg?s=128&g=1", "display_name": "JuanR", "link": "https://stackoverflow.com/users/4190402/juanr"}, "is_accepted": true, "score": 1, "last_activity_date": 1548271076, "last_edit_date": 1548271076, "creation_date": 1548270543, "answer_id": 54334101, "question_id": 54333925, "link": "https://stackoverflow.com/questions/54333925/check-all-strings-in-arraylist-contains-in-other-arraylist/54334101#54334101", "title": "Check all strings in arraylist contains in other arraylist", "body": "<p>There are many ways to skin a cat. Here is one using Linq's <code>Join</code> extension method:</p>\n\n<pre><code>var list1 = new[] { \"Name\",  \"Item\" };\nvar list2 = new[] { \"Item\", \"Name\", \"Count\" };\nvar join = list1.Join(list2, l1 =&gt; l1, l2 =&gt; l2, (l1, l2) =&gt; new { l1, l2 });\nvar allContained = join.Count() == list1.Count();\n</code></pre>\n\n<p>Just be careful with comparison of strings. There is an overload that takes an <code>IEqualityComparer&lt;TKey&gt;</code> to allow you to define how the keys are compared.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>As Alex Leo has pointed out, you can use <code>Intersect</code>:</p>\n\n<pre><code> var allContained = list1.Intersect(list2).Count() == list1.Count();\n</code></pre>\n\n<p>Much simpler and it also provides an <code>IEqualityComparer&lt;T&gt;</code> overload.</p>\n"}, {"tags": [], "owner": {"reputation": 619, "user_id": 2623538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhR1w.jpg?s=128&g=1", "display_name": "NaDeR Star", "link": "https://stackoverflow.com/users/2623538/nader-star"}, "is_accepted": false, "score": 1, "last_activity_date": 1548270558, "creation_date": 1548270558, "answer_id": 54334105, "question_id": 54333925, "link": "https://stackoverflow.com/questions/54333925/check-all-strings-in-arraylist-contains-in-other-arraylist/54334105#54334105", "title": "Check all strings in arraylist contains in other arraylist", "body": "<p>Try something like this</p>\n\n<pre><code>var arrayOne = new string[4];\n    arrayOne[0] = \"Item1\";\n    arrayOne[1] = \"Item2\";\n    arrayOne[2] = \"Item3\";\n    arrayOne[3] = \"Item4\";\n\nvar arrayTwo = new string[4];\n    arrayTwo[0] = \"Item1\";\n    arrayTwo[1] = \"Item2\";\n    arrayTwo[2] = \"Item3\";\n    arrayTwo[3] = \"Item4\";\n\n    var allItemIsThere = true;\n\n    foreach (var one in arrayOne)\n    {\n        allItemIsThere = arrayTwo.Contains(one);\n        if(!allItemIsThere)\n        { break;}\n    }\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 54334101, "answer_count": 3, "score": 0, "last_activity_date": 1548271076, "creation_date": 1548269787, "question_id": 54333925, "link": "https://stackoverflow.com/questions/54333925/check-all-strings-in-arraylist-contains-in-other-arraylist", "title": "Check all strings in arraylist contains in other arraylist", "body": "<p>I trying make if Arraylist all values contains in other arraylist (all values)</p>\n\n<p>Arraylist one:</p>\n\n<pre><code>Name\nItem\n</code></pre>\n\n<p>ArrayList two:</p>\n\n<pre><code>Item\nName\nCount\n</code></pre>\n\n<p>Note: the lists are shuffled</p>\n\n<p>I tried this:</p>\n\n<pre><code>foreach (string str1 in arraylistone)\n                            {\n                                if (arraylisttwo.Contains(str1))\n                                {\n                                    //return true;\n                                }\n                            }\n</code></pre>\n\n<p>But it says true if contains someone element</p>\n"}, {"tags": ["c#", "regex"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9263175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba319a11e11da71dc5bbfcfd150c4b57?s=128&d=identicon&r=PG&f=1", "display_name": "daFunk", "link": "https://stackoverflow.com/users/9263175/dafunk"}, "edited": false, "score": 0, "creation_date": 1548271368, "post_id": 54333926, "comment_id": 95486078, "body": "Worked fine in a regex tester but not in c# :(  var bodyRegex = new Regex(@&quot;/#(.|\\s)*?##/gm&quot;); var bodyMatches = bodyRegex.Matches(newEmail.EmailBody);  That returns no matches, but the newEmail.EmailBody defo has the pattern #blahblah## repeated within it."}, {"owner": {"reputation": 23752, "user_id": 1118978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2rloq.jpg?s=128&g=1", "display_name": "Dervi\u015f Kay\u0131mba\u015f\u0131o\u011flu", "link": "https://stackoverflow.com/users/1118978/dervi%c5%9f-kay%c4%b1mba%c5%9f%c4%b1o%c4%9flu"}, "reply_to_user": {"reputation": 15, "user_id": 9263175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba319a11e11da71dc5bbfcfd150c4b57?s=128&d=identicon&r=PG&f=1", "display_name": "daFunk", "link": "https://stackoverflow.com/users/9263175/dafunk"}, "edited": false, "score": 1, "creation_date": 1548271858, "post_id": 54333926, "comment_id": 95486285, "body": "why do I need to delete this answer? why is it requested?"}], "tags": [], "owner": {"reputation": 23752, "user_id": 1118978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2rloq.jpg?s=128&g=1", "display_name": "Dervi\u015f Kay\u0131mba\u015f\u0131o\u011flu", "link": "https://stackoverflow.com/users/1118978/dervi%c5%9f-kay%c4%b1mba%c5%9f%c4%b1o%c4%9flu"}, "is_accepted": true, "score": -1, "last_activity_date": 1548271686, "last_edit_date": 1548271686, "creation_date": 1548269790, "answer_id": 54333926, "question_id": 54333871, "link": "https://stackoverflow.com/questions/54333871/c-regex-get-every-instance-of-start-to-end-char/54333926#54333926", "title": "c# regex get every instance of start to end char", "body": "<p>try the regex below:</p>\n\n<pre><code>/#.*?##/g\n</code></pre>\n\n<p>Note That: <code>?</code> quantifier  makes the preceding quantifier lazy, causing it to match as few characters as possible.</p>\n\n<hr>\n\n<p>For multiline operation</p>\n\n<pre><code>/#(.|\\s)*?##/gm\n</code></pre>\n\n<p>For C#</p>\n\n<pre><code>Regex.Match(input, \"#(.|\\s)*?##\", RegexOptions.Multiline)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9263175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba319a11e11da71dc5bbfcfd150c4b57?s=128&d=identicon&r=PG&f=1", "display_name": "daFunk", "link": "https://stackoverflow.com/users/9263175/dafunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "closed_date": 1548269754, "accepted_answer_id": 54333926, "answer_count": 1, "score": -2, "last_activity_date": 1548271686, "creation_date": 1548269589, "last_edit_date": 1548270475, "question_id": 54333871, "link": "https://stackoverflow.com/questions/54333871/c-regex-get-every-instance-of-start-to-end-char", "closed_reason": "Duplicate", "title": "c# regex get every instance of start to end char", "body": "<p>In c#, I'm struggling to create a regex that will pick up each instance of a start -> end character. \nstart char = #\nend char = ##</p>\n\n<p>text to evaluate:\nblah blah blah blah #<em>instance1 regex needs to pick this up</em>## blahblah #<em>instance2 regex needs to # ignore hashes# within until it gets to the end</em>##</p>\n\n<p>So i want it to find every instance that starts with \"#\" and ends with \"##\" ignoring other hashes in between. </p>\n\n<p>This needs to work across paragraphs of text and to ignore newlines, carriage returns etc. I just want everything between the start # and the end ## for each instance of that pattern.  </p>\n"}, {"tags": ["c#", "sql", "sql-server", "asp.net-mvc", "asp.net-identity"], "comments": [{"owner": {"reputation": 573, "user_id": 2268936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e4e4cbfff46c6bf5479ce5c9f6062428?s=128&d=identicon&r=PG", "display_name": "Felix Cen", "link": "https://stackoverflow.com/users/2268936/felix-cen"}, "edited": false, "score": 0, "creation_date": 1548269500, "post_id": 54333788, "comment_id": 95485268, "body": "Are you sure the user id is INT? By default it is varchar"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8723281, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3b89c322085b121d41f8f17e3efc97ef?s=128&d=identicon&r=PG&f=1", "display_name": "mustafa", "link": "https://stackoverflow.com/users/8723281/mustafa"}, "edited": false, "score": 0, "creation_date": 1548271313, "post_id": 54333932, "comment_id": 95486054, "body": "Thank you, i used int instead of nvarchar"}], "tags": [], "owner": {"reputation": 573, "user_id": 2268936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e4e4cbfff46c6bf5479ce5c9f6062428?s=128&d=identicon&r=PG", "display_name": "Felix Cen", "link": "https://stackoverflow.com/users/2268936/felix-cen"}, "is_accepted": true, "score": 1, "last_activity_date": 1548269799, "creation_date": 1548269799, "answer_id": 54333932, "question_id": 54333788, "link": "https://stackoverflow.com/questions/54333788/relationship-between-identity-tables-and-other-tables-in-asp-net-mvc-5/54333932#54333932", "title": "Relationship between Identity tables and Other tables in ASP.NET MVC 5", "body": "<p>By default the primary key of Users is nvarchar, so, your foreign key should be defined with that type. </p>\n\n<pre><code>Create Table dbo.Bookmark\n(\n  BookmarkID int Primary key identity(1,1) not null,\n  BookmarkDate datetime default getdate() not null,\n  UserID [nvarchar](128) constraint FK_Favorites_Users_UserID foreign key (UserID) references Users(UserID) not null\n)\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8723281, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3b89c322085b121d41f8f17e3efc97ef?s=128&d=identicon&r=PG&f=1", "display_name": "mustafa", "link": "https://stackoverflow.com/users/8723281/mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 54333932, "answer_count": 1, "score": 0, "last_activity_date": 1548269799, "creation_date": 1548269212, "question_id": 54333788, "link": "https://stackoverflow.com/questions/54333788/relationship-between-identity-tables-and-other-tables-in-asp-net-mvc-5", "title": "Relationship between Identity tables and Other tables in ASP.NET MVC 5", "body": "<p>In ASP.NET MVC 5 project, the database and identity tables are created by code first, and i created other tables by SQL (not by code first) in this database, and i want to join User table with some table by user Id.</p>\n\n<p>Say database called Qwerty and the identity tables are:</p>\n\n<pre><code>  dbo.Users\n  dbo.Roles\n  dbo.UserClaims\n  ... ect\n</code></pre>\n\n<p>I want to create tables by SQL like this:</p>\n\n<pre><code>Create Table Topic.Topic\n(\n  TopicID int Primary key identity(1,1) not null,\n  TopicAddress nvarchar(255) not null\n)\n\nCreate Table dbo.Bookmark\n(\n  BookmarkID int Primary key identity(1,1) not null,\n  BookmarkDate datetime default getdate() not null,\n  UserID int constraint FK_Favorites_Users_UserID foreign key (UserID) references Users(UserID) not null\n)\n</code></pre>\n\n<p><strong>Topic</strong> table is created successfully, but when i run SQL code for Bookmark table, it give me error and mark <strong>Users</strong> (table name) word with <strong>red line</strong></p>\n"}, {"tags": ["c#", "asp.net-mvc", "asp.net-web-api"], "comments": [{"owner": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 0, "creation_date": 1548269343, "post_id": 54333770, "comment_id": 95485196, "body": "There seems to be plenty of articles out there: <a href=\"https://www.google.com/search?q=web+api+azure+active+directory+authentication\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>. What <b>specifically</b> is not working or have you tried."}, {"owner": {"reputation": 390, "user_id": 2066483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/63420e9009ecb243a89b73a564ee73ee?s=128&d=identicon&r=PG", "display_name": "Rhendar", "link": "https://stackoverflow.com/users/2066483/rhendar"}, "reply_to_user": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 0, "creation_date": 1548269623, "post_id": 54333770, "comment_id": 95485323, "body": "@Igor I&#39;m trying to get it to work with Azure but Azure is forcing me to do a redirect to a Microsoft website to login. This redirect looks completely unprofessional for one and for two it stops the Visual Studio debugger which means that after the login is complete and the user is redirected back to the website I can&#39;t test anything else because the debugger has stopped. Reattaching the debugger to the window doesn&#39;t work either because it doesn&#39;t hit any breakpoints."}, {"owner": {"reputation": 5357, "user_id": 1030169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b40f413b34463de22c81d35b4c1930?s=128&d=identicon&r=PG", "display_name": "jmoerdyk", "link": "https://stackoverflow.com/users/1030169/jmoerdyk"}, "reply_to_user": {"reputation": 54898, "user_id": 1260204, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/402e1da680f92d16e7736ab14a696f06?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/1260204/igor"}, "edited": false, "score": 0, "creation_date": 1548269642, "post_id": 54333770, "comment_id": 95485333, "body": "@Igor that&#39;s for <i>Azure</i> AD, which is different than a local AD instance, which Microsoft no longer supports out of the box as they did prior to the Identity system for authentication.  Unfortunately from my experience, the answer seem that you need to roll your own"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7758647"}, "is_accepted": true, "score": 1, "last_activity_date": 1548365326, "creation_date": 1548365326, "answer_id": 54355565, "question_id": 54333770, "link": "https://stackoverflow.com/questions/54333770/web-api-authentication-via-active-directory/54355565#54355565", "title": "Web API authentication via Active Directory", "body": "<p>You will always be redirected if you're using Azure AD. You shouldn't be able to do this locally to my knowledge.</p>\n"}], "owner": {"reputation": 390, "user_id": 2066483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/63420e9009ecb243a89b73a564ee73ee?s=128&d=identicon&r=PG", "display_name": "Rhendar", "link": "https://stackoverflow.com/users/2066483/rhendar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 54355565, "answer_count": 1, "score": 1, "last_activity_date": 1548365326, "creation_date": 1548269146, "question_id": 54333770, "link": "https://stackoverflow.com/questions/54333770/web-api-authentication-via-active-directory", "title": "Web API authentication via Active Directory", "body": "<p>How does one go about tying in AD authentication to an existing Web API? I've attempted to do this with Azure but Azure doesn't play nice with Web APIs. The constant redirects are a nightmare. Is there some way I can set it up to just hit a local AD sever, authenticate the user, and get back a token? It seems like it should be fairly simple but I'm finding no information on this.</p>\n"}, {"tags": ["c#", "asp.net", "wcf", "iis", "http-error"], "comments": [{"owner": {"reputation": 947, "user_id": 864433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9119fed98488e35dd4d179eb4a08c44d?s=128&d=identicon&r=PG", "display_name": "Clay Ver Valen", "link": "https://stackoverflow.com/users/864433/clay-ver-valen"}, "edited": false, "score": 0, "creation_date": 1548271208, "post_id": 54333715, "comment_id": 95486007, "body": "Did you try the steps here <a href=\"https://www.codeproject.com/Tips/882774/Fix-HTTP-Error-The-requested-content\" rel=\"nofollow noreferrer\">codeproject.com/Tips/882774/&hellip;</a> to remove ISAPI and CGI restrictions?"}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 0, "creation_date": 1548276715, "post_id": 54333715, "comment_id": 95488242, "body": "&quot;developing this service was real fun&quot;. It might be such a fun that you ignore the fact that WCF is almost dead and everyone else moves to ASP.NET Core Web API."}, {"owner": {"reputation": 162, "user_id": 7547137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827cc7fb0f93b91e177a02e6648c74f1?s=128&d=identicon&r=PG&f=1", "display_name": "lionthefox", "link": "https://stackoverflow.com/users/7547137/lionthefox"}, "reply_to_user": {"reputation": 947, "user_id": 864433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9119fed98488e35dd4d179eb4a08c44d?s=128&d=identicon&r=PG", "display_name": "Clay Ver Valen", "link": "https://stackoverflow.com/users/864433/clay-ver-valen"}, "edited": false, "score": 0, "creation_date": 1548315747, "post_id": 54333715, "comment_id": 95499028, "body": "@ClayVerValen Thanks, i will give it a try tonight."}, {"owner": {"reputation": 162, "user_id": 7547137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827cc7fb0f93b91e177a02e6648c74f1?s=128&d=identicon&r=PG&f=1", "display_name": "lionthefox", "link": "https://stackoverflow.com/users/7547137/lionthefox"}, "reply_to_user": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 0, "creation_date": 1548315882, "post_id": 54333715, "comment_id": 95499097, "body": "@LexLi Still works as supposed to (besides from my problem), so i don&#39;t really care too much. Also it&#39;s my first web service, so I&#39;m not too fussed about it. Thanks for your advice though."}], "answers": [{"tags": [], "owner": {"reputation": 162, "user_id": 7547137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827cc7fb0f93b91e177a02e6648c74f1?s=128&d=identicon&r=PG&f=1", "display_name": "lionthefox", "link": "https://stackoverflow.com/users/7547137/lionthefox"}, "is_accepted": false, "score": 0, "last_activity_date": 1548336460, "creation_date": 1548336460, "answer_id": 54347770, "question_id": 54333715, "link": "https://stackoverflow.com/questions/54333715/wcf-http-404-17-not-found-after-depyloing-to-local-iis/54347770#54347770", "title": "WCF: HTTP 404.17 NOT FOUND after depyloing to local iis", "body": "<p>Solved it:\nThe problem was that there was no IIS APPPOOL Login for my SQLSERVER Database configured.\nHere is the step by step explanation: <a href=\"https://stackoverflow.com/a/7698316/7547137\">https://stackoverflow.com/a/7698316/7547137</a></p>\n"}], "owner": {"reputation": 162, "user_id": 7547137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827cc7fb0f93b91e177a02e6648c74f1?s=128&d=identicon&r=PG&f=1", "display_name": "lionthefox", "link": "https://stackoverflow.com/users/7547137/lionthefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 755, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548336460, "creation_date": 1548268968, "question_id": 54333715, "link": "https://stackoverflow.com/questions/54333715/wcf-http-404-17-not-found-after-depyloing-to-local-iis", "title": "WCF: HTTP 404.17 NOT FOUND after depyloing to local iis", "body": "<p>I created a restful web service in WCF. Everything works perfectly fine if i host it via IISExpress in Visual Studio. But after deploying it to local IIS, a 404.17 NOT FOUND error occures, when trying to access the .svc service.\nIt states: \n\"Not Found The requested content appears to be script and will not be served by the static file handler\"</p>\n\n<p>I already tried these solutions:</p>\n\n<blockquote>\n  <p>Launch Command Prompt - Start - cmd.exe cd C:\\Windows\\Microsoft.NET\\Framework64[Dot Net Version] aspnet_regiis -ir \n  and\n  \"C:\\Windows\\Microsoft.NET\\Framework\\v3.0\\Windows Communication Foundation\" and execute\"servicemodelreg -i\" to install them manually.</p>\n</blockquote>\n\n<p>which did not change anything.</p>\n\n<p>I'm pretty sure it's a configuration problem but can't figure it out since I'm quite unexperienced in doing this.</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;configuration&gt;\n  &lt;configSections&gt;\n    &lt;section name=\"entityFramework\" type=\"System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" requirePermission=\"false\"/&gt;\n  &lt;/configSections&gt;\n  &lt;appSettings/&gt;\n  &lt;system.web&gt;\n    &lt;compilation debug=\"true\" targetFramework=\"4.6.2\"/&gt;\n    &lt;httpRuntime/&gt;\n    &lt;pages controlRenderingCompatibilityVersion=\"3.5\" clientIDMode=\"AutoID\"/&gt;\n  &lt;/system.web&gt;\n  &lt;system.serviceModel&gt;\n    &lt;behaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"ServiceBehavior\"&gt;\n          &lt;serviceMetadata httpGetEnabled=\"true\" httpsGetEnabled=\"true\"/&gt;\n          &lt;serviceDebug includeExceptionDetailInFaults=\"true\"/&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n      &lt;endpointBehaviors&gt;\n        &lt;behavior name=\"webHttpServiceBehavior\"&gt;\n          &lt;webHttp/&gt;\n        &lt;/behavior&gt;\n      &lt;/endpointBehaviors&gt;\n    &lt;/behaviors&gt;\n    &lt;services&gt;\n      &lt;service name=\"MyService.Service\" behaviorConfiguration=\"ServiceBehavior\"&gt;\n        &lt;host&gt;\n          &lt;baseAddresses&gt;\n            &lt;add baseAddress=\"http://localhost/\"/&gt;\n          &lt;/baseAddresses&gt;\n        &lt;/host&gt;\n        &lt;endpoint binding=\"webHttpBinding\" contract=\"MyService.IMyService\" behaviorConfiguration=\"webHttpServiceBehavior\"/&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;serviceHostingEnvironment aspNetCompatibilityEnabled=\"true\" multipleSiteBindingsEnabled=\"true\"/&gt;\n  &lt;/system.serviceModel&gt;\n  &lt;system.webServer&gt;\n    &lt;modules runAllManagedModulesForAllRequests=\"true\"/&gt;\n    &lt;directoryBrowse enabled=\"true\"/&gt;\n  &lt;/system.webServer&gt;\n  &lt;entityFramework&gt;\n    &lt;defaultConnectionFactory type=\"System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework\"&gt;\n      &lt;parameters&gt;\n        &lt;parameter value=\"mssqllocaldb\"/&gt;\n      &lt;/parameters&gt;\n    &lt;/defaultConnectionFactory&gt;\n    &lt;providers&gt;\n      &lt;provider invariantName=\"System.Data.SqlClient\" type=\"System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer\"/&gt;\n    &lt;/providers&gt;\n  &lt;/entityFramework&gt;\n  &lt;connectionStrings&gt;\n    &lt;add name=\"MyEntities\" connectionString=\"metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;data source=localhost\\myDB;initial catalog=DB;integrated security=True;multipleactiveresultsets=True;application name=EntityFramework&amp;quot;\" providerName=\"System.Data.EntityClient\"/&gt;\n  &lt;/connectionStrings&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>I'm pretty frustrated after trying for days because developing this service was real fun until deployment failed completely.\nI would really appreciate any hints. \nThanks!</p>\n"}, {"tags": ["c#", ".net", "wcf"], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 671775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d7f17a5b6e55de251d8dba3d13ef025?s=128&d=identicon&r=PG", "display_name": "Sheridan", "link": "https://stackoverflow.com/users/671775/sheridan"}, "edited": false, "score": 0, "creation_date": 1548683523, "post_id": 54360119, "comment_id": 95617323, "body": "The key is this sentence: &quot;I am trying to figure out how to replace their endpoint which is in the app.config with one created in code so I can load endpoint URL, username, and password using DI&quot;.  When I create the endpoint using the configuration in the app.config I find that I am unable to set the username and password.  I would have expected this line of code to do it: mailingService.ClientCredentials.UserName.UserName = userName; but I think it isn&#39;t working because the credentials are in the wsse:username node.  Regardless I couldn&#39;t figure out how to set it."}], "tags": [], "owner": {"reputation": 746, "user_id": 10833805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db33df97e3a162199b1dff1d47fe0073?s=128&d=identicon&r=PG&f=1", "display_name": "Ackelry Xu", "link": "https://stackoverflow.com/users/10833805/ackelry-xu"}, "is_accepted": false, "score": 0, "last_activity_date": 1548398244, "creation_date": 1548398244, "answer_id": 54360119, "question_id": 54333710, "link": "https://stackoverflow.com/questions/54333710/how-to-add-organizationtoken-to-wcf-endpoint-in-code/54360119#54360119", "title": "How to Add OrganizationToken to WCF Endpoint in code", "body": "<p>I see you app.config has configured headers node and it seems you are not using the endpointconfig. Instead, you  add headers in your c# code.</p>\n\n<p>How about directly use the  endpoint configuration in your app.config?</p>\n\n<pre><code>var mailingService = new MailingServiceClient(\"MailingServicePort\")\n</code></pre>\n\n<p>If you want to add addressHeader, you could also try to use OutgoingMessageHeaders or HttpRequestMessageProperty.\n<a href=\"https://code.msdn.microsoft.com/windowsapps/How-to-add-custom-5cbbf066\" rel=\"nofollow noreferrer\">https://code.msdn.microsoft.com/windowsapps/How-to-add-custom-5cbbf066</a></p>\n\n<p>Please ensure where you want to add the header, OutgoingMessageHeaders is used to add a soap header and HttpRequestMessageProperty is used to add a header in request header.</p>\n"}], "owner": {"reputation": 241, "user_id": 671775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d7f17a5b6e55de251d8dba3d13ef025?s=128&d=identicon&r=PG", "display_name": "Sheridan", "link": "https://stackoverflow.com/users/671775/sheridan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548398244, "creation_date": 1548268939, "last_edit_date": 1548269262, "question_id": 54333710, "link": "https://stackoverflow.com/questions/54333710/how-to-add-organizationtoken-to-wcf-endpoint-in-code", "title": "How to Add OrganizationToken to WCF Endpoint in code", "body": "<p>I am trying to connect to a SOAP API of a vendor and I have a sample project they provided which works.  I am trying to figure out how to replace their endpoint which is in the app.config with one created in code so I can load endpoint URL, username, and password using DI.</p>\n\n<p>Here is the relevant XML from the app.config:</p>\n\n<p><code>&lt;client&gt;\n      &lt;endpoint address=\"https://strongmail.com/sm/services/mailing/v2\" binding=\"basicHttpBinding\" bindingConfiguration=\"MailingServiceServiceSoapBinding\" contract=\"MailingService\" name=\"MailingServicePort\"&gt;\n        &lt;headers&gt;\n          &lt;SOAP-ENV:Header xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n            &lt;wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"&gt;\n              &lt;wsse:UsernameToken wsu:Id=\"UsernameToken\"&gt;\n                &lt;wsse:Username&gt;Username&lt;/wsse:Username&gt;\n                &lt;wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\"&gt;Password&lt;/wsse:Password&gt;\n              &lt;/wsse:UsernameToken&gt;\n              &lt;OrganizationToken xmlns=\"http://www.strongmail.com/services/v2/schema\"&gt;\n                &lt;organizationName&gt;admin&lt;/organizationName&gt;\n                &lt;subOrganizationId&gt;\n                  &lt;id&gt;1&lt;/id&gt;\n                &lt;/subOrganizationId&gt;\n              &lt;/OrganizationToken&gt;\n            &lt;/wsse:Security&gt;\n          &lt;/SOAP-ENV:Header&gt;\n        &lt;/headers&gt;\n      &lt;/endpoint&gt;<br>\n    &lt;/client&gt;</code></p>\n\n<p>This is the code I am trying to use to instantiate this.</p>\n\n<pre><code>public class SelligentOrganizationToken\n    {\n        public string organizationName { get; set; }\n        public SelligentOrganization subOrganizationId { get; set; }\n    }\n\n    public class SelligentOrganization\n    {\n        public string id { get; set; }\n    }\n\n    private MailingService CreateMailingService(string mailingServiceUrl, string userName, string password)\n    {\n\n        var securityElement = SecurityBindingElement.CreateUserNameOverTransportBindingElement();\n        securityElement.IncludeTimestamp = false;\n        var encodingElement = new TextMessageEncodingBindingElement(MessageVersion.Soap11, Encoding.UTF8);\n        var transportElement = new HttpsTransportBindingElement();\n\n        var customBinding = new CustomBinding(securityElement, encodingElement, transportElement);\n\n        var remoteAddress = new EndpointAddress(mailingServiceUrl);\n\n        var mailingService = new MailingServiceClient(customBinding, remoteAddress);\n\n        mailingService.ClientCredentials.UserName.UserName = userName;\n        mailingService.ClientCredentials.UserName.Password = password;\n\n        ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls11;\n\n        var selligentOrganizationToken = new SelligentOrganizationToken()\n        {\n            organizationName = \"admin\",\n            subOrganizationId = new SelligentOrganization()\n            {\n                id = \"1\"\n            }\n        };\n\n        //Serialize object to xml\n        XmlObjectSerializer xmlObjectSerializer = new DataContractSerializer(typeof(SelligentOrganizationToken), \"OrganizationToken\", \"http://www.strongmail.com/services/v2/schema\");\n\n        var eab = new EndpointAddressBuilder(mailingService.Endpoint.Address);\n        eab.Headers.Add(AddressHeader.CreateAddressHeader(\"OrganizationToken\", \"http://www.strongmail.com/services/v2/schema\", selligentOrganizationToken, xmlObjectSerializer));\n        mailingService.Endpoint.Address = eab.ToEndpointAddress();\n\n        return mailingService;\n    }\n</code></pre>\n\n<p>When I try to run this I am getting:</p>\n\n<p>System.ServiceModel.FaultException: 'A security error was encountered when verifying the message'</p>\n\n<p>Which, incidentally, is what I get when running the example code if I remove the OrganizationToken node.</p>\n\n<p>Any help on this will be greatly appreciated, thank you in advance!</p>\n"}, {"tags": ["c#", "delegates", "copy-paste"], "comments": [{"owner": {"reputation": 619, "user_id": 2623538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhR1w.jpg?s=128&g=1", "display_name": "NaDeR Star", "link": "https://stackoverflow.com/users/2623538/nader-star"}, "edited": false, "score": 0, "creation_date": 1548269816, "post_id": 54333666, "comment_id": 95485429, "body": "Pass the RecordType to your method and make conditions by it..."}], "answers": [{"comments": [{"owner": {"reputation": 6892, "user_id": 285336, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/786bbfa1943aa036324b118790febfe8?s=128&d=identicon&r=PG", "display_name": "Oleg Sh", "link": "https://stackoverflow.com/users/285336/oleg-sh"}, "edited": false, "score": 0, "creation_date": 1548295276, "post_id": 54334067, "comment_id": 95493494, "body": "If we have one more type then our foreach would be with one more if like: <code>foreach if(record.RecordType == recordTypeToCheck) res = (TDomainType)smth else if....</code>"}], "tags": [], "owner": {"reputation": 12429, "user_id": 4995012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a300442854f4caef5cd41a7b3084a6e?s=128&d=identicon&r=PG", "display_name": "Fabjan", "link": "https://stackoverflow.com/users/4995012/fabjan"}, "is_accepted": false, "score": 1, "last_activity_date": 1548271137, "last_edit_date": 1548271137, "creation_date": 1548270359, "answer_id": 54334067, "question_id": 54333666, "link": "https://stackoverflow.com/questions/54333666/c-how-to-rewrite-it-without-copy-paste-code/54334067#54334067", "title": "C#: How to rewrite it without &quot;copy/paste&quot; code", "body": "<p>Well, you could first write down a simplified schema for methods and analyze their structure:</p>\n\n<pre><code>Method1(domain)\n  some stuff...\n  foreach if(c1) res = (Type1)smth\n  if (res == null) throw ex(errMsg1)\n\nMethod2(domain)\n  some stuff...\n  foreach if(c2) res = (Type2)smth\n  if (res == null) throw ex(errMsg2)\n</code></pre>\n\n<p>So what each function has? </p>\n\n<ul>\n<li>Common code (including foreach loop)</li>\n<li>Some specific condition in 'if' statement</li>\n<li>Specific type to which we cast the result to</li>\n<li>Specific error message that we use for exception we throw in case when result is null or empty</li>\n</ul>\n\n<p>How can we fulfill these conditions and create one function? </p>\n\n<ul>\n<li>For number one in our list we don't need anything</li>\n<li>For second condition we can pass argument which we then use in\n'if' condition.</li>\n<li>For third we can either use generics and pass the type as type\nparameter or cast result to <code>dynamic</code></li>\n<li>Error message once again we can accept as parameter</li>\n</ul>\n\n<p>So a simplified structure of a new method might look like:</p>\n\n<pre><code>Method3&lt;TDomainType&gt;(domain, recordTypeToCheck, errorMsg)\n  some stuff...\n  foreach if(record.RecordType == recordTypeToCheck) res = (TDomainType)smth\n  if (res == null) throw ex with errorMsg \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 283, "user_id": 8839621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18c369a0fe291fbcd80d90207b4bb4ca?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Ma\u0142ek", "link": "https://stackoverflow.com/users/8839621/adam-ma%c5%82ek"}, "is_accepted": true, "score": 2, "last_activity_date": 1548284451, "last_edit_date": 1548284451, "creation_date": 1548276789, "answer_id": 54335458, "question_id": 54333666, "link": "https://stackoverflow.com/questions/54333666/c-how-to-rewrite-it-without-copy-paste-code/54335458#54335458", "title": "C#: How to rewrite it without &quot;copy/paste&quot; code", "body": "<p>First define common interface</p>\n\n<pre><code>public interface IExtractor\n{\n    string RecordType { get; }\n    string ErrorMessage { get; }\n    string GetValue(object record);\n}\n</code></pre>\n\n<p>Next create implementations</p>\n\n<pre><code>class MxRecordExtractor : IExtractor\n{\n    public string RecordType =&gt; \"Mx\";\n\n    public string ErrorMessage =&gt; DomainRegistrationCore.Models.DomainRecordType.MX;\n\n    public string GetValue(object record)\n    {\n        return ((Microsoft.Graph.DomainDnsMxRecord)record).MailExchange;\n    }\n}\n\nclass VerificationRecordExtractor : IExtractor\n{\n    public string RecordType =&gt; \"Txt\";\n\n    public string ErrorMessage =&gt; DomainRegistrationCore.Models.DomainRecordType.TXT;\n\n    public string GetValue(object record)\n    {\n        return ((Microsoft.Graph.DomainDnsTxtRecord)record).Text;\n    }\n}\n</code></pre>\n\n<p>Later create private abstracted version of method:</p>\n\n<pre><code>private async Task&lt;string&gt; ExtractForDomainAsync(string domain, IExtractor extractor)\n{\n    try\n    {\n        var records = (await _graphClient.Domains[domain].VerificationDnsRecords.Request().GetAsync());\n        string extractedValue = String.Empty;\n\n        foreach (var record in records)\n        {\n            if (record.RecordType == extractor.RecordType)\n            {\n                extractedValue = extractor.GetValue(record);\n                break;\n            }\n        }\n\n        if (String.IsNullOrWhiteSpace(extractedValue))\n            throw new DomainRecordNotFoundException(extractor.ErrorMessage);\n\n        return extractedValue;\n    }\n    catch (ServiceException graphEx)\n    {\n        if (graphEx.StatusCode == System.Net.HttpStatusCode.NotFound)\n        {\n            throw new DomainNotFoundException();\n        }\n\n        throw new UnknownException(graphEx.StatusCode, graphEx.Error.Message);\n    }\n}\n</code></pre>\n\n<p>Finally modify existing methods to use our common method:</p>\n\n<pre><code>public Task&lt;string&gt; GetMxRecordForDomainAsync(string domain)\n{\n    return ExtractForDomainAsync(domain,  new MxRecordExtractor());\n}\n\npublic Task&lt;string&gt; GetVerificationRecordForDomainAsync(string domain)\n{\n    return ExtractForDomainAsync(domain, new VerificationRecordExtractor());\n}\n</code></pre>\n"}], "owner": {"reputation": 6892, "user_id": 285336, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/786bbfa1943aa036324b118790febfe8?s=128&d=identicon&r=PG", "display_name": "Oleg Sh", "link": "https://stackoverflow.com/users/285336/oleg-sh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 54335458, "answer_count": 2, "score": 1, "last_activity_date": 1548284451, "creation_date": 1548268761, "question_id": 54333666, "link": "https://stackoverflow.com/questions/54333666/c-how-to-rewrite-it-without-copy-paste-code", "title": "C#: How to rewrite it without &quot;copy/paste&quot; code", "body": "<p>I have 2 similar methods:</p>\n\n<pre><code>    /// &lt;summary&gt;\n    /// \n    /// &lt;/summary&gt;\n    /// &lt;param name=\"domain\"&gt;&lt;/param&gt;\n    /// &lt;exception cref=\"DomainRecordNotFoundException\"&gt;Throw when the dns record is not found in Office365&lt;/exception&gt;\n    /// &lt;exception cref=\"DomainNotFoundException\"&gt;Throw when domain is not added to Office365&lt;/exception&gt;\n    /// &lt;exception cref=\"UnknownException\"&gt;Unknown exception from Microsoft Graph&lt;/exception&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public async Task&lt;string&gt; GetMxRecordForDomainAsync(string domain)\n    {\n        try\n        {\n            var records = await _graphClient.Domains[domain].ServiceConfigurationRecords.Request().GetAsync();\n            string mxRecord = String.Empty;\n\n            foreach (var record in records)\n            {\n                if (record.RecordType == \"Mx\")\n                {\n                    mxRecord = ((Microsoft.Graph.DomainDnsMxRecord)record).MailExchange;\n                    break;\n                }\n            }\n\n            if (String.IsNullOrWhiteSpace(mxRecord))\n                throw new DomainRecordNotFoundException(DomainRegistrationCore.Models.DomainRecordType.MX);\n\n            return mxRecord;\n        }\n        catch (ServiceException graphEx)\n        {\n            if (graphEx.StatusCode == System.Net.HttpStatusCode.NotFound)\n            {\n                throw new DomainNotFoundException();\n            }\n\n            throw new UnknownException(graphEx.StatusCode, graphEx.Error.Message);\n        }\n    }\n\n    /// &lt;summary&gt;\n    /// \n    /// &lt;/summary&gt;\n    /// &lt;param name=\"domain\"&gt;&lt;/param&gt;\n    /// &lt;exception cref=\"DomainRecordNotFoundException\"&gt;Throw when the dns record is not found in Office365&lt;/exception&gt;\n    /// &lt;exception cref=\"DomainNotFoundException\"&gt;Throw when domain is not added to Office365&lt;/exception&gt;\n    /// &lt;exception cref=\"UnknownException\"&gt;Unknown exception from Microsoft Graph&lt;/exception&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public async Task&lt;string&gt; GetVerificationRecordForDomainAsync(string domain)\n    {\n        try\n        {\n            var records = (await _graphClient.Domains[domain].VerificationDnsRecords.Request().GetAsync());\n            string verificationText = String.Empty;\n\n            foreach (var record in records)\n            {\n                if (record.RecordType == \"Txt\")\n                {\n                    verificationText = ((Microsoft.Graph.DomainDnsTxtRecord)record).Text;\n                    break;\n                }\n            }\n\n            if (String.IsNullOrWhiteSpace(verificationText))\n                throw new DomainRecordNotFoundException(DomainRegistrationCore.Models.DomainRecordType.TXT);\n\n            return verificationText;\n        }\n        catch (ServiceException graphEx)\n        {\n            if (graphEx.StatusCode == System.Net.HttpStatusCode.NotFound)\n            {\n                throw new DomainNotFoundException();\n            }\n\n            throw new UnknownException(graphEx.StatusCode, graphEx.Error.Message);\n        }\n    }\n</code></pre>\n\n<p>as we can see, these 2 methods differ only this part:</p>\n\n<pre><code>        foreach (var record in records)\n        {\n            if (record.RecordType == **RECORD**)\n            {\n                mxRecord = ((**TYPE_OF_RECORD**)record).MailExchange;\n                break;\n            }\n        }\n\n        if (String.IsNullOrWhiteSpace(mxRecord))\n            throw new DomainRecordNotFoundException(**RECORD**);\n</code></pre>\n\n<p>other parts are the same. I want to rewrite it for one common method, but don't understand how. I assume, that I can do it with <code>Func&lt;&gt;</code> or <code>Action&lt;&gt;</code></p>\n"}, {"tags": ["c#", "outlook-addin"], "comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1548278556, "post_id": 54333624, "comment_id": 95488986, "body": "Is the message visible in the list when you attempt to select it?"}, {"owner": {"reputation": 3, "user_id": 5796588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f854fa81a6731f76c10aaec8b5a3a4d5?s=128&d=identicon&r=PG&f=1", "display_name": "jbryan10", "link": "https://stackoverflow.com/users/5796588/jbryan10"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1548338693, "post_id": 54333624, "comment_id": 95512300, "body": "If the inbox folder is currently selected and an email in the inbox folder is selected, then it works. If an email in the sent items folder is selected (and the inbox folder is still selected in the explorer), then I get the exception, but this is after the code has already selected the sent items folder."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1548355229, "post_id": 54333624, "comment_id": 95521907, "body": "After the folder is selected, the message list is populated asynchronously, you might have to wait until that happens."}, {"owner": {"reputation": 3, "user_id": 5796588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f854fa81a6731f76c10aaec8b5a3a4d5?s=128&d=identicon&r=PG&f=1", "display_name": "jbryan10", "link": "https://stackoverflow.com/users/5796588/jbryan10"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1548432210, "post_id": 54333624, "comment_id": 95551745, "body": "Ok, that is definitely the problem. I added a wait method just to test it out and that works as expected, but I would certainly prefer a way to execute upon completion of the message list being populated. Any thoughts on how to do that?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 1, "creation_date": 1548435622, "post_id": 54333624, "comment_id": 95553591, "body": "I can only think of using Explorer.FolderSwitch event if you are setting the Explorer.CurrentFolder property."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5796588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f854fa81a6731f76c10aaec8b5a3a4d5?s=128&d=identicon&r=PG&f=1", "display_name": "jbryan10", "link": "https://stackoverflow.com/users/5796588/jbryan10"}, "edited": false, "score": 0, "creation_date": 1596812184, "post_id": 59260688, "comment_id": 111939918, "body": "Sorry for the delayed response! The <code>oNS.Folders[mailItem.ReceivedByName].Folders</code> bit is causing trouble as it throws an &quot;Array index out of bounds&quot; exception. This is caused by the <code>mailItem.ReceivedByName</code> being &quot;null&quot;. However if it is an email that I sent, then the &quot;ReceivedByName&quot; is going to cause issues anyway since it will be trying to look at another user&#39;s folders, right? I tried &quot;SenderName&quot;, but that doesn&#39;t work either. What I need is <code>mailItem.Parent.Parent</code> to get back to the main folder, but that doesn&#39;t work either."}], "tags": [], "owner": {"reputation": 11, "user_id": 4574303, "user_type": "registered", "profile_image": "https://graph.facebook.com/723607444404233/picture?type=large", "display_name": "\uc7a5\uc778\uc218", "link": "https://stackoverflow.com/users/4574303/%ec%9e%a5%ec%9d%b8%ec%88%98"}, "is_accepted": false, "score": 0, "last_activity_date": 1576039164, "last_edit_date": 1576039164, "creation_date": 1575955140, "answer_id": 59260688, "question_id": 54333624, "link": "https://stackoverflow.com/questions/54333624/how-to-select-a-mailitem-not-in-the-explorer-currentview/59260688#59260688", "title": "How to select a MailItem not in the Explorer CurrentView", "body": "<p>Try this code</p>\n\n<pre><code>public void SetExplorerSelection(string emailID)\n{\n\n    //Get Outlook namespace\n    var oApp = Globals.ThisAddIn.Application;\n    var oNS = oApp.GetNamespace(\"mapi\");\n\n    //Get the Active Explorer\n    Microsoft.Office.Interop.Outlook.Explorer activeExplorer = oApp.ActiveExplorer();\n\n    //Clear the current selection\n    activeExplorer.ClearSelection();\n\n    //Get the Mail Item\n    try\n    {\n        MailItem mailItem = oNS.GetItemFromID(emailID);\n\n        if (activeExplorer.IsItemSelectableInView(mailItem))\n        {\n            //Show the item in the Explorer\n            activeExplorer.AddToSelection(mailItem);\n\n            return;\n        }\n        else\n        {\n            int flag = 0;\n            foreach(Microsoft.Office.Interop.Outlook.MAPIFolder myDestFolder in oNS.Folders[mailItem.ReceivedByName].Folders)\n            {\n                activeExplorer.CurrentFolder = myDestFolder;\n                foreach (Microsoft.Office.Interop.Outlook.View tmp in myDestFolder.Views)\n                {\n                    try\n                    {\n                        activeExplorer.CurrentView = tmp;\n                        activeExplorer.ClearSelection();\n                        activeExplorer.AddToSelection(item);\n\n                        tmp.Reset();\n                        tmp.Apply();\n\n                        flag = 1;\n                        break;\n                    }\n                    catch\n                    {\n                        continue;\n                    }\n                }\n\n                if(flag ==1 )\n                    break;\n            }\n\n        }\n    }\n    catch\n    {\n        MessageBox.Show(\"It is deleted message\");\n    }\n\n}\n</code></pre>\n\n<p>Thank you </p>\n"}], "owner": {"reputation": 3, "user_id": 5796588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f854fa81a6731f76c10aaec8b5a3a4d5?s=128&d=identicon&r=PG&f=1", "display_name": "jbryan10", "link": "https://stackoverflow.com/users/5796588/jbryan10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576039164, "creation_date": 1548268591, "question_id": 54333624, "link": "https://stackoverflow.com/questions/54333624/how-to-select-a-mailitem-not-in-the-explorer-currentview", "title": "How to select a MailItem not in the Explorer CurrentView", "body": "<p>When trying to programmatically select a MailItem to be shown in the ActiveExplorer, I get the \"Cannot select or deselect the item because it is not available in the current view\" exception.</p>\n\n<p>I have a TaskPane in Outlook showing a list of emails based on some user specified search criteria and I am trying to allow the user to right-click on a single email (in the TaskPane) and show it in the Explorer window. This works great when the user currently has their inbox open/selected in the Explorer and they attempt to show an email found in their inbox. However, if they try to show an email found in their sent box, then it throws the \"Cannot select or deselect the item because it is not available in the current view\" exception.</p>\n\n<p>I am updating the view by setting the ActiveExplorer.CurrentFolder property to the selected email's parent folder and this seems to be the best way to do this. I confirmed that the CurrentFolder and CurrentView properties are changing to what they should be and that the Explorer view does indeed change, but I still get the exception when I try to select the item.</p>\n\n<p>I originally just tried to change the CurrentFolder, then AddToSelection, but moved the AddToSelection to an event handler thinking that it was happening to fast. Of course, that didn't fix the problem.</p>\n\n<pre><code>    public void SetExplorerSelection(string emailID)\n    {\n\n        //Get Outlook namespace\n        var oApp = Globals.ThisAddIn.Application;\n        var oNS = oApp.GetNamespace(\"mapi\");\n\n        //Get the Active Explorer\n        Microsoft.Office.Interop.Outlook.Explorer activeExplorer = oApp.ActiveExplorer();\n\n        //Clear the current selection\n        activeExplorer.ClearSelection();\n\n        //Get the Mail Item\n        MailItem mailItem = oNS.GetItemFromID(emailID);\n\n        if (activeExplorer.IsItemSelectableInView(mailItem))\n        {\n            //Show the item in the Explorer\n            activeExplorer.AddToSelection(mailItem);\n\n            return;\n        }\n        else\n        {\n\n            //* indicates items that were added to TRY to fix the problem\n\n            //*Send selected item to public var\n            currentMail = mailItem;\n\n            //*Get the Current View\n            Microsoft.Office.Interop.Outlook.View cView = activeExplorer.CurrentView;\n\n            //*Check the initial states of CurrentFolder and CurrentView\n            Debug.Print(\"Folder (from): \" + activeExplorer.CurrentFolder.Name);\n            Debug.Print(\"View (from): \" + cView.Name);\n\n            //*Create event handler for ViewSwitch\n            activeExplorer.ViewSwitch += new ExplorerEvents_10_ViewSwitchEventHandler(Explorer_ViewSwitch);\n\n            //Change the Current Folder being viewed in the Explorer\n            activeExplorer.CurrentFolder = mailItem.Parent as Microsoft.Office.Interop.Outlook.Folder;\n\n            //*Reset/Apply changes to the CurrentView\n            cView = activeExplorer.CurrentView;\n            cView.Reset();\n            cView.Apply();\n\n            //activeExplorer.AddToSelection(mailItem);\n\n        }\n\n\n    }\n\n    //*ViewSwitch Event Handler\n    public void Explorer_ViewSwitch()\n    {\n\n        //Get Outlook namespace\n        var oApp = Globals.ThisAddIn.Application;\n        var oNS = oApp.GetNamespace(\"mapi\");\n\n        //Get the ActiveExplorer\n        Microsoft.Office.Interop.Outlook.Explorer activeExplorer = oApp.ActiveExplorer();\n\n        //Get the CurrentView\n        Microsoft.Office.Interop.Outlook.View cView = activeExplorer.CurrentView;\n\n        //Check the current states of CurrentFolder and CurrentView\n        Debug.Print(\"Folder (to): \" + activeExplorer.CurrentFolder.Name);\n        Debug.Print(\"View (to): \" + cView.Name);\n\n        //Add the item to the selection\n        //***This is where the exception occurs***\n        activeExplorer.AddToSelection(currentMail);\n\n        //Reset the public var\n        currentMail = null;\n\n    }\n</code></pre>\n\n<p>As I mentioned, I confirmed that the Debugs are showing the correct information (switching from inbox to sent box) and that the view itself is changed (sent items folder is selected) in the Explorer before getting the exception. If I continue running the code and try again with the same email now that the view is already set as the sent box, it works fine and properly pulls up the sent email.</p>\n"}, {"tags": ["c#", "wpf", "unity-container", "prism", "prism-7"], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 560476, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab37eddeed363daec875ae10403ed977?s=128&d=identicon&r=PG&f=1", "display_name": "metoyou", "link": "https://stackoverflow.com/users/560476/metoyou"}, "edited": false, "score": 0, "creation_date": 1582194482, "post_id": 54343953, "comment_id": 106696666, "body": "Annoying the issue has been locked as an alternative use case would be an application that is ran in the system tray from start so would have no starting window!"}], "tags": [], "owner": {"reputation": 8866, "user_id": 5758420, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a47e2744f0e5b6f84407efd06dbee96f?s=128&d=identicon&r=PG&f=1", "display_name": "Haukinger", "link": "https://stackoverflow.com/users/5758420/haukinger"}, "is_accepted": true, "score": 4, "last_activity_date": 1548339526, "last_edit_date": 1548339526, "creation_date": 1548324278, "answer_id": 54343953, "question_id": 54333568, "link": "https://stackoverflow.com/questions/54333568/prism-7-using-prismapplication-createshell-with-a-non-window-control/54343953#54343953", "title": "Prism 7. Using PrismApplication.CreateShell() with a non Window control", "body": "<blockquote>\n  <p>do I have to roll back and use the BootStrapper like before?</p>\n</blockquote>\n\n<p>The bootstrapper is still there. It is marked as deprecated and might go away in a future version, but as long as it's there, you can use it. <s>At least, until the problem with <code>PrismApplicationBase</code> is fixed. You should create an issue on <a href=\"https://github.com/PrismLibrary/Prism/issues\" rel=\"nofollow noreferrer\">github</a> for that.</s></p>\n\n<p>Edit:</p>\n\n<p>The issue has already been brought up and it won't be fixed (<a href=\"https://github.com/PrismLibrary/Prism/issues/1413\" rel=\"nofollow noreferrer\">1413</a>).</p>\n\n<p>I'll copy the proposed workaround from the issue for reference:</p>\n\n<pre><code>protected override Window CreateShell()\n{\n    return null;\n}\n\nprotected override void OnInitialized()\n{\n    var shellWindow = Container.Resolve&lt;ShellWindow&gt;();\n    shellWindow.Show();\n    MainWindow = shellWindow.ParentOfType&lt;Window&gt;();\n\n    // there lines was not executed because of null Shell - so must duplicate here. Originally called from PrismApplicationBase.Initialize\n    RegionManager.SetRegionManager(MainWindow, Container.Resolve&lt;IRegionManager&gt;());\n    RegionManager.UpdateRegions();\n    InitializeModules();\n\n    base.OnInitialized();\n}\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 6325122, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/479e612da39755c5f4c72ab3ced87806?s=128&d=identicon&r=PG&f=1", "display_name": "Lance", "link": "https://stackoverflow.com/users/6325122/lance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1779, "favorite_count": 0, "accepted_answer_id": 54343953, "answer_count": 1, "score": 2, "last_activity_date": 1548339526, "creation_date": 1548268390, "question_id": 54333568, "link": "https://stackoverflow.com/questions/54333568/prism-7-using-prismapplication-createshell-with-a-non-window-control", "title": "Prism 7. Using PrismApplication.CreateShell() with a non Window control", "body": "<p>I would like to update from 6.3 to 7.</p>\n\n<p>I seem to have hit a road block. </p>\n\n<p>When using the PrismApplication class in the App.xaml, CreateShell expects a return type of Window instead of the previous BootStrapper which wanted a DependencyObject.</p>\n\n<p>My MainShell is a modified  Telerik RadWindow which itself is a modified System.Windows.Controls.HeaderedContentControl and casting to Window is not possible.</p>\n\n<p>Is there a way around this so I can use the PrismApplication object or do I have to roll back and use the BootStrapper like before?</p>\n"}, {"tags": ["c#", "asp.net"], "comments": [{"owner": {"reputation": 18124, "user_id": 812970, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Y5RQs.jpg?s=128&g=1", "display_name": "Sunil", "link": "https://stackoverflow.com/users/812970/sunil"}, "edited": false, "score": 1, "creation_date": 1548268600, "post_id": 54333541, "comment_id": 95484869, "body": "You mean two items with same text show up in DDL?"}, {"owner": {"reputation": 5512, "user_id": 391715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85a8b20e9fc25a6dc0d5371d9da05e32?s=128&d=identicon&r=PG", "display_name": "abney317", "link": "https://stackoverflow.com/users/391715/abney317"}, "edited": false, "score": 1, "creation_date": 1548268871, "post_id": 54333541, "comment_id": 95484987, "body": "Are there 12 items in your dropdown?"}], "answers": [{"tags": [], "owner": {"reputation": 18124, "user_id": 812970, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Y5RQs.jpg?s=128&g=1", "display_name": "Sunil", "link": "https://stackoverflow.com/users/812970/sunil"}, "is_accepted": false, "score": 1, "last_activity_date": 1548269509, "creation_date": 1548269509, "answer_id": 54333856, "question_id": 54333541, "link": "https://stackoverflow.com/questions/54333541/textbox-data-is-reflected-in-ddl-twice/54333856#54333856", "title": "Textbox data is reflected in ddl twice", "body": "<p>Try executing the code in page load event conditionally as given below.</p>\n\n<p>So, on intitial page load i.e. when <code>Page.IsPostBack == false</code> the logic of inserting item at 0 index happens. In your case, every time the page posts back the same item gets added again and therefore you see the 0 item added twice.</p>\n\n<pre><code>protected void Page_Load(object sender, EventArgs e)\n{\n     if(!Page.IsPostBack) {\n         string set = Request.QueryString[\"state\"];\n\n         Bond();\n\n         ddl.Items.Insert(0, new ListItem(set));\n      }\n}\n</code></pre>\n\n<p>Also, as suggested in another answer, call DataBind method only once in your Bond method (i.e. remove the first DataBind but keep the last DataBind in Bond method). There is no need to call it twice.</p>\n"}], "owner": {"reputation": 1, "user_id": 7179046, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aFyCoC_kkKE/AAAAAAAAAAI/AAAAAAAAAJU/aYmk446VcWI/photo.jpg?sz=128", "display_name": "Aman Warwade", "link": "https://stackoverflow.com/users/7179046/aman-warwade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548269509, "creation_date": 1548268278, "last_edit_date": 1548268400, "question_id": 54333541, "link": "https://stackoverflow.com/questions/54333541/textbox-data-is-reflected-in-ddl-twice", "title": "Textbox data is reflected in ddl twice", "body": "<p>I fill one textbox and transfer that data in DDL field.DDL already have data by database value and transfer data showing in the 0 positions of the DDL but zero position repeated in the DDL.</p>\n\n<pre><code> protected void Page_Load(object sender, EventArgs e)\n {\n     string set = Request.QueryString[\"state\"];\n\n\n     Bond();\n\n     ddl.Items.Insert(0, new ListItem(set));\n }\n\n void Bond() {\n        SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings[\"conn\"].ToString());\n        con.Open();\n        SqlCommand cmd = new SqlCommand(\"select top 10  * from Login\",con);\n        SqlDataAdapter da = new SqlDataAdapter(cmd);\n        DataSet ds = new DataSet();\n        da.Fill(ds);\n        ddl.DataSource=ds;\n\n        ddl.DataBind();\n\n        ddl.DataTextField = \"USERNAME\";\n        ddl.DataValueField = \"ID\";\n        ddl.DataBind();\n }\n</code></pre>\n"}, {"tags": ["c#", "sql-server"], "comments": [{"owner": {"reputation": 119, "user_id": 10728149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd5f9f11821f12341699a14c2f829a?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan", "link": "https://stackoverflow.com/users/10728149/johnathan"}, "reply_to_user": {"reputation": 60839, "user_id": 301857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4KmT.jpg?s=128&g=1", "display_name": "Grant Winney", "link": "https://stackoverflow.com/users/301857/grant-winney"}, "edited": false, "score": 0, "creation_date": 1548268648, "post_id": 54333527, "comment_id": 95484887, "body": "I tried mileage_textbox.Text = myReader.GetString(&quot;Miles&quot;); but io still get the same error as before :( .  I have also got rid of the .ToString()"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1548268936, "post_id": 54333527, "comment_id": 95485013, "body": "Additionally, you should never, ever glue data into strings to make SQL.  It is very prone to error, outdated and even dangerous.  Use SQL Parameters always"}, {"owner": {"reputation": 94146, "user_id": 477420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eb05243292dee6726c128660d31583b?s=128&d=identicon&r=PG", "display_name": "Alexei Levenkov", "link": "https://stackoverflow.com/users/477420/alexei-levenkov"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1548269491, "post_id": 54333527, "comment_id": 95485263, "body": "@WelcomeOverflow I think current version of post should get OP this hint already :)"}], "answers": [{"comments": [{"owner": {"reputation": 2203, "user_id": 2747287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50a5172c8eda1b16912793f596ba77bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Schlueter", "link": "https://stackoverflow.com/users/2747287/ryan-schlueter"}, "reply_to_user": {"reputation": 4214, "user_id": 5394572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H9Ql7.png?s=128&g=1", "display_name": "madreflection", "link": "https://stackoverflow.com/users/5394572/madreflection"}, "edited": false, "score": 0, "creation_date": 1548268556, "post_id": 54333583, "comment_id": 95484847, "body": "Good catch I&#39;ll get that changed,"}, {"owner": {"reputation": 119, "user_id": 10728149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd5f9f11821f12341699a14c2f829a?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan", "link": "https://stackoverflow.com/users/10728149/johnathan"}, "edited": false, "score": 0, "creation_date": 1548269419, "post_id": 54333583, "comment_id": 95485226, "body": "I have tried &quot;Convert.ToDecimal(myReader[&quot;Miles&quot;]);&quot;   but it displays        cannot implicitly convert type &#39;decimal&#39; to &#39;string&#39;.   for the 2nd one is there an error where the ])) is at the end.  tried adding a bracket in and a &quot;[&quot; infront of miles but no luck @Ryan.  Appreciate the help :)"}, {"owner": {"reputation": 2203, "user_id": 2747287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50a5172c8eda1b16912793f596ba77bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Schlueter", "link": "https://stackoverflow.com/users/2747287/ryan-schlueter"}, "reply_to_user": {"reputation": 119, "user_id": 10728149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd5f9f11821f12341699a14c2f829a?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan", "link": "https://stackoverflow.com/users/10728149/johnathan"}, "edited": false, "score": 0, "creation_date": 1548269730, "post_id": 54333583, "comment_id": 95485381, "body": "@Johnathan I fixed the bottom one. Just removed the ["}, {"owner": {"reputation": 119, "user_id": 10728149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd5f9f11821f12341699a14c2f829a?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan", "link": "https://stackoverflow.com/users/10728149/johnathan"}, "edited": false, "score": 0, "creation_date": 1548269933, "post_id": 54333583, "comment_id": 95485480, "body": "I stil get the error &quot; cannot implicitly convert type &#39;decimal&#39; to &#39;string&#39;. &quot; :&#39;(   it also says  Exceptions: InvalidCast Exception."}, {"owner": {"reputation": 2203, "user_id": 2747287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50a5172c8eda1b16912793f596ba77bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Schlueter", "link": "https://stackoverflow.com/users/2747287/ryan-schlueter"}, "reply_to_user": {"reputation": 119, "user_id": 10728149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd5f9f11821f12341699a14c2f829a?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan", "link": "https://stackoverflow.com/users/10728149/johnathan"}, "edited": false, "score": 1, "creation_date": 1548270013, "post_id": 54333583, "comment_id": 95485519, "body": "did you add .ToString() to the end?"}, {"owner": {"reputation": 119, "user_id": 10728149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd5f9f11821f12341699a14c2f829a?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan", "link": "https://stackoverflow.com/users/10728149/johnathan"}, "edited": false, "score": 0, "creation_date": 1548270263, "post_id": 54333583, "comment_id": 95485621, "body": "Re-Run the Program and used &quot; myReader.GetDecimal(myReader.GetOrdinal(&quot;Miles&quot;)).ToString()&zwnj;&#8203;; &quot; this has solved my query.  Thank you @Ryan"}], "tags": [], "owner": {"reputation": 2203, "user_id": 2747287, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50a5172c8eda1b16912793f596ba77bd?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Schlueter", "link": "https://stackoverflow.com/users/2747287/ryan-schlueter"}, "is_accepted": true, "score": 3, "last_activity_date": 1548270101, "last_edit_date": 1548270101, "creation_date": 1548268429, "answer_id": 54333583, "question_id": 54333527, "link": "https://stackoverflow.com/questions/54333527/cannot-convert-string-to-int-when-trying-to-get-value-by-column-name/54333583#54333583", "title": "Cannot convert &quot;String&quot; to &quot;int&quot; when trying to get value by column name", "body": "<p>String Miles = myReader.GetDecimal(myReader.GetOrdinal(\"Miles\")).ToString();</p>\n"}], "owner": {"reputation": 119, "user_id": 10728149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bccd5f9f11821f12341699a14c2f829a?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan", "link": "https://stackoverflow.com/users/10728149/johnathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "closed_date": 1548268816, "accepted_answer_id": 54333583, "answer_count": 1, "score": 0, "last_activity_date": 1548270101, "creation_date": 1548268194, "last_edit_date": 1548269439, "question_id": 54333527, "link": "https://stackoverflow.com/questions/54333527/cannot-convert-string-to-int-when-trying-to-get-value-by-column-name", "closed_reason": "Duplicate", "title": "Cannot convert &quot;String&quot; to &quot;int&quot; when trying to get value by column name", "body": "<p>I am trying to populate a text box with miles.  I have a table which stores Routes and Miles where i have a dropdown list populated with these Routes.  When i try to get the miles read into the text box I am getting compile time error \"Cannot convert 'string' to 'int'\" in following code (for both <code>GetInt32</code> and <code>GetDecimal</code>).   </p>\n\n<pre><code>private void location_comboBox_SelectedIndexChanged(object sender, EventArgs e)\n{\n    string conString = \"****ConnectionString*****\";\n    string query = \"SELECT * FROM Location_Table WHERE Route = '\" +\n        location_comboBox.Text + \"';\"; // simplified, actual code uses parametrized query\n    SqlConnection con = new SqlConnection(conString);\n    SqlCommand cmd = new SqlCommand(query, con);\n    con.Open();\n    SqlDataReader myReader = cmd.ExecuteReader();\n\n    while (myReader.Read())\n    {\n         String Miles = myReader.GetInt32(\"Miles\").ToString();\n         mileage_textbox.Text = Miles;\n    }\n}  \n</code></pre>\n\n<p>Line <code>String Miles = myReader.GetInt32(\"Miles\").ToString();</code> gives error</p>\n\n<blockquote>\n  <p>Cannot convert \"string\" to \"int\"</p>\n</blockquote>\n\n<p>which makes sense as <code>SqlDataReader.GetInt32</code> expects some sort of index (\"The zero-based column ordinal.\"), but I'd like to use column names</p>\n\n<p>Column types in DB:</p>\n\n<ul>\n<li>Miles -  Decimal(3,1) </li>\n<li>Route - varchar(50) </li>\n<li>id - nchar(10) (not used in sample)</li>\n</ul>\n"}, {"tags": ["c#", "system.reflection"], "comments": [{"owner": {"reputation": 433, "user_id": 5723554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/skVBK.jpg?s=128&g=1", "display_name": "Andre.Santarosa", "link": "https://stackoverflow.com/users/5723554/andre-santarosa"}, "edited": false, "score": 1, "creation_date": 1548268212, "post_id": 54333484, "comment_id": 95484685, "body": "Please provide us some code, so we can take a look whats going on"}, {"owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "edited": false, "score": 1, "creation_date": 1548268495, "post_id": 54333484, "comment_id": 95484813, "body": "Welcome to StackOverflow. In order for us to help you out, we&#39;ll need to know more about the kind of data you&#39;re dealing with. If the data is in a standard format there&#39;s a good chance you can find a library that&#39;ll do this for you. For JSON, it could be as simple as <code>JsonConvert.DeserializeObject(data, type)</code>. Otherwise you&#39;ll probably need to parse the data in some way and use reflection to set field or property values on the object. Go ahead and edit your answer to add information rather than using comments."}, {"owner": {"reputation": 12429, "user_id": 4995012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a300442854f4caef5cd41a7b3084a6e?s=128&d=identicon&r=PG", "display_name": "Fabjan", "link": "https://stackoverflow.com/users/4995012/fabjan"}, "edited": false, "score": 0, "creation_date": 1548268663, "post_id": 54333484, "comment_id": 95484896, "body": "Check this question: <a href=\"https://stackoverflow.com/questions/39620828/factory-to-create-different-objects-of-same-interface/39620931#39620931\" title=\"factory to create different objects of same interface\">stackoverflow.com/questions/39620828/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 10957425, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5WX5y8SftDI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOyz-CYw6fZAzvLsoON8EYhUbrhaA/mo/photo.jpg?sz=128", "display_name": "CRS", "link": "https://stackoverflow.com/users/10957425/crs"}, "edited": false, "score": 0, "creation_date": 1548269028, "post_id": 54333484, "comment_id": 95485051, "body": "I have edited the question with code......"}, {"owner": {"reputation": 25, "user_id": 10957425, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5WX5y8SftDI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOyz-CYw6fZAzvLsoON8EYhUbrhaA/mo/photo.jpg?sz=128", "display_name": "CRS", "link": "https://stackoverflow.com/users/10957425/crs"}, "reply_to_user": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "edited": false, "score": 0, "creation_date": 1548269788, "post_id": 54333484, "comment_id": 95485417, "body": "@StriplingWarrior It&#39;s standard format, not JSON. Can I ask you for the library that you are referring to , pls ?"}, {"owner": {"reputation": 25, "user_id": 10957425, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5WX5y8SftDI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOyz-CYw6fZAzvLsoON8EYhUbrhaA/mo/photo.jpg?sz=128", "display_name": "CRS", "link": "https://stackoverflow.com/users/10957425/crs"}, "reply_to_user": {"reputation": 12429, "user_id": 4995012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a300442854f4caef5cd41a7b3084a6e?s=128&d=identicon&r=PG", "display_name": "Fabjan", "link": "https://stackoverflow.com/users/4995012/fabjan"}, "edited": false, "score": 1, "creation_date": 1548269822, "post_id": 54333484, "comment_id": 95485433, "body": "@Fabjan I am trying this...will get back to you with results"}, {"owner": {"reputation": 25, "user_id": 10957425, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5WX5y8SftDI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOyz-CYw6fZAzvLsoON8EYhUbrhaA/mo/photo.jpg?sz=128", "display_name": "CRS", "link": "https://stackoverflow.com/users/10957425/crs"}, "reply_to_user": {"reputation": 12429, "user_id": 4995012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a300442854f4caef5cd41a7b3084a6e?s=128&d=identicon&r=PG", "display_name": "Fabjan", "link": "https://stackoverflow.com/users/4995012/fabjan"}, "edited": false, "score": 0, "creation_date": 1548301652, "post_id": 54333484, "comment_id": 95494757, "body": "Thank you @Fabjan I am not sure how I can mark your comment as answer"}, {"owner": {"reputation": 12429, "user_id": 4995012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a300442854f4caef5cd41a7b3084a6e?s=128&d=identicon&r=PG", "display_name": "Fabjan", "link": "https://stackoverflow.com/users/4995012/fabjan"}, "edited": false, "score": 0, "creation_date": 1548318420, "post_id": 54333484, "comment_id": 95500325, "body": "@CRS Well, you can&#39;t but I&#39;m glad that it is working for you..."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10957425, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5WX5y8SftDI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOyz-CYw6fZAzvLsoON8EYhUbrhaA/mo/photo.jpg?sz=128", "display_name": "CRS", "link": "https://stackoverflow.com/users/10957425/crs"}, "edited": false, "score": 0, "creation_date": 1548270832, "post_id": 54334091, "comment_id": 95485854, "body": "\u2022Deserialization - use existing libraries to deserialize from XML, JSON, etc   &gt;&gt;&gt;&gt; I am not getting the data in XML, JSON format, but I am curious to know what are the libraries you are referring to ...?"}], "tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": false, "score": 0, "last_activity_date": 1548270505, "creation_date": 1548270505, "answer_id": 54334091, "question_id": 54333484, "link": "https://stackoverflow.com/questions/54333484/return-an-object-dynamically-from-a-method-that-accepts-only-type-of-class/54334091#54334091", "title": "Return an object dynamically from a method that accepts only type of class", "body": "<blockquote>\n  <p>I am struck at a point where I have to populate the fields with the data object that I have.</p>\n</blockquote>\n\n<p>That's because the compiler has no idea what type is being returned, so it can't bind to the properties of the <em>runtime</em> type. </p>\n\n<p>Depending on how you're getting the data for the runtime object, you have some options:</p>\n\n<ul>\n<li>Reflection - find properties with the names you want to set using reflectrion</li>\n<li><code>dynamic</code> - use <code>dynamic</code> to defer all prpoerty binding until runtime (basically the same as above but letting the compiler generate the necessary reflection code)</li>\n<li>Deserialization - use existing libraries to deserialize from XML, JSON, etc.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 134355, "user_id": 120955, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3653360c9b96b1ae5e39067c9e18183c?s=128&d=identicon&r=PG", "display_name": "StriplingWarrior", "link": "https://stackoverflow.com/users/120955/striplingwarrior"}, "is_accepted": true, "score": 0, "last_activity_date": 1548276589, "creation_date": 1548276589, "answer_id": 54335411, "question_id": 54333484, "link": "https://stackoverflow.com/questions/54333484/return-an-object-dynamically-from-a-method-that-accepts-only-type-of-class/54335411#54335411", "title": "Return an object dynamically from a method that accepts only type of class", "body": "<p>This looks like a good use case for <a href=\"https://github.com/AutoMapper/AutoMapper\" rel=\"nofollow noreferrer\">AutoMapper</a>.</p>\n\n<p>Start by initializing mappings between your classes. </p>\n\n<pre><code>Mapper.Initialize(cfg =&gt; {\n    cfg.CreateMap&lt;DataInput, Class1&gt;();\n    cfg.CreateMap&lt;DataInput, Class2&gt;();\n    // etc.\n});\n</code></pre>\n\n<p>Note: You may need to create some custom mappings <a href=\"https://automapper.readthedocs.io/en/latest/Projection.html\" rel=\"nofollow noreferrer\">like projections</a>, because it looks like the types of your fields don't always match up.</p>\n\n<p>Then you can leverage the Mapper.Map methods:</p>\n\n<pre><code>public object Convert(DataInput ratCommon, Type type1) =&gt; Mapper.Map(foo, typeof(DataInput), type1);\n</code></pre>\n\n<p>Or, if <code>type1</code> is known at compile-time, you can get type safety via generics:</p>\n\n<pre><code>public T Convert&lt;T&gt;(DataInput ratCommon) =&gt; Mapper.Map&lt;T&gt;(foo);\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10957425, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5WX5y8SftDI/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOyz-CYw6fZAzvLsoON8EYhUbrhaA/mo/photo.jpg?sz=128", "display_name": "CRS", "link": "https://stackoverflow.com/users/10957425/crs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 54335411, "answer_count": 2, "score": 2, "last_activity_date": 1548301516, "creation_date": 1548268014, "last_edit_date": 1548301516, "question_id": 54333484, "link": "https://stackoverflow.com/questions/54333484/return-an-object-dynamically-from-a-method-that-accepts-only-type-of-class", "title": "Return an object dynamically from a method that accepts only type of class", "body": "<p>I am working on .NET framework 3.5 \nI have a requirement to create a method in C#, which can accept one of the 5 types of classes and generate object dynamically using the class type that I pass to the method. So basically there are 2 inputs to this method. One is type of class, and another is the data object that I need to fill the object with. \nOnce the method is invoked, it should automatically create an object of the type of class that I sent , and fill the fields with the data object that I sent.\nI tried using System.reflection's createinstance, and got an object with desired class, however, I am struck at a point where I have to populate the fields with the data object that I have. Any help is much appreciated.</p>\n\n<pre><code>Edit : `public class DataInput\n{\n    public string field1 { get; set; }\n    public string field2 { get; set; }\n    public string field3 { get; set; }\n    public string field4 { get; set; }\n    public DateTime field5 { get; set; }\n    public DateTime field6 { get; set; }\n\n\n}\nMy 5 classes look like this :\n\npublic class Class1\n{\n    public string field1;\n    public string field2;\n    public string field3;\n    public string field4;\n    public DateTime field5;\n}\n\npublic class Class2\n{\n    public string field1;\n    public string field2;\n    public string field3;\n\n}\n\npublic class Class3\n{\n    public int field1;\n    public string field2;\n    public string field3;\n\n}\n\npublic class Class4\n{\n    public int field1;\n    public string field2;\n    public string field3;\n    public DateTime field4;\n\n\n}\npublic class Class5\n{\n    public int field1;\n    public DateTime field2;\n    public string field3;\n\n}\n\npublic void Convert(DataInput ratCommon, Type type1)\n{\n    var type = Type.GetType(type1.AssemblyQualifiedName.ToString());\n    if (type != null)\n    {\n        Object obj = Activator.CreateInstance(type);  //This  creates an instance with type I passed, but I am struck here\n\n    }\n}\nI combined @Fabjan answer and @striplingwarrior answer and got the result. I can't thank you enough....\n</code></pre>\n"}, {"tags": ["c#", ".net", "version"], "comments": [{"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 1, "creation_date": 1548268212, "post_id": 54333477, "comment_id": 95484684, "body": "Incomplete and unclear. When do you want to change it?  Provide steps and example values."}, {"owner": {"reputation": 1, "user_id": 10957414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef3f8b6e49da368d767333c8719587?s=128&d=identicon&r=PG&f=1", "display_name": "mikep", "link": "https://stackoverflow.com/users/10957414/mikep"}, "reply_to_user": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1548270899, "post_id": 54333477, "comment_id": 95485881, "body": "Sorry, I&#39;m new to this.  I did research this and found nothing that explained how can I read the version number in Deployment Project Properties with a c# program?"}, {"owner": {"reputation": 619, "user_id": 2623538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dhR1w.jpg?s=128&g=1", "display_name": "NaDeR Star", "link": "https://stackoverflow.com/users/2623538/nader-star"}, "edited": false, "score": 0, "creation_date": 1548272399, "post_id": 54333477, "comment_id": 95486505, "body": "Check <a href=\"https://stackoverflow.com/questions/3359974/how-to-include-version-number-in-vs-setup-project-output-filename\">This</a>"}, {"owner": {"reputation": 1, "user_id": 10957414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef3f8b6e49da368d767333c8719587?s=128&d=identicon&r=PG&f=1", "display_name": "mikep", "link": "https://stackoverflow.com/users/10957414/mikep"}, "edited": false, "score": 0, "creation_date": 1548336443, "post_id": 54333477, "comment_id": 95510870, "body": "After further reading, I now understand (partially anyway) that the version number in the Assemblyinfo file is the application version, while the version in the Deployment Project properties is the installer version.  The former is accessible as Application.ProductVersion and can easily be displayed in the app.  The latter shows up in add/remove programs, but one has to jump through hoops to use it in a program.  I&#39;ll just keep these two versions the same."}], "owner": {"reputation": 1, "user_id": 10957414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef3f8b6e49da368d767333c8719587?s=128&d=identicon&r=PG&f=1", "display_name": "mikep", "link": "https://stackoverflow.com/users/10957414/mikep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548267992, "creation_date": 1548267992, "question_id": 54333477, "link": "https://stackoverflow.com/questions/54333477/in-net-how-do-i-use-the-version-number-from-the-deployment-project-properties", "title": "In .net, how do I use the Version number from the Deployment Project Properties?", "body": "<p>In .net, how do I access the Version number from the Deployment Project Properties?</p>\n\n<p>I know about the assembly version number but wanted to just change the version number in one place.</p>\n"}, {"tags": ["c#", "rendering", "sfml", "text-rendering", "sfml.net"], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 10494293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/awPf8.png?s=128&g=1", "display_name": "Byte", "link": "https://stackoverflow.com/users/10494293/byte"}, "is_accepted": true, "score": 0, "last_activity_date": 1548402003, "creation_date": 1548402003, "answer_id": 54360900, "question_id": 54333473, "link": "https://stackoverflow.com/questions/54333473/otter-text-rendering-not-works/54360900#54360900", "title": "Otter - text rendering not works", "body": "<p>I have a answer.\nText class not rendering,because its not added to scene.\nTo add it to scene,we need to create an entity,and add Text component to it.</p>\n\n<pre><code>Game g = new Game();\ng.Color = Color.Black;\nScene scn = new Scene();\nText t = new Text(\"Text\",\"Font\",16);\nEntity ent = new Entity();\nent.AddGraphics(t);\nscn.Add(ent);\ng.Start(scn);\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10494293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/awPf8.png?s=128&g=1", "display_name": "Byte", "link": "https://stackoverflow.com/users/10494293/byte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 54360900, "answer_count": 1, "score": 0, "last_activity_date": 1548402003, "creation_date": 1548267985, "question_id": 54333473, "link": "https://stackoverflow.com/questions/54333473/otter-text-rendering-not-works", "title": "Otter - text rendering not works", "body": "<p>I made method,that draws text using Otter(2D Game Rendering Library using SFML.NET).But method not works correct,text not rendered.\nCode:</p>\n\n<pre><code>    public static void DrawText(string Text,string Font,int Size,VXG_Color \n                                                                         clr)\n    {\n        Text t = new Text(Text,Font,Size);\n        t.Color = VXGColor(clr);\n        t.Render(0f,0f);\n        t.Visible = true;\n    }\n</code></pre>\n\n<p>Using method:</p>\n\n<pre><code>static void Main(string[] args)\n {\n   DrawText(\"hello\", @\"C:\\Users\\serge\\Downloads\\DarkDemo\\DarkDemo\\bin\\kongtext.ttf\", 72, Rendering.VXG_Color.Orange);\n }\n</code></pre>\n\n<p>Method is executed,exceptions not throwed,but its not renders,i dont see text.</p>\n"}, {"tags": ["c#", ".net", "linq"], "answers": [{"comments": [{"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 0, "creation_date": 1548284049, "post_id": 54334464, "comment_id": 95491063, "body": "Why do you use <code>new List&lt;string&gt;</code> in one place and <code>ToList</code> in another?"}], "tags": [], "owner": {"reputation": 1, "user_id": 10957731, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1rUYNTCHlqM/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPpC5uFGa9qOepBfEABUjVu7DiTRA/mo/photo.jpg?sz=128", "display_name": "Markus", "link": "https://stackoverflow.com/users/10957731/markus"}, "is_accepted": false, "score": 0, "last_activity_date": 1548272152, "creation_date": 1548272152, "answer_id": 54334464, "question_id": 54333452, "link": "https://stackoverflow.com/questions/54333452/linq-query-for-particular-situation-2/54334464#54334464", "title": "LINQ Query for particular situation 2", "body": "<p>Try this </p>\n\n<pre><code>Class.Select(c =&gt; new ClassStudentDto \n{ \n  ClassName = c.Name, \n  StudentNames = new List&lt;string&gt;(Student.Where(s =&gt; StudentClass.Where(cs =&gt; cs.ClassId == c.Id).Select(cs =&gt; cs.StudentId).Contains(s.Id)).Select(s =&gt; s.Name)) \n}).ToList();\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4361, "user_id": 223942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe27c9ee97a08da1ca52243c160390bc?s=128&d=identicon&r=PG", "display_name": "Kilanash", "link": "https://stackoverflow.com/users/223942/kilanash"}, "is_accepted": true, "score": 0, "last_activity_date": 1548281118, "creation_date": 1548281118, "answer_id": 54336407, "question_id": 54333452, "link": "https://stackoverflow.com/questions/54333452/linq-query-for-particular-situation-2/54336407#54336407", "title": "LINQ Query for particular situation 2", "body": "<p>Here's the linq version as left joins using groupjoin:</p>\n\n<pre><code>from c in classes\njoin ljsc in studentClasses \n     on c.id equals ljsc.classId \n     into leftjoinStudentClasses\nfrom sc in leftjoinStudentClasses.DefaultIfEmpty(new StudentClass())\njoin ljs in students \n     on sc.studentId equals ljs.id \n     into leftjoinStudents\nfrom s in leftjoinStudents.DefaultIfEmpty(new Student())\ngroup new { s,c } by c.name into grp\nselect new \n{\n    @class = grp.Key, students = from ss in grp select ss?.s?.name\n}\n</code></pre>\n\n<p><a href=\"https://dotnetfiddle.net/b6C9dP\" rel=\"nofollow noreferrer\">Link to dotnetfiddle version</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "is_accepted": false, "score": 0, "last_activity_date": 1548284380, "creation_date": 1548284380, "answer_id": 54336997, "question_id": 54333452, "link": "https://stackoverflow.com/questions/54333452/linq-query-for-particular-situation-2/54336997#54336997", "title": "LINQ Query for particular situation 2", "body": "<p>If you must have <code>null</code>, you can use:</p>\n\n<pre><code>var data = from c in context.GetClass\n           join sc in context.GetStudentClasses on c.Id equals sc.ClassId into scj\n           select new StudentClassDTO {\n               ClassName = c.Name,\n               StudentNames = scj.Any() ? (from sc in scj\n                                           join s in context.GetStudents on sc.StudentId equals s.Id\n                                           select s.Name).ToList()\n                                        : null\n           };\n</code></pre>\n\n<p>But you can eliminate the test if you are okay with an empty list:</p>\n\n<pre><code>var data = from c in context.GetClass\n           join sc in context.GetStudentClasses on c.Id equals sc.ClassId into scj\n           select new StudentClassDTO {\n               ClassName = c.Name,\n               StudentNames = (from sc in scj\n                               join s in context.GetStudents on sc.StudentId equals s.Id\n                               select s.Name).ToList()\n           };\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4671373"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 54336407, "answer_count": 3, "score": -1, "last_activity_date": 1548284380, "creation_date": 1548267836, "question_id": 54333452, "link": "https://stackoverflow.com/questions/54333452/linq-query-for-particular-situation-2", "title": "LINQ Query for particular situation 2", "body": "<p>Lets say that I have following tables:</p>\n\n<pre><code> Student(id(pk), name)\n Class(id(pk), name)\n StudentClass(id(pk), studentId(fk), classId(fk))\n</code></pre>\n\n<p>Imagine as follows:</p>\n\n<p><code>Student</code> table contains:</p>\n\n<pre><code> (1,\"John\"), (2, \"Mike\"), (3,\"Josh\")\n</code></pre>\n\n<p><code>Class</code> table contains:</p>\n\n<pre><code>(1,\"Geography\"), (2, \"Math\"), (3, \"History\"), (4,\"Biology)\"\n</code></pre>\n\n<p><code>StudentClass</code> table contains:</p>\n\n<pre><code>(`1, 1, 1),(2,2,2),(3,3,2)\n</code></pre>\n\n<p>Lets now assume that I have a <code>StudentClassDTO</code> class which contains  </p>\n\n<pre><code>List&lt;string&gt; StudentNames\nstring ClassName\n</code></pre>\n\n<p>How can I by using using LINQ query get data into <code>StudentClassDTO</code>? Any help appreciated.</p>\n\n<p>So the final data will be </p>\n\n<ol>\n<li>{John, Geography} </li>\n<li>{[Mike,Josh] Math} </li>\n<li>{NULL, History}</li>\n<li>{Null, Biology}</li>\n</ol>\n\n<p>I tried left outer joins but I could not find the way to do it.</p>\n"}, {"tags": ["c#", "wpf", "observablecollection"], "comments": [{"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 1, "creation_date": 1548268009, "post_id": 54333445, "comment_id": 95484579, "body": "I don&#39;t know what your design is but in this case I&#39;d avoid to have a <b>copy</b> of your data, as you can see it&#39;s hard to keep them in sync. What I&#39;d use is a <b>view</b> of the observable collection (which might be smart enough to fire the appropriate events or a dumb view which always fires <code>Reset</code>)."}, {"owner": {"reputation": 855, "user_id": 7310000, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c301a2d4abfbb21574b3fad45794b37a?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfried.V", "link": "https://stackoverflow.com/users/7310000/siegfried-v"}, "reply_to_user": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1548270839, "post_id": 54333445, "comment_id": 95485855, "body": "@AdrianoRepetti yes in fact I think I am doing something wrong (I am new with MVVM concept). Could you please explain me how I can define these filtered views? Because in that case it is pretty simple, but sometimes I have a view that is a filter of a collectionview, and conditions are on selected elements of a second view. I will now edit my post to put some more concrete code(and I am aware I am doing something wrong)."}, {"owner": {"reputation": 8584, "user_id": 426185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64e54f32c14d0f11e4e91009703322?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/426185/andy"}, "edited": false, "score": 1, "creation_date": 1548273831, "post_id": 54333445, "comment_id": 95487110, "body": "You can have multiple views based on one collection and filters can be as complicated as you like so long as they return a bool for any given record.  <a href=\"https://social.technet.microsoft.com/wiki/contents/articles/26673.wpf-collectionview-tips.aspx\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/wiki/contents/articles/&hellip;</a>"}, {"owner": {"reputation": 2496, "user_id": 3512524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d86f158f96941fef8bb311262cf3ad0e?s=128&d=identicon&r=PG&f=1", "display_name": "Krzysztof Skowronek", "link": "https://stackoverflow.com/users/3512524/krzysztof-skowronek"}, "edited": false, "score": 0, "creation_date": 1548274311, "post_id": 54333445, "comment_id": 95487287, "body": "Take a look at <a href=\"https://dynamic-data.org/\" rel=\"nofollow noreferrer\">DynamicData</a>, it is far more powerfull than Views of observable collections"}, {"owner": {"reputation": 13840, "user_id": 1177147, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/zHhAS.jpg?s=128&g=1", "display_name": "Mark Feldman", "link": "https://stackoverflow.com/users/1177147/mark-feldman"}, "edited": false, "score": 0, "creation_date": 1548277293, "post_id": 54333445, "comment_id": 95488452, "body": "Very similar question asked and answered <a href=\"https://stackoverflow.com/questions/1256793/mvvm-sync-collections\">here</a>. That case involves synching two different types of collections, your scenario is more simple."}, {"owner": {"reputation": 855, "user_id": 7310000, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c301a2d4abfbb21574b3fad45794b37a?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfried.V", "link": "https://stackoverflow.com/users/7310000/siegfried-v"}, "edited": false, "score": 0, "creation_date": 1548299811, "post_id": 54333445, "comment_id": 95494459, "body": "Ok thanks all for your answers, I definitely will look further in documentations, until now I didn&#39;t use them(cause I didn&#39;t manage to use them), but I see this will be very helpful."}, {"owner": {"reputation": 855, "user_id": 7310000, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c301a2d4abfbb21574b3fad45794b37a?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfried.V", "link": "https://stackoverflow.com/users/7310000/siegfried-v"}, "reply_to_user": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1548397330, "post_id": 54333445, "comment_id": 95534248, "body": "@AdrianoRepetti thanks, I made a tutorial (www.blackwasp.co.uk) and finally understood all about &#39;ICollectionView&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 855, "user_id": 7310000, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c301a2d4abfbb21574b3fad45794b37a?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfried.V", "link": "https://stackoverflow.com/users/7310000/siegfried-v"}, "edited": false, "score": 0, "creation_date": 1548397422, "post_id": 54339192, "comment_id": 95534286, "body": "in fact I made the tutorial on ICollectionView (www.blackwasp.co.uk), and that helped solving my problem, need to update all of my project with these views, very useful. Thanks"}], "tags": [], "owner": {"reputation": 1300, "user_id": 9250153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f3d55650526a7e58bb9739dda4a0cff?s=128&d=identicon&r=PG&f=1", "display_name": "Alex.Wei", "link": "https://stackoverflow.com/users/9250153/alex-wei"}, "is_accepted": true, "score": 1, "last_activity_date": 1559109716, "last_edit_date": 1559109716, "creation_date": 1548302551, "answer_id": 54339192, "question_id": 54333445, "link": "https://stackoverflow.com/questions/54333445/update-an-observablecollection-that-is-the-result-of-another-observablecollectio/54339192#54339192", "title": "Update an ObservableCollection that is the result of another ObservableCollection", "body": "<p>Since you didn't give us the detial of the data struct, I just assume that <code>PhaseInContract</code> is included in <code>MainList</code>. So, just simply create two views for your <code>MainList</code>, then binding them to UI. All views will synchronize with source automatically.</p>\n\n<pre><code>Public ICollectionView MainListView;\nPublic ICollectionView PhaseInContractView;\nPublic ObservableCollection&lt;YourDataClass&gt; MainList;\n\npublic YourViewModel()\n{\n    MainList = new ObservableCollection&lt;YourDataClass&gt;();\n\n    // Load datas form db and fill MainList\n\n    MainListView = new CollectionViewSource() { Source = MainList }.View;\n    MainListView.Filter = (x) =&gt;\n    {\n        // your MainListView filtering logic.\n    };\n\n    PhaseInContractView = new CollectionViewSource() { Source = MainList }.View;\n    PhaseInContractView.Filter = (x) =&gt;\n    {\n        // your PhaseInContractView filtering logic\n    };\n\nprivate Affaire selectedAffaire;\npublic Affaire SelectedAffaire\n{\n    get { return selectedAffaire; }\n    set\n    {\n        selectedAffaire = value;\n        this.NotifyPropertyChanged(\"SelectedAffaire\");\n        if (value != null)\n        {\n           PhaseInContractView.Refresh();\n        }\n        MainListView.Refresh();\n    }\n}\n\n// And other properties.\n...\n</code></pre>\n"}], "owner": {"reputation": 855, "user_id": 7310000, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c301a2d4abfbb21574b3fad45794b37a?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfried.V", "link": "https://stackoverflow.com/users/7310000/siegfried-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 54339192, "answer_count": 1, "score": 0, "last_activity_date": 1559109716, "creation_date": 1548267807, "last_edit_date": 1548272093, "question_id": 54333445, "link": "https://stackoverflow.com/questions/54333445/update-an-observablecollection-that-is-the-result-of-another-observablecollectio", "title": "Update an ObservableCollection that is the result of another ObservableCollection", "body": "<p>Excuse me but I didn't know how to formulate the question :</p>\n\n<p>I have two ObservableCollection</p>\n\n<p>ObservableCollection MyMainList\nis the ObservableCollection where are stored all of my objects.</p>\n\n<pre><code>ObservableCollection&lt;T&gt; MyFilteredList = new ObservableCollection(MyMainList.Where(x=&gt;Condition))\n</code></pre>\n\n<p>is the ObservableCollection filtered according some parameters.</p>\n\n<p>At one moment, I need to add or remove objects from MyMainList, but then MyFilteredList is not updated automatically.</p>\n\n<p>I need always to do :</p>\n\n<pre><code>MyMainList.Add(newObject);\nMyFilteredList.Add(newObject);\n</code></pre>\n\n<p>Is there a way to do all of that in just one line, so when I modify MyMainList, MyFilteredList will be automatically updated?</p>\n\n<p>Edit : To answer to Adriano Repetti, when I open my window, I load all of objects (so I don't need to reload my DB everytime I change filters).\nI have three different filters :\n - 1 combobox \"Affaire\" (list of the contracts)\n - 1 combobox \"Phase\" (list of the subcontracts)\n - 1 TextBox \"Filter\" ( if I want to see only objects whose name contains that text).</p>\n\n<p>When I change selection of 1st ComboBox, I update the list of subcontracts, and update the filtered list of assemblies.</p>\n\n<pre><code>private Affaire selectedAffaire;\npublic Affaire SelectedAffaire\n{\n   get { return selectedAffaire; }\n   set\n   {\n      selectedAffaire = value;\n      this.NotifyPropertyChanged(\"SelectedAffaire\");\n      if (value != null)\n      {\n         GetListPhaseInContract(); //I update the list of subcontracts in 2nd Combobox\n      }\n      UpdateListAssemblages(); // I update MyFilteredList\n   }\n}\n</code></pre>\n\n<p>When I change selection of 2nd ComboBox (subcontract), I update the list of MyFilteredList</p>\n\n<pre><code>private Phase selectedPhase;\npublic Phase SelectedPhase\n{\n   get { return selectedPhase; }\n   set\n   {\n       selectedPhase = value;\n       this.NotifyPropertyChanged(\"SelectedPhase\");\n       UpdateListAssemblages();\n   }\n}\n</code></pre>\n\n<p>Then when I change my TextBox value, I also update the list</p>\n\n<pre><code>private string texteFiltre;\npublic string TexteFiltre\n{\n   get { return texteFiltre; }\n   set\n   {\n      texteFiltre = value;\n      this.NotifyPropertyChanged(\"TexteFiltre\");\n      UpdateListAssemblages();\n   }\n}\n</code></pre>\n\n<p>If I understood, this <a href=\"https://stackoverflow.com/questions/9615891/filter-an-observable-collection\">post</a> is what I need to look for? I don't know yet what are ICollectionView, but I guess I need to look in that way?Will I gain some execution time using ICollectionView? as I see I need anyway to Refresh it?       </p>\n"}, {"tags": ["c#", "wpf", "xaml"], "comments": [{"owner": {"reputation": 183, "user_id": 6053847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8017c81650954d6eaf0e526f5365a6c5?s=128&d=identicon&r=PG&f=1", "display_name": "FranklinLee", "link": "https://stackoverflow.com/users/6053847/franklinlee"}, "edited": false, "score": 0, "creation_date": 1548312174, "post_id": 54333334, "comment_id": 95497514, "body": "why you need to imply this demand?  You can double-click on the text in DataGridTextColumn ,and modify the text."}, {"owner": {"reputation": 167, "user_id": 10885503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2020299e225ab04579cc6b8870ad4969?s=128&d=identicon&r=PG&f=1", "display_name": "gbcga97", "link": "https://stackoverflow.com/users/10885503/gbcga97"}, "reply_to_user": {"reputation": 183, "user_id": 6053847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8017c81650954d6eaf0e526f5365a6c5?s=128&d=identicon&r=PG&f=1", "display_name": "FranklinLee", "link": "https://stackoverflow.com/users/6053847/franklinlee"}, "edited": false, "score": 0, "creation_date": 1548325969, "post_id": 54333334, "comment_id": 95504579, "body": "because the user asked for it being easier to enter the information"}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 9830756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kamil D", "link": "https://stackoverflow.com/users/9830756/kamil-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1548268423, "creation_date": 1548268423, "answer_id": 54333579, "question_id": 54333334, "link": "https://stackoverflow.com/questions/54333334/how-to-enable-a-datagrid-column-text-in-c-wpf/54333579#54333579", "title": "How to enable a datagrid column text in C#/ wpf", "body": "<p>Put <code>UpdateSourceTrigger=PropertyChanged</code> into DataGrid binding instead of DataGridTextColumn</p>\n"}, {"tags": [], "owner": {"reputation": 183, "user_id": 6053847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8017c81650954d6eaf0e526f5365a6c5?s=128&d=identicon&r=PG&f=1", "display_name": "FranklinLee", "link": "https://stackoverflow.com/users/6053847/franklinlee"}, "is_accepted": true, "score": 0, "last_activity_date": 1548397290, "creation_date": 1548397290, "answer_id": 54359937, "question_id": 54333334, "link": "https://stackoverflow.com/questions/54333334/how-to-enable-a-datagrid-column-text-in-c-wpf/54359937#54359937", "title": "How to enable a datagrid column text in C#/ wpf", "body": "<p>I found a solution to meet the require,but it needs object bound to Datagrid has a boolean property.Here's the xaml:</p>\n\n<pre><code>&lt;DataGridTemplateColumn Width=\"120\"&gt;\n                    &lt;DataGridTemplateColumn.CellTemplate&gt;\n                        &lt;DataTemplate&gt;\n                            &lt;TextBox\n                                Name=\"innerTextBox\"\n                                BorderThickness=\"0\"\n                                IsReadOnly=\"{Binding DisableEdit, UpdateSourceTrigger=PropertyChanged}\"\n                                Text=\"{Binding Name}\" /&gt;\n                        &lt;/DataTemplate&gt;\n                    &lt;/DataGridTemplateColumn.CellTemplate&gt;\n                &lt;/DataGridTemplateColumn&gt;\n</code></pre>\n\n<p>and here is the object:\n public class Person:BindableBase\n    {\n        private string name;</p>\n\n<pre><code>    public string Name\n    {\n        get { return name; }\n        set { name = value; }\n    }\n\n    private bool disableEdit;\n\n    public bool DisableEdit\n    {\n        get { return disableEdit; }\n        set { SetProperty(ref disableEdit, value); }\n    }\n\n}\n</code></pre>\n\n<p>And here is button_click event:</p>\n\n<pre><code>        var person = datagrid.SelectedCells[0].Item as Person;\n\n        person.DisableEdit = false;\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 10885503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2020299e225ab04579cc6b8870ad4969?s=128&d=identicon&r=PG&f=1", "display_name": "gbcga97", "link": "https://stackoverflow.com/users/10885503/gbcga97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 54359937, "answer_count": 2, "score": 0, "last_activity_date": 1548397290, "creation_date": 1548267392, "question_id": 54333334, "link": "https://stackoverflow.com/questions/54333334/how-to-enable-a-datagrid-column-text-in-c-wpf", "title": "How to enable a datagrid column text in C#/ wpf", "body": "<p>I have an app in which as soon as I click the \"Insert\" I want the program to enable the text in data grid and the user can enter the information of the product. Can someone help me with how can I do this? </p>\n\n<p>below the app code and picture</p>\n\n<p><a href=\"https://i.stack.imgur.com/vvUyf.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<pre><code>&lt;Window&gt;\n    &lt;Grid&gt;\n        &lt;Grid.ColumnDefinitions&gt;\n            &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;\n            &lt;ColumnDefinition&gt;&lt;/ColumnDefinition&gt;\n        &lt;/Grid.ColumnDefinitions&gt;\n        &lt;Grid.RowDefinitions&gt;\n            &lt;RowDefinition Height=\"Auto\"&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition Height=\"Auto\"&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition Height=\"Auto\"&gt;&lt;/RowDefinition&gt;\n            &lt;RowDefinition Height=\"Auto\"&gt;&lt;/RowDefinition&gt;\n        &lt;/Grid.RowDefinitions&gt;\n        &lt;TextBlock Grid.Row=\"0\" Grid.Column=\"0\" FontWeight=\"Bold\" HorizontalAlignment=\"Center\"&gt;Produtos&lt;/TextBlock&gt;\n        &lt;TextBlock Grid.Row=\"0\" Grid.Column=\"1\" FontWeight=\"Bold\" HorizontalAlignment=\"Center\"&gt;Unidades&lt;/TextBlock&gt;\n        &lt;TextBlock Grid.Row=\"0\" Grid.Column=\"2\" FontWeight=\"Bold\" HorizontalAlignment=\"Center\"&gt;Empresas&lt;/TextBlock&gt;\n        &lt;TextBlock Grid.Row=\"0\" Grid.Column=\"3\" FontWeight=\"Bold\" HorizontalAlignment=\"Center\"&gt;Operadores&lt;/TextBlock&gt;\n        &lt;DataGrid Grid.Row=\"1\" Grid.Column=\"0\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\" Margin=\"5\" ItemsSource=\"{Binding ListaProdutos}\" AutoGenerateColumns=\"False\" SelectedItem=\"{Binding ProdutoSelecionado}\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Header=\"Descri\u00e7\u00e3o\" Binding=\"{Binding Descricao, UpdateSourceTrigger=PropertyChanged}\" Width=\"*\"&gt;&lt;/DataGridTextColumn&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n        &lt;DataGrid Grid.Row=\"1\" Grid.Column=\"1\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\" Margin=\"5\" ItemsSource=\"{Binding ListaUnidades}\" AutoGenerateColumns=\"False\" SelectedItem=\"{Binding UnidadeSelecionada}\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Header=\"Descri\u00e7\u00e3o\" Binding=\"{Binding Descricao, UpdateSourceTrigger=PropertyChanged}\" Width=\"*\"&gt;&lt;/DataGridTextColumn&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n        &lt;DataGrid Grid.Row=\"1\" Grid.Column=\"2\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\" Margin=\"5\" ItemsSource=\"{Binding ListaEmpresas}\" AutoGenerateColumns=\"False\" SelectedItem=\"{Binding EmpresaSelecionada}\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Header=\"Descri\u00e7\u00e3o\" Binding=\"{Binding Descricao, UpdateSourceTrigger=PropertyChanged}\" Width=\"*\"&gt;&lt;/DataGridTextColumn&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n        &lt;DataGrid Grid.Row=\"1\" Grid.Column=\"3\" CanUserAddRows=\"False\" CanUserDeleteRows=\"False\" Margin=\"5\" ItemsSource=\"{Binding ListaOperadores}\" AutoGenerateColumns=\"False\" SelectedItem=\"{Binding OperadorSelecionado}\"&gt;\n            &lt;DataGrid.Columns&gt;\n                &lt;DataGridTextColumn Header=\"Nome\" Binding=\"{Binding Nome, UpdateSourceTrigger=PropertyChanged}\" Width=\"*\"&gt;&lt;/DataGridTextColumn&gt;\n            &lt;/DataGrid.Columns&gt;\n        &lt;/DataGrid&gt;\n        &lt;StackPanel Grid.Row=\"2\" Grid.Column=\"0\" Orientation=\"Horizontal\" HorizontalAlignment=\"Center\"&gt;\n            &lt;Button Command=\"{Binding InserirProdutoCommand}\" Width=\"50\" Height=\"25\"&gt;Inserir&lt;/Button&gt;\n            &lt;Button Command=\"{Binding ExcluirProdutoCommand}\" Width=\"50\" Height=\"25\"&gt;Excluir&lt;/Button&gt;\n        &lt;/StackPanel&gt;\n        &lt;StackPanel Grid.Row=\"2\" Grid.Column=\"1\" Orientation=\"Horizontal\" HorizontalAlignment=\"Center\"&gt;\n            &lt;Button Command=\"{Binding InserirUnidadeCommand}\" Width=\"50\" Height=\"25\"&gt;Inserir&lt;/Button&gt;\n            &lt;Button Command=\"{Binding ExcluirUnidadeCommand}\" Width=\"50\" Height=\"25\"&gt;Excluir&lt;/Button&gt;\n        &lt;/StackPanel&gt;\n        &lt;StackPanel Grid.Row=\"2\" Grid.Column=\"2\" Orientation=\"Horizontal\" HorizontalAlignment=\"Center\"&gt;\n            &lt;Button Command=\"{Binding InserirEmpresaCommand}\" Width=\"50\" Height=\"25\"&gt;Inserir&lt;/Button&gt;\n            &lt;Button Command=\"{Binding ExcluirEmpresaCommand}\" Width=\"50\" Height=\"25\"&gt;Excluir&lt;/Button&gt;\n        &lt;/StackPanel&gt;\n        &lt;StackPanel Grid.Row=\"2\" Grid.Column=\"3\" Orientation=\"Horizontal\" HorizontalAlignment=\"Center\"&gt;\n            &lt;Button Command=\"{Binding InserirOperadorCommand}\" Width=\"50\" Height=\"25\" HorizontalAlignment=\"Center\"&gt;Inserir&lt;/Button&gt;\n            &lt;Button Command=\"{Binding ExcluirOperadorCommand}\" Width=\"50\" Height=\"25\" HorizontalAlignment=\"Center\"&gt;Excluir&lt;/Button&gt;\n        &lt;/StackPanel&gt;\n        &lt;Border Grid.Row=\"3\" Grid.Column=\"0\" Grid.ColumnSpan=\"4\" BorderThickness=\"0 1 0 0\" BorderBrush=\"Gray\" Margin=\"10,10,5,0\" Padding=\"5 5 5 0\" VerticalAlignment=\"Top\" Height=\"46\"&gt;\n            &lt;StackPanel Orientation=\"Horizontal\" HorizontalAlignment=\"Right\"&gt;\n                &lt;Button Command=\"{Binding SalvarCommand}\" Width=\"80\" Height=\"30\"&gt;Salvar&lt;/Button&gt;\n                &lt;Button Command=\"{Binding CancelarCommand}\" Width=\"80\" Height=\"30\"&gt;Cancelar&lt;/Button&gt;\n            &lt;/StackPanel&gt;\n        &lt;/Border&gt;\n    &lt;/Grid&gt;\n&lt;/Window&gt;\n</code></pre>\n"}, {"tags": ["c#", "httpwebrequest"], "comments": [{"owner": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548275170, "post_id": 54333285, "comment_id": 95487620, "body": "<code>but not?</code> What <b>did</b> occur?"}, {"owner": {"reputation": 1730, "user_id": 2491685, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JA551.jpg?s=128&g=1", "display_name": "Minh Nguyen", "link": "https://stackoverflow.com/users/2491685/minh-nguyen"}, "reply_to_user": {"reputation": 21694, "user_id": 34092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e78a68c6e32f9b8aeb47a968ebea9f?s=128&d=identicon&r=PG&f=1", "display_name": "mjwills", "link": "https://stackoverflow.com/users/34092/mjwills"}, "edited": false, "score": 0, "creation_date": 1548769109, "post_id": 54333285, "comment_id": 95654445, "body": "@mjwills: it returns 200 status code with response uri is <a href=\"http://www.google.com\" rel=\"nofollow noreferrer\">google.com</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19955, "user_id": 101087, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/646f0fa3075659904242cf6f576ed2e9?s=128&d=identicon&r=PG", "display_name": "NineBerry", "link": "https://stackoverflow.com/users/101087/nineberry"}, "is_accepted": true, "score": 2, "last_activity_date": 1548269596, "creation_date": 1548269596, "answer_id": 54333872, "question_id": 54333285, "link": "https://stackoverflow.com/questions/54333285/how-to-get-redirect-url-of-http-www-google-com-site/54333872#54333872", "title": "How to get redirect url of http://www.google.com site", "body": "<p>Google does not initiate a redirect in this case because it cannot be sure that the client supports https. It seems that google checks the UserAgent header of the request and only initiates a redirection when it can be sure the user agent supports https.</p>\n\n<pre><code>string urlRequest = \"http://www.google.com\";\n\nHttpWebRequest request = HttpWebRequest.CreateHttp(urlRequest);\n\nrequest.UserAgent = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0\";\nrequest.AllowAutoRedirect = false;\n\nHttpWebResponse response = request.GetResponse() as HttpWebResponse;\n\nMessageBox.Show(response.StatusCode.ToString());\nMessageBox.Show(response.Headers[\"Location\"]);\n</code></pre>\n\n<p>Other request headers will also influence how Google behaves.</p>\n"}], "owner": {"reputation": 1730, "user_id": 2491685, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JA551.jpg?s=128&g=1", "display_name": "Minh Nguyen", "link": "https://stackoverflow.com/users/2491685/minh-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 54333872, "answer_count": 1, "score": 0, "last_activity_date": 1548269596, "creation_date": 1548267237, "question_id": 54333285, "link": "https://stackoverflow.com/questions/54333285/how-to-get-redirect-url-of-http-www-google-com-site", "title": "How to get redirect url of http://www.google.com site", "body": "<p>I have tried this simple code to get redirect code 307 but failed.</p>\n\n<pre><code>string urlRequest = \"http://www.google.com\";\nrequest = HttpWebRequest.Create(urlRequest) as HttpWebRequest;\nrequest.AllowAutoRedirect = false;\nvar response = request.GetResponse();\n</code></pre>\n\n<p>Expect response status code is 307 and AbsoluteUri = \"<a href=\"https://www.google.com\" rel=\"nofollow noreferrer\">https://www.google.com</a>\" but not?</p>\n"}, {"tags": ["c#", "wpf", "xceed"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 0, "creation_date": 1548266966, "post_id": 54333198, "comment_id": 95484080, "body": "Probably because it&#39;s looking for actual properties rather than fields. What does your struct look like?"}, {"owner": {"reputation": 324, "user_id": 469632, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5313507fb885a804905cc7006808314d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/469632/peter"}, "edited": false, "score": 0, "creation_date": 1548280135, "post_id": 54333198, "comment_id": 95489675, "body": "That makes sense. This should be a fairly simple change to implement by Xceed? I&#39;m just asking before I suggest they implement."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1228"}, "edited": false, "score": 0, "creation_date": 1548344300, "post_id": 54333198, "comment_id": 95515850, "body": "It&#39;s not really them, you see Bindings in WPF work against properties, full stop. They will never work against fields. XCeed most likely reflect over your object looking for properties and generate UI and Bindings dynamically. Even if they reflected over fields as well the Bindings (framework code) still won&#39;t work."}], "owner": {"reputation": 324, "user_id": 469632, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5313507fb885a804905cc7006808314d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/469632/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1548280237, "creation_date": 1548266898, "last_edit_date": 1548280237, "question_id": 54333198, "link": "https://stackoverflow.com/questions/54333198/can-xceed-propertygrid-accept-structs", "title": "Can XCEED PropertyGrid accept structs?", "body": "<p>I can use Xceeds <code>PropertyGrid</code> control to correctly display all the relevant information for a <code>class</code> by binding the class object to <code>SelectedObject</code>. </p>\n\n<p>However, this is not showing anything (no properties) when bind <code>SelectedObject</code> to a <code>struct</code>. The PropertyGrid binding is working as I see the name of the struct (ABFFileHeader) at the top (see image). Any ideas what is going on?</p>\n\n<p><a href=\"https://i.stack.imgur.com/QPcvl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QPcvl.png\" alt=\"enter image description here\"></a></p>\n\n<p>The struct looks like this:</p>\n\n<pre><code> [StructLayout(LayoutKind.Sequential, Pack = 1, CharSet = CharSet.Ansi)]\n        public struct ABFFileHeader\n        {\n            // GROUP #1 - File ID and size information\n            public float fFileVersionNumber;\n            public short nOperationMode;            //y\n            /// &lt;summary&gt;\n            /// The total number of samples (not Duration)\n            /// &lt;/summary&gt;\n            public int lActualAcqLength;\n            public short nNumPointsIgnored;\n            public int lActualEpisodes;\n            public uint uFileStartDate;         // YYYYMMDD         //y\n            public uint uFileStartTimeMS;           //y\n            public int lStopwatchTime;\n            public float fHeaderVersionNumber;\n            public short nFileType;         //y\n\n            // GROUP #2 - File Structure\n            public int lDataSectionPtr;\n            public int lTagSectionPtr;\n            public int lNumTagEntries;\n            public int lScopeConfigPtr;\n            public int lNumScopes;\n            public int lDeltaArrayPtr;\n            public int lNumDeltas;\n            public int lVoiceTagPtr;\n            public int lVoiceTagEntries;\n            public int lSynchArrayPtr;\n            public int lSynchArraySize;\n            public short nDataFormat;\n            public short nSimultaneousScan;\n            public int lStatisticsConfigPtr;\n            public int lAnnotationSectionPtr;\n            public int lNumAnnotations;\n            [MarshalAs(UnmanagedType.ByValArray, ArraySubType = UnmanagedType.I4, SizeConst = Constants.ABF_DACCOUNT)]\n            public int[] lDACFilePtr;\n            [MarshalAs(UnmanagedType.ByValArray, ArraySubType = UnmanagedType.I4, SizeConst = Constants.ABF_DACCOUNT)]\n            public int[] lDACFileNumEpisodes;\n\n            // GROUP #3 - Trial hierarchy information\n            public short nADCNumChannels;\n            public float fADCSequenceInterval;\n            public uint uFileCompressionRatio;\n            public sbyte bEnableFileCompression;                        //   bool %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n            public float fSynchTimeUnit;\n</code></pre>\n"}, {"tags": ["c#", "exception", "control-flow", "try-catch-finally"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 3, "creation_date": 1548266898, "post_id": 54333163, "comment_id": 95484052, "body": "The  <code>catch {}</code> block is unnecessary."}, {"owner": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 4, "creation_date": 1548267450, "post_id": 54333163, "comment_id": 95484310, "body": "In general, try/catch/throw should be used for &quot;exceptional&quot; circumstances, and not just for program flow control.  The alternative in your case would be to have <code>validateTrainingSets</code> return an enumerated type with four choices (Succeeded, TrainingSetCardinalityMismatch, etc).  Does that make your code cleaner or not - well, it depends.  One thing to realize is that throwing an exception is expensive (writing try/catch/finally is cheap, but the actual throw takes a long time).  That may figure into your decision.  In any case, this is &quot;opinion-based&quot; and likely to get closed"}, {"owner": {"reputation": 235601, "user_id": 60761, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bf43bae0431d8f4a062234b5e3a0cb9?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Holterman", "link": "https://stackoverflow.com/users/60761/henk-holterman"}, "edited": false, "score": 0, "creation_date": 1548267961, "post_id": 54333163, "comment_id": 95484561, "body": "Readability is King. Other readers will assume an exception is about an error condition. Go for the code that causes the least confusion."}, {"owner": {"reputation": 11603, "user_id": 1007019, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/HjT3D.png?s=128&g=1", "display_name": "UnhandledExcepSean", "link": "https://stackoverflow.com/users/1007019/unhandledexcepsean"}, "edited": false, "score": 1, "creation_date": 1548269573, "post_id": 54333163, "comment_id": 95485298, "body": "Probably a better question for either Code Review or Software Engineering SE sites."}, {"owner": {"reputation": 313, "user_id": 7411381, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210630720899426/picture?type=large", "display_name": "Tara", "link": "https://stackoverflow.com/users/7411381/tara"}, "edited": false, "score": 1, "creation_date": 1548279105, "post_id": 54333163, "comment_id": 95489235, "body": "@Flydog57I reworded this question to avoid being opinion based, and to fit some of the suggestions already provided. I&#39;ve read alot about weather or not exceptions should only be used in &quot;exceptional&quot; cases, &amp; there are people on both sides. The explanation that makes the most sense to me is that if an assumption of a fucntion, for example, is incorrect, rather than return an arbitrary value to indicate that, it&#39;s better to throw an exception so others aware of the issue."}, {"owner": {"reputation": 313, "user_id": 7411381, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210630720899426/picture?type=large", "display_name": "Tara", "link": "https://stackoverflow.com/users/7411381/tara"}, "reply_to_user": {"reputation": 4431, "user_id": 4739488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q8m1k.png?s=128&g=1", "display_name": "Flydog57", "link": "https://stackoverflow.com/users/4739488/flydog57"}, "edited": false, "score": 0, "creation_date": 1548279159, "post_id": 54333163, "comment_id": 95489262, "body": "@Flydog57 AlThough, I love the idea of an enum, just need to find a way to also pass along other variables for the exception (like the paramName, mesage, actual value, among other custom fields I created for the exception) , maybe a struct would be more appropriate?"}, {"owner": {"reputation": 5045, "user_id": 329496, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/92ab9af5b2597efeee9eab0f0d782409?s=128&d=identicon&r=PG", "display_name": "simbo1905", "link": "https://stackoverflow.com/users/329496/simbo1905"}, "edited": false, "score": 1, "creation_date": 1548288003, "post_id": 54333163, "comment_id": 95492084, "body": "Definitely codereview.stackexchange.com which is a sister site to stackoverflow is a better place to ask such things as people\u2019s mind set there is less about \u201cright\u201d and \u201cwrong\u201c and more about \u201cmake better\u201d. I asked a question there today and was very happy for the improvements in the answer."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 7411381, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210630720899426/picture?type=large", "display_name": "Tara", "link": "https://stackoverflow.com/users/7411381/tara"}, "edited": false, "score": 0, "creation_date": 1548279378, "post_id": 54333741, "comment_id": 95489362, "body": "I love the idea, except I would also need a way to pass other parameters such as the paramName, message, actualValue, etc., among the custom fields that I created for thos particular exceptions, maybe have it return a struct that includes those fields along with a field for the enum?"}, {"owner": {"reputation": 8212, "user_id": 10116, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a47f1d509ad6ef38f226017c4b285289?s=128&d=identicon&r=PG", "display_name": "Larry OBrien", "link": "https://stackoverflow.com/users/10116/larry-obrien"}, "reply_to_user": {"reputation": 313, "user_id": 7411381, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210630720899426/picture?type=large", "display_name": "Tara", "link": "https://stackoverflow.com/users/7411381/tara"}, "edited": false, "score": 1, "creation_date": 1548279844, "post_id": 54333741, "comment_id": 95489552, "body": "I&#39;ve edited the answer to include the possibility of returning an interface or abstract class. I actually <i>prefer</i> this idea : creating expressive <i>types</i> is a very good practice. There&#39;s an even more sophisticated route called the <code>Either</code> monad, which would allow you to automatically split the valid and invalid sets, but it&#39;s kind of a rabbithole."}, {"owner": {"reputation": 313, "user_id": 7411381, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210630720899426/picture?type=large", "display_name": "Tara", "link": "https://stackoverflow.com/users/7411381/tara"}, "edited": false, "score": 0, "creation_date": 1548279944, "post_id": 54333741, "comment_id": 95489599, "body": "OH, I see you addressed that with your abstract class, I think this is actually perfect, thanks!"}], "tags": [], "owner": {"reputation": 8212, "user_id": 10116, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a47f1d509ad6ef38f226017c4b285289?s=128&d=identicon&r=PG", "display_name": "Larry OBrien", "link": "https://stackoverflow.com/users/10116/larry-obrien"}, "is_accepted": true, "score": 2, "last_activity_date": 1548287350, "last_edit_date": 1548287350, "creation_date": 1548269060, "answer_id": 54333741, "question_id": 54333163, "link": "https://stackoverflow.com/questions/54333163/how-could-i-rework-this-code-so-as-not-to-appear-as-if-i-am-using-exceptions-as/54333741#54333741", "title": "How could I rework this code so as not to appear as if I am using exceptions as a form of flow-control?", "body": "<p>Yes, I think most reviewers would find this confusing and ask for changes. If I understand the problem correctly, you might use an <code>enum</code> such as : </p>\n\n<pre><code>enum Validity { Valid, TrainingSetCardinalityMismatch, InputSetCardinalityMismatch, OutputAnswerCardinalityMismatch } \n\nclass TrainingSet { \n    Validity Validate(TrainingAnswer[] trainingAnswers) { // ... etc ... } \n}\n</code></pre>\n\n<p>And then divvy things up however you find most intuitive, such as : </p>\n\n<pre><code>var validTrainingSets = \n    from trainingSet in fldTrainingSets \n    where trainingSet.Validate(fldTrainingSets) == Validity.Valid\n    select trainingSet;\n</code></pre>\n\n<p>Or :</p>\n\n<pre><code>var validTrainingSets = \n    fldTrainingSelects.Select(t =&gt; t.Validate(fldTrainingAnswers)).Filter(v =&gt; v == Validity.Valid); \n</code></pre>\n\n<p>Or :</p>\n\n<pre><code>Dictionary&lt;Validity, List&lt;TrainingSet&gt;&gt; groupedTrainingSets = \n    from trainingSet in fldTrainingSets   \n    group trainingSet by trainingSet.Validate(fldTrainingAnswers) into validityGroup \n    select new { validityGroup.Key, validityGroup.ToList() } \n</code></pre>\n\n<p>If an <code>enum</code> isn't sufficient, then try an interface or an abstract class : </p>\n\n<pre><code>interface IValidity {}\n\nclass Valid : IValidity { // ... etc ... } \nclass TrainingSetCardinalityMismatch : IValidity { public int ExpectedCardinality; // etc...  } \n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 7411381, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210630720899426/picture?type=large", "display_name": "Tara", "link": "https://stackoverflow.com/users/7411381/tara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1548269613, "accepted_answer_id": 54333741, "answer_count": 1, "score": 0, "last_activity_date": 1578692935, "creation_date": 1548266710, "last_edit_date": 1578692935, "question_id": 54333163, "link": "https://stackoverflow.com/questions/54333163/how-could-i-rework-this-code-so-as-not-to-appear-as-if-i-am-using-exceptions-as", "closed_reason": "Opinion-based", "title": "How could I rework this code so as not to appear as if I am using exceptions as a form of flow-control?", "body": "<p>I've heard it said that exceptions and try-catch blocks should not be used to flow-control, so I would like a way to rework this code to avoid that appearance.</p>\n\n<p>I have a method validateTrainingSets, within a neuralNetwork class that does exactly what it's name suggests - validates the prvided training sets (to ensure, among other things, that the number of inputs in the training sets match the number of inputs into the neural network, and that the number of outputs per answer matches the number of final outputs of the neural network).</p>\n\n<p>Because there are many different ways in which the validation can fail, I've devided to leave the throwing of exception up to the validation method itself, and there are three different custom exceptions that can be thrown from the function.</p>\n\n<p>In a method that allows users of the class to manually update the number of neurons per layer, the final bit of code validates and/or updates the training sets (depending on whether or not new training sets were provided), and my question is, how would I improve it? </p>\n\n<p>In the code below, the \"true\" parameter in the validator tells the validator to set the training sets to null if it fails. (It is intended that if the user did not provide new training sets, but the existing training sets are consistent with the new arrangement to keep them, but to discard them if not). </p>\n\n<p>The fldValidate field is a flag that's set to false earlier in the code and I need to ensure that it's set back to true ragardless of any errors.</p>\n\n<pre><code>try { validateTrainingSets(fldTrainingSets, fldTrainingAnswers, true); }\ncatch(TrainingSetCardinalityMismatch) { }\ncatch(InputSetCardinlityMismatch) { }\ncatch(OutputAnswerCardinalityMismatch) { }\ncatch {\n    fldValidate = true;\n    throw;\n}\nfinally { fldValidate = true; }\n</code></pre>\n"}, {"tags": ["c#", "xml", "list"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1548266855, "post_id": 54333149, "comment_id": 95484030, "body": "You cannot have an array at the root level of xml (it is considered Note Well Formed).  Simply serializing the digital-sales class will automatically create the same structure that you deserialized."}, {"owner": {"reputation": 101, "user_id": 10805820, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h9Y7n.png?s=128&g=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/10805820/coder"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1548267022, "post_id": 54333149, "comment_id": 95484105, "body": "Can you share an example please . Am not familiar with the syntax"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "is_accepted": true, "score": 1, "last_activity_date": 1548323318, "last_edit_date": 1548323318, "creation_date": 1548267740, "answer_id": 54333428, "question_id": 54333149, "link": "https://stackoverflow.com/questions/54333149/write-listobject-to-xml-file-with-elements-and-attribute/54333428#54333428", "title": "Write List&lt;object&gt; to XML file with elements and attribute", "body": "<p>Here is the code :</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Xml;\nusing System.Xml.Serialization;\n\n\nnamespace ConsoleApplication98\n{\n    class Program\n    {\n        const string FILENAME = @\"c:\\temp\\test.xml\";\n        static void Main(string[] args)\n        {\n            XmlReader reader = XmlReader.Create(FILENAME);\n            XmlSerializer serializer = new XmlSerializer(typeof(DigitalSales));\n            DigitalSales digitalSales = (DigitalSales)serializer.Deserialize(reader);\n\n            reader.Close();\n\n            XmlWriter writer = XmlWriter.Create(FILENAME);\n            serializer.Serialize(writer, digitalSales);\n\n        }\n    }\n\n\n    [XmlRoot(\"digital-sales\")]\n    public class DigitalSales\n    {\n        [XmlElement(\"supervisor\")]\n        public List&lt;Supervisor&gt; supervisor { get; set; }\n\n    }\n    [XmlRoot(\"supervisor\")]\n    public class Supervisor\n    {\n        [XmlAttribute(\"id\")]\n        public string Id { set; get; }\n\n        [XmlElement(\"Name\")]\n        public string Name { set; get; }\n\n        [XmlElement(\"Contract\")]\n        public int Contracts { set; get; }\n\n        [XmlElement(\"Volume\")]\n        public long Volume { set; get; }\n\n        [XmlElement(\"Average\")]\n        public int Average { set; get; }\n    }\n\n\n}\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10805820, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h9Y7n.png?s=128&g=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/10805820/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 54333428, "answer_count": 1, "score": 0, "last_activity_date": 1548323425, "creation_date": 1548266626, "last_edit_date": 1548323425, "question_id": 54333149, "link": "https://stackoverflow.com/questions/54333149/write-listobject-to-xml-file-with-elements-and-attribute", "title": "Write List&lt;object&gt; to XML file with elements and attribute", "body": "<p>I have the following class:</p>\n\n<pre><code>[XmlType(\"supervisor\")]\npublic class Supervisor\n{\n   [XmlAttribute(\"id\")]\n    public string Id { set; get; }\n\n    [XmlElement(\"Name\")]\n    public string Name { set; get; }\n\n    [XmlElement(\"Contract\")]\n    public int Contracts { set; get; }\n\n    [XmlElement(\"Volume\")]\n    public long Volume { set; get; }\n\n    [XmlElement(\"Average\")]\n    public int Average { set; get; }\n}\n</code></pre>\n\n<p>which reads from XML file:</p>\n\n<pre><code> &lt;digital-sales xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n    &lt;supervisor id=\"1236674\"&gt;\n        &lt;Name&gt;Hiroki&lt;/Name&gt;\n        &lt;Contract&gt;11&lt;/Contract&gt;\n        &lt;Volume&gt;1036253&lt;/Volume&gt;\n        &lt;Average&gt;94205&lt;/Average&gt;\n    &lt;/supervisor&gt;\n    &lt;supervisor id=\"123459\"&gt;\n        &lt;Name&gt;Ayumi&lt;/Name&gt;\n        &lt;Contract&gt;5&lt;/Contract&gt;\n        &lt;Volume&gt;626038&lt;/Volume&gt;\n        &lt;Average&gt;125208&lt;/Average&gt;\n    &lt;/supervisor&gt; ...\n &lt;/digital-sales&gt;\n</code></pre>\n\n<p>in the code I create List  and process it.\nnow I want to write the List to XML file while maintaining the\nsame XML structure. How do I do that? </p>\n\n<p><a href=\"https://stackoverflow.com/questions/54090867/how-to-use-xml-id-to-fill-class-object\">How to use xml id to fill class object?</a> </p>\n"}, {"tags": ["c#", "database", "wpf", "project"], "comments": [{"owner": {"reputation": 8584, "user_id": 426185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64e54f32c14d0f11e4e91009703322?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/426185/andy"}, "edited": false, "score": 1, "creation_date": 1548274044, "post_id": 54333113, "comment_id": 95487194, "body": "The wide scope of your question means it&#39;s inherently unsuited to stack overflow. I guess that&#39;s why you have a down vote. Good luck."}, {"owner": {"reputation": 103, "user_id": 10703017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IvBPJxvwgmY/AAAAAAAAAAI/AAAAAAAAAF0/QLYEkVTgld4/photo.jpg?sz=128", "display_name": "Ryk", "link": "https://stackoverflow.com/users/10703017/ryk"}, "reply_to_user": {"reputation": 8584, "user_id": 426185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64e54f32c14d0f11e4e91009703322?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/426185/andy"}, "edited": false, "score": 0, "creation_date": 1548281755, "post_id": 54333113, "comment_id": 95490298, "body": "@Andy Perhaps yes. I was naive hoping for a straightforward answer."}, {"owner": {"reputation": 8584, "user_id": 426185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64e54f32c14d0f11e4e91009703322?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/426185/andy"}, "edited": false, "score": 0, "creation_date": 1548323467, "post_id": 54333113, "comment_id": 95503088, "body": "SO is intended to give indisputable answers to specific questions. Threads which don&#39;t have a specific answer are closed due to their &quot;opinion based&quot; nature. Your luck is still holding though :^)"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 10703017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IvBPJxvwgmY/AAAAAAAAAAI/AAAAAAAAAF0/QLYEkVTgld4/photo.jpg?sz=128", "display_name": "Ryk", "link": "https://stackoverflow.com/users/10703017/ryk"}, "edited": false, "score": 0, "creation_date": 1548325402, "post_id": 54338214, "comment_id": 95504256, "body": "I have seen that book recommended many times, i.e Pro C# 7. I will definitely take a look into it. Thanks!"}], "tags": [], "owner": {"reputation": 1809, "user_id": 1383366, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/3a4d9b9bba5c161be88d53ac75c6b7b5?s=128&d=identicon&r=PG", "display_name": "redcurry", "link": "https://stackoverflow.com/users/1383366/redcurry"}, "is_accepted": false, "score": 1, "last_activity_date": 1548293963, "creation_date": 1548293963, "answer_id": 54338214, "question_id": 54333113, "link": "https://stackoverflow.com/questions/54333113/prerequisites-for-creating-a-project-in-wpf-with-c/54338214#54338214", "title": "Prerequisites for creating a project in WPF with C#", "body": "<p>I really enjoyed the book <a href=\"https://rads.stackoverflow.com/amzn/click/com/1484230175\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Pro C# 7</a>. I think it's very well written and comprehensive. It even covers WPF at a reasonable level. There are also chapters on dealing with SQL databases.</p>\n\n<p>Once you're familiar with C# and some WPF basics, you can read <a href=\"https://rads.stackoverflow.com/amzn/click/com/184968622X\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Windows Presentation Foundation 4.5 Cookbook</a>. I found that their specific examples and explanations helped me understand how WPF works.</p>\n\n<p>Then it's about getting your hands dirty by trying things out. You'll find a lot of resources online as you search for problems you run into. There are tons of blog posts explaining specific WPF solutions, and of course there's StackOverflow.</p>\n\n<p>Good luck.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 10703017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IvBPJxvwgmY/AAAAAAAAAAI/AAAAAAAAAF0/QLYEkVTgld4/photo.jpg?sz=128", "display_name": "Ryk", "link": "https://stackoverflow.com/users/10703017/ryk"}, "edited": false, "score": 0, "creation_date": 1548325421, "post_id": 54343616, "comment_id": 95504267, "body": "This answer is indeed helpful. Thank you for changing your mind!"}, {"owner": {"reputation": 8584, "user_id": 426185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64e54f32c14d0f11e4e91009703322?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/426185/andy"}, "reply_to_user": {"reputation": 103, "user_id": 10703017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IvBPJxvwgmY/AAAAAAAAAAI/AAAAAAAAAF0/QLYEkVTgld4/photo.jpg?sz=128", "display_name": "Ryk", "link": "https://stackoverflow.com/users/10703017/ryk"}, "edited": false, "score": 0, "creation_date": 1548337199, "post_id": 54343616, "comment_id": 95511350, "body": "I think you misunderstand. It wasn&#39;t me downvoting and i didn&#39;t post an answer yesterday because i was on my tablet."}, {"owner": {"reputation": 103, "user_id": 10703017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IvBPJxvwgmY/AAAAAAAAAAI/AAAAAAAAAF0/QLYEkVTgld4/photo.jpg?sz=128", "display_name": "Ryk", "link": "https://stackoverflow.com/users/10703017/ryk"}, "edited": false, "score": 0, "creation_date": 1548337550, "post_id": 54343616, "comment_id": 95511570, "body": "That is not the case, I said that because I was grateful for a straightforward answer rather than a comment. :)"}], "tags": [], "owner": {"reputation": 8584, "user_id": 426185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed64e54f32c14d0f11e4e91009703322?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/426185/andy"}, "is_accepted": true, "score": 1, "last_activity_date": 1548323166, "creation_date": 1548323166, "answer_id": 54343616, "question_id": 54333113, "link": "https://stackoverflow.com/questions/54333113/prerequisites-for-creating-a-project-in-wpf-with-c/54343616#54343616", "title": "Prerequisites for creating a project in WPF with C#", "body": "<p>With WPF you should use MVVM. Unfortunately, there are no good books that will teach you that though.\nI have a bunch of articles and samples on TechNet wiki and Gallery. A number of these originated from coaching and teaching newbies.</p>\n\n<p><a href=\"https://social.technet.microsoft.com/wiki/contents/articles/30959.user-page-andy-oneill.aspx\" rel=\"nofollow noreferrer\">https://social.technet.microsoft.com/wiki/contents/articles/30959.user-page-andy-oneill.aspx</a></p>\n\n<p>Some of what's in there ought to help.</p>\n\n<p>Use viewmodel first for navigation.\nDon't use pages, use usercontrols and bind content to a property returns a viewmodel.\nTemplate using datatype=vmtype into usercontrols in the ui.</p>\n\n<p>I think redcurry's recommendation of pro c#7 is good. I like Jon Skeet's c# in depth.\nFor database theory.\nBear in mind it has changed very little in 20 years. Hence rather old books are still good and you can pick up copies really cheap nowadays. For example <a href=\"https://www.amazon.co.uk/dp/0201752840?slotNum=0&amp;linkCode=g12&amp;imprToken=uS5pZKPLsrVEOJop6zd4iA&amp;creativeASIN=0201752840&amp;tag=javarevisit01-21\" rel=\"nofollow noreferrer\">https://www.amazon.co.uk/dp/0201752840?slotNum=0&amp;linkCode=g12&amp;imprToken=uS5pZKPLsrVEOJop6zd4iA&amp;creativeASIN=0201752840&amp;tag=javarevisit01-21</a>  well worth a fiver.\nMy big tips on indexing:\nBy default - add an auto integer as primary key rather than using any natural key you think will \"always\" be unique. They inevitably change.</p>\n\n<p>Don't add too many indexes.</p>\n\n<p>The old advice is still true. Normalise 'til it hurts and then denormalise 'til it works.</p>\n\n<p>SQL server is good, easy to find online advice and sql express is free. Jobs are very useful but the \"full\" version of sql server is expensive. If you will have large quantities of sql server and low/no budget then MySQL.</p>\n\n<p>There are free resources for sql server on the web. For example <a href=\"http://www.sqlservercentral.com/\" rel=\"nofollow noreferrer\">http://www.sqlservercentral.com/</a></p>\n\n<p>I've never read a book on LINQ. I learnt it as I went by looking up stuff on the web. I rely heavily on intellisense when writing anything isn't fairly simple. My big tip on LINQ is not to use it for complex queries and as complexity increases in one you're writing you should look at the generated sql. Complicated linq is prone to generating terribly inefficient sql.</p>\n"}], "owner": {"reputation": 103, "user_id": 10703017, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IvBPJxvwgmY/AAAAAAAAAAI/AAAAAAAAAF0/QLYEkVTgld4/photo.jpg?sz=128", "display_name": "Ryk", "link": "https://stackoverflow.com/users/10703017/ryk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 54343616, "answer_count": 2, "score": -1, "last_activity_date": 1548323166, "creation_date": 1548266466, "question_id": 54333113, "link": "https://stackoverflow.com/questions/54333113/prerequisites-for-creating-a-project-in-wpf-with-c", "title": "Prerequisites for creating a project in WPF with C#", "body": "<p>I have been thinking a lot lately about making a fully functional project with a small team using C# WPF UI. The goal is to create a construction management software. It is not about \"reinventing the wheel\", the idea behind this is to gain experience in software programming.</p>\n\n<p>Some of the general knowledge that we possess:</p>\n\n<ul>\n<li><p>We have been introduced in OOP at the University.</p></li>\n<li><p>We have programmed in Visual Studio before, but only standard C#.</p></li>\n<li><p>We watched this playlist of <em><a href=\"https://www.youtube.com/watch?v=Vjldip84CXQ&amp;list=PLrW43fNmjaQVYF4zgsD0oL9Iv6u23PI6M\" rel=\"nofollow noreferrer\">Tutorials on WPF</a></em></p></li>\n<li><p>We have also been looking at some tamplates on Telerik, but our understanding in WPF is too shallow right now to comprehend them.</p></li>\n</ul>\n\n<p>Some of the things we would love to understand:</p>\n\n<ul>\n<li><p>What SQL Server would be appropriate for this kind of software, we used Microsoft SQL Server so far. </p></li>\n<li><p>Any recommendation of books that might help us enhance our skill in building a database <em>such as: reading from it, creating appropriate relation-ships, etc</em> would be greatly appreciated.</p></li>\n<li><p>Any recommendation of books for C#, LINQ or anything you know and might help us.</p></li>\n</ul>\n\n<p>We want to treat this project seriously and we know that we will struggle with this documentation step for quite a while. Please let us know if there is any other step or fundamental thing that we missed, thank you!</p>\n"}, {"tags": ["c#", "asp.net-core-2.1"], "comments": [{"owner": {"reputation": 4238, "user_id": 1327570, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/seAG9.jpg?s=128&g=1", "display_name": "ttugates", "link": "https://stackoverflow.com/users/1327570/ttugates"}, "edited": false, "score": 1, "creation_date": 1548267275, "post_id": 54333108, "comment_id": 95484216, "body": "<code>SqlCommands</code> are an option to cut your round trips in half.  Could create a DataContext method along lines of <code>AddReadingIfNotExists(Reading reading)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1214, "user_id": 7848128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0655d9171caf70dd24a37a53a2c5e5b5?s=128&d=identicon&r=PG&f=1", "display_name": "JED", "link": "https://stackoverflow.com/users/7848128/jed"}, "edited": false, "score": 1, "creation_date": 1548267574, "post_id": 54333261, "comment_id": 95484383, "body": "<a href=\"http://www.entityframeworktutorial.net/efcore/working-with-stored-procedure-in-ef-core.aspx\" rel=\"nofollow noreferrer\">reference for creating stored procedures</a>"}, {"owner": {"reputation": 1214, "user_id": 7848128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0655d9171caf70dd24a37a53a2c5e5b5?s=128&d=identicon&r=PG&f=1", "display_name": "JED", "link": "https://stackoverflow.com/users/7848128/jed"}, "edited": false, "score": 0, "creation_date": 1548268300, "post_id": 54333261, "comment_id": 95484719, "body": "Thanks, that&#39;s definitely something I&#39;ll have to think about doing. The readings do come in a large list via an API request and are first stored in a <code>List&lt;Reading&gt;</code> so I could check the list on itself, and that would probably do the trick. If I were to compare incoming lists against each other, I would suspect that I&#39;d have to find a way to store the list of incoming readings in a variable that can persist across sessions."}, {"owner": {"reputation": 1, "user_id": 285465, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d989ed3c52dbe11e3ae2f537ce717a6?s=128&d=identicon&r=PG", "display_name": "TomTom", "link": "https://stackoverflow.com/users/285465/tomtom"}, "reply_to_user": {"reputation": 1214, "user_id": 7848128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0655d9171caf70dd24a37a53a2c5e5b5?s=128&d=identicon&r=PG&f=1", "display_name": "JED", "link": "https://stackoverflow.com/users/7848128/jed"}, "edited": false, "score": 1, "creation_date": 1548269630, "post_id": 54333261, "comment_id": 95485326, "body": "Actually if you get LISTS anyway, then upload the lists to a temp or other staging table via SqlBulkCopy (i..e. allow doubles as per your rule) and then use ONE sp to move them to final storage.Suddenly a thread should be able to handle 50k rows in a second (actual number here) and you can use multiple threads / parallel requests. Eliminate doubles in the select.... from the select...into part."}], "tags": [], "owner": {"reputation": 1, "user_id": 285465, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d989ed3c52dbe11e3ae2f537ce717a6?s=128&d=identicon&r=PG", "display_name": "TomTom", "link": "https://stackoverflow.com/users/285465/tomtom"}, "is_accepted": true, "score": 4, "last_activity_date": 1548267159, "creation_date": 1548267159, "answer_id": 54333261, "question_id": 54333108, "link": "https://stackoverflow.com/questions/54333108/net-core-2-1-entity-framework-check-for-duplicates-before-adding-to-db/54333261#54333261", "title": ".NET Core 2.1 - Entity Framework: Check for duplicates before adding to DB", "body": "<p>The fastest way is to insert and have a unique index blow and react to the error message.</p>\n\n<p>Alternative do use a stored procedure.</p>\n\n<p>Anything you do with EF will per definition NOT be fastest choice. And yes, this does not mean abandoning it all - EF is good for 80% to 95% of operations. Just bypass it for this one.</p>\n"}], "owner": {"reputation": 1214, "user_id": 7848128, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0655d9171caf70dd24a37a53a2c5e5b5?s=128&d=identicon&r=PG&f=1", "display_name": "JED", "link": "https://stackoverflow.com/users/7848128/jed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "accepted_answer_id": 54333261, "answer_count": 1, "score": 1, "last_activity_date": 1548267159, "creation_date": 1548266460, "last_edit_date": 1548266881, "question_id": 54333108, "link": "https://stackoverflow.com/questions/54333108/net-core-2-1-entity-framework-check-for-duplicates-before-adding-to-db", "title": ".NET Core 2.1 - Entity Framework: Check for duplicates before adding to DB", "body": "<p>In my SQL Server DB, I have a table of IOT data (nearing 1,000,000 records). When the app receives inbound readings, I want to check that the DB doesn't already have a reading for that device with the same timestamp. What is the fastest way to check for records with matching properties?</p>\n\n<p><strong>Model</strong></p>\n\n<pre><code>public class Reading\n{\n    public int Id { get; set; }\n    public double Measurement { get; set; }\n    public int DeviceId { get; set; }\n    public Device Device { get; set; }\n    public DateTime Timestamp { get; set; }\n}\n</code></pre>\n\n<p><strong>AddReading Method</strong></p>\n\n<pre><code>public class ReadingRepository\n{\n    private readonly DataContext _context;\n\n    public ReadingRepository(DataContext context)\n    {\n        _context = context;\n    }\n\n    public void AddReading(Reading reading)\n    {\n        // my proposed method... is there a better way?\n        if (!_context.Readings.Any(r =&gt;\n            r.DeviceId == reading.DeviceId,\n            r.Timestamp == reading.Timestamp))\n            _context.Readings.Add(reading);\n    }\n}\n</code></pre>\n"}, {"tags": ["c#", ".net", "azure-web-app-service"], "comments": [{"owner": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1548266448, "post_id": 54333062, "comment_id": 95483825, "body": "You are deploying a new version, that has to load, that takes time. No feature can save you from that, just make a dummy request after publishing"}, {"owner": {"reputation": 21, "user_id": 10957210, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m1Jm436O4Ms/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZXmmlZ1cs22uQHVHa9O1lSGNoTxg/mo/photo.jpg?sz=128", "display_name": "bulb2", "link": "https://stackoverflow.com/users/10957210/bulb2"}, "reply_to_user": {"reputation": 26461, "user_id": 2141621, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/525cb8cf58e22b35b9bfc99d52cde986?s=128&d=identicon&r=PG&f=1", "display_name": "Camilo Terevinto", "link": "https://stackoverflow.com/users/2141621/camilo-terevinto"}, "edited": false, "score": 0, "creation_date": 1548266873, "post_id": 54333062, "comment_id": 95484038, "body": "Cannot send a dummy request on production. Web service changes the state of the app."}, {"owner": {"reputation": 16352, "user_id": 932728, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/4PyNZ.jpg?s=128&g=1", "display_name": "Peter Bons", "link": "https://stackoverflow.com/users/932728/peter-bons"}, "edited": false, "score": 0, "creation_date": 1548268798, "post_id": 54333062, "comment_id": 95484956, "body": "You might be able to create an endpoint to do just that, a dummy request. Maybe you already have an health endpoint you can use?"}, {"owner": {"reputation": 21, "user_id": 10957210, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m1Jm436O4Ms/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZXmmlZ1cs22uQHVHa9O1lSGNoTxg/mo/photo.jpg?sz=128", "display_name": "bulb2", "link": "https://stackoverflow.com/users/10957210/bulb2"}, "edited": false, "score": 0, "creation_date": 1548272358, "post_id": 54333062, "comment_id": 95486483, "body": "Hi, I have built a ping service that is mapped to the base url of the app. &quot;Always on&quot; Azure web app&#39;s feature sends a request to that endpoint every 5 minutes however this does not warm up the endpoint that does the actual work. I believe this ping is just for keeping app alive, preventing it from unloading while being idle."}, {"owner": {"reputation": 101, "user_id": 9974048, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4xunL.png?s=128&g=1", "display_name": "Matt Drouillard", "link": "https://stackoverflow.com/users/9974048/matt-drouillard"}, "edited": false, "score": 0, "creation_date": 1577580257, "post_id": 54333062, "comment_id": 105203640, "body": "In production environment use deployment slots, and then swap the slots.  This will help mitigate your issue with the slow loading speeds.  I am having the same issue, with development environments it isn&#39;t as big of an issue though."}, {"owner": {"reputation": 985, "user_id": 1219999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/417f9421066f39de3354c30a2f92e865?s=128&d=identicon&r=PG", "display_name": "Dave Lucre", "link": "https://stackoverflow.com/users/1219999/dave-lucre"}, "edited": false, "score": 0, "creation_date": 1598413118, "post_id": 54333062, "comment_id": 112447626, "body": "The issue is that it&#39;s every single unique page request/api endpoint that is slow on the first request.  Surely there&#39;s a way to pre-compile these things so that people don&#39;t have to wait 15 seconds on each page the first time that page is hit?"}], "answers": [{"tags": [], "owner": {"reputation": 747, "user_id": 2461574, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b66cde11f7aa8685ae1e650cdf186834?s=128&d=identicon&r=PG", "display_name": "Jose Parra", "link": "https://stackoverflow.com/users/2461574/jose-parra"}, "is_accepted": false, "score": 3, "last_activity_date": 1549433549, "creation_date": 1549433549, "answer_id": 54547608, "question_id": 54333062, "link": "https://stackoverflow.com/questions/54333062/slow-first-request-after-publishing-azure-web-app/54547608#54547608", "title": "Slow first request after publishing Azure Web App", "body": "<p>This bit me as well. \"Always On\" will only make automated calls to your service root - think about slapping the process every time so it won't fall sleep.. We don't use this in our PROD services, we rather have an Azure Availability Test invoking a Ping() endpoint every 5 mins - two birdies, one stone. Besides, AlwaysOn will generate 404 errors in App Insights if you don't have anything in the root.. \nA totally different thing is warming up each one of the endpoints so they could get JIT-ed and ready, and I have not found anything better than a warm-up script with the whole list of endpoints to call, it is not perfect but it works. So every time you do a deployment o do a restart this will automatically run and your first calls won't be hurt. \nHave a look at <a href=\"https://blog.baslijten.com/warmup-your-application-on-azure-app-service-when-scaling-up-and-swapping-slots-using-application-initialization/\" rel=\"nofollow noreferrer\">this article</a>.\nI hope this helps</p>\n"}], "owner": {"reputation": 21, "user_id": 10957210, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m1Jm436O4Ms/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZXmmlZ1cs22uQHVHa9O1lSGNoTxg/mo/photo.jpg?sz=128", "display_name": "bulb2", "link": "https://stackoverflow.com/users/10957210/bulb2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549433549, "creation_date": 1548266274, "question_id": 54333062, "link": "https://stackoverflow.com/questions/54333062/slow-first-request-after-publishing-azure-web-app", "title": "Slow first request after publishing Azure Web App", "body": "<p>I have performance issue with ASP.NET Web API app hosted as Azure Web App. After deploying the first request to web service is really slow (we are talking about seconds here). Subsequent requests work just fine without extra delay. </p>\n\n<p>\"Always on\" feature works fine keeping the app from unloading but this does not solve my issue. I do not want this first request to warm up the service (BTW - should it be warmed up?).</p>\n\n<p>I've used diagnostic and profiling tools in Azure without finding the root cause of this thing. I've used Application Insights as well. It seems like one function of mine needs much more time to execute during this first request - debugging the app locally I did not notice any performance issue with mentioned function.</p>\n\n<p>How can I fix this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c#", "regex"], "comments": [{"owner": {"reputation": 5830, "user_id": 3776927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46cb2cca9626c6d445bd05297be86251?s=128&d=identicon&r=PG&f=1", "display_name": "derpirscher", "link": "https://stackoverflow.com/users/3776927/derpirscher"}, "edited": false, "score": 1, "creation_date": 1548265448, "post_id": 54332706, "comment_id": 95483358, "body": "If I understand you correctly, you want to parse the correct date out of a string like <code>foo bar 29-JAN-19 blah blubb</code> or <code>foo bar 28-01-19 13:15:00 blah blubb</code>?"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 1, "creation_date": 1548265706, "post_id": 54332706, "comment_id": 95483481, "body": "You can OR (use pipe) expressions so you can have different options."}, {"owner": {"reputation": 2626, "user_id": 5667167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0578d15bb8fe82332bb123aa29e8b24e?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/5667167/brandon"}, "reply_to_user": {"reputation": 5830, "user_id": 3776927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46cb2cca9626c6d445bd05297be86251?s=128&d=identicon&r=PG&f=1", "display_name": "derpirscher", "link": "https://stackoverflow.com/users/3776927/derpirscher"}, "edited": false, "score": 0, "creation_date": 1548265757, "post_id": 54332706, "comment_id": 95483505, "body": "@derpirscher That&#39;s correct"}], "answers": [{"tags": [], "owner": {"reputation": 39249, "user_id": 361, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/932a90d841204bed64a5165e591c5332?s=128&d=identicon&r=PG", "display_name": "stimms", "link": "https://stackoverflow.com/users/361/stimms"}, "is_accepted": false, "score": 1, "last_activity_date": 1548265358, "creation_date": 1548265358, "answer_id": 54332851, "question_id": 54332706, "link": "https://stackoverflow.com/questions/54332706/how-to-allow-characters-in-certain-spot-in-string/54332851#54332851", "title": "How to Allow Characters in Certain Spot in String", "body": "<p>Regular expressions are likely not your best bet. If you know the full set of formats you might encounter then you can use the regular DateTime.ParseExact with a format string. Check for a <code>FormatException</code> to know if you've successfully parsed the date. If your months are using English abbreviations then be sure to pass in an English culture</p>\n\n<pre><code>DateTime.ParseExact(\"28-JAN-19\", \"dd-MMM-yy\", new CultureInfo(\"en\"));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2626, "user_id": 5667167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0578d15bb8fe82332bb123aa29e8b24e?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/5667167/brandon"}, "edited": false, "score": 0, "creation_date": 1548266701, "post_id": 54333085, "comment_id": 95483967, "body": "Yeah, those are valid assumptions, the problem is that there could be endless formats. I&#39;m starting to think RegEx isn&#39;t my best option for this. So, if I go this route, basically I need to pipe together a bunch of potential formats, right?"}, {"owner": {"reputation": 43527, "user_id": 98094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VkdLW.jpg?s=128&g=1", "display_name": "Icemanind", "link": "https://stackoverflow.com/users/98094/icemanind"}, "reply_to_user": {"reputation": 2626, "user_id": 5667167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0578d15bb8fe82332bb123aa29e8b24e?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/5667167/brandon"}, "edited": false, "score": 0, "creation_date": 1548266814, "post_id": 54333085, "comment_id": 95484012, "body": "@James - Well there could be hundreds of formats. Depending on what you are making, your best bet might be to ask the user to supply it in a standard format. e.g. <code>Please enter the date (DD-MM-YYYY) --&gt;</code>. Something like that. In which case, @stimms would have the better answer."}, {"owner": {"reputation": 2626, "user_id": 5667167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0578d15bb8fe82332bb123aa29e8b24e?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/5667167/brandon"}, "edited": false, "score": 0, "creation_date": 1548267479, "post_id": 54333085, "comment_id": 95484327, "body": "Valid. It&#39;s not a UI input, so setting the format isn&#39;t going to work. We&#39;re getting data from a handful of sources so the date formats vary."}], "tags": [], "owner": {"reputation": 43527, "user_id": 98094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/VkdLW.jpg?s=128&g=1", "display_name": "Icemanind", "link": "https://stackoverflow.com/users/98094/icemanind"}, "is_accepted": true, "score": 1, "last_activity_date": 1548266663, "last_edit_date": 1548266663, "creation_date": 1548266344, "answer_id": 54333085, "question_id": 54332706, "link": "https://stackoverflow.com/questions/54332706/how-to-allow-characters-in-certain-spot-in-string/54333085#54333085", "title": "How to Allow Characters in Certain Spot in String", "body": "<p>This RegEx should match all the examples you provided:</p>\n\n<pre><code>[0-9]{2}-([A-Za-z]{3}|[0-9]{2})-[0-9]{2,4}( [0-9][0-9]?:[0-9][0-9]?:[0-9][0-9])?\n</code></pre>\n\n<p>It does make a couple of assumptions though, based on your examples. First, it assumes all your dates will always start with a 2-digit day. It also assumes that your month abbreviations will be 3 letters long. It also assumes that your hours, minutes and seconds will all be 2 digits long. Let me know if any of these assumptions are incorrect.</p>\n\n<p>Here is a <a href=\"http://refiddle.com/refiddles/5c48aadd75622d72820c0000\" rel=\"nofollow noreferrer\">fiddle</a></p>\n"}], "owner": {"reputation": 2626, "user_id": 5667167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0578d15bb8fe82332bb123aa29e8b24e?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon", "link": "https://stackoverflow.com/users/5667167/brandon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 54333085, "answer_count": 2, "score": 0, "last_activity_date": 1548266663, "creation_date": 1548264862, "question_id": 54332706, "link": "https://stackoverflow.com/questions/54332706/how-to-allow-characters-in-certain-spot-in-string", "title": "How to Allow Characters in Certain Spot in String", "body": "<p>I'm trying to parse a date. The problem, is my regular expression omits any letter because I want to avoid <code>01-28-2019 UTC</code> or any letters outside of the main date. Now, it works fine when the date is formatted like I just listed, however it fails when we get a date formatted like <code>28-JAN-19</code>.</p>\n\n<pre><code>var sourceValue = Regex.Replace(\"28-JAN-19\", @\"[A-Za-z]\", \"\");\nvar parsed = DateTime.Parse(sourceValue);\n</code></pre>\n\n<p>The date I need to parse can be in a few different formats. Can a regular expression be used to handle this? If so, what tweaks are needed to trim any letters outside of the <code>xx-xx-xx</code> part of the string?</p>\n\n<p><code>28-JAN-19</code>\n<code>28-01-19</code>\n<code>28-JAN-19 13:15:00</code>\n<code>28-01-19 13:15:00</code>\n<code>28-01-2019 13:15:00</code></p>\n"}, {"tags": ["c#", "xml"], "comments": [{"owner": {"reputation": 417, "user_id": 8061731, "user_type": "registered", "profile_image": "https://graph.facebook.com/1980186498881052/picture?type=large", "display_name": "Valentin Garcia", "link": "https://stackoverflow.com/users/8061731/valentin-garcia"}, "edited": false, "score": 2, "creation_date": 1548264692, "post_id": 54332594, "comment_id": 95483061, "body": "Name and count are not elements, those are attributes of the Item element"}], "answers": [{"tags": [], "owner": {"reputation": 23752, "user_id": 1118978, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/2rloq.jpg?s=128&g=1", "display_name": "Dervi\u015f Kay\u0131mba\u015f\u0131o\u011flu", "link": "https://stackoverflow.com/users/1118978/dervi%c5%9f-kay%c4%b1mba%c5%9f%c4%b1o%c4%9flu"}, "is_accepted": true, "score": 3, "last_activity_date": 1548264775, "creation_date": 1548264775, "answer_id": 54332685, "question_id": 54332594, "link": "https://stackoverflow.com/questions/54332594/how-to-get-elements-in-node/54332685#54332685", "title": "How to get &quot;elements&quot; in node", "body": "<p>You need to use Attributes. Check my solution</p>\n\n<pre><code>XmlNodeList xmlNodes = xmlDocument.SelectNodes(\"Item\");\nforeach (XmlNode xmlNode in xmlNodes)\n{\n    foreach (XmlAttribute attr in xmlNodes.Attributes)\n    {\n         MessageBox.Show($\"Attribute Name is {attr.Name} and Value is {attr.Value}\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9856121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfbdf6c19c09f8eb8b92389e4e9dc54c?s=128&d=identicon&r=PG&f=1", "display_name": "Slinidy", "link": "https://stackoverflow.com/users/9856121/slinidy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 54332685, "answer_count": 1, "score": 0, "last_activity_date": 1548264775, "creation_date": 1548264378, "question_id": 54332594, "link": "https://stackoverflow.com/questions/54332594/how-to-get-elements-in-node", "title": "How to get &quot;elements&quot; in node", "body": "<p>I trying to get \"elements\" from node and show in MessageBox</p>\n\n<p>My XML: <code>&lt;Item Name=\"Test\" Count=\"5\"/&gt;</code></p>\n\n<p>Elements:</p>\n\n<blockquote>\n<pre><code>Name\nCount\n</code></pre>\n</blockquote>\n\n<p>My Code: </p>\n\n<pre><code>XmlNodeList xmlNodes = xmlDocument.SelectNodes(\"Item\");\n                            foreach (XmlNode xmlNode in xmlNodes)\n                            {\n                                MessageBox.Show(xmlNode.InnerText);\n                            }\n</code></pre>\n\n<p>But I do not know how to do this</p>\n"}, {"tags": ["c#", "visual-studio", "unity3d", "hololens"], "comments": [{"owner": {"reputation": 1953, "user_id": 1609929, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Bvq1G.jpg?s=128&g=1", "display_name": "Jethro", "link": "https://stackoverflow.com/users/1609929/jethro"}, "edited": false, "score": 0, "creation_date": 1548327483, "post_id": 54332589, "comment_id": 95505552, "body": "Can you tell us about your D partition, and the folder you&#39;re using?  I&#39;d suspect some kind of permissions problem.  A way to rule this out would be to try again from your C drive."}, {"owner": {"reputation": 21, "user_id": 9778155, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209073107224135/picture?type=large", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/9778155/abdullah"}, "reply_to_user": {"reputation": 1953, "user_id": 1609929, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Bvq1G.jpg?s=128&g=1", "display_name": "Jethro", "link": "https://stackoverflow.com/users/1609929/jethro"}, "edited": false, "score": 0, "creation_date": 1548343080, "post_id": 54332589, "comment_id": 95515023, "body": "I build it on the desktop and it worked fine, however, doesn&#39;t work when I output to the folder..."}, {"owner": {"reputation": 2227, "user_id": 1289007, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c09a0c0e9587d8bc02473752e16e0490?s=128&d=identicon&r=PG", "display_name": "Sunius", "link": "https://stackoverflow.com/users/1289007/sunius"}, "edited": false, "score": 3, "creation_date": 1548482382, "post_id": 54332589, "comment_id": 95566186, "body": "You can&#39;t build your project to the same directory as your Unity Project. Make a subdirectory."}, {"owner": {"reputation": 21, "user_id": 9778155, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209073107224135/picture?type=large", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/9778155/abdullah"}, "edited": false, "score": 0, "creation_date": 1548681086, "post_id": 54332589, "comment_id": 95615878, "body": "thanks for that, I&#39;ve done that and it works GREAT!"}], "owner": {"reputation": 21, "user_id": 9778155, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209073107224135/picture?type=large", "display_name": "Abdullah", "link": "https://stackoverflow.com/users/9778155/abdullah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 333, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1548264369, "creation_date": 1548264369, "question_id": 54332589, "link": "https://stackoverflow.com/questions/54332589/unity-cant-build-to-windows-platform-for-hololens", "title": "Unity can&#39;t build to windows platform for HoloLens", "body": "<p>I've followed the Microsoft documentation for building mixed reality application. I did not have a problem making the app, the application runs in the editor without a problem. However, I can't build the application, this is the error:</p>\n\n<p>I've checked the preference, cleaned out the cache, checked the information on the player setting and XR virtual reality: mixed reality is ticked.</p>\n\n<p>Invalid build path: d:/unity_projects/holoworld\nUnityEngine.GUIUtility:ProcessEvent(Int32, IntPtr)</p>\n"}, {"tags": ["c#", "excel", "visual-studio", "combobox"], "comments": [{"owner": {"reputation": 6114, "user_id": 3070060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a936bdd7a67a345d312281305d5adde?s=128&d=identicon&r=PG&f=1", "display_name": "PaulF", "link": "https://stackoverflow.com/users/3070060/paulf"}, "edited": false, "score": 1, "creation_date": 1548268265, "post_id": 54332551, "comment_id": 95484703, "body": "This is probably very inefficient as the range will include ALL rows of column B - over 1million. If you know the data stops at the first blank cell, it would be better to avoid creating a massive list &amp; just iterate through the cells with a for loop until you get a null value. As Jazimov says - you should use d.Value (or d.Value2). If you do iterate through the Cells property - you should note that although it is accessed as an array, the first value is Cells[1,1] not Cells[0,0]"}, {"owner": {"reputation": 344, "user_id": 5398145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1f8d135ff39ae82feae00561ce29aba0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Pinto", "link": "https://stackoverflow.com/users/5398145/nicole-pinto"}, "reply_to_user": {"reputation": 6114, "user_id": 3070060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a936bdd7a67a345d312281305d5adde?s=128&d=identicon&r=PG&f=1", "display_name": "PaulF", "link": "https://stackoverflow.com/users/3070060/paulf"}, "edited": false, "score": 0, "creation_date": 1548269052, "post_id": 54332551, "comment_id": 95485062, "body": "I&#39;ve edited my code to have a specific range (B1-B40), instead of the entire column. The combo box populates with items but each item just says System.COM Object, instead of the real value. I tried using &quot;comboBox1.Items.Add(d.Value);&quot; like Jazimov says but it gives an error &quot;object does not contain a definition for Value&quot;. Can you please take a look at my edited code above? I&#39;m thinking I need to somehow convert all the objects to a proper array or to strings or something."}, {"owner": {"reputation": 344, "user_id": 5398145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1f8d135ff39ae82feae00561ce29aba0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Pinto", "link": "https://stackoverflow.com/users/5398145/nicole-pinto"}, "reply_to_user": {"reputation": 6114, "user_id": 3070060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a936bdd7a67a345d312281305d5adde?s=128&d=identicon&r=PG&f=1", "display_name": "PaulF", "link": "https://stackoverflow.com/users/3070060/paulf"}, "edited": false, "score": 0, "creation_date": 1548270683, "post_id": 54332551, "comment_id": 95485805, "body": "nevermind I have figured out a way to do it, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 5398145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1f8d135ff39ae82feae00561ce29aba0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Pinto", "link": "https://stackoverflow.com/users/5398145/nicole-pinto"}, "edited": false, "score": 0, "creation_date": 1548268278, "post_id": 54333333, "comment_id": 95484711, "body": "Thanks, but it still doesn&#39;t seem to work, I think my issue is earlier in the code, with how I am grouping the range and iterating over it in my foreach(). Perhaps I&#39;m putting it into the list wrong or should not be using a list all together"}, {"owner": {"reputation": 6114, "user_id": 3070060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a936bdd7a67a345d312281305d5adde?s=128&d=identicon&r=PG&f=1", "display_name": "PaulF", "link": "https://stackoverflow.com/users/3070060/paulf"}, "reply_to_user": {"reputation": 344, "user_id": 5398145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1f8d135ff39ae82feae00561ce29aba0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Pinto", "link": "https://stackoverflow.com/users/5398145/nicole-pinto"}, "edited": false, "score": 0, "creation_date": 1548268438, "post_id": 54333333, "comment_id": 95484787, "body": "@NicolePinto: see my comment above about using a list - creating the list will take a long time &amp; use a lot of memory."}, {"owner": {"reputation": 10720, "user_id": 999082, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/374368c921c7546bb4f38e2ccd633ad6?s=128&d=identicon&r=PG", "display_name": "Jazimov", "link": "https://stackoverflow.com/users/999082/jazimov"}, "edited": false, "score": 1, "creation_date": 1548272017, "post_id": 54333333, "comment_id": 95486350, "body": "I think my version will work with.Text instead. I was unable to test the code when I posted it, but based on your working version, the .Text property should work. If you can try that and let us know, it might help others."}, {"owner": {"reputation": 344, "user_id": 5398145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1f8d135ff39ae82feae00561ce29aba0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Pinto", "link": "https://stackoverflow.com/users/5398145/nicole-pinto"}, "edited": false, "score": 0, "creation_date": 1548275724, "post_id": 54333333, "comment_id": 95487852, "body": "@Jazimov I posted what worked for me down below. Thanks :)"}], "tags": [], "owner": {"reputation": 10720, "user_id": 999082, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/374368c921c7546bb4f38e2ccd633ad6?s=128&d=identicon&r=PG", "display_name": "Jazimov", "link": "https://stackoverflow.com/users/999082/jazimov"}, "is_accepted": false, "score": 0, "last_activity_date": 1548272041, "last_edit_date": 1548272041, "creation_date": 1548267388, "answer_id": 54333333, "question_id": 54332551, "link": "https://stackoverflow.com/questions/54332551/how-can-i-populate-a-combobox-using-the-fields-in-an-excel-column-c/54333333#54333333", "title": "How can I populate a comboBox using the fields in an excel column? C#", "body": "<p>Instead of adding <code>d</code> to the <code>comboBox1</code>, does it work if you add <code>d.Value</code>, like this?</p>\n\n<pre><code>comboBox1.Items.Add(d.Text);\n</code></pre>\n\n<p>( You might need to cast to string although the .Text property already should return a string:</p>\n\n<pre><code>comboBox1.Items.Add((string)d.Text);\n</code></pre>\n\n<p>)</p>\n"}, {"tags": [], "owner": {"reputation": 344, "user_id": 5398145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1f8d135ff39ae82feae00561ce29aba0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Pinto", "link": "https://stackoverflow.com/users/5398145/nicole-pinto"}, "is_accepted": false, "score": -1, "last_activity_date": 1548270816, "creation_date": 1548270816, "answer_id": 54334159, "question_id": 54332551, "link": "https://stackoverflow.com/questions/54332551/how-can-i-populate-a-combobox-using-the-fields-in-an-excel-column-c/54334159#54334159", "title": "How can I populate a comboBox using the fields in an excel column? C#", "body": "<p>Figured it out, I had to fix up some of the excel naming conventions in my foreach statement and convert them to strings within the statement!</p>\n\n<pre><code>            Excel.Application xlApp = new Excel.Application();\n            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(\"X:\\\\Private\\\\Users\\\\Temp\\\\testexcel.xlsm\");\n            Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1]; \n            Excel.Range range = xlWorksheet.get_Range(\"B1:B40\");\n\n\n        foreach (Excel.Range item in range.Cells)\n        {\n\n            string lst = (string)item.Text;\n            comboBox1.Items.Add(lst);\n        }\n</code></pre>\n"}], "owner": {"reputation": 344, "user_id": 5398145, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1f8d135ff39ae82feae00561ce29aba0?s=128&d=identicon&r=PG&f=1", "display_name": "Nicole Pinto", "link": "https://stackoverflow.com/users/5398145/nicole-pinto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 670, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1548272041, "creation_date": 1548264219, "last_edit_date": 1548269241, "question_id": 54332551, "link": "https://stackoverflow.com/questions/54332551/how-can-i-populate-a-combobox-using-the-fields-in-an-excel-column-c", "title": "How can I populate a comboBox using the fields in an excel column? C#", "body": "<p>I have data in column B of my excel sheet that I would like to use to populate a combobox, each cell in the row being a value in the comboBox dropdown list.</p>\n\n<pre><code>        Excel.Application xlApp = new Excel.Application();\n        Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(\"X:\\\\Private\\\\Users\\\\Temp\\\\testexcel.xlsm\");\n        Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];\n        Excel.Range xlRange = xlWorksheet.Range[\"B1:B40\"];\n\n\n\n        foreach (var d in xlRange)\n        {\n\n           comboBox1.Items.Add(d);\n\n\n        }\n</code></pre>\n\n<p>My code doesn't seem to work, I am having trouble with where I should be casting to a string so that it doesn't return as a system.COMobject and instead returns with all the strings in the excel cells as the values in the comboBox. Should I use an array or a list or neither? Am I getting the column range correctly?</p>\n"}, {"tags": ["c#", "json", "json.net"], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 4231460, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-HgZKkdiLk14/AAAAAAAAAAI/AAAAAAAAAEM/yt2JLRuTVBk/photo.jpg?sz=128", "display_name": "Jozkee", "link": "https://stackoverflow.com/users/4231460/jozkee"}, "is_accepted": false, "score": 0, "last_activity_date": 1572658729, "creation_date": 1572658729, "answer_id": 58667589, "question_id": 54332489, "link": "https://stackoverflow.com/questions/54332489/c-deserialize-json-with-ref-paths-in-json-schema-style/58667589#58667589", "title": "C#: Deserialize JSON with $ref paths in json-schema style", "body": "<p>Here is: <a href=\"https://www.newtonsoft.com/jsonschema\" rel=\"nofollow noreferrer\">https://www.newtonsoft.com/jsonschema</a></p>\n\n<p>(ignore this text, StackOverflow ask me for at least 30 characters.</p>\n"}], "owner": {"reputation": 1, "user_id": 2317141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/791c950b673c9d94756fade238755355?s=128&d=identicon&r=PG", "display_name": "elsilmaril", "link": "https://stackoverflow.com/users/2317141/elsilmaril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1572658729, "creation_date": 1548263980, "question_id": 54332489, "link": "https://stackoverflow.com/questions/54332489/c-deserialize-json-with-ref-paths-in-json-schema-style", "title": "C#: Deserialize JSON with $ref paths in json-schema style", "body": "<p>I have JSON files that reference others using the reference type used by json-schema and swagger. Below is a summary of these ref format.</p>\n\n<p>I've searched quite a bit and didn't find a library in C# that allows me to resolve to deserialize json that has these reference style.</p>\n\n<p>Any clues on how to do this, ideally using JSON.NET?</p>\n\n<p>Ref format:</p>\n\n<ul>\n<li>Local Reference \u2013 <strong>$ref: '#/definitions/myElement'</strong> # means go to the root of the current document and then find elements definitions and myElement one after one.</li>\n<li>Remote Reference \u2013 <strong>$ref: 'document.json'</strong> Uses the whole document located on the same server and in the same location.\n\n<ul>\n<li>The element of the document located on the same server \u2013 <strong>$ref: 'document.json#/myElement'</strong></li>\n<li>The element of the document located in the parent folder \u2013 <strong>$ref: '../document.json#/myElement'</strong></li>\n<li>The element of the document located in another folder \u2013 <strong>$ref: '../another-folder/document.json#/myElement'</strong></li>\n</ul></li>\n<li>URL Reference \u2013 <strong>$ref: '<a href=\"http://path/to/your/resource\" rel=\"nofollow noreferrer\">http://path/to/your/resource</a>'</strong> Uses the whole document located on the different server.\n\n<ul>\n<li>The specific element of the document stored on the different server \u2013 <strong>$ref: '<a href=\"http://path/to/your/resource.json#myElement\" rel=\"nofollow noreferrer\">http://path/to/your/resource.json#myElement</a>'</strong></li>\n<li>The document on the different server, which uses the same protocol (for example, HTTP or HTTPS) \u2013 <strong>$ref: '//anotherserver.com/files/example.json'</strong></li>\n</ul></li>\n</ul>\n"}, {"tags": ["c#", "sql-server", "entity-framework", "entity-framework-6"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 2, "creation_date": 1548263957, "post_id": 54332332, "comment_id": 95482783, "body": "Sound like the server may be expecting a keep alive and closing when idle.  See following posting : <a href=\"https://social.msdn.microsoft.com/Forums/sqlserver/en-US/707fbc2b-3894-4d95-988e-d3473e481dbf/keep-alive-and-keep-alive-interval-properties-in-sql-server-2012?forum=sqldatabaseengine\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/sqlserver/en-US/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 5143466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIIBQ.jpg?s=128&g=1", "display_name": "agsk", "link": "https://stackoverflow.com/users/5143466/agsk"}, "is_accepted": false, "score": 0, "last_activity_date": 1549039062, "creation_date": 1549039062, "answer_id": 54483608, "question_id": 54332332, "link": "https://stackoverflow.com/questions/54332332/entity-framework-6-losing-connection-on-long-transaction/54483608#54483608", "title": "Entity Framework 6 losing connection on long transaction", "body": "<p>One thing is not clear from your post what are using ? Code first or Db First ? However you should dispose your DbContext resources after all your transaction happens and definitely implement this line of code in your DbConetext constructor </p>\n\n<pre><code> public partial class RDSS_WBEntities : DbContext\n    {\n        public RDSS_WBEntities() : base(\"name=RDSS_WBEntities\")\n        {\n            this.Database.CommandTimeout = int.MaxValue;\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10596552, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IngIAbNf5Bg/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCsKu1sQtP7g1qovTXBvZtmWdkI7g/mo/photo.jpg?sz=128", "display_name": "Oscar &#211; Foghl&#250;", "link": "https://stackoverflow.com/users/10596552/oscar-%c3%93-foghl%c3%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1549039062, "creation_date": 1548263368, "question_id": 54332332, "link": "https://stackoverflow.com/questions/54332332/entity-framework-6-losing-connection-on-long-transaction", "title": "Entity Framework 6 losing connection on long transaction", "body": "<p>I'm currently doing a complex migration task where each iteration must be wrapped in a transaction in case of failure. Each iteration can take as long as 2 hours.</p>\n\n<p>This has mostly been successful. There have been some cases where a long operation is required in between accesses to the connection.</p>\n\n<p>Essentially the connection is idle for a while (> 10 minutes) and when I try to use the connection again I discover it is broken:</p>\n\n<pre><code>System.Data.Entity.Core.EntityCommandExecutionException: An error occurred while executing the command definition. See the inner exception for details. ---&gt; System.Data.SqlClient.SqlException: The connection is broken and recovery is not possible.  The connection is marked by the server as unrecoverable.  No attempt was made to restore the connection.\n   at System.Data.SqlClient.SqlCommand.&lt;&gt;c.&lt;ExecuteDbDataReaderAsync&gt;b__180_0(Task`1 result)\n   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()\n   at System.Threading.Tasks.Task.Execute()\n</code></pre>\n\n<p>The code looks something like:</p>\n\n<pre><code>// Context = instance of DbContext\nusing (var dbContextTransaction = Context.Database.BeginTransaction())\n{\n    DoStuffWithContext(Context);\n\n    PotentiallyLongOperationWithoutContext();\n\n    DoMoreStuffWithContext(Context);\n}\n</code></pre>\n\n<p>Normally this all works fine but when PotentiallyLongOperationWithoutContext does take a long time I get the exception when DoMoreStuffWithContext first tries to use the context.</p>\n"}]