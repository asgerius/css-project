[{"tags": ["c", "serial-port", "pty", "termios", "socat"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11799422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe12512f9a7dd3cd357577b52943cfe?s=128&d=identicon&r=PG&f=1", "display_name": "BreakfastCalzone", "link": "https://stackoverflow.com/users/11799422/breakfastcalzone"}, "edited": false, "score": 0, "creation_date": 1563463433, "post_id": 57087973, "comment_id": 100717028, "body": "If I am writing bytes to /dev/pts/2 shouldn&#39;t I be able to listen to /dev/pts/3 to observe output (since this is a data transfer connection between them)? When I echo to /dev/pts/2 I can cat /dev/pts/3 to see what I echo&#39;d."}, {"owner": {"reputation": 33, "user_id": 11799422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe12512f9a7dd3cd357577b52943cfe?s=128&d=identicon&r=PG&f=1", "display_name": "BreakfastCalzone", "link": "https://stackoverflow.com/users/11799422/breakfastcalzone"}, "edited": false, "score": 0, "creation_date": 1563464651, "post_id": 57087973, "comment_id": 100717791, "body": "Also, this tried exactly this with listening to BOTH /dev/pts/2 and /dev/pts/3 but it still didn&#39;t work."}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "reply_to_user": {"reputation": 33, "user_id": 11799422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe12512f9a7dd3cd357577b52943cfe?s=128&d=identicon&r=PG&f=1", "display_name": "BreakfastCalzone", "link": "https://stackoverflow.com/users/11799422/breakfastcalzone"}, "edited": false, "score": 0, "creation_date": 1563464874, "post_id": 57087973, "comment_id": 100717936, "body": "With minicom I see data on both ports. If I use <code>cat</code> I can only see data on <code>&#47;dev&#47;pts&#47;2</code>."}, {"owner": {"reputation": 33, "user_id": 11799422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe12512f9a7dd3cd357577b52943cfe?s=128&d=identicon&r=PG&f=1", "display_name": "BreakfastCalzone", "link": "https://stackoverflow.com/users/11799422/breakfastcalzone"}, "edited": false, "score": 0, "creation_date": 1563466148, "post_id": 57087973, "comment_id": 100718635, "body": "Oh ok it works with minicom and I can only see it on the port that is not being written to (which is the expected behavior). Thanks! Not sure why cat and read don&#39;t work."}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "reply_to_user": {"reputation": 33, "user_id": 11799422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe12512f9a7dd3cd357577b52943cfe?s=128&d=identicon&r=PG&f=1", "display_name": "BreakfastCalzone", "link": "https://stackoverflow.com/users/11799422/breakfastcalzone"}, "edited": false, "score": 0, "creation_date": 1563466456, "post_id": 57087973, "comment_id": 100718771, "body": "Yeah, that&#39;s consistent with what I see. I&#39;m not sure why <code>cat</code> works like that either. I have never been fond of it."}], "tags": [], "owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1563429626, "creation_date": 1563429626, "answer_id": 57087973, "question_id": 57084952, "link": "https://stackoverflow.com/questions/57084952/how-to-use-termios-to-send-bytes-over-a-socat-data-transfer-loop/57087973#57087973", "title": "How to use Termios to send bytes over a socat data transfer loop", "body": "<p>Your code works fine with real and virtual serial ports for me.</p>\n\n<p>You need to pay attention to the <code>socat</code> output:</p>\n\n<pre><code>$ socat -d -d pty pty\n2019/07/18 07:55:45 socat[8144] N PTY is /dev/pts/2\n2019/07/18 07:55:45 socat[8144] N PTY is /dev/pts/3\n2019/07/18 07:55:45 socat[8144] N starting data transfer loop with FDs [5,5] and [7,7]\n</code></pre>\n\n<p>Then listen on the first port of the pair:</p>\n\n<pre><code>$ cat /dev/pts/2\n</code></pre>\n\n<p>And run your code (compiled with <code>PORT_NAME \"/dev/pts/2\"</code>) and you'll see the <code>abc</code> con the terminal where you run <code>cat</code>.</p>\n\n<p>You can also try connecting to <code>/dev/pts/2</code> or <code>/dev/pts/3</code> with minicom or any other terminal you like and you'll see the output:</p>\n\n<pre><code>$ minicom -D /dev/pts/2 -b 9600\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11799422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe12512f9a7dd3cd357577b52943cfe?s=128&d=identicon&r=PG&f=1", "display_name": "BreakfastCalzone", "link": "https://stackoverflow.com/users/11799422/breakfastcalzone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 568, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1563429626, "creation_date": 1563404038, "last_edit_date": 1563405510, "question_id": 57084952, "link": "https://stackoverflow.com/questions/57084952/how-to-use-termios-to-send-bytes-over-a-socat-data-transfer-loop", "title": "How to use Termios to send bytes over a socat data transfer loop", "body": "<p>I am trying to write a simple program that sends bytes over a serial connection. I created a data transfer loop using socat as follows:</p>\n\n<pre><code>$ socat -d -d pty pty\n</code></pre>\n\n<p>This creates a data transfer loop between /dev/pts/2 and /dev/pts/0. When I try to use termios in my C program to write some bytes, I successfully am able to open the serial connection using open(). I then write some bytes using write() and I receive the number of bytes written. Yet, when I listen to the opposite ends I don't see any output. I used these to try and listen in another terminal:</p>\n\n<pre><code>$ cat /dev/pts/0 | xxd\n$ read -r line &lt; /dev/pts/0\n$ echo $line\n</code></pre>\n\n<p>I know my socat connection works because when I echo bytes and listen on the other end, I receive them normally.</p>\n\n<pre><code>#define BAUD_RATE B9600\n#define PORT_NAME \"/dev/pts/2\"\n\n/* Serial Connection Manager */\nstruct termios tty;\nint fd;\n\nint main(){\n  /*\n  O_RDWR: read/write access to serial port\n  O_NOCTTY: No terminal will control the process\n  O_NDELAY: Non-blocking, returns immediately\n  */\n  fd = open(PORT_NAME, O_RDWR | O_NOCTTY | O_NDELAY);\n  printf(\"%s\\n\", PORT_NAME);\n  if (fd == -1) {\n    printf(\"Error in opening serial port\\n\");\n    return -1;\n  }\n  else\n    printf(\"Port opened successfully\\n\");\n\n  tcgetattr(fd, &amp;tty); // get current attrs of serial port\n  // raw mode of terminal driver\n  //cfsetispeed(&amp;tty, BAUD_RATE);\n  //cfsetospeed(&amp;tty, BAUD_RATE);\n  cfmakeraw(&amp;tty);\n\n  // set additional control modes\n  cfsetspeed(&amp;tty, (speed_t) BAUD_RATE);\n  tty.c_cflag &amp;= ~CSTOPB; //1 stop bit\n  tty.c_cflag &amp;= ~CRTSCTS; //disable hardware flow control\n  tty.c_cflag |= CLOCAL; //ignore modem control lines\n  tty.c_cflag |= CREAD; //enable receiver\n\n  if((tcsetattr(fd, TCSANOW, &amp;tty)) != 0){\n    printf(\"Error in setting attributes\\n\");\n    close(fd);\n    return -1;\n  }\n  else\n    printf(\"BaudRate = %d\\nStopBits = 1\\nParity = Odd\\n\", BAUD_RATE);\n\n  sleep(1); // wait for configuration\n  tcflush(fd, TCIOFLUSH);\n\n  char buf[3] = \"abc\";\n  int bytes_written = write(fd, buf, 3);\n  printf(\"Bytes written: %d\", bytes_written);\n  close(fd);\n  return 0;\n}\n</code></pre>\n\n<p>I expected to be able to listen to the bytes using \n<code>$ read -r output &lt; /dev/pts/0</code>\nand that when echoing output would give \"abc\".</p>\n\n<p>Running my program gives the following output:</p>\n\n<pre><code>/dev/pts/2\nPort opened successfully\nBaudRate = 13\nStopBits = 1\nParity = Odd\nBytes written: 3\n</code></pre>\n\n<p>So I know the bytes are going somewhere since write() doesn't return -1.</p>\n"}, {"tags": ["c", "function", "pointers", "parameters"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 4, "creation_date": 1563400464, "post_id": 57084488, "comment_id": 100692127, "body": "No, that is not enforced by the language specifications."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1563400577, "post_id": 57084488, "comment_id": 100692161, "body": "No. These may be even passed via registers and not to have address at all. And by taking their addresses you are forcing the compiler to allocate some memory space in addition to it."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563400698, "post_id": 57084488, "comment_id": 100692191, "body": "@EugeneSh. Ah, yes, the good old MIPS ISA has 4 <i>argument</i> registers, if memory serves."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1563400991, "post_id": 57084488, "comment_id": 100692257, "body": "@ChristianGibbons Arm ABI is specifying passing first three argument via registers (if memory serves :))"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1563409583, "post_id": 57084488, "comment_id": 100694082, "body": "Try a function that accepts two <code>double</code>s."}], "answers": [{"tags": [], "owner": {"reputation": 8784, "user_id": 2728148, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GXsMO.png?s=128&g=1", "display_name": "Cort Ammon", "link": "https://stackoverflow.com/users/2728148/cort-ammon"}, "is_accepted": false, "score": 6, "last_activity_date": 1563400684, "creation_date": 1563400684, "answer_id": 57084538, "question_id": 57084488, "link": "https://stackoverflow.com/questions/57084488/is-the-difference-between-the-addresses-of-a-functions-parameters-always-4-byte/57084538#57084538", "title": "Is the difference between the addresses of a function&#39;s parameters always 4 bytes?", "body": "<p>Absolutely not, in so many ways that it would be hard to count them all.</p>\n\n<p>First and foremost, the memory layout of arguments is simply not specified by the C language.  Full stop.  It is not specified.  Thus the answer is \"no\" immediately.</p>\n\n<p><code>va_list</code> exists because there was a need to be able to navigate a list of varadic arguments because it wasn't specified other than that.  <code>va_list</code> is intentionally <em>very</em> limited, so that it works on platforms where the shape of the stack does not match your intuition.</p>\n\n<p>Other reasons it can't always be 4:</p>\n\n<ul>\n<li>What if you pass an object of length 8?</li>\n<li>What if the compiler optimizes a reference to actually point at the object in another frame?</li>\n<li>What if the compiler adds padding, perhaps to align a 64-bit number on a 64-bit boundary?</li>\n<li>What if the stack is built in the opposite direction (such that the difference would be -4 instead of +4)</li>\n</ul>\n\n<p>The list goes on and on.  C does not specify the relative addresses between arguments.</p>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 2, "last_activity_date": 1563404320, "last_edit_date": 1563404320, "creation_date": 1563404051, "answer_id": 57084956, "question_id": 57084488, "link": "https://stackoverflow.com/questions/57084488/is-the-difference-between-the-addresses-of-a-functions-parameters-always-4-byte/57084956#57084956", "title": "Is the difference between the addresses of a function&#39;s parameters always 4 bytes?", "body": "<p>As the other answers correctly say:</p>\n\n<p><strong>No.</strong></p>\n\n<p>Furthermore, even trying to determine whether the addresses differ by 4 bytes, depending on how you do it, probably has <em>undefined behavior</em>, which means the C standard says nothing about what your program does.</p>\n\n<pre><code>void func(long a, long b)\n{\n    printf(\"%d\\n\", (int)&amp;b - (int)&amp;a);\n}\n</code></pre>\n\n<p><code>&amp;a</code> and <code>&amp;b</code> are expression of type <code>long*</code>. Converting a pointer to <code>int</code> is legal, but the result is implementation-defined, and \"If the result cannot be represented in the integer type, the behavior is undefined. The result need not be in the range of values of any integer type.\"</p>\n\n<p>It's very likely that pointers are 64 bits and <code>int</code> is 32 bits, so the conversions could lose information.</p>\n\n<p>Most likely the conversions will give you values of type <code>int</code>, but they don't necessarily have any meaning, nor does their difference.</p>\n\n<p>Now you can subtract pointer values directly, with a result of the signed integer type <code>ptrdiff_t</code> (which, unlike <code>int</code>, is probably big enough to hold the result).</p>\n\n<pre><code>printf(\"%td\\n\", &amp;b - &amp;a);\n</code></pre>\n\n<p>But \"When two pointers are subtracted, both shall point to elements of the same array object, or one past the last element of the array object; the result is the difference of the subscripts of the two array elements.\"  Pointers to distinct object cannot be meaningfully compared or subtracted.</p>\n\n<p>Having said all that, it's likely that the <em>implementation</em> you're using has a memory model that's reasonably straightforward, and that pointer values are in effect represented as indices into a monolithic memory space.  Comparing <code>&amp;b</code> vs. <code>&amp;a</code> is not permitted by the C language, but examining the values can provide some insight about what's going on behind the curtain -- which can be especially useful if you're tracking down a bug.</p>\n\n<p>Here's something you can do portably to examine the addresses:</p>\n\n<pre><code>printf(\"&amp;a = %p\\n\", (void*)&amp;a);\nprintf(\"&amp;b = %p\\n\", (void*)&amp;b);\n</code></pre>\n\n<p>The result you're seeing for the subtraction (4) suggests that type <code>long</code> is probably 4 bytes (32 bits) on your system. I'd guess you're on Windows. It also suggests something about the way function parameters are allocated -- something that you as a programmer should almost never have to care about, but is worth understanding anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 0, "last_activity_date": 1563406831, "creation_date": 1563406831, "answer_id": 57085295, "question_id": 57084488, "link": "https://stackoverflow.com/questions/57084488/is-the-difference-between-the-addresses-of-a-functions-parameters-always-4-byte/57085295#57085295", "title": "Is the difference between the addresses of a function&#39;s parameters always 4 bytes?", "body": "<blockquote>\n  <p>[...] I was just curious if the addresses of a function's parameters are always in a difference of 4 bytes from one another.\"</p>\n</blockquote>\n\n<p>The greatest error in your reasoning is to think that the parameters exist in memory <strong>at all</strong>.</p>\n\n<p>I am running this program on x86-64:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nvoid func(long a, long b)\n{\n    printf(\"%d\\n\", (int)((intptr_t)&amp;b - (intptr_t)&amp;a));\n}\n\nint main(void)\n{\n    func(1, 2);\n}\n</code></pre>\n\n<p>and compile it with <code>gcc -O3</code> it prints <strong><code>8</code></strong>, proving that your guess is absolutely wrong. Except... when I compile it without optimization it prints out <strong><em><code>-8</code></em></strong>. </p>\n\n<p>X86-64 SYSV calling convention says that the arguments are passed in registers instead of being passed in memory. <code>a</code> and <code>b</code> do not have an address <strong>until</strong> you take their address with <code>&amp;</code> - then the compiler is caught with its pants down from cheating the <a href=\"https://stackoverflow.com/questions/15718262/what-exactly-is-the-as-if-rule\">as-if rule</a> and it quickly pulls up its pants and stuffs them into some memory location so that they can have their address taken, but it is in no way consistent in <em>where</em> they're stored.</p>\n"}], "owner": {"reputation": 81, "user_id": 10601715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dde09edfb712cbe0fbd978fa444dd398?s=128&d=identicon&r=PG&f=1", "display_name": "aviad1", "link": "https://stackoverflow.com/users/10601715/aviad1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1563406831, "creation_date": 1563400300, "question_id": 57084488, "link": "https://stackoverflow.com/questions/57084488/is-the-difference-between-the-addresses-of-a-functions-parameters-always-4-byte", "title": "Is the difference between the addresses of a function&#39;s parameters always 4 bytes?", "body": "<p>I've been doing some pointers testing in C, and I was just curious if the addresses of a function's parameters are always in a difference of 4 bytes from one another.</p>\n\n<p>I've tries to run the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid func(long a, long b);\n\nint main(void)\n{\n    func(1, 2);\n\n    getchar();\n    return 0;\n}\n\nvoid func(long a, long b)\n{\n    printf(\"%d\\n\", (int)&amp;b - (int)&amp;a);\n}\n</code></pre>\n\n<p>This code seems to always print 4, no matter what is the type of func's parameters.\nI was just wondering if it's ALWAYS 4, because if so it can be useful for something I'm trying to do (but if it isn't necessarily 4 I guess I could just use va_list for my function or something).\nSo: Is it necessarily 4 bytes?</p>\n"}, {"tags": ["c", "list", "linked-list"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1563398457, "post_id": 57083731, "comment_id": 100691512, "body": "Are you allowed to sort the lists (or sort copies of the original lists)?  That would improve the performance.  What you outline should work, but is slow \u2014 it has a time complexity O(length(L1) * length(L2)).  It won&#39;t matter if your lists are expected to be short (tens of elements, or less); it will if they&#39;re expected to be long (thousands of elements)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1563399442, "post_id": 57083731, "comment_id": 100691831, "body": "Note that you don&#39;t need to test for <code>l1 != NULL</code> after you return <code>NULL</code> when <code>l1 == NULL</code>.  Similarly with testing <code>l2 != NULL</code> after you&#39;ve returned when <code>l2 == NULL</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1563399618, "post_id": 57083731, "comment_id": 100691887, "body": "Presumably, you need to establish a loop over all the elements of <code>L1</code>.  For each element, you run a loop over all the elements of <code>L2</code> and compare the element of <code>L2</code> with the current element of <code>L1</code>.  If you find a match in <code>L2</code>, you terminate the inner loop and move onto the next element in the outer loop.  If you don&#39;t find a match, you add the element of <code>L1</code> to <code>L3</code>, and then move onto the next element in the outer loop."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1563399904, "post_id": 57083731, "comment_id": 100691977, "body": "It&#39;s hard to see the relevance of recursion here unless the two input lists are in fact sorted."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1563411039, "post_id": 57083731, "comment_id": 100694307, "body": "The case <code>l1 == l2</code> should be handled!!!"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1563411234, "post_id": 57083731, "comment_id": 100694342, "body": "Your <code>struct data</code> declaration is incorrect; in C, a structure cannot contain a member that is of its own type, only of a pointer to its own type: <code>struct node { ... struct node *next };</code> . Mind the <code>*</code>."}], "owner": {"reputation": 21, "user_id": 10591467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qwqJw.jpg?s=128&g=1", "display_name": "Sabaudian", "link": "https://stackoverflow.com/users/10591467/sabaudian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563399366, "creation_date": 1563395735, "last_edit_date": 1563399366, "question_id": 57083731, "link": "https://stackoverflow.com/questions/57083731/difference-between-two-lists-recursively", "title": "Difference between two lists recursively", "body": "<p>The exercise I am trying to do, asks me to, given two lists (L1 and L2) without duplicates inside them, create a third list with the elements present only in L1.</p>\n\n<p>The first way that I thought of to solve the problem is to take every single node of the list L1 and compare it with the whole list L2, if the node is not present then I add it to the new list that I have to build.\nMy problem is that I don't understand how to process this step.</p>\n\n<p>I have understood the basic cases of the exercise. If L1 is empty, return NULL (for example). If L1 is not empty, but L2 is empty, then I simply return L1.</p>\n\n<p>Example:</p>\n\n<p>L1: 15->13->2->3->70->100</p>\n\n<p>l2: 3->13->5->27->100->101</p>\n\n<p>Output:</p>\n\n<p>L3: 15->2->70</p>\n\n<p>This is my attempt:</p>\n\n<pre><code>//struct\nstruct data \n{\n  int d;\n  struct data d;\n};\ntypedef struct data Node;\n\n//create the list\nNode *creat_list() {\n\n    Node *lis, *p, *last;\n    int x;\n\n    printf(\"\\n Insert new data: \");\n    scanf(\"%d\", &amp;x);\n\n    if(x &lt;= 0)\n    {\n        lis = NULL;\n    }\n    else\n    {\n        last = newnode();\n\n        lis = last;\n        last-&gt;d = x;\n        last-&gt;next = NULL;\n\n        printf(\" Insert new data: \");\n        scanf(\"%d\", &amp;x);\n\n        while(x &gt; 0)\n        {\n            p = newnode();\n            p-&gt;d = x;\n            p-&gt;next = NULL;\n            last-&gt;next = p;\n            last = p;\n            printf(\" Insert new data: \");\n            scanf(\"%d\", &amp;x);\n\n        }\n    }\n    return (lis);\n}\n\nNode *list_difference(Node *l1, Node *l2) {\n\n    Node *l3;\n\n    if (l1 == NULL) return NULL;\n\n    if (l1 != NULL &amp;&amp; l2 == NULL) return l1;\n\n    if (l1 != NULL &amp;&amp; l2 != NULL)\n    {\n        ...\n        ...\n    }\n    return l3;\n}\n</code></pre>\n"}, {"tags": ["c", "raspberry-pi", "hardware", "i2c", "smbus"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1563395365, "post_id": 57083604, "comment_id": 100690380, "body": "If you try to turn relay 2 on and off, does it also affect relay 1, only do relay 2, or do nothing?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10576065"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1563396515, "post_id": 57083604, "comment_id": 100690822, "body": "@ThomasJager Turning Relay 2 on will shut Relay 1 Off, yes. Shutting Relay 2 off results in the same result as shutting Relay 1 Off - Both are powered off. I can post the Code for the Relay 2 functions if that would help better"}, {"owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1563397525, "post_id": 57083604, "comment_id": 100691158, "body": "dumb question, do they have the same I2C address?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10576065"}, "reply_to_user": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1563397599, "post_id": 57083604, "comment_id": 100691185, "body": "@yhyrcanus yes they do, the two relays are on one board. The one board has an address of 0x20"}, {"owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 2, "creation_date": 1563397998, "post_id": 57083604, "comment_id": 100691353, "body": "Wait, MCP23008 is an IO expander. The relays themselves aren&#39;t I2C devices. You probably want to use bitwise math with the data, instead of just equaling it. Every time, you&#39;re SETTING the bits to be 10 or 01 or 00. If you kept the status of what relays are activated, you could OR it/AND it with a mask to turn both on/just the one you want off."}, {"owner": {"reputation": 415, "user_id": 56938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f823e2d5049dacc1d6e446a216589120?s=128&d=identicon&r=PG", "display_name": "bdowling", "link": "https://stackoverflow.com/users/56938/bdowling"}, "edited": false, "score": 0, "creation_date": 1563398219, "post_id": 57083604, "comment_id": 100691439, "body": "In your second example, the value of data will be 0xFC (i.e., the bottom two bits are zero). If command 0x09 takes the second byte and sets the output state of both relays (likely), then your code will turn both of them off. If you want to set the relays individually, then you&#39;ll either need to keep track of the state yourself or use a different command.   Also, you&#39;ll want to call <code>close(file)</code> at the end of each function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10576065"}, "reply_to_user": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "edited": false, "score": 0, "creation_date": 1563398366, "post_id": 57083604, "comment_id": 100691482, "body": "@yhyrcanus My apologies, that&#39;s just what the board says on it. Here is the board: <a href=\"https://store.ncd.io/product/mcp3427-16-bit-2-channel-analog-to-digital-converter-i2c-mini-module/\" rel=\"nofollow noreferrer\">link</a> Thank you for that suggestion, I&#39;ll give it a try. I don&#39;t understand how to turn just one relay off though."}, {"owner": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 0, "creation_date": 1563398549, "post_id": 57083604, "comment_id": 100691538, "body": "You need to maintain your own variable to keep a record of the desired state of each relay. You should then either set or clear an individual bit in that variable to turn a particular relay on or off. You send the contents of that variable to your I2C device - you can&#39;t individually control just one at a time - you need to figure out the state you want them both to be in and then send that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10576065"}, "reply_to_user": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 0, "creation_date": 1563398609, "post_id": 57083604, "comment_id": 100691565, "body": "@brhans thank you for the suggestion"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10576065"}, "edited": false, "score": 0, "creation_date": 1563456355, "post_id": 57084561, "comment_id": 100712498, "body": "Basically ioctl is just a method to find a device and configure it to output or input, from my understanding (which is minimal). Thank you for the answer though"}], "tags": [], "owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "is_accepted": true, "score": 0, "last_activity_date": 1563400949, "creation_date": 1563400949, "answer_id": 57084561, "question_id": 57083604, "link": "https://stackoverflow.com/questions/57083604/turning-one-raspberry-pi-i2c-connected-relay-on-turns-the-other-relay-off/57084561#57084561", "title": "Turning One Raspberry Pi I2C Connected Relay On Turns the Other Relay Off", "body": "<p>I don't know how the fancy <code>ioctl</code> stuff works, but I'd try to do all initialization outside of this function, including setting all the GPIO's to output.</p>\n\n<p>You should probably just have one function call to set/clear a relay. I'd do something like this to start:</p>\n\n<pre><code>void RelayOnOff(unsigned char relay, unsigned char enable)\n{\n    //Init to all off\n    static unsigned char data = 0x00;\n    ...  \n    if (enable){\n        data |= ( 1 &lt;&lt; relay );\n    }\n    else{\n        data &amp;= ~( 1 &lt;&lt; relay );\n    }\n    config[0] = 0x09;\n    config[1] = data;\n    write(file, config, 2);\n}\n</code></pre>\n\n<p>You pass in what relay you want to control, and a boolean value for enable/disable. If you make the data variable static, it'll \"remember\" that value from function call to function call. The enable/disable sets/clears the bit for whatever relay you pass in (0-7).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10576065"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 57084561, "answer_count": 1, "score": 0, "last_activity_date": 1563400949, "creation_date": 1563395011, "last_edit_date": 1563396826, "question_id": 57083604, "link": "https://stackoverflow.com/questions/57083604/turning-one-raspberry-pi-i2c-connected-relay-on-turns-the-other-relay-off", "title": "Turning One Raspberry Pi I2C Connected Relay On Turns the Other Relay Off", "body": "<p>Currently, I have two, 2-Channel 1 Amp SPDT Signal Relay Controllers connected to my Raspberry Pi 3 via I2C, and when I currently run the function to turn one relay on, the other one will shut off at the same time (one or the other is on). In addition, my button to shut off relay 1 and my button to shut off relay 2 will shut both relays off. </p>\n\n<p>My program is written in a windows form (visual studio), and I am accessing a C Shared Library via Dll Import, but I know for a fact my problem is within my C library. I am very new to C and how shifting works, so the root of my problem lies within the logic and structure of my code. Frankly, I'm confused on how to properly code this.</p>\n\n<p>This is currently the method to turn Relay 1 On. It turns the relay on properly, but this also turns Relay 2 Off at the same time. </p>\n\n<pre><code>void Relay1On() ***CURRENTLY TURNS OTHER OFF WHEN ACTIVATED***\n{\n    // Create I2C bus\n    int file;\n    char *bus = \"/dev/i2c-1\";\n    if ((file = open(bus, O_RDWR)) &lt; 0) \n    {\n        printf(\"Failed to open the bus. \\n\");\n        exit(1);\n    }\n    // Get I2C device, MCP23008 I2C address is 0x20(32)\n    ioctl(file, I2C_SLAVE, 0x20);\n\n    // Configure all pins of port as output (0x00)\n    char config[2] = {0};\n    config[0] = 0x00;\n    config[1] = 0x00;\n    write(file, config, 2);\n\n    //Turn the first relay on\n    char data = 0x01;\n    config[0] = 0x09;\n    config[1] = data;\n    write(file, config, 2);\n\n}\n</code></pre>\n\n<p>Here is the code for Relay 1 Off, I will not post Relay 2 On/Off because it is basically the same, Relay2On just has an added <code>data += 1;</code> after <code>char data = 0x01;</code>. Both 'Off' methods result in both relays shutting off. </p>\n\n<pre><code>void Relay1Off()\n{\n    // Create I2C bus\n    int file;\n    char *bus = \"/dev/i2c-1\";\n    if ((file = open(bus, O_RDWR)) &lt; 0) \n    {\n        printf(\"Failed to open the bus. \\n\");\n        exit(1);\n    }\n    // Get I2C device, MCP23008 I2C address is 0x20(32)\n    ioctl(file, I2C_SLAVE, 0x20);\n\n    // Configure all pins of port as output (0x00)\n    char config[2] = {0};\n    config[0] = 0x00;\n    config[1] = 0x00;\n    write(file, config, 2);\n\n    //Turn the first relay off *****Turns all off at the moment******\n    char data = 0xFE;\n    data = (data &lt;&lt; 1);\n    config[0] = 0x09;\n    config[1] = data;\n    write(file, config, 2);\n}\n</code></pre>\n\n<p>All I want is the methods to do as described, turn Relay 1 On when the method is called. When Relay1Off is called, shut only Relay 1 off. I'm sure it is simple, but as I've stated above C is quite new to me. </p>\n\n<p>Thank you in advance for any contribution.</p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1563395094, "post_id": 57083574, "comment_id": 100690253, "body": "How about utilizing all 6 threads for checking a <i>single</i> number? Like make your <code>is_prime</code> multithreaded. That&#39;s just wild idea, by the way."}, {"owner": {"reputation": 144, "user_id": 11799423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oC2OYl-Wh68/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfZa_6JPo3sasvkyRLJr4VR73qvdA/photo.jpg?sz=128", "display_name": "Bob Rob", "link": "https://stackoverflow.com/users/11799423/bob-rob"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563395335, "post_id": 57083574, "comment_id": 100690363, "body": "Good idea, i can consider it; even if i would prefer to don&#39;t modify the is_prime function"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1563395475, "post_id": 57083574, "comment_id": 100690435, "body": "Welcome to SO! Why don&#39;t you want to modify <code>is_prime</code>? As written, it&#39;s extremely inefficient, so it should be the first place to look. It seems like you&#39;ll want to write something like a <a href=\"https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes\" rel=\"nofollow noreferrer\">Sieve of Eratosthenes</a>, then figure out how to multithread it. What exactly are your goals with this project? Why do you want to print without saving it in an array (surely, this would destroy efficiency if I&#39;m thinking straight)? <a href=\"https://stackoverflow.com/a/18885065/6243352\">This post</a> is in C# but has a lot of generic advice which may be useful."}, {"owner": {"reputation": 144, "user_id": 11799423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oC2OYl-Wh68/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfZa_6JPo3sasvkyRLJr4VR73qvdA/photo.jpg?sz=128", "display_name": "Bob Rob", "link": "https://stackoverflow.com/users/11799423/bob-rob"}, "edited": false, "score": 0, "creation_date": 1563395764, "post_id": 57083574, "comment_id": 100690545, "body": "It&#39;s a school homework, the funcion is_prime isn&#39;t important for my goals (I can assume that it is efficent), the problem is the efficency of the rest of the program, and in particular the big array a"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563396077, "post_id": 57083574, "comment_id": 100690666, "body": "I think the big array <code>a</code> is a reasonable way to do what you&#39;re trying to do."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563396159, "post_id": 57083574, "comment_id": 100690700, "body": "You can save memory by making it an array of booleans instead of putting the value <code>i</code> in <code>a[i]</code>. <code>a[i]</code> is either <code>1</code> or <code>0</code> depending on whether <code>i</code> is prime. Then the printing loop prints <code>i</code> rather than <code>a[i]</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563396201, "post_id": 57083574, "comment_id": 100690722, "body": "But 10K ints instead of 10K chars is not a big deal these days."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563396333, "post_id": 57083574, "comment_id": 100690768, "body": "@Barmar The list of primes is pretty sparse, so 10K primes will result in <i>much</i> longer array of booleans. And it&#39;s size is not known initially."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1563396454, "post_id": 57083574, "comment_id": 100690805, "body": "@EugeneSh. If that&#39;s what he&#39;s supposed to be doing, his code is wrong. He&#39;s getting all the primes below 10K, not the first 10K primes, unless I&#39;m misunderstanding it."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1563397325, "post_id": 57083574, "comment_id": 100691095, "body": "All primes below 10,000 is a significantly different problem from the first 10,000 primes. For the former, a school assignment for elementary threads lessons anticipates you partitioning the range into six segment (such as 1 to 1666, 1667 to 3333, and so on), letting each thread finding the primes in each segment, and printing the results. Each thread can be allowed to report its own results, and only one synchronization per thread is necessary (thread finishes its work, waits for go-ahead, then prints results, and the parent gives the go-aheads in order by assigned segment), or\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1563397375, "post_id": 57083574, "comment_id": 100691106, "body": "\u2026 the parent could collect the results from the threads and report them in order (each thread could allocate memory to return its results and return a pointer to the parent, or the parent could assign each thread a buffer)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563397744, "post_id": 57083574, "comment_id": 100691253, "body": "The 10,000th prime is 104,729, whereas there are 1,229 primes less than 10,000 (the last is 9,973)."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1563400029, "post_id": 57083574, "comment_id": 100692021, "body": "@ggorlen the Sieve of Eratosthenes is indeed a good way to identify primes, much more efficient than the OP&#39;s approach, but it parallelizes very poorly because of its extensive data dependencies."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1563400755, "post_id": 57083574, "comment_id": 100692202, "body": "Yeah, intuitively it doesn&#39;t feel very parallelizable, but the link I posted shows an impressive 25x speed increase with parallel SOE over a poor implementation. I didn&#39;t read it in detail, so there might be other non-MT reasons for the increase. Either way, it probably doesn&#39;t matter since it sounds like primes are incidental to the program and OP just is calling function X from N threads and printing some ordered results."}], "answers": [{"tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": false, "score": 0, "last_activity_date": 1567720302, "creation_date": 1567720302, "answer_id": 57813393, "question_id": 57083574, "link": "https://stackoverflow.com/questions/57083574/how-to-print-result-in-order-even-if-using-threads-in-c/57813393#57813393", "title": "How to print result in order even if using threads in c?", "body": "<p>Get rid of your threads and just optimize your <code>is_prime</code> function. If you're trying to print out every single prime you've found, the printing is going to be a significant fraction of the work you're doing and that won't parallelize at all, so why bother with the threads?</p>\n"}], "owner": {"reputation": 144, "user_id": 11799423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oC2OYl-Wh68/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfZa_6JPo3sasvkyRLJr4VR73qvdA/photo.jpg?sz=128", "display_name": "Bob Rob", "link": "https://stackoverflow.com/users/11799423/bob-rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567720302, "creation_date": 1563394853, "last_edit_date": 1567707522, "question_id": 57083574, "link": "https://stackoverflow.com/questions/57083574/how-to-print-result-in-order-even-if-using-threads-in-c", "title": "How to print result in order even if using threads in c?", "body": "<p>I need to fine the first 10000 prime numbers using six threads and print them in order. How can i improve my solution?</p>\n\n<pre><code>#define N 6\n#define S 10000\n\nint a[S] = {0};\n\nint is_prime(int n){\n  int k;\n  if(n == 2)\n    return 1;\n  for (int i = 2; i&lt;n; i++){\n    k = n%i;\n    if(k == 0)\n      return 0;\n  }\n  return 1;\n}\n\nvoid* prime_number(void* arg){\n  int num = (int *) arg;\n  for(int i = (S/N)*num; i&lt;(S/N)*(num+1) &amp;&amp; i&lt;S; i++){\n    if(is_prime(i))\n      a[i] = i;\n  }\n  pthread_exit(NULL);\n}\n\nint main(int argc, char const *argv[]) {\n  pthread_t *th;\n  th = malloc(sizeof(pthread_t)*N);\n  for(int i = 0; i&lt;N; i++){\n    pthread_create(&amp;th[i], NULL, prime_number, i);\n  }\n  for(int i = 0; i&lt;N; i++){\n    pthread_join(th[i], NULL);\n  }\n  for(int i = 0; i&lt;S; i++){\n    if(a[i] != 0)\n      printf(\"%d \", a[i]);\n  }\n\n  printf(\"\\n\");\n  free(th);\n  return 0;\n}\n</code></pre>\n\n<p>In my solution I save everything in the a array and then I print it. Is there a better way to calculate if a number is prime and, if so, print it without save it in the array?</p>\n\n<p>I need to print the numbers in order.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1563395618, "post_id": 57083259, "comment_id": 100690498, "body": "I get the a-circumflex, &quot;&#226;&#226;&#226;&#226;...&quot;, instead of the box, but it looks almost correct."}, {"owner": {"reputation": 25, "user_id": 10904656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtBL4.jpg?s=128&g=1", "display_name": "Ido G", "link": "https://stackoverflow.com/users/10904656/ido-g"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1563395983, "post_id": 57083259, "comment_id": 100690631, "body": "@NeilEdelman I think you should try fill the empty quotes of setlocale with: &quot;en_US.UTF-8&quot; the should specify you want the us utf-8 settings"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1563396271, "post_id": 57083259, "comment_id": 100690751, "body": "That didn&#39;t do anything, but commenting <code>setlocal</code> out seems to draw the pipes correctly. There&#39;s one too-many <code>\\n</code> before your bottom line."}, {"owner": {"reputation": 15569, "user_id": 2302862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e264db339bb96e343770fa38018e00f1?s=128&d=identicon&r=PG", "display_name": "Siguza", "link": "https://stackoverflow.com/users/2302862/siguza"}, "edited": false, "score": 0, "creation_date": 1563396688, "post_id": 57083259, "comment_id": 100690874, "body": "Works out of the box for me on macOS 10.12.6 (minus the messed up newline). However it also works if I remove the <code>setlocale</code>, change <code>wprintf</code> to <code>printf</code>, and drop the <code>L</code> prefix from the strings."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1563396691, "post_id": 57083259, "comment_id": 100690877, "body": "Exchanging the <code>putchar</code> and the <code>DrawDownLine</code> at the end of <code>DrawFrame</code> worked. I suspect it works on <code>wprintf</code> or <code>printf</code>."}, {"owner": {"reputation": 30170, "user_id": 5231607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QzGsq.jpg?s=128&g=1", "display_name": "1201ProgramAlarm", "link": "https://stackoverflow.com/users/5231607/1201programalarm"}, "edited": false, "score": 3, "creation_date": 1563396807, "post_id": 57083259, "comment_id": 100690920, "body": "This could be because you&#39;re mixing wide character output (<code>wprintf</code>) with narrow character output (<code>putchar</code>).  Does changing the putchar calls to <code>putwchar(L&#39;\\n&#39;);</code> make any difference?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1563397153, "post_id": 57083259, "comment_id": 100691033, "body": "You should only call <code>setlocale()</code> once, and that is most sensibly done at the start of <code>main()</code>.  However, that is mostly an optimization.  Calling it multiple times with the same arguments should only (at worst) cost the time taken to reread the locale; at best, the code compares the requested locale with the current local and decides there&#39;s no change and returns."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1563403678, "post_id": 57083259, "comment_id": 100692868, "body": "Which compiler and operating system are you using? Support for wprintf varies, and the source encoding matters too, you might find that <code>&quot;\u2551&quot;</code> becomes narrow char <code>0xBA</code>  for example.  It&#39;s more portable to stick to the basic character set for source code, and use unicode sequences like <code>\\u2551</code>"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 4, "last_activity_date": 1563399402, "last_edit_date": 1563399402, "creation_date": 1563398763, "answer_id": 57084256, "question_id": 57083259, "link": "https://stackoverflow.com/questions/57083259/weird-space-when-using-wide-characters-in-c/57084256#57084256", "title": "Weird space when using wide characters in c", "body": "<blockquote>\n  <p>Also as you can see I don't understand the correct use of setlocale, do you need to do it only once? or more?</p>\n</blockquote>\n\n<p>Locale changes applied via <code>setlocale()</code> are persistent within the calling process.  You do not need to call that function multiple times unless you want to make multiple changes.  But you <em>do</em> need to name a locale to it that serves your intended purpose, or if you call it with an empty string then you or the program user does need to ensure that the environment variables that define the various locale categories are set to values that suit the purpose.</p>\n\n<blockquote>\n  <p>But when I am running this code with some int values I get an output\n  with seemingly random spaces and newlines.</p>\n</blockquote>\n\n<p><strong>That sounds like the result of a character-encoding mismatch</strong>, or even two (but see also below):</p>\n\n<ul>\n<li>there can be a runtime mismatch because the locale you tell the program to use for output does not match the one expected by the output device (<em>e.g.</em> a terminal) with which the program's output is displayed, and</li>\n<li>there can also be a compile time mismatch between the actual character encoding of your source file and the encoding the compiler interprets it as having.</li>\n</ul>\n\n<p>Additionally, use of wide string literal syntax notwithstanding, it is implementation-dependent which characters other than C's basic set may appear in your source code.  The wide syntax specifies mostly the form of the storage for the literal (elements of type <code>wchar_t</code>), not so much what character values are valid or how they are interpreted.</p>\n\n<p>Note also that the width of <code>wchar_t</code> is implementation-dependent, and it can be as small as eight bits.  It is not necessarily the case that a <code>wchar_t</code> can represent arbitrary Unicode characters -- in fact, it is pretty common for <code>wchar_t</code> to be 16 bits wide, which in fact <em>isn't</em> wide enough for the majority of characters from Unicode's 21-bit code space.  You might get an internal representation of wider characters in a two-unit form, such as a UTF-16 surrogate pair, but you also might not -- a great deal of this is left to individual implementations.</p>\n\n<p>Among those things, what encoding the compiler expects, under what circumstances, and how you can influence that are all implementation-dependent.  For GCC, for instance, the default source (\"input\") character set is UTF-8, and you can define a different one via its <code>-finput-charset</code> option.  You can also specify both a standard and a wide execution character set via the <code>-fexec-charset</code> and <code>-fwide-exec-charset</code> options, if you wish to do so.  GCC relies on <code>iconv</code> for conversions, both at compile time (source charset to execution charset) and at runtime (from execution charset to locale charset).  Other implementations have other options (or none), with their own semantics.</p>\n\n<p><strong>So what should you do?</strong>  In the first place, I suggest taking the source character set out of the equation by using UTF-8 string literals expressed using only basic character set (requires C2011):</p>\n\n<pre><code>#define VERTICAL_PIPE     u8\"\\xe2\\x95\\x91\"\n#define HORIZONTAL_PIPE   u8\"\\xe2\\x95\\x90\"\n#define UP_RIGHT_CORNER   u8\"\\xe2\\x95\\x97\"\n#define UP_LEFT_CORNER    u8\"\\xe2\\x95\\x94\"\n#define DOWN_RIGHT_CORNER u8\"\\xe2\\x95\\x9d\"\n#define DOWN_LEFT_CORNER  u8\"\\xe2\\x95\\x9a\"\n</code></pre>\n\n<p>Note well that the resulting strings are normal, not wide, so you should not use the wide-oriented output functions with them.  Instead, use the normal <code>printf</code>, <code>putchar</code>, <em>etc.</em>.</p>\n\n<p>And that brings us to another issue with your code: <strong>you must not mix wide-oriented and byte-oriented functions writing to the same stream</strong> without taking explicit measures to switch (<code>freopen</code> or <code>fwide</code>; see <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.2p4\" rel=\"nofollow noreferrer\">paragraph 7.21.2/4</a> of the standard).  In practice, mixing the two can quite plausibly produce mangled results.</p>\n\n<p>Then also ensure that your local environment variables are set correctly for your actual environment.  Chances are good that they already are, but it's worth a check.</p>\n"}], "owner": {"reputation": 25, "user_id": 10904656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtBL4.jpg?s=128&g=1", "display_name": "Ido G", "link": "https://stackoverflow.com/users/10904656/ido-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "accepted_answer_id": 57084256, "answer_count": 1, "score": 2, "last_activity_date": 1563399402, "creation_date": 1563393370, "last_edit_date": 1563396052, "question_id": 57083259, "link": "https://stackoverflow.com/questions/57083259/weird-space-when-using-wide-characters-in-c", "title": "Weird space when using wide characters in c", "body": "<p>I am trying to draw a square with a given width and height.\nI am trying to do so while using the box characters from Unicode.\nI am using this code:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;locale.h&gt;\n\n#include \"string_prints.h\"\n\n#define VERTICAL_PIPE L\"\u2551\"\n#define HORIZONTAL_PIPE L\"\u2550\"\n#define UP_RIGHT_CORNER L\"\u2557\"\n#define UP_LEFT_CORNER L\"\u2554\"\n#define DOWN_RIGHT_CORNER L\"\u255d\"\n#define DOWN_LEFT_CORNER L\"\u255a\"\n\n// Function to print the top line\nvoid DrawUpLine(int w){\n    setlocale(LC_ALL, \"\");\n    wprintf(UP_LEFT_CORNER);\n    for (int i = 0; i &lt; w; i++)\n    {\n        wprintf(HORIZONTAL_PIPE);\n    }\n    wprintf(UP_RIGHT_CORNER);\n}\n\n// Function to print the sides\nvoid DrawSides(int w, int h){\n    setlocale(LC_ALL, \"\");\n    for (int i = 0; i &lt; h; i++)\n    {\n        wprintf(VERTICAL_PIPE);\n        for (int j = 0; j &lt; w; j++)\n        {\n            putchar(' ');\n        }\n        wprintf(VERTICAL_PIPE);\n        putchar('\\n');\n    }\n}\n\n// Function to print the bottom line\nvoid DrawDownLine(int w){\n    setlocale(LC_ALL, \"\");\n    wprintf(DOWN_LEFT_CORNER);\n    for (int i = 0; i &lt; w; i++)\n    {\n        wprintf(HORIZONTAL_PIPE);\n    }\n    wprintf(DOWN_RIGHT_CORNER);\n}\n\nvoid DrawFrame(int w, int h){\n    DrawUpLine(w);\n    putchar('\\n');\n    DrawSides(w, h);\n    putchar('\\n');\n    DrawDownLine(w);\n}\n</code></pre>\n\n<p>But when I am running this code with some int values I get an output with seemingly random spaces and newlines (although the pipes seem at the correct order).</p>\n\n<p>It is being called from main.c from the header like so:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;locale.h&gt;\n\n#include \"string_prints.h\"\n\nint main(){\n    DrawFrame(10, 20); // Calling the function\n    return 0;\n}\n</code></pre>\n\n<p>Also as you can see I don't understand the correct use of setlocale, do you need to do it only once? or more?</p>\n\n<p>Any help appreciated thanks in advance!</p>\n"}, {"tags": ["c", "arrays", "struct", "initialization", "initializer-list"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563391830, "post_id": 57082904, "comment_id": 100688806, "body": "<code>A_ a = {.a = b};</code> works for me."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563391905, "post_id": 57082904, "comment_id": 100688839, "body": "Actually no. It compiles, but does not work."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563391910, "post_id": 57082904, "comment_id": 100688842, "body": "@EugeneSh.: I doubt it. Can you show an example with Godbolt?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1563391957, "post_id": 57082904, "comment_id": 100688856, "body": "@EricPostpischil You are right, added another comment just before yours. Not sure what it does...<a href=\"https://ideone.com/k2xOIj\" rel=\"nofollow noreferrer\">ideone.com/k2xOIj</a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563393145, "post_id": 57082904, "comment_id": 100689391, "body": "@EugeneSh.: It does exactly what the message shown in the question says it does: Make an integer from a pointer without a cast. The grammar makes <code>b</code> an <i>assignment-expression</i>, so it is converted to a pointer to its first element, and that is used to initialize the first <code>int</code> in <code>a.a</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1563393206, "post_id": 57082904, "comment_id": 100689422, "body": "@EricPostpischil Got it, thanks"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1563409048, "post_id": 57082904, "comment_id": 100693989, "body": "Try <code>int main() {     unsigned int b[4] = {1,2,3,4};     A_ a = {{b[0], b[1], b[2], b[3]}};     printf(&quot;%d\\n&quot;, a.a[0]); }</code> to <i>Initialize a struct with previous declared array</i>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563410218, "post_id": 57082904, "comment_id": 100694190, "body": "@EugeneSh. the code is erroneous; but, for unclear reasons, gcc categorizes the mistake as a warning, and ideone.com suppresses gcc warnings"}, {"owner": {"reputation": 5009, "user_id": 1455108, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/zaRtd.jpg?s=128&g=1", "display_name": "Jo&#227;o Paulo", "link": "https://stackoverflow.com/users/1455108/jo%c3%a3o-paulo"}, "edited": false, "score": 0, "creation_date": 1563415366, "post_id": 57082904, "comment_id": 100695073, "body": "I think gcc categorizes as a warning because we can convert int to almost anything. I believe that if I change to double, I would get an error..."}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1563392163, "creation_date": 1563392163, "answer_id": 57083019, "question_id": 57082904, "link": "https://stackoverflow.com/questions/57082904/initialize-a-struct-with-previous-declared-array/57083019#57083019", "title": "Initialize a struct with previous declared array", "body": "<p>Standard C does not provide any mechanism to initialize a structure member with an array, except for initializing arrays with string literals.</p>\n\n<p>Instead, you can initialize the structure with a structure. Assuming the values you want to use are known when the code is written, the latter structure can also be made <code>static const</code>:</p>\n\n<pre><code>int main(void)\n{\n    static const A_ InitialStructure = {{ 1, 2, 3, 4 }};\n    A_ a = InitialStructure;\n}\n</code></pre>\n"}], "owner": {"reputation": 5009, "user_id": 1455108, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/zaRtd.jpg?s=128&g=1", "display_name": "Jo&#227;o Paulo", "link": "https://stackoverflow.com/users/1455108/jo%c3%a3o-paulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 57083019, "answer_count": 1, "score": 1, "last_activity_date": 1563392163, "creation_date": 1563391583, "question_id": 57082904, "link": "https://stackoverflow.com/questions/57082904/initialize-a-struct-with-previous-declared-array", "title": "Initialize a struct with previous declared array", "body": "<p>I have the following situation:</p>\n\n<pre><code>typedef struct A {\n    unsigned int a[4];\n} A_;\n\nint main() {\n    unsigned int b[4] = {1,2,3,4};\n    A_ a = {b};\n}\n</code></pre>\n\n<p>This is making me get the following warning:</p>\n\n<blockquote>\n  <p>warning: initialization of 'unsigned int' from 'unsigned int *' makes\n  integer from pointer without a cast</p>\n</blockquote>\n\n<p>But making this <code>A_ a = {{1,2,3,4}};</code> is ok. Why?</p>\n"}, {"tags": ["c", "gcc", "cmake"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1563399805, "post_id": 57082513, "comment_id": 100691950, "body": "<b>Absence</b> of <code>CMAKE_BUILD_TYPE</code> variable setting doesn&#39;t imply <code>Debug</code> build. The project may program setting build type by default, but if it does not do that, then the build type is &quot;none&quot;, and <b>no specific flags</b> are applied."}], "answers": [{"comments": [{"owner": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "edited": false, "score": 0, "creation_date": 1563390492, "post_id": 57082648, "comment_id": 100688236, "body": "How can tell gcc to never auto-initialize variables?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "edited": false, "score": 0, "creation_date": 1563390667, "post_id": 57082648, "comment_id": 100688306, "body": "@Dan: It&#39;s not auto-initializing variables. What makes you think it is? The problem is that the compiler passes needed for analysis of program flow, to determine if the variable is uninitialized at the time of access, only happen as part of optimization. &quot;Non-optimizing mode&quot; is a very <i>unnatural</i> thing for a modern compiler, and lacks the capability to do any useful analysis."}, {"owner": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "edited": false, "score": 0, "creation_date": 1563390866, "post_id": 57082648, "comment_id": 100688398, "body": "I&#39;m using std c99, as far as I understand, when using this standard, it initializes local variables to 0 (except in release mode it seems)"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "edited": false, "score": 1, "creation_date": 1563392279, "post_id": 57082648, "comment_id": 100688997, "body": "@Dan: No. That&#39;s just what happens to be present in the memory that they occupy. They are not initialized."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1563399928, "post_id": 57082648, "comment_id": 100691986, "body": "&quot;... disables optimization, which prevents the compiler passes that perform transformations and static analysis needed to determine that a variable is used uninitialized from ever happening.&quot; - Are you sure about that? As far as I know, optimization (<code>-O&lt;something&gt;</code>) and warnings options (<code>-W&lt;something&gt;</code>) are completely <b>independent</b>."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1563400068, "post_id": 57082648, "comment_id": 100692033, "body": "@Tsyvarev: Yes. They&#39;re not completely independent. Some of them, especially this one which is heuristic and not precise, are only triggered during analysis that&#39;s performed for optimization purposes. In principle you could do the same analysis then throw it away in non-optimizing configuration, but GCC&#39;s architecture is not really designed to do that."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1563403327, "post_id": 57082648, "comment_id": 100692793, "body": "Hm, when I enable, say <code>-Werror=maybe-uninitialized</code> option, I expect the errors found to be the <b>same</b> whenever it is optimized or non-optimized build. From my opinion it is <code>gcc</code> who should enable needed analysis when it sees that option."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1563405955, "post_id": 57082648, "comment_id": 100693400, "body": "@Tsyvarev: Well it doesn&#39;t, and this is documented somewhere. <code>-O0</code> really just <b>should not be used</b>. Until CMake made it a thing again, almost nobody was using it."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1563407982, "post_id": 57082648, "comment_id": 100693792, "body": "OK, I have found some other questions about <code>-Werror=maybe-uninitialized</code> and optimization switches, like this one: <a href=\"https://stackoverflow.com/questions/47307538/why-gcc-does-not-report-uninitialized-variable\" title=\"why gcc does not report uninitialized variable\">stackoverflow.com/questions/47307538/&hellip;</a>."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 2, "last_activity_date": 1563390378, "creation_date": 1563390378, "answer_id": 57082648, "question_id": 57082513, "link": "https://stackoverflow.com/questions/57082513/gcc-warnings-not-detected-in-cmake-debug-builds-but-detected-in-release-ones/57082648#57082648", "title": "GCC warnings not detected in cmake debug builds, but detected in release ones", "body": "<p>CMake's default/\"debug\" build profile entirely disables optimization, which prevents the compiler passes that perform transformations and static analysis needed to determine that a variable is used uninitialized from ever happening. While to some extent this improves debugging experience with single-step of source lines, as you've found it hides warnings and also tends to hide consequences of undefined behavior in your code.</p>\n\n<p>Traditionally \"disable optimizations entirely for non-release builds\" has not been a thing among unix-oriented developers. It's a carry-over from common practice in the MSVC world that's reflective of CMake's origins and user base.</p>\n"}], "owner": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 57082648, "answer_count": 1, "score": 1, "last_activity_date": 1563390378, "creation_date": 1563389692, "question_id": 57082513, "link": "https://stackoverflow.com/questions/57082513/gcc-warnings-not-detected-in-cmake-debug-builds-but-detected-in-release-ones", "title": "GCC warnings not detected in cmake debug builds, but detected in release ones", "body": "<p>I have a <code>cmake</code>/<code>gcc</code> project in which I have enabled several warnings and the flag <code>-Werror</code>.</p>\n\n<p>I have noticed that some warnings are detected when I use the <code>cmake</code> flag <code>-DCMAKE_BUILD_TYPE=Release</code>, but they are not when I don't apply the above <code>cmake</code> flag. <strong>For example, one of these warnings is:</strong></p>\n\n<pre><code>error: \u2018var_name\u2019 may be used uninitialized in this function [-Werror=maybe-uninitialized]\n</code></pre>\n\n<p>I have read here: <a href=\"https://stackoverflow.com/questions/10085945/set-cflags-and-cxxflags-options-using-cmake\">Set CFLAGS and CXXFLAGS options using CMake</a> that there are several <code>CMAKE_C_FLAGS</code> variables for different build types, for instance, <code>CMAKE_C_FLAGS_RELEASE</code>. </p>\n\n<p>I have tried to apply those variables for release and debug builds, but this time none of the above detect the warnings I'm expecting.</p>\n\n<p><strong>What I'm missing?</strong></p>\n"}, {"tags": ["c", "embedded", "doxygen"], "comments": [{"owner": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1563438962, "post_id": 57082281, "comment_id": 100702698, "body": "As afar as I know this is a newer functionality of c++ (I don&#39;t know when it was introduced, might already be a few year ago), that has not, yet, been build-in into doxygen. Maybe best to check and when necessary create an issue in the doxygen issue tracker (<a href=\"https://github.com/doxygen/doxygen/issues\" rel=\"nofollow noreferrer\">github.com/doxygen/doxygen/issues</a>)."}, {"owner": {"reputation": 742, "user_id": 6271889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f217c1e060d40fca9e619528ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6271889/leonardo"}, "reply_to_user": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1563479140, "post_id": 57082281, "comment_id": 100724301, "body": "OK, that was what I was afraid of. Just a heads up, I don&#39;t think this is a standard C++ functionality, it&#39;s a directive com the Chess compiler from Synopsys. Cheers!"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1564143831, "post_id": 57082281, "comment_id": 100944171, "body": "<code>chess_storage(x)</code> might as well be a preprocessor macro with an argument."}], "owner": {"reputation": 742, "user_id": 6271889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39d2f217c1e060d40fca9e619528ec4e?s=128&d=identicon&r=PG&f=1", "display_name": "Leonardo", "link": "https://stackoverflow.com/users/6271889/leonardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563545591, "creation_date": 1563388563, "last_edit_date": 1563545591, "question_id": 57082281, "link": "https://stackoverflow.com/questions/57082281/doxygen-and-c-function-name-with-modifiers", "title": "Doxygen and C function name with modifiers", "body": "<p>I'm documenting some embedded C code and some functions have storage modifiers that are specific to the compiler, like so:</p>\n\n<pre><code>int chess_storage(x0) firmware_function(unsigned long int chess_storage(a0) param)\n</code></pre>\n\n<p>Because the directive has a parameter, Doxygens interprets the directive as the function name.</p>\n\n<p>The usual solution would be to use <code>PREDEFINED</code> directive in the Doxyfile as explained in the <a href=\"http://www.doxygen.nl/manual/preprocessing.html\" rel=\"nofollow noreferrer\">Doxygen Manual:Preprocessing</a> and this <a href=\"http://doxygen.10944.n7.nabble.com/Is-it-possible-to-force-doxygen-to-ignore-compiler-specific-keywords-td2857.html\" rel=\"nofollow noreferrer\">mail list post</a> to completely ignore the storage modifier:</p>\n\n<pre><code>PREDEFINED             = chess_storage(x)=\n</code></pre>\n\n<p>The problem with this approach is that the documentation would not be accurate, as the actual function does have that modifier. </p>\n\n<p>I've also tried to use <code>@fn</code>, but it didn't work either.</p>\n\n<pre><code>/**\n * @fn int firmware_function(unsigned long int param);\n *\n * A C function with a modifier\n *\n * @param param A parameter\n * @return zero.\n */\nint chess_storage(x0) firmware_function(unsigned long int chess_storage(a0) param);\n</code></pre>\n\n<p>So the goal here is not to ignore the parameter, but make Doxygen aware that it's just a word.</p>\n"}, {"tags": ["c", "linux", "string", "file"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1563388126, "post_id": 57082143, "comment_id": 100687155, "body": "<code>if (strcmp(fixed_str,line))==0)</code> - this can&#39;t compile. There are two <code>(</code>s and three <code>)</code>s."}, {"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 1, "creation_date": 1563388237, "post_id": 57082143, "comment_id": 100687229, "body": "Show us your <code>strncmp</code> attempt."}, {"owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563388242, "post_id": 57082143, "comment_id": 100687231, "body": "If you make the correction @EugeneSh. recommended and use strncmp it should work"}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "edited": false, "score": 0, "creation_date": 1563388678, "post_id": 57082143, "comment_id": 100687411, "body": "No compiling is correct this is typo i was using strncmp i changed the code here to simpify the case ..... sorry for that i correct it"}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "reply_to_user": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "edited": false, "score": 0, "creation_date": 1563388858, "post_id": 57082143, "comment_id": 100687485, "body": "@ZacharyOldham strncmp is not working as mentioned in the OP"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1563388994, "post_id": 57082143, "comment_id": 100687544, "body": "@incompetent Replace <code>printf(&quot;%s&quot;, line);</code> with <code>printf(&quot;&lt;%s&gt;&quot;, line);</code> and look closely at the output. Also show us a minimal <code>test.txt</code> file that reproduces the problem-"}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1563389479, "post_id": 57082143, "comment_id": 100687777, "body": "@Jabberwocky oops &lt;%s&gt; is not printing the &gt; on the same line! what should I do please?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1563389531, "post_id": 57082143, "comment_id": 100687806, "body": "@incompetent read the docs of <code>getline</code> carefully and/or apply Cliffords answer below."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1563391479, "post_id": 57082143, "comment_id": 100688650, "body": "Whoa there ... <i>&quot;In my actual program...&quot;</i>  - OK, but does <i>this</i> code exhibit the same problem?  The way you read the input could change the result entirely depending on the semantics of the input method.  Your <i>actual</i> code may be exhibiting a different problem entirely - just with the same observable  symptoms.  You should at least post a fragment showing how you are taking input and what the input file contains - or better, just talk about this code, and post a different question if the solution to this does not work with the &quot;real&quot; code."}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1563391993, "post_id": 57082143, "comment_id": 100688874, "body": "Yes @Clifford I am new to C programming so I have divided my problem statement in smaller challenges like reading from file per line, comparing with some string with each line of the file then getting the both strings from text file and further use binary files with struct."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1563390490, "post_id": 57082429, "comment_id": 100688235, "body": "Note, the same thing happens with <code>fgets</code>. Please see <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input/28462221#28462221\">Removing trailing newline character from fgets() input</a>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "edited": false, "score": 1, "creation_date": 1563390808, "post_id": 57082429, "comment_id": 100688373, "body": "@incompetent : Note that further problems can be encountered if the file has alternative line termination such as <code>\\r</code> (CR) or <code>\\r\\n</code> (CR+LF) - if you need to permit this (for example if the text file might be prepared on a Windows system), you&#39;ll need additional <code>line</code> processing."}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "edited": false, "score": 0, "creation_date": 1563390983, "post_id": 57082429, "comment_id": 100688428, "body": "My file is created on Linux but one uncertainty is that fixed_str will be taken from another file. Is there any advice or caution for this case?"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "edited": false, "score": 1, "creation_date": 1563392146, "post_id": 57082429, "comment_id": 100688951, "body": "@incompetent : Yes per my comment on the question, the problem may change entirely depending on how you are reading the input, and the input file content.  For example if your <code>fixed_str</code> input also uses <code>getline()</code> the input may or may not have a newline in the same way.  I&#39;d probably use <code>strpbrk()</code> on <i>both</i> strings using <code>&quot;\\r\\n&quot;</code> as the delimiters and replacing them with <code>\\0</code> to be text file type and input method agnostic."}, {"owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "edited": false, "score": 0, "creation_date": 1563392632, "post_id": 57082429, "comment_id": 100689150, "body": "Thanks I will come with new question if any new complication arises but I am hopeful I will handle these complications after your such nice guidance"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "edited": false, "score": 1, "creation_date": 1563392833, "post_id": 57082429, "comment_id": 100689241, "body": "@incompetent : I have added to the answer to cover the possibility of input from different sources or input methods with ambiguous line ends."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563393656, "post_id": 57082429, "comment_id": 100689634, "body": "<code>line[ strcspn( line, &quot;\\r\\n&quot; ) ] = &#39;\\0&#39;;</code> will strip both trailing <code>&quot;\\n&quot;</code> and trailing <code>&quot;\\r\\n&quot;</code>.  (And single or repeated <code>&quot;\\r&quot;</code>...)"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563394619, "post_id": 57082429, "comment_id": 100690055, "body": "@AndrewHenle - good point, mind if I use that?  The problem with a single <code>\\r</code> is <code>getline()</code> looks for <code>\\n</code>, so if you have say <code>xxxxx\\ryyyyyy\\n</code>, the <code>yyyyyy</code> will be ignored.  I have not solved that issue, merely decided not claim it was supported by the solution."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563394744, "post_id": 57082429, "comment_id": 100690112, "body": "@Clifford Yes, the embedded <code>\\r</code> might be a problem depending on the input. Use it all you want - it&#39;s not like I own the rights to <code>strcspn()</code>.  ;-)"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1563395089, "post_id": 57082429, "comment_id": 100690249, "body": "I did not want to steal the (better) idea if you were perhaps going to post an answer of your own.  Added - with credit note."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": true, "score": 5, "last_activity_date": 1563394854, "last_edit_date": 1563394854, "creation_date": 1563389300, "answer_id": 57082429, "question_id": 57082143, "link": "https://stackoverflow.com/questions/57082143/c-strings-string-comparisons-always-result-in-false/57082429#57082429", "title": "C strings string comparisons always result in false", "body": "<p>From the <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\"><code>getline()</code> man page</a> (my <strong><em>emphasis</em></strong>):</p>\n\n<blockquote>\n  <p>getline() reads an entire line from stream, storing the address of\n         the buffer containing the text into *lineptr.  The buffer is null-\n         terminated and <strong><em>includes the newline character</em></strong>, if one was found.</p>\n</blockquote>\n\n<p>Your <code>fixed_str</code> has no newline.</p>\n\n<p>Strip any newline character thus (for example):</p>\n\n<pre><code>char* nl = strrchr( line, '\\n' ) ;\nif(nl != NULL) *nl = `\\0` ;\n</code></pre>\n\n<p>Or more efficiently since <code>getline()</code> returns the line length (in <code>read</code> in your case):</p>\n\n<pre><code>if(line[read - 1] == '\\n' ) line[read - 1] = `\\0` ;\n</code></pre>\n\n<p>Adding a <code>'\\n'</code> to <code>fixed_str</code> may seem simpler, but is not a good idea because the last (or only) line in a file won't have one but may otherwise be a match.</p>\n\n<p>Using <code>strncmp()</code> as described in your question should have worked, but without seeing the attempt it is hard to comment, but it is in any case a flawed solution since it would match <em>all</em> of the following for example:</p>\n\n<pre><code>testline4\ntestline4 and some more\ntestline4 12345.\n</code></pre>\n\n<p>Where <code>fixed_str</code> is taken from console or file input rather than a constant, the input method and data source may cause problems, as may the possibility of alternate line-end conventions.  To make it more robust you might do:</p>\n\n<pre><code>// Strip any LF or CR+LF line end from fixed_str\nchar* line_end = strpbrk( fixed_str, \"\\r\\n\" ) ;\nif( line_end != NULL ) *line_end = '\\0' ;  \n\n// Strip any LF or CR+LF line end from line\nline_end = strpbrk( line, \"\\r\\n\" ) ;\nif( line_end != NULL ) *line_end = '\\0' ;  \n</code></pre>\n\n<p>Or the simpler (i.e. better) solution pointed out by @AndrewHenle:</p>\n\n<pre><code>// Strip any LF or CR+LF line end from fixed_str\nfixed_str[strcspn(line, \"\\r\\n\")] = '\\0';\n\n// Strip any LF or CR+LF line end from line\nline[strcspn(line, \"\\r\\n\")] = '\\0';\n</code></pre>\n\n<p>That way either input can be compared regardless of lines ending in nothing, CR or CR+LF and the line end may even differ between the two inputs.</p>\n"}], "owner": {"reputation": 1497, "user_id": 4843379, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a3681737b6e2ecc037c83474eed2309c?s=128&d=identicon&r=PG&f=1", "display_name": "incompetent", "link": "https://stackoverflow.com/users/4843379/incompetent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 57082429, "answer_count": 1, "score": 0, "last_activity_date": 1563394854, "creation_date": 1563387862, "last_edit_date": 1563390284, "question_id": 57082143, "link": "https://stackoverflow.com/questions/57082143/c-strings-string-comparisons-always-result-in-false", "title": "C strings string comparisons always result in false", "body": "<p>I am trying to finding a string in a file. I wrote following by modifying code snippet present in man page of <code>getline</code>.</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    FILE * fp;\n    char * line = NULL;\n    char *fixed_str = \"testline4\";\n    size_t len = 0;\n    ssize_t read;\n\n    fp = fopen(\"test.txt\", \"r\");\n    if (fp == NULL)\n        exit(EXIT_FAILURE);\n\n    while ((read = getline(&amp;line, &amp;len, fp)) != -1) {\n        printf(\"Retrieved line of length %zu:\\n\", read);\n        printf(\"%s\", line);\n\n        if (strcmp(fixed_str,line)==0)\n            printf(\"the match is found\\n\");\n    }\n    //printf(\"the len of string is %zu\\n\", strlen(fixed_str));\n\n    fclose(fp);\n    if (line)\n        free(line);\n    exit(EXIT_SUCCESS);\n} \n</code></pre>\n\n<p>The problem is that result of strcmp is always false despite getline is successfully and correctly iterating over all lines in the file. \nThe length of fixed_str is 9 and that of equal string in file is 10 due to newline character (AM I RIGHT?). But comparing 9 chars with the help of <code>strncmp</code> still produces wrong result. I also ruled out the possibilities of caps and spaces so I think I am doing something very wrong</p>\n\n<p>The test.txt is as below</p>\n\n<pre><code>test line1\ntest line2\ntest line3\ntestline4\nstring1\nstring2\nstring3\nfirst name\n</code></pre>\n\n<p>I tried all entries but no success</p>\n\n<p><strong>NOTE:</strong> In my actual program I have to read <code>fixed_str</code> from another file</p>\n"}, {"tags": ["c", "multithreading", "unix", "server", "posix"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1563387990, "post_id": 57082019, "comment_id": 100687096, "body": "There is a wall of code there. An observation: &quot;there might be a handful of other bugs&quot; so the reason for misbehaviour can be <i>anything</i>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563388201, "post_id": 57082019, "comment_id": 100687197, "body": "Regarding <code>fflush(stdout); &#47;&#47;For unknown reason this is needed.</code> That&#39;s to ensure the output is sent when you are debugging, since the preceding output does not send a newline. When a program terminates unexpectedly, buffered output is lost."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563388566, "post_id": 57082019, "comment_id": 100687359, "body": "Oops that first big code block is copy/paste error anyway, stopping mid-flow and continuing with what was already there, so two <code>main</code> functions for example."}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563388618, "post_id": 57082019, "comment_id": 100687379, "body": "No, the bug cannot be anything. There might be other bugs with other symptoms, but there is only one bug causing this behavior  Thank you for your info about fflush."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1563388668, "post_id": 57082019, "comment_id": 100687402, "body": "What I mean, is that you think there are bugs in the code, their <i>result</i> can be anything. If you don&#39;t know what is wrong, how do you know there is &quot;only one bug&quot; when you already said there are more?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563388767, "post_id": 57082019, "comment_id": 100687445, "body": "This isn&#39;t your own code?"}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563388926, "post_id": 57082019, "comment_id": 100687509, "body": "It is my own code. (95% of it)  What I mean with &quot;there might be other bugs&quot;. There might be other results which are not wished, but I have not discovered them yet.  I have fixed the twice copied code. Thank you!"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563389353, "post_id": 57082019, "comment_id": 100687724, "body": "There is way too much code here for us to be able to help. Trim it down to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\"><i>minimal</i> example</a> so we can actually understand the issue. Note that the process of trimming down your code often exposes the error by reducing complexity."}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563389451, "post_id": 57082019, "comment_id": 100687760, "body": "That is it. I tried that. But how do I trim it down when all the other junk is there. I will try again and edit my answer then!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563389457, "post_id": 57082019, "comment_id": 100687763, "body": "If you close by closing the terminal is that an unexpected exit? If so, where does <code>pjob_data-&gt;end_of_program</code> get set, on which the loop <code>while(!pjob_data-&gt;end_of_program)</code> depends?"}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563389740, "post_id": 57082019, "comment_id": 100687907, "body": "Yes; closing the terminal is an unexpected scenario. But it is not the end_of_program since there might be other clients. If the connection is closed, the process is supposed to exit the thread. (see &#39;if(n == 0){}&#39;"}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563390072, "post_id": 57082019, "comment_id": 100688061, "body": "@tadman Edit That is it. I tried that. But how do I trim it down when all the other junk is needed. I will try again and edit my answer then! \u2013 Niclas Schwalbe 9 mins ago"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563390253, "post_id": 57082019, "comment_id": 100688134, "body": "Most people here are prepared to spend, at most, five minutes helping you with a problem. If this really can&#39;t be trimmed down due to complexity and it will take longer to review, consider services like <a href=\"https://www.codementor.io\" rel=\"nofollow noreferrer\">Codementor</a>, <a href=\"https://www.savvy.is\" rel=\"nofollow noreferrer\">Savvy</a>, or <a href=\"https://www.airpair.com\" rel=\"nofollow noreferrer\">airpair</a> to engage with experts for in-depth problem solving."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1563390865, "post_id": 57082019, "comment_id": 100688397, "body": "Your client doesn&#39;t check for <code>fgets(buffer, BUFLEN, stdin)</code> returning an error. If the tty that&#39;s acting as stdin gets closed (because you closed the terminal window), fgets returns an error and leaves buffer untouched, so the client sends it again. A short time after that the client is killed by sighup. It doesn&#39;t always do this, though. stracing the client slows things down enough that the sighup gets received before the read completes."}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563391707, "post_id": 57082019, "comment_id": 100688753, "body": "True, but the problem is not clientsided..."}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563393790, "post_id": 57082019, "comment_id": 100689693, "body": "I made a smart observation. Maybe you - guys - can now understand better what actually happens wrongly. See Edit Edit."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563394455, "post_id": 57082019, "comment_id": 100689970, "body": "@NiclasSchwalbe <i>True, but the problem is not clientsided...</i>  How do you know that?  Try running something like Wireshark to see what actually goes through the connection (assuming it&#39;s a TCP connection between machines)."}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563394697, "post_id": 57082019, "comment_id": 100690096, "body": "I think I will go for that, however, if the terminal gets closed, should not the process be abrupted?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563395172, "post_id": 57082019, "comment_id": 100690291, "body": "@NiclasSchwalbe It will be, but as mentioned above in the comments, that may take some time to happen, and it might happen after the process gets a failed read from <code>stdin</code>.  And once the error or eof flag gets set on <code>stdin</code> (that&#39;s implementation-dependent), <code>fgets()</code> will return <b>fast</b> and not modify the contents of the buffer.  I can easily see that loop running a lot of times before the signal to end the process gets both queued and delivered."}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563395704, "post_id": 57082019, "comment_id": 100690529, "body": "Okay. This explains something. Do you have any idea why the Server stops writing Clients name? I can safely say that the only code causing the problem, is the job_read function..."}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563395930, "post_id": 57082019, "comment_id": 100690610, "body": "@AndrewHenle But even if it is the client&#39;s fault, I have to rule on server-side, because otherwise, this would actually be a small hack..."}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563435912, "post_id": 57082019, "comment_id": 100701020, "body": "Does flushing the stdout affect stdin?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563395141, "post_id": 57083434, "comment_id": 100690280, "body": "if(fgets(buffer, BUFLEN, stdin) == NULL){         \tcontinue;         }  Unfortunately, error still exists..."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563396702, "post_id": 57083434, "comment_id": 100690881, "body": "@NiclasSchwalbe Have you tried something like Wireshark to see if the packets actually get sent?  You might have to use the actual IP address of your system instead lf <code>127.0.0.1</code>."}, {"owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "edited": false, "score": 0, "creation_date": 1563397555, "post_id": 57083434, "comment_id": 100691168, "body": "I have a actually a really hard time interpreting what i see... If i use my actual ip-adress would this require me to open port on router?"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1563488358, "post_id": 57083434, "comment_id": 100727587, "body": "If you can&#39;t get Wireshark to work, just start your server with  <code>strace -f .&#47;server 9999</code> to see what the server reads from the socket."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1563396643, "last_edit_date": 1563396643, "creation_date": 1563394257, "answer_id": 57083434, "question_id": 57082019, "link": "https://stackoverflow.com/questions/57082019/what-causes-a-server-to-read-the-last-message-of-a-client-over-and-over-again/57083434#57083434", "title": "What causes a Server to read the last message of a Client over and over again?", "body": "<p>This code will repeat the last line read from <code>stdin</code> over and over if the input stream is closed:</p>\n\n<pre><code>while(!pjob_data-&gt;end_of_program) {\n    fgets(buffer, BUFLEN, stdin);\n\n    pthread_mutex_lock(&amp;pjob_data-&gt;socketids_changingMutex);\n    for(int i = 0; i &lt; pjob_data-&gt;open_cnncts; i++){\n        m = write(pjob_data-&gt;socket_ids[i], name, strlen(name));\n        if((m &lt; 0)){\n            error(\"Writing name failed\");\n        }\n        n = write(pjob_data-&gt;socket_ids[i], buffer, strlen(buffer));\n        if((n &lt; 0)){\n            error(\"Writing message failed\");\n        }\n    }\n    pthread_mutex_unlock(&amp;pjob_data-&gt;socketids_changingMutex);\n    if(strcmp(\"Bye\\n\", buffer) == 0){\n        exit(EXIT_SUCCESS);\n    }\n}\n</code></pre>\n\n<p>You never check if <code>fgets()</code> fails.  When it does, the previous contents of <code>buffer</code> are written to the socket.  And then the loop repeats over and over as long as <code>pjob_data-&gt;end_of_program</code> doesn't evaluate to true, sending the contents of <code>buffer</code> each time.  Likely really quickly, too.</p>\n\n<p>EDIT:</p>\n\n<p>The same error exists in the client code:</p>\n\n<pre><code>while(!endprogram){\n    fgets(buffer, BUFLEN, stdin);\n    n = write(sockfd, buffer, strlen(buffer));\n    if(n &lt; 0){\n        error(\"Error on writing\");\n    }\n    n = strcmp(buffer, \"Bye\");\n    if(n == 0){\n        endprogram = true;\n    }\n}\n</code></pre>\n\n<p>The fix is to check the return value from <code>fgets()</code> and if <code>NULL</code>, act appropriately.  I haven't analyzed the code enough to know what \"appropriately\" means.</p>\n\n<p>This code calls <code>pthread_exit()</code> with the mutex locked:</p>\n\n<pre><code>    pthread_mutex_lock(&amp;pjob_data-&gt;socketids_changingMutex);\n    if(n == 0){\n        delete_socket(new_sock_fd, pjob_data);\n        pthread_exit(NULL);\n    }\n</code></pre>\n\n<p>Any attempt to lock or unlock the <code>pjob_data-&gt;socketids_changingMutex</code> after this will likely fail silently, or deadlock.</p>\n"}], "owner": {"reputation": 13, "user_id": 8215588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07bc20756dd13d1c02d4440c0195c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "Niclas Schwalbe", "link": "https://stackoverflow.com/users/8215588/niclas-schwalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563396643, "creation_date": 1563387346, "last_edit_date": 1563395864, "question_id": 57082019, "link": "https://stackoverflow.com/questions/57082019/what-causes-a-server-to-read-the-last-message-of-a-client-over-and-over-again", "title": "What causes a Server to read the last message of a Client over and over again?", "body": "<p>Given that code for a server, a really unexplainable bug appears in the job_read function.</p>\n\n<p>If this server is connecting with clients, everything seems to work fine - although there might be a handful of other bugs. If a client connects, a new thread will be started, which then reads the input of the client. If the client sends a message this message will be spread to all other clients. The client is run through the terminal. If you stop the client with STRG + C everything will work just fine, but not if you crash it when you exit the terminal.  </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define BUFLEN 255\n#define MAX_CONNECTIONS 128\n#define MAX_NAME_LENGTH 30\n\nstruct JOB_INFO {\n    int socket_ids[MAX_CONNECTIONS];\n    bool end_of_program;\n    int open_cnncts;\n    pthread_mutex_t socketids_changingMutex;\n};\n\nstruct SERVER_INFO {\n    struct sockaddr_in serv_add;\n    struct sockaddr_in cli_adr;\n    socklen_t cli_len;\n    pthread_t write_thread;\n};\n//Global Variables\nFILE* plog_file;\n\nvoid delete_socket(int socketid, struct JOB_INFO* pjob_data);\nvoid* job_read(void*);\nvoid* job_write(void*);\nvoid error(const char* msg);\nvoid setUpFileStream(int argc, char* argv[]);\nint setUpConnections(struct SERVER_INFO* pserver_data, char* port_numc);\nvoid enterConnectingLoop(struct SERVER_INFO* pserver_data, struct JOB_INFO* pjob_data, int sockfd);\n\nvoid error(const char* msg){\n    perror(msg);\n    exit(1);\n}\n\nint main(int argc, char* argv[]) {\n    setUpFileStream(argc, argv);\n\n    int sock_fd;\n    struct JOB_INFO job_data;\n    job_data.end_of_program = false;\n    job_data.open_cnncts = 0;\n\n    struct SERVER_INFO server_data;\n    //Create mutex\n    if(pthread_mutex_init(&amp;(job_data.socketids_changingMutex), NULL) &lt; 0){\n        error(\"Could not initialize Mutex\");\n    }\n    //Initialzing threads and create write_thread\n    pthread_create(&amp;server_data.write_thread, NULL, job_write, (void*)&amp;job_data);\n\n    //Setup for connections\n    sock_fd = setUpConnections(&amp;server_data, argv[1]);\n    fprintf(plog_file,\"Listening...\");\n    fflush(stdout); //For unknown reason this is needed.\n    enterConnectingLoop(&amp;server_data, &amp;job_data, sock_fd);\n\n    job_data.end_of_program = true;\n    close(sock_fd);\n\n    pthread_join(server_data.write_thread, NULL);\n    pthread_mutex_destroy(&amp;job_data.socketids_changingMutex);\n    return EXIT_SUCCESS;\n}\n\nvoid* job_read(void * p){\n\n    char** pc = (char**)p; //allow pointer arithmetic\n    int new_sock_fd = *((int*) (pc[1]));  //Casting\n    struct JOB_INFO* pjob_data = ((struct JOB_INFO*) (pc[0])); //Casting\n\n    ssize_t n; //Error catching variable\n    ssize_t m; //Error catching variable\n    char buffer[BUFLEN];\n    char name[MAX_NAME_LENGTH];\n    sprintf(name, \"Client %d: \", new_sock_fd);\n    fprintf(plog_file, \"Reading from %s\\n\", name);\n\n    while(!pjob_data-&gt;end_of_program){\n        n = read(new_sock_fd, buffer, BUFLEN-1);\n        if ( n &gt; 0 ) buffer[n] = '\\0';  // add a \\0 on success\n        if(n&lt;0){\n            printf(\"Buffer: %s\", buffer);\n            error(\"Reading Failed\");\n        }\n        pthread_mutex_lock(&amp;pjob_data-&gt;socketids_changingMutex);\n        if(n == 0){\n            delete_socket(new_sock_fd, pjob_data);\n            pthread_exit(NULL);\n        }\n\n        for(int i = 0; i &lt; pjob_data-&gt;open_cnncts; i++){\n            if(pjob_data-&gt;socket_ids[i] == new_sock_fd){\n                continue;\n            }\n            m = write(pjob_data-&gt;socket_ids[i], name, strlen(name));\n            if((m &lt; 0)){\n                error(\"Writing name failed\");\n            }\n            n = write(pjob_data-&gt;socket_ids[i], buffer, strlen(buffer));\n            if((n &lt; 0)){\n                error(\"Writing message failed\");\n            }\n        }\n        pthread_mutex_unlock(&amp;pjob_data-&gt;socketids_changingMutex);\n        printf(\"%s%s\", name, buffer);\n        fflush(stdout); //For unknown reason this is needed.\n    }\n    delete_socket(new_sock_fd, pjob_data);\n    free(p);\n    pthread_exit( NULL );\n}\n\nvoid* job_write(void* args){\n    struct JOB_INFO* pjob_data = (struct JOB_INFO*)(args);\n    fprintf(plog_file, \"Started writing thread...\\n\");\n    ssize_t n; //Error catching variable\n    ssize_t m; //Error catching variable\n    char buffer[BUFLEN];\n    char* name = \"Server: \\0\";\n\n    while(!pjob_data-&gt;end_of_program) {\n        fgets(buffer, BUFLEN, stdin);\n\n        pthread_mutex_lock(&amp;pjob_data-&gt;socketids_changingMutex);\n        for(int i = 0; i &lt; pjob_data-&gt;open_cnncts; i++){\n            m = write(pjob_data-&gt;socket_ids[i], name, strlen(name));\n            if((m &lt; 0)){\n                error(\"Writing name failed\");\n            }\n            n = write(pjob_data-&gt;socket_ids[i], buffer, strlen(buffer));\n            if((n &lt; 0)){\n                error(\"Writing message failed\");\n            }\n        }\n        pthread_mutex_unlock(&amp;pjob_data-&gt;socketids_changingMutex);\n        if(strcmp(\"Bye\\n\", buffer) == 0){\n            exit(EXIT_SUCCESS);\n        }\n    }\n    free(args);\n    pjob_data-&gt;end_of_program = true;\n    pthread_exit( NULL );\n}\n\nvoid enterConnectingLoop(struct SERVER_INFO* pserver_data, struct JOB_INFO* pjob_data, int sockfd){\n    listen(sockfd, MAX_CONNECTIONS);\n\n    for(pjob_data-&gt;open_cnncts = 0; (!pjob_data-&gt;end_of_program); /*mutex needs to be set*/ ){\n        void** p = malloc(2*sizeof(void*));\n        p[0] = (void*)pjob_data;\n        p[1] = (void*)&amp;(pjob_data-&gt;socket_ids[pjob_data-&gt;open_cnncts]);\n        pjob_data-&gt;socket_ids[pjob_data-&gt;open_cnncts] =\n                accept(sockfd, (struct sockaddr*) &amp;pserver_data-&gt;cli_adr, &amp;pserver_data-&gt;cli_len);\n        pthread_mutex_lock(&amp;(pjob_data-&gt;socketids_changingMutex)); //Note you cannot mutex the accept()\n        printf(\"SOCKETFD %d\\n\", (pjob_data-&gt;socket_ids[pjob_data-&gt;open_cnncts]));\n        fprintf(plog_file,\"Client connected.\\n\");\n        pthread_t thread;\n        pthread_create(&amp;thread , NULL, job_read, p);\n        pjob_data-&gt;open_cnncts++;\n        pthread_mutex_unlock(&amp;(pjob_data-&gt;socketids_changingMutex));\n    }\n}\n\nvoid delete_socket(int socketid, struct JOB_INFO* pjob_data){\n    bool found = false;\n    for(int i = 0; i &lt; pjob_data-&gt;open_cnncts; i++){\n        if(found){\n            pjob_data-&gt;socket_ids[i-1] = pjob_data-&gt;socket_ids[i];\n        }\n        if(pjob_data-&gt;socket_ids[i] == socketid){\n            close(socketid);\n            found = true;\n        }\n    }\n    if(found){\n        pjob_data-&gt;open_cnncts--;\n    }\n}\n\ninline void setUpFileStream(int argc, char* argv[]){\n    printf(\"Server started...\\n\");\n    if(argc &lt; 2){\n        fprintf(stderr, \"You must provide a port number\");\n        exit(EXIT_FAILURE);\n    }\n    if(argc == 3){\n        plog_file = fopen(argv[2], \"w\");\n    } else {\n        plog_file = fopen(\"logfile.txt\", \"w\");\n    }\n    plog_file = stdout;\n    stderr = plog_file;\n}\n\ninline int setUpConnections(struct SERVER_INFO* pserver_data, char* port_numc){\n    pserver_data-&gt;cli_len = sizeof(pserver_data-&gt;cli_adr);\n    memset(&amp;pserver_data-&gt;serv_add, 0, sizeof((pserver_data-&gt;serv_add)));\n\n    uint16_t port_num = (uint16_t)atoi(port_numc);\n    pserver_data-&gt;serv_add.sin_family = AF_INET;\n    pserver_data-&gt;serv_add.sin_addr.s_addr = INADDR_ANY;\n    pserver_data-&gt;serv_add.sin_port = htons(port_num);\n\n    int sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if(sockfd &lt; 0){\n        error(\"Error opening socket.\");\n    }\n\n    if(bind(sockfd, (struct sockaddr*) (&amp;pserver_data-&gt;serv_add), sizeof(pserver_data-&gt;serv_add)) &lt; 0){\n        error(\"Binding failed.\");\n    }\n    return sockfd;\n}\", buffer) == 0){\n            exit(EXIT_SUCCESS);\n        }\n    }\n    free(args);\n    pjob_data-&gt;end_of_program = true;\n    pthread_exit( NULL );\n}\n\nvoid enterConnectingLoop(struct SERVER_INFO* pserver_data, struct JOB_INFO* pjob_data, int sockfd){\n    listen(sockfd, MAX_CONNECTIONS);\n\n    for(pjob_data-&gt;open_cnncts = 0; (!pjob_data-&gt;end_of_program); /*mutex needs to be set*/ ){\n        void** p = malloc(2*sizeof(void*));\n        p[0] = (void*)pjob_data;\n        p[1] = (void*)&amp;(pjob_data-&gt;socket_ids[pjob_data-&gt;open_cnncts]);\n        pjob_data-&gt;socket_ids[pjob_data-&gt;open_cnncts] =\n                accept(sockfd, (struct sockaddr*) &amp;pserver_data-&gt;cli_adr, &amp;pserver_data-&gt;cli_len);\n        pthread_mutex_lock(&amp;(pjob_data-&gt;socketids_changingMutex)); //Note you cannot mutex the accept()\n        printf(\"SOCKETFD %d\\n\", (pjob_data-&gt;socket_ids[pjob_data-&gt;open_cnncts]));\n        fprintf(plog_file,\"Client connected.\\n\");\n        pthread_t thread;\n        pthread_create(&amp;thread , NULL, job_read, p);\n        pjob_data-&gt;open_cnncts++;\n        pthread_mutex_unlock(&amp;(pjob_data-&gt;socketids_changingMutex));\n    }\n}\n\nvoid delete_socket(int socketid, struct JOB_INFO* pjob_data){\n    bool found = false;\n    for(int i = 0; i &lt; pjob_data-&gt;open_cnncts; i++){\n        if(found){\n            pjob_data-&gt;socket_ids[i-1] = pjob_data-&gt;socket_ids[i];\n        }\n        if(pjob_data-&gt;socket_ids[i] == socketid){\n            close(socketid);\n            found = true;\n        }\n    }\n    if(found){\n        pjob_data-&gt;open_cnncts--;\n    }\n}\n\ninline void setUpFileStream(int argc, char* argv[]){\n    printf(\"Server started...\\n\");\n    if(argc &lt; 2){\n        fprintf(stderr, \"You must provide a port number\");\n        exit(EXIT_FAILURE);\n    }\n    if(argc == 3){\n        plog_file = fopen(argv[2], \"w\");\n    } else {\n        plog_file = fopen(\"logfile.txt\", \"w\");\n    }\n    plog_file = stdout;\n    stderr = plog_file;\n}\n\ninline int setUpConnections(struct SERVER_INFO* pserver_data, char* port_numc){\n    pserver_data-&gt;cli_len = sizeof(pserver_data-&gt;cli_adr);\n    memset(&amp;pserver_data-&gt;serv_add, 0, sizeof((pserver_data-&gt;serv_add)));\n\n    uint16_t port_num = (uint16_t)atoi(port_numc);\n    pserver_data-&gt;serv_add.sin_family = AF_INET;\n    pserver_data-&gt;serv_add.sin_addr.s_addr = INADDR_ANY;\n    pserver_data-&gt;serv_add.sin_port = htons(port_num);\n\n    int sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if(sockfd &lt; 0){\n        error(\"Error opening socket.\");\n    }\n\n    if(bind(sockfd, (struct sockaddr*) (&amp;pserver_data-&gt;serv_add), sizeof(pserver_data-&gt;serv_add)) &lt; 0){\n        error(\"Binding failed.\");\n    }\n    return sockfd;\n}\n</code></pre>\n\n<p>Within the job function, the Server seems to print the last message of the Client over and over again.</p>\n\n<pre><code>void* job_read(void * p){\n\n    char** pc = (char**)p; //allow pointer arithmetic\n    int new_sock_fd = *((int*) (pc[1]));  //Casting\n    struct JOB_INFO* pjob_data = ((struct JOB_INFO*) (pc[0])); //Casting\n\n    ssize_t n; //Error catching variable\n    ssize_t m; //Error catching variable\n    char buffer[BUFLEN];\n    char name[MAX_NAME_LENGTH];\n    sprintf(name, \"Client %d: \", new_sock_fd);\n    fprintf(plog_file, \"Reading from %s\\n\", name);\n\n    while(!pjob_data-&gt;end_of_program){\n        n = read(new_sock_fd, buffer, BUFLEN-1);\n        if ( n &gt; 0 ) buffer[n] = '\\0';  // add a \\0 on success\n        if(n&lt;0){\n            printf(\"Buffer: %s\", buffer);\n            error(\"Reading Failed\");\n        }\n        pthread_mutex_lock(&amp;pjob_data-&gt;socketids_changingMutex);\n        if(n == 0){\n            delete_socket(new_sock_fd, pjob_data);\n            pthread_exit(NULL);\n        }\n\n        for(int i = 0; i &lt; pjob_data-&gt;open_cnncts; i++){\n            if(pjob_data-&gt;socket_ids[i] == new_sock_fd){\n                continue;\n            }\n            m = write(pjob_data-&gt;socket_ids[i], name, strlen(name));\n            if((m &lt; 0)){\n                error(\"Writing name failed\");\n            }\n            n = write(pjob_data-&gt;socket_ids[i], buffer, strlen(buffer));\n            if((n &lt; 0)){\n                error(\"Writing message failed\");\n            }\n        }\n        pthread_mutex_unlock(&amp;pjob_data-&gt;socketids_changingMutex);\n        printf(\"%s%s\", name, buffer);\n        fflush(stdout); //For unknown reason this is needed.\n    }\n    delete_socket(new_sock_fd, pjob_data);\n    free(p);\n    pthread_exit( NULL );\n}\n</code></pre>\n\n<p>There are two things. Within this function, the name variable seems to disappear from time to time.  She does not get printed nor sent. But as far as I know, the name variable is always initialized.</p>\n\n<p><strong>Reproduce the bug:</strong></p>\n\n<p>Compile Server and Client(code below). \nStart Server and open a port: </p>\n\n<pre><code>./Server 9999\n</code></pre>\n\n<p>Start Client:</p>\n\n<pre><code>./Client 127.0.0.1 9999\n</code></pre>\n\n<p>Type something in the client.\nExit the client by closing the terminal.\nServer behaves faulty.</p>\n\n<p>Thank you!</p>\n\n<p>Client Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define BUFLEN 255\n\nbool endprogram = false;\nint sockfd;\n\nvoid error(const char* msg){\n    perror(msg);\n    exit(1);\n}\n\nvoid* job_read(void* p){\n    char buffer[BUFLEN];\n    while(!endprogram){\n        bzero(buffer, BUFLEN);\n        ssize_t n = read(sockfd, buffer, (BUFLEN));\n        if(n &lt; 0){\n            error(\"Error on reading\");\n        }\n        printf(\"%s\", buffer);\n        int i = strncmp(\"Bye\", buffer, 3);\n        if(i == 0){\n            endprogram = true;\n            pthread_exit(NULL);\n        }\n    }\n   pthread_exit(NULL);\n}\n\nint main(int argc, const char * argv[]) {\n    pthread_t readt;\n\n    int16_t portnum;\n    struct sockaddr_in serveraddr;\n    struct hostent* server;\n\n    if(argc &lt; 3){\n        perror(\"You shall provide a port and a ip adress\");\n    }\n    portnum = atoi(argv[2]);\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if(sockfd &lt; 0){\n        error(\"Error opening socket\");\n    }\n\n    server = gethostbyname(argv[1]);\n    if(!server){\n        error(\"No such host\");\n    }\n\n    bzero((char*)&amp;serveraddr, sizeof(serveraddr));\n    serveraddr.sin_family = AF_INET;\n    bcopy((char *)server-&gt;h_addr_list[0], (char *)&amp;serveraddr.sin_addr.s_addr, sizeof(server-&gt;h_length));\n    serveraddr.sin_port = htons(portnum);\n\n    if(connect(sockfd, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr))&lt;0){\n        error(\"Connection failed\");\n    }\n\n    pthread_create(&amp;readt, NULL, &amp;job_read, NULL);\n\n    ssize_t n;\n    char buffer[BUFLEN];\n    while(!endprogram){\n        fgets(buffer, BUFLEN, stdin);\n        n = write(sockfd, buffer, strlen(buffer));\n        if(n &lt; 0){\n            error(\"Error on writing\");\n        }\n        n = strcmp(buffer, \"Bye\");\n        if(n == 0){\n            endprogram = true;\n        }\n    }\n    pthread_join(readt, NULL);\n    close(sockfd);\n    return 0;\n}\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>It is really hard to reduce the problem since I need all these methods to either set the problem up or to maintain core-functionality. However, this is the first reducement (uncompilable), where the bug might be.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdbool.h&gt;\n\n#define BUFLEN 255\n#define MAX_CONNECTIONS 128\n#define MAX_NAME_LENGTH 30\n\nstruct JOB_INFO {\n    int socket_ids[MAX_CONNECTIONS];\n    bool end_of_program;\n    int open_cnncts;\n    pthread_mutex_t socketids_changingMutex;\n};\n\nstruct SERVER_INFO {\n    struct sockaddr_in serv_add;\n    struct sockaddr_in cli_adr;\n    socklen_t cli_len;\n    pthread_t write_thread;\n};\n//Global Variables\nFILE* plog_file;\n\nvoid delete_socket(int socketid, struct JOB_INFO* pjob_data);\nvoid* job_read(void*);\nvoid error(const char* msg);\nvoid enterConnectingLoop(struct SERVER_INFO* pserver_data, struct JOB_INFO* pjob_data, int sockfd);\n\nint main(int argc, char* argv[]) {\n\n    int sock_fd;\n    struct JOB_INFO job_data;\n    job_data.end_of_program = false;\n    job_data.open_cnncts = 0;\n\n    struct SERVER_INFO server_data;\n    enterConnectingLoop(&amp;server_data, &amp;job_data, sock_fd);\n\n    job_data.end_of_program = true;\n    close(sock_fd);\n\n    pthread_join(server_data.write_thread, NULL);\n    pthread_mutex_destroy(&amp;job_data.socketids_changingMutex);\n    return EXIT_SUCCESS;\n}\n\nvoid* job_read(void * p){\n\n    char** pc = (char**)p; //allow pointer arithmetic\n    int new_sock_fd = *((int*) (pc[1]));  //Casting\n    struct JOB_INFO* pjob_data = ((struct JOB_INFO*) (pc[0])); //Casting\n\n    ssize_t n; //Error catching variable\n    ssize_t m; //Error catching variable\n    char buffer[BUFLEN];\n    char name[MAX_NAME_LENGTH];\n    sprintf(name, \"Client %d: \", new_sock_fd);\n    fprintf(plog_file, \"Reading from %s\\n\", name);\n\n    while(!pjob_data-&gt;end_of_program){\n        n = read(new_sock_fd, buffer, BUFLEN-1);\n        if ( n &gt; 0 ) buffer[n] = '\\0';  // add a \\0 on success\n        if(n&lt;0){\n            printf(\"Buffer: %s\", buffer);\n            error(\"Reading Failed\");\n        }\n        pthread_mutex_lock(&amp;pjob_data-&gt;socketids_changingMutex);\n        if(n == 0){\n            delete_socket(new_sock_fd, pjob_data);\n            pthread_exit(NULL);\n        }\n\n        for(int i = 0; i &lt; pjob_data-&gt;open_cnncts; i++){\n            if(pjob_data-&gt;socket_ids[i] == new_sock_fd){\n                continue;\n            }\n            m = write(pjob_data-&gt;socket_ids[i], name, strlen(name));\n            if((m &lt; 0)){\n                error(\"Writing name failed\");\n            }\n            n = write(pjob_data-&gt;socket_ids[i], buffer, strlen(buffer));\n            if((n &lt; 0)){\n                error(\"Writing message failed\");\n            }\n        }\n        printf(\"%s%s\", name, buffer);\n        pthread_mutex_unlock(&amp;pjob_data-&gt;socketids_changingMutex);\n        fflush(stdout); //For unknown reason this is needed.\n    }\n    delete_socket(new_sock_fd, pjob_data);\n    free(p);\n    pthread_exit( NULL );\n}\n\nvoid enterConnectingLoop(struct SERVER_INFO* pserver_data, struct JOB_INFO* pjob_data, int sockfd){\n    listen(sockfd, MAX_CONNECTIONS);\n\n    for(pjob_data-&gt;open_cnncts = 0; (!pjob_data-&gt;end_of_program); /*mutex needs to be set*/ ){\n        void** p = malloc(2*sizeof(void*));\n        p[0] = (void*)pjob_data;\n        p[1] = (void*)&amp;(pjob_data-&gt;socket_ids[pjob_data-&gt;open_cnncts]);\n        pjob_data-&gt;socket_ids[pjob_data-&gt;open_cnncts] =\n                accept(sockfd, (struct sockaddr*) &amp;pserver_data-&gt;cli_adr, &amp;pserver_data-&gt;cli_len);\n        pthread_mutex_lock(&amp;(pjob_data-&gt;socketids_changingMutex)); //Note you cannot mutex the accept()\n        printf(\"SOCKETFD %d\\n\", (pjob_data-&gt;socket_ids[pjob_data-&gt;open_cnncts]));\n        fprintf(plog_file,\"Client connected.\\n\");\n        pthread_t thread;\n        pthread_create(&amp;thread , NULL, job_read, p);\n        pjob_data-&gt;open_cnncts++;\n        pthread_mutex_unlock(&amp;(pjob_data-&gt;socketids_changingMutex));\n    }\n}\n\nvoid delete_socket(int socketid, struct JOB_INFO* pjob_data){\n    bool found = false;\n    for(int i = 0; i &lt; pjob_data-&gt;open_cnncts; i++){\n        if(found){\n            pjob_data-&gt;socket_ids[i-1] = pjob_data-&gt;socket_ids[i];\n        }\n        if(pjob_data-&gt;socket_ids[i] == socketid){\n            close(socketid);\n            found = true;\n        }\n    }\n    if(found){\n        pjob_data-&gt;open_cnncts--;\n    }\n}\n</code></pre>\n\n<p>I will try to set up a program which will do the same thing on a pc using input and output file and thereby surrounding this whole inet-setup-monster...</p>\n\n<p><strong>EDIT EDIT:</strong></p>\n\n<p>If the same thing happens outside if an IDE, I get an coredump - instead of stupid output: similar to this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid* job_read(void* p){\n    sleep(1000); //delay to ensure job_write is waiting\n    FILE* pfile = ((FILE**)p)[0];\n    while(1){\n        char buffer[20];\n        fgets(buffer, 19, pfile);\n        printf(\"&amp;s\", buffer);\n    }\n\n}\n\nvoid* job_write(void* p){\n    FILE* pfile = ((FILE**)p)[0];\n    fputs(\"hi\\n\", pfile);\n    sleep(1200); //delay to ensure job_write is waiting\n    pthread_exit(NULL); //FUCK THE OPEN CONNECTION\n}\n\nint main(int argc, char* argv[]) {\n    (void)argv; //Compiler things\n    (void)argc;\n    printf(\"HERE\");\n    FILE* in = fopen(\"in.txt\", \"w\");\n    pthread_t firstread; //Simulate all threads in actual IO: Server\n    pthread_t firstwrite; //Client\n\n    FILE** p = malloc(sizeof(FILE*));\n    p[0] = in;\n\n    pthread_create(&amp;firstwrite, NULL, job_write, (void*)&amp;p);\n    pthread_create(&amp;firstread, NULL, job_read, (void*)&amp;p);\n\n    pthread_join(firstwrite, NULL);\n}\n</code></pre>\n\n<p>I guess this might be the solution to my actual problem. My assumption is that I try to write a file which no longer exists or something like this. however, I guess it is because of a closed file causing the bug</p>\n\n<p><strong>EDIT EDIT EDIT</strong></p>\n\n<p>I can safely say, that the problem is caused by the job_read function.\nAs commented, a smart user realzed that if the terminal quits it will take some time, before the actual process gets killed. This might cause one of the errors.</p>\n"}, {"tags": ["c", "linux", "posix", "rename"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563387042, "post_id": 57081914, "comment_id": 100686653, "body": "Why do you care that <code>foo</code> will be edited if you replace it anyway?"}, {"owner": {"reputation": 6875, "user_id": 2002452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3c2349a8ccc58b9d485eff0095025ae5?s=128&d=identicon&r=PG", "display_name": "michaelmeyer", "link": "https://stackoverflow.com/users/2002452/michaelmeyer"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563387376, "post_id": 57081914, "comment_id": 100686800, "body": "@EugeneSh. It&#39;s for a deduplication tool. I want to replace <code>foo</code> with a link to another file that holds the same data as <code>foo</code>, without losing data in the process."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1563400296, "post_id": 57081914, "comment_id": 100692080, "body": "This is possible on most CoW filesystems like Btrfs, which has an ioctl to verify and dedup specific ranges in the kernel."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1563400512, "post_id": 57081914, "comment_id": 100692146, "body": "This doesn&#39;t really make any sense.  Files don&#39;t have names.  There are names in directories that refer to files, and I suppose that&#39;s what you mean, but....if you have an open file handle on the file that you accessed through the link &quot;bar&quot;, and it contains the data you want, and some other process changes &quot;bar&quot; so that it references another file, your process still has the original file and the data is still there.  Even if it doesn&#39;t have any links left in the file system, you can still modify the data and create a link named &quot;foo&quot;."}, {"owner": {"reputation": 6875, "user_id": 2002452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3c2349a8ccc58b9d485eff0095025ae5?s=128&d=identicon&r=PG", "display_name": "michaelmeyer", "link": "https://stackoverflow.com/users/2002452/michaelmeyer"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1563470040, "post_id": 57081914, "comment_id": 100720431, "body": "@WilliamPursell You can certainly modify the data of a file that has been unlinked, or even copy its data to a new file, but you can&#39;t rename, link to it or link from it, and so on, since, for these functions to work, the file&#39;s directory entry must be reachable, which it isn&#39;t at this point."}], "answers": [{"comments": [{"owner": {"reputation": 6875, "user_id": 2002452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3c2349a8ccc58b9d485eff0095025ae5?s=128&d=identicon&r=PG", "display_name": "michaelmeyer", "link": "https://stackoverflow.com/users/2002452/michaelmeyer"}, "edited": false, "score": 0, "creation_date": 1563470404, "post_id": 57084414, "comment_id": 100720610, "body": "After a quick check, it seems indeed to better to rely on a filesystem feature. Still, it&#39;s  somewhat regrettable that POSIX doesn&#39;t allow more control on directory entries. Looking at the Linux kernel, the <code>rename()</code> function in the fs layer takes directory entries and inode as arguments."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 2, "last_activity_date": 1563399813, "creation_date": 1563399813, "answer_id": 57084414, "question_id": 57081914, "link": "https://stackoverflow.com/questions/57081914/calling-rename-without-overwriting-unexpected-data-and-without-overwriting-wit/57084414#57084414", "title": "Calling rename() without overwriting unexpected data and without overwriting with unexpected data", "body": "<p>Based on your comment:</p>\n\n<blockquote>\n  <p>It's for a deduplication tool. I want to replace foo with a link to another file that holds the same data as foo, without losing data in the process</p>\n</blockquote>\n\n<p>I think you have an XY problem. You cannot make the <code>rename</code> operation atomic with respect to contents of the files. But your goal is just to avoid data loss if a file changes unexpectedly during the deduplication process. That's amenable to other approaches, like keeping a hardlink to the old file and restoring it (either to the original name, or to a special recovery area) <em>after</em> performing the rename and then comparing to detect that it's changed.</p>\n\n<p>However there are a lot of fundamental issues that still make this problematic, starting with at least:</p>\n\n<ul>\n<li><p>A process may have an open handle for write on the old file, without having modified it yet, and may modify and close it after you deduplicate it. In that case the close operation will orphan it and the data will be lost.</p></li>\n<li><p>Any process intending to modify one of the files being deduplicated will modify all duplicates at the same time once they're hard-linked, probably contrary to your expectation.</p></li>\n</ul>\n\n<p>If your goal is deduplicating to save space, but keeping semantics to allow modification, you really need a filesystem that deduplicates fs blocks with copy-on-write semantics, not hard links. On the other hand, if you want hard links, you should treat the whole tree being deduplicated as essentially read-only during <strong>and after</strong> the deduplication operation.</p>\n"}], "owner": {"reputation": 6875, "user_id": 2002452, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3c2349a8ccc58b9d485eff0095025ae5?s=128&d=identicon&r=PG", "display_name": "michaelmeyer", "link": "https://stackoverflow.com/users/2002452/michaelmeyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 57084414, "answer_count": 1, "score": 0, "last_activity_date": 1563399813, "creation_date": 1563386925, "last_edit_date": 1563394956, "question_id": 57081914, "link": "https://stackoverflow.com/questions/57081914/calling-rename-without-overwriting-unexpected-data-and-without-overwriting-wit", "title": "Calling rename() without overwriting unexpected data and without overwriting with unexpected data", "body": "<p>Say you have a file named <code>foo</code> that contains some definite sequence of bytes <code>X</code>, and you want to atomically replace it with a file named <code>bar</code> that contains a byte sequence <code>Y</code>. This is typically done with the <code>rename()</code> system call---in this case, by invoking <code>rename(\"bar\", \"foo\")</code>. However, you want the two following constraints to be observed:</p>\n\n<ol>\n<li>The replacement should only be performed if the file named <code>bar</code> does contain the data <code>Y</code>, otherwise it should fail.</li>\n<li>The replacement should only be performed if the file named <code>foo</code> does contain the data <code>X</code> otherwise it should fail.</li>\n</ol>\n\n<p>How to do that correctly?</p>\n\n<p>To prevent <code>foo</code> and <code>bar</code> from being edited before we call <code>rename()</code>, we can lock them with <code>fnctl</code> or equivalent. But locks only help to prevent modifications of the file data, they have no effect on directory entries, so that, by the time <code>rename()</code> does its magic, the data <code>foo</code> or <code>bar</code> refer to might not be the same.</p>\n\n<p>Two examples of data loss scenarios, for the two constraints described above:</p>\n\n<ol>\n<li><ul>\n<li>We've locked the file named <code>bar</code> and made sure that it contains the data <code>Y</code></li>\n<li>Before we've time to replace <code>foo</code> with <code>bar</code>, some program replaces <code>bar</code> with a file previously named <code>qux</code> that holds the data <code>Z</code>.</li>\n<li>We replace <code>foo</code> with <code>bar</code>.</li>\n<li>Now the file <code>foo</code>, which we expected to contain the data of <code>bar</code>, contains instead the data of <code>qux</code>. Both the data of <code>foo</code> and <code>bar</code> is lost.</li>\n</ul></li>\n<li><ul>\n<li>We've locked the file named <code>foo</code> and made sure that it contains the data <code>X</code>.</li>\n<li>Before we've time to replace <code>foo</code> with <code>bar</code>, some program replaces <code>foo</code> with a file previously named <code>qux</code> that holds the data <code>Z</code>.</li>\n<li>We replace <code>foo</code> with <code>bar</code>.</li>\n<li>Now the file <code>foo</code> does contain the data of <code>bar</code>, but the data of the file <code>qux</code> has been lost in the process.</li>\n</ul></li>\n</ol>\n"}, {"tags": ["c", "arrays", "fopen", "binaryfiles", "fread"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1563386811, "post_id": 57081744, "comment_id": 100686566, "body": "....because if the default opening mode is text <code>&quot;t&quot;</code> then there can be newline conversions on some systems."}, {"owner": {"reputation": 95, "user_id": 11521388, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aT2Fq0RP98k/AAAAAAAAAAI/AAAAAAAAARM/ArGyJ7kNYgk/photo.jpg?sz=128", "display_name": "Gabriel Machado", "link": "https://stackoverflow.com/users/11521388/gabriel-machado"}, "edited": false, "score": 0, "creation_date": 1563388794, "post_id": 57081744, "comment_id": 100687460, "body": "That worked. In the documentation I&#39;ve read about fopen, there was no option &#39;b&#39;, I thought that it was all opened in  binary mode, and what really mattered was the function I used to read it. Thank you!"}], "owner": {"reputation": 95, "user_id": 11521388, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-aT2Fq0RP98k/AAAAAAAAAAI/AAAAAAAAARM/ArGyJ7kNYgk/photo.jpg?sz=128", "display_name": "Gabriel Machado", "link": "https://stackoverflow.com/users/11521388/gabriel-machado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563386257, "creation_date": 1563386257, "question_id": 57081744, "link": "https://stackoverflow.com/questions/57081744/weird-behavior-reading-float-vector-from-binary-file", "title": "Weird behavior reading float vector from binary file", "body": "<p>I'm putting a float32 array in a binary file using python to analyze it in C. For that, I'm using this python code:</p>\n\n<pre><code>'''python\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nN=500\n\nsignal=np.arange(0,N)\n\n\n#generating binary array\nmyarr=np.array(signal, dtype='float32')\nmyarr=myarr.tobytes(order='C')\n\n#creating file.bin\nwith open('file.bin', 'wb') as f:\n    f.write(myarr)\n\n#recovering the data\nwith open('file.bin', 'rb') as f:\n    recAr=f.read()\n\nrecAr=np.frombuffer(recAr, dtype='float32')\nprint(recAr.size)\n\nplt.figure()\nplt.plot(signal)\nplt.show()\n'''\n</code></pre>\n\n<p>Then I'm reading it in C using this code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\n\n//Read a float vector from a binary file\nfloat * readVector(int v_size, char file_name[]){\n  float *my_floats=(float*)malloc(sizeof(float)*v_size);\n  //opening file\n  FILE *file_to_read = fopen(file_name, \"r\");\n\n  if (file_to_read == NULL){\n    printf(\"File would not open!\\n\");\n  }\n  //read binary\n  //size_t fread ( void * ptr, size_t size, size_t count, FILE * stream );\n  fread(my_floats, sizeof(my_floats[0]), v_size, file_to_read);\n\n  fclose(file_to_read);\n\n  return my_floats;\n}\n\nint main(void){\n\n  int v_size=500;\n  float *array=readVector(v_size, \"file.bin\");\n\n  for(int i=0; i&lt;v_size;i++)\n    printf(\"%d - %f\\n\", i, array[i]);\n  return 0;\n}\n</code></pre>\n\n<p>But what I get is really strange. For small array sizes, everything goes ok, if N=50, I read it all fine, but if it's bigger, like 500, I can just read the first 100 ok, and then all the others goes wrong, most of them are read as 0.000. And if the data in signal is different, like a sine wave, I can read fewer good numbers. On the other hand, if I read it in python, it goes ok, and all the numbers in the array are right.</p>\n\n<p>I really don't know what is happening. </p>\n"}, {"tags": ["c", "c-strings", "strcpy", "strcat", "strncpy"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 3, "creation_date": 1563384550, "post_id": 57081303, "comment_id": 100685543, "body": "<code>path</code> is considered an <code>int</code>. Declare as: <code>void some_function(char *path)</code>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1563384643, "post_id": 57081303, "comment_id": 100685588, "body": "<code>strncpy</code> does not terminate the copied string if more is attempted to be copied than the size parameter. <code>strncat</code> will then atempt to search the end, but there may not be a terminating null character."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1563384760, "post_id": 57081303, "comment_id": 100685642, "body": "And turn warnings of your compiler ON."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1563384761, "post_id": 57081303, "comment_id": 100685643, "body": "In the <code>strncat</code> call you have to specify the remaining space, something like <code>sizeof(filename)-strlen(filename)</code>."}, {"owner": {"reputation": 8154, "user_id": 2470782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921783e0584f9ace7e05d303e4d48869?s=128&d=identicon&r=PG", "display_name": "Ingo Leonhardt", "link": "https://stackoverflow.com/users/2470782/ingo-leonhardt"}, "edited": false, "score": 0, "creation_date": 1563384795, "post_id": 57081303, "comment_id": 100685661, "body": "and please note that a) <code>strncpy()</code> doesn&#39;t write a <code>&#39;\\0&#39;</code> to <code>filename</code> if <code>strlen(PATH) &gt;= MAX_SIZE</code> and b) <code>strncat()</code> appends up to another <code>MAX_SIZE</code> characters to <code>filename</code> thus potentially exceeding the array size"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1563384849, "post_id": 57081303, "comment_id": 100685679, "body": "To terminate the <code>strncpy</code>d string: <code>filename[sizeof(filename)-1]= &#39;\\0&#39;;</code>"}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1563385438, "post_id": 57081303, "comment_id": 100685964, "body": "@paul: filename array is fully initialized with 0&#39;s in the above case."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1563466127, "post_id": 57081303, "comment_id": 100718624, "body": "Note that <code>sizeof(filename)</code> is <code>MAX_SIZE</code>."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1563387471, "last_edit_date": 1563387471, "creation_date": 1563385601, "answer_id": 57081600, "question_id": 57081303, "link": "https://stackoverflow.com/questions/57081303/i-have-encountered-buffer-overflow-array-index-out-of-bounds-error/57081600#57081600", "title": "I have encountered &quot;Buffer overflow-array index out of bounds&quot; error", "body": "<p>If you are using the function <code>strncpy</code> then you have to set its last character to the zero character '\\0'. Otherwise you can not guarantee that the character array contains a string.</p>\n\n<p>Using <code>strncat</code> this way</p>\n\n<pre><code>strncat(filename, attr, sizeof(filename));\n</code></pre>\n\n<p>does not make sense. The array <code>filename</code> can have no enough space to accommodate the string <code>attr</code>. But you are trying to copy <code>sizeof(filename)</code> characters to an array that already can be entirely filled.</p>\n\n<p>You have to check \"manually\" whether the destination array contains enough space to append a new string to the already stored string.</p>\n\n<p>So there is no sense to use the function <code>strncat</code> because in any case the result path will be invalid.</p>\n\n<p>You can use the following approach shown in the demonstrative program below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_SIZE 512\n\nvoid some_function(const char *path )\n{\n    char filename[MAX_SIZE] = \"\";\n    const char *attr = \"/funct\";\n    size_t n = strlen( attr );\n\n    strncpy( filename, path, sizeof (filename ) );\n\n    filename[ MAX_SIZE - 1] = '\\0';\n\n    if ( n &lt; MAX_SIZE - strlen( filename ) )\n    {\n        strcat( filename, attr ); \n    }\n\n    puts( filename );\n}\n\nint main(void) \n{\n    const char *path = \"/path\";\n\n    some_function( path );\n\n    return 0;\n}\n</code></pre>\n\n<p>Or you could at the very beginning of the function check whether the array can contain the both strings. For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_SIZE 512\n\nvoid some_function(const char *path )\n{\n    char filename[MAX_SIZE] = \"\";\n    const char *attr = \"/funct\";\n    size_t n1 = strlen( path );\n    size_t n2 = strlen( attr );\n\n    if ( n1 + n2 &lt; MAX_SIZE )\n    {\n        strcpy( filename, path );\n\n        strcpy( filename + n1, attr ); \n    }\n\n    puts( filename );\n}\n\nint main(void) \n{\n    const char *path = \"/path\";\n\n    some_function( path );\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1563387861, "creation_date": 1563387861, "answer_id": 57082141, "question_id": 57081303, "link": "https://stackoverflow.com/questions/57081303/i-have-encountered-buffer-overflow-array-index-out-of-bounds-error/57082141#57082141", "title": "I have encountered &quot;Buffer overflow-array index out of bounds&quot; error", "body": "<p>The error message of the compiler is probably because you copy a maximum of 511 bytes (plus null) and then concatenate another maximum of 511 bytes (plus null), a total of 1022 bytes (plus one null).</p>\n\n<p>However, the compiler sees the target is only 512 bytes and issues a warning.</p>\n\n<p>Solutions are given in comments and in other solutions, which I do not repeat here.</p>\n"}], "owner": {"reputation": 11, "user_id": 8323979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/195b64598a0e125d6cf22b37ded22592?s=128&d=identicon&r=PG&f=1", "display_name": "Harminder Singh", "link": "https://stackoverflow.com/users/8323979/harminder-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1563452543, "creation_date": 1563384365, "last_edit_date": 1563452543, "question_id": 57081303, "link": "https://stackoverflow.com/questions/57081303/i-have-encountered-buffer-overflow-array-index-out-of-bounds-error", "title": "I have encountered &quot;Buffer overflow-array index out of bounds&quot; error", "body": "<p>I do understand the error but don't know what is the proper solution for this. It says</p>\n\n<blockquote>\n  <p>Array 'filename' of size 512 may use index value(s) MIN..1022</p>\n</blockquote>\n\n<p>Is it because <code>strncat</code> is called right after <code>strncpy</code>?</p>\n\n<p>I tried doing <code>strlen</code>, but that introduced some other errors.</p>\n\n<pre><code>#define MAX_SIZE 512\nvoid some_function(const char *path)        /*path is also char  \n                                             array of size 512*/  \n{\n\n    char filename[MAX_SIZE]=\"\";\n    char *attr = \"/funct\";\n\n    strncpy(filename, path, sizeof(filename));\n    strncat(filename, attr, sizeof(filename));  //error line\n\n}\n</code></pre>\n\n<p>Is there any proper solution for this.</p>\n"}, {"tags": ["c++", "c", "compiler-optimization", "endianness", "bit-fields"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1563384546, "post_id": 57081289, "comment_id": 100685540, "body": "The code does not compile in C (MSVC)."}, {"owner": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563384839, "post_id": 57081289, "comment_id": 100685676, "body": "@WeatherVane: It&#39;s not supposed to. The OP said it&#39;s C++. Now, why the OP feels the need to put C++ in a question about C is a different matter."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 2, "creation_date": 1563384907, "post_id": 57081289, "comment_id": 100685715, "body": "@NicolBolas it has the C tag. There is no C/C++ language as mentioned in the post, or entire C/C++ community."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 1, "creation_date": 1563384946, "post_id": 57081289, "comment_id": 100685730, "body": "Compiler Explorer (gcc.godbolt.org) has a nice selection of compilers/platforms. Why not test it there and post the results? I would upvote."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "edited": false, "score": 0, "creation_date": 1563384991, "post_id": 57081289, "comment_id": 100685751, "body": ":) Well it is C++ code, so you&#39;d need to convert it to C."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1563385026, "post_id": 57081289, "comment_id": 100685771, "body": "<i>I&#39;ve attached straightforward C++ source code to tell the bit-field truth</i> How many different compilers did you use?  On how many different systems?  How many of those systems were big-endian?  How many of those systems were little-endian?  From what you&#39;ve posted, your &quot;truth&quot; applies to using one compiler on one operating system running on little-endian hardware.  That&#39;s no &quot;truth&quot;.  If you want to make an assertion, do the work to support it."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "edited": false, "score": 0, "creation_date": 1563385101, "post_id": 57081289, "comment_id": 100685813, "body": "In general the OP question applies to both C and C++, that is, unless somebody can point to a C++ spec where all of the ambiguity cited in the C standard is settled."}, {"owner": {"reputation": 374839, "user_id": 734069, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a356923f858fbe363dad1dc566837fc6?s=128&d=identicon&r=PG", "display_name": "Nicol Bolas", "link": "https://stackoverflow.com/users/734069/nicol-bolas"}, "edited": false, "score": 4, "creation_date": 1563385172, "post_id": 57081289, "comment_id": 100685847, "body": "@RBornert: &quot;<i>This looming freedom for the compiler seems to be a full-stop for many who claim &quot;you cannot trust bit-fields&quot;, or &quot;bit-fields are not portable.&quot;</i>&quot; I&#39;m not sure I understand your point. Or more specifically, it&#39;s not clear exactly what these objections are referring to. You&#39;re basically claiming that &quot;some people&quot; have said &quot;some thing&quot;, in some context you have not provided, and then dared people to find practical examples of that &quot;some thing&quot; being the case. Bitfields certainly are portable, in that <i>valid</i> code written against them will work across platforms."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1563386072, "post_id": 57081289, "comment_id": 100686248, "body": "The (non) portability of bitfields is often misunderstood.  Bitfields are just about exactly as portable as ordinary ints.  If you&#39;re describing data structures to be used within a program, they&#39;re quite portable and can be used perfectly portably.  But if you&#39;re describing data formats to be used for interchange, read/written to files or network streams, there are significant portability difficulties.  These can generally be overcome (for bitfields as well as for ordinary ints), although ugly ifdefs may be required."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563386764, "post_id": 57081289, "comment_id": 100686541, "body": "@AndrewHenle You&#39;re more or less making my point.  You&#39;re trying to burden me with questing to find a bunch of exotic architecture.  I can&#39;t and not for trying.  Big endian is not as common, now, as the caution suggests.  In the early days of computing, Big endian was more common.  How many members here will ACTUALLY post output results that diverge from what I posted?  That any of us can consider the possibility of Big Foot is not the same as actually finding one right now. :)   Opinions about Big Foot are easy.  Finding one not so much these days."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1563387438, "post_id": 57081289, "comment_id": 100686831, "body": "@RBornert &quot;I don&#39;t think that will happen, so it can be ignored&quot;?  How&#39;s that working for Boeing? You&#39;re also assuming bit-field layout is only influenced by endianness.  That&#39;s wrong, too. &quot;Implementation-defined&quot; means the compiler gets to choose - different compilers on the same platform can do it differently.  Writing robust, reliable code means you discount <b>nothing</b>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1563387733, "post_id": 57081289, "comment_id": 100686979, "body": "I&#39;m someone who has said &quot;<a href=\"https://stackoverflow.com/questions/53118858/bit-manipulations-good-practices/53119001#53119001\">don&#39;t use bitfields</a>&quot;.  But you&#39;re probably right: there&#39;s probably a vast majority of little-endian machines out there that all do bitfields the same way.  If you want to assume that architecture, you probably won&#39;t get in too much trouble, and no one here is going to stop you.  (It sounds like your mind&#39;s basically made up already, anyway.)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1563388033, "post_id": 57081289, "comment_id": 100687113, "body": "@SteveSummit <i>Bitfields are just about exactly as portable as ordinary ints</i> I&#39;ll have to disagree with that.  Compilers aren&#39;t free change the ordering of integral values in a structure.  They can with bit-fields."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563388182, "post_id": 57081289, "comment_id": 100687188, "body": "@AndrewHenle  I agree with you in the case where the developer does not have any control over the nature of the software at a network endpoint.  If you control the compiler and CPU architecture for network endpoints, then bit-field endianness is NOT an issue.  I&#39;d like to point out that Microsoft did a decent job of removing the ambiguity for bit field sizing and alignment.  The nature of the output I posted is evidence of such.  Also, GNU has compiler flags that conform to Microsoft normalization."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563388705, "post_id": 57081289, "comment_id": 100687425, "body": "@RBornert You&#39;re also assuming what you have control over now you&#39;ll remain in control of in the future. The output currently posted doesn&#39;t even establish that Microsoft treats bit-fields consistently. Barring bugs every compiler pretty much <b>must</b> do that - you just don&#39;t prove it here as you compile your code <i>once</i>. You didn&#39;t document testing it with different compiler options, 32-bit vs. 64-bit, different versions of the compiler, different versions of the OS, yet you&#39;re claiming you&#39;ve removed the ambiguity?"}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563389303, "post_id": 57081289, "comment_id": 100687702, "body": "@AndrewHenle  If you use any recent Microsoft compiler on Intel or AMD systems, you will get the posted output for both 32bit and 64bit builds.  And in fact I&#39;ve been writing C source code since 1987, C++ since 1990. Not once have I seen any C/C++ compiler NOT pack bit-fields exactly like the posted output.  Where is the evidence for any C/C++ compiler that is packing bit-fields differently?  Show me the evidence please."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1563390310, "post_id": 57081289, "comment_id": 100688157, "body": "@RBornert <i>If you use any recent Microsoft compiler on Intel or AMD systems, you will get the posted output for both 32bit and 64bit builds.</i>  If that&#39;s the entirety of your universe, fine. But you&#39;re trying to imply what works there will work everywhere, and it&#39;s up to us to actually prove it won&#39;t.  I&#39;d say you have that backwards.  I&#39;d rather write code based on assurances that things <b>will</b> work no matter what and therefore prefer strictly-compliant C code that doesn&#39;t rely on implementation-defined behavior."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "edited": false, "score": 0, "creation_date": 1563391105, "post_id": 57081289, "comment_id": 100688487, "body": "<a href=\"https://docs.microsoft.com/en-us/cpp/cpp/cpp-bit-fields?view=vs-2019\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/cpp/cpp-bit-fields?view=vs-2019</a> : &quot;The ordering of data declared as bit fields is from low to high bit, as shown in the figure above.&quot;  <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.8.5/gcc/Variable-Attributes.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc-4.8.5/gcc/Variable-Attributes.htm&zwnj;&#8203;l</a> : &quot;-mms-bitfields&quot; flag will have the compiler produce bitfields per Microsofts low to high packing."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563391525, "post_id": 57081289, "comment_id": 100688666, "body": "@AndrewHenle  Ok let us say &quot;my world&quot; is limited to Windows systems and Linux systems.  Where is the evidence that I need to worry about anything?  MS has removed all ambiguity about bit-packing and the gnu compiler will conform to what MS is doing.  So these 2 environments cover what percentage of computers right now?  I&#39;m not claiming there are zero Big Foot.  I&#39;m claiming that the evidence for needing to care about Big Foot is disappearing."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1563393661, "post_id": 57081289, "comment_id": 100689635, "body": "@RBornert I don&#39;t think we&#39;re going to hear a collective forehead slap, from all of the commenters here, saying &quot;Zounds!  You&#39;re right!  Bitfields are no longer a portability issue!  We should all use them (with assumptions about their ordering) with wild abandon now!&quot;  Equally, I don&#39;t think we&#39;re going to convince you that bitfield portability is still something to be concerned about.  So I&#39;m not seeing where this discussion is going."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1563394821, "post_id": 57081289, "comment_id": 100690145, "body": "@SteveSummit Let&#39;s agree that for OS source code and compiler source code and open network packet exchange source code, no forehead &quot;Zounds&quot; will be happening.  However, for application layer developers who have a lot of control over target run environments including hardware and compilers, I cannot find any reason to not use bit-fields as a matter of safe predictable convenience.  I will let the source code I posted stand as evidence until somebody posts a valid instance of it failing to work as expected.  At a minimum, a Win/Linux developer can probably say &quot;Zounds!&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1563385417, "post_id": 57081370, "comment_id": 100685949, "body": "I&#39;ll note that the code you posted implicitly assumes the compiler used will place the bit-fields in the proper locations per relevant IP standards based merely on the endianness of the machine.  There&#39;s nothing in the C standard that requires that."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "edited": false, "score": 0, "creation_date": 1563385429, "post_id": 57081370, "comment_id": 100685957, "body": "I hear you.  Have been aware of examples like this my entire career.  I understand endianness issues.  This struct is evidence that the looming endianness issue is solved.  The nature of my post has to do with the &quot;actual number of Big Foot&quot; in the forest versus &quot;omg there might be a Big Foot&quot; in the forest."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "edited": false, "score": 2, "creation_date": 1563385540, "post_id": 57081370, "comment_id": 100686007, "body": "@RBornert Ignoring the Big Foot that might be in the forest is how you wind up with sloppy code that gets stomped with bugs.  My standards are higher than that."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563387202, "post_id": 57081370, "comment_id": 100686725, "body": "@AndrewHenle  On an open network with no expectation of any normalcy other then Network byte order, then I agree with you.  However, for client server systems where the developer controls both sides then there is no reason to be scared of bit-fields.  I&#39;ve used them safely for years in a controlled predictable context."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "edited": false, "score": 0, "creation_date": 1563388231, "post_id": 57081370, "comment_id": 100687224, "body": "@RBornert Your use of ridicule (Big Foot?!? really?) and straw men (&quot;scared of bit-fields&quot;) is based on what?"}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "edited": false, "score": 0, "creation_date": 1563391079, "post_id": 57081370, "comment_id": 100688470, "body": "<a href=\"https://docs.microsoft.com/en-us/cpp/cpp/cpp-bit-fields?view=vs-2019\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/cpp/cpp/cpp-bit-fields?view=vs-2019</a> : &quot;The ordering of data declared as bit fields is from low to high bit, as shown in the figure above.&quot;  <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.8.5/gcc/Variable-Attributes.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc-4.8.5/gcc/Variable-Attributes.htm&zwnj;&#8203;l</a> : &quot;-mms-bitfields&quot; flag will have the compiler produce bitfields per Microsofts low to high packing."}, {"owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "edited": false, "score": 0, "creation_date": 1563400699, "post_id": 57081370, "comment_id": 100692193, "body": "Just found this, and to some degree, there is an attempt to say the same thing.  <a href=\"https://softwareengineering.stackexchange.com/questions/165899/has-little-endian-won\" title=\"has little endian won\">softwareengineering.stackexchange.com/questions/165899/&hellip;</a>"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 5, "last_activity_date": 1563384631, "creation_date": 1563384631, "answer_id": 57081370, "question_id": 57081289, "link": "https://stackoverflow.com/questions/57081289/c-c-is-bitfield-endianess-really-a-problem-in-actual-practice/57081370#57081370", "title": "C/C++ Is bitfield endianess really a problem in actual practice?", "body": "<p>One common way that bitfields can differ is in bit endianness.  Little endian machine will have the low order bits first while big endian machines have the high order bits first.</p>\n\n<p>As an example, here is the definition of <code>struct iphdr</code>, which models an IP header, taken from /usr/include/netinet/ip.h on a CentOS 7.2 system:</p>\n\n<pre><code>struct iphdr\n  {\n#if __BYTE_ORDER == __LITTLE_ENDIAN\n    unsigned int ihl:4;\n    unsigned int version:4;\n#elif __BYTE_ORDER == __BIG_ENDIAN\n    unsigned int version:4;\n    unsigned int ihl:4;\n#else\n# error \"Please fix &lt;bits/endian.h&gt;\"\n#endif\n    u_int8_t tos;\n    u_int16_t tot_len;\n    u_int16_t id;\n    u_int16_t frag_off;\n    u_int8_t ttl;\n    u_int8_t protocol;\n    u_int16_t check;\n    u_int32_t saddr;\n    u_int32_t daddr;\n    /*The options start here. */\n  };\n</code></pre>\n\n<p>This struct is meant to be layered directly on top of a buffer containing a raw IP datagram at the point the IP header starts.  Note that the ordering of the <code>version</code> and <code>ihl</code> fields differ depending on the endianness.</p>\n\n<p>And in reference to this:</p>\n\n<blockquote>\n  <p>a whole herd of compiler writers and CPU makers conspiring in a star chamber, just grinning and anxious to do some exotic bit-field sizing and alignments simply because the standard permits.</p>\n</blockquote>\n\n<p>Compiler writers are indeed quick to take advantage of any behavior undefined or unspecified by the standard in order to perform a wide variety of optimizations that might surprise those that think C always behaves as a thin wrapper around assembly language.</p>\n"}], "owner": {"reputation": 21, "user_id": 5498998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67bd3bd72594851bd5a617fbcaf621ed?s=128&d=identicon&r=PG&f=1", "display_name": "RBornert", "link": "https://stackoverflow.com/users/5498998/rbornert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1563384631, "creation_date": 1563384313, "question_id": 57081289, "link": "https://stackoverflow.com/questions/57081289/c-c-is-bitfield-endianess-really-a-problem-in-actual-practice", "title": "C/C++ Is bitfield endianess really a problem in actual practice?", "body": "<p>So per the C compiler standard here:</p>\n\n<p><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf\" rel=\"nofollow noreferrer\">http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf</a></p>\n\n<p>We find a failure to pin down requirements for exactly how bit-fields get implemented inside a C compiler.  Apparently, as long as the bit-fields behave like any other scalar field, anything goes.  The doc section 6.7.2.1-10 says:</p>\n\n<blockquote>\n  <p>\"An implementation may allocate any addressable storage unit large\n  enough to hold a bit-field. If enough space remains, a bit-field that\n  immediately follows another bit-field in a structure shall be packed\n  into adjacent bits of the same unit. If insufficient space remains,\n  whether a bit-field that does not fit is put into the next unit or\n  overlaps adjacent units is implementation-defined. The order of\n  allocation of bit-fields within a unit (high-order to low-order or\n  low-order to high-order) is implementation-defined. The alignment of\n  the addressable storage unit is unspecified.\"</p>\n</blockquote>\n\n<p>This looming freedom for the compiler seems to be a full-stop for many who claim \"you cannot trust bit-fields\",  or \"bit-fields are not portable.\"  The alarm suggests a whole herd of compiler writers and CPU makers conspiring in a star chamber, just grinning and anxious to do some exotic bit-field sizing and alignments simply because the standard permits.</p>\n\n<p>WHERE IS THE EVIDENCE for these crazy bohemian compiler/CPU designers who are dedicated to guaranteeing that bit-fields remain forever undependable and unportable?  I want to see actual hard evidence of the green-men on mars.</p>\n\n<p>I've attached straightforward C++ source code to tell the bit-field truth about any system with a C++ compiler.  I am asking the community, NOT for opinion, but for hard output evidence for your system and compiler if it diverges from the results posted.  If I had the ability to poll the entire C/C++ community for same/not-same vote compared to the posted results, I wonder what the percentages would be?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n/*\n A simple program to illustrate the bitfields actual internal compiled layout.\n Results depend on machine architecture and compiler implementation and flags.\n*/\n\ntypedef unsigned long long int ulli;\n\nstruct bitf\n{\n    //   field      bits  offset\n    ulli f0         : 1; // 0\n    ulli f1         : 2; // 1\n    ulli f3         : 3; // 3\n    ulli f7         : 4; // 6\n    ulli f15        : 5; // 10\n    ulli f31        : 6; // 15\n    ulli f63        : 7; // 21\n    ulli f127       : 8; // 28\n    ulli f255       : 9; // 36\n    ulli f511       :10; // 45\n    ulli end        : 9; // 55\n                         // 64\n\n    bitf():\n         f0         ( 0 )\n        ,f1         ( 1 )\n        ,f3         ( 3 )\n        ,f7         ( 7 )\n        ,f15        ( 15 )\n        ,f31        ( 31 )\n        ,f63        ( 63 )\n        ,f127       ( 127 )\n        ,f255       ( 255 )\n        ,f511       ( 511 )\n        ,end        ( 0 )\n    {}\n\n    ulli get_shft() const\n    {\n        ulli bits=0;\n        bits &lt;&lt;= 9; bits |=   0;\n        bits &lt;&lt;=10; bits |= 511;\n        bits &lt;&lt;= 9; bits |= 255;\n        bits &lt;&lt;= 8; bits |= 127;\n        bits &lt;&lt;= 7; bits |=  63;\n        bits &lt;&lt;= 6; bits |=  31;\n        bits &lt;&lt;= 5; bits |=  15;\n        bits &lt;&lt;= 4; bits |=   7;\n        bits &lt;&lt;= 3; bits |=   3;\n        bits &lt;&lt;= 2; bits |=   1;\n        bits &lt;&lt;= 1; bits |=   0;\n        return bits;\n    }\n\n    ulli get_cast() const\n    {\n        ulli bits = *((ulli*)(this));\n        return bits;\n    }\n};\n\nint main()\n{\n    bitf bf;\n    ulli shft = bf.get_shft();\n    ulli cast = bf.get_cast();\n\n    printf(\"sizeof(ulli) is %zu\\n\\n\",sizeof(ulli));\n    printf(\"shft%scast\\n\\n\",(shft==cast)?\"==\":\"!=\");\n    printf(\"BITS from MSB 63 (left) down to LSB 0 (right)\\n\");\n    printf(\"    : \"); for(int i=63; i&gt;=0; i--) printf(\"%c\",(i%10)==0 ? i/10 +'0' : ' '); printf(\"\\n\");\n    printf(\"    : \"); for(int i=63; i&gt;=0; i--) printf(\"%d\",i%10); printf(\"\\n\");\n    printf(\"shft: \"); for(int i=63; i&gt;=0; i--) printf(\"%llu\",(shft&gt;&gt;i)&amp;1); printf(\"\\n\");\n    printf(\"cast: \"); for(int i=63; i&gt;=0; i--) printf(\"%llu\",(cast&gt;&gt;i)&amp;1); printf(\"\\n\");\n    printf(\"    : ====----====----====----====----====----====----====----====----\\n\");\n    printf(\"shft: \"); for(int i=15;i&gt;=0;i--) printf(\"%4llx\",(shft&gt;&gt;(i*4)&amp;0xf)); printf(\"\\n\");\n    printf(\"cast: \"); for(int i=15;i&gt;=0;i--) printf(\"%4llx\",(cast&gt;&gt;(i*4)&amp;0xf)); printf(\"\\n\");\n    printf(\"    : ====----====----====----====----====----====----====----====----\\n\");\n    unsigned char *pb;\n    pb = (unsigned char*)(&amp;shft);\n    printf(\"shft: \"); for(int i=sizeof(shft)-1; i&gt;=0; i--) printf(\"%8x\", pb[i]); printf(\"\\n\");\n    pb = (unsigned char*)(&amp;cast);\n    printf(\"cast: \"); for(int i=sizeof(cast)-1; i&gt;=0; i--) printf(\"%8x\", pb[i]); printf(\"\\n\");\n    printf(\"\\n\");\n\n    printf(\"&lt;ENTER&gt;\"); getchar();\n    return 0;\n}\n</code></pre>\n\n<p>Results for Intel Core i7, Win10, VS2015, 64bit build</p>\n\n<pre><code>sizeof(ulli) is 8\n\nshft==cast\n\nBITS from MSB 63 (left) down to LSB 0 (right)\n    :    6         5         4         3         2         1         0\n    : 3210987654321098765432109876543210987654321098765432109876543210\nshft: 0000000000111111111011111111011111110111111011111011110111011010\ncast: 0000000000111111111011111111011111110111111011111011110111011010\n    : ====----====----====----====----====----====----====----====----\nshft:    0   0   3   f   e   f   f   7   f   7   e   f   b   d   d   a\ncast:    0   0   3   f   e   f   f   7   f   7   e   f   b   d   d   a\n    : ====----====----====----====----====----====----====----====----\nshft:        0      3f      ef      f7      f7      ef      bd      da\ncast:        0      3f      ef      f7      f7      ef      bd      da\n\n&lt;ENTER&gt;\n</code></pre>\n"}, {"tags": ["c", "function", "syntax", "header-files"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1563384910, "post_id": 57081281, "comment_id": 100685718, "body": "What <i>do</i> happen when you run the program? What is the output you <i>do</i> get? Please take some to read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1563384984, "post_id": 57081281, "comment_id": 100685749, "body": "Fix your casing in your file names so that it matches your includes."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1563385138, "post_id": 57081281, "comment_id": 100685829, "body": "<a href=\"https://repl.it/@robertwharvey/Just-Print\" rel=\"nofollow noreferrer\">repl.it/@robertwharvey/Just-Print</a>"}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 2, "last_activity_date": 1563384900, "creation_date": 1563384900, "answer_id": 57081434, "question_id": 57081281, "link": "https://stackoverflow.com/questions/57081281/how-to-use-a-function-from-a-second-c-file-in-the-main-c-file/57081434#57081434", "title": "How to use a function from a second C file in the main C file?", "body": "<p>In main.c, change:</p>\n\n<pre><code>void app_main() {\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>int main(void) {\n</code></pre>\n\n<p>and then compile like:</p>\n\n<blockquote>\n  <p>gcc main.c just_printf.c</p>\n</blockquote>\n\n<p>and the output will be (after executing a.out):</p>\n\n<pre><code>Georgioss-MBP:~ gsamaras$ ./a.out \nattempting to call print\ntried to prrint\n</code></pre>\n\n<p>You should get a warning about implicit declaration of the function printf, since you don't include <code>stdio.h</code> - do that in the header file, I would suggest, like this: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n</code></pre>\n\n<p>Suggestion: In the header file, the include guard would be usually written like:</p>\n\n<pre><code>JUST_PRINT_H\n</code></pre>\n\n<p>i.e., without the trailing underscore, and the full name of the file, in capital characters.</p>\n"}], "owner": {"reputation": 143, "user_id": 11644444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KGtc7.jpg?s=128&g=1", "display_name": "phantomBlurrr", "link": "https://stackoverflow.com/users/11644444/phantomblurrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 57081434, "answer_count": 1, "score": 2, "last_activity_date": 1563386969, "creation_date": 1563384290, "last_edit_date": 1563386969, "question_id": 57081281, "link": "https://stackoverflow.com/questions/57081281/how-to-use-a-function-from-a-second-c-file-in-the-main-c-file", "title": "How to use a function from a second C file in the main C file?", "body": "<p>I'm trying to split up a large C file because it's very difficult to read and keep track of what's doing what. I read up on it and it supposed to be as simple as creating a c file that contains the function, then a header file that references the function, then include the header file in main c file and simply use the function. However, I've done that and the function in question isn't actually being called in my code.</p>\n\n<p>I tried placing printf statements in the function so I could see if it was really being called and these do not show up in monitor (which I interpret as the function is not being called)</p>\n\n<pre><code>//MAIN.c\n#include \"just_printf.h\"\n\nvoid app_main(){\n    printf(\"attempting to call print\\n\");\n    just_print();\n}\n\n//---------------------------------------\n//JUST_PRINTF.h\n#ifndef MAIN_JUST_PRINT_H_\n#define MAIN_JUST_PRINT_H_\n\nvoid just_print();\n\n#endif\n\n//---------------------------------------\n//JUST_PRINTF.c\n#include \"just_printf.h\"\n\nvoid just_print(){\n    printf(\"tried to prrint\");\n}\n</code></pre>\n\n<p>When I run main.c, it's supposed to print \"attempting to call print\" then when it calls just_print() it's supposed to print \"tried to prrint\". This is just a sanity check before I try moving actual functionality out of my main.c file. What am I doing wrong? Am I misunderstanding how to split up a c file? Right now all I get is the first printf statement before the function call.</p>\n"}, {"tags": ["c", "opengl", "transparency", "glfw"], "comments": [{"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1563386079, "post_id": 57080896, "comment_id": 100686251, "body": "As far as the code in the question goes, you will have a cleared back buffer. So even if your system / compositor supports this kind of transparency, there is no reason for it to appear at this point."}, {"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "reply_to_user": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1563388246, "post_id": 57080896, "comment_id": 100687234, "body": "@derhass: Since I don&#39;t understand what is happening: Could you explain why an alpha of 0.1 shouldn&#39;t cause a transparent window?"}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1563471927, "post_id": 57080896, "comment_id": 100721304, "body": "The code is far from being a complete example. I just tried to point out that it is unclear if that buffer content is ever swapped to the front buffer."}, {"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "reply_to_user": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "edited": false, "score": 0, "creation_date": 1563543033, "post_id": 57080896, "comment_id": 100745821, "body": "@derhass: I copied his code in an otherwise perfectly working example. When all of the color channels are 1, then the window is not transparent, no matter what alpha is. E.g. (1,1,1,0) is completely opaque. (1,0,1,0) is partially transparent. I can&#39;t explain what is happening though."}, {"owner": {"reputation": 38487, "user_id": 2327517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Bulc.jpg?s=128&g=1", "display_name": "derhass", "link": "https://stackoverflow.com/users/2327517/derhass"}, "reply_to_user": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "edited": false, "score": 0, "creation_date": 1563559649, "post_id": 57080896, "comment_id": 100753732, "body": "@BDL that looks like your compositor is expecting pre-multiplied alpha."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10223201, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l2ks6xVzo3E/AAAAAAAAAAI/AAAAAAAAAA8/-1pnevGj93Y/photo.jpg?sz=128", "display_name": "AregevDev", "link": "https://stackoverflow.com/users/10223201/aregevdev"}, "edited": false, "score": 0, "creation_date": 1563384324, "post_id": 57081108, "comment_id": 100685461, "body": "This gives the same result"}, {"owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "reply_to_user": {"reputation": 29, "user_id": 10223201, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l2ks6xVzo3E/AAAAAAAAAAI/AAAAAAAAAA8/-1pnevGj93Y/photo.jpg?sz=128", "display_name": "AregevDev", "link": "https://stackoverflow.com/users/10223201/aregevdev"}, "edited": false, "score": 0, "creation_date": 1563385961, "post_id": 57081108, "comment_id": 100686191, "body": "@AregevDev What I wrote is definitely a problem. But there seems to be some other issues with the clear color. When I set it to (0,0,0,0), the window gets transparent. At the moment where I set all channels to one (1,1,1,0) transparency is gone. Unfortunately, I really can&#39;t explain why this happens."}], "tags": [], "owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "is_accepted": false, "score": 1, "last_activity_date": 1563383640, "creation_date": 1563383640, "answer_id": 57081108, "question_id": 57080896, "link": "https://stackoverflow.com/questions/57080896/how-to-enable-framebuffer-transparency-in-glfw/57081108#57081108", "title": "How to enable framebuffer transparency in GLFW?", "body": "<p><code>glfwWindowHint</code> has to be called <strong>before</strong> the window gets created (which can be seen in the demo you mentioned). Otherwise they do not have any effect. Correct code:</p>\n\n<pre><code>glfwWindowHint(GLFW_VERSION_MAJOR, 3);\nglfwWindowHint(GLFW_VERSION_MINOR, 3);\nglfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\nglfwWindowHint(GLFW_RESIZABLE, 1);\nglfwWindowHint(GLFW_TRANSPARENT_FRAMEBUFFER, 1);\n\nGLFWwindow *window = glfwCreateWindow(500, 500, \"opengl\", NULL, NULL);\nif (!window) {\n    printf(\"Could not create GLFW window\");\n    return 1;\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10223201, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l2ks6xVzo3E/AAAAAAAAAAI/AAAAAAAAAA8/-1pnevGj93Y/photo.jpg?sz=128", "display_name": "AregevDev", "link": "https://stackoverflow.com/users/10223201/aregevdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1604721848, "creation_date": 1563382708, "question_id": 57080896, "link": "https://stackoverflow.com/questions/57080896/how-to-enable-framebuffer-transparency-in-glfw", "title": "How to enable framebuffer transparency in GLFW?", "body": "<p>I am stuck with window transparency in GLFW, I followed their window guide and examples but nothing seems to work...\nGLFW version 3.3 with OpenGL 3.3 as well.</p>\n\n<p>I went through the gears example in GLFW's repository, which introduces a completely transparent window, copied the required window hint (<code>GLFW_FRAMEBUFFER_TRANSPARENCY</code>) and set it to true. This does not work for me</p>\n\n<p>I am initializing my window using the following:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if (!glfwInit()) {\n    printf(\"Could not initialize GLFW\\n\");\n    return 1;\n}\n\nGLFWwindow *window = glfwCreateWindow(500, 500, \"opengl\", NULL, NULL);\nif (!window) {\n    printf(\"Could not create GLFW window\");\n    return 1;\n}\n\nglfwWindowHint(GLFW_VERSION_MAJOR, 3);\nglfwWindowHint(GLFW_VERSION_MINOR, 3);\nglfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);\nglfwWindowHint(GLFW_RESIZABLE, 1);\nglfwWindowHint(GLFW_TRANSPARENT_FRAMEBUFFER, 1);\n\nglfwMakeContextCurrent(window);\nglfwSwapInterval(1);\nglfwSetFramebufferSizeCallback(window, resizeCallback);\n</code></pre>\n\n<p>Then I clear this way:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>glClearColor(1.0, 1.0, 1.0, 0.1);\nglClear(GL_COLOR_BUFFER_BIT);\n</code></pre>\n\n<p>I expect the window to be semi-transparent, did I missed something?</p>\n"}, {"tags": ["c", "string", "char", "strcmp"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1563382159, "post_id": 57080733, "comment_id": 100684522, "body": "You cannot compare a pointer-to-character as a string. <b>It&#39;s not nul-terminated</b> (which is why you get additional characters) Now you can fudge it by using a 2-character array with the last character <code>0</code>, e.g. <code>char ch[2] = &quot;&quot;;</code> and then use <code>ch[0] = line[1];</code> and <code>strcmp(ch, &quot;V&quot;)</code>. ALL <i>string</i> functions in C require a <i>nul-terminated</i> string as their argument."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1563382192, "post_id": 57080733, "comment_id": 100684543, "body": "What is ch pointing at?"}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1563382806, "post_id": 57080733, "comment_id": 100684788, "body": "In the shown code, ch is an uninitialized pointer.   That is, it holds a pointer, but was never told what to point to.   So, it might point to NULL, and it might point to some random address.   When you set <code>ch[0] = line[1]</code>, then you&#39;re writing the character at <code>line[1]</code> to wherever <code>ch</code> happens to be pointing.   If <code>ch</code> happens to be a valid address, then this means you&#39;re <i>scribbling</i> over some other data that might be important to someone else.  If it&#39;s not a valid address, you get a segmentation fault..."}, {"owner": {"reputation": 3767, "user_id": 8710344, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e2292c452c0d0c9824d2aa38bb74d9fc?s=128&d=identicon&r=PG&f=1", "display_name": "HardcoreHenry", "link": "https://stackoverflow.com/users/8710344/hardcorehenry"}, "edited": false, "score": 0, "creation_date": 1563383102, "post_id": 57080733, "comment_id": 100684919, "body": "You should familiarize yourself with c strings -- learn what a character holds vs what a character pointer holds, learn the syntax  <code>&quot;V&quot;</code> vs<code>&#39;V&#39;</code>, and learn what null-termination means."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1563382659, "creation_date": 1563382659, "answer_id": 57080881, "question_id": 57080733, "link": "https://stackoverflow.com/questions/57080733/how-to-create-a-pointer-to-only-the-first-letter-of-a-string/57080881#57080881", "title": "How to create a pointer to only the first letter of a string", "body": "<p>The errors you're getting is because <code>ch</code> does not point to a null terminated string.</p>\n\n<p>In the first case:</p>\n\n<pre><code>char* ch;\nch[0] = line[1];\n</code></pre>\n\n<p>The pointer <code>ch</code> hasn't been initialized, but you then dereference the pointer (implicitly via the array subscript operator <code>[]</code>) in an attempt to write to it.  Dereferencing an uninitialized pointer invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, which in your case gives unexpected output.</p>\n\n<p>Similarly for the second case:</p>\n\n<pre><code>char ch[1];\nch[0] = line[1];\n</code></pre>\n\n<p>Here <code>ch</code> is an array of size 1 and you assign a value to that member.  But then you pass <code>ch</code> to <code>strcmp</code> which expects a null terminated string.  Since the array only contains 1 element, there is no space for the null terminator.  As a result the <code>strcmp</code> reads past the end of the array looking for one.  Reading past the end of an array also invokes undefined behavior.</p>\n\n<p>To do a proper string comparison, the array must have room for the string in question which means the size must be at least 2:</p>\n\n<pre><code>char ch[2];\nch[0] = line[1];\nch[1] = 0;\n</code></pre>\n\n<p>However, your goal is not to compare strings.  You want to compare a single character instead.  To do that, just use single quotes to denote a character constant and compare that directly against the element in question:</p>\n\n<pre><code>printf(\"test:%c \", line[1]);\nprintf(\"strcmp result: %d\\n\", (line[1] == 'V'));\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11798738, "user_type": "registered", "profile_image": "https://graph.facebook.com/1795452787224134/picture?type=large", "display_name": "Jakegar", "link": "https://stackoverflow.com/users/11798738/jakegar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 57080881, "answer_count": 1, "score": -3, "last_activity_date": 1563382659, "creation_date": 1563381954, "question_id": 57080733, "link": "https://stackoverflow.com/questions/57080733/how-to-create-a-pointer-to-only-the-first-letter-of-a-string", "title": "How to create a pointer to only the first letter of a string", "body": "<p>I'm trying to use strcmp() to compare to the first letter of the string line (which should be \"V\") with the letter \"V\" in c. </p>\n\n<p>I've tried several different methods of trying to create a pointer to only the first letter of the string in order to use to compare.  My latest solution seemed to work better but is adding some string of letters after the initial assignment. </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\n    printf(\"test:%c \", line[1]);\n    char* ch;\n    ch[0] = line[1];\n    printf(\"ch is: %s\\n\", ch);  \n    printf(\"strcmp result: %d\\n\", strcmp(ch, \"V\"));\n\n</code></pre>\n\n<p>line is already initialized as a long string (read from a file).\nThe second letter of line is \"V\", so I would expect ch = \"V\".  However, these results show up: </p>\n\n<p>test:V </p>\n\n<p>ch is: VL?[?</p>\n\n<p>strcmp result: 76</p>\n\n<p>Similarly, this code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    char ch[1];\n    ch[0] = line[1];\n    printf(\"ch is: %s\\n\", ch);\n    printf(\"strcmp result: %d\\n\", strcmp(ch, \"V\"));\n</code></pre>\n\n<p>provides this incorrect answer:\ntest:V </p>\n\n<p>ch is: V?   </p>\n\n<p>strcmp result: 133</p>\n\n<p>Wondering why those extra letters show up in ch, and if there's a better way to do this in general.  My entire program relies on reading and comparing certain letters in the string line so this is an essential part of it. </p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["c", "linux", "shell"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1563379966, "post_id": 57080216, "comment_id": 100683434, "body": "Terminal signals aren&#39;t sent to background processes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 1, "creation_date": 1563380068, "post_id": 57080216, "comment_id": 100683502, "body": "What happens if you start your shell and just type Ctrl-C at the prompt, without running any command first? And what happens if you do that in any of the well-known shells (ash, ksh, bash, csh...)?"}, {"owner": {"reputation": 32193, "user_id": 2908724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1xBJR.png?s=128&g=1", "display_name": "bishop", "link": "https://stackoverflow.com/users/2908724/bishop"}, "edited": false, "score": 1, "creation_date": 1563380193, "post_id": 57080216, "comment_id": 100683589, "body": "Use <code>kill</code> to signal a background process, as in (bash): <code>sleep 60 &amp; kill $!</code>"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1563381558, "post_id": 57080216, "comment_id": 100684224, "body": "What do you expect to happen? We don&#39;t know how you handle <code>CTRL+C</code>. When you run <code>echo hello &amp;</code>, the background process should exit very fast. When you press <code>CTRL+C</code> after seeing the output, it is too late even if your shell really sends a signal to the background process. Try something like <code>sleep 60</code> or other long-running commands."}, {"owner": {"reputation": 407, "user_id": 7870784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b620ec2fb060d76bc73b291c4459439b?s=128&d=identicon&r=PG&f=1", "display_name": "roy cabouly", "link": "https://stackoverflow.com/users/7870784/roy-cabouly"}, "edited": false, "score": 0, "creation_date": 1563381808, "post_id": 57080216, "comment_id": 100684346, "body": "What I meant that ctrl-c in the shell itself doesnt work after I run a backgorund process. e.g I cant return to the bash shell."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1563382178, "post_id": 57080216, "comment_id": 100684529, "body": "@roycabouly, btw, generally speaking, edits should be written to make the question as clear as possible to first-time readers. For that reason, we frown on edit markers -- better to make the question read as you would write it if you were asking it with the information included from the very beginning; anyone who wants to know what changed when can click the edit-history link to get that separately."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 32193, "user_id": 2908724, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1xBJR.png?s=128&g=1", "display_name": "bishop", "link": "https://stackoverflow.com/users/2908724/bishop"}, "edited": false, "score": 1, "creation_date": 1563382262, "post_id": 57080216, "comment_id": 100684570, "body": "@bishop After clarification, that is clearly not the duplicate.  The question should not be closed on that basis."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1563382298, "post_id": 57080216, "comment_id": 100684584, "body": "I somehow doubt that that fragment of code is sufficient, and possibly not even relevant."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1563382625, "post_id": 57080216, "comment_id": 100684716, "body": "Currently the misleading text remains unchanged and we only find out what you meant if we make it to the &quot;edit&quot; at the end.  Just edit the body to reflect accurately what you meant in the first instance.  I think your whole question can be reduced to just &quot;After spawning a background task, my shell program no longer terminates on Ctrl+C&quot;.  A succinct re-write is often better than just adding more words if you want to clarify."}, {"owner": {"reputation": 407, "user_id": 7870784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b620ec2fb060d76bc73b291c4459439b?s=128&d=identicon&r=PG&f=1", "display_name": "roy cabouly", "link": "https://stackoverflow.com/users/7870784/roy-cabouly"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1563383871, "post_id": 57080216, "comment_id": 100685288, "body": "@Clifford This is the main code run in the loop that executes the commands. the parser of the command work just fine and also the code of runcmd() that runs the command."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1563388413, "post_id": 57080216, "comment_id": 100687298, "body": "@roycabouly :  I appreciate that, but if you don&#39;t know what the problem is you are not really in a position to know <i>where</i> it is, and if the problem cannot be reproduced from what you have posted, it is hard to help.  With view of <i>all</i> the code, the first thing I&#39;d look for perhaps is whether a SIGINT handler is set-up at all."}, {"owner": {"reputation": 407, "user_id": 7870784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b620ec2fb060d76bc73b291c4459439b?s=128&d=identicon&r=PG&f=1", "display_name": "roy cabouly", "link": "https://stackoverflow.com/users/7870784/roy-cabouly"}, "edited": false, "score": 0, "creation_date": 1563389444, "post_id": 57080216, "comment_id": 100687758, "body": "I think I have solved it, the problem apperantly was due to a missed case in the parser. Thanks everyone for helping and sorry for this messed up question."}], "owner": {"reputation": 407, "user_id": 7870784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b620ec2fb060d76bc73b291c4459439b?s=128&d=identicon&r=PG&f=1", "display_name": "roy cabouly", "link": "https://stackoverflow.com/users/7870784/roy-cabouly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563384931, "creation_date": 1563379863, "last_edit_date": 1563384931, "question_id": 57080216, "link": "https://stackoverflow.com/questions/57080216/ctrl-c-doesnt-work-after-i-use-feature-in-my-custom-shell", "title": "ctrl-c doesnt work after I use &amp; feature in my custom shell", "body": "<p>I'm trying to write a background feature in a custom shell I'm building.(e.g the &amp; option like: echo hello &amp;)</p>\n\n<p>Everything works fine when I spawn forground processes, but after spwaning a background process my shell program doesn't terminate when ctrl-c is pressed.</p>\n\n<p>Here is the part of my code that responsible for running the new process as background/forground:</p>\n\n<pre><code>struct cmd* c=parsecmd(buf);\npid_t pid;\nsignal(SIGTTOU,SIG_IGN);\nif((pid=fork1()) == 0){\n  pid=getpid();\n  setpgid(pid,pid);\n  if((c-&gt;type &amp; 0x100)==0)//if forground\n    tcsetpgrp(0,pid);\n  signal(SIGTTOU,SIG_DFL);\n  runcmd(c);\n}\nsetpgid(pid,pid);\nif((c-&gt;type &amp; 0x100)==0){\n    tcsetpgrp(0,pid);\n    wait(&amp;r);\n    tcsetpgrp(0,getpgid(getpid()));\n}\n//printf(\"my pgid is %d and the forground pgid is %d\\n\",getpgid(getpid()),$\nsignal(SIGTTOU,SIG_DFL);\n</code></pre>\n\n<p>And here is what I get when I run it:</p>\n\n<pre><code>6.828$ echo hello &amp;\n6.828$ hello\n\n6.828$ ^C\n6.828$ \n</code></pre>\n\n<p>Can someone help me figure out what is my mistake here?</p>\n\n<p>Also I should say that when I use ctrl-c right after spawning the background process works. the thing that doesn't work is when I type enter and write ctrl-c and then it wont work even if I will continue spawning other commands(forground or background) .it works just fine when I type enter after spawning a forground. process(and </p>\n"}, {"tags": ["c", "x86", "intel", "glibc", "intel-tsx"], "comments": [{"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1563389859, "post_id": 57080062, "comment_id": 100687972, "body": "I don&#39;t have a GLIBC recent enough to test, but <a href=\"https://narkive.com/QsMy0Ect.6\" rel=\"nofollow noreferrer\">this link</a> contains the patch to the manual. It contains the attribute bit for the kind of the mutex to make it always (or never) use elision. It also says that mutex without a kind set uses the PTHREAD_MUTEX envar. It is old though."}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1563432476, "post_id": 57080062, "comment_id": 100699412, "body": "Would you please post a minimal example and show us how you compile and link it?"}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "reply_to_user": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1563436162, "post_id": 57080062, "comment_id": 100701156, "body": "@FlorianWeimer Hi, I updated the post, is this what you meant?"}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1563439238, "post_id": 57080062, "comment_id": 100702838, "body": "@MargaretBloom hi, I went through the link. I can&#39;t compile program if I use PTHREAD_MUTEX_INIT_NP or PTHREAD_MUTEX_ELISION_NP type. maybe it needs another gcc flag? I also tried running &quot;PTHREAD_MUTEX=elision&quot; directly from shell, does it need anything else? because this still does not seem to work."}, {"owner": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1563463309, "post_id": 57080062, "comment_id": 100716963, "body": "@AnaKhorguani I had the same problem compiling, I checked my GLIBC version and it wasn&#39;t recent enough. Unfortunately, I cannot update it right now."}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "reply_to_user": {"reputation": 33092, "user_id": 5801661, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D8ENZ.jpg?s=128&g=1", "display_name": "Margaret Bloom", "link": "https://stackoverflow.com/users/5801661/margaret-bloom"}, "edited": false, "score": 0, "creation_date": 1563470466, "post_id": 57080062, "comment_id": 100720639, "body": "@MargaretBloom Well thank you anyway. Just a weird thing is that this patch is around 6 years ago, and I tried with glibc 2.27 version now which is from last year, and still PTHREAD_MUTEX_ELISION_NP does not compile. gcc version is 7.4"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563472717, "post_id": 57080062, "comment_id": 100721633, "body": "According to <a href=\"https://ark.intel.com/content/www/us/en/ark/products/120492/intel-xeon-gold-6130-processor-22m-cache-2-10-ghz.html\" rel=\"nofollow noreferrer\">Intel</a>, your processor should support TSX-NI, but check for both <code>hle</code> and <code>rtm</code> in <code>&#47;proc&#47;cpuinfo</code> and make sure it&#39;s not been disabled using a microcode update (because it&#39;s buggy according to erratum SKX88). Also, <code>glibc.elision.enable</code> is supported starting with <a href=\"https://github.com/bminor/glibc/commit/07ed18d26a342741cb25a4739158c65ed9dd4d09\" rel=\"nofollow noreferrer\">glibc 2.27</a>. You can check your glibc version using <code>ldd --version</code>. Then we can see what to do."}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563474895, "post_id": 57080062, "comment_id": 100722565, "body": "@HadiBrais Both hle and rtm flags are presented. How can I check if it was disabled with microcode update? In Bugs it shows these: cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds. Current version of libc is 2.24, I will try to see if I can update it to 2.27"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 1, "creation_date": 1563475393, "post_id": 57080062, "comment_id": 100722772, "body": "If both hle and rtm flags are supported, then TSX-NI should work on your processor. I think the problem is with your glibc version. <code>glibc.elision.enable</code> has no effect on versions older than 2.27. If I remember corrcetly, older versions of glibc have to be compiled with <code>--enable-lock-elision=yes</code> for lock elision to work."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 1, "creation_date": 1563475600, "post_id": 57080062, "comment_id": 100722861, "body": "Just to clarify, glibc before 2.27 have to be compiled with <code>--enable-lock-elision=yes</code>, <b>not</b> your code. In contrast, starting with glibc 2.27, <b>your code</b> has to be run with <code>export GLIBC_TUNABLES=glibc.elision.enable=1</code>."}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "edited": false, "score": 0, "creation_date": 1563476104, "post_id": 57080062, "comment_id": 100723031, "body": "Ok I see. So either I should recompile existing glibc version with --enable-lock-elision=yes, or I should upgrade it to 2.27 and then run export GLIBC_TUNABLES=glibc.elision.enable=1 with it, right?"}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563622044, "post_id": 57080062, "comment_id": 100765891, "body": "@HadiBrais Thanks for the clarifications, I tried with glibc 2.27 version and it seems that export GLIBC_TUNABLES=glibc.elision.enable=1 works with that. Even thought I get 0 cycles for elision, I get up to 1% transactional cycles but all of them are aborted. This should be a &quot;problem&quot; of the program."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563622818, "post_id": 57080062, "comment_id": 100766045, "body": "Nice. I cannot comment on the &quot;0 cycles for elision&quot; because I don&#39;t what the code exactly is. Also it would be nice to know what events you&#39;re using. Note that there are performance events that you can use to determine why a transaction got aborted."}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "edited": false, "score": 0, "creation_date": 1563638983, "post_id": 57080062, "comment_id": 100769659, "body": "yes, what I&#39;m doing is a very general observation on the program. In the first place, I just wanted to determine if the program was benefiting from this new lock elision feature. I&#39;m using perf stat -T command which is sufficient so far, but I agree, I found several native counters mentioned for closer monitoring."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1563641859, "post_id": 57080062, "comment_id": 100770343, "body": "Your edit (that the env var works with glibc 2.27) looks like an answer.  You should probably post it as such instead of just an edit to the question."}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1563644161, "post_id": 57080062, "comment_id": 100770956, "body": "@PeterCordes Ok, I did so. I decided to update the post since it was HadiBrais suggestion that I checked and saw that it worked. But I agree that adding it as an answer is clearer."}], "answers": [{"comments": [{"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563644190, "post_id": 57127052, "comment_id": 100770966, "body": "If this answers your question, you can/should accept the answer by clicking on the check mark below the voting buttons."}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563644279, "post_id": 57127052, "comment_id": 100770990, "body": "Ok, but it was in fact your answer :)"}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 1, "creation_date": 1563645666, "post_id": 57127052, "comment_id": 100771311, "body": "That&#39;s OK, you can go ahead and accept the answer. I&#39;ve added more information if you don&#39;t mind, just to make the answer more complete."}, {"owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563646267, "post_id": 57127052, "comment_id": 100771464, "body": "@HadiBrais yes sure, this is a way more comprehensive answer. Thank you very much."}, {"owner": {"reputation": 7287, "user_id": 963864, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/94e2dd813e278309b6281b4a4b7fdddd?s=128&d=identicon&r=PG", "display_name": "curiousguy", "link": "https://stackoverflow.com/users/963864/curiousguy"}, "edited": false, "score": 1, "creation_date": 1563661619, "post_id": 57127052, "comment_id": 100774487, "body": "&quot;<i>this bug report,</i>&quot; please mention that that wasn&#39;t considered a bug in glibc"}], "tags": [], "owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "is_accepted": true, "score": 3, "last_activity_date": 1563655096, "last_edit_date": 1563655096, "creation_date": 1563643682, "answer_id": 57127052, "question_id": 57080062, "link": "https://stackoverflow.com/questions/57080062/enable-disable-hardware-lock-elision/57127052#57127052", "title": "Enable/Disable Hardware Lock Elision", "body": "<p>In earlier versions of glibc, before 2.27, support for TSX could only be controlled using a compile-time flag called <code>enable-lock-elision</code>. I don't know which versions have <code>enable-lock-elision</code> enabled or disabled, but that's how it used to work<sup>1</sup>. So if you wanted to enable/dsiable TSX, you'll have to compile glibc yourself and use that flag accordingly. Starting with <a href=\"https://github.com/bminor/glibc/commit/07ed18d26a342741cb25a4739158c65ed9dd4d09\" rel=\"nofollow noreferrer\">glibc 2.27</a>, that compile-time option was removed and replaced by a run-time option called <code>glibc.elision.enable</code>. That is, glibc is always compiled with support for TSX, but TSX will only be used if the environment variable <code>glibc.elision.enable</code> is set to 1 before running the application (e.g., by executing <code>export GLIBC_TUNABLES=glibc.elision.enable=1</code>).</p>\n\n<p>Before 2.27, <code>glibc.elision.enable</code> doesn't exist and so it has no effect. Whether TSX is used depends on the compile-time flag <code>enable-lock-elision</code>. You're using 2.24. So the easiest solution would be to move to 2.27 or a more recent version.</p>\n\n<p>Note that all current Intel processors that support TSX appear to have the same bug that \"using Intel TSX Instructions May Lead to Unpredictable System Behavior\" according to the respective specification updates. For some processors, Intel has released microcode updates to actually disable TSX. However, the implementation on your processor continues to be enabled.</p>\n\n<hr>\n\n<p><strong>Footnotes:</strong></p>\n\n<p>(1) According to this <a href=\"https://bugs.launchpad.net/ubuntu/+source/glibc/+bug/1642390\" rel=\"nofollow noreferrer\">bug report</a>, lock elision has been disabled in glibc starting with 2.23. I think this is done by disabling <code>enable-lock-elision</code> when building glibc, but I've not verified this by looking at the code. But this is consistent with your observation that it is disabled in 2.24.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1611609817, "post_id": 65892528, "comment_id": 116502902, "body": "Also note that all x86 CPUs with updated microcode have HLE disabled.  Only RTM is still available on any CPUs, if the OS allows.  <a href=\"https://stackoverflow.com/q/61310108\">Has Hardware Lock Elision gone forever due to Spectre Mitigation?</a>/"}], "tags": [], "owner": {"reputation": 41, "user_id": 15008211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a67dad4005eb276af64890cc5664912d?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/15008211/simon"}, "is_accepted": false, "score": 2, "last_activity_date": 1611637429, "last_edit_date": 1611637429, "creation_date": 1611609371, "answer_id": 65892528, "question_id": 57080062, "link": "https://stackoverflow.com/questions/57080062/enable-disable-hardware-lock-elision/65892528#65892528", "title": "Enable/Disable Hardware Lock Elision", "body": "<p>To add to the answer from Ana, I think the glibc may have custom variables on the OS intended for. At least on RHEL,  &quot;RHEL_GLIBC_TUNABLES=&quot;glibc.elision.enable=1&quot; was already introduced in glibc 2.17. It is possible that OP's distro also has a similar environmental variable for enabling HLE at runtime.</p>\n<pre><code>%define glibcsrcdir glibc-2.17-c758a686\n%define glibcversion 2.17\n%define glibcrelease 317%{?dist}\n...\n# If the architecture has elision support in glibc then it should be listed\n# here to enable elision for default pthread mutexes and rwlocks. The elision\n# is not enabled automatically and each process has to opt-in to elision via\n# the environment variable RHEL_GLIBC_TUNABLES by setting it to enabled e.g.\n# RHEL_GLIBC_TUNABLES=&quot;glibc.elision.enable=1&quot;.\n%define elisionarches x86_64 %{power64}\n...\n%ifarch %{elisionarches}\n    --enable-lock-elision=yes \\\n%endif\n...\n</code></pre>\n<p>According to glibc.spec of glibc 2.23.1 for Fedora 24, elisions has been disabled at compile-time since glibc 2.20 except on s390/s390x systems.\nThis is reaffirmed with the glibc.spec of glibc 2.24. for Fedora 25.</p>\n<pre><code># Enable lock elision support for these architectures\n#\n# At the moment lock elision is disabled on x86_64 until there's a CPU that\n# would actually benefit from enabling it.  Intel released a microcode update\n# to disable HLE and RTM at boot and the Fedora kernel now applies it early\n# enough that keeping lock elision enabled should be harmless, but we have\n# disabled it anyway as a conservative measure.\n%define lock_elision_arches s390 s390x\n...\n%ifarch %{lock_elision_arches}\n        --enable-lock-elision \\\n%endif\n...\n# Disable rwlock elision if --enable-lock-elision is not used.\nPatch0052: glibc-disable-rwlock-elision.patch\n...\n* Tue Sep 30 2014 Siddhesh Poyarekar &lt;siddhesh@redhat.com&gt; - 2.20.90-6\n- Sync with upstream master.\n- Disable more Intel TSX usage in rwlocks (#1146967).\n- Enable lock elision again on s390 and s390x.\n- Enable Systemtap SDT probes for all architectures (#985109).\n</code></pre>\n<p>while it's not conclusive to say that the OP's Linux distro runs on the same glibc 2.24 as Fedora 25 does, it is likely that the generic glibc 2.24 has elision disabled as per Patch0052. That's why OP couldn't see performance gain with &quot;export GLIBC_TUNABLES=glibc.elision.enable=1&quot;</p>\n<p>source:<br />\n<a href=\"http://rpmfind.net/linux/RPM/centos/7.9.2009/x86_64/Packages/glibc-2.17-317.el7.x86_64.html\" rel=\"nofollow noreferrer\">http://rpmfind.net/linux/RPM/centos/7.9.2009/x86_64/Packages/glibc-2.17-317.el7.x86_64.html</a><br />\n<a href=\"http://rpm.pbone.net/info_idpl_48715292_distro_fedora_24_com_glibc-2.23.1-12.fc24.x86_64.rpm.html\" rel=\"nofollow noreferrer\">http://rpm.pbone.net/info_idpl_48715292_distro_fedora_24_com_glibc-2.23.1-12.fc24.x86_64.rpm.html</a><br />\n<a href=\"http://rpm.pbone.net/resultsb_dist_103_size_26149846_name_glibc-2.24-10.fc25.src.rpm.html\" rel=\"nofollow noreferrer\">http://rpm.pbone.net/resultsb_dist_103_size_26149846_name_glibc-2.24-10.fc25.src.rpm.html</a></p>\n<p><strong>update:</strong><br />\nSLES12 has its own glibc versions. SP2 comes with glibc 2.22, which is different from the glibc 2.22 from Fedora 25.</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>SLES12 SP2</th>\n<th>Fedora 25</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>\\</td>\n<td>Patch0052: glibc-disable-rwlock-elision.patch (since 2.20.90)</td>\n</tr>\n<tr>\n<td>elision=--enable-lock-elision <br>if [ &quot;$dirname&quot; = &quot;noelision&quot; ]; then <br>   elision=--disable-lock-elision <br>fi</td>\n<td>\\</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>source:<br />\n<a href=\"https://www.suse.com/support/kb/doc/?id=000019071\" rel=\"nofollow noreferrer\">https://www.suse.com/support/kb/doc/?id=000019071</a>\n<a href=\"http://rpm.pbone.net/info_idpl_55157770_distro_opensuse_com_glibc-2.24-3.29.x86_64.rpm.html\" rel=\"nofollow noreferrer\">http://rpm.pbone.net/info_idpl_55157770_distro_opensuse_com_glibc-2.24-3.29.x86_64.rpm.html</a></p>\n"}], "owner": {"reputation": 814, "user_id": 10591515, "user_type": "registered", "profile_image": "https://graph.facebook.com/2363120117050209/picture?type=large", "display_name": "Ana Khorguani", "link": "https://stackoverflow.com/users/10591515/ana-khorguani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1175, "favorite_count": 1, "accepted_answer_id": 57127052, "answer_count": 2, "score": 6, "last_activity_date": 1611637429, "creation_date": 1563379286, "last_edit_date": 1587365883, "question_id": 57080062, "link": "https://stackoverflow.com/questions/57080062/enable-disable-hardware-lock-elision", "title": "Enable/Disable Hardware Lock Elision", "body": "<p>I am using glibc 2.24 version. It has lock elision path included for pthread_mutex_lock implementation with Transactional Synchronization Extensions such as _xbegin() and _xend(). The hardware is supposed to support lock elision as <em>hle</em> CPU flag is for Hardware Lock Elision I think. The processor I am using is Intel(R) Xeon(R) Gold 6130 with Skylake architecture.</p>\n\n<p>First I wanted to disable Lock elision but when I run the program that uses <strong>pthread_mutex_lock</strong>, with <strong>perf stat -T</strong> to monitor transactional cycles, I got 0. I assume this means pthread_mutex_lock does not use transactional path at all. After googling I found that it might be necessary to use <strong>export GLIBC_TUNABLES=glibc.elision.enable=1</strong> first, to enable lock elision but after this step I still don't see any transactions with perf. </p>\n\n<p>On the other hand when I include _xbegin(); and _xend(); directly in the process, I get some number of transactional cycles with perf stat -T, which should mean that I am looking for the right counters with perf, hopefully.</p>\n\n<p>So any advice to how I can enable lock elision would be helpful. Or am I checking it incorrectly? </p>\n\n<p><strong>Update</strong> for TSX I'm using this two instructions in the main function, just like this:</p>\n\n<pre><code>_xbegin();\n_xend();\n</code></pre>\n\n<p>I'm not sure which library it needs, I already have tens of them included. For compilation I'm using the following flags: -O3 -march=native -lpthread that are relevant for this example. </p>\n\n<p>For locks I have mutex:</p>\n\n<pre><code>pthread_mutex_t * mutex;\nmutex = (pthread_mutex_t *) malloc(10 * sizeof(pthread_mutex_t));\nfor(int k=0; k&lt;10; k++){\n    pthread_mutex_init(&amp;mutex[k], NULL);\n  }\n</code></pre>\n\n<p>Maybe for elision I should initialize it differently? </p>\n"}, {"tags": ["c", "vhdl", "documentation", "doxygen"], "comments": [{"owner": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1563378125, "post_id": 57079439, "comment_id": 100682313, "body": "In the cited question there is a possible solution given, disadvantage is a bit that one is mixed multiple styles. An approach might be similar, but for the secondary part create a TAG file and in the main part use this TAG file. I didn&#39;t try it, just a thought that came into my mind."}, {"owner": {"reputation": 421, "user_id": 2466685, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/549e70e71acf1a2a9020737ec4009667?s=128&d=identicon&r=PG", "display_name": "Andrey Pro", "link": "https://stackoverflow.com/users/2466685/andrey-pro"}, "reply_to_user": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1563383689, "post_id": 57079439, "comment_id": 100685185, "body": "@albert I need more explanatation abou this TAG"}, {"owner": {"reputation": 5891, "user_id": 1657886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d48ba7c8258ef5c613ba129411a6b0?s=128&d=identicon&r=PG", "display_name": "albert", "link": "https://stackoverflow.com/users/1657886/albert"}, "edited": false, "score": 0, "creation_date": 1563438767, "post_id": 57079439, "comment_id": 100702593, "body": "Please have a a look in the documentation chapter about configuration and the chapter: Linking to external documentation. Here are you find the settings <code>GENERATE_TAGFILE</code> and <code>TAGFILES</code>"}], "owner": {"reputation": 421, "user_id": 2466685, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/549e70e71acf1a2a9020737ec4009667?s=128&d=identicon&r=PG", "display_name": "Andrey Pro", "link": "https://stackoverflow.com/users/2466685/andrey-pro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563377308, "creation_date": 1563377308, "question_id": 57079439, "link": "https://stackoverflow.com/questions/57079439/mixed-c-and-vhdl-documentation-in-doxygen", "title": "Mixed C and VHDL documentation in Doxygen", "body": "<p>I have an embedded project that consists of a microcontroller (C) and an FPGA (VHDL), for that I wish to create a documenation. </p>\n\n<p>The question ist similar to <a href=\"https://stackoverflow.com/questions/5102770/doxygen-seamless-documentation-for-project-with-c-and-vhdl\">Doxygen: Seamless documentation for project with C++ and VHDL</a></p>\n\n<p>But I don't have as strict requirements as there. That is, I don't need intermixing in the same group  or interlinking. I would simply like to have two modules: \"VHDL\" and \"C\", each optimized for respective language, but in the same documenation.</p>\n\n<p>Perhaps someone has come up with a solution in the past 8 years?</p>\n"}, {"tags": ["c", "fonts", "x11"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611508641, "post_id": 57078805, "comment_id": 116468679, "body": "Can you show the exact argument you are passing to this program? Is this font listed when you type <code>xlsfonts</code>? I would say yes, use client-side fonts (almost everyone is using them these days)."}, {"owner": {"reputation": 111, "user_id": 6783373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVU3o.jpg?s=128&g=1", "display_name": "Skillmon likes topanswers.xyz", "link": "https://stackoverflow.com/users/6783373/skillmon-likes-topanswers-xyz"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611509685, "post_id": 57078805, "comment_id": 116468993, "body": "@n.&#39;pronouns&#39;m. thanks for your interest, but I have to admit that I don&#39;t remember the exact call. Just now I used <code>XListFonts(dsp,&quot;*&quot;,5000,&amp;font_count)</code> to list the fonts found on my system, and then tried <code>.&#47;foo &quot;-misc-aurebeshinv-medium-r-normal--0-0-0-0-p-0-iso10646-1&quot;</code> (with and without the quotes, <code>foo</code> being the compiled program shown above)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611525312, "post_id": 57078805, "comment_id": 116473777, "body": "I found that on my system if I specify <code>iso10646</code> or any other registry for OTF fonts, <code>XLoadQueryFont</code> fails; if I specify <code>*</code>, it succeeds."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611525957, "post_id": 57078805, "comment_id": 116473914, "body": "Sorry it also works with adobe registry, even though other registries like iso10646, iso8859 etc are listed as available."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611526020, "post_id": 57078805, "comment_id": 116473930, "body": "You may also want to try Xft fonts."}, {"owner": {"reputation": 111, "user_id": 6783373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVU3o.jpg?s=128&g=1", "display_name": "Skillmon likes topanswers.xyz", "link": "https://stackoverflow.com/users/6783373/skillmon-likes-topanswers-xyz"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611529142, "post_id": 57078805, "comment_id": 116474722, "body": "@n.&#39;pronouns&#39;m. thanks for the hints. Unfortunately, on my system it makes no difference whether I use <code>*</code>, <code>adobe</code> or the <code>iso10646</code> version, as long as I use an OTF font. I&#39;ll have a look at Xft fonts."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611530656, "post_id": 57078805, "comment_id": 116475040, "body": "You may also want to try just <code>*-aurebeshinv-*</code> font spec."}, {"owner": {"reputation": 111, "user_id": 6783373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVU3o.jpg?s=128&g=1", "display_name": "Skillmon likes topanswers.xyz", "link": "https://stackoverflow.com/users/6783373/skillmon-likes-topanswers-xyz"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611531352, "post_id": 57078805, "comment_id": 116475181, "body": "@n.&#39;pronouns&#39;m. doesn&#39;t work. It doesn&#39;t matter how I input it, as long as it should load an OTF it will fail for me."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611559206, "post_id": 57078805, "comment_id": 116480382, "body": "<code>*</code> selects the first element in the set of  registries (or whatever xlfd elements), alphabetically. In my case <code>adobe</code> is the correct one, and also the first one alphabetically. If your correct registry (or another element) is not the first one, it will not load. Maybe you need to try all of them explicitly."}, {"owner": {"reputation": 111, "user_id": 6783373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVU3o.jpg?s=128&g=1", "display_name": "Skillmon likes topanswers.xyz", "link": "https://stackoverflow.com/users/6783373/skillmon-likes-topanswers-xyz"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611560534, "post_id": 57078805, "comment_id": 116480829, "body": "@n.&#39;pronouns&#39;m. I tried all possible variants for most of the OTF fonts installed on my system, none of which worked."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611598604, "post_id": 57078805, "comment_id": 116498470, "body": "last suggestion, install xfontsel and try to select your font such that the example text is not grayed out"}, {"owner": {"reputation": 111, "user_id": 6783373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVU3o.jpg?s=128&g=1", "display_name": "Skillmon likes topanswers.xyz", "link": "https://stackoverflow.com/users/6783373/skillmon-likes-topanswers-xyz"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611601579, "post_id": 57078805, "comment_id": 116499678, "body": "@n.&#39;pronouns&#39;m. there is no combination in <code>xfontsel</code> for the OTF fonts which works, unfortunately. Have you tried for an OTF font, or for TTF on your machine?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611602315, "post_id": 57078805, "comment_id": 116499963, "body": "No it actually doesn&#39;t work for me. Apparently the font I have tested exists as both OTF and TTF on my system. Sorry about misleading you."}, {"owner": {"reputation": 111, "user_id": 6783373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVU3o.jpg?s=128&g=1", "display_name": "Skillmon likes topanswers.xyz", "link": "https://stackoverflow.com/users/6783373/skillmon-likes-topanswers-xyz"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1611603681, "post_id": 57078805, "comment_id": 116500524, "body": "@n.&#39;pronouns&#39;m. thanks for investing time, there is nothing to feel sorry about! I guess I should try to reach out to the maintainers of X11 in that case."}], "owner": {"reputation": 111, "user_id": 6783373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nVU3o.jpg?s=128&g=1", "display_name": "Skillmon likes topanswers.xyz", "link": "https://stackoverflow.com/users/6783373/skillmon-likes-topanswers-xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1611507886, "creation_date": 1563375371, "last_edit_date": 1611507886, "question_id": 57078805, "link": "https://stackoverflow.com/questions/57078805/xloadqueryfont-fails-on-font-found-with-xlistfonts", "title": "XLoadQueryFont fails on font found with XListFonts", "body": "<p>I'm trying to load an OTF font into <a href=\"https://github.com/benruijl/sflock\" rel=\"nofollow noreferrer\"><code>sflock</code></a>. <code>sflock</code> uses <code>XLoadQueryFont()</code> to load the font, but for some reason the font I'm trying to load doesn't work.</p>\n\n<p>I wrote a small test program which just tries to load a font and then exits. Program is shown below. It loads the font successfully for any TTF font (I tried so far) on my machine, but the OTFs I've tried don't work at all. The OTF fonts are shown by <code>XListFonts()</code>, so X does find them, but can't load them. Is there a way to load OTF fonts into X11, or do I have to use pango or similar?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;X11/Xlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char* argv[])\n{\n    if (argc != 2) {\n        fprintf(stderr,\"Missing argument.\\n\");\n        return 1;\n    }\n\n    Display *dsp = XOpenDisplay(0);\n\n    XFontStruct *font = XLoadQueryFont(dsp, argv[1]);\n    if (font == NULL) {\n        printf(\"font not found.\\n\");\n    } else {\n        printf(\"font found.\\n\");\n        XFreeFont(dsp, font);\n    }\n\n    XCloseDisplay(dsp);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "x11", "xlib"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 2, "creation_date": 1563440964, "post_id": 57078155, "comment_id": 100703773, "body": "Usually window border is handled by the Window Manager. So you probably don&#39;t want this border, instead you want a borderless window which has the rectangle inside its edges, and transparent center."}, {"owner": {"reputation": 295, "user_id": 3113356, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66205112115dc0601e889774b7a6fbbd?s=128&d=identicon&r=PG&f=1", "display_name": "rudolfninja", "link": "https://stackoverflow.com/users/3113356/rudolfninja"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1563441235, "post_id": 57078155, "comment_id": 100703908, "body": "Thanks. Then the second variant should be implemented. Could you please share examples how to make transparent center inside of my orange rectangle?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1563447536, "post_id": 57078155, "comment_id": 100707388, "body": "I don&#39;t have such an example."}, {"owner": {"reputation": 295, "user_id": 3113356, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66205112115dc0601e889774b7a6fbbd?s=128&d=identicon&r=PG&f=1", "display_name": "rudolfninja", "link": "https://stackoverflow.com/users/3113356/rudolfninja"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1563447626, "post_id": 57078155, "comment_id": 100707433, "body": "May be some links I can read to implement transparent center within my orange window?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1563552734, "post_id": 57078155, "comment_id": 100751001, "body": "@rudolfninja <a href=\"https://stackoverflow.com/questions/39906128/how-to-create-semi-transparent-white-window-in-xlib\" title=\"how to create semi transparent white window in xlib\">stackoverflow.com/questions/39906128/&hellip;</a>"}, {"owner": {"reputation": 295, "user_id": 3113356, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66205112115dc0601e889774b7a6fbbd?s=128&d=identicon&r=PG&f=1", "display_name": "rudolfninja", "link": "https://stackoverflow.com/users/3113356/rudolfninja"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1563716845, "post_id": 57078155, "comment_id": 100783506, "body": "@JL2210, thanks for the reply, but unfortunately it isn&#39;t what I need...or may be it is, but I don&#39;t understand how can it solve my problem. Do you mean, that my window shouldn&#39;t be completely transparent?"}], "answers": [{"comments": [{"owner": {"reputation": 295, "user_id": 3113356, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66205112115dc0601e889774b7a6fbbd?s=128&d=identicon&r=PG&f=1", "display_name": "rudolfninja", "link": "https://stackoverflow.com/users/3113356/rudolfninja"}, "edited": false, "score": 0, "creation_date": 1563775630, "post_id": 57136195, "comment_id": 100795378, "body": "Thanks. Looks like it solved my problem. One more question: is XSetBackground needed on Expose event handler? Everything works fine without this call, but may be it is needed in some purposes."}, {"owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "reply_to_user": {"reputation": 295, "user_id": 3113356, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66205112115dc0601e889774b7a6fbbd?s=128&d=identicon&r=PG&f=1", "display_name": "rudolfninja", "link": "https://stackoverflow.com/users/3113356/rudolfninja"}, "edited": false, "score": 0, "creation_date": 1563789985, "post_id": 57136195, "comment_id": 100802264, "body": "@rudolfninja No. Oh damn it, sorry, that was a leftover from my experiment. Code fixed."}, {"owner": {"reputation": 319, "user_id": 2086511, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/327c8e6c4f5c762e7d5e225d84a10ee4?s=128&d=identicon&r=PG", "display_name": "kenn", "link": "https://stackoverflow.com/users/2086511/kenn"}, "edited": false, "score": 0, "creation_date": 1612120753, "post_id": 57136195, "comment_id": 116661619, "body": "Is it possible to draw that rectangle with mouse as in the  case of rubberbanding?"}, {"owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "reply_to_user": {"reputation": 319, "user_id": 2086511, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/327c8e6c4f5c762e7d5e225d84a10ee4?s=128&d=identicon&r=PG", "display_name": "kenn", "link": "https://stackoverflow.com/users/2086511/kenn"}, "edited": false, "score": 0, "creation_date": 1612196012, "post_id": 57136195, "comment_id": 116684680, "body": "@kenn Sure, why not. The code would look quite a bit different though."}, {"owner": {"reputation": 319, "user_id": 2086511, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/327c8e6c4f5c762e7d5e225d84a10ee4?s=128&d=identicon&r=PG", "display_name": "kenn", "link": "https://stackoverflow.com/users/2086511/kenn"}, "edited": false, "score": 0, "creation_date": 1612197217, "post_id": 57136195, "comment_id": 116685281, "body": "@hidefromkgb would you post a sample code please? Shall I ask it as a question?"}, {"owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "reply_to_user": {"reputation": 319, "user_id": 2086511, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/327c8e6c4f5c762e7d5e225d84a10ee4?s=128&d=identicon&r=PG", "display_name": "kenn", "link": "https://stackoverflow.com/users/2086511/kenn"}, "edited": false, "score": 0, "creation_date": 1612197453, "post_id": 57136195, "comment_id": 116685398, "body": "@kenn For starters, please at least try doing it yourself."}], "tags": [], "owner": {"reputation": 5371, "user_id": 7019311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a2981ebd25241785e1495e511caa61a?s=128&d=identicon&r=PG&f=1", "display_name": "hidefromkgb", "link": "https://stackoverflow.com/users/7019311/hidefromkgb"}, "is_accepted": true, "score": 5, "last_activity_date": 1563789995, "last_edit_date": 1563789995, "creation_date": 1563736043, "answer_id": 57136195, "question_id": 57078155, "link": "https://stackoverflow.com/questions/57078155/draw-border-frame-using-xlib/57136195#57136195", "title": "Draw border (frame) using xlib", "body": "<p>Two main mistakes.</p>\n\n<ol>\n<li>Not initializing <code>attr</code> and <code>gcv</code> to 0</li>\n<li>Not using <code>attr.colormap</code> for color allocation</li>\n</ol>\n\n<p>That should help:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;X11/Xlib.h&gt;\n#include &lt;X11/Xutil.h&gt;\n#include &lt;X11/Xatom.h&gt;\n\n#define W_WIDTH 640\n#define W_HEIGHT 480\n\n#define X_POS 100\n#define Y_POS 120\n#define BORDER_WIDTH 2\n\nint main(int argc, char *argv[]) {\n    XRectangle rectangles[4] = {\n        { X_POS, Y_POS, W_WIDTH, BORDER_WIDTH },\n        { X_POS, Y_POS, BORDER_WIDTH, W_HEIGHT },\n        { X_POS, W_HEIGHT - BORDER_WIDTH, W_WIDTH, BORDER_WIDTH },\n        { W_WIDTH - BORDER_WIDTH, Y_POS, BORDER_WIDTH, W_HEIGHT }\n    };\n    Display *dpy = XOpenDisplay(NULL);\n    XSetWindowAttributes attr = {0};\n    XGCValues gcv = {0};\n    XVisualInfo vinfo;\n    GC gc;\n\n    Window w;\n\n    int run = 1;\n\n    XMatchVisualInfo(dpy, DefaultScreen(dpy), 32, TrueColor, &amp;vinfo);\n    attr.colormap = XCreateColormap(dpy, DefaultRootWindow(dpy), vinfo.visual, AllocNone);\n\n    XColor color;\n    char orangeDark[] = \"#FF8000\";\n    XParseColor(dpy, attr.colormap, orangeDark, &amp;color);\n    XAllocColor(dpy, attr.colormap, &amp;color);\n\n    w = XCreateWindow(dpy, DefaultRootWindow(dpy), X_POS, Y_POS,\n                      W_WIDTH, W_HEIGHT, BORDER_WIDTH, vinfo.depth,\n                      InputOutput, vinfo.visual, CWColormap | CWBorderPixel | CWBackPixel, &amp;attr);\n\n    gcv.line_width = BORDER_WIDTH;\n    gc = XCreateGC(dpy, w, GCLineWidth, &amp;gcv);\n\n    XSelectInput(dpy, w, ExposureMask);\n    long value = XInternAtom(dpy, \"_NET_WM_WINDOW_TYPE_DOCK\", False);\n    XChangeProperty(dpy, w, XInternAtom(dpy, \"_NET_WM_WINDOW_TYPE\", False),\n                    XA_ATOM, 32, PropModeReplace, (unsigned char *) &amp;value, 1);\n    XMapWindow(dpy, w);\n    XSync(dpy, False);\n\n    while(run) {\n        XEvent xe;\n        XNextEvent(dpy, &amp;xe);\n        switch (xe.type) {\n            case Expose:\n                XSetForeground(dpy, gc, color.pixel);\n                XDrawRectangles(dpy, w, gc, rectangles, 4);\n                XFillRectangles(dpy, w, gc, rectangles, 4);\n                XSync(dpy, False);\n                break;\n\n            default:\n                break;\n        }\n    }\n\n    XDestroyWindow(dpy, w);\n    XCloseDisplay(dpy);\n\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/beuop.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/beuop.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 295, "user_id": 3113356, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/66205112115dc0601e889774b7a6fbbd?s=128&d=identicon&r=PG&f=1", "display_name": "rudolfninja", "link": "https://stackoverflow.com/users/3113356/rudolfninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 0, "accepted_answer_id": 57136195, "answer_count": 1, "score": 5, "last_activity_date": 1612198007, "creation_date": 1563373361, "last_edit_date": 1563526974, "question_id": 57078155, "link": "https://stackoverflow.com/questions/57078155/draw-border-frame-using-xlib", "title": "Draw border (frame) using xlib", "body": "<p>Is it possible to draw transparent window without title bar, close button, responses on mouse buttons using xlib. So just border with specific color and width? Something like <a href=\"https://i.stack.imgur.com/ItXUQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ItXUQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>this orange rectangle is what I need to create. Also I'd like to have possibility to move, resize, close and make it flicking (change border's color on timer) programatically.</p>\n\n<p>I managed to create transparent window without titlebar and draw rectangles on each side of the window to make border-effect:</p>\n\n<pre><code>#define W_WIDTH 640\n#define W_HEIGHT 480\n\n#define X_POS 100\n#define Y_POS 120\n#define BORDER_WIDTH 2\n\nDisplay *dpy;\nWindow w;\n\nXRectangle rectangles[4] =\n    {\n    { X_POS, Y_POS, W_WIDTH, BORDER_WIDTH },\n    { X_POS, Y_POS, BORDER_WIDTH, W_HEIGHT },\n    { X_POS, W_HEIGHT - BORDER_WIDTH, W_WIDTH, BORDER_WIDTH },\n    { W_WIDTH - BORDER_WIDTH, Y_POS, BORDER_WIDTH, W_HEIGHT }\n    };\n\nint main(int argc, char *argv[])\n{\n    GC gc;\n    XGCValues gcv;\n    int run = 1;\n\n    dpy = XOpenDisplay(NULL);\n\n    XVisualInfo vinfo;\n    XMatchVisualInfo(dpy, DefaultScreen(dpy), 32, TrueColor, &amp;vinfo);\n    XSetWindowAttributes attr;\n    attr.colormap = XCreateColormap(dpy, DefaultRootWindow(dpy), vinfo.visual, AllocNone);\n\n    w = XCreateWindow(dpy, DefaultRootWindow(dpy), X_POS, Y_POS,\n                      W_WIDTH, W_HEIGHT, BORDER_WIDTH, vinfo.depth,\n                      InputOutput, vinfo.visual, CWColormap | CWBorderPixel | CWBackPixel, &amp;attr);\n    XColor color;\n    Colormap colormap;\n    char orangeDark[] = \"#FF8000\";\n    colormap = DefaultColormap(dpy, 0);\n    XParseColor(dpy, colormap, orangeDark, &amp;color);\n    XAllocColor(dpy, colormap, &amp;color);\n\n    gcv.line_width = BORDER_WIDTH;\n    gc = XCreateGC(dpy, w, GCLineWidth, &amp;gcv);\n\n    XSelectInput(dpy, w, ExposureMask);\n    Atom window_type = XInternAtom(dpy, \"_NET_WM_WINDOW_TYPE\", False);\n    long value = XInternAtom(dpy, \"_NET_WM_WINDOW_TYPE_DOCK\", False);\n    XChangeProperty(dpy, w, window_type, XA_ATOM, 32, PropModeReplace, (unsigned char *) &amp;value, 1);\n    XMapWindow(dpy, w);\n    XSync(dpy, False);\n\n    while(run)\n    {\n        XEvent xe;\n        XNextEvent(dpy, &amp;xe);\n        switch (xe.type)\n        {\n            case Expose:\n                XSetForeground(dpy, gc, color.pixel);\n                XDrawRectangles(dpy, w, gc, rectangles, 4);\n                XFillRectangles(dpy, w, gc, rectangles, 4);\n                XSync(dpy, False);\n                break;\n            default:\n                break;\n        }\n    }\n\n    XDestroyWindow(dpy, w);\n    XCloseDisplay(dpy);\n\n    return 0;\n}\n</code></pre>\n\n<p>This code works almost fine except the thing, that my orange border is semitransparent and is almost invisible on light windows:\n<a href=\"https://i.stack.imgur.com/pL19u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pL19u.png\" alt=\"enter image description here\"></a>\nCould you please tell how I need change my code to draw solid orange rectangles? Another variant I have is to draw transparent rectangle inside of orange window. But I didn't find any info in the Internet about how to do that.</p>\n"}, {"tags": ["c", "microservices", "executable", "cloud-foundry", "binaryfiles"], "comments": [{"owner": {"reputation": 10226, "user_id": 1585136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de253a68c4e3690787c1c55fc1104413?s=128&d=identicon&r=PG", "display_name": "Daniel Mikusa", "link": "https://stackoverflow.com/users/1585136/daniel-mikusa"}, "edited": false, "score": 0, "creation_date": 1563467568, "post_id": 57077796, "comment_id": 100719296, "body": "<code>And why is the command called multiple times?</code> -&gt; when your app &quot;crashes&quot; (in your case it&#39;s exiting cause it&#39;s supposed to, but the platform considers that a crash), the platform will attempt to rectify the situation and restart your app. In your case, that just results in the command running multiple times."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "edited": false, "score": 0, "creation_date": 1563472548, "post_id": 57099071, "comment_id": 100721558, "body": "Thanks again for the good clarifications. I stumbled upon the Spring Cloud Task which seems to fulfil my requirements, so I am trying that option. My Plan is to use the ProcessBuilder to call my binary in the CommandLineRunner. However, I am not sure of the command to call."}, {"owner": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "edited": false, "score": 0, "creation_date": 1563473117, "post_id": 57099071, "comment_id": 100721788, "body": "How does Cloud Foundry know the location of my binary when the command is called?"}, {"owner": {"reputation": 10226, "user_id": 1585136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de253a68c4e3690787c1c55fc1104413?s=128&d=identicon&r=PG", "display_name": "Daniel Mikusa", "link": "https://stackoverflow.com/users/1585136/daniel-mikusa"}, "reply_to_user": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "edited": false, "score": 0, "creation_date": 1563588224, "post_id": 57099071, "comment_id": 100760587, "body": "While Spring Cloud Task is a wonderful project, IMO that is overkill. You don&#39;t need to wrap your nice, efficient native executable in a JVM just to get it to run. You can run it directly. If you need some set up or massaging, you can wrap it in a powershell or batch script. Side note, the Java buildpack is focused only on running Java apps on Linux. It would be difficult to get a Java app to run on a Windows Cell in Cloud Foundry."}, {"owner": {"reputation": 10226, "user_id": 1585136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de253a68c4e3690787c1c55fc1104413?s=128&d=identicon&r=PG", "display_name": "Daniel Mikusa", "link": "https://stackoverflow.com/users/1585136/daniel-mikusa"}, "reply_to_user": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "edited": false, "score": 0, "creation_date": 1563588403, "post_id": 57099071, "comment_id": 100760607, "body": "<code>How does Cloud Foundry know the location of my binary when the command is called?</code> -&gt; It&#39;s not Cloud Foundry. It&#39;s just how you execute processes on Windows. You can specify the full path to the executable, you can specify a relative path or you can leave off the path and make sure it&#39;s on the search PATH. When you push your app to CF, the target of push (usually the current directory, unless you set <code>-p</code>) will be the current working directory from which your application runs. Thus if your binary is in the target directory, <code>.&#47;helloworld</code> should work. If it&#39;s in a <code>bin&#47;</code> then <code>bin&#47;helloworld</code>"}, {"owner": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "edited": false, "score": 0, "creation_date": 1563780851, "post_id": 57099071, "comment_id": 100797545, "body": "<code>While Spring Cloud Task is a wonderful project, IMO that is overkill.</code>--&gt; Well explained. I will try the suggestion of wrapping <code>it in a powershell or batch script</code>. But then, it should run as a <i>Task</i> and not as a <i>LRP</i>. I guess a I can do it like you suggested in a previous post (<code>push it as a normal app, stop the app, run a run-task</code>). Iam not providing snippets because we are writing the technical concepts and prototyping the use cases beforehand. Thanks once again!"}, {"owner": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "edited": false, "score": 0, "creation_date": 1563797497, "post_id": 57099071, "comment_id": 100806602, "body": "I created a manifest.yml with the command to call the simple binary like so: <code>command: .&#47;helloworld &amp;&amp; sleep infinity</code> with the usual elements <code>no-route: true</code> and  <code>health-check-type: process</code>. The command was called once and container was subsequently destroyed, which was exactly my use case. So I really don&#39;t need the Spring Cloud Task like you pointed out, thanks."}, {"owner": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "edited": false, "score": 0, "creation_date": 1563797931, "post_id": 57099071, "comment_id": 100806860, "body": "However, I called another binary which converts a file type into another file type. Apparently, that also worked because the output says file with name was created. <b>BUT</b>, I can&#39;t see the file in the execution directly. How can I locate the created File please? A simple command like <code>gcc -o hellocompiled hello.c &amp;&amp; sleep infinity</code> also worked but there was no <code>hellocompiled</code> in the base directory like I&#39;d expected. Do I need to mount external Volumes for this and similar scenarios where files must be written to disc to work?"}, {"owner": {"reputation": 10226, "user_id": 1585136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de253a68c4e3690787c1c55fc1104413?s=128&d=identicon&r=PG", "display_name": "Daniel Mikusa", "link": "https://stackoverflow.com/users/1585136/daniel-mikusa"}, "reply_to_user": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "edited": false, "score": 0, "creation_date": 1563908274, "post_id": 57099071, "comment_id": 100854478, "body": "Files will only be around for the duration of your container. If it runs, and stops quickly that could be problematic. You&#39;d really need a three phased approach: run, ship to somewhere stable (S3, NFS, etc..), then exit."}, {"owner": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "edited": false, "score": 0, "creation_date": 1563910534, "post_id": 57099071, "comment_id": 100855419, "body": "Alright, I thought as much. But still  kind of annoying going extra steps when all you need is the output to your base directory. But thanks for your reply, I am really learning a lot from you..."}], "tags": [], "owner": {"reputation": 10226, "user_id": 1585136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de253a68c4e3690787c1c55fc1104413?s=128&d=identicon&r=PG", "display_name": "Daniel Mikusa", "link": "https://stackoverflow.com/users/1585136/daniel-mikusa"}, "is_accepted": false, "score": 0, "last_activity_date": 1563467515, "creation_date": 1563467515, "answer_id": 57099071, "question_id": 57077796, "link": "https://stackoverflow.com/questions/57077796/deploying-native-c-c-binary-as-a-standalone-microservice-in-pcf-dev/57099071#57099071", "title": "Deploying Native C/C++ Binary as a standalone Microservice in PCF-DEV", "body": "<blockquote>\n  <p>The Microservice is thus not an LRP. It is possibly a Task in PCF palance, but it does not rely on the existence of other Microservices. It must be a standalone Microservice but not a long-running one.</p>\n</blockquote>\n\n<p>It's definitely a task. It's fine that it does not rely on other services. A task is just simple a process that runs for a finite amount of time and exits 0 for success or something else for error.</p>\n\n<blockquote>\n  <p>cf push HelloServiceAgain -c './helloworld' -b <a href=\"https://github.com/cloudfoundry/binary-buildpack.git\" rel=\"nofollow noreferrer\">https://github.com/cloudfoundry/binary-buildpack.git</a> -u process --no-route</p>\n</blockquote>\n\n<p>I would recommend using this slight variation:  <code>cf push HelloServiceAgain -c 'sleep 5000' -b binary_buildpack -u process --no-route</code>.</p>\n\n<p>This will...</p>\n\n<ol>\n<li>Assume that the compiled binary is in the current directory.</li>\n<li>Uses the system provided binary buildpack which should be fine.</li>\n<li>Sets the health check to be based on the process &amp; sets no route.</li>\n<li>Runs <code>sleep</code>, which is merely to pass the health check.</li>\n</ol>\n\n<p>The purpose of this is so that your application will upload &amp; stage. We set the command to <code>sleep</code> because we just need the app to stage and start (this is a workaround to make sure that staging occurs, you have to run once to trigger staging at least at the moment). Once the app starts, just run <code>cf stop</code> and stop the app. Since all you have is the task, you don't need the app to continue running. If you update your app, you do need to follow this process again though, as that will restage your changes.</p>\n\n<p>At this point, you can <code>cf run-task</code> and execute your program. Ex: <code>cf run-task app-name './helloworld'</code>.</p>\n\n<p>Hope that helps!</p>\n"}], "owner": {"reputation": 21, "user_id": 11772394, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1nj2vJ3N7ok/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNVAF8U9v1vxp0gDX08zecW924EQ/photo.jpg?sz=128", "display_name": "Mabasha", "link": "https://stackoverflow.com/users/11772394/mabasha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563467515, "creation_date": 1563372263, "last_edit_date": 1563374604, "question_id": 57077796, "link": "https://stackoverflow.com/questions/57077796/deploying-native-c-c-binary-as-a-standalone-microservice-in-pcf-dev", "title": "Deploying Native C/C++ Binary as a standalone Microservice in PCF-DEV", "body": "<p>I have a use case to deploy a compiled  Native C executable as a Microservice on PCF:</p>\n\n<p>The compiled executable is called like so: \n    \"mycbinary inputfile outputfile\"\nand terminates after the operation. The Microservice is thus not an LRP.\nIt is possibly a Task in PCF palance, but it does not rely on the existence of other Microservices.\nIt must be a standalone Microservice but not a long-running one.</p>\n\n<p>How can I achieve this use case with PCF please, i.e what possibilities do I have?\nThe Microservice terminates when the binary is done with its work until it is needed again.</p>\n\n<p>To test the feasibility of what I could do, I tried pushing some compiled C code to PCF-DEV.\nI am using cf push since that's my understanding of a standalone App on PCF</p>\n\n<p>cf push HelloServiceAgain -c './helloworld' -b <a href=\"https://github.com/cloudfoundry/binary-buildpack.git\" rel=\"nofollow noreferrer\">https://github.com/cloudfoundry/binary-buildpack.git</a> -u process --no-route</p>\n\n<p>The push crashed with the following message:</p>\n\n<p>Waiting for app to start...\nStart unsuccessful</p>\n\n<p>TIP: use 'cf.exe logs HelloService --recent' for more information</p>\n\n<p>In the log file there was this entry:\n    OUT Process has crashed with type: \"web\"</p>\n\n<p>Then I pushed another command which expects parameters. This started without a problem, but the same message in the log file</p>\n\n<p>cf push HelloServiceGCC -c 'gcc -o ./hellogcc ./hello1.c' -b <a href=\"https://github.com/cloudfoundry/binary-buildpack.git\" rel=\"nofollow noreferrer\">https://github.com/cloudfoundry/binary-buildpack.git</a> -u process --no-route</p>\n\n<p>I have the following additional questions please:</p>\n\n<p>1) Is the message \"Process has crashed with type: \"web\" an ERROR? And why is the command called multiple times?\n 2) The second push which succeeded is supposed to create a compiled <code>hellogcc</code> executable which I expect to see in the same root directory. Where is the output file created and how can I access it from the local file system?</p>\n\n<p>Sorry for asking so many questions but I am a newbie in the PCF business.</p>\n"}, {"tags": ["c++", "c", "postgresql", "lua"], "comments": [{"owner": {"reputation": 5746, "user_id": 4984564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9bc286af6678a63ceb881eaf9e966f5f?s=128&d=identicon&r=PG", "display_name": "DarkWiiPlayer", "link": "https://stackoverflow.com/users/4984564/darkwiiplayer"}, "edited": false, "score": 2, "creation_date": 1563372123, "post_id": 57077602, "comment_id": 100678614, "body": "My best guess is a version mismatch, make sure that you&#39;re using the same version of Lua (5.3) everywhere. Maybe your C++ project is using a different version of Lua (use <code>print(_VERSION)</code> to see the Lua version you&#39;re running on."}, {"owner": {"reputation": 2266, "user_id": 4567755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tb0nx.png?s=128&g=1", "display_name": "Green", "link": "https://stackoverflow.com/users/4567755/green"}, "edited": false, "score": 0, "creation_date": 1563372469, "post_id": 57077602, "comment_id": 100678842, "body": "Having your compiler and linker options would help. Same goes to seeing your includes. Similar errors usually occur in C++ if you don&#39;t include lua headers within <code>extern &quot;C&quot;</code>."}, {"owner": {"reputation": 64130, "user_id": 107090, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/RZVHK.png?s=128&g=1", "display_name": "lhf", "link": "https://stackoverflow.com/users/107090/lhf"}, "edited": false, "score": 1, "creation_date": 1563374630, "post_id": 57077602, "comment_id": 100680312, "body": "You need to export the Lua API symbols from your C++ program. Link it with <code>-Wl,-E</code>."}, {"owner": {"reputation": 11, "user_id": 11797814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610dfb49707e0b6640fdeaad1a0e0da8?s=128&d=identicon&r=PG&f=1", "display_name": "RuAlastor", "link": "https://stackoverflow.com/users/11797814/rualastor"}, "edited": false, "score": 0, "creation_date": 1563436109, "post_id": 57077602, "comment_id": 100701130, "body": "Thanks for the help! I actually solved the problem. Version was correct and the error wasn&#39;t about includes as well. I believe Lua wasn&#39;t exporting API symbols correctly as @Ihf said, but I think I did something wrong because -Wl,-E didn&#39;t work for me either. I had to explicitly link <b>liblua5.3.so</b> for everything to work."}, {"owner": {"reputation": 2266, "user_id": 4567755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tb0nx.png?s=128&g=1", "display_name": "Green", "link": "https://stackoverflow.com/users/4567755/green"}, "edited": false, "score": 2, "creation_date": 1563436480, "post_id": 57077602, "comment_id": 100701335, "body": "@RuAlastor I suggest you modify question with your initial compiler/linker flags and post an answer with your own solution. For future reference and the ones curious for more details (like me). Someone may even suggest then a nicer solution if there is one."}], "owner": {"reputation": 11, "user_id": 11797814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/610dfb49707e0b6640fdeaad1a0e0da8?s=128&d=identicon&r=PG&f=1", "display_name": "RuAlastor", "link": "https://stackoverflow.com/users/11797814/rualastor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563445895, "creation_date": 1563371737, "last_edit_date": 1563445895, "question_id": 57077602, "link": "https://stackoverflow.com/questions/57077602/error-loading-external-lua-module-luasql-postgres-from-module-imbedded-in-c", "title": "Error loading external lua module (luasql.postgres) from module imbedded in C++ project", "body": "<p>I need to write a C++ project with a Lua script, which reads info from PostgreSQL and gives recieved data back to C++ project. \nIt works correctly when called from terminal with Lua-interpreter however when I try to call Lua module from C++, script works incorrectly and returns error.</p>\n\n<p>Home OS - Debian 9.\nPostgreSQL version - 9.6.\nCompiler - g++.\nLua version - 5.3.4.\nI've already tried changing  in Lua file trying different *.so files. It didn't help.</p>\n\n<p>Compiler/Linker flags:</p>\n\n<blockquote>\n  <p>g++ -c -m64 -pipe -g -std=gnu++11 -Wall -W -fPIC -DQT_QML_DEBUG -I.\n  -I/usr/lib/x86_64-linux-gnu/qt5/mkspecs/linux-g++-64 -o main.o </p>\n  \n  <p>g++ -m64 -o luaTest main.o -llua -ldl</p>\n</blockquote>\n\n<p>main.cpp</p>\n\n<pre><code>lua_State* _script = luaL_newstate();\nif (_script == NULL) {\n    std::cout &lt;&lt; \"Failed to allocate memory!\\n\";\n    return -1;\n}\nint result = luaL_loadfile(_script, filename1);\nif (result != LUA_OK) {\n    std::cout &lt;&lt; \"Failed to load file!\\n\";\n    return -1;\n}\nluaL_openlibs(_script);\nresult = lua_pcall(_script, 0, 0, 0);\nif (result != LUA_OK) {\n    std::string luaError = lua_tostring(_script, -1);\n    std::cout &lt;&lt; \"Failed to run script!\\n\" &lt;&lt; luaError &lt;&lt; '\\n';\n    return -1;\n}\n</code></pre>\n\n<p>lua:</p>\n\n<pre><code>package.cpath = \"/usr/lib/x86_64-linux-gnu/liblua5.3-sql-postgres.so\"\n\nfunction getDatabase()\n    driver = require \"luasql.postgres\"\n    env = assert(driver.postgres())\n\nconnect = assert(env:connect(\"luabase\", \"sorokin\", \"123456\", \"127.0.0.1\", \"5432\"))\n\nres = connect:execute(\"DROP SEQUENCE user_ids\")\nres = connect:execute(\"DROP TABLE users\")\n\n\nres = assert(connect:execute(\"CREATE TABLE users(\\\n                id INTEGER PRIMARY KEY ,\\\n                fname CHAR(15),\\\n                lname CHAR(30),\\\n                job CHAR(15)\\\n                )\"))\n\nres = assert(connect:execute(\"INSERT INTO users(id, fname, lname, job) \\\n            VALUES (1, 'Andrey', 'Sedin', 'Deputat')\"))\nres = assert(connect:execute(\"INSERT INTO users \\\n            VALUES (2, 'Andrey', 'Dranga', 'Boxer')\"))\nres = assert(connect:execute(\"INSERT INTO users \\\n            VALUES (3, 'Roberto', 'Ierusalimskiy', 'Programmer')\"))\n\n\n\ncursor = assert(connect:execute(\"SELECT * FROM users ORDER BY lname\"))\n\nprint()\nprint(string.format(\"%1s %-16s %-31s %-16s\",\n        \"#\", \"| FNAME\", \"| LNAME\", \"| JOB\"))\nprint(string.format(\"%1s %-16s %-31s %-16s\",\n        \"-\", \"| -----\", \"| -----\", \"| ---\"))\n\nrow = cursor:fetch({}, \"a\")\nwhile row do\n    print(string.format(\"%1s %1s %-15s%1s %-30s%1s %-15s\",\n        row.id, \"|\", row.fname, \"|\", row.lname, \"|\", row.job))\n    row = cursor:fetch(row, \"a\")\nend\nprint()\n\ncursor:close()\nconnect:close()\nenv:close()\nend\n\ngetDatabase()\n</code></pre>\n\n<p>error message from Lua-script:</p>\n\n<blockquote>\n  <p>error loading module 'luasql.postgres' from file\n  '/usr/lib/x86_64-linux-gnu/liblua5.3-sql-postgres.so':\n    /usr/lib/x86_64-linux-gnu/liblua5.3-sql-postgres.so: undefined\n  symbol: lua_settop</p>\n</blockquote>\n"}, {"tags": ["c", "struct", "static"], "comments": [{"owner": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "edited": false, "score": 1, "creation_date": 1563371236, "post_id": 57077394, "comment_id": 100678000, "body": "Do you mean that you wish the struct types to be visible only in <code>list.c</code>, or are you trying to declare static variables of those types?"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1563371435, "post_id": 57077394, "comment_id": 100678145, "body": "Use the static when you declare the variable, not in the <code>typedef</code>."}, {"owner": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "edited": false, "score": 0, "creation_date": 1563371500, "post_id": 57077394, "comment_id": 100678205, "body": "yes i want the struct types to be only visible in list.c."}, {"owner": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "edited": false, "score": 0, "creation_date": 1563371595, "post_id": 57077394, "comment_id": 100678270, "body": "i have edited it, sorry i pasted my code without checking."}, {"owner": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1563371673, "post_id": 57077394, "comment_id": 100678321, "body": "@ThomasJager i did try it, but the compiler throws an error &quot;expected specifier-qualifier-list before static&quot;. Somebody in this site also mentioned that you cannot declare static variable inside a struct."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1563371991, "post_id": 57077394, "comment_id": 100678531, "body": "@VanTeoLe If you only want the types visible in list.c, then put the typedefs in list.c."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1563372297, "post_id": 57077394, "comment_id": 100678738, "body": "When you say you want the struct types to be invisible, do you mean that only the pointer types <code>Node *</code> and <code>List *</code> are to be exposed?"}], "answers": [{"comments": [{"owner": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "edited": false, "score": 0, "creation_date": 1563372133, "post_id": 57077635, "comment_id": 100678619, "body": "how should i declare it in list.c? Like typedef struct ListNode {element..} Node?"}], "tags": [], "owner": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "is_accepted": false, "score": 0, "last_activity_date": 1563372353, "last_edit_date": 1563372353, "creation_date": 1563371820, "answer_id": 57077635, "question_id": 57077394, "link": "https://stackoverflow.com/questions/57077394/how-to-make-a-static-struct-from-typedef/57077635#57077635", "title": "how to make a static struct from typedef", "body": "<p>You can use pointers to opaque structs to hide the contents of your structs <code>List</code> and <code>Node</code>. In the header, use include only the opaque declarations</p>\n\n<pre><code>typedef struct ListNode Node;\ntypedef struct List List;\n</code></pre>\n\n<p>and the function declarations. These tell the compiler that the structs and typedefs exist, but not what the structs contain.</p>\n\n<p>In <code>list.c</code>, include the full declarations, but not as typedefs, since the header file already tells the compiler about the typedef'ed names.</p>\n\n<pre><code>struct ListNode {\n    /* contents */\n};\nstruct List {\n    /* contents */\n};\n</code></pre>\n\n<p>This way the contents of the structs are not usable in other C files, but the functions in <code>list.c</code> can still use them. This also means that other C files cannot create new instances of these structs, except by using the functions offered in <code>list.h</code>.</p>\n"}], "owner": {"reputation": 124, "user_id": 10076956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5BsZMv-fe18/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7r2p4alkYStXegIEfnmmaHjIOlZOA/mo/photo.jpg?sz=128", "display_name": "Van Teo Le", "link": "https://stackoverflow.com/users/10076956/van-teo-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "closed_date": 1563372163, "answer_count": 1, "score": 0, "last_activity_date": 1563372353, "creation_date": 1563371096, "last_edit_date": 1563371430, "question_id": 57077394, "link": "https://stackoverflow.com/questions/57077394/how-to-make-a-static-struct-from-typedef", "closed_reason": "Duplicate", "title": "how to make a static struct from typedef", "body": "<p>I have a header file list.h and a source file list.c,which define the functions in list.h.\nI have a struct here:</p>\n\n<pre><code>    typedef struct ListNode{\n struct ListNode* next;\n struct ListNode* prev;\n void *value;\n    }Node;\n    typedef struct List{\n Node *first;\n Node *last;\n int count;\n    }List;\n</code></pre>\n\n<p>How can i make them only visible to the functions in list.h,when the compiler does not accept using static and typedef together? These are the functions i declare in list.h:</p>\n\n<pre><code>    List *List_create();\n    void List_destroy(List *list);\n    void *List_remove(List *list,Node *node);\n</code></pre>\n"}, {"tags": ["c", "memory", "struct", "intel"], "comments": [{"owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "edited": false, "score": 0, "creation_date": 1563371365, "post_id": 57077381, "comment_id": 100678094, "body": "Where is the <code>sdCard</code> variable coming from?"}, {"owner": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "reply_to_user": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "edited": false, "score": 0, "creation_date": 1563371452, "post_id": 57077381, "comment_id": 100678156, "body": "The sdCard variable is declared above the function, so it is global to all functions."}, {"owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "edited": false, "score": 1, "creation_date": 1563371705, "post_id": 57077381, "comment_id": 100678341, "body": "Did you properly malloc that? If that is your entire declaration and it is not declared elsewhere, then you are gonna need <code>SD * sdCard = malloc(sizeof(SD));</code>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1563371874, "post_id": 57077381, "comment_id": 100678456, "body": "Where is the memory for the <code>SD</code> object that <code>sdCard</code> is pointing at?  If you pointed it at a local variable inside a function that later returned earlier in your program, then it might be aliasing onto local variables on the stack inside your function which is undefined behaviour."}, {"owner": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "edited": false, "score": 0, "creation_date": 1563372170, "post_id": 57077381, "comment_id": 100678659, "body": "The first declaration is in the main <code>SD sdCard;</code> I give the variable to a function and the function saves it in the library. <code>SDInit(&amp;sdCard)</code> <code>uint8_t SDInit(SD* sd){ \tsdCard = sd;&#47;&#47;rest of the code}</code>"}, {"owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "edited": false, "score": 0, "creation_date": 1563372673, "post_id": 57077381, "comment_id": 100678990, "body": "If I had to guess, I would say that you are misusing the SDInit function and sdCard is not properly initialized. Can you show the call to that function, as well as the initialization of the param you pass to it?"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1563377905, "post_id": 57077381, "comment_id": 100682183, "body": "<code>if(!SDInit(&amp;sdCard)){ QM_PRINTF(&quot;ERROR1\\n&quot;);</code>: errors are usually reported as non-zero.  That looks weird"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "edited": false, "score": 0, "creation_date": 1563374055, "post_id": 57078040, "comment_id": 100679969, "body": "Thank you! I used your first suggestion because I quite need the function. I am currently testing the system, but at the moment it is working."}, {"owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "reply_to_user": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "edited": false, "score": 0, "creation_date": 1563374189, "post_id": 57078040, "comment_id": 100680048, "body": "Great. If it ends up working, mark it for others with the same/similar problem. Welcome to Stack Overflow."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "edited": false, "score": 1, "creation_date": 1563374415, "post_id": 57078040, "comment_id": 100680191, "body": "@Bolt123:  Why would you use dynamic storage for this at all, instead of making <code>SD sdCard;</code> instead of <code>SD *sdCard</code>?  If you always init a pointer once at startup with a fixed-size malloc call and never change it, you might as well just use static storage instead.  Then you can remove a level of indirection instead of having a pointer that&#39;s initialized to point at a private static <code>SD</code> object.  You can still pass around a pointer to the static object of course, so you don&#39;t have to change much code."}, {"owner": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1563376203, "post_id": 57078040, "comment_id": 100681227, "body": "@PeterCordes, thank you for saying that. I checked my code and I changed it and it is also working. So both of your answers work!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "edited": false, "score": 0, "creation_date": 1563376271, "post_id": 57078040, "comment_id": 100681263, "body": "@Bolt123: yeah, of course Zachary&#39;s answer works, it&#39;s just less efficient."}], "tags": [], "owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "is_accepted": true, "score": 1, "last_activity_date": 1563808294, "last_edit_date": 1563808294, "creation_date": 1563373016, "answer_id": 57078040, "question_id": 57077381, "link": "https://stackoverflow.com/questions/57077381/why-are-my-variables-in-my-struct-changing/57078040#57078040", "title": "Why are my variables in my struct changing?", "body": "<p>You are improperly initializing <code>sdCard</code>. Currently you are assigning the value of <code>sdCard</code> to be a pointer to its own location on the stack. Instead, do <code>SDInit(malloc(sizeof(SD)));</code>.</p>\n\n<p>Personally, I would not even have that initialization function. I would just do <code>SD * sdCard = malloc(sizeof(SD));</code></p>\n\n<p>EDIT: In response to Peter's point, you could also do this and ignore the instantiation function:</p>\n\n<pre><code>SD sdCard;\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10388172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07190ad339f293e38584b1b3a50c2f63?s=128&d=identicon&r=PG&f=1", "display_name": "Bolt123", "link": "https://stackoverflow.com/users/10388172/bolt123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 57078040, "answer_count": 1, "score": 0, "last_activity_date": 1563808294, "creation_date": 1563371052, "last_edit_date": 1563372401, "question_id": 57077381, "link": "https://stackoverflow.com/questions/57077381/why-are-my-variables-in-my-struct-changing", "title": "Why are my variables in my struct changing?", "body": "<p>I am trying to set up an SD card on an Intel Board D2000 Quark. The problem, I am encountering is that my variables in my struct change at a certain point in the program. I figured out when the variables are changing but I do not have an idea how to fix it.</p>\n\n<p>The reason I am using C instead of C++ is that the compiler of Intel Microcontrollers Studio does not let my use C++. </p>\n\n<p>Below, I copied some of the relevant code.</p>\n\n<pre><code>SD* sdCard;\nuint8_t readData(uint32_t block, uint16_t offset, uint16_t count, uint8_t* dst){\n    if(count == 0){\n        return true;\n    }\n    if((count + offset) &gt; 512){\n        goto fail;\n    }\n    if(!sdCard-&gt;inBlock_ || block != sdCard-&gt;block_ || offset &lt; sdCard-&gt;offset_){\n        sdCard-&gt;block_ = block;\n        if(sdCard-&gt;type_ != SD_CARD_TYPE_SDHC){\n            block &lt;&lt;=9;\n        }\n        uint8_t result = sendCommand(CMD17, block);\n        if(result){\n            goto fail;\n        }\n        if(!waitStartBlock()){\n            goto fail;\n        }\n        sdCard-&gt;offset_ = 0;\n        sdCard-&gt;inBlock_ = 1;\n    }\n\n    for(; sdCard-&gt;offset_ &lt; offset; sdCard-&gt;offset_++){\n        spiRecieve();\n    }\n    for(uint16_t i = 0; i &lt; count; i++){\n        dst[i] = spiRecieve();\n    }\n    sdCard-&gt;offset_ += count;\n    if(!sdCard-&gt;partialBlockRead_ || sdCard-&gt;offset_ &gt;= 512){\n        readEnd();\n    }\n    QM_PUTS(\"RD FINISH\");\n    return true;\n\n    fail:\n    QM_PUTS(\"RD FAIL\");\n    return false;}\n</code></pre>\n\n<p>The moment the variables change is <code>sdCard-&gt;block_ = block;</code>. First it is a certain value. After this statement the value is 0xFFFFFFFF; This happens to every variable in the struct. </p>\n\n<p>My struct looks like this:</p>\n\n<pre><code>typedef struct SDcard{\nuint32_t block_ ;\nuint8_t errorCode_;\nuint8_t inBlock_;\nuint16_t offset_;\nuint8_t partialBlockRead_;\nuint8_t status_;\nuint8_t type_;\n}SD;\n</code></pre>\n\n<p>Update for the comments:\nThis is my temporary main:</p>\n\n<pre><code>SD sdCard;\n\nint main(void)\n{\nif(!SDInit(&amp;sdCard)){\n    QM_PRINTF(\"ERROR1\\n\");\n}\nwhile(1){}\n}\n</code></pre>\n\n<p>If anyone knows a solution or has some questions, please let me know.</p>\n"}, {"tags": ["c", "cryptography", "malloc"], "comments": [{"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 2, "creation_date": 1563371138, "post_id": 57077378, "comment_id": 100677944, "body": "Zeroing would be a safe thing to do, yes. I believe that all current OSes do zero your memory before giving it to another process (but they might no guerantee that behavior...), but certainly you also want to protect your process from itself."}, {"owner": {"reputation": 31885, "user_id": 1008938, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/EOZbS.png?s=128&g=1", "display_name": "Linuxios", "link": "https://stackoverflow.com/users/1008938/linuxios"}, "edited": false, "score": 2, "creation_date": 1563371293, "post_id": 57077378, "comment_id": 100678045, "body": "See some notes at this question: <a href=\"https://stackoverflow.com/questions/1287180/why-doesnt-free-zero-out-the-memory-prior-to-releasing-it\" title=\"why doesnt free zero out the memory prior to releasing it\">stackoverflow.com/questions/1287180/&hellip;</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1563371373, "post_id": 57077378, "comment_id": 100678099, "body": "Note, that <code>memset</code> might be insufficient for this, as it is not guaranteed to not be optimized out. There is (optionally) <code>memset_s</code> which has the required guarantee."}], "answers": [{"tags": [], "owner": {"reputation": 4859, "user_id": 7431860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P6Jko.jpg?s=128&g=1", "display_name": "Nick Reed", "link": "https://stackoverflow.com/users/7431860/nick-reed"}, "is_accepted": false, "score": 3, "last_activity_date": 1563372819, "last_edit_date": 1563372819, "creation_date": 1563372516, "answer_id": 57077870, "question_id": 57077378, "link": "https://stackoverflow.com/questions/57077378/is-it-possible-to-recover-secret-data-with-allocating-memory-like-rsa-private-k/57077870#57077870", "title": "Is it possible to recover secret data with allocating memory (like RSA private key in free&#39;d memory used for decryption)?", "body": "<p><strong>It's possible, but there's no guarantees.</strong></p>\n\n<p>If you're coding in C, and the target memory was previously allocated by your program, then <em>depending on your implementation</em>, you may or may not get an access violation (Segmentation fault). <a href=\"https://stackoverflow.com/a/1584414/7431860\">This answer</a> explains that it's possible to re-access data that's already been freed by the same program that allocated it, as C memory functions don't necessarily return their memory to the OS after it's freed, and may instead <a href=\"https://stackoverflow.com/a/1309314/7431860\">keep it around in the process's heap manager</a>, un-zero'd, to re-allcoate it faster. This is implementation-specific, though, and there's no guarantee it will work. <a href=\"https://stackoverflow.com/a/1287228/7431860\">If you really want to make sure sensitive data is gone, use memset() before you free it.</a></p>\n\n<p>As for <em>another</em> program's sensitive data, though, <a href=\"https://security.stackexchange.com/a/110482\">this post on Information Security</a> describes the conditions where it's possible to read another process's data, allocated or otherwise: running your process as root, a child/parent that forked in such a way, or programs using shared memory space. Outside of these conditions, it's probably not possible.</p>\n\n<p>When you allocate memory, the kernel will return anonymous map (<a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow noreferrer\">memory that is not backed by a file, and is set to zero</a>) with <code>mmap()</code>. This is always zero filled, except in the most specific circumstances (constrained embedded systems). Even then, the kernel has to be compiled specifically to allow this.</p>\n\n<p>Even in the best of circumstances, I doubt it could be done at all, let alone consistently.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1563372571, "last_edit_date": 1592644375, "creation_date": 1563372571, "answer_id": 57077882, "question_id": 57077378, "link": "https://stackoverflow.com/questions/57077378/is-it-possible-to-recover-secret-data-with-allocating-memory-like-rsa-private-k/57077882#57077882", "title": "Is it possible to recover secret data with allocating memory (like RSA private key in free&#39;d memory used for decryption)?", "body": "<p>Inside a single process, neither the operating system nor standard C libraries nor other ordinary libraries provide any protection against finding data by examining the contents of freed memory. The routines that allocate and free memory essentially<sup>1</sup> work entirely inside the process, and the process, including your code inside the process, has full control over them. (Cryptographic libraries may include special provisions for protecting data when its memory is being freed.)</p>\n<p>Outside a single process, all general-purpose multi-user operating systems protect processes by ensuring that any data formerly used by one process is overwritten with safe data (often zeros) before being given to another process.</p>\n<p>For the most part, the protections afforded by operating systems assume the memory and other hardware behave ideally as taught in class: That each memory bit contains a zero or a one and nothing else. In practice, hardware is imperfect, and flaws can sometimes be used to get data that should be protected.</p>\n<h2>Footnotes</h2>\n<p><sup>1</sup> Generally, memory allocation routines have to have some interaction with the system, such as requesting more memory from the system. But the bulk of the memory management is done inside the process.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1563373575, "creation_date": 1563373575, "answer_id": 57078220, "question_id": 57077378, "link": "https://stackoverflow.com/questions/57077378/is-it-possible-to-recover-secret-data-with-allocating-memory-like-rsa-private-k/57078220#57078220", "title": "Is it possible to recover secret data with allocating memory (like RSA private key in free&#39;d memory used for decryption)?", "body": "<p>It is possible, since freeing memory doesn't necessarily mean that it gets cleared.</p>\n\n<p>For example, given the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[])\n{\n    int i, len = 20;\n    char *p = malloc(len);\n    strcpy(p, \"this is a test!!\");\n    printf(\"&amp;p=%p, p=%s\\n\", &amp;p, p);\n    for (i=0; i&lt;len; i++) {\n        printf(\"%02x \", p[i]);\n    }\n    printf(\"\\n\");\n    free(p);\n    // undefined behavior below: dereferencing freed memory\n    printf(\"p=%s\\n\",  p);\n    for (i=0; i&lt;len; i++) {\n        printf(\"%02x \", p[i]);\n    }\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>My system outputs the following:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>&amp;p=0x7ffd24e08290, p=this is a test!!\n74 68 69 73 20 69 73 20 61 20 74 65 73 74 21 21 00 00 00 00 \np=\n00 00 00 00 00 00 00 00 61 20 74 65 73 74 21 21 00 00 00 00 \n</code></pre>\n\n<p>So if your program had a security flaw that allowed an attacker to take control of it, they could dump the contents of this freed memory and expose sensitive data.</p>\n\n<p>For this reason, memory containing secret data should be wiped as soon as it is no longer needed.  The naive approach to this would be to call <code>memset</code> on the block of memory, however many compilers will optimize it out if it sees that the memory is no longer used after that point.</p>\n\n<p>There is a function defined in the C standard called <code>memset_s</code> which is guaranteed not to be optimized out, however not all implementations have it.  You'll need to find some library call that will clear memory that won't me optimized out.  Libraries like OpenSSL will do this for you when you call their cleanup routines (see <a href=\"https://stackoverflow.com/questions/42868879/c-code-to-clean-up-memory-for-openssl-evp-pkey-private-keys\">this post</a> as a example).</p>\n"}], "owner": {"reputation": 184, "user_id": 10064563, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "\u0130brahim \u0130pek", "link": "https://stackoverflow.com/users/10064563/%c4%b0brahim-%c4%b0pek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 57078220, "answer_count": 3, "score": 5, "last_activity_date": 1563373575, "creation_date": 1563371049, "last_edit_date": 1563371231, "question_id": 57077378, "link": "https://stackoverflow.com/questions/57077378/is-it-possible-to-recover-secret-data-with-allocating-memory-like-rsa-private-k", "title": "Is it possible to recover secret data with allocating memory (like RSA private key in free&#39;d memory used for decryption)?", "body": "<p>For example, lets take the pseudo code which tries to obtain RSA private key once stored in allocated (then <code>free</code>'d) memory with this method:</p>\n\n<pre><code>int main(){\n    bigNum priKey;\n\n\n    while(true) {\n        void *mem = malloc(2024); //allocate a good amount of chunk\n\n        if(rsaKeyIn(mem, &amp;priKey))\n            break;\n    }\n\n    printf(\"RSA PRK found: %s\", priKey.getText())\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Question</strong>: Is this possible? or is it possible to recover any other secret data?</p>\n\n<p>Or does the OS zero'es the <code>free</code>'d memory for sake of security? If it is not the case, should we fill allocated memory with zeroes manually before we free it?</p>\n"}, {"tags": ["c", "compiler-errors", "proc"], "answers": [{"tags": [], "owner": {"reputation": 1115, "user_id": 10856970, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q3mai-ypFws/AAAAAAAAAAI/AAAAAAAAAIg/GUzS4DSGL-o/photo.jpg?sz=128", "display_name": "Shivendra Pratap Kushwaha", "link": "https://stackoverflow.com/users/10856970/shivendra-pratap-kushwaha"}, "is_accepted": true, "score": 0, "last_activity_date": 1563371247, "creation_date": 1563371247, "answer_id": 57077449, "question_id": 57077327, "link": "https://stackoverflow.com/questions/57077327/compilation-error-of-pc-file-pcc-s-02015-unable-to-open-include-file-and-pc/57077449#57077449", "title": "compilation error of .pc file &quot;PCC-S-02015, unable to open include file&quot; and &quot;PCC-S-02201, Encountered the symbol &quot;size_t&quot; &quot;", "body": "<p>I checked the sys_include variable in \"<strong>/u01/app2/ora12c/product/12.1.0/dbhome_1/precomp/admin/pcscfg.cfg</strong>\" file. Some of the include paths were not available. Those directories were not found in the server. I tried to include the path during compilation ( Alternate way is to change path in pcscfg.cfg ). </p>\n\n<pre><code>proc  include=/usr/lib/gcc/x86_64-redhat-linux/4.8.2/include connection.pc\n</code></pre>\n\n<p>And the issue was resolved. </p>\n"}], "owner": {"reputation": 1115, "user_id": 10856970, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q3mai-ypFws/AAAAAAAAAAI/AAAAAAAAAIg/GUzS4DSGL-o/photo.jpg?sz=128", "display_name": "Shivendra Pratap Kushwaha", "link": "https://stackoverflow.com/users/10856970/shivendra-pratap-kushwaha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 57077449, "answer_count": 1, "score": 0, "last_activity_date": 1563371556, "creation_date": 1563370907, "last_edit_date": 1563371556, "question_id": 57077327, "link": "https://stackoverflow.com/questions/57077327/compilation-error-of-pc-file-pcc-s-02015-unable-to-open-include-file-and-pc", "title": "compilation error of .pc file &quot;PCC-S-02015, unable to open include file&quot; and &quot;PCC-S-02201, Encountered the symbol &quot;size_t&quot; &quot;", "body": "<p>I made a .pc code for DB connectivity. But it fails due to compilation error. I am running below command:</p>\n\n<pre><code>proc connectivity.c\n</code></pre>\n\n<p>And getting output as :</p>\n\n<pre><code>/Pro*C/C++: Release 12.1.0.1.0 - Production on Wed Jul 17 18:54:54 2019\n\nCopyright (c) 1982, 2013, Oracle and/or its affiliates.  All rights reserved.\n\nSystem default option values taken from: \n/u01/app2/ora12c/product/12.1.0/dbhome_1/precomp/admin/pcscfg.cfg\n\nError at line 33, column 11 in file /usr/include/stdio.h\n# include &lt;stddef.h&gt;\n..........1\nPCC-S-02015, unable to open include file\nError at line 15, column 10 in file /usr/include/_G_config.h\n#include &lt;stddef.h&gt;\n.........1\nPCC-S-02015, unable to open include file\nError at line 51, column 11 in file /usr/include/wchar.h\n# include &lt;stddef.h&gt;\n..........1\nPCC-S-02015, unable to open include file\nError at line 50, column 10 in file /usr/include/libio.h\n#include &lt;stdarg.h&gt;\n.........1\nPCC-S-02015, unable to open include file\nSyntax error at line 307, column 3, file /usr/include/libio.h:\nError at line 307, column 3 in file /usr/include/libio.h\n  size_t __pad5;\n..1\nPCC-S-02201, Encountered the symbol \"size_t\" when expecting one of the \nfollowing\n:\n\n   } char, const, double, enum, float, int, long, ulong_varchar,\n   OCIBFileLocator OCIBlobLocator, OCIClobLocator, OCIDateTime,\n   OCIExtProcContext, OCIInterval, OCIRowid, OCIDate, OCINumber,\n   OCIRaw, OCIString, short, signed, sql_context, sql_cursor,\n   struct, union, unsigned, utext, uvarchar, varchar, void,\n   volatile, a typedef name,\nThe symbol \"enum,\" was substituted for \"size_t\" to continue.\n</code></pre>\n\n<p>I checked all header files are present. This issue is coming from some library variables and functions. </p>\n"}, {"tags": ["c", "linux-kernel", "mutex", "deadlock", "panic"], "comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1563381484, "post_id": 57077036, "comment_id": 100684187, "body": "How about running <code>sysctl kernel.softlockup_panic=1</code>?"}, {"owner": {"reputation": 991, "user_id": 2012815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gFdPO.jpg?s=128&g=1", "display_name": "Peter L.", "link": "https://stackoverflow.com/users/2012815/peter-l"}, "edited": false, "score": 0, "creation_date": 1563390211, "post_id": 57077036, "comment_id": 100688114, "body": "You can also call panic() from within your code."}, {"owner": {"reputation": 1, "user_id": 11797740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_O2-xVgpFR8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdY42bm7nNd619qjZGUAwoF1JjVOw/photo.jpg?sz=128", "display_name": "siba prasad", "link": "https://stackoverflow.com/users/11797740/siba-prasad"}, "reply_to_user": {"reputation": 991, "user_id": 2012815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gFdPO.jpg?s=128&g=1", "display_name": "Peter L.", "link": "https://stackoverflow.com/users/2012815/peter-l"}, "edited": false, "score": 0, "creation_date": 1563453310, "post_id": 57077036, "comment_id": 100710569, "body": "@PeterL. If I call panic() from the code, then I&#39;ll get dumps because of that. But I want the dumps due to watchdog bite from deadlock using mutex."}, {"owner": {"reputation": 1, "user_id": 11797740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_O2-xVgpFR8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdY42bm7nNd619qjZGUAwoF1JjVOw/photo.jpg?sz=128", "display_name": "siba prasad", "link": "https://stackoverflow.com/users/11797740/siba-prasad"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1563455261, "post_id": 57077036, "comment_id": 100711750, "body": "@IanAbbott I already used this. Please find it below. /etc # sysctl -a | grep kernel.softlockup_panic                                                                                                                                                    kernel.softlockup_panic = 1 Still, my device is not getting crashed."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1563458635, "post_id": 57077036, "comment_id": 100714069, "body": "Thinking about it a bit more, the only effect of the mutex deadlock in <code>foo2</code> is to put the kernel thread to sleep. There is nothing to prevent other tasks being scheduled on the CPU that was running that kernel thread, so no soft lockup condition will occur. You should be able to detect the deadlock using the lock debugging kernel config options, but I don&#39;t think there is an option to call panic() when a locking violation occurs."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1563467648, "post_id": 57077036, "comment_id": 100719345, "body": "You need to trigger the watchdog timer in the kernel.  I believe that will trigger if timer interrupts are disabled for 10 seconds."}, {"owner": {"reputation": 1, "user_id": 11797740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_O2-xVgpFR8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdY42bm7nNd619qjZGUAwoF1JjVOw/photo.jpg?sz=128", "display_name": "siba prasad", "link": "https://stackoverflow.com/users/11797740/siba-prasad"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1563528435, "post_id": 57077036, "comment_id": 100738453, "body": "@stark - I&#39;m sorry. But how to trigger the watchdog timer in kernel? Do you mean to run echo c &gt; /proc/sysrq-trigger?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1563540319, "post_id": 57077036, "comment_id": 100744334, "body": "You want the watchdog to trigger. I explained in my comment what triggers the watchdog.  It has nothing to do with sysrq.  It has nothing to do with deadlocks.  It has to do with timer interrupts, that&#39;s it."}], "owner": {"reputation": 1, "user_id": 11797740, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_O2-xVgpFR8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdY42bm7nNd619qjZGUAwoF1JjVOw/photo.jpg?sz=128", "display_name": "siba prasad", "link": "https://stackoverflow.com/users/11797740/siba-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563435667, "creation_date": 1563370085, "last_edit_date": 1563435667, "question_id": 57077036, "link": "https://stackoverflow.com/questions/57077036/how-to-create-kernel-panic-when-deadlock-happens-due-to-mutex-lock", "title": "How to create kernel panic when deadlock happens due to mutex lock?", "body": "<p>I want to manually create a kernel panic using mutex based deadlock. \nI created 2 kernel threads in a module &amp; did recursive mutex lock. So one of the thread again acquire the lock &amp; put into deadlock situation. I understand that using mutex, system went to sleep state, so device is not getting crashed. Is there any mechanism, that I can create a panic when deadlock happens due to mutex lock?</p>\n\n<pre><code>int foo1(void *data)\n{\n    while(!kthread_should_stop()) {\n        mutex_lock(&amp;my_mutex);\n        global_variable++;\n        mutex_unlock(&amp;my_mutex);\n        msleep(1000);\n    }\n    return 0;\n}\n\nint foo2(void *data)\n{\n    while(!kthread_should_stop()) {\n        mutex_lock(&amp;my_mutex);\n        global_variable++;\n        mutex_lock(&amp;my_mutex);  // Recursive lock\n        mutex_unlock(&amp;my_mutex);\n        msleep(1000);\n    }\n    return 0;\n}\n\nstatic int __init driver_init(void)\n{\n        if((alloc_chrdev_region(&amp;dev, 0, 1, \"my_Dev\")) &lt;0){\n                printk(KERN_INFO \"Cannot allocate major number\\n\");\n                return -1;\n        }\n        cdev_init(&amp;my_cdev,&amp;fops);\n\n        if((cdev_add(&amp;my_cdev,dev,1)) &lt; 0){\n            printk(KERN_INFO \"Cannot add the device to the system\\n\");\n        }\n\n        if((device_create(dev_class,NULL,dev,NULL,\"my_device\")) == NULL){\n            printk(KERN_INFO \"Cannot create the Device\\n\");\n            class_destroy(dev_class);\n        }\n\n        mutex_init(&amp;my_mutex);\n\n        my_thread1 = kthread_run(foo1,NULL,\"my Thread1\");\n        if(my_thread1) {\n            printk(KERN_ERR \"Kthread1 Created Successfully...\\n\");\n        } else {\n            printk(KERN_ERR \"Cannot create kthread1\\n\");\n        }\n\n        my_thread2 = kthread_run(foo2,NULL,\"my Thread2\");\n        if(my_thread2) {\n            printk(KERN_ERR \"Kthread2 Created Successfully...\\n\");\n        } else {\n            printk(KERN_ERR \"Cannot create kthread2\\n\");\n        }\n        return 0;\n}\n</code></pre>\n\n<p>Using above code, I'm able to create the deadlock. But I'm looking for a kernel panic, so that I can do the debugging for this error.</p>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 4, "creation_date": 1563367509, "post_id": 57076129, "comment_id": 100675465, "body": "All you&#39;re doing is assigning memory addresses. There&#39;s no copying of the character data happening (You&#39;d use something like <code>strcpy</code> for that)."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1563367543, "post_id": 57076129, "comment_id": 100675490, "body": "Why do you think it should give <code>segfault</code>?"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1563367695, "post_id": 57076129, "comment_id": 100675575, "body": "You&#39;re leaking the memory allocated by <code>malloc(sizeof(char)*1);</code>, but that&#39;s not going to cause a segmentation fault. On an unrelated note, <code>sizeof(char)</code> is always <code>1</code> so you can just shorten it to <code>malloc(1)</code> instead."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1563367942, "post_id": 57076129, "comment_id": 100675735, "body": "Explicitly asking for segmentation-fault is not considered a good learning strategy."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1563368011, "post_id": 57076129, "comment_id": 100675796, "body": "@machine_1 That depends, on the learning curriculum. :)"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 6, "last_activity_date": 1563367737, "last_edit_date": 1563367737, "creation_date": 1563367652, "answer_id": 57076224, "question_id": 57076129, "link": "https://stackoverflow.com/questions/57076129/why-does-this-code-work-and-not-produce-a-segmentation-error/57076224#57076224", "title": "Why does this code work and not produce a segmentation error?", "body": "<p>In your code</p>\n\n<pre><code>names[0]=malloc(sizeof(char)*1) ;\nnames[0]=\"ATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATC\";\n</code></pre>\n\n<p>you're basically overwriting the value of the variable <code>names[0]</code>, i.e, storing another pointer to it (the starting address of the string literal). There is no reason it should produce a segmentation fault. It will however, cause <a href=\"https://en.wikipedia.org/wiki/Memory_leak\" rel=\"noreferrer\">memory leak</a>, as you're losing the original pointer returned by <code>malloc()</code> and will never get a chance to <code>free()</code> it.</p>\n\n<p>OTOH, if you would have written something like</p>\n\n<pre><code>names[0]=malloc(sizeof(char)*1) ;\nstrcpy(names[0], \"ATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATC\");\n</code></pre>\n\n<p>where you were trying to access memory location beyond the allocated boundary, you'll invoke <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a>. Then also, segmentation fault is <strong>one of the many</strong> possible side effects, it's never guranteed.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 4, "last_activity_date": 1563368107, "creation_date": 1563368107, "answer_id": 57076362, "question_id": 57076129, "link": "https://stackoverflow.com/questions/57076129/why-does-this-code-work-and-not-produce-a-segmentation-error/57076362#57076362", "title": "Why does this code work and not produce a segmentation error?", "body": "<p>Your code is well formed, so there's no reason it should segfault.  Let's break things down:</p>\n\n<pre><code>char **names;\n</code></pre>\n\n<p>This declares a pointer to pointer to <code>char</code>.</p>\n\n<pre><code>names=malloc(2*sizeof(char *));\n</code></pre>\n\n<p>This allocates space for an array of <code>char *</code> of size 2 and assigns that address to <code>names</code>.</p>\n\n<pre><code>names[0]=malloc(sizeof(char)*1) ;\n</code></pre>\n\n<p>This allocates space for an array of <code>char</code> of size 1 and assigns that address to <code>names[0]</code>.</p>\n\n<pre><code>names[0]=\"ATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATC\";\n</code></pre>\n\n<p>Here's where it gets interesting.  This assigns the address of the given string constant to <code>names[0]</code>, <strong>overwriting</strong> the address of the allocated memory that was assigned on the previous line.  This also leaks the memory allocated on the prior line.</p>\n\n<pre><code>printf(\"%s\",names[0]);\n</code></pre>\n\n<p>This prints the string pointed to by <code>names[0]</code>.  Since it contains the address of the string literal <code>\"ATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATC\"</code>, that is what was printed.</p>\n\n<p>Instead of assigning a string literal to <code>names[0]</code>, what you probably wanted to do was this:</p>\n\n<pre><code>strcpy(names[0], \"ATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATC\");\n</code></pre>\n\n<p>This would copy the contents of the string literal to <code>names[0]</code>, which only points to 1 byte of allocated memory.  A segfault here however is not guaranteed.  </p>\n\n<p>When you write past the end of allocated memory, you invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> which means the code may crash, it may output strange results, or it could appear to work properly.  Just because the code <em>might</em> crash doesn't mean it <em>will</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1563371282, "creation_date": 1563371282, "answer_id": 57077461, "question_id": 57076129, "link": "https://stackoverflow.com/questions/57076129/why-does-this-code-work-and-not-produce-a-segmentation-error/57077461#57077461", "title": "Why does this code work and not produce a segmentation error?", "body": "<p>As pointed out by the other answers, a pointer to the first character in the string literal is assigned to <code>names[0]</code> rather than the string being copied into the allocated object. Also, if you assign a string literal to a character pointer variable, it should be declared as <code>const</code>.</p>\n\n<p>When working in C, the programmer needs to create her own safety net. Below is an example of a function which terminates the program if the string to be assigned is too long.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define LEN(arr) (sizeof (arr) / sizeof (arr)[0])\n#define NEW_ARRAY(ptr, n) (ptr) = malloc((n) * sizeof (ptr)[0])\n\nstatic void Copy(const char source[], int sourceLen, char target[], int targetLen)\n{\n    if (targetLen &gt;= sourceLen) {\n        strcpy(target, source);\n    } else {\n        fprintf(stderr, \"Copy failed\\n\");\n        exit(EXIT_FAILURE);\n    }\n}\n\n\nint main(void)\n{\n    char source[] = \"ATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATC\";\n    char *target;\n    int targetLen = 1;\n\n    NEW_ARRAY(target, targetLen);\n    Copy(source, LEN(source), target, targetLen);\n    puts(target);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8011520, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-owlJX5GmPwI/AAAAAAAAAAI/AAAAAAAAACk/L8hYZ5wRtIE/photo.jpg?sz=128", "display_name": "Alsamman", "link": "https://stackoverflow.com/users/8011520/alsamman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 57076224, "answer_count": 3, "score": -1, "last_activity_date": 1563371282, "creation_date": 1563367377, "last_edit_date": 1563368212, "question_id": 57076129, "link": "https://stackoverflow.com/questions/57076129/why-does-this-code-work-and-not-produce-a-segmentation-error", "title": "Why does this code work and not produce a segmentation error?", "body": "<p>Why doesn't this code give me segmentation error?\nI've allocated only 1 char and yet I entered more than 1 char.</p>\n\n<pre><code>char **names;\n\nnames=malloc(2*sizeof(char *));\nnames[0]=malloc(sizeof(char)*1) ;\n\nnames[0]=\"ATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATCCACTATCAHCTACHATC\";\n\nprintf(\"%s\",names[0]);\n</code></pre>\n\n<p>I expected it should generate a segmentation error.</p>\n"}, {"tags": ["c", "hash"], "comments": [{"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1563367318, "post_id": 57076013, "comment_id": 100675359, "body": "First of all, don&#39;t cast malloc: <a href=\"https://stackoverflow.com/q/605845/6872717\">stackoverflow.com/q/605845/6872717</a>"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 3, "creation_date": 1563367455, "post_id": 57076013, "comment_id": 100675433, "body": "When asking about a compilation error, including the actual compilation error sounds useful."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1563367568, "post_id": 57076013, "comment_id": 100675503, "body": "Instead of <code>malloc(sizeof(type));</code> use <code>malloc(sizeof(*ptr));</code> which is future-proof."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1563367665, "post_id": 57076013, "comment_id": 100675554, "body": "If you change the first sentence to &quot;It doesn&#39;t work and it stops at allocation of new node.&quot; then the question makes more sense."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1563369818, "post_id": 57076013, "comment_id": 100677094, "body": "@Justanotherstudent : Was there actually a compilation error ? Or was that a typo like Ian Abbott assumes ? Can you clarify what actually happens by editing the question (describe both the desired behavior and the actual behavior in sufficient detail) ?"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10489209, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CCSSJPuzWyA/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUAF-vsOgHOI3S28ZN_Lu9S4AyJ6w/mo/photo.jpg?sz=128", "display_name": "Just another student", "link": "https://stackoverflow.com/users/10489209/just-another-student"}, "edited": false, "score": 0, "creation_date": 1563367482, "post_id": 57076127, "comment_id": 100675446, "body": "Definitely that, my bad"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 59, "user_id": 10489209, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CCSSJPuzWyA/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUAF-vsOgHOI3S28ZN_Lu9S4AyJ6w/mo/photo.jpg?sz=128", "display_name": "Just another student", "link": "https://stackoverflow.com/users/10489209/just-another-student"}, "edited": false, "score": 0, "creation_date": 1563367675, "post_id": 57076127, "comment_id": 100675561, "body": "@Justanotherstudent You can also read  <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">do-i-cast-the-result-of-malloc</a>"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 4, "last_activity_date": 1563367375, "creation_date": 1563367375, "answer_id": 57076127, "question_id": 57076013, "link": "https://stackoverflow.com/questions/57076013/error-with-malloc-which-i-cant-understand-using-hash-table-with-separate-chainin/57076127#57076127", "title": "Error with malloc which i cant understand using hash table with separate chaining", "body": "<pre><code>hash *T = (hash*) malloc (n*sizeof(hash));\nfor( i = 0 ; i &lt; 2*n ; i++) {\n    T[i].head= NULL;\n    T[i].count= 0;\n\n}\n</code></pre>\n\n<p>You allocate memory for <code>n</code> elements but loop till <code>2*n</code>, what do you need?</p>\n"}], "owner": {"reputation": 59, "user_id": 10489209, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CCSSJPuzWyA/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUAF-vsOgHOI3S28ZN_Lu9S4AyJ6w/mo/photo.jpg?sz=128", "display_name": "Just another student", "link": "https://stackoverflow.com/users/10489209/just-another-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 57076127, "answer_count": 1, "score": 0, "last_activity_date": 1563367564, "creation_date": 1563367003, "last_edit_date": 1563367564, "question_id": 57076013, "link": "https://stackoverflow.com/questions/57076013/error-with-malloc-which-i-cant-understand-using-hash-table-with-separate-chainin", "title": "Error with malloc which i cant understand using hash table with separate chaining", "body": "<p>it doesnt compile and it stops at declaration of new node. \nThe program itself should initialize an hash table and print the conflicts and how many there are inside of hash table.\nIt seems like it goes out of memory , but im inserting just 5 elements so it shouldnt really do this.\nMaybe its an error between structures? I cant get it.</p>\n\n<pre><code>typedef struct item{\n    int key;\n    struct item *next;\n}item;\n\ntypedef struct hash{\n    item *head;\n    int count;\n} hash;\n\n\n\nint hashing(int x , int a , int b , int table_size){\n    int p = 999149;\n    return ((a*x + b) % p) % 2*table_size;\n}\n\nitem * insert_list( int x){\n\n    item *new;\n    new = (item*)malloc(sizeof(item));\n\n    new-&gt;key = x;\n    new-&gt;next = NULL;\n    return new;\n}\n\nvoid insert( hash* ht, int x , int a , int b , int table_size){\n    int index = hashing( x , a ,b , table_size);\n    item *new_node=insert_list(x);\n\n    if(!ht[index].head){\n        ht[index].head = new_node;\n        ht[index].count++;\n        return;\n    }\n    new_node-&gt;next = (ht[index].head);\n    ht[index].head = new_node;\n    ht[index].count++;\n    return;\n}\n\n\nint main(){\n    int n, a , b, i , x;\n    scanf(\"%d\", &amp;n);\n    scanf(\"%d\", &amp;a);\n    scanf(\"%d\" , &amp;b);\n\n    int *longest = malloc(sizeof(int)*2);\n\n    hash *T = (hash*) malloc (n*sizeof(hash));\n    for( i = 0 ; i &lt; 2*n ; i++) {\n        T[i].head= NULL;\n        T[i].count= 0;\n\n    }\n\n    for ( i = 0  ; i &lt; n ; i++){\n        scanf(\"%d\" , &amp;x);\n        insert( T, x , a , b ,2*n);\n    }\n    int max_l=-1;\n    int counter=0;;\nfor( i = 0 ; i &lt; 2*n ; i++) {\n    if (max_l&lt; T[i].count)max_l = T[i].count;\n\n    if(T[i].count &gt;1 ) counter= counter + T[i].count;       \n}\nprintf(\"%d\\n%d\", max_l, counter);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1360, "user_id": 11608064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6vNDnlV3OuY/AAAAAAAAAAI/AAAAAAAAPZs/ncdvjh0w7ak/photo.jpg?sz=128", "display_name": "DenverCoder1", "link": "https://stackoverflow.com/users/11608064/denvercoder1"}, "edited": false, "score": 0, "creation_date": 1563367004, "post_id": 57075963, "comment_id": 100675155, "body": "There is no difference between <code>int (a);</code> and <code>int a;</code>"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1563367009, "post_id": 57075963, "comment_id": 100675159, "body": "Is this from some particularly old C code? There&#39;s no type given for the parameter <code>a</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1563367064, "post_id": 57075963, "comment_id": 100675192, "body": "You have two variables in your code, both &quot;wrapped inside parentheses&quot;. Which one do you mean?"}, {"owner": {"reputation": 331, "user_id": 10202131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S1QO2.jpg?s=128&g=1", "display_name": "Md. A. Barik", "link": "https://stackoverflow.com/users/10202131/md-a-barik"}, "edited": false, "score": 0, "creation_date": 1563367319, "post_id": 57075963, "comment_id": 100675360, "body": "Just , I have started learning C programming! I declare variable a with int type and I&#39;m passing the variable in the function as a parameter. So why we need to declared the type like : int check(int a) { ... }"}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 4, "creation_date": 1563367415, "post_id": 57075963, "comment_id": 100675405, "body": "@Md.A.Barik That&#39;s just the way the C language works. The variable in a function is not the same as the one outside it."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 1360, "user_id": 11608064, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6vNDnlV3OuY/AAAAAAAAAAI/AAAAAAAAPZs/ncdvjh0w7ak/photo.jpg?sz=128", "display_name": "DenverCoder1", "link": "https://stackoverflow.com/users/11608064/denvercoder1"}, "edited": false, "score": 2, "creation_date": 1563368061, "post_id": 57075963, "comment_id": 100675831, "body": "@eyl327 Actually, there&#39;s a difference: the first one is ugly, and will make maintainers of the code lose some seconds thinking about why those parentheses are there and who put them there :-)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1563368180, "post_id": 57075963, "comment_id": 100675920, "body": "In the code you have shown, there is no function call, so you are not passing the variable in the function as a parameter. You are (attempting to) define a function with a parameter with the same name as a variable. (The definition should be <code>int check(int a) { ... }</code>.) The parameter and variable are different objects even though they have the same name. The variable <code>a</code> is hidden by parameter <code>a</code> inside the <code>check</code> function body."}], "answers": [{"comments": [{"owner": {"reputation": 1218, "user_id": 5386951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c509548d0fe560351a9dce7dbee6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "89f3a1c", "link": "https://stackoverflow.com/users/5386951/89f3a1c"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1563368572, "post_id": 57076381, "comment_id": 100676202, "body": "Thanks for pointing it out; I was just editing the answer when your notification arrived."}], "tags": [], "owner": {"reputation": 1218, "user_id": 5386951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c509548d0fe560351a9dce7dbee6eb0?s=128&d=identicon&r=PG&f=1", "display_name": "89f3a1c", "link": "https://stackoverflow.com/users/5386951/89f3a1c"}, "is_accepted": true, "score": 5, "last_activity_date": 1563368489, "last_edit_date": 1563368489, "creation_date": 1563368179, "answer_id": 57076381, "question_id": 57075963, "link": "https://stackoverflow.com/questions/57075963/why-should-i-wrap-variable-name-inside-parenthesis-in-c-programming/57076381#57076381", "title": "Why should I wrap variable name inside parenthesis in C programming?", "body": "<blockquote>\n  <p>So why we need to declared the type like : int check(int a) { ... }</p>\n</blockquote>\n\n<p>From this it is clear you're referring to the function and not to the variable itself. That part of the code is defining a function.</p>\n\n<p>So, let's separate the two things in your code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int (a);\n</code></pre>\n\n<p>Declares variable <code>a</code>. As @eyl327 stated:</p>\n\n<blockquote>\n  <p>There is no difference between int (a); and int a;</p>\n</blockquote>\n\n<p>So that int could be called whatever you wanted; that it now has the same name as the variable used in the function definition is just coincidence. It could be, for example, <code>int my_integer;</code>.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int check(a) {\n    return a % 2;\n}\n</code></pre>\n\n<p>Here you define a function which receives an integer and which will return modulo 2 of that int (you can read <a href=\"https://www.quora.com/C-Programming-How-does-the-modulus-operator-work-when-we-divide-a-smaller-number-by-a-larger-number-For-example-3-5-or-5-10\" rel=\"noreferrer\">this</a> if you don't know what that means).</p>\n\n<p>It is missing the <em>type</em> of the variable which receives the function. It should be, instead:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int check(int a) {\n    return a % 2;\n}\n</code></pre>\n\n<p>Now, I think it is possible that the combination used in your code is valid, but I've never seen it before, and if you're learning now, I'd suggest you get familiar with the traditional way of defining variables and functions.</p>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 11604295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/886b92fad785ec43f1f17ad6c5d047ee?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/11604295/simon"}, "is_accepted": false, "score": 0, "last_activity_date": 1563368944, "creation_date": 1563368944, "answer_id": 57076648, "question_id": 57075963, "link": "https://stackoverflow.com/questions/57075963/why-should-i-wrap-variable-name-inside-parenthesis-in-c-programming/57076648#57076648", "title": "Why should I wrap variable name inside parenthesis in C programming?", "body": "<p>From what I see, you are asking about the variable declaration.  The function is using proper syntax except for the type of <code>a</code>  e.g. <code>int check(int a) {...}</code>.</p>\n\n<p>For the variable declaration, the parenthesis act as mathematical parenthesis as in they dictate the order to determine the variable type.  In your case, this doesn't change the variable (it is still int).  </p>\n\n<p>However, you can have more complex types that require parenthesis.  For example:</p>\n\n<pre><code>int (*aptr)[3]; //aptr is a pointer to an array of 3 integers\nint *bptr[3]; //bptr is an array of 3 integer pointers\n</code></pre>\n\n<p>These parenthesis are necessary as the order matters.  In this case, brackets ([]) take precedence. You can keep going with more complex types.  But the idea is that parenthesis are used to set an \"order of operations\" when determining the type of a variable.  You can almost always add redundant parenthesis to be verbose, but it is not necessary.</p>\n"}], "owner": {"reputation": 331, "user_id": 10202131, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S1QO2.jpg?s=128&g=1", "display_name": "Md. A. Barik", "link": "https://stackoverflow.com/users/10202131/md-a-barik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 932, "favorite_count": 0, "accepted_answer_id": 57076381, "answer_count": 2, "score": -5, "last_activity_date": 1563368944, "creation_date": 1563366825, "question_id": 57075963, "link": "https://stackoverflow.com/questions/57075963/why-should-i-wrap-variable-name-inside-parenthesis-in-c-programming", "title": "Why should I wrap variable name inside parenthesis in C programming?", "body": "<pre><code>int (a);\n\nint check(a) {\n    return a % 2;\n}\n</code></pre>\n\n<h2>why should I use parenthesis to wrap the variable name</h2>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 306, "user_id": 10164669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lOki1.jpg?s=128&g=1", "display_name": "FedonKadifeli", "link": "https://stackoverflow.com/users/10164669/fedonkadifeli"}, "edited": false, "score": 3, "creation_date": 1563363530, "post_id": 57074912, "comment_id": 100673192, "body": "What kind of code is this? C? Where is the closing <code>#endif</code> in the last code? And why you put type specifiers (<code>int</code>) in the calling code of <code>someMethod</code>?"}, {"owner": {"reputation": 1, "user_id": 8683065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670f53a0cf590bd833b0865515003421?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Kadam", "link": "https://stackoverflow.com/users/8683065/akshay-kadam"}, "edited": false, "score": 0, "creation_date": 1563363667, "post_id": 57074912, "comment_id": 100673254, "body": "Yes, its a C code"}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1563367808, "post_id": 57074912, "comment_id": 100675651, "body": "&quot;unreferenced formal parameter&quot; is a warning, not an error (though you can promote warnings to errors in your settings if you want). It&#39;s complaining that you have parameters that you aren&#39;t using. You have three options: turn off the warning (either <a href=\"https://stackoverflow.com/a/26601359/1287251\">locally</a> or in your project settings), stop promoting the warning to an error (again, in your project settings), or use the parameters (i.e. just do <code>(void)arg1; (void)arg2;</code> within the function to show the compiler you&#39;re using the arguments)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1563367843, "post_id": 57074912, "comment_id": 100675674, "body": "<code>_MACRO</code> is a reserved identifier.  The <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.1.3\" rel=\"nofollow noreferrer\">C standard reserves identifiers</a> starting with a single underscore and an uppercase letter along with identifiers starting with two underscores: &quot;All identifiers that begin with an underscore and either an uppercase letter or another underscore are always reserved for any use.&quot;"}, {"owner": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1563367876, "post_id": 57074912, "comment_id": 100675695, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3020584/avoid-warning-unreferenced-formal-parameter\">Avoid warning &#39;Unreferenced Formal Parameter&#39;</a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 34083, "user_id": 1287251, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IQkBy.png?s=128&g=1", "display_name": "Cornstalks", "link": "https://stackoverflow.com/users/1287251/cornstalks"}, "edited": false, "score": 0, "creation_date": 1563367972, "post_id": 57074912, "comment_id": 100675764, "body": "@Cornstalks That&#39;s a pure C++ question.  I&#39;m not sure it&#39;s applicable to C."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1563369080, "post_id": 57076661, "comment_id": 100676543, "body": "Typos in your case statements?  They&#39;re all <code>FOO1</code> and all call <code>foo1()</code>."}], "tags": [], "owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "is_accepted": false, "score": 0, "last_activity_date": 1563369965, "last_edit_date": 1563369965, "creation_date": 1563368975, "answer_id": 57076661, "question_id": 57074912, "link": "https://stackoverflow.com/questions/57074912/how-to-fix-macro-ifdef-for-conditional-code/57076661#57076661", "title": "How to fix macro #ifdef for conditional code?", "body": "<p>Alternative:</p>\n\n<pre><code>#define FOO (FOO1)\n\nenum Foo {\n        FOO1,\n        FOO2,\n        FOO3\n};\n\nint foo1(void);\nint foo2(void);\nint foo3(void);\n\nint foo(void)\n{\n\n        switch (FOO) {\n        case FOO1:\n                return foo1();\n        case FOO2:\n                return foo2();\n        case FOO3:\n                return foo3();\n        default:\n                return -1;\n        }\n}\n\nint foo1(void)\n{\n        return 1;\n}\n\nint foo2(void)\n{\n        return 2;\n}\n\nint foo3(void)\n{\n        return 3;\n}\n</code></pre>\n\n<p>The benefit of this is that the compiler compiles all the code, so you can check if there are any errors in the code, which with the preprocessor you don't get.</p>\n\n<p>Basically the preprocessor <code>#if</code> and company are useful only for using features that may not be available, but if a feature is available, then prefer <code>if</code> or <code>switch</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 0, "creation_date": 1563369325, "post_id": 57076704, "comment_id": 100676742, "body": "@EdwardKarak Because that completely changes the semantics. That said, the macro suggested also unnecessarily generates dead code (the optimised will probably remove that but why bother?)."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "edited": false, "score": 0, "creation_date": 1563369657, "post_id": 57076704, "comment_id": 100676986, "body": "@EdwardKarak That would impede optimizations"}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1563370194, "post_id": 57076704, "comment_id": 100677321, "body": "@KonradRudolph That&#39;s what common sense seems to indicates, but for our old compiler, that does it. And yes, that creates dead code, but the slight loss in performance is offfset by the fact that we can build this multi-millions lines of a behemoth without getting thousands of false positive warnings."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1563370883, "post_id": 57076704, "comment_id": 100677755, "body": "@MartinV&#233;ronneau I don\u2019t doubt that this \u201cdoes it\u201d. But it\u2019s unnecessary: The method in my answer is the conventional way of suppressing this warning, and generates no dead code and requires no extra files/translation units/build steps."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1563374845, "post_id": 57076704, "comment_id": 100680416, "body": "@KonradRudolph I see absolutely no problem with your method (and in fact, I&#39;ll upvote it), but with the old compiler we&#39;re using it doesn work all the time (I just tested that). That&#39;s really an old compiler for an embedded platform, and we&#39;re stuck with it. Anyway, the warning posted by the OP clearly comes from MSVC, so I agree that your method is better."}], "tags": [], "owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "is_accepted": false, "score": 1, "last_activity_date": 1563388903, "last_edit_date": 1563388903, "creation_date": 1563369106, "answer_id": 57076704, "question_id": 57074912, "link": "https://stackoverflow.com/questions/57074912/how-to-fix-macro-ifdef-for-conditional-code/57076704#57076704", "title": "How to fix macro #ifdef for conditional code?", "body": "<p>I'm hesitant to present you with this solution as it's the ugliest hack ever.</p>\n\n<p>Context : I'm working with a very old C compiler that has a lot of quirks, one of which is that the warnings about unused parameters or variables can happen at any given steps of the optimization process. So, for example, sometimes you get a warning that a certain variable is unused, but truly, it has just been optimized away.</p>\n\n<p>The old codebase is also littered by #ifdef, so I've encountered your problem more than once.</p>\n\n<p><strong>The hack</strong></p>\n\n<p><em>suppresswarning.h</em></p>\n\n<pre><code>extern long SuppressWarning;\n#define SUPPRESS_WARNING(p) (SuppressWarning += (uintptr_t)&amp;(p))\n</code></pre>\n\n<p><em>suppresswarning.c</em></p>\n\n<pre><code>long SupressWarning;\n</code></pre>\n\n<p><em>YourFile.c</em></p>\n\n<pre><code>#include \"suppresswarning.h\"\n\nint someAnotherMethod(int arg1, int arg2)\n{\n  //othercode\n#ifdef __MACRO\n  someMethod(arg1, agr2);\n  //othercode\n#else\n  SUPPRESS_WARNING(arg1);\n  SUPPRESS_WARNING(arg2);\n#endif\n}\n</code></pre>\n\n<p>The <code>SUPPRESS_WARNING</code> macro, essentially, prevents the compiler from optimizing the variable away. This has the added value to be clear for any new programmer reading the code ; <code>SUPPRESS_WARNING</code> suppresses a warning.</p>\n\n<p>This hack doesn't necessarly require to add a translation unit. Most projects have miscellaneous units for debugging or for utility functions ; this can be put there instead.</p>\n"}, {"comments": [{"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1563369914, "post_id": 57076747, "comment_id": 100677164, "body": "I used <code>(void)</code> as <code>UNUSED</code>, but it doesn&#39;t avoid <code>-Wunused-result</code>, so I came up with a more sophisticated one: <code>#define UNUSED(e) do { if (e) {} } while (0)</code>"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 1, "creation_date": 1563370795, "post_id": 57076747, "comment_id": 100677692, "body": "@CacahueteFrito The <code>-Wunused-result</code> warning is unrelated to OP\u2019s question: It corresponds to unused <i>result</i> values on functions, but <i>only</i> if they have the attribute <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#Function-Attributes\" rel=\"nofollow noreferrer\"><code>warn_unused_result</code></a>. And some versions of GCC indeed ignore <code>(void) result;</code> in this context. <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=82134\" rel=\"nofollow noreferrer\">That\u2019s a bug</a>."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1563371105, "post_id": 57076747, "comment_id": 100677916, "body": "Yes, it&#39;s unrelated to OP, but related to answer and I thought it might be useful :)"}], "tags": [], "owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "is_accepted": true, "score": 3, "last_activity_date": 1563369234, "creation_date": 1563369234, "answer_id": 57076747, "question_id": 57074912, "link": "https://stackoverflow.com/questions/57074912/how-to-fix-macro-ifdef-for-conditional-code/57076747#57076747", "title": "How to fix macro #ifdef for conditional code?", "body": "<p>The error you\u2019re getting has been elevated from a warning due to some compiler flag. And you\u2019re getting the warning because, when <code>__MACRO</code> is undefined, your <code>someAnotherMethod</code> function has unused parameters.</p>\n\n<p>The conventional way of silencing this warning is to cast the parameter to <code>void</code>, thereby using it.</p>\n\n<p>Something else, your macro name is invalid, you mustn\u2019t use a double underscore, or a leading underscore followed by a capital letter. This notation is reserved for the C implementation.</p>\n\n<p>Instead, use <code>YOUR_LIBRARY_NAME_MACRO</code> as a naming convention.</p>\n\n<pre><code>int someAnotherMethod(int arg1, int arg2) {\n# ifdef LIB_MACRO\n  someMethod(int arg1, int agr2);\n# else\n  (void) arg1;\n  (void) arg2;\n# endif\n}\n</code></pre>\n\n<p>This is sometimes hidden behind a macro:</p>\n\n<pre><code>#define UNUSED(x) (void) (x)\n\n\u2026\n\nint someAnotherMethod(int arg1, int arg2) {\n  \u2026\n  UNUSED(arg1);\n  \u2026\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563803899, "post_id": 57145970, "comment_id": 100810498, "body": "This does not &quot;work fine&quot;.  There are multiple problems with this answer.  First and foremost, C does not support arguments without a name.  See <a href=\"https://stackoverflow.com/questions/8776810/parameter-name-omitted-c-vs-c\" title=\"parameter name omitted c vs c\">stackoverflow.com/questions/8776810/&hellip;</a>.  Second, <code>__XYZ</code> is a reserved identifier and should not be used."}], "tags": [], "owner": {"reputation": 1, "user_id": 8683065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670f53a0cf590bd833b0865515003421?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Kadam", "link": "https://stackoverflow.com/users/8683065/akshay-kadam"}, "is_accepted": false, "score": 0, "last_activity_date": 1563798138, "creation_date": 1563798138, "answer_id": 57145970, "question_id": 57074912, "link": "https://stackoverflow.com/questions/57074912/how-to-fix-macro-ifdef-for-conditional-code/57145970#57145970", "title": "How to fix macro #ifdef for conditional code?", "body": "<pre><code>int someAnotherMethod(\n#ifdef __XYZ\nint arg1,\n #else\nint,\n#endif\nint arg2)\n{\n//othercode\n#ifdef __XYZ\nsomeMethod(int arg1, int agr2);\n#endif\n//othercode\n}\n</code></pre>\n\n<p>This worked fine for both the arguments.</p>\n"}], "owner": {"reputation": 1, "user_id": 8683065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/670f53a0cf590bd833b0865515003421?s=128&d=identicon&r=PG&f=1", "display_name": "Akshay Kadam", "link": "https://stackoverflow.com/users/8683065/akshay-kadam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 57076747, "answer_count": 4, "score": 0, "last_activity_date": 1563798138, "creation_date": 1563363348, "last_edit_date": 1563367479, "question_id": 57074912, "link": "https://stackoverflow.com/questions/57074912/how-to-fix-macro-ifdef-for-conditional-code", "title": "How to fix macro #ifdef for conditional code?", "body": "<p>I have a method </p>\n\n<pre><code>int someMethod(int arg1, int arg2)\n{\n  //method body\n}\n</code></pre>\n\n<p>and I have a macro defined say <code>_MACRO</code> for the same method so as to execute it based on the condition.</p>\n\n<pre><code>#ifdef _MACRO\nint someMethod(int arg1, int agr2)\n{\n  //method body\n}\n#endif\n</code></pre>\n\n<p>I am using this <code>someMethod</code> in say <code>someAnotherMethod(int arg1, int arg2)</code></p>\n\n<pre><code>int someAnotherMethod(int arg1, int arg2)\n{\n  //othercode\n  #ifdef __MACRO\n  someMethod(int arg1, int agr2);\n  //othercode\n}\n</code></pre>\n\n<p>I get an error for the same in someAnotherMethod().</p>\n\n<pre><code>error C4100: 'arg1' : unreferenced formal parameter\n</code></pre>\n\n<p>Can anyone explain this thing and provide an alternative approach?</p>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1563360672, "post_id": 57074000, "comment_id": 100671708, "body": "You need to swap your assignments. <code>c=b;</code> =&gt; <code>b=c;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11796827"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1563364940, "post_id": 57074000, "comment_id": 100673913, "body": "Fine its working.Can you also tell me how to print only the nth number of the loop ;ex n= 5 output should only print 13??not whole loop 1 2  4 7 13"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1563366097, "post_id": 57074000, "comment_id": 100674561, "body": "You probably mean 11? If you don&#39;t want to print in the loop, move your print statement behind the loop."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1563370430, "post_id": 57074000, "comment_id": 100677470, "body": "Use <code>int main(void)</code>: C17::6.11.6: <i>&quot;Function declarators The use of function declarators with empty parentheses (not prototype-format parameter type declarators) is an obsolescent feature.&quot;</i>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11796827"}, "edited": false, "score": 0, "creation_date": 1563364740, "post_id": 57074163, "comment_id": 100673822, "body": "Can you also tell me how to print only the nth number of the loop ;ex n= 5 output should only print 13??not whole loop 1 2  4 7 13"}, {"owner": {"reputation": 2480, "user_id": 425280, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3d858b37026a879b80886249d3e8c4d3?s=128&d=identicon&r=PG", "display_name": "krammer", "link": "https://stackoverflow.com/users/425280/krammer"}, "edited": false, "score": 0, "creation_date": 1563367962, "post_id": 57074163, "comment_id": 100675753, "body": "print when i = n"}], "tags": [], "owner": {"reputation": 2480, "user_id": 425280, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3d858b37026a879b80886249d3e8c4d3?s=128&d=identicon&r=PG", "display_name": "krammer", "link": "https://stackoverflow.com/users/425280/krammer"}, "is_accepted": false, "score": 0, "last_activity_date": 1563360648, "creation_date": 1563360648, "answer_id": 57074163, "question_id": 57074000, "link": "https://stackoverflow.com/questions/57074000/how-to-print-a-series-upto-n-terms-with-each-term-sum-of-previous-three-terms/57074163#57074163", "title": "How to print a series upto n terms, with each term = sum of previous three terms and first term=1 then 2 3 6 11", "body": "<p>You have assigned the values incorrectly. You are also assigning s = c, which is incorrect as it is not being used in future. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n    int main() {\n    int a=0,b=1,c=0,i,n,s;  //To print  s=1(first term)\n    scanf(\"%d\",&amp;n);\n    for(i=1;i&lt;=n;i++){\n    s=a+b+c;\n    printf(\"%d \",s);//for first time it will print 1.\n\n    // The values you were swapping was in reverse order.\n    a = b;\n    b = c; \n    c = s; \n    }    \n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 0, "last_activity_date": 1563360727, "creation_date": 1563360727, "answer_id": 57074194, "question_id": 57074000, "link": "https://stackoverflow.com/questions/57074000/how-to-print-a-series-upto-n-terms-with-each-term-sum-of-previous-three-terms/57074194#57074194", "title": "How to print a series upto n terms, with each term = sum of previous three terms and first term=1 then 2 3 6 11", "body": "<p>You have the assignment statements reversed. <code>s=c;</code> puts the value of <code>c</code> is <code>s</code>, but you want the value of <code>s</code> in <code>c</code>.</p>\n\n<p>You can fix that by reversing each assignment, but then you will be changing <code>c</code> before it is stored in <code>b</code> and changing <code>b</code> before it is stored in <code>a</code>. To fix that, reverse the order of the assignments, so <code>a</code> is assigned first:</p>\n\n<pre><code>a = b;\nb = c;\nc = s;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 7790591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e98c9fc4c2a2928d9a7c95a774c8a65?s=128&d=identicon&r=PG&f=1", "display_name": "GMoney", "link": "https://stackoverflow.com/users/7790591/gmoney"}, "is_accepted": false, "score": 0, "last_activity_date": 1563360808, "creation_date": 1563360808, "answer_id": 57074215, "question_id": 57074000, "link": "https://stackoverflow.com/questions/57074000/how-to-print-a-series-upto-n-terms-with-each-term-sum-of-previous-three-terms/57074215#57074215", "title": "How to print a series upto n terms, with each term = sum of previous three terms and first term=1 then 2 3 6 11", "body": "<p>You have your assignments the wrong way around:</p>\n\n<pre><code>s=c;//for second term value of s=1 will be pasted in c. \nc=b; //for second term value of c=0 will be pasted in b.\nb=a; //for second term value of b=1 will be pasted in a.\n</code></pre>\n\n<p>This should be</p>\n\n<pre><code>a = b; //for second term value of b=1 will be pasted in a.\nb = c; //for second term value of c=0 will be pasted in b.\nc = s;//for second term value of s=1 will be pasted in c.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": -1, "last_activity_date": 1563365204, "last_edit_date": 1563365204, "creation_date": 1563360920, "answer_id": 57074246, "question_id": 57074000, "link": "https://stackoverflow.com/questions/57074000/how-to-print-a-series-upto-n-terms-with-each-term-sum-of-previous-three-terms/57074246#57074246", "title": "How to print a series upto n terms, with each term = sum of previous three terms and first term=1 then 2 3 6 11", "body": "<ol>\n<li>The initial values should be <code>0,0,1</code> for <code>a,b,c</code> respectively</li>\n<li>In this case you will get an array of <code>1 2 4 7 13</code></li>\n<li>You have assigned the values for <code>a,b,c</code> in the reverse order.</li>\n</ol>\n\n<p>The modified code is below.</p>\n\n<pre><code>int main() \n{\n    int a=0,b=0,c=1,i,n,s;  //To print  s=1(first term)\n    scanf(\"%d\",&amp;n);\n    for(i=1;i&lt;=n;i++)\n    {\n        s=a+b+c;\n        printf(\"%d \",s);//for first time it will print 1.\n        a=b;\n        b=c;\n        c=s;\n    } \n\n    return 0;\n}\n</code></pre>\n\n<p>Output for n = 5 is</p>\n\n<blockquote>\n  <p>1 2 4 7 13</p>\n</blockquote>\n\n<p><strong>Edit</strong></p>\n\n<p>To print the value of nth term, you need to move the <code>printf</code> to the end of the loop.</p>\n\n<p>If <code>n</code> is very large, you can consider not having a loop itself, deriving the formula for the nth term and using that directly.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11796827"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1563365204, "creation_date": 1563360087, "last_edit_date": 1563360636, "question_id": 57074000, "link": "https://stackoverflow.com/questions/57074000/how-to-print-a-series-upto-n-terms-with-each-term-sum-of-previous-three-terms", "title": "How to print a series upto n terms, with each term = sum of previous three terms and first term=1 then 2 3 6 11", "body": "<p>I am not understanding why my code isn't showing right output. For example: input of <code>n=5</code> should give output <code>1 2 3 6 11</code> but it gives output <code>1 1 0 0 0</code>. Can you please suggest some improvement in my  code?</p>\n\n<p>My code  works on the principle similar to  Fibonacci series. Instead of adding 2 previous terms it adds previous 3 terms.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int a=0,b=1,c=0,i,n,s;  //To print  s=1(first term)\n    scanf(\"%d\",&amp;n);\n    for(i=1;i&lt;=n;i++){\n      s=a+b+c;\n      printf(\"%d \",s);//for first time it will print 1.\n\n      s=c;//for second term value of s=1 will be pasted in c. \n      c=b; //for second term value of c=0 will be pasted in b.\n      b=a; //for second term value of b=1 will be pasted in a.\n    }    //loop will go back to first step and print s=1+0+1=2(second term)\n     and so on ,3,6,11....\n\n    return 0;\n}\n</code></pre>\n\n<p>I expect the output for <code>n=5</code> to be </p>\n\n<blockquote>\n  <p>1,2,3,6,11 </p>\n</blockquote>\n\n<p>but actual output is </p>\n\n<blockquote>\n  <p>1 1 0 0 0</p>\n</blockquote>\n"}, {"tags": ["c", "mmap"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1563364478, "post_id": 57073719, "comment_id": 100673677, "body": "What is the problem? What is the question?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1563364874, "post_id": 57073719, "comment_id": 100673877, "body": "how can you have only 730 page faults if you mmap <i>and</i> modify 1024 pages?"}, {"owner": {"reputation": 13, "user_id": 8224899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7yTNBrPJ28I/AAAAAAAAAAI/AAAAAAAAASw/QzfhZyeZ828/photo.jpg?sz=128", "display_name": "Gladwin Mohlamonyane", "link": "https://stackoverflow.com/users/8224899/gladwin-mohlamonyane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1563365351, "post_id": 57073719, "comment_id": 100674136, "body": "Sorry about that. It was 730 with my previous code. I was actually doing more with the page to make my own malloc. In the code I put up there now I didn&#39;t update that paragraph."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1563365853, "post_id": 57073719, "comment_id": 100674401, "body": "So, we&#39;ve got a piece of code that does not highlight the actual problem which is with some <i>other</i> code?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1563365921, "post_id": 57073719, "comment_id": 100674440, "body": "You get  ~same value without and with unmap? Also you get 0 <i>most of the time from munmap</i> - what does this mean? You ought to get 0 from munmap <b>every single time</b> unless you&#39;re not randomly shooting at memory addresses munmapping here and there..."}, {"owner": {"reputation": 13, "user_id": 8224899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7yTNBrPJ28I/AAAAAAAAAAI/AAAAAAAAASw/QzfhZyeZ828/photo.jpg?sz=128", "display_name": "Gladwin Mohlamonyane", "link": "https://stackoverflow.com/users/8224899/gladwin-mohlamonyane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1563365937, "post_id": 57073719, "comment_id": 100674450, "body": "Yeah, I made a mistake. The problem is in that code though. I called mmap 1024 times and munmap for each one. I wanted to know why I see so many page reclaims even when I use munmap."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1563366028, "post_id": 57073719, "comment_id": 100674524, "body": "Ah. OK, that is easy to answer."}, {"owner": {"reputation": 13, "user_id": 8224899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7yTNBrPJ28I/AAAAAAAAAAI/AAAAAAAAASw/QzfhZyeZ828/photo.jpg?sz=128", "display_name": "Gladwin Mohlamonyane", "link": "https://stackoverflow.com/users/8224899/gladwin-mohlamonyane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1563366055, "post_id": 57073719, "comment_id": 100674537, "body": "Yes. The value is the same."}, {"owner": {"reputation": 13, "user_id": 8224899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7yTNBrPJ28I/AAAAAAAAAAI/AAAAAAAAASw/QzfhZyeZ828/photo.jpg?sz=128", "display_name": "Gladwin Mohlamonyane", "link": "https://stackoverflow.com/users/8224899/gladwin-mohlamonyane"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1563366387, "post_id": 57073719, "comment_id": 100674768, "body": "I get 0 on all munmap requests. I counted the number of lines printed by my program and it was 1024 lines. Shouldn&#39;t calling munmap reduce the amount of times the kernel has to reclaim those pages since they&#39;ve already been given back to the system?"}, {"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1563369146, "post_id": 57073719, "comment_id": 100676595, "body": "Try compiling the same code, preceding it with <code>dtruss</code> (will need root privileges). Like <code>dtruss gcc your_file.c</code> You may get some useful information which helps you to debug."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8224899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7yTNBrPJ28I/AAAAAAAAAAI/AAAAAAAAASw/QzfhZyeZ828/photo.jpg?sz=128", "display_name": "Gladwin Mohlamonyane", "link": "https://stackoverflow.com/users/8224899/gladwin-mohlamonyane"}, "edited": false, "score": 0, "creation_date": 1563377808, "post_id": 57076738, "comment_id": 100682131, "body": "Thank you for this. Would this trait carry over to freebsd systems such as Mac? Additionally, if I bzero this region myself again then would that result in the kernel having fewer page reclaims?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 13, "user_id": 8224899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7yTNBrPJ28I/AAAAAAAAAAI/AAAAAAAAASw/QzfhZyeZ828/photo.jpg?sz=128", "display_name": "Gladwin Mohlamonyane", "link": "https://stackoverflow.com/users/8224899/gladwin-mohlamonyane"}, "edited": false, "score": 0, "creation_date": 1563380632, "post_id": 57076738, "comment_id": 100683793, "body": "@GladwinMohlamonyane mostly... It comes from the POSIX semantics and from what the hardware is capable of. Of course other OSes can add a flag similar to <code>MAP_UNINITIALIZED</code>. It seems that OSX does not have any such flag."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 0, "last_activity_date": 1563380378, "last_edit_date": 1563380378, "creation_date": 1563369201, "answer_id": 57076738, "question_id": 57073719, "link": "https://stackoverflow.com/questions/57073719/higher-page-reclaims-when-using-munmap/57076738#57076738", "title": "higher page reclaims when using munmap", "body": "<p>The important thing to remember about <code>mmap</code> is that the <code>MAP_ANONYMOUS</code> memory must be zeroed. So what happens usually is that a kernel will map a page frame with only zeroes in there - and only when a write hits the page, a read-write mapped zero page is mapped in place. </p>\n\n<p>However, this is the reason why the kernel cannot reuse the originally mapped page right away - it does not know that only the first byte of the page is dirty - instead, it must zero all 4 kiB bytes on that page before it can be given back to the process in a new anonymous mapping. Hence in both examples there are at least 1024 page faults occurring.</p>\n\n<p>If the memory would not need to be zeroed, Linux for example has an extra flag called <code>MAP_UNINITIALIZED</code> that tells kernel that the pages need not be zeroed, but it is only available in embedded devices:</p>\n\n<blockquote>\n  <p><strong><code>MAP_UNINITIALIZED</code> (since Linux 2.6.33)</strong></p>\n  \n  <p>Don't clear anonymous pages.  This flag is intended  to  improve\n                performance  on  embedded devices.  This flag is honored only if\n                the kernel was configured with the<br>\n      <code>CONFIG_MMAP_ALLOW_UNINITIALIZED</code>\n    option.  Because of the security implications, that option\n                is normally enabled only  on  embedded  devices  (i.e.,  devices\n                where one has complete control of the contents of user memory).</p>\n</blockquote>\n\n<p>I guess the reason for its non-availability in generic Linux kernels is because the kernel does not keep track of the process that previously had mapped the page frame, hence the page could leak information from a sensitive process.</p>\n\n<hr>\n\n<p><code>bzero</code>ing the page yourself would not affect performance - the kernel would not know that it was zeroed because there is no architecture that would support it in hardware - and then it is cheaper to <strong>write</strong> zeroes over the page than to <strong>check</strong> if the page is full of all zeroes <strong>and</strong> then in 99.9999999 % cases to write zeroes over it anyway.</p>\n"}], "owner": {"reputation": 13, "user_id": 8224899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7yTNBrPJ28I/AAAAAAAAAAI/AAAAAAAAASw/QzfhZyeZ828/photo.jpg?sz=128", "display_name": "Gladwin Mohlamonyane", "link": "https://stackoverflow.com/users/8224899/gladwin-mohlamonyane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 57076738, "answer_count": 1, "score": 0, "last_activity_date": 1563380378, "creation_date": 1563359094, "last_edit_date": 1563365865, "question_id": 57073719, "link": "https://stackoverflow.com/questions/57073719/higher-page-reclaims-when-using-munmap", "title": "higher page reclaims when using munmap", "body": "<p>On Mac my use of munmap results in seeing higher page reclaims.</p>\n\n<p>The return value of my munmap is 0, which indicates that the requested pages where successfully unmapped.</p>\n\n<p>Why do I see higher page reclaims when I test programs using memory I have mapped and unmapped in this way?</p>\n\n<p>Is there a way to debug munmap and see if my calls to that function aren't doing anything to the mapped memory that is passed to it.</p>\n\n<p>I used \"/usr/bin/time -l\" to see the amount of page reclaims I get from running my program. Whenever I use munmap my page reclaims get higher then when I don't.</p>\n\n<pre><code>int           main(void)          \n{                                                           \n        int i = 0; char *addr;\n        while (i &lt; 1024)\n        {\n            addr = mmap(0, getpagesize(), PROT_READ | PROT_WRITE, MAP_ANONYMOUS | MAP_PRIVATE, -1, 0);\n            addr[0] = 23;\n            if (!munmap(addr, getpagesize()))\n                print(\"Success\\n\");\n            i++;\n        }\n\n\n        return (NULL);                                      \n}\n</code></pre>\n\n<p>on allocation</p>\n\n<p>when I call munmap:</p>\n\n<ul>\n<li>I pass it the same pointer it gave me.</li>\n<li>I check the return value and check if it is 0 &lt;-- this is what I get most of the time.</li>\n</ul>\n\n<p>I made a test program where I call mmap 1024 times and munmap that number of times too.</p>\n\n<p>When I don't call munmap the reclaimed pages are within the region of 1478 and the value is the same when I call munmap.</p>\n\n<p>How can I check if my use of that memory is correct?</p>\n"}, {"tags": ["c", "linux", "usb", "libusb", "libusb-1.0"], "answers": [{"tags": [], "owner": {"reputation": 1488, "user_id": 7589255, "user_type": "registered", "profile_image": "https://graph.facebook.com/976575932385292/picture?type=large", "display_name": "Boris Lipschitz", "link": "https://stackoverflow.com/users/7589255/boris-lipschitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1564348927, "creation_date": 1564348927, "answer_id": 57245063, "question_id": 57073590, "link": "https://stackoverflow.com/questions/57073590/libusb-device-descriptor-bcdusb-possible-values/57245063#57245063", "title": "libusb device descriptor: bcdUSB possible values", "body": "<p>I am unaware about any documentation with all possible values of bcdUSB being described, yet have to mention one thing. Nothing prevents a USB device from sending an invalid device descriptor content. Although, i didn't exactly test it on anything, it seems quite likely to me an OS is going to ignore a wrong bcdUSB, with the device continuing to operate as expected.</p>\n\n<p>Make sure to have some sane defaults, just in case of encountering an invalid value there. </p>\n\n<p>Just to demonstrate, this is how a device descriptor is defined on a device side. Pretty much \"hardcoded\". And yea, this is an actual code, from an actual lib, running on an actual device.</p>\n\n<pre><code>/*-----------------------------------------------------------------------------+\n| Device Descriptor \n|-----------------------------------------------------------------------------*/\nuint8_t const abromDeviceDescriptor[SIZEOF_DEVICE_DESCRIPTOR] = {\n    SIZEOF_DEVICE_DESCRIPTOR,               // Length of this descriptor\n    DESC_TYPE_DEVICE,                       // Type code of this descriptor\n    0x00, 0x02,                             // Release of USB spec\n    0x02,                                   // Device's base class code\n    0x00,                                   // Device's sub class code\n    0x00,                                   // Device's protocol type code\n    EP0_PACKET_SIZE,                        // End point 0's packet size\n    USB_VID&amp;0xFF, USB_VID&gt;&gt;8,               // Vendor ID for device, TI=0x0451\n                                            // You can order your own VID at www.usb.org\"\n    USB_PID&amp;0xFF, USB_PID&gt;&gt;8,               // Product ID for device,\n                                            // this ID is to only with this example\n    VER_FW_L, VER_FW_H,                     // Revision level of device\n    1,                                      // Index of manufacturer name string desc\n    2,                                      // Index of product name string desc\n    USB_STR_INDEX_SERNUM,                   // Index of serial number string desc\n    1                                       //  Number of configurations supported\n};\n</code></pre>\n"}], "owner": {"reputation": 1108, "user_id": 1934741, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/b9fcef56e9894bc4ef3c2ee71921ef6a?s=128&d=identicon&r=PG", "display_name": "Kallel Omar", "link": "https://stackoverflow.com/users/1934741/kallel-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564348927, "creation_date": 1563358666, "last_edit_date": 1563359878, "question_id": 57073590, "link": "https://stackoverflow.com/questions/57073590/libusb-device-descriptor-bcdusb-possible-values", "title": "libusb device descriptor: bcdUSB possible values", "body": "<p>I'm developing a C app using libusb-1.0. I want to get some config parameters related to usb devices. My question is related to bcdUSB parameter. My code is like following:</p>\n\n<pre><code>libusb_device *dev;\nstruct libusb_device_descriptor desc;\n\n....\n\nret = libusb_get_device_descriptor(dev, &amp;desc);\n\nif (ret&lt;0) {\n    fprintf(stderr, \"error in getting device descriptor\\n\");\n    return 1;\n}\n\nprintf(\"bcdUSB: %04x\\n\", desc.bcdUSB);\n</code></pre>\n\n<p>For some devices I get 0401 value: </p>\n\n<pre><code>bcdUSB: 0401\n</code></pre>\n\n<p>I don't understand what's exactly the meaning of this value.</p>\n\n<p>In libusb code I found this comment in libusb_device_descriptor structure code: </p>\n\n<pre><code>/** USB specification release number in binary-coded decimal. A value of\n * 0x0200 indicates USB 2.0, 0x0110 indicates USB 1.1, etc. */\nuint16_t bcdUSB;\n</code></pre>\n\n<p>It specifies just 0200 and 0110 values meaning. Is there a documentation of all possible values of bcdUSB including 0401 ?</p>\n"}, {"tags": ["c++", "c", "gcc", "warnings", "padding"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1563359794, "post_id": 57073501, "comment_id": 100671264, "body": "<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html</a>"}, {"owner": {"reputation": 119, "user_id": 6231882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xXkB8.jpg?s=128&g=1", "display_name": "OpalApps", "link": "https://stackoverflow.com/users/6231882/opalapps"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1563361208, "post_id": 57073501, "comment_id": 100671997, "body": "@LightnessRacesinOrbit Thanks for the suggestion. Although it could have potentially worked, in my case I have &quot;-Wall&quot; on (not my decision), will add this to the question. The problem with -Wall is that with &quot;#pragma GCC diagnostics push&quot; I get &quot;-Wunknown-pragmas&quot;.Will have to work this around somehow. But thanks to your suggestion I have found others struggling with very similar issue: <a href=\"https://stackoverflow.com/questions/12842306/suppress-wunknown-pragmas-warning-in-gcc\" title=\"suppress wunknown pragmas warning in gcc\">stackoverflow.com/questions/12842306/&hellip;</a>."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1563362408, "post_id": 57073501, "comment_id": 100672620, "body": "You wrote <code>diagnostics</code> instead of <code>diagnostic</code>, so indeed that&#39;s an unknown pragma."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1563362795, "post_id": 57073501, "comment_id": 100672829, "body": "By the way, <code>-Wall</code> is good but add <code>-Wextra -pedantic</code> too for extra goodness"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 6231882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xXkB8.jpg?s=128&g=1", "display_name": "OpalApps", "link": "https://stackoverflow.com/users/6231882/opalapps"}, "edited": false, "score": 0, "creation_date": 1563369989, "post_id": 57074703, "comment_id": 100677208, "body": "Hm, it does actually work when you write it correctly. Thanks! :)"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "reply_to_user": {"reputation": 119, "user_id": 6231882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xXkB8.jpg?s=128&g=1", "display_name": "OpalApps", "link": "https://stackoverflow.com/users/6231882/opalapps"}, "edited": false, "score": 0, "creation_date": 1563370003, "post_id": 57074703, "comment_id": 100677216, "body": "@OpalApps Magic :P"}], "tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": true, "score": 3, "last_activity_date": 1563362846, "last_edit_date": 1563362846, "creation_date": 1563362541, "answer_id": 57074703, "question_id": 57073501, "link": "https://stackoverflow.com/questions/57073501/exception-exclusion-for-wpadded-warning/57074703#57074703", "title": "Exception/exclusion for -Wpadded warning", "body": "<p>Yes, <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html\" rel=\"nofollow noreferrer\">GCC has pragmas for this</a>:</p>\n\n<pre><code>#pragma GCC diagnostic push\n#pragma GCC diagnostic ignored \"-Wpadded\"\n\n// Doesn't warn\nstruct Foo { bool x; int y; };\n\n#pragma GCC diagnostic pop\n\n\n// Warns\nstruct Bar { bool x; int y; };\n</code></pre>\n\n<h3>(<a href=\"https://coliru.stacked-crooked.com/a/f25dfcefca5f90e3\" rel=\"nofollow noreferrer\">live demo</a>)</h3>\n\n<p>Nothing about <code>-Wall</code> makes this complicated or in any way a problem; you just have to spell the pragma correctly. \ud83d\ude0a</p>\n"}], "owner": {"reputation": 119, "user_id": 6231882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xXkB8.jpg?s=128&g=1", "display_name": "OpalApps", "link": "https://stackoverflow.com/users/6231882/opalapps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 57074703, "answer_count": 1, "score": 1, "last_activity_date": 1563370139, "creation_date": 1563358328, "last_edit_date": 1563370139, "question_id": 57073501, "link": "https://stackoverflow.com/questions/57073501/exception-exclusion-for-wpadded-warning", "title": "Exception/exclusion for -Wpadded warning", "body": "<p>I have <i>-Wpadded</i> warning option on (gcc/g++) and getting these warnings for non-padded C/C++ structures as expected.</p>\n\n<p>Now, I want to exclude some of the structures from that warning without having to actually pad them.</p>\n\n<p>To make things even more complicated - I have \"-Wall\". This makes the approach with <code>#pragma GCC diagnostics ignored -Wpadded</code> not usable (shame, would have been very neat).</p>\n\n<p>Some sort of \"pragma\" directive in the code is what I would expect as a solution. Thanks in advance!</p>\n\n<p><strong>Please note that there was a misspelling in my original question text! Refer to the accepted answer for the confirmation that the method with #pragma actually works!</strong></p>\n"}, {"tags": ["c", "matlab", "mex"], "comments": [{"owner": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1563358521, "post_id": 57073423, "comment_id": 100670661, "body": "Downloading zip files from strangers on the internet: nonononononnono. Do make your question complete, dont make us risk our computers to help you. Add the mex function here. (I have removed the link to your zip file from the question)."}, {"owner": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 1, "creation_date": 1563358658, "post_id": 57073423, "comment_id": 100670723, "body": "In any case, its almost sure that the issue is that you do not have exactly: <code>void mexFunction( int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[] )</code> as main function on your c file."}, {"owner": {"reputation": 133, "user_id": 4944836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83c781d3e08a2d628a351395e35f37ef?s=128&d=identicon&r=PG&f=1", "display_name": "Luks", "link": "https://stackoverflow.com/users/4944836/luks"}, "reply_to_user": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1563368262, "post_id": 57073423, "comment_id": 100675984, "body": "@AnderBiguri point taken (even if it is a trustworthy source). I included the the mex fn of the main c file, albeit there are more files at play in the compilation of the final mex file. The <code>void mexFunction</code> looks good to me, but as you can see I am a novice mex user.. any hint on how to repair much appreciated!"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1563370288, "post_id": 57073423, "comment_id": 100677386, "body": "The <code>mexFunction</code> is conditionally compiled, if <code>KALCVF_MEX</code> is defined. You might want to add a <code>-DKALCVF_MEX</code> argument to your <code>mex</code> command."}, {"owner": {"reputation": 133, "user_id": 4944836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83c781d3e08a2d628a351395e35f37ef?s=128&d=identicon&r=PG&f=1", "display_name": "Luks", "link": "https://stackoverflow.com/users/4944836/luks"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1563371481, "post_id": 57073423, "comment_id": 100678185, "body": "@CrisLuengo so when I compile my mex <code>mexFunction</code> like that, Matlab crashes each time I am trying to use the <code>mexFunction</code> afterwards.."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1563371916, "post_id": 57073423, "comment_id": 100678488, "body": "That could have so many different reasons... debugging a MEX-file is not trivial. Were you told to compile with <code>-R2018a</code>? Remove that if not. Also, are you passing the expected input arguments? Some MEX-files are not written robustly and will crash because they make assumptions about the types of the input arguments."}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1563372017, "post_id": 57073423, "comment_id": 100678552, "body": "For example, this code doesn&#39;t check that the input arrays are of type <code>double</code>, it just makes that assumption. If you pass an array of any other type, you&#39;re likely going to crash MATLAB."}, {"owner": {"reputation": 133, "user_id": 4944836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83c781d3e08a2d628a351395e35f37ef?s=128&d=identicon&r=PG&f=1", "display_name": "Luks", "link": "https://stackoverflow.com/users/4944836/luks"}, "reply_to_user": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1563372704, "post_id": 57073423, "comment_id": 100679009, "body": "@CrisLuengo OK, I checked both potential sources and they do not seem to be the reason. In the end, debugging this file appears to be above my skill set - I may be better off recoding the C files in plain matlab. But many thanks everybody!!"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 2, "creation_date": 1563372900, "post_id": 57073423, "comment_id": 100679151, "body": "Debugging MEX-files is not trivial, even for people experienced in debugging C code, because it&#39;s running within MATLAB which makes using Valgrind and similar tools hard. But judicious use of <code>printf</code> statements usually gets me there in the end. If you don&#39;t know what the code does, debugging is terribly hard."}], "owner": {"reputation": 133, "user_id": 4944836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83c781d3e08a2d628a351395e35f37ef?s=128&d=identicon&r=PG&f=1", "display_name": "Luks", "link": "https://stackoverflow.com/users/4944836/luks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 549, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563371697, "creation_date": 1563358035, "last_edit_date": 1563371697, "question_id": 57073423, "link": "https://stackoverflow.com/questions/57073423/error-invalid-mex-file-mex-filename-gateway-function-is-missing", "title": "Error: Invalid MEX-file &#39;[MEX_FILENAME]&#39;: Gateway function is missing", "body": "<p>I successfully compiled a mex function in <strong>Matlab 2018a</strong> under <strong>Linux</strong>, from a set of files provided kindly provided by a user. When I try to use the function I get the error message <code>Error: Invalid MEX-file '[MEX_FILENAME]': Gateway function is missing</code>. Where does this error come from and how to deal with it??   </p>\n\n<p>I compiled by: </p>\n\n<pre class=\"lang-matlab prettyprint-override\"><code>mex -v -R2018a kalcvf/kalcvf.c kalcvf/dlyap.c kalcvf/matlib.c -lmwblas -lmwlapack\n</code></pre>\n\n<p>(I had to replace all <code>sprintf_s</code> by <code>snprintf</code>, as the former does not work with Linux)</p>\n\n<p><strong>Update: The main c file looks like this:</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"matlib.h\"\n\n/* all warning messages were supressed because in case of failure in dlyap\n   there exist default solution in the main algorithm */\n//#define _DLYAP_NOMSG_\n\n#ifdef KALCVF_MEX\n#undef KALCVF_MEX\nvoid mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[]) {\n\n    double *data, *a, *F, *b, *H, *var, *z0, *vz0, *logl, *pred, *vpred, *filt, *vfilt;\n    const mwSize *dims;\n    mwSize lead, T, Nz, Ny, rows, cols, ndims, inca=0, incF=0, incb=0, incH=0, incvar=0;\n\n    /*===== check number of input and output arguments =====*/\n\n    if ( (nrhs != 7) &amp;&amp; (nrhs != 9) )\n        mexErrMsgTxt(\"Seven or nine input arguments required.\");\n    if ( (nlhs &gt; 5) )\n        mexErrMsgTxt(\"More than five output arguments specified.\");\n\n    /*===== check number of forecasting steps =====*/\n    lead = (mwSize)mxGetScalar(prhs[1]);\n    if ( (mxGetM(prhs[1])*mxGetN(prhs[1]) != 1) || (lead &lt; 0) )\n        mexErrMsgTxt(\"lead must be positive integer scalar.\");\n\n    /*===== check input matrix dimensions =====*/\n\n    /* data must be Ny\ufffdT matrix */\n    Ny = mxGetM(prhs[0]);\n    T  = mxGetN(prhs[0]);\n\n    /* a must be Nz\ufffd1 or Nz\ufffd(T+lead) vector */\n    Nz = mxGetM(prhs[2]);\n    if ( (cols=mxGetN(prhs[2])) == 1 )\n        inca = 0;\n    else if ( cols == (T+lead) )\n        inca = Nz;\n    else {\n        snprintf(msg,101, \"data has Ny=%d rows and T=%d columns, lead is equal to %d, \"\n            \"a has Nz=%d rows, but the number of columns in a (%d) is neither one \"\n            \"nor T+lead=%d.\", Ny, T, lead, Nz, cols, T+lead);\n        mexErrMsgTxt(msg);\n    }\n\n    /* F must be Nz\ufffdNz or Nz\ufffdNz\ufffd(T+lead) matrix */\n    dims = mxGetDimensions(prhs[3]);\n    if ( (dims[0] != Nz) || (dims[1] != Nz) ) {\n        snprintf(msg,101, \"a and F must have the same number of rows. F must be square in the first two dimensions. \"\n            \"a has Nz=%d rows, but F has %d rows and %d columns.\", Nz, dims[0], dims[1]);\n        mexErrMsgTxt(msg);\n    }\n    ndims = mxGetNumberOfDimensions(prhs[3]);\n    if ( ndims == 2 )\n        incF = 0;\n    else if ( ndims == 3 ) {\n        if ( dims[2] == (T+lead) )\n            incF = Nz*Nz;\n        else {\n            snprintf(msg,101, \"F must have (T+lead)=%d elements in third dimension.\", T+lead);\n            mexErrMsgTxt(msg);\n        }\n    } else\n        mexErrMsgTxt(\"F must be two- or three-dimensional matrix.\");\n\n    /* b must be Ny\ufffd1 or Ny\ufffd(T+lead) vector */\n    if ( (rows=mxGetM(prhs[4])) != Ny ) {\n        snprintf(msg,101, \"data and b must have the same number of rows. \"\n            \"data has Ny=%d rows, but the number of rows in b is %d.\", Ny, rows);\n        mexErrMsgTxt(msg);\n    }\n    if ( (cols=mxGetN(prhs[4])) == 1 )\n        incb = 0;\n    else if ( cols == (T+lead) )\n        incb = Ny;\n    else {\n        snprintf(msg,101, \"data has Ny=%d rows and T=%d columns, lead is equal to %d, \"\n            \"b has Ny=%d rows, but the number of columns in b (%d) is neither one \"\n            \"nor T+lead=%d.\", Ny, T, lead, Ny, cols, T+lead);\n        mexErrMsgTxt(msg);\n    }\n\n    /* H must be Ny\ufffdNz or Ny\ufffdNz\ufffd(T+lead) matrix */\n    dims = mxGetDimensions(prhs[5]);\n    if ( dims[0] != Ny ) {\n        snprintf(msg,101, \"data and H must have the same number of rows. \"\n            \"data has Ny=%d rows, but the number of rows in H is %d.\", Ny, dims[0]);\n        mexErrMsgTxt(msg);\n    }\n    if ( dims[1] != Nz ) {\n        snprintf(msg,101, \"H must have the same number of columns as rows in matrix a. \"\n            \"a has Nz=%d rows, but the number of columns in H is %d.\", Nz, dims[1]);\n        mexErrMsgTxt(msg);\n    }\n    ndims = mxGetNumberOfDimensions(prhs[5]);\n    if ( ndims == 2 )\n        incH = 0;\n    else if ( ndims == 3 ) {\n        if ( dims[2] == (T+lead) )\n            incH = Ny*Nz;\n        else {\n            snprintf(msg,101, \"H must have (T+lead)=%d elements in third dimension.\", T+lead);\n            mexErrMsgTxt(msg);\n        }\n    } else\n        mexErrMsgTxt(\"H must be two- or three-dimensional matrix.\");\n\n    /* var must be (Ny+Nz)\ufffd(Ny+Nz) or (Ny+Nz)\ufffd(Ny+Nz)\ufffd(T+lead) matrix */\n    dims = mxGetDimensions(prhs[6]);\n    if ( (dims[0] != Ny+Nz) || (dims[1] != Ny+Nz) ) {\n        snprintf(msg,101, \"var must contain variance matrix for the errors in transition and measurement equations. \"\n            \"var must be square p.d.f. %d\ufffd%d or %d\ufffd%d\ufffd%d matrix, but your var has %d rows and %d columns.\",\n            Ny+Nz, Ny+Nz, Ny+Nz, Ny+Nz, T+lead, dims[0], dims[1]);\n        mexErrMsgTxt(msg);\n    }\n    ndims = mxGetNumberOfDimensions(prhs[6]);\n    if ( ndims == 2 )\n        incvar = 0;\n    else if ( ndims == 3 ) {\n        if ( dims[2] == (T+lead) )\n            incvar = (Ny+Nz)*(Ny+Nz);\n        else {\n            snprintf(msg,101, \"var must have (T+lead)=%d elements in third dimension.\", T+lead);\n            mexErrMsgTxt(msg);\n        }\n    } else\n        mexErrMsgTxt(\"var must be two- or three-dimensional matrix.\");\n\n    /* if specified, z0 must be Nz\ufffd1 vector and vz0 must be Nz\ufffdNz matrix */\n    if ( nrhs==9 ) {\n        rows = mxGetM(prhs[7]);\n        cols = mxGetN(prhs[7]);\n        if ( ( rows != Nz ) || ( cols != 1 ) ) {\n            snprintf(msg,101, \"a and z0 must have the same number of rows. z0 must be Nz\ufffd1 vector. \"\n                \"a has Nz=%d rows, but z0 has %d rows and %d columns.\", Nz, rows, cols);\n            mexErrMsgTxt(msg);\n        }\n        rows=mxGetM(prhs[8]);\n        cols=mxGetN(prhs[8]);\n        if ( ( rows != Nz ) || ( cols != Nz ) ) {\n            snprintf(msg,101, \"a and vz0 must have the same number of rows. vz0 must be square Nz\ufffdNz matrix. \"\n                \"a has Nz=%d rows, but vz0 has %d rows and %d columns.\", Nz, rows, cols);\n            mexErrMsgTxt(msg);\n        }\n    }\n\n    /*===== get pointers to input arguments =====*/\n\n    data = mxGetPr(prhs[0]);\n    a    = mxGetPr(prhs[2]);\n    F    = mxGetPr(prhs[3]);\n    b    = mxGetPr(prhs[4]);\n    H    = mxGetPr(prhs[5]);\n    var  = mxGetPr(prhs[6]);\n    if ( nrhs == 9 ) {\n        z0 = mxGetPr(prhs[7]);\n        vz0 = mxGetPr(prhs[8]);\n    } else {\n        z0  = NULL;\n        vz0 = NULL;\n    }\n\n    /*===== create output scalar value of the average log likelihood function =====*/\n\n    logl = mxGetPr(plhs[0] = mxCreateDoubleMatrix(1, 1, mxREAL));\n\n    /*===== get pointers to optional output arguments =====*/\n\n    if ( nlhs &lt; 5 ) vfilt = NULL;\n    else {\n        mwSize dim[3] = { Nz, Nz, T };\n        vfilt = mxGetPr(plhs[4]=mxCreateNumericArray(3, dim, mxDOUBLE_CLASS, mxREAL));\n    }\n    if ( nlhs &lt; 4 ) filt = NULL;\n    else filt  = mxGetPr(plhs[3]=mxCreateDoubleMatrix(Nz, T, mxREAL));\n    if ( nlhs &lt; 3 ) vpred = NULL;\n    else {\n        mwSize dim[3] = { Nz, Nz, T+lead };\n        vpred = mxGetPr(plhs[2]=mxCreateNumericArray(3, dim, mxDOUBLE_CLASS, mxREAL));\n    }\n    if ( nlhs &lt; 2 ) pred = NULL;\n    else pred  = mxGetPr(plhs[1]=mxCreateDoubleMatrix(Nz, T+lead, mxREAL));\n\n    /*===== compute Kalman Filter =====*/\n\n    *logl = kalcvf(data, (int)T, (int)lead, (int)Ny, (int)Nz, a, (int)inca, F, (int)incF, b, (int)incb, H, (int)incH,\n        var, (int)incvar, z0, vz0, pred, vpred, filt, vfilt);\n\n}\n#endif\n\n/* The Kalman filter */\n#define PI 3.141592653589793238\ndouble kalcvf(double *data, int T, int lead, int Ny, int Nz,\n              double *a_all, int inca, double *F_all, int incF,\n              double *b_all, int incb, double *H_all, int incH,\n              double *var_all, int incvar, double *z0, double *vz0,\n              double *pred, double *vpred, double *filt, double *vfilt) {\n\n    double *a, *F, *b, *H, *var, *V, *G, *R, *P;\n    double logl=0.0, prod;\n    int Nyz, NyzNyz, NyNz, NzNz, Nz1, incpred=0, incvpred=0, info=0, t, i;\n\n    Nyz = Ny+Nz;\n    NyzNyz = Nyz*Nyz;\n    NyNz = Ny*Nz;\n    NzNz = Nz*Nz;\n    Nz1 = Nz+1;\n\n    /* If specified, pointers pred and vpred will be incremented by incpred and incvpred\n       to save data from each iteration. If not specified, allocate memory for vector pred\n       and matrix vpred, and leave zero increments */\n    if (pred) incpred = Nz;\n    else pred = (double *)mxCalloc(Nz, sizeof(double));\n    if (vpred) incvpred = NzNz;\n    else vpred = (double *)mxCalloc(NzNz, sizeof(double));\n\n    /* initialize pred and vpred */\n    if (z0)\n        cblas_dcopy(Nz, z0, one, pred, one);\n    else {\n        cblas_dcopy(Nz, a_all, one, pred, one);\n        dlins(Nz, one, F_all, pred, &amp;info);\n    }\n    if (vz0)\n        cblas_dcopy(NzNz, vz0, one, vpred, one);\n    else {\n        dlyap(Nz, F_all, var_all, Nyz, vpred, &amp;info);\n        if ( info &gt; 0 ) {\n            double million=1e6;\n            cblas_dcopy(NzNz, &amp;zero_d, zero, vpred, one);\n            cblas_daxpy(Nz, one_d, &amp;million, zero, vpred, Nz1);\n        }\n    }\n\n    /* allocate memory for temporary variables */\n    a   = (double *) mxCalloc(Nz,     sizeof(double));\n    F   = (double *) mxCalloc(NzNz,   sizeof(double));\n    b   = (double *) mxCalloc(Ny,     sizeof(double));\n    H   = (double *) mxCalloc(NyNz,   sizeof(double));\n    var = (double *) mxCalloc(NyzNyz, sizeof(double));\n    P   = (double *) mxCalloc(NzNz,   sizeof(double));\n    /* var = [V G; G' R] */\n    V = var;          /* V(t) = Var(eta(t)) */\n    G = var+Nyz*Nz;   /* G(t) = Cov(eta(t),eps(t)) */\n    R = G+Nz;         /* R(t) = Var(eps(t)) */\n\n    for (t=0; t&lt;T; t++) {\n        /* H = H_all(:,:,t) */\n        cblas_dcopy(NyNz, &amp;H_all[t*incH], one, H, one);\n        /* b = b_all(:,t) */\n        cblas_dcopy(Ny, &amp;b_all[t*incb], one, b, one);\n        /* b = -H*pred-b */\n        cblas_dgemv(CblasColMajor, CblasNoTrans, Ny, Nz, mone_d, H, Ny, pred, one, mone_d, b, one);\n        /* b = data(:,t)+b */\n        cblas_daxpy(Ny, one_d, &amp;data[t*Ny], one, b, one);\n      /* P = vpred */\n        cblas_dcopy(NzNz, vpred, one, P, one);\n        /* P = chol(P)' */\n      dpotrf(chl, &amp;Nz, P, &amp;Nz, &amp;info);\n        /* H = H*P */\n        cblas_dtrmm(CblasColMajor, CblasRight, CblasLower, CblasNoTrans, CblasNonUnit, Ny, Nz, one_d, P, Nz, H, Ny);\n        /* var = var_all(:,:,t) */\n        cblas_dcopy(NyzNyz, &amp;var_all[t*incvar], one, var, one);\n        /* R = H*H'+R */\n        cblas_dsyrk(CblasColMajor, CblasLower, CblasNoTrans, Ny, Nz, one_d, H, Ny, one_d, R, Nyz);\n        /* R = chol(R)' */\n        dpotrf(chl, &amp;Ny, R, &amp;Nyz, &amp;info);\n        /* b = R\\b */\n        cblas_dtrsv(CblasColMajor, CblasLower, CblasNoTrans, CblasNonUnit, Ny, R, Nyz, b, one);\n        /* logl += 2*log(prod(diag(R)))+b'*b */\n        prod = R[0];\n        for (i=1; i&lt;Ny; i++)\n            prod *= R[i*(Nyz+1)];\n        logl += 2*log(prod)+cblas_ddot(Ny, b, one, b, one);\n        if (t&lt;T-1 || lead&gt;0) {\n            /* F = F_all(:,:,t) */\n            cblas_dcopy(NzNz, &amp;F_all[t*incF], one, F, one);\n            /* a = a_all(:,t) */\n            cblas_dcopy(Nz, &amp;a_all[t*inca], one, a, one);\n            /* a = F*pred+a */\n            cblas_dgemv(CblasColMajor, CblasNoTrans, Nz, Nz, one_d, F, Nz, pred, one, one_d, a, one);\n            /* F = F*P */\n            cblas_dtrmm(CblasColMajor, CblasRight, CblasLower, CblasNoTrans, CblasNonUnit, Nz, Nz, one_d, P, Nz, F, Nz);\n            /* G = F*H'+G */\n            cblas_dgemm(CblasColMajor, CblasNoTrans, CblasTrans, Nz, Ny, Nz, one_d, F, Nz, H, Ny, one_d, G, Nyz);\n            /* G = G/R' */\n            cblas_dtrsm(CblasColMajor, CblasRight, CblasLower, CblasTrans, CblasNonUnit, Nz, Ny, one_d, R, Nyz, G, Nyz);\n            /* a = G*b+a */\n            cblas_dgemv(CblasColMajor, CblasNoTrans, Nz, Ny, one_d, G, Nyz, b, one, one_d, a, one);\n            /* V = F*F'+V */\n            cblas_dsyrk(CblasColMajor, CblasLower, CblasNoTrans, Nz, Nz, one_d, F, Nz, one_d, V, Nyz);\n            /* V = -G*G'+V */\n            cblas_dsyrk(CblasColMajor, CblasLower, CblasNoTrans, Nz, Ny, mone_d, G, Nyz, one_d, V, Nyz);\n        }\n        if (filt || vfilt) {\n            /* H = H*P' */\n            cblas_dtrmm(CblasColMajor, CblasRight, CblasLower, CblasTrans, CblasNonUnit, Ny, Nz, one_d, P, Nz, H, Ny);\n            /* H = R\\H */\n            cblas_dtrsm(CblasColMajor, CblasLeft, CblasLower, CblasNoTrans, CblasNonUnit, Ny, Nz, one_d, R, Nyz, H, Ny);\n            if (filt) {\n                /* filt = pred */\n                cblas_dcopy(Nz, pred, one, filt, one);\n                /* filt = H'*b+filt */\n                cblas_dgemv(CblasColMajor, CblasTrans, Ny, Nz, one_d, H, Ny, b, one, one_d, filt, one);\n                /* increment filt */\n                filt += Nz;\n            }\n            if (vfilt) {\n                /* vfilt = vpread */\n                cblas_dcopy(NzNz, vpred, one, vfilt, one);\n                /* vfilt = -H'*H+vfilt */\n                cblas_dsyrk(CblasColMajor, CblasLower, CblasTrans, Nz, Ny, mone_d, H, Ny, one_d, vfilt, Nz);\n                /* vfilt = tril(vfilt)+tril(vfilt,-1)' */\n                dtril(Nz, vfilt, Nz);\n                /* increment vfilt */\n                vfilt += NzNz;\n            }\n        }\n        if (t&lt;T-1 || lead&gt;0) {\n            /* pred(:,t+1) = a */\n            if (incpred) pred += incpred;\n            cblas_dcopy(Nz, a, one, pred, one);\n            /* vpred(:,:,t+1) = tril(V)+tril(V,-1)' */\n            if (incvpred) vpred += incvpred;\n            for (i=0; i&lt;Nz; i++)\n                cblas_dcopy(Nz, &amp;V[i], Nyz, &amp;vpred[i], Nz);\n            dtril(Nz, vpred, Nz);\n        }\n    }\n    if (lead&gt;1 &amp;&amp; (incpred || incvpred)) {\n        for (t=T+1; t&lt;T+lead; t++) {\n            /* F = F_all(:,:,t) */\n            cblas_dcopy(NzNz, &amp;F_all[t*incF], one, F, one);\n            /* a = a_all(:,t) */\n            cblas_dcopy(Nz, &amp;a_all[t*inca], one, a, one);\n            /* a = F*pred+a */\n            cblas_dgemv(CblasColMajor, CblasNoTrans, Nz, Nz, one_d, F, Nz, pred, one, one_d, a, one);\n            /* pred(:,t) = a */\n            if (incpred) pred += incpred;\n            cblas_dcopy(Nz, a, one, pred, one);\n            /* P = vpred */\n            cblas_dcopy(NzNz, vpred, one, P, one);\n            /* P = chol(P)' */\n            dpotrf(chl, &amp;Nz, P, &amp;Nz, &amp;info);\n            /* F = F*P */\n            cblas_dtrmm(CblasColMajor, CblasRight, CblasLower, CblasNoTrans, CblasNonUnit, Nz, Nz, one_d, P, Nz, F, Nz);\n            /* var = var_all(:,:,t) */\n            cblas_dcopy(NyzNyz, &amp;var_all[t*incvar], one, var, one);\n            /* vpred = V */\n            if (incvpred) vpred += incvpred;\n            for (i=0; i&lt;Nz; i++)\n                cblas_dcopy(Nz, &amp;V[i], Nyz, &amp;vpred[i], Nz);\n            /* vpred = F*F'+vpred */\n            cblas_dsyrk(CblasColMajor, CblasLower, CblasNoTrans, Nz, Nz, one_d, F, Nz, one_d, vpred, Nz);\n            dtril(Nz, vpred, Nz);\n        }\n    }\n\n    logl = -(Ny*log(2*PI)+logl/T)/2;\n\n    if (!incpred) mxFree(pred);\n    if (!incvpred) mxFree(vpred);\n    mxFree(a);\n    mxFree(F);\n    mxFree(b);\n    mxFree(H);\n    mxFree(var);\n    mxFree(P);\n    return (logl);\n}\n#undef PI\n</code></pre>\n\n<p>For completeness, te output of the mex compilation is:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>    &gt;&gt; mex -v -R2018a kalcvf/kalcvf.c kalcvf/dlyap.c kalcvf/matlib.c -lmwblas -lmwlapack\nVerbose mode is on.\n... Looking for compiler 'gcc' ...\n... Executing command 'which gcc' ...Yes ('/usr/bin/gcc').\n... Executing command 'gcc -print-file-name=libstdc++.so' ...Yes ('/usr/lib/gcc/x86_64-linux-gnu/7/libstdc++.so').\nFound installed compiler 'gcc'.\nOptions file details\n-------------------------------------------------------------------\n    Compiler location: /usr/bin/gcc\n    Options file: /home/lukas/.matlab/R2018a/mex_C_glnxa64.xml\n    CMDLINE2 : /usr/bin/gcc -pthread -Wl,--no-undefined -Wl,-rpath-link,/usr/local/MATLAB/R2018a/bin/glnxa64 -shared  -O -Wl,--version-script,\"/usr/local/MATLAB/R2018a/extern/lib/glnxa64/c_exportsmexfileversion.map\" /tmp/mex_8846989578426_15298/kalcvf.o /tmp/mex_8846989578426_15298/dlyap.o /tmp/mex_8846989578426_15298/matlib.o /tmp/mex_8846989578426_15298/c_mexapi_version.o   -lmwblas  -lmwlapack   -L\"/usr/local/MATLAB/R2018a/bin/glnxa64\" -lmx -lmex -lmat -lm -lstdc++ -o kalcvf.mexa64\n    CC : /usr/bin/gcc\n    DEFINES : -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE \n    MATLABMEX : -DMATLAB_MEX_FILE \n    CFLAGS : -fexceptions -fPIC -fno-omit-frame-pointer -pthread\n    INCLUDE : -I\"/usr/local/MATLAB/R2018a/extern/include\" -I\"/usr/local/MATLAB/R2018a/simulink/include\"\n    COPTIMFLAGS : -O -DNDEBUG\n    CDEBUGFLAGS : -g\n    LD : /usr/bin/gcc\n    LDFLAGS : -pthread -Wl,--no-undefined -Wl,-rpath-link,/usr/local/MATLAB/R2018a/bin/glnxa64\n    LDTYPE : -shared \n    FUNCTIONMAP : \"/usr/local/MATLAB/R2018a/extern/lib/glnxa64/mexFunction.map\"\n    VERSIONMAP : \"/usr/local/MATLAB/R2018a/extern/lib/glnxa64/c_exportsmexfileversion.map\"\n    LINKEXPORT : -Wl,--version-script,\"/usr/local/MATLAB/R2018a/extern/lib/glnxa64/mexFunction.map\"\n    LINKEXPORTVER : -Wl,--version-script,\"/usr/local/MATLAB/R2018a/extern/lib/glnxa64/c_exportsmexfileversion.map\"\n    LINKLIBS : -lmwblas  -lmwlapack   -L\"/usr/local/MATLAB/R2018a/bin/glnxa64\" -lmx -lmex -lmat -lm -lstdc++\n    LDOPTIMFLAGS : -O\n    LDDEBUGFLAGS : -g\n    MWCPPLIB : \"/usr/local/MATLAB/R2018a/sys/os/glnxa64/libstdc++.so.6\"\n    OBJEXT : .o\n    LDEXT : .mexa64\n    SETENV : CC=\"/usr/bin/gcc\"\n                CXX=\"g++\"\n                CFLAGS=\"-fexceptions -fPIC -fno-omit-frame-pointer -pthread -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE \"\n                CXXFLAGS=\"-fexceptions -fPIC -fno-omit-frame-pointer -pthread -std=c++11 -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE \"\n                COPTIMFLAGS=\"-O -DNDEBUG\"\n                CXXOPTIMFLAGS=\"-O -DNDEBUG\"\n                CDEBUGFLAGS=\"-g\"\n                CXXDEBUGFLAGS=\"-g\"\n                LD=\"/usr/bin/gcc\"\n                LDXX=\"g++\"\n                LDFLAGS=\"-pthread -Wl,--no-undefined -Wl,-rpath-link,/usr/local/MATLAB/R2018a/bin/glnxa64 -shared  -lmwblas  -lmwlapack   -L\"/usr/local/MATLAB/R2018a/bin/glnxa64\" -lmx -lmex -lmat -lm -lstdc++ -Wl,--version-script,\"/usr/local/MATLAB/R2018a/extern/lib/glnxa64/mexFunction.map\"\"\n                LDDEBUGFLAGS=\"-g\"\n    GCC : /usr/bin/gcc\n    CPPLIBS : /usr/lib/gcc/x86_64-linux-gnu/7/libstdc++.so\n    MATLABROOT : /usr/local/MATLAB/R2018a\n    ARCH : glnxa64\n    SRC : \"/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/kalcvf.c\";\"/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c\";\"/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/matlib.c\";\"/usr/local/MATLAB/R2018a/extern/version/c_mexapi_version.c\"\n    OBJ : /tmp/mex_8846989578426_15298/kalcvf.o;/tmp/mex_8846989578426_15298/dlyap.o;/tmp/mex_8846989578426_15298/matlib.o;/tmp/mex_8846989578426_15298/c_mexapi_version.o\n    OBJS : /tmp/mex_8846989578426_15298/kalcvf.o /tmp/mex_8846989578426_15298/dlyap.o /tmp/mex_8846989578426_15298/matlib.o /tmp/mex_8846989578426_15298/c_mexapi_version.o \n    SRCROOT : /home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/kalcvf\n    DEF : /tmp/mex_8846989578426_15298/kalcvf.def\n    EXP : \"kalcvf.exp\"\n    LIB : \"kalcvf.lib\"\n    EXE : kalcvf.mexa64\n    ILK : \"kalcvf.ilk\"\n    MANIFEST : \"kalcvf.mexa64.manifest\"\n    TEMPNAME : kalcvf\n    EXEDIR : \n    EXENAME : kalcvf\n    OPTIM : -O -DNDEBUG\n    LINKOPTIM : -O\n    CMDLINE1_0 : /usr/bin/gcc -c -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE  -I\"/usr/local/MATLAB/R2018a/extern/include\" -I\"/usr/local/MATLAB/R2018a/simulink/include\" -fexceptions -fPIC -fno-omit-frame-pointer -pthread -O -DNDEBUG \"/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/kalcvf.c\" -o /tmp/mex_8846989578426_15298/kalcvf.o\n    CMDLINE1_1 : /usr/bin/gcc -c -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE  -I\"/usr/local/MATLAB/R2018a/extern/include\" -I\"/usr/local/MATLAB/R2018a/simulink/include\" -fexceptions -fPIC -fno-omit-frame-pointer -pthread -O -DNDEBUG \"/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c\" -o /tmp/mex_8846989578426_15298/dlyap.o\n    CMDLINE1_2 : /usr/bin/gcc -c -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE  -I\"/usr/local/MATLAB/R2018a/extern/include\" -I\"/usr/local/MATLAB/R2018a/simulink/include\" -fexceptions -fPIC -fno-omit-frame-pointer -pthread -O -DNDEBUG \"/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/matlib.c\" -o /tmp/mex_8846989578426_15298/matlib.o\n    CMDLINE1_3 : /usr/bin/gcc -c -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE  -I\"/usr/local/MATLAB/R2018a/extern/include\" -I\"/usr/local/MATLAB/R2018a/simulink/include\" -fexceptions -fPIC -fno-omit-frame-pointer -pthread -O -DNDEBUG \"/usr/local/MATLAB/R2018a/extern/version/c_mexapi_version.c\" -o /tmp/mex_8846989578426_15298/c_mexapi_version.o\n-------------------------------------------------------------------\nBuilding with 'gcc'.\nWarning: You are using gcc version '7.4.0'. The version of gcc is not supported. The version\ncurrently supported with MEX is '6.3.x'. For a list of currently supported compilers see:\nhttps://www.mathworks.com/support/compilers/current_release. \n/usr/bin/gcc -c -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE  -I\"/usr/local/MATLAB/R2018a/extern/include\" -I\"/usr/local/MATLAB/R2018a/simulink/include\" -fexceptions -fPIC -fno-omit-frame-pointer -pthread -O -DNDEBUG \"/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/kalcvf.c\" -o /tmp/mex_8846989578426_15298/kalcvf.o\n/usr/bin/gcc -c -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE  -I\"/usr/local/MATLAB/R2018a/extern/include\" -I\"/usr/local/MATLAB/R2018a/simulink/include\" -fexceptions -fPIC -fno-omit-frame-pointer -pthread -O -DNDEBUG \"/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c\" -o /tmp/mex_8846989578426_15298/dlyap.o\n/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c: In function \u2018dlyap\u2019:\n/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c:102:24: warning: \u2018) is 0. The factorization has been completed, but Uis exactly singular. Division by 0 will occur if you use the factor U for solving a system of linear equations.\u2019 directive output truncated writing 162 bytes into a region of size between 76 and 96 [-Wformat-truncation=]\n       snprintf(msg,101,\"u(%d,%d) is 0. The factorization has been completed, but U\"\n                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c:103:56: note: format string is defined here\n       snprintf(msg,101,\"u(%d,%d) is 0. The factorization has been completed, but U\"\n                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n          \"is exactly singular. Division by 0 will occur if you use the factor \"\n          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~\n          \"U for solving a system of linear equations.\", info[0], info[0]);\n          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~   \nIn file included from /usr/include/stdio.h:862:0,\n                 from /usr/local/MATLAB/R2018a/extern/include/mex.h:194,\n                 from /home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/matlib.h:4,\n                 from /home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c:33:\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:64:10: note: \u2018__builtin___snprintf_chk\u2019 output between 168 and 188 bytes into a destination of size 101\n   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,\n          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n        __bos (__s), __fmt, __va_arg_pack ());\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c:165:24: warning: \u2018 and \u2019 directive output truncated writing 5 bytes into a region of size 0 [-Wformat-truncation=]\n       snprintf(msg,101,\"The algorithm has failed to find all the eigenvalues after \"\n                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c:166:55: note: format string is defined here\n          \"a total %d iterations. Elements 1,2, ..., %d and %d, %d,\"\n                                                       ^~~~~\nIn file included from /usr/include/stdio.h:862:0,\n                 from /usr/local/MATLAB/R2018a/extern/include/mex.h:194,\n                 from /home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/matlib.h:4,\n                 from /home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/dlyap.c:33:\n/usr/include/x86_64-linux-gnu/bits/stdio2.h:64:10: note: \u2018__builtin___snprintf_chk\u2019 output between 211 and 261 bytes into a destination of size 101\n   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,\n          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n        __bos (__s), __fmt, __va_arg_pack ());\n        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n/usr/bin/gcc -c -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE  -I\"/usr/local/MATLAB/R2018a/extern/include\" -I\"/usr/local/MATLAB/R2018a/simulink/include\" -fexceptions -fPIC -fno-omit-frame-pointer -pthread -O -DNDEBUG \"/home/lukas/Documents/PhD/Econometrics/Matlab_mex_files/kalcvf/matlib.c\" -o /tmp/mex_8846989578426_15298/matlib.o\n/usr/bin/gcc -c -DMX_COMPAT_64  -DMATLAB_MEXCMD_RELEASE=R2018a  -DUSE_MEX_CMD   -D_GNU_SOURCE -DMATLAB_MEX_FILE  -I\"/usr/local/MATLAB/R2018a/extern/include\" -I\"/usr/local/MATLAB/R2018a/simulink/include\" -fexceptions -fPIC -fno-omit-frame-pointer -pthread -O -DNDEBUG \"/usr/local/MATLAB/R2018a/extern/version/c_mexapi_version.c\" -o /tmp/mex_8846989578426_15298/c_mexapi_version.o\n/usr/bin/gcc -pthread -Wl,--no-undefined -Wl,-rpath-link,/usr/local/MATLAB/R2018a/bin/glnxa64 -shared  -O -Wl,--version-script,\"/usr/local/MATLAB/R2018a/extern/lib/glnxa64/c_exportsmexfileversion.map\" /tmp/mex_8846989578426_15298/kalcvf.o /tmp/mex_8846989578426_15298/dlyap.o /tmp/mex_8846989578426_15298/matlib.o /tmp/mex_8846989578426_15298/c_mexapi_version.o   -lmwblas  -lmwlapack   -L\"/usr/local/MATLAB/R2018a/bin/glnxa64\" -lmx -lmex -lmat -lm -lstdc++ -o kalcvf.mexa64\nMEX completed successfully.\n</code></pre>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 3126, "user_id": 2955790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vShcC.png?s=128&g=1", "display_name": "Duck Dodgers", "link": "https://stackoverflow.com/users/2955790/duck-dodgers"}, "edited": false, "score": 9, "creation_date": 1563357673, "post_id": 57073226, "comment_id": 100670185, "body": "<a href=\"https://beginnersbook.com/2014/01/2d-arrays-in-c-example/\" rel=\"nofollow noreferrer\">Beginner&#39;s Tutorial</a> or try any other C book of your choice."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1563357712, "post_id": 57073226, "comment_id": 100670205, "body": "Two things unrelated to your problem: First of all <b><i>never ever</i></b> use the <code>gets</code> function, it&#39;s <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">dangerous</a> and have been removed from the C standard. Use e.g. <a href=\"https://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> instead. Second, passing a read-only <code>FILE</code> stream to <code>fflush</code> (like <code>stdin</code>) is explicitly mentioned as <i>undefined behavior</i> in the C specification."}], "answers": [{"tags": [], "owner": {"reputation": 359, "user_id": 11796720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe2c3f1bc463738af3393207efacc50?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/11796720/pablo"}, "is_accepted": false, "score": -2, "last_activity_date": 1563358926, "last_edit_date": 1563358926, "creation_date": 1563358442, "answer_id": 57073524, "question_id": 57073226, "link": "https://stackoverflow.com/questions/57073226/what-does-char-a5050-mean-in-c/57073524#57073524", "title": "What does char a[50][50] mean in C?", "body": "<p>That program seems to store <code>n</code> names in the array <code>a</code>. It first asks for the number of names, and then the names. The method <code>char *gets(char *str)</code> stores each different line in an entry of <code>a</code>.</p>\n\n<p><code>n</code> has 2 dimensions. The first refers to the number of names, and the second is for the length of each name. Something like <code>n[number_of_names][lenght_of_name]</code></p>\n\n<p>However, it will probably crash if the user provides an n > 50, or if a name contains more than 50 chars.</p>\n\n<p>Also, <code>gets()</code> is dangerous. See <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">this other post</a>.</p>\n\n<p><strong>EDIT:</strong> Changing <code>a</code> to one dimensions makes the program try to store a whole line inside a char, hence the error</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1563363446, "creation_date": 1563363446, "answer_id": 57074928, "question_id": 57073226, "link": "https://stackoverflow.com/questions/57073226/what-does-char-a5050-mean-in-c/57074928#57074928", "title": "What does char a[50][50] mean in C?", "body": "<p><code>char a[50][50]</code> declares <code>a</code> to be an array of 50 arrays of 50 <code>char</code>.</p>\n\n<p>Then <code>a[0]</code> is an array of 50 <code>char</code>, and so is <code>a[1]</code>,<code>a[2]</code>. <code>a[3]</code>, and so on up to <code>a[49]</code>. There are 50 separate arrays, and each of them has 50 <code>char</code>.</p>\n\n<p>Since <code>a[0]</code> is an array of 50 <code>char</code>, <code>a[0][0]</code> is a <code>char</code>. In general, <code>a[i][j]</code> is character <code>j</code> of array <code>i</code>.</p>\n\n<p><code>gets(a[i])</code> says to read characters from input and put them into <code>a[i]</code>. For this to work, <code>a[i]</code> must be an array of <code>char</code>\u2014<code>gets</code> reads multiple characters and puts them in the array. If <code>a[i]</code> were a single character, <code>gets</code> could not work.</p>\n\n<p>Although <code>gets(a[i])</code> says to put characters into <code>a[i]</code>, it works by passing an address instead of passing the array. When an array is used in an expression other than as the operand of <code>sizeof</code> or the address operator <code>&amp;</code>, C automatically converts it to a pointer to its first element. Since <code>a[i]</code> is an array, it is automatically converted to a pointer to its first element (a pointer to <code>a[i][0]</code>). <code>gets</code> receives this pointer and uses it to fill in characters that it reads from the standard input stream.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11755550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d911726a75457195c44fb4fb91c9490?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Ciupak", "link": "https://stackoverflow.com/users/11755550/mitchell-ciupak"}, "is_accepted": false, "score": 0, "last_activity_date": 1563368625, "creation_date": 1563368625, "answer_id": 57076532, "question_id": 57073226, "link": "https://stackoverflow.com/questions/57073226/what-does-char-a5050-mean-in-c/57076532#57076532", "title": "What does char a[50][50] mean in C?", "body": "<p>Basically, in C this signifies an array of length 0 to 50 of that contains the character value of 50 in each cell of the array</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1563384150, "creation_date": 1563384150, "answer_id": 57081241, "question_id": 57073226, "link": "https://stackoverflow.com/questions/57073226/what-does-char-a5050-mean-in-c/57081241#57081241", "title": "What does char a[50][50] mean in C?", "body": "<p><code>char a[50][50]</code> declares <code>a</code> as a 50-element array of 50-element arrays of <code>char</code>.  That means each <code>a[i]</code> is a 50-element array of <code>char</code>.  It will be laid out in memory like:</p>\n\n<pre><code>   +---+\na: |   | a[0][0]\n   +---+\n   |   | a[0][1]\n   +---+\n   |   | a[0][2]\n   +---+\n    ...\n   +---+\n   |   | a[0][49]\n   +---+\n   |   | a[1][0]\n   +---+\n   |   | a[1][1]\n   +---+\n    ...\n   +---+\n   |   | a[1][49]\n   +---+\n   |   | a[2][0]\n   +---+ \n    ...\n</code></pre>\n\n<p>This code is storing up to 50 <em>strings</em>, each up to 49 characters long, in <code>a</code> (IOW, each <code>a[i]</code> can store a 49-character string).  In C, a <em>string</em> is a sequence of character values including a 0-valued terminator.  For example, the string <code>\"hello\"</code>, is represented as the sequence <code>{'h', 'e', 'l', 'l', 'o', 0}</code>.  That trailing <code>0</code> marks the end of the string.  String handling functions and output functions like <code>puts</code> and <code>printf</code> with the <code>%s</code> specifier need that 0 terminator in order to process the string correctly.  </p>\n\n<p>Strings are stored in arrays of character type, either <code>char</code> (for ASCII, UTF-8, or EBCDIC character sets) or <code>wchar_t</code> for \"wide\" strings (character sets that require more than 8 or so bits to encode).  An N-character string requires an array that's <em>at least</em> N+1 elements wide to account for the 0 terminator.  </p>\n\n<p>Unless it is the operand of the <code>sizeof</code> or unary <code>&amp;</code> operator, or is a string literal used to initialize an array of character type, an <em>expression</em> of type \"N-element array of <code>T</code>\" will be converted (\"decay\") to an expression of type \"pointer to <code>T</code>\", and the value of the expression will be the address of the first element of the array. </p>\n\n<p>When you call</p>\n\n<pre><code>gets( a[i] );\n</code></pre>\n\n<p>the expression <code>a[i]</code> is converted from type \"50-element array of <code>char</code>\" to \"pointer to <code>char</code>\", and the value of the expression is the address of the first element of the array (<code>&amp;a[i][0]</code>)<sup>1</sup>.  <code>gets</code> will read characters from standard input and store them to the array starting at that address.  Note that <code>gets</code> is no longer part of the standard C library - it was removed in the 2011 version of the standard because it is unsafe.  C does not require any sort of bounds checking on array accesses - if you type in more characters than the target buffer is sized to hold (in this case, 50), those extra characters will be written to memory immediately following the last element of the array, which can cause all sorts of mayhem.  Buffer overflows are a popular malware exploit. You should replace the <code>gets</code> call with</p>\n\n<pre><code>fgets( a[i], 50, stdin );\n</code></pre>\n\n<p>which will read up to 49 characters into <code>a[i]</code> from standard input.  Note that any excess characters are left in the input stream.</p>\n\n<p>Also, the behavior of <code>fflush</code> is not defined for input streams<sup>2</sup> - there's no good, safe, <em>portable</em> way to clear excess input except to read it using <code>getchar</code> or <code>fgetc</code>.</p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>This is why you got the error message you did when you changed <code>a</code> from <code>char [50][50]</code> to <code>char [50]</code> - in that case, <code>a[i]</code> has type <code>char</code>, not <code>char *</code>, and the value of <code>a[i]</code> is not an <em>address</em>.  \n\n<li>Microsoft's Visual Studio C compiler is a notable exception - it will clear excess input from the input stream.  However, that's specific to MSVC, and not portable across different compilers.  The operation is also a little nonsensical with respect to \"flush\" semantics.\n</ol>\n\n<p></sup></p>\n"}], "owner": {"reputation": 55, "user_id": 11796868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RVIUQ.jpg?s=128&g=1", "display_name": "Ho&#224;ng Th\u1ee7y Ti&#234;n", "link": "https://stackoverflow.com/users/11796868/ho%c3%a0ng-th%e1%bb%a7y-ti%c3%aan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1354, "favorite_count": 0, "accepted_answer_id": 57081241, "answer_count": 4, "score": -11, "last_activity_date": 1563384150, "creation_date": 1563357468, "question_id": 57073226, "link": "https://stackoverflow.com/questions/57073226/what-does-char-a5050-mean-in-c", "title": "What does char a[50][50] mean in C?", "body": "<p>I'm working on a homework that has to do with strings.\nHere's the code</p>\n\n<pre><code>\nint main(){\n    char a[50][50];\n    int n;\n    printf(\"Enter the value of n\\n\");\n    scanf(\"%d\",&amp;n);\n    printf(\"Enter %d names\\n\",n);\n    fflush(stdin);\n    for(int i=0; i&lt;n; i++){\n        gets(a[i]);\n    }\n</code></pre>\n\n<p>I tried to change the char a[50][50] into char a[50] but the entire program didn't run, came along with this error message: \"Invalid conversion from 'char' to '*char'\nI don't really understand how this works.</p>\n"}, {"tags": ["c++", "c", "bison"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1563357203, "post_id": 57073058, "comment_id": 100669897, "body": "Why do you think the Bison stack size would change for a C++ implementation of Bison? Otherwise, nothing stops you from using C++ code in the Bison actions. And you might want to search for &quot;Bison++&quot;."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1563378924, "post_id": 57073058, "comment_id": 100682805, "body": "@Someprogrammerdude: Bison&#39;s C++ template implements the parser stack using a <code>std::vector</code>, leaving it to that standard library datatype to implement any size limit. I don&#39;t believe most <code>std::vector</code> implementations do anything other than respond to allocation failures (if these occur; as we all know, platforms with optimistic memory allocation generally don&#39;t report allocation failure in a useful fashion)."}], "answers": [{"tags": [], "owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "is_accepted": false, "score": 1, "last_activity_date": 1563359608, "creation_date": 1563359608, "answer_id": 57073846, "question_id": 57073058, "link": "https://stackoverflow.com/questions/57073058/porting-c-bison-parser-to-c/57073846#57073846", "title": "Porting C bison parser to C++", "body": "<p>Assuming you want to get your hands on writing parsers in C++ using Flex &amp; Bison, here comes the answer.</p>\n\n<p><a href=\"http://www.jonathanbeard.io/tutorials/FlexBisonC++\" rel=\"nofollow noreferrer\">This article</a> provides answer to your question. The author is using Flex and Bison in C++ freely, in OO manner. In case of Flex, you can make use of <code>%{ ... %}</code> code blocks. On the other hand, in case of Bison, that's how really, really generic parser would look in C++ according to author:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>%skeleton \"lalr1.cc\"\n%require  \"3.0\"\n%debug \n%defines \n%define api.namespace {MC}\n%define parser_class_name {MC_Parser}\n\n%code requires{\n   namespace MC {\n      class MC_Driver;\n      class MC_Scanner;\n   }\n\n// The following definitions is missing when %locations isn't used\n# ifndef YY_NULLPTR\n#  if defined __cplusplus &amp;&amp; 201103L &lt;= __cplusplus\n#   define YY_NULLPTR nullptr\n#  else\n#   define YY_NULLPTR 0\n#  endif\n# endif\n\n}\n\n%parse-param { MC_Scanner  &amp;scanner  }\n%parse-param { MC_Driver  &amp;driver  }\n\n%code{\n   #include &lt;iostream&gt;\n   #include &lt;cstdlib&gt;\n   #include &lt;fstream&gt;\n\n   /* include for all driver functions */\n   #include \"mc_driver.hpp\"\n\n#undef yylex\n#define yylex scanner.yylex\n}\n\n%define api.value.type variant\n%define parse.assert\n\n%token               END    0     \"end of file\"\n%token               UPPER\n%token               LOWER\n%token &lt;std::string&gt; WORD\n%token               NEWLINE\n%token               CHAR\n\n%locations\n\n%%\n\nlist_option : END | list END;\n\nlist\n  : item\n  | list item\n  ;\n\nitem\n  : UPPER   { driver.add_upper(); }\n  | LOWER   { driver.add_lower(); }\n  | WORD    { driver.add_word( $1 ); }\n  | NEWLINE { driver.add_newline(); }\n  | CHAR    { driver.add_char(); }\n  ;\n\n%%\n\n\nvoid \nMC::MC_Parser::error( const location_type &amp;l, const std::string &amp;err_message )\n{\n   std::cerr &lt;&lt; \"Error: \" &lt;&lt; err_message &lt;&lt; \" at \" &lt;&lt; l &lt;&lt; \"\\n\";\n} \n</code></pre>\n\n<p>... and the driver code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;cctype&gt;\n#include &lt;fstream&gt;\n#include &lt;cassert&gt;\n\n#include \"mc_driver.hpp\"\n\nMC::MC_Driver::~MC_Driver()\n{\n   delete(scanner);\n   scanner = nullptr;\n   delete(parser);\n   parser = nullptr;\n}\n\nvoid \nMC::MC_Driver::parse( const char * const filename )\n{\n   /**\n    * Remember, if you want to have checks in release mode\n    * then this needs to be an if statement \n    */\n   assert( filename != nullptr );\n   std::ifstream in_file( filename );\n   if( ! in_file.good() )\n   {\n       exit( EXIT_FAILURE );\n   }\n   parse_helper( in_file );\n   return;\n}\n\nvoid\nMC::MC_Driver::parse( std::istream &amp;stream )\n{\n   if( ! stream.good()  &amp;&amp; stream.eof() )\n   {\n       return;\n   }\n   //else\n   parse_helper( stream ); \n   return;\n}\n\n\nvoid \nMC::MC_Driver::parse_helper( std::istream &amp;stream )\n{\n\n   delete(scanner);\n   try\n   {\n      scanner = new MC::MC_Scanner( &amp;stream );\n   }\n   catch( std::bad_alloc &amp;ba )\n   {\n      std::cerr &lt;&lt; \"Failed to allocate scanner: (\" &lt;&lt;\n         ba.what() &lt;&lt; \"), exiting!!\\n\";\n      exit( EXIT_FAILURE );\n   }\n\n   delete(parser); \n   try\n   {\n      parser = new MC::MC_Parser( (*scanner) /* scanner */, \n                                  (*this) /* driver */ );\n   }\n   catch( std::bad_alloc &amp;ba )\n   {\n      std::cerr &lt;&lt; \"Failed to allocate parser: (\" &lt;&lt; \n         ba.what() &lt;&lt; \"), exiting!!\\n\";\n      exit( EXIT_FAILURE );\n   }\n   const int accept( 0 );\n   if( parser-&gt;parse() != accept )\n   {\n      std::cerr &lt;&lt; \"Parse failed!!\\n\";\n   }\n   return;\n}\n\nvoid \nMC::MC_Driver::add_upper()\n{ \n   uppercase++; \n   chars++; \n   words++; \n}\n\nvoid \nMC::MC_Driver::add_lower()\n{ \n   lowercase++; \n   chars++; \n   words++; \n}\n\nvoid \nMC::MC_Driver::add_word( const std::string &amp;word )\n{\n   words++; \n   chars += word.length();\n   for(const char &amp;c : word ){\n      if( islower( c ) )\n      { \n         lowercase++; \n      }\n      else if ( isupper( c ) ) \n      { \n         uppercase++; \n      }\n   }\n}\n\nvoid \nMC::MC_Driver::add_newline()\n{ \n   lines++; \n   chars++; \n}\n\nvoid \nMC::MC_Driver::add_char()\n{ \n   chars++; \n}\n\n\nstd::ostream&amp; \nMC::MC_Driver::print( std::ostream &amp;stream )\n{\n   /** NOTE: Colors are defined as class variables w/in MC_Driver **/\n   stream &lt;&lt; red  &lt;&lt; \"Results: \" &lt;&lt; norm &lt;&lt; \"\\n\";\n   stream &lt;&lt; blue &lt;&lt; \"Uppercase: \" &lt;&lt; norm &lt;&lt; uppercase &lt;&lt; \"\\n\";\n   stream &lt;&lt; blue &lt;&lt; \"Lowercase: \" &lt;&lt; norm &lt;&lt; lowercase &lt;&lt; \"\\n\";\n   stream &lt;&lt; blue &lt;&lt; \"Lines: \" &lt;&lt; norm &lt;&lt; lines &lt;&lt; \"\\n\";\n   stream &lt;&lt; blue &lt;&lt; \"Words: \" &lt;&lt; norm &lt;&lt; words &lt;&lt; \"\\n\";\n   stream &lt;&lt; blue &lt;&lt; \"Characters: \" &lt;&lt; norm &lt;&lt; chars &lt;&lt; \"\\n\";\n   return(stream);\n}\n</code></pre>\n\n<p>Much better explaination (compared to just comments above) of this code can be found on authors website linked two paragraphs above. I really advice you to check it out.</p>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 0, "last_activity_date": 1563379337, "last_edit_date": 1563379337, "creation_date": 1563378685, "answer_id": 57079872, "question_id": 57073058, "link": "https://stackoverflow.com/questions/57073058/porting-c-bison-parser-to-c/57079872#57079872", "title": "Porting C bison parser to C++", "body": "<p>You're under no obligation to use flex's C++ template in a C++ program. The C code generated by flex should compile and execute correctly in C++. (At least, I haven't seen a problem.) As indicated in the flex documentation, any C++ incompatibility in the generated C code will be treated as a bug and should be reported as such.</p>\n\n<p>Having said that, if your only concern with bison's C template is the limitation on parser stack size, you can easily increase the limit by defining <code>YYMAXDEPTH</code>. In particular, you can essentially avoid any limit by using:</p>\n\n<pre><code>#define YYMAXDEPTH (YYSTACK_ALLOC_MAXIMUM / YYSTACK_BYTES (1))\n</code></pre>\n\n<p>(That formula was derived from a comment in the skeleton <code>data/yacc.c</code>:</p>\n\n<pre><code>/* YYMAXDEPTH -- maximum size the stacks can grow to (effective only\n   if the built-in stack extension method is used).\n\n   Do not make this value too large; the results are undefined if\n   YYSTACK_ALLOC_MAXIMUM &lt; YYSTACK_BYTES (YYMAXDEPTH)\n   evaluated with infinite-precision integer arithmetic.  */\n</code></pre>\n\n<p>I don't know if that comment really constitutes formal documentation, but it seems to be addressed to people who might consider changing the value of <code>YYMAXDEPTH</code> so I'm assuming that it's OK to rely on it. :-) ) On the other hand, you might well consider imposing some smaller limit, since just leaving it to <code>malloc()</code> to report allocation failure -- which is the result of the above <code>#define</code> -- is notoriously unreliable on platforms which use optimistic memory allocation.</p>\n\n<p>The issue with optimistic memory allocation is not avoided by switching to C++, since bison's C++ template relies on <code>std::vector</code> to report memory allocation failure, and none of the standard library implementations I know of attempt to predict future unavailability of optimistic allocated memory.</p>\n"}], "owner": {"reputation": 35, "user_id": 1112577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d87b83f11ebfcdcca7e326113020fe?s=128&d=identicon&r=PG", "display_name": "Nedeljko", "link": "https://stackoverflow.com/users/1112577/nedeljko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563379337, "creation_date": 1563356907, "question_id": 57073058, "link": "https://stackoverflow.com/questions/57073058/porting-c-bison-parser-to-c", "title": "Porting C bison parser to C++", "body": "<p>I use reentrant FLEX C based scanner and reentrant bison C based parser. It works fine.</p>\n\n<p>I wish to keep reentrant C based FLEX scanner and to get reentrant bison C++ based parser.</p>\n\n<p>Why? When the input is too complex (too long if-else-if chain), then limitation about bison's stack size is problem. Also, I dislike undocumented solutions and solutions where authors says that something will be changed and so on. This is why I wish to keep C based FLEX scanner.</p>\n\n<p>Also, I need to use specific prefixes or suffixes or namespaces to use multiple reentrant FLEX C based scanners and reentrant bison C++ based parsers.</p>\n\n<p>Thanx</p>\n"}, {"tags": ["c", "malloc", "free"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563357057, "post_id": 57073057, "comment_id": 100669813, "body": "<i>I want to know where am i going wrong</i>  To get that, you&#39;ll have to post a complete example.  What you&#39;ve posted isn&#39;t enough for anyone to say what&#39;s wrong."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 3, "creation_date": 1563357073, "post_id": 57073057, "comment_id": 100669826, "body": "Please create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal, complete and verifiable example</a> and add it to your question."}, {"owner": {"reputation": 13, "user_id": 11289348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab22de1e0d25cbc6de22ce1a6aa8a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Rudvick", "link": "https://stackoverflow.com/users/11289348/rudvick"}, "edited": false, "score": 0, "creation_date": 1563357151, "post_id": 57073057, "comment_id": 100669867, "body": "Alright, one sec"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1563357255, "post_id": 57073057, "comment_id": 100669931, "body": "Aside: note that <code>void free(void *memblock);</code> takes a <code>void *</code> pointer as passed to your functions. There is no need for a cast."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1563357283, "post_id": 57073057, "comment_id": 100669942, "body": "In C you <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc/\">don&#39;t have to cast the result of <code>malloc</code></a>."}, {"owner": {"reputation": 13, "user_id": 11289348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab22de1e0d25cbc6de22ce1a6aa8a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Rudvick", "link": "https://stackoverflow.com/users/11289348/rudvick"}, "edited": false, "score": 0, "creation_date": 1563357438, "post_id": 57073057, "comment_id": 100670030, "body": "I have removed the castings, still get the same result"}, {"owner": {"reputation": 13, "user_id": 11289348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab22de1e0d25cbc6de22ce1a6aa8a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Rudvick", "link": "https://stackoverflow.com/users/11289348/rudvick"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563357513, "post_id": 57073057, "comment_id": 100670072, "body": "Also added the whole code, so as you get the idea of implementation @AndrewHenle"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563357521, "post_id": 57073057, "comment_id": 100670078, "body": "You have one <code>malloc</code> but two <code>free</code> calls - although you don&#39;t call them yourself, you pass the functions to the library routines. From the casts posted originally, one of them is a <code>char*</code> type."}, {"owner": {"reputation": 13, "user_id": 11289348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab22de1e0d25cbc6de22ce1a6aa8a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Rudvick", "link": "https://stackoverflow.com/users/11289348/rudvick"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563357594, "post_id": 57073057, "comment_id": 100670140, "body": "One if for they key and one is for destroying the info of a node @WeatherVane"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1563357732, "post_id": 57073057, "comment_id": 100670225, "body": "Is the info the last parameter of <code>RBTreeInsert</code> ? Ie. a pointer to a string literal in your case ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563357745, "post_id": 57073057, "comment_id": 100670238, "body": "So you are saying the library function allocates the memory for the info (you don&#39;t). How can it do that, if you don&#39;t tell it the size and type? Apart from that, the data appears to be, say, <code>&quot;Appointment 2 (day 3560, hour 11)&quot;</code> which is a string literal and cannot be freed."}, {"owner": {"reputation": 13, "user_id": 11289348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab22de1e0d25cbc6de22ce1a6aa8a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Rudvick", "link": "https://stackoverflow.com/users/11289348/rudvick"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1563357886, "post_id": 57073057, "comment_id": 100670325, "body": "@SanderDeDycker Yes that is the case."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1563357997, "post_id": 57073057, "comment_id": 100670388, "body": "Then that&#39;s likely your problem. Don&#39;t free string literals !"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563358040, "post_id": 57073057, "comment_id": 100670418, "body": "You are passing callback functions for creation and destruction - it&#39;s all up to your user-defined functions. One <code>malloc</code>, two <code>free</code>."}], "owner": {"reputation": 13, "user_id": 11289348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dab22de1e0d25cbc6de22ce1a6aa8a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Rudvick", "link": "https://stackoverflow.com/users/11289348/rudvick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1563358393, "answer_count": 0, "score": 0, "last_activity_date": 1563357316, "creation_date": 1563356907, "last_edit_date": 1563357316, "question_id": 57073057, "link": "https://stackoverflow.com/questions/57073057/how-to-free-this-memory-properly", "closed_reason": "Duplicate", "title": "How to free this memory properly?", "body": "<p>I have used the following two functions in a program, but while freeing i am getting the following error.</p>\n\n<pre><code>free(): invalid size\nMakefile:19: recipe for target 'run' failed\nmake: *** [run] Aborted (core dumped)\n</code></pre>\n\n<pre><code>/* rbcal.c -- solution to rbcal task */\n#include &lt;string.h&gt;\n#include \"../rb_tree/red_black_tree.h\"\n\n/* do not change the name of rbtree, and do not make it static */\nrb_red_blk_tree *rbtree = NULL;\n\n/* define a function to convert days, hours to a key.\n *   You are free to use any representation. The companion\n *   function destroykey() will be called when key is no\n *   longer needed.\n */\nvoid *createkey(int day, int hour)\n{\n    int *key  = malloc(sizeof(int));\n    *key = (day*1000 + hour);\n    return (void *)key;\n    /* your code goes here */\n}\n\n\n/* define functions for red black tree */\n\nvoid destroykey(void *a)\n{\n    free(a);\n    /* your code goes here */\n}\n\n\nvoid destroyinfo(void *a)\n{\n    free(a);\n    /* your code goes here */\n}\n\nint compare(const void *a, const void *b)\n{\n    if( *(int*)a &gt; *(int*)b) return(1);\n    if( *(int*)a &lt; *(int*)b) return(-1);\n    return(0);\n    /* return 0 if key a equals key b,\n     * return 1 if key a is EARLIER than key b\n     * return -1 if key a is LATER than key b\n     */\n}\n\n/* init - initialize rbtree\n *   before calling init, rbtree is NULL\n *   when init returns, rbtree must be an empty tree\n */\nvoid init()\n{\n    rbtree=RBTreeCreate(compare,destroykey,destroykey,NULL,NULL);\n    /* your code goes here */\n}\n\n\n/* cleanup - deallocate all allocated memory \n *    before calling cleanup, rbtree is either NULL or a tree\n *    after cleanup, rbtree is NULL and any memory allocated\n *          by rbtree functions or other functions is freed\n */\nvoid cleanup()\n{   \n    RBTreeDestroy(rbtree);\n    /* your code goes here */\n}\n\n\n/* cal_add - associate a string with a time in rbtree\n *    Before calling cal_add, day/hour may or may not be in rbtree\n *    After calling cal_add, day/hour is associated with *content*\n *        of string s such that cal_lookup(day, hour) will \n *        retrieve s. The storage pointed to by s may be \n *        overwritten by the caller, so do not assume s is \n *        immutable (i.e. make a copy).\n *        Although the red-black tree can store two identical\n *        keys with different info values, cal_add should \n *        not add a new appointment if day/hour is already in\n *        the calendar.\n *    Return 0 if the day/hour is already entered into the calendar.\n *    Otherwise, the appointment is entered and return 1.\n */\nint cal_add(int day, int hour, char *s)\n{   \n    if(RBExactQuery(rbtree,createkey(day,hour))!=0)\n        return 0;\n\n    RBTreeInsert(rbtree,createkey(day,hour),(char *)s);\n    return 1;\n    /* your code goes here */\n}\n\n\n/* cal_lookup - retrieve the appointment for a given time\n *    Before cal_lookup is called, rbtree is a valid red-black tree.\n *    After cal_lookup is called, rbtree is unchanged.\n *    The returned value is NULL if there is no appointment at the\n *        given day and hour; otherwise, the returned value is the string\n *        associated with the appointment in a previous call to cal_add().\n *    The returned string should be the address of the string in the \n *        tree. The returned string will not be modified or freed.\n */\nchar *cal_lookup(int day, int hour)\n{\n    if(RBExactQuery(rbtree,createkey(day,hour))==0)\n        return NULL;\n    return ((char *) RBExactQuery(rbtree,createkey(day,hour))-&gt;info);\n    /* your code goes here */\n}\n\n\nint main()\n{\n    init();\n    int pass = 1;\n    pass &amp;= cal_add(3560, 10, \"Appointment 1 (day 3560, hour 10)\");\n    cal_add(3560, 11, \"Appointment 2 (day 3560, hour 11)\");\n    pass &amp;= (cal_lookup(3560, 12) == NULL);\n    pass &amp;= (strcmp(cal_lookup(3560, 10), \n                    \"Appointment 1 (day 3560, hour 10)\") == 0);\n    cleanup();\n    if (pass) {\n        printf(\"cal_add() and cal_lookup() worked as expected \"\n               \"in simple tests.\\n\");\n    } else {\n        printf(\"There is a problem with cal_add() or cal_lookup().\\n\");\n    }\n    return 0; /* return 0 on success */\n}\n\n</code></pre>\n\n<p>The RB Tree implementation is given here: <a href=\"https://pastecode.xyz/view/c1663925\" rel=\"nofollow noreferrer\">https://pastecode.xyz/view/c1663925</a></p>\n\n<p>I want to know where am i going wrong, i have tried from the questions already asked but i am still not able to get it to work.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1563355745, "post_id": 57072416, "comment_id": 100669111, "body": "You&#39;re incrementing the ptr in wrong location. Increment it <b>either</b> in the for loop (<code>i++, ptr ++</code>) or <b>after</b> printf."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 9, "last_activity_date": 1563355090, "last_edit_date": 1563355090, "creation_date": 1563355034, "answer_id": 57072471, "question_id": 57072416, "link": "https://stackoverflow.com/questions/57072416/difference-in-printing-out-pointer-value-vs-array/57072471#57072471", "title": "Difference in printing out pointer value vs array", "body": "<pre><code>int arr[5] = { 1, 2, 3, 4, 5 };\n    int * ptr = arr;\n\n    for (int i = 0; i &lt; 5; i++) {\n        (*ptr) += 2;\n        ptr++;\n        printf(\"%d\", (*ptr));\n    }\n</code></pre>\n\n<p>The reason is you are incrementing the pointer first and then printing its content.</p>\n\n<p>Perhaps you need to print the contents first then increment it to point next element.</p>\n\n<pre><code>int arr[5] = { 1, 2, 3, 4, 5 };\n    int * ptr = arr;\n\n    for (int i = 0; i &lt; 5; i++) {\n        (*ptr) += 2;\n        printf(\"%d\", (*ptr));\n        ptr++;\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1563356057, "post_id": 57072608, "comment_id": 100669283, "body": "<code>has a garbage value</code> - how do you know that? Accessing <code>arr[5]</code> is undefined behavior, you shouldn&#39;t make any assumptions what happens on such access."}], "tags": [], "owner": {"reputation": 89, "user_id": 8972038, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/1969707509983334/picture?type=large", "display_name": "Ankush Pandit", "link": "https://stackoverflow.com/users/8972038/ankush-pandit"}, "is_accepted": false, "score": -1, "last_activity_date": 1563355450, "creation_date": 1563355450, "answer_id": 57072608, "question_id": 57072416, "link": "https://stackoverflow.com/questions/57072416/difference-in-printing-out-pointer-value-vs-array/57072608#57072608", "title": "Difference in printing out pointer value vs array", "body": "<p>In the first code:\n<strong>(*ptr) += 2;</strong>   It is increasing the value pointed by 'ptr' by 2 .</p>\n\n<p><strong>ptr++;</strong>         It increments the pointer by position 1, that means it points to the next element. At the end of loop it is pointing to arr[5] which has a garbage value.</p>\n"}, {"tags": [], "owner": {"reputation": 465, "user_id": 11241587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bea334bb29226f73a25b431b3e48b5?s=128&d=identicon&r=PG&f=1", "display_name": "Theodor Badea", "link": "https://stackoverflow.com/users/11241587/theodor-badea"}, "is_accepted": false, "score": 1, "last_activity_date": 1563355910, "creation_date": 1563355910, "answer_id": 57072726, "question_id": 57072416, "link": "https://stackoverflow.com/questions/57072416/difference-in-printing-out-pointer-value-vs-array/57072726#57072726", "title": "Difference in printing out pointer value vs array", "body": "<p>The reason for your error is the fact that you make ptr point to the next value before printing your current value(the value you actually want to be printed).\nLet's consider the first step of your for loop, line by line, and keep in mind that in the beginning you made ptr point to the first element of the array(int * ptr = arr;):</p>\n\n<ol>\n<li>(*ptr) += 2; - this line is equivalent to (*ptr) = (*ptr) + 2; which means \"increase by 2 the value located in the memory address pointed by ptr\", so now the first element of the array is 3 (ptr is unchanged, it points to the first element of the array).</li>\n<li>ptr++; - this line increments ptr, or in other words ptr will now point to the next memory location, in your case the second element of the array. First element is 3, the value of the second element is unchanged.</li>\n<li>printf(\"%d\", (*ptr)); - this line prints the value stored in the memory location pointed by ptr, but you made ptr point to the next location in the previous line, so ptr is pointing, as I said before, to the second element.</li>\n</ol>\n\n<p>I hope you understand what happens in the next steps of your for loop.</p>\n"}, {"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1563356090, "post_id": 57072734, "comment_id": 100669303, "body": "<code>ptr+i;</code> ? What does <code>prt+i</code> do? It just adds <code>i</code> to <code>ptr</code> and discards the result?"}, {"owner": {"reputation": 910, "user_id": 6422591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wIpwn.jpg?s=128&g=1", "display_name": "manish ma", "link": "https://stackoverflow.com/users/6422591/manish-ma"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1563356288, "post_id": 57072734, "comment_id": 100669412, "body": "*(Ptr + i) = ptr[ i ]"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1563356790, "post_id": 57072734, "comment_id": 100669676, "body": "The code is still wrong and won&#39;t produce the expected output the OP was looking for"}, {"owner": {"reputation": 910, "user_id": 6422591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wIpwn.jpg?s=128&g=1", "display_name": "manish ma", "link": "https://stackoverflow.com/users/6422591/manish-ma"}, "edited": false, "score": 0, "creation_date": 1563357990, "post_id": 57072734, "comment_id": 100670385, "body": "Looks so simple, and yet so complicated :D"}], "tags": [], "owner": {"reputation": 910, "user_id": 6422591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wIpwn.jpg?s=128&g=1", "display_name": "manish ma", "link": "https://stackoverflow.com/users/6422591/manish-ma"}, "is_accepted": false, "score": -1, "last_activity_date": 1563357947, "last_edit_date": 1563357947, "creation_date": 1563355938, "answer_id": 57072734, "question_id": 57072416, "link": "https://stackoverflow.com/questions/57072416/difference-in-printing-out-pointer-value-vs-array/57072734#57072734", "title": "Difference in printing out pointer value vs array", "body": "<p>If you're already using a for loop. \nReplace ptr++ with ptr+i.</p>\n\n<pre><code>int arr[5] = { 1, 2, 3, 4, 5 };\nint * ptr = arr;\n\nfor (int i = 0; i &lt; 5; i++) {\n    *(ptr + i) += 2;\n    printf(\"%d\", *(ptr + i));\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 0, "last_activity_date": 1563356434, "creation_date": 1563356434, "answer_id": 57072900, "question_id": 57072416, "link": "https://stackoverflow.com/questions/57072416/difference-in-printing-out-pointer-value-vs-array/57072900#57072900", "title": "Difference in printing out pointer value vs array", "body": "<p>The reason it does not work is because you incremented the pointer before printing it out.</p>\n\n<pre><code>for (int i = 0; i &lt; 5; i++) {\n    (*ptr) += 2;\n    /* ptr++; */\n    printf(\"%d\", *ptr++);\n/*                   ^^ increment after */\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 763, "user_id": 10656609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67a018f0678dafb31664d25e08c716d?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/10656609/alan"}, "is_accepted": false, "score": 0, "last_activity_date": 1563359244, "creation_date": 1563359244, "answer_id": 57073757, "question_id": 57072416, "link": "https://stackoverflow.com/questions/57072416/difference-in-printing-out-pointer-value-vs-array/57073757#57073757", "title": "Difference in printing out pointer value vs array", "body": "<p>As people here have said, your output is wrong because you increment ptr before printing its content.</p>\n\n<p>The reason you are getting values like \"-858993460\" is</p>\n\n<p><code>ptr = arr</code> sets ptr to the arrays memory location. The way this works is, arr has a specific memory location and reserves that memory location and all the ones following it until memorylocation+(length-1).</p>\n\n<p>So assuming arr is at location \"15007140\".</p>\n\n<p>Then you set the values on each memory location as following:</p>\n\n<pre><code>15007140 = 1\n15007144 = 2\n15007148 = 3\n15007152 = 4\n15007156 = 5\n</code></pre>\n\n<p>Doing <code>ptr=arr</code> essentially sets ptr=15007140. When calling (*ptr) you get access to the value in memory location 15007140. doing ptr++ increases 15007140 to 15007144. if you call (*ptr) you get access to the value in that location, which is 2 in this case.</p>\n\n<p>if you increase ptr further and further, you can actually increase it beyond 15007156 (which is the end of the array), thus getting access to memory addresses and their values, which are no direct part of your code (as you saw with the -858993460 in your case).</p>\n\n<p>Because ptr starts at the address of the first array position, doing <code>ptr++;</code> before printing, you end up printing the value of array position arr[1] first, and printing \"arr[6]\" last (but because your array is only of length 5, \"arr[6]\" is actually something unrelated to your array within your memory)</p>\n\n<p>\"Correct\" code would be:</p>\n\n<pre><code>for (int i = 0; i &lt; 5; i++) {\n    (*ptr) += 2;\n    printf(\"%d\\r\\n\", ptr);\n    ptr++;\n}\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 11796577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2faf9357a8e0a89ad80dd7a9102e24?s=128&d=identicon&r=PG&f=1", "display_name": "jieun", "link": "https://stackoverflow.com/users/11796577/jieun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 57072471, "answer_count": 6, "score": 10, "last_activity_date": 1563359244, "creation_date": 1563354827, "last_edit_date": 1563355110, "question_id": 57072416, "link": "https://stackoverflow.com/questions/57072416/difference-in-printing-out-pointer-value-vs-array", "title": "Difference in printing out pointer value vs array", "body": "<p>I have a question on printing out pointer value and array. </p>\n\n<pre><code>int arr[5] = { 1, 2, 3, 4, 5 };\nint * ptr = arr;\n\nfor (int i = 0; i &lt; 5; i++) {\n    (*ptr) += 2;\n    ptr++;\n    printf(\"%d\", (*ptr));\n}\n</code></pre>\n\n<p>Above is what I typed in first but it didn't work. So I erased the printf line and entered a new code which is this. And it worked. </p>\n\n<pre><code>for (int i = 0; i &lt; 5; i++) {\n    printf(\"%d \", arr[i]);\n}\n</code></pre>\n\n<p>I understand why the second one worked but still don't understand why first one didn't. </p>\n\n<p>Expected output was 3 4 5 6 7 but the actual output of the first code was \n2 3 4 5 -858993460</p>\n"}, {"tags": ["c", "windows", "registry"], "answers": [{"tags": [], "owner": {"reputation": 1239, "user_id": 4452971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/og0oX.png?s=128&g=1", "display_name": "Castorix", "link": "https://stackoverflow.com/users/4452971/castorix"}, "is_accepted": false, "score": 0, "last_activity_date": 1563360687, "creation_date": 1563360687, "answer_id": 57074181, "question_id": 57072413, "link": "https://stackoverflow.com/questions/57072413/creating-a-windows-api-to-add-modify-query-delete-registry-keys-from-command/57074181#57074181", "title": "Creating a Windows API to add, modify, query, delete Registry Keys from command line", "body": "<p>You must parse the command line</p>\n\n<p>One of the methods is with <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-commandlinetoargvw\" rel=\"nofollow noreferrer\">CommandLineToArgvW</a></p>\n\n<p>For example (based on SDK samples) =></p>\n\n<p>includes/libs :</p>\n\n<pre><code>#include &lt;strsafe.h&gt;\n#include &lt;shlwapi.h&gt;\n#pragma comment (lib,\"Shlwapi.lib\")\n</code></pre>\n\n<p>Test code (example for -q (query) and -d (delete) =></p>\n\n<pre><code>BOOL bQuery = FALSE, bDelete = FALSE;\nTCHAR wsParameter[MAX_PATH];\nint nArgs;\nLPWSTR *pszArgs = CommandLineToArgvW(GetCommandLine(), &amp;nArgs);\nif (pszArgs)\n{       \n    for (int iArg = 1; iArg != nArgs; iArg++)\n    {\n        LPTSTR pszArg = pszArgs[iArg];\n        if (!StrCmpNIC(pszArg, TEXT(\"-q\"), 3))\n        {\n            bQuery = TRUE;\n            StringCchCopy(wsParameter, ARRAYSIZE(wsParameter), pszArg + 3);\n            break;\n        }\n        else if (!StrCmpNIC(pszArg, TEXT(\"-d\"), 3))\n        {   \n            bDelete = TRUE;\n            StringCchCopy(wsParameter, ARRAYSIZE(wsParameter), pszArg + 3);\n            break;\n        }\n        // else if ...\n    }\n\n    if (bQuery)\n    {\n        // Query code with wsParameter  \n    }\n    else if (bDelete)\n    {\n        // Delete code with wsParameter \n    }\n    GlobalFree(pszArgs);        \n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9743278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1e786372d3170ae33326244e51caea?s=128&d=identicon&r=PG", "display_name": "dpa76", "link": "https://stackoverflow.com/users/9743278/dpa76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563360687, "creation_date": 1563354817, "last_edit_date": 1563355410, "question_id": 57072413, "link": "https://stackoverflow.com/questions/57072413/creating-a-windows-api-to-add-modify-query-delete-registry-keys-from-command", "title": "Creating a Windows API to add, modify, query, delete Registry Keys from command line", "body": "<p>I am undertaking a task which requires me to query, add(inc values), delete and modify registry keys. The program needs to support all the different types of registry data and most importantly, it needs to use command line arguments, much in the same way that reg.exe does. </p>\n\n<p>A declaration, I am not well-versed in low-level programming languages (ie, I'm a noob); the task is part of a broader non-programming security course however I am keen to build upon what I've done so far and complete the task. I have created 3 individual .c files in Visual Studio which successfully run in debug mode; however, I do not know how to create a single code file which accepts command line arguments. </p>\n\n<p>The code I have created thus far has been pieced together from various posts I have dug up while researching the solution; in addition I've watched a stack of YouTube vids but alas, no progress. I have also dug as deep as I can on Stack Overflow but I have found nothing that helps me to understand how to solve the main issues of</p>\n\n<ol>\n<li>Creating a single .c file which performs all of the required functions, with seperate calls; and </li>\n<li>Creating a call dispatcher to parse the user commands from the command line.</li>\n</ol>\n\n<p>Below I have dropped in the .c file that includes the query, add and modify functions but not the delete function. This can be run from the command line using the .exe file which Visual Studio creates, however it simply runs the code from top to bottom. I am unaware of how to individually call each separate function of the program. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;Windows.h&gt;\n\nint main()\n{\n    LONG lReg;\n    HKEY hKey;\n    DWORD number = 0x00000001;\n    LONG dresult;\n\n    if (RegOpenKeyExW(HKEY_LOCAL_MACHINE, L\"Software\\\\Test2\\\\Product\\\\SmartId\", 0, KEY_SET_VALUE | KEY_WOW64_64KEY, &amp;hKey) == ERROR_SUCCESS)\n        {\n        printf(\"Key location open successful \\n\");\n        dresult = RegDeleteKey(HKEY_LOCAL_MACHINE, L\"Software\\\\Test2\\\\Product\\\\SmartId\");\n        RegCloseKey(hKey);\n        }\n    else \n        {\n        lReg = RegCreateKeyEx(\n        HKEY_LOCAL_MACHINE,\n        L\"Software\\\\Test2\\\\Product\\\\SmartId\",\n        0,\n        NULL,\n        REG_OPTION_NON_VOLATILE,\n        KEY_ALL_ACCESS | KEY_WOW64_64KEY,\n        NULL,\n        &amp;hKey,\n        NULL);\n\n        if (lReg == ERROR_SUCCESS)\n            {\n            printf(\"Key successfully added to registry \\n\");\n            }\n        else \n            {\n            printf(\"Key not added to registry\");\n            }   \n        }\n\n    if (RegSetValueExW(hKey, L\"OEMBackground\", 0, REG_DWORD, (LPBYTE)&amp;number, sizeof(DWORD)) == ERROR_SUCCESS)\n        {\n            printf(\"Key changed in registry \\n\");\n        }\n        else \n        {\n            printf(\"Key not changed in registry \\n\");\n        }\n\n    RegCloseKey(hKey);\n\n    return 0;\n}\n</code></pre>\n\n<p>I expect that the command line input will be something like (for query)</p>\n\n<p>C:\\Windows\\system32>regfunction -q hklm\\software\\test2</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "edited": false, "score": 2, "creation_date": 1563354533, "post_id": 57072319, "comment_id": 100668345, "body": "Read it out loud: &quot;Enter the loop if <code>c</code> is not a star or if <code>d</code> is not a slash.&quot; Is this what you want?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1563354578, "post_id": 57072319, "comment_id": 100668369, "body": "I think it&#39;s time you learn about <a href=\"https://en.wikipedia.org/wiki/De_Morgan&#39;s_laws\" rel=\"nofollow noreferrer\">De Morgan&#39;s laws</a> on how to negate logic."}], "answers": [{"tags": [], "owner": {"reputation": 941, "user_id": 7617604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7f920ede1516b4f8460a1b0e554bc8b?s=128&d=identicon&r=PG&f=1", "display_name": "Burdui", "link": "https://stackoverflow.com/users/7617604/burdui"}, "is_accepted": false, "score": 1, "last_activity_date": 1563356776, "creation_date": 1563356776, "answer_id": 57073014, "question_id": 57072319, "link": "https://stackoverflow.com/questions/57072319/shouldnt-this-loop-stop-when-my-character-is-either-or/57073014#57073014", "title": "shouldn&#39;t this loop stop when my character is either &#39;*&#39; or &#39;/&#39;?", "body": "<blockquote>\n  <p>this function should remove all input until it hits the end of a comment</p>\n</blockquote>\n\n<p>contrasts</p>\n\n<blockquote>\n  <p>i thought it should stop as soon as it meets an * or / in the </p>\n</blockquote>\n\n<p>The latter would require a check afterwards if the comment indeed did end or if it is just a random * or /.</p>\n\n<p>As pointed out it stops if the end of a comment is encountered.\nThe comment ends if it meets an * <strong>and</strong> / thus <code>c == '*' &amp;&amp; d == '/'</code>.\nOn the other hand this means that the loop continues reading until <code>!(c == '*' &amp;&amp; d == '/')</code> which is equivalent to <code>c != '*' || d != '/'</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2202, "user_id": 8911175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2000c44d0ba4a2642e8846064a77ee34?s=128&d=identicon&r=PG&f=1", "display_name": "taurus05", "link": "https://stackoverflow.com/users/8911175/taurus05"}, "edited": false, "score": 1, "creation_date": 1563361646, "post_id": 57073933, "comment_id": 100672202, "body": "awesome explaination!"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 2, "last_activity_date": 1563427840, "last_edit_date": 1563427840, "creation_date": 1563359908, "answer_id": 57073933, "question_id": 57072319, "link": "https://stackoverflow.com/questions/57072319/shouldnt-this-loop-stop-when-my-character-is-either-or/57073933#57073933", "title": "shouldn&#39;t this loop stop when my character is either &#39;*&#39; or &#39;/&#39;?", "body": "<blockquote>\n  <p>i thought it should stop as soon as it meets an * or / in the comment</p>\n</blockquote>\n\n<p>No, it will not stop at the first * or first /</p>\n\n<p>Assume <code>c</code> is <strong>not</strong> a <code>*</code>. Then look at the logical expression:</p>\n\n<pre><code>while(c!='*' || d !='/')\n      ^^^^^^\n       TRUE as we assumed that c is not a *\n</code></pre>\n\n<p>When the first part of the logical expression is TRUE and the operator is <code>||</code> the whole expression will be TRUE regardless of the second part of the logical expression.</p>\n\n<p>So from this we have learned: When <code>c</code> is <strong>not</strong> equal to <code>*</code> the loop will go on.</p>\n\n<p>So now assume that <code>d</code> is <strong>not</strong> a <code>/</code>.</p>\n\n<pre><code>while(c!='*' || d !='/')\n                ^^^^^^\n                TRUE as we assumed that d is not a /\n</code></pre>\n\n<p>Again, as one part of the logical OR-expression (i.e. the second part) is TRUE, the whole expression will be TRUE and the loop will go on.</p>\n\n<p>Now we only miss the case where <code>c</code> is a <code>*</code> and <code>d</code> is a <code>/</code></p>\n\n<pre><code>while(c!='*' || d !='/')\n      ^^^^^^    ^^^^^^\n       FALSE     FALSE as we assumed that d is a /\n         |\n         as we assumed that c is a *\n</code></pre>\n\n<p>So in this case the loop will stop because <code>FALSE || FALSE</code> results in <code>FALSE</code>.</p>\n\n<p>We can write this as as a table:</p>\n\n<pre><code>     c     |     d     | Logical expression\n-------------------------------------------\n   != '*'  | any value |     TRUE\n-------------------------------------------\n any value |   != '/'  |     TRUE\n-------------------------------------------\n   == '*'  |   == '/'  |     FALSE\n</code></pre>\n\n<p>In other words - the loop will stop if and only if <code>c</code> has the value <code>*</code> <strong>and</strong> <code>d</code> has the value <code>/</code></p>\n\n<p>The body of the loop shows us that <code>c</code> always gets the value that <code>d</code> had in the previous loop:</p>\n\n<pre><code>{\n    c =d;            // c is assigned the value that d got in the previous loop\n    d = getchar();   // d is assigned the next character of the input\n}\n</code></pre>\n\n<p>So together <code>c</code> and <code>d</code> form a 2 character sliding window of the input.</p>\n\n<p>As an example consider reading the test string: \"a * is born*/\"</p>\n\n<pre><code>text | c   | d   | comment\n----------------------\n 'a' | 'a' |     | initialization\n ' ' | 'a' | ' ' | initialization\n '*' | ' ' | '*' | loop\n ' ' | '*' | ' ' | loop\n 'i' | ' ' | 'i' | loop\n 's' | 'i' | 's' | loop\n ' ' | 's' | ' ' | loop\n 'b' | ' ' | 'b' | loop\n 'o' | 'b' | 'o' | loop\n 'r' | 'o' | 'r' | loop\n 'n' | 'r' | 'n' | loop\n '*' | 'n' | '*' | loop\n '/' | '*' | '/' | loop (last loop because now c is * AND d is /\n</code></pre>\n\n<p>In other words - the loop will only stop when the text string contains the sequence <code>*/</code> which is indeed the end-of-comment sequence.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11273428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1563427840, "creation_date": 1563354464, "question_id": 57072319, "link": "https://stackoverflow.com/questions/57072319/shouldnt-this-loop-stop-when-my-character-is-either-or", "title": "shouldn&#39;t this loop stop when my character is either &#39;*&#39; or &#39;/&#39;?", "body": "<p>Heloo ,I've been looking over the solution for the 1-23 in K&amp;R C programing book ,and i dont totally understand the incomment function , this function should remove all input until it hits the end of a comment ,because of the <code>||</code> operator i thought it should stop as soon as it meets an * or / in the comment but the function still works how it should ,can someone explain how it really works? </p>\n\n<pre><code>void incomment()\n{\n    int c,d;\n\n    c = getchar();\n    d = getchar();\n\n    while(c!='*' || d !='/')\n    {\n        c =d;\n        d = getchar();\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "function-pointers", "googlemock", "gmock"], "comments": [{"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1563357838, "post_id": 57072085, "comment_id": 100670296, "body": "Looks like you have messed up something with your problem. Unit test should test your code not external code (dll), so thing you are testing looks weird.  I would expect that you have some code which is using dll functionality and for test purposes you are using mock of functionality delivered by that dll. So your code could be tested against scenarios which are hard to reproduce when dll is in use. Please provide more context since looks like you are doing something wrong or misunderstood what are mocks for."}, {"owner": {"reputation": 45, "user_id": 7262963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vc2c6G9umPs/AAAAAAAAAAI/AAAAAAAAA1g/hEsoA1CIF_s/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7262963/daniel"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1563362551, "post_id": 57072085, "comment_id": 100672696, "body": "The goal is to provide a framework to test dllA that has dependencies in dllB that relies on hardware."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1563363588, "post_id": 57072085, "comment_id": 100673216, "body": "Is this your dll?  I mean do you have a code for that dll?"}, {"owner": {"reputation": 45, "user_id": 7262963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vc2c6G9umPs/AAAAAAAAAAI/AAAAAAAAA1g/hEsoA1CIF_s/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7262963/daniel"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1563365698, "post_id": 57072085, "comment_id": 100674319, "body": "No, I don&#39;t have access to the source. I&#39;m only providing a testing framework preferably with mock functionality included."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1563367523, "post_id": 57072085, "comment_id": 100675476, "body": "So what are you testing someone else code? What is the point? The only case I can imagine this has some reason is creating test which will verify that dll functionality didn&#39;t change when you deploy new version of it since you do not trust the vendor. But this is quite unusual case."}, {"owner": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1563367756, "post_id": 57072085, "comment_id": 100675617, "body": "In normal situation you write test for your code and mock everything what is not yours, so external dll libraries and so on. The gain is that mocks can simulate unusual situations which can araise on dependency (dll or other library)."}, {"owner": {"reputation": 45, "user_id": 7262963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vc2c6G9umPs/AAAAAAAAAAI/AAAAAAAAA1g/hEsoA1CIF_s/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7262963/daniel"}, "reply_to_user": {"reputation": 22818, "user_id": 1387438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad806758c356c915ea08a4bfd79131e3?s=128&d=identicon&r=PG", "display_name": "Marek R", "link": "https://stackoverflow.com/users/1387438/marek-r"}, "edited": false, "score": 0, "creation_date": 1563367871, "post_id": 57072085, "comment_id": 100675691, "body": "It is unusual, I definitely agree :)"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7262963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vc2c6G9umPs/AAAAAAAAAAI/AAAAAAAAA1g/hEsoA1CIF_s/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7262963/daniel"}, "edited": false, "score": 0, "creation_date": 1563365770, "post_id": 57072939, "comment_id": 100674352, "body": "I tried your approach but I got <code>undefined reference to `Fixture::mock_` </code> during linking. Not sure why, but I&#39;ll keep on trying."}, {"owner": {"reputation": 768, "user_id": 10765031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19818c272f28b0be58edab2373192e34?s=128&d=identicon&r=PG&f=1", "display_name": "fdan", "link": "https://stackoverflow.com/users/10765031/fdan"}, "reply_to_user": {"reputation": 45, "user_id": 7262963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vc2c6G9umPs/AAAAAAAAAAI/AAAAAAAAA1g/hEsoA1CIF_s/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7262963/daniel"}, "edited": false, "score": 0, "creation_date": 1563367016, "post_id": 57072939, "comment_id": 100675162, "body": "@Daniel the mock is static. static members have to be declared somewhere in your source files. I updated the answer."}, {"owner": {"reputation": 45, "user_id": 7262963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vc2c6G9umPs/AAAAAAAAAAI/AAAAAAAAA1g/hEsoA1CIF_s/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7262963/daniel"}, "edited": false, "score": 0, "creation_date": 1563368726, "post_id": 57072939, "comment_id": 100676289, "body": "Thank you fdan, I should&#39;ve known that error message by now. It works now, just as you suggested! Do you have any recommendation how to apply this procedure to a long list of varying functions?"}, {"owner": {"reputation": 45, "user_id": 7262963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vc2c6G9umPs/AAAAAAAAAAI/AAAAAAAAA1g/hEsoA1CIF_s/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7262963/daniel"}, "edited": false, "score": 0, "creation_date": 1563428341, "post_id": 57072939, "comment_id": 100697887, "body": "This <a href=\"https://stackoverflow.com/a/32274666/7262963\">answer</a> now makes much more sense to me. Though I&#39;m also torn between Gmock and FFF to mock C-functions."}], "tags": [], "owner": {"reputation": 768, "user_id": 10765031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19818c272f28b0be58edab2373192e34?s=128&d=identicon&r=PG&f=1", "display_name": "fdan", "link": "https://stackoverflow.com/users/10765031/fdan"}, "is_accepted": true, "score": 5, "last_activity_date": 1563366960, "last_edit_date": 1563366960, "creation_date": 1563356520, "answer_id": 57072939, "question_id": 57072085, "link": "https://stackoverflow.com/questions/57072085/how-to-assign-gmock-function-to-specific-function-pointer/57072939#57072939", "title": "How to assign gmock function to specific function pointer?", "body": "<p>the easiest solution is to simply declare a static (or free) function that calls the mock. </p>\n\n<pre><code>class Fixture : public ::testing::Test\n{\npublic:\n    static int add(int a, int b)\n    {\n        return mock_.add(a, b);\n    }\n\n    static MockB mock_;\n};\n\nMockB Fixture::mock_; // static declaration somewhere in .cpp\n\nTEST_F(Fixture, MyTest)\n{\n    EXPECT_CALL(mock_, add(_, _));\n    init(Fixture::add, Fixture::add);\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7262963, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Vc2c6G9umPs/AAAAAAAAAAI/AAAAAAAAA1g/hEsoA1CIF_s/photo.jpg?sz=128", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7262963/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1221, "favorite_count": 0, "accepted_answer_id": 57072939, "answer_count": 1, "score": 3, "last_activity_date": 1563368942, "creation_date": 1563353710, "last_edit_date": 1563368942, "question_id": 57072085, "link": "https://stackoverflow.com/questions/57072085/how-to-assign-gmock-function-to-specific-function-pointer", "title": "How to assign gmock function to specific function pointer?", "body": "<p>I'm working on unit testing two dlls with Gtest and Gmock in C++:<br>\nA.dll and B.dll, both are written in C and I cannot modify them.</p>\n\n<p>A.dll's <code>init</code> function uses B.dll's functions as arguments via function pointers. I want to mock B's functions (as they are hardware dependent).</p>\n\n<p>I created a test fixture class for A.dll that dynamically loads the functions <code>init</code> and <code>calc</code>. The following code gives a quick overview of the functions of interest:</p>\n\n<pre><code>class TestFixture : public ::testing::Test {\n    // dynamically loads functions from A.dll and assigns\n    // them to function pointers init_ptr and calc_ptr.\n};\n\n// function pointer typedef for use with B.dll's functions\ntypedef int (*funcPtr)(int, int);\n\n// Loaded from A.dll    \nvoid init(funcPtr func1, funcPtr func2) {\n    // internally set functions in A.dll to be used in calculate\n}\n\n// Loaded from A.dll\nint calculate(int a, int b) {\n    // returns a+b + a+b\n    return func1(func2(a,b), func2(a,b));\n}\n\n// Inside B.dll, should be mocked\nint add(int a, int b) { return a+b; }\n\n// Dummy class for B.dll\nclass B {\n    virtual ~B() {}\n    virtual int add(int a, int b) = 0;    \n};\n\nclass MockB : public B {\nvirtual ~MockB() {}\n    MOCK_METHOD(int, add, (int a, int b));\n};\n\n// Following example test run is the goal:\nTEST_F(TestFixture, AddTest) {\n    MockB b;\n\n    // want to use mocked add function here\n    init_ptr(mockedAdd, mockedAdd);\n\n    EXPECT_CALL(b, add(_,_)).Times(3);\n    EXPECT_EQ(calc_ptr(2,3), 10);\n}\n</code></pre>\n\n<p>When I tried to create a dummy B and a MockB class, I didn't manage to assign the mocked methods to the function pointers that <code>init_ptr(funcPtr, funcPtr)</code> requires. Is there a way to achieve this with Gmock (or a similar framework)?</p>\n"}, {"tags": ["c", "json", "protocol-buffers", "cjson"], "comments": [{"owner": {"reputation": 554, "user_id": 5306039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0b2908132960fc726570b38fe4266?s=128&d=identicon&r=PG&f=1", "display_name": "shubham", "link": "https://stackoverflow.com/users/5306039/shubham"}, "edited": false, "score": 0, "creation_date": 1563359899, "post_id": 57071654, "comment_id": 100671305, "body": "Could you share the example message that you want to convert? You can get rid of those whitespaces using <a href=\"https://github.com/DaveGamble/cJSON#printing-json\" rel=\"nofollow noreferrer\"><code>cJSON_PrintUnformatted</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 10144116, "user_type": "registered", "profile_image": "https://graph.facebook.com/1972002622861942/picture?type=large", "display_name": "Krzysztof Tarnawski", "link": "https://stackoverflow.com/users/10144116/krzysztof-tarnawski"}, "is_accepted": false, "score": 0, "last_activity_date": 1563364518, "creation_date": 1563364518, "answer_id": 57075224, "question_id": 57071654, "link": "https://stackoverflow.com/questions/57071654/how-to-translate-between-cjson-and-protobuf-bytes-variable/57075224#57075224", "title": "How to translate between cJSON and protobuf bytes variable", "body": "<p>I've been struggling with this task for like 2 days and when I posted this topic an light bulb appeared over my head...</p>\n\n<p>so I've changed slightly translating from json to protobuf:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>json = cJSON_PrintUnformatted(args);\nreq-&gt;args.data = json;\nreq-&gt;args.len = strlen(json);\n</code></pre>\n\n<p>then I made something similar from json->protobuf to protobuf->json:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>    args = cJSON_Parse((char*)cvp-&gt;args.data);\n    cJSON_AddItemToObject(json_message, \"rpt\", args);\n\n    if (args) {\n        cJSON_ArrayForEach(arg, args) {\n            key = arg-&gt;string;\n            log_debug(\"PARSER: key = %s\", key);\n            if (key != NULL) {\n                if (cJSON_IsNumber(arg)) {\n                    log_info(\"received argument: %s : (int)%d : (double)%.2f\",\n                            key, arg-&gt;valueint, arg-&gt;valuedouble);\n                    cJSON_AddItemToObject(rpt, key, arg-&gt;valueint);\n                } else if (cJSON_IsString(arg) &amp;&amp; (arg-&gt;valuestring != NULL)) {\n                    log_info(\"received argument: %s : %s\", key,\n                            arg-&gt;valuestring);\n                    cJSON_AddItemToObject(rpt, key, arg-&gt;valuestring);\n                } else {\n                    log_error(\"error while parsing argument's value\");\n                }\n            } else {\n                log_error(\"error while parsing argument\");\n            }\n        }\n    }\n</code></pre>\n\n<p>basically it turned out that I forgot about existence of cJSON_Parse() function ...</p>\n"}], "owner": {"reputation": 5, "user_id": 10144116, "user_type": "registered", "profile_image": "https://graph.facebook.com/1972002622861942/picture?type=large", "display_name": "Krzysztof Tarnawski", "link": "https://stackoverflow.com/users/10144116/krzysztof-tarnawski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563364518, "creation_date": 1563352072, "last_edit_date": 1563360644, "question_id": 57071654, "link": "https://stackoverflow.com/questions/57071654/how-to-translate-between-cjson-and-protobuf-bytes-variable", "title": "How to translate between cJSON and protobuf bytes variable", "body": "<p>I'm using protobuf-c library and a cJSON and I have protobuf message with field\n    bytes args = 1; // Command-specific payload</p>\n\n<p>I'm parsing cJSON to protobuf like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>args = cJSON_GetObjectItemCaseSensitive(command, \"args\");\n    if (args) {\n        cJSON_ArrayForEach(arg, args) {\n            key = arg-&gt;string;\n            log_debug(\"PARSER: key = %s\", key);\n            if (key != NULL) {\n                if (cJSON_IsNumber(arg)) {\n                    log_info(\"received argument: %s : (int)%d : (double)%.2f\",\n                            key, arg-&gt;valueint, arg-&gt;valuedouble);\n                } else if (cJSON_IsString(arg) &amp;&amp; (arg-&gt;valuestring != NULL)) {\n                    log_info(\"received argument: %s : %s\", key,\n                            arg-&gt;valuestring);\n                } else {\n                    log_error(\"error while parsing argument's value\");\n                }\n            } else {\n                log_error(\"error while parsing argument\");\n            }\n        }\n        log_debug(\"PARSER: print = %s\", args);\n        // not sure if it is proper way of adding cJSON object to protobuf's bytes variable\n        req-&gt;args.data = cJSON_Print(args);\n        req-&gt;args.len = strlen(req-&gt;args.data);\n</code></pre>\n\n<p>and then I'm trying to parse it back to cJSON and add to proper message format:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char rpt_char[MAX_RPT_SIZE];\nstrncpy(rpt_char, (char*)cvp-&gt;args.data, cvp-&gt;args.len);\n    cJSON_AddItemToObject(json_message, \"rpt\", rpt = cJSON_CreateObject());\n    cJSON_AddStringToObject(rpt, \"args\", rpt_char);\n</code></pre>\n\n<p>I need to parse message from cJSON to protobuf and then back to cJSON.\nFinal JSON should look like this:</p>\n\n<pre><code>{\n...\nrpt: {\narg1: data, // don't know actual names of key strings and values\narg2: data\n},\n...\n}\n</code></pre>\n\n<p>but what I get is:</p>\n\n<pre><code>{\n...\n\"rpt\":  {\n           \"args\": \"{\\n\\t\\\"arg1\\\":\\t38,\\n\\t\\\"arg2\\\":\\t\\\"Taylor Norman\\\"\\n}[\\u0002\\u00106[\\u0002\\u0010\ufffd[\\u0002\\u0010\ufffd[\\u0002\\u0010\ufffd\u020d\\u0003\\u0001\ufffd[\\u0002\\u0010\ufffd\u020d\\u0006\"\n        },\n...\n}\n</code></pre>\n\n<p>edit.\nexample message generated by some random generator:</p>\n\n<pre><code>{\"cmd\":0,\"t\":963205,\"xi\":\"5d2c8cb34888fc8471991545\",\"args\":{\"arg1\":38,\"arg2\":\"Taylor Norman\"},\"kid\":\"5d2c8cb3329f9599e4730b6a\",\"sig\":\"5d2c8cb33949d35fb22d0cb3\"}\n</code></pre>\n"}, {"tags": ["c", "cortex-m"], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 6, "last_activity_date": 1563349843, "creation_date": 1563349843, "answer_id": 57070989, "question_id": 57070949, "link": "https://stackoverflow.com/questions/57070949/what-does-the-following-call-mean-in-c/57070989#57070989", "title": "what does the following call mean in C?", "body": "<p>This statement does not do anything logically.</p>\n\n<p>It is sometimes added to avoid warnings in compilers and Static Analysers for unused variables</p>\n"}, {"tags": [], "owner": {"reputation": 3796, "user_id": 4661625, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c3cd0caf54e0766c83f04f51f881303b?s=128&d=identicon&r=PG&f=1", "display_name": "Bumsik Kim", "link": "https://stackoverflow.com/users/4661625/bumsik-kim"}, "is_accepted": false, "score": 4, "last_activity_date": 1563350910, "last_edit_date": 1563350910, "creation_date": 1563349954, "answer_id": 57071023, "question_id": 57070949, "link": "https://stackoverflow.com/questions/57070949/what-does-the-following-call-mean-in-c/57071023#57071023", "title": "what does the following call mean in C?", "body": "<p><code>(void) variable;</code> is usually used to avoid unused variable warnings.</p>\n\n<p>It doesn't do anything but the SDK dev might left it there for future use.</p>\n"}], "owner": {"reputation": 583, "user_id": 4912037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8ad5a96e60d4a5086e0c5b3cfb19ce?s=128&d=identicon&r=PG&f=1", "display_name": "yashC", "link": "https://stackoverflow.com/users/4912037/yashc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "closed_date": 1563354050, "accepted_answer_id": 57070989, "answer_count": 2, "score": 4, "last_activity_date": 1563350910, "creation_date": 1563349690, "question_id": 57070949, "link": "https://stackoverflow.com/questions/57070949/what-does-the-following-call-mean-in-c", "closed_reason": "Duplicate", "title": "what does the following call mean in C?", "body": "<p>I am exploring an sdk and I came across the following set of statements.</p>\n\n<pre><code>uint32_t init_time = 0;\ninit_time = get_current_time_in_ms();\n(void)init_time; // What does this statement do?\n</code></pre>\n\n<p>My first thought was that this is a NULL check of some sorts but I tried zero and non-zero value in a test C code doing something similar but response in both case was the same.</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["c", "pointers", "c11"], "comments": [{"owner": {"reputation": 1605, "user_id": 11723965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ygAu.jpg?s=128&g=1", "display_name": "nivpeled", "link": "https://stackoverflow.com/users/11723965/nivpeled"}, "edited": false, "score": 0, "creation_date": 1563348071, "post_id": 57070494, "comment_id": 100664904, "body": "I think that <i>refer</i> here (in 6.2.7 Compatible type and composite type) means deference or access the object the pointer points to."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1563348414, "post_id": 57070494, "comment_id": 100665104, "body": "Those are three declaration of three separate objects. &quot;Refer&quot; here does not mean &quot;holds the address of another object&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1563348345, "creation_date": 1563348345, "answer_id": 57070607, "question_id": 57070494, "link": "https://stackoverflow.com/questions/57070494/void-pointer-compatibility-with-other-pointer-types/57070607#57070607", "title": "Void pointer compatibility with other pointer types", "body": "<p>Keyword: <em>All <strong>declarations</strong> ...</em></p>\n\n<pre><code>int x = 5;\nint *xp = &amp;x;\nvoid *vp = xp;\n</code></pre>\n\n<p>These are three declarations, declaring three separate objects: <code>x</code>, <code>xp</code>, and <code>vp</code>.</p>\n\n<p>What the section you quoted means is that if one file says</p>\n\n<pre><code>extern int foo;\n</code></pre>\n\n<p>and another file says</p>\n\n<pre><code>extern double *foo;\n</code></pre>\n\n<p>the behavior is undefined because <code>foo</code> has been declared twice, with different types.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1563544112, "creation_date": 1563544112, "answer_id": 57113884, "question_id": 57070494, "link": "https://stackoverflow.com/questions/57070494/void-pointer-compatibility-with-other-pointer-types/57113884#57113884", "title": "Void pointer compatibility with other pointer types", "body": "<blockquote>\n  <p>Q: Yet, as far as I can see, that section does not say <code>void*</code> is compatible with other pointer types /--/\n  ...perfectly valid by tradition and 6.3.2.3, but would seem to be undefined behavior by 6.2.7.</p>\n</blockquote>\n\n<p>6.2.7 doesn't say much but points at further reading at 6.7.6.1 pointer declarations, where we can find the relevant part:</p>\n\n<blockquote>\n  <p>For two pointer types to be compatible, both shall be identically qualified and both shall be pointers to compatible types.</p>\n</blockquote>\n\n<p>So no, <code>void*</code> isn't a compatible type with for example <code>int*</code>, because <code>void</code> isn't compatible with <code>int</code>. They may <em>point</em> at compatible types though, and you may <em>convert</em> freely between them.</p>\n\n<p>The code you posted is fine, because it only relates to the pointed-at types. An example of undefined behavior because of non-compatible pointer types would rather be this:</p>\n\n<pre><code>void* v;\nint* p = *(int**)&amp;v;\n</code></pre>\n\n<p>Here the address of the pointer itself is forcibly converted to a non-compatible type. It is actually of type <code>void**</code> but the programmer tells the compiler to treat is as <code>int**</code>, then read the contents as if it was <code>int*</code>. Formally we read the object through a \"lvalue access\" of a type not compatible with the object being stored at that location.</p>\n\n<p>In practice though, since <code>void*</code> must be converted to/from other object pointer types without losing information, it almost certainly has the same size and representation as object pointers. The C standard does not guarantee that though, so formally threating it as another type is undefined behavior.</p>\n\n<p>This is related to the C concept of <em>effective type</em> of an object and <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing</a>.</p>\n"}], "owner": {"reputation": 25603, "user_id": 45843, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/55f76441107f14055f95e08bb7bd01df?s=128&d=identicon&r=PG&f=1", "display_name": "rwallace", "link": "https://stackoverflow.com/users/45843/rwallace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 57070607, "answer_count": 2, "score": 0, "last_activity_date": 1563544112, "creation_date": 1563347878, "question_id": 57070494, "link": "https://stackoverflow.com/questions/57070494/void-pointer-compatibility-with-other-pointer-types", "title": "Void pointer compatibility with other pointer types", "body": "<p>It is a familiar feature of C that a <code>void*</code> can be assigned to or from any pointer variable. In N1570, the draft standard document for C11, this is specified in <code>6.3.2.3 Pointers</code>:</p>\n\n<blockquote>\n  <p>A pointer to void may be converted to or from a pointer to any object type. A pointer to any object type may be converted to a pointer to void and back again; the result shall compare equal to the original pointer.</p>\n</blockquote>\n\n<p>But <code>6.2.7 Compatible type and composite type</code> says</p>\n\n<blockquote>\n  <p>All declarations that refer to the same object or function shall have compatible type; otherwise, the behavior is undefined.</p>\n</blockquote>\n\n<p>Yet, as far as I can see, that section does <em>not</em> say <code>void*</code> is compatible with other pointer types. So:</p>\n\n<pre><code>int x = 5;\nint *xp = &amp;x;\nvoid *vp = xp;\n</code></pre>\n\n<p>is expected to be perfectly valid by tradition and <code>6.3.2.3</code>, but would seem to be undefined behavior by <code>6.2.7</code>.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["c", "pipe"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563346426, "post_id": 57069576, "comment_id": 100664024, "body": "Error messages should be printed to <code>stderr</code> (standard error), not to <code>stdout</code>.  Use <code>fprintf(stderr,</code> in place of <code>printf(</code>."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1563348081, "post_id": 57069576, "comment_id": 100664910, "body": "You really should be checking the return values of functions like <code>read()</code> and <code>write()</code>..."}, {"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1563349853, "post_id": 57069576, "comment_id": 100665863, "body": "@Shawn if by checking the return values, you mean ensuring a <code>-1</code> wasn&#39;t returned due to SIGINT or some error, the above code snippets are minimal verifiable examples to demonstrate the error I&#39;m seeing, as per StackOverflow guidelines[1].  Adding error-handling wouldn&#39;t have helped me illustrate my point.  [1]<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1563350731, "post_id": 57069576, "comment_id": 100666311, "body": "Error checking would (hopefully; always hard to be sure with undefined behavior like using uninitialized values) indicate an issue -- with <code>EBADF</code> unless you get unlucky."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1563351408, "post_id": 57069576, "comment_id": 100666678, "body": "As a case in point about being unlucky, on my test system, <code>my_array[0]</code> ends up getting initialized to 0, which is the descriptor used for standard input. Apparently writing to standard input works on my system (Though I get different output from you). It might not for someone with a different OS, though. And in this case, the parent process is blocking waiting for the user to type something and hit enter so it can be read (There&#39;s more undefined behavior if you do that because you try to print a char array that&#39;s not always 0-terminated, much less at the right spot...)"}, {"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1563424824, "post_id": 57069576, "comment_id": 100696904, "body": "That&#39;s exactly what was happening on my side- standard input was waiting for input.  That&#39;s what the lag was- when I typed in <code>Foo</code> I saw <code>Foo\\nBuf: Foo</code>.  Ugh... well at least I know what was causing my process to hang!  Thanks @Shawn."}], "answers": [{"comments": [{"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563344638, "post_id": 57069650, "comment_id": 100663236, "body": "Sure, but to use a similar metaphor, why can&#39;t a length-of-one array be used as a &quot;bucket&quot;, filling it up (writing to it) with the child process and emptying it out (reading from it) with the parent?"}, {"owner": {"reputation": 1605, "user_id": 11723965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ygAu.jpg?s=128&g=1", "display_name": "nivpeled", "link": "https://stackoverflow.com/users/11723965/nivpeled"}, "edited": false, "score": 1, "creation_date": 1563344959, "post_id": 57069650, "comment_id": 100663342, "body": "the array does not hold just a simple meaningless integer. this int is a file descriptor. the OS maintains a llist of file descriptor and associates them with objects (pipe in this example). you read or write using the wrong fd, and the behavior is undefined."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563345554, "post_id": 57069650, "comment_id": 100663583, "body": "@RichieThomas It could be, but then it wouldn&#39;t be a <i>pipe</i>... ;)"}, {"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563347346, "post_id": 57069650, "comment_id": 100664479, "body": "@Someprogrammerdude I think I&#39;ve over-emphasized my interest in <code>pipe()</code>.  I&#39;ve edited the question title to clarify my intent.  My goal to figure out why the 2nd example (without <code>pipe()</code>) was hanging, which I think I&#39;ve accomplished.  Moreover, I&#39;m unsure what the use case of pipes really are, assuming one could get the 2nd example to work (perhaps using different system calls or data structures).  What do pipes give us that a working version of the 2nd example does not?  Or is such a version not possible?"}, {"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563349214, "post_id": 57069650, "comment_id": 100665536, "body": "To put it another way, if (and I know it&#39;s a big if) I can achieve the same result with a length-of-one &quot;bucket&quot; as I can with a length-of-two &quot;pipe&quot;, what advantage does the pipe have?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563350319, "post_id": 57069650, "comment_id": 100666095, "body": "@RichieThomas The advantage of pipes over &quot;buckets&quot; is that pipes exists as an IPC primitive, while buckets does not. There simply isn&#39;t a &quot;bucket&quot; type communication primitive in the POSIX standard."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 1, "last_activity_date": 1563344659, "last_edit_date": 1563344659, "creation_date": 1563344540, "answer_id": 57069650, "question_id": 57069576, "link": "https://stackoverflow.com/questions/57069576/with-vs-without-the-c-pipe-function-whats-causing-this-behavior/57069650#57069650", "title": "With vs without the C pipe() function- what&#39;s causing this behavior?", "body": "<p>A pipe, on computers as well as in real life, have <em>two</em> ends. And like pipes in real life, data flows from one end of the pipe (the write end) to the other (the read end).</p>\n\n<p>The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pipe.html\" rel=\"nofollow noreferrer\"><code>pipe</code></a> function gives you those two ends by writing them to an array of two file-descriptors. The first element of the pair is read-only, and the second is write-only.</p>\n"}, {"comments": [{"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563344996, "post_id": 57069722, "comment_id": 100663362, "body": "<code>Calling pipe() with other argument type (int array[1] in your case) results in undefined behavior,...</code>  But I didn&#39;t call pipe() with array[1] in the 2nd code example.  In fact, I didn&#39;t call pipe() at all in that example.  That was the point of example 2- I was trying to avoid using that function call."}, {"owner": {"reputation": 1605, "user_id": 11723965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ygAu.jpg?s=128&g=1", "display_name": "nivpeled", "link": "https://stackoverflow.com/users/11723965/nivpeled"}, "reply_to_user": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563345323, "post_id": 57069722, "comment_id": 100663491, "body": "sorry i missed that. so you are not creating the pipe at all! and using write and read function on uninitialzied file descriptor. this is still &quot;undefined behavior&quot;."}, {"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563346154, "post_id": 57069722, "comment_id": 100663867, "body": "Can you be more specific about how the undefined behavior causes the hanging process?  According to the script&#39;s output, we know the write / read operations are succeeding since the contents of <code>buf</code> (which originated from <code>mypipefd</code>) are logged to the screen in example 2.  So I would think that the only thing left for the process to do is terminate."}, {"owner": {"reputation": 1605, "user_id": 11723965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ygAu.jpg?s=128&g=1", "display_name": "nivpeled", "link": "https://stackoverflow.com/users/11723965/nivpeled"}, "reply_to_user": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563346266, "post_id": 57069722, "comment_id": 100663929, "body": "the functionality works correctly only by chance; probabaly some other side effects happen such as process TCB get corrupted which cause the OS to not be able to kill the process."}, {"owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563346510, "post_id": 57069722, "comment_id": 100664060, "body": "<code>probabaly some other side effects happen such as process TCB get corrupted which cause the OS to not be able to kill the process.</code>  Any thoughts on how I could test or verify this hypothesis?  My goal is to have a definitive answer to why the process is hanging, if only to post here for the benefit of other people with similar questions."}, {"owner": {"reputation": 1605, "user_id": 11723965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ygAu.jpg?s=128&g=1", "display_name": "nivpeled", "link": "https://stackoverflow.com/users/11723965/nivpeled"}, "reply_to_user": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "edited": false, "score": 0, "creation_date": 1563346592, "post_id": 57069722, "comment_id": 100664084, "body": "assuming you run on Linux, I would use strace. <a href=\"https://linux.die.net/man/1/strace\" rel=\"nofollow noreferrer\">linux.die.net/man/1/strace</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1563346686, "post_id": 57069722, "comment_id": 100664129, "body": "I like the quote.  I usually use &quot;your boss, your boss&#39;s boss, and your boss&#39;s boss&#39;s boss&quot; as the delighted audience."}], "tags": [], "owner": {"reputation": 1605, "user_id": 11723965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ygAu.jpg?s=128&g=1", "display_name": "nivpeled", "link": "https://stackoverflow.com/users/11723965/nivpeled"}, "is_accepted": false, "score": 1, "last_activity_date": 1563346632, "last_edit_date": 1563346632, "creation_date": 1563344854, "answer_id": 57069722, "question_id": 57069576, "link": "https://stackoverflow.com/questions/57069576/with-vs-without-the-c-pipe-function-whats-causing-this-behavior/57069722#57069722", "title": "With vs without the C pipe() function- what&#39;s causing this behavior?", "body": "<p>The pipe() function accepts an array of <em>2</em> integer as an input argument.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\nint pipe(int pipefd[2]);\n#define _GNU_SOURCE             /* See feature_test_macros(7) */\n#include &lt;fcntl.h&gt;              /* Obtain O_* constant definitions */\n#include &lt;unistd.h&gt;\nint pipe2(int pipefd[2], int flags);\n</code></pre>\n\n<p>It then generates a new pipe object, and initializes the pipefd array with file descriptors for read and write operation.</p>\n\n<p>What you try to do is call read() and write() using some arbitrary, uninitialized ints (or file descriptor). Meaning the OS did not allocate a pipe object and did not provide you with file descriptors (the pipe's API) to be use with read() and write().</p>\n\n<p>This (calling read() or write() with uninitialized file descriptor) will result in \"undefined behavior\".</p>\n\n<blockquote>\n  <p>\"I find that a good working definition of \"undefined behaviur\" is \"works for me, works for you, works during development and QA, but blows up in your most important customer's face\"\" --- Scott Meyers</p>\n</blockquote>\n"}], "owner": {"reputation": 2267, "user_id": 2143275, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMJGg.png?s=128&g=1", "display_name": "Richie Thomas", "link": "https://stackoverflow.com/users/2143275/richie-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 57069650, "answer_count": 2, "score": 1, "last_activity_date": 1563346856, "creation_date": 1563344162, "last_edit_date": 1563346856, "question_id": 57069576, "link": "https://stackoverflow.com/questions/57069576/with-vs-without-the-c-pipe-function-whats-causing-this-behavior", "title": "With vs without the C pipe() function- what&#39;s causing this behavior?", "body": "<p>I wrote a simple script (taken from a tutorial) which writes data to one end of a pipe in a child process, and reads it from the other end of the pipe in the parent process:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n  pid_t pid;\n  int mypipefd[2];\n  int ret;\n  char buf[20];\n\n  ret = pipe(mypipefd);\n\n  if (ret == -1) {\n    printf(\"Pipe failed.\\n\");\n    exit(1);\n  }\n\n  if ((pid = fork()) == -1) {\n    printf(\"Fork failed.\\n\");\n    exit(1);\n  } else if (pid == 0) {\n    printf(\"Child process.\\n\");\n    char msg[] = \"Hello there!\";\n    write(mypipefd[1], msg, strlen(msg) + 1); \n  } else {\n    printf(\"Parent process.\\n\");\n    read(mypipefd[0], buf, 15);\n    printf(\"Buf: %s\\n\", buf);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>This works fine and outputs the results I expect:</p>\n\n<pre><code>Parent process.\nChild process.\nBuf: Hello there!\n[ project ] $\n</code></pre>\n\n<p>Then as I got more familiar with the code, I wondered why we need to use <code>mypipefd[2]</code> and <code>pipe()</code> to achieve this goal, or whether <code>mypipefd[1]</code> by itself would work.  So I tried it out with the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n  pid_t pid;\n  int my_array[1];\n  char buf[20];\n\n  if ((pid = fork()) == -1) {\n    printf(\"Fork failed.\\n\");\n    exit(1);\n  } else if (pid == 0) {\n    printf(\"Child process.\\n\");\n    char msg[] = \"Hello there!\\n\";\n    write(my_array[0], msg, strlen(msg) + 1); \n  } else {\n    // wait(NULL);\n    printf(\"Parent process.\\n\");\n    read(my_array[0], buf, 15);\n    printf(\"Buf: %s\\n\", buf);\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>This code outputs the same text, but it hangs after it finishes printing.</p>\n\n<pre><code>Parent process.\nChild process.\nBuf: Hello there!\n</code></pre>\n\n<p>No prompt, this time.  I even tried un-commenting that call to <code>wait(NULL)</code>, on the off-chance that the root cause was a conflict between parent and child processes.  No such luck.</p>\n\n<p>What's going on here?  Why am I unable to read and write to a length-of-one array in this way without the program hanging?  What exactly is the compiler stuck on?</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "coredump"], "comments": [{"owner": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "edited": false, "score": 1, "creation_date": 1563343363, "post_id": 57069392, "comment_id": 100662767, "body": "Why you are using an array of <code>int</code> pointers when your intention is just to set <code>int</code>-s?"}], "answers": [{"comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1563344100, "post_id": 57069445, "comment_id": 100663036, "body": "Nitpick: &quot;...undefined pointer equals i&quot; is not correct. The pointer is defined and the pointer value is NULL (due to <code>arr</code> being a global variable)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563345907, "post_id": 57069445, "comment_id": 100663745, "body": "The assignments are perfectly kosher in the second case; it is using the result of the assignments after the function that does the assigning exits that leads to UB.  If the single pointer initialized in Variant B was used to print the data in the <code>setArr()</code> function, or in a function it called, there&#39;d be no problem.  This is, however, nitpicking \u2014 in the code shown, the end result is UB in the printing code."}], "tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 1, "last_activity_date": 1563343482, "creation_date": 1563343482, "answer_id": 57069445, "question_id": 57069392, "link": "https://stackoverflow.com/questions/57069392/reason-for-segmentation-fault-vs-returning-random-values-with-the-following-c-co/57069445#57069445", "title": "Reason for Segmentation fault vs returning random values with the following C code", "body": "<p>Version A says \"the contents of an undefined pointer equals i\" - undefined behavior = crash. Basically you are trying to write to some unknown location in memory.</p>\n\n<p>Version B says \"Some pointer = some address\" - still undefined behavior as <code>&amp;i</code> goes out of scope, but it is still an address and so it \"kind of works\". Here you are writing to \"good\" memory locations, but reading from bad ones.</p>\n"}, {"tags": [], "owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "is_accepted": true, "score": 5, "last_activity_date": 1563344189, "last_edit_date": 1563344189, "creation_date": 1563343773, "answer_id": 57069506, "question_id": 57069392, "link": "https://stackoverflow.com/questions/57069392/reason-for-segmentation-fault-vs-returning-random-values-with-the-following-c-co/57069506#57069506", "title": "Reason for Segmentation fault vs returning random values with the following C code", "body": "<p>You are hitting a lot of undefined behavior scenarios, but I will explain what is likely happening.</p>\n\n<p><code>arr</code> is an array of 10 pointers to integers.</p>\n\n<pre><code>int * arr[10]; // array of 10 int pointers\n</code></pre>\n\n<p>And when declared as a global variable, all of those pointers are going to be zero-initialized - so hence, it's an array of 10 <strong>NULL</strong> pointers.</p>\n\n<p>So this line in version A, is dereferencing the address at <code>arr[index]</code>:</p>\n\n<pre><code>* arr[index] = i;\n</code></pre>\n\n<p>Is effectively saying this:</p>\n\n<pre><code>*(NULL) = i;\n</code></pre>\n\n<p>And that will certainly crash consistently.</p>\n\n<p>In Version B, you have it as:</p>\n\n<pre><code>    int i = v;\n    arr[index] = &amp;i;\n</code></pre>\n\n<p>So now you are correctly assigning a pointer to a slot in the array.  However that address getting assigned is to a local stack variable, <code>i</code>, which goes out of scope as soon as the function returns.  So when you print the value at that address, it's most certainly been clobbered from other calls writing on top of the stack. (Or technically this \"undefined behavior\" of accessing a memory address of a stack variable that has gone out of scope.)</p>\n\n<p>Better:</p>\n\n<pre><code>void setArr (int index, int v){\n    arr[index] = malloc(sizeof(int));\n    *arr[index] = v;\n}\n</code></pre>\n\n<p>The above allocates memory for the address that you want to copy that value into.  You're on your own for how to free that memory.</p>\n\n<p>Alternatively:</p>\n\n<p>Just declare <code>arr</code> as an array of integers instead of pointers:</p>\n\n<pre><code>int arr[10];\nvoid setArr (int index, int v){\n    arr[index] = v;\n}\n</code></pre>\n\n<p>And then print normally without the <code>*</code> deference thing on <code>arr</code>.</p>\n\n<pre><code>printf(\"arr[%d]: %d\\n\", i, arr[i]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 11411242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9ddc629b6b59e7098920303f34d0d4d?s=128&d=identicon&r=PG&f=1", "display_name": "Workarea", "link": "https://stackoverflow.com/users/11411242/workarea"}, "is_accepted": false, "score": -1, "last_activity_date": 1563344522, "last_edit_date": 1563344522, "creation_date": 1563344183, "answer_id": 57069584, "question_id": 57069392, "link": "https://stackoverflow.com/questions/57069392/reason-for-segmentation-fault-vs-returning-random-values-with-the-following-c-co/57069584#57069584", "title": "Reason for Segmentation fault vs returning random values with the following C code", "body": "<p>in first case, you have defined the \"array of pointers\" to integer. They are not integer pointers. Either you will have to allocate memory (preferably using melloc/calloc functions) before storing any value to them OR you can define the array of integer like this:\n<code>int (*a)[10]</code></p>\n\n<p>The following link may show you some idea about it: <a href=\"https://stackoverflow.com/questions/13910749/difference-between-ptr10-and-ptr10\">Difference between *ptr[10] and (*ptr)[10]</a></p>\n\n<p>In second case, you are saving the address of integer into integer pointer, which is ok, but <code>int i</code> is local variable to function <code>setArr()</code>. This will therefore, the value of <code>int i</code> will be dereferenced every time the function <code>setArr()</code> exits. Therefore you are getting undefined behavior for 2nd case. Either you can use <code>static int i</code> OR use global variable (not preferred) OR use pointer to integer assignment.</p>\n"}], "owner": {"reputation": 21, "user_id": 11795620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e24dbb39d2354061181d5d7008ee085?s=128&d=identicon&r=PG&f=1", "display_name": "Janick C.", "link": "https://stackoverflow.com/users/11795620/janick-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 57069506, "answer_count": 3, "score": 1, "last_activity_date": 1563344583, "creation_date": 1563343202, "last_edit_date": 1563344583, "question_id": 57069392, "link": "https://stackoverflow.com/questions/57069392/reason-for-segmentation-fault-vs-returning-random-values-with-the-following-c-co", "title": "Reason for Segmentation fault vs returning random values with the following C code", "body": "<p>Please explain (reason for the output) what happens as a result of running the two segments of code. Please explain their difference too. There are two versions of <code>setArr(int, int)</code> as explained below...</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nvoid setArr(int, int);\n\nint *arr[10]; // array of 10 int pointers\n\nint main(int argc, char *argv[]) {\n    int i;\n\n    setArr(0, 0);\n    setArr(1, 100);\n    setArr(2, 200);\n    setArr(3, 300);\n    setArr(4, 400);\n\n    for (i = 0; i &lt; 5; i++) \n        printf(\"arr[%d]: %d\\n\", i, *arr[i]);   /* should be 0,100, 200,300,400 */\n\n    return 0;\n}\n</code></pre>\n\n<p>Versions of <code>setArr</code></p>\n\n<p><strong>Version A</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void setArr(int index, int v) {\n    int i = v; \n    *arr[index] = i;\n}\n</code></pre>\n\n<p><strong>Output:</strong> <code>Segmentation fault (core dumped)</code></p>\n\n<p><strong>Version B</strong></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void setArr(int index, int v) {\n    int i = v;\n    arr[index] = &amp;i;\n}\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre>\narr[0]: 400\narr[1]: 32748\narr[2]: 32748\narr[3]: 32748\narr[4]: 32748\n</pre>\n\n<p>I presume the values from running Version B are just random values.</p>\n\n<p>I am fairly new to pointers I have knowledge in Java, so please explain it as beginner friendly as you can :) </p>\n"}, {"tags": ["c", "structure", "file-handling", "data-files"], "comments": [{"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1563343021, "post_id": 57069236, "comment_id": 100662653, "body": "Are you sure the RECORD macro or variable is not referring to a different file other than CustomerRecord.dat?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1563343875, "post_id": 57069236, "comment_id": 100662941, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\" title=\"why is while feoffile always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1563343886, "post_id": 57069236, "comment_id": 100662944, "body": "You must do a seek-like operation each change from reading to writing (and you do one), but also between each change from writing to reading (which you do not do).  The standard requires that.  You also do not error check any of the file operations, but you should, especially when anything is going wrong (but you should anyway)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1563344272, "post_id": 57069236, "comment_id": 100663106, "body": "The negation of a <code>size_t</code> value (such as <code>-sizeof(Customer)</code>) is probably not a negative number; it is not clear where the <code>fseek()</code> is moving the current position.  You don&#39;t show what diagnostic printing you&#39;ve added \u2014 such as printing the record that is read.  That&#39;s a most basic debugging operation.  If you don&#39;t get sensible input, you know you&#39;ve got a problem."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1563344582, "post_id": 57069236, "comment_id": 100663213, "body": "Of your three alternatives, (3) is closest.  It would be reasonable to use <code>while (fread(&amp;x, sizeof(Customer), 1, fp) == 1)</code> as the loop test.  (Incidentally, the second seek operation mention previously can be as simple as <code>fseek(fp, 0, SEEK_CUR);</code>.)"}, {"owner": {"reputation": 71, "user_id": 9971619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RiQ6zFQ3bOM/AAAAAAAAAAI/AAAAAAAAAEs/YYR2uH_9LU8/photo.jpg?sz=128", "display_name": "Kalpadiptya Roy", "link": "https://stackoverflow.com/users/9971619/kalpadiptya-roy"}, "reply_to_user": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 0, "creation_date": 1563351809, "post_id": 57069236, "comment_id": 100666877, "body": "@BlueStrat Yes I have defined  RECORD by #define as CustomerRecord.dat"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 9971619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RiQ6zFQ3bOM/AAAAAAAAAAI/AAAAAAAAAEs/YYR2uH_9LU8/photo.jpg?sz=128", "display_name": "Kalpadiptya Roy", "link": "https://stackoverflow.com/users/9971619/kalpadiptya-roy"}, "edited": false, "score": 0, "creation_date": 1563353661, "post_id": 57070653, "comment_id": 100667841, "body": "Does the fseeko() and ftello() functions also clears the end-of-file indicator?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1563354465, "post_id": 57070653, "comment_id": 100668297, "body": "Please read the documentation. <a href=\"http://man7.org/linux/man-pages/man3/fseeko.3.html\" rel=\"nofollow noreferrer\">man fseeko</a>  <code>The fseeko() and ftello() functions are identical to fseek(3) and        ftell(3) (see fseek(3)), respectively, except that the offset        argument of fseeko() and the return value of ftello() is of type        off_t instead of long.</code>"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 71, "user_id": 9971619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RiQ6zFQ3bOM/AAAAAAAAAAI/AAAAAAAAAEs/YYR2uH_9LU8/photo.jpg?sz=128", "display_name": "Kalpadiptya Roy", "link": "https://stackoverflow.com/users/9971619/kalpadiptya-roy"}, "edited": false, "score": 0, "creation_date": 1563396290, "post_id": 57070653, "comment_id": 100690756, "body": "@kalpadiptya: you seem to think that resetting eof is somehow a defect or oddity of fseek, which means that you&#39;re not yet thinking clearly about the meaning of the EOF indicator. You should reread the last paragraph in my answer until you understand why checking <code>eof()</code> at the beginning of  a loop is almost certainly wrong. If you fseek a stream, then it is no longer positioned at the end (probably) so it would be incorrect to indicate that it was. But that&#39;s not what eof() is used for. ..."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1563396412, "post_id": 57070653, "comment_id": 100690795, "body": "Eof() is used immediately after some input function reports &quot;error or no more data&quot; (like <code>fread</code> returning 0) in order to distinguish between those two cases. Obviously (I would have thought), you need to check this condition before attempting to use the data read because if the error or EOF occurs, <i>*there is no data</i>&quot;."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 2, "last_activity_date": 1563349602, "last_edit_date": 1563349602, "creation_date": 1563348545, "answer_id": 57070653, "question_id": 57069236, "link": "https://stackoverflow.com/questions/57069236/why-the-fread-function-is-not-reaching-the-end-of-file-and-the-loop-continues/57070653#57070653", "title": "Why the fread() function is not reaching the end-of-file and the loop continues infinitely, while reading structures from a file?", "body": "<p>You definitely don't want your loop to test <code>feof(fp)</code> -- indeed, that is <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\">practically never right</a> -- because <code>feof(fp)</code> will always be false at the end if the loop, so the loop will never end. Why? The <code>fseek</code> manpage spells it out:</p>\n\n<blockquote>\n  <p>A successful call to the <code>fseek()</code> function clears the end-of-file indicator for the stream.</p>\n</blockquote>\n\n<p>Anyway, if you think about it, you want to terminate the loop exactly when <code>fread</code> reports that it got no data. You certainly don't want to process the non-existent data that <code>fread</code> didn't read. So testing whether there was an EOF after you handle the possibly unread data can't be right, even if <code>feof(fp)</code> actually returned a useful value. </p>\n\n<hr>\n\n<p>A couple of other notes:</p>\n\n<ol>\n<li><p>You're better off using <code>ftell</code> to recall the read cursor before the <code>read</code>, and then <code>fseek</code>ing to the saved point. That avoids a bunch of corner cases, and is easily upgraded to use the more general <code>fseeko/ftello</code> functions, which work properly with large files. (Or you could just go directly to using <code>fseeko</code> and <code>ftello</code>.</p></li>\n<li><p>Think about what you want to do if the last <code>read</code> is partial. Of course, that \"can't happen\" if you always create fixed-length records. But everything that \"can't happen\" eventually does, for one reason or another. Best to deal with it.</p></li>\n</ol>\n"}], "owner": {"reputation": 71, "user_id": 9971619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RiQ6zFQ3bOM/AAAAAAAAAAI/AAAAAAAAAEs/YYR2uH_9LU8/photo.jpg?sz=128", "display_name": "Kalpadiptya Roy", "link": "https://stackoverflow.com/users/9971619/kalpadiptya-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 1, "accepted_answer_id": 57070653, "answer_count": 1, "score": 1, "last_activity_date": 1563353897, "creation_date": 1563342432, "last_edit_date": 1563353897, "question_id": 57069236, "link": "https://stackoverflow.com/questions/57069236/why-the-fread-function-is-not-reaching-the-end-of-file-and-the-loop-continues", "title": "Why the fread() function is not reaching the end-of-file and the loop continues infinitely, while reading structures from a file?", "body": "<p>The code snippet given below is a part of my Customer Billing System Project which I'm writing in C. Here I'm taking input of the Customer Data in a Customer structure and saving the entire structure in \"CustomerRecord.dat\" file using the writefile() function as defined in my code. After successfully writing the Customer data in my file, I'm trying to traverse the file and assign Customer numbers to each record. For doing this I'm using the setCustomerNo() funtion as defined in my code. </p>\n\n<p>The problem is the while loop inside the setCustomerNo() funtion is running infinitely and reading even after the end of file.</p>\n\n<p>Please help me solving this issue.</p>\n\n<p>I've tried replacing:</p>\n\n<ol>\n<li>while(!feof(fp) { // LOOP BODY }</li>\n<li>while(!feof(fp) &amp;&amp; !ferror(fp))  { // LOOP BODY }</li>\n<li>while(fread(&amp;x, sizeof(Customer), 1, fp) || !feof(fp))   { // LOOP BODY }</li>\n</ol>\n\n<p>But none of these above replacements worked for me.</p>\n\n<pre><code>#define RECORD CustomerRecord.dat\ntypedef struct\n{\n    int customerNo;\n    unsigned int phoneNo;\n    char name[20];\n    char address[32];\n    float balance;\n}Customer;\n\nvoid writefile(Customer x)\n{\n    FILE *fp;\n    fp = fopen(\"CustomerRecord.dat\", \"ab\");\n    fwrite(&amp;x, sizeof(Customer), 1, fp);\n    fclose(fp);\n}\n\nCustomer setCustomerNo()\n{\n    FILE *fp;\n    Customer x, y;\n    int k = 1;\n\n    fp = fopen(RECORD, \"rb+\");\n    while(!feof(fp) &amp;&amp; !ferror(fp))\n    {\n        fread(&amp;x, sizeof(Customer), 1, fp);\n        x.customerNo = k++;\n        y = x;\n        fseek(fp, -sizeof(Customer), SEEK_CUR);\n        fwrite(&amp;x, sizeof(Customer), 1, fp);\n    }\n    fclose(fp);\n    return y;\n}\n</code></pre>\n\n<p>The expected result is that the function setCustomerNo() will read all the structures stored in file from the beginning and update customerNo(s) starting from 1 and so on to the structures stored in the file. At the end return the last updated structure.</p>\n"}, {"tags": ["c", "malloc", "memory-alignment", "c89"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1563342684, "post_id": 57068989, "comment_id": 100662530, "body": "I believe it is"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1563344869, "post_id": 57068989, "comment_id": 100663314, "body": "@chux: why delete your answer?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1563354711, "post_id": 57068989, "comment_id": 100668457, "body": "The point in DR28 is that the compiler <i>can</i> optimize, but it is not explicitly mentioned in the C90 text so you cannot find any relevant quote in it. The point is that they <i>both</i> are pointing to the same location, the one that in C99 was worded as the effective type stuff."}, {"owner": {"reputation": 779, "user_id": 4933116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-Pov-76Ho5_c/AAAAAAAAAAI/AAAAAAAAABE/UX5RzZlWMnU/photo.jpg?sz=128", "display_name": "pommicket", "link": "https://stackoverflow.com/users/4933116/pommicket"}, "edited": false, "score": 0, "creation_date": 1563354978, "post_id": 57068989, "comment_id": 100668599, "body": "Oops yes, I misread that. But anyways, that&#39;s saying the compiler can optimize it even if the two pointers overlap, which isn&#39;t true in my case."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563356473, "post_id": 57068989, "comment_id": 100669507, "body": "<i>using the start of that allocation as a pointer to a header which contains the length and capacity of the array</i>  Which means the remainder of the array is no longer &quot;suitably aligned so that it may be assigned to a pointer to any type of object and then used to access such an object or an array of such objects in the space allocated&quot; unless you&#39;ve taken care to ensure the size of your header matches the required alignment.  With C11 and later you can use <code>_Alignof (max_align_t)</code> to determine that."}, {"owner": {"reputation": 779, "user_id": 4933116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-Pov-76Ho5_c/AAAAAAAAAAI/AAAAAAAAABE/UX5RzZlWMnU/photo.jpg?sz=128", "display_name": "pommicket", "link": "https://stackoverflow.com/users/4933116/pommicket"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563361226, "post_id": 57068989, "comment_id": 100672005, "body": "@AndrewHenle Are you sure? I&#39;m not just adding the size of the header to the pointer and using it as the array (see the code I just added)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563362398, "post_id": 57068989, "comment_id": 100672612, "body": "@LeoTenenbaum <a href=\"https://stackoverflow.com/questions/42630843/bus-error-with-allocated-memory-on-a-heap\">I&#39;m sure</a>.  Just because it works on x86 systems doesn&#39;t mean you&#39;re not violating an alignment restriction.  The way you&#39;re doing it now looks marginally OK, though, as you&#39;re assuming <code>int</code> is twice the size of <code>short</code>. It doesn&#39;t have to be, but likely is on your system. (Your code was not posted when I made my original comment)"}, {"owner": {"reputation": 779, "user_id": 4933116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-Pov-76Ho5_c/AAAAAAAAAAI/AAAAAAAAABE/UX5RzZlWMnU/photo.jpg?sz=128", "display_name": "pommicket", "link": "https://stackoverflow.com/users/4933116/pommicket"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563366186, "post_id": 57068989, "comment_id": 100674622, "body": "@AndrewHenle That example is different, because they&#39;re using <code>new</code> and giving it the type, and <code>new</code> probably aligns based on the type (also, even if they did use <code>malloc</code>, 250 might not be a multiple of <code>sizeof(int)</code>, so it wouldn&#39;t necessarily be aligned properly). <code>malloc</code>, on the other hand is guaranteed to be aligned for all types (i.e. I could remove either the <code>*int_ptr = ...</code> line or the <code>short_ptr[x] = y</code> lines and it would definitely comply to the standard); I&#39;m just not sure if it&#39;ll work with two different types at the same time."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563367589, "post_id": 57068989, "comment_id": 100675514, "body": "@LeoTenenbaum <i>because they&#39;re using <code>new</code></i>  That&#39;s irrelevant to alignment restrictions. Do you understand <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing</a>?  Have you ever written code for non-x86 systems that will fail to run code that does misaligned accesses?  <code>short_array += 2;</code> in your code in isolation is correct.  This is not strictly correct: <code>&#47;* Skip over the int *&#47;</code>  What if a <code>short</code> is 2 bytes but an <code>int</code> is 8 bytes?  Your code makes size assumptions that are not safe."}, {"owner": {"reputation": 779, "user_id": 4933116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-Pov-76Ho5_c/AAAAAAAAAAI/AAAAAAAAABE/UX5RzZlWMnU/photo.jpg?sz=128", "display_name": "pommicket", "link": "https://stackoverflow.com/users/4933116/pommicket"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563367984, "post_id": 57068989, "comment_id": 100675772, "body": "@AndrewHenle <b>suppose that I know that <code>sizeof(int) &lt;= 2 * sizeof(short)</code></b>. In the code below that (which is closer to the code that I&#39;m actually using), I actually do make sure that the header and the array don&#39;t overlap, like replacing <code>short_array += 2</code> with <code>short_array += ceiling(sizeof(int) &#47; sizeof(short))</code> (and of course allocating enough space to do so)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563368769, "post_id": 57068989, "comment_id": 100676322, "body": "@LeoTenenbaum I see no evidence at all that you&#39;ve considered <a href=\"https://stackoverflow.com/questions/8732441/what-is-overalignment-of-execution-regions-and-input-sections\">overaligned types</a>"}, {"owner": {"reputation": 779, "user_id": 4933116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-Pov-76Ho5_c/AAAAAAAAAAI/AAAAAAAAABE/UX5RzZlWMnU/photo.jpg?sz=128", "display_name": "pommicket", "link": "https://stackoverflow.com/users/4933116/pommicket"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563371331, "post_id": 57068989, "comment_id": 100678076, "body": "@AndrewHenle Suppose on some (strange) system, a <code>short</code> must be at a memory address which is a multiple of 3 and an <code>int</code> must be at a memory address which is a multiple of 5. (so <code>sizeof(int) &lt;= 2 * sizeof(short)</code>). <code>malloc</code> must return a pointer which can both be used as a <code>short*</code> <i>and</i> as an <code>int*</code>, so it must be a multiple of 15. Let&#39;s say it picks memory address 90. What I&#39;m doing is using address 90 (which is a multiple of 5) as an <code>int</code>, and using addresses 96, 99, and 102 (which are all multiples of 3) as <code>short</code>s. So, on that hypothetical system, this would work."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1565298557, "post_id": 57068989, "comment_id": 101320586, "body": "@AndrewHenle: While DR#028 was correct in saying that the indicated optimization should be allowed, the stated rationalization is nonsensical.  If one recognizes the rules as saying that a byte which is used as a type T in some context may only subsequently be accessed by an lvalue which is derived, within that context, from an object of one of the listed types, that will be sufficient to define the behavior of allocated storage without any need for &quot;effective types&quot; based on the nonsensical rationale of DR#028."}], "answers": [{"comments": [{"owner": {"reputation": 779, "user_id": 4933116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-Pov-76Ho5_c/AAAAAAAAAAI/AAAAAAAAABE/UX5RzZlWMnU/photo.jpg?sz=128", "display_name": "pommicket", "link": "https://stackoverflow.com/users/4933116/pommicket"}, "edited": false, "score": 0, "creation_date": 1563351046, "post_id": 57070994, "comment_id": 100666468, "body": "The particular thing I&#39;m trying to do is make a dynamic array type (so I&#39;m allocating space for an array, and using the first part as a header for the length and capacity), but I&#39;d like it to work for all types, which is why I can&#39;t &quot;just&quot; use a struct. As for &quot;The C99, C11 and C18 behaviour is the one that should be considered here&quot;, I was asking about C90, but oh well..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 779, "user_id": 4933116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-Pov-76Ho5_c/AAAAAAAAAAI/AAAAAAAAABE/UX5RzZlWMnU/photo.jpg?sz=128", "display_name": "pommicket", "link": "https://stackoverflow.com/users/4933116/pommicket"}, "edited": false, "score": 0, "creation_date": 1563352336, "post_id": 57070994, "comment_id": 100667156, "body": "Then please edit your question to say so! Good motivation"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 779, "user_id": 4933116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-Pov-76Ho5_c/AAAAAAAAAAI/AAAAAAAAABE/UX5RzZlWMnU/photo.jpg?sz=128", "display_name": "pommicket", "link": "https://stackoverflow.com/users/4933116/pommicket"}, "edited": false, "score": 1, "creation_date": 1563352482, "post_id": 57070994, "comment_id": 100667224, "body": "@LeoTenenbaum <a href=\"https://kristerw.blogspot.com/2017/07/strict-aliasing-in-c90-vs-c99-and-how.html\" rel=\"nofollow noreferrer\">&#254;his is the reason why the C90 references are not useful</a>"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 1, "last_activity_date": 1563349865, "creation_date": 1563349865, "answer_id": 57070994, "question_id": 57068989, "link": "https://stackoverflow.com/questions/57068989/two-types-in-the-same-dynamic-allocation/57070994#57070994", "title": "Two types in the same dynamic allocation", "body": "<p>C90 ought to be dead by now, rest in peace. The C99, C11 and C18 behaviour is the one that should be considered here. They talk a lot about effective types. As the object allocated by <code>malloc</code> is not typed as such, the compiler will track the types of each pointer and memory area. </p>\n\n<p>If you write an <code>int</code> to the first 4 bytes, then the compiler is allowed to consider the datatype at the first 4 bytes to be an <code>int</code>. If then you write shorts to the successive bytes, their effective type will be <code>short</code>. <em>If</em> the storage does not overlap then your code is OK.</p>\n\n<p>But - be careful: if you however <em>overlap</em> the storage, i.e. you'll write the <code>short</code> over the <code>int</code> and read back the <code>int</code> afterwards, then all bets are off.</p>\n\n<p>Finally there is a rather good way of avoiding ambiguity - use a <code>struct</code> type. How about just using</p>\n\n<pre><code>struct two_types_in_one_malloc {\n    int the_int;\n    short the_shorts[3];\n};\n</code></pre>\n"}], "owner": {"reputation": 779, "user_id": 4933116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-Pov-76Ho5_c/AAAAAAAAAAI/AAAAAAAAABE/UX5RzZlWMnU/photo.jpg?sz=128", "display_name": "pommicket", "link": "https://stackoverflow.com/users/4933116/pommicket"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1563361124, "creation_date": 1563341158, "last_edit_date": 1563361124, "question_id": 57068989, "link": "https://stackoverflow.com/questions/57068989/two-types-in-the-same-dynamic-allocation", "title": "Two types in the same dynamic allocation", "body": "<p>The ISO C90 Standard (or at least the draft of it that I have) says this about <code>malloc</code> and alignment:</p>\n\n<blockquote>\n  <p>The pointer returned if the allocation succeeds is suitably aligned so that it may be assigned to a pointer to any type of object and then used to access such an object or an array of such objects in the space allocated...</p>\n</blockquote>\n\n<p>But can you use the same pointer returned by <code>malloc</code> for two different types? For example, suppose that I know that <code>sizeof(int) &lt;= 2 * sizeof(short)</code>. Could I allocate enough memory for <code>5</code> <code>short</code>s, and use the first two as an <code>int</code>, i.e. is the following code guaranteed to work as intended?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void) {\n    void* data = malloc(5 * sizeof(short));\n    short* short_array = data;\n    int* int_ptr = data;\n    if (!data) return EXIT_FAILURE;\n    *int_ptr = 13943;\n    short_array += 2; /* Skip over the int */\n    short_array[0] = 7;\n    short_array[1] = 238;\n    short_array[2] = -123;\n    printf(\"%d %d %d %d\\n\", *int_ptr, short_array[0], short_array[1], short_array[2]);\n    free(data);\n    return 0;\n}\n</code></pre>\n\n<p>I've tried this code, and it does output <code>13943 7 238 -123</code> for me, but I'm not entirely sure if it's standard-compliant.</p>\n\n<hr>\n\n<p>Edit: Specifically, I'm trying to make a dynamic array type (which can be an array of any type), so I'm allocating an array of one type, and using the start of that allocation as a pointer to a header which contains the length and capacity of the array.</p>\n\n<p>To be clear, here is approximately what I'm doing:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>size_t header_elements = (sizeof(ArrayHeader) + array_type_size - 1) / array_type_size); /* = ceil(sizeof(ArrayHeader) / array_type_size) */\nvoid* data = malloc((header_elements + array_length) * array_type_size);\nArrayHeader* header = data;\nvoid* array = (char*)data + header_elements * array_type_size;\n</code></pre>\n\n<p>So, <code>header</code> points to the start of the allocation and the actual <code>array</code> is offset by a multiple of the size of the type stored in it.</p>\n"}, {"tags": ["c", "avr", "i2c", "atmega", "lcd"], "answers": [{"comments": [{"owner": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "edited": false, "score": 0, "creation_date": 1563429047, "post_id": 57071678, "comment_id": 100698132, "body": "Thank you AterLux, Your&#39;s advice about address was true. If I send the 0x4E as SLA+W, the status in TWSR is 0x18 which means that the SLA+W was sent, and the ACK was received. Sending any other SLA+W byte returns 0x20 status in TWSR, so the address 0x4E is correct. But when I&#39;m sending next byte (0x08 which should set backlight), the write function stucks. Please take a look on this code. <a href=\"https://pastebin.com/rrahhtec\" rel=\"nofollow noreferrer\">pastebin.com/rrahhtec</a> You can see that the led_on() function is never called, becase write loop never stops."}, {"owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "reply_to_user": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "edited": false, "score": 0, "creation_date": 1563437338, "post_id": 57071678, "comment_id": 100701819, "body": "@bielu000 I do not see <code>TWBR</code> initialization in your code. By default, its value is zero, giving 1MHz I2C frequency at 16MHz CPU (refer to section <i>22.5.2 Bit Rate Generator Unit</i> of the datasheet). You have to limit I2C speed at 100kHz max. So, set TWBR to 72 for 16MHz CPU, or 32 for 8MHz CPU."}, {"owner": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "edited": false, "score": 0, "creation_date": 1563457558, "post_id": 57071678, "comment_id": 100713296, "body": "You have absolutely right. I totally forgot about Bit Rate Generator. In my case I set TWBR to 52, because my CPU speed is 12 Mhz. Thank you."}], "tags": [], "owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "is_accepted": true, "score": 1, "last_activity_date": 1563354296, "last_edit_date": 1563354296, "creation_date": 1563352176, "answer_id": 57071678, "question_id": 57068848, "link": "https://stackoverflow.com/questions/57068848/avr-atmega168-i2c-lcd-does-not-want-to-initialize/57071678#57071678", "title": "AVR Atmega168 I2C LCD does not want to initialize", "body": "<p><strong>1)</strong> Please clarify what the I2C-to-parallel IC you have? I cannot find what is PCF85741, I see datasheets only for <a href=\"https://www.nxp.com/docs/en/data-sheet/PCF8574_PCF8574A.pdf\" rel=\"nofollow noreferrer\">PCF8574 and PCF8574A</a>.</p>\n\n<p>In the first case, the slave address will be (including r/w bit) 0x40...0x4F, in the second - 0x70...0x7F.</p>\n\n<p>Speaking from my experience the usual I2C circuit which comes with those displays has PCF8574A on it (i.e. address is 0x7*). And pin 3 there, by the way, is used to control the backlight.</p>\n\n<p><strong>2)</strong> Make sure what lower bits of the address you have? Are inputs A0 A1 A2 pulled up or tied to ground?</p>\n\n<p>Again, from my experience, those boards usually have pull-ups to +5, and solderable jumpers on the board, to short those to ground. By default, the jumpers are not soldered, therefore A0 A1 A2 has a high logical level, thus the I2C address of the device is <strong>0x7E</strong> (writing)/0x7F (reading). If you have PCF8574T on board, then the address will be <strong>0x4E</strong>/0x4F</p>\n\n<p>You can easily detect has the IC answered or not, by checking TWS bits in TWSR register <code>(TWSR &amp; TW_STATUS_MASK)</code> should be equal to <code>TW_MT_SLA_ACK</code> (0x18) after the address is transmitted, or <code>TW_MT_DATA_ACK</code> (0x28) after the data byte is transmitted. (See <a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-9365-Automotive-Microcontrollers-ATmega88-ATmega168_Datasheet.pdf\" rel=\"nofollow noreferrer\">the datasheet</a> section <em>19.8.1 Master Transmitter Mode</em> pages 186-188)</p>\n\n<p>Or, more simply, if you have P3 of the PCF8574 connected to the backlight, you can try output <code>0x08</code> / <code>0x00</code> to see if the backlight is turning on and off.</p>\n\n<p><strong>3)</strong> For the initialization sequence look at <em>Figure 24 4-Bit Interface</em> on page 46 of <a href=\"https://www.sparkfun.com/datasheets/LCD/HD44780.pdf\" rel=\"nofollow noreferrer\">HD44780 datasheet</a>\n   Note bits DB5 and DB4 are high. Also, be careful, since you're only writing to the display controller, the bit <em>R/W</em> (i.e. the bit 1 of the output) should always be zero (note you're sending <code>wi_write_byte(0x03);</code> and then <code>twi_write_byte(0x02);</code> with the bit 1 is set high).</p>\n\n<p>The example may be as follows:</p>\n\n<pre><code>void send4bits(uint8_t fourbits, bool is_cmd) {\n  uint8_t d = (fourbits &lt;&lt; 4) | 0b1000;\n  if (!is_cmd) d |= 1;\n  twi_write_byte(d | 0b100); // E high\n  twi_write_byte(d);         // E low\n}\n\nvoid sendcmd(uint8_t cmd) {\n  send4bits(cmd &gt;&gt; 4, true);\n  send4bits(cmd &amp; 0xF, true);\n}\n\nvoid senddata(uint8_t cmd) {\n  send4bits(cmd &gt;&gt; 4, false);\n  send4bits(cmd &amp; 0xF, false);\n}\n\n\n// initialization sequence\n\nsend4bits(0b0011, true);\n_delay_ms(5);\nsend4bits(0b0011, true);\n_delay_ms(1);\nsend4bits(0b0011, true);\n// since I2C is slow enough the required 100us pause already happened here\nsend4bits(0b0010, true);\n\nsendcmd(0b00101000);\nsendcmd(0b00001000);\nsendcmd(0b00000001);\ndelay_ms(2);\nsendcmd(0b00000110);\n\nsendcmd(0b00001110);\n\n// Initialization is done\n\nsendcmd(0x80); // Set cursor at the beginning\nfor (uint8_t i = 'A' ; i &lt;= 'Z' ; i++) {\n  senddata(i); // Send some random data\n}\n</code></pre>\n"}], "owner": {"reputation": 1005, "user_id": 6947687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d0d3a100995c266cd398b0f85d26a946?s=128&d=identicon&r=PG&f=1", "display_name": "bielu000", "link": "https://stackoverflow.com/users/6947687/bielu000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 57071678, "answer_count": 1, "score": 0, "last_activity_date": 1612003386, "creation_date": 1563340064, "last_edit_date": 1612003386, "question_id": 57068848, "link": "https://stackoverflow.com/questions/57068848/avr-atmega168-i2c-lcd-does-not-want-to-initialize", "title": "AVR Atmega168 I2C LCD does not want to initialize", "body": "<p>I'm using I2C converter to send data to my lcd. \nThe converter is based on PCF85741, and the lcd is Hitachi hd44780.</p>\n\n<p>Port mapping between PCF85741 and lcd is as follows:</p>\n\n<blockquote>\n  <p>P0 -> RS</p>\n  \n  <p>P1 -> RW</p>\n  \n  <p>P2 -> E</p>\n  \n  <p>P3 -> ? </p>\n  \n  <p>P4 -> D4</p>\n  \n  <p>P5 -> D5 </p>\n  \n  <p>P6 -> D6 </p>\n  \n  <p>P7 -> D7 </p>\n</blockquote>\n\n<p>The documentation says that the default address of my slave is 0x20, but with RW bit I need to send 0x40. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>void twi_start()\n{\n    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWEN) | (1 &lt;&lt; TWSTA);\n\n    while (!(TWCR &amp; (1 &lt;&lt; TWINT)));\n}\n\nvoid twi_stop()\n{\n    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWEN) | (1 &lt;&lt; TWSTO);\n\n    while (!(TWCR &amp; (1 &lt;&lt; TWSTO)));\n}\n\nvoid twi_write(uint8_t byte)\n{\n    TWDR = byte;\n\n    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWEN);\n\n    while (!(TWCR &amp; (1 &lt;&lt; TWINT)));\n}\n\nvoid twi_write_byte(uint8_t byte)\n{\n    uint8_t SLAVE_ADDRESS = 0x40;\n\n\n    twi_start();\n    twi_write(SLAVE_ADDRESS);\n    twi_write(byte);\n\n    twi_stop();\n}\n</code></pre>\n\n<p>Lcd init</p>\n\n<pre><code>void lcd_init2()\n{\n    for (int i = 0; i &lt; 3; i++) {\n        twi_write_byte(0x03);\n\n        _delay_ms(20);\n    }\n\n    twi_write_byte(0x02);\n    _delay_ms(20);\n\n    //4 bit mode\n    twi_write_byte(0x24); // D5 -&gt; 1, E -&gt; 1 \n    _delay_ms(10);\n    twi_write_byte(0x20); // D5 -&gt; 1, E -&gt; 0\n    _delay_ms(10);\n\n    //2 lines\n    twi_write_byte(0x24); // D5 -&gt; 1, E -&gt; 1\n    _delay_ms(10);\n    twi_write_byte(0x20); // D5 -&gt; 1, E -&gt; 0 first nibble\n    _delay_ms(10);\n\n    twi_write_byte(0x84); // D7 -&gt; 1, E -&gt; 1\n    _delay_ms(10);\n    twi_write_byte(0x80); // D7 -&gt; 1, E -&gt; 0 second nibble \n    _delay_ms(10);\n}\n</code></pre>\n\n<p>After this code, the lcd should be in 4bit mode, with 2 lines, but it isn't \nNothing changes on lcd. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1563337783, "post_id": 57068503, "comment_id": 100661160, "body": "The code you have will <i>not</i> parse your stated expression <code>1 + 2.5 *3</code> as you desire. Those spaces will muck up your <code>scanf</code> from the get-go because <code>%c</code> does not automatically skip whitespace. Checking the actual result of <code>scanf</code> for the number of arguments correctly parsed is a good idea."}, {"owner": {"reputation": 55, "user_id": 11795130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70030f6315c4b8485481f36340d5d5?s=128&d=identicon&r=PG&f=1", "display_name": "KhanhThan1002", "link": "https://stackoverflow.com/users/11795130/khanhthan1002"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1563339568, "post_id": 57068503, "comment_id": 100661558, "body": "@WhozCraig Yeah I know the scanf doesnt skip white spaces. When I enter an expression I don&#39;t put in any white space between the numbers and the operators. Still, the program doesnt return anything, even the sentence inside the printf."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1563340223, "post_id": 57068503, "comment_id": 100661720, "body": "&quot;When I enter an expression I don&#39;t put in any white space between the numbers and the operators&quot; --&gt; then why post &quot;1 + 2.5 *3&quot; instead of &quot;1+2.5*3\\n&quot;?  Post true input used.  Also append <code>&quot;\\n&quot;</code> to <code>printf()</code> format."}, {"owner": {"reputation": 55, "user_id": 11795130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70030f6315c4b8485481f36340d5d5?s=128&d=identicon&r=PG&f=1", "display_name": "KhanhThan1002", "link": "https://stackoverflow.com/users/11795130/khanhthan1002"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1563343907, "post_id": 57068503, "comment_id": 100662953, "body": "@chux I apologize for causing confusion. I&#39;ll do it next time"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1563344553, "post_id": 57068503, "comment_id": 100663203, "body": "Use <code>fgets</code> and parse the string. This will save you all the <code>scanf</code> related problems."}, {"owner": {"reputation": 55, "user_id": 11795130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70030f6315c4b8485481f36340d5d5?s=128&d=identicon&r=PG&f=1", "display_name": "KhanhThan1002", "link": "https://stackoverflow.com/users/11795130/khanhthan1002"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1563346175, "post_id": 57068503, "comment_id": 100663877, "body": "@Jabberwocky Thank you for your response. However I am following the C Programming - A Modern Approach book, and it hasn&#39;t mentioned the <code>fgets</code> function so far (I&#39;m currently at the end of Chapter 7). The book must have assumed that <code>scanf</code> is enough for this programming project. I will use <code>fgets</code> as soon as it comes up"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 11795130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70030f6315c4b8485481f36340d5d5?s=128&d=identicon&r=PG&f=1", "display_name": "KhanhThan1002", "link": "https://stackoverflow.com/users/11795130/khanhthan1002"}, "edited": false, "score": 1, "creation_date": 1563343710, "post_id": 57068876, "comment_id": 100662875, "body": "Thank you for your response. However I am following the C Programming - A Modern Approach book, and it hasn&#39;t mentioned the fgets function so far (I&#39;m currently at the end of Chapter 7)."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 3, "last_activity_date": 1563340558, "last_edit_date": 1563340558, "creation_date": 1563340234, "answer_id": 57068876, "question_id": 57068503, "link": "https://stackoverflow.com/questions/57068503/evaluate-an-expression-users-can-enter-as-many-numbers-and-operators-as-they-wa/57068876#57068876", "title": "Evaluate an expression, users can enter as many numbers and operators as they want", "body": "<p>Even after you press enter after putting complete expression.</p>\n\n<pre><code>scanf(\"%c\", &amp;ch);\nscanf(\"%f\", &amp;b);\n</code></pre>\n\n<p>Will still wait to input float because of order of <code>scanf</code>.</p>\n\n<p>Just break immediately once you press enter as below.</p>\n\n<pre><code>while (ch != '\\n') {\n    if (ch == '+')\n        result += b;\n    else if (ch == '-')\n        result -= b;\n    else if (ch == '*')\n        result *= b;\n    else if (ch == '/') {\n        result /= b; }\n    scanf(\"%c\", &amp;ch);\n    if (ch == '\\n') break;\n    scanf(\"%f\", &amp;b);\n}\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>I would suggest you to use <code>fgets</code> to read the complete expression at\n  once and process the expression afterwards also your current code is very naive wouldn't even work for complex expression which includes <code>(</code>, <code>)</code> etc, you may want to use LIFO data structure by processing the read expression in reverse order.</p>\n</blockquote>\n"}], "owner": {"reputation": 55, "user_id": 11795130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70030f6315c4b8485481f36340d5d5?s=128&d=identicon&r=PG&f=1", "display_name": "KhanhThan1002", "link": "https://stackoverflow.com/users/11795130/khanhthan1002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 57068876, "answer_count": 1, "score": 4, "last_activity_date": 1563340558, "creation_date": 1563337456, "question_id": 57068503, "link": "https://stackoverflow.com/questions/57068503/evaluate-an-expression-users-can-enter-as-many-numbers-and-operators-as-they-wa", "title": "Evaluate an expression, users can enter as many numbers and operators as they want", "body": "<p>This is the Programming Project 7.12 of the C Programming - A Modern Approach. The program is expected to evaluate an expression (for example 1+2.5*3) and return its result (10.5 in this case, note that the expression is evaluated from left to right, and no operator takes precedence over any other operator).</p>\n\n<p>This is what I've tried (the expression is 1 + 2.5 *3, for example): store 1 in a, + in ch, and 2.5 in b. Then let result = a, compute the \"new\" result by either adding, subtracting, dividing or multiplying with b. Then continue reading the expression, storing * in ch, and 3 in b. Run the while loop again until the scanf detects a new-line character. I wonder what is wrong with my method, or my code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    float a, b, result;\n    char ch;\n    printf(\"Enter an expression: \");\n    scanf(\"%f%c%f\", &amp;a, &amp;ch, &amp;b);\n    result = a;\n    while (ch != '\\n') {\n        if (ch == '+')\n            result += b;\n        else if (ch == '-')\n            result -= b;\n        else if (ch == '*')\n            result *= b;\n        else if (ch == '/') {\n            result /= b; }\n        scanf(\"%c\", &amp;ch);\n        scanf(\"%f\", &amp;b);\n    }\n    printf(\"Value of expression: %.2f\", result);\n    return 0;\n}\n</code></pre>\n\n<p>It doesn't return anything :(</p>\n"}, {"tags": ["c", "arrays", "pointers", "double", "2d"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1563336881, "post_id": 57068408, "comment_id": 100660994, "body": "Why the cast <code>(int**)</code> in <code>xpp = (int**)x;</code>?  The cast hints that code is doing something <i>I know better than you compiler, so do it and do not complain</i>."}, {"owner": {"reputation": 37, "user_id": 11167565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89ed64e8f62abfa979c8fc24a4a4628?s=128&d=identicon&r=PG&f=1", "display_name": "Jav", "link": "https://stackoverflow.com/users/11167565/jav"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1563337954, "post_id": 57068408, "comment_id": 100661197, "body": "Right. Without the cast I get &quot;warning: assignment from incompatible pointer type&quot;. What is the best way to access the array using xpp?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1563337996, "post_id": 57068408, "comment_id": 100661206, "body": "&quot;best way to access the array using xpp&quot; --&gt; Do not use <code>int **xpp;</code> - it is not the right type."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1563338120, "last_edit_date": 1563338120, "creation_date": 1563337755, "answer_id": 57068538, "question_id": 57068408, "link": "https://stackoverflow.com/questions/57068408/double-pointers-and-2d-arrays-in-c/57068538#57068538", "title": "double pointers and 2d arrays in c", "body": "<p>Rather than ...</p>\n\n<pre><code>int x[2][2] = {{10, 20},{30, 40}};\nint **xpp;\nxpp = (int**)x;\n</code></pre>\n\n<p>... realize that <code>x</code> in the expression converts to a pointer the address of the first element.  The first element of <code>x</code> is <code>x[0]</code> which has a type of <code>int [2]</code>, so the type needed is <code>int (*)[2]</code> or <a href=\"https://cdecl.org/?q=int+%28*p%29%5B2%5D%3B\" rel=\"nofollow noreferrer\">pointer to array 2 of int</a>.</p>\n\n<pre><code>int (*p)[2];\np = x;\n\nprintf (\"%p\\n\", (void *) p);\nprintf (\"%p\\n\", (void *) *p);\nprintf (\"%d\\n\", **p);\nprintf (\"%d %d %d %d\\n\", p[0][0], p[0][1], p[1][0], p[1][1]);\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>0xffffcbd0 (sample)\n0xffffcbd0 (sample)\n10\n10 20 30 40\n</code></pre>\n\n<hr>\n\n<p>Tip: avoid casting - it often hides weak programming.</p>\n"}], "owner": {"reputation": 37, "user_id": 11167565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d89ed64e8f62abfa979c8fc24a4a4628?s=128&d=identicon&r=PG&f=1", "display_name": "Jav", "link": "https://stackoverflow.com/users/11167565/jav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 57068538, "answer_count": 1, "score": 3, "last_activity_date": 1563340114, "creation_date": 1563336651, "last_edit_date": 1563340114, "question_id": 57068408, "link": "https://stackoverflow.com/questions/57068408/double-pointers-and-2d-arrays-in-c", "title": "double pointers and 2d arrays in c", "body": "<p>I'm trying to access a 2D array using double pointer</p>\n\n<pre><code>int x[2][2] = {{10, 20},{30, 40}};\nint *xp;\nint **xpp;\n\nprintf (\"%d  %d\\n%d  %d\\n\", x[0][0], x[0][1], x[1][0], x[1][1]);\nprintf (\"\\n\");\n\nxp = *x;\nprintf (\"%d  %d\\n%d  %d\\n\", *xp, *(xp + 1), *(xp + 2), *(xp + 3));\nprintf (\"\\n\");\n\nxpp = (int**)x;\nprintf (\"%d\\n\", **xpp);\n</code></pre>\n\n<p>What I get is:</p>\n\n<blockquote>\n<pre><code>10  20\n30  40\n\n10  20\n30  40\n\nSegmentation fault\n</code></pre>\n</blockquote>\n\n<p>Question: How should I access the array using <code>xpp</code>?</p>\n"}, {"tags": ["python", "c", "ctypes"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1563336932, "post_id": 57068069, "comment_id": 100661004, "body": "So lpOuter.pBuffer1 contains a null value. (It doesn&#39;t point to a null value; the pointer itself is a null value). Are you supposed to pass a buffer into the function, perhaps?"}, {"owner": {"reputation": 1453, "user_id": 2133240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iz1JT.jpg?s=128&g=1", "display_name": "dsgdfg", "link": "https://stackoverflow.com/users/2133240/dsgdfg"}, "edited": false, "score": 0, "creation_date": 1563342501, "post_id": 57068069, "comment_id": 100662464, "body": "<b>What did you do with the seven bits left?</b>  Just use <i>bytes</i> not another types(int,string,bool,long etc.) I read the codes you wrote, but I couldn&#39;t see a description of the memory allocation. You cannot access definitions within C codes (values that cannot be saved), you can only call functions. STURCT is not a function!"}, {"owner": {"reputation": 157, "user_id": 9289807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RlyhJWF_Mnw/AAAAAAAAAAI/AAAAAAAAABE/v5K0eZEy6aM/photo.jpg?sz=128", "display_name": "Moore Tech", "link": "https://stackoverflow.com/users/9289807/moore-tech"}, "reply_to_user": {"reputation": 1453, "user_id": 2133240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iz1JT.jpg?s=128&g=1", "display_name": "dsgdfg", "link": "https://stackoverflow.com/users/2133240/dsgdfg"}, "edited": false, "score": 0, "creation_date": 1563343056, "post_id": 57068069, "comment_id": 100662664, "body": "@dsgdfg In this case the function name and struct definition is having the identical name. In my code I am indeed calling <code>NET_DVR_ManualSnap</code>, not the struct!"}, {"owner": {"reputation": 157, "user_id": 9289807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RlyhJWF_Mnw/AAAAAAAAAAI/AAAAAAAAABE/v5K0eZEy6aM/photo.jpg?sz=128", "display_name": "Moore Tech", "link": "https://stackoverflow.com/users/9289807/moore-tech"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1563343108, "post_id": 57068069, "comment_id": 100662676, "body": "@immibis I assume we need to define the struct variable with some amount of size first?"}, {"owner": {"reputation": 1453, "user_id": 2133240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iz1JT.jpg?s=128&g=1", "display_name": "dsgdfg", "link": "https://stackoverflow.com/users/2133240/dsgdfg"}, "edited": false, "score": 0, "creation_date": 1563343233, "post_id": 57068069, "comment_id": 100662716, "body": "<b>null</b> is undefined for python, try : return byte for true 0xFE and false 0xFF , <b>bool</b> can&#39;t be shared outer side! EOF not equal to null."}, {"owner": {"reputation": 157, "user_id": 9289807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RlyhJWF_Mnw/AAAAAAAAAAI/AAAAAAAAABE/v5K0eZEy6aM/photo.jpg?sz=128", "display_name": "Moore Tech", "link": "https://stackoverflow.com/users/9289807/moore-tech"}, "reply_to_user": {"reputation": 1453, "user_id": 2133240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iz1JT.jpg?s=128&g=1", "display_name": "dsgdfg", "link": "https://stackoverflow.com/users/2133240/dsgdfg"}, "edited": false, "score": 0, "creation_date": 1563343398, "post_id": 57068069, "comment_id": 100662783, "body": "@dsgdfg I think you&#39;ve misunderstood my question. Apparently I have no problem calling the function. My question is how can I access the variable <code>pBuffer1</code> from the output parameter <code>lpOuter</code>."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1563471645, "post_id": 57068069, "comment_id": 100721168, "body": "You didn&#39;t define function&#39;s <i>argtypes</i>. So you get 2 <i>NULL</i> pointers. Is this a problem? Maybe this is what you should have gotten (no license plate has been identified). What about the structure&#39;s members? You didn&#39;t do any initialization on the structure before passing it to the function. You should at least do <code>lpOuter.dwSize = ctypes.sizeof(NET_DVR_PLATE_RESULT)</code>."}, {"owner": {"reputation": 1453, "user_id": 2133240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iz1JT.jpg?s=128&g=1", "display_name": "dsgdfg", "link": "https://stackoverflow.com/users/2133240/dsgdfg"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1563700393, "post_id": 57068069, "comment_id": 100779802, "body": "@CristiFati your comment got memmory allocation ! (+1) . And warning again **Just use bytes not other types**(LSB,MSB,EMPTY VALUES,ERRORS,ANSWER LENGTH, EOBP(end of bytes pointer),RAM SIZE EXCEED,BUFFER CLEAR METHOD,POINTER CLEAR METHOD) . Moore Tech You have to attend the C teaching.have nice day!"}], "owner": {"reputation": 157, "user_id": 9289807, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RlyhJWF_Mnw/AAAAAAAAAAI/AAAAAAAAABE/v5K0eZEy6aM/photo.jpg?sz=128", "display_name": "Moore Tech", "link": "https://stackoverflow.com/users/9289807/moore-tech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 738, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563333465, "creation_date": 1563333465, "question_id": 57068069, "link": "https://stackoverflow.com/questions/57068069/python-ctypes-null-pointer-access", "title": "Python Ctypes NULL pointer access", "body": "<p>I am integrating with a C library and in one of the method, I can get all of the data successfully except for a buffer pointer.</p>\n\n<p>Here is the method definition</p>\n\n<pre><code>BOOL NET_DVR_ManualSnap(\n  LONG                      lUserID,\n  LPNET_DVR_MANUALSNAP      lpInter,  // input parameter\n  LPNET_DVR_PLATE_RESULT    lpOuter   // output parameter\n);\n</code></pre>\n\n<p>Here is the <code>NET_DVR_PLATE_RESULT</code> struct definition</p>\n\n<pre><code>struct{\n  DWORD                    dwSize;\n  BYTE                     byResultType;\n  ...\n  BYTE                     *pBuffer1;\n  BYTE                     *pBuffer2;\n} NET_DVR_PLATE_RESULT, *LPNET_DVR_PLATE_RESULT;\n</code></pre>\n\n<p>In my python side, both pBuffer1 and pBuffer2 are images made of pointer of bytes.</p>\n\n<pre><code>class NET_DVR_PLATE_RESULT(ctypes.Structure):\n\n    _fields_ = [\n        (\"dwSize\", ctypes.c_uint),\n        (\"byResultType\", ctypes.c_byte),\n        (\"pBuffer1\", ctypes.POINTER(ctypes.c_byte)),\n        (\"pBuffer2\", ctypes.POINTER(ctypes.c_byte))\n    ]\n</code></pre>\n\n<p>When calling the method,</p>\n\n<pre><code>lUserID = 0\nlib.NET_DVR_ManualSnap.restype = ctypes.c_bool\n\nlpInter = NET_DVR_MANUALSNAP()\nlpInter.byLaneNo = 1\n\nlpOuter = NET_DVR_PLATE_RESULT()\n\nsuccess = lib.NET_DVR_ManualSnap(lUserID, ctypes.byref(lpInter), ctypes.byref(lpOuter))\n\nif success:\n    print(lpOuter.pBuffer1.contents) // NULL pointer access\n    print(lpOuter.pBuffer2.contents) // NULL pointer access\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "edited": false, "score": 1, "creation_date": 1563332886, "post_id": 57067987, "comment_id": 100660296, "body": "Why do you think there will be an error?, it is undefined behavior I would think"}, {"owner": {"reputation": 9, "user_id": 8134849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6083231951a9a3d4c66d349f30020481?s=128&d=identicon&r=PG", "display_name": "Murali", "link": "https://stackoverflow.com/users/8134849/murali"}, "reply_to_user": {"reputation": 61700, "user_id": 5291015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZFijZ.jpg?s=128&g=1", "display_name": "Inian", "link": "https://stackoverflow.com/users/5291015/inian"}, "edited": false, "score": 0, "creation_date": 1563332955, "post_id": 57067987, "comment_id": 100660316, "body": "we dint pass any variable or value for %s"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1563333247, "post_id": 57067987, "comment_id": 100660361, "body": "<code>void main ()</code> should be <code>int main(void)</code>. If you have a book that tells you to use <code>void main ()</code>, replace it with one written by someone who knows C."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1563333989, "post_id": 57067987, "comment_id": 100660476, "body": "What compiler are you using? Any compiler will likely warn (at least) you when compiling that code."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 2, "creation_date": 1563334492, "post_id": 57067987, "comment_id": 100660552, "body": "If you expect C to check your code for errors at runtime and issue sensible error messages if your code violates some constraint, then you need to adjust your expectations. For better or worse, that&#39;s not C&#39;s philosophy. C does not spend the extra cycles at runtime to check validity, on the basis that programmers who accept the responsibility of ensuring their code is correct don&#39;t want to pay the cost of double-checking it. However, you can ask the C compiler to warn you about things which are likely to be problems, and you absolutely should do that."}], "answers": [{"comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1563333209, "post_id": 57068019, "comment_id": 100660352, "body": "It&#39;s also worth pointing out that having <code>%s</code> print <code>(null)</code> if the argument is a null pointer is not required, but it&#39;s a common extension. The behavior would still be undefined if an explicit null pointer were passed."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1563333662, "post_id": 57068019, "comment_id": 100660427, "body": "@KeithThompson It&#39;s also worth noting that there&#39;s a known problem with that extension: when the compiler decides to optimize a <code>printf</code> and calls <code>puts</code> instead, the extension doesn&#39;t come into play, and boom! I wouldn&#39;t rely on that extension, although it&#39;s nice having it as extra safety."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1563340829, "post_id": 57068019, "comment_id": 100661889, "body": "@CacahueteFrito Eh? The &quot;extension&quot; only comes into play when the format contains <code>%s</code>, but the optimization only comes into play when the format string is constant and contains no <code>%</code> signs at all.  So they shouldn&#39;t ever conflict with each other (let alone go &quot;boom&quot;), right?  What am I missing?"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1563342294, "post_id": 57068019, "comment_id": 100662404, "body": "@SteveSummit <code>char *s = NULL; printf(&quot;%s\\n&quot;, s);</code> should be enough to halt &amp; catch fire with a decent optimizer :-) (it&#39;s equivalent to <code>puts(s);</code>). If the compiler is very aggressive at optimizing, some other less obvious cases may result in UB.  The link recently added into the answer reflects that."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1563355411, "post_id": 57068019, "comment_id": 100668890, "body": "@CacahueteFrito: Yes, gcc transforms <code>printf(&quot;%s\\n&quot;, s;</code> to <code>puts(s)</code> at all optimization levels, and clang at <code>-O1</code> and higher. (gcc 7.4.0, clang 6.0.0, Ubuntu 18.04.2 x86_64)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1563355460, "post_id": 57068019, "comment_id": 100668924, "body": "@SteveSummit: See my previous comment (can&#39;t &quot;@&quot; more than one person)."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1563340810, "last_edit_date": 1563340810, "creation_date": 1563333027, "answer_id": 57068019, "question_id": 57067987, "link": "https://stackoverflow.com/questions/57067987/how-the-null-gets-printed-what-is-the-concept-behind-it/57068019#57068019", "title": "How the (null) gets printed? What is the concept behind it?", "body": "<p>Your format string expects 4 arguments but you only pass 3.  Doing so invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, meaning you can't predict the behavior of the program.  </p>\n\n<p>In this case the string \"(null)\" is printed, but your code could print some random sequence of characters, no extra characters, or it could crash.  There's no guarantee.</p>\n\n<p>What <em>probably</em> happened is that the <code>%s</code> format specifier attempted to read the next 8 bytes on the stack to get a pointer, and those 8 bytes happened to all be 0, so the string \"(null)\" is printed because it read a NULL pointer.  But again, there's no guarantee of that.</p>\n\n<p>Also see, <a href=\"https://stackoverflow.com/questions/11589342/what-is-the-behavior-of-printing-null-with-printfs-s-specifier\">What is the behavior of printing NULL with printf's %s specifier?</a>.</p>\n"}], "owner": {"reputation": 9, "user_id": 8134849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6083231951a9a3d4c66d349f30020481?s=128&d=identicon&r=PG", "display_name": "Murali", "link": "https://stackoverflow.com/users/8134849/murali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 57068019, "answer_count": 1, "score": -1, "last_activity_date": 1563340810, "creation_date": 1563332704, "last_edit_date": 1563334239, "question_id": 57067987, "link": "https://stackoverflow.com/questions/57067987/how-the-null-gets-printed-what-is-the-concept-behind-it", "title": "How the (null) gets printed? What is the concept behind it?", "body": "<pre><code>#include&lt;stdio.h&gt;  \n\nstatic char c;  \nstatic int i;  \nstatic float f;   \nstatic char s[100];  \n\nvoid main ()  \n{  \n    printf(\"%d %d %f %s\",c,i,f); \n}  \n</code></pre>\n\n<p>I expect the error in output, but the actual output is <code>0 0 0.000000 (null)</code></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1563332679, "post_id": 57067915, "comment_id": 100660265, "body": "It seems to be doing what you told it to do. It starts copying the last name at the fifth letter. If you want to output the last name starting at the beginning, why tell it to skip?"}, {"owner": {"reputation": 55, "user_id": 11795130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70030f6315c4b8485481f36340d5d5?s=128&d=identicon&r=PG&f=1", "display_name": "KhanhThan1002", "link": "https://stackoverflow.com/users/11795130/khanhthan1002"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1563332955, "post_id": 57067915, "comment_id": 100660315, "body": "Ah I get what you meant: the ch variable had already been assigned a different value before I called the second while loop. Let me modify the code a little bit and see if I can get the expected result. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 11795130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70030f6315c4b8485481f36340d5d5?s=128&d=identicon&r=PG&f=1", "display_name": "KhanhThan1002", "link": "https://stackoverflow.com/users/11795130/khanhthan1002"}, "edited": false, "score": 0, "creation_date": 1563336588, "post_id": 57068304, "comment_id": 100660941, "body": "Thank you @Adarsh Anurag, thats what I did and now my code runs as expected."}], "tags": [], "owner": {"reputation": 280, "user_id": 8105702, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-X6zDsNMKFno/AAAAAAAAAAI/AAAAAAAAABM/lOd2OxVDaJQ/photo.jpg?sz=128", "display_name": "Adarsh Anurag", "link": "https://stackoverflow.com/users/8105702/adarsh-anurag"}, "is_accepted": true, "score": 2, "last_activity_date": 1563335747, "creation_date": 1563335747, "answer_id": 57068304, "question_id": 57067915, "link": "https://stackoverflow.com/questions/57067915/unable-to-display-expected-result-using-putcharch/57068304#57068304", "title": "Unable to display expected result using putchar(ch)", "body": "<p>You should try the following changes to your code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    char ch, first_ini;\n    int len1 = 0, i = 0;\n    printf(\"Enter a first and last name: \");\n    ch = getchar();\n    first_ini = ch;\n    printf(\"The name is: \");\n    while (ch != ' '){\n        len1++;\n        ch = getchar();\n    }\n    while (ch != '\\n')\n    {\n        ch = getchar();// get the characters of second word\n        if(ch != '\\n')\n            putchar(ch);// print the characters of second word but avoid newline\n    }\n    printf(\", %c\", first_ini);\n    return 0;\n}\n</code></pre>\n\n<p>The problem with your code was that it started printing the characters of second word only when the length of second word became greater than the first word. </p>\n"}], "owner": {"reputation": 55, "user_id": 11795130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70030f6315c4b8485481f36340d5d5?s=128&d=identicon&r=PG&f=1", "display_name": "KhanhThan1002", "link": "https://stackoverflow.com/users/11795130/khanhthan1002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 57068304, "answer_count": 1, "score": 1, "last_activity_date": 1563338862, "creation_date": 1563332011, "last_edit_date": 1563338862, "question_id": 57067915, "link": "https://stackoverflow.com/questions/57067915/unable-to-display-expected-result-using-putcharch", "title": "Unable to display expected result using putchar(ch)", "body": "<p>I am new to C programming :D.</p>\n\n<p>This is the Programming Project 7.1 in C Programming - A Modern Method. For example, the input first and last name are Lloyd Fosdick, the expected result should be Fosdick, L. I tried counting the number of characters in the first name (which is 5 in this case). Then, when i > the length of the first name, start printing by using putchar(), as illustrated by the code below. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    char ch, first_ini;\n    int len1 = 0, i = 0;\n    printf(\"Enter a first and last name: \");\n    ch = getchar();\n    first_ini = ch;\n    printf(\"The name is: \");\n    while (ch != ' '){\n        len1++;\n        ch = getchar();\n    }\n    while (ch != '\\n')\n    {\n        i++;\n       if (i &lt;= len1) {\n            ch = getchar();\n        }\n        else {\n            putchar(ch);\n            ch = getchar();\n        }\n\n    }\n    printf(\", %c\", first_ini);\n    return 0;\n}\n</code></pre>\n\n<p>The result I got was ick, L. instead of Fosdick, L</p>\n"}, {"tags": ["c", "compiler-construction", "abstract-syntax-tree", "cppcheck"], "comments": [{"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 1, "creation_date": 1563345295, "post_id": 57067538, "comment_id": 100663480, "body": "You probably need a data flow graph or something similar in order to conclude that <code>s</code> points to <code>a</code> for some function call in your code. Have a look at <a href=\"https://stackoverflow.com/a/15755160/5265292\">stackoverflow.com/a/15755160/5265292</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 11794951, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uuo_IlTIRRI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGO5NCeBOTbDQSzfEVe-XcfjHpmg/photo.jpg?sz=128", "display_name": "White Wang", "link": "https://stackoverflow.com/users/11794951/white-wang"}, "edited": false, "score": 0, "creation_date": 1563355352, "post_id": 57069598, "comment_id": 100668858, "body": "As we all know,It&#39;s quite easy to understand s= str_arry; will removes the connection between s and a for human, But How can computer know that? Could you please give me some hints ?"}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "reply_to_user": {"reputation": 31, "user_id": 11794951, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uuo_IlTIRRI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGO5NCeBOTbDQSzfEVe-XcfjHpmg/photo.jpg?sz=128", "display_name": "White Wang", "link": "https://stackoverflow.com/users/11794951/white-wang"}, "edited": false, "score": 0, "creation_date": 1563356487, "post_id": 57069598, "comment_id": 100669522, "body": "The address pointed by <code>s</code> is not the same as the address pointed by <code>a</code>."}], "tags": [], "owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "is_accepted": false, "score": 1, "last_activity_date": 1563344260, "creation_date": 1563344260, "answer_id": 57069598, "question_id": 57067538, "link": "https://stackoverflow.com/questions/57067538/how-to-do-static-code-logical-analysis-with-ast-tree-or-other-tool/57069598#57069598", "title": "How to do static code logical analysis with AST tree or other tool?", "body": "<blockquote>\n  <p>How could Cppcheck get the connection between \u2018a\u2019 in f2 and \u2018s\u2019 in f1? </p>\n</blockquote>\n\n<p>They are definitely not the same. One of the following can happen:</p>\n\n<hr>\n\n<p>You pass <code>a</code> to the function, and CPPcheck continues to remember the size of <code>a</code>, even though you access it with the formal parameter <code>s</code>.</p>\n\n<p>You have to keep in mind that static analysis tools and compilers work differently, with different purposes in mind. Static analysis tools were crated EXACTLY for the purpose of catching things like you presented in your question.</p>\n\n<hr>\n\n<p>In your second example you have:</p>\n\n<pre><code>s= str_arry;\n</code></pre>\n\n<p>which removes the connection between <code>s</code> and <code>a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 965, "user_id": 7772356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6749606abf1529e3bf62e4ae18104d43?s=128&d=identicon&r=PG", "display_name": "AndreyKarpov", "link": "https://stackoverflow.com/users/7772356/andreykarpov"}, "is_accepted": false, "score": 2, "last_activity_date": 1563381949, "creation_date": 1563381949, "answer_id": 57080732, "question_id": 57067538, "link": "https://stackoverflow.com/questions/57067538/how-to-do-static-code-logical-analysis-with-ast-tree-or-other-tool/57080732#57080732", "title": "How to do static code logical analysis with AST tree or other tool?", "body": "<p>I don't know how exactly Cppcheck works but I'll tell you how to solve this problem in general. There are two main approaches to the analysis of interrelated functions.</p>\n\n<p>In the first case, when an analyzer meets function call it starts analyzing its body considering value of factual arguments transmitted through the function. This happens naturally only if it is known which values are transmitted to the function. This refers to: an exact value, a range, a set of values, null/non-null pointer, etc. The complexity of the transmitted information depends on the analyzer sophistication. For example, it can start analyzing the function body knowing that two of the transmitted pointers refer to the same array.</p>\n\n<p>It's an excellent accurate approach. But there's a serious problem. The analyzers based on this concept are very slow. They have to analyze functions bodies with different input data sets over and over again. The functions in turn call other ones and so on. And at some point the \"inside\" analysis has to be stopped which, in practice, makes this approach not that accurate and excellent as it might seem in theory.</p>\n\n<p>There's a second approach. It's based on automatic function annotations. The thing is, when analyzing functions the information on how its arguments are used and which values they can't take is being gazed. Let's consider the simple example that I gave in the article called '<a href=\"https://www.viva64.com/en/b/0592/\" rel=\"nofollow noreferrer\">Technologies used in the PVS-Studio code analyzer for finding bugs and potential vulnerabilities</a>'.</p>\n\n<pre><code>int Div(int X)\n{\n  return 10 / X;\n}\nvoid Foo()\n{\n  for (int i = 0; i &lt; 5; ++i)\n    Div(i);\n}\n</code></pre>\n\n<p>An analyzer recognizes that <code>X</code> variable is used in <code>Div</code> function as a divider. Based on it, a special <code>Div</code> function annotation is created automatically. Then it takes into account the fact that a range of [0..4] values is transmitted to the function as the <code>X</code> argument. The analyzer concludes that the division by zero should appear. </p>\n\n<p>This approach is more crude and not that accurate as the first one. But it is very fast and allows to create strong correlations between big amount of functions with no loss of productivity.</p>\n\n<p>It can be much more complicated in practice. For example, the PVS-Studio analyzer uses the second approach as the main one but not always. Sometimes when dealing with template functions we analyze them once more (the first approach). In other words, we use a combined approach to maintain the balance between the depth and speed of analysis.</p>\n"}, {"tags": [], "owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "is_accepted": false, "score": 2, "last_activity_date": 1563466575, "creation_date": 1563466575, "answer_id": 57098829, "question_id": 57067538, "link": "https://stackoverflow.com/questions/57067538/how-to-do-static-code-logical-analysis-with-ast-tree-or-other-tool/57098829#57098829", "title": "How to do static code logical analysis with AST tree or other tool?", "body": "<p>In order to analyze the possible sources of some value, it's a good idea to turn all variables into immutables by introducing a new symbol whenever the original was changed and using the new symbol for all following occurences (the original symbol won't be used after the point where it was re-assigned in the original code).</p>\n\n<p>Consider the following code:</p>\n\n<pre><code>// control flow block 1\nint i = 1;\nif (some_condition()) {\n    // control flow block 2\n    i = 2;\n}\n// control flow block 3\nint j = i;\n</code></pre>\n\n<p>With the control flow graph</p>\n\n<pre><code>[1]\n | \\     &lt;- if (some_condition())\n |  [2]\n | /     &lt;- join of control flow after the if block ends\n[3]\n</code></pre>\n\n<p>You could write a list of all symbols that are alive (have a value that is used anywhere later in the control flow graph) at the entry and exit point of a block in the control flow graph:</p>\n\n<pre><code>[1] entry: nothing; exit: i\n[2] entry: nothing; exit: i\n[3] entry: i; exit: i, j (I assume i, j are re-used after the end of this example)\n</code></pre>\n\n<p>Notice that <code>[2] entry</code> is empty, since <code>i</code> is never read and always written within block <code>[2]</code>. The problem with this representation is, that <code>i</code> is in the exit list of all blocks but it has different possible values for each block.</p>\n\n<p>So, lets introduce the immutable symbols in pseudo-code:</p>\n\n<pre><code>// control flow block 1\ni = 1;\nif (some_condition()) {\n    // control flow block 2\n    i_1 = 2;\n}\n// control flow block 3\n// join-logic of predecessor [1] and [2]\ni_2 = one_of(i, i_1);\nj = i_2;\n</code></pre>\n\n<p>Now every variable is coupled exactly to its first (and only) assignment. Meaning, a dependency graph can be constructed by analyzing the symbols that are involved in an assignment</p>\n\n<pre><code>i   -&gt; i_2\ni_1 -&gt; i_2\ni_2 -&gt; j\n</code></pre>\n\n<p>Now in case there is <strong>any constraint</strong> on the allowed value of <code>j</code>, a static checker could require that <strong>all predecessors</strong> of <code>j</code> (namely <code>i_2</code>, in turn originating from <code>i</code> and <code>i_1</code>), satisfy this requirement.</p>\n\n<p>In case of function calls, the dependency graph would contain an edge from every calling argument to the corresponding parameter in the function definition.</p>\n\n<p>Applying this to your example is straight forward if we only focus on the array variable and ignore changes to the array content (I'm not quite sure to what extent a static checker would track the content of individual array items in order to find danger down the road):</p>\n\n<p>Example 1:</p>\n\n<pre><code>void f1(char *s)\n{\n    s[20] = 0;\n}\n\nvoid f2()\n{\n    char a[10];\n    if (x + y == 2) {\n        f1(a);\n    }\n}\n</code></pre>\n\n<p>Transforms to</p>\n\n<pre><code>f1(s)\n{\n    s[20] = 0;\n}\n\nf2()\n{\n    a = char[10];\n    if (x + y == 2) {\n        call f1(a);\n    }\n}\n</code></pre>\n\n<p>With dependency graph including the passed arguments via function call</p>\n\n<pre><code>a -&gt; s\n</code></pre>\n\n<p>So it's immediately clear that <code>a</code> has to be considered for the static analysis of the safety of <code>s[20]</code>.</p>\n\n<p>Example 2:</p>\n\n<pre><code>void f1(char *s)\n{\n    char str_arry[30];\n    s= str_arry;\n    s[20] = 0;\n}\n</code></pre>\n\n<p>Transforms to</p>\n\n<pre><code>f1(s)\n{\n    // control flow block 1\n    str_arry = char[30];\n    s_1 = str_arry;\n    s_1[20] = 0;\n}\n</code></pre>\n\n<p>With dependency graph</p>\n\n<pre><code>str_arry -&gt; s_1\n</code></pre>\n\n<p>So it's immediately clear that the only value to be considered for the static analysis of the safety of <code>s_1[20]</code> is <code>str_arry</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 11794951, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uuo_IlTIRRI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reGO5NCeBOTbDQSzfEVe-XcfjHpmg/photo.jpg?sz=128", "display_name": "White Wang", "link": "https://stackoverflow.com/users/11794951/white-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1563466575, "creation_date": 1563328707, "last_edit_date": 1563329234, "question_id": 57067538, "link": "https://stackoverflow.com/questions/57067538/how-to-do-static-code-logical-analysis-with-ast-tree-or-other-tool", "title": "How to do static code logical analysis with AST tree or other tool?", "body": "<pre><code>void f1(char *s)\n{\n s[20] = 0;\n}\nvoid f2()\n{\n char a[10];\n if (x + y == 2) {\n f1(a);\n }\n}\n</code></pre>\n\n<p>Cppcheck will report this message:\nArray 'a[10]' index 20 out of bounds</p>\n\n<p>How could Cppcheck get the connection between \u2018a\u2019 in f2 and \u2018s\u2019 in f1? </p>\n\n<p>I have built AST tree, But It only supplies information of each symbol, and give little information to me on the logical relationship of symbols. \nHow could computer know \u2018a\u2019 in f2 and \u2018s\u2019 in f1 are the same thing?\nAs I know, we have to take so many situations into consideration, such as:</p>\n\n<pre><code>void f1(char *s)\n{\n char str_arry[30];\n s= str_arry;\n s[20] = 0;\n}\n</code></pre>\n\n<p>In this case 's' and 'a' are not the same things.</p>\n"}, {"tags": ["c", "string", "loops"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1563328021, "post_id": 57067452, "comment_id": 100659498, "body": "As a purely stylistic matter, you should use <code>break;</code> instead of <code>goto END_LOOP;</code>"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 3, "creation_date": 1563328163, "post_id": 57067452, "comment_id": 100659515, "body": "You should also never use <code>gets</code>.  The man page for it explicitly says this.  This may be the cause of your problem (or at least, allowing it to go undetected).  Your string buffer holds 20 <code>char</code> values, which gives you 19 usable string values plus one terminating null character.  If you enter any string larger than 19 characters, you will write past the end of your array and be subject to undefined behavior."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1563328256, "post_id": 57067452, "comment_id": 100659530, "body": "The function: <code>gets()</code> has been depreciated for many years and completely removed in the last two versions of C.  Suggest reading the MAN page for <code>fgets()</code> and using that function"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1563328480, "post_id": 57067452, "comment_id": 100659563, "body": "regarding: <code>char *resultKata = malloc(sizeof(char) * textlen);</code>  1) the expression: <code>sizeof(char)</code> is defined in the C standard as 1.  Multiplying anything by 1 has no effect and just clutters the code.  Suggest removing that expression.  2) the function: <code>malloc()</code> is expecting a parameter of type: <code>size_t</code>, but <code>textlen</code> is declared as an <code>int</code>  3) always check (!=NULL) the returned value to assure the operation was successful.  If not successful, call <code>perror( &quot;malloc failed&quot; );</code> to output both your error message and the text reason the system thinks the error occurred to <code>stderr</code>"}], "answers": [{"comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "reply_to_user": {"reputation": 31, "user_id": 11794956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zs4mTGKuXH4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reFYPGRUG90f8jeXYiDcovtPslbcw/photo.jpg?sz=128", "display_name": "auprojects all", "link": "https://stackoverflow.com/users/11794956/auprojects-all"}, "edited": false, "score": 0, "creation_date": 1563695515, "post_id": 57072967, "comment_id": 100778781, "body": "@auprojectsall Don&#39;t worry too much. Guess how all the professionals started... ;-)"}], "tags": [], "owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "is_accepted": false, "score": 2, "last_activity_date": 1563356986, "last_edit_date": 1563356986, "creation_date": 1563356615, "answer_id": 57072967, "question_id": 57067452, "link": "https://stackoverflow.com/questions/57067452/error-in-self-written-c-function-to-split-strings/57072967#57072967", "title": "Error in self written C function to split strings", "body": "<p>There appear a lot of <code>malloc()</code>s in the code of OP.</p>\n\n<p>Concerning the already given comments:</p>\n\n<blockquote>\n  <ol>\n  <li>Multiplying anything by 1 has no effect and just clutters the code. Suggest removing that expression.</li>\n  </ol>\n</blockquote>\n\n<p>IMHO, this is a matter of style. If it improves or weakens the readability of code is a matter of personal preference. I assume the compiler is clever enough to ignore the multiplication by 1, and I would ignore as well.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>the function: <code>malloc()</code> is expecting a parameter of type: <code>size_t</code>, but <code>textlen</code> is declared as an <code>int</code></li>\n  </ol>\n</blockquote>\n\n<p>Although I agree I don't see it as a critical point as long as the provided <code>int</code> value will be positive.</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>always check (!=NULL) the returned value to assure the operation was successful.</li>\n  </ol>\n</blockquote>\n\n<p>This is what I would recommend as well.</p>\n\n<p>What does me personally annoy is that there are some <code>malloc()</code>s in the code but not a single <code>free()</code>. Allocating memory with <code>malloc()</code> means, some heap memory is marked as &ldquo;in use&rdquo; in internal heap memory manager. If it is not <code>free()</code>d it will be marked &ldquo;as used&rdquo; until end of process life. Losing (e.g. overwriting) a pointer to an allocated memory makes it lost. (No possibility to address it again.) This is called <a href=\"https://en.wikipedia.org/wiki/Memory_leak\" rel=\"nofollow noreferrer\">memory leak</a>.</p>\n\n<p>Sure, this is not a critical issue in the exposed sample code but it might become one in larger applications with more heap memory consumption. Hence, I found it worth to be mentioned.</p>\n\n<p>The whole example seems to resemble what can be done with the standard library functions</p>\n\n<ul>\n<li><a href=\"https://en.cppreference.com/w/c/string/byte/strlen\" rel=\"nofollow noreferrer\"><code>strlen()</code></a></li>\n<li><a href=\"https://en.cppreference.com/w/c/string/byte/strtok\" rel=\"nofollow noreferrer\"><code>strtok()</code></a>.</li>\n</ul>\n\n<p>(Not that you get me wrong. I don't see anything bad to resemble standard functions for learning purposes.)</p>\n\n<p>There is actually nothing wrong with <code>getLengthString()</code>. However, it manages two count variables <code>i</code> and <code>len</code>. The OP might have missed that they have always the same value after each iteration step. Hence, one of them is redundant and can be eliminated:</p>\n\n<pre><code>int getLengthString(char *var_text)\n{\n  int len = 0;\n  while (var_text[len]) ++len;\n  return len;\n}\n</code></pre>\n\n<p>Concerning <code>getLengthSplitText()</code> (which is responsible to count words), I don't see why any <code>malloc()</code> is necessary at all. Thus, I wrote a new function <code>getNumTokens()</code> which counts the non-empty words (I call them &ldquo;tokens&rdquo;) which are separated by a certain split character:</p>\n\n<pre><code>int getNumTokens(char *var_text, char split)\n{\n  int n = 0;\n  for (int inToken = 0; *var_text; ++var_text) {\n    if (!inToken &amp;&amp; *var_text != split) ++n; // count if new token starts\n    inToken = *var_text != split; // update flag\n  }\n  return n;\n}\n</code></pre>\n\n<p>It's a bit shorter and doesn't need any <code>malloc()</code>.</p>\n\n<p>Please, note the variable <code>inToken</code> which is actually used as (boolean) flag. It is responsible to remember whether a token is already counted while iterating over text. It is updated in each iteration step by assigning the result of comparison of current character (<code>*var_text</code>) and the separator (<code>split</code>).</p>\n\n<p>The provided <code>var_text</code> is used for access and progress directly &ndash; no extra index is used. As there is only one iteration over text needed, it doesn't hurt that the pointer is changed. It's a local copy (passed by value) with limited life-time inside of function.</p>\n\n<p>Concerning <code>strtok()</code>, I once wrote a variant <code>strtoke()</code> (just for fun) as answer to <a href=\"https://stackoverflow.com/a/42315689/7478597\">SO: Split string into Tokens in C, when there are 2 delimiters in a row</a>.</p>\n\n<p>There are two facts to note:</p>\n\n<ol>\n<li><p><code>strtok()</code> modifies the input string by replacing an occurrence of a delimiter by a <code>\\0</code> byte (to delimit the found token).</p></li>\n<li><p><code>strtok()</code> manages an internal global state which makes it non-reentrant.</p></li>\n</ol>\n\n<p>The solution of OP seems to have none of those restrictions buying that with the usage of <code>malloc()</code> (with all the concerns mentioned above).</p>\n\n<p>So, I changed the assumptions a bit (there are actually no restrictions mentioned in OPs question). I considered modification of input (1.) as acceptable and wrote a new function <code>getNextToken()</code>:</p>\n\n<pre><code>char* getNextToken(char *var_text, char split)\n{\n  // skip space\n  for (; *var_text &amp;&amp; *var_text == split; ++var_text);\n  // remember start of token\n  char *token = var_text;\n  // skip token\n  for (; *var_text &amp;&amp; *var_text != split; ++var_text);\n  // remark end of token\n  *var_text = '\\0'; // doesn't hurt if there is already a '\\0'\n  // done\n  return token;\n}\n</code></pre>\n\n<p>The function will return the start of first token in <code>var_text</code>. If it is an empty string (the contents of returned pointer is <code>\\0</code>) then no token could be found.\nThereby, the end of found token is remarked with a <code>\\0</code>-Byte (in the given input string) which might be a split character before.</p>\n\n<p>As I didn't want a global internal state, I have to move from token to token outside of <code>getNextToken()</code>. I found this acceptable as it can be done using the function <code>getLengthString()</code> again. With this, a pointer can be moved from begin to end of token (where the <code>\\0</code>-Byte has been written). Adding 1, the possible start of next token is reached. Of course, this might break when the end of text is reached (where the address after the terminator <code>\\0</code> might be out of bound). For our luck, the number of tokens is already known.</p>\n\n<p>The complete sample:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint getLengthString(char *var_text);\nint getNumTokens(char *var_text, char split);\nchar* getNextToken(char *var_text, char split);\n\nint main()\n{\n  char var_text[100];\n  if (!fgets(var_text, 100, stdin)) {\n    fprintf(stderr, \"Input failed!\\n\");\n    return -1;\n  }\n  printf(\"Total Characters: %d\\n\", (int)getLengthString(var_text));\n  const char split = ' ';\n  const int nTokens = getNumTokens(var_text, split);\n  printf(\"Total Words: %d\\n\", nTokens);\n  printf(\"Split Result:\\n\");\n  char *token = var_text;\n  for (int i = 1; i &lt;= nTokens; ++i) {\n    token = getNextToken(token, split);\n    printf(\"#%2d-%s\\n\", i, token);\n    token += getLengthString(token) + 1;\n  }\n  return 0;\n}\n\nint getLengthString(char *var_text)\n{\n  int len = 0;\n  while (var_text[len]) ++len;\n  return len;\n}\n\nint getNumTokens(char *var_text, char split)\n{\n  int n = 0;\n  for (int inToken = 0; *var_text; ++var_text) {\n    if (!inToken &amp;&amp; *var_text != split) ++n; // count if new token starts\n    inToken = *var_text != split; // update flag\n  }\n  return n;\n}\n\nchar* getNextToken(char *var_text, char split)\n{\n  // skip space\n  for (; *var_text &amp;&amp; *var_text == split; ++var_text);\n  // remember start of token\n  char *token = var_text;\n  // skip token\n  for (; *var_text &amp;&amp; *var_text != split; ++var_text);\n  // remark end of token\n  *var_text = '\\0'; // doesn't hurt if there is already a '\\0'\n  // done\n  return token;\n}\n</code></pre>\n\n<p>Output for <code>I like C programming language but I have problem about this code.</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Total Characters: 66\nTotal Words: 12\nSplit Result:\n# 1-I\n# 2-like\n# 3-C\n# 4-programming\n# 5-language\n# 6-but\n# 7-I\n# 8-have\n# 9-problem\n#10-about\n#11-this\n#12-code.\n</code></pre>\n\n<p>Output for <code>Thank you for the help. Now, the code can work. I like programming.</code>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Total Characters: 68\nTotal Words: 13\nSplit Result:\n# 1-Thank\n# 2-you\n# 3-for\n# 4-the\n# 5-help.\n# 6-Now,\n# 7-the\n# 8-code\n# 9-can\n#10-work.\n#11-I\n#12-like\n#13-programming.\n</code></pre>\n\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/67962656b5298e73\" rel=\"nofollow noreferrer\"><strong>Live Demo on coliru</strong></a></kbd></p>\n"}], "owner": {"reputation": 31, "user_id": 11794956, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zs4mTGKuXH4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reFYPGRUG90f8jeXYiDcovtPslbcw/photo.jpg?sz=128", "display_name": "auprojects all", "link": "https://stackoverflow.com/users/11794956/auprojects-all"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1563356986, "creation_date": 1563327892, "last_edit_date": 1563351307, "question_id": 57067452, "link": "https://stackoverflow.com/questions/57067452/error-in-self-written-c-function-to-split-strings", "title": "Error in self written C function to split strings", "body": "<p>I just learned about string a few weeks ago, and I was interested in making my own function. At first I tried a short sentence and it worked, but I encountered a problem when I tried a long sentence...</p>\n\n<p>The problem might be in the \"getSplitText\" function, how can I fix this error?</p>\n\n<p>Is it bad to use for loop for this case?</p>\n\n<p>Before</p>\n\n<p><img src=\"https://i.stack.imgur.com/a3NxG.png\" alt=\"image 1\"></p>\n\n<p>After</p>\n\n<p><img src=\"https://i.stack.imgur.com/DCMIp.png\" alt=\"image 2\"></p>\n\n<p>This is my code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar *getSplitText(char *var_text, char split, int index);\nint getLengthSplitText(char *var_text, char split);\nint getLengthString(char *var_text);\n\nint main(){\n    char var_text[100];\n    fgets(var_text,100,stdin);\n    int i;\n    printf(\"Total Characters: %d\\n\",getLengthString(var_text));\n    printf(\"Total Words: %d\\n\",getLengthSplitText(var_text,' '));\n    printf(\"Split Result:\\n\");\n    for(i=1;i&lt;=getLengthSplitText(var_text,' ');i++){\n        printf(\"#%d-%s\\n\",i,getSplitText(var_text,' ',i));\n    }\n\n   return 0;\n}\n\nint getLengthString(char *var_text){\n    int len = 0, i = 0;\n    while (var_text[i] != '\\0'){\n        len++;\n        i++;\n    }\n    return len;\n}\n\nint getLengthSplitText(char *var_text, char split){\n\n    int textlen = getLengthString(var_text);\n    int lenKata=0;\n    char *resultKata = malloc(sizeof(char) * textlen);\n    resultKata[0]='\\0';\n    int i,j=0;\n    for(i=0;i&lt;textlen;i++){\n\n        if(var_text[i]!=split){\n\n            if(textlen-1==i){\n                resultKata[j] = var_text[i];\n                resultKata[j + 1] = '\\0';\n                lenKata ++;\n            }else {\n                resultKata[j] = var_text[i];\n                j++;\n                resultKata[j + 1] = '\\0';\n            }\n            //printf(\"#1 %s\\n\",resultKata);\n\n        }else if(var_text[i]==split){\n\n            if(resultKata[0]!='\\0'){\n                lenKata ++;\n                }else{\n                    j = 0;\n                    resultKata[0] = '\\0';\n                }\n            }\n            //printf(\"#2 %s\\n\",resultKata);\n        }\n    return lenKata;\n    }\n\nchar *getSplitText(char *var_text,char split, int index){\n\n    int textlen = getLengthString(var_text);\n    char *resultKata = malloc(sizeof(char) * textlen);\n    resultKata[0]='\\0';\n\n    if(index&lt;=getLengthSplitText(var_text,split)) {\n        int i,j=0;\n        int lenKata=0;\n\n        for (i = 0; i &lt; textlen; i++) {\n\n            if (var_text[i] != split) {\n\n                if (textlen - 1 == i) {\n                    resultKata[j] = var_text[i];\n                    resultKata[j + 1] = '\\0';\n                    lenKata++;\n                    break;\n                } else {\n                    resultKata[j] = var_text[i];\n                    j++;\n                    resultKata[j + 1] = '\\0';\n                }\n                //printf(\"#1 %s\\n\",resultKata);\n\n            } else if (var_text[i] == split) {\n\n                if (resultKata[0] != '\\0') {\n                    lenKata++;\n                    if (lenKata == index) {\n                        resultKata[j] = '\\0';\n                        break;\n                    } else {\n                        j = 0;\n                        resultKata[0] = '\\0';\n                    }\n                }\n                //printf(\"#2 %s\\n\",resultKata);\n            }\n        }\n    }\n    return resultKata;\n}\n</code></pre>\n"}, {"tags": ["c", "openbsd", "bpf"], "comments": [{"owner": {"reputation": 77122, "user_id": 106671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a910ad61c5827193f003a11be5dacb14?s=128&d=identicon&r=PG", "display_name": "Nikolai Fetissov", "link": "https://stackoverflow.com/users/106671/nikolai-fetissov"}, "edited": false, "score": 0, "creation_date": 1563327119, "post_id": 57067292, "comment_id": 100659344, "body": "Have no experience coding for BPF, but are you sure opening the bpf device file read-only would let you bind it to the NIC with that second ioctl?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1563329367, "post_id": 57067292, "comment_id": 100659723, "body": "the interface <code>em0</code> has a modifier that only allows the group: <code>egress</code>  The interface <code>em1</code> has no such restriction.  Suggest using <code>em1</code>"}], "owner": {"reputation": 35, "user_id": 11144586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27e1842fc8e17396b1df0a80197e9c87?s=128&d=identicon&r=PG", "display_name": "Lucky The Rabbit", "link": "https://stackoverflow.com/users/11144586/lucky-the-rabbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1563326270, "creation_date": 1563326270, "question_id": 57067292, "link": "https://stackoverflow.com/questions/57067292/binding-a-bpf-descriptor-to-an-interface", "title": "Binding a BPF descriptor to an interface", "body": "<p>I'm trying to write a small C program on an OpenBSD vm I just installed, and cannot get my file descriptor (to <code>/dev/bpf</code>) to bind to my interface.</p>\n\n<p>OpenBSD info:</p>\n\n<pre><code>openbsd:waffles uplime$ uname -a\nOpenBSD openbsd.securitea.app 6.5 GENERIC#3 amd64\nopenbsd:waffles uplime$ ifconfig\nlo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 32768\n    index 4 priority 0 llprio 3\n    groups: lo\n    inet6 ::1 prefixlen 128\n    inet6 fe80::1%lo0 prefixlen 64 scopeid 0x4\n    inet 127.0.0.1 netmask 0xff000000\nem0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500\n    lladdr 00:0c:29:34:99:7b\n    index 1 priority 0 llprio 3\n    groups: egress\n    media: Ethernet autoselect (1000baseT full-duplex,master)\n    status: active\n    inet 10.10.73.199 netmask 0xfffffc00 broadcast 10.10.75.255\nem1: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500\n    lladdr 00:0c:29:34:99:85\n    index 2 priority 0 llprio 3\n    media: Ethernet autoselect (1000baseT full-duplex,master)\n    status: active\n    inet 172.16.221.129 netmask 0xffffff00 broadcast 172.16.221.255\nenc0: flags=0&lt;&gt;\n    index 3 priority 0 llprio 3\n    groups: enc\n    status: active\npflog0: flags=141&lt;UP,RUNNING,PROMISC&gt; mtu 33136\n    index 5 priority 0 llprio 3\n    groups: pflog\nopenbsd:waffles uplime$\n</code></pre>\n\n<p>However, when I try to bind my descriptor to <code>em0</code>, I get the following error:</p>\n\n<pre><code>openbsd:waffles uplime$ cc -std=c99 -Wall -Wextra -pedantic -g -O1 -o tmp/test tmp/test.c\nopenbsd:waffles uplime$ doas tmp/test\nioctl: em0: Device not configured\nopenbsd:waffles uplime$\n</code></pre>\n\n<p>I'm using the following testcase:</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;net/bpf.h&gt;\n#include &lt;net/if.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/ioctl.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {\n  int fd = open(\"/dev/bpf\", O_RDONLY);\n  int packet_max = 32768;\n\n  if(fd &lt; 0) {\n    fprintf(stderr, \"open: /dev/bpf: %s\\n\", strerror(errno));\n    return 1;\n  }\n\n  if(ioctl(fd, BIOCSBLEN, &amp;packet_max) &lt; 0) {\n    fprintf(stderr, \"ioctl: BIOCSBLEN: %s\\n\", strerror(errno));\n    return 1;\n  }\n\n  struct ifreq req;\n  memset(&amp;req, 0, sizeof(req));\n  strcpy(req.ifr_name, \"em0\");\n\n  if(ioctl(fd, BIOCSETIF, req) &lt; 0) {\n    fprintf(stderr, \"ioctl: em0: %s\\n\", strerror(errno));\n    return 1;\n  }\n\n  return 0;\n}\n</code></pre>\n\n<p>I know the interface is fine, because it is the only one connected to the internet, and I'm able to make inbound/outbound requests without issue. I can also run <code>tcpdump -i em0</code> without issue. Am I missing an ioctl call (or something similar) to make the interface usable?</p>\n"}, {"tags": ["c++", "c", "linux", "visual-studio-2017", "openssl"], "comments": [{"owner": {"reputation": 731, "user_id": 4254084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/773716242749160/picture?type=large", "display_name": "Fi Ras", "link": "https://stackoverflow.com/users/4254084/fi-ras"}, "edited": false, "score": 0, "creation_date": 1563331811, "post_id": 57067219, "comment_id": 100660135, "body": "I&#39;m not sure, but have you checked access permissions of file &#39;.key&#39; ?"}, {"owner": {"reputation": 109, "user_id": 3741969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b128d4bab30a212158ebb1e49e4a2110?s=128&d=identicon&r=PG&f=1", "display_name": "siamenock", "link": "https://stackoverflow.com/users/3741969/siamenock"}, "reply_to_user": {"reputation": 731, "user_id": 4254084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/773716242749160/picture?type=large", "display_name": "Fi Ras", "link": "https://stackoverflow.com/users/4254084/fi-ras"}, "edited": false, "score": 0, "creation_date": 1563338643, "post_id": 57067219, "comment_id": 100661350, "body": "@Fi Ras It has been less than a week to make &#39;.key&#39; file. and I made it again but not worked."}], "owner": {"reputation": 109, "user_id": 3741969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b128d4bab30a212158ebb1e49e4a2110?s=128&d=identicon&r=PG&f=1", "display_name": "siamenock", "link": "https://stackoverflow.com/users/3741969/siamenock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563514651, "creation_date": 1563325505, "last_edit_date": 1563514651, "question_id": 57067219, "link": "https://stackoverflow.com/questions/57067219/debug-console-not-blocked-for-std-input-required-by-library-function", "title": "Debug console not blocked for std input required by library function", "body": "<p>Every <strong>code works fine. Debugging with visual studio is problem</strong>.</p>\n\n<p>I'm making Linux server using openSSL library with c++11.</p>\n\n<p>The server runs on CentOS in VMware. (Will move to Azure when completed)</p>\n\n<p>I work on Visual studio 2017, cross-compile linked with that CentOS.</p>\n\n<p>When I call</p>\n\n<pre><code>int SSL_CTX_use_PrivateKey_file(SSL_CTX *ctx, const char *file, int type);\n</code></pre>\n\n<p>this funcntion in ssl library, it opens private key file, require me password on standard input, showing up message on standard out and wait for my input.</p>\n\n<p>But if I run on Visual studio debug mode, it just passes away.</p>\n\n<p>It works fine when I use .out file on CentOS, and that '.out' file is compiled by visual studio for debugging.</p>\n\n<p>It's not a path problem. '.crt' file opens well and only '.key' file in the same folder not opens well.</p>\n\n<p>these are the code where problem occur.\nSslUtil, ExceptionSslUtil class is in my own code. but the other all functions and structures in this code are in ssl library.</p>\n\n<pre><code>void SslUtil::InitAsServer(const char* pathCert, const char* pathKey) {\n    amIServer = true;\n    SSL_load_error_strings();\n    SSLeay_add_ssl_algorithms();\n    meth = SSLv23_server_method();\n    ctx = SSL_CTX_new(meth);\n\n    if (!ctx)\n        throw ExceptionSslUtil(\"ctx create error\");\n    if (SSL_CTX_use_certificate_file(ctx, pathCert, SSL_FILETYPE_PEM) &lt;= 0)\n        throw ExceptionSslUtil(\"cert file open error\");\n    if (SSL_CTX_use_PrivateKey_file( ctx, pathKey, SSL_FILETYPE_PEM) &lt;= 0)// here's the problem.\n        throw ExceptionSslUtil(\"private key file open error\");\n    if (!SSL_CTX_check_private_key(ctx))\n        throw ExceptionSslUtil(\"Private key does not match the certificate public keyn\");                                                                                                                                       \n    return;\n}\n</code></pre>\n\n<p>SSL_CTX_use_PrivateKey_file function not blocked for input, just returning minus value. It has to wait for input but not.</p>\n\n<p>I have no idea what's happening there.\nIt worked previously,</p>\n\n<p>but when I change original main(argc, argv) function into mainSslEpoll(argc, argv) and make it called by other main function, this problem happen... why?\nThe following is my new main function.</p>\n\n<pre><code>int main(int argc, char** argv) {\n    string str;\n    while (true) {\n        cout &lt;&lt; \"select mode\" &lt;&lt; endl;\n        cout &lt;&lt; \"\\t\" &lt;&lt; \"0:SSL + Epoll server\" &lt;&lt; endl;\n        cout &lt;&lt; \"\\t\" &lt;&lt; \"1:SSL server\" &lt;&lt; endl;\n        cout &lt;&lt; \"\\t\" &lt;&lt; \"2:SSL client\" &lt;&lt; endl;\n        cin &gt;&gt; str;\n        if (str[0] == '0') return mainSslEpoll(argc, argv);\n        if (str[0] == '1') return mainSslServer(argc, argv);\n        if (str[0] == '2') return mainSslClient(argc, argv);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "static-libraries", "visual-studio-2019"], "answers": [{"comments": [{"owner": {"reputation": 34, "user_id": 11794720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4a7946b4519e63fc6a897f1d8aa260?s=128&d=identicon&r=PG&f=1", "display_name": "CVR-Skidz", "link": "https://stackoverflow.com/users/11794720/cvr-skidz"}, "edited": false, "score": 0, "creation_date": 1563325728, "post_id": 57066983, "comment_id": 100659101, "body": "Thanks for the answer, would i need to have my library at the root of my project directory? Or does the location not matter."}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "reply_to_user": {"reputation": 34, "user_id": 11794720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4a7946b4519e63fc6a897f1d8aa260?s=128&d=identicon&r=PG&f=1", "display_name": "CVR-Skidz", "link": "https://stackoverflow.com/users/11794720/cvr-skidz"}, "edited": false, "score": 0, "creation_date": 1563326012, "post_id": 57066983, "comment_id": 100659147, "body": "Yes put your lib in the directory with your header and c files. Since the path is relative. If you want to provide an absolute path to a directory you can do that too."}, {"owner": {"reputation": 34, "user_id": 11794720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4a7946b4519e63fc6a897f1d8aa260?s=128&d=identicon&r=PG&f=1", "display_name": "CVR-Skidz", "link": "https://stackoverflow.com/users/11794720/cvr-skidz"}, "edited": false, "score": 0, "creation_date": 1563326165, "post_id": 57066983, "comment_id": 100659175, "body": "Ahhh, i was so stupid, my library was built for x64 and my target platform for the program was x86, changing this and using <code>#pragma comment works</code>!"}, {"owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "reply_to_user": {"reputation": 34, "user_id": 11794720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4a7946b4519e63fc6a897f1d8aa260?s=128&d=identicon&r=PG&f=1", "display_name": "CVR-Skidz", "link": "https://stackoverflow.com/users/11794720/cvr-skidz"}, "edited": false, "score": 0, "creation_date": 1563326272, "post_id": 57066983, "comment_id": 100659195, "body": "Glad I could help."}], "tags": [], "owner": {"reputation": 2323, "user_id": 8350647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJNHD.png?s=128&g=1", "display_name": "Nina", "link": "https://stackoverflow.com/users/8350647/nina"}, "is_accepted": true, "score": 0, "last_activity_date": 1563322862, "creation_date": 1563322862, "answer_id": 57066983, "question_id": 57066929, "link": "https://stackoverflow.com/questions/57066929/how-would-i-link-a-lib-library-from-a-different-solution-in-visual-studio-201/57066983#57066983", "title": "How would I link a `.lib` library from a different solution in Visual Studio 2019?", "body": "<p>You can link libraries through the #pragma directive. Try this.\n<code>#pragma comment(lib,\"libname\")</code> At the top of your C/header file. Where libname is obviously the name of your library you are linking. The quotations need to stay.</p>\n"}], "owner": {"reputation": 34, "user_id": 11794720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4a7946b4519e63fc6a897f1d8aa260?s=128&d=identicon&r=PG&f=1", "display_name": "CVR-Skidz", "link": "https://stackoverflow.com/users/11794720/cvr-skidz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 57066983, "answer_count": 1, "score": 2, "last_activity_date": 1563322862, "creation_date": 1563322228, "question_id": 57066929, "link": "https://stackoverflow.com/questions/57066929/how-would-i-link-a-lib-library-from-a-different-solution-in-visual-studio-201", "title": "How would I link a `.lib` library from a different solution in Visual Studio 2019?", "body": "<p>Currently I am building a static library to read bitmap images in C. I am wanting for others to be able to link the library without access to the Visual Studio project it was created in. I can not figure out how to link my '.lib' file to another project, any ideas?</p>\n\n<p>I am trying to use Visual Studio 2019. My '.lib' compiles successfully, when I reference it in another project (by adding a reference in the solution explorer) within the same solution everything works as intended.</p>\n\n<p>However when I try to add it in a different solution by either setting the additional dependencies and library directories in the project configuration or adding the library to the resources folder the linker can not find the definitions for my header files in the library.</p>\n\n<p>I have tried to set </p>\n\n<pre><code>Properties&gt;Linker&gt;General&gt;Additional Library Directories\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Properties&gt;Linker&gt;Input&gt;Additional Dependencies\n</code></pre>\n\n<p>Both the properties I type in evaluate to the correct path but i still have no luck.</p>\n\n<p>I expect my program to compile and run as it does when adding a reference to the library project within the same solution.</p>\n\n<p>What i receive is:</p>\n\n<pre><code>Error   LNK2001 unresolved external symbol (any function symbol here)\n</code></pre>\n\n<p>Any help is appreciated, this is my first question so I am sorry if it is unclear :).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 418, "user_id": 5191613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ffb0b8a64f3d3d1067840169a91a98?s=128&d=identicon&r=PG&f=1", "display_name": "Clayton L", "link": "https://stackoverflow.com/users/5191613/clayton-l"}, "edited": false, "score": 1, "creation_date": 1563322504, "post_id": 57066910, "comment_id": 100658587, "body": "I&#39;m not quite sure what&#39;s going on with your malloc call.  The sizeof operator can be applies to structs, so really it seems like you should be calling something along the lines of <code>malloc(sizeof(struct s_stock_str) * ac)</code> to get chunk of memory that can hold <i>ac</i> of the type <i>struct s_stock_str</i>"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1563322540, "post_id": 57066910, "comment_id": 100658596, "body": "Since you trying to create an array of <code>s_stock_str</code> elements and index it up to the value <code>ac-1</code>, you should be allocating <code>pointeur = malloc(sizeof(s_stock_str) * ac);</code>.  Also, you have not shown what the <code>copie</code> function does."}, {"owner": {"reputation": 33, "user_id": 11785248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2ae68c53cbd58f3c18a18d07f21f6e?s=128&d=identicon&r=PG&f=1", "display_name": "pikl", "link": "https://stackoverflow.com/users/11785248/pikl"}, "edited": false, "score": 0, "creation_date": 1563324458, "post_id": 57066910, "comment_id": 100658924, "body": "the copie fonction only copie src to a pointer of char and give it to the outpout :/ nothing else          char    <i>copie(char *av, int size, int i)         { \tchar *copier;  \ti = 0; \tcopier = malloc(sizeof(*av)</i> (size + 1)); \twhile(av[i]) \t{ \t\tcopier[i] = av[i]; \t\ti++;             }            copier[i] = av[i];           return (copier);          }"}, {"owner": {"reputation": 33, "user_id": 11785248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2ae68c53cbd58f3c18a18d07f21f6e?s=128&d=identicon&r=PG&f=1", "display_name": "pikl", "link": "https://stackoverflow.com/users/11785248/pikl"}, "reply_to_user": {"reputation": 418, "user_id": 5191613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33ffb0b8a64f3d3d1067840169a91a98?s=128&d=identicon&r=PG&f=1", "display_name": "Clayton L", "link": "https://stackoverflow.com/users/5191613/clayton-l"}, "edited": false, "score": 0, "creation_date": 1563324665, "post_id": 57066910, "comment_id": 100658961, "body": "@ClaytonL you are a genuis , i make a sizeof the struct and it work , thank you very mush"}], "answers": [{"tags": [], "owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "is_accepted": false, "score": 0, "last_activity_date": 1563344975, "creation_date": 1563344975, "answer_id": 57069754, "question_id": 57066910, "link": "https://stackoverflow.com/questions/57066910/problem-with-malloc-77128-0x7fffb99573c0-malloc-error-for-object-0x7fd77c/57069754#57069754", "title": "problem with malloc (77128,0x7fffb99573c0) malloc: *** error for object 0x7fd77c4025c8:", "body": "<pre><code>s_stock_str *pointeur;\n...\npointeur[i].size = size;\n...\n</code></pre>\n\n<p>You are definitely writing to unallocated memory if <code>i &gt; 1</code> (you <code>malloc</code>ated memory for only one element).</p>\n\n<hr>\n\n<p>Also, this:</p>\n\n<pre><code>i = 1;\nwhile (i &lt; ac)\n{\n  size = tailletableau(av[i],i);\n  pointeur[i].size = size;\n  pointeur[i].str = av[i];\n  pointeur[i].copy = copie(av[i],size, i);\n  i++;\n}\n</code></pre>\n\n<p>should be written as a <code>for</code> (for simplicity and readability):</p>\n\n<pre><code>for( i = 1; i &lt; ac; i++)\n{\n  size = tailletableau(av[i],i);\n  pointeur[i].size = size;\n  pointeur[i].str = av[i];\n  pointeur[i].copy = copie(av[i],size, i);\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11785248, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df2ae68c53cbd58f3c18a18d07f21f6e?s=128&d=identicon&r=PG&f=1", "display_name": "pikl", "link": "https://stackoverflow.com/users/11785248/pikl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563344975, "creation_date": 1563321925, "last_edit_date": 1563325648, "question_id": 57066910, "link": "https://stackoverflow.com/questions/57066910/problem-with-malloc-77128-0x7fffb99573c0-malloc-error-for-object-0x7fd77c", "title": "problem with malloc (77128,0x7fffb99573c0) malloc: *** error for object 0x7fd77c4025c8:", "body": "<p>I have homework to do with malloc and have an issue.</p>\n\n<p>I have to take what is given as a array of string in av and put it in a structure that goes like this:  </p>\n\n<pre><code>typedef struct s_stock_str\n{\n     int size;    // the size of the string\n     char *str;   // the string\n     char *copy;  // a copie of the string \n} s_stock_str;\n</code></pre>\n\n<p>The problem is that I count all the characters that the chain in the array have and malloc it to a pointer in this form: </p>\n\n<pre><code>lentstr = ((lentstr + ac -1) * 2 + ((ac -1 )*sizeof(int)));\npointeur = malloc((sizeof(char) * lentstr));\n</code></pre>\n\n<p>lentstr + ac -1 for the space of '\\0'<br>\n*2 for the place of the copy<br>\n((ac -1 )*sizeof(int)) for the size of the int  </p>\n\n<p>and I multiply everything with the size of a char.<br>\nac is the number of arguments and we don't use the first one so I put -1.</p>\n\n<p>I malloc everything but after first argument it give me this error:  </p>\n\n<blockquote>\n  <p>a.out(77128,0x7fffb99573c0) malloc: <strong>* error for object\n  0x7fd77c4025c8: incorrect checksum for freed object - object was\n  probably modified after being freed.\n  *</strong> set a breakpoint in malloc_error_break to debug</p>\n</blockquote>\n\n<p>Could someone explain to me what is this ?</p>\n\n<pre><code>int     taille(int ac, char **av)\n{\n  int i;\n  int a;\n  int compteur;\n\n  compteur = 0;\n  i = 0;\n  a = 1;\n  while(a &lt; ac )\n  {\n    i = 0;\n    while(av[a][i++])\n        compteur++;\n    a++;\n  }\n  return (compteur);\n}\n\nstruct s_stock_str *ft_strs_to_tab(int ac, char **av)\n{\n  s_stock_str *pointeur;\n  int lentstr;\n  int i;\n  int size;\n\n  lentstr = taille(ac, av);\n  lentstr = ((lentstr + ac -1) * 2 + ((ac -1 )*sizeof(int)));\n  pointeur = malloc((sizeof(char) * lentstr));\n  i = 1;\n  while (i &lt; ac)\n  {\n    size = tailletableau(av[i],i);\n    pointeur[i].size = size;\n    pointeur[i].str = av[i];\n    pointeur[i].copy = copie(av[i],size, i);\n    i++;\n  }   \n  return pointeur;\n}\n</code></pre>\n"}, {"tags": ["c", "openssl", "asn.1", "der", "libcrypto"], "owner": {"reputation": 575, "user_id": 5116581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/68e6f94f4333705a5f74190057d92c91?s=128&d=identicon&r=PG&f=1", "display_name": "Arya Pourtabatabaie", "link": "https://stackoverflow.com/users/5116581/arya-pourtabatabaie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1563320503, "creation_date": 1563320503, "question_id": 57066759, "link": "https://stackoverflow.com/questions/57066759/looping-through-asn-1-sequence-using-openssl-libcrypto", "title": "Looping Through ASN.1 Sequence Using OpenSSL Libcrypto", "body": "<p>Given a sequence object, how can one iterate through the objects inside it? I've tried <code>ASN1_TYPE_unpack_sequence</code> but have no idea how to interpret the objects it returns.</p>\n\n<p>Here is a toy example, the DER encoding of a sequence containing an empty octet string.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;openssl/asn1.h&gt;\n\nint main()\n{\n    unsigned char der_bytes[] = {48, 2, 4, 0};\n\n    //Parse DER\n\n    ASN1_TYPE *sequence = 0;\n    const unsigned char * der_bytes_iterator = der_bytes;\n    sequence = d2i_ASN1_TYPE(sequence, &amp;der_bytes_iterator, sizeof der_bytes);\n\n    //Make sure it was parsed properly\n\n    if (der_bytes_iterator != der_bytes.data + sizeof der_bytes)\n    {\n        puts(\"Failed to consume DER string\\n\");\n        return 1;\n    }\n\n    if (sequence-&gt;type != V_ASN1_SEQUENCE)\n    {\n        printf(\"Expected type tag %d, got %d.\\n\", V_ASN1_SEQUENCE, sequence-&gt;type);\n        return 2;\n    }\n\n    //Try to iterate using ASN1_TYPE_unpack_sequece\n\n    const ASN1_ITEM *item = ASN1_ITEM_rptr(ASN1_ANY);\n    void * unpack_result = ASN1_TYPE_unpack_sequence(item, sequence);\n\n    //Now what?\n    return 0;\n}\n</code></pre>\n\n<p>What is interesting is that <code>{48, 0}</code> encodes an empty sequence and <code>{4, 0}</code> encodes an empty octet string. So it seems like if I can only have the sequence's header parsed to know how long the header itself is and how much \"payload\" there is, I can just skip the header and keep parsing objects one by one until the payload is exhausted, no extra context required. Although this may be a dangerously naive view of how DER works.</p>\n"}, {"tags": ["c", "character-encoding"], "comments": [{"owner": {"reputation": 967, "user_id": 5294619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/afe990a13c278488b9e2268e226f082a?s=128&d=identicon&r=PG&f=1", "display_name": "ddbug", "link": "https://stackoverflow.com/users/5294619/ddbug"}, "edited": false, "score": 0, "creation_date": 1563320696, "post_id": 57066709, "comment_id": 100658251, "body": "Do you save the C file as utf-8 or MBCS or UCS-16? Linux or Windows (which version)? A short answer is that Windows 10 tends to fully support UTF-8, and UTF-8 becomes the common encoding everywhere. Then a UTF-8 string in C indeed is a dumb array of bytes, unless you try to split it to characters."}, {"owner": {"reputation": 89955, "user_id": 130758, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/MbIFT.jpg?s=128&g=1", "display_name": "devoured elysium", "link": "https://stackoverflow.com/users/130758/devoured-elysium"}, "reply_to_user": {"reputation": 967, "user_id": 5294619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/afe990a13c278488b9e2268e226f082a?s=128&d=identicon&r=PG&f=1", "display_name": "ddbug", "link": "https://stackoverflow.com/users/5294619/ddbug"}, "edited": false, "score": 0, "creation_date": 1563320740, "post_id": 57066709, "comment_id": 100658262, "body": "Hi! I&#39;m on Ubuntu 16.04 LTS. CLion indicates it&#39;s a UTF-8 file (as expected in Linux)."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1563321313, "post_id": 57066709, "comment_id": 100658382, "body": "<i>The C Programming Language</i> was published in 1978. Unicode started in 1991. Should it surprise you that C doesn&#39;t handle character encodings well?"}, {"owner": {"reputation": 967, "user_id": 5294619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/afe990a13c278488b9e2268e226f082a?s=128&d=identicon&r=PG&f=1", "display_name": "ddbug", "link": "https://stackoverflow.com/users/5294619/ddbug"}, "edited": false, "score": 0, "creation_date": 1563321326, "post_id": 57066709, "comment_id": 100658385, "body": "C is unfortunate language where a character must be integral type. In all normal languages a character is a string that is one character long. No matter how it is represented internally and how many bytes it needs. So you can extract one character and print it an it will work. In C, char is one byte which can be any part of UTF-8 character. Or, resort to longer integers (16, 32 bits...). If you are interested in C++ too, read about char8_t."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1563321853, "post_id": 57066709, "comment_id": 100658467, "body": "<code>for (int i = 0; i &lt; sizeof str; i++)  printf(&quot;%d&quot;, str[i]);</code> to reveal details and see true encoding."}, {"owner": {"reputation": 89955, "user_id": 130758, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/MbIFT.jpg?s=128&g=1", "display_name": "devoured elysium", "link": "https://stackoverflow.com/users/130758/devoured-elysium"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1563321859, "post_id": 57066709, "comment_id": 100658469, "body": "@LeeDanielCrocker: I never said I was. The question is: if C doesn&#39;t care, at which point are the encoded characters assembled?"}, {"owner": {"reputation": 89955, "user_id": 130758, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/MbIFT.jpg?s=128&g=1", "display_name": "devoured elysium", "link": "https://stackoverflow.com/users/130758/devoured-elysium"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1563321882, "post_id": 57066709, "comment_id": 100658471, "body": "@chux I did that too, yes."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1563321951, "post_id": 57066709, "comment_id": 100658478, "body": "devoured elysium, perhaps you did on your machine but that result is not here. Notice <code>sizeof</code> and <code>&quot;%d&quot;</code>."}, {"owner": {"reputation": 967, "user_id": 5294619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/afe990a13c278488b9e2268e226f082a?s=128&d=identicon&r=PG&f=1", "display_name": "ddbug", "link": "https://stackoverflow.com/users/5294619/ddbug"}, "edited": false, "score": 1, "creation_date": 1563323673, "post_id": 57066709, "comment_id": 100658794, "body": "@devouredelysium If the characters are sent to a graphic device (terminal, printer), it  assembles them to visible form. If characters are sent to file, they remain dumb arrays of bytes. The C language plays very small role in this. C++ streams know about encoding more, but this knowledge is devalued by universal use of UTF-8 ."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1563380306, "post_id": 57066709, "comment_id": 100683648, "body": "At least three things to be aware of that are relevant to character encodings in C: source-charset, exec-charset and locales. (The first two are very simple. The third, I probably wouldn&#39;t explain sufficiently or accurately in general.)"}], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 1, "last_activity_date": 1563324282, "creation_date": 1563324282, "answer_id": 57067124, "question_id": 57066709, "link": "https://stackoverflow.com/questions/57066709/at-what-point-do-encodings-enter-into-play-in-c-if-at-all-how-do-strings-get-p/57067124#57067124", "title": "At what point do encodings enter into play in C, if at all? How do strings get properly printed, then?", "body": "<p>The printing isn't a function of C, but of the display context, whatever that is. For a terminal there are UTF-8 decoding functions which map the raw character data into the character to be shown on screen using a particular font. A similar sort of display logic happens in graphical applications, though with even more complexity relating to proportional font widths, ligatures, hyphenation, and numerous other typographical concerns.</p>\n\n<p>Internally this is often done by decoding UTF-8 into some intermediate form first, like UTF-16 or UTF-32, for look-up purposes. In extremely simple terms, each character in a font has a Unicode identifier. In practice this is a lot more complicated as there is room for character variants, and multiple characters may be represented by a singular character in a font, like  \"fi\" and \"ff\" <a href=\"https://en.wikipedia.org/wiki/Typographic_ligature\" rel=\"nofollow noreferrer\">ligatures</a>. Accented characters like \"\u00e7\" may be a combination of characters, as allowed by Unicode. That's where things like <a href=\"https://stackoverflow.com/questions/6579844/how-does-zalgo-text-work\">Zalgo text</a> come about: you can often stack a truly ridiculous number of Unicode \"combining characters\" together into a single output character.</p>\n\n<p>Typography is a complex world with complex libraries required to render properly.</p>\n\n<p>You can handle UTF-8 data in C, but only with special libraries. Nothing that C ships with in the Standard Library can understand them, to C it's just a series of bytes, and it assumes byte is equivalent to character for the purposes of length. That is <code>strlen</code> and such work with bytes as a unit, not characters.</p>\n\n<p>C++, as an example, has much better support for this distinction between byte and character. Other languages have even better support, with languages like Swift having exceptional support for UTF-8 specifically and Unicode in general.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1563327216, "creation_date": 1563327216, "answer_id": 57067384, "question_id": 57066709, "link": "https://stackoverflow.com/questions/57066709/at-what-point-do-encodings-enter-into-play-in-c-if-at-all-how-do-strings-get-p/57067384#57067384", "title": "At what point do encodings enter into play in C, if at all? How do strings get properly printed, then?", "body": "<p><code>printf(\"_%c_\", str[i]);</code> prints the character associated with each <code>str[i]</code> - one at a time.</p>\n\n<p>The value of <code>char str[i]</code> is converted to an <code>int</code> when passed ot a <code>...</code> function.  The <code>int</code> value is then converted to <code>unsigned char</code> as directed by <code>\"%c\"</code> and \"and the resulting character is written\". </p>\n\n<p><code>char str[] = \"Jo\u00e3o\";</code> does not certainly specify a UTF8 sequence.  That in an implementation detail.  A specified way is to use <code>char str[] = u8\"Jo\u00e3o\";</code> since C11 (or maybe C99).</p>\n\n<p><code>printf()</code> does not specify a direct way to print <em>UTF8 stirrings</em>.</p>\n"}], "owner": {"reputation": 89955, "user_id": 130758, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/MbIFT.jpg?s=128&g=1", "display_name": "devoured elysium", "link": "https://stackoverflow.com/users/130758/devoured-elysium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1563327216, "creation_date": 1563320098, "question_id": 57066709, "link": "https://stackoverflow.com/questions/57066709/at-what-point-do-encodings-enter-into-play-in-c-if-at-all-how-do-strings-get-p", "title": "At what point do encodings enter into play in C, if at all? How do strings get properly printed, then?", "body": "<p>To investigate how C deals with UTF-8 / Unicode characters, I did this little experiment. </p>\n\n<p>It's not that I'm trying to solve anything particular at the moment, but I know that Java deals with the whole encoding situation in a transparent way to the coder and I was wondering how C, that is a lot lower level, treats its characters.</p>\n\n<p>The following test seems to indicate that C is entirely ignorant about encoding concerns, as that it's just up to the display device to know how to interpret the sequence of chars when showing them on screen. The later tests (when printing the characters surrounded by <code>_</code>) seem particular telling?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    char str[] = \"Jo\u00e3o\"; // \u00e3 does not belong to the standard \n                         // (or extended) ASCII characters\n\n    printf(\"number of chars = %d\\n\", (int)strlen(str)); // 5\n\n    int len = 0;\n    while (str[len] != '\\0')\n        len++;\n    printf(\"number of bytes = %d\\n\", len); // 5\n\n    for (int i = 0; i &lt; len; i++)\n        printf(\"%c\", str[i]);\n    puts(\"\");\n    // \"Jo\u00e3o\"\n\n    for (int i = 0; i &lt; len; i++)\n        printf(\"_%c_\", str[i]);\n    puts(\"\");\n    // _J__o__\ufffd__\ufffd__o_ -&gt; wow!!!\n\n    str[2] = 'X'; // let's change this special character\n                  // and see what happens\n    for (int i = 0; i &lt; len; i++)\n        printf(\"%c\", str[i]);\n    puts(\"\");\n    // JoX\ufffdo\n\n    for (int i = 0; i &lt; len; i++)\n        printf(\"_%c_\", str[i]);\n    puts(\"\");\n    // _J__o__X__\ufffd__o_\n} \n</code></pre>\n\n<p>I have knowledge of how ASCII / UTF-8 work, what I'm really unsure is on at what moment do the characters get interpreted as \"compound\" characters, as it seems that C just treats them as dumb bytes. What's really the science behind this?</p>\n"}, {"tags": ["c++", "c", "parallel-processing", "mpi", "matrix-multiplication"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 1, "creation_date": 1563314789, "post_id": 57066017, "comment_id": 100657052, "body": "You need to allocate your arrays in contiguous memory(you are using jagged arrays instead). A quick search on SO will point you to brilliantly answered similar questions."}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 9070774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-knrx2VibqIE/AAAAAAAAAAI/AAAAAAAAJHg/UksjZBKLFyc/photo.jpg?sz=128", "display_name": "Saurabh Bade", "link": "https://stackoverflow.com/users/9070774/saurabh-bade"}, "edited": false, "score": 0, "creation_date": 1563509974, "post_id": 57079861, "comment_id": 100731273, "body": "I was trying to do this in C++, however,  I go back and will do it in C. Thank you so much."}, {"owner": {"reputation": 137, "user_id": 9070774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-knrx2VibqIE/AAAAAAAAAAI/AAAAAAAAJHg/UksjZBKLFyc/photo.jpg?sz=128", "display_name": "Saurabh Bade", "link": "https://stackoverflow.com/users/9070774/saurabh-bade"}, "edited": false, "score": 0, "creation_date": 1563665079, "post_id": 57079861, "comment_id": 100775009, "body": "Just want to inform that it is not working, getting **segmentation fault ** error."}, {"owner": {"reputation": 1898, "user_id": 10911932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5XI.gif?s=128&g=1", "display_name": "j23", "link": "https://stackoverflow.com/users/10911932/j23"}, "reply_to_user": {"reputation": 137, "user_id": 9070774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-knrx2VibqIE/AAAAAAAAAAI/AAAAAAAAJHg/UksjZBKLFyc/photo.jpg?sz=128", "display_name": "Saurabh Bade", "link": "https://stackoverflow.com/users/9070774/saurabh-bade"}, "edited": false, "score": 0, "creation_date": 1563785277, "post_id": 57079861, "comment_id": 100799662, "body": "@SaurabhBade it&#39;s working without segmentation fault for me. Let me try with some other input values to see whether I get any errors or not."}, {"owner": {"reputation": 1898, "user_id": 10911932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5XI.gif?s=128&g=1", "display_name": "j23", "link": "https://stackoverflow.com/users/10911932/j23"}, "reply_to_user": {"reputation": 137, "user_id": 9070774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-knrx2VibqIE/AAAAAAAAAAI/AAAAAAAAJHg/UksjZBKLFyc/photo.jpg?sz=128", "display_name": "Saurabh Bade", "link": "https://stackoverflow.com/users/9070774/saurabh-bade"}, "edited": false, "score": 1, "creation_date": 1563787156, "post_id": 57079861, "comment_id": 100800697, "body": "@SaurabhBade Segmentation fault was due to the declaration of array aa and cc with size N. Size should be N*N/size i.e Total number of elements divided by the number of processes. I have changed it in the code."}], "tags": [], "owner": {"reputation": 1898, "user_id": 10911932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5XI.gif?s=128&g=1", "display_name": "j23", "link": "https://stackoverflow.com/users/10911932/j23"}, "is_accepted": true, "score": 1, "last_activity_date": 1563786965, "last_edit_date": 1563786965, "creation_date": 1563378647, "answer_id": 57079861, "question_id": 57066017, "link": "https://stackoverflow.com/questions/57066017/how-to-fix-issue-while-doing-parallel-programming-with-mpi-for-matrix-multiplica/57079861#57079861", "title": "How to fix issue while doing parallel programming with MPI for Matrix-Multiplication with dynamic 2D array?", "body": "<p>Declaring array like this</p>\n\n<pre><code> int **a = new int*[N];\n    for (int i = 0; i &lt; N; i++)\n        a[i] = new int[N]; \n</code></pre>\n\n<p>will not allocate it in contiguous memory location. Replacing above declaration with one of the following will make the application work.</p>\n\n<pre><code> int a[N][N]; // or\n int **a=malloc(N*N*sizeof(int));\n</code></pre>\n\n<p>MPI_Scatter,  Gather etc works on arrays with contiguous memory location.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;math.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stddef.h&gt;\n#include \"mpi.h\"\n\n\nint main(int argc, char *argv[])\n{\n    int i, j, k, rank, size, tag = 99, blksz, sum = 0,N=0;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\n    if(rank ==0)\n    {\n      std::cout &lt;&lt; \"input value of N\" &lt;&lt; '\\n';\n      std::cin &gt;&gt; N;\n    }\n    MPI_Bcast(&amp;N, 1, MPI_INT, 0, MPI_COMM_WORLD);\nint size_array=(N*N)/size;\nint aa[size_array],cc[size_array]; // Declare arrays here since value of N is 0 otherwise \n    int a[N][N];\n    int b[N][N];\n    int c[N][N];\n    for (int i = 0; i &lt; N; i++)\n        c[i] = new int[N];\n\n        if (rank == 0)\n        {\n\n            for (int i = 0; i &lt; N; i++)\n            {\n                for (int j = 0; j &lt; N; j++)\n                {\n                        a[i][j] =rand() % 10;\n                        std::cout &lt;&lt; a[i][j];\n                }\n                std::cout &lt;&lt; '\\n';\n            }\n\n            std::cout &lt;&lt; '\\n';\n\n            for (int i = 0; i &lt; N; i++)\n            {\n                for (int j = 0; j &lt; N; j++)\n                {\n                        b[i][j] =rand() % 10;\n                        std::cout &lt;&lt; b[i][j];\n                }\n                std::cout &lt;&lt; '\\n';\n            }\n        }\n\n    MPI_Scatter(a, N*N/size, MPI_INT, aa, N*N/size, MPI_INT,0,MPI_COMM_WORLD);\n\n    //broadcast second matrix to all processes\n    MPI_Bcast(b, N*N, MPI_INT, 0, MPI_COMM_WORLD);\n\n    MPI_Barrier(MPI_COMM_WORLD);\n\n          //perform vector multiplication by all processes\n          for (i = 0; i &lt; N; i++)\n          {\n                    for (j = 0; j &lt; N; j++)\n                    {\n                            sum = sum + aa[j] * b[j][i];  //MISTAKE_WAS_HERE\n                    }\n                    cc[i] = sum;\n                    sum = 0;\n            }\n\n    MPI_Gather(cc, N*N/size, MPI_INT, c, N*N/size, MPI_INT, 0, MPI_COMM_WORLD);\n\n    MPI_Barrier(MPI_COMM_WORLD);\n\n    MPI_Finalize();\n\n\n    if (rank == 0)                         //I_ADDED_THIS\n    {\n      for (i = 0; i &lt; N; i++) {\n              for (j = 0; j &lt; N; j++)\n              {\n                      std::cout &lt;&lt; a[i][j]&lt;&lt; '\\n';\n              }\n              std::cout &lt;&lt; '\\n';\n      }\n      std::cout &lt;&lt; '\\n' &lt;&lt; '\\n';\n\n    }\n}\n</code></pre>\n\n<p>Also declare the array <code>int aa[N],cc[N];</code> after the <code>scanf</code>.</p>\n"}], "owner": {"reputation": 137, "user_id": 9070774, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-knrx2VibqIE/AAAAAAAAAAI/AAAAAAAAJHg/UksjZBKLFyc/photo.jpg?sz=128", "display_name": "Saurabh Bade", "link": "https://stackoverflow.com/users/9070774/saurabh-bade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 57079861, "answer_count": 1, "score": 0, "last_activity_date": 1563786965, "creation_date": 1563314567, "question_id": 57066017, "link": "https://stackoverflow.com/questions/57066017/how-to-fix-issue-while-doing-parallel-programming-with-mpi-for-matrix-multiplica", "title": "How to fix issue while doing parallel programming with MPI for Matrix-Multiplication with dynamic 2D array?", "body": "<p>I am trying to create three matrices a,b,c where c = a*b with using MPI. Also, I am taking the length of these matrices as N (common for all) as it I have to create a square matrix. However, whenever I enter the value of N in runtime, I am getting a segmentation fault error and if I put I gave the value of N in the program, then it works fine. </p>\n\n<p>I have tried this with scatter and gather as given it in here: <a href=\"https://stackoverflow.com/questions/41575243/matrix-multiplication-using-mpi-scatter-and-mpi-gather\">matrix multiplication using Mpi_Scatter and Mpi_Gather</a>\n. Now I have to di dynamically, so that can check the time consumption done by the program to execute it. Just want to inform that I have done this OpenMP, and which was great, but want to compare which one is really good i.e. OpenMP or MPI.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;math.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stddef.h&gt;\n#include \"mpi.h\"\n\n\nint main(int argc, char *argv[])\n{\n    int i, j, k, rank, size, tag = 99, blksz, sum = 0,N=0;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\n    int aa[N],cc[N];\n    if(rank ==0)\n    {\n      std::cout &lt;&lt; \"input value of N\" &lt;&lt; '\\n';\n      std::cin &gt;&gt; N;\n    }\n    MPI_Bcast(&amp;N, 1, MPI_INT, 0, MPI_COMM_WORLD);\n\n    int **a = new int*[N];\n    for (int i = 0; i &lt; N; i++)\n        a[i] = new int[N];\n\n    int **b = new int*[N];\n    for (int i = 0; i &lt; N; i++)\n        b[i] = new int[N];\n\n    int **c = new int*[N];\n    for (int i = 0; i &lt; N; i++)\n        c[i] = new int[N];\n\n        if (rank == 0)\n        {\n\n            for (int i = 0; i &lt; N; i++)\n            {\n                for (int j = 0; j &lt; N; j++)\n                {\n                        a[i][j] =rand() % 10;\n                        std::cout &lt;&lt; a[i][j];\n                }\n                std::cout &lt;&lt; '\\n';\n            }\n\n            std::cout &lt;&lt; '\\n';\n\n            for (int i = 0; i &lt; N; i++)\n            {\n                for (int j = 0; j &lt; N; j++)\n                {\n                        b[i][j] =rand() % 10;\n                        std::cout &lt;&lt; b[i][j];\n                }\n                std::cout &lt;&lt; '\\n';\n            }\n        }\n\n    MPI_Scatter(a, N*N/size, MPI_INT, aa, N*N/size, MPI_INT,0,MPI_COMM_WORLD);\n\n    //broadcast second matrix to all processes\n    MPI_Bcast(b, N*N, MPI_INT, 0, MPI_COMM_WORLD);\n\n    MPI_Barrier(MPI_COMM_WORLD);\n\n          //perform vector multiplication by all processes\n          for (i = 0; i &lt; N; i++)\n          {\n                    for (j = 0; j &lt; N; j++)\n                    {\n                            sum = sum + aa[j] * b[j][i];  //MISTAKE_WAS_HERE\n                    }\n                    cc[i] = sum;\n                    sum = 0;\n            }\n\n    MPI_Gather(cc, N*N/size, MPI_INT, c, N*N/size, MPI_INT, 0, MPI_COMM_WORLD);\n\n    MPI_Barrier(MPI_COMM_WORLD);\n\n    MPI_Finalize();\n\n\n    if (rank == 0)                         //I_ADDED_THIS\n    {\n      for (i = 0; i &lt; N; i++) {\n              for (j = 0; j &lt; N; j++)\n              {\n                      std::cout &lt;&lt; a[i][j]&lt;&lt; '\\n';\n              }\n              std::cout &lt;&lt; '\\n';\n      }\n      std::cout &lt;&lt; '\\n' &lt;&lt; '\\n';\n\n    }\n    delete *a;\n    delete *b;\n    delete *c;\n}\n\n\n</code></pre>\n\n<p>The error which I am getting is:</p>\n\n<p>mpirun noticed that process rank 3 with PID 3580 on node localhost exited on signal 11 (Segmentation fault).</p>\n\n<p>I just wanted here that matrix multiplication to be done.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1563316095, "post_id": 57065913, "comment_id": 100657366, "body": "Your title refers to an &quot;unknown type error&quot;. That can only happen in C as a compile-time error. If you had that error, your program wouldn&#39;t run and you couldn&#39;t get a segmentation fault."}, {"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1563316631, "post_id": 57065913, "comment_id": 100657461, "body": "@KeithThompson, When OP says &quot;unknown type error&quot; he is obviously not quoting an error message, but stating that he doesn&#39;t know what kind of error he is seeing"}, {"owner": {"reputation": 13, "user_id": 9184409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee0b4d9527b4f12cf62267d5b1b3c9b?s=128&d=identicon&r=PG", "display_name": "Atharva", "link": "https://stackoverflow.com/users/9184409/atharva"}, "edited": false, "score": 0, "creation_date": 1563316865, "post_id": 57065913, "comment_id": 100657502, "body": "@jirassimok sir i am not getting any clue about -Wall and -Wextra you are talking about.. So plz tell me some more about it and thanks for your help.."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1563332467, "post_id": 57065913, "comment_id": 100660225, "body": "@HAL9000: That was hardly obvious, but the title has now been edited so it doesn&#39;t matter."}, {"owner": {"reputation": 13, "user_id": 9184409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee0b4d9527b4f12cf62267d5b1b3c9b?s=128&d=identicon&r=PG", "display_name": "Atharva", "link": "https://stackoverflow.com/users/9184409/atharva"}, "edited": false, "score": 0, "creation_date": 1563362920, "post_id": 57065913, "comment_id": 100672876, "body": "@jirassimok i&#39;am not understanding th concept behind your last comment if((char  * buffer == malloc(100)){ }else{ }. plzz explain..."}], "answers": [{"tags": [], "owner": {"reputation": 2336, "user_id": 7389264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160900497f0373247800b2ad89798e32?s=128&d=identicon&r=PG&f=1", "display_name": "jirassimok", "link": "https://stackoverflow.com/users/7389264/jirassimok"}, "is_accepted": false, "score": 2, "last_activity_date": 1563316671, "last_edit_date": 1563316671, "creation_date": 1563314407, "answer_id": 57065991, "question_id": 57065913, "link": "https://stackoverflow.com/questions/57065913/segmentation-fault-core-dumped-when-inserting-element-into-linked-list/57065991#57065991", "title": "Segmentation fault (core dumped) when inserting element into linked list", "body": "<p>You have a <code>A = NULL</code> where you should have a <code>A == NULL</code>. As it is now, you are setting <code>A</code> to <code>NULL</code>, then trying to access one of its fields.</p>\n\n<p>In C, the assignment operator (<code>=</code>) returns the value it assigned. So when you say <code>if (A = NULL)</code>, it assigns the <code>NULL</code> to <code>A</code>, then returns <code>NULL</code>, so the condition is false and the <code>else</code> branch is executed.</p>\n\n<pre><code>else {\n    struct node* temp1 = A; // now temp1 is also NULL\n    while (temp1-&gt;link != NULL) // temp1 is NULL, so this is NULL-&gt;link\n</code></pre>\n\n<p>So you end up with <code>NULL-&gt;link</code>, which attempts to dereference <code>NULL</code>, which is an undefined behavior, and usually causes a segfault.</p>\n\n<p>If you are compiling with <code>gcc</code>, I recommend using <code>-Wall</code> (and maybe even <code>-Wextra</code>) to display more compilation warnings, including a warning for using <code>=</code> in a conditional expression.</p>\n\n<hr>\n\n<p>In case you're wondering why C allows this at all, it's very useful for checking the results of function calls. For example:</p>\n\n<pre><code>if ((char *buffer = malloc(100))) {\n    // malloc worked, and you can use the buffer here\n}\nelse {\n    // malloc failed, so you can do something else\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "is_accepted": true, "score": 2, "last_activity_date": 1563317983, "last_edit_date": 1563317983, "creation_date": 1563317621, "answer_id": 57066439, "question_id": 57065913, "link": "https://stackoverflow.com/questions/57065913/segmentation-fault-core-dumped-when-inserting-element-into-linked-list/57066439#57066439", "title": "Segmentation fault (core dumped) when inserting element into linked list", "body": "<p>Compiling your program with some helpful flags would have helped you solve your problem:</p>\n\n<pre><code>user@machine:~$ gcc -Wall -Werror -o scratch main.c\nmain.c: In function \u2018insert_element\u2019:\nmain.c:14:12: error: suggest parentheses around assignment used as truth value [-Werror=parentheses]\n         if(A=NULL)\n            ^\ncc1: all warnings being treated as errors\n</code></pre>\n\n<p>Without fixing this problem, you'll get</p>\n\n<pre><code>user@machine:~$ gcc -o scratch main.c\nuser@machine:~$ ./scratch \nSegmentation fault (core dumped)\n</code></pre>\n\n<p>If we fix the error</p>\n\n<pre><code>if(A==NULL)\n</code></pre>\n\n<p>and change the <code>printf</code> statement</p>\n\n<pre><code>printf(\"%d\\n\",ptr-&gt;data);\n</code></pre>\n\n<p>we get this output</p>\n\n<pre><code>5\n5\n6\n3\n5\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9184409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cee0b4d9527b4f12cf62267d5b1b3c9b?s=128&d=identicon&r=PG", "display_name": "Atharva", "link": "https://stackoverflow.com/users/9184409/atharva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 57066439, "answer_count": 2, "score": -2, "last_activity_date": 1563317983, "creation_date": 1563313890, "last_edit_date": 1563317800, "question_id": 57065913, "link": "https://stackoverflow.com/questions/57065913/segmentation-fault-core-dumped-when-inserting-element-into-linked-list", "title": "Segmentation fault (core dumped) when inserting element into linked list", "body": "<p>I am new to data structures and I am trying to implement a linked list data structure. I am getting a \"segmentation fault (core dumped)\" during run time.</p>\n\n<p>I am using a Linux terminal to compile and run the program. I have written a <code>insert_element()</code> function to insert a node at the beginning and a recursive function <code>print()</code> to print the list. I am getting the segmentation fault during run time. How can i get rid of it?</p>\n\n<pre><code>struct node{\n        int data;\n        struct node* link;\n};\n\nstruct node* insert_element(struct node* A,int ino)\n{\n        struct node *temp=(struct node*)malloc(sizeof(struct node));\n        temp-&gt;data=ino;\n        temp-&gt;link=NULL;\n        if(A=NULL)\n        {\n        A=temp;\n        }\n        else\n        {\n                struct node* temp1=A;\n                while(temp1-&gt;link!=NULL)\n                {\n                        temp1=temp1-&gt;link;\n                }\n                temp1-&gt;link=temp;\n        }\n        return A;\n}\n\nvoid print(struct node* ptr)\n{\n        if(ptr==NULL)\n                return;\n        printf(\"%d\",ptr-&gt;data);\n        print(ptr-&gt;link);\n}\n\nint main()\n{\n        struct node* head=NULL;\n        head=insert_element(head,5);\n        head=insert_element(head,5);\n        head=insert_element(head,6);\n        head=insert_element(head,3);\n        head=insert_element(head,5);\n        print(head);\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "linker", "ld", "ubuntu-18.04"], "comments": [{"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1563311461, "post_id": 57065480, "comment_id": 100656078, "body": "Either you are running out of memory, or you have bad RAM. Those are the two most likely explanations, based on the information given in the question."}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 2, "creation_date": 1563311654, "post_id": 57065480, "comment_id": 100656132, "body": "Show your code. In <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> form preferably."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563311660, "post_id": 57065480, "comment_id": 100656134, "body": "Try a different gcc version"}, {"owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563311756, "post_id": 57065480, "comment_id": 100656163, "body": "@EugeneSh. Why would that help? You are just guessing.."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "edited": false, "score": 0, "creation_date": 1563311785, "post_id": 57065480, "comment_id": 100656175, "body": "@JesperJuhl Because the segfault is not caused by the OPs program but by <code>ld</code>. Meaning that it is buggy, or there is some OS/HW issue."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1563312218, "post_id": 57065480, "comment_id": 100656297, "body": "Still worth adding the MCVE, though. Someone could see the code and go, &quot;Oh. THAT bug.&quot; Also add the output of <code>gcc -v</code> so we know what gcc we&#39;re dealing with."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 3, "creation_date": 1563312735, "post_id": 57065480, "comment_id": 100656474, "body": "Interestingly similar question from earlier today:  <a href=\"https://stackoverflow.com/questions/57051568/collect2-fatal-error-ld-terminated-with-signal-11-segmentation-fault#comment100635128_57051568\" title=\"collect2 fatal error ld terminated with signal 11 segmentation fault%23comment100635128_57051568\">stackoverflow.com/questions/57051568/&hellip;</a>  Also Ubuntu 18.04."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563312912, "post_id": 57065480, "comment_id": 100656520, "body": "What are the various <code>LD_*</code> environment variables set to?  Can you add the output from <code>env | grep LD_</code>?"}, {"owner": {"reputation": 1872, "user_id": 2104472, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/18805ffb0c3acfbd23cd6c84951afafc?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Ivanishin", "link": "https://stackoverflow.com/users/2104472/vladislav-ivanishin"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1563342840, "post_id": 57065480, "comment_id": 100662588, "body": "@user4581301 clearly, gcc has nothing to do with this. <code>ld -v</code> already segfaults. I&#39;d count that as a minimal example"}, {"owner": {"reputation": 811, "user_id": 4974092, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd6ae9a61064b289cb20cb1296e39761?s=128&d=identicon&r=PG&f=1", "display_name": "tarun14110", "link": "https://stackoverflow.com/users/4974092/tarun14110"}, "edited": false, "score": 0, "creation_date": 1563465811, "post_id": 57065480, "comment_id": 100718464, "body": "Nothing worked. I tried everything I could think of like reinstalling build-essentials, gcc, binutils etc. I re installed the ubuntu now. Should I delete this question?"}], "owner": {"reputation": 811, "user_id": 4974092, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd6ae9a61064b289cb20cb1296e39761?s=128&d=identicon&r=PG&f=1", "display_name": "tarun14110", "link": "https://stackoverflow.com/users/4974092/tarun14110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 601, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1563313040, "creation_date": 1563311360, "last_edit_date": 1563313040, "question_id": 57065480, "link": "https://stackoverflow.com/questions/57065480/compiler-gives-error-ld-terminated-with-signal-11", "title": "compiler gives error ld terminated with signal 11", "body": "<p>I am trying to compile a simple hello program using gcc, but getting the below error. i am using ubuntu.</p>\n\n<p>gcc -g -o hello hello.c</p>\n\n<blockquote>\n  <p>collect2: fatal error: ld terminated with signal 11 [Segmentation\n  fault], core dumped compilation terminated.</p>\n</blockquote>\n\n<p>strace ld -v</p>\n\n<blockquote>\n  <p>execve(\"/usr/bin/ld\", [\"ld\", \"-v\"], 0x7ffc43b744c8 /* 57 vars */) = 0\n  --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x2} ---\n  +++ killed by SIGSEGV (core dumped) +++ Segmentation fault (core dumped)</p>\n</blockquote>\n\n<p>I tried reinstalling gcc and binutils, didn't work.</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1563309923, "post_id": 57065105, "comment_id": 100655443, "body": "Your code says &quot;if this condition then <i>do nothing</i>, but also add one to count regardless&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "edited": false, "score": 0, "creation_date": 1563389763, "post_id": 57065215, "comment_id": 100687917, "body": "oh my god I&#39;ve tried some other stuff and probably forgot to remove the semi colon."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "edited": false, "score": 0, "creation_date": 1563389925, "post_id": 57065215, "comment_id": 100688005, "body": "If I see code that &quot;isn&#39;t working&quot; and it has an egregious error like this that makes the code behave in a completely incorrect way then that&#39;s the first thing to fix. If there&#39;s still problems you&#39;re going to have to show how this code is used. There&#39;s no use-case in your example, so we&#39;re not sure how to engage that function properly."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "edited": false, "score": 0, "creation_date": 1563390150, "post_id": 57065215, "comment_id": 100688091, "body": "It&#39;d help if this example was more complete. There&#39;s a two-dimensional array structure at work here, which is confusing things. It&#39;s ideal if you produce something small that <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">we can compile and experiment with to fix your problem</a>."}, {"owner": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "edited": false, "score": 0, "creation_date": 1563390226, "post_id": 57065215, "comment_id": 100688119, "body": "so I&#39;m using loops like 2d array if I want to know the character at a position I&#39;m using  str[x][y] unlike array I&#39;m not getting the element at that position but the whole string at x"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "edited": false, "score": 0, "creation_date": 1563390317, "post_id": 57065215, "comment_id": 100688161, "body": "Are you testing for one character, or more than one character at a time? You can always use a <code>switch</code> inside a loop for more than one possible match."}, {"owner": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "edited": false, "score": 0, "creation_date": 1563391156, "post_id": 57065215, "comment_id": 100688508, "body": "The question I&#39;m trying to do: There are &#39;n&#39; number of employees in an office they should be divided in groups of two to form a team. if n is odd the remaining one will be a one man team. The input will be n number of strings with c&#39;s and x&#39;s. Two employees i,j (0&lt;i,j&lt;n)are compatible(if i!=j and i=j=c)and otherwise (if i!=j, if i=j=x) the team with one member can handle the load if(i=j) and i=j=c and otherwise if i=j=x... my idea is to count the compatibility for every employee and start teaming up with the lowest one."}, {"owner": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "edited": false, "score": 0, "creation_date": 1563391265, "post_id": 57065215, "comment_id": 100688555, "body": "sample input: 3 ccx cxx xxx"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "edited": false, "score": 0, "creation_date": 1563391309, "post_id": 57065215, "comment_id": 100688580, "body": "That description helps a lot. You may want to open up a new question with that detail, and close this one out as related to the syntax error that&#39;s now fixed."}, {"owner": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "edited": false, "score": 0, "creation_date": 1563391483, "post_id": 57065215, "comment_id": 100688652, "body": "But Im not allowed to ask another question it seems If you get any solution please comment Thank you."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1563310054, "creation_date": 1563310054, "answer_id": 57065215, "question_id": 57065105, "link": "https://stackoverflow.com/questions/57065105/comparing-a-specific-character-to-a-string/57065215#57065215", "title": "comparing a specific character to a string", "body": "<p>Your code says \"if this condition then <em>do nothing</em>, but also add one to count regardless\". Remember a <code>;</code> is used to terminate a statement, so in the case of <code>if</code> you don't put one, you're not done yet.</p>\n\n<p>Try and code your <code>if</code> statements like this:</p>\n\n<pre><code>if(str[x][y]=='c') {\n  count++;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11794229, "user_type": "registered", "profile_image": "https://graph.facebook.com/497303654366870/picture?type=large", "display_name": "Betelgeuse", "link": "https://stackoverflow.com/users/11794229/betelgeuse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1563389958, "creation_date": 1563309561, "last_edit_date": 1563389958, "question_id": 57065105, "link": "https://stackoverflow.com/questions/57065105/comparing-a-specific-character-to-a-string", "title": "comparing a specific character to a string", "body": "<p>I'm using array of strings soo when trying to compare a character str[x][y] it is comparing with the first letter of string x i.e str[x].</p>\n\n<pre><code>for(x=0;x&lt;n;x++)\n    {\n        int count=0;\n        for(y=0;y&lt;n;y++)\n        {\n            if(x!=y)\n            {\n                if(str[x][y]=='c')\n                {\n                    count++;\n                }\n            }\n            printf(\"%c\\n\",str[x][y]);\n        }\n</code></pre>\n\n<p>while printing it is giving the correct value but while comparing it is taking the whole string, and only the first character of the string is compared.</p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 263, "user_id": 2411703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab9aa7ff5267f35acd2c858cfc92a5a?s=128&d=identicon&r=PG", "display_name": "peter.cntr", "link": "https://stackoverflow.com/users/2411703/peter-cntr"}, "edited": false, "score": 1, "creation_date": 1563308865, "post_id": 57064853, "comment_id": 100655020, "body": "Could you be more specific about what you mean by &#39;split&#39;? (For example, do you want the <code>fillit</code> function to be &#39;split&#39; into subroutines?)"}, {"owner": {"reputation": 83, "user_id": 11794161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a414189746cd150252639f29e5084a59?s=128&d=identicon&r=PG&f=1", "display_name": "GusD", "link": "https://stackoverflow.com/users/11794161/gusd"}, "reply_to_user": {"reputation": 263, "user_id": 2411703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab9aa7ff5267f35acd2c858cfc92a5a?s=128&d=identicon&r=PG", "display_name": "peter.cntr", "link": "https://stackoverflow.com/users/2411703/peter-cntr"}, "edited": false, "score": 0, "creation_date": 1563309051, "post_id": 57064853, "comment_id": 100655095, "body": "I would like my function make a maximum of 25 lines, so i need to &quot;split&quot; or cut this function in several parts. But as i cant keep data of each variable its difficult."}, {"owner": {"reputation": 263, "user_id": 2411703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ab9aa7ff5267f35acd2c858cfc92a5a?s=128&d=identicon&r=PG", "display_name": "peter.cntr", "link": "https://stackoverflow.com/users/2411703/peter-cntr"}, "edited": false, "score": 0, "creation_date": 1563309283, "post_id": 57064853, "comment_id": 100655187, "body": "Right. The usual way do do this in C, while avoiding globals, is to create a structure with all necessary storage and pass a pointer to that structure to all functions that need to access/modify data in it."}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 1, "creation_date": 1563312235, "post_id": 57064853, "comment_id": 100656304, "body": "Don&#39;t comment comments asking for additional information or clarification: edit your post. Evaluate <code>check_in_map(tetri, map, nb_block, map_index)</code> just once as a &quot;<code>switch</code>-expression&quot;. <i>Don&#39;t knock yourself out trying to adhere to guidelines like the one quoted</i>. (When the majority of &quot;on-line&quot; terminals displayed 24 or 25 lines on a 12 inch tube, a formatting style using less lines was common (place curly brace in same line as control structure). It still saves place to combine declaration and initialisation of variables.)"}, {"owner": {"reputation": 2026, "user_id": 3789665, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/38983281a7926f50843153d9e0788cdf?s=128&d=identicon&r=PG&f=1", "display_name": "greybeard", "link": "https://stackoverflow.com/users/3789665/greybeard"}, "edited": false, "score": 0, "creation_date": 1563312318, "post_id": 57064853, "comment_id": 100656337, "body": "The computation of the size to allocate looks fatally wrong: I&#39;m used to <code>sizeof\u2007*hash_index\u2007*\u2007(j\u2007+\u20071)</code>"}, {"owner": {"reputation": 6275, "user_id": 1690217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h01XY.png?s=128&g=1", "display_name": "Chris Schaller", "link": "https://stackoverflow.com/users/1690217/chris-schaller"}, "edited": false, "score": 0, "creation_date": 1563316272, "post_id": 57064853, "comment_id": 100657396, "body": "This style of question, where you have a functional routine but you want opinions on style or help with refactoring is better asked on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> (code review is not an option for migration that I can access in the review queues)"}, {"owner": {"reputation": 6275, "user_id": 1690217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h01XY.png?s=128&g=1", "display_name": "Chris Schaller", "link": "https://stackoverflow.com/users/1690217/chris-schaller"}, "edited": false, "score": 2, "creation_date": 1563325707, "post_id": 57064853, "comment_id": 100659095, "body": "Your question is about refactoring, but if your current code works, is refactoring necessary? We&#39;re talking about reducing a 39 line function (including variables and spaces) down to 25 lines here. Refactoring will result in many more lines of code and your logic is pretty well reduced into sub-routines already. IMO this is the result of good refactoring, you&#39;ve done a good job, sit back, have a beer and appreciate it :)"}], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 10181901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99fc3838f60d36d86fa0dd338c30265b?s=128&d=identicon&r=PG", "display_name": "Vikas Agarwal", "link": "https://stackoverflow.com/users/10181901/vikas-agarwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1563358645, "creation_date": 1563358645, "answer_id": 57073582, "question_id": 57064853, "link": "https://stackoverflow.com/questions/57064853/how-can-i-split-this-function/57073582#57073582", "title": "How can i split this function", "body": "<p>If your aim is to just reduce the line count, then perhaps you can try this:</p>\n\n<pre><code>int     fillit(char *map, char **tab, int map_size, int j) {\n int map_index = 0, nb_block = 0, **tetri, *hash_index;\n tetri = tetri_stock_hash(tab, j, map_size);\n if (!(hash_index = (int *)ft_memalloc(sizeof(hash_index) * (j + 1))))\n    return (-1);\n while (nb_block != j) {\n     switch (check_in_map(tetri, map, nb_block, map_index)) {\n         case 1: hash_index[nb_block] = map_index;\n        place_in_map(tetri, map, &amp;nb_block, &amp;map_index); break;\n        case -1: map_index++; break;\n        case 2: if (nb_block == 0) {\n            map_size++;\n            map = map_generate(4 + map_size);\n            fillit(map, tab, map_size, j);\n            return (1);\n        }\n        nb_block--;\n        delete_in_map(tetri, map, nb_block, hash_index[nb_block]);\n        map_index = hash_index[nb_block] + 1; break;\n     }\n }\n a_z(tetri, map, hash_index, j);\n map_print_color(map);\n return (0);\n}\n</code></pre>\n\n<p>This is exactly what you wrote, I am unaware of algorithm or logic behind it, just removed excess lines and a little tinkering here and there.</p>\n"}], "owner": {"reputation": 83, "user_id": 11794161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a414189746cd150252639f29e5084a59?s=128&d=identicon&r=PG&f=1", "display_name": "GusD", "link": "https://stackoverflow.com/users/11794161/gusd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563358645, "creation_date": 1563308276, "last_edit_date": 1563336957, "question_id": 57064853, "link": "https://stackoverflow.com/questions/57064853/how-can-i-split-this-function", "title": "How can i split this function", "body": "<p>I have a basic Backtracking algorithm which checks if i can place tetris on a map, all function are simple, check_map which check if there is place on the map, place_map which allow to place tetris on my map and delete_tetri which delete tetri on the map.</p>\n\n<p>By convention, I would like to keep my functions to a maximum of 25 lines, so I need to <em>split</em> or <em>refactor</em> this code into multiple smaller functions.</p>\n\n<p>I am having trouble achieving this because keeping track of all the variables is difficult.</p>\n\n<pre><code>int     fillit(char *map, char **tab, int map_size, int j)\n{\n int map_index;\n int nb_block;\n int **tetri;\n int *hash_index;\n\n tetri = tetri_stock_hash(tab, j, map_size);\n map_index = 0;\n nb_block = 0;\n if (!(hash_index = (int *)ft_memalloc(sizeof(hash_index) * (j + 1))))\n    return (-1);\n while (nb_block != j)\n {\n     if (check_in_map(tetri, map, nb_block, map_index) == 1)\n     {\n        hash_index[nb_block] = map_index;\n        place_in_map(tetri, map, &amp;nb_block, &amp;map_index);\n     }\n     else if (check_in_map(tetri, map, nb_block, map_index) == -1)\n        map_index++;\n     else if (check_in_map(tetri, map, nb_block, map_index) == 2)\n     {\n        if (nb_block == 0)\n        {\n            map_size++;\n            map = map_generate(4 + map_size);\n            fillit(map, tab, map_size, j);\n            return (1);\n        }\n        nb_block--;\n        delete_in_map(tetri, map, nb_block, hash_index[nb_block]);\n        map_index = hash_index[nb_block] + 1;\n     }\n }\n a_z(tetri, map, hash_index, j);\n map_print_color(map);\n return (0);\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "signals", "valgrind", "eflags"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 1, "creation_date": 1563305966, "post_id": 57063983, "comment_id": 100653821, "body": "<code>puts</code> is not sigaction-safe. It is likely an UB."}, {"owner": {"reputation": 41, "user_id": 11793914, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p8W6XLkoof4/AAAAAAAAAAI/AAAAAAAAABE/SEhvsNrGdYo/photo.jpg?sz=128", "display_name": "TetraSomia", "link": "https://stackoverflow.com/users/11793914/tetrasomia"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1563308542, "post_id": 57063983, "comment_id": 100654882, "body": "Thanks i edited that"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1563308624, "post_id": 57063983, "comment_id": 100654923, "body": "<code>write(STDIN_FILENO,...);</code>?!?!?"}, {"owner": {"reputation": 41, "user_id": 11793914, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p8W6XLkoof4/AAAAAAAAAAI/AAAAAAAAABE/SEhvsNrGdYo/photo.jpg?sz=128", "display_name": "TetraSomia", "link": "https://stackoverflow.com/users/11793914/tetrasomia"}, "edited": false, "score": 0, "creation_date": 1563309830, "post_id": 57063983, "comment_id": 100655407, "body": "Whoopsie I&#39;m tired..."}, {"owner": {"reputation": 3079, "user_id": 3035584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3f84eebae0cfccb50e3be86dad24f1?s=128&d=identicon&r=PG&f=1", "display_name": "phd", "link": "https://stackoverflow.com/users/3035584/phd"}, "edited": false, "score": 0, "creation_date": 1564432828, "post_id": 57063983, "comment_id": 101021328, "body": "When using traps, it might be needed to use the valgrind option --vex-iropt-register-updates=allregs-at-each-insn"}, {"owner": {"reputation": 41, "user_id": 11793914, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p8W6XLkoof4/AAAAAAAAAAI/AAAAAAAAABE/SEhvsNrGdYo/photo.jpg?sz=128", "display_name": "TetraSomia", "link": "https://stackoverflow.com/users/11793914/tetrasomia"}, "edited": false, "score": 0, "creation_date": 1564650493, "post_id": 57063983, "comment_id": 101103753, "body": "Sadly it did not change the behavior, but thanks!"}], "owner": {"reputation": 41, "user_id": 11793914, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p8W6XLkoof4/AAAAAAAAAAI/AAAAAAAAABE/SEhvsNrGdYo/photo.jpg?sz=128", "display_name": "TetraSomia", "link": "https://stackoverflow.com/users/11793914/tetrasomia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1563309816, "creation_date": 1563304257, "last_edit_date": 1563309816, "question_id": 57063983, "link": "https://stackoverflow.com/questions/57063983/is-valgrind-ignoring-trap-flag-tf-bit-in-rflags-register", "title": "Is Valgrind ignoring Trap Flag (TF) bit in RFLAGS register?", "body": "<p>In one of my project I need to manually edit the RFLAGS register to raise a SIGTRAP upon each instruction using the TF bit. It works when running the program directly, but not when running it under Valgrind.</p>\n\n<p>Here is a quick program that shows what I mean:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;unistd.h&gt;\n\n#define REG_EFL 17\n#define TRAP_FLAG 0x100\n\nvoid handler(int sig, siginfo_t *siginfo, void *ctx) {\n  const char msg[] = \"From handler\\n\";\n  write(STDOUT_FILENO, msg, sizeof(msg)-1);\n  ((ucontext_t*)ctx)-&gt;uc_mcontext.gregs[REG_EFL] &amp;= ~TRAP_FLAG;\n}\n\nint main() {\n  struct sigaction act = {0};\n  act.sa_sigaction = &amp;handler;\n  act.sa_flags = SA_SIGINFO;\n  sigaction(SIGTRAP, &amp;act, NULL);\n  puts(\"Raising SIGTRAP 1\");\n  __asm__(\"pushfq;\"\n          \"pop %rax;\"\n          \"or $0x100, %rax;\"\n          \"push %rax;\"\n          \"popfq;\");\n  puts(\"Raising SIGTRAP 2\");\n  __asm__(\"int3;\");\n  return 0;\n}\n</code></pre>\n\n<p>Here is the expected output:</p>\n\n<pre><code>Raising SIGTRAP 1\nFrom handler\nRaising SIGTRAP 2\nFrom handler\n</code></pre>\n\n<p>Here is the Valgrind output:</p>\n\n<pre><code>Raising SIGTRAP 1\nRaising SIGTRAP 2\nFrom handler\n</code></pre>\n"}, {"tags": ["c", "raspberry-pi"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1563307261, "post_id": 57063894, "comment_id": 100654374, "body": "<a href=\"http://man7.org/linux/man-pages/man3/syslog.3.html\" rel=\"nofollow noreferrer\"><code>syslog</code></a>?"}, {"owner": {"reputation": 647, "user_id": 9773285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e95570197a5ef8f4a067a3669c09143?s=128&d=identicon&r=PG&f=1", "display_name": "Mark A", "link": "https://stackoverflow.com/users/9773285/mark-a"}, "edited": false, "score": 1, "creation_date": 1563308386, "post_id": 57063894, "comment_id": 100654815, "body": "If you&#39;re that concerned about flash wear then you can log to a file in a <a href=\"http://man7.org/linux/man-pages/man5/tmpfs.5.html\" rel=\"nofollow noreferrer\">tmpfs</a>.  That opens up the possibility to use a regular logging library with rotating log files."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1563309643, "post_id": 57063894, "comment_id": 100655328, "body": "If you&#39;re running the Raspbian OS, it uses systemd, and so you can use sd_journal_print() to write to the system journal. It&#39;s designed for exactly that kind of thing."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563309115, "post_id": 57064956, "comment_id": 100655115, "body": "<i>In your case, to implement this, drop the array entirely, and simply <code>fprintf(stdout, &quot;event notice : %s\\n&quot;, eventdetailstring);</code></i>  No, just no.  Using <code>stdout</code> (or <code>stderr</code>) for logging is never a good practice.  Especially for &quot;This program runs 24/7 <i>&quot;forever&quot;</i>&quot;.  Using <code>stdout</code>/<code>stderr</code> irrevocably ties the process to one log file and makes log file rotation impossible, among many other problems.  <code>eventmonitor &gt; logfile</code>?!?!  You really need to think about what happens in that case should <code>logfile</code> fill up the filesystem..."}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563309333, "post_id": 57064956, "comment_id": 100655203, "body": "@AndrewHenle : I guess you didn&#39;t read the rest of my answer, where I addressed exactly the points you raised ..."}, {"owner": {"reputation": 99, "user_id": 3294257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/764db09655e2fc69c83d46db31682276?s=128&d=identicon&r=PG", "display_name": "PeteC", "link": "https://stackoverflow.com/users/3294257/petec"}, "edited": false, "score": 0, "creation_date": 1563414195, "post_id": 57064956, "comment_id": 100694873, "body": "Wow, you folks have provided some good possibilities.  Being a novice I have do some research to know what they mean.  This could take some time.  Also, I got some message about a &quot;Suggested Edit&quot; that removed my two paragraphs starting with &quot;(1)&quot; and &quot;(2)&quot;.  They still seem to be there so, am I the only one to see them or can everyone see them?"}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "reply_to_user": {"reputation": 99, "user_id": 3294257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/764db09655e2fc69c83d46db31682276?s=128&d=identicon&r=PG", "display_name": "PeteC", "link": "https://stackoverflow.com/users/3294257/petec"}, "edited": false, "score": 0, "creation_date": 1563459864, "post_id": 57064956, "comment_id": 100714875, "body": "@PeteC : at this particular moment, I see the &quot;(1)&quot; and &quot;(2)&quot; paragraphs; I&#39;m guessing that if you accept the suggested edit, they will be removed, and that if you decline the suggested edit, they will remain; but I&#39;m doing some guesswork there, since I cannot see exactly what you see"}, {"owner": {"reputation": 99, "user_id": 3294257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/764db09655e2fc69c83d46db31682276?s=128&d=identicon&r=PG", "display_name": "PeteC", "link": "https://stackoverflow.com/users/3294257/petec"}, "edited": false, "score": 0, "creation_date": 1563485735, "post_id": 57064956, "comment_id": 100726818, "body": "Well, to add to the confusion, I went to the page that suggested removing (1) and (2) and clicked &quot;reject&quot;.  i got a message saying &quot;the owner has already approved the edit&quot;.  I don&#39;t think I ever did.  Anyway I clicked &quot;reject&quot;. Now (1) is missing but not (2).  Oh well??????"}], "tags": [], "owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "is_accepted": false, "score": -1, "last_activity_date": 1563308843, "creation_date": 1563308843, "answer_id": 57064956, "question_id": 57063894, "link": "https://stackoverflow.com/questions/57063894/logging-events-looking-for-a-good-way/57064956#57064956", "title": "Logging Events---Looking For a Good Way", "body": "<p>Welcome to Stack Overflow and to C programming!  A wonderful world of possibilities awaits you.</p>\n\n<p>I have several thoughts in response to your situation.</p>\n\n<p><strong>The very short summary is to use <code>stdout</code> and delegate the output-file management to the shell.</strong></p>\n\n<p>The longer, rambling answer full of my personal musing is as follows:</p>\n\n<p><strong>1 :</strong>  A very typical thing for C programs to do is <em>not</em> be in charge of how outputs are kept.  You might have heard of the \"built in\" file handles, <code>stdin</code>, <code>stdout</code>, and <code>stderr</code>.  These file handles are (under normal circumstances) always available to your program for input (from <code>stdin</code>) and output (<code>stdout</code> and <code>stderr</code>).  As you might guess from their names <code>stdout</code> is customarily used for regular output and <code>stderr</code> is customarily used for error / exception output.  It is exceedingly typical for a C program to simply read from <code>stdin</code> and output to <code>stdout</code> and <code>stderr</code>, and let <em>something else</em> (e.g., the shell) take care of what those actually are.</p>\n\n<p>For example, reading from <code>stdin</code> means that your program can be used for keyboard entry <em>and</em> for file reading, <em>without needing to change your program's code</em>.  The same goes for <code>stdout</code> and <code>stderr</code>; simply output to those file handles, and let the user decide whether those should go to the screen or be redirected to a file.  And, because <code>stdout</code> and <code>stderr</code> are separate file handles, the user can have them go to separate 'destinations'.</p>\n\n<p>In your case, to implement this, drop the array entirely, and simply</p>\n\n<pre><code>fprintf(stdout, \"event notice : %s\\n\", eventdetailstring);\n</code></pre>\n\n<p>(or similar) every time your program has something to say.  Take a look at <code>fflush()</code>, too, because of potential output buffering.</p>\n\n<p><strong>2a :</strong> This gets you continuous output.  This itself can help with your concern about memory wear on the Pi's flash disk.  If you do something like:</p>\n\n<pre><code>eventmonitor &gt; logfile\n</code></pre>\n\n<p>then <code>logfile</code> will be being appended to during the lifetime of your program, which will tend to be writing to new parts of the flash disk.  Of course, if you only ever append, you will eventually run out of space on the disk, so you might set up a <code>cron</code> job to kill the currently running <code>eventmonitor</code> and restart it every day at midnight.  Done with the above command, that would cause it to overwrite <code>logfile</code> once per day.  This prevents endless growth, and it <em>might</em> even use a new physical area of the flash drive for the new file (even though it's the same name; underneath, it's a different file, with a different inode, etc.)  But even if it reuses the exact same area of the flash drive, now you are down to worrying if this will last more than 10,000 days, instead of 10,000 writes.  I'm betting that within 10,000 days, new options will be available -- worst case, you buy a new Pi every 27 years or so!</p>\n\n<p>There are other possible variations on this theme, as well.  e.g., you could have a sophisticated script kicked off by <code>cron</code> every day at midnight that kills any currently running <code>eventmonitor</code>, deletes output files older than a week, and starts a new <code>eventmonitor</code> outputting to a file whose filename is based partly on the date so that past days' file aren't overwritten.  But all of this is in the realm of <em>using</em> your program.  You can make your program easier to use by <em>writing</em> it to use <code>stdin</code>, <code>stdout</code>, and <code>stderr</code>.</p>\n\n<p><strong>2b :</strong>  Or, you can just have <code>stdout</code> go to the screen, which is typically how it already is when a program is started from an interactive shell / terminal window.  I imagine you could have the Pi running headless most of the time, and when you want to see what your program is outputting, hook up a monitor.  Generally, things will stay running between disconnecting and reconnecting your monitor.  This avoids affecting the flash drive at all.</p>\n\n<p><strong>3 :</strong>  Another approach is to have your event monitoring program send its output somewhere off-system.  This is getting into more advanced programming territory, so you might want to save this for a later enhancement, after you've mastered more of the basics.  But, your program could establish a network connection to, say, a JSON API and send event information there.  This would let you separate the functions of <em>event monitoring</em> from <em>event reporting</em>.</p>\n\n<p>You will discover as you learn more programming that this idea of <em>separation of concerns</em> is an important concept, and applies at various levels of a program or a system of interoperating programs.  In this case, the Pi is a good fit for the data monitoring aspect because it is a lightweight solution, and some other system with more capacity and more stable storage can cover the data collection aspect.</p>\n"}], "owner": {"reputation": 99, "user_id": 3294257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/764db09655e2fc69c83d46db31682276?s=128&d=identicon&r=PG", "display_name": "PeteC", "link": "https://stackoverflow.com/users/3294257/petec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563486636, "creation_date": 1563303855, "last_edit_date": 1563486636, "question_id": 57063894, "link": "https://stackoverflow.com/questions/57063894/logging-events-looking-for-a-good-way", "title": "Logging Events---Looking For a Good Way", "body": "<p>I created a program that monitors for events.\nI want to log these events \"in the right way\".\nCurrently I have a string array, log[500][100].\nEach line is a string of characters (up to 100) that report something about the event.\nI have it set up so that only the last 500 events are saved in the array.\nAfter that, new events overwrite the oldest events.</p>\n\n<p>Currently I just keep revolving through the array until the program terminates, then I write the array to a file.</p>\n\n<p>Going forward I would like to view the log in real time, any time I wish, without disturbing the event processing and logging process.</p>\n\n<p>I considered opening the file for \"appending\" but here are my concerns:</p>\n\n<p>(1) The program is running on a Raspberry Pi which has a flash memory as a \"disk drive\".  I believe flash memories have a limited number of write cycles before problems can occur.  This program runs 24/7 \"forever\" so I am afraid the \"disk drive\" will \"wear out\".</p>\n\n<p>(2) I am using pretty much all the CPU capacity of the RPi so I don't want to add a lot of overhead/CPU cycles.</p>\n\n<p>How would experienced programmers attack this problem?</p>\n\n<p>Please go easy on me, this is my first C program.</p>\n\n<p>[EDIT]\nI began reviewing all the information and I became intrigued by Mark A's suggestion for tmpfs.  I looked into it more and I am sure this answers my question.  It allows the creation of files in RAM not the SD card.  They are lost on power down but I don't care.\nIn order to keep the files from growing to large I created a double buffer approach.  First I write 500 events to file A then switch to file B. When 500 events have been written to file B I close and reopen file A (to delete the contents and start at 0 events) and switch to writing to file A.  I found I needed to fflush(file...) after each write or else the file was empty until fclose.\nNormally that would be OK but right now I am fighting a nasty segmentation fault so I want as much insight into what is going on.  When I hit the fault, I never get to my fclose statements.</p>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 0, "creation_date": 1563303752, "post_id": 57063832, "comment_id": 100652884, "body": "Do you know what a breakpoint is?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1563303791, "post_id": 57063832, "comment_id": 100652906, "body": "It&#39;s only a breakpoint in your IDE. It helps you debugging, following the instructions one by one and seeing how the variables change."}], "answers": [{"tags": [], "owner": {"reputation": 194, "user_id": 10322433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ouTTb.png?s=128&g=1", "display_name": "blueheart", "link": "https://stackoverflow.com/users/10322433/blueheart"}, "is_accepted": false, "score": 0, "last_activity_date": 1563304743, "last_edit_date": 1563304743, "creation_date": 1563304289, "answer_id": 57063990, "question_id": 57063832, "link": "https://stackoverflow.com/questions/57063832/im-learning-c-programming-recursion-and-doing-an-activity-but-im-stuck/57063990#57063990", "title": "I&#39;m learning C programming recursion and doing an activity but I&#39;m stuck", "body": "<p>change</p>\n\n<pre><code>num = sumOfDigits(num)/10;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>num = sumOfDigits(num/10);\n</code></pre>\n\n<p>The num variable in your example isn't being decreased, the function will call itself until the memory runs out, and you will have a segmentation fault error.</p>\n"}], "owner": {"reputation": 11, "user_id": 11793898, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JNfr0SLgbZQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reKtma0teIzoIfFP5y49pwsal1xEA/photo.jpg?sz=128", "display_name": "Dean", "link": "https://stackoverflow.com/users/11793898/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1563356392, "creation_date": 1563303570, "last_edit_date": 1563356392, "question_id": 57063832, "link": "https://stackoverflow.com/questions/57063832/im-learning-c-programming-recursion-and-doing-an-activity-but-im-stuck", "title": "I&#39;m learning C programming recursion and doing an activity but I&#39;m stuck", "body": "<p>Maybe it's a simple question. I just started learning C alone.\nThere is a break point \n\"if\" in sumOfDigits function.\nBut I have no idea why it is a breakpoint...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint sumOfDigits(int);\n\nint main(int argc, const char * argv[]) {\n    int N;\n\n    scanf(\"%d\", &amp;N);\n    N = sumOfDigits(N);\n    printf(\"%d\", N);\n\n    return 0;\n}\n\nint sumOfDigits (int num)\n{\n    if (num&lt;10)\n        return num;\n    else\n    {\n        num = sumOfDigits(num)/10;\n    return num + num%10;\n}\n}\n</code></pre>\n\n<p>It shows me like this.</p>\n\n<p>Thread 1: breakpoint 1.1</p>\n"}, {"tags": ["c", "microcontroller"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1563300604, "post_id": 57063144, "comment_id": 100651528, "body": "<code>400</code> is a <i>small</i> number, so I would go with the naive linear search."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1563300642, "post_id": 57063144, "comment_id": 100651551, "body": "Use an array, not a list. Sort it. Use <code>bsearch()</code> if you&#39;re lazy or write your own binary search code if this is for a class."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1563301703, "post_id": 57063144, "comment_id": 100652027, "body": "I guess you&#39;ve connected a PT100 sensor. Is it linear? If that&#39;s the case, you could use a linear interpolation just by knowing the largest and smallest values and instead of doing a lookup, you can calculate the value."}], "answers": [{"comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1563301259, "post_id": 57063211, "comment_id": 100651841, "body": "Yes, 400 is such a small number that a simple binary search of an array would be faster than calculating the hash function for a dictionary. And use less memory."}], "tags": [], "owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "is_accepted": false, "score": 1, "last_activity_date": 1563300749, "creation_date": 1563300749, "answer_id": 57063211, "question_id": 57063144, "link": "https://stackoverflow.com/questions/57063144/how-to-search-for-value-in-large-list-of-values/57063211#57063211", "title": "How to search for value in large list of values", "body": "<p>The best way to do that would probably be with a dictionary, but C does not natively have a dictionary so you would need to implement one yourself. Maybe look here: <a href=\"https://stackoverflow.com/questions/4384359/quick-way-to-implement-dictionary-in-c\">Quick Way to Implement Dictionary in C</a></p>\n\n<p>400 is not a lot, however, so even iterating over it should be fine.</p>\n"}, {"tags": [], "owner": {"reputation": 8818, "user_id": 994153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93223e5ce701c54b075a45e57f61f37d?s=128&d=identicon&r=PG", "display_name": "Colin D Bennett", "link": "https://stackoverflow.com/users/994153/colin-d-bennett"}, "is_accepted": true, "score": 1, "last_activity_date": 1563301397, "creation_date": 1563301397, "answer_id": 57063333, "question_id": 57063144, "link": "https://stackoverflow.com/questions/57063144/how-to-search-for-value-in-large-list-of-values/57063333#57063333", "title": "How to search for value in large list of values", "body": "<p>So you are using a lookup table to convert resistance to temperature.  You have a table with 400 entries.  You could use a nearest-neighbor algorithm, where you just write a <code>for</code>-loop and look for the table entry with the closest resistance value to the measured resistance, then report the temperature stored in that table entry.</p>\n\n<p>However, you can do much better.  If you sort the lookup table by resistance you can use <a href=\"https://en.wikipedia.org/wiki/Linear_interpolation\" rel=\"nofollow noreferrer\">linear interpolation</a> to provide a much more accurate conversion.  This means you find the two entries the measured resistance falls between.  Then you interpolate (use arithmetic to compute a temperature proportionally between the table entries) between these entries in order to get a more accurate temperature conversion.</p>\n\n<p>Here is an example of linear interpolation in <a href=\"https://stackoverflow.com/questions/7091294/how-to-build-a-lookup-table-in-c-sdcc-compiler-with-linear-interpolation\">How to build a lookup table in C (SDCC compiler) with linear interpolation</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 3305, "user_id": 1428695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a843c704cdb7e32a93769cddfed4747?s=128&d=identicon&r=PG", "display_name": "yhyrcanus", "link": "https://stackoverflow.com/users/1428695/yhyrcanus"}, "is_accepted": false, "score": 2, "last_activity_date": 1563302078, "creation_date": 1563302078, "answer_id": 57063507, "question_id": 57063144, "link": "https://stackoverflow.com/questions/57063144/how-to-search-for-value-in-large-list-of-values/57063507#57063507", "title": "How to search for value in large list of values", "body": "<p>I would take the 400 data points you have, drop them into excel/program of your choice, and generate a regression function (likely linear, if it's resistance to temperature).</p>\n\n<p>If you're worried about speed, AVR's sometimes have pipelines for L/S, MUL, and ADD, so it could potentially be faster to calculate it than look it up.</p>\n"}, {"tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 1, "last_activity_date": 1563302089, "creation_date": 1563302089, "answer_id": 57063510, "question_id": 57063144, "link": "https://stackoverflow.com/questions/57063144/how-to-search-for-value-in-large-list-of-values/57063510#57063510", "title": "How to search for value in large list of values", "body": "<p>Tables with equidistant x-values are often used in embedded systems.</p>\n\n<p>If your present resistance values (x) for your table are not equidistant, use your desktop computer to calculate/interpolate the temperature values (y) for equidistant resistance values. </p>\n\n<p>Then you can use a simple array of temperature values and calculate the index from the resistance.</p>\n\n<p>Example table, assuming you have a resistance range from 80 to 110 and a corresponding temperature range from 0 to 100.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>resistance temperature (corresponding table index)\n80         0           0\n82         1           1\n84         2           2\n86         4           3\n88         7           4\n...        ...\n108        99          29\n110        100         30\n</code></pre>\n\n<p>Then you can use an array like this</p>\n\n<pre><code>int temp_table[] = { 0, 1, 2, 4, 7, /* ... */ 99, 100 };\n</code></pre>\n\n<p>and calculate the temperature like this:</p>\n\n<pre><code>const int rmin = 80;\nconst int rmax = 110;\nint r; /* assuming this is the measures resistance */\nint temp;\nint index;\n\nif(r &lt; rmin) {\n   /* error min */\n} else if(r &gt; rmax) {\n   /* error max */\n} else {\n   /* This calculates the table index for the highest resistance value \n      from the table not greater than r.   Check your resistance range\n      and factor and divider to  make sure you don't get an overflow here. */\n   index = ( (r - rmin) * (sizeof(temp_table) / sizeof(temp_table[0])) ) / (rmax - rmin);\n   temp = temp_table(index);\n}\n</code></pre>\n\n<p>If you have less table points, you might want to extend this simple table search with linear (or other) interpolation. </p>\n"}], "owner": {"reputation": 29, "user_id": 11793712, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BFAH3Ae8fTc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH8HEZ0SfcTtE8i9l2AWXKi290Qg/photo.jpg?sz=128", "display_name": "darkpanda08", "link": "https://stackoverflow.com/users/11793712/darkpanda08"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 57063333, "answer_count": 4, "score": -4, "last_activity_date": 1563302089, "creation_date": 1563300506, "last_edit_date": 1563300929, "question_id": 57063144, "link": "https://stackoverflow.com/questions/57063144/how-to-search-for-value-in-large-list-of-values", "title": "How to search for value in large list of values", "body": "<p>I have a resistance output in my program. Now I want to convert that to temperature. So for that I have a list of resistance vales and it's corresponding temperature and that list has 400 values. I am programming it in Embedded C for my AVR microcontroller.</p>\n\n<p>I was thinking of making a function with for loop but the number of values are very large so it is not a good idea.</p>\n\n<p>I expect that if I give resistance to be 70 ohms then that function or program should check in that list for the temperature at 70 ohms.</p>\n"}, {"tags": ["c++", "c", "dll", "linker", "lib"], "comments": [{"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 1, "creation_date": 1563300874, "post_id": 57063127, "comment_id": 100651655, "body": "In the dll you need to link to whatever library that implements <code>va_g729a_init_encoder()</code>"}, {"owner": {"reputation": 103, "user_id": 5081244, "user_type": "registered", "profile_image": "https://graph.facebook.com/1172105046149527/picture?type=large", "display_name": "Mohamed Ibrahim", "link": "https://stackoverflow.com/users/5081244/mohamed-ibrahim"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1563301416, "post_id": 57063127, "comment_id": 100651900, "body": "it is the library I added into the linker"}, {"owner": {"reputation": 103, "user_id": 5081244, "user_type": "registered", "profile_image": "https://graph.facebook.com/1172105046149527/picture?type=large", "display_name": "Mohamed Ibrahim", "link": "https://stackoverflow.com/users/5081244/mohamed-ibrahim"}, "reply_to_user": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1563301711, "post_id": 57063127, "comment_id": 100652030, "body": "why marked as duplicate? the duplicate question is talking generally about the error not fixing a specific case I faced and can&#39;t determine where is the problem."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1563301796, "post_id": 57063127, "comment_id": 100652067, "body": "The duplicate most likely covers your case."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1563301894, "post_id": 57063127, "comment_id": 100652102, "body": "<b><i>it is the library I added into the linker</i></b> The linker is saying that you did not do this step properly. Perhaps you added it for 1 configuration but not the other. Note that each configuration (debug / release ...) has independent settings."}, {"owner": {"reputation": 8811, "user_id": 487892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Leb5B.jpg?s=128&g=1", "display_name": "drescherjm", "link": "https://stackoverflow.com/users/487892/drescherjm"}, "edited": false, "score": 0, "creation_date": 1563302692, "post_id": 57063127, "comment_id": 100652418, "body": "What you are doing to make a <code>dll</code> looks correct. Make sure you define <code>WIN32PROJECT2_EXPORTS</code> when building the <code>dll</code> and don&#39;t define it when using the <code>dll</code>. However this has nothing to do with the linker error."}], "owner": {"reputation": 103, "user_id": 5081244, "user_type": "registered", "profile_image": "https://graph.facebook.com/1172105046149527/picture?type=large", "display_name": "Mohamed Ibrahim", "link": "https://stackoverflow.com/users/5081244/mohamed-ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "closed_date": 1563301105, "answer_count": 0, "score": 0, "last_activity_date": 1563300449, "creation_date": 1563300449, "question_id": 57063127, "link": "https://stackoverflow.com/questions/57063127/how-to-recompile-a-lib-into-a-dll", "closed_reason": "Duplicate", "title": "How to recompile a .lib into a dll?", "body": "<p>I am trying to produce a dll from a static library + header file in order to make it as a plugin for another python project.</p>\n\n<p>(<a href=\"https://github.com/muggot/myphone3/tree/master/h323plus/plugins/audio/VoiceAgeG729/va_g729\" rel=\"nofollow noreferrer\">https://github.com/muggot/myphone3/tree/master/h323plus/plugins/audio/VoiceAgeG729/va_g729</a>)</p>\n\n<p>But, I am getting linker errors which I can't figure the real reason behind them.</p>\n\n<p>I tried the accepted answer in [1], but the librarian is not working ( unable to start correctly) so I couldn't make it.</p>\n\n<p>Here is my code for the dll which will wrap one function as example</p>\n\n<p>Win32Project2.h</p>\n\n<pre><code>#ifdef WIN32PROJECT2_EXPORTS\n#define WIN32PROJECT2_API __declspec(dllexport)\n#else\n#define WIN32PROJECT2_API __declspec(dllimport)\n#endif\n#include &lt;C:\\Users\\user name\\Desktop\\CELP/va_g729.h&gt;\n#pragma comment(lib, \"va_g729.lib\")\n\nWIN32PROJECT2_API void fnWin32Project2(void);\n\n</code></pre>\n\n<p>dllmain.cpp</p>\n\n<pre><code>#include \"stdafx.h\"\n\n\nBOOL APIENTRY DllMain( HMODULE hModule,\n                       DWORD  ul_reason_for_call,\n                       LPVOID lpReserved\n                     )\n{\n    switch (ul_reason_for_call)\n    {\n    case DLL_PROCESS_ATTACH:\n    case DLL_THREAD_ATTACH:\n    case DLL_THREAD_DETACH:\n    case DLL_PROCESS_DETACH:\n        break;\n    }\n    return TRUE;\n}\n</code></pre>\n\n<p>Win32Project2.cpp</p>\n\n<pre><code>#include \"stdafx.h\"\n#include \"Win32Project2.h\"\n#include &lt;C:\\Users\\user name\\Desktop\\CELP\\va_g729.h&gt;\n\n// This is an example of an exported function.\nWIN32PROJECT2_API void fnWin32Project2(void)\n{\n    return va_g729a_init_encoder(); // A function inside the .lib\n}\n</code></pre>\n\n<p>I added the directory of the .h into project's properties->C/C++->general->Aditional include directories\nand added the lib path into linker->general->additional libraries directory \nFinally, added the .lib itself into linker->input->additional dependencies</p>\n\n<p>but, I got the following linker errors:\nerror LNK1120: 1 unresolved externals\nError1 error LNK2001: unresolved external symbol \"void __cdecl va_g729a_init_encoder(void)\" (?va_g729a_init_encoder@@YAXXZ) </p>\n\n<p>I understand that linker can't find the function, but why? did I mess something?</p>\n\n<hr>\n\n<p>[1] <a href=\"https://stackoverflow.com/questions/27778169/how-to-import-lib-into-dll\">How to import .lib into .dll?</a></p>\n"}, {"tags": ["c", "cs50", "trie"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1563300441, "post_id": 57063079, "comment_id": 100651459, "body": "It is giving you the line numbers. And only you know what is in there."}, {"owner": {"reputation": 43, "user_id": 11674974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fq-5s9HdGVg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGnOPI-Lg9V1JBQtLheHH2J4XxCQ/mo/photo.jpg?sz=128", "display_name": "CeNiEi", "link": "https://stackoverflow.com/users/11674974/ceniei"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563300604, "post_id": 57063079, "comment_id": 100651529, "body": "can valgrind() cause the IDE to shut down????"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563300667, "post_id": 57063079, "comment_id": 100651560, "body": "IDE can be buggy. You don&#39;t even specify what kind of IDE."}, {"owner": {"reputation": 43, "user_id": 11674974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fq-5s9HdGVg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGnOPI-Lg9V1JBQtLheHH2J4XxCQ/mo/photo.jpg?sz=128", "display_name": "CeNiEi", "link": "https://stackoverflow.com/users/11674974/ceniei"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563301209, "post_id": 57063079, "comment_id": 100651825, "body": "i am using cs50 ide"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563301358, "post_id": 57063079, "comment_id": 100651881, "body": "They have a special IDE now? Cool. This course is doing everything to make it disconnected from the real-world programming as much as possible... I believe there is a dedicated SE site for CS50 somewhere. Here it is <a href=\"https://cs50.stackexchange.com/\">cs50.stackexchange.com</a> , and I saw questions about this exercise are there"}], "owner": {"reputation": 43, "user_id": 11674974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fq-5s9HdGVg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcGnOPI-Lg9V1JBQtLheHH2J4XxCQ/mo/photo.jpg?sz=128", "display_name": "CeNiEi", "link": "https://stackoverflow.com/users/11674974/ceniei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563574577, "creation_date": 1563300266, "last_edit_date": 1563574577, "question_id": 57063079, "link": "https://stackoverflow.com/questions/57063079/pset4-cs50-speller-trie-valgrind-causing-cs50-ide-to-shut-down", "title": "pset4 cs50 speller -trie valgrind causing cs50 IDE to shut down", "body": "<p>I am working on cs50 pset4 speller using trie. When unloading the dictionary although the dictionary is unloaded (it completes without segfault), I can not run valgrind().</p>\n\n<p>Although valgrind() works when i give a small dictionary, but when I use the default large dictionary, valgrind() just stops working and the message of no connection pops up and I am returned to the dashboard. So I tried running check50 with the log flag, and this message popped up:</p>\n\n<pre><code>checking for valgrind errors... \n        Conditional jump or move depends on uninitialised value(s): (file: dictionary.c, line: 77)\n        Conditional jump or move depends on uninitialised value(s): (file: dictionary.c, line: 152)\n        Conditional jump or move depends on uninitialised value(s): (file: dictionary.c, line: 144)\n        Conditional jump or move depends on uninitialised value(s): (file: dictionary.c, line: 114)\n        Conditional jump or move depends on uninitialised value(s): (file: dictionary.c, line: 105)\n        Conditional jump or move depends on uninitialised value(s): (file: dictionary.c, line: 166)\n        32 bytes in 1 blocks are still reachable in loss record 1 of 1\n</code></pre>\n\n<p>I am aware of the last line and trying to fix it, but what are these other lines. I am unloading by the following code.</p>\n\n<pre><code>bool func_unload(node *unloader)\n{\n    node *temp = unloader;\n    for(int i = 0; i &lt; N; i++)\n    {\n        temp = unloader;\n        if(unloader -&gt; children[i] != NULL)\n        {\n            func_unload(unloader -&gt; children[i]);\n        }\n    }\n    free(unloader);\n    unloader = temp;\n    return true;\n}\n\n// Unloads dictionary from memory, returning true if successful else false\nbool unload(void)\n{\n    func_unload(root);\n    return true;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563300271, "post_id": 57063061, "comment_id": 100651385, "body": "Now, format the rest of the code yourself..."}, {"owner": {"reputation": 9, "user_id": 11567407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nz2hMZhEolw/AAAAAAAAAAI/AAAAAAAABsw/d0-MWf08EYw/photo.jpg?sz=128", "display_name": "sourabh sharma", "link": "https://stackoverflow.com/users/11567407/sourabh-sharma"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563300486, "post_id": 57063061, "comment_id": 100651470, "body": "@EugeneSh. thanks, I am posting first time so that&#39;s why I don&#39;t know exactly. it&#39;s just suggested by StackOverflow and I just did it accordingly. but btw thanks and please help me."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1563300738, "post_id": 57063061, "comment_id": 100651585, "body": "The reason for the infinite loop is that fgetc() returns an int, not char. The value EOF is different from any char, so you&#39;ll never see it. Also, what&#39;s the fseek() there for? I see no reason for it at all."}, {"owner": {"reputation": 9, "user_id": 11567407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nz2hMZhEolw/AAAAAAAAAAI/AAAAAAAABsw/d0-MWf08EYw/photo.jpg?sz=128", "display_name": "sourabh sharma", "link": "https://stackoverflow.com/users/11567407/sourabh-sharma"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1563300817, "post_id": 57063061, "comment_id": 100651620, "body": "@LeeDanielCrocker so can you suggest me that what could be the code for this problem. ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1563302422, "post_id": 57063061, "comment_id": 100652310, "body": "@LeeDanielCrocker the <code>fseek</code> is there so that the <code>&#39;l&#39;</code> can be overwritten with a <code>&#39;p&#39;</code>."}, {"owner": {"reputation": 9, "user_id": 11567407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nz2hMZhEolw/AAAAAAAAAAI/AAAAAAAABsw/d0-MWf08EYw/photo.jpg?sz=128", "display_name": "sourabh sharma", "link": "https://stackoverflow.com/users/11567407/sourabh-sharma"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1563302674, "post_id": 57063061, "comment_id": 100652409, "body": "@LeeDanielCrocker  i want to overwrite l with p/"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11567407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nz2hMZhEolw/AAAAAAAAAAI/AAAAAAAABsw/d0-MWf08EYw/photo.jpg?sz=128", "display_name": "sourabh sharma", "link": "https://stackoverflow.com/users/11567407/sourabh-sharma"}, "edited": false, "score": 0, "creation_date": 1563302802, "post_id": 57063490, "comment_id": 100652466, "body": "can you please please explain me little bit more.. because i am new to c. i know how to use fflush(). but why i have to use fflush here , I am not getting."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 9, "user_id": 11567407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nz2hMZhEolw/AAAAAAAAAAI/AAAAAAAABsw/d0-MWf08EYw/photo.jpg?sz=128", "display_name": "sourabh sharma", "link": "https://stackoverflow.com/users/11567407/sourabh-sharma"}, "edited": false, "score": 0, "creation_date": 1563303456, "post_id": 57063490, "comment_id": 100652758, "body": "The man page explains that you have to: <i>When you switch from writing to reading, you must use an intervening call to either fflush or to a file positioning function.</i>"}, {"owner": {"reputation": 9, "user_id": 11567407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nz2hMZhEolw/AAAAAAAAAAI/AAAAAAAABsw/d0-MWf08EYw/photo.jpg?sz=128", "display_name": "sourabh sharma", "link": "https://stackoverflow.com/users/11567407/sourabh-sharma"}, "edited": false, "score": 0, "creation_date": 1563303792, "post_id": 57063490, "comment_id": 100652907, "body": "but i am using fseek() here. it says use either fflush or(fseek(),fsetpos,rewind). so instead of using fflush i used fseek()."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 9, "user_id": 11567407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nz2hMZhEolw/AAAAAAAAAAI/AAAAAAAABsw/d0-MWf08EYw/photo.jpg?sz=128", "display_name": "sourabh sharma", "link": "https://stackoverflow.com/users/11567407/sourabh-sharma"}, "edited": false, "score": 0, "creation_date": 1563303880, "post_id": 57063490, "comment_id": 100652941, "body": "That is between the read and the write. You must deal with changing from write to read too, as the man page says. After the <code>fputc</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 9, "user_id": 11567407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nz2hMZhEolw/AAAAAAAAAAI/AAAAAAAABsw/d0-MWf08EYw/photo.jpg?sz=128", "display_name": "sourabh sharma", "link": "https://stackoverflow.com/users/11567407/sourabh-sharma"}, "edited": false, "score": 0, "creation_date": 1563304696, "post_id": 57063490, "comment_id": 100653280, "body": "It&#39;s what the C standard says. What happens under the hood is the busines of the implementation."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1563302466, "last_edit_date": 1563302466, "creation_date": 1563301995, "answer_id": 57063490, "question_id": 57063061, "link": "https://stackoverflow.com/questions/57063061/i-am-getting-unexpected-output-in-this-program/57063490#57063490", "title": "I am getting unexpected output in this Program", "body": "<p>Please note this from the <a href=\"https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/fopen-wfopen?view=vs-2017\" rel=\"nofollow noreferrer\">man page</a> for <code>fopen()</code>. </p>\n\n<blockquote>\n  <p>When the <strong>\"r+\"</strong>, <strong>\"w+\"</strong>, or <strong>\"a+\"</strong> access type is specified, both reading and writing are enabled (the file is said to be open for \"update\"). However, when you switch from reading to writing, the input operation must encounter an EOF marker. If there is no EOF, you must use an intervening call to a file positioning function. The file positioning functions are <code>fsetpos</code>, <code>fseek</code>, and <code>rewind</code>. <em>When you switch from writing to reading, you must use an intervening call to either <code>fflush</code> or to a file positioning function.</em> (my italics)</p>\n</blockquote>\n\n<p>So after you wrote <code>'p'</code> to the file, it is not enough to carry on reading as though nothing has happened, you must <code>fseek</code> to the original position, obtained by <code>ftell</code>, or <code>fflush</code> the file.</p>\n\n<p>Also don't use magic numbers: in <code>fseek</code> you should use <code>SEEK_CUR</code> not <code>1</code>.</p>\n\n<p>Finally, function <code>fgetc</code> returns an <code>int</code> type, not <code>char</code>. This allows <code>EOF</code> to be distinguished from the data byte <code>0xFF</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 11567407, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nz2hMZhEolw/AAAAAAAAAAI/AAAAAAAABsw/d0-MWf08EYw/photo.jpg?sz=128", "display_name": "sourabh sharma", "link": "https://stackoverflow.com/users/11567407/sourabh-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563302466, "creation_date": 1563300152, "last_edit_date": 1563300613, "question_id": 57063061, "link": "https://stackoverflow.com/questions/57063061/i-am-getting-unexpected-output-in-this-program", "title": "I am getting unexpected output in this Program", "body": "<p>I just want to replace specific character from file.\nfor example, I want to replace character 'l' with character 'p'.\nis it correct way ? </p>\n\n<pre><code>int main() {\n  FILE * ptr;\n  ptr = fopen(\"D:\\f4.txt\", \"r+\");\n\n  if (ptr == NULL) {\n    printf(\"file cant be opened\");\n    exit(0);\n  }\n\n  char ch = fgetc(ptr);\n  while (ch != EOF) {\n    if (ch == 'l') {\n      fseek(ptr, -1, 1);\n      fputc('p', ptr);\n    }\n\n    ch = fgetc(ptr);\n  }\n\n  fclose(ptr);\n}\n</code></pre>\n\n<p>suppose content in my file is \"hello everyone\" so output should be like \"heppo everyone\" but it writes in file \"hepepepepepepepepepepepepepepep\" continuesly. please help me to find why this happen.</p>\n"}, {"tags": ["c", "debugging", "stm32", "adc"], "comments": [{"owner": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 1, "creation_date": 1563307953, "post_id": 57063043, "comment_id": 100654646, "body": "It looks like at least two curly braces are missing at the end, can you please check you code snippet for completeness? Thank you"}, {"owner": {"reputation": 17, "user_id": 11682933, "user_type": "registered", "profile_image": "https://graph.facebook.com/2195617653826948/picture?type=large", "display_name": "Micha\u0142 Suchonos", "link": "https://stackoverflow.com/users/11682933/micha%c5%82-suchonos"}, "reply_to_user": {"reputation": 2528, "user_id": 4658169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b351ed2ce7ddde5ab5ac9bd96200a62d?s=128&d=identicon&r=PG&f=1", "display_name": "CuriouslyRecurringThoughts", "link": "https://stackoverflow.com/users/4658169/curiouslyrecurringthoughts"}, "edited": false, "score": 0, "creation_date": 1563463422, "post_id": 57063043, "comment_id": 100717023, "body": "The brackets are okay, I must have missed them while copying the code. It&#39;s edited now."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11682933, "user_type": "registered", "profile_image": "https://graph.facebook.com/2195617653826948/picture?type=large", "display_name": "Micha\u0142 Suchonos", "link": "https://stackoverflow.com/users/11682933/micha%c5%82-suchonos"}, "edited": false, "score": 0, "creation_date": 1563463900, "post_id": 57064208, "comment_id": 100717345, "body": "after making it <code>volatile</code> the <code>check</code> variable still shows up as 0.0. The <code>SenseADC</code> variable shows constant value of 15474. The ADC resolution is set to 12 bits so it shouldn&#39;t have value greater than 4096 and it certainly should not be constant."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 17, "user_id": 11682933, "user_type": "registered", "profile_image": "https://graph.facebook.com/2195617653826948/picture?type=large", "display_name": "Micha\u0142 Suchonos", "link": "https://stackoverflow.com/users/11682933/micha%c5%82-suchonos"}, "edited": false, "score": 0, "creation_date": 1563477166, "post_id": 57064208, "comment_id": 100723487, "body": "Then something is fundamentally wrong with your compiler or debugger setup."}, {"owner": {"reputation": 17, "user_id": 11682933, "user_type": "registered", "profile_image": "https://graph.facebook.com/2195617653826948/picture?type=large", "display_name": "Micha\u0142 Suchonos", "link": "https://stackoverflow.com/users/11682933/micha%c5%82-suchonos"}, "edited": false, "score": 0, "creation_date": 1563565607, "post_id": 57064208, "comment_id": 100756006, "body": "Okay, I managed to find the solution, for some reason it didn&#39;t upload new version of the program to the microcontroller if previous one had the same file name. After uploading it with external software and then checking value with STMstudio it showed up good results."}], "tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": true, "score": 3, "last_activity_date": 1563305241, "creation_date": 1563305241, "answer_id": 57064208, "question_id": 57063043, "link": "https://stackoverflow.com/questions/57063043/stm32-using-cubemx-and-stmstudio-int-main-doesnt-work/57064208#57064208", "title": "STM32 using CubeMX and STMStudio: &#39;int main()&#39; doesn&#39;t work", "body": "<p>The compiler must have noticed that the <code>check</code> variable is only written and never read, and optimized away the writes as having no purpose. For debugging purposes, you can declare it as <code>volatile</code> to force all writes to get through to memory.</p>\n\n<p>The <code>const</code> values in the program are likewise victims of the optimization, the compiler has used the values directly in the code, possibility precalculating parts of the expressions.</p>\n"}], "owner": {"reputation": 17, "user_id": 11682933, "user_type": "registered", "profile_image": "https://graph.facebook.com/2195617653826948/picture?type=large", "display_name": "Micha\u0142 Suchonos", "link": "https://stackoverflow.com/users/11682933/micha%c5%82-suchonos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 57064208, "answer_count": 1, "score": 0, "last_activity_date": 1563463479, "creation_date": 1563300068, "last_edit_date": 1563463479, "question_id": 57063043, "link": "https://stackoverflow.com/questions/57063043/stm32-using-cubemx-and-stmstudio-int-main-doesnt-work", "title": "STM32 using CubeMX and STMStudio: &#39;int main()&#39; doesn&#39;t work", "body": "<p>I'm learning to code on STM32F429ZI Nucleo board and I've been trying to read temperature from ADC1 temperature sensor using STMStudio. </p>\n\n<p>The code I found in one of tutorials didn't work so I tried checking value of \"check\" variable at various parts of code and then I've noticed that, not only the value of \"check\" variable doesn't change anywhere inside the main function, but also the STMStudio doesn't see any variables declared inside of the main function. </p>\n\n<p>Any idea why is that?</p>\n\n<p>I've tried different code which uses button to light up LED to check if the board is ok and it worked just fine.</p>\n\n<pre><code>    /* Private variables ---------------------------------------------------------*/\nADC_HandleTypeDef hadc1;\n\n/* USER CODE BEGIN PV */\nuint16_t SenseADC;\nfloat check = 0;\nfloat Temperature;\nfloat Vsense;\n\n/* USER CODE END PV */\n\n/* Private function prototypes -----------------------------------------------*/\nvoid SystemClock_Config(void);\nstatic void MX_GPIO_Init(void);\nstatic void MX_ADC1_Init(void);\n/* USER CODE BEGIN PFP */\n\n/* USER CODE END PFP */\n\n/* Private user code ---------------------------------------------------------*/\n/* USER CODE BEGIN 0 */\n\n/* USER CODE END 0 */\n\n/**\n  * @brief  The application entry point.\n  * @retval int\n  */\nint main(void)\n{\n  /* USER CODE BEGIN 1 */\n\n  /* USER CODE END 1 */\n\n  /* MCU Configuration--------------------------------------------------------*/\n\n  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */\n  HAL_Init();\n\n  /* USER CODE BEGIN Init */\n\n  /* USER CODE END Init */\n\n  /* Configure the system clock */\n  SystemClock_Config();\n\n  /* USER CODE BEGIN SysInit */\n\n  /* USER CODE END SysInit */\n\n  /* Initialize all configured peripherals */\n  MX_GPIO_Init();\n  MX_ADC1_Init();\n  /* USER CODE BEGIN 2 */\n  HAL_ADC_Start(&amp;hadc1);\n\n  check = 2;\n  const float V25 = 0.76; // [V]\n  const float Vsupply = 3.0; // [V]\n  const float ADCResolution = 4095;\n  const float avg_slope = 0.0025; // [V/deg. C]\n  /* USER CODE END 2 */\n\n  /* Infinite loop */\n  /* USER CODE BEGIN WHILE */\n  while (1)\n  {\n\n      if(HAL_ADC_PollForConversion(&amp;hadc1,10) == HAL_OK){\n          check = 3;\n          SenseADC = HAL_ADC_GetValue(&amp;hadc1);\n          Vsense=(SenseADC*Vsupply)/ADCResolution;\n          Temperature = (Vsense - V25)/avg_slope + 25;\n\n          HAL_ADC_Start(&amp;hadc1);\n\n      }\n  }\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "linux", "migration", "aix", "porting"], "comments": [{"owner": {"reputation": 141, "user_id": 11747704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb84546faab41a1101a8b54aa6a68b5?s=128&d=identicon&r=PG&f=1", "display_name": "StefOverflow", "link": "https://stackoverflow.com/users/11747704/stefoverflow"}, "edited": false, "score": 1, "creation_date": 1563302971, "post_id": 57062930, "comment_id": 100652533, "body": "Do you have some more insights of what should the <code>userpw</code> struct contain, and of the expected behavior of <code>getuserattr()</code>, <code>getuserpw()</code>, <code>setpwdb()</code> and <code>endpwdb()</code>?"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1563303003, "post_id": 57062930, "comment_id": 100652549, "body": "It is not possible to read a user&#39;s password on Linux, only the hash is stored."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1563304428, "post_id": 57062930, "comment_id": 100653162, "body": "<a href=\"http://man7.org/linux/man-pages/man3/getspnam.3.html\" rel=\"nofollow noreferrer\">getspent()</a> and friends are probably the closest equivalent for the pwdb stuff."}, {"owner": {"reputation": 81, "user_id": 11314808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0213071d44b5850cd94ec603d7d47918?s=128&d=identicon&r=PG&f=1", "display_name": "voyager", "link": "https://stackoverflow.com/users/11314808/voyager"}, "reply_to_user": {"reputation": 141, "user_id": 11747704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb84546faab41a1101a8b54aa6a68b5?s=128&d=identicon&r=PG&f=1", "display_name": "StefOverflow", "link": "https://stackoverflow.com/users/11747704/stefoverflow"}, "edited": false, "score": 0, "creation_date": 1563306255, "post_id": 57062930, "comment_id": 100653960, "body": "@StefOverflow Many thanks for comment. I&#39;ve added links to documentation of those function."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1563312573, "post_id": 57062930, "comment_id": 100656416, "body": "Also see <a href=\"https://stackoverflow.com/q/57050832/608639\">Header files not found when porting from AIX to Linux</a>"}], "answers": [{"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1563306553, "last_edit_date": 1563306553, "creation_date": 1563306219, "answer_id": 57064415, "question_id": 57062930, "link": "https://stackoverflow.com/questions/57062930/migrating-aix-specific-c-function-calls-to-linux/57064415#57064415", "title": "Migrating AIX specific C function calls to Linux", "body": "<p>You likely want to use <a href=\"http://man7.org/linux/man-pages/man3/getpwent.3.html\" rel=\"nofollow noreferrer\"><code>getpwent</code></a>, and its related functions.</p>\n\n<blockquote>\n  <p>The <code>getpwent()</code> function returns a pointer to a structure containing\n         the broken-out fields of a record from the password database (e.g.,\n         the local password file <code>/etc/passwd</code>, NIS, and LDAP).  The first time\n         <code>getpwent()</code> is called, it returns the first entry; thereafter, it\n         returns successive entries.</p>\n  \n  <p>The <code>setpwent()</code> function rewinds to the beginning of the password\n         database.</p>\n  \n  <p>The <code>endpwent()</code> function is used to close the password database after\n         all processing has been performed.</p>\n</blockquote>\n\n<p>If you want to get the password entry of a particular user, you can use <a href=\"http://man7.org/linux/man-pages/man3/getpwnam.3.html\" rel=\"nofollow noreferrer\"><code>getpwnam</code></a> or one of its variants.</p>\n\n<blockquote>\n  <p>The <code>getpwnam()</code> function returns a pointer to a structure containing\n         the broken-out fields of the record in the password database (e.g.,\n         the local password file <code>/etc/passwd</code>, NIS, and LDAP) that matches the\n         username <em>name</em>.</p>\n</blockquote>\n"}], "owner": {"reputation": 81, "user_id": 11314808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0213071d44b5850cd94ec603d7d47918?s=128&d=identicon&r=PG&f=1", "display_name": "voyager", "link": "https://stackoverflow.com/users/11314808/voyager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563306553, "creation_date": 1563299511, "last_edit_date": 1563306059, "question_id": 57062930, "link": "https://stackoverflow.com/questions/57062930/migrating-aix-specific-c-function-calls-to-linux", "title": "Migrating AIX specific C function calls to Linux", "body": "<p>I have got source files from an application on IBM AIX and I am trying to build them on Linux. However, header files named <code>usersec.h</code>and <code>userpw.h</code> which are there on AIX are not present on Linux. Hence, on Linux I am getting compiler error for these functions:</p>\n\n<p>Declared in <code>usersec.h</code></p>\n\n<pre><code>int     getuserattr (char *, char *, void *, int);\n</code></pre>\n\n<p>More info about <code>getuserattr</code> is <a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_aix_71/com.ibm.aix.basetrf1/getuserattr.htm\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Declared in <code>userpw.h</code></p>\n\n<pre><code>struct userpw\n{\n        char    *upw_passwd;            /* user's passwd */\n        unsigned int    upw_flags;      /* flags of restrictions */\n        time_t  upw_lastupdate;         /* date of last passwd update */\n        char    upw_name[PW_NAMELEN];   /* user's name */\n};\n\nstruct userpw   *getuserpw (); \nint setpwdb ();  \nint endpwdb ();\n</code></pre>\n\n<p>Please find more information: <a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_aix_71/com.ibm.aix.basetrf1/getuserpw.htm\" rel=\"nofollow noreferrer\">getuserpw</a>, <a href=\"https://www.ibm.com/support/knowledgecenter/beta/no/ssw_aix_72/s_bostechref/setpwdb.html\" rel=\"nofollow noreferrer\">setpwdb and endpwdb</a></p>\n\n<p>If anyone knows how to write equivalent functions on Linux, it would be really great.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1563298414, "post_id": 57062648, "comment_id": 100650574, "body": "Don&#39;t use <code>gets</code>.  It is a deprecated, unsafe function."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563298428, "post_id": 57062648, "comment_id": 100650582, "body": "Why do you have <code>s</code> at the end of your <code>scanf</code> format string? <code>[^\\t\\n]</code> is a format operator all by itself, it&#39;s <i>not</i> a modifier to <code>%s</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1563298528, "post_id": 57062648, "comment_id": 100650623, "body": "<code>fflush(stdin);</code> is not standard C."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563298642, "post_id": 57062648, "comment_id": 100650672, "body": "<code>fscanf()</code> doesn&#39;t return a character, it returns an integer, the number of inputs processed. Why are you comparing with <code>&#39;\\0&#39;</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563299091, "post_id": 57062648, "comment_id": 100650877, "body": "<code>&amp;p.name</code> should be just <code>p.name</code>."}, {"owner": {"reputation": 13, "user_id": 11793411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ne8rm.png?s=128&g=1", "display_name": "Kim Dave Torres", "link": "https://stackoverflow.com/users/11793411/kim-dave-torres"}, "edited": false, "score": 0, "creation_date": 1563336119, "post_id": 57062648, "comment_id": 100660843, "body": "So what is the  proper way of coding to compare the user inputted string with a space from the file:"}, {"owner": {"reputation": 13, "user_id": 11793411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ne8rm.png?s=128&g=1", "display_name": "Kim Dave Torres", "link": "https://stackoverflow.com/users/11793411/kim-dave-torres"}, "edited": false, "score": 0, "creation_date": 1563336408, "post_id": 57062648, "comment_id": 100660905, "body": "I used gets to get all string included the space that inputted from the user. If I use only scanf it does not include the space only first one word will compare."}, {"owner": {"reputation": 13, "user_id": 11793411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ne8rm.png?s=128&g=1", "display_name": "Kim Dave Torres", "link": "https://stackoverflow.com/users/11793411/kim-dave-torres"}, "edited": false, "score": 0, "creation_date": 1563336631, "post_id": 57062648, "comment_id": 100660950, "body": "I use [^\\t\\n] to read string included the space of it. And if I use only %s will not include space."}, {"owner": {"reputation": 13, "user_id": 11793411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ne8rm.png?s=128&g=1", "display_name": "Kim Dave Torres", "link": "https://stackoverflow.com/users/11793411/kim-dave-torres"}, "edited": false, "score": 0, "creation_date": 1563336822, "post_id": 57062648, "comment_id": 100660986, "body": "I use fflush(stdin)  is to clear (or flush) the output buffer and move the buffered data to console to avoid jumping in to another input."}], "owner": {"reputation": 13, "user_id": 11793411, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ne8rm.png?s=128&g=1", "display_name": "Kim Dave Torres", "link": "https://stackoverflow.com/users/11793411/kim-dave-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1563299343, "answer_count": 0, "score": 0, "last_activity_date": 1563298302, "creation_date": 1563298302, "question_id": 57062648, "link": "https://stackoverflow.com/questions/57062648/i-want-to-compare-the-string-in-file-to-the-user-inputted-but-it-seems-the-out-i", "closed_reason": "Duplicate", "title": "I want to compare the string in file to the user inputted but it seems the out is not equal", "body": "<p>In c programming I want to compare user inputted string from the file using structure check if it is equal.</p>\n\n<p>Even though I use string compare. I still did not solve my problem.</p>\n\n<p>So this is my code in while loop its only read and compare the fist line name of the text file.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\nstruct sample {\nchar name[50];\n}; \nint main() {\n    struct sample p;\n    char ch[50];\n    FILE *fp;\n    FILE *fp2;\n    fp = fopen(\"D:/Users/User/Desktop/test/text.txt\",\"a\");\n\n    fflush(stdin);\n    printf(\"enter 1st string: \");\n    scanf(\"%[^\\t\\n]s\",&amp;p.name);\n    fprintf(fp,\"%s\\n\",p.name);\n    fclose(fp);\n\n    fp2 = fopen(\"D:/Users/User/Desktop/test/text.txt\",\"r\");\n\n    printf(\"enter string to be compared: \");\n    gets(ch);\n\n    printf(\"Your entered string [%s]\\n\",ch);\n\n    while(fscanf(fp2,\"%[^\\n]s\",p.name) != '\\0') {\n        if(strcmpi(ch,p.name) == 0){\n            printf(\"\\nsame:)\\n\");\n        }else{\n            printf(\"\\nnot the same!\\n\");\n       }\n    }\n    fclose(fp2);\n    return 0;\n}\n</code></pre>\n\n<p>I want to compare the user inputted string if it is the same and output or display it \"same:)\".</p>\n"}, {"tags": ["c", "boolean", "boolean-expression"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 8, "creation_date": 1563297856, "post_id": 57062530, "comment_id": 100650292, "body": "Unreleated to the question: All your <code>=</code> should be <code>==</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1563297864, "post_id": 57062530, "comment_id": 100650298, "body": "Please <code>#include &lt;stdbool.h&gt;</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1563297923, "post_id": 57062530, "comment_id": 100650340, "body": "Also, your leap year logic is wrong, it returns true for all multiples of 4, it doesn&#39;t do the century exceptions correctly. See <a href=\"https://stackoverflow.com/questions/3029417/correct-expression-for-checking-leap-years\" title=\"correct expression for checking leap years\">stackoverflow.com/questions/3029417/&hellip;</a>"}, {"owner": {"reputation": 10050, "user_id": 3512538, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/6Om7A.png?s=128&g=1", "display_name": "CIsForCookies", "link": "https://stackoverflow.com/users/3512538/cisforcookies"}, "edited": false, "score": 1, "creation_date": 1563297955, "post_id": 57062530, "comment_id": 100650353, "body": "Use _Bool inatead"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563298015, "post_id": 57062530, "comment_id": 100650374, "body": "You never use the variable <code>leapYear</code>."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1563298034, "post_id": 57062530, "comment_id": 100650384, "body": "Use <code>_Bool</code> or include <code>&lt;stdbool.h&gt;</code> to get the <code>bool</code> alias."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1563298233, "post_id": 57062530, "comment_id": 100650479, "body": "Even if you use <code>_Bool b = true;</code> you still need to <code>#include &lt;stdbool.h&gt;</code> for the <code>true</code> to be accepted."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1563298029, "post_id": 57062544, "comment_id": 100650380, "body": "<code>bool</code> <i>is</i> a standard type since C99"}, {"owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563298113, "post_id": 57062544, "comment_id": 100650419, "body": "@EugeneSh. sorry, wrong terminology. What I meant was it is not included by default, you have to include it yourself."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1563298952, "post_id": 57062544, "comment_id": 100650803, "body": "<code>_Bool</code> is a standard type that is available without inclusion of any headers. So still, yes, booleans are &quot;included by default&quot;.  They need to be, because <code>_Bool</code> has special rules that don&#39;t apply to any other type.  <code>bool</code> is just an alias for <code>_Bool</code>, provided for convenience by stdbool.h."}, {"owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1563299652, "post_id": 57062544, "comment_id": 100651134, "body": "@JohnBollinger It is my understanding that using <code>_Bool</code> is considered bad practice"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1563301261, "post_id": 57062544, "comment_id": 100651842, "body": "Dunno where you got that idea, @ZacharyOldham.  If anything, I&#39;d be inclined to put it the other way around -- using <code>bool</code> in C is potentially problematic because it risks colliding with code that provides its own definition for that symbol, and such code isn&#39;t particularly uncommon.  But that&#39;s entirely beside the point. <code>_Bool</code>s are booleans. The <code>bool</code> of stdbool.h is the same type, but you don&#39;t need the header to have booleans.  (And <code>_Bool</code> <i>is</i> an integer.)"}], "tags": [], "owner": {"reputation": 716, "user_id": 9969356, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-pD3m-C36B4I/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1D7oWVmGPi3Wfxj7hc5UPIpNj5sA/mo/photo.jpg?sz=128", "display_name": "Zachary Oldham", "link": "https://stackoverflow.com/users/9969356/zachary-oldham"}, "is_accepted": false, "score": 1, "last_activity_date": 1563299690, "last_edit_date": 1563299690, "creation_date": 1563297875, "answer_id": 57062544, "question_id": 57062530, "link": "https://stackoverflow.com/questions/57062530/how-to-assign-true-to-a-boolean-variable-in-c-language/57062544#57062544", "title": "How to assign true to a boolean variable in c language", "body": "<p>You would need to <code>#include &lt;stdbool.h&gt;</code> to use booleans, but in C we usually use an integer. The way it works is 0 is false, anything else is true.</p>\n\n<p>In your case, </p>\n\n<pre><code>int leapYear = 0;    // default to false\n... \nleapYear = 1;    // set to true. Any non-zero value works.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 5, "last_activity_date": 1563299388, "last_edit_date": 1563299388, "creation_date": 1563297950, "answer_id": 57062567, "question_id": 57062530, "link": "https://stackoverflow.com/questions/57062530/how-to-assign-true-to-a-boolean-variable-in-c-language/57062567#57062567", "title": "How to assign true to a boolean variable in c language", "body": "<p>You have to include the header file <code>&lt;stdbool.h&gt;</code></p>\n\n<p>In this file <code>bool</code> is defined as a macro and expands to the C standard unsigned integer type <code>_Bool</code>.</p>\n\n<p>Any value that is not equal to <code>0</code> is converted to <code>1</code> and assigned to a variable of the type _Bool.</p>\n\n<p>To set for example a variable to true You could just write</p>\n\n<pre><code>bool leapYear = 1;\n</code></pre>\n\n<p>The header file also contains macros for <code>true</code> and <code>false</code>.</p>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nint main(void) \n{\n    bool leapYear = true;\n\n    printf( \"leapYear = %u\\n\", leapYear );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>leapYear = 1\n</code></pre>\n\n<p>If you do not want to include the header then you could just use the standard integer type <code>_Bool</code>.</p>\n\n<p>For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    _Bool leapYear = 1;\n\n    printf( \"leapYear = %u\\n\", leapYear );\n\n    return 0;\n}\n</code></pre>\n\n<p>Or even the type <code>int</code> like</p>\n\n<pre><code>int leapYear = 1;\n</code></pre>\n\n<p>In C logical operations return integer 1 if an expression is true or 0 otherwise.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1563331147, "post_id": 57063031, "comment_id": 100660005, "body": "Off by 1. 1700 is often considered a non-leap year <a href=\"https://www.quora.com/Why-are-years-such-as-1700-1800-1900-not-leap-years-even-though-they-are-divisible-by-4-but-1600-and-2000-are\" rel=\"nofollow noreferrer\">ref</a>.  Suggest <code>0 == (year % 100) &amp;&amp; year &gt;= 1700</code> or <code>0 == (year % 100) &amp;&amp; year &gt; 1582</code>"}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 1, "last_activity_date": 1563382563, "last_edit_date": 1563382563, "creation_date": 1563300006, "answer_id": 57063031, "question_id": 57062530, "link": "https://stackoverflow.com/questions/57062530/how-to-assign-true-to-a-boolean-variable-in-c-language/57063031#57063031", "title": "How to assign true to a boolean variable in c language", "body": "<p>As everyone has pointed out, your main problem was failure to <code>#include &lt;stdbool.h&gt;</code>. Also, your use of <code>=</code> instead of <code>==</code> in the conditional. I, personally, would not try to use a single conditional because the rules for leap year are complex and hard to translate into a single statement. I'd use a function for clarity:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n\nbool is_leap(int year) {\n    if (0 == (year % 400)) return true;\n    if (0 == (year % 100) &amp;&amp; year &gt; 1582) return false;\n    if (0 == (year % 4)) return true;\n    return false;\n}\n\nint main(int argc, char *argv[]) {\n    . . .\n    bool leap = is_leap(2019);\n    . . .\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11778740, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3reAtshdQZ4/AAAAAAAAAAI/AAAAAAAAXrQ/izfjfnkFonk/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/11778740/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1637, "favorite_count": 0, "accepted_answer_id": 57062567, "answer_count": 3, "score": 0, "last_activity_date": 1563382563, "creation_date": 1563297799, "last_edit_date": 1563298801, "question_id": 57062530, "link": "https://stackoverflow.com/questions/57062530/how-to-assign-true-to-a-boolean-variable-in-c-language", "title": "How to assign true to a boolean variable in c language", "body": "<p>I want to assign true to the boolean variable leapYear if the integer variable year is a leap year (A leap year is a multiple of 4, and if it is a multiple of 100, it must also be a multiple of 400.)in a c program</p>\n\n<p>Here's the code I tried.</p>\n\n<pre><code>bool leapYear;\nint year;\n\nprintf(\"Enter a year \");\nscanf(\"%d\", &amp;year);\nif (year %4 = 0 || year %100 = 0 || year %400 = 0)\n    printf(\"true\");\n</code></pre>\n\n<p>I tried to compile the code I wrote but it gives an error saying unknown type name 'bool'.</p>\n"}, {"tags": ["c", "gcc", "assembly", "x86", "compiler-optimization"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563297428, "post_id": 57062430, "comment_id": 100650119, "body": "Are you saying <code>-O0</code> is still optimizing?"}, {"owner": {"reputation": 384, "user_id": 11157641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c39e56bbe90080366b0456e5daa4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Albuquerque", "link": "https://stackoverflow.com/users/11157641/yuri-albuquerque"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563297502, "post_id": 57062430, "comment_id": 100650149, "body": "I&#39;m saying that even passing this flag, the function is optimized"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563297532, "post_id": 57062430, "comment_id": 100650159, "body": "Does it happen if you enable debugging symbols with <code>-g</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1563297601, "post_id": 57062430, "comment_id": 100650184, "body": "Looks like it is the case.. <a href=\"https://godbolt.org/z/NT0Cr1\" rel=\"nofollow noreferrer\">godbolt.org/z/NT0Cr1</a> Well, I would first ask - why do you need this?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563297700, "post_id": 57062430, "comment_id": 100650221, "body": "I just tried with <code>-g</code>, the answer to my question is yes, it still optimizes."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 4, "creation_date": 1563297732, "post_id": 57062430, "comment_id": 100650226, "body": "Does <code>-fno-builtin</code> work?  Of course, that will probably effect a lot more than <code>printf()</code> optimizations."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1563297837, "post_id": 57062430, "comment_id": 100650284, "body": "@AndrewHenle This works <a href=\"https://godbolt.org/z/FdXIGH\" rel=\"nofollow noreferrer\">godbolt.org/z/FdXIGH</a>"}, {"owner": {"reputation": 6533, "user_id": 1918193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b70a14318e0f417ecac47809f38fafc?s=128&d=identicon&r=PG", "display_name": "Marc Glisse", "link": "https://stackoverflow.com/users/1918193/marc-glisse"}, "edited": false, "score": 4, "creation_date": 1563297919, "post_id": 57062430, "comment_id": 100650337, "body": "<code>-fno-builtin-printf</code> if you want to disable only that one. Documented in the C dialect options."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1563298064, "post_id": 57062430, "comment_id": 100650394, "body": "@EugeneSh.: Yes, <code>-O0</code> will even optimize <code>x &#47; 10</code> to a multiplicative inverse.  See <a href=\"//stackoverflow.com/a/33284629\">Disable all optimization options in GCC</a>.  It still stores everything to memory between C statements (for consistent debugging; that&#39;s what <code>-O0</code> really means); gcc doesn&#39;t have a &quot;fully dumb&quot; mode that tries to transliterate C to asm as naively as possible.  Use <code>tcc</code> for that, or most other compilers with <code>-O0</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1563298131, "post_id": 57062430, "comment_id": 100650427, "body": "@PeterCordes Yeah, my comment was about this specific optimization, I just saved few words making it a bit too general..."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563298134, "post_id": 57062430, "comment_id": 100650429, "body": "@Barmar: <code>-g</code> never has any effect on code-gen for gcc, just how much debug info is emitted as metadata."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1563298237, "post_id": 57062430, "comment_id": 100650482, "body": "@PeterCordes I was hoping that it would impact optimization so you can find the function call when debugging, at least with low optimization levels."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563298244, "post_id": 57062430, "comment_id": 100650485, "body": "@EugeneSh.: Yeah, I was a bit surprised that gcc looked for printf-&gt;putchar at <code>-O0</code> (in fact I didn&#39;t know it did that at all).  But I wasn&#39;t at all shocked; I did remember that it does the normal printf-&gt;puts optimization even at <code>-O0</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563298293, "post_id": 57062430, "comment_id": 100650509, "body": "There are many really simple optimizations that are almost like macro expansions."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1563298302, "post_id": 57062430, "comment_id": 100650515, "body": "@Barmar: <code>-O0</code> makes sure function calls aren&#39;t optimized away.  You can still set a breakpoint on the callsite and step into the call to see where it goes.  And like Andrew and Marc commented, if you want to treat standard functions as not just part of the implementation, there&#39;s <code>-fno-builtin</code> or <code>-fno-builtin-funcname</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1563298350, "post_id": 57062430, "comment_id": 100650539, "body": "Someone should post <code>-fno-builtin</code> as an answer."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1563298886, "post_id": 57062430, "comment_id": 100650766, "body": "@Barmar: yup, you&#39;re right.  Collected some of my comments into an answer."}, {"owner": {"reputation": 384, "user_id": 11157641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c39e56bbe90080366b0456e5daa4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Albuquerque", "link": "https://stackoverflow.com/users/11157641/yuri-albuquerque"}, "edited": false, "score": 0, "creation_date": 1563298892, "post_id": 57062430, "comment_id": 100650769, "body": "Thank you all for the comments"}], "answers": [{"comments": [{"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563304414, "post_id": 57062793, "comment_id": 100653159, "body": "&quot;You can&#39;t disable all optimizations.&quot; This may not be correct. That division to multiplicative inverse optimization appears to be disabled in <code>-Os</code>. Then we can use <code>gcc -Os -Q --help=optimizers | grep enabled</code> to determine what optimizations that are enabled by <code>-Os</code> and explicitly disable each one of them using the corresponding flag. (I&#39;m not sure if there is a flag dedicated to optimizing divisions). <code>-fno-builtin</code> has to also be used (or even <code>-ffreestanding</code>). I don&#39;t know whether this will disable all optimizations, but I don&#39;t agree with that answer you linked."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563304767, "post_id": 57062793, "comment_id": 100653312, "body": "@HadiBrais: I think GCC is always going to at least combine <code>x = y + 1 + 2 +3</code> into <code>x = y + 6</code> with any options, if <code>y</code> is an integer type.  The general point about GCC transforming through an internal representation is good."}, {"owner": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563305031, "post_id": 57062793, "comment_id": 100653429, "body": "Maybe. But the point I&#39;m making is that it doesn&#39;t have to do that transformation to emit native code. I&#39;m not very familiar with gcc&#39;s source code, but we have to look at the code and see what all flags and macros being used to enable/disable every single optimization/compilation pass. Hopefully a gcc developer will see this post and tell us for sure."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 18599, "user_id": 4230618, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KRWgI.jpg?s=128&g=1", "display_name": "Hadi Brais", "link": "https://stackoverflow.com/users/4230618/hadi-brais"}, "edited": false, "score": 0, "creation_date": 1563305356, "post_id": 57062793, "comment_id": 100653572, "body": "@HadiBrais: you could ping \\@MarcGlisse in the comments on the question, he&#39;s a GCC dev."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 6, "last_activity_date": 1563298858, "creation_date": 1563298858, "answer_id": 57062793, "question_id": 57062430, "link": "https://stackoverflow.com/questions/57062430/how-to-get-the-gcc-compiler-to-not-optimize-a-standard-library-function-call-lik/57062793#57062793", "title": "How to get the gcc compiler to not optimize a standard library function call like printf?", "body": "<p>Use <code>-fno-builtin</code> to disable all replacement and inlining of standard C functions with equivalents.</p>\n\n<p>Or use <code>-fno-builtin-FUNCNAME</code> for a specific function, like <code>-fno-builtin-printf</code>.</p>\n\n<p>By default, some commonly-used standard C functions are handled as builtin functions, similar to <code>__builtin_popcount</code>.  The handler for printf replaces it with putchar or puts if possible.  <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html\" rel=\"noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Other-Builtins.html</a></p>\n\n<p>The implementation details of a C statement like <code>printf(\"a\")</code> are not considered a visible side-effect by default, so aren't something that gets preserved.  You can still set a breakpoint at the call-site and step into the function (at least in asm, or in source mode if you have debug symbols installed).</p>\n\n<hr>\n\n<p>To disable other kinds of optimizations for a single function, see <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Common-Function-Attributes.html\" rel=\"noreferrer\"><code>__attribute__((optimize(0)))</code> on a function</a> or <code>#pragma GCC optimize</code>.  But beware:</p>\n\n<blockquote>\n  <p>The <code>optimize</code> attribute should be used for debugging purposes only. It is not suitable in production code.</p>\n</blockquote>\n\n<hr>\n\n<p>You can't disable <em>all</em> optimizations.  Some optimization is inherent in the way gcc transforms through an internal representation on the way to asm.  See <a href=\"//stackoverflow.com/a/33284629\">Disable all optimization options in GCC</a>.  </p>\n\n<p>e.g. even at <code>-O0</code> gcc will optimize <code>x / 10</code> to a multiplicative inverse.</p>\n\n<p>It still stores everything to memory between C statements (for consistent debugging; <a href=\"https://stackoverflow.com/questions/53366394/why-does-clang-produce-inefficient-asm-with-o0-for-this-simple-floating-point\">that's what <code>-O0</code> really means</a>); gcc doesn't have a \"fully dumb\" mode that tries to transliterate C to asm as naively as possible.  Use <code>tcc</code> for that.  Clang and ICC with <code>-O0</code> are somewhat more literal than gcc, and so is MSVC debug mode.</p>\n\n<p>Note that <code>-g</code> never has <em>any</em> effect on code-gen, only on the metadata emitted.  GCC uses other options (mostly <code>-O</code>, <code>-f*</code>, and <code>-m*</code>) to control code-gen, so you can always safely enable <code>-g</code> without hurting performance, other than a larger binary.  It's not debug <em>mode</em> (that's <code>-O0</code>), it's just debug <em>symbols</em>.</p>\n"}], "owner": {"reputation": 384, "user_id": 11157641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c39e56bbe90080366b0456e5daa4f?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Albuquerque", "link": "https://stackoverflow.com/users/11157641/yuri-albuquerque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "accepted_answer_id": 57062793, "answer_count": 1, "score": 6, "last_activity_date": 1563300059, "creation_date": 1563297319, "last_edit_date": 1563300059, "question_id": 57062430, "link": "https://stackoverflow.com/questions/57062430/how-to-get-the-gcc-compiler-to-not-optimize-a-standard-library-function-call-lik", "title": "How to get the gcc compiler to not optimize a standard library function call like printf?", "body": "<p>Out of curiosity, I was wondering if there is any way that gcc does not optimize any function calls?</p>\n\n<p>In the generated assembly code, the printf function is replaced by putchar. This happens even with the default <code>-O0</code> minimal optimization flag.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    printf(\"a\");\n    return 0;\n}\n</code></pre>\n\n<p>(<a href=\"https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(fontScale:1.0749542399999998,j:1,lang:c%2B%2B,source:&#39;%23include+%3Cstdio.h%3E%0A%0Aint+main(void)+%7B%0A++++printf(%22a%22)%3B%0A++++return+0%3B%0A%7D&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:32.752902155887234,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g91,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),fontScale:1.0749542399999998,lang:c%2B%2B,libs:!(),options:&#39;-O0+-Wall&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+9.1+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),k:33.913764510779444,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:clang800,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;0&#39;,libraryCode:&#39;1&#39;,trim:&#39;1&#39;),fontScale:1.0749542399999998,lang:c%2B%2B,libs:!(),options:&#39;-O0+-Wall&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+8.0.0+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),k:33.33333333333333,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">Godbolt</a> showing GCC9 doing it, clang8 keeping it unchanged.)</p>\n"}, {"tags": ["c", "sockets", "epoll", "recv", "multiplexing"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1563296367, "post_id": 57062087, "comment_id": 100649730, "body": "<code>recv(curr_fd, buffer, sizeof(buffer), 0);</code> and <code>printf(&quot;File Descriptor: %d. Message: %s\\n&quot;, curr_fd, buffer);</code> will result in undefined behavior if <code>sizeof(buffer)</code> bytes are received as there is no space for a <code>&#39;\\0&#39;</code> terminator."}], "answers": [{"tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 1, "last_activity_date": 1563296800, "creation_date": 1563296800, "answer_id": 57062294, "question_id": 57062087, "link": "https://stackoverflow.com/questions/57062087/how-do-i-manage-receiving-multiple-buffers-from-multiple-clients-using-epoll/57062294#57062294", "title": "How do I manage receiving multiple buffers from multiple clients using epoll?", "body": "<blockquote>\n  <p>Would I need a separate buffer for each client?</p>\n</blockquote>\n\n<p>Yes. You will need to store a separate client state for each client. As part of that client's state, the partial message buffer should also be stored separately for each client.</p>\n\n<blockquote>\n  <p>Does anyone have any ideas, or any sample code I could look at.</p>\n</blockquote>\n\n<p>You could look at the code for <a href=\"http://facil.io\" rel=\"nofollow noreferrer\">the facil.io library</a>, and it's <a href=\"https://github.com/boazsegev/facil.io/blob/fe7574d70c0bd3aa73a8d592cb902cfd6b8b8837/examples/raw-http.c\" rel=\"nofollow noreferrer\">raw-HTTP example code</a>.</p>\n\n<p>In the example code you will notice that <a href=\"https://github.com/boazsegev/facil.io/blob/fe7574d70c0bd3aa73a8d592cb902cfd6b8b8837/examples/raw-http.c#L55-L71\" rel=\"nofollow noreferrer\">each HTTP client (protocol / state object)</a> will have it's own target <a href=\"https://github.com/boazsegev/facil.io/blob/fe7574d70c0bd3aa73a8d592cb902cfd6b8b8837/examples/raw-http.c#L236-L251\" rel=\"nofollow noreferrer\">buffer for reading</a>.</p>\n\n<p>The facil.io library uses <code>epoll</code> under the hood (or <code>kqueue</code> on BSD/macOS and <code>poll</code> if you really want to go portable) - so the framework's logic applies to your case.</p>\n\n<p>Sometimes it's possible to use a stack allocated (or per-thread) buffer, but this is only true if you later copy the data you need to keep.</p>\n"}], "owner": {"reputation": 247, "user_id": 8310085, "user_type": "registered", "profile_image": "https://graph.facebook.com/1789907944358222/picture?type=large", "display_name": "Alex Erling", "link": "https://stackoverflow.com/users/8310085/alex-erling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563296800, "creation_date": 1563295852, "question_id": 57062087, "link": "https://stackoverflow.com/questions/57062087/how-do-i-manage-receiving-multiple-buffers-from-multiple-clients-using-epoll", "title": "How do I manage receiving multiple buffers from multiple clients using epoll?", "body": "<p>I have a server that is using epoll. My question is what is the best way to process all the buffers so I can deal with half messages, or multiple messages coming in a buffer.</p>\n\n<p><strong>For example:</strong></p>\n\n<p>If the message is \"Hello From Client Number #\".</p>\n\n<p>Buffer's received through epoll:</p>\n\n<p>From Client 1: \"Hello From\"</p>\n\n<p>From Client 2: \"Hello From Client Number 2Hello From Client Number 2\"</p>\n\n<p>From Client 1: \" Client Number 1HelloFromClient Number 1\"</p>\n\n<p>In this scenario, I need to be able to identify that \"Hello From\" is only half a message and store it somewhere. Then I need to be able to process that two whole messages have gone through from Client 2. And then go back and pick up where I left off from Client 1. I know there are ways of distinguishing messages using delimiters, or sending message length, but I'm not quit sure on how to deal with receiving half a message at all.</p>\n\n<p>Does anyone have any ideas, or any sample code I could look at.</p>\n\n<p><em>Note</em> \nI know it's bad that I'm currently processing everything into one buffer. I'm going to change that. Would I need a separate buffer for each client?</p>\n\n<p>Thanks for any help!</p>\n\n<pre><code>void epoll(int listening_port)\n{\n    char buffer[500];       //buffer for message\n    int listen_sock = 0;    //file descriptor (fd) for listening socket\n    int conn_sock = 0;      //fd for connecting socket\n    int epollfd = 0;         // fd for epoll\n    int nfds = 0;           //number of fd's ready for i/o\n    int i = 0;              //index to which file descriptor we are lookng at\n    int curr_fd = 0;        //fd for socket we are currently looking at\n    bool loop = 1;          //boolean value to help identify whether to keep in loop or not\n    socklen_t address_len;\n    struct sockaddr_in serv_addr;\n    struct epoll_event ev, events[EPOLL_MAX_EVENTS];\n    ssize_t result = 0;\n\n\n    bzero(buffer, sizeof(buffer));\n    bzero(&amp;serv_addr, sizeof(serv_addr));\n\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_port = listening_port;\n    serv_addr.sin_addr.s_addr = INADDR_ANY;\n\n    listen_sock = create_socket();\n\n\n    if(bind(listen_sock, SA &amp;serv_addr, sizeof(serv_addr)) != 0)\n    {\n        perror(\"Bind failed\");\n    }\n    else\n    {\n        printf(\"Bind successful\\n\");\n    }\n\n\n    set_socket_nonblocking(listen_sock);\n\n    listen_on_socket(listen_sock, SOMAXCONN); //specifying max connections in backlog\n\n    epollfd = initialize_epoll();\n\n    ev.events = EPOLLIN | EPOLLOUT | EPOLLET | EPOLLRDHUP;\n    ev.data.fd = listen_sock;\n\n    if(epoll_ctl(epollfd, EPOLL_CTL_ADD, listen_sock, &amp;ev) == ERROR)\n    {\n        perror(\"Epoll_ctl: listen sock\");\n    }\n    else\n    {\n        printf(\"Successfully added listen socket to epoll\\n\");\n    }\n\n    while (RUN_EPOLL)\n    {\n        nfds = epoll_wait(epollfd, events, EPOLL_MAX_EVENTS, 0); //waiting for incoming connection;\n        if(nfds == ERROR)\n        {\n            perror(\"EPOLL_Wait\");\n        }\n        //printf(\"Finished waiting\\i\");\n\n        for(i = 0; i &lt; nfds; ++i)\n        {\n            curr_fd = events[i].data.fd;\n            loop = true; //reset looping flag\n            //Notification from Listening Socket - Process Incoming Connections\n\n            if (curr_fd == listen_sock) {\n\n                while(loop)\n                {\n                    conn_sock = accept(listen_sock, SA &amp;serv_addr, &amp;address_len); //accept incoming connection\n                    printf(\"Accepted new incoming connection - socket fd: %d\\n\", conn_sock);\n                    if (conn_sock &gt; 0) //if successful set socket nonblocking and add it to epoll\n                    {\n\n                        set_socket_nonblocking(conn_sock);\n\n                        ev.events = EPOLLIN | EPOLLOUT| EPOLLET | EPOLLRDHUP; //setting flags\n                        ev.data.fd = conn_sock; //specify fd of new connection in event to follow\n                        if (epoll_ctl(epollfd, EPOLL_CTL_ADD, conn_sock, &amp;ev) == ERROR) //add fd to monitored fd's\n                        {\n                            perror(\"epoll_ctl: conn_sck\");\n                        }\n                        else\n                        {\n                            printf(\"Added %d to monitor list\\n\", conn_sock);\n                        }\n\n\n                    }\n                    else if (conn_sock == ERROR)\n                    {\n                        if ((errno == EAGAIN) || (errno == EWOULDBLOCK))\n                        {\n                            printf(\"All incoming connections processed\\n\");\n                            loop = false;\n                        }\n                        else\n                        {\n                            perror(\"Accept remote socket\");\n                            loop = false;\n                        }\n                    }\n                }\n            }\n            else if(events[i].events &amp; EPOLLRDHUP) //detecting if peer shutdown\n            {\n                printf(\"Detected socket peer shutdown. Closing now. \\n\");\n\n                if (epoll_ctl(epollfd, EPOLL_CTL_DEL, curr_fd, NULL) == ERROR) {\n                    perror(\"epoll_ctl: conn_sck\");\n                }\n\n                close_socket(curr_fd);\n            }\n            else if(events[i].events &amp; EPOLLIN)\n            {\n                while(loop)\n                {\n                    result = recv(curr_fd, buffer, sizeof(buffer), 0);\n                    //printf(\"Length of incoming message is %d\\i\", result);\n\n                    if(result &gt; 0) //\n                    {\n                        printf(\"File Descriptor: %d. Message: %s\\n\", curr_fd, buffer); //I know this will need to be changd\n                        bzero(buffer, sizeof(buffer));\n                    }\n                    else if(result == ERROR) //Message is completely sent\n                    {\n\n                        if(errno == EAGAIN)\n                        {\n\n                            loop = false;\n\n                        }\n                    }\n                    else if(result == 0)\n                    {\n                        //Removing the fd from the monitored descriptors in epoll\n                        if (epoll_ctl(epollfd, EPOLL_CTL_DEL, curr_fd, NULL) == ERROR) {\n                            perror(\"epoll_ctl: conn_sck\");\n                        }\n                        close_socket(curr_fd); //Closing the fd\n                        loop = false;\n                    }\n\n                }\n\n            }\n        }\n\n    }\n\n    close_socket(listen_sock);\n    //need to develop way to gracefully close out of epoll\n\n    return;\n\n}\n</code></pre>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1563294644, "post_id": 57061773, "comment_id": 100648927, "body": "It is probably used as an initializer for some array or structure. Just replace the occurrences of the macro name with it&#39;s body."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1563294722, "post_id": 57061773, "comment_id": 100648966, "body": "You can grep the source tree for uses of those macros in <code>.c</code> or other <code>.h</code> files.  (I usually use <code>find</code>, <code>xargs</code>, and <code>grep</code>, but I think grep also has an <code>-R</code> option to recursively grep subdirectories.)"}, {"owner": {"reputation": 5101, "user_id": 700170, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gZ8hw.png?s=128&g=1", "display_name": "Morten Jensen", "link": "https://stackoverflow.com/users/700170/morten-jensen"}, "edited": false, "score": 0, "creation_date": 1563296177, "post_id": 57061773, "comment_id": 100649628, "body": "It&#39;s a 16 byte / 128 bit initializer for the &quot;any&quot; + &quot;loopback&quot; address. The 32bit IPv4 equivalent is <code>#define INADDR_ANY ((unsigned long int) 0x00000000)</code> + <code>#define INPORT_ANY 0</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1563296195, "post_id": 57061773, "comment_id": 100649642, "body": "The <code>_INIT</code> portion of the macro identifiers is a strong signal about their intended usage: they are meant to be used as <i>initializers</i>.  Moreover, their specific syntactic form has no other use in C. In particular, they are initializers suitable for objects of type <code>struct in6_addr</code> (which is also strongly clued by their identifiers)."}], "answers": [{"tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 1, "last_activity_date": 1563294919, "last_edit_date": 1563294919, "creation_date": 1563294838, "answer_id": 57061832, "question_id": 57061773, "link": "https://stackoverflow.com/questions/57061773/i-dont-understand-a-macro-of-inet-netinet-in-h/57061832#57061832", "title": "I don&#39;t understand a macro of inet/netinet/in.h", "body": "<p><a href=\"http://man7.org/linux/man-pages/man7/ipv6.7.html\" rel=\"nofollow noreferrer\">The man page</a> explains well.</p>\n\n<blockquote>\n  <p>To bind an <code>AF_INET6</code> socket to any process, the local address should\n  be copied from the <code>in6addr_any</code> variable which has <code>in6_addr</code> type. \n  In static initializations, <strong><code>IN6ADDR_ANY_INIT</code></strong> may also be used,\n  which expands to a constant expression.  Both of them are in network\n  byte order. The IPv6 loopback address <code>(::1)</code> is available in the\n  global <code>in6addr_loopback</code> variable.  For initializations,\n  <strong><code>IN6ADDR_LOOPBACK_INIT</code></strong> should be used. IPv4 connections can be handled with the v6 API by using the v4-mapped-on-v6 address type;\n  thus a program needs to support only this API type to support both\n  protocols.  This is handled transparently by the address handling\n  functions in the C library.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "is_accepted": true, "score": 3, "last_activity_date": 1563296143, "creation_date": 1563296143, "answer_id": 57062148, "question_id": 57061773, "link": "https://stackoverflow.com/questions/57061773/i-dont-understand-a-macro-of-inet-netinet-in-h/57062148#57062148", "title": "I don&#39;t understand a macro of inet/netinet/in.h", "body": "<p>These are initializers for <code>struct in6_addr</code>. The <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/netinet/in.h.html\" rel=\"nofollow noreferrer\">standard</a> requires <code>struct in6_addr</code> to have at least the single member <code>s6_addr</code>, which must be a <code>uint8_t[16]</code>.</p>\n\n<p>Most of the time, <code>struct in6_addr</code> is, however, implemented as a nested union containing 8, 16 and 32-bit integers arrays for optimized access. For example, glibc has</p>\n\n<pre><code>struct in6_addr {\n  union {\n    uint8_t __u6_addr8[16];\n    uint16_t __u6_addr16[8];\n    uint32_t __u6_addr32[4];\n  } __in6_u;\n};\n</code></pre>\n\n<p>and an accessor define</p>\n\n<pre><code>#define s6_addr                 __in6_u.__u6_addr8\n</code></pre>\n\n<p>Remember, that union initializers need their own set of curly brackets and operate on the first member of the union. The outermost <code>{}</code> are required for the struct, the next level of <code>{}</code> for the union and the innermost <code>{}</code> for the array initializer.</p>\n\n<p>Hence</p>\n\n<pre><code>#define IN6ADDR_ANY_INIT { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }\n</code></pre>\n\n<p>which is</p>\n\n<pre><code>0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0 \n</code></pre>\n\n<p>and</p>\n\n<pre><code>#define IN6ADDR_LOOPBACK_INIT { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }\n</code></pre>\n\n<p>which is</p>\n\n<pre><code>::1\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9883670, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6J2FltgXY20/AAAAAAAAAAI/AAAAAAAAAM8/8zkLaCuSu8A/photo.jpg?sz=128", "display_name": "James Miguel Jaramillo Huaman", "link": "https://stackoverflow.com/users/9883670/james-miguel-jaramillo-huaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 57062148, "answer_count": 2, "score": 2, "last_activity_date": 1563296143, "creation_date": 1563294593, "question_id": 57061773, "link": "https://stackoverflow.com/questions/57061773/i-dont-understand-a-macro-of-inet-netinet-in-h", "title": "I don&#39;t understand a macro of inet/netinet/in.h", "body": "<p>I'm working with IPv6 migration of software drivers in C and I want to understand the following macro of <b>IN6ADDR_ANY_INIT</b> and <b>IN6ADDR_LOOPBACK_INIT</b>. Please help: </p>\n\n<pre><code>/* Copyright (C) 1991-2019 Free Software Foundation, Inc.\n   This file is part of the GNU C Library.\n   The GNU C Library is free software; you can redistribute it and/or\n   modify it under the terms of the GNU Lesser General Public\n   License as published by the Free Software Foundation; either\n   version 2.1 of the License, or (at your option) any later version.\n   The GNU C Library is distributed in the hope that it will be useful,\n   but WITHOUT ANY WARRANTY; without even the implied warranty of\n   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n   Lesser General Public License for more details.\n   You should have received a copy of the GNU Lesser General Public\n   License along with the GNU C Library; if not, see\n   &lt;http://www.gnu.org/licenses/&gt;.  */\n\n#ifndef        _NETINET_IN_H\n#define        _NETINET_IN_H        1\n#include &lt;features.h&gt;\n#include &lt;bits/stdint-uintn.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;bits/types.h&gt;\n\n.\n.\n.\n\n#define IN6ADDR_ANY_INIT { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }\n#define IN6ADDR_LOOPBACK_INIT { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }\n</code></pre>\n"}, {"tags": ["c", "image", "interpolation", "gstreamer", "video-processing"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563353647, "post_id": 57061579, "comment_id": 100667831, "body": "If you want to remove 1 pixel at a time I suggest you can either remove it horizontally or vertically. If the crop ratio is \u2265 16:9 remove the strip from the nearer of the left or right edge. Otherwise remove the strip from the nearer of the top or bottom edge."}, {"owner": {"reputation": 39, "user_id": 9350052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z7ZcZ.jpg?s=128&g=1", "display_name": "Emmanuel Ruaud", "link": "https://stackoverflow.com/users/9350052/emmanuel-ruaud"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563355442, "post_id": 57061579, "comment_id": 100668907, "body": "Thanks, so if I want a perfect aspect ratio I iterate cropping pixels in both dimensions until I have it ? I am concerned about the smoothness of the transition if so. It may not be so awful on large pictures (I have been testing in 640x480 until now)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563355867, "post_id": 57061579, "comment_id": 100669174, "body": "Perhaps a better transition is to always crop left or right, and also crop the top/bottom if it goes under 16:9. Then the major dimension is changing smoothly."}, {"owner": {"reputation": 39, "user_id": 9350052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z7ZcZ.jpg?s=128&g=1", "display_name": "Emmanuel Ruaud", "link": "https://stackoverflow.com/users/9350052/emmanuel-ruaud"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1563367507, "post_id": 57061579, "comment_id": 100675460, "body": "I will try it out I let you know when I have results."}], "owner": {"reputation": 39, "user_id": 9350052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z7ZcZ.jpg?s=128&g=1", "display_name": "Emmanuel Ruaud", "link": "https://stackoverflow.com/users/9350052/emmanuel-ruaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563352714, "creation_date": 1563293786, "last_edit_date": 1563352714, "question_id": 57061579, "link": "https://stackoverflow.com/questions/57061579/cropping-by-1px-while-keeping-aspect-ratio", "title": "Cropping by 1px while keeping aspect ratio", "body": "<p>I am using gstreamer to simulate camera movement in a video stream. I have a 4K video and I want to extract a 1080p image that can be both cropped and scaled from the original.\nThe process needs to be really smooth.</p>\n\n<p>I am currently using the gstreamer videocrop and videoscale elements and I update the element properties to set the coordinates of the image I want to extract.\nThe process I tried is the following: </p>\n\n<ul>\n<li>I specify the coordinates of a region of interest of any size.</li>\n<li>I set this ROI as a target</li>\n<li>A function is called and crops 1px of the image along the coordinate that is the furthest from its destination while trying to maintain the aspect ratio.</li>\n<li>I sleep a few ms</li>\n<li>I repeat the function until the destination is reached or I have a new one</li>\n</ul>\n\n<p>The issue I have right now is that when I crop only 1px in some axis I can't get a perfect aspect ratio anymore.</p>\n\n<p>I could remove 16px and 9px each time to stay in 16:9 but it would appear odd right ?</p>\n\n<p>I am wondering if there is some sort of interpolation algorithm that handles this problem. I did not find anything relevant though.\nAny idea or comments ?</p>\n"}, {"tags": ["c", "bilinear-interpolation"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1563293561, "post_id": 57061429, "comment_id": 100648420, "body": "It is more complex than just adding <code>main</code>. You also need to read the image. What is its format? Finally you need to write the scaled image back again. I suggest you get some help. It may too much to ask and explain here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5494880"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1563295844, "post_id": 57061429, "comment_id": 100649497, "body": "<code>image_1.jpeg</code> is the image I am using for this. The output can be whatever, <code>image_1_larger.jpeg</code> for example. It is bilinear interpolation, so it scales an image up 60%. My post got edited, so the link was lost: <a href=\"https://rosettacode.org/wiki/Bilinear_interpolation#C\" rel=\"nofollow noreferrer\">rosettacode.org/wiki/Bilinear_interpolation#C</a>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1563298368, "post_id": 57061429, "comment_id": 100650550, "body": "Then you also need to decode the jpeg image. It&#39;s getting more complex... You could convert the jpeg to a bmp and then read the bmp, which is simpler but absolutely not rivial either."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5494880"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1563299695, "post_id": 57061429, "comment_id": 100651158, "body": "If I just use a bmp, is there a simple way to do this?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1563300341, "post_id": 57061429, "comment_id": 100651425, "body": "My answer at <a href=\"https://stackoverflow.com/questions/47768094/pointer-file-randomly-changes-value-in-middle-of-reading-raw-bitmap-data\" title=\"pointer file randomly changes value in middle of reading raw bitmap data\">stackoverflow.com/questions/47768094/&hellip;</a> shows how to read a bitmap image, however, you mus still convert scanlines to the pixel data of your structure. A scanline is rounded up and the last few bytes are unused, You must <i>not</i> copy those to your image data. Still: it is probably too complex for you, I guess, but maybe this helps."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1563307329, "post_id": 57061429, "comment_id": 100654389, "body": "First one has to decode jpeg compression to get an uncompressed image, eg, <a href=\"https://keyj.emphy.de/nanojpeg/\" rel=\"nofollow noreferrer\">keyj.emphy.de/nanojpeg</a>. At first glance, it appears their code is using 32-bit RGBA pixel format, but your jpeg file is probably 24-bits, so that may cause an issue. You could edit it with eg gimp to a format compatible with this code."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 11700128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rlam5.png?s=128&g=1", "display_name": "elucent", "link": "https://stackoverflow.com/users/11700128/elucent"}, "is_accepted": false, "score": 0, "last_activity_date": 1563301016, "creation_date": 1563301016, "answer_id": 57063260, "question_id": 57061429, "link": "https://stackoverflow.com/questions/57061429/running-c-bilinear-interpolation/57063260#57063260", "title": "Running C Bilinear Interpolation", "body": "<p>Your problem here is probably less so figuring out how to call <code>scale</code>, and more so figuring out how to load your images. I recommend the <a href=\"https://www.lonesock.net/soil.html\" rel=\"nofollow noreferrer\">SOIL library</a>, it handles most common formats and gets you the raw pixel data.</p>\n\n<p>You'll also most likely need some function to create the actual <code>image_t</code> instances from the raw image. SOIL and other image libraries should be able to provide you the width and height, as well as some kind of byte or int array for the image itself. image_t appears to be row-major in your example, so something like this could work:</p>\n\n<pre><code>image_t to_image_t(int width, int height, unsigned char* data) {\n    image_t img = { malloc(sizeof(int) * width * height), width, height };\n    for (int i = 0; i &lt; width * height; i ++) {\n        // You may need to fiddle with this based on your image's format\n        // and how you load it.\n        img-&gt;pixels[i] = (data[0] &lt;&lt; 24)\n                       | (data[1] &lt;&lt; 16)\n                       | (data[2] &lt;&lt; 8)\n                       | (data[3]);\n    }\n    return img;\n}\n</code></pre>\n\n<p>Just remember to free your image's pixel data after you're done using it.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5494880"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563301016, "creation_date": 1563293204, "last_edit_date": 1563295914, "question_id": 57061429, "link": "https://stackoverflow.com/questions/57061429/running-c-bilinear-interpolation", "title": "Running C Bilinear Interpolation", "body": "<p>I came across this, the C version of Bilinear interpolation. I can't figure out how to run it. I have an image called <code>image_1.jpeg</code> that I want to use...</p>\n\n<p>It looks you just need to call scale(), but how exactly do you write the main() method to do that?</p>\n\n<p>The Code -></p>\n\n<pre><code>#include &lt;stdint.h&gt;\ntypedef struct {\n    uint32_t *pixels;\n    unsigned int w;\n    unsigned int h;\n} image_t;\n#define getByte(value, n) (value &gt;&gt; (n*8) &amp; 0xFF)\n\nuint32_t getpixel(image_t *image, unsigned int x, unsigned int y){\n    return image-&gt;pixels[(y*image-&gt;w)+x];\n}\nfloat lerp(float s, float e, float t){return s+(e-s)*t;}\nfloat blerp(float c00, float c10, float c01, float c11, float tx, float ty){\n    return lerp(lerp(c00, c10, tx), lerp(c01, c11, tx), ty);\n}\nvoid putpixel(image_t *image, unsigned int x, unsigned int y, uint32_t color){\n    image-&gt;pixels[(y*image-&gt;w) + x] = color;\n}\nvoid scale(image_t *src, image_t *dst, float scalex, float scaley){\n    int newWidth = (int)src-&gt;w*scalex;\n    int newHeight= (int)src-&gt;h*scaley;\n    int x, y;\n    for(x= 0, y=0; y &lt; newHeight; x++){\n        if(x &gt; newWidth){\n            x = 0; y++;\n        }\n        float gx = x / (float)(newWidth) * (src-&gt;w-1);\n        float gy = y / (float)(newHeight) * (src-&gt;h-1);\n        int gxi = (int)gx;\n        int gyi = (int)gy;\n        uint32_t result=0;\n        uint32_t c00 = getpixel(src, gxi, gyi);\n        uint32_t c10 = getpixel(src, gxi+1, gyi);\n        uint32_t c01 = getpixel(src, gxi, gyi+1);\n        uint32_t c11 = getpixel(src, gxi+1, gyi+1);\n        uint8_t i;\n        for(i = 0; i &lt; 3; i++){\n            //((uint8_t*)&amp;result)[i] = blerp( ((uint8_t*)&amp;c00)[i], ((uint8_t*)&amp;c10)[i], ((uint8_t*)&amp;c01)[i], ((uint8_t*)&amp;c11)[i], gxi - gx, gyi - gy); // this is shady\n            result |= (uint8_t)blerp(getByte(c00, i), getByte(c10, i), getByte(c01, i), getByte(c11, i), gx - gxi, gy -gyi) &lt;&lt; (8*i);\n        }\n        putpixel(dst,x, y, result);\n    }\n}\n</code></pre>\n\n<p>source: <a href=\"https://rosettacode.org/wiki/Bilinear_interpolation#C\" rel=\"nofollow noreferrer\">https://rosettacode.org/wiki/Bilinear_interpolation#C</a></p>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "printf", "dimension"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1563292730, "post_id": 57061273, "comment_id": 100648022, "body": "Remove the newline character and replace with spaces/tabs? You might also want to look at the width specifier for the format strings."}, {"owner": {"reputation": 4535, "user_id": 59081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c17b54bbea172f608e552f9bf67d4f9?s=128&d=identicon&r=PG", "display_name": "Tanveer Badar", "link": "https://stackoverflow.com/users/59081/tanveer-badar"}, "edited": false, "score": 0, "creation_date": 1563292903, "post_id": 57061273, "comment_id": 100648117, "body": "And perhaps a single <code>fprintf</code> with a format string having two specifiers?"}, {"owner": {"reputation": 1, "user_id": 11793098, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lM8F_Oboxu0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbzper4Dz_lPqoulXRBGOM7nI0Og/photo.jpg?sz=128", "display_name": "Jhonatan Palacios", "link": "https://stackoverflow.com/users/11793098/jhonatan-palacios"}, "edited": false, "score": 0, "creation_date": 1563292950, "post_id": 57061273, "comment_id": 100648144, "body": "That did make them separated by column, but it only creates one line of data compared to my fprintf(stdout) code"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563293018, "post_id": 57061273, "comment_id": 100648169, "body": "I don&#39;t understand your question. How many lines do you expect? And why?"}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1563293031, "post_id": 57061273, "comment_id": 100648178, "body": "Could you edit the question to add the desired output and what you&#39;re getting? Because it&#39;s getting kind of confusing."}, {"owner": {"reputation": 1, "user_id": 11793098, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lM8F_Oboxu0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbzper4Dz_lPqoulXRBGOM7nI0Og/photo.jpg?sz=128", "display_name": "Jhonatan Palacios", "link": "https://stackoverflow.com/users/11793098/jhonatan-palacios"}, "edited": false, "score": 0, "creation_date": 1563293248, "post_id": 57061273, "comment_id": 100648291, "body": "I&#39;ve edited it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1563293402, "post_id": 57061273, "comment_id": 100648350, "body": "Your edit have just invalidated the previous comments, but did not make it any clearer. You are printing one line and asking why it is printing one line."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563293992, "post_id": 57061525, "comment_id": 100648601, "body": "What does it improve?"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 1, "creation_date": 1563295137, "post_id": 57061525, "comment_id": 100649171, "body": "Er, why be cute with the comma operator in that error check and not a more usual <code>if (fptr == NULL) { fprintf(stderr, &quot;Can not open&#47;create file\\n&quot;); exit(EXIT_FAILURE); }</code>?"}, {"owner": {"reputation": 1899, "user_id": 8854921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b76055b306b4dbab08ee558957f52e?s=128&d=identicon&r=PG&f=1", "display_name": "Bo R", "link": "https://stackoverflow.com/users/8854921/bo-r"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563309513, "post_id": 57061525, "comment_id": 100655276, "body": "@EugeneSh. The question was different when I answered it (it used two <code>printf</code>). Now I&#39;m a bit confused as to what the question asker wants."}, {"owner": {"reputation": 1899, "user_id": 8854921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b76055b306b4dbab08ee558957f52e?s=128&d=identicon&r=PG&f=1", "display_name": "Bo R", "link": "https://stackoverflow.com/users/8854921/bo-r"}, "reply_to_user": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1563309575, "post_id": 57061525, "comment_id": 100655302, "body": "@Shawn It was a bit hasty to my local formatter to not use so many lines. I&#39;ll adjust."}], "tags": [], "owner": {"reputation": 1899, "user_id": 8854921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b76055b306b4dbab08ee558957f52e?s=128&d=identicon&r=PG&f=1", "display_name": "Bo R", "link": "https://stackoverflow.com/users/8854921/bo-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1563309655, "last_edit_date": 1563309655, "creation_date": 1563293540, "answer_id": 57061525, "question_id": 57061273, "link": "https://stackoverflow.com/questions/57061273/how-could-i-improve-my-code-for-printing-to-a-text-file-in-c/57061525#57061525", "title": "How could I improve my code for printing to a text file in C?", "body": "<p>Here is an improvement suggestion:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n  unsigned i1 = 101;\n  unsigned j1 = 202;\n\n  FILE *fptr = fopen(\"Dimensions.txt\", \"w\");\n  if (fptr == NULL) {\n    fprintf(stderr, \"Can not open/create file\\n\");\n    exit(EXIT_FAILURE);\n  }\n  fprintf(fptr, \"%u %u\\n\", i1, j1);\n  fclose(fptr);\n  return EXIT_SUCCESS;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11793098, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lM8F_Oboxu0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfbzper4Dz_lPqoulXRBGOM7nI0Og/photo.jpg?sz=128", "display_name": "Jhonatan Palacios", "link": "https://stackoverflow.com/users/11793098/jhonatan-palacios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1563309655, "creation_date": 1563292659, "last_edit_date": 1563293236, "question_id": 57061273, "link": "https://stackoverflow.com/questions/57061273/how-could-i-improve-my-code-for-printing-to-a-text-file-in-c", "title": "How could I improve my code for printing to a text file in C?", "body": "<p>I'm working with the open-source thermal simulator HotSpot 6.0, I seek to extract the dimensional parameters -x and -y onto a text file to use for a new thermal modeling tool. </p>\n\n<p>I've tried terminal printing x and y locations:</p>\n\n<pre><code>fprintf(stdout, \"Location in x: %u\\n\", i1);\nfprintf(stdout, \"Location in y: %u\\n\", j1);\n</code></pre>\n\n<p>The above code prints lines of i1 and j1 numbers, but I would like to have them saved to a text file.\nThe code below is my attempt at printing to a text file.</p>\n\n<pre><code>FILE *fptr;\nfptr = fopen(\"Dimensions.txt\",\"w\");\nfprintf(fptr,\"%u\\t %u\\t\",i1,j1);\nfclose(fptr);\n</code></pre>\n\n<p>The output of the code above prints only one line of code. I would like to know why this is to fix it.</p>\n"}, {"tags": ["c", "memory", "embedded"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1563291246, "post_id": 57060802, "comment_id": 100647149, "body": "Put the breakpoint at the first line of <code>main</code> and check then.  It should be initialized by the startup code before main is entered. <a href=\"https://stackoverflow.com/questions/17783210/when-are-static-and-global-variables-initialized\" title=\"when are static and global variables initialized\">stackoverflow.com/questions/17783210/&hellip;</a>"}, {"owner": {"reputation": 840, "user_id": 6704493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4c301ad478ef6b75733125f2b3d049d?s=128&d=identicon&r=PG&f=1", "display_name": "Pawe\u0142 Dymowski", "link": "https://stackoverflow.com/users/6704493/pawe%c5%82-dymowski"}, "edited": false, "score": 1, "creation_date": 1563293107, "post_id": 57060802, "comment_id": 100648220, "body": "Most of the compilers add __main() at the beginning or before actual main() to initialize statics, so you have to let appliaction to start"}, {"owner": {"reputation": 351, "user_id": 4604759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de599df6671db42349c8b438ec7a350?s=128&d=identicon&r=PG&f=1", "display_name": "MiCo", "link": "https://stackoverflow.com/users/4604759/mico"}, "edited": false, "score": 0, "creation_date": 1563296797, "post_id": 57060802, "comment_id": 100649879, "body": "Please check that in your map file contains entries for the .bss and/or .data sections."}, {"owner": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 1, "creation_date": 1563321042, "post_id": 57060802, "comment_id": 100658337, "body": "If you&#39;re using some custom or non-standard startup code then most likely you&#39;re missing a loop which zeroes out the .bss segment."}, {"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "reply_to_user": {"reputation": 259, "user_id": 4526054, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N5Ub5.jpg?s=128&g=1", "display_name": "brhans", "link": "https://stackoverflow.com/users/4526054/brhans"}, "edited": false, "score": 0, "creation_date": 1563352437, "post_id": 57060802, "comment_id": 100667199, "body": "@brhans It looks like you are right. Please check <code>UPDATE-2</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1563749924, "post_id": 57060802, "comment_id": 100790757, "body": "It is very common for embedded compilers to provide a &quot;minimal&quot; or &quot;fast&quot; startup code, which essentially does nothing but setting the stack pointer. From what I remember, Cosmic does this too (it&#39;s been ages since I used it). You would have to create a project as &quot;standard&quot;, &quot;ANSI&quot; or whatever the compiler calls it. Only then will it initialize <code>.bss</code> and <code>.data</code>. You can see this for yourself if you single step the startup code from the reset vector and onward. It&#39;s common practice in embedded to avoid writing code that relies on static storage initialization because of this."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1563749981, "post_id": 57060802, "comment_id": 100790770, "body": "You might find this helpful: <a href=\"https://electronics.stackexchange.com/questions/237740/what-resides-in-the-different-memory-types-of-a-microcontroller/237759#237759\">What resides in the different memory types of a microcontroller?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1563303179, "post_id": 57060962, "comment_id": 100652631, "body": "@Clifford The OP says &quot;<b>before</b> running the application itself&quot; (emphasis mine), with together of some other wording make me think that the OP is using a hardware debugger or similar, and doesn&#39;t enter the C startup code which does the initialization."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 1, "creation_date": 1563348045, "post_id": 57060962, "comment_id": 100664890, "body": "Indeed - now I read more carefully.  The important clue comes <i>way down</i> the question.  It does say that but it does not say that <code>crc32_buffer()</code> is being invoked them, merely that the value observed in is memory while at the reset vector - i.e.. the CRT is not performing initialisation.  However later he says that it does break on a data access break-point, indicating <i>initialisation on first use</i> so you are right, except this is not a CRT initialisation, but a local static initialise on first use."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1563291607, "creation_date": 1563291607, "answer_id": 57060962, "question_id": 57060802, "link": "https://stackoverflow.com/questions/57060802/static-variable-is-not-initialized-to-zero/57060962#57060962", "title": "Static variable is not initialized to zero", "body": "<p>If you read <a href=\"https://en.cppreference.com/w/c/language/storage_duration#Storage_duration\" rel=\"nofollow noreferrer\">this storage duration reference</a> you will see that for static storage duration</p>\n\n<blockquote>\n  <p>the value stored in the object is initialized only once, prior to main function</p>\n</blockquote>\n\n<p>So you have to let the startup code running before <code>main</code> run first. Once the <code>main</code> function is called the value should have been initialized.</p>\n"}, {"comments": [{"owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "edited": false, "score": 0, "creation_date": 1563351462, "post_id": 57070659, "comment_id": 100666715, "body": "I think that when I define a new <code>static</code> variable and initialize it to <code>FALSE</code>, when I first check its value in the <code>if</code> statement, it should have the initial value of <code>FALSE</code>, right? This is not the case for me. When I check its value, I find <code>once</code> has the value of <code>0x14</code> instead of <code>0</code>"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "edited": false, "score": 0, "creation_date": 1563352546, "post_id": 57070659, "comment_id": 100667259, "body": "@Salahuddin OK, but that is not clear in your question. Also if you have hit a data access breakpoint, something accessed it.  You need to set it to a write access rather than read/write to be more selective re initialisation.  Also inspect the code disassembly and register values.  Some debuggers do not handle static variables well and may give misleading indications."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 0, "last_activity_date": 1563348571, "creation_date": 1563348571, "answer_id": 57070659, "question_id": 57060802, "link": "https://stackoverflow.com/questions/57060802/static-variable-is-not-initialized-to-zero/57070659#57070659", "title": "Static variable is not initialized to zero", "body": "<blockquote>\n  <p>I find the memory location 0x80 has again 0x14 before running the application.</p>\n</blockquote>\n\n<p>Initialisation requires code; the state of the memory after reset,  <em>before</em> any code has executed is non-deterministic.</p>\n\n<blockquote>\n  <p>I tried setting a breakpoint if the memory location 0x80 was accessed (read/write) but the application didn't stop until it reached the if statement in the code snippet.</p>\n</blockquote>\n\n<p>That sounds like the initialisation right there.  What value did the variable acquire at that point?  Local statics can be initialised on first use, rather than in the run-time start-up.  It looks to me that in fact you do not have a problem at all other than understanding the semantics of static.</p>\n\n<p>If for example you place a break-point on the <code>static</code> declaration itself, and run it, I expect you will observe that the break point is hit once on first use initialisation, and thereafter will not break on subsequent calls to the function.</p>\n"}], "owner": {"reputation": 1167, "user_id": 932786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/49bf3465e918ef75eb511f089b833bb1?s=128&d=identicon&r=PG", "display_name": "Salahuddin", "link": "https://stackoverflow.com/users/932786/salahuddin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 57060962, "answer_count": 2, "score": 1, "last_activity_date": 1563352394, "creation_date": 1563291098, "last_edit_date": 1563352394, "question_id": 57060802, "link": "https://stackoverflow.com/questions/57060802/static-variable-is-not-initialized-to-zero", "title": "Static variable is not initialized to zero", "body": "<p>I'm developing an embedded application on <code>stm8s</code> microcontroller using <code>STVD</code> IDE and <code>COSMIC</code> compiler.</p>\n\n<p>I'm trying to define a <code>static bool</code> variable to use it to execute a snippet of code only once. Unexpectedly, the variable <code>once</code> is not initialized to <code>FALSE</code> or <code>0</code>. Although I explicitly initialized it. Here is the snippet of my code:</p>\n\n<pre><code>uint32_t crc32_buffer(void)\n{\n    static bool once = FALSE;\n    uint32_t crc = 0;\n\n    if(!once)\n    {\n        calcTable();\n        crc = 10;\n        once = TRUE;\n    }\n\n    return crc;\n}\n</code></pre>\n\n<p>When I tried to check the physical memory location, I found that every time after entering a new debugging session (even after hardware restarting the controller) and before running the application itself, the memory address <code>0x80</code> has the same value <code>0x14</code>. </p>\n\n<p>If I modified the code to assign <code>FALSE</code> to <code>once</code> after the variable's initialization:</p>\n\n<pre><code>once = FALSE;\n</code></pre>\n\n<p>The memory location is changed to contain <code>0x00</code>. Then if I exit this debugging session and then re-modified the code to delete this line of code and start a new debugging session, I find the memory location <code>0x80</code> has again <code>0x14</code> before running the application.</p>\n\n<p>I don't understand what can prevent the compiler to initialize the variable to <code>0</code>. I don't understand what can write <code>0x14</code> to the memory location even before running the application.</p>\n\n<p>I tried setting a breakpoint if the memory location <code>0x80</code> was accessed (read/write) but the application didn't stop until it reached the <code>if</code> statement in the code snippet.</p>\n\n<p><strong>UPDATE-2</strong></p>\n\n<p>As many pointed out the startup procedure, I don\u2019t use the default startup code. However, I'm using a custom one.\nWhen I used the standard startup code instead of the custom one I was using, the memory locations were set to <code>0</code> before <code>main()</code> function start execution. This is not the case with the custom startup code.\nSo, when I define a new <code>static</code> variable and explicitly initialize it to <code>FALSE</code>, this initialization will only take place in the startup code before <code>main()</code>, right?</p>\n"}, {"tags": ["c", "function", "recursion", "cs50"], "comments": [{"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 2, "creation_date": 1563291071, "post_id": 57060678, "comment_id": 100647045, "body": "Hint: Transforming a loop into a recursion can sometimes be quite tricky. It\u2019s much simpler to take the original formulation of the Collatz problem and write it directly as a recursion. This is much more straightforward."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1563291367, "post_id": 57060678, "comment_id": 100647223, "body": "Other hint: to get familiar with recursion write the factorial function as recursive function."}, {"owner": {"reputation": 726, "user_id": 11583672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nmhaz.jpg?s=128&g=1", "display_name": "Giampietro Seu", "link": "https://stackoverflow.com/users/11583672/giampietro-seu"}, "edited": false, "score": 0, "creation_date": 1563291466, "post_id": 57060678, "comment_id": 100647293, "body": "Hint: are the inner <code>while</code> loops really needed in your code?"}], "answers": [{"tags": [], "owner": {"reputation": 308, "user_id": 3927579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79c6744b7d14faaaa0cf636601f0aeb5?s=128&d=identicon&r=PG", "display_name": "tbejos", "link": "https://stackoverflow.com/users/3927579/tbejos"}, "is_accepted": false, "score": 0, "last_activity_date": 1563292150, "creation_date": 1563292150, "answer_id": 57061126, "question_id": 57060678, "link": "https://stackoverflow.com/questions/57060678/how-to-change-code-to-create-a-recursive-function/57061126#57061126", "title": "How to change code, to create a recursive function", "body": "<p>For something like this I would recommend having a recursive function that return's the number of time's it took to get n to be equal to 1, since that's really all you want to keep track of. Since the code you are trying to make recursive is a loop, this make's it relatively easy to find what your base case (or exit condition) is going to be. In this case it's going to be when n == 1. So this lead's us to have something like this</p>\n\n<pre><code>int recursive_function(int n) {\n    if (n == 1) {\n        return 0;\n    }\n}\n</code></pre>\n\n<p>Now we need to focus on the logic, in order to keep track of the number of times the function has run (j essentially), we should make the function return the amount of times it's ran, then this will make it a lot easier to keep track of. So for this we'll add another return statement to the function, and make it run again since we already have our exit condition set up to tell us when to stop. After that you just need to add the logic in as well but we should end up with something like this:</p>\n\n<pre><code>int recursive_function(int n) {\n    if (n == 1) {\n        return 0;\n    } else if (n % 2 != 0 ) {\n        n = 3 * n + 1 ;\n    } else if (n % 2 == 0) {\n        n /= 2;\n    }\n    return 1 + recursive_function(n);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2199, "user_id": 1762556, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/10LnU.jpg?s=128&g=1", "display_name": "Ki J&#233;y", "link": "https://stackoverflow.com/users/1762556/ki-j%c3%a9y"}, "edited": false, "score": 1, "creation_date": 1563292582, "post_id": 57061209, "comment_id": 100647929, "body": "You mean to return <code>n * fact(n - 1)</code> in your first example"}], "tags": [], "owner": {"reputation": 54, "user_id": 11302416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7Qo0.jpg?s=128&g=1", "display_name": "toobladink", "link": "https://stackoverflow.com/users/11302416/toobladink"}, "is_accepted": false, "score": 0, "last_activity_date": 1563298947, "last_edit_date": 1563298947, "creation_date": 1563292447, "answer_id": 57061209, "question_id": 57060678, "link": "https://stackoverflow.com/questions/57060678/how-to-change-code-to-create-a-recursive-function/57061209#57061209", "title": "How to change code, to create a recursive function", "body": "<p>Well, since you don't know what a recursive function may look like or how it should call itself, here's a quick example.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int fact(int n)\n{\n  if (n == 0) // this is the stopping case\n    return 1;\n  else\n    return n * fact(n-1)); // this is what makes the function recursive\n}\n</code></pre>\n\n<p>In this example, we are calculating the factorial of a number. We need to have a branch so when we know when we should stop calling the function. Fundamentally, this recursive function is the same as follows:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>for (int i = 0; i &lt; n; i ++)\n{\n  result = result * i;\n}\n</code></pre>\n\n<p>Having a function being recursive means it's getting rid of a loop. I'd encourage you to start with your outermost while loop, and determine how you can eliminate that by implementing some return functions in various parts of your code to make it recursive. As a hint, it looks like you should have the following <code>if</code> statement:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>if (n != 1)\n  return /* whatever is fit for your stopping case, should be an integer */\n</code></pre>\n\n<p>Another important thing to notice with recursive functions - the input needs to change when you make the function call itself. What I mean is, you should not have a function like this:</p>\n\n<pre><code>int x(int n)\n{\n  if (n == 0)\n    return 1;\n  else\n    return x(n);\n}\n</code></pre>\n\n<p>Inputting the same number and not having something like <code>return x(n-1)</code> will create an infinite loop, because there's no possible way to reach the stopping case, unless the original number inputted reaches the stopping case.</p>\n\n<p>Of course, you may also add more calculations with your recursive call, and write something like <code>return 7 * x(n) / 2;</code>. Many beginners often forget this when learning about recursive functions and only want to write something like <code>return x(n-2);</code> for their return statements.</p>\n\n<p>In your case, it looks like that the \"stopping case\" should be <code>if (n == 1)</code>. </p>\n\n<p>Hopefully that should be enough to get you started!</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1563292503, "creation_date": 1563292503, "answer_id": 57061228, "question_id": 57060678, "link": "https://stackoverflow.com/questions/57060678/how-to-change-code-to-create-a-recursive-function/57061228#57061228", "title": "How to change code, to create a recursive function", "body": "<p>Here you are.:)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nunsigned int collatz( unsigned int n )\n{\n    return n &lt; 2 ? 0 : 1 + collatz( n % 2 == 0 ? n / 2 : 3 * n + 1 );\n}\n\nint main(void) \n{\n    while ( 1 )\n    {\n        unsigned int n;\n\n        printf( \"Enter a non-negative number (0 - exit): \" );\n\n        if ( scanf( \"%u\", &amp;n ) != 1 || n == 0 ) break;\n\n        printf( \"The number of steps is %u\\n\\n\", collatz( n ) );\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output might look like</p>\n\n<pre><code>Enter a non-negative number (0 - exit): 19\nThe number of steps is 20\n\nEnter a non-negative number (0 - exit): 0\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8754547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e67a9b2cbc4768783f3677b47f801232?s=128&d=identicon&r=PG&f=1", "display_name": "Szabolcs Hatala", "link": "https://stackoverflow.com/users/8754547/szabolcs-hatala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1563298947, "creation_date": 1563290691, "last_edit_date": 1563292595, "question_id": 57060678, "link": "https://stackoverflow.com/questions/57060678/how-to-change-code-to-create-a-recursive-function", "title": "How to change code, to create a recursive function", "body": "<p>I am enrolled in a course called CS50. I have been learning about recursive functions recently, and although I have created a program called Collatz, that does what I want it to do, it does not have a recursive function inside as the function does not call itself. I am stuck and I can't figure out, how should I implement a recursive function, so that it looks neat and clean and calls itself.</p>\n\n<p>I have tried to implement a function beside my main function. But I don't know how should that function look like, and how does it call itself.</p>\n\n<pre><code>//int x(int n);\n\nint main(void)\n{\n    int n;\n    //j is a counter for the number of times 'n' has to be calculated to get n==1\n    int j = 0;\n\n    //Ask for an integer\n    printf(\"Int: \");\n    scanf(\"%i\", &amp;n);\n\n    //Check for 0 or less\n    if (n &lt;= 0)\n    {\n        printf(\"ERROR.\")\n        return 1;\n    }\n\n    //This is where recursion should be implemented\n    while (n != 1)\n    {\n        if (n % 2 != 0)\n        {\n            while ((n % 2) != 0)\n            {\n                n = 3*n + 1 ;\n                j++;\n            }\n        }\n        else if ((n % 2) == 0)\n        {\n            while (n != 1)\n            {\n                n /= 2;\n                j++;\n            }\n        }\n    }\n    printf(\"N: %i, number of times: %i \\n\", n,j);\n}\n\n/*\nint x(int n)\n{\n    Should a recursive function be implemented here?\n}\n*/\n</code></pre>\n\n<p>Output is ok as is.\nOutput should be the number n which should be always 1, so to prove the program works and always get to number 1 , and amount of how many steps does it take to get to 1 from n.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1563289951, "post_id": 57060340, "comment_id": 100646413, "body": "I believe it should be <code>(*high)[0]</code> and <code>(*high)++;</code>"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1563290018, "post_id": 57060340, "comment_id": 100646440, "body": "@FirstStrike What about an element with zero value in the original array?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1563290037, "post_id": 57060340, "comment_id": 100646452, "body": "But why use double indirection anyway? Just use single indirection."}, {"owner": {"reputation": 726, "user_id": 11583672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nmhaz.jpg?s=128&g=1", "display_name": "Giampietro Seu", "link": "https://stackoverflow.com/users/11583672/giampietro-seu"}, "edited": false, "score": 0, "creation_date": 1563290065, "post_id": 57060340, "comment_id": 100646470, "body": "<code>if(array[i] &gt; 0)</code> should be <code>if(arr[i] &gt; 0)</code>"}, {"owner": {"reputation": 1246, "user_id": 1385652, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/36c394d66e9444796f59d490c7608e1a?s=128&d=identicon&r=PG", "display_name": "Hossein Nasr", "link": "https://stackoverflow.com/users/1385652/hossein-nasr"}, "edited": false, "score": 0, "creation_date": 1563290871, "post_id": 57060340, "comment_id": 100646936, "body": "please try to compile your code first and after that post it here."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1563302661, "post_id": 57060340, "comment_id": 100652405, "body": "Rather than copying values to new arrays, I suggest you simply reorder them in place so that all negative values come first. Keep a count so you know how many you have (<code>kneg</code>) and where the first non-negative value is (at <code>array[kneg]</code> (unless all values are negative))."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1563303534, "post_id": 57060340, "comment_id": 100652793, "body": "Continuing my previous comment: something like this --- <a href=\"https://ideone.com/t3xtHF\" rel=\"nofollow noreferrer\">ideone.com/t3xtHF</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1153, "user_id": 11345381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3322e1e397dd7f2626bd3b7280585b1?s=128&d=identicon&r=PG&f=1", "display_name": "rtoijala", "link": "https://stackoverflow.com/users/11345381/rtoijala"}, "is_accepted": true, "score": 2, "last_activity_date": 1563290591, "creation_date": 1563290591, "answer_id": 57060646, "question_id": 57060340, "link": "https://stackoverflow.com/questions/57060340/split-an-int-array-in-a-c-function-and-return-2-different-arrays/57060646#57060646", "title": "Split an int array in a C function and return 2 different arrays", "body": "<p>As mentioned in the comments, the double indirection with <code>int**</code> is unnecessary. A more suitable interface to the function is shown below.\nIt takes as input the array and count, and pointers to large enough output arrays. As output, the arrays are filled with the positive (negative) values, and the count for each is written to <code>*npos</code> (<code>*nneg</code>).</p>\n\n<p>Treatment of zeroes is left to you. Just edit the <code>if</code> conditions.</p>\n\n<p>Also note how I use <code>*npos += 1</code> instead of <code>(*npos)++</code> to avoid mistakes with operator precedence.</p>\n\n<pre><code>void separate(int *arr, int cnt, int *neg, int *pos, int *nneg, int *npos)\n{\n    *nneg = 0;\n    *npos = 0;\n\n    for(int i = 0; i &lt; cnt; i++)\n    {\n        if (arr[i] &gt; 0)\n        {\n            pos[*npos] = arr[i];\n            *npos += 1;\n        }\n        else if (arr[i] &lt; 0)\n        {\n            neg[*nneg] = arr[i];\n            *nneg += 1;\n        }\n    }\n}\n</code></pre>\n\n<p>While in your example you know how many positive and negative values there are, in general you should allocate arrays that are definitely large enough, i.e. <code>cnt</code> elements.</p>\n"}], "owner": {"reputation": 19, "user_id": 11792760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bd5e265f2c27402ef13e3c8e654d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "FirstStrike", "link": "https://stackoverflow.com/users/11792760/firststrike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 57060646, "answer_count": 1, "score": 0, "last_activity_date": 1563290789, "creation_date": 1563289575, "last_edit_date": 1563290789, "question_id": 57060340, "link": "https://stackoverflow.com/questions/57060340/split-an-int-array-in-a-c-function-and-return-2-different-arrays", "title": "Split an int array in a C function and return 2 different arrays", "body": "<p>I try to split an int array. This array contains positive and negative numbers and I want the function to return 2 arrays one with the positive numbers and one with the negative numbers.</p>\n\n<p>I already tried the following code but it doesn't work as expected.</p>\n\n<pre><code> int main(void)\n    {\n            int array[] = {1, -1, 2, 3, 4, -5, 6};\n            int cnt = sizeof(array)/sizeof(array[0]);\n            int *neg, *pos;\n            int **low = &amp;neg;\n            int **high = &amp;pos;\n\n            neg = (int*) malloc(sizeof(int) * 2);\n            pos = (int*) malloc(sizeof(int) * 5);\n\n            sort(array, cnt, low, high);\n\n            for(int i = 0; i &lt; 5; i++)\n            {\n                   printf(\"%3d\\n\", pos[i]);\n            }\n\n            //same for negative array\n\n            return 0;\n\n    }\n\n    int sort(int *arr, int cnt, int **low, int **high)\n    {\n          for(int i = 0; i &lt; cnt; i++)\n          {\n               if(arr[i] &gt; 0)\n               {\n                   *high[0] = arr[i];\n                   **high++;\n               }\n               else\n               {\n                   *low[0] = arr[i];\n                   **low++;\n               }\n          }\n    }\n</code></pre>\n\n<p>If someone could show me what I am doing wrong would help a lot.</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "edited": false, "score": 3, "creation_date": 1563287909, "post_id": 57059785, "comment_id": 100645152, "body": "Using one loop does not decrease time complexity.."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1563288122, "post_id": 57059785, "comment_id": 100645295, "body": "Please be careful when editing your questions, so you don&#39;t remove other peoples edits (unless it&#39;s a faulty edit)."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1563288739, "post_id": 57059785, "comment_id": 100645665, "body": "@Udit Gavasane Show the form of the triangle you are going to output."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1563288031, "post_id": 57059841, "comment_id": 100645230, "body": "That&#39;s really not that different from the loops the OP already have. The OP want only a <i>single</i> loop, not nested loops."}, {"owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1563288106, "post_id": 57059841, "comment_id": 100645280, "body": "@Someprogrammerdude it is not happen with a single loop :)"}], "tags": [], "owner": {"reputation": 1199, "user_id": 11152032, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge37s.png?s=128&g=1", "display_name": "Anshu", "link": "https://stackoverflow.com/users/11152032/anshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1563288032, "last_edit_date": 1563288032, "creation_date": 1563287967, "answer_id": 57059841, "question_id": 57059785, "link": "https://stackoverflow.com/questions/57059785/how-to-print-an-equilateral-triangle-in-c-using-1-loop/57059841#57059841", "title": "How to print an equilateral Triangle in C using 1 loop?", "body": "<p>you can try this </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int i, j, rows;\n\n    /* Input number of rows to print */\n    printf(\"Enter number of rows : \");\n    scanf(\"%d\", &amp;rows);\n\n    /* Iterate through rows */\n    for(i=1; i&lt;=rows; i++)\n    { \n        /* Print leading spaces */\n        for(j=i; j&lt;rows; j++)\n        {\n            printf(\" \");\n        }\n\n        /* Print star */\n        for(j=1; j&lt;=(2*i-1); j++)\n        {\n            printf(\"*\");\n        }\n\n        /* Move to next line */\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>Enter number of rows: 5\n    *\n   ***\n  *****\n *******\n*********\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "is_accepted": false, "score": 0, "last_activity_date": 1563292710, "creation_date": 1563292710, "answer_id": 57061293, "question_id": 57059785, "link": "https://stackoverflow.com/questions/57059785/how-to-print-an-equilateral-triangle-in-c-using-1-loop/57061293#57061293", "title": "How to print an equilateral Triangle in C using 1 loop?", "body": "<p>Yes, you could use an unreadable single loop (testable <a href=\"https://wandbox.org/permlink/22ZS8qqJY28JLlil\" rel=\"nofollow noreferrer\">HERE</a>).</p>\n\n<pre><code>void print_triangle(int n)\n{\n    if (n &lt; 1)\n        return;\n\n    int m = n * n;\n    for (int i = 0, e = n - 1, f = 0; i &lt; m; ++i)\n    {\n        if ( i &gt;= f )\n           putchar('*');\n        if ( i != e )\n            putchar(' ');\n        else\n        {\n            putchar('\\n');\n            f += n + 1;\n            e += n;\n        }\n    }\n}\n</code></pre>\n\n<p>Whether it is worth the pain or not is questionable. I'd say no.</p>\n"}], "owner": {"reputation": 1, "user_id": 11792537, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-92mBDiSOB9A/AAAAAAAAAAI/AAAAAAAAALw/zdBYpoKNytA/photo.jpg?sz=128", "display_name": "Udit Gavasane", "link": "https://stackoverflow.com/users/11792537/udit-gavasane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1563299789, "creation_date": 1563287796, "last_edit_date": 1563288017, "question_id": 57059785, "link": "https://stackoverflow.com/questions/57059785/how-to-print-an-equilateral-triangle-in-c-using-1-loop", "title": "How to print an equilateral Triangle in C using 1 loop?", "body": "<p>I want to print the sequence *********** in equilateral form</p>\n\n<p>for given input n(here 5) using a single loop in C.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n</code></pre>\n\n<p>I tried it using the normal method where I use one outer loop and one inner loop to print the corresponding elements. Now, my aim is to reduce the time complexity by making the use of 1 loop.</p>\n\n<pre><code>for(int i=n;i&gt;0;i--)\n{\n    for(int j=0;j&lt;n-i;j++)\n    printf(\" \");\n\n    for(int j=0;j&lt;i;j++)\n    {\n        printf(\"* \");\n    }\n    printf(\"\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "printf", "undefined", "c-strings"], "comments": [{"owner": {"reputation": 407, "user_id": 2235468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3811eb9dbd96a4078c61f641545de1a1?s=128&d=identicon&r=PG", "display_name": "Roel Balink", "link": "https://stackoverflow.com/users/2235468/roel-balink"}, "edited": false, "score": 4, "creation_date": 1563287418, "post_id": 57059636, "comment_id": 100644853, "body": "Why not just compile this code and see for yourself what happens?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1563287460, "post_id": 57059636, "comment_id": 100644888, "body": "This will be undefined behavior as <code>printf</code> expects extra parameter passed for <code>%s</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 407, "user_id": 2235468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3811eb9dbd96a4078c61f641545de1a1?s=128&d=identicon&r=PG", "display_name": "Roel Balink", "link": "https://stackoverflow.com/users/2235468/roel-balink"}, "edited": false, "score": 6, "creation_date": 1563287481, "post_id": 57059636, "comment_id": 100644901, "body": "@RoelBalink Because this will prove nothing."}, {"owner": {"reputation": 156300, "user_id": 1782465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b45d92faaf9d122bfed585490e0bafc5?s=128&d=identicon&r=PG", "display_name": "Angew is no longer proud of SO", "link": "https://stackoverflow.com/users/1782465/angew-is-no-longer-proud-of-so"}, "reply_to_user": {"reputation": 407, "user_id": 2235468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3811eb9dbd96a4078c61f641545de1a1?s=128&d=identicon&r=PG", "display_name": "Roel Balink", "link": "https://stackoverflow.com/users/2235468/roel-balink"}, "edited": false, "score": 7, "creation_date": 1563287489, "post_id": 57059636, "comment_id": 100644909, "body": "@RoelBalink Because that will just give you one particular instance of Undefined Behaviour, which could be very different when compiled in an even slightly different context."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 2, "creation_date": 1563287560, "post_id": 57059636, "comment_id": 100644962, "body": "Did you mean <code>printf(&quot;%s\\n&quot;, ptr);</code>?"}, {"owner": {"reputation": 65594, "user_id": 459640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/bc790307b3c4cdbd25f582d9067651f1?s=128&d=identicon&r=PG", "display_name": "aschepler", "link": "https://stackoverflow.com/users/459640/aschepler"}, "edited": false, "score": 0, "creation_date": 1563288010, "post_id": 57059636, "comment_id": 100645209, "body": "To avoid this mistake and just output the string raw, you could <code>fwrite(ptr, 1, strlen(ptr), stdout)</code> or <code>printf(&quot;%s&quot;, ptr)</code>."}, {"owner": {"reputation": 111, "user_id": 11708011, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKiF9RHwTlo/AAAAAAAAAAI/AAAAAAAAD0I/h-iR2lOZN88/photo.jpg?sz=128", "display_name": "chetan vamshi", "link": "https://stackoverflow.com/users/11708011/chetan-vamshi"}, "reply_to_user": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1563290036, "post_id": 57059636, "comment_id": 100646451, "body": "@MadPhysicist no,what  i meant is :  printf(&quot;hi%s&quot;);  will this %s give some garbage value ? because when i execute it it&#39;s giving an output as: &quot;hi hi%s&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 11708011, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKiF9RHwTlo/AAAAAAAAAAI/AAAAAAAAD0I/h-iR2lOZN88/photo.jpg?sz=128", "display_name": "chetan vamshi", "link": "https://stackoverflow.com/users/11708011/chetan-vamshi"}, "edited": false, "score": 0, "creation_date": 1563289400, "post_id": 57059696, "comment_id": 100646084, "body": "thanks you are correct but, in the exact program of yours if *ptr = &quot;hi%s&quot; then ?... can u explain again ."}, {"owner": {"reputation": 111, "user_id": 11708011, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKiF9RHwTlo/AAAAAAAAAAI/AAAAAAAAD0I/h-iR2lOZN88/photo.jpg?sz=128", "display_name": "chetan vamshi", "link": "https://stackoverflow.com/users/11708011/chetan-vamshi"}, "edited": false, "score": 0, "creation_date": 1563289511, "post_id": 57059696, "comment_id": 100646150, "body": "if i execute it as *ptr = &quot;hi%s&quot; then the output is as &quot;hi hi%s&quot;  can u explain why its like that?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 111, "user_id": 11708011, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKiF9RHwTlo/AAAAAAAAAAI/AAAAAAAAD0I/h-iR2lOZN88/photo.jpg?sz=128", "display_name": "chetan vamshi", "link": "https://stackoverflow.com/users/11708011/chetan-vamshi"}, "edited": false, "score": 0, "creation_date": 1563289733, "post_id": 57059696, "comment_id": 100646299, "body": "@chetanvamshi I have not understood what you are asking. The format specifier %s that is present in the string literal requires a corresponding argument that is absent. So the function call has undefined behavior."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 4, "last_activity_date": 1563288087, "last_edit_date": 1563288087, "creation_date": 1563287516, "answer_id": 57059696, "question_id": 57059636, "link": "https://stackoverflow.com/questions/57059636/what-will-be-the-output-if-we-print-a-string-that-contains-s-in-it/57059696#57059696", "title": "What will be the output, if we print a string that contains &quot;%s&quot; in it?", "body": "<p>There will be undefined behavior.:)</p>\n\n<p>This part of the string literal <code>%s</code> is considered by the function as a format specifier.</p>\n\n<p>From the C Standard (7.21.6.1 The fprintf function)</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>... If there are insufficient arguments for the format, the behavior is \n  undefined.</li>\n  </ol>\n</blockquote>\n\n<p>If you want to output the string <code>\"hi%s\"</code> as is you should define the literal like <code>\"hi%%s\"</code>.</p>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    char *ptr = \"hi%%s\";\n\n    printf( ptr );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is</p>\n\n<pre><code>hi%s\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1563289168, "post_id": 57059697, "comment_id": 100645931, "body": "<code>puts()</code> appends a newline."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563292492, "post_id": 57059697, "comment_id": 100647872, "body": "@AndrewHenle in this case, I don&#39;t think it really matters."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563302780, "post_id": 57059697, "comment_id": 100652454, "body": "@AndrewHenle Is <code>fputs()</code> the best compromise?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1563302890, "post_id": 57059697, "comment_id": 100652495, "body": "@machine_1 I would think so.  <code>puts( s )</code> is not equivalent to <code>printf( &quot;%s&quot;, s )</code>, but <code>fputs( s, stdout )</code> is."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 6, "last_activity_date": 1563287516, "creation_date": 1563287516, "answer_id": 57059697, "question_id": 57059636, "link": "https://stackoverflow.com/questions/57059636/what-will-be-the-output-if-we-print-a-string-that-contains-s-in-it/57059697#57059697", "title": "What will be the output, if we print a string that contains &quot;%s&quot; in it?", "body": "<p>Your program invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behaviour</a>.</p>\n\n<p>Your code is equivalent to</p>\n\n<pre><code> printf(\"hi%s\");\n</code></pre>\n\n<p>where <code>%s</code> is a conversion specifier and it expects an argument to be supplied.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a77.21.6.1</p>\n\n<blockquote>\n  <p>[...] If there are insufficient arguments for the format, the behavior is\n  undefined. [....]</p>\n</blockquote>\n\n<p><strong>Suggestion:</strong> If you just have to print a string, without a need of any conversion (formatting), you can use <a href=\"https://linux.die.net/man/3/puts\" rel=\"noreferrer\"><code>puts()</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 5, "last_activity_date": 1563287560, "creation_date": 1563287560, "answer_id": 57059711, "question_id": 57059636, "link": "https://stackoverflow.com/questions/57059636/what-will-be-the-output-if-we-print-a-string-that-contains-s-in-it/57059711#57059711", "title": "What will be the output, if we print a string that contains &quot;%s&quot; in it?", "body": "<p>You're not \"printing a string which has <code>%s</code> in its content\". You're passing such a string as the <strong>format string</strong> to <code>printf</code>, and by doing so without a matching argument for the format field, your program has <strong>undefined behavior</strong>. The first argument to <code>printf</code> is not a string you want to print. It's a format string that controls how the remaining arguments are interpreted/converted, and which can also contain literal text to merge them into.</p>\n\n<p>\"Printing a string which has <code>%s</code> in its content\" (where <code>ptr</code> points to that string, as in your question) can be accomplished by <code>printf(\"%s\", ptr)</code> or <code>puts(ptr)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1084, "user_id": 11551238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xSJfc.png?s=128&g=1", "display_name": "Cabbage Champion", "link": "https://stackoverflow.com/users/11551238/cabbage-champion"}, "reply_to_user": {"reputation": 111, "user_id": 11708011, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKiF9RHwTlo/AAAAAAAAAAI/AAAAAAAAD0I/h-iR2lOZN88/photo.jpg?sz=128", "display_name": "chetan vamshi", "link": "https://stackoverflow.com/users/11708011/chetan-vamshi"}, "edited": false, "score": 0, "creation_date": 1563290626, "post_id": 57060351, "comment_id": 100646795, "body": "No problem, glad to help! @chetanvamshi"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1563408642, "post_id": 57060351, "comment_id": 100693910, "body": "Your second paragraph is a conjecture and the behaviour might be quite different for the same code in other cases. There are plenty of other possible outcomes, including formatting the hard drive; it is dangerous to suggest to the reader that the behaviour might be limited to what you have described"}, {"owner": {"reputation": 1084, "user_id": 11551238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xSJfc.png?s=128&g=1", "display_name": "Cabbage Champion", "link": "https://stackoverflow.com/users/11551238/cabbage-champion"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1563415974, "post_id": 57060351, "comment_id": 100695187, "body": "@M.M Its says &quot;Possible&quot; for a reason."}], "tags": [], "owner": {"reputation": 1084, "user_id": 11551238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xSJfc.png?s=128&g=1", "display_name": "Cabbage Champion", "link": "https://stackoverflow.com/users/11551238/cabbage-champion"}, "is_accepted": true, "score": 11, "last_activity_date": 1563292932, "last_edit_date": 1563292932, "creation_date": 1563289596, "answer_id": 57060351, "question_id": 57059636, "link": "https://stackoverflow.com/questions/57059636/what-will-be-the-output-if-we-print-a-string-that-contains-s-in-it/57060351#57060351", "title": "What will be the output, if we print a string that contains &quot;%s&quot; in it?", "body": "<p>As specified in other answered, a undefined behavior will occur. </p>\n\n<p><strong>What the undefined behavior means in this context:</strong>\n When <code>printf</code> receives a string with <em>n</em> number of format specifiers (such as %s) it is going to expect <em>n</em> number of parameters to be passed to the function in addition to the string. So, when you have a statement like this <code>printf(\"hi%s\")</code>, the function will behave as if you passed a parameter (in this case the second parameter should be a char *) even though there is not. The function is just going to get the next value on the stack which is some junk value in this case. Then the function will deference this junk value and will treat it as a buffer of characters. The reasons why this behavour is undefined is there is no telling what the junk value on the stack could be. </p>\n\n<p><strong>Possible Outcomes</strong></p>\n\n<ol>\n<li><p>The junk value on the stack is 0 -> Segmentation fault when junk value is dereferenced.</p></li>\n<li><p>The junk value on the stack happens to be a valid memory address ->  The bytes at the memory location will keep getting inserted into the string (appended to \"hi\" in this case) until either a byte of value 0 is encountered or a segmentation fault occurs.  </p></li>\n<li>The junk value on the stack is not 0 but is not a valid memory location -> Segmentation fault when junk value is dereferenced.</li>\n</ol>\n\n<p><strong>Producing the same situation</strong> \nThe below portion of code is a very similar situation to <code>printf(\"hi%s\")</code></p>\n\n<pre><code>void foo() {\n   char * myJunkValue;  // Since not a global/static variable, this is not guaranteed to be 0\n   printf(myJunkValue); // Undefined behavior\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1563291624, "creation_date": 1563291624, "answer_id": 57060965, "question_id": 57059636, "link": "https://stackoverflow.com/questions/57059636/what-will-be-the-output-if-we-print-a-string-that-contains-s-in-it/57060965#57060965", "title": "What will be the output, if we print a string that contains &quot;%s&quot; in it?", "body": "<p>As other answered have mentioned, what you're doing invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> because you're calling <code>printf</code> without enough arguments for the given format specifier.  In your case you got junk output, but your program could have just as easily crashed.</p>\n\n<p>To expand on this, code that looks like this:</p>\n\n<pre><code>printf(ptr);\n</code></pre>\n\n<p>Is almost always wrong.  If the string that <code>ptr</code> points to can be controlled by the user in any way, you open yourself up to a <a href=\"https://www.owasp.org/index.php/Format_string_attack\" rel=\"nofollow noreferrer\">format string vulnerability</a>.  The user could supply a specially crafted string using <code>%s</code>, <code>%x</code>, etc. that could dump the contents of memory and expose sensitive data, or a string using <code>%n</code> that could write to memory and allow an attacker to take over your program.</p>\n\n<p>Many static analyzers will throw a warning if the first argument to <code>printf</code> is not a string constant for this reason.</p>\n"}], "owner": {"reputation": 111, "user_id": 11708011, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zKiF9RHwTlo/AAAAAAAAAAI/AAAAAAAAD0I/h-iR2lOZN88/photo.jpg?sz=128", "display_name": "chetan vamshi", "link": "https://stackoverflow.com/users/11708011/chetan-vamshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 1, "accepted_answer_id": 57060351, "answer_count": 5, "score": 7, "last_activity_date": 1563408317, "creation_date": 1563287343, "last_edit_date": 1563408317, "question_id": 57059636, "link": "https://stackoverflow.com/questions/57059636/what-will-be-the-output-if-we-print-a-string-that-contains-s-in-it", "title": "What will be the output, if we print a string that contains &quot;%s&quot; in it?", "body": "<p>I'd like to know what the result would be if we print a string that contains \"%s\" in its content?</p>\n\n<p>I tried printing it as \"hi%s\".</p>\n\n<pre><code>char *ptr=\"hi%s\";\nprintf(ptr);\n</code></pre>\n\n<p>I expected the output to be as \"hi\".\nbut i got it as \"hi hi%s\".</p>\n\n<blockquote>\n  <p>\"hi hi%s\"</p>\n</blockquote>\n"}, {"tags": ["c++", "c", "linux", "shared-libraries", "static-libraries"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563286235, "post_id": 57059186, "comment_id": 100644024, "body": "Basically your proposed &quot;name mangling&quot; is the same as that proposed in the comments of your other question:  rename the symbols in one of the libraries.  You already rejected that."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1563286664, "post_id": 57059186, "comment_id": 100644315, "body": "XY problem? Why are you trying to mangle things?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563287517, "post_id": 57059186, "comment_id": 100644933, "body": "C doesn\u2019t support name mangling.  You can probably do it in C++."}, {"owner": {"reputation": 29, "user_id": 11275856, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991939970933779/picture?type=large", "display_name": "Abhishek Garg", "link": "https://stackoverflow.com/users/11275856/abhishek-garg"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563299852, "post_id": 57059186, "comment_id": 100651226, "body": "@AndrewHenle I didnt reject that idea. Actually the only way i know is by using --default-symver , and --default-symver is not exactly name mangling. And i dont want to rename all function in my code. I need something which can do symbol rename or name mangling , without much code changes."}, {"owner": {"reputation": 29, "user_id": 11275856, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991939970933779/picture?type=large", "display_name": "Abhishek Garg", "link": "https://stackoverflow.com/users/11275856/abhishek-garg"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1563299910, "post_id": 57059186, "comment_id": 100651245, "body": "@SergeyA i need name mangling as the solution to the problem <a href=\"https://stackoverflow.com/questions/56947406/two-library-of-different-versions-in-an-application\" title=\"two library of different versions in an application\">stackoverflow.com/questions/56947406/&hellip;</a>"}, {"owner": {"reputation": 29, "user_id": 11275856, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991939970933779/picture?type=large", "display_name": "Abhishek Garg", "link": "https://stackoverflow.com/users/11275856/abhishek-garg"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563299971, "post_id": 57059186, "comment_id": 100651267, "body": "@JonathanLeffler can u kindly state how can we do in cpp"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563302231, "post_id": 57059186, "comment_id": 100652241, "body": "@AbhishekGarg <i>I didnt reject that idea.</i> You most certainly did reject renaming symbols:  &quot; If I add my_ in front of all symbols , I have to make changes in A.1.so and B.so , and that changes will be really huge.This change is no better than dlopen().I need something which can make this thing work with minimal changes.&quot; The only difference between this question and that suggestion that you rejected is the replacement of &quot;rename symbols&quot; with &quot;name mangling&quot;. You&#39;re casting about for a way to stuff two versions of the same library - with many overlapping symbols - into one process."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563302783, "post_id": 57059186, "comment_id": 100652457, "body": "<i>i need name mangling as the solution to the problem <a href=\"https://stackoverflow.com/questions/56947406/two-library-of-different-versions-in-an-application\" title=\"two library of different versions in an application\">stackoverflow.com/questions/56947406/&hellip;</a></i>  That makes this a duplicate of that question."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563314762, "post_id": 57059186, "comment_id": 100657044, "body": "If you (can) compile the code as C++ and there are no <code>extern &quot;C&quot;</code> portions, then C++ will automatically mangle the names for you.  If the library names overlap, then as long as you have the source to at least one of the libraries, you can deal with the issue by wrapping the library code in <code>namespace libname_3_14_1593 {</code> \u2026 <code>}</code> to make the names be in a new, name-versioned namespace.  That&#39;s all I meant by my comment."}, {"owner": {"reputation": 29, "user_id": 11275856, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991939970933779/picture?type=large", "display_name": "Abhishek Garg", "link": "https://stackoverflow.com/users/11275856/abhishek-garg"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1563334010, "post_id": 57059186, "comment_id": 100660482, "body": "@AndrewHenle okay i realize my mistake. I thought he meant to say to rename all functions.I didnt had any idea of name mangling at that time. How can I prepend my_ to all external symbols"}, {"owner": {"reputation": 29, "user_id": 11275856, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991939970933779/picture?type=large", "display_name": "Abhishek Garg", "link": "https://stackoverflow.com/users/11275856/abhishek-garg"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563334088, "post_id": 57059186, "comment_id": 100660496, "body": "@JonathanLeffler okay namespace is a good idea  but i was looking more easy with less code change,and the code is actually written in c , so i cannot use that"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563342917, "post_id": 57059186, "comment_id": 100662612, "body": "If the code is in C, you&#39;re stuck \u2014 C doesn&#39;t support name mangling (sensibly).  You can write a header that mangles somehow every externally visible symbol in each library and use that, but it isn&#39;t a good solution.  I&#39;m not clear why you want to try to do this."}, {"owner": {"reputation": 29, "user_id": 11275856, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991939970933779/picture?type=large", "display_name": "Abhishek Garg", "link": "https://stackoverflow.com/users/11275856/abhishek-garg"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563370574, "post_id": 57059186, "comment_id": 100677561, "body": "@JonathanLeffler i am trying all this as a part to the solution <a href=\"https://stackoverflow.com/questions/56947406/two-library-of-different-versions-in-an-application\" title=\"two library of different versions in an application\">stackoverflow.com/questions/56947406/&hellip;</a> . Anyway &quot; You can write a header that mangles somehow every externally visible symbol in each library and use that&quot; ---- How to do this.Are u thinking using namespace"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563570447, "post_id": 57059186, "comment_id": 100757580, "body": "I&#39;m not thinking of &#39;using namespace&#39; any more; you&#39;re working in C.  But you could arrange for a header that contains multiple lines like <code>#define symbol1 libA_2_6_symbol1</code> to map the name <code>symbol1</code> from library A (version 2.6) to the new name <code>libA_2_6_symbol1</code> \u2014 rinse and repeat for every symbol in library A version 2.6.  The code for the library would need to include that header (early enough in each compilation unit to be useful), and the code that uses the material from library A version 2.6 would need to be compiled with that header too. <i>[\u2026continued (1)\u2026]</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563570660, "post_id": 57059186, "comment_id": 100757636, "body": "<i>[\u2026continuation (1)\u2026]</i> You could run the <code>nm</code> program to get the externally defined symbol names and use a <code>sed</code> script to rewrite them.  A more sophisticated mapping would use function-like macros instead of object-like macros; that is a good idea, but tracking the function call argument lists could be painful (though I suppose <code>#define symbol1(...) libA_2_6_symbol1(__VA_ARGS__)</code> would do the job with minimal checking, but since the code already works, minimal checking should be adequate.  You&#39;d need to capture functions separately from variables. <i>[\u2026continued (2)\u2026]</i>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1563570808, "post_id": 57059186, "comment_id": 100757680, "body": "<i>[\u2026continuation (2)\u2026]</i>  If you need to be able to have code calling both this version and another version of the same library, then you need to keep the two sets of calls to the library in separate files (so that each can be compiled with the correct library), and then use glue code to call both versioned libraries.  It&#39;s a mess \u2014 it isn&#39;t what you should be doing.  It may be what you have to do, though.  And no, the C compiler isn&#39;t going to help much, IMO.  You can look at the GNU C library versioning mechanisms to see if they help you, but I expect that they won&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 3688, "user_id": 1111557, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f2b40cacf02c8fa3f91429ef441912ac?s=128&d=identicon&r=PG", "display_name": "inetknght", "link": "https://stackoverflow.com/users/1111557/inetknght"}, "is_accepted": false, "score": 1, "last_activity_date": 1563404466, "creation_date": 1563404466, "answer_id": 57085015, "question_id": 57059186, "link": "https://stackoverflow.com/questions/57059186/explicit-name-mangling-also-called-name-decoration-for-all-symbols-in-a-librar/57085015#57085015", "title": "Explicit name mangling (also called name decoration) for all symbols in a library", "body": "<p>Your question is:</p>\n\n<blockquote>\n  <p>Is there any way to explicitly do name mangling (also called name decoration) in a library written in c(or cpp).I want all the symbols of my shared library to have their names mangled.</p>\n</blockquote>\n\n<p>However, I suspect that you're using the term <em>name mangling</em> inappropriately. Name mangling has <em>nothing</em> to do with <em>library release version</em>. If you mean to version each object exported in your library, then there are plenty of questions to answer that. Personally, I would use a versioned namespace -- but only because I haven't (yet) been bitten by it. Here's a quick example:</p>\n\n<pre><code>namespace mylibrary {\nnamespace v1 {\nclass foo {};\n}\nusing foo = v1::foo;\n}\n\nmylibrary::foo f; // mylibrary::v1::foo\n</code></pre>\n\n<p>...then on a later release...</p>\n\n<pre><code>namespace mylibrary {\nnamespace v1 {\nclass foo {};\n}\nnamespace v2 {\nclass foo;\n}\nusing foo = v2::foo;\n}\nmylibrary::foo newer_f; // mylibrary::v2::foo\nmylibrary::v1::foo older_f;\n</code></pre>\n\n<p>There are of course many permutations you could have. And there are a <em>lot</em> of caveats, especially if you have templated code or make use of ADL. If you release version 1 of the library with one definition of <code>class foo</code> but then version 2 has a <em>different definition</em>, then the two libraries <em>will not</em> be compatible! That's rather the whole point though.</p>\n\n<p>If however I am incorrect and you truly do want to enforce C++ name mangling in your C++ library (which is odd, because it should be done by default), then the answer is twofold. First, take a look at some related questions:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/a/610949/1111557\">Why would you use 'extern \"C++\"'?</a></li>\n<li><a href=\"https://stackoverflow.com/a/38761684/1111557\">\"Undefined reference to\" error while linking object files</a></li>\n<li><a href=\"https://stackoverflow.com/questions/18877437/undefined-reference-to-errors-when-linking-static-c-library-with-c-code\">\"Undefined reference to\" error when linking static C library with C++ code</a></li>\n</ul>\n\n<p>The reading is <em>related</em> but not causal. The related questions are answering your question <em>in reverse</em>.</p>\n\n<p>Many operating systems are written in C and that is typically why you'd see <code>extern \"C\"</code> when including system headers. It's also why you sometimes see the linker complaining about missing functions when you try to use things declared in a header whose library was compiled with C instead of C++.</p>\n\n<p>So to go in the other direction (in <em>your</em> direction): in your header file, you can declare your exports to be <code>extern \"C++\"</code>. That tells the compiler to <em>specifically</em> use mangled names when importing or exporting the object. </p>\n\n<p>Using <code>extern \"C++\"</code> won't <em>by itself</em> be your magic trick. There are some GCC options which control some of the more specific functionality about name mangling. So, secondly, take a look at those. The (external link) to the GCC manual page is here: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html</a></p>\n\n<p>Any option which mentions ABI, such as <code>-fabi</code>, might impact you. \"<code>-fabi</code>\" flags relate to \"Application Binary Interface\". You might want to learn more about these terms too. <a href=\"https://stackoverflow.com/q/2171177/1111557\">What is an application binary interface</a> has some excellent answers describing what an ABI is and how you can start to reason about them. \"<code>-Wabi</code>\" will tell GCC to emit warnings when it detects potential ABI conflicts. But, like all things C++, it's not foolproof. I would not be surprised if there are name mangling issues which might not be detected by it. That's particularly true if you ever mix heterogenous compiler vendors or versions.</p>\n\n<p>Importantly: <strong>mixing ABIs is likely going to be a <em>big</em> headache</strong>. I'd be very concerned about ABI incompatibilities being forced together and causing <em>very</em> difficult-to-debug undefined behaviors!</p>\n"}], "owner": {"reputation": 29, "user_id": 11275856, "user_type": "registered", "profile_image": "https://graph.facebook.com/1991939970933779/picture?type=large", "display_name": "Abhishek Garg", "link": "https://stackoverflow.com/users/11275856/abhishek-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1563404466, "creation_date": 1563285999, "question_id": 57059186, "link": "https://stackoverflow.com/questions/57059186/explicit-name-mangling-also-called-name-decoration-for-all-symbols-in-a-librar", "title": "Explicit name mangling (also called name decoration) for all symbols in a library", "body": "<p>Is there any way to explicitly do name mangling (also called name decoration) in a library written in c(or cpp).I want all the symbols of my shared library to have their names mangled.</p>\n\n<p>Consider this question:\n<a href=\"https://stackoverflow.com/questions/56947406/two-library-of-different-versions-in-an-application\">Two library of different versions in an application</a>\nIn this if I can explicitly have all their names mangled , I think i can resolve that issue.May be there is some option in gcc compiler itself to do this.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1563285524, "post_id": 57058848, "comment_id": 100643543, "body": "<code>libm_alias_float</code> creates an alias from one function to another. Your understanding is wrong, both <code>__kernel_standard_f</code> and <code>__ieee754_sqrtf</code> are provided by glibc. One just handles negative numbers (as is required by SVID)."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1563287145, "post_id": 57058848, "comment_id": 100644645, "body": "@Johnas <code>sysdeps&#47;ieee754&#47;k_standard{,f,l}.c</code>."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1563300280, "post_id": 57058848, "comment_id": 100651392, "body": "It&#39;s not <b>that</b> kernel; not the operating system system kernel."}], "answers": [{"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 6, "last_activity_date": 1563300510, "last_edit_date": 1563300510, "creation_date": 1563287026, "answer_id": 57059528, "question_id": 57058848, "link": "https://stackoverflow.com/questions/57058848/glibc-uses-kernel-functions/57059528#57059528", "title": "glibc uses kernel functions", "body": "<p>The GNU C Library's mathematical functions are fully implemented within the <a href=\"https://sourceware.org/git/?p=glibc.git\" rel=\"nofollow noreferrer\">\"glibc\" source tree</a>.  They don't rely on the operating system kernel for anything.  The word \"kernel\" in this context refers to a <em>computational</em> kernel \u2014 the core of some mathematical algorithm, the part you might want to write in hand-optimized assembly language.</p>\n\n<p>The function <code>__kernel_standard_f</code> is badly named.  It contains common code for handling errors in the math functions; it would be better to have named it something like <code>__math_domain_error</code>.  In this case, <code>__sqrtf</code> calls <code>__kernel_standard_f</code> when its argument is negative; <code>__kernel_standard_f</code> will then take care of setting <code>errno</code> to <code>EDOM</code>, possibly calling the SVID <a href=\"http://man7.org/linux/man-pages/man3/matherr.3.html\" rel=\"nofollow noreferrer\"><code>matherr</code></a> callback, and returning a NaN.  (The mysterious code 126 tells <code>__kernel_standard_f</code> which function called it and why.  The implementation of <code>__kernel_standard_f</code> is in <code>sysdeps/ieee754/k_standardf.c</code> and <code>sysdeps/ieee754/k_standard.c</code>.)</p>\n\n<p>The condition <code>_LIB_VERSION != _IEEE_</code> has to do with whether or not POSIX and/or SVID math error handling is enabled; modern mathematical algorithms would really rather just look for NaN in the result and not have the library waste time setting <code>errno</code> or calling <code>matherr</code>, so there's a mechanism to turn the latter two off.</p>\n\n<p>If the argument to <code>__sqrtf</code> is <em>not</em> negative, it tail calls <code>__ieee754_sqrtf</code>, which performs the actual calculation of the square root. There are several alternative implementations of this function within the glibc source tree; its generic, C-only version is in <code>sysdeps/ieee754/flt-32/e_sqrtf.c</code>.  (The names of the files that implement math functions are cryptic even by glibc's standards.  I don't bother trying to understand them, I just do <code>find sysdeps -name '*sqrtf*'</code> or whatever.)  This function <em>also</em> starts with logic to detect a negative argument (also zero, infinity, and NaN) and return the appropriate values, but it doesn't touch <code>errno</code>.  If you want to understand the mathematical technique used to calculate square roots, this is the file to look at.</p>\n\n<p>If you run the above <code>find</code> command yourself you will discover several other files named <code>e_sqrtf.c</code>; these are all in directories named after specific CPUs, whose floating-point units have hardware support for computing square roots, so for instance <code>sysdeps/x86_64/fpu/e_sqrt.c</code> reads</p>\n\n<pre><code>double\n__ieee754_sqrt (double x)\n{\n  double res;\n\n  asm (\"sqrtsd %1, %0\" : \"=x\" (res) : \"xm\" (x));\n\n  return res;\n}\n</code></pre>\n\n<p>because the x86 <code>sqrtsd</code> instruction does the whole job.</p>\n\n<p>Glibc's build process will select one of these files, instead of the generic C version, when building for one of these CPUs.  This mechanism is complex and not completely documented, but <a href=\"https://gnu.org/software/libc/manual/html_node/Maintenance.html\" rel=\"nofollow noreferrer\">the \"Maintenance\" appendix to the glibc manual</a>, particularly its \"Source Layout\" and \"Porting\" sections, gives a decent overview of it.</p>\n\n<hr>\n\n<p><code>libm_alias_float (__sqrt, sqrt)</code> arranges for <code>__sqrtf</code> to also have the name <code>sqrtf</code>, but as a <em><a href=\"https://stackoverflow.com/questions/15525537/what-are-practical-applications-of-weak-linking\">weak alias</a></em>.  This is necessary for standards compliance.  Please ask a separate question if you want more detail.</p>\n"}], "owner": {"reputation": 73, "user_id": 11790926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b4544725b6c0c0c5817e3c880c5bf44?s=128&d=identicon&r=PG&f=1", "display_name": "Johnas", "link": "https://stackoverflow.com/users/11790926/johnas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 57059528, "answer_count": 1, "score": 2, "last_activity_date": 1563300510, "creation_date": 1563284992, "last_edit_date": 1563285719, "question_id": 57058848, "link": "https://stackoverflow.com/questions/57058848/glibc-uses-kernel-functions", "title": "glibc uses kernel functions", "body": "<p>I am trying to understand this method from the glibc source code:</p>\n\n<pre><code>    26 #if LIBM_SVID_COMPAT\n    27 /* wrapper sqrtf */\n    28 float\n    29 __sqrtf (float x)\n    30 {\n    31   if (__builtin_expect (isless (x, 0.0f), 0) &amp;&amp; _LIB_VERSION     != _IEEE_)\n    32     return __kernel_standard_f (x, x, 126); /*    sqrt(negative) */\n    33 \n    34   return __ieee754_sqrtf (x);\n    35 }\n    36 libm_alias_float (__sqrt, sqrt)\n    37 #endif\n</code></pre>\n\n<p>As far as I understand from here, if the program doesn\u2019t find a valid implementation for the <code>sqrt</code> function from glibc, it calls a hardware function, so a specific machine function, from the kernel. Is this right?<br>\nAlso, what does <code>libm_alias_float (__sqrt, sqrt)</code> mean?</p>\n"}, {"tags": ["c", "opengl-es", "textures", "raspberry-pi3", "freetype2"], "comments": [{"owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1563285813, "post_id": 57058805, "comment_id": 100643720, "body": "Are you sure that the format of the buffer (<code>face-&gt;glyph-&gt;bitmap.buffer</code>) is <code>GL_RGBA</code> rather than <code>GL_RED</code>?"}, {"owner": {"reputation": 33, "user_id": 10793084, "user_type": "registered", "profile_image": "https://graph.facebook.com/2231770910369105/picture?type=large", "display_name": "Yannik Nelson", "link": "https://stackoverflow.com/users/10793084/yannik-nelson"}, "reply_to_user": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "edited": false, "score": 0, "creation_date": 1563286674, "post_id": 57058805, "comment_id": 100644325, "body": "I started with it as GL_RED, but nothing would display, so I changed it to GL_RGBA and got the result you can see."}], "answers": [{"comments": [{"owner": {"reputation": 6020, "user_id": 4052193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6062c93ce987aa90ac59d06e758f03b6?s=128&d=identicon&r=PG&f=1", "display_name": "Columbo", "link": "https://stackoverflow.com/users/4052193/columbo"}, "edited": false, "score": 1, "creation_date": 1563314642, "post_id": 57063025, "comment_id": 100657013, "body": "I reckon OP will also have to use <code>glPixelStorei(GL_UNPACK_ALIGNMENT, 1);</code> before calling <code>glTexImage2D</code> to handle the case where <code>face-&gt;glyph-&gt;bitmap.width</code> doesn&#39;t divide by 4. (Or use <code>FT_Bitmap_Convert</code>)"}, {"owner": {"reputation": 33, "user_id": 10793084, "user_type": "registered", "profile_image": "https://graph.facebook.com/2231770910369105/picture?type=large", "display_name": "Yannik Nelson", "link": "https://stackoverflow.com/users/10793084/yannik-nelson"}, "edited": false, "score": 1, "creation_date": 1563541950, "post_id": 57063025, "comment_id": 100745212, "body": "This was kinda right, the only thing i needed to change was GL_RGBA to GL_ALPHA,"}], "tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": true, "score": 1, "last_activity_date": 1563314889, "last_edit_date": 1563314889, "creation_date": 1563299962, "answer_id": 57063025, "question_id": 57058805, "link": "https://stackoverflow.com/questions/57058805/how-to-fix-freetype-incorrectly-loading-characters/57063025#57063025", "title": "How to fix freetype incorrectly loading characters", "body": "<p>The buffer which is returned by <a href=\"https://www.freetype.org/freetype2/docs/reference/ft2-base_interface.html#ft_load_char\" rel=\"nofollow noreferrer\"><code>FT_Load_Char</code></a> contains one byte for each pixel of the glyph.<br>\nIf you would use modern OpenGL the you could use the format <code>GL_RED</code> for the bitmap format and the internal texture image format. the rest would do the <a href=\"https://www.khronos.org/opengl/wiki/Shader\" rel=\"nofollow noreferrer\">Shader program</a>.<br>\nSince you use <a href=\"https://www.khronos.org/opengl/wiki/Legacy_OpenGL\" rel=\"nofollow noreferrer\">Legacy OpenGL</a> you've to use a format that converts the byte value to an RGB value. Use <code>GL_LUMINANCE</code> for that. <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glTexImage2D.xml\" rel=\"nofollow noreferrer\"><code>GL_LUMINANCE</code></a> converts <em>\"into an RGBA element by replicating the luminance value three times for red, green, and blue and attaching 1 for alpha\"</em>.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>glTexImage2D(\n    GL_TEXTURE_2D,\n    0,\n    GL_LUMINANCE,\n    face-&gt;glyph-&gt;bitmap.width,\n    face-&gt;glyph-&gt;bitmap.rows,\n    0,\n    GL_LUMINANCE,\n    GL_UNSIGNED_BYTE,\n    face-&gt;glyph-&gt;bitmap.buffer\n);\n</code></pre>\n\n<p>Note that two-dimensional texturing has to be enabled, see <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glEnable.xml\" rel=\"nofollow noreferrer\"><code>glEnable</code></a>:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>glEnable(GL_TEXTURE_2D)\n</code></pre>\n\n<hr>\n\n<p>If you want to draw the text with an transparent background, then you can use <a href=\"https://www.khronos.org/registry/OpenGL-Refpages/es2.0/xhtml/glTexImage2D.xml\" rel=\"nofollow noreferrer\"><code>GL_ALPHA</code></a>: </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>glTexImage2D(\n    GL_TEXTURE_2D,\n    0,\n    GL_ALPHA,\n    face-&gt;glyph-&gt;bitmap.width,\n    face-&gt;glyph-&gt;bitmap.rows,\n    0,\n    GL_ALPHA,\n    GL_UNSIGNED_BYTE,\n    face-&gt;glyph-&gt;bitmap.buffer\n);\n</code></pre>\n\n<p>When you draw the text, then you've to enable <a href=\"https://www.khronos.org/opengl/wiki/Blending\" rel=\"nofollow noreferrer\"><code>Blending</code></a>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void drawText(char* inString, float x, float y, float scale, colour col) {\n\n    glEnable(GL_BLEND);\n    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);\n\n    glEnable(GL_TEXTURE_2D);\n\n    // [...]\n\n    glDisable(GL_TEXTURE_2D);\n    glDisable(GL_BLEND);\n}\n</code></pre>\n\n<hr>\n\n<p>Further <code>glPixelStorei(GL_UNPACK_ALIGNMENT, 1);</code> should be called before <code>getChars();</code>. </p>\n"}], "owner": {"reputation": 33, "user_id": 10793084, "user_type": "registered", "profile_image": "https://graph.facebook.com/2231770910369105/picture?type=large", "display_name": "Yannik Nelson", "link": "https://stackoverflow.com/users/10793084/yannik-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 57063025, "answer_count": 1, "score": 2, "last_activity_date": 1569272368, "creation_date": 1563284872, "last_edit_date": 1569272368, "question_id": 57058805, "link": "https://stackoverflow.com/questions/57058805/how-to-fix-freetype-incorrectly-loading-characters", "title": "How to fix freetype incorrectly loading characters", "body": "<p>The FreeType library opens and loads a font without throwing errors, but when I try and use the character textures they're repeated and upsidedown.</p>\n\n<p>I'm creating a graphics-based program using OpenGL, to deal with fonts and text I'm using FreeType. When I load the texture and set it up, the correct sizes and glyph attributes (width, advance etc...) are provided, but when I use the bitmap to create a texture and use that texture it's incorrect (as described earlier).</p>\n\n<p>here is the initialisation code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>FT_Init_FreeType(&amp;ft);\nFT_New_Face(ft, \"Roboto.ttf\", 0, &amp;face);\nFT_Set_Pixel_Sizes(face, 0, 100);\ngetChars();\nglPixelStorei(GL_UNPACK_ALIGNMENT, 1);\nFT_Done_Face(face);\nFT_Done_FreeType(ft);\n</code></pre>\n\n<p>here is the code that then gets the character textures:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void getChars(){\n  int index = 0;\n  for (GLubyte c = 0; c &lt; 128; c++){\n    if (FT_Load_Char(face, c, FT_LOAD_RENDER)){\n      printf(\"couldn't load character\\n\");\n      continue;\n    }\n    GLuint texture;\n    glGenTextures(1,&amp;texture);\n    glBindTexture(GL_TEXTURE_2D, texture);\n    glTexImage2D(GL_TEXTURE_2D,0,GL_RGBA,face-&gt;glyph-&gt;bitmap.width,face-&gt;glyph-&gt;bitmap.rows,0,GL_RGBA,GL_UNSIGNED_BYTE,face-&gt;glyph-&gt;bitmap.buffer);\n    //glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);\n    //glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);\n    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\n    //glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\n    Character character = {texture, {face-&gt;glyph-&gt;bitmap.width, face-&gt;glyph-&gt;bitmap.rows}, {face-&gt;glyph-&gt;bitmap_left, face-&gt;glyph-&gt;bitmap_top}, face-&gt;glyph-&gt;advance.x};\n    chars[index++] = character;\n  }\n  printf(\"Got characters\\n\");\n}\n</code></pre>\n\n<p>I've commented out the glTexParameteri s that didn't make any difference to the way the texture was displayed</p>\n\n<p>Here are the structures used to store the textures:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>typedef struct vec2 {\n  float x;\n  float y;\n} vec2;\n\ntypedef struct Character {\n  GLuint Texture;\n  vec2 Size;\n  vec2 Bearing;\n  GLuint Advance;\n} Character;\n\nCharacter chars[128];\n</code></pre>\n\n<p>Finally here is the code that displays a string passed to it:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void drawText(char* inString, float x, float y, float scale, colour col) {\n  for (char* string = inString; *string != '\\0'; string++){\n    Character ch = chars[(int) *string];\n    glBindTexture( GL_TEXTURE_2D, ch.Texture);\n\n    printf(\"character\\n\");\n\n    float xpos = x + ch.Bearing.x * scale * 2 /glutGet(GLUT_WINDOW_WIDTH);\n    float ypos = y - (ch.Size.y - ch.Bearing.y) * scale * 2 /glutGet(GLUT_WINDOW_HEIGHT);\n\n    float w = ch.Size.x * scale * 2 /glutGet(GLUT_WINDOW_WIDTH);\n    float h = ch.Size.y * scale * 2 /glutGet(GLUT_WINDOW_HEIGHT);\n\n    //draws the textured QUAD\n    glBegin(GL_QUADS);\n    //set the colour of the quad the texutre blends with to white with the appropriate opacity\n    glColor4f(col.R, col.G, col.B, col.A);\n    glTexCoord2f(0.0,0.0);\n    glVertex2f(xpos, ypos);\n    glTexCoord2f(0.0,1.0);\n    glVertex2f(xpos, ypos+h);\n    glTexCoord2f(1.0,1.0);\n    glVertex2f(xpos+w, ypos+h);\n    glTexCoord2f(1.0,0.0);\n    glVertex2f(xpos+w, ypos);\n    glEnd();\n\n    x += (ch.Advance &gt;&gt; 6) * scale * 2 /glutGet(GLUT_WINDOW_WIDTH);\n    printf(\"w %1.0f\\n\",w);\n    printf(\"h %1.0f\\n\",h);\n    printf(\"x %1.0f\\n\",xpos);\n    printf(\"y %1.0f\\n\",ypos);\n  }\n}\n</code></pre>\n\n<p>I expect the normal text to be loaded, but as described earlier, each character looks like its own texture map</p>\n\n<p><a href=\"https://i.stack.imgur.com/WXhhD.png\" rel=\"nofollow noreferrer\">this is the way the text looks (ignore the image behind it)</a></p>\n"}, {"tags": ["c", "swift", "pointers", "unsafe-pointers"], "answers": [{"comments": [{"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1563296187, "post_id": 57060116, "comment_id": 100649635, "body": "Thanks, you&#39;re right in all points. I still don&#39;t get this part though: <code>Swift arrays are instances of value types, who&#39;s lifetime is bound by the stack</code>. My <code>buffer</code> variable is allocated as a pointer, how is it bound to the stack? Another question: Why don&#39;t you use <code>UnsafeMutableBufferPointer</code> instead of <code>UnsafeMutablePointer</code>? @Alvae"}, {"owner": {"reputation": 1225, "user_id": 2437015, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Y3Drx.jpg?s=128&g=1", "display_name": "Rohan Bhale", "link": "https://stackoverflow.com/users/2437015/rohan-bhale"}, "reply_to_user": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 1, "creation_date": 1563346354, "post_id": 57060116, "comment_id": 100663977, "body": "@T.Meyer the buffer is a Swift Array. Swift array are value types(&#39;They are treated similar to Structs or Enums&#39;) backed by Heap storage. Value types get their memory allocated on stack, but if backed by heap storage a part is allocated on heap and I feel this memory gets deallocated when the setter exits. Again I could be wrong here in my assumption. I too feel confused here."}, {"owner": {"reputation": 975, "user_id": 6908155, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L0m4opnbGTM/AAAAAAAAAAI/AAAAAAAAACg/1bvbHxBc_Io/photo.jpg?sz=128", "display_name": "Alvae", "link": "https://stackoverflow.com/users/6908155/alvae"}, "reply_to_user": {"reputation": 1225, "user_id": 2437015, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Y3Drx.jpg?s=128&g=1", "display_name": "Rohan Bhale", "link": "https://stackoverflow.com/users/2437015/rohan-bhale"}, "edited": false, "score": 0, "creation_date": 1563352442, "post_id": 57060116, "comment_id": 100667200, "body": "That is perfectly correct @RohanBhale. As for @T.Meyer&#39;s second question, an <code>UnsafeMutableBufferPointer</code> wraps a pointer with an int storing its capacity, which I don&#39;t need in my example. I personally think it easier to stick to the <code>Unsafe[Mutable]Pointer</code> APIs when dealing with C."}], "tags": [], "owner": {"reputation": 975, "user_id": 6908155, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L0m4opnbGTM/AAAAAAAAAAI/AAAAAAAAACg/1bvbHxBc_Io/photo.jpg?sz=128", "display_name": "Alvae", "link": "https://stackoverflow.com/users/6908155/alvae"}, "is_accepted": true, "score": 3, "last_activity_date": 1563288873, "creation_date": 1563288873, "answer_id": 57060116, "question_id": 57058778, "link": "https://stackoverflow.com/questions/57058778/how-to-copy-a-pointer-to-an-array-in-swift/57060116#57060116", "title": "How to copy a pointer to an array in Swift?", "body": "<p>There are a couple of problems with your solution.</p>\n\n<p>First, it is ill-advised to use <code>String.count</code> to count to get the size of the underlying C buffer. The reason is that <code>String.count</code> returns the number of <em>actual characters</em> of your string, and not the number of bytes used to represent it. Not all characters fit the 256 bits of <code>Int8</code> (a.k.a. <code>CChar</code>). Hence, your code will probably crash if you attempt setting your property with non-ascii characters. It is better to use the <code>String.utf8CString</code> property, which returns a contiguous array of <code>CChar</code>.</p>\n\n<p>Second, since your buffer is allocated within the setter, it will be deallocated when your setter returns (Swift arrays are instances of value types, who's lifetime is bound by the stack). That means the pointer corresponding to <code>buffer</code>'s base is actually invalidated when your setter returns. I suspect this is the reason why the error you reported occurs at runtime.</p>\n\n<p>Finally, please do not test for <code>true</code> in guards and if statements.</p>\n\n<p>Here is a corrected version:</p>\n\n<pre><code>var registrationUri: String {\n  get {\n    return String(cString: reg_uri)\n  }\n  set {\n    if (reg_uri != nil) {\n      reg_uri.deallocate()\n    }\n\n    newValue.withCString { cString in\n      // No need to add 1, newValue.utf8CString already has the correct buffer capacity.\n      let capacity = newValue.utf8CString.count\n      let buffer: UnsafeMutablePointer&lt;Int8&gt; = .allocate(capacity: capacity)\n      buffer.assign(from: cString, count: capacity)\n      reg_uri = UnsafePointer(buffer)\n    }\n  }\n}\n\n// ...\n\nmyInstance.registrationUri = \"\u3053\u3093\u3044\u3061\u306f\"\nprint(myInstance.registrationUri)\n// Prints \"\u3053\u3093\u3044\u3061\u306f\"\n</code></pre>\n"}], "owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 1, "accepted_answer_id": 57060116, "answer_count": 1, "score": 2, "last_activity_date": 1563288873, "creation_date": 1563284800, "last_edit_date": 1563285112, "question_id": 57058778, "link": "https://stackoverflow.com/questions/57058778/how-to-copy-a-pointer-to-an-array-in-swift", "title": "How to copy a pointer to an array in Swift?", "body": "<p>I'm basically trying to wrap a C structure within a Swift class. </p>\n\n<p>The Swift class has an instance property of type of the C structure.</p>\n\n<p>The C structure contains several properties which are of type <code>const char *</code>.</p>\n\n<p>In order to assign values to the structure, I wrote getters and setters for each property: </p>\n\n<pre class=\"lang-swift prettyprint-override\"><code>public class MyClass: NSObject {\n    private var configuration = c_structure_config()\n}\n</code></pre>\n\n<pre class=\"lang-swift prettyprint-override\"><code>// Function of MyClass\n// f.ex. on \"registrationUri:\"\nprivate(set) public var registrationUri: String {\n    get {\n        return String(cString: configuration.reg_uri)\n    }\n    set {\n        if (configuration.reg_uri != nil) {\n            configuration.reg_uri.deallocate()\n        }\n        let maxLength = newValue.count + 1 // +1 for NULL\n        var buffer: [CChar] = [CChar](UnsafeMutableBufferPointer&lt;Int8&gt;.allocate(capacity: maxLength))\n        guard newValue.getCString(&amp;buffer, maxLength: maxLength, encoding: .utf8) == true else {\n            fatalError(\"Could not allocate memory for Account Config reg uri\")\n        }\n        // \"configuration\" is the instance property (see above)\n        // reg_uri is of type char const *\n        configuration.reg_uri = UnsafePointer&lt;Int8&gt;(buffer)\n    }\n}\n</code></pre>\n\n<p>However, this approach leads to weird crashes and error reports complaining about pointers overlapping range (<code>Fatal error: UnsafeMutablePointer.initialize overlapping range</code>).</p>\n\n<p>I know that I'm deallocating and allocating memory whenever the string is set and that that's probably not very efficient. I haven't found a better solution so far though.</p>\n\n<p>What's wrong here (or is this right, I made a wrong assumption and I gotta search somewhere else)?</p>\n"}, {"tags": ["c", "stm32", "read-write", "flash-memory"], "comments": [{"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 1, "creation_date": 1563286555, "post_id": 57058410, "comment_id": 100644257, "body": "In my opinion there is an ambiguity in the terms: usually a write operation to the Flash consists of : 1) erase a sector (if needed) 2) program a word (or 2 words), program meaning clear one or several bits in the memory."}], "answers": [{"comments": [{"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 1, "creation_date": 1563286362, "post_id": 57058694, "comment_id": 100644109, "body": "You cannot say there is not much difference between writing to RAM and FLASH. The Flash sector needs to be erased, according to the product you have to take care to program in a different sector (or bank) than the one you are executing from, on STM32L4 you can program only 64 bits at a time, you have to set one or several bits in the Flash controller registers before doing the write access on the data bus... However you&#39;re right that at the end the write is provoked by the same C (or assembly) instruction."}], "tags": [], "owner": {"reputation": 940, "user_id": 5840652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ELL15.png?s=128&g=1", "display_name": "Vinci", "link": "https://stackoverflow.com/users/5840652/vinci"}, "is_accepted": true, "score": 7, "last_activity_date": 1563284628, "creation_date": 1563284628, "answer_id": 57058694, "question_id": 57058410, "link": "https://stackoverflow.com/questions/57058410/understanding-the-writing-to-flash-process-in-the-stm32-reference-manual/57058694#57058694", "title": "Understanding the writing to flash process in the STM32 reference manual", "body": "<p>Apart from a couple of things (e.g. only write after erase, timings, alignment, lock/unlock) their ain't much difference between writing to RAM and writing to FLASH memory. So if you have followed the steps from the reference manual and the FLASH memory is ready (i.e. cleared and unlocked) then you can simply take an aligned memory address and write to it.</p>\n\n<p>STMs very own HAL library contains a function which does all the cumbersome boilerplate for you and allows you to \"just write\":</p>\n\n<pre><code>HAL_StatusTypeDef HAL_FLASH_Program(uint32_t TypeProgram, uint32_t Address, uint64_t Data)\n</code></pre>\n\n<p>Internally this function uses a subroutine which performs the actual write and it looks like this:</p>\n\n<pre><code>static void FLASH_Program_DoubleWord(uint32_t Address, uint64_t Data)\n{\n  /* Check the parameters */\n  assert_param(IS_FLASH_PROGRAM_ADDRESS(Address));\n\n  /* Set PG bit */\n  SET_BIT(FLASH-&gt;CR, FLASH_CR_PG);\n\n  /* Program first word */\n  *(__IO uint32_t*)Address = (uint32_t)Data;\n\n  /* Barrier to ensure programming is performed in 2 steps, in right order\n    (independently of compiler optimization behavior) */\n  __ISB();\n\n  /* Program second word */\n  *(__IO uint32_t*)(Address+4U) = (uint32_t)(Data &gt;&gt; 32);\n}\n</code></pre>\n\n<p>As you can see there is no magic involved. It's just a dereferenced pointer and an assignment.</p>\n"}, {"comments": [{"owner": {"reputation": 64505, "user_id": 413337, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/783783f968e84cf5047544e9a0f3ccf4?s=128&d=identicon&r=PG", "display_name": "Codo", "link": "https://stackoverflow.com/users/413337/codo"}, "edited": false, "score": 0, "creation_date": 1563284871, "post_id": 57058699, "comment_id": 100643120, "body": "I think your first example is not working because <i>It is only possible to program double word (2 x 32 data)</i>. So you would need to write to the next four bytes as well: <code>*(volatile uint32_t*)0x00080004 = 0;</code>"}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 3, "last_activity_date": 1563284636, "creation_date": 1563284636, "answer_id": 57058699, "question_id": 57058410, "link": "https://stackoverflow.com/questions/57058410/understanding-the-writing-to-flash-process-in-the-stm32-reference-manual/57058699#57058699", "title": "Understanding the writing to flash process in the STM32 reference manual", "body": "<blockquote>\n  <p>What data write operation is it mentioning?</p>\n</blockquote>\n\n<p>The \"data write\" is just a normal write to a address in memory that is the flash memory. It is usually the <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0552a/BABFGBDD.html\" rel=\"nofollow noreferrer\">STR</a> assembly instruction. Screening at your datasheet, I guess the flash memory addresses are between 0x08080000 and 0x00080000.</p>\n\n<p>Ex. the following C code would write the value 42 to the first flash memory address:</p>\n\n<pre><code> *(volatile uint32_t*)0x00080000 = 42.\n</code></pre>\n\n<p>For a reference implementation you can see <a href=\"https://github.com/DengQilong/stm32l4libs/blob/master/STM32L4xx_HAL_Driver/Src/stm32l4xx_hal_flash.c#L782\" rel=\"nofollow noreferrer\">stm32 hal drivers</a>:</p>\n\n<pre><code>  /* Set PG bit */\n  SET_BIT(FLASH-&gt;CR, FLASH_CR_PG);\n\n  /* Program the double word */\n  *(__IO uint32_t*)Address = (uint32_t)Data;\n  *(__IO uint32_t*)(Address+4) = (uint32_t)(Data &gt;&gt; 32);\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 11681090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd712770f6d2bc37de2c27ec4ef8ec?s=128&d=identicon&r=PG&f=1", "display_name": "arry_h", "link": "https://stackoverflow.com/users/11681090/arry-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2026, "favorite_count": 0, "accepted_answer_id": 57058694, "answer_count": 2, "score": 3, "last_activity_date": 1563284636, "creation_date": 1563283723, "last_edit_date": 1563284540, "question_id": 57058410, "link": "https://stackoverflow.com/questions/57058410/understanding-the-writing-to-flash-process-in-the-stm32-reference-manual", "title": "Understanding the writing to flash process in the STM32 reference manual", "body": "<p>I am programming the stm32l412kb where at one point I will be writing data to flash (from UART). From the stm32l41xx <a href=\"https://www.st.com/content/ccc/resource/technical/document/reference_manual/group0/b0/ac/3e/8f/6d/21/47/af/DM00151940/files/DM00151940.pdf/jcr:content/translations/en.DM00151940.pdf\" rel=\"nofollow noreferrer\">reference manual</a>, I understand the steps in how to clear the memory before writing to it but on page 84 there is one step that I do not know how to do when writing the actual data. That step is the </p>\n\n<blockquote>\n  <p>Perform the data write operation at the desired memory address</p>\n</blockquote>\n\n<p>What data write operation is it mentioning? I can't see any register the memory address goes to so I assume its going to use pointers? How would I go about doing this? </p>\n\n<p>Your help is much appreciated,\nMany thanks,</p>\n\n<p>Harry</p>\n"}, {"tags": ["c", "warnings", "volatile"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1563283844, "post_id": 57058403, "comment_id": 100642463, "body": "C doesn&#39;t have any kind of <a href=\"https://en.wikipedia.org/wiki/Reflection_(computer_programming)\" rel=\"nofollow noreferrer\">reflection</a>. Once a program is built, the types of variables are fixed."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1563283874, "post_id": 57058403, "comment_id": 100642484, "body": "I don&#39;t think you can, but you can use two temporary variables, assign the volatiles to them and then perform the check on those."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1563283973, "post_id": 57058403, "comment_id": 100642543, "body": "But it looks like you don&#39;t need volatile at all, as I see you call <code>update_vars</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563283984, "post_id": 57058403, "comment_id": 100642551, "body": "What <code>update_vars</code> do? I suspect that these should not even be volatile..."}, {"owner": {"reputation": 345, "user_id": 2631794, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1065639065/picture?type=large", "display_name": "William Dussault", "link": "https://stackoverflow.com/users/2631794/william-dussault"}, "edited": false, "score": 0, "creation_date": 1563284421, "post_id": 57058403, "comment_id": 100642810, "body": "update_vars is checking for the change in a variable value."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1563284643, "post_id": 57058403, "comment_id": 100642975, "body": "What does it mean? Please post the code."}, {"owner": {"reputation": 345, "user_id": 2631794, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1065639065/picture?type=large", "display_name": "William Dussault", "link": "https://stackoverflow.com/users/2631794/william-dussault"}, "edited": false, "score": 0, "creation_date": 1563285957, "post_id": 57058403, "comment_id": 100643820, "body": "It just checks a register and does some filtering. After that there is some IP i cannot post. Thanks for the help :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1563285995, "post_id": 57058403, "comment_id": 100643849, "body": "Does it assign a value to the passed pointer? If it does, then you are misusing <code>volatile</code>."}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 0, "creation_date": 1563293652, "post_id": 57058403, "comment_id": 100648459, "body": "The weird thing is that you are calling <code>update_vars</code> twice, only varying the argument. Does it somehow detect which of <code>a</code> and <code>b</code> you are passing? And are <code>a</code> and <code>b</code> registers themselves, and you update some other vars based on them? Or, is <code>update_vars</code> reading some other registers and assigning a value through the pointer argument (e.g., <code>*arg = filter(some_register);</code>)? In the latter case you probably don&#39;t need (and shouldn&#39;t use) <code>volatile</code> at all \u2013 volatility isn&#39;t &quot;inherited&quot; from the register being volatile. Does something else assign to <code>a</code> and/or <code>b</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 5, "last_activity_date": 1563283868, "creation_date": 1563283868, "answer_id": 57058448, "question_id": 57058403, "link": "https://stackoverflow.com/questions/57058403/is-it-possible-to-turn-off-or-turn-on-volatility-in-c-variables/57058448#57058448", "title": "Is it possible to &quot;Turn off&quot; or &quot;Turn on&quot; volatility in C variables?", "body": "<p>The <code>volatile</code> property of a variable cannot be disabled.</p>\n\n<p>You need to create a non-volatile copy of each and then operate on those.</p>\n\n<pre><code>unsigned char a_stable = a;\nunsigned char b_stable = b;\n\nif((addr_bit &amp; (a_stable | b_stable)) == 0){\n    ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94, "user_id": 9652523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/749c55a85d27c4ca2607e000be8b3a70?s=128&d=identicon&r=PG&f=1", "display_name": "Kobip", "link": "https://stackoverflow.com/users/9652523/kobip"}, "is_accepted": false, "score": -1, "last_activity_date": 1563284007, "creation_date": 1563284007, "answer_id": 57058497, "question_id": 57058403, "link": "https://stackoverflow.com/questions/57058403/is-it-possible-to-turn-off-or-turn-on-volatility-in-c-variables/57058497#57058497", "title": "Is it possible to &quot;Turn off&quot; or &quot;Turn on&quot; volatility in C variables?", "body": "<p>To avoid the warning you can <strong>break up the C statement, so that each C statement holds only one access to a volatile variable.</strong></p>\n"}], "owner": {"reputation": 345, "user_id": 2631794, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1065639065/picture?type=large", "display_name": "William Dussault", "link": "https://stackoverflow.com/users/2631794/william-dussault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 57058448, "answer_count": 2, "score": 2, "last_activity_date": 1563284007, "creation_date": 1563283690, "question_id": 57058403, "link": "https://stackoverflow.com/questions/57058403/is-it-possible-to-turn-off-or-turn-on-volatility-in-c-variables", "title": "Is it possible to &quot;Turn off&quot; or &quot;Turn on&quot; volatility in C variables?", "body": "<p>I have two static volatile variables in C and I would like to check them both in a logical statement. However, when I do I get a warning \" undefined behavior: the order of volatile accesses is undefined in this statement  1037\"\nIs it possible to suspend volatility of a C variable for a very brief moment to ensure good data? </p>\n\n<p>Here is the code:  </p>\n\n<pre><code>static volatile unsigned char b;\nstatic volatile unsigned char a;\n\n//update the states of the two volatile variables \nupdate_vars( &amp;a);\nupdate_vars( &amp;b);\n\n// check them in a logical statement\n// Can I suspend the volatile lable??  \nif((addr_bit &amp; (a | b)) == 0){\n// update another variables\n}\nelse{\n// another action\n}\n</code></pre>\n\n<p>I'm thinking about this in the same context of interrupts, whereas you temporary suspend them if you want stable evaluation of the data at a precise moment. Thanks!</p>\n"}]