[{"tags": ["c", "bitwise-operators"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552520517, "post_id": 55152772, "comment_id": 97045909, "body": "This is how two&#39;s complement notation works."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552520547, "post_id": 55152772, "comment_id": 97045912, "body": "Read <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Two%27s_complement</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552520612, "post_id": 55152772, "comment_id": 97045924, "body": "<code>11111111</code> is <code>-1</code>, <code>00000000</code> is <code>0</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 1, "creation_date": 1552527861, "post_id": 55152895, "comment_id": 97047717, "body": "Nice answer. Twos-complement may seem as a complex and odd way of dealing with a signed number, but actually it is a very clever encoding that simplifies how a CPU is designed. It allows a simple unsigned binary adder circuit to work regardless of the sign of the added quantities, and eliminates the ambiguity of having both a positive or negative zero value."}, {"owner": {"reputation": 35, "user_id": 8513959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CDQFt.jpg?s=128&g=1", "display_name": "Fabian S", "link": "https://stackoverflow.com/users/8513959/fabian-s"}, "edited": false, "score": 0, "creation_date": 1552545945, "post_id": 55152895, "comment_id": 97052317, "body": "could you clarify me a couple of things: 1) I do understand how to do 2&#39;s compliment, but why are we doing it? In what way is 2&#39;s compliment connected to a NOT operator? 2) I understand where these numbers come from:  c = -128 + 64 + 4 = -60, but the answer is c = -61. Where does that substraction (or addition of a -1) comes from?"}, {"owner": {"reputation": 177, "user_id": 4400826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71efb93f183e1e79d9745ad1362815aa?s=128&d=identicon&r=PG&f=1", "display_name": "mcfisty", "link": "https://stackoverflow.com/users/4400826/mcfisty"}, "edited": false, "score": 0, "creation_date": 1552635341, "post_id": 55152895, "comment_id": 97093241, "body": "So the reason that c is -61 and not -60 is because the NOT operator doesn&#39;t actually convert from positive to negative, it merely flips the bits. This is only half of the process to get from 60 to -60, the other half being adding 1 after flipping the bits.  So c = ~a + 1 is how you would &#39;manually&#39; do twos complement conversion, but c = -1*a will do it for you under the hood."}], "tags": [], "owner": {"reputation": 177, "user_id": 4400826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71efb93f183e1e79d9745ad1362815aa?s=128&d=identicon&r=PG&f=1", "display_name": "mcfisty", "link": "https://stackoverflow.com/users/4400826/mcfisty"}, "is_accepted": false, "score": 2, "last_activity_date": 1552521411, "creation_date": 1552521411, "answer_id": 55152895, "question_id": 55152772, "link": "https://stackoverflow.com/questions/55152772/difficulty-understanding-signed-not/55152895#55152895", "title": "difficulty understanding signed not", "body": "<p>Conversion from a positive to a negative number in twos complement (the standard signed format) constitutes a bitwise inversion, and adding one.</p>\n\n<p>Note that for simplicity I am using a single signed byte.</p>\n\n<pre><code>So if 60 = 0011 1100\nThen c   = 1100 0011 + 1\n         = 1100 0100\n</code></pre>\n\n<p>And for a signed byte, the most significant bit is negative,\nso  </p>\n\n<pre><code>c = -128 + 64 + 4 = -60\n</code></pre>\n\n<p>You need to add 1 to account for the fact that the most significant bit is -128, while the largest positive number is 0111 1111 = 127. All negative numbers have a 1 for -128 which needs to be offset.</p>\n\n<p>This is easy to see when you look at converting 0 to -0. Invert 00000000 and you get 11111111 and adding one gets you back to 00000000. Do the same with 1 to -1 and you get 11111111 - the largest possible negative number.</p>\n"}], "owner": {"reputation": 35, "user_id": 8513959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CDQFt.jpg?s=128&g=1", "display_name": "Fabian S", "link": "https://stackoverflow.com/users/8513959/fabian-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552521411, "creation_date": 1552520425, "question_id": 55152772, "link": "https://stackoverflow.com/questions/55152772/difficulty-understanding-signed-not", "title": "difficulty understanding signed not", "body": "<p>I'm having trouble understanding why c equals -61 on the following program:</p>\n\n<pre><code>   main() {\n       unsigned int a = 60;     // 60 = 0011 1100   \n       unsigned int b = 13;     // 13 = 0000 1101\n       int c = 0;           \n       c = ~a;          //-61 = 1100 0011\n       printf(\"Line 4 - Value of c is %d\\n\", c );\n   }\n</code></pre>\n\n<p>I do understand how the NOT operator works on 0011 1100 (the solution being 1100 0011). But I'm not sure why the decimal number is increased by 1. Is this some sort of type conversion from unsigned int (from a) into signed int (from c) ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1552518975, "post_id": 55152550, "comment_id": 97045498, "body": "I&#39;d expect <code>*top++;  stack[*top] = value;</code> --&gt; <code>stack[*top] = value; (*top)++; </code>.  It <i>looks</i> like code has 2 issues: pre/post (*p)++ vs *p++, maybe more. `"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552518989, "post_id": 55152550, "comment_id": 97045502, "body": "First step: check that <code>argc</code> tells you there are enough program arguments."}, {"owner": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 2, "creation_date": 1552519038, "post_id": 55152550, "comment_id": 97045519, "body": "<code>*top++</code> is the same as <code>*(top++)</code> because of operator precedence. Turn on compiler warnings."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552519108, "post_id": 55152550, "comment_id": 97045539, "body": "<code>int *valueTop = 0;</code> looks suspicious. You are passing this pointer to be dereferenced in <code>pushValStack()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 0, "last_activity_date": 1552519121, "creation_date": 1552519121, "answer_id": 55152594, "question_id": 55152550, "link": "https://stackoverflow.com/questions/55152550/segmentation-fault-in-simple-c-calculator/55152594#55152594", "title": "Segmentation Fault in Simple C Calculator", "body": "<p><code>operandTop</code> is a pointer variable of type <code>int*</code>. You initialize it to <code>0</code> (a null pointer) and never assign a different value to it. Any attempt to dereference it will cause undefined behavior, likely a segmentation fault.</p>\n\n<p>I ran your program under a debugger with no command-line arguments, and it died on line 61, <code>while (*operandTop != 0){</code></p>\n"}, {"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 0, "last_activity_date": 1552519714, "creation_date": 1552519714, "answer_id": 55152678, "question_id": 55152550, "link": "https://stackoverflow.com/questions/55152550/segmentation-fault-in-simple-c-calculator/55152678#55152678", "title": "Segmentation Fault in Simple C Calculator", "body": "<p>You're declaring a number of <code>int*</code> variables, but never allocating any memory for them. They should be <code>int</code> instead, since they contain indexes into the stack.</p>\n\n<pre><code>int valueTop = 0;\nint operandTop = 0;\n</code></pre>\n\n<p>Then you should use these variables, you don't need to dereference them. But when you pass them to functions that need to update the variables, you have to pass the address of the variable.</p>\n\n<pre><code>int main(int argc, char *argv[]){\n    char *token;\n    int tokenNumber = 1;\n    int value[51];\n    int valueTop = 0;\n    int valueOne,valueTwo;\n    char *operand[51];\n    int operandTop = 0;\n    char *operandOne;\n\n    token = argv[tokenNumber];\n    while (token != NULL){\n        if (*token == '+' || *token == 'x' || *token == '['){\n            pushOpStack(operand, &amp;operandTop, token);\n        }\n        else if (*token == ']'){\n            while (*operand[operandTop] != '['){\n                operandOne = popOpStack(operand, &amp;operandTop);\n                if (*operandOne == '+'){\n                    valueOne = popValStack(value, &amp;valueTop);\n                    valueTwo = popValStack(value, &amp;valueTop);\n                    pushValStack(value, &amp;valueTop, valueOne + valueTwo);\n                }\n                if (*operandOne == 'x'){\n                    valueOne = popValStack(value, &amp;valueTop);\n                    valueTwo = popValStack(value, &amp;valueTop);\n                    pushValStack(value, &amp;valueTop, valueOne * valueTwo);\n                }\n            }\n        }\n        else {\n            pushValStack(value, &amp;valueTop, atoi(token));\n        }\n        tokenNumber++;\n        token = argv[tokenNumber];\n    }\n    while (operandTop != 0){\n        operandOne = popOpStack(operand, &amp;operandTop);\n        if (*operandOne == '+'){\n            valueOne = popValStack(value, &amp;valueTop);\n            valueTwo = popValStack(value, &amp;valueTop);\n            pushValStack(value, &amp;valueTop, valueOne + valueTwo);\n        }\n        if (*operandOne == 'x'){\n            valueOne = popValStack(value, &amp;valueTop);\n            valueTwo = popValStack(value, &amp;valueTop);\n            pushValStack(value, &amp;valueTop, valueOne * valueTwo);\n        }\n    }\n    printf(\"\\n%d\",popValStack(value, &amp;valueTop));\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11035390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54209fc6994083bbb53f577239f12123?s=128&d=identicon&r=PG&f=1", "display_name": "asdfffffffff", "link": "https://stackoverflow.com/users/11035390/asdfffffffff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 55152678, "answer_count": 2, "score": -4, "last_activity_date": 1552519714, "creation_date": 1552518780, "question_id": 55152550, "link": "https://stackoverflow.com/questions/55152550/segmentation-fault-in-simple-c-calculator", "title": "Segmentation Fault in Simple C Calculator", "body": "<p>I have run into a segmentation fault in a simple c calculator that I am trying to create.  The calculator is supposed to take in a formula with +, x, and square brackets and output the answer. The implementation is based on two arrays that work as stacks, an operand stack and a value stack. I am struggling to fix the segmentation fault.  I have attached the code below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid pushValStack(int stack[], int *top, int value){\n   *top++;\n   stack[*top] = value;\n}\n\nint popValStack(int stack[], int *top){\n   *top--;\n   return stack[*top];\n}\n\nvoid pushOpStack(char *stack[], int *top, char *value){\n   *top++;\n   stack[*top] = value;\n}\n\nchar *popOpStack(char *stack[], int *top){\n   *top--;\n   return stack[*top];\n}\n\nint main(int argc, char *argv[]){\n   char *token;\n   int tokenNumber = 1;\n   int value[51];\n   int *valueTop = 0;\n   int valueOne,valueTwo;\n   char *operand[51];\n   int *operandTop = 0;\n   char *operandOne;\n\n   token = argv[tokenNumber];\n   while (token != NULL){\n      if (*token == '+' || *token == 'x' || *token == '['){\n         pushOpStack(operand, operandTop, token);\n      }\n      else if (*token == ']'){\n         while (*operand[*operandTop] != '['){\n            operandOne = popOpStack(operand, operandTop);\n            if (*operandOne == '+'){\n               valueOne = popValStack(value, valueTop);\n               valueTwo = popValStack(value, valueTop);\n               pushValStack(value, valueTop, valueOne + valueTwo);\n            }\n            if (*operandOne == 'x'){\n               valueOne = popValStack(value, valueTop);\n               valueTwo = popValStack(value, valueTop);\n               pushValStack(value, valueTop, valueOne * valueTwo);\n            }\n         }\n      }\n      else {\n         pushValStack(value, valueTop, atoi(token));\n      }\n      tokenNumber++;\n      token = argv[tokenNumber];\n   }\n   while (*operandTop != 0){\n      operandOne = popOpStack(operand, operandTop);\n      if (*operandOne == '+'){\n         valueOne = popValStack(value, valueTop);\n         valueTwo = popValStack(value, valueTop);\n         pushValStack(value, valueTop, valueOne + valueTwo);\n      }\n      if (*operandOne == 'x'){\n         valueOne = popValStack(value, valueTop);\n         valueTwo = popValStack(value, valueTop);\n         pushValStack(value, valueTop, valueOne * valueTwo);\n      }\n   }\n   printf(\"\\n%d\",popValStack(value, valueTop));\n}\n</code></pre>\n"}, {"tags": ["c", "syntax", "macros"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1552516390, "post_id": 55152124, "comment_id": 97044757, "body": "The double-underscore names are implementation-specific built-in functions."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552516426, "post_id": 55152124, "comment_id": 97044773, "body": "I think the <code>bool</code> stuff is for compatibility with different historical proposals."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12211554"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552516517, "post_id": 55152124, "comment_id": 97044803, "body": "@Barmar I have seen that name before on the site, and I agree that bracketless if statements are iffy, but what do you mean by implementaton-specific built in functions?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12211554"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552516622, "post_id": 55152124, "comment_id": 97044832, "body": "@Barmar Ok. I will edit in more examples"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1552516861, "post_id": 55152124, "comment_id": 97044895, "body": "Names beginning with two underscores are reserved to the implementation. This is usually used for invoking operations that the compiler recognizes specially. <code>__TERMSIG()</code> might be assembly code, for instance."}, {"owner": {"reputation": 5192, "user_id": 2318649, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rW1HG.jpg?s=128&g=1", "display_name": "barny", "link": "https://stackoverflow.com/users/2318649/barny"}, "edited": false, "score": 1, "creation_date": 1552517023, "post_id": 55152124, "comment_id": 97044942, "body": "Don\u2019t forget that C dates back to the early 70s. Do your research."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1552523691, "post_id": 55152293, "comment_id": 97046697, "body": "I expect that the Gtk team have made a decision &quot;we are part of the implementation&quot; and deliberately use names reserved for &quot;the implementation&quot;, limiting the possibility of damage by using <code>_Gtk</code> as a prefix (so a compiler would have to consciously decide to use the same prefix for some name if it was to actually cause the Gtk team any problems)."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1552577222, "post_id": 55152293, "comment_id": 97071910, "body": "<b>it&#39;s not really very clear which reserved names belong to compilers and which to libc implementations</b> As far as the C standard is concerned, I don&#39;t think there&#39;s much distinction. Anything that isn&#39;t part of the user&#39;s code or third-party libraries is &quot;the implementation&quot;."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552577878, "post_id": 55152293, "comment_id": 97072378, "body": "@Barmar Unfortunately. Practically, there should be a distinction, though, as libcs and compilers are usually provided by different vendors. The lack of this distinction isn&#39;t just a theoretical annoyance either. I believe there&#39;s been at least one case where two common libc and compiler implementations (glibc and clang?) clashed and one had to rename one of its reserved identifiers because of it."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552578307, "post_id": 55152293, "comment_id": 97072681, "body": "As far as the programmer using them is concerned, there&#39;s no distinction. To do what you want, the standard would need multiple levels of namespacing, for the compiler, standard library, and end programmer. And they might also want another level for &quot;popular&quot; libraries like the POSIX API and Gtk. Where does this end?"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 2, "last_activity_date": 1552517633, "last_edit_date": 1552517633, "creation_date": 1552517294, "answer_id": 55152293, "question_id": 55152124, "link": "https://stackoverflow.com/questions/55152124/why-do-the-c-libraries-and-language-define-name-and-then-typedef-or-pound-defin/55152293#55152293", "title": "Why do the c libraries and language define _name and then typedef or pound define _name name?", "body": "<p>It's all about namespace management.</p>\n\n<p>Names prefixed with two underscores or an underscore and an upper case letter are implementation-reserved. An implementation may expose them virtually indiscriminately (well, it's not really very clear which reserved names belong to compilers and which to libc implementations).</p>\n\n<p>Names like <code>WIFCONTINUED</code>, on the other hand, belong to the user (and <code>&lt;sys/wait.h&gt;</code> under POSIX), and <code>stdlib.h</code> shouldn't contain them under POSIX.</p>\n\n<p>GLIBC exposes them from <code>stdlib.h</code> only conditionally:</p>\n\n<pre><code>#if (defined __USE_XOPEN || defined __USE_XOPEN2K8) &amp;&amp; !defined _SYS_WAIT_H\n/* XPG requires a few symbols from &lt;sys/wait.h&gt; being defined.  */\n# include &lt;bits/waitflags.h&gt;\n# include &lt;bits/waitstatus.h&gt;\n\n/* Define the macros &lt;sys/wait.h&gt; also would define this way.  */\n# define WEXITSTATUS(status)    __WEXITSTATUS (status)\n# define WTERMSIG(status)   __WTERMSIG (status)\n# define WSTOPSIG(status)   __WSTOPSIG (status)\n# define WIFEXITED(status)  __WIFEXITED (status)\n# define WIFSIGNALED(status)    __WIFSIGNALED (status)\n# define WIFSTOPPED(status) __WIFSTOPPED (status)\n# ifdef __WIFCONTINUED\n#  define WIFCONTINUED(status)  __WIFCONTINUED (status)\n# endif\n#endif  /* X/Open or XPG7 and &lt;sys/wait.h&gt; not included.  */\n</code></pre>\n\n<p>and it's not including them by <code>#including</code> <code>&lt;sys/wait.h&gt;</code> probably because <code>&lt;sys/wait.h&gt;</code> likely has other stuff that shouldn't be included even if the condition for this <code>#if</code> (triggered by the right <a href=\"http://man7.org/linux/man-pages/man7/feature_test_macros.7.html\" rel=\"nofollow noreferrer\">feature test macros</a> ) block is satisfied.</p>\n\n<p>When they use the prefixed forms (defined in the internal <code>&lt;bits/waitstatus.h&gt;</code>), <code>&lt;sys/wait.h&gt;</code> can then reuse the same ones (identically redefined macros don't generate warnings) and everything works even when they're both <code>#include</code>d; and no header exposes more non-reserved names than required by the standards in force (the standards in use depend on the <a href=\"http://man7.org/linux/man-pages/man7/feature_test_macros.7.html\" rel=\"nofollow noreferrer\">feature test macros</a> with which you compile).</p>\n\n<p>Gtk is just wrong. Gtk isn't a libc implementation, and so it has no business using those reserved names.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12211554"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 55152293, "answer_count": 1, "score": 4, "last_activity_date": 1615483013, "creation_date": 1552516188, "last_edit_date": 1615483013, "question_id": 55152124, "link": "https://stackoverflow.com/questions/55152124/why-do-the-c-libraries-and-language-define-name-and-then-typedef-or-pound-defin", "title": "Why do the c libraries and language define _name and then typedef or pound define _name name?", "body": "<p>It seems that the C libraries and language has a lot of useless type names. For example, C has a built in type <code>_Bool</code> and there is a macro in <code>stdbool.h</code>, <code>#define bool _Bool</code>. Why didn't C just have <code>bool</code> built in instead of <code>_Bool</code>? I found more examples in <code>stdio.h</code> and <code>stdlib.h</code>. Like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code># define WEXITSTATUS(status)    __WEXITSTATUS (status)\n# define WTERMSIG(status)   __WTERMSIG (status)\n# define WSTOPSIG(status)   __WSTOPSIG (status)\n# define WIFEXITED(status)  __WIFEXITED (status)\n# define WIFSIGNALED(status)    __WIFSIGNALED (status)\n# define WIFSTOPPED(status) __WIFSTOPPED (status)\n# ifdef __WIFCONTINUED\n#  define WIFCONTINUED(status)  __WIFCONTINUED (status)\n# endif\n</code></pre>\n\n<p>My question is why bother declaring a function <code>__FUNCTIONNAME (arg)</code> and then <code>#define FUNCTIONNAME(arg) __FUNCTIONNAME(arg)</code>? Why not just declare <code>FUNCTIONNAME(arg)</code> to start with?</p>\n\n<p>Another example in <code>stdio.h</code>:</p>\n\n<pre><code>extern FILE *__stdinp;\nextern FILE *__stdoutp;\nextern FILE *__stderrp;\n</code></pre>\n\n<p>And later:</p>\n\n<pre><code>#define stdin __stdinp\n#define stdout __stdoutp\n#define stderr __stderrp\n</code></pre>\n\n<p>Like seriously, why? What is wrong with just defining them then declaring them like this:</p>\n\n<pre><code>extern FILE *stdin;\nextern FILE *stdout;\nextern FILE *stderr;\n</code></pre>\n\n<p>Why didn't they just declare the functions without the underscores and then have no need for these macros?</p>\n"}, {"tags": ["c", "nan", "bubble-sort"], "comments": [{"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552513858, "post_id": 55151688, "comment_id": 97043868, "body": "Are you using C or C++?  Your code is straight C code."}, {"owner": {"reputation": 4537, "user_id": 1361901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ea140060e08a193f5814b0ebd2eb6ef?s=128&d=identicon&r=PG", "display_name": "Joseph Larson", "link": "https://stackoverflow.com/users/1361901/joseph-larson"}, "edited": false, "score": 0, "creation_date": 1552514282, "post_id": 55151688, "comment_id": 97044027, "body": "Make your if more complicated. if (array[d] != Nan &amp;&amp; array[d+1] == NaN || ...) -- something like that, so you leave leading NaN values where they are and shift later ones towards the front."}, {"owner": {"reputation": 17, "user_id": 8883566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fd68a802fffbd1dba63d47d25fd98c?s=128&d=identicon&r=PG&f=1", "display_name": "Radar", "link": "https://stackoverflow.com/users/8883566/radar"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1552517330, "post_id": 55151688, "comment_id": 97045038, "body": "@NathanOliver My bad was corrected by someone else yeah its definitely C code. Dont know why it worked using scanf and all in the cpp file but ill go ahead and change the title name."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8883566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fd68a802fffbd1dba63d47d25fd98c?s=128&d=identicon&r=PG&f=1", "display_name": "Radar", "link": "https://stackoverflow.com/users/8883566/radar"}, "edited": false, "score": 0, "creation_date": 1552517185, "post_id": 55152106, "comment_id": 97044998, "body": "Appreciate the help! My bad dont know why the code worked in C++ but yeah my code was definitely C forgot about the std::cout function. In regards to the given code have used it through visual studio, would there be a way to add more than one NaN. Currently when typing NaN in the console all remaining arrays become 0, without the option of typing another number."}, {"owner": {"reputation": 229, "user_id": 10918448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2226af4f3e09f4c922563448dbec69?s=128&d=identicon&r=PG&f=1", "display_name": "Unterfliege", "link": "https://stackoverflow.com/users/10918448/unterfliege"}, "reply_to_user": {"reputation": 17, "user_id": 8883566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fd68a802fffbd1dba63d47d25fd98c?s=128&d=identicon&r=PG&f=1", "display_name": "Radar", "link": "https://stackoverflow.com/users/8883566/radar"}, "edited": false, "score": 0, "creation_date": 1552598200, "post_id": 55152106, "comment_id": 97083526, "body": "My mistake, sorry. <code>std::cin</code> will fail if you input &quot;NaN&quot; because that&#39;s no float. As soon as the fail flag of <code>std::cin</code> is set, it will skip all other input operations until you clear the flag using <code>std::cin.clear()</code> (see the second code example). Using <code>std::cin</code> it is impossible to input NaN directly into a float, you&#39;d have to use a string and convert the string into a float. You would have to input the NaN manually using either C&#39;s <code>nanf(&quot;&quot;)</code> or C++&#39;s <code>std::numeric_limits&lt;float&gt;::quiet_NaN()</code>. But actually, why do you want to input a NaN?"}, {"owner": {"reputation": 17, "user_id": 8883566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fd68a802fffbd1dba63d47d25fd98c?s=128&d=identicon&r=PG&f=1", "display_name": "Radar", "link": "https://stackoverflow.com/users/8883566/radar"}, "edited": false, "score": 0, "creation_date": 1552644568, "post_id": 55152106, "comment_id": 97098156, "body": "Part of a project, requirement is to input a NaN @Unterfliege"}, {"owner": {"reputation": 1549, "user_id": 837055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4P0SS.png?s=128&g=1", "display_name": "cffk", "link": "https://stackoverflow.com/users/837055/cffk"}, "edited": false, "score": 0, "creation_date": 1612197604, "post_id": 55152106, "comment_id": 116685470, "body": "If <code>a</code> and <code>b</code> are both NaN, the comparison should return false (otherwise the conditions for weak ordering are violated).  So to be safe, the comparison should be <code>!std::isnan(b) &amp;&amp; (std::isnan(a) || a &lt; b)</code>."}], "tags": [], "owner": {"reputation": 229, "user_id": 10918448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc2226af4f3e09f4c922563448dbec69?s=128&d=identicon&r=PG&f=1", "display_name": "Unterfliege", "link": "https://stackoverflow.com/users/10918448/unterfliege"}, "is_accepted": true, "score": 0, "last_activity_date": 1552516088, "creation_date": 1552516088, "answer_id": 55152106, "question_id": 55151688, "link": "https://stackoverflow.com/questions/55151688/how-to-sort-an-array-that-includes-nans-c/55152106#55152106", "title": "How to sort an array that includes NaN&#39;s C", "body": "<p>As mentioned in the comments, your code is C code and not C++. Here is your code in C++ with an added condition which should fix your problem:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;cmath&gt;\n\nint main()\n{\n    std::size_t array_size;\n    std::cout &lt;&lt; \"Enter the size of array\\n\";\n    std::cin &gt;&gt; array_size;\n\n    std::cout &lt;&lt; \"Enter \" &lt;&lt; array_size &lt;&lt; \" integers\\n\";\n\n    std::vector&lt;float&gt; array(array_size);\n    for(std::size_t i = 0; i &lt; array.size(); ++i)\n        std::cin &gt;&gt; array[i];\n\n    for(std::size_t a = 0; a &lt; array.size() - 1; ++a)\n        for(std::size_t b = 0; b &lt; array.size() - 1 - a; ++b)\n            if(std::isnan(array[b + 1]) || array[b] &gt; array[b + 1])\n                std::swap(array[b], array[b + 1]);\n\n    std::cout &lt;&lt; \"Sorted array in ascending order:\\n\";\n\n    for(const auto&amp; a : array)\n        std::cout &lt;&lt;  a &lt;&lt; '\\n';\n\n    return 0;\n}\n</code></pre>\n\n<p>And if you don't want to write all the sort stuff by yourself, you can do it with even more C++ and the algorithm library (and an added input check):</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename T&gt;\nT get_input()\n{\n    T input;\n    while(true)\n    {\n        std::cin &gt;&gt; input;\n        if(std::cin)\n            return input;\n        std::cin.clear();\n        std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), '\\n');\n        std::cout &lt;&lt; \"Invalid input! Please try again.\\n\";\n    }\n}\n\nint main()\n{\n    std::cout &lt;&lt; \"Enter the size of array\\n\";\n    std::size_t array_size = get_input&lt;std::size_t&gt;();\n\n    std::cout &lt;&lt; \"Enter \" &lt;&lt; array_size &lt;&lt; \" integers\\n\";\n\n    std::vector&lt;float&gt; input(array_size);\n    for(auto&amp; a : input)\n        a = get_input&lt;float&gt;();\n\n    std::sort(input.begin(), input.end(), [](const auto&amp; a, const auto&amp; b){ return std::isnan(a) || a &lt; b; });\n\n    std::cout &lt;&lt; \"Sorted array in ascending order:\\n\";\n\n    for(const auto&amp; a : input)\n        std::cout &lt;&lt; a &lt;&lt; '\\n';\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1552695564, "last_edit_date": 1552695564, "creation_date": 1552522649, "answer_id": 55153058, "question_id": 55151688, "link": "https://stackoverflow.com/questions/55151688/how-to-sort-an-array-that-includes-nans-c/55153058#55153058", "title": "How to sort an array that includes NaN&#39;s C", "body": "<p>Note that according to the C standard, two NaN values never compare equal, even if they have the same bit pattern.  If you are going to sort data with NaNs, you need to:</p>\n\n<ol>\n<li>Decide where NaN values should be sorted w.r.t proper values (typically the choices are \"before negative infinity\" or \"after positive infinity\").</li>\n<li>Use much more delicate tests than a simple <code>a &gt; b</code> comparison.</li>\n</ol>\n\n<p>You can find relevant information scattered around the C11 standard.  For example:</p>\n\n<ul>\n<li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.12.14\" rel=\"nofollow noreferrer\">\u00a77.12.14 Comparison macros</a></li>\n<li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#5.2.4.2.2\" rel=\"nofollow noreferrer\">\u00a75.2.4.2.2 Characteristics of floating point types <code>&lt;float.h&gt;</code></a></li>\n<li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.6.1p4\" rel=\"nofollow noreferrer\">\u00a76.2.6.1 Representations of types: General \u00b64</a></li>\n<li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.1.2\" rel=\"nofollow noreferrer\">\u00a76.3.1.2 Boolean type</a></li>\n<li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.12.3\" rel=\"nofollow noreferrer\">\u00a77.12.3 Classification macros</a></li>\n<li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.12.3.4\" rel=\"nofollow noreferrer\">\u00a77.12.3.4 The <code>isnan</code> macro</a></li>\n<li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.12.3.6\" rel=\"nofollow noreferrer\">\u00a77.12.3.6 The <code>signbit</code> macro</a></li>\n<li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.12.12.2\" rel=\"nofollow noreferrer\">\u00a77.12.12.2 The <code>fmax</code> functions</a></li>\n<li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#F\" rel=\"nofollow noreferrer\">Annex F: IEC 60559 floating-point arithmetic (normative)</a></li>\n</ul>\n\n<p>You will probably arrange to create a function (possibly an <code>inline</code> function, unless you're going to pass it to a function like <code>qsort()</code>) that compares two floating point values of the relevant type (it looks like you're using <code>float</code>) that uses the <code>isnan()</code> or <code>isnanf()</code> classification macro to determine whether either or both of the values is a NaN.  The function will probably return a value indicating equality if both values are NaNs, but if one is a NaN, the return value will place it earlier or later than the other depending on the order in which you want NaNs to appear, and it will return the appropriate value for the comparison of other values (normal values, zeros, infinities, subnormal numbers) \u2014 regular values and infinities only require the regular comparison operators unless you need to sort negative zeros correctly w.r.t positive zeros.</p>\n\n<p>For example, writing a function that works with <code>qsort()</code> (and using type <code>double</code> rather than <code>float</code>) yields something like this, assuming that numbers should be sorted into ascending sequence and that NaNs should compare smaller than any other value.  The code includes test code to read data from standard input, print it, sort it, and print it again.</p>\n\n<pre><code>#include &lt;math.h&gt;\n\n/* Belongs in a header! */\nextern int cmp_double(const void *v1, const void *v2);\n\n/* Sort doubles, with NaNs coming first */\n/* Switch return values -1 and +1 after testing n1, n2 to sort NaNs last */\nint cmp_double(const void *v1, const void *v2)\n{\n    double d1 = *(const double *)v1;\n    double d2 = *(const double *)v2;\n    int n1 = isnan(d1);\n    int n2 = isnan(d2);\n\n    if (n1 &amp;&amp; n2)\n        return 0;\n    if (n1)\n        return -1;\n    if (n2)\n        return +1;\n    if (d1 &lt; d2)\n        return -1;\n    if (d1 &gt; d2)\n        return +1;\n    // The values are 'equal', but \u2026\n    if (d1 != 0.0)\n        return 0;\n    // They're both zero, but they could have different signs\n    int s1 = signbit(d1);\n    int s2 = signbit(d2);\n    if (s1 != s2)\n        return (s1) ? -1 : +1;\n    return 0;\n}\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic void dump_doubles(const char *tag, int num, double values[num])\n{\n    printf(\"%s (%d):\\n\", tag, num);\n    int line_len = 0;\n    for (int i = 0; i &lt; num; i++)\n    {\n        int n = printf(\" %+12.4f\", values[i]);\n        if (n &lt;= 0)\n            break;\n        line_len += n;\n        if (line_len &gt;= 60)\n        {\n            line_len = 0;\n            putchar('\\n');\n        }\n    }\n    if (line_len &gt; 0)\n        putchar('\\n');\n}\n\nint main(void)\n{\n    enum { NUM_VALUES = 50 };\n    double values[NUM_VALUES];\n\n    int i = 0;\n\n    for (i = 0; i &lt; NUM_VALUES; i++)\n    {\n        if (scanf(\"%lf\", &amp;values[i]) != 1)\n            break;\n    }\n\n    dump_doubles(\"Before sort\", i, values);\n    qsort(values, i, sizeof(values[0]), cmp_double);\n    dump_doubles(\"After sort\", i, values);\n\n    return 0;\n}\n</code></pre>\n\n<p>Note the testing required to sort -0.0 before +0.0!</p>\n\n<p>Consider the input data:</p>\n\n<pre><code>3023.421800 9033.902200 nan -9370.952500 3088.884900 6829.135400 0\n-0.000000 -inf -5267.546800 -8784.373300 5663.944600 -9728.231300 inf\n-inf -5373.038600 4282.941600 6245.734200 -5533.975400 nan 8445.713600\n+inf -9108.960400 -3796.671200 nan -2363.851300 877.460400 9936.416900\n-3480.867400\n</code></pre>\n\n<p>The output from that is:</p>\n\n<pre><code>Before sort (29):\n   +3023.4218   +9033.9022          nan   -9370.9525   +3088.8849\n   +6829.1354      +0.0000      -0.0000         -inf   -5267.5468\n   -8784.3733   +5663.9446   -9728.2313         +inf         -inf\n   -5373.0386   +4282.9416   +6245.7342   -5533.9754          nan\n   +8445.7136         +inf   -9108.9604   -3796.6712          nan\n   -2363.8513    +877.4604   +9936.4169   -3480.8674\nAfter sort (29):\n          nan          nan          nan         -inf         -inf\n   -9728.2313   -9370.9525   -9108.9604   -8784.3733   -5533.9754\n   -5373.0386   -5267.5468   -3796.6712   -3480.8674   -2363.8513\n      -0.0000      +0.0000    +877.4604   +3023.4218   +3088.8849\n   +4282.9416   +5663.9446   +6245.7342   +6829.1354   +8445.7136\n   +9033.9022   +9936.4169         +inf         +inf\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8883566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44fd68a802fffbd1dba63d47d25fd98c?s=128&d=identicon&r=PG&f=1", "display_name": "Radar", "link": "https://stackoverflow.com/users/8883566/radar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "accepted_answer_id": 55152106, "answer_count": 2, "score": -1, "last_activity_date": 1552695564, "creation_date": 1552513659, "last_edit_date": 1552673013, "question_id": 55151688, "link": "https://stackoverflow.com/questions/55151688/how-to-sort-an-array-that-includes-nans-c", "title": "How to sort an array that includes NaN&#39;s C", "body": "<p>Have been trying to implement my code as a means to sort all integers including NaNs. However can not seem to find a function that would sort NaNs into my program. Code is able to sort other integers including infinities, however when a nan is entered the program recognizes the input but does not sort it to the start of the list. Any help would be appreciated. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    float array[100], swap;\n    int c, d, n;\n\n    printf(\"Enter the size of array\\n\");\n    scanf(\"%d\", &amp;n);\n\n    printf(\"Enter %d integers\\n\", n);\n\n    for (c = 0; c &lt; n; c++)\n        scanf(\"%f\", &amp;array[c]);\n\n    for (c = 0; c &lt; (n - 1); c++)\n    {\n        for (d = 0; d &lt; n - c - 1; d++)\n        {\n            if (array[d] &gt; array[d + 1]) \n            {\n                swap = array[d];\n                array[d] = array[d + 1];\n                array[d + 1] = swap;\n            }\n        }\n    }\n\n    printf(\"Sorted array in ascending order:\\n\");\n\n\n    for (c = 0; c &lt; n; c++)\n        printf(\"%f\\n\", array[c]);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "time"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 6, "creation_date": 1552512083, "post_id": 55151382, "comment_id": 97043096, "body": "Have you looked into what UTC is?"}, {"owner": {"reputation": 628, "user_id": 3529352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/245b44fc0ecbcdea18a29bc8016f5d4c?s=128&d=identicon&r=PG&f=1", "display_name": "nathan", "link": "https://stackoverflow.com/users/3529352/nathan"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1552512219, "post_id": 55151382, "comment_id": 97043158, "body": "yeah, it is a standard &quot;Coordinated Universal Time &quot;"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1552512235, "post_id": 55151382, "comment_id": 97043165, "body": "UTC is a universal timezone, essentially the same as GMT (Greenwich Mean Time).  Times always have an associated timezone, and in this case the documentation says it&#39;s UTC (rather than local time).  It&#39;s very clear."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1552512416, "post_id": 55151382, "comment_id": 97043234, "body": "<code>time()</code> always returns UTC time, so it will be the same regardless of your time zone."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1552512509, "post_id": 55151382, "comment_id": 97043279, "body": "@TomKarzes Strictly speaking, UTC isn&#39;t a time &quot;zone&quot; as it is not actually associated with any area.  That is essentially what separates UTC from GMT; GMT is an actual zone that countries use as their official time, and it also happens to align with UTC (well, that&#39;s more by design than happenstance, but who cares?)"}, {"owner": {"reputation": 628, "user_id": 3529352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/245b44fc0ecbcdea18a29bc8016f5d4c?s=128&d=identicon&r=PG&f=1", "display_name": "nathan", "link": "https://stackoverflow.com/users/3529352/nathan"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1552513256, "post_id": 55151382, "comment_id": 97043638, "body": "@ChristianGibbons  I know my real problem. I thought UTC is a timezone  .since wikipedia says &quot;In some countries where English is spoken, the term Greenwich Mean Time (GMT) is often used as a synonym for UTC&quot;   then I was thinking,  the time() in USA should return (A+B). A is current USA to  &quot;1970-01-01 00:00:00 +0000&quot; in USA. B is time difference of (1970-01-01 00:00:00 +0000 USA to1970-01-01 00:00:00 +0000 GMT ). Seems I am totally wrong"}, {"owner": {"reputation": 628, "user_id": 3529352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/245b44fc0ecbcdea18a29bc8016f5d4c?s=128&d=identicon&r=PG&f=1", "display_name": "nathan", "link": "https://stackoverflow.com/users/3529352/nathan"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1552514154, "post_id": 55151382, "comment_id": 97043974, "body": "um, looks like your opinion is very different from @ChristianGibbons.   if &quot;the time expressed in UTC can be characterized as local time plus a (location- and date-specific) delta between local and UTC&quot; is correct, then time() would return different value in different timzone.  which seems not true"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552517724, "post_id": 55151382, "comment_id": 97045146, "body": "&quot;returns the time as the number of seconds since the Epoch, 1970-01-01 00:00:00 +0000 (UTC)&quot; is a bit of fib.  Its not the &quot;number of seconds&quot;, like 1,2,3,....1024,1025,1026, ... 1000000000,1000000001, 1000000002.  It is a series of <i>timestamps</i> like <code>1970-1-1.0:0:0, 1970-1-1.0:0:1, 1970-1-1.0:0:2, ...</code>  The difference are those pesky <i>leap seconds</i>.  Unix pretends in <code>time_t</code>, they do not occur."}], "answers": [{"comments": [{"owner": {"reputation": 628, "user_id": 3529352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/245b44fc0ecbcdea18a29bc8016f5d4c?s=128&d=identicon&r=PG&f=1", "display_name": "nathan", "link": "https://stackoverflow.com/users/3529352/nathan"}, "edited": false, "score": 0, "creation_date": 1552513559, "post_id": 55151471, "comment_id": 97043739, "body": "so in USA California, can I say time() returns the number of seconds since &quot;1970-01-01 00:00:00 +0000 local standard&quot;"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 628, "user_id": 3529352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/245b44fc0ecbcdea18a29bc8016f5d4c?s=128&d=identicon&r=PG&f=1", "display_name": "nathan", "link": "https://stackoverflow.com/users/3529352/nathan"}, "edited": false, "score": 1, "creation_date": 1552513733, "post_id": 55151471, "comment_id": 97043803, "body": "@nathan The &quot;+0000&quot; part means UTC.  &quot;local standard&quot; doesn&#39;t mean anything."}], "tags": [], "owner": {"reputation": 150, "user_id": 6765778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b43b34e026194a3a40cc5d41b81ea291?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleOne", "link": "https://stackoverflow.com/users/6765778/humbleone"}, "is_accepted": false, "score": 0, "last_activity_date": 1552512390, "creation_date": 1552512390, "answer_id": 55151471, "question_id": 55151382, "link": "https://stackoverflow.com/questions/55151382/confused-about-utc/55151471#55151471", "title": "Confused about UTC", "body": "<p>Assuming your system time is set properly, the timezone in which the machine resides makes no difference as to what <code>time()</code> returns, since\u2013as you have already acknowledged\u2013UTC is by definition universal and does not vary from location to location.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1552517970, "post_id": 55152148, "comment_id": 97045213, "body": "Detail: Most conversions   <code>1552516168</code> to/from <code>2019-03-13T22:**:**Z</code> pretend <i>leap seconds</i> do not exist, so 1552516168 is not quite the count of seconds since <code>1970-01-01 00:00:00Z</code>."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1552518109, "post_id": 55152148, "comment_id": 97045261, "body": "Correct. <code>time()</code> actually returns the number of seconds that aren&#39;t leap seconds since the start of 1970 UTC."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552518262, "post_id": 55152148, "comment_id": 97045310, "body": "Nice way to say it &quot;that aren&#39;t leap seconds since the start of 1970 UTC&quot;."}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": true, "score": 4, "last_activity_date": 1552545316, "last_edit_date": 1552545316, "creation_date": 1552516311, "answer_id": 55152148, "question_id": 55151382, "link": "https://stackoverflow.com/questions/55151382/confused-about-utc/55152148#55152148", "title": "Confused about UTC", "body": "<p>The number of seconds since the start of 1970 UTC doesn't vary based on where you are located in the world, so <code>time</code> returns the same regardless of where you are located in the world (assuming correct system clocks).</p>\n\n<p>Conversions to local time is performed by subsequent operations.</p>\n\n<pre><code>$ TZ=America/Toronto perl -MPOSIX -le'\n   my $time = time();\n   print $time;\n   print strftime(\"%FT%TZ\", gmtime($time));\n   print strftime(\"%FT%T%z\", localtime($time)) =~ s/(?=..\\z)/:/sr;\n'\n1552516168\n2019-03-13T22:29:28Z\n2019-03-13T18:29:28-04:00\n\n$ TZ=America/Halifax perl -MPOSIX -le'\n   my $time = time();\n   print $time;\n   print strftime(\"%FT%TZ\", gmtime($time));\n   print strftime(\"%FT%T%z\", localtime($time)) =~ s/(?=..\\z)/:/sr;\n'\n1552516168\n2019-03-13T22:29:28Z\n2019-03-13T19:29:28-03:00\n</code></pre>\n\n<p>[<em>Oops, I thought this question was tagged <a href=\"/questions/tagged/perl\" class=\"post-tag\" title=\"show questions tagged &#39;perl&#39;\" rel=\"tag\">perl</a>. However, the code should be clear enough to convey the idea to a C programmer. <code>time</code>, <code>gmtime</code>, <code>localtime</code> and <code>strftime</code> behave similarly in both languages.</em>]</p>\n"}], "owner": {"reputation": 628, "user_id": 3529352, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/245b44fc0ecbcdea18a29bc8016f5d4c?s=128&d=identicon&r=PG&f=1", "display_name": "nathan", "link": "https://stackoverflow.com/users/3529352/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 55152148, "answer_count": 2, "score": 0, "last_activity_date": 1552545316, "creation_date": 1552512014, "last_edit_date": 1552520572, "question_id": 55151382, "link": "https://stackoverflow.com/questions/55151382/confused-about-utc", "title": "Confused about UTC", "body": "<p>I am not very clear about the <code>time()</code> function.\n\"man 2 time\" says \"time() returns the time as the number of seconds since the Epoch, 1970-01-01 00:00:00 +0000 (UTC).\"</p>\n\n<p>My question is </p>\n\n<ul>\n<li>Suppose device A is in London, device B is in USA.\nDoes the <code>time()</code> return same value or not?  Or does the <code>time()</code> result change with timezone?</li>\n</ul>\n\n<p>====update====</p>\n\n<p>I know my real problem. I thought UTC is a timezone. Since Wikipedia says \"In some countries where English is spoken, the term Greenwich Mean Time (GMT) is often used as a synonym for UTC\" then I was thinking, the <code>time()</code> in USA should return (A+B). A is current USA to \"1970-01-01 00:00:00 +0000\" in USA. B is time difference of (1970-01-01 00:00:00 +0000 USA to1970-01-01 00:00:00 +0000 GMT ). Seems I am totally wrong.</p>\n"}, {"tags": ["c", "while-loop"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 6, "creation_date": 1552511488, "post_id": 55151214, "comment_id": 97042838, "body": "<code>if( letter = &#39;&gt;&#39;)</code> you need to use <code>==</code> for comparison."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1552511601, "post_id": 55151214, "comment_id": 97042888, "body": "Please explain why in one case <code>move_cursor_right(position_of_cursor, max);</code> and in another case <code>move_cursor_right (&amp;position_of_cursor, max);</code>. Making a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> could answer that, but better is to explain the API you imagine for that function."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1552511922, "post_id": 55151214, "comment_id": 97043019, "body": "Also, <code>printf(position_of_cursor);</code> and <code>printf(&quot;%d&quot;, position_of_cursor);</code> The first will very like cause a crash, since a <code>const char *</code> is expected. Please take note of compiler warnings."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1552512616, "post_id": 55151214, "comment_id": 97043332, "body": "Also, in <code>move_cursor_right (&amp;position_of_cursor, max);</code> and others, <code>max</code> is <i>uninitialised</i>."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1552512899, "post_id": 55151214, "comment_id": 97043465, "body": "your program probably crashes in ~move_cursor_right` or <code>move_cursor_left</code>. Try running in a debugger like <code>gdb</code>."}, {"owner": {"reputation": 121, "user_id": 10636761, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N8Rfc6VbD18/AAAAAAAAAAI/AAAAAAAAADQ/wDNHB3ux4GU/photo.jpg?sz=128", "display_name": "Gearoid Sheehan", "link": "https://stackoverflow.com/users/10636761/gearoid-sheehan"}, "edited": false, "score": 0, "creation_date": 1552513003, "post_id": 55151214, "comment_id": 97043525, "body": "Edited to fix above suggestions and I also included the wordgame.c code"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1552516191, "post_id": 55151214, "comment_id": 97044688, "body": "Your code in <code>move_cursor_right</code> and <code>move_cursor_right</code> is wrong. The parameter <code>pPosition_of_cursor</code> is an <code>int*</code>, but you are treating it as an <code>int</code>.  Change your increment and decrement lines to be like this: <code>*pPosition_of_cursor = *pPosition_of_cursor + 1;</code>"}, {"owner": {"reputation": 121, "user_id": 10636761, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N8Rfc6VbD18/AAAAAAAAAAI/AAAAAAAAADQ/wDNHB3ux4GU/photo.jpg?sz=128", "display_name": "Gearoid Sheehan", "link": "https://stackoverflow.com/users/10636761/gearoid-sheehan"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1552517718, "post_id": 55151214, "comment_id": 97045142, "body": "@bruceg fixed my problem, thank you!"}], "owner": {"reputation": 121, "user_id": 10636761, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N8Rfc6VbD18/AAAAAAAAAAI/AAAAAAAAADQ/wDNHB3ux4GU/photo.jpg?sz=128", "display_name": "Gearoid Sheehan", "link": "https://stackoverflow.com/users/10636761/gearoid-sheehan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552512957, "creation_date": 1552511243, "last_edit_date": 1552512957, "question_id": 55151214, "link": "https://stackoverflow.com/questions/55151214/c-game-shutting-down-after-user-input", "title": "C game shutting down after user input", "body": "<p>I am working on a game where the user must change the letters in a word to make the target word using a cursor. My code is running but when the user input is taken the cursor does not move and the letters do not change. Symbols are printed before the next iteration of the loop just before \"Game state\".</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include \"WordGame.h\"\n\nint main() {\n    char  current_letters[] = {'b', 'e', 'l', 'l'};\n    char target_letters[] = {'c', 'o', 'a', 't'};\n    int position_of_cursor = 2;\n    const int NUMBER_OF_LETTERS = 4;\n    bool game_finished = false;\n    int number_of_letter_changes = 0;\n    int max = 3;\n\n    while (number_of_letter_changes &lt; 8) {\n        display_game_state (target_letters, current_letters, NUMBER_OF_LETTERS, position_of_cursor, number_of_letter_changes);\n\n        printf(\"Enter a command: \");\n        char letter = get_user_char();\n\n        if( letter == '&gt;') {\n            move_cursor_right(position_of_cursor, max);\n        }\n        else if ( letter == '&lt;') {\n            move_cursor_left(position_of_cursor, max);\n        }\n\n        move_cursor_right (&amp;position_of_cursor, max);\n        printf(\"%d\", position_of_cursor);\n        move_cursor_right (&amp;position_of_cursor, max);\n        printf(\"%d\", position_of_cursor);\n        number_of_letter_changes++;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>WordGame.c code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\n    char get_user_char() {\n    //1. We create the output variable with the value the user has input by keyboard\n    char res = getchar();\n\n    //2. We discard any extra character the user has input by keyboard\n    bool finish = false;\n    char dummy_char = ' ';\n\n    while (finish == false) {\n        dummy_char = getchar();\n        if (dummy_char == '\\n')\n            finish = true;\n    }\n\n    //3. We return the output variable\n    return res;\n}\n\n    void display_game_state(char* pTarget_letters, char* pCurrent_letters,const int NUMBER_OF_LETTERS,\n                            const int cursor_position, const int number_of_letter_changes)\n        {\n            printf(\"---Game State ---\\n\");\n          //  printf(\"%p\\n\", pCurrent_letters);\n\n            int c;\n\n            printf(\"Target: \");\n\n            for(c = 0; c &lt;= 3; ++c) {\n\n                printf(\"%c\", *pTarget_letters);\n                pTarget_letters = pTarget_letters + 1;\n\n            }\n\n            printf(\"\\n-----------------\\n\");\n\n            for(c = 0; c &lt;= 3; ++c) {\n\n                printf (\"%c\", *pCurrent_letters);\n                pCurrent_letters = pCurrent_letters + 1;\n\n            }\n\n            int i;\n\n            const char DASH = '-';\n            const char SPACE = ' ';\n\n            for(i = 0; i &lt; cursor_position ; ++i) {\n\n                printf(\"%c\", SPACE);\n            }\n\n            printf(\"\\n%c\", DASH);\n\n            printf(\"\\nChanges: %d\\n\", number_of_letter_changes);\n\n            char letter;\n    }\n\n    void move_cursor_right(int* pPosition_of_cursor, const int max)\n\n    {\n\n        printf (\"%c\", *pPosition_of_cursor);\n        pPosition_of_cursor = pPosition_of_cursor + 1;\n\n    }\n\n    void move_cursor_left(int* pPosition_of_cursor, const int max)\n\n    {\n\n        printf (\"%c\", *pPosition_of_cursor);\n        pPosition_of_cursor = pPosition_of_cursor - 1;\n\n    }\n\n    void change_letters(char* pLetters, int position, char new_letter, int max)\n\n    {\n        char* plocation_of_letter_to_change = pLetters + position;\n    }\n\n    void start_game(char * pCurrent,  char* pTarget, const int size_of_word)\n{\n    int position_of_cursor = 0;\n    bool game_finished = false;\n    int number_of_letter_changes = 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "csv", "multidimensional-array", "struct"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1552511231, "post_id": 55151069, "comment_id": 97042736, "body": "Recommend you read this.  <a href=\"https://stackoverflow.com/questions/17258647/why-is-it-safer-to-use-sizeofpointer-in-malloc\" title=\"why is it safer to use sizeofpointer in malloc\">stackoverflow.com/questions/17258647/&hellip;</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1552512501, "post_id": 55151069, "comment_id": 97043274, "body": "The <code>strdup()</code> approach is a viable one, and the only viable one of the three presented.  If it&#39;s not working for you then we would need to consider a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to do more than guess about why not."}], "answers": [{"tags": [], "owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "is_accepted": false, "score": 1, "last_activity_date": 1552512373, "creation_date": 1552512373, "answer_id": 55151465, "question_id": 55151069, "link": "https://stackoverflow.com/questions/55151069/how-to-assign-a-temp-value-to-a-2d-array/55151465#55151465", "title": "How to assign a temp value to a 2d array", "body": "<p><code>arrayofnodes[i] = malloc(N * sizeof (struct node));</code> makes enough space for N structs. What you want is space for N struct pointers.   </p>\n\n<p>However I don't think that's your main problem.  Only \"way 2\" is valid - you do need to create storage for every new string you read.  \"way 1\" is re-using the <code>temp</code> storage, and \"way 3\" is re-using the 'fun' storage, which will be invalid as soon as you exit the function.</p>\n\n<p>If \"way 2\" is not working for you, I'd look at the code generating <code>row</code> and <code>count</code>.  Are those indexes always less than <code>35</code> and <code>test</code> respectively?</p>\n"}, {"tags": [], "owner": {"reputation": 729, "user_id": 11060870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a74dd465c0373f529ebe6f9ee7592add?s=128&d=identicon&r=PG", "display_name": "ccxxshow", "link": "https://stackoverflow.com/users/11060870/ccxxshow"}, "is_accepted": false, "score": 0, "last_activity_date": 1552538401, "creation_date": 1552538401, "answer_id": 55155059, "question_id": 55151069, "link": "https://stackoverflow.com/questions/55151069/how-to-assign-a-temp-value-to-a-2d-array/55155059#55155059", "title": "How to assign a temp value to a 2d array", "body": "<p>When using malloc or strdup, you need extra 16 bytes of space for management. <br>\nWhen you allocate a lot of small memory, this extra space also takes up a lot of memory.<br>\nSo consider own managing memory, or tcmalloc, jemalloc</p>\n\n<h3>Below is the test data:</h3>\n\n<p>gcc -otest test.c -Wall -O3 -g</p>\n\n<pre><code>[test_strdup] cost time: 1085247 us, use memory: 839.81 MB\n[test_optimized] cost time: 394635 us, use memory: 411.71 MB\n</code></pre>\n\n<p>gcc -otest test.c -Wall -O3 -g -ltcmalloc</p>\n\n<pre><code>[test_strdup] cost time: 627160 us, use memory: 461.07 MB\n[test_optimized] cost time: 397938 us, use memory: 422.85 MB\n</code></pre>\n\n<p>gcc -otest test.c -Wall -O3 -g -ljemalloc</p>\n\n<pre><code>[test_strdup] cost time: 749875 us, use memory: 481.77 MB\n[test_optimized] cost time: 330825 us, use memory: 451.96 MB\n</code></pre>\n\n<h3>Below is the test code</h3>\n\n<p>Just to compare the memory allocation, there is a memory leak in the test code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;sys/sysinfo.h&gt;\n\n#define ROWS 35\n#define COLS (1000*10000/ROWS)\n#define MB   (1024*1024)\n#define TEST_STR \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n\nstruct node {\n    char *value;\n};\n\nlong current_time()\n{\n    struct timeval tv;\n    gettimeofday(&amp;tv, NULL);\n    return tv.tv_sec * 1000000L + tv.tv_usec;\n}\n\nlong current_usemem()\n{\n    FILE *fp;\n    long resident = 0;\n\n    fp = fopen(\"/proc/self/statm\", \"r\");\n    if (fp) {\n        if (fscanf(fp, \"%*s %ld \", &amp;resident) != 1)\n            resident = 0;\n        fclose(fp);\n    }\n    resident *= 4096;\n\n    return resident;\n}\n\nvoid test_strdup()\n{\n    char temp[500];\n    struct node **arrayofnodes[ROWS];\n    int i, j;\n    long start_time, end_time;\n    long start_usemem, end_usemem;\n\n    strcpy(temp, TEST_STR);\n    start_usemem = current_usemem();\n    start_time = current_time();\n\n    for(i = 0; i &lt; ROWS; i++) {\n        arrayofnodes[i] = (struct node **)malloc(COLS * sizeof(struct node *));\n        for(j = 0; j &lt; COLS; j++) {\n            arrayofnodes[i][j] = (struct node *)malloc(sizeof (struct node));\n        }\n    }\n\n    for(i = 0; i &lt; ROWS; i++) {\n        for(j = 0; j &lt; COLS; j++) {\n            arrayofnodes[i][j]-&gt;value = strdup(temp);\n        }\n    }\n\n    end_time = current_time();\n    end_usemem = current_usemem();\n    printf(\"[%s] cost time: %ld us, use memory: %.2f MB\\n\",\n           __FUNCTION__, end_time - start_time,\n           (end_usemem - start_usemem) / 1024.0 / 1024);\n}\n\nstruct memory_chunk {\n    struct memory_chunk *next;\n    char *cur;\n    char *end;\n    char buf[0];\n};\n\nstruct memory_pool {\n    struct memory_chunk *head;\n};\n\nvoid *pool_alloc(struct memory_pool *pool, size_t size)\n{\n    void *ret;\n    struct memory_chunk *chunk;\n\n    chunk = pool-&gt;head;\n    if (chunk == NULL || chunk-&gt;cur + size &gt;= chunk-&gt;end) {\n        size_t len = (size &lt; MB ? MB : size + sizeof(*chunk));\n        chunk = (struct memory_chunk *)malloc(len);\n        chunk-&gt;next = pool-&gt;head;\n        chunk-&gt;end = (char *)chunk + len;\n        chunk-&gt;cur = chunk-&gt;buf;\n        pool-&gt;head = chunk;\n    }\n\n    ret = chunk-&gt;cur;\n    chunk-&gt;cur += size;\n    return ret;\n}\n\nchar *pool_strdup(struct memory_pool *pool, const char *s)\n{\n    size_t size = strlen(s) + 1;\n    void *ret = pool_alloc(pool, size);\n    memcpy(ret, s, size);\n    return ret;\n}\n\nvoid test_optimized()\n{\n    char temp[500];\n    struct node ***arrayofnodes;\n    int i, j;\n    long start_time, end_time;\n    long start_usemem, end_usemem;\n    struct memory_pool pool = {NULL};\n\n    strcpy(temp, TEST_STR);\n    start_usemem = current_usemem();\n    start_time = current_time();\n\n    arrayofnodes = (struct node ** *)pool_alloc(&amp;pool, ROWS * sizeof(struct node **));\n    for(i = 0; i &lt; ROWS; i++) {\n        arrayofnodes[i] = (struct node **)pool_alloc(&amp;pool, COLS * sizeof(struct node *));\n        for(j = 0; j &lt; COLS; j++) {\n            arrayofnodes[i][j] = (struct node *)pool_alloc(&amp;pool, sizeof(struct node));\n        }\n    }\n\n    for(i = 0; i &lt; ROWS; i++) {\n        for(j = 0; j &lt; COLS; j++) {\n            arrayofnodes[i][j]-&gt;value = pool_strdup(&amp;pool, temp);\n        }\n    }\n\n    end_time = current_time();\n    end_usemem = current_usemem();\n    printf(\"[%s] cost time: %ld us, use memory: %.2f MB\\n\",\n           __FUNCTION__, end_time - start_time,\n           (end_usemem - start_usemem) / 1024.0 / 1024);\n\n}\n\nint main()\n{\n    test_strdup();\n    test_optimized();\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11188661, "user_type": "registered", "profile_image": "https://graph.facebook.com/2255135198044795/picture?type=large", "display_name": "Catherine Bunch", "link": "https://stackoverflow.com/users/11188661/catherine-bunch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552538401, "creation_date": 1552510617, "last_edit_date": 1552515784, "question_id": 55151069, "link": "https://stackoverflow.com/questions/55151069/how-to-assign-a-temp-value-to-a-2d-array", "title": "How to assign a temp value to a 2d array", "body": "<p>So I have a 2d array of structs that I am storing data from a csv file. I am reading in the strings from the file then I want to assign their value in the 2d array as that string. So for example position [0][0] would be \"red\" and position [1][1] would be \"blue\" or something. The problem is that I am reading in the characters from the file and storing them in a temp string then I want to assign that temp string value to the current position I'm on. So I have the temp as \"red\" and I want [0][0] to be \"red\" then it reads more from the file and temp is now \"blue\" and I want [0][1] to be \"blue\". When I assign [0][0]=temp then [0][1]=temp they write over each other(since it is a pointer). I have tried strdup(temp) but that does not seem to fix the problem either they still re write over each other sometimes. I know I could use strcpy but for strcpy I have to have another string to copy it to so I tried that with just making a new char array each time, but that does not work either. It still gets written over. I know I could fix this problem if each time I assigned a value I created a new char array with a new name and pointed to that char array, but this is for a very large csv file so then I would have to create about 10 million char arrays and I do not know how to do that, and it seems like there should be a simpler way. </p>\n\n<p>Any help is very much appreciated thanks! </p>\n\n<pre><code>struct node {\n    char* value;\n};\n\nchar temp[500];\nstruct node ** arrayofnodes[35];\nfor(int i=0; i&lt;35; i++) {\n    arrayofnodes[i] = malloc(test * sizeof (struct node));\n    for(int j=0; j&lt;test; j++) arrayofnodes[i][j] = malloc(sizeof (struct node));\n}\n\n\n//(all of this below happens inside a function because it is going to be called like 10 million times)\n    arrayofnodes[row][count]-&gt;value=temp; //way 1\n    arrayofnodes[row][count]-&gt;value=strdup(temp); //way 2\n    char fun[500];\n    strcpy(fun,temp);\n    arrayofnodes[row][count]-&gt;value=fun;//way 3\n</code></pre>\n"}, {"tags": ["c", "gcc", "scanf", "stdin", "ansi"], "comments": [{"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1552510869, "post_id": 55151068, "comment_id": 97042588, "body": "Read entire lines, then parse them for example with <code>sscanf</code>."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11199633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa40921423a1b0b58815b7ae6d2e223?s=128&d=identicon&r=PG", "display_name": "user648933", "link": "https://stackoverflow.com/users/11199633/user648933"}, "edited": false, "score": 0, "creation_date": 1552563812, "post_id": 55151182, "comment_id": 97062240, "body": "Could you explain me a bit more in detail how would this scanf exiting after the enter work?"}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 3, "last_activity_date": 1552511105, "creation_date": 1552511105, "answer_id": 55151182, "question_id": 55151068, "link": "https://stackoverflow.com/questions/55151068/c-programming-scanf-function/55151182#55151182", "title": "C programming, scanf() function", "body": "<p>A space in the format string of <code>scanf</code> will consume any white space (if any); Format specifier <code>%d</code> will also ignore any whitespaces before the actual number. So <code>\" %d\"</code> has the same effect as <code>\"%d\"</code>. Format specifier <code>%c</code> will not ignore white spaces but read them in, so <code>\" %c\"</code> would be different than <code>\"%c\"</code>. In your case, where <code>%c</code> is at the beginning of the format string of <code>scanf(\"%c %d %d\", ...)</code> has the same effect as <code>scanf(\"%c%d%d\", ...)</code>.</p>\n\n<p>If you want to allow to exit before everything is entered, I'd suggest to read in a complete \"line\" using <code>fgets</code> and then parse the input accordingly, e.g. using <code>sscanf</code> of <code>strtok</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 11199633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa40921423a1b0b58815b7ae6d2e223?s=128&d=identicon&r=PG", "display_name": "user648933", "link": "https://stackoverflow.com/users/11199633/user648933"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 55151182, "answer_count": 1, "score": 0, "last_activity_date": 1552512606, "creation_date": 1552510614, "last_edit_date": 1552512606, "question_id": 55151068, "link": "https://stackoverflow.com/questions/55151068/c-programming-scanf-function", "title": "C programming, scanf() function", "body": "<p>Does scanf put spaces in its buffer or input stream?\nIf i say </p>\n\n<pre><code>scanf(\"%c %d %d\", &amp;character, &amp;num1, &amp;num2);\n</code></pre>\n\n<p>And now say</p>\n\n<pre><code>scanf(\"%c\", &amp;char2);\n</code></pre>\n\n<p>I know that enter will stay in the buffer but do the spaces count?</p>\n\n<pre><code>scanf(\"%c%d%d\", &amp;character, &amp;num1, &amp;num2);\n</code></pre>\n\n<p>Is this any different than the first part.</p>\n\n<p>Also another thing.\nCan I somehow break scanf after user presses enter. If it presses enter after the num1 for ex. Input: i 5</p>\n\n<p>Can i somehow make scanf stop after this even though it is waiting for one more input?</p>\n"}, {"tags": ["c", "string", "struct"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 5, "creation_date": 1552508358, "post_id": 55150544, "comment_id": 97041427, "body": "You didn&#39;t declare enough space for the trailing null byte."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 2, "creation_date": 1552508393, "post_id": 55150544, "comment_id": 97041437, "body": "Strings need length+1 to leave room for the terminator."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1552508394, "post_id": 55150544, "comment_id": 97041440, "body": "Use <code>mytime[6]</code> and <code>mydate[11]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 4, "last_activity_date": 1552508612, "creation_date": 1552508612, "answer_id": 55150606, "question_id": 55150544, "link": "https://stackoverflow.com/questions/55150544/c-struct-string-elements-are-concatenated/55150606#55150606", "title": "C - Struct string elements are concatenated", "body": "<p>You have undefined behavior since there is not sufficient room in <code>mydate</code> to contain strings of the format \"MM-DD-YYYY\" - don't forget the implicit null terminator at the end.</p>\n\n<p>What you're specifically observing is that the lack of the null terminator means that the output function (<code>puts</code>, <code>printf</code>, or whatever you're using) continues to read characters after the string ends. It so happens that there isn't any padding between <code>mydate</code> and <code>mytime</code> in your case, so the value in <code>mytime</code> appears to be part of the string as well. </p>\n\n<p>Remember, since arrays decay to pointers when passed to functions, there is no way for a function with an array parameter to know when it is done reading the array; the null terminator acts as a sentinel value for this purpose.</p>\n\n<p>Solution: Increase the size of both <code>mydate</code> and <code>mytime</code> to accommodate the null terminator as well.</p>\n"}, {"comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1552514196, "post_id": 55151297, "comment_id": 97043993, "body": "I would not recommend using <code>strncpy</code> as a &quot;safe alternative&quot; to <code>strcpy</code>; that is not its intended purpose"}], "tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": false, "score": 1, "last_activity_date": 1552511583, "creation_date": 1552511583, "answer_id": 55151297, "question_id": 55150544, "link": "https://stackoverflow.com/questions/55150544/c-struct-string-elements-are-concatenated/55151297#55151297", "title": "C - Struct string elements are concatenated", "body": "<p>since you complained that your code did not work even with increased sizes, here is an example which works correctly:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstruct mystruct1 {\n    char mydate[11];\n    char mytime[6];\n};\n\nvoid main() {\n    struct mystruct1 *mystruct1 = (struct mystruct1*)malloc(sizeof(struct mystruct1));\n\n    strcpy(mystruct1-&gt;mydate, \"01-01-1970\");\n    strcpy(mystruct1-&gt;mytime, \"00:01\");\n\n    printf(\"date: %s, time: %s\\n\", mystruct1-&gt;mydate, mystruct1-&gt;mytime);\n}\n</code></pre>\n\n<p>In this example every array has enough space to keep the string with the null terminator. So, you can compare it to your code.</p>\n\n<p>In general it is also possible to keep sizes as in your example. But you need to always remember that the end of the string cannot be determined automatically and will require you to use specific function, like <code>strncpy</code> instead of <code>strcpy</code>. <code>printf</code> will not work directly as well. So here is another example:</p>\n\n<pre><code>struct mystruct2 {\n    char mydate[10];\n    char mytime[5];\n};\n\nvoid main() {\n    struct mystruct2 *mystruct2 = (struct mystruct2*)malloc(sizeof(struct mystruct2));\n\n    strncpy(mystruct2-&gt;mydate, \"02-02-2970\", 10);\n    strncpy(mystruct2-&gt;mytime, \"00:02\", 5);\n\n    // need top prepare standard strings with terminator for printf\n    char mydate[11]; // still need [11] for printf to work\n    char mytime[6];\n\n    strncpy(mydate, mystruct2-&gt;mydate, 10);\n    mydate[10] = 0; // make sure to put a string terminator here\n    strncpy(mytime, mystruct2-&gt;mytime, 10);\n    mytime[5] = 0;\n\n    printf(\"date: %s, time: %s\\n\", mydate, mytime);\n}\n</code></pre>\n\n<p>The above makes sense in some situation where you are really tight on the memory, but should not be used in generic cases. </p>\n"}, {"tags": [], "owner": {"reputation": 1899, "user_id": 8854921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b76055b306b4dbab08ee558957f52e?s=128&d=identicon&r=PG&f=1", "display_name": "Bo R", "link": "https://stackoverflow.com/users/8854921/bo-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1552564822, "last_edit_date": 1552564822, "creation_date": 1552514786, "answer_id": 55151897, "question_id": 55150544, "link": "https://stackoverflow.com/questions/55150544/c-struct-string-elements-are-concatenated/55151897#55151897", "title": "C - Struct string elements are concatenated", "body": "<p>The are at least two problems with the code.</p>\n\n<p>1) You are writing too much in the <code>mydate</code> and <code>mytime</code>. The fix is either to allocate more memory in the struct, i.e., <code>char mydate[10+1];</code> &amp; <code>char mytime[5+1];</code>. Or just don't write the <code>NULL</code> terminator. A solution for that, since you know the size in advance, use <code>memcpy(mystruct-&gt;mydate, \"01-01-1970\", sizeof(mystruct-&gt;mydate));</code> or similar <code>memcpy(mystruct-&gt;mytime, \"00:01\", 5);</code>.</p>\n\n<p>2) The second part, print out, you are not showing (hint). So if you don't store the <code>NULL</code>-terminator then print out needs to be a little more delicate as shown in the example below.</p>\n\n<pre><code>// Possible dynamic max size\nprintf(\"date: %.*stime: %.*sThe\\n\",\n       (int) sizeof(mystruct-&gt;mydate), mystruct-&gt;mydate,\n       (int) sizeof(mystruct-&gt;mytime), mystruct-&gt;mytime);\n\n// Fixed max size\nprintf(\"date: %.10stime: %.5sEnd\\n\",\n       mystruct-&gt;mydate,\n       mystruct-&gt;mytime);\n</code></pre>\n\n<p>Either way, the print out will be:</p>\n\n<pre><code>date: 01-01-1970time: 00:01The\ndate: 01-01-1970time: 00:01End\n</code></pre>\n\n<p>The <code>printf</code>-syntax used maximizes the length of the string printed.</p>\n\n<p>BTW, your printout, <code>01-01-197000:01</code>, is likely the result of the compiler placing the memory layout of <code>struct mystruct</code> directly after each other in memory. The the resulting memory layout is equivalent to </p>\n\n<pre><code>struct mystruct {\n    char my[15];\n}\n</code></pre>\n\n<p>where the compiler knows that <code>mydate</code> starts at offset 0, and <code>mytime</code> starts at offset 10. This, if you filled your struct in the order of your example you first get <code>\"01-01-1970\\0\"</code> followed by <code>\"01-01-197000:01\\0\"</code> (where the last write is out of scope for the struct). So printing the date with <code>printf(\"%s\", mystruct-&gt;mydate);</code> gives you your sequence output.</p>\n\n<p>On the other hand, had you decided to write you data in the reverse order,</p>\n\n<pre><code>strcpy(mystruct-&gt;mytime, \"00:01\");\nstrcpy(mystruct-&gt;mydate, \"01-01-1970\");\n</code></pre>\n\n<p>the output of</p>\n\n<pre><code>printf(\"date: %s, time: %sEnd\\n\", mystruct-&gt;mydate, mystruct-&gt;mytime);\n</code></pre>\n\n<p>would be</p>\n\n<pre><code>date: 01-01-1970, time: End\n</code></pre>\n\n<p>since you time was overwritten my the null terminator of the <code>mydate</code> string copy.</p>\n"}], "owner": {"reputation": 13, "user_id": 10799092, "user_type": "registered", "profile_image": "https://graph.facebook.com/1115143745204409/picture?type=large", "display_name": "Nick Stavr", "link": "https://stackoverflow.com/users/10799092/nick-stavr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1552564822, "creation_date": 1552508315, "last_edit_date": 1552509343, "question_id": 55150544, "link": "https://stackoverflow.com/questions/55150544/c-struct-string-elements-are-concatenated", "title": "C - Struct string elements are concatenated", "body": "<p>i have two string elements in my structure</p>\n\n<pre><code>struct mystruct{\n    char mydate[10];\n    char mytime[5];\n};\n</code></pre>\n\n<p>They will store strings of type \"XX:YY\" and \"XX-YY-ZZZZ\" respectively.</p>\n\n<p>But when I am assigning some value into these variables</p>\n\n<pre><code>struct mystruct *mystruct = (struct mystruct*)malloc(sizeof(struct mystruct));\nstrcpy(mystruct-&gt;mydate, \"01-01-1970\");\nstrcpy(mystruct-&gt;mytime, \"00:01\");\n</code></pre>\n\n<p><em>mydate</em> variables is printing this:</p>\n\n<pre><code>01-01-197000:01\n</code></pre>\n\n<p>I am missing something? Can you help me? Thanks in andance!</p>\n\n<ul>\n<li>EDITED with more info</li>\n<li>don't works even if I increase the size by one</li>\n</ul>\n"}, {"tags": ["c", "rhel7"], "comments": [{"owner": {"reputation": 6746, "user_id": 1143634, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/e7lca.png?s=128&g=1", "display_name": "StaceyGirl", "link": "https://stackoverflow.com/users/1143634/staceygirl"}, "edited": false, "score": 8, "creation_date": 1552506930, "post_id": 55150189, "comment_id": 97040769, "body": "Why did you put <code>extern int errno</code> there? You should use standard <code>errno</code> <i>macro</i> from <code>&lt;errno.h&gt;</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552507289, "post_id": 55150189, "comment_id": 97040930, "body": "... but if you&#39;re going to rely on <code>errno</code> instead of <code>status</code> to check for errors then you should indeed set it to 0 immediately prior to  calling <code>system()</code> (without declaring it yourself).  Also, do not rely on it to keep its value across subsequent calls to standard library functions."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552508242, "post_id": 55150189, "comment_id": 97041369, "body": "@JohnBollinger This is clearly just a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, it doesn&#39;t &quot;rely&quot; on either variable, it just prints them both. So the question is why is <code>system()</code> returning <code>-1</code> for a perfectly valid command."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552508277, "post_id": 55150189, "comment_id": 97041392, "body": "Does <code>&#47;tmp&#47;test.txt</code> contain the <code>ls</code> output?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552508495, "post_id": 55150189, "comment_id": 97041492, "body": "Well no, @Barmar, it&#39;s <i>not</i> an MCVE.  It&#39;s lacking in the completeness dimension.  Moreover, if the OP indeed does declare <code>errno</code> in their real code, then there&#39;s not much to say about their specific code beyond that the program exhibits undefined behavior."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552508609, "post_id": 55150189, "comment_id": 97041548, "body": "@JohnBollinger Sorry, what I meant was that it&#39;s a simplification that shows the main problem."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1552508671, "post_id": 55150189, "comment_id": 97041575, "body": "Specifically, there&#39;s no <code>if (errno == ...)</code> that&#39;s done without checking <code>status</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1552508906, "post_id": 55150189, "comment_id": 97041666, "body": "Yes, I understand that it&#39;s a cut down summary, but there is not enough here to answer the question.  If I were to speculate based on what I see, I would guess that <code>&#47;tmp&#47;test.txt</code> already exists and is not writable by the OP.  But who knows what actually relevant code may have been omitted that would have led me to a different guess / conclusion?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1552509466, "post_id": 55150189, "comment_id": 97041921, "body": "In any case, there isn&#39;t anything special or peculiar about RHEL that would make the example call to the <code>system()</code> function inherently incorrect, so that I would expect it to fail.  A similar, but complete and correct program runs for me on closely-related CentOS 7, returning 0 from <code>system()</code> and setting <code>errno</code> to 0."}, {"owner": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "edited": false, "score": 0, "creation_date": 1552510321, "post_id": 55150189, "comment_id": 97042303, "body": "You can&#39;t invoke <code>system()</code> with a stream redirect. Stream redirection with <code>&gt;&gt;</code> is a shell feature. You need to use <code>strdup2</code> to redirect the output of a child process."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 3, "creation_date": 1552510826, "post_id": 55150189, "comment_id": 97042563, "body": "Is that actually the full program? You can certainly trigger this error if, for example, you add <code>SA_NOCLDWAIT</code> to the flags for the <code>SIGCHILD</code> handler."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "edited": false, "score": 5, "creation_date": 1552510964, "post_id": 55150189, "comment_id": 97042637, "body": "@sturcotte06: system uses a shell to execute the argument. Posix standard quote:  &quot;The system() function shall behave as if a child process were created using fork(), and the child process invoked the sh utility using execl() as follows: <code>execl(&lt;shell path&gt;, &quot;sh&quot;, &quot;-c&quot;, command, (char *)0);</code>&quot;"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1552512005, "post_id": 55150189, "comment_id": 97043064, "body": "Are you running the program from the command line or is it started by systemd?"}, {"owner": {"reputation": 63, "user_id": 7200789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5501584823bc13326bfc20d7d0e5fb1c?s=128&d=identicon&r=PG&f=1", "display_name": "JEtheDBA", "link": "https://stackoverflow.com/users/7200789/jethedba"}, "edited": false, "score": 0, "creation_date": 1552573302, "post_id": 55150189, "comment_id": 97068937, "body": "Thanks for the replies!  This is not the &quot;real&quot; command in system().  This is a test command to show that even something simple is working, but returning -1.  The &quot;real&quot; command calls SQL*Loader."}, {"owner": {"reputation": 63, "user_id": 7200789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5501584823bc13326bfc20d7d0e5fb1c?s=128&d=identicon&r=PG&f=1", "display_name": "JEtheDBA", "link": "https://stackoverflow.com/users/7200789/jethedba"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1552573638, "post_id": 55150189, "comment_id": 97069220, "body": "@stark:  The program is typically run from a cron job calling the *.exe file."}, {"owner": {"reputation": 63, "user_id": 7200789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5501584823bc13326bfc20d7d0e5fb1c?s=128&d=identicon&r=PG&f=1", "display_name": "JEtheDBA", "link": "https://stackoverflow.com/users/7200789/jethedba"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552573793, "post_id": 55150189, "comment_id": 97069334, "body": "@John Bollinger:  What else would you like to know?"}, {"owner": {"reputation": 63, "user_id": 7200789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5501584823bc13326bfc20d7d0e5fb1c?s=128&d=identicon&r=PG&f=1", "display_name": "JEtheDBA", "link": "https://stackoverflow.com/users/7200789/jethedba"}, "edited": false, "score": 0, "creation_date": 1552574422, "post_id": 55150189, "comment_id": 97069801, "body": "Also, the &quot;real&quot; program does not have errno at all.  I only added that to troubleshoot.  So, whether it&#39;s &quot;extern int errno = 0;&quot;, &quot;errno = 0;&quot;, or nothing, system() returns a -1."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1552574516, "post_id": 55150189, "comment_id": 97069877, "body": "@JEtheDBA, I would like a <i>bona fide</i> <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, as Barmar already requested.  If what you&#39;ve presented so far is in fact characteristic of the problem, then a MCVE needn&#39;t be more than a few lines longer.  I would also like to know about the existence, ownership, and permissions of the file to which you&#39;re trying to redirect the command&#39;s output relative to the user running the program.  Including SELinux properties if that&#39;s enabled in enforcing mode (the default for CentOS 7)."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1552580827, "post_id": 55150189, "comment_id": 97074485, "body": "@jethedba: it&#39;s not that people don&#39;t believe you; it&#39;s that we need something testable. A complete but short program with a <code>main()</code> and and <code>#include</code>s and, if absolutely necessary support functions. (How is <code>os_log_msg</code> implemented? Does it rely on initialisation code of a complex library? Better to just write to stderr or a temp file.) Then show how you run the program and its precise result. <i>You</i> can see all this stuff; it&#39;s right in front of you. We can&#39;t. So share."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1552581054, "post_id": 55150189, "comment_id": 97074641, "body": "Anyway, I think @zwol nailed it. The question is figuring out what might be installing or modifying a signal handler."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7200789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5501584823bc13326bfc20d7d0e5fb1c?s=128&d=identicon&r=PG&f=1", "display_name": "JEtheDBA", "link": "https://stackoverflow.com/users/7200789/jethedba"}, "edited": false, "score": 0, "creation_date": 1552574629, "post_id": 55150899, "comment_id": 97069971, "body": "Thanks for the answer.  The actual program does not contain errno at all.  I added that to troubleshoot.  The main problem is that system(cmd) runs whatever is in &quot;cmd&quot; successfully, but ALWAYS returns a -1.  Even system() by itself returns a -1."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 63, "user_id": 7200789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5501584823bc13326bfc20d7d0e5fb1c?s=128&d=identicon&r=PG&f=1", "display_name": "JEtheDBA", "link": "https://stackoverflow.com/users/7200789/jethedba"}, "edited": false, "score": 0, "creation_date": 1552577262, "post_id": 55150899, "comment_id": 97071941, "body": "@JEtheDBA I can think of a reason why this might be happening, but I really need to see a <i>complete test program</i> that reproduces the phenomenon (<code>system(cmd)</code> always returns -1) before I can tell you any more."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 63, "user_id": 7200789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5501584823bc13326bfc20d7d0e5fb1c?s=128&d=identicon&r=PG&f=1", "display_name": "JEtheDBA", "link": "https://stackoverflow.com/users/7200789/jethedba"}, "edited": false, "score": 1, "creation_date": 1552577339, "post_id": 55150899, "comment_id": 97071995, "body": "@JEtheDBA Actually, one more thing: When constructing the complete test program, pay attention to whether or not your full program installs any signal handlers, and if so, exactly how it does that."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 5, "last_activity_date": 1552578460, "last_edit_date": 1552578460, "creation_date": 1552509772, "answer_id": 55150899, "question_id": 55150189, "link": "https://stackoverflow.com/questions/55150189/linux-system-returns-1-errno-10-no-child-processes/55150899#55150899", "title": "Linux system() returns -1, ERRNO = 10 No child processes", "body": "<p>The value &minus;1 can only be returned by <code>system</code> if initial creation of a child process (via <code>fork</code>) or collection of its exit status (via <code>wait</code>) fails.  Neither of these things can happen because of a problem with the command passed to <code>system</code>, because the command is interpreted in the child process.  Problems with the command will show up as <code>system</code> returning a value <code>s</code> that is not equal to either 0 or &minus;1, and for which either <code>WIFEXITED(s) &amp;&amp; WEXITSTATUS(s) != 0</code> or <code>WIFSIGNALED(s)</code> is true.  (The macros <code>WIFEXITED</code>, <code>WIFSIGNALED</code>, and <code>WEXITSTATUS</code> are defined in <code>sys/wait.h</code>.)  (See <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/system.html\" rel=\"nofollow noreferrer\">the POSIX specification for <code>system</code></a> to understand why this happens.)</p>\n\n<p><code>fork</code> failures typically only happen because of system-wide resource exhaustion and/or severe imposed resource quotas.  For instance, this program prints</p>\n\n<pre><code>true: status=-1 errno=11 (Resource temporarily unavailable)\n</code></pre>\n\n<p>when I run it.</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/resource.h&gt;\n\nint main(void)\n{\n  struct rlimit rl;\n  rl.rlim_cur = 1;\n  rl.rlim_max = 1;\n  setrlimit(RLIMIT_NPROC, &amp;rl);\n\n  int status = system(\"true\");\n  printf(\"true: status=%d errno=%d (%s)\\n\", status, errno, strerror(errno));\n  return 0;\n}\n</code></pre>\n\n<p>A <code>wait</code> failure inside <code>system</code> could happen if you have a SIGCHLD handler that steals the wait status.  For instance, this program prints</p>\n\n<pre><code>true: status=-1 errno=10 (No child processes)\n</code></pre>\n\n<p>when I run it.  (There are several other ways in which a SIGCHLD handler could interfere with <code>system</code>; this is just the shortest demo program I could think of.)</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;signal.h&gt;\n\nint main(void)\n{\n  signal(SIGCHLD, SIG_IGN);\n\n  int status = system(\"true\");\n  printf(\"true: status=%d errno=%d (%s)\\n\", status, errno, strerror(errno));\n  return 0;\n}\n</code></pre>\n\n<p>You said that whatever command you pass to <code>system</code> does execute correctly but <code>system</code> nonetheless returns &minus;1, and that makes me think your problem is due to a bad interaction between <code>wait</code> and a <code>SIGCHLD</code> handler.  Getting \"No child processes\" (<code>ECHILD</code>) in <code>errno</code> is consistent with this hypothesis, because <code>wait</code> is documented to produce that error code, and <code>fork</code> isn't.  But it's just a hypothesis.  To diagnose your problem any better than this, we need to see a <em>complete</em> test program that we can compile and run for ourselves and observe the exact same failure condition that you are.  Please read and follow the instructions at <a href=\"https://stackoverflow.com/help/mcve\">https://stackoverflow.com/help/mcve</a> .</p>\n"}], "owner": {"reputation": 63, "user_id": 7200789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5501584823bc13326bfc20d7d0e5fb1c?s=128&d=identicon&r=PG&f=1", "display_name": "JEtheDBA", "link": "https://stackoverflow.com/users/7200789/jethedba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3232, "favorite_count": 0, "closed_date": 1553299470, "answer_count": 1, "score": 2, "last_activity_date": 1554737598, "creation_date": 1552506740, "last_edit_date": 1554737598, "question_id": 55150189, "link": "https://stackoverflow.com/questions/55150189/linux-system-returns-1-errno-10-no-child-processes", "closed_reason": "Not suitable for this site", "title": "Linux system() returns -1, ERRNO = 10 No child processes", "body": "<p>When I run the following C code in RHEL 7.4:</p>\n\n<pre><code>errno = 0;\n\nstatus = system(\"ls &gt;&gt; /tmp/test.txt\");\nsprintf(msg, \"Value of errno: %d\\n\", errno);\nsprintf(msg, \"Status: %d \", status);\nos_log_msg(msg);\n</code></pre>\n\n<p>I get return code of -1 and errno = 10 (No child processes).  The /tmp/test.txt file is actually created, so it works, but the program sees a non-zero return code and exits.</p>\n\n<p>The thing is that this command returned a 0 in HP-UX 11.11, but we migrated to RHEL 7.4 and now we get -1.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1552505785, "post_id": 55149919, "comment_id": 97040230, "body": "You will want to look at <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\"><b>Why is while ( !feof (file) ) always wrong?</b></a> and <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why gets() is so dangerous it should never be used!</a>"}, {"owner": {"reputation": 135, "user_id": 11192290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tGH9zj1nnxU/AAAAAAAAAAI/AAAAAAAAALM/BSYluOgEa54/photo.jpg?sz=128", "display_name": "Andreea Elena", "link": "https://stackoverflow.com/users/11192290/andreea-elena"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552506364, "post_id": 55149919, "comment_id": 97040507, "body": "The professor from my course always use !feof(file) and the code works always perfectly , also the gets(). I don&#39;t think that this is the problem."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552506695, "post_id": 55149919, "comment_id": 97040642, "body": "Well prof and you have not looked carefully enough: the last data is likely to be repeated if you don&#39;t check (and act on) the return value from <code>fread</code>. But in this case you do check <code>feof</code> before acting on the read."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1552507380, "post_id": 55149919, "comment_id": 97040965, "body": "@AndreeaElena even I redirect stdin  (e.g. <code>.&#47;a.out &lt; file</code>)  feof() is never true in creare_fisier() ... but of course gets does nothing, and raport.txt is just explosing my disk never finishing to grow"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1552507516, "post_id": 55149919, "comment_id": 97041021, "body": "@AndreeaElena Many professors are not real programmers, and they pass on many common errors like this, and we have to fix students like you."}, {"owner": {"reputation": 135, "user_id": 11192290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tGH9zj1nnxU/AAAAAAAAAAI/AAAAAAAAALM/BSYluOgEa54/photo.jpg?sz=128", "display_name": "Andreea Elena", "link": "https://stackoverflow.com/users/11192290/andreea-elena"}, "edited": false, "score": 0, "creation_date": 1552507843, "post_id": 55149919, "comment_id": 97041177, "body": "So instead to ease my work, the professor makes it more difficult :)) yey . That&#39;s why I&#39;m really struggling in doing these homeworks :(("}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1552509211, "post_id": 55149919, "comment_id": 97041808, "body": "@AndreeaElena: maybe, but don&#39;t get into the habit of blaming your educator exclusively. CS courses still need hard work on the part of students (i.e. students should not seek for others to do their work for them)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1552509410, "post_id": 55149919, "comment_id": 97041892, "body": "Uh, I now see you used <code>feof</code> twice. The usage in <code>creare_fisier()</code> is incorrect, but the usage in <code>afisare_fisier()</code> is like it was intended to be used. Still, you should check the returned status value of the input functions."}, {"owner": {"reputation": 135, "user_id": 11192290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tGH9zj1nnxU/AAAAAAAAAAI/AAAAAAAAALM/BSYluOgEa54/photo.jpg?sz=128", "display_name": "Andreea Elena", "link": "https://stackoverflow.com/users/11192290/andreea-elena"}, "reply_to_user": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 1, "creation_date": 1552509971, "post_id": 55149919, "comment_id": 97042144, "body": "@halfer , thank you for your advices"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1552511255, "post_id": 55149919, "comment_id": 97042750, "body": "@AndreeaElena I added more remarks in my answer since you accepted it, they can interest you, reread my answer"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552524798, "post_id": 55149919, "comment_id": 97046969, "body": "the function: <code>gets()</code> has been depreciated for years and completely removed from the  more recent versions of the C language.  I.E. Your compiler should have told you this.  Suggest using <code>fgets()</code> instead ( read the MAN page for <code>fgets()</code> as the parameters are different than those for <code>gets()</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552524966, "post_id": 55149919, "comment_id": 97047022, "body": "The function: <code>main()</code> only has two valid signatures: <code>int main( void )</code> and <code>int main( int argc, char *argv[] )</code>  Notice that they all have a return type of <code>int</code>.  Not <code>void</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552525151, "post_id": 55149919, "comment_id": 97047074, "body": "OT: regarding: <code>printf(&quot;Eroare&quot;);</code>  1) Error messages should be output to <code>stderr</code>, not <code>stdout</code> 2) when the error is from a C library function should also output (to stderr) the text reason the system thinks the error occurred.  Suggest calling <code>perror()</code> as that performs both outputs to <code>stderr</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552525229, "post_id": 55149919, "comment_id": 97047094, "body": "OT: regarding: <code>fopen_s(&amp;g, nume, &quot;w&quot;);</code>  ALWAYS check (!=NULL) the returned value to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552525482, "post_id": 55149919, "comment_id": 97047155, "body": "regarding: <code>fread(&amp;f, sizeof(FLOARE), 1, g);     while (!feof(h)) {         fprintf(g, &quot;%d %s %s %f&quot;, f.codf, f.floare, f.culoare, f.pret);         fread(&amp;f, sizeof(FLOARE), 1, g);</code>  Much much better to use the returned value from <code>fread()</code> to control the loop, similar to: `    while( fread(&amp;f, sizeof(FLOARE), 1, g) == 1)     {         fprintf(g, &quot;%d %s %s %f&quot;, f.codf, f.floare, f.culoare, f.pret);     }`  and since this is outputting a text file, suggest appending a &#39;\\n&#39; to the end of the format string  I.E. &quot;%d %s %s %f\\n&quot;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552525676, "post_id": 55149919, "comment_id": 97047189, "body": "OT: for ease of readability and understanding:  1) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>  2) please consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552525978, "post_id": 55149919, "comment_id": 97047261, "body": "OT: the function: <code>scanf_s()</code> returns the number of input format specifiers successfully read.  Code should ALWAYS  check that returned value to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552526125, "post_id": 55149919, "comment_id": 97047305, "body": "OT: regarding: <code>typedef struct {   char floare[40];   char culoare[30];   float pret;   int codf; }FLOARE;</code>   1) should always include a &#39;tag&#39; name because that is what most debuggers use to enable displaying the contents of the individual fields.  2) for flexability (and other reasons) should separate the definition of the struct from a typedef for that struct"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 2, "last_activity_date": 1552511883, "last_edit_date": 1552511883, "creation_date": 1552506647, "answer_id": 55150160, "question_id": 55149919, "link": "https://stackoverflow.com/questions/55149919/how-to-write-a-subprogram-to-read-from-a-binary-file-and-write-in-a-text-file/55150160#55150160", "title": "How to write a subprogram to read from a binary file and write in a text file?", "body": "<blockquote>\n  <p>When I run the code it's not happening anything and the space occupied by the text file is growing as I keep open the console.</p>\n</blockquote>\n\n<p>This is because you use <em>feof</em> and you mix <em>gets</em> and <em>scanf</em></p>\n\n<p>Note you also (try to) read in <em>g</em> rather than in <em>h</em> in <code>afisare_fisier</code></p>\n\n<p>Here a proposal :</p>\n\n<p>I always use <em>fgets</em> to read on <em>stdin</em>, first because that allows to indicate the max size to read while <em>gets</em> can overflow the received buffer, and to not have to do a <em>getchar()</em> or equivalent in the hope to bypass a newline etc. </p>\n\n<p>The newline are part of the read strings so in fields <em>floare</em> and <em>culoare</em>, probably you have to remove them.</p>\n\n<p>In case <em>floare</em> and <em>culoare</em> are words and do not contain space(s) you can replace the <em>fgets</em> (+ <em>sscanf</em>) by <em>fscanf</em> to not have the newlines in <em>floare</em> and <em>culoare</em> (do not forget to indicate the max size when you <em>fscanf</em> a string).</p>\n\n<p>Note that using the result of <em>fgets</em> to detect EOF (rather than <em>feof</em>) I do not have to put it two times in the source.</p>\n\n<p>I added the check all time a file is open</p>\n\n<p>I give the name of the two files in argument to <code>afisare_fisier</code> because there is no reason that one knows the name of the input file.</p>\n\n<p>Because <em>EOF</em> is not easy from stdin I also stop to read when it is not possible to <em>sscanf</em> the <em>Cod floare</em>, that allows to terminate on an empty line (the user just hit <code>&lt;enter&gt;</code> without digit before)</p>\n\n<pre><code>typedef struct {\n  char floare[40];\n  char culoare[30];\n  float pret;\n  int codf;\n}FLOARE;\n\n\nvoid creare_fisier(char*nume) {\n  FILE*g;\n  FLOARE f;\n  fopen_s(&amp;g, nume, \"wb\");\n  if (!g)\n    printf(\"Eroare\");\n  else\n  {\n    char s[32];\n\n    for (;;) {\n      printf(\"Cod floare:\");\n      if ((fgets(s, sizeof(s), stdin) == NULL) ||\n          (sscanf(s, \"%d\", &amp;f.codf) != 1))\n        break;\n      printf(\"Nume floare:\"); \n      if (fgets(f.floare, sizeof(f.floare), stdin) == NULL)\n        break;\n      printf(\"Culoare floare:\"); \n      if (fgets(f.culoare, sizeof(f.culoare), stdin) == NULL)\n        break;\n      printf(\"Pret:\");\n      if ((fgets(s, sizeof(s), stdin) == NULL) ||\n          (sscanf(s, \"%f\", &amp;f.pret) != 1))\n        break;\n      fwrite(&amp;f, sizeof(f), 1, g);\n    }\n    fclose(g);\n  }\n}\n\nvoid afisare_fisier(char * in, char * out) {\n  FILE*h;\n  FLOARE f;\n  fopen_s(&amp;h, in, \"rb\");\n  if (!h)\n    printf(\"Eroare (in)\");\n  else {\n    FILE*g;\n    fopen_s(&amp;g, out, \"w\");\n    if (!g)\n      printf(\"Eroare (out)\");\n    else {\n      while (fread(&amp;f, sizeof(f), 1, h) == 1) { /* read in h, not in g */\n        fprintf(g, \"%d %s %s %f\\n\", f.codf, f.floare, f.culoare, f.pret);\n      }\n      fclose(g);\n    }\n    fclose(h);\n  }\n}\n\nint main() {\n  char numef[] = \"lista.dat\";\n  creare_fisier(numef);\n  char numetxt[] = \"raport.txt\";\n  afisare_fisier(numef, numetxt);\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -g -pedantic -Wextra f.c\npi@raspberrypi:/tmp $ ./a.out\nCod floare:123\nNume floare:nume1\nCuloare floare:culoare1\nPret:12.34\nCod floare:456\nNume floare:nume2\nCuloare floare:culoare2\nPret:21.4\nCod floare:\npi@raspberrypi:/tmp $ cat raport.txt\n123 nume1\n culoare1\n 12.340000\n456 nume2\n culoare2\n 21.400000\n</code></pre>\n\n<p>Note : I hit <code>&lt;enter&gt;</code> when the third <em>Cod floare</em> was requested</p>\n"}], "owner": {"reputation": 135, "user_id": 11192290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tGH9zj1nnxU/AAAAAAAAAAI/AAAAAAAAALM/BSYluOgEa54/photo.jpg?sz=128", "display_name": "Andreea Elena", "link": "https://stackoverflow.com/users/11192290/andreea-elena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 55150160, "answer_count": 1, "score": 2, "last_activity_date": 1552511883, "creation_date": 1552505608, "last_edit_date": 1552509111, "question_id": 55149919, "link": "https://stackoverflow.com/questions/55149919/how-to-write-a-subprogram-to-read-from-a-binary-file-and-write-in-a-text-file", "title": "How to write a subprogram to read from a binary file and write in a text file?", "body": "<pre><code>#include&lt;stdio.h&gt;\n\ntypedef struct {\n  char floare[40];\n  char culoare[30];\n  float pret;\n  int codf;\n}FLOARE;\n\n\nvoid creare_fisier(char*nume) {\n  FILE*g;\n  FLOARE f;\n  fopen_s(&amp;g, nume, \"wb\");\n  if (!g)\n    printf(\"Eroare\");\n  else\n  {\n    printf(\"Cod floare:\"); scanf_s(\"%d\", &amp;f.codf);\n    while (!feof(stdin)) {\n        getchar();\n        printf(\"Nume floare:\"); gets(f.floare);\n        printf(\"Culoare floare:\"); gets(f.culoare);\n        printf(\"Pret:\"); scanf_s(\"%f\", &amp;f.pret);\n        fwrite(&amp;f, sizeof(FLOARE), 1, g);\n        printf(\"Cod floare:\"); scanf_s(\"%d\", &amp;f.codf);\n    }\n    fclose(g);\n  }\n}\n\nvoid afisare_fisier(char*nume) {\n  FILE*h;\n  FLOARE f;\n  fopen_s(&amp;h, \"lista.dat\", \"rb\");\n  if (!h)\n    printf(\"Eroare\");\n  else {\n    FILE*g;\n    fopen_s(&amp;g, nume, \"w\");\n    fread(&amp;f, sizeof(FLOARE), 1, g);\n    while (!feof(h)) {\n        fprintf(g, \"%d %s %s %f\", f.codf, f.floare, f.culoare, f.pret);\n        fread(&amp;f, sizeof(FLOARE), 1, g);\n    }\n    fclose(g), fclose(h);\n  }\n}\n\nvoid main() {\n  char numef[] = \"lista.dat\";\n  creare_fisier(numef);\n  char numetxt[] = \"raport.txt\";\n  afisare_fisier(numetxt);\n}\n</code></pre>\n\n<p>The subprogram which creates  the binary file is working, but the listing of the information into a text file is not working. When I run the code it's not happening anything and the space occupied by the text file is growing as I keep open the console. I don't really have experience with the subprograms, but I know the structure of listing into a text file.</p>\n\n<p>This is for a homework task.</p>\n"}, {"tags": ["c", "arrays", "pointers", "casting", "explain"], "answers": [{"comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1552505555, "post_id": 55149768, "comment_id": 97040107, "body": "It&#39;s legal. <code>char *</code> is a specific exception to the strict aliasing rules."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1552505680, "post_id": 55149768, "comment_id": 97040174, "body": "@user2357112 The hesitance I have is more going back <i>from</i> the <code>char *</code> to <code>short *</code>.  If you increment that <code>char *</code> in such a way that it does not meet <code>short</code> alignment requirements, you&#39;re asking for trouble."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1552506355, "post_id": 55149768, "comment_id": 97040502, "body": "(Come to think of it, strict aliasing probably isn&#39;t the right rule, since there&#39;s no value access through the <code>char *</code> here. I don&#39;t remember which rule or rules define the behavior involved here. Page 84, footnote 91 in the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf\" rel=\"nofollow noreferrer\">N1256 draft</a> talks about pointer arithmetic being equivalent to casting to <code>char *</code>, doing the math there, and casting back, but I don&#39;t think that&#39;s normative, and I don&#39;t know where to find all the separate normative pieces that combine to say this is okay.)"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1552508729, "post_id": 55149768, "comment_id": 97041599, "body": "@user2357112  Yeah, that&#39;s why I left it as an uncertainty in the legality of it.  Suffice to say, I wouldn&#39;t ever want to commit code like this.  Even if it does happen to be technically legal; I&#39;d rather not play with fire when there are better options."}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 1, "last_activity_date": 1552505314, "last_edit_date": 1552505314, "creation_date": 1552505008, "answer_id": 55149768, "question_id": 55149719, "link": "https://stackoverflow.com/questions/55149719/i-need-detailed-explaination-on-why-the-pointer-is-pointing-on-a2-because-i-do/55149768#55149768", "title": "I need detailed explaination on why the pointer is pointing on a[2] because I don&#39;t understand and I thought it pointed to a[4]", "body": "<p><code>a</code> is an array of <code>short</code>, which is probably two bytes on your system.  You increment a <code>char *</code> to that array by 4, so you move forward by 4 bytes.  Since the elements of the array are two bytes each, moving forward two bytes is the equivalent of moving forward two elements.</p>\n\n<p>I'm not certain if your code is strictly legal as you are aliasing this <code>char *</code> with a <code>short *</code>.  It may be technically legal as the underlying element is effectively a <code>short</code>, but if you had incremented your <code>char *</code> by an odd amount and then cast that to a <code>short *</code>, now you're making an unaligned access.</p>\n"}], "owner": {"reputation": 59, "user_id": 10651588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565799a0f72edbb3fbff0e6b088ad97b?s=128&d=identicon&r=PG&f=1", "display_name": "Youssef Hussein", "link": "https://stackoverflow.com/users/10651588/youssef-hussein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552505314, "creation_date": 1552504800, "question_id": 55149719, "link": "https://stackoverflow.com/questions/55149719/i-need-detailed-explaination-on-why-the-pointer-is-pointing-on-a2-because-i-do", "title": "I need detailed explaination on why the pointer is pointing on a[2] because I don&#39;t understand and I thought it pointed to a[4]", "body": "<p>I don't get why pshrt after the last line points at a[2], can someone explain in details please?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nvoid main ()\n{\n    short a[10],*pshrt,shrt;\n    char *pchar;\n    int i;\n    for (i=0;i&lt;10;i++)\n        a[i]=rand();\n    //show\n    for (i=0;i&lt;10;i++)\n    {\n        printf(\"%d\\t\",a[i]);\n    }\n    printf(\"\\n\\n\");\n    pchar = (char*)a;\n    pshrt = (short*)(pchar+4);\n    printf(\"%d\",*pshrt);\n}\n</code></pre>\n"}, {"tags": ["c", "bash", "sh"], "comments": [{"owner": {"reputation": 551, "user_id": 6142154, "user_type": "registered", "profile_image": "https://graph.facebook.com/580882669/picture?type=large", "display_name": "Ulises Andr&#233; Fierro", "link": "https://stackoverflow.com/users/6142154/ulises-andr%c3%a9-fierro"}, "edited": false, "score": 1, "creation_date": 1552505518, "post_id": 55149692, "comment_id": 97040087, "body": "Try int rc = system (&quot;/home/username/bin/somescript.sh&quot;); where you use an absolute path to your script. Also, make sure the shebang on the shell script is correct."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1552507367, "post_id": 55149692, "comment_id": 97040960, "body": "A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, giving us enough detail to produce the problem ourselves, might include details such as what directory your C program is in, what directory you invoke the C program <i>from</i>, what command you use for that invocation, whether your <code>matrix.sh</code> is flagged executable and whether it has a valid shebang, etc."}], "answers": [{"comments": [{"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1552506840, "post_id": 55150069, "comment_id": 97040724, "body": "Better to suggest <code>&amp;&amp;</code> rather than <code>;</code> to separate a <code>cd</code> and the command anticipated to be run in that directory, so your failure mode doesn&#39;t involve running the command in the <i>wrong</i> directory."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1552506941, "post_id": 55150069, "comment_id": 97040774, "body": "Good advice, @CharlesDuffy.  Updated."}, {"owner": {"reputation": 11, "user_id": 10633411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wAo4Fl4CKns/AAAAAAAAAAI/AAAAAAAAAAA/8gGryo-k6Yc/photo.jpg?sz=128", "display_name": "Jaya Lakshmi", "link": "https://stackoverflow.com/users/10633411/jaya-lakshmi"}, "edited": false, "score": 0, "creation_date": 1552637863, "post_id": 55150069, "comment_id": 97094366, "body": "Thank you very much for the detailed answer. I again tried the possible methods suggested by you. Unfortunately, the same error was being shown. I think the problem lies somewhere else. Thanks"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1552506872, "last_edit_date": 1552506872, "creation_date": 1552506225, "answer_id": 55150069, "question_id": 55149692, "link": "https://stackoverflow.com/questions/55149692/cause-of-sh-1-file-not-found-error-with-system-command-tried-possible-soluti/55150069#55150069", "title": "Cause of sh: 1 file not found error with system() command? Tried possible solutions in StackOverflow (listed below) but failed", "body": "<p>Supposing that an absolute pathname for the script you want to execute is <code>/path/to/matrix.sh</code>, and that it is executable by name from the command line, a variation that will work is</p>\n\n<pre><code>system(\"/path/to/matrix.sh\");\n</code></pre>\n\n<p>To avoid the second warning you should capture the return value as well, and verify that it does not indicate an error (by being -1).</p>\n\n<p>As for your attempts:</p>\n\n<blockquote>\n  <p>1) system(\"./matrix.sh\")</p>\n</blockquote>\n\n<p>This depends on <code>matrix.sh</code> being present in the current working directory (which may or may not be the one containing the C program).  That's what the \"./\" part means.</p>\n\n<blockquote>\n  <p>2) int ret=system(\"./matrix.sh\")</p>\n</blockquote>\n\n<p>Same as the previous, only here you catch the error code.  <em>The shell</em> will likely have emitted an error message, but that's not observable by the program.  The program can use the value of <code>ret</code> to determine whether the script was successfully launched and if so, what its exit code was.</p>\n\n<blockquote>\n  <p>3) system(\"cd /path/to/matrix.sh; ./matrix.sh &amp;\")</p>\n</blockquote>\n\n<p>The \"cd /path/to/matrix.sh\" part is wrong because <code>matrix.sh</code> is not a directory.  Additionally, it's unclear why you are using the <code>&amp;</code> operator to execute the script in the background.  This variation ought to work, however:</p>\n\n<pre><code>system(\"cd /path/to &amp;&amp; ./matrix.sh\");\n</code></pre>\n\n<p>That might make sense to do if the script (unwisely) depends on using relative paths to locate other files installed near it, and it will fail without trying to execute the (possibly wrong) script if it does not succeed in changing the working directory.</p>\n\n<blockquote>\n  <p>4) system(\"./matrix.sh>> outputfilename\")</p>\n</blockquote>\n\n<p>This has the same issue as (1) and (2).  Redirecting the standard output does not resolve it.  You could probably suppress the error message by redirecting standard error instead of standard output (\"./matrix.sh 2> /dev/null\"), but that by itself would not solve the main problem.</p>\n\n<blockquote>\n  <p>5) system(\"Path/to/matrisx.sh\")</p>\n</blockquote>\n\n<p>That's almost it, but (1) file and directory names are case-sensitive to <code>bash</code>, and <code>Path</code> is not the same as <code>path</code>, but more importantly, (2) without a leading <code>/</code> character, \"Path/to/matrisx.sh\" is still interpreted relative to the current working directory.</p>\n\n<blockquote>\n  <p>6) system(\"bash/Path/to/matrix.sh\")</p>\n</blockquote>\n\n<p>That could almost work, too, if the path were correct, but you need at least one space character between \"bash\" and the path to the script.</p>\n\n<pre><code>system(\"bash /path/to/matrix.sh\");\n</code></pre>\n\n<p>That variation does introduce an extra level of shell, however, which is a needless inefficiency unless the script you're naming is not directly executable.</p>\n"}], "owner": {"reputation": 11, "user_id": 10633411, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wAo4Fl4CKns/AAAAAAAAAAI/AAAAAAAAAAA/8gGryo-k6Yc/photo.jpg?sz=128", "display_name": "Jaya Lakshmi", "link": "https://stackoverflow.com/users/10633411/jaya-lakshmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1397, "favorite_count": 0, "closed_date": 1552506711, "answer_count": 1, "score": 0, "last_activity_date": 1552506872, "creation_date": 1552504692, "question_id": 55149692, "link": "https://stackoverflow.com/questions/55149692/cause-of-sh-1-file-not-found-error-with-system-command-tried-possible-soluti", "closed_reason": "Duplicate", "title": "Cause of sh: 1 file not found error with system() command? Tried possible solutions in StackOverflow (listed below) but failed", "body": "<p>Based on the answers in StackOverflow, I used system command in a C program to invoke matrix.sh in the following possible ways:</p>\n\n<p>1)    system(\"./matrix.sh\") </p>\n\n<p>2)    int ret=system(\"./matrix.sh\") </p>\n\n<p>3)    system(\"cd /path/to/matrix.sh; ./matrix.sh &amp;\") </p>\n\n<p>4)    system(\"./matrix.sh>> outputfilename\") </p>\n\n<p>5)    system(\"Path/to/matrisx.sh\")</p>\n\n<p>6)    system(\"bash/Path/to/matrix.sh\")</p>\n\n<p>and a few others. But all of these give the SAME error. sh:1: Matrix.sh not found and another error (except in 2nd case) as\n warning: ignoring return value of 'system', declared with attribute warn_unused_result [-Wunused-result]</p>\n\n<p>The paths of the invoking C program and the [input .sh script, expected output file] are different. How to write the system() command in this situation? What is the cause of this error?</p>\n"}, {"tags": ["c", "bit-shift"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 3, "creation_date": 1552504598, "post_id": 55149462, "comment_id": 97039684, "body": "<a href=\"//stackoverflow.com/q/10134805\">Bitwise rotate left function</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552522053, "post_id": 55149628, "comment_id": 97046285, "body": "@chux  I assumed key is unsigned because OP is declaring <code>a</code> as unsigned, but you are completely right. Thanks for pointing this fact."}], "tags": [], "owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "is_accepted": true, "score": 1, "last_activity_date": 1552522185, "last_edit_date": 1552522185, "creation_date": 1552504422, "answer_id": 55149628, "question_id": 55149462, "link": "https://stackoverflow.com/questions/55149462/how-to-replace-the-the-least-significant-bit-lsb-with-most-significant-bit-ms/55149628#55149628", "title": "How to replace the the least significant bit (LSB) with most significant bit (MSB) in C", "body": "<p>Assuming <code>key</code> is also of type <code>uint32_t</code>, you can try this</p>\n\n<pre><code>  for (int i = 0; i &lt; 5; i++)\n{\n   uint32_t a = key &gt;&gt; 31;  //convert MSB to LSB\n   key &lt;&lt;= 1; // shift key 1 bit to the left, (discarding current MSB) making space for new LSB\n   key |= a;  // append LSB\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552518760, "post_id": 55149935, "comment_id": 97045444, "body": "&quot;Since you are using an <code>unsigned int</code>&quot; --&gt; the sign-ness of <code>key</code> is not given.  Hopefully it is."}, {"owner": {"reputation": 1789, "user_id": 3980968, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/FXI47.jpg?s=128&g=1", "display_name": "BlueStrat", "link": "https://stackoverflow.com/users/3980968/bluestrat"}, "edited": false, "score": 2, "creation_date": 1552522374, "post_id": 55149935, "comment_id": 97046374, "body": "Better explanation than mine and good remarks regarding how key is confusing."}], "tags": [], "owner": {"reputation": 3054, "user_id": 193848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HWieK.jpg?s=128&g=1", "display_name": "Andrew Cottrell", "link": "https://stackoverflow.com/users/193848/andrew-cottrell"}, "is_accepted": false, "score": 1, "last_activity_date": 1552505644, "creation_date": 1552505644, "answer_id": 55149935, "question_id": 55149462, "link": "https://stackoverflow.com/questions/55149462/how-to-replace-the-the-least-significant-bit-lsb-with-most-significant-bit-ms/55149935#55149935", "title": "How to replace the the least significant bit (LSB) with most significant bit (MSB) in C", "body": "<p>Looks like you already accepted an answer, but I'm gonna give you a little more feedback to hopefully help you on your way.  You've got a couple problems:</p>\n\n<p>First, your example key 11110000 is confusing.  Is that binary or hex?  Binary 0b11110000 is an 8-bit number, not a 32-bit number.  Whereas hexadecimal 0x11110000 is a 32-bit number but it probably isn't going to bitwise-shift as you might expect.  For example, 0x11110000 shifted left 1 bit becomes 0x22220000, not 0x11100001.</p>\n\n<p>Second, I see what you're trying to do by saving the MSb and trying to bitwise-OR it in later as the LSb.  But your shift amounts are wrong.  You want to bitwise-OR the value into bit 0, not bit 1.  So your shift amount would be &lt;&lt; 0, not &lt;&lt; 1.  Since &lt;&lt; 0 is essentially a no-op you can just leave it off.</p>\n\n<p>Here are some minor changes to your code that should make things right.  I've added comments to hopefully describe what I changed.</p>\n\n<pre><code>for (int i = 0; i &lt; 5; i++)\n{\n\n    //uint32_t a = (1 &lt;&lt; 31) &amp; key;\n    // This shifts key 31 bits to the right, with the result being\n    // bit31 becomes bit0.  Since you are using an unsigned int,\n    // all the upper bits will be 0.\n    uint32_t bit0 = key &gt;&gt; 31;\n\n    key = (key &lt;&lt; 1);\n\n    // This step is unnecessary and also incorrect.  I believe you\n    // are trying to zero out bit0.  The bitwise shift left (above) will have\n    // shifted in a zero already.\n    //key &amp;= ~(1 &lt;&lt; 1);\n\n    // Now bitwise-OR in bit0.\n    //key |= (a &lt;&lt; 1);\n    key |= bit0;\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11133203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xqg10.jpg?s=128&g=1", "display_name": "L0KiZ", "link": "https://stackoverflow.com/users/11133203/l0kiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1360, "favorite_count": 0, "accepted_answer_id": 55149628, "answer_count": 2, "score": 0, "last_activity_date": 1552522185, "creation_date": 1552503751, "last_edit_date": 1552510284, "question_id": 55149462, "link": "https://stackoverflow.com/questions/55149462/how-to-replace-the-the-least-significant-bit-lsb-with-most-significant-bit-ms", "title": "How to replace the the least significant bit (LSB) with most significant bit (MSB) in C", "body": "<p>I have just started c-programming and I have a problem to replace the least significant bit (LSB) with the most significant bit (MSB). </p>\n\n<p>For example, the first key (key is 32 bit) is 11110000, and after the transformation, it would be 11100001, and then 11000011, and then 10000111, 00001111, 00011110 and so on.</p>\n\n<p>Here is my code that I have tried:</p>\n\n<pre><code>for (int i = 0; i &lt; 5; i++)\n{\n    uint32_t a = (1 &lt;&lt; 31) &amp; key;\n\n    key = (key &lt;&lt; 1);\n    key &amp;= ~(1 &lt;&lt; 1);\n    key |= (a &lt;&lt; 1);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "dynamic"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552504800, "post_id": 55149417, "comment_id": 97039777, "body": "You will want to review: <a href=\"http://stackoverflow.com/questions/750178/is-it-a-good-idea-to-typedef-pointers\">Is it a good idea to <b>typedef</b> pointers?</a>."}, {"owner": {"reputation": 404, "user_id": 10485803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7c4b92d7ae60dd2b5566a365111bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Jae Yang", "link": "https://stackoverflow.com/users/10485803/jae-yang"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552505571, "post_id": 55149417, "comment_id": 97040120, "body": "I wanted to use Vector as a pointer because I just wanted this to be a generic library class I can use without worrying about the internal representation. Was this not the appropriate idea?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552505686, "post_id": 55149417, "comment_id": 97040179, "body": "That makes sense, its just a pointer to type for hiding."}], "answers": [{"comments": [{"owner": {"reputation": 404, "user_id": 10485803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7c4b92d7ae60dd2b5566a365111bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Jae Yang", "link": "https://stackoverflow.com/users/10485803/jae-yang"}, "edited": false, "score": 0, "creation_date": 1552504284, "post_id": 55149519, "comment_id": 97039536, "body": "Thanks for this, i didn&#39;t realize I was referencing the same i variable."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": true, "score": 1, "last_activity_date": 1552504011, "creation_date": 1552504011, "answer_id": 55149519, "question_id": 55149417, "link": "https://stackoverflow.com/questions/55149417/generic-dynamic-array-not-updating-properties-correctly/55149519#55149519", "title": "Generic Dynamic Array not updating properties correctly", "body": "<p>You store pointers in your vector and not values. In the loop</p>\n\n<pre><code>for(int i=0; i&lt;10; i++){\n    vector_add(v, 0, (void *)&amp;i);\n}\n</code></pre>\n\n<p>you store 10 times the address of the same <code>i</code> variable.</p>\n\n<p>Change the design if you want to store values instead.</p>\n"}], "owner": {"reputation": 404, "user_id": 10485803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e7c4b92d7ae60dd2b5566a365111bdc?s=128&d=identicon&r=PG&f=1", "display_name": "Jae Yang", "link": "https://stackoverflow.com/users/10485803/jae-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 55149519, "answer_count": 1, "score": 0, "last_activity_date": 1552504011, "creation_date": 1552503523, "question_id": 55149417, "link": "https://stackoverflow.com/questions/55149417/generic-dynamic-array-not-updating-properties-correctly", "title": "Generic Dynamic Array not updating properties correctly", "body": "<p>I am creating a generic dynamic array in C. Whenever I update any value in the array, it doesn't update properly and seems to be updating everything in the array. The output of my main file is not expected. I am having trouble finding what the error is in gdb.</p>\n\n<p>My header file:</p>\n\n<pre><code>#ifndef INC_6_VECTOR_H\n#define INC_6_VECTOR_H\ntypedef struct Vector_S * Vector;\n\nVector init_Vector();\nvoid free_Vector(Vector);\nvoid vector_add(Vector, int, void *);\nvoid * vector_value(Vector, int);\n\n#endif //INC_6_VECTOR_H\n</code></pre>\n\n<p>My Source File:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include \"Vector.h\"\n\n#define STARTINGSIZE 10\n\nstruct Vector_S{\n    void **head;\n    size_t size;\n    size_t length;\n};\n\nVector init_Vector(){\n    Vector vector = malloc(sizeof(struct Vector_S));\n    vector-&gt;size = 0;\n    vector-&gt;length = STARTINGSIZE;\n    vector-&gt;head = malloc(STARTINGSIZE * sizeof(void *));\n    return vector;\n}\n\nvoid free_Vector(Vector vector){\n    free(vector-&gt;head);\n    free(vector);\n}\nvoid vector_add(Vector vector, int idx, void * data){\n    if (vector-&gt;size &gt;= vector-&gt;length){\n        size_t oldLength = vector-&gt;length;\n        void *headTemp;\n        headTemp = realloc(vector-&gt;head, 2*oldLength* sizeof(void *));\n        if (headTemp == NULL){\n            printf(\"Failed realloc\\n\");\n            exit(1);\n        }\n        vector-&gt;length = 2*oldLength;\n        vector-&gt;head = headTemp;\n    }\n    vector-&gt;head[idx] = data;\n    vector-&gt;size++;\n\n}\nvoid * vector_value(Vector vector, int idx){\n    return vector-&gt;head[idx];\n}\n</code></pre>\n\n<p>and my testing file</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"Vector.h\"\nint main(void){\n    printf(\"Main run test\\n\");\n    Vector v = init_Vector();\n    for(int i=0; i&lt;10; i++){\n        vector_add(v, 0, (void *)&amp;i);\n    }\n    for(int i=0; i&lt;10; i++){\n        printf(\"The value at %d idx is %d\\n\", i, *(int*)vector_value(v,i));\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "if-statement", "conditional-statements"], "comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 1, "creation_date": 1552502141, "post_id": 55149038, "comment_id": 97038430, "body": "if <code>puzzle[row][column]</code> values 0 the condition is false, else it is true, it a short way to write <code>if (puzzle[row][column] != 0)</code>, not != null because it is an array of <i>int</i> and null is &#39;reserved&#39; for pointer"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552502219, "post_id": 55149038, "comment_id": 97038480, "body": "Example: <code>int apples = 42; if(apples) { &#47;* will be executed *&#47; }</code>. In the second question, <code>isValid()</code> returns a non-0 value for the expression to be <code>true</code>."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1552502603, "post_id": 55149038, "comment_id": 97038689, "body": "You need to include the code fragment (or preferably, a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) in the question.  As it is, it makes no sense at all if the linked resource is unavailable.  Please <a href=\"https://stackoverflow.com/posts/55149038/edit\">edit</a> to make your question complete <i>in itself</i> (you can keep the link, but the question shouldn&#39;t <i>depend</i> on it to make sense)."}], "answers": [{"tags": [], "owner": {"reputation": 3054, "user_id": 193848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HWieK.jpg?s=128&g=1", "display_name": "Andrew Cottrell", "link": "https://stackoverflow.com/users/193848/andrew-cottrell"}, "is_accepted": false, "score": 0, "last_activity_date": 1552502337, "creation_date": 1552502337, "answer_id": 55149117, "question_id": 55149038, "link": "https://stackoverflow.com/questions/55149038/conditions-in-an-if-statement/55149117#55149117", "title": "Conditions in an if statement", "body": "<p>In C conditionals 0 is false and anything non-zero is true.  <code>puzzle</code> is a 2-dimensional array of <code>int</code>.  If the <code>int</code> is 0 then the conditional evaluates as false.  If the <code>int</code> is non-zero then the conditional evaluates as true.</p>\n"}, {"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": false, "score": 3, "last_activity_date": 1552502392, "creation_date": 1552502392, "answer_id": 55149133, "question_id": 55149038, "link": "https://stackoverflow.com/questions/55149038/conditions-in-an-if-statement/55149133#55149133", "title": "Conditions in an if statement", "body": "<p>Because, in C <code>int</code> expressions can be used in place of boolean expressions with 0 being false and anything else being true, <code>if(puzzle[row][column])</code> is an idiomatic way of writing </p>\n\n<pre><code>if(puzzle[row][column] != 0)\n</code></pre>\n\n<p>I prefer the latter because the former does seem to confuse people not familiar with the idiom.</p>\n\n<blockquote>\n  <p>If a number exists in that position it will continue? For this I would have thought to use != null</p>\n</blockquote>\n\n<p>The values in a cell are number - <code>int</code>s in fact. He uses zero as a convention for \"not filled in yet\". If the values in the array were pointers, I would agree, with <code>if(puzzle[row][column] != NULL)</code> but they aren't pointers.</p>\n"}], "owner": {"reputation": 9, "user_id": 8941205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d2acfae4997fab6b97dda729971cc70?s=128&d=identicon&r=PG&f=1", "display_name": "Cristian", "link": "https://stackoverflow.com/users/8941205/cristian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553594954, "creation_date": 1552502006, "question_id": 55149038, "link": "https://stackoverflow.com/questions/55149038/conditions-in-an-if-statement", "title": "Conditions in an if statement", "body": "<p>I'm looking through this article (<a href=\"https://spin.atomicobject.com/2012/06/18/solving-sudoku-in-c-with-recursive-backtracking/\" rel=\"nofollow noreferrer\">https://spin.atomicobject.com/2012/06/18/solving-sudoku-in-c-with-recursive-backtracking/</a>) explaining a backtracking approach to solve a sudoku puzzle in C and I had a couple of questions about conditions in if statements. </p>\n\n<p>He uses if(puzzle[row][column]), I am unsure as to what it is checking. If a number exists in that position it will continue? For this I would have thought to use != null to check that it's not empty</p>\n\n<p>He also uses a function call inside an if statement: if(isValid(nextNum, puzzle, row, column) Does this mean if the function is successful it executes what's inside the if?  </p>\n"}, {"tags": ["c", "montecarlo", "pi"], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 8705952, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3655760f5ef9fe92833603259b7a7c8?s=128&d=identicon&r=PG&f=1", "display_name": "Pengibaby", "link": "https://stackoverflow.com/users/8705952/pengibaby"}, "edited": false, "score": 0, "creation_date": 1552504597, "post_id": 55148953, "comment_id": 97039683, "body": "Thank you so much! This is my first time writing C program, so still unfamiliar with it. But this really helped! ^^"}], "tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": true, "score": 5, "last_activity_date": 1552503728, "last_edit_date": 1552503728, "creation_date": 1552501743, "answer_id": 55148953, "question_id": 55148800, "link": "https://stackoverflow.com/questions/55148800/monte-carlo-method-of-finding-pi-using-c/55148953#55148953", "title": "Monte Carlo Method of finding pi using C", "body": "<p>You need to use floating-point randomization, or otherwise to use a circle with a very big radius.</p>\n\n<p>So instead of</p>\n\n<pre><code>    randomx = (double)(rand() % (1+1-0) + 0);\n    randomy = (double)(rand() % (1+1-0) + 0);\n</code></pre>\n\n<p>you use</p>\n\n<pre><code>    randomx = rand();\n    randomy = rand();\n</code></pre>\n\n<p>and you consider if it falls inside the circle of radius RAND_MAX</p>\n\n<pre><code>   #define RMAX ((double)RAND_MAX*(double)RAND_MAX)\n   equation &lt;= RMAX;\n</code></pre>\n\n<p>You do the details.  Read <code>man 3 rand</code> to see that rand() returns integer. </p>\n"}, {"comments": [{"owner": {"reputation": 353, "user_id": 8705952, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3655760f5ef9fe92833603259b7a7c8?s=128&d=identicon&r=PG&f=1", "display_name": "Pengibaby", "link": "https://stackoverflow.com/users/8705952/pengibaby"}, "edited": false, "score": 1, "creation_date": 1552504703, "post_id": 55148958, "comment_id": 97039731, "body": "Thank you for the link, and your explanation! ^^"}], "tags": [], "owner": {"reputation": 3276, "user_id": 746547, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6iL90.jpg?s=128&g=1", "display_name": "Louen", "link": "https://stackoverflow.com/users/746547/louen"}, "is_accepted": false, "score": 3, "last_activity_date": 1552501756, "creation_date": 1552501756, "answer_id": 55148958, "question_id": 55148800, "link": "https://stackoverflow.com/questions/55148800/monte-carlo-method-of-finding-pi-using-c/55148958#55148958", "title": "Monte Carlo Method of finding pi using C", "body": "<p>Your <code>randomx</code> and <code>randomy</code> variables are constrained to  an <strong>integer</strong> value, because the <a href=\"https://en.cppreference.com/w/c/numeric/random/rand\" rel=\"nofollow noreferrer\"><code>rand()</code></a> functions returns an integer. </p>\n\n<p>See it live <a href=\"https://ideone.com/NCW7Yu\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>As a consequence, each your two variables will be either 1 or 0, so your point will be randomly one of (0,0), (1,0), (0,1), (1,1), which has a 3:4 chance of being in the circle. Hence your result of 3.</p>\n\n<p>You can look up <a href=\"https://stackoverflow.com/questions/13408990/how-to-generate-random-float-number-in-c\">How to generate random float number in C</a> if you want a random number between 0 and 1.</p>\n"}, {"comments": [{"owner": {"reputation": 353, "user_id": 8705952, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3655760f5ef9fe92833603259b7a7c8?s=128&d=identicon&r=PG&f=1", "display_name": "Pengibaby", "link": "https://stackoverflow.com/users/8705952/pengibaby"}, "edited": false, "score": 0, "creation_date": 1552504646, "post_id": 55148964, "comment_id": 97039701, "body": "Thank you so much for your explanation, this has helped me understand this a bit more! ^^"}], "tags": [], "owner": {"reputation": 323, "user_id": 10663791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7930f895c4b8d07165716fe6672be8f?s=128&d=identicon&r=PG&f=1", "display_name": "Guille", "link": "https://stackoverflow.com/users/10663791/guille"}, "is_accepted": false, "score": 6, "last_activity_date": 1552501767, "creation_date": 1552501767, "answer_id": 55148964, "question_id": 55148800, "link": "https://stackoverflow.com/questions/55148800/monte-carlo-method-of-finding-pi-using-c/55148964#55148964", "title": "Monte Carlo Method of finding pi using C", "body": "<p>It works as it should. The problem is the implementation.</p>\n\n<p>The C <code>rand()</code> function <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_rand.htm\" rel=\"noreferrer\">returns an integer</a> in the range 0 to <code>RAND_MAX</code>. The keyword there is <strong>integer</strong>.</p>\n\n<p>You then calculate the result of that integer modulo 2, which can be 0 or 1. That leaves you with 4 possible points: (0,0), (0,1), (1,0), (1,1).</p>\n\n<p>Of those 4 points, only 1 lies outside of the circle of radius 1: (1,1). That is, of out of 4 possible points, 3 lie in the circle.</p>\n\n<p>You should replace that code to use floating point values, not integers, so you calculate the proportion of points inside and outside of the circle.</p>\n"}, {"comments": [{"owner": {"reputation": 353, "user_id": 8705952, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3655760f5ef9fe92833603259b7a7c8?s=128&d=identicon&r=PG&f=1", "display_name": "Pengibaby", "link": "https://stackoverflow.com/users/8705952/pengibaby"}, "edited": false, "score": 0, "creation_date": 1552504833, "post_id": 55148996, "comment_id": 97039795, "body": "Thank you for your explanation! ^^"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1552501866, "creation_date": 1552501866, "answer_id": 55148996, "question_id": 55148800, "link": "https://stackoverflow.com/questions/55148800/monte-carlo-method-of-finding-pi-using-c/55148996#55148996", "title": "Monte Carlo Method of finding pi using C", "body": "<p>For your approach to work, you need to generate <code>double</code> values drawn from a uniform distribution on the interval [0,1] (or approximately so).  You are instead generating random integers drawn from the two-element set {0, 1}, and converting them to type <code>double</code>.  This does not yield anything remotely like the distribution you need for your purposes.</p>\n"}, {"tags": [], "owner": {"reputation": 35454, "user_id": 1366871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3ec9d9128a25ba6eae8a1d42c2eb04a?s=128&d=identicon&r=PG", "display_name": "dreamcrash", "link": "https://stackoverflow.com/users/1366871/dreamcrash"}, "is_accepted": false, "score": 0, "last_activity_date": 1611777932, "creation_date": 1611777932, "answer_id": 65926586, "question_id": 55148800, "link": "https://stackoverflow.com/questions/55148800/monte-carlo-method-of-finding-pi-using-c/65926586#65926586", "title": "Monte Carlo Method of finding pi using C", "body": "<p>The others already pointed out your mistake. I am providing a optimized version <a href=\"https://stackoverflow.com/questions/65560634/monte-carlo-simulation-runs-significantly-slower-than-sequential/\">based on another SO Thead</a></p>\n<pre><code>   int main(void)\n    {\n        long points = 1000000000; // Some input\n        long m = 0;\n        unsigned long HAUSNUMERO = 1;\n        double DIV1byMAXbyMAX = 1. / RAND_MAX / RAND_MAX;\n    \n        unsigned int aThreadSpecificSEED_x = HAUSNUMERO + 1\n        unsigned int aThreadSpecificSEED_y = HAUSNUMERO - 1\n        for(long i = 0; i &lt; points; i++)\n        {\n            double x = rand_r( &amp;aThreadSpecificSEED_x );\n            double y = rand_r( &amp;aThreadSpecificSEED_y );\n            m += (1  &gt;= ( x * x + y * y ) * DIV1byMAXbyMAX);\n        }\n        printf(&quot;Pi is roughly %lf\\n&quot;, (double) 4*m / (double) points);\n    }\n</code></pre>\n"}], "owner": {"reputation": 353, "user_id": 8705952, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3655760f5ef9fe92833603259b7a7c8?s=128&d=identicon&r=PG&f=1", "display_name": "Pengibaby", "link": "https://stackoverflow.com/users/8705952/pengibaby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1147, "favorite_count": 1, "accepted_answer_id": 55148953, "answer_count": 5, "score": 7, "last_activity_date": 1611777932, "creation_date": 1552501179, "question_id": 55148800, "link": "https://stackoverflow.com/questions/55148800/monte-carlo-method-of-finding-pi-using-c", "title": "Monte Carlo Method of finding pi using C", "body": "<p>I have written a function that takes in a long long value <code>n</code> and uses that as the number of iterations to go through. The function should give a good estimate of pi, however, all the values for large <code>n</code> tends towards 3.000, and not 3.1415,so I am not sure what is going on? </p>\n\n<p>Is there anything that I did wrong?</p>\n\n<p>This is my code:</p>\n\n<pre><code>double estimate_pi(long long n){\n    double randomx, randomy, equation, pi;\n    long long i, incircle = 0;\n\n    for(i = 0; i &lt; n; i++){\n        randomx = (double)(rand() % (1+1-0) + 0);\n        randomy = (double)(rand() % (1+1-0) + 0);\n\n        equation = randomx * randomx + randomy * randomy;\n\n        if(equation &lt;= 1){\n            incircle++;\n        }\n    }\n\n    pi = (long double)4 * (long double)incircle / (long double)n;\n\n    return pi;\n}\n</code></pre>\n\n<p>in the main function, to print 10 values of pi:</p>\n\n<pre><code>int main(void){\n\n    long long N;\n    double pi_approx;\n    int i;\n\n    printf(\"Input a value of N: \");\n    if(scanf(\"%ld\", &amp;N) != 1){\n        printf(\"Error, input must be an integer!\\n\");\n        exit(EXIT_SUCCESS);\n    } \n    if(N &lt; 1){\n        printf(\"Error, the integer must be positive!\\n\");\n        exit(EXIT_SUCCESS); \n    }\n\n    srand(time(NULL));\n    for(i = 0; i &lt; 10; i++){\n        pi_approx = estimate_pi(N);\n        printf(\"%.10f\\n\", pi_approx);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1552499533, "post_id": 55148326, "comment_id": 97037043, "body": "Your question is totally unclear, sorry."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552499658, "post_id": 55148326, "comment_id": 97037120, "body": "Indented by 4-spaces so the code and data is proper formatted as fixed-width."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1552499689, "post_id": 55148326, "comment_id": 97037136, "body": "You are looking for a simple parser. You should read the file into a buffer and use for example <code>char *ptr = strstr(buf, &quot;a=&quot;); int zahla = atoi(ptr+2);</code> (and similar for b). Of course you have to do error checking and perhaps some more advanced parsing: Bottom line: <code>sscanf()</code> seems inappropriate for your task at first glance."}], "answers": [{"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 2, "last_activity_date": 1552514835, "last_edit_date": 1552514835, "creation_date": 1552500779, "answer_id": 55148701, "question_id": 55148326, "link": "https://stackoverflow.com/questions/55148326/how-can-i-use-the-function-sscanf-to-read-specific-characters/55148701#55148701", "title": "How can I use the function sscanf to read specific characters?", "body": "<ul>\n<li><p>The format specifier <code>\"%^\"</code> is meaningless and won't actually do anything -- so you never get anything in your <code>zimu</code> array.</p></li>\n<li><p>The <code>s</code> after <code>%[1-9]</code> in a format specifier means \"match a literal 's' character\", so will never match.  You probably just want to remove it.</p></li>\n<li><p>Since your input lines start with <code>a=</code> or <code>b=</code>, the <code>\"%[1-9]\"</code> format specifiers will not match.</p></li>\n</ul>\n\n<p>Most likely what you want is something like</p>\n\n<pre><code>char name[100], value[100];\nif (sscanf(buffer, \" %99[a-z] = %99[0-9]\", name, value) == 2) {\n    // matched a line with name=value, do something with it\n} else {\n    // didn't match -- give an error?\n}\n</code></pre>\n\n<ul>\n<li>use space characters in the format to skip whitespace -- whenever there is a space it will skip over 0 or more whitespace characters.  Note the 0 -- a space is not required, and any number of spaces may be there</li>\n<li>ALWAYS check the return value to see if the expected number of items matched</li>\n<li>You need something in the format to match all the characters on the line, though format specifiers other than <code>%[</code> and <code>%c</code> will also skip whitespace, and you can ignore trailing stuff if you don't care about it.  If you do care about trailing stuff, you can use <code>%n</code> to check how many characters you scanned to make sure it is the entire line.</li>\n<li>use bounds on <code>%s</code> and <code>%[</code> specifiers reading into fixed arrays to ensure that they don't overflow.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1552503426, "creation_date": 1552503426, "answer_id": 55149398, "question_id": 55148326, "link": "https://stackoverflow.com/questions/55148326/how-can-i-use-the-function-sscanf-to-read-specific-characters/55149398#55149398", "title": "How can I use the function sscanf to read specific characters?", "body": "<p>There is some confusion regarding the <code>%[abc]</code> scansets in <code>scanf</code> format strings: you should specify the maximum number of characters to read and give the character ranges between the <code>[</code> and <code>]</code>. There is no trailing <code>s</code> after the <code>]</code>. Extra spaces in the format string cause spaces to be skipped.</p>\n\n<p>Here is a corrected version of your code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    FILE *fp;\n    char buffer[1024];\n    char zimu[128];\n    char zahla[128];\n    char zahlb[128];\n\n    fp = fopen(\"./0312.conf\", \"r\");\n    if (fp == NULL) {\n        perror(\"error\");\n        return -1;\n    }\n    zahla[0] = zahlb[0] = '\\0';\n    while (fgets(buffer, 1024, fp) != NULL) {\n        if (sscanf(buffer, \" %127[a-z]\", zimu) != 1)\n            continue;\n        printf(\"zimu is: %s\\n\", zimu);\n        if (strcmp(zimu, \"a\") == 0) {\n            sscanf(buffer, \" a = %127[1-9]\", zahla);\n        }\n        if (strcmp(zimu, \"b\") == 0) {\n            sscanf(buffer, \" b = %127[1-9]\", zahlb);\n        }\n    }\n    printf(\"a=%s, b=%s\\n\", zahla, zahlb);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11198787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e390cbf225222558a03e573edf7ccc0?s=128&d=identicon&r=PG&f=1", "display_name": "Yocto", "link": "https://stackoverflow.com/users/11198787/yocto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 55148701, "answer_count": 2, "score": 1, "last_activity_date": 1552514835, "creation_date": 1552499478, "last_edit_date": 1552502673, "question_id": 55148326, "link": "https://stackoverflow.com/questions/55148326/how-can-i-use-the-function-sscanf-to-read-specific-characters", "title": "How can I use the function sscanf to read specific characters?", "body": "<p>I want to read the information from the file and give the value of <code>a</code> in file to the \"a\" and value of <code>b</code> to the \"b\". But it didn't work.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n    FILE *fp;\n    char buffer[1024];\n    char zahla[128];\n    char zahlb[128];\n    char zimu[128];\n\n    fp = fopen(\"./0312.conf\", \"r\");\n    if (fp == NULL) {\n        perror(\"error\");\n        return (-1);\n    }\n    while (fgets(buffer, 1024, fp) != NULL) {\n        sscanf(buffer, \"%^\", zimu);\n        printf(\"zimu is: %s\\n\", zimu);\n\n        if (strcmp(zimu, \"a\") == 0) {\n            sscanf(buffer, \"%[1-9]s\", zahla);\n        }\n        if (strcmp(zimu, \"b\") == 0) {\n            sscanf(buffer, \"%[1-9]s\", zahlb);\n        }\n    }\n    printf(\"a=%s, b=%s\\n\", zahla, zahlb);\n}\n</code></pre>\n\n<p>the content of the file is:</p>\n\n<p><PRE>\n       a=10\n                b=5\n</PRE></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 9846, "user_id": 1745544, "user_type": "registered", "accept_rate": 23, "profile_image": "https://www.gravatar.com/avatar/92a0f69d86d214e0cffceb76c6e3f09f?s=128&d=identicon&r=PG", "display_name": "OldProgrammer", "link": "https://stackoverflow.com/users/1745544/oldprogrammer"}, "edited": false, "score": 0, "creation_date": 1552498326, "post_id": 55147956, "comment_id": 97036413, "body": "<a href=\"https://www.geeksforgeeks.org/command-line-arguments-in-c-cpp/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/command-line-arguments-in-c-cpp</a>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1552498453, "post_id": 55147956, "comment_id": 97036486, "body": "You should have a counter such as <code>curarg</code> initialized with 1 (pointing to <code>cut</code>). Then identify the command in <code>argv[curarg]</code>. You know, that <code>cut</code> needs two arguments, so parse the arguments in <code>argv[curarg+1]</code> and <code>argv[curarg+2]</code>, execute the command and advance <code>curarg</code> by 3, now pointing to <code>copy</code>. Then iterate the process"}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1552498551, "post_id": 55147956, "comment_id": 97036539, "body": "@Ctx Could you give me an example in code on how this might work?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1552498600, "post_id": 55147956, "comment_id": 97036564, "body": "@AHunt I suggest you try it yourself; if your attempt fails, show this in your question and we can try to help."}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "edited": false, "score": 0, "creation_date": 1552498675, "post_id": 55147956, "comment_id": 97036599, "body": "No problem, when I posted the comment, the code format was not showing in your answer."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1552507882, "post_id": 55147956, "comment_id": 97041196, "body": "If you intend to release your programme to the public, I suggest using GNUs <code>getopt</code> or equivalent. <a href=\"https://www.gnu.org/software/libc/manual/html_node/Parsing-Program-Arguments.html\" rel=\"nofollow noreferrer\">gnu.org/software/libc/manual/html_node/&hellip;</a>"}, {"owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1552516917, "post_id": 55147956, "comment_id": 97044914, "body": "@Ctx Why would I need to iterate the process?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1552521320, "post_id": 55147956, "comment_id": 97046096, "body": "@AHunt Because you have an indeterminate number of arguments to process, so you need some kind of iteration or recursion."}], "answers": [{"comments": [{"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 1, "creation_date": 1552504304, "post_id": 55148589, "comment_id": 97039543, "body": "That will work for the specific example given, but what if he puts a <code>paste</code> after the first <code>cut</code>?"}, {"owner": {"reputation": 774, "user_id": 11059346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eOFhuwfbeLw/AAAAAAAAAAI/AAAAAAAAC5g/I9X1kvk3q24/photo.jpg?sz=128", "display_name": "Esdras Xavier", "link": "https://stackoverflow.com/users/11059346/esdras-xavier"}, "reply_to_user": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "edited": false, "score": 0, "creation_date": 1552517478, "post_id": 55148589, "comment_id": 97045078, "body": "In this case would be a problem"}], "tags": [], "owner": {"reputation": 774, "user_id": 11059346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eOFhuwfbeLw/AAAAAAAAAAI/AAAAAAAAC5g/I9X1kvk3q24/photo.jpg?sz=128", "display_name": "Esdras Xavier", "link": "https://stackoverflow.com/users/11059346/esdras-xavier"}, "is_accepted": false, "score": 1, "last_activity_date": 1552500406, "creation_date": 1552500406, "answer_id": 55148589, "question_id": 55147956, "link": "https://stackoverflow.com/questions/55147956/how-to-use-command-line-argument-in-function-calls-and-parameters/55148589#55148589", "title": "How to use command line argument in function calls and parameters?", "body": "<p>When you pass some value by param in C/C++ such as:</p>\n\n<p><code>./cnp cut 13 5 copy 33 7 paste 1 input-b.txt output.txt</code>, you need use <code>argv[positon_of_your_param]</code>, so your <code>argv[0]</code> will be the same as <code>./cnp</code>, and your <code>argv[1]</code> will be <code>cut</code>.</p>\n\n<p>Now following this you can just use each one based in your argument, try the code bellow I made it in <strong>C</strong>, but would be almost the same to <strong>C++</strong>. All your <em><strong>argv</strong></em> return char, so if you wanna get a integer you must convert, you can use <code>atoi()</code>, this function get a char and return a integer <a href=\"http://www.cplusplus.com/reference/cstdlib/atoi/\" rel=\"nofollow noreferrer\">doc</a>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid error(char *c, int n) {\n  printf(\"%s\\n\", c);\n  exit(n);\n}\n\nint main(int argc, char *argv[]) {\n\n  char *firstAction, *secondAction, *thirdAction;\n  char *file1, *file2;\n  int howManyCharacters=0, startAt=0;\n  int columnStart=0, columnEnd=0;\n  int nAfterPaste = 0;\n\n  if (argc &lt; 10) {\n    error(\"You must specify 10 parameters at least\", -1);\n  } else {\n    firstAction       = argv[1];\n    startAt           = atoi(argv[2]); // atoi(const char * str) -&gt; This function convert your char into integer\n    howManyCharacters = atoi(argv[3]);\n    secondAction      = argv[4];\n    columnStart       = atoi(argv[5]);\n    columnEnd         = atoi(argv[6]) + columnStart;\n    thirdAction       = argv[7];\n    nAfterPaste       = atoi(argv[8]);\n    file1             = argv[9];\n    file2             = argv[10];\n\n    printf(\"%s \", firstAction);\n    printf(\"%i \", startAt);\n    printf(\"%i \", howManyCharacters);\n    printf(\"%s \", secondAction);\n    printf(\"%i \", columnStart);\n    printf(\"%i \", columnEnd);\n    printf(\"%s \", thirdAction);\n    printf(\"%i \", nAfterPaste);\n    printf(\"%s \", file1);\n    printf(\"%s \\n\", file2);\n\n  }\n\n  return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 1, "last_activity_date": 1552503934, "creation_date": 1552503934, "answer_id": 55149507, "question_id": 55147956, "link": "https://stackoverflow.com/questions/55147956/how-to-use-command-line-argument-in-function-calls-and-parameters/55149507#55149507", "title": "How to use command line argument in function calls and parameters?", "body": "<p>You have an array of strings in <code>argv</code> that looks like this:</p>\n\n<pre><code>{ \"./cnp\", \"cut\", \"13\", \"5\", \"copy\", \"33\", \"7\", \"paste\", \"1\", \"input-b.txt\", \"output.txt\" }\n</code></pre>\n\n<p>On the assumption that the last two arguments are always the input and output files, I would loop through the arguments from 1 to <code>arc - 3</code> to process the commands e.g. the below sketch is not a complete solution but should give you some ideas.</p>\n\n<pre><code>if (argc &lt; 3) \n{\n    // Handle the fact that there were not enough arguments.\n}\nelse \n{\n    int commandArgs = argc - 2;\n    for (int i = 1 ; i &lt; commandArgs ; ++i) // Start at 1 to omit program name\n    {\n        if (strcmp(argv[i], \"cut\") == 0) \n        {\n            if (commandArgs - i &lt; 2)\n            {\n                // Handle not enough args to cut\n            }\n            else \n            {\n                // You have a cut command, call cut or save it to call cut later       \n                i += 2; // Skip the two parameters \n            }\n        }\n        else if (strcmp(argv[i], \"copy\") == 0)\n        {\n            // similar pattern to above\n        }\n        else if (strcmp(argv[i], \"paste\") == 0)\n        {\n            // similar pattern to above\n        }  \n        else \n        {\n            // Handle invalid command error\n        }          \n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10534413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d1ed7a8a0466fc0c4d67a101f5c334?s=128&d=identicon&r=PG&f=1", "display_name": "AHunt", "link": "https://stackoverflow.com/users/10534413/ahunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 55149507, "answer_count": 2, "score": -1, "last_activity_date": 1552552402, "creation_date": 1552498145, "last_edit_date": 1552552402, "question_id": 55147956, "link": "https://stackoverflow.com/questions/55147956/how-to-use-command-line-argument-in-function-calls-and-parameters", "title": "How to use command line argument in function calls and parameters?", "body": "<p>I am trying to read in the arguments from the main function. My problem is how to get each argument in order to put them into functions. I know I have to use something like strcmp( argv[ currentArg ], \"albus\" ) == 0, but I am pretty confused on how to do it especially since there might be different numbers of arguments.\nFor example:</p>\n\n<pre><code>./cnp cut 13 5 copy 33 7 paste 1 input-b.txt output.txt\n</code></pre>\n\n<p>cnp is the name of the main file\nthe cut copy and paste keywords are the function in the program\nThe numbers are the indices where the function has to cut, past and copy\ninput-b.txt output.txt are the files. </p>\n\n<p>Here, we're asking it to cut 5 characters starting at column 13. This should cut the 3-digit number after each name. Then, we ask it to make a copy of what's in columns 33 to 39; that's 7 characters starting in column 33, and it should give us a copy the last floating point number on each line. Then, we tell it to paste that at the start of the line, giving us another copy of these numbers at the start of each line. So the original would look like this</p>\n\n<pre><code>       Young  003   3  89.81  67.10  80.85  D\n       Venus  002   8  72.29  73.59  76.20  A\n      Jasmin  003   6  55.19  50.51  63.88  F\n     Micheal  001   3  98.93  91.37  99.00  C\n       Abram  001   2  50.23  90.14  57.36  E\n   Rigoberto  002   8  61.63  94.64  77.05  B\n         Noe  003   2  68.41  61.79  64.60  A\n     Kristin  002   5  77.34  84.68  65.16  B\n     Phillip  001   6  63.19  76.08  52.39  B\n     Monique  001   6  81.76  57.62  80.15  A\n       Verda  002  10  93.03  56.21  93.58  C\n      Louise  003   2  70.30  71.37  61.91  C\n       Vilma  001   9  71.09  93.43  76.72  G \n</code></pre>\n\n<p>After the program runs, it would look like this:</p>\n\n<pre><code>80.85         Young   3  89.81  67.10  80.85  D\n76.20         Venus   8  72.29  73.59  76.20  A\n63.88        Jasmin   6  55.19  50.51  63.88  F\n99.00       Micheal   3  98.93  91.37  99.00  C\n57.36         Abram   2  50.23  90.14  57.36  E\n77.05     Rigoberto   8  61.63  94.64  77.05  B\n64.60           Noe   2  68.41  61.79  64.60  A\n65.16       Kristin   5  77.34  84.68  65.16  B\n52.39       Phillip   6  63.19  76.08  52.39  B\n80.15       Monique   6  81.76  57.62  80.15  A\n93.58         Verda  10  93.03  56.21  93.58  C\n61.91        Louise   2  70.30  71.37  61.91  C\n76.72         Vilma   9  71.09  93.43  76.72  G\n</code></pre>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"buffer.h\"\n#include \"document.h\"\n\nint main(int argc, char *argv[])\n{\n\n  char \n\n\n\n   if(argc &gt; 0) {\n\n\n   }\n\n   else {\n\n}\n\n   return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The paste, cut, copy functions look like:</p>\n\n<pre><code>bool cut( char *line, int start, int n )\n</code></pre>\n\n<pre><code>bool copy(char *line, int start, int n) \n</code></pre>\n\n<pre><code>bool paste(char *line, int start)\n</code></pre>\n\n<p>To read and print it out, we have these functions:</p>\n\n<pre><code>int readDocument( FILE *fp, char doc[ MAX_LINES ][ MAX_LENGTH + 1 ] )\n</code></pre>\n\n<pre><code>void printDocument(FILE *fp, char doc[MAX_LINES][MAX_LENGTH + 1], int lines)\n</code></pre>\n\n<p>I have already completed theses functions but I need help on what to do in the main function on how to use the command line arguments. I am using a Linux machine.</p>\n"}, {"tags": ["c", "unix", "signals", "wait", "sigchld"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1552497596, "post_id": 55147657, "comment_id": 97036029, "body": "Not sure what you are confused about. <code>wait</code> blocks the parent until child terminates. Stopped child is not a terminated child."}, {"owner": {"reputation": 63, "user_id": 6917152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea1d22b9c4f918e5c73ff6fa0c5855c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0418\u0433\u043e\u0440\u044c \u041a\u043e\u0440\u043f\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/6917152/%d0%98%d0%b3%d0%be%d1%80%d1%8c-%d0%9a%d0%be%d1%80%d0%bf%d0%b5%d0%bd%d0%ba%d0%be"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1552498000, "post_id": 55147657, "comment_id": 97036263, "body": "From the man page, it waits for process to change state."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1552498878, "post_id": 55147657, "comment_id": 97036706, "body": "You can&#39;t safely call anything but async-signal-safe functions in a signal handler.  On Linux, the list can be found on <a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\">the <code>signal-safety</code> man page</a>. None of the functions you are calling - <code>wait()</code>, <code>perror()</code>, <code>exit()</code>, <code>puts()</code>, or <code>psignal()</code> are async-signal-safe. <a href=\"https://port70.net/~nsz/c/c11/n1570.html#note188\" rel=\"nofollow noreferrer\">Footnote 188 of the C 11 standard</a> even states: &quot;Thus, a signal handler cannot, in general, call standard library functions.&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1552499111, "post_id": 55147657, "comment_id": 97036818, "body": "@AndrewHenle: Both <code>wait()</code> and <code>waitpid()</code> are listed as async-signal safe in the POSIX description of <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04\" rel=\"nofollow noreferrer\">Signal Concepts</a>.  The Linux page you link to also lists both <code>wait()</code> and <code>waitpid()</code> as safe.  The C standard is almost impossibly restrictive; it is the bare minimum subset and, for all practical purposes, real systems are never as restrictive as the C standard."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1552519283, "post_id": 55147657, "comment_id": 97045589, "body": "@JonathanLeffler I missed the <code>wait()</code> call.  <i>The C standard is almost impossibly restrictive; it is the bare minimum subset and, for all practical purposes, real systems are never as restrictive as the C standard.</i>  The point was that without platform-specific documentation that states a library function call can safely be called from within a signal handler, it&#39;s unsafe to do so and likely invokes undefined behavior."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1552519368, "post_id": 55147657, "comment_id": 97045606, "body": "@AndrewHenle: The <a href=\"https://stackoverflow.com/questions/tagged/unix\">unix</a> tag hints (rather strongly) that the platform is not as impossibly restrictive as the C standard but that it probably hews fairly close to what POSIX allows."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1552519579, "post_id": 55147657, "comment_id": 97045668, "body": "@JonathanLeffler I assumed Linux, and Linux only loosely follows POSIX.  &quot;GNU&#39;s not Unix&quot; isn&#39;t really a good thing. Read the notes on <code>fork()</code> on the <a href=\"http://man7.org/linux/man-pages/man7/signal-safety.7.html\" rel=\"nofollow noreferrer\"><code>signal-safety</code> man page</a>  I seriously doubt after 16+ years POSIX is going to remove <code>fork()</code> from the list of functions required to be async-signal-safe just because Linux can&#39;t seem to make it happen.  AFAIK AIX, HP-UX have no problems, and I <b>know</b> Solaris doesn&#39;t."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1552520024, "post_id": 55147657, "comment_id": 97045775, "body": "@AndrewHenle \u2014 Linux on <code>fork()</code> is interesting. I would&#39;ve thought it was obvious that if a signal handler directly or indirectly calls a function that isn&#39;t async-signal safe, then the result is unreliable. It is less obvious that <code>pthread_atfork()</code> handlers will fire if you&#39;re not familiar with the function. There are suggestions around that using <code>fork()</code> in threaded programs is really not a good idea, and this would seem to be part of the reason why; other reasons are based on the fact that there&#39;s only one thread in the child process, so all sorts of resources may be locked afterwards."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1552499348, "post_id": 55147935, "comment_id": 97036959, "body": "You could probably use <code>WNOHANG</code> too \u2014 though it probably doesn&#39;t matter too much if you don&#39;t loop.  However, a process can have multiple children (even children that the current program didn&#39;t start, but that the program which executed the current one started and didn&#39;t wait for), and you might need to collect more than one corpse."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 5, "last_activity_date": 1552499193, "last_edit_date": 1552499193, "creation_date": 1552498072, "answer_id": 55147935, "question_id": 55147657, "link": "https://stackoverflow.com/questions/55147657/unix-signal-handling-wait-in-sigchld-handler-c/55147935#55147935", "title": "UNIX signal handling. Wait in SIGCHLD handler. C", "body": "<p>You have to use <code>waitpid()</code> instead of <code>wait()</code>, and you need to specify the option <code>WUNTRACED</code> to also have stopped children reported with <code>waitpid()</code>, like this:</p>\n\n<pre><code>if (waitpid(-1, &amp;statol, WUNTRACED) &lt; 0) {\n</code></pre>\n\n<p>Now <code>waitpid()</code> should return immediately and your macro <code>WIFSTOPPED(&amp;statol)</code> should be true.</p>\n"}], "owner": {"reputation": 63, "user_id": 6917152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ea1d22b9c4f918e5c73ff6fa0c5855c?s=128&d=identicon&r=PG&f=1", "display_name": "\u0418\u0433\u043e\u0440\u044c \u041a\u043e\u0440\u043f\u0435\u043d\u043a\u043e", "link": "https://stackoverflow.com/users/6917152/%d0%98%d0%b3%d0%be%d1%80%d1%8c-%d0%9a%d0%be%d1%80%d0%bf%d0%b5%d0%bd%d0%ba%d0%be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 0, "accepted_answer_id": 55147935, "answer_count": 1, "score": 2, "last_activity_date": 1552499193, "creation_date": 1552497050, "question_id": 55147657, "link": "https://stackoverflow.com/questions/55147657/unix-signal-handling-wait-in-sigchld-handler-c", "title": "UNIX signal handling. Wait in SIGCHLD handler. C", "body": "<p>I've a parent and a child processes. In the parent I established a signal handler for a SIGCHLD. I send SIGTSTP signal to the child, that trigers SIGCHLD and in SIGCHLD siganl handler in parent I call wait function to get a status of the stopped child. But instead of returning immediately it blocks. Then I send a SIGCONT signal to the child and wait returns with errno set to Interuppted system call. I can't understand what I'm missing.</p>\n\n<pre><code>pid_t pid;\n\n\nstatic void sig_chld(int signo);\n\n\nint main() {\n\n    struct sigaction act, savechld;\n    sigemptyset(&amp;act.sa_mask);\n    act.sa_flags = 0;\n\n\n    act.sa_handler = sig_chld;\n    if (sigaction(SIGCHLD, &amp;act, &amp;savechld) &lt; 0){\n        return errno;\n    }\n\n    pid = fork();\n    switch (pid){\n        case -1:{\n            perror(\"fork failed\");\n            return errno;\n        }\n        case 0:{    //child\n            if (sigaction(SIGCHLD, &amp;savechld, NULL) &lt; 0)\n                return errno;\n\n            execlp(path, name_of_executable, (char*)NULL);\n            return errno;\n        }\n        default:{\n            for (;;)\n                pause();\n        }\n    }\n    return 0;\n}\n\n\n\nvoid sig_chld(int signo) {\n    int statol;\n    if (wait(&amp;statol) &lt; 0){\n        perror(\"waitt error\");\n        exit(errno);\n    }\n\n    if (WIFSTOPPED(statol)){\n        puts(\"Child is stopped\");\n    } else if (WIFEXITED(statol)){\n        puts(\"Child exited\");\n    } else if (WIFCONTINUED(statol)){\n        puts(\"Child continued\");\n    } else if (WIFSIGNALED(statol)){\n        puts(\"Child is signaled\");\n        int sig = WTERMSIG(statol);\n        psignal(sig, NULL);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "windows-10", "gtk", "gtk3"], "answers": [{"tags": [], "owner": {"reputation": 335, "user_id": 10247482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bae12ba8d48079297d49c2af21610b3?s=128&d=identicon&r=PG", "display_name": "CL40", "link": "https://stackoverflow.com/users/10247482/cl40"}, "is_accepted": false, "score": 0, "last_activity_date": 1552582931, "creation_date": 1552582931, "answer_id": 55168269, "question_id": 55147480, "link": "https://stackoverflow.com/questions/55147480/building-and-running-gtk-application-on-windows-with-meson/55168269#55168269", "title": "Building and Running GTK application on Windows with Meson", "body": "<p>Admittedly this was a very hard problem to solve and asking it in a way to get an answer was even harder.</p>\n\n<p>After a few days of pulling what little hair I have left out, I deleted <code>builddir</code>, moved the <code>mingw64</code>binary path higher up in my environment, and set out rebuilding it.</p>\n\n<p>As it turns out, this seems to be a problem with the clang backend using ninja. Switching the backend to <code>gcc</code> (by virtue of moving the <code>mingw64/bin</code> folder up) magically fixed the problem, despite me not removing anything from my environment variables. </p>\n\n<p>I really hate magic - but I have no further explanation for this or a reason why <code>clang</code> would fail and <code>gcc</code> would work. If someone could chime in with an improved answer that would be great. I am not a compiler wizard with regards to the various C/C++ backends.</p>\n"}], "owner": {"reputation": 335, "user_id": 10247482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bae12ba8d48079297d49c2af21610b3?s=128&d=identicon&r=PG", "display_name": "CL40", "link": "https://stackoverflow.com/users/10247482/cl40"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552582931, "creation_date": 1552496503, "question_id": 55147480, "link": "https://stackoverflow.com/questions/55147480/building-and-running-gtk-application-on-windows-with-meson", "title": "Building and Running GTK application on Windows with Meson", "body": "<p>I am currently unable to successfully run the application I have built successfully using Meson. To install GTK I followed the steps available <a href=\"https://www.gtk.org/download/windows.php\" rel=\"nofollow noreferrer\">here</a> in order to install it. Additionally I added the path <code>C:\\msys64\\mingw64\\bin</code> to my path.</p>\n\n<p>Inside of that path, I was able to successfully run the applications <code>gtk-demo.exe</code>, <code>gtk3-demo.exe</code>, and <code>gtk3-demo-application.exe</code> which would indicate to me it installed successfully.</p>\n\n<p>I set out to build the sample application provided in the tutorial for Meson:</p>\n\n<pre><code>#include&lt;gtk/gtk.h&gt;\n\nint main(int argc, char **argv) {\n  GtkWidget *win;\n  gtk_init(&amp;argc, &amp;argv);\n  win = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n  gtk_window_set_title(GTK_WINDOW(win), \"Hello there\");\n  g_signal_connect(win, \"destroy\", G_CALLBACK(gtk_main_quit), NULL);\n  gtk_widget_show(win);\n  gtk_main();\n}\n</code></pre>\n\n<p>Running <code>ninja</code> in my <code>builddir</code> I get the following output:</p>\n\n<pre><code>[1/1] Linking target test.exe.\nLINK : warning LNK4044: unrecognized option '/-no-undefined'; ignored\nLINK : warning LNK4044: unrecognized option '/-as-needed'; ignored\nLINK : warning LNK4044: unrecognized option '/-start-group'; ignored\nLINK : warning LNK4044: unrecognized option '/luuid'; ignored\nLINK : warning LNK4044: unrecognized option '/-end-group'; ignored\n</code></pre>\n\n<p>Upon running it however, I run into the following error:</p>\n\n<blockquote>\n  <p>The procedure entry point g_application_get_type could not be located in the dynamic link library C:\\Users\\me\\proj\\builddir\\test.exe.</p>\n</blockquote>\n\n<p>Figuring this was a problem caused by stumbling into DLL hell, I checked my path (fine) and I copied over all the gtk dlls I could find in the bin directory into the local builddir. That didn't work either.</p>\n\n<p>I am at a loss - I'd just like to get this to work! What should I try to do to fix this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 4, "creation_date": 1552496530, "post_id": 55147440, "comment_id": 97035352, "body": "<code>*pInput == (&#39; &#39; || &#39;\\t&#39; || &#39;\\n&#39;)</code> doesn&#39;t do at all what you think. You should look up what these operators do."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1552496530, "post_id": 55147440, "comment_id": 97035353, "body": "<code>||</code> is going between logical expressions, not between constants you want to compare to."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1552496640, "post_id": 55147440, "comment_id": 97035431, "body": "@EugeneSh True, but how come the line never gets executed? Compiler knows that pointer can never be (probably) 1? That would keep the <b>next</b> line from execution..."}, {"owner": {"reputation": 11196, "user_id": 1079907, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a7c69e39fbec2c781db5f27b40f63023?s=128&d=identicon&r=PG", "display_name": "Sunil Bojanapally", "link": "https://stackoverflow.com/users/1079907/sunil-bojanapally"}, "edited": false, "score": 1, "creation_date": 1552496779, "post_id": 55147440, "comment_id": 97035526, "body": "Right way to do is <code>if ( (*pInput == &#39; &#39;)  || (*pInput == &#39;\\t&#39;) || (*pInput == &#39;\\&#39;) ) { .. }</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1552496794, "post_id": 55147440, "comment_id": 97035530, "body": "@Yunnosch I think the OP have somehow distorted the original warning."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552496832, "post_id": 55147440, "comment_id": 97035555, "body": "@EugeneSh. Possible."}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1552496933, "post_id": 55147440, "comment_id": 97035610, "body": "What compiler are you using and how are you compiling?  I&#39;m not getting a warning as written.  (Although others are correct regarding the <i>intent</i> of the statement is written incorrectly)."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1552497438, "post_id": 55147440, "comment_id": 97035921, "body": "Seems like the function <code>isspace()</code> in <code>&lt;ctype.h&gt;</code> would be useful for you"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552497717, "post_id": 55147440, "comment_id": 97036100, "body": "OT: for ease of readability and understanding: 1) please consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces.  2) separate code blocks: <code>for</code> <code>if</code> <code>else</code> <code>while</code> <code>do...while</code> <code>switch</code> <code>case</code> <code>default</code> via a single blank line.  3) separate functions by 2 or 3 blank lines (be consistent)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1552497874, "post_id": 55147440, "comment_id": 97036193, "body": "regarding: <code>while((c = fgetc(pFile)) != EOF){</code>  the function: <code>fgetc()</code> returns an <code>int</code> and <code>EOF</code> is an <code>int</code>.  so the variable <code>c</code> should be declared as an <code>int</code>, not as a <code>char</code>.   When compiling, always enable the warnings, then fix those warnings.  ( for <code>gcc</code>, at a minimum use: <code>-Wall -Wextra -Wconversion -pedantic -std=gnu11</code> )  Note: other compilers use different options to produce the same thing"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552498494, "post_id": 55147440, "comment_id": 97036508, "body": "OT: regarding: <code>printf(&quot;failed to open file\\n&quot;);</code>  error messages should be output to <code>stderr</code>, not <code>stdout</code> and when the error is from a C library function, then should also output (to <code>stderr</code>) the text reason the system thinks the error occurred.  The function: <code>perror()</code> correctly handles both the above operations"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 4, "last_activity_date": 1552497513, "last_edit_date": 1552497513, "creation_date": 1552497144, "answer_id": 55147686, "question_id": 55147440, "link": "https://stackoverflow.com/questions/55147440/compiler-warns-that-my-function-will-never-execute/55147686#55147686", "title": "Compiler warns that my function will never execute", "body": "<p>It's not saying that the statement will not be executed, just specific expressions within it. The warning message looks like this:</p>\n\n<pre><code>testcompare.c:67:35: warning: code will never be executed [-Wunreachable-code]\n    if(*pInput == (' ' || '\\t' || '\\n'))\n                                  ^~~~\ntestcompare.c:67:27: warning: code will never be executed [-Wunreachable-code]\n    if(*pInput == (' ' || '\\t' || '\\n'))\n                          ^~~~\n</code></pre>\n\n<p>Notice the arrows pointing to <code>'\\n'</code> and <code>'\\t'</code>, those are what it's saying will never be executed.</p>\n\n<p>The <code>||</code> operator is a short-circuiting operator, it only executes the right operand if the left operand is falsey.</p>\n\n<p>In this case, since the <code>' '</code> is a constant, and it's known to be truthy (any <code>char</code> other than <code>'\\0'</code> is truthy), the other two operands do not need to be executed to determine the result.</p>\n"}, {"tags": [], "owner": {"reputation": 63869, "user_id": 241590, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/4854e06b7e4c6b4941443c0cf2da7dfe?s=128&d=identicon&r=PG", "display_name": "stacker", "link": "https://stackoverflow.com/users/241590/stacker"}, "is_accepted": false, "score": 1, "last_activity_date": 1552497569, "creation_date": 1552497569, "answer_id": 55147801, "question_id": 55147440, "link": "https://stackoverflow.com/questions/55147440/compiler-warns-that-my-function-will-never-execute/55147801#55147801", "title": "Compiler warns that my function will never execute", "body": "<p>You would need to rewrite the expression:</p>\n\n<pre><code>if(*pInput == (' ' || '\\t' || '\\n'))\n</code></pre>\n\n<p>as</p>\n\n<pre><code>if(*pInput ==' ' || *pInput =='\\t' || *pInput =='\\n'))\n</code></pre>\n\n<p>or </p>\n\n<pre><code>if ( strchr(\" \\t\\n\" , *pInput) != NULL)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 0, "last_activity_date": 1552501315, "creation_date": 1552501315, "answer_id": 55148836, "question_id": 55147440, "link": "https://stackoverflow.com/questions/55147440/compiler-warns-that-my-function-will-never-execute/55148836#55148836", "title": "Compiler warns that my function will never execute", "body": "<p>The <code>||</code> operator evaluates its second operand only if the first operand evaluates to 0.</p>\n\n<p>So in <code>' ' || '\\t' || '\\n'</code> the last operand is never evaluated because <code>' ' || '\\t'</code> is non-zero.</p>\n\n<p>On the other hand, you want to write something like</p>\n\n<pre><code>(*pInput == ' ') || (*pInput == '\\t') || (*pInput == '\\n')\n</code></pre>\n\n<p>Other mistake you did, you forgot to insert the final <code>0</code> in the string <code>input</code></p>\n\n<pre><code>while((c = fgetc(pFile)) != EOF){\n    *pInput = c;\n    ++pInput;\n}\n\nfclose(pFile);\npFile = NULL;\n*pInput = 0;       /* THIS IS IMPORTANT */\npInput = input;  \n\nwhile(*pInput)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 11096593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/858c7d4dd255be32ec8aed3fc3474b8f?s=128&d=identicon&r=PG&f=1", "display_name": "TestEngineer11", "link": "https://stackoverflow.com/users/11096593/testengineer11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55147686, "answer_count": 3, "score": 1, "last_activity_date": 1552501315, "creation_date": 1552496353, "last_edit_date": 1552496479, "question_id": 55147440, "link": "https://stackoverflow.com/questions/55147440/compiler-warns-that-my-function-will-never-execute", "title": "Compiler warns that my function will never execute", "body": "<p>I have defined a function called checkrow, which reads a given element of a char array (fed to it by a pointer to char) and determines if it is equal to certain characters. When I compile my overall program, the compiler tells me that line 67, which is <code>(if(*pInput == (' ' || '\\t' || '\\n')))</code> will never execute. Why? The logic makes sense to me. Below is the code. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint checkRow(char *pArray);\n\nint main (void){\n\n    char c = 0;\n    int high = 0;\n    int low = 9;\n    int checksum = 0;\n    char input[3000];\n    char *pInput = input;\n    FILE *pFile = NULL;\n\n    pFile = fopen(\"foo.txt\", \"r\");\n    if (pFile == NULL){\n        printf(\"failed to open file\\n\");\n        return (-1);\n    }\n\n    while((c = fgetc(pFile)) != EOF){\n        *pInput = c;\n        ++pInput;\n    }\n\n    fclose(pFile);\n    pFile = NULL;\n    pInput = input; //point pInput back to the address of the first element of input\n    //printf(\"the checksum is %d\\n\", checksum(pInput));\n    while(*pInput){\n\n        if(checkRow(pInput) == 0){\n            checksum += (high - low);\n            ++pInput;\n            continue;\n        }\n        else{\n            if((*pInput - '0') &gt; high &amp;&amp; (*pInput - '0') &lt; low){\n            high = *pInput - '0';\n            low = *pInput - '0';\n            ++pInput;\n            continue;\n            }\n            else if (*pInput - '0' &gt; high){\n            high = *pInput - '0';\n            ++pInput;\n            continue;\n            }\n            else if(*pInput - '0' &lt; low){\n            low = *pInput - '0';\n            ++pInput;\n            }\n        }\n\n    }\n\n    printf(\"this is the checksum %d\\n\", checksum);\n    getchar();\n    return 0;\n}\n\nint checkRow(char *pInput){\n\n    int in = 0;\n\n    if(*pInput == (' ' || '\\t' || '\\n'))\n        in = 0;\n    else\n        in = 1;\n    return in;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "malloc"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1552494987, "post_id": 55146913, "comment_id": 97034433, "body": "Why is a screwdriver not good for hammering nails?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1552495005, "post_id": 55146913, "comment_id": 97034440, "body": "What do you mean? Show code that you think should be working but in fact isn&#39;t."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1552495023, "post_id": 55146913, "comment_id": 97034448, "body": "The function <code>malloc</code> does not allow you &quot;to resize anything&quot;. It allocates memory dynamically. The function <code>realloc</code> then allows you to resize it. But because an array was not obtained from <code>malloc</code>, you can&#39;t resize it."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1552495117, "post_id": 55146913, "comment_id": 97034504, "body": "Arrays are on the stack.  <code>malloc</code> manipulates memory on the heap.  (In environments where those things exist.  Sometimes.  (Usually))"}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1552495211, "post_id": 55146913, "comment_id": 97034556, "body": "@WilliamPursell Arrays not only live on the stack."}, {"owner": {"reputation": 1324, "user_id": 7231449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K4GZN.jpg?s=128&g=1", "display_name": "acarlstein", "link": "https://stackoverflow.com/users/7231449/acarlstein"}, "edited": false, "score": 0, "creation_date": 1552495267, "post_id": 55146913, "comment_id": 97034598, "body": "Sherief, Weather is correct. If you wish to &quot;resize&quot;, you will have to create a new array of greater length and then copy the content from the old array to the new array. This is the same thing that a Vector or ArrayList does. When you add a new element that goes beyond the capacity, they create a new array of double the size and then copy the content of the old array prior to inserting the new element."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1552495800, "post_id": 55146913, "comment_id": 97034917, "body": "<code>realloc</code> is what you are actually looking for.  <code>realloc</code> is a generalization of <code>malloc</code> that can resize memory as well as allocate it."}], "answers": [{"comments": [{"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1552495756, "post_id": 55147005, "comment_id": 97034893, "body": "realloc can actually be used for allocating memory as well"}], "tags": [], "owner": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "is_accepted": false, "score": 1, "last_activity_date": 1552495136, "creation_date": 1552495136, "answer_id": 55147005, "question_id": 55146913, "link": "https://stackoverflow.com/questions/55146913/why-cant-you-resize-array-in-c-using-malloc/55147005#55147005", "title": "Why cant you resize array in C using malloc?", "body": "<p><a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow noreferrer\">malloc</a> is used to allocate memory not resizing. If you want resizing check <a href=\"http://man7.org/linux/man-pages/man3/realloc.3p.html\" rel=\"nofollow noreferrer\">realloc</a>.</p>\n"}], "owner": {"reputation": 167, "user_id": 11198460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CXAgogjduQU/AAAAAAAAAAI/AAAAAAAAAvU/rkpUnkKpFWo/photo.jpg?sz=128", "display_name": "Sherief El-Ghazawi", "link": "https://stackoverflow.com/users/11198460/sherief-el-ghazawi"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "closed_date": 1552496044, "answer_count": 1, "score": 2, "last_activity_date": 1552495136, "creation_date": 1552494850, "question_id": 55146913, "link": "https://stackoverflow.com/questions/55146913/why-cant-you-resize-array-in-c-using-malloc", "closed_reason": "Needs details or clarity", "title": "Why cant you resize array in C using malloc?", "body": "<p>I know that malloc allows you to resize anything you want by allocating space for it. But why does this not work for resizing arrays in C?</p>\n"}, {"tags": ["c", "function", "pointers"], "comments": [{"owner": {"reputation": 2192, "user_id": 10848591, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eoV3Oz4qBEo/AAAAAAAAAAI/AAAAAAAAEz8/sAjB2IHG5Ao/photo.jpg?sz=128", "display_name": "Spinkoo", "link": "https://stackoverflow.com/users/10848591/spinkoo"}, "edited": false, "score": 3, "creation_date": 1552493326, "post_id": 55146388, "comment_id": 97033416, "body": "can you show us the scanEntries call ?"}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 2, "creation_date": 1552493438, "post_id": 55146388, "comment_id": 97033497, "body": "This code does not constitute a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> since the function you&#39;re asking about (<code>scanEntries</code>) is not called"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1552493856, "post_id": 55146388, "comment_id": 97033775, "body": "If you declare <code>int *p;</code> and your prototype is <code>void scanEntries(int total, int *p)</code>, you simply call it as <code>scanEntries(enterSize(), p);</code> (no <code>&#39;*&#39;</code> here) <code>&quot;warning: passing argument 2 of \u2018scanEntries\u2019 makes pointer from integer without a cast [enabled by default]&quot;</code> is due to your attempt to pass <code>*p</code> which dereferences the integer pointer <code>&#39;p&#39;</code> resulting in an <code>int</code> value instead of pointer to <code>int</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1552494522, "post_id": 55146388, "comment_id": 97034169, "body": "<code>*(p + number)</code> and alike should be written as <code>p[number]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1552494052, "post_id": 55146611, "comment_id": 97033894, "body": "He can do it just the way he is attempting with the allocated pointer <code>p</code>. Your example is for a different case of passing the <b><i>address of</i></b> an <code>int</code> as a pointer."}, {"owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552562928, "post_id": 55146611, "comment_id": 97061709, "body": "Ah, correct! :) When I answered the question was not well-specified so I just answered what was on the title."}], "tags": [], "owner": {"reputation": 1415, "user_id": 4288486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fceeebcdab5325a9b458c1af8c51111d?s=128&d=identicon&r=PG", "display_name": "Jo&#227;o Neto", "link": "https://stackoverflow.com/users/4288486/jo%c3%a3o-neto"}, "is_accepted": false, "score": 1, "last_activity_date": 1552563032, "last_edit_date": 1552563032, "creation_date": 1552493940, "answer_id": 55146611, "question_id": 55146388, "link": "https://stackoverflow.com/questions/55146388/in-c-how-do-i-define-functions-with-pointers-as-arguments/55146611#55146611", "title": "In C - how do I define functions with pointers as arguments?", "body": "<p>This is the basic gist on how to :</p>\n\n<ul>\n<li>Declare a function that accepts a pointer</li>\n<li>Pass a pointer to a function</li>\n</ul>\n\n<p>Minimal Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid incrementMyInt(int *p) {\n  // increment the value of the int that p points to\n  (*p)++;\n}\n\nint main() {\n  int n1 = 3;\n  int *n2 = malloc(sizeof(int));\n  *n2 = 7;\n  incrementMyInt(&amp;n1); // pass the address of n\n  incrementMyInt(n2);\n  printf(\"n1 is %d\\n\", n);\n  printf(\"n2 is %d\\n\", *n2);\n  return 0;\n}\n</code></pre>\n\n<p>It outputs <code>n1 is 4</code> and <code>n2 is 8</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552497135, "post_id": 55147136, "comment_id": 97035731, "body": "Your statement is not incorrect, but it should be <code>scanEntries (initSize, p);</code> otherwise the program will block waiting on duplicate input. (you already called <code>enterSize()</code> here <code>int initSize = enterSize();</code>.)"}], "tags": [], "owner": {"reputation": 99, "user_id": 11112946, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zJ8ZQkUCOkY/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPi5r4NvVpJ2GSVZ8oJRDY9NmfU8w/mo/photo.jpg?sz=128", "display_name": "Meher Khiari", "link": "https://stackoverflow.com/users/11112946/meher-khiari"}, "is_accepted": false, "score": 1, "last_activity_date": 1552495563, "creation_date": 1552495563, "answer_id": 55147136, "question_id": 55146388, "link": "https://stackoverflow.com/questions/55146388/in-c-how-do-i-define-functions-with-pointers-as-arguments/55147136#55147136", "title": "In C - how do I define functions with pointers as arguments?", "body": "<p>Change:</p>\n\n<pre><code>scanEntries(enterSize(), *p);\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>scanEntries(enterSize(), p);\n</code></pre>\n\n<h1>Explanation</h1>\n\n<p>You have to pass a pointer as the second parameter of the function. p is a pointer to an int, thus, the call you made is passing the int instead of the pointer. That's why you have the warning.</p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 4352328, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/358405a05d0bd6687da5ab98127578d9?s=128&d=identicon&r=PG&f=1", "display_name": "randomguy537", "link": "https://stackoverflow.com/users/4352328/randomguy537"}, "edited": false, "score": 0, "creation_date": 1552496087, "post_id": 55147167, "comment_id": 97035084, "body": "I simply changed *p to p just now and all the errors when compiling are gone!  But when I run the program, after I enter the size of an array the program says &quot;Segmentation fault&quot; and terminates."}, {"owner": {"reputation": 125, "user_id": 4352328, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/358405a05d0bd6687da5ab98127578d9?s=128&d=identicon&r=PG&f=1", "display_name": "randomguy537", "link": "https://stackoverflow.com/users/4352328/randomguy537"}, "edited": false, "score": 0, "creation_date": 1552497812, "post_id": 55147167, "comment_id": 97036162, "body": "Oh Christ, I always make this mistake in scanf functions!!! Thanks so much, that should&#39;ve been obvious."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1552496539, "last_edit_date": 1552496539, "creation_date": 1552495647, "answer_id": 55147167, "question_id": 55146388, "link": "https://stackoverflow.com/questions/55146388/in-c-how-do-i-define-functions-with-pointers-as-arguments/55147167#55147167", "title": "In C - how do I define functions with pointers as arguments?", "body": "<p>The definition of your function is fine.  The problem is how you're calling it.</p>\n\n<p>In your <code>main</code> function, you declare <code>p</code> as a pointer:</p>\n\n<pre><code>int *p; /* p is an int pointer */\n</code></pre>\n\n<p>But then you dereference that pointer when calling <code>scanEntries</code>:</p>\n\n<pre><code>scanEntries(enterSize(), *p);\n</code></pre>\n\n<p>You're actually passing an <code>int</code> to the function instead of a pointer to <code>int</code>, so the compiler is attempting to convert the <code>int</code> into a pointer to match the parameter.  That's what the warning is telling you.</p>\n\n<p>Since the function expects an <code>int *</code>, just pass it directly to the function.  Also, you don't need to call <code>enterSize</code> again here since you already got the size.  use <code>initSize</code> instead:</p>\n\n<pre><code>scanEntries(initSize, p);\n</code></pre>\n\n<p>Also, this is wrong:</p>\n\n<pre><code>scanf(\"%d\\n\", output);\n</code></pre>\n\n<p>The <code>%d</code> format specifier expects a pointer to <code>int</code>, but you're just passing a plain <code>int</code>.  Using the wrong type for a format specifier invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You want to pass the address of <code>output</code> to the function, that way it gets updated.  Also, the <code>\\n</code> in the format will cause your program to prompt for extra input.  It's not needed.</p>\n\n<pre><code>scanf(\"%d\", &amp;output);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1552496856, "creation_date": 1552496856, "answer_id": 55147585, "question_id": 55146388, "link": "https://stackoverflow.com/questions/55146388/in-c-how-do-i-define-functions-with-pointers-as-arguments/55147585#55147585", "title": "In C - how do I define functions with pointers as arguments?", "body": "<p>Continuing from my comments - If you declare int <code>*p</code>; and your prototype is <code>void scanEntries(int total, int *p)</code>, you simply call it as <code>scanEntries(initSize, p);</code> (no <code>'*'</code> here) <code>\"warning: passing argument 2 of \u2018scanEntries\u2019 makes pointer from integer without a cast [enabled by default]\"</code> is due to your attempt to pass <code>*p</code> which dereferences the integer pointer <code>'p'</code> resulting in an <code>int</code> value instead of a <em>pointer to int</em>.</p>\n\n<p>Beyond your initial pointer passing problem, you have a large number of additonal errors:</p>\n\n<p>In  <code>main()</code> you should not call <code>enterSize()</code> a second time, instead:</p>\n\n<pre><code>    scanEntries (initSize, p);\n</code></pre>\n\n<p>Further, you must validate <em>EVERY</em> allocation and <em>EVERY</em> input, e.g.</p>\n\n<pre><code>    p = calloc(initSize, sizeof(int));\n    if (!p) {   /* VALIDATE EVERY ALLOCATION */\n        perror (\"calloc-p\");\n        return 1;\n    }\n</code></pre>\n\n<p>and finally, if you allocate memory, develop good habits and ensure you <code>free</code> it when it is no longer needed, e.g.</p>\n\n<pre><code>    free (p);   /* don't forget to free what you allocate */\n}\n</code></pre>\n\n<p>In <code>scanInt()</code>, you must provide a pointer to <code>output</code> to <code>scanf</code>, e.g.</p>\n\n<pre><code>    if (scanf (\"%d\", &amp;output) != 1) { /* VALIDATE EVERY INPUT */\n        fputs (\"error: invalid input - not an integer.\\n\", stderr);\n        exit (EXIT_FAILURE);\n    }\n</code></pre>\n\n<p>(<strong>note:</strong> the <code>&amp;output</code> in the <code>scanf</code> call)</p>\n\n<p>Further, while equivalent, don't use pointer notation for <code>*(p + number)</code>, instead simply use <code>p[number]</code> it is more readable.</p>\n\n<p>Putting it altogether, you could do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* function to scan any integer value */\nint scanInt (void)\n{\n    int output;\n\n    if (scanf (\"%d\", &amp;output) != 1) { /* VALIDATE EVERY INPUT */\n        fputs (\"error: invalid input - not an integer.\\n\", stderr);\n        exit (EXIT_FAILURE);\n    }\n\n    return (output);\n}\n\n/* scanInt but as one entry out of a group */\nint scanEntry (int number, int total)\n{\n    printf (\"Please enter score %d of %d: \", number+1, total);\n\n    return (scanInt());\n}\n\n/* scanEntry for an entire dynamic array) */\nvoid scanEntries (int total, int *p)\n{\n    int number;\n\n    for (number = 0; number &lt; total; number++) {\n        p[number] = scanEntry (number, total);\n#ifdef TESTING\n        printf (\" scanEntries testing - %d\\n\", p[number]);\n#endif\n    }\n}\n\n/* scanInt but with a prompt to enter size */\nint enterSize (void)\n{\n    printf (\"Please enter size of array: \");\n    return (scanInt());\n}\n\nint main (void) {\n\n    /* entering initial size, done in a separate function */\n    int initSize = enterSize(),\n        *p;                             /* p is an int pointer */\n    p = calloc(initSize, sizeof(int));\n    if (!p) {   /* VALIDATE EVERY ALLOCATION */\n        perror (\"calloc-p\");\n        return 1;\n    }\n    printf (\"%d\\n\", initSize);\n\n    scanEntries (initSize, p);\n\n    printf (\"%d entries read:\\n\\n\", initSize);\n    for (int i = 0; i &lt; initSize; i++)\n        printf (\"p[%2d] : %d\\n\", i, p[i]);\n\n    free (p);   /* don't forget to free what you allocate */\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>(<strong>note:</strong> you can add <code>-DTESTING</code> to your compiler options to define <code>TESTING</code> to activate the additional code.)</p>\n\n<pre><code>$ ./bin/scanentries\nPlease enter size of array: 4\n4\nPlease enter score 1 of 4: 1\nPlease enter score 2 of 4: 2\nPlease enter score 3 of 4: 3\nPlease enter score 4 of 4: 4\n4 entries read:\n\np[ 0] : 1\np[ 1] : 2\np[ 2] : 3\np[ 3] : 4\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/scanentries\n==11795== Memcheck, a memory error detector\n==11795== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==11795== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==11795== Command: ./bin/scanentries\n==11795==\nPlease enter size of array: 4\n4\nPlease enter score 1 of 4: 1\nPlease enter score 2 of 4: 2\nPlease enter score 3 of 4: 3\nPlease enter score 4 of 4: 4\n4 entries read:\n\np[ 0] : 1\np[ 1] : 2\np[ 2] : 3\np[ 3] : 4\n==11795==\n==11795== HEAP SUMMARY:\n==11795==     in use at exit: 0 bytes in 0 blocks\n==11795==   total heap usage: 1 allocs, 1 frees, 16 bytes allocated\n==11795==\n==11795== All heap blocks were freed -- no leaks are possible\n==11795==\n==11795== For counts of detected and suppressed errors, rerun with: -v\n==11795== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)\n</code></pre>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 125, "user_id": 4352328, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/358405a05d0bd6687da5ab98127578d9?s=128&d=identicon&r=PG&f=1", "display_name": "randomguy537", "link": "https://stackoverflow.com/users/4352328/randomguy537"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1552563032, "creation_date": 1552493253, "last_edit_date": 1552494699, "question_id": 55146388, "link": "https://stackoverflow.com/questions/55146388/in-c-how-do-i-define-functions-with-pointers-as-arguments", "title": "In C - how do I define functions with pointers as arguments?", "body": "<p>I am trying to define a function titled scanEntries which takes an int argument and a pointer argument. When i tried to compile it, I got an error message: </p>\n\n<blockquote>\n<pre><code>\"warning: passing argument 2 of \u2018scanEntries\u2019 makes pointer from integer \n without a cast [enabled by default]\"\n</code></pre>\n</blockquote>\n\n<p>I tried looking up that error message here, but all I got was results about existing string-related functions, not customized functions. I've never tried writing functions with pointers as arguments before; what am I doing wrong? What exactly needs to be casted here and how do I do it?</p>\n\n<pre><code> /* function to scan any integer value */\nint scanInt() {\n    int output;\n    scanf(\"%d\\n\", output);\n    return(output);\n}\n\n/* scanInt but as one entry out of a group */\nint scanEntry(int number, int total) {\n    printf(\"Please enter score %d of %d: \", number+1, total);\n    return(scanInt());\n}\n\n/* scanEntry for an entire dynamic array) */\nvoid scanEntries(int total, int *p) {\n    int number;\n    for(number = 0; number &lt; total; number++) {\n        *(p + number) = scanEntry(number, total);\n        /* for testing */\n        printf(\"%d\", *(p + number));\n    }\n}\n</code></pre>\n\n<p>Here is where scanEntries is called, plus one more function not shown above that I used here:</p>\n\n<pre><code>/* scanInt but with a prompt to enter size */\nint enterSize() {\n    printf(\"Please enter size of array: \");\n    return(scanInt());\n}\n\nint main() {\n    /* entering initial size, done in a separate function */\n    int initSize = enterSize();\n    int *p; /* p is an int pointer */\n    p = calloc(initSize, sizeof(int));\n    printf(\"%d\", initSize);\n\n    scanEntries(enterSize(), *p);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "file", "struct"], "comments": [{"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "edited": false, "score": 1, "creation_date": 1552491792, "post_id": 55145833, "comment_id": 97032288, "body": "What is the line of the code which causes the seg fault?"}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1552491931, "post_id": 55145833, "comment_id": 97032382, "body": "you should also paste the definitions"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1552492500, "post_id": 55145833, "comment_id": 97032804, "body": "<code>fwrite(&amp;con[a],..</code> is an error. Remove the <code>&amp;</code>."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1552492609, "post_id": 55145833, "comment_id": 97032896, "body": "Besides, <code>n</code> is still zero in the code shown, so nothing will be written."}, {"owner": {"reputation": 45, "user_id": 11057286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zF--EUFCTmQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNt-1sQ_Hye1LemawbHBZA9A0pEUA/mo/photo.jpg?sz=128", "display_name": "Caty Battjes", "link": "https://stackoverflow.com/users/11057286/caty-battjes"}, "edited": false, "score": 1, "creation_date": 1552492657, "post_id": 55145833, "comment_id": 97032933, "body": "My problem was that I had not open pRead. Thank you xing"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1552493711, "post_id": 55145833, "comment_id": 97033676, "body": "@CatyBattjes <b>always</b> check if <code>fopen</code> succeeds."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552499327, "post_id": 55145833, "comment_id": 97036944, "body": "OT: regarding: <code>struct contact *con = (struct contact *)malloc(size * sizeof(struct contact));</code>  When calling any of the heap allocation functions: <code>malloc()</code> <code>calloc()</code> <code>realloc()</code>  1) always check (!=NULL) the returned value to assure the operation was successful.  2) In C, the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  Suggest removing the cast"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552499447, "post_id": 55145833, "comment_id": 97037010, "body": "OT: regarding: ` while (fread(&amp;con[a], sizeof(struct contact),1, pRead)){`  Always check the returned value (compare against the third parameter) to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552499551, "post_id": 55145833, "comment_id": 97037053, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (not just code snippets so we can reproduce the problem, so we can help you debug it"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552499814, "post_id": 55145833, "comment_id": 97037207, "body": "OT: regarding <code>scanf(&quot;%s&quot;, con[n].LastName);</code> (and other calls to <code>scanf()</code>)  1) always check the returned value (in this instance it should be 1 (any other value indicates an error occurred)  to assure the operation was successful.  2) when using the input format specifiers &#39;%s&#39; and/or &#39;%[...]&#39; always include a MAX CHARACTERS modifier that is 1 less than the length of the input buffer as those specifiers always append a NUL byte to the input.  This also avoids any possibility of a buffer overflow and the resulting undefined behavior"}, {"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1552528533, "post_id": 55145833, "comment_id": 97047853, "body": "<code>fread(&amp;con[a], sizeof(struct contact),1, pRead)</code> reads everything into the same place (<code>a</code> never changes in the loop). On top of that, the value of <code>a</code> at the time of reading is <code>n</code>, which is likely illegal."}], "owner": {"reputation": 45, "user_id": 11057286, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zF--EUFCTmQ/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNt-1sQ_Hye1LemawbHBZA9A0pEUA/mo/photo.jpg?sz=128", "display_name": "Caty Battjes", "link": "https://stackoverflow.com/users/11057286/caty-battjes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552495550, "creation_date": 1552491616, "last_edit_date": 1552495550, "question_id": 55145833, "link": "https://stackoverflow.com/questions/55145833/adding-an-array-of-structs-into-a-file-in-c", "title": "Adding an array of structs into a file in c", "body": "<p>I have a code where I am able to add my struct array to a file, but am unable to continue adding contacts to my struct array like I should. </p>\n\n<p>Here are my variables:</p>\n\n<pre><code>struct contact {                // Data structure that holds contact information \n    char FirstName[10];         // Array for first name\n    char LastName[10];          // Array for last name\n    int PhoneNum;               // Phone number\n};\n\nint Choice = 0;\n    int n = 0;\n    int size = 1;\n    struct contact *con = (struct contact *)malloc(size * sizeof(struct contact));\n    int a = 0;\n    int b = 0;\n    int SortChoice = 0;\n    int iRandNum = 0;\n    int Valid = 0;\n    char temp[10];\n    int tempNum = 0;\n    char File[20];\n    int status = 0;\n\n    FILE *pRead;\n    FILE *pWrite;\n</code></pre>\n\n<p>Here is the add contact part:</p>\n\n<pre><code>if (n == size)\n            {\n                size = size * 2;\n                con = (struct contact*)realloc(con, size * sizeof(struct contact));\n            }\n            // Records the information given into the structure\n            printf(\"\\nYou chose to add a contact.\");\n            printf(\"\\nFirst name: \");\n            scanf(\"%s\", con[n].FirstName);\n            printf(\"\\nLast name: \");\n            scanf(\"%s\", con[n].LastName);\n            printf(\"\\nPhone number (Numbers only): \");\n            scanf(\"%d\", &amp;con[n].PhoneNum);\n            printf(\"\\nRecord added to the phone book.\");\n\n            // Prints out the given information\n            printf(\"\\n\\nNew contact:\");\n            printf(\"\\nFirst name: %s\", con[n].FirstName);\n            printf(\"\\nLast name: %s\", con[n].LastName);\n            printf(\"\\nPhone number: %d\", con[n].PhoneNum);\n            printf(\"\\nContact number is %d\", n);\n            printf(\"\\n\");\n            n += 1;\n</code></pre>\n\n<p>And here is the file part:</p>\n\n<pre><code>printf(\"\\nYou chose to store all contacts to a file.\");\n\n            if (status == 0){\n                printf(\"\\nWhat would you like to name your file?\\n\");\n                scanf(\"%s\", &amp;File);\n                printf(\"\\nFile name is %s\", File);\n                pWrite = fopen(File, \"w\");\n\n                if (pWrite == 0){\n                    printf(\"\\nFile not opened\");\n                }\n                else {\n                    for (a = 0; a &lt; n; a++){\n                        fwrite(&amp;con[a], sizeof(struct contact), 1, pWrite);\n                    }\n                    fclose(pWrite);\n                    pRead =fopen(File, \"r\");\n                    printf(\"\\n\\nContacts added to %s\", File);\n                    printf(\"\\n\\nContacts in file:\\n\");\n                    while (fread(&amp;con[a], sizeof(struct contact),1, pRead)){\n                        printf(\"\\n\");\n                        printf(\"\\nFirst name: %s\", con[a].FirstName);\n                        printf(\"\\nLast name: %s\", con[a].LastName);\n                        printf(\"\\nPhone number: %d\", con[a].PhoneNum);\n                        printf(\"\\n\");\n                    }\n                    fclose(pRead);\n                }\n            }\n</code></pre>\n\n<p>If you guys can figure out where I've gone wrong, and potentially why I can't continue to access the file I created that would be great. Thanks</p>\n"}, {"tags": ["c", "permissions", "ipc", "shared-memory"], "answers": [{"tags": [], "owner": {"reputation": 378, "user_id": 8067109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20c81b36e29bd46af60b41e261355d83?s=128&d=identicon&r=PG&f=1", "display_name": " thoron ", "link": "https://stackoverflow.com/users/8067109/thoron"}, "is_accepted": true, "score": 2, "last_activity_date": 1552493642, "creation_date": 1552493642, "answer_id": 55146517, "question_id": 55145332, "link": "https://stackoverflow.com/questions/55145332/using-numerical-equivalent-of-ipc-creat-in-shmget-c/55146517#55146517", "title": "Using numerical equivalent of IPC_CREAT in shmget() C", "body": "<p>You can check it by doing <code>printf(\"%o\\n\", IPC_CREAT | 0600)</code>. It will print 1600 if IPC_CREAT is 01000 which is in my system.</p>\n\n<p>But here is the problem:\nMacros can vary system to system so you shouldn't rely on the value in your system.</p>\n\n<p>And using magic numbers makes code less readable for other people and for you. I can understand what <code>IPC_CREAT | 0600</code> means when I see it -rwx octals are well known- but I probably would say \"what the heck is 01600\" if I see it. And you too probably wouldn't remember what was it after a while.   </p>\n"}, {"tags": [], "owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "is_accepted": false, "score": 3, "last_activity_date": 1552501492, "creation_date": 1552501492, "answer_id": 55148888, "question_id": 55145332, "link": "https://stackoverflow.com/questions/55145332/using-numerical-equivalent-of-ipc-creat-in-shmget-c/55148888#55148888", "title": "Using numerical equivalent of IPC_CREAT in shmget() C", "body": "<p>The former method is the correct way to call the function, because it makes your code system independent.  Just because IPC_CREAT is defined as <code>01000</code> on your development system, it does not mean it will be the same elsewhere (although it will more likely than not remain the same for the major version of the same operating system).</p>\n\n<p>It's better to use to become comfortable with the <em>first one</em>, as a matter of fact, it makes for easier maintenance of your software.</p>\n\n<p>I would even recommend going as far as replacing <code>0600</code> with proper constants, as in:</p>\n\n<p><code>shm_open(..., O_RDWR|IPC_CREAT);</code></p>\n"}], "owner": {"reputation": 663, "user_id": 9490777, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Adhamzhon Shukurov", "link": "https://stackoverflow.com/users/9490777/adhamzhon-shukurov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 55146517, "answer_count": 2, "score": 1, "last_activity_date": 1552501492, "creation_date": 1552490249, "question_id": 55145332, "link": "https://stackoverflow.com/questions/55145332/using-numerical-equivalent-of-ipc-creat-in-shmget-c", "title": "Using numerical equivalent of IPC_CREAT in shmget() C", "body": "<p>I was learning how to create a shared memory using <code>shmget()</code>. Up to this point, all the examples that I found use <code>IPC_CREAT | &lt;shm_perm&gt;</code> format for the flag (or something similar). When I checked my <code>bits/ipc.h</code> content <code>IPC_CREAT</code> was defined to be <code>01000</code>. </p>\n\n<p>I tried to create a shared memory with permission of <code>0600</code>. First I used the formal method = ><code>IPC_CREAT | 0600</code>, it worked. Then instead of bitwise OR-ing the two, just used <code>01600</code>, I could not observe any difference in the result, but not sure if it applies for all cases as I am new to C programming.</p>\n\n<p>This might be something trivial, but I wonder why it is better to use the OR-ing method rather than just concatenating <code>01</code> with a required permission type (I found the latter method easier to remember and type). </p>\n\n<ul>\n<li><strong>Is there special feature that the formal method has and the latter lacks (maybe related with OS)?</strong></li>\n<li><strong>Is it safe to use the latter method if I am more comfortable with that one?</strong></li>\n</ul>\n"}, {"tags": ["c", "ncurses", "windows-subsystem-for-linux"], "comments": [{"owner": {"reputation": 13, "user_id": 7635881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a916f8e371eae98fd99b11998391aac9?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Koch", "link": "https://stackoverflow.com/users/7635881/brian-koch"}, "edited": false, "score": 0, "creation_date": 1552490450, "post_id": 55145136, "comment_id": 97031375, "body": "Fixed that and updated screenshot"}, {"owner": {"reputation": 6673, "user_id": 777689, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/19JOo.jpg?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/777689/petert"}, "edited": false, "score": 1, "creation_date": 1552491796, "post_id": 55145136, "comment_id": 97032292, "body": "The program seems fine. If you use a console like mintty or winpty you&#39;ll get better VT100 support."}], "answers": [{"tags": [], "owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "is_accepted": false, "score": 2, "last_activity_date": 1552510444, "creation_date": 1552510444, "answer_id": 55151042, "question_id": 55145136, "link": "https://stackoverflow.com/questions/55145136/ncurses-with-wsl-displaying-boxes-incorrectly/55151042#55151042", "title": "NCurses with WSL Displaying Boxes Incorrectly", "body": "<p>The <code>getch();</code> should be <code>wgetch(mainMenu);</code>\nOtherwise, repainting <code>stdscr</code> can wipe out part of the <code>mainWindow</code>.</p>\n\n<p>But that does not appear to be the problem shown in the picture.  That's probably using <code>TERM=xterm</code> (or <code>TERM=xterm-256color</code>) on some terminal that doesn't completely match <strong>xterm</strong>, e.g., the <a href=\"https://stackoverflow.com/questions/51904557/how-to-get-a-correctly-sized-window-in-ncurses/51907467#51907467\"><em>repeat</em></a> feature.</p>\n"}], "owner": {"reputation": 13, "user_id": 7635881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a916f8e371eae98fd99b11998391aac9?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Koch", "link": "https://stackoverflow.com/users/7635881/brian-koch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552510444, "creation_date": 1552489617, "last_edit_date": 1552490412, "question_id": 55145136, "link": "https://stackoverflow.com/questions/55145136/ncurses-with-wsl-displaying-boxes-incorrectly", "title": "NCurses with WSL Displaying Boxes Incorrectly", "body": "<p>I am using ubuntu on my windows computer using the windows subsystem for linux to compile a simple program using ncurses in C that shows a box inside a ncurses window. As seen in the picture below, the  box does not render fully. Is there something wrong with my code or is this an issue within WSL?</p>\n\n<p><a href=\"https://i.imgur.com/nNrWNvt.png\" rel=\"nofollow noreferrer\">The drawn box displays incorrectly</a>\nThe box should stretch and connect the left and right sides</p>\n\n<pre><code>    int main()\n{\n    initscr();\n    noecho();\n    cbreak();\n\n    int sizeY, sizeX;\n    getmaxyx(stdscr, sizeY, sizeX);\n\n    WINDOW *mainMenu = newwin(10, 10, 5, 10);\n    box(mainMenu, 0, 0);\n    refresh();\n    wrefresh(mainMenu);\n    keypad(mainMenu, true);\n\n    getch();\n    endwin();\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "mqtt", "mosquitto", "libmosquitto"], "comments": [{"owner": {"reputation": 353, "user_id": 4857187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/223b06e291b04967f23a7f53ae17c762?s=128&d=identicon&r=PG&f=1", "display_name": "Santosh Balaji", "link": "https://stackoverflow.com/users/4857187/santosh-balaji"}, "edited": false, "score": 0, "creation_date": 1552533177, "post_id": 55143474, "comment_id": 97048845, "body": "Can you post the code snippets what you have done so far ? Your description is not enough for understanding the issue"}], "answers": [{"tags": [], "owner": {"reputation": 1282, "user_id": 3960558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3527e668e8c30bd6a75b4764496951a?s=128&d=identicon&r=PG&f=1", "display_name": "MBer", "link": "https://stackoverflow.com/users/3960558/mber"}, "is_accepted": false, "score": 0, "last_activity_date": 1552691998, "creation_date": 1552691998, "answer_id": 55191840, "question_id": 55143474, "link": "https://stackoverflow.com/questions/55143474/how-to-publish-data-synchronously-using-mosquitto-publish/55191840#55191840", "title": "How to publish data synchronously using mosquitto_publish?", "body": "<p>Based on the <a href=\"https://mosquitto.org/api/files/mosquitto-h.html#mosquitto_publish\" rel=\"nofollow noreferrer\">mosquitto_publich documentation</a>, the function returns when sending has been \"successful\". <strong>MQTT does not guarantee the order in which messages arrive</strong>, so you should arguably watch for the arrival rather than the sending, and avoid having two messages race each other to the broker. With QoS 0, the client never knows if a message arrived; that requires QoS 1 or 2, for which additional communications are exchanged. Raise the quality of service, and you can use <a href=\"https://mosquitto.org/api/files/mosquitto-h.html#mosquitto_max_inflight_messages_set\" rel=\"nofollow noreferrer\">mosquitto_max_inflight_messages_set</a>(mosq, 1) so that the client queues any additional messages until it receives confirmation from the server. This may be even more efficient than \"waiting\" for completion, since non-MQTT operations can continue. The queue might pile up if you send bursts of many messages.</p>\n\n<p>The more complex alternative is to send messages unrestricted, but include an index with each, so that the subscriber can sort them upon receipt (for which it would need its own queue and delay). Not recommended if this burden is going to fall on multiple subscribers.</p>\n"}], "owner": {"reputation": 81, "user_id": 1676751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b474f2066b334a43a9433b6560f2225b?s=128&d=identicon&r=PG&f=1", "display_name": "chinmaya", "link": "https://stackoverflow.com/users/1676751/chinmaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552714264, "creation_date": 1552484924, "last_edit_date": 1552714264, "question_id": 55143474, "link": "https://stackoverflow.com/questions/55143474/how-to-publish-data-synchronously-using-mosquitto-publish", "title": "How to publish data synchronously using mosquitto_publish?", "body": "<p>I have written code (<code>mosquitto_publish()</code>) using Mosquitto to publish data to AWS.</p>\n\n<p>My problem is the sequence with which data is arriving on the MQTT broker. In the Paho client, I see <code>waitForCompletion()</code>, but nothing similar in Mosquitto. Would anyone please help me in dealing with this problem ?</p>\n"}, {"tags": ["c", "stdin"], "comments": [{"owner": {"reputation": 2653, "user_id": 3515931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4c0edddc6a265a0a22058bb2343328d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnH", "link": "https://stackoverflow.com/users/3515931/johnh"}, "edited": false, "score": 1, "creation_date": 1552484373, "post_id": 55143159, "comment_id": 97026839, "body": "@LiranFunaro - they asked for C - your link is about C++.  C doesn&#39;t do <code>cin</code> and <code>cout</code>.  For C, try reading something like this tutorial (I don&#39;t know how good it is - but surely you can Google some others on how to use <code>stdin</code> if it isn&#39;t what you need).  <a href=\"https://www.cs.bu.edu/teaching/c/file-io/intro/\" rel=\"nofollow noreferrer\">cs.bu.edu/teaching/c/file-io/intro</a>"}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 1, "creation_date": 1552484523, "post_id": 55143159, "comment_id": 97026948, "body": "You have already open this file, <code>#inlude &lt;stdio.h&gt;</code> and <code>fread(buff, size, 1, stdin);</code>"}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1552484577, "post_id": 55143159, "comment_id": 97026983, "body": "You don&#39;t open anything (your shell that does the input redirection did that), you just read from <code>stdin</code> the usual ways - <code>fgets()</code>, <code>getchar()</code>, <code>scanf()</code>, whatever."}, {"owner": {"reputation": 5681, "user_id": 1150918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81acdd9b6273c7860ac440c99eb747c?s=128&d=identicon&r=PG", "display_name": "Kamiccolo", "link": "https://stackoverflow.com/users/1150918/kamiccolo"}, "edited": false, "score": 0, "creation_date": 1552484955, "post_id": 55143159, "comment_id": 97027254, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4023895/how-do-i-read-a-string-entered-by-the-user-in-c\">How do I read a string entered by the user in C?</a>"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1552484972, "post_id": 55143159, "comment_id": 97027264, "body": "The file is not &quot;passed through stdin&quot;.  The file <i>is</i> stdin."}, {"owner": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "edited": false, "score": 0, "creation_date": 1552485247, "post_id": 55143159, "comment_id": 97027485, "body": "It seems I did not understand concept of stdin. I thought I had to pass it to some function. I got it working now"}], "answers": [{"tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": true, "score": 2, "last_activity_date": 1552485103, "creation_date": 1552485103, "answer_id": 55143537, "question_id": 55143159, "link": "https://stackoverflow.com/questions/55143159/how-to-read-a-file-passed-through-stdin-in-c/55143537#55143537", "title": "How to read a file passed through stdin in C", "body": "<p>You can directly read the data without having to open the file. <code>stdin</code> is already open. Without special checks your program doesn't know if it is a file or input from a terminal or from a pipe. </p>\n\n<p>You can access <code>stdin</code> by its file descriptor <code>0</code> using <code>read</code> or use functions from <code>stdio.h</code>. If the function requires a <code>FILE *</code> you can use the global <code>stdin</code>.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define BUFFERSIZE (100) /* choose whatever size is necessary */\n\n/* This code snippet should be in a function */\n\nchar buffer[BUFFERSIZE];\n\nif( fgets(buffer, sizeof(buffer), stdin) != NULL )\n{\n    /* check and process data */\n}\nelse\n{\n    /* handle EOF or error */\n}\n</code></pre>\n\n<p>You could also use <code>scanf</code> to read and convert the input data. This function always reads from <code>stdin</code> (in contrast to <code>fscanf</code>).</p>\n"}], "owner": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "accepted_answer_id": 55143537, "answer_count": 1, "score": 0, "last_activity_date": 1552485103, "creation_date": 1552484061, "question_id": 55143159, "link": "https://stackoverflow.com/questions/55143159/how-to-read-a-file-passed-through-stdin-in-c", "title": "How to read a file passed through stdin in C", "body": "<p>I want to pass a text file to a C program like this <code>./program &lt; text.txt</code>. I found out on SO that arguments passed like that dont appear in <code>argv[]</code> but rather in <code>stdin</code>. How can I open the file in stdin and read it?</p>\n"}, {"tags": ["c", "loops", "while-loop"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1552483889, "post_id": 55143078, "comment_id": 97026463, "body": "<code>count=count++;</code> - replace by <code>count++;</code> Or by <code>count = count + 1;</code>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552484044, "post_id": 55143078, "comment_id": 97026584, "body": "Hey, don&#39;t edit your question. It is not your compiler, so it <i>should</i> show the wrong code"}, {"owner": {"reputation": 23, "user_id": 11149521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934cbcc9bca727c24fc84c1a50d61087?s=128&d=identicon&r=PG&f=1", "display_name": "Elips", "link": "https://stackoverflow.com/users/11149521/elips"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552484214, "post_id": 55143078, "comment_id": 97026724, "body": "the code run but the average is wrong"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552484260, "post_id": 55143078, "comment_id": 97026752, "body": "Because you calculate it and print as integer."}, {"owner": {"reputation": 23, "user_id": 11149521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934cbcc9bca727c24fc84c1a50d61087?s=128&d=identicon&r=PG&f=1", "display_name": "Elips", "link": "https://stackoverflow.com/users/11149521/elips"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552484357, "post_id": 55143078, "comment_id": 97026827, "body": "i put the first integer 1 and the second 1 the average should be 1+1/2=1 but in output they said average =0"}, {"owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "edited": false, "score": 0, "creation_date": 1552484509, "post_id": 55143078, "comment_id": 97026939, "body": "your count will be 1 larger than it should be at all times because your count will increment even when the input is -1, try checking the input directly after the scanf like: if(grade == -1) { break;}"}, {"owner": {"reputation": 23, "user_id": 11149521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934cbcc9bca727c24fc84c1a50d61087?s=128&d=identicon&r=PG&f=1", "display_name": "Elips", "link": "https://stackoverflow.com/users/11149521/elips"}, "edited": false, "score": 0, "creation_date": 1552484927, "post_id": 55143078, "comment_id": 97027230, "body": "i should do it using only while loop"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11149521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934cbcc9bca727c24fc84c1a50d61087?s=128&d=identicon&r=PG&f=1", "display_name": "Elips", "link": "https://stackoverflow.com/users/11149521/elips"}, "edited": false, "score": 0, "creation_date": 1552548251, "post_id": 55143683, "comment_id": 97053130, "body": "how  we can solve the -1 input to  print no grades entered i cant solve it"}, {"owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "reply_to_user": {"reputation": 23, "user_id": 11149521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934cbcc9bca727c24fc84c1a50d61087?s=128&d=identicon&r=PG&f=1", "display_name": "Elips", "link": "https://stackoverflow.com/users/11149521/elips"}, "edited": false, "score": 0, "creation_date": 1552571899, "post_id": 55143683, "comment_id": 97067892, "body": "After the while loop has ended (User input -1) you would want to check that your count variable is greater than 0 before calculating the average and printing it."}], "tags": [], "owner": {"reputation": 348, "user_id": 11019146, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uN1b_TeM4-s/AAAAAAAAAAI/AAAAAAAAACE/el4YYLCuRvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11019146/patrick"}, "is_accepted": true, "score": 0, "last_activity_date": 1552485951, "last_edit_date": 1552485951, "creation_date": 1552485509, "answer_id": 55143683, "question_id": 55143078, "link": "https://stackoverflow.com/questions/55143078/develop-a-class-averaging-program-that-will-process-an-arbitrary-number-of-grade/55143683#55143683", "title": "Develop a class averaging program that will process an arbitrary number of grades each time the program run", "body": "<p>There is a few problematic lines in the code that you should fix.</p>\n\n<pre><code>count=count++;\n</code></pre>\n\n<p>as pointed out by Eugene's comments, count++ is similar to count = count + 1. This line should only be one of those. think of \"count = count++\" as \"count = count = count + 1\" which is a very odd way to format an increment. This line should only be <code>count++;</code></p>\n\n<pre><code>average=sum/count;\n</code></pre>\n\n<p>This line is doing integer division, where your question is looking for floating point answers. You can force these two integers to perform floating point division by multiplying it by 1.0 (a floating point value). It should look like this:</p>\n\n<pre><code>average = 1.0 * sum / count;\n</code></pre>\n\n<p>Finally, your loop will increment the counter each time no matter what is input, as well as add it to the sum. When -1 is input, it will increment the count and add it to the sum before the while loop has ended. You can put these operations into a simple if statement to ensure this is accounted for: </p>\n\n<pre><code>printf(\"enter grade=\");\nscanf(\"%d\",&amp;grade);\nif (grade &gt;= 0) {\n    sum=grade+sum;\n    count++;\n}\n</code></pre>\n\n<p>Hopefully this helps!</p>\n\n<p>Note: This does not account for the case where no numbers are input before -1, I will leave this for you to play with, you can come back to this question if you have further issues</p>\n"}], "owner": {"reputation": 23, "user_id": 11149521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934cbcc9bca727c24fc84c1a50d61087?s=128&d=identicon&r=PG&f=1", "display_name": "Elips", "link": "https://stackoverflow.com/users/11149521/elips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 55143683, "answer_count": 1, "score": -3, "last_activity_date": 1552485951, "creation_date": 1552483838, "last_edit_date": 1552484166, "question_id": 55143078, "link": "https://stackoverflow.com/questions/55143078/develop-a-class-averaging-program-that-will-process-an-arbitrary-number-of-grade", "title": "Develop a class averaging program that will process an arbitrary number of grades each time the program run", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{\nint grade,count,sum,average;\ngrade=0;\ncount=0;\nsum=0;\nwhile(grade!=-1)\n{\nprintf(\"enter grade=\");\nscanf(\"%d\",&amp;grade);\nsum=grade+sum;\ncount=count++;\n}\naverage=sum/count;\nprintf(\"the average is=%d\",average);\nreturn 0;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/1rmVy.png\" rel=\"nofollow noreferrer\">this is the question and the output!!!</a>\ni have a homework to do this exercise i wrote it but i dont know where is wrong so plz guys i want a little help !!!\nthanks</p>\n"}, {"tags": ["c", "arm", "embedded", "nxp-microcontroller"], "comments": [{"owner": {"reputation": 6250, "user_id": 488700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/620a68b8a42a5af384929133de068c63?s=128&d=identicon&r=PG", "display_name": "Artur", "link": "https://stackoverflow.com/users/488700/artur"}, "edited": false, "score": 3, "creation_date": 1552484578, "post_id": 55142612, "comment_id": 97026984, "body": "Handle your problem step by step. Since you already have oscilloscope and can verify it easily - write simple code to set your desired pins as outputs and make sure you know how to set them to 0 or 1. Later write code to handle LCD or whatever device you want."}], "owner": {"reputation": 21, "user_id": 2293738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/143bd96dec35bee24439a3298b35414f?s=128&d=identicon&r=PG", "display_name": "user2293738", "link": "https://stackoverflow.com/users/2293738/user2293738"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552482367, "creation_date": 1552482367, "question_id": 55142612, "link": "https://stackoverflow.com/questions/55142612/lcd-interfacing-with-arm-cortex-m0-lpc845", "title": "LCD interfacing with ARM cortex M0+ lpc845", "body": "<p>I'm trying to interface 8x2 lcd using parallel interfacing[4 bit mode],\nDisplay used - 8x2 lcd [PC 0802--A]\nST7066U--Dot Matrix LCD Controller/Driver</p>\n\n<p>Since i'm trying to interface using GPIO pins, not using I2C or SPI\ninterface, and since no drivers are there for this particular MCU[LPC845],\nI compared with lpc2148 MCU [lcd.c and lcd.h files], and have made the changes, but not able to write to the display.</p>\n\n<p>And when checked the data/command signals in the oscilloscope, in data pins\nI'm getting float voltages[i.e., for d4-D7] LOW signal on this pins, and \nhigh signals on command pins[RS,RW,EN].</p>\n\n<p>Kindly suggest me the process of writing the char/string to the display varies for ARM mcu?as i'm referring lpc2148 libraries.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["c", "dynamic-memory-allocation", "realloc"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1552482175, "post_id": 55142519, "comment_id": 97025275, "body": "<i>The contents will be unchanged in the range from the start of the region up to the <b>minimum of the old and new sizes</i></b> - it&#39;s half of your citation."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1552482309, "post_id": 55142519, "comment_id": 97025354, "body": "<code>void **ptr = realloc(ptr, nsize);</code> means that <code>ptr</code> is not initialized when passed to <code>realloc</code>: undefined behaviour"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1552482354, "post_id": 55142519, "comment_id": 97025383, "body": "@Jabberwocky Not necessarily simply shortened. It still can be re-allocated in a different place."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552482382, "post_id": 55142519, "comment_id": 97025403, "body": "@EugeneSh. yes of course. Anyway the documentation is clear."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1552482424, "post_id": 55142519, "comment_id": 97025432, "body": "@Jabberwocky if this is OP real code it&#39;s a bug, because right hand <code>ptr</code> has an undefined value (you initialize it with the return of <code>realloc</code> which hasn&#39;t been called yet)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1552482485, "post_id": 55142519, "comment_id": 97025478, "body": "<i>mental note to delete the account</i> :)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1552482489, "post_id": 55142519, "comment_id": 97025479, "body": "Why? Have you been elected already? It says 6 more days"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1552482496, "post_id": 55142519, "comment_id": 97025486, "body": "@Jean-Fran&#231;oisFabre &quot;If the original size is size&quot;...sounds like an allocation beforehand?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552482532, "post_id": 55142519, "comment_id": 97025513, "body": "@EugeneSh. people make predictions :) but you&#39;re right. Not done at all"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552482548, "post_id": 55142519, "comment_id": 97025527, "body": "@EugeneSh.: He&#39;s pretty high on the list."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1552482570, "post_id": 55142519, "comment_id": 97025538, "body": "Yeah. You&#39;ve got one of my votes BTW :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 4, "creation_date": 1552482580, "post_id": 55142519, "comment_id": 97025545, "body": "unless <code>ptr</code> comes from a different scope you all agree that <code>void **ptr = realloc(ptr,size)</code> is a big issue right?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1552482659, "post_id": 55142519, "comment_id": 97025605, "body": "Me too\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f\u034f"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1552482673, "post_id": 55142519, "comment_id": 97025618, "body": "@Jean-Fran&#231;oisFabre: Yes you&#39;re correct. Moderator 15, Cat 0. Oops."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1552482708, "post_id": 55142519, "comment_id": 97025644, "body": "What other scope can the <code>ptr</code> argument be? It is <b>wrong</b> not poor, because the argument passed must be either <code>NULL</code>  or a previously allocated pointer."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1552482727, "post_id": 55142519, "comment_id": 97025654, "body": "thanks, and BTW it&#39; s a duplicate if you read the question properly"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1552482984, "post_id": 55142519, "comment_id": 97025856, "body": "@Jean-Fran&#231;oisFabre I&#39;m not sure this is a duplicate of <a href=\"https://stackoverflow.com/questions/9575122/can-i-assume-that-calling-realloc-with-a-smaller-size-will-free-the-remainder\" title=\"can i assume that calling realloc with a smaller size will free the remainder\">stackoverflow.com/questions/9575122/&hellip;</a>. The dupe doesn&#39;t mention the <i>content</i> of the memory being reallocated."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1552484057, "post_id": 55142519, "comment_id": 97026594, "body": "true, I&#39;ve re-read and no. But it&#39;s still an &quot;undefined behaviour&quot; question. I&#39;ve reopened and answered it :)"}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 5, "last_activity_date": 1552485200, "last_edit_date": 1552485200, "creation_date": 1552482218, "answer_id": 55142564, "question_id": 55142519, "link": "https://stackoverflow.com/questions/55142519/behavior-of-realloc-when-the-memory-is-shrunk/55142564#55142564", "title": "Behavior of `realloc()` when the memory is shrunk", "body": "<p>First of all,</p>\n\n<pre><code> void **ptr = realloc(ptr, nsize); \n</code></pre>\n\n<p>is wrong, as you're using <code>ptr</code> uninitialized (that is being defined here), and as per <code>realloc()</code> function description from <code>C11</code>, chapter \u00a77.22.3.5</p>\n\n<blockquote>\n  <p><em>If <code>ptr</code> is a <strong>null pointer</strong>, the <code>realloc</code> function behaves like the <code>malloc</code> function for the\n  specified size. Otherwise, if <code>ptr</code> does not match <strong>a pointer earlier returned by a memory\n  management function</strong>, or if the space has been deallocated by a call to the free or\n  <code>realloc</code> function, the behavior is undefined. [...]</em></p>\n</blockquote>\n\n<p>So, your code invokes undefined behavior, as you're passing a pointer which contains an indeterminate value.</p>\n\n<p>However, considering your case to be something like</p>\n\n<pre><code>void **ptr = malloc(size);\nassert (ptr);\nptr = realloc(ptr, nsize);\n</code></pre>\n\n<p>it is a very poor usage, in case <code>realloc</code> fails (where it does not alter the original memory and return <code>NULL</code>), you'll end up losing the actual pointer, too. Use an intermediate variable to store validate the returned pointer, and then assign it back to the original variable, as needed.</p>\n\n<p>That said, re-check the quote (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>The <code>realloc()</code> function changes the size of the memory block pointed to by <code>ptr</code> to size bytes. <strong>The contents will be unchanged in the range from the start of the region up to the minimum of the old and new sizes.</strong> If the new size is larger than the old size, the added memory will not be initialized.</p>\n</blockquote>\n\n<p>So, to answer</p>\n\n<blockquote>\n  <p><em>If the original size is <code>size</code>, does that mean <code>ptr + nsize + 1</code> still contains allocated entries?</em></p>\n</blockquote>\n\n<p>No, we can;t say. After the successful <code>realloc()</code> call, we are only allowed to access up to <code>ptr + nsize - 1</code>. Trying to read/write <code>ptr + nsize</code> and onwards is undefined, as that memory location does not belong to your process anymore and that memory location is \"invalid\". </p>\n\n<p>You should not have any need to bother about the content beyond <code>ptr + nsize - 1</code>, anyways.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1552484842, "post_id": 55143145, "comment_id": 97027179, "body": "<code>you have no guarantee of that.</code>..umm, why? <code>nsize</code> is the new size, right?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1552484974, "post_id": 55143145, "comment_id": 97027266, "body": "the plus one is irrelevant, yes. But if <code>nsize</code> is the new size, then all data past it is unreliable. That&#39;s what I meant."}, {"owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "edited": false, "score": 0, "creation_date": 1552488972, "post_id": 55143145, "comment_id": 97030276, "body": "Thanks for the response (and yes, I didn&#39;t mean to write the <code>void **</code> in front of <code>ptr</code> as that would be initializing it). So, prior to reallocating the memory, should I loop for the data in <code>ptr + nsize + 1</code> and free it so that there isn&#39;t a memory leak?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1552490540, "post_id": 55143145, "comment_id": 97031450, "body": "free it? no <code>realloc</code> does that already. You can set it to 0 or 0xDEADBEEF or whatever just in case you stumble on that afterwards."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1552495399, "post_id": 55143145, "comment_id": 97034691, "body": "It&#39;s a minor point, and safe programming certainly requires using a temporary to store the <code>realloc</code> return value, but it&#39;s hard to see how <code>realloc</code> could fail if it is asked to reduce the size of the allocation, since it is required to preserve the previous allocation if an error is returned. So even if <code>realloc</code> wants to copy the storage into a new region and can&#39;t find memory to do that, it still has the option of just returning the original allocation."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1552496397, "post_id": 55143145, "comment_id": 97035273, "body": "that&#39;s really a good point. We could imagine that the system would deallocate the memory, then a higher priority task/interrupt/whatever takes over and allocates some memory, stealing the process memory. I don&#39;t know if it&#39;s a real scenario though. You may also point out that <code>realloc</code> rarely/never returns <code>NULL</code> in modern systems because of virtualization and paging (I&#39;m not a specialist)"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1552496807, "post_id": 55143145, "comment_id": 97035537, "body": "But it can&#39;t deallocate the memory until it definitely has the replacement memory and has copied the original content, because if it fails it must not modify the original. If the new allocation is somehow stolen, the copy will fail. Anyway, like I said, minor point. Both <code>realloc</code> and <code>malloc</code> will fail on modern systems if the request is larger than the process VM limit, see <code>rlimit</code>. In particular, <code>malloc((size_t)-1)</code> almost certainly returns <code>NULL</code>."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1552497230, "post_id": 55143145, "comment_id": 97035794, "body": "okay, realloc with shrink <i>cannot</i> fail. If another block is allocated to move the memory and that fails, then the system will probably keep the current block, not moving the data. You&#39;re right. interesting chat."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 8, "last_activity_date": 1552485013, "last_edit_date": 1552485013, "creation_date": 1552484011, "answer_id": 55143145, "question_id": 55142519, "link": "https://stackoverflow.com/questions/55142519/behavior-of-realloc-when-the-memory-is-shrunk/55143145#55143145", "title": "Behavior of `realloc()` when the memory is shrunk", "body": "<p>first you probably mean:</p>\n\n<pre><code>void **ptr = malloc(nsize*2);\n</code></pre>\n\n<p>then</p>\n\n<pre><code>ptr = realloc(ptr, nsize);\n</code></pre>\n\n<p>or the safe way:</p>\n\n<pre><code>void **ptr2 = realloc(ptr, nsize);\nif (ptr2 != NULL)\n{\n   ptr = ptr2;\n} // else failure\n</code></pre>\n\n<p>because using <code>realloc(ptr,nsize)</code> to <em>set</em> the value of <code>ptr</code> is undefined behaviour and probably crashes.</p>\n\n<p>Now, the system reduces the memory size as stated in <a href=\"https://stackoverflow.com/questions/9575122/can-i-assume-that-calling-realloc-with-a-smaller-size-will-free-the-remainder\">Can I assume that calling realloc with a smaller size will free the remainder?</a></p>\n\n<p>Now your question is:</p>\n\n<blockquote>\n  <p>If the original size is <code>size</code>, does that mean <code>ptr + nsize + 1</code> still contains allocated entries? </p>\n</blockquote>\n\n<p>you have no guarantee of that. This is undefined behaviour from <code>ptr + nsize</code> already (thanks Sourav).</p>\n\n<p>Why? this area doesn't belong to your program anymore.</p>\n\n<p>You could have bugs reading past the new smaller array, which would yield valid results if the old data was there, which is probable, true, but:</p>\n\n<ul>\n<li>the system could keep the same memory location, but reuse this block immediately for other data</li>\n<li>the system could <em>move</em> the new data to another memory location (so old <code>ptr</code> would be different from new <code>ptr</code>, hence the return value that some people ignore and it \"works\" until it crashes), in that case, what's behind is complete irrelevant data.</li>\n</ul>\n\n<p>If both conditions above don't happen, it's very likely that the data is unchanged. <code>realloc</code> won't going to set to 0 some memory that isn't supposed to be used. Some debug frameworks (which ones I don't remember) put a pattern when deallocating memory so if you stumble on this pattern in your program it's a clear indication that you're reading an unallocated/uninitialized memory, but it has overhead, so it's not done by default. You can \"overload\" the memory allocation functions to do that yourself too.</p>\n\n<p>Anyhow, make sure you're not reading past the new array, as what you'll find isn't guaranteed.</p>\n"}], "owner": {"reputation": 183, "user_id": 9785313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R0msl.png?s=128&g=1", "display_name": "S. Sharma", "link": "https://stackoverflow.com/users/9785313/s-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 524, "favorite_count": 0, "accepted_answer_id": 55143145, "answer_count": 2, "score": 4, "last_activity_date": 1552488774, "creation_date": 1552482085, "last_edit_date": 1552488774, "question_id": 55142519, "link": "https://stackoverflow.com/questions/55142519/behavior-of-realloc-when-the-memory-is-shrunk", "title": "Behavior of `realloc()` when the memory is shrunk", "body": "<p>The <a href=\"https://linux.die.net/man/3/realloc\" rel=\"nofollow noreferrer\">man</a> page of <code>realloc()</code> says:</p>\n\n<blockquote>\n  <p>The <code>realloc()</code> function changes the size of the memory block pointed to by <code>ptr</code> to <code>size</code> bytes. The contents will be unchanged in the range from the start of the region up to the minimum of the old and new sizes. If the new size is larger than the old size, the added memory will not be initialized. </p>\n</blockquote>\n\n<p>However, the man page doesn't say anything about what happens if the new size is less than the old size. For example, if I have the following code:</p>\n\n<pre><code>ptr = realloc(ptr, nsize); // Where nsize &lt; the original size and ptr is of type void **\n</code></pre>\n\n<p>If the original size is <code>size</code>, does that mean <code>ptr + nsize + 1</code> still contains allocated entries?</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["c", "struct", "scope", "header", "declaration"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1552478606, "post_id": 55141452, "comment_id": 97022958, "body": "Yes, you can. What did you try?"}, {"owner": {"reputation": 11, "user_id": 6542519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bc6da9dc12d0d16b58f151bcd277e2c?s=128&d=identicon&r=PG", "display_name": "user21553", "link": "https://stackoverflow.com/users/6542519/user21553"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1552478754, "post_id": 55141452, "comment_id": 97023065, "body": "@SouravGhosh I have tried to write struct Function_Call; at the beggining of the file, But it didn&#39;t work"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1552480911, "post_id": 55141452, "comment_id": 97024490, "body": "I&#39;ve never seen the error message <code>But it didn&#39;t work</code> from a compiler.  What was the <i>actual</i>, <b>exact</b> result?"}], "owner": {"reputation": 11, "user_id": 6542519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bc6da9dc12d0d16b58f151bcd277e2c?s=128&d=identicon&r=PG", "display_name": "user21553", "link": "https://stackoverflow.com/users/6542519/user21553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1552478772, "answer_count": 0, "score": 0, "last_activity_date": 1552478539, "creation_date": 1552478539, "question_id": 55141452, "link": "https://stackoverflow.com/questions/55141452/it-is-possible-to-declare-a-struct-at-the-start-of-the-header-and-to-define-it", "closed_reason": "Duplicate", "title": "It is possible to declare a struct at the start of the header, and to define it later in the file?", "body": "<p>I have a problem with a task of mine. I have to implement undos and redos for some operations to a specific set. In the header file of the controller I have the following code.</p>\n\n<pre><code>typedef struct {\n    Function_Call* undo_function;\n    Function_Call* redo_function;\n\n}Operation ;\n\ntypedef struct{\n\n    struct Operation** operations;\n    int cf;\n    int index;\n    int size;\n    int max_size;\n\n}UndoController;\n\ntypedef struct{\n\n    Medicine_Repository* medicine_repository;\n    UndoController* undoController;\n\n}Controller;\n\n\ntypedef struct{\n\n    void (*func)(Medicine*,Controller*);\n    Medicine* argument_medicine;\n    Controller* argument_controller;\n\n}Function_Call;\n</code></pre>\n\n<p>The controller has to know about the undo_controller, the undo_controller needs to know about the Operation, Operation needs to know about the Function_Call, and the Function_Call needs to know about the controller. In this \"loop\" one struct Won't be able to see what it must, and an error would occurr. Is it possible to pre-declare somehow a struct at the beggining of the file and to define it later in the same header file? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 429, "user_id": 10209003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d9d1dd420c5e9381d2978720c47940?s=128&d=identicon&r=PG&f=1", "display_name": "Korni", "link": "https://stackoverflow.com/users/10209003/korni"}, "edited": false, "score": 0, "creation_date": 1552478551, "post_id": 55141333, "comment_id": 97022910, "body": "just save it in an e.g. <code>char</code> array und use it when desired"}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 0, "creation_date": 1552478562, "post_id": 55141333, "comment_id": 97022919, "body": "You can save this in string, if you parse int32 declare <code>char binaryResult[33] = {0};</code>. 33 because of &#39;\\0&#39; on end string."}, {"owner": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 2, "creation_date": 1552478570, "post_id": 55141333, "comment_id": 97022924, "body": "I don\u2019t understand your question. IP addresses are just numbers. You can just test these conditions with bit masks."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 13359, "user_id": 1779477, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f62e1d28063f41fd9728d811fea3a84c?s=128&d=identicon&r=PG&f=1", "display_name": "idmean", "link": "https://stackoverflow.com/users/1779477/idmean"}, "edited": false, "score": 0, "creation_date": 1552478641, "post_id": 55141333, "comment_id": 97022987, "body": "@idmean or, even simple integer comparison."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1552478673, "post_id": 55141333, "comment_id": 97023012, "body": "<code>base10 or base 16</code> IPv4 is usually base10."}, {"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 1, "creation_date": 1552479347, "post_id": 55141333, "comment_id": 97023440, "body": "<code>for (c = 8; c &gt;= 0; c--)</code> will produce 9-bit output instead of 8."}, {"owner": {"reputation": 433, "user_id": 1300067, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/eea2f83b188964da51603ca16153ee8a?s=128&d=identicon&r=PG", "display_name": "Pavan", "link": "https://stackoverflow.com/users/1300067/pavan"}, "edited": false, "score": 0, "creation_date": 1552479396, "post_id": 55141333, "comment_id": 97023473, "body": "Can you add more details, what will be you input, you can use % (mod function) after shift operator (&lt;&lt; or &gt;&gt;)."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552479408, "post_id": 55141333, "comment_id": 97023482, "body": "we need more info here. for instance the type of <code>ip4</code>"}, {"owner": {"reputation": 1077, "user_id": 7545157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZqbEb.jpg?s=128&g=1", "display_name": "Sven Kr&#252;ger", "link": "https://stackoverflow.com/users/7545157/sven-kr%c3%bcger"}, "edited": false, "score": 0, "creation_date": 1552479874, "post_id": 55141333, "comment_id": 97023812, "body": "Welcome to SO!... Why do you want to convert an IP-Address to an ASCII-String of zeros and ones at all?"}, {"owner": {"reputation": 9, "user_id": 11196881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d31babe17a7cd5ef7dde18b6dbfe80f?s=128&d=identicon&r=PG&f=1", "display_name": "Userrturk", "link": "https://stackoverflow.com/users/11196881/userrturk"}, "edited": false, "score": 0, "creation_date": 1552480106, "post_id": 55141333, "comment_id": 97023959, "body": "I added my code from beginning so that you can see what (ip4) is.For example program will ask the user (Enter ip adress:) and user input such an ip adres (168.122.1.2) in that ip adress (168 is equal to ip1)(122 is equal ip2)(1 equal ip 3)(2 equan ip4).So I have 4 for loop to convert it binary each block.But I need to save the binary format to continue .My question is how can I save for example (00000001) for ip4.I need to save as an integer."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1552481925, "post_id": 55141333, "comment_id": 97025128, "body": "@Userrturk please don&#39;t add clarifications as tons of text in a commenbt but <a href=\"https://stackoverflow.com/posts/55141333/edit\">edit</a>  your question instead. And please don&#39;t post pictures of text. Post text as text."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11196881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d31babe17a7cd5ef7dde18b6dbfe80f?s=128&d=identicon&r=PG&f=1", "display_name": "Userrturk", "link": "https://stackoverflow.com/users/11196881/userrturk"}, "edited": false, "score": 0, "creation_date": 1552480282, "post_id": 55141769, "comment_id": 97024087, "body": "I added my code from beginning so that you can see what (ip4) is.For example program will ask the user (Enter ip adress:) and user input such an ip adres (168.122.1.2) in that ip adress (168 is equal to ip1)(122 is equal ip2)(1 equal ip 3)(2 equan ip4).So I have 4 for loop to convert it binary each block.But I need to save the binary format to continue .My question is how can I save for example (00000001) for ip4.I need to save as an integer"}], "tags": [], "owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "is_accepted": false, "score": 0, "last_activity_date": 1552479614, "creation_date": 1552479614, "answer_id": 55141769, "question_id": 55141333, "link": "https://stackoverflow.com/questions/55141333/how-can-i-save-the-output-of-for-loop-in-terms-of-integer/55141769#55141769", "title": "How can I save the output of for loop in terms of integer?", "body": "<p>You want to convert an IP address in binary form, but this is not what you've been asked to do.</p>\n\n<p>The question you have could be reduced to \"what are the first three bits of this 32bits integer?\"</p>\n\n<pre><code>void start_of_ip(int32_t ip4) {\n\n    /* testing if first bit is not set \n    0x80000000 is 1000 0000 0000 0000 0000 0000 0000 0000 */\n    if (!(ip4 &amp; 0x80000000)) {\n        /* class A IP*/\n        puts(\"start with b0\")\n    } else {    \n        /* in this block, we know that first bit is set */\n\n        /* testing if second bit is not set */          \n        if (!(ip4 &amp; 0x40000000)) {\n            /* class B IP*/\n            puts(\"start with b10\");\n        } else {                \n            /* in this block, we know that first two bits are set */\n\n            /* testing if third bit is not set */           \n            if (!(ip4 &amp; 0x20000000)) {\n                /* class C IP*/\n                puts(\"start with b110\");\n            } else {\n                /* the rest */\n                puts(\"other case\");\n            }               \n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 11196881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d31babe17a7cd5ef7dde18b6dbfe80f?s=128&d=identicon&r=PG&f=1", "display_name": "Userrturk", "link": "https://stackoverflow.com/users/11196881/userrturk"}, "edited": false, "score": 1, "creation_date": 1552838978, "post_id": 55185690, "comment_id": 97154174, "body": "Thank you very very very much.I cant explain with words.It is very important for me .The dead line is today.I saw it 2 min ago.I  was give up.I will finish the assignment.Thanks &lt;3"}], "tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 0, "last_activity_date": 1552663038, "creation_date": 1552663038, "answer_id": 55185690, "question_id": 55141333, "link": "https://stackoverflow.com/questions/55141333/how-can-i-save-the-output-of-for-loop-in-terms-of-integer/55185690#55185690", "title": "How can I save the output of for loop in terms of integer?", "body": "<blockquote>\n  <p>I need to save as an integer.</p>\n</blockquote>\n\n<p>You're lucky, since you already have saved your IP address parts <code>ip1</code>\u2026<code>ip4</code> as integers.</p>\n\n<blockquote>\n  <p>But I need to save the binary format to continue .</p>\n</blockquote>\n\n<p>Probably the integers are already stored in a plain binary representation, but the C standard guarantees that:</p>\n\n<blockquote>\n  <p>Values stored in \u2026 objects of type unsigned char shall be\n  represented using a pure binary notation.</p>\n</blockquote>\n\n<p>So, at least after storing an address part in an <code>unsigned char</code>,\nyou can safely continue with step <em>e.</em> of your programming assignment without worrying about the textual representation of the address. To determine the address class according to the shown table, it suffices to shift and mask the first number:</p>\n\n<pre><code>        if (menu == 3)\n        {\n            unsigned char first = ip1;  // convert to \"a pure binary notation\"\n            char class = first&gt;&gt;7 == 0 ? 'A'    // starts with 0\n                       : first&gt;&gt;6 == 2 ? 'B'    // starts with 10\n                       : first&gt;&gt;5 == 6 ? 'C'    // starts with 110\n                       :                 'D';   // the rest\n            printf(\"The class of the given IP address is: %c\\n\", class);\n            break;\n        }\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11196881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d31babe17a7cd5ef7dde18b6dbfe80f?s=128&d=identicon&r=PG&f=1", "display_name": "Userrturk", "link": "https://stackoverflow.com/users/11196881/userrturk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 1, "accepted_answer_id": 55185690, "answer_count": 2, "score": -2, "last_activity_date": 1552663198, "creation_date": 1552478157, "last_edit_date": 1552663198, "question_id": 55141333, "link": "https://stackoverflow.com/questions/55141333/how-can-i-save-the-output-of-for-loop-in-terms-of-integer", "title": "How can I save the output of for loop in terms of integer?", "body": "<pre><code>for (c = 8; c &gt;= 0; c--){\n    k = ip4 &gt;&gt; c;\n    if (k &amp; 1)\n        printf(\"1\");\n    else\n        printf(\"0\");\n}\n</code></pre>\n\n<p>Hello everyone.I'm trying to convert an ip adress from  base10 or  base 16 to binary.I wrote this code to convert ip adress to binary.But also I need to save the output of for loop so that answer such a question and continue code.\nQuestion is on th link.It is forbidden to use arrays and data structures.Here is my assignment that I'm trying to solve.I will be very happy if you solve my problem.<img src=\"https://i.stack.imgur.com/6TKCI.png\" alt=\"enter image description here\">\nThan you for your help.<a href=\"https://i.stack.imgur.com/nOBUZ.png\" rel=\"nofollow noreferrer\">Here is my code from beginnig to for loop.</a>\n<img src=\"https://i.stack.imgur.com/0gSlQ.png\" alt=\"enter image description here\">\nI added my code from beginning so that you can see what (ip4) is.For example program will ask the user (Enter ip adress:) and user input such an ip adres (168.122.1.2) in that ip adress (168 is equal to ip1)(122 is equal ip2)(1 equal ip 3)(2 equan ip4).So I have 4 for loop to convert it binary each block.But I need to save the binary format to continue .My question is how can I save for example (00000001) for ip4.I need to save as an integer.</p>\n\n<pre><code>    #include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\nint main (){\n\nchar ch;    \nint base,ip1,ip2,ip3,ip4,ip;\nint sub1,sub2,sub3,sub4,subnet;\nprintf(\"Please enter the Base for your IP Address (10/16):\");\nscanf(\"%d\",&amp;base);\nif(base!=10 &amp;&amp; base!=16)\n    printf(\"Sorry that is not a valid base!\\n\");\nif(base==10){\nprintf(\"Please enter the IP Address:\");\nscanf(\"%d%c%d%c%d%c%d\",&amp;ip1,&amp;ch,&amp;ip2,&amp;ch,&amp;ip3,&amp;ch,&amp;ip4);\nip=ip1+ip2+ip3+ip4;\nif(ip&gt;0&amp;&amp;ip&lt;1020)\n    printf(\"Thanks it is a valid IP address!\\n\");\nelse\n    printf(\"This is NOT a valid IP Address!\");  \n\nprintf(\"Please enter the Subnet Mask: \");\nscanf(\"%d%c%d%c%d%c%d\",&amp;sub1,&amp;ch,&amp;sub2,&amp;ch,&amp;sub3,&amp;ch,&amp;sub4);\nsubnet=sub1+sub2+sub3+sub4;\nif(subnet&gt;0&amp;&amp;subnet&lt;1020)\nprintf(\"Thanks it is a valid Subnet Mask!\\n\");}\n\nelse if(base==16){\nprintf(\"Please enter the IP Address:\");\nscanf(\"%d%c%d%c%d%c\",&amp;ip1,&amp;ch,&amp;ip2,&amp;ch,&amp;ip3,&amp;ch,&amp;ip4);\nip=ip1+ip2+ip3+ip4;\nif(ip&gt;0&amp;&amp;ip&lt;1020)\n    printf(\"Thanks it is a valid IP address!\\n\");\nelse\n    printf(\"This is NOT a valid IP Address!\");  \nprintf(\"Please enter the Subnet Mask: \");\nscanf(\"%d%c%d%c%d%c%d\",&amp;sub1,&amp;ch,&amp;sub2,&amp;ch,&amp;sub3,&amp;ch,&amp;sub4);\nsubnet=sub1+sub2+sub3+sub4;\nif(subnet&gt;0&amp;&amp;subnet&lt;1020)\nprintf(\"Thanks it is a valid Subnet Mask!\\n\");}         \n\nint menu,k,c;\nwhile(1){\nprintf(\"1. Convert IP address to binary\\n\");\nprintf(\"2. Convert subnet mask to binary\\n\");\nprintf(\"3. Specify the class of the IP address\\n\");\nprintf(\"4. Specify the number of host addresses availablen\\n\");\nprintf(\"5. Provide new IP Address and subnet mask\\n\");\nprintf(\"6. Exit\\n\");\nscanf(\"%d\",&amp;menu);\nwhile(menu&gt;0 &amp;&amp; menu&lt;6){\n    if(menu==1){\n        for (c = 8; c &gt;= 0; c--)\n  {\n    k = ip1 &gt;&gt; c;\n\n    if (k &amp; 1)\n      printf(\"1\");\n    else\n      printf(\"0\");\n  }\n    printf(\".\");\n  for (c = 8; c &gt;= 0; c--)\n  {\n    k = ip2 &gt;&gt; c;\n\n    if (k &amp; 1)\n      printf(\"1\");\n    else\n      printf(\"0\");\n  }\n    printf(\".\");\n    for (c = 8; c &gt;= 0; c--)\n  {\n    k = ip3 &gt;&gt; c;\n\n    if (k &amp; 1)\n      printf(\"1\");\n    else\n      printf(\"0\");\n  } \n    printf(\".\");\n  for (c = 8; c &gt;= 0; c--)\n  {\n    k = ip4 &gt;&gt; c;\n\n    if (k &amp; 1)\n      printf(\"1\");\n    else\n      printf(\"0\");\n\n  }\n        printf(\"\\n\");\n        break;\n\n    }\n    else if (menu==2){\n\n    for (c = 8; c &gt;= 0; c--)\n  {\n    k = sub1 &gt;&gt; c;\n\n    if (k &amp; 1)\n      printf(\"1\");\n    else\n      printf(\"0\");\n  }\n    printf(\".\");\n  for (c = 8; c &gt;= 0; c--)\n  {\n    k = sub2 &gt;&gt; c;\n\n    if (k &amp; 1)\n      printf(\"1\");\n    else\n      printf(\"0\");\n  }\n    printf(\".\");\n    for (c = 8; c &gt;= 0; c--)\n  {\n    k = sub3 &gt;&gt; c;\n\n    if (k &amp; 1)\n      printf(\"1\");\n    else\n      printf(\"0\");\n  } \n    printf(\".\");\n  for (c = 8; c &gt;= 0; c--)\n  {\n    k = sub4 &gt;&gt; c;\n\n    if (k &amp; 1)\n      printf(\"1\");\n    else\n      printf(\"0\");\n\n  }\n        printf(\"\\n\");\n        break;\n}\n\n}\n}\n\n    return 0;\n\n}\n</code></pre>\n\n<p>You can test the code.But you should enter base 10 and ip will be just inlude point ant integer just like 192.168.1.1 also subnet is need to be like that.</p>\n"}, {"tags": ["c", "multithreading", "combinatorics", "hyperparameters"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1552476857, "post_id": 55140872, "comment_id": 97021844, "body": "How about forgetting pthreads and looking into <a href=\"https://en.wikipedia.org/wiki/OpenMP\" rel=\"nofollow noreferrer\">OpenMP</a> instead. You&#39;re not doing <i>threading</i> as such, just parallel calculations."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1552477060, "post_id": 55140872, "comment_id": 97021947, "body": "Additionally... you&#39;ve got 4 CPUs so 25 threads is an overkill"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552477275, "post_id": 55140872, "comment_id": 97022097, "body": "As long as the loop limit can be divided evenly by the number of threads, then it&#39;s easy to calculate the ranges, use a structure for those ranges (i.e. starting index and the number of iterations to make) and also have that structure contain a pointer to the first element of your array. Then pass that structure to the thread."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552477356, "post_id": 55140872, "comment_id": 97022153, "body": "As for memory usage, processes on POSIX systems <i>duplicates</i> the memory of the parent process (even through it commonly uses copy-on-write for efficiency), while in a multi-threaded process all threads <i>share</i> the same memory."}], "answers": [{"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1552477007, "creation_date": 1552477007, "answer_id": 55140983, "question_id": 55140872, "link": "https://stackoverflow.com/questions/55140872/c-multithreading-nested-for-loops-problem-of-combinatorial-explosion-from-hype/55140983#55140983", "title": "C Multithreading nested for loops - problem of combinatorial explosion from hyperparameter grid search", "body": "<p>There's <a href=\"https://en.wikipedia.org/wiki/OpenMP\" rel=\"nofollow noreferrer\">OpenMP</a> which provides an API for parallelisation. </p>\n\n<p>If you want to do it manually with pthreads etc, you have to put the loops in a thread callback, then pass each thread the <code>a</code> min and max values as it's individual job order. They can all access the array simultaneously as long as no thread overwrites the memory area used by another thread.</p>\n\n<p>You'll have to benchmark the code and see how many threads that are ideal, since thread creation comes with overhead code.</p>\n"}], "owner": {"reputation": 1, "user_id": 11196420, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2dxmHlENFyg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reV009r3P0cKGvl-QRZMkYWD1b8BQ/mo/photo.jpg?sz=128", "display_name": "Chris K", "link": "https://stackoverflow.com/users/11196420/chris-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552477007, "creation_date": 1552476606, "question_id": 55140872, "link": "https://stackoverflow.com/questions/55140872/c-multithreading-nested-for-loops-problem-of-combinatorial-explosion-from-hype", "title": "C Multithreading nested for loops - problem of combinatorial explosion from hyperparameter grid search", "body": "<p>I have a small C program with less than 500 lines of code. Here is a simplified version. The actual one is more compute intensive.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint array_a [100000000];\n// array 382 MB in size, 100 million x 4 bytes\n\nint main(void)\n{\n    for (int a = 0; a &lt; 1000; a++)\n        {\n        for (int b = 0; b &lt; 1000; b++)\n            {\n            for (int c = 0; c &lt; 1000; c++)\n                {\n                for (int i = 0; i &lt; 100000000; i++)\n                    {\n                    int x = array_a[i] + a + b + c;\n                    }\n                }\n            }\n        }\nreturn 0;\n}\n</code></pre>\n\n<p>Right now I do manual multithreading for my 4-core cpu where I compile 4 different versions of the code. Using the example above, each process would then use 400 MB of ram, for a total of 1.6 GB ram usage.</p>\n\n<p>I need to change just two numbers in the first for loop for the 4 different compilations:</p>\n\n<pre><code>compile 1: for (int a = 0; a &lt; 250; a++)\ncompile 2: for (int a = 250; a &lt; 500; a++)\ncompile 3: for (int a = 500; a &lt; 750; a++)\ncompile 4: for (int a = 750; a &lt; 1000; a++)\n</code></pre>\n\n<p>Very easy solution. </p>\n\n<p>I've been trying to figure out pthreads, but I can't wrap my head around it. My code doesn't use functions and pointers.</p>\n\n<p>How would you split the code above into 25 threads?</p>\n\n<pre><code>thread 1: (int a = 0; a &lt; 40; a++)\nthread 2: (int a = 40; a &lt; 80; a++)\n....\nthread 24: (int a = 920; a &lt; 960; a++)\nthread 25: (int a = 960; a &lt; 1000; a++)\n</code></pre>\n\n<p>Is each thread going to use 400 MB for the array (total 10 GB ram usage)? Or is each thread going to use the same 400 MB of ram (total 400 MB ram usage)? I don't care about ram usage, just the fastest solution.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1552473145, "post_id": 55139660, "comment_id": 97019605, "body": "You&#39;re invoking undefined behavior by going out of bounds of the array. Which is valid, but a big no-no. The numbers you&#39;re getting are just &#39;random&#39; numbers happening to be in that area of you programs memory. It could also crash your program, hence undefined behavior."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1552473188, "post_id": 55139660, "comment_id": 97019639, "body": "It comes from reading memory which is not yours. It&#39;s undefined behaviour."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552473217, "post_id": 55139660, "comment_id": 97019660, "body": "<code>a[]</code> -&gt; <code>a[N]</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1552473262, "post_id": 55139660, "comment_id": 97019701, "body": "BTW what output did you expect when running this program?"}, {"owner": {"reputation": 2999, "user_id": 7520531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0107497596782a18d4a853214a883546?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/7520531/jose"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552473313, "post_id": 55139660, "comment_id": 97019728, "body": "@Lundin true, mine was focused on C++, I have deleted my suggestion."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 1, "creation_date": 1552473509, "post_id": 55139660, "comment_id": 97019854, "body": "@Neijwiert, in what sense is it &quot;valid&quot; to access an array via an out-of-bounds index?  Exercising undefined behavior is practically the essence of <i>in</i>valid."}, {"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552473725, "post_id": 55139660, "comment_id": 97020001, "body": "@JohnBollinger I worded it incorrectly. Valid in a sense that the compiler is fine with it and valid in a sense that it may or may not execute (which in that case should be invalid)."}, {"owner": {"reputation": 197, "user_id": 8554147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XTR2F1gn6DI/AAAAAAAAAAI/AAAAAAAAADk/rbtiVvWlLm4/photo.jpg?sz=128", "display_name": "WW00WW", "link": "https://stackoverflow.com/users/8554147/ww00ww"}, "reply_to_user": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1552475401, "post_id": 55139660, "comment_id": 97020974, "body": "@Neijwiert @Jabberwocky  Sorry for the late response. I understand that that is the wrong behavior. But what exactly I wonder is that why <code>2</code> is in the result always? I&#39;ve re-compiled it again and again, but it always <code>2</code> in that position, why not <code>0</code>?"}, {"owner": {"reputation": 197, "user_id": 8554147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XTR2F1gn6DI/AAAAAAAAAAI/AAAAAAAAADk/rbtiVvWlLm4/photo.jpg?sz=128", "display_name": "WW00WW", "link": "https://stackoverflow.com/users/8554147/ww00ww"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552476027, "post_id": 55139660, "comment_id": 97021354, "body": "@Lundin Sorry for my late response, I just update the question. I think this question might be not a duplication"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552476252, "post_id": 55139660, "comment_id": 97021487, "body": "@Voldikss If you have a new question, then please ask a new question instead of editing and changing the meaning. There are posted answers and when you edit, you invalidate them, which is not ok. I did a rollback of your changes (see edit history). But the new question is not a good one anyway, see my comment below Sean&#39;s answer."}, {"owner": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 1, "creation_date": 1552478110, "post_id": 55139660, "comment_id": 97022621, "body": "@Voldikss It just happens to be that way every time you compile it with the compiler you&#39;re using. <a href=\"https://onlinegdb.com/SJVb1_ID4\" rel=\"nofollow noreferrer\">this</a> example also happens to have the same output if you leave out the <code>int b</code> variable. But notice how <code>b</code> happens to be printed out now. The compiler decided that <code>b</code> is located directly after <code>a</code> in memory. You should never rely on this, the compiler may change it."}, {"owner": {"reputation": 197, "user_id": 8554147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XTR2F1gn6DI/AAAAAAAAAAI/AAAAAAAAADk/rbtiVvWlLm4/photo.jpg?sz=128", "display_name": "WW00WW", "link": "https://stackoverflow.com/users/8554147/ww00ww"}, "reply_to_user": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1552478733, "post_id": 55139660, "comment_id": 97023053, "body": "@Neijwiert Thank you so much for your explanation! I get it~"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 915, "user_id": 3254536, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c4d61200a78c3d51c929553f2a3c5de8?s=128&d=identicon&r=PG&f=1", "display_name": "Neijwiert", "link": "https://stackoverflow.com/users/3254536/neijwiert"}, "edited": false, "score": 0, "creation_date": 1552483262, "post_id": 55139660, "comment_id": 97026045, "body": "@Neijwiert, I accept that the expression <code>a[i]</code> conforms to C syntax, but the action of &quot;going out of bounds of the array&quot; is <i>never</i> valid.  Moreover, although a compiler may nevertheless accept the code, it is not obligated to do so, the correctness of its syntax notwithstanding.  That a compiler may or does accept the code is quite a different thing from the code or the behavior it represents being valid.  I acknowledge that this may be nitpicky, but it is important to be precise when talking with someone, such as the OP, who may not be equipped to see through imprecision."}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 8554147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XTR2F1gn6DI/AAAAAAAAAAI/AAAAAAAAADk/rbtiVvWlLm4/photo.jpg?sz=128", "display_name": "WW00WW", "link": "https://stackoverflow.com/users/8554147/ww00ww"}, "edited": false, "score": 0, "creation_date": 1552475559, "post_id": 55139725, "comment_id": 97021073, "body": "Thank you for your explanation and please excuse me for my late response. I understand that that is the wrong behavior. What exactly I wonder is that why <code>2</code> is in the result always? I&#39;ve re-compiled it again and again, but it always <code>2</code> in that position, why not <code>0</code>?"}, {"owner": {"reputation": 197, "user_id": 8554147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XTR2F1gn6DI/AAAAAAAAAAI/AAAAAAAAADk/rbtiVvWlLm4/photo.jpg?sz=128", "display_name": "WW00WW", "link": "https://stackoverflow.com/users/8554147/ww00ww"}, "edited": false, "score": 0, "creation_date": 1552475710, "post_id": 55139725, "comment_id": 97021161, "body": "I know that <code>a[2]</code> is undefined, it refers somewhere in the memory in my computer. But why it always give me <code>2</code> while not other numbers such as <code>0</code>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 197, "user_id": 8554147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XTR2F1gn6DI/AAAAAAAAAAI/AAAAAAAAADk/rbtiVvWlLm4/photo.jpg?sz=128", "display_name": "WW00WW", "link": "https://stackoverflow.com/users/8554147/ww00ww"}, "edited": false, "score": 3, "creation_date": 1552476172, "post_id": 55139725, "comment_id": 97021443, "body": "@Voldikss There doesn&#39;t have to be a rational explanation for it. And it is usually not meaningful to ponder the result of undefined behavior, as there&#39;s usually nothing of interest to learn about. Basically you are asking &quot;when I dropped this glass to the floor so that it shattered, why did some of the pieces end up under the dinner table&quot;. I&#39;m sure there&#39;s an explanation but why would you care - simply avoid dropping glasses."}, {"owner": {"reputation": 197, "user_id": 8554147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XTR2F1gn6DI/AAAAAAAAAAI/AAAAAAAAADk/rbtiVvWlLm4/photo.jpg?sz=128", "display_name": "WW00WW", "link": "https://stackoverflow.com/users/8554147/ww00ww"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552476358, "post_id": 55139725, "comment_id": 97021555, "body": "@Lundin Thanks man, I understand it~"}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552480971, "post_id": 55139725, "comment_id": 97024518, "body": "One thing to note as well, if you ever use strlen or sizeof to determine the length of an array with underfined length i.e. array [ ] it will always go out of bounds before terminating. Always declare array lengths where possible i.e. array[5], array[32] etc"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552482585, "post_id": 55139725, "comment_id": 97025551, "body": "@Medicineman25, that is <b><i>false</i></b>.  Evaluating a <code>sizeof</code> expression <i>never</i> performs an out of bounds access, and whether <code>strlen()</code> of an array with implicit size attempts out of bounds access depends on its initializer.  If the initializer is a string literal, then <code>strlen</code> on it is fine.  Otherwise, it might or might not be ok."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552485699, "post_id": 55139725, "comment_id": 97027774, "body": "@John Bollinger my apologies, you are of course correct. I&#39;ve just double checked and I made the obvious mistake of using sizeof on int types without dividing the result by 4, thus causing my iterator to be of a much greater size."}], "tags": [], "owner": {"reputation": 55713, "user_id": 26095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WLsjF.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/26095/sean"}, "is_accepted": true, "score": 4, "last_activity_date": 1552474543, "last_edit_date": 1552474543, "creation_date": 1552473169, "answer_id": 55139725, "question_id": 55139660, "link": "https://stackoverflow.com/questions/55139660/confusion-about-array-initialization-in-c-language/55139725#55139725", "title": "Confusion about array initialization in c language", "body": "<p>When you do</p>\n\n<pre><code>int a[] = { 1 };\n</code></pre>\n\n<p>the number of elements in the array will automatically be adjusted to be equal to the number of elements in the initializer. In this case the initializer contains 1 integer so your code is equivalent to:</p>\n\n<pre><code>int a[1] = { 1 };\n</code></pre>\n\n<p>You've got an array of length 1 but in the for-loop you are accessing 10 items in it (i.e. accessing <code>a[0]</code>, <code>a[1]</code>, ... <code>a[9]</code>). This is undefined behavior, and what you are seeing is the data beyond the end of your array.</p>\n"}], "owner": {"reputation": 197, "user_id": 8554147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XTR2F1gn6DI/AAAAAAAAAAI/AAAAAAAAADk/rbtiVvWlLm4/photo.jpg?sz=128", "display_name": "WW00WW", "link": "https://stackoverflow.com/users/8554147/ww00ww"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1552473188, "accepted_answer_id": 55139725, "answer_count": 1, "score": 0, "last_activity_date": 1562927146, "creation_date": 1552472986, "last_edit_date": 1562927146, "question_id": 55139660, "link": "https://stackoverflow.com/questions/55139660/confusion-about-array-initialization-in-c-language", "closed_reason": "Duplicate", "title": "Confusion about array initialization in c language", "body": "<p>I wrote this code and ran it:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint i;\nint a[] = { 1 };\n\nint main()\n{\n    for (i = 0; i &lt; 10; i++)\n        printf(\"%d\\n\", a[i]);\n};\n</code></pre>\n\n<p>It always gave me the following result</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>1\n0\n2\n0\n0\n0\n0\n0\n0\n0\n</code></pre>\n\n<p>I know the length of <code>a[]</code> is 1 and <code>a[1],a[2]...</code> are invalid. But I re-compiled it again and finally I found <code>a[2]</code> always give <code>2</code>, I am quite confused about the <code>2</code>, where did it come from and why <code>a[2]</code> is not other numbers such as <code>0</code> or some random number?</p>\n"}, {"tags": ["c", "time"], "comments": [{"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 1, "creation_date": 1552472143, "post_id": 55139287, "comment_id": 97018985, "body": "You can try multithreading using <code>pthread.h</code>."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1552473809, "post_id": 55139287, "comment_id": 97020050, "body": "On what platform this game is supposed to run?"}, {"owner": {"reputation": 33, "user_id": 11156242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3134484df14b5bce5a36c181825d6a2?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Martins", "link": "https://stackoverflow.com/users/11156242/antonio-martins"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1552474463, "post_id": 55139287, "comment_id": 97020449, "body": "@Jabberwocky MAC OS X I\u2019m programming on XCODE"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1552474616, "post_id": 55139287, "comment_id": 97020542, "body": "@AntonioMartins you should mention this in the question. You can <a href=\"https://stackoverflow.com/posts/55139287/edit\">edit</a>  your question."}], "answers": [{"tags": [], "owner": {"reputation": 1278, "user_id": 9057499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PvHd7.jpg?s=128&g=1", "display_name": "Arnaud Peralta", "link": "https://stackoverflow.com/users/9057499/arnaud-peralta"}, "is_accepted": false, "score": 0, "last_activity_date": 1552472698, "last_edit_date": 1552472698, "creation_date": 1552472252, "answer_id": 55139401, "question_id": 55139287, "link": "https://stackoverflow.com/questions/55139287/running-a-time-function-in-background/55139401#55139401", "title": "running a time function in background?", "body": "<pre><code>#include &lt;time.h&gt;\n</code></pre>\n\n<p>You have the <code>time()</code> function who gives you the time, since <code>00:00:00 UTC, January 1, 1970</code>.</p>\n\n<p>This is a good alternative because its a clock in the background. Use the <code>time()</code> function once a the beginning of your program, and after it will be easy for you to base your code on it.</p>\n\n<p>Don't try to re-invent the wheel.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1552473057, "post_id": 55139409, "comment_id": 97019549, "body": "Very few embedded systems support this though. To begin with, you&#39;ll need a RTC with continuous supply in hardware."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1552474583, "post_id": 55139409, "comment_id": 97020528, "body": "@Lundin apparently the OP wants this to run on MacOS."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1552472281, "creation_date": 1552472281, "answer_id": 55139409, "question_id": 55139287, "link": "https://stackoverflow.com/questions/55139287/running-a-time-function-in-background/55139409#55139409", "title": "running a time function in background?", "body": "<p>Begin by getting the current <a href=\"https://en.cppreference.com/w/c/chrono/time\" rel=\"nofollow noreferrer\">time</a> as a starting point. Then in your main event loop get the current time <em>right now</em>, and compare to the starting time. If the difference is equal or larger than the timeout (<code>5</code> to <code>15</code>) then \"perform\" your event.</p>\n\n<p>This of course relies on the fact that almost <em>all</em> systems return the time as seconds (since an epoch).</p>\n"}], "owner": {"reputation": 33, "user_id": 11156242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3134484df14b5bce5a36c181825d6a2?s=128&d=identicon&r=PG&f=1", "display_name": "Antonio Martins", "link": "https://stackoverflow.com/users/11156242/antonio-martins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552474877, "creation_date": 1552471970, "last_edit_date": 1552474877, "question_id": 55139287, "link": "https://stackoverflow.com/questions/55139287/running-a-time-function-in-background", "title": "running a time function in background?", "body": "<p>Im developing a game on xcode in which the user puts some value of time between 5 and 15 seconds for each play. The game should run until the time reaches its end (value inserted by the user). I\u2019ve not been able to code this, I\u2019ve tried wait(), diff_time, sleep() but those didn\u2019t work out since sleep() actually stops the processes entirely. What I\u2019m trying to say is, is there a function of time that can run in \u201cbackground\u201d and when the time ends return some value that I can use for... let\u2019s say an if statement, run the game until that value is returned. \nThank you everyone.</p>\n"}, {"tags": ["c", "multithreading", "thread-safety", "pthreads", "posix"], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1552499312, "last_edit_date": 1552499312, "creation_date": 1552474291, "answer_id": 55140118, "question_id": 55139234, "link": "https://stackoverflow.com/questions/55139234/simple-multi-threading-stack-implementation-using-conditional-variables/55140118#55140118", "title": "Simple Multi-threading Stack Implementation using Conditional Variables", "body": "<blockquote>\n  <p><strong>Q</strong>: My problem with this implementation is: Doesn't this require a 1:1 ratio between readings a writings due to the signaling? This\n  implementation does not allow to write multiple items without any\n  reads in between since every write requires a signal triggered in the\n  read function (vice versa multiple reads).</p>\n</blockquote>\n\n<p>If the <code>write()</code> function is truly analogous to the <code>read()</code> function presented, then yes and no.  I think you're suggesting that the stack could never have more than one element, but that in particular is not so.  Note how a thread entering your <code>read()</code> function and finding the stack nonempty will bypass waiting on the condition variable altogether.  A thread waits to read only if the stack is empty.  The analog on the other side would be that threads wait to write only if the stack is full to capacity.</p>\n\n<blockquote>\n  <p><strong>Q2</strong> How long is a signal \"valid\" after calling pthread_cond_signal(...)?</p>\n</blockquote>\n\n<p>No time at all.  Only threads already waiting on a condition variable can be unblocked when that CV is signaled.  There is not afterward any memory of a signal having been received, even if no thread was unblocked by it.</p>\n"}], "owner": {"reputation": 893, "user_id": 4884487, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/5K2bp.jpg?s=128&g=1", "display_name": "SebNag", "link": "https://stackoverflow.com/users/4884487/sebnag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 55140118, "answer_count": 1, "score": 0, "last_activity_date": 1552499312, "creation_date": 1552471809, "last_edit_date": 1552473540, "question_id": 55139234, "link": "https://stackoverflow.com/questions/55139234/simple-multi-threading-stack-implementation-using-conditional-variables", "title": "Simple Multi-threading Stack Implementation using Conditional Variables", "body": "<p>In our CS course we used POSIX Thread Programming to implement\na simple stack data structure. We therefore made use of <a href=\"https://linux.die.net/man/3/pthread_cond_signal\" rel=\"nofollow noreferrer\"><code>pthread_cond_wait</code></a> and <a href=\"https://linux.die.net/man/3/pthread_cond_signal\" rel=\"nofollow noreferrer\"><code>pthread_cond_signal</code></a>: </p>\n\n<pre><code>pthread_mutex_t write_mutex; \npthread_mutex_t read_mutex; \n\npthread_cond_t write_cond; \npthread_cond_t read_cond;\n\nint read()\n{\n    pthread_mutex_lock(&amp;read_mutex); \n    while(is_empty())\n    {\n        pthred_cond_wait(&amp;read_cond, &amp;read_mutex);\n    }\n    // read value [...]\n    pthread_cond_signal(&amp;write_cond);\n    pthread_mutex_unlock(&amp;read_mutex);\n\n    return read_value;\n\n}\n</code></pre>\n\n<p>The write function is implemented similarly but locking the <code>write_mutex</code> and signaling the <code>read_cond</code> instead.  </p>\n\n<p><strong>Q:</strong> \nMy problem with this implementation is: Doesn't this require a 1:1 ratio between readings a writings due to the signaling? This implementation does not allow to write multiple items without any reads in between since every write requires a signal triggered in the read function (vice versa multiple reads).  </p>\n\n<p>Is my understanding correct or am I missing something?</p>\n\n<p><strong>Q2</strong> How long is a signal \"valid\" after calling <code>pthread_cond_signal(...)</code>?</p>\n"}, {"tags": ["c", "linux", "gcc", "weak-linking"], "comments": [{"owner": {"reputation": 82430, "user_id": 17833, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExIEf.png?s=128&g=1", "display_name": "Petesh", "link": "https://stackoverflow.com/users/17833/petesh"}, "edited": false, "score": 1, "creation_date": 1552478462, "post_id": 55139165, "comment_id": 97022852, "body": "Without more details, any answer we give here would be conjecture. We know nothing about the &#39;third party library&#39; - did you rebuild it with the new compiler? Did you change <i>anything</i> else going from 4.1 to 4.4 - i.e. is it being built on a different computer? did you change the architecture from 32bit to 64bit (can be a side effect of compiling gcc without multilib support), did you change compilation flags?"}], "answers": [{"comments": [{"owner": {"reputation": 486, "user_id": 5925476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ca6ce6e4c775b9a79b629d6f4b7848?s=128&d=identicon&r=PG&f=1", "display_name": "mnabil", "link": "https://stackoverflow.com/users/5925476/mnabil"}, "edited": false, "score": 0, "creation_date": 1552476311, "post_id": 55140446, "comment_id": 97021520, "body": "The idea is that, gcc4.1.2 marked the &quot;lstat64&quot; of the third party library as weak, however, in the runtime, the application uses the one of glibc. On the other hand, when we ported our code to gcc4.4.4, we found that the compiler marked &quot;lstat64&quot; of the third party library as unresolved, and in the run time, it try to use the one of the third party library not the one of glibc. Thus, I am trying to understand the root cause of this new behavior?"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 486, "user_id": 5925476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ca6ce6e4c775b9a79b629d6f4b7848?s=128&d=identicon&r=PG&f=1", "display_name": "mnabil", "link": "https://stackoverflow.com/users/5925476/mnabil"}, "edited": false, "score": 0, "creation_date": 1552476399, "post_id": 55140446, "comment_id": 97021576, "body": "I&#39;m not sure how GCC can mark a third party function as weak. Possibly, the third party library writers marked their function as weak."}, {"owner": {"reputation": 486, "user_id": 5925476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ca6ce6e4c775b9a79b629d6f4b7848?s=128&d=identicon&r=PG&f=1", "display_name": "mnabil", "link": "https://stackoverflow.com/users/5925476/mnabil"}, "edited": false, "score": 0, "creation_date": 1552478369, "post_id": 55140446, "comment_id": 97022802, "body": "No, the third party library does not mark it as weak;"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 486, "user_id": 5925476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ca6ce6e4c775b9a79b629d6f4b7848?s=128&d=identicon&r=PG&f=1", "display_name": "mnabil", "link": "https://stackoverflow.com/users/5925476/mnabil"}, "edited": false, "score": 0, "creation_date": 1552478590, "post_id": 55140446, "comment_id": 97022948, "body": "<code>nm</code> command shows <code>lstat64</code> as weak. How would you know if this was marked for the GCC function or the third party function?"}, {"owner": {"reputation": 486, "user_id": 5925476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ca6ce6e4c775b9a79b629d6f4b7848?s=128&d=identicon&r=PG&f=1", "display_name": "mnabil", "link": "https://stackoverflow.com/users/5925476/mnabil"}, "edited": false, "score": 0, "creation_date": 1552478779, "post_id": 55140446, "comment_id": 97023086, "body": "This is a goo question. The lstat64 of the gcc is in fact a wrapper for __lxstat64 as defined in the &quot;stat.h&quot; file. When I issue &quot;nm&quot; on our application, it gives a reference for the __lxstat64@glibc  and a reference for lstat64"}, {"owner": {"reputation": 486, "user_id": 5925476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ca6ce6e4c775b9a79b629d6f4b7848?s=128&d=identicon&r=PG&f=1", "display_name": "mnabil", "link": "https://stackoverflow.com/users/5925476/mnabil"}, "edited": false, "score": 0, "creation_date": 1552478864, "post_id": 55140446, "comment_id": 97023138, "body": "Also, in gcc4.4.4, nm of the application gives a reference to &quot;U  lstat64@ThirdParty.so&quot;, but in gcc4.1.2, nm the application gives &quot;W   lstat64&quot; with no reference to the third party so"}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 3, "last_activity_date": 1552475256, "creation_date": 1552475256, "answer_id": 55140446, "question_id": 55139165, "link": "https://stackoverflow.com/questions/55139165/why-gcc-can-automatically-tag-a-symbol-as-weak/55140446#55140446", "title": "why gcc can automatically tag a symbol as weak", "body": "<p>As per the <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.4.5/gcc/Function-Attributes.html\" rel=\"nofollow noreferrer\">GCC documentation</a>:</p>\n\n<blockquote>\n  <p><strong>weak</strong><br>\n  The weak attribute causes the declaration to be emitted as a weak symbol rather than a global. <strong>This is primarily useful in defining library functions which can be overridden in user code</strong>, though it can also be used with non-function declarations. Weak symbols are supported for ELF targets, and also for a.out targets when using the GNU assembler and linker. </p>\n</blockquote>\n\n<p>In your case <code>lstat64</code> was probably marked as weak in GCC 4.1.2 because it would then not conflict with the third party library function. GCC probably wanted these external functions to have precedence.</p>\n\n<p>But in a later version, GCC would have wanted its own version of <code>lstat64</code> to have precedence. </p>\n"}], "owner": {"reputation": 486, "user_id": 5925476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97ca6ce6e4c775b9a79b629d6f4b7848?s=128&d=identicon&r=PG&f=1", "display_name": "mnabil", "link": "https://stackoverflow.com/users/5925476/mnabil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552475880, "creation_date": 1552471612, "question_id": 55139165, "link": "https://stackoverflow.com/questions/55139165/why-gcc-can-automatically-tag-a-symbol-as-weak", "title": "why gcc can automatically tag a symbol as weak", "body": "<p>We have built our code using gcc4.1.2, and we have used function \"lstat64\" that is defined in the \"sys/stat.h\" system header file and also defined in a third party library that we use.</p>\n\n<p>When we \"nm\" our executable, we find that:</p>\n\n<pre><code>W  lstat64\n</code></pre>\n\n<p>My question Is: why gcc marked it as a weak function?</p>\n\n<p>Also, we have ported our code to gcc4.4.4, we found that the new gcc did not marked the function as \"weak\", it marked it as undefined?</p>\n\n<p>Why this change in behavior?</p>\n"}, {"tags": ["c", "arrays", "function", "2d"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552471602, "post_id": 55139118, "comment_id": 97018636, "body": "Don&#39;t use pointer arithmetic directly, use array-indexing properly. That will make your code much cleaner and easier to read and understand. And as mentioned in your <a href=\"https://stackoverflow.com/questions/55135942/difference-ary1d0-and-ary1d\">previous question</a> don&#39;t pass pointers to arrays (it&#39;s <i>very</i> seldom needed)."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1552471685, "post_id": 55139118, "comment_id": 97018689, "body": "And what is the problem?"}, {"owner": {"reputation": 19, "user_id": 9579225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e79cb2f495e41a2b88c0426baeb164?s=128&d=identicon&r=PG&f=1", "display_name": "Fkcm95", "link": "https://stackoverflow.com/users/9579225/fkcm95"}, "edited": false, "score": 0, "creation_date": 1552471699, "post_id": 55139118, "comment_id": 97018696, "body": "Ok, if I write in the function : cout &lt;&lt; ary2D[1][1] &lt;&lt; endl; I get the address."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552471715, "post_id": 55139118, "comment_id": 97018708, "body": "As for how to solve what I think your problem is, remember that C doesn&#39;t have &quot;2d&quot; arrays. What you have here is an array <i>of arrays</i>. To help you understand how they work I suggest you draw it out on a piece of paper, and then use arrows to draw out pointers to different places."}, {"owner": {"reputation": 19, "user_id": 9579225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e79cb2f495e41a2b88c0426baeb164?s=128&d=identicon&r=PG&f=1", "display_name": "Fkcm95", "link": "https://stackoverflow.com/users/9579225/fkcm95"}, "edited": false, "score": 0, "creation_date": 1552471733, "post_id": 55139118, "comment_id": 97018718, "body": "Problem is, I get the address and not the value.."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552471749, "post_id": 55139118, "comment_id": 97018725, "body": "The function should usually be <code>void print2D_A(double ary2D[][4]){ ... }</code> called with <code>print2D_A(ary2D);</code> and the first element is accessed with <code>ary2D[0][0]</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552471841, "post_id": 55139118, "comment_id": 97018795, "body": "@Fkcm95 the function thinks it is getting a 2D array of pointers."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552471874, "post_id": 55139118, "comment_id": 97018819, "body": "Or perhaps the problem is that you forget that <code>ary2D</code> is a <i>pointer</i>, and that it needs to be dereferenced to get what it points to. So you need to use e.g. <code>(*ary2D)[0][0]</code> to get the first element of the first array (the parentheses are needed because of <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\"><i>operator precedence</i></a>)."}], "answers": [{"comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1552472495, "post_id": 55139418, "comment_id": 97019208, "body": "The idiomatic declaration is more <code>void print2D_A(double ary2D[][4])</code>, because the 2D array will <i>decay</i> to a pointer to 1D arrays."}, {"owner": {"reputation": 19, "user_id": 9579225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e79cb2f495e41a2b88c0426baeb164?s=128&d=identicon&r=PG&f=1", "display_name": "Fkcm95", "link": "https://stackoverflow.com/users/9579225/fkcm95"}, "edited": false, "score": 0, "creation_date": 1552472553, "post_id": 55139418, "comment_id": 97019244, "body": "First of all, Thanks for the answer. And how can I called the function in this way? print2D_A(&amp;ary2D); How I must change the printf in the function??"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 19, "user_id": 9579225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e79cb2f495e41a2b88c0426baeb164?s=128&d=identicon&r=PG&f=1", "display_name": "Fkcm95", "link": "https://stackoverflow.com/users/9579225/fkcm95"}, "edited": false, "score": 0, "creation_date": 1552475111, "post_id": 55139418, "comment_id": 97020795, "body": "@Fkcm95 Again I wonder <i>why?</i> Is it still curiosity? Even after the comments and answers you got from your previous question? An array is an array is an array, it doesn&#39;t really matter if it&#39;s an array of <code>double</code>, or an array of <i>arrays</i> of <code>double</code>. The semantics and behavior is just the same."}], "tags": [], "owner": {"reputation": 411, "user_id": 5001634, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-triDFH1RN3o/AAAAAAAAAAI/AAAAAAAAAC4/eEwLD4rmuWs/photo.jpg?sz=128", "display_name": "Yuanhui", "link": "https://stackoverflow.com/users/5001634/yuanhui"}, "is_accepted": false, "score": 0, "last_activity_date": 1552472786, "last_edit_date": 1552472786, "creation_date": 1552472310, "answer_id": 55139418, "question_id": 55139118, "link": "https://stackoverflow.com/questions/55139118/get-value-from-pointer-array-call-by-reference/55139418#55139418", "title": "get Value from Pointer Array - Call By Reference", "body": "<p>Do not use the address of a 2D array, it really not clearly to understand.</p>\n\n<pre><code>void print2D_A(double ary2D[3][4])    // `ary2D` is already a pointer of array, seems like `douible* ary2D`\n{\n    printf(\"%f\\n\", ary2D[0][0]);\n}\n\n</code></pre>\n\n<p>EDIT:</p>\n\n<pre><code>void print2D_B(double ary2D[3][4])    // `ary2D` is already a pointer of array, seems like `douible* ary2D`\n{\n    for(int i=0; i&lt;3; i++)\n    {\n        for(int j=0; j&lt;4; j++)\n        {\n            printf(\"%f, \", ary2D[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    double ary2D[3][4] = {\n        { 10.1, 11.2, 12.3, 13.4 },\n        { 20.1, 21.2, 22.3, 23.4 },\n        { 30.1, 31.2, 32.3, 33.4 }\n    };\n    print2D_A(ary2D);    // In fact, this is a pointer of double array\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9579225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e79cb2f495e41a2b88c0426baeb164?s=128&d=identicon&r=PG&f=1", "display_name": "Fkcm95", "link": "https://stackoverflow.com/users/9579225/fkcm95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1552472786, "creation_date": 1552471467, "last_edit_date": 1552471551, "question_id": 55139118, "link": "https://stackoverflow.com/questions/55139118/get-value-from-pointer-array-call-by-reference", "title": "get Value from Pointer Array - Call By Reference", "body": "<p>I want to get the value from a Reference in function. \nMy Function is: </p>\n\n<pre><code>void print2D_A(double (*ary2D)[3][4]){ ... }\n</code></pre>\n\n<p>Main: </p>\n\n<pre><code>double ary2D[3][4] = {\n                        {10.1, 11.2, 12.3, 13.4},\n                        {20.1, 21.2, 22.3, 23.4},\n                        {30.1, 31.2, 32.3, 33.4}\n                     };\nprint2D_A(&amp;ary2D);\n</code></pre>\n\n<p>Get First Value in Function: </p>\n\n<pre><code>*(ary2D)+1\n</code></pre>\n"}, {"tags": ["c", "visual-studio", "debugging", "runtime-error"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1552478499, "post_id": 55138498, "comment_id": 97022874, "body": "<i><a href=\"https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/04f1c082-79db-4f41-82fc-3d41b14c8713/regarding-error-quotstatusinvalidcruntimeparameterquot-c0000417?forum=vcgeneral\" rel=\"nofollow noreferrer\">This is related...</a></i>.  And here is an almost <i><a href=\"https://stackoverflow.com/a/38151124/645128\">identical question/answer.</a></i>"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1552478595, "post_id": 55138498, "comment_id": 97022950, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/38135608/how-do-identify-status-invalid-cruntime-parameter-exception\">How do identify STATUS_INVALID_CRUNTIME_PARAMETER exception</a>"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1552478800, "post_id": 55138498, "comment_id": 97023103, "body": "Regarding <i>I searched intensively...</i>  I appreciate that sometimes after what seems like several attempts at finding the right query string for a Google search, the right response just never seems to pop.  In this case I used <i>STATUS_INVALID_CRUNTIME_PARAMETER on Visual Studio</i>, and the first two links are the two links I commented above."}, {"owner": {"reputation": 227, "user_id": 1573870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1cc2609b6351f8cc35c0100efb174592?s=128&d=identicon&r=PG", "display_name": "lineinthesand", "link": "https://stackoverflow.com/users/1573870/lineinthesand"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1552897584, "post_id": 55138498, "comment_id": 97169537, "body": "I had checked all of the articles you linked before posting here but I did not succeed in debugging. The only thing I could do was to set a break point somewhere near that supposed crash. Now, after 3 days I&#39;m finally at the cause: fopen(&quot;somedir\\\\somefile.xml&quot;,&quot;w&quot;) returns a NULL pointer despite the file being created. But that&#39;s a different question."}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1552900649, "post_id": 55138498, "comment_id": 97171006, "body": "Well, if it&#39;s something that happens after a while, you may have issues like: fragmented address space (some allocations therefore are destined to fail), leaked memory (with the same outcome), race condition (leading to inconsistent/corrupt state), overflow of some important index/count/pointer, memory corruption."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1552910429, "post_id": 55138498, "comment_id": 97176699, "body": "I am happy to see you have found some thing that at least is contributing to your mystery.  In general, without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> included as part of your post, it is impossible for anyone to know how to help.  This is a good example.  If you would have included that section of code originally, somebody would have asked about checking the return value of those functions that have them."}, {"owner": {"reputation": 227, "user_id": 1573870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1cc2609b6351f8cc35c0100efb174592?s=128&d=identicon&r=PG", "display_name": "lineinthesand", "link": "https://stackoverflow.com/users/1573870/lineinthesand"}, "edited": false, "score": 0, "creation_date": 1553069577, "post_id": 55138498, "comment_id": 97243915, "body": "Even if I had been able to include an example (which was not possible since I did not know the location of the error and the purpose of my question was to find a method how to catch the location) the question still remains: why does fopen return a NULL?"}, {"owner": {"reputation": 227, "user_id": 1573870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1cc2609b6351f8cc35c0100efb174592?s=128&d=identicon&r=PG", "display_name": "lineinthesand", "link": "https://stackoverflow.com/users/1573870/lineinthesand"}, "reply_to_user": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1553070001, "post_id": 55138498, "comment_id": 97244099, "body": "@AlexeyFrunze: at least I can exclude memory corruption (valgrind and DrMemory agree there&#39;s none). If I was to guess, I would say it must be some kind of overflow (depending on the process runtime). But maybe I&#39;ll know more later today or tomorrow; I included a strerror(errno) in my code hopefully giving me more information about the fopen error."}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1553159905, "post_id": 55138498, "comment_id": 97284260, "body": "Btw, what about other resources? Too many open files? Leaked (not closed) handles? Can you check that with e.g. process explorer (I think you could see the number of handles in the process with it)?"}, {"owner": {"reputation": 227, "user_id": 1573870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1cc2609b6351f8cc35c0100efb174592?s=128&d=identicon&r=PG", "display_name": "lineinthesand", "link": "https://stackoverflow.com/users/1573870/lineinthesand"}, "reply_to_user": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1553186012, "post_id": 55138498, "comment_id": 97300181, "body": "@AlexeyFrunze: Yes, that seems to be it: the intel fortran lib leaks mutant (mutex) handles on each formatted write eventually exhausting all resources during the (long) runtime."}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "edited": false, "score": 0, "creation_date": 1553227693, "post_id": 55138498, "comment_id": 97314134, "body": "I&#39;m making that the answer then."}], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 1573870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1cc2609b6351f8cc35c0100efb174592?s=128&d=identicon&r=PG", "display_name": "lineinthesand", "link": "https://stackoverflow.com/users/1573870/lineinthesand"}, "edited": false, "score": 1, "creation_date": 1553245962, "post_id": 55292782, "comment_id": 97320773, "body": "It turned out it is a known (and fixed) bug in the Intel runtime libraries: <a href=\"https://software.intel.com/en-us/forums/intel-visual-fortran-compiler-for-windows/topic/591225\" rel=\"nofollow noreferrer\">software.intel.com/en-us/forums/&hellip;</a>. Using a patched libifcoremd.dll fixes the problem, the handles behave well (o;"}], "tags": [], "owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "is_accepted": true, "score": 0, "last_activity_date": 1553227789, "creation_date": 1553227789, "answer_id": 55292782, "question_id": 55138498, "link": "https://stackoverflow.com/questions/55138498/how-can-i-debug-the-cause-of-a-0xc0000417-exit-code/55292782#55292782", "title": "How can I debug the cause of a 0xc0000417 exit code", "body": "<p>It could be too many open files or leaked (not closed) handles. You can check that with e.g. Process Explorer (I think you could see the number of handles in the process with it).</p>\n"}], "owner": {"reputation": 227, "user_id": 1573870, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1cc2609b6351f8cc35c0100efb174592?s=128&d=identicon&r=PG", "display_name": "lineinthesand", "link": "https://stackoverflow.com/users/1573870/lineinthesand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1122, "favorite_count": 0, "accepted_answer_id": 55292782, "answer_count": 1, "score": 1, "last_activity_date": 1553246177, "creation_date": 1552469749, "last_edit_date": 1553246177, "question_id": 55138498, "link": "https://stackoverflow.com/questions/55138498/how-can-i-debug-the-cause-of-a-0xc0000417-exit-code", "title": "How can I debug the cause of a 0xc0000417 exit code", "body": "<p>I get an exit error code 0xc0000417 (which translates to STATUS_INVALID_CRUNTIME_PARAMETER) in my executable (mixed Fortran/C) and try to find out what's causing it. It seems to occur when trying to write to a file which I infer because the file is created but there's nothing in it. Yet I have the suspicion that's not the /real/ cause. When I disable writing of that file, which is done from C code, it crashes when writing a different file, this time from Fortran code.</p>\n\n<p>The unfortunate thing is: this only happens after the program (a CPU heavy calculation) has finished after having run for ~2-3 days. When I tried to shorten the calculation time by various means to facilitate debugging, the problem did not occur anymore. It almost seemed like the long runtime was crucial for triggering the problem.</p>\n\n<p>I tried running it in Visual Studio 2015 but VS does not break/stop (like it would if e.g. a segfault had happened) despite having turned on breaking at all the C++ Exceptions, like was suggested in some other thread and all Common Language Runtime Exceptions.</p>\n\n<p>What I would like VS to do is to either break whenever that error code is 'produced' and examine the values of variables or at least get a stack trace.</p>\n\n<p>I searched intensively but I could not find a satisfactory solution to my problem. In essence, my question is similar to <a href=\"https://stackoverflow.com/questions/36968475/how-to-debug-invalid-parameter-passed-to-c-runtime-function\">how to debug &quot;Invalid parameter passed to C runtime function&quot;?</a> but the problem does not occur with the linux version of my program, so I'm looking for directions on how to debug it on Windows, either with Visual Studio or some other tool.</p>\n\n<p><strong>Edit:</strong>\nSadly, <em>I</em> was not able to find any convenient means of breaking automatically when the error occurs. So I went with the manual way of setting a breakpoint (in VS) near the supposed crash and step through the code.\nIt turned out that I got a NULL pointer from fopen:</p>\n\n<pre><code>myfile = fopen(\"somedir\\\\somefile.xml\");\n</code></pre>\n\n<p>despite the file being created. But when trying to write to that file (via the NULL handle!), a segfault occurred. Strangely, it seems I only get a NULL pointer from fopen when the process has a long lifetime. But that's offtopic for that question.</p>\n\n<p><strong>Edit 2:</strong>\nChecking the global <code>errno</code> variable gave error code 22 which again translates to an invalid argument. However, the argument to fopen is <em>not</em> invalid as I verified with the debugger and the fact that the <strong>file is actually created correctly</strong> (with 0 bytes length). Now I think that that <strong>that error code 22 is simply misleading</strong> because when I check (via a watch in VS) <code>$err, hr</code> I get:</p>\n\n<pre><code>0x000005aa ERROR_NO_SYSTEM_RESOURCES : Insufficient system resources exist to complete the requested service.\n</code></pre>\n\n<p>Just like mentioned <a href=\"https://stackoverflow.com/questions/13866282/ioexception-insufficient-system-resources-when-there-is-aplenty\">here</a>, I have plenty of HD space (1.4 GB), plenty of free RAM (3.2 GB), and I fear it is something not directly caused by my program but something due to broken Windows design of file handling (it does not happen under Linux).</p>\n\n<p><strong>Edit 3:</strong> OK, it seems it is not Windows itself that's the culprit but rather the Intel Fortran compiler I'm using. Every time I'm doing formatted write statements in my program, a Mutant (Windows speak for mutex) handle is leaked. Using WinDbg and <code>!htrace -enable</code>, then running a bit further, break and issue <code>!htrace -diff</code> gives loads of these backtraces:</p>\n\n<pre><code>0x00000000777ca25a: ntdll!NtCreateMutant+0x000000000000000a\n0x000007fefd54a1b7: KERNELBASE!CreateMutexExW+0x0000000000000057\n0x000007fefd551d60: KERNELBASE!CreateMutexExA+0x0000000000000050\n0x000007fedfab24db: libifcoremd!for_lge_ssll+0x0000000000001dcb\n0x000007fedfb03ed6: libifcoremd!for_write_int_fmt+0x0000000000000056\n0x000000014085aa21: myprog!MY_ROUTINE+0x0000000000000121\n</code></pre>\n\n<p>During the program runtime these mutant handles seem to accumulate until they exhaust all handle resources (16711680 handles) so that there's nothing left for file handles.</p>\n\n<p><strong>Edit 4:</strong> It's a bug in the intel fortran runtime libraries that has been fixed with a later version (see <a href=\"https://software.intel.com/en-us/forums/intel-visual-fortran-compiler-for-windows/topic/591225\" rel=\"nofollow noreferrer\">here</a>). Using the patched version of <code>libifcoremd.dll</code> fixes the problem, i.e. the handle count does not increase anymore during formatted writes.</p>\n"}, {"tags": ["java", "c", "makefile", "java-native-interface"], "answers": [{"comments": [{"owner": {"reputation": 399, "user_id": 4623892, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/72a8206d7a9c1f89c1cf3baf469213cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dr_Click", "link": "https://stackoverflow.com/users/4623892/dr-click"}, "edited": false, "score": 0, "creation_date": 1552486204, "post_id": 55140563, "comment_id": 97028157, "body": "Perfect, it works but I still have a question. I&#39;m using the jdk 1.8.0_111 so, I tried to use javac -h but it failed ; I had to use javah. But, doesn&#39;t javac -h should already be allowed in that jdk ?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 399, "user_id": 4623892, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/72a8206d7a9c1f89c1cf3baf469213cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dr_Click", "link": "https://stackoverflow.com/users/4623892/dr-click"}, "edited": false, "score": 0, "creation_date": 1552486554, "post_id": 55140563, "comment_id": 97028441, "body": "@Dr_Click answered <a href=\"https://stackoverflow.com/questions/46577196/javac-no-source-files-when-using-h-option\">here</a>"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 2, "last_activity_date": 1552475611, "creation_date": 1552475611, "answer_id": 55140563, "question_id": 55138492, "link": "https://stackoverflow.com/questions/55138492/jni-receipe-for-target-hellojni-h-failed-while-using-the-makefile/55140563#55140563", "title": "JNI : &quot;receipe for target &#39;HelloJNI.h&#39; failed while using the &#39;makefile&#39;", "body": "<p>The error does not come from <code>javac</code> \u00b4- it is caused by <code>javac</code> not being in the <em>PATH</em> and the <code>CreateProcess</code> system call is unable to locate it, and hence the command is not executed. Nothing you change <em>after</em> <code>javac</code> is going to help there. Possible fixes are e.g.</p>\n\n<ul>\n<li>adding the path of <code>javac</code> to <code>PATH</code>...</li>\n<li><p>calling <code>javac</code> with the full path to it:</p>\n\n<pre><code>c:/Foo/Bar/JavaSDK/bin/whatever/javac -h -classpath $(CLASS_PATH) $*\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 399, "user_id": 4623892, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/72a8206d7a9c1f89c1cf3baf469213cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dr_Click", "link": "https://stackoverflow.com/users/4623892/dr-click"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 55140563, "answer_count": 1, "score": 0, "last_activity_date": 1552475611, "creation_date": 1552469707, "last_edit_date": 1552475301, "question_id": 55138492, "link": "https://stackoverflow.com/questions/55138492/jni-receipe-for-target-hellojni-h-failed-while-using-the-makefile", "title": "JNI : &quot;receipe for target &#39;HelloJNI.h&#39; failed while using the &#39;makefile&#39;", "body": "<p>I'm experimenting the use of JNI with Eclipse, using <a href=\"https://www3.ntu.edu.sg/home/ehchua/programming/java/JavaNativeInterface.html\" rel=\"nofollow noreferrer\">this tutorial</a> and I fail to use the makefile as explained in the part \"2.6 JNI in Eclipse - step 3\".</p>\n\n<p>When I right click on the jni folder, selecting \"Build targets\" => \"Build\" => and selecting the target HelloJNI.h => Build, I get the following error message : </p>\n\n<blockquote>\n  <p>10:19:12 **** Build of configuration Default for project HelloJNI ****\n  make HelloJNI.h \n  javac -h -classpath ../bin HelloJNI\n  makefile:10: recipe for target 'HelloJNI.h' failed\n  process_begin: CreateProcess(NULL, javac -h -classpath ../bin HelloJNI, ...) failed.\n  make (e=2): Le fichier sp\u00e9cifi\u00e9 est introuvable.</p>\n  \n  <p>make: *** [HelloJNI.h] Error 2</p>\n  \n  <p>10:19:13 Build Finished (took 801ms)</p>\n</blockquote>\n\n<p>and the last line of the makefile file shown below indicates there is an error (but which one ?)</p>\n\n<pre><code># Define a variable for classpath\nCLASS_PATH = ../bin\n\n# Define a virtual path for .class in the bin directory\nvpath %.class $(CLASS_PATH)\n\nHelloJNI.h : HelloJNI.class\n    javac -h -classpath $(CLASS_PATH) $*\n</code></pre>\n\n<p>I checked that I'm having a \"make\" file in \"C:\\MinGW\\bin\". I haden't so I made a copy of \"mingw32-make.exe\" and renamed it \"make.exe\".<br>\nI also tried to change the last intruction javac -h (...) to javah (...) but I get the same error.</p>\n\n<p>I suppose the error line</p>\n\n<blockquote>\n  <p>CreateProcess(NULL, javac -h -classpath ../bin HelloJNI, ...) failed. make (e=2): Le fichier sp\u00e9cifi\u00e9 est introuvable. [The specified file is not found.]</p>\n</blockquote>\n\n<p>should help me to understand what is wrong but I didn't succeed.</p>\n\n<p>Thank you for your help </p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "aio", "workqueue"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1552468712, "post_id": 55137519, "comment_id": 97016742, "body": "Please, show the code. Explanations are useful, but they are not a replacement for the code itself."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1552672079, "post_id": 55137519, "comment_id": 97114379, "body": "You are dereferencing a null pointer <code>a_work</code> in <code>async_read_work</code> and you have also <code>kfree</code>d the thing that <code>a_work</code> was pointing to."}], "answers": [{"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 1, "last_activity_date": 1552673029, "creation_date": 1552673029, "answer_id": 55188419, "question_id": 55137519, "link": "https://stackoverflow.com/questions/55137519/kernel-oops-when-calling-aio-complete-by-workqueue/55188419#55188419", "title": "Kernel Oops when calling aio_complete by workqueue", "body": "<p>In your <code>async_read_work</code> function, you call <code>kfree(a_work);</code>, set <code>a_work = NULL;</code> and then dereference <code>a_work</code> here: <code>a_work-&gt;a_iocb-&gt;ki_complete(a_work-&gt;a_iocb,100, 0);</code>.</p>\n\n<p>Possible solutions:</p>\n\n<ol>\n<li><p>Rearrange the code:</p>\n\n<pre><code>    a_work-&gt;a_iocb-&gt;ki_complete(a_work-&gt;a_iocb,100, 0);\n    kfree(a_work);\n    a_work = NULL; /* not really necessary */\n</code></pre></li>\n<li><p>Use a local variable:</p>\n\n<pre><code>    struct kiocb *iocb;\n    ...\n    iocb = a_work-&gt;a_iocb;\n    kfree(a_work);\n    a_work = NULL; /* not really necessary */\n    iocb-&gt;ki_complete(iocb,100, 0);\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 10976985, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0XU8RlJHmJ0/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMYw7E5oEuQ7wBfm2_PZS5Ig6Jyiw/mo/photo.jpg?sz=128", "display_name": "zz bb", "link": "https://stackoverflow.com/users/10976985/zz-bb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 55188419, "answer_count": 1, "score": 0, "last_activity_date": 1575807138, "creation_date": 1552466431, "last_edit_date": 1575807138, "question_id": 55137519, "link": "https://stackoverflow.com/questions/55137519/kernel-oops-when-calling-aio-complete-by-workqueue", "title": "Kernel Oops when calling aio_complete by workqueue", "body": "<p>Short Edition of the question:</p>\n\n<p>Process submit IO through io_submit(file open with O_DIRECT).\nWhen <code>kiocb-&gt;ki_complete(aio_complete_rw)</code> is called in fs address_space_operations <code>.direct_IO</code>, everything works well.\nBut when <code>kiocb-&gt;ki_complete(aio_complete_rw)</code> is called in workqueue work function(queued at the end of fs <code>.direct_IO</code>), kernel Oops happens.</p>\n\n<hr>\n\n<p>I have modified code of a fs to receive request from libaio interfaces, fs would queue request to workqueue and return <code>EIOCBQUEUED</code>.\nThen the queued work would just call <code>iocb-&gt;ki_complete</code>, and kernel Oops happens.</p>\n\n<pre><code>[  161.904957] BUG: unable to handle kernel NULL pointer dereference at 0000000000000008\n[  161.905850] IP: async_read_work+0x246/0x2e0 \n[  161.906425] PGD 0 P4D 0 \n[  161.906693] Oops: 0000 [#1] SMP NOPTI\n[  161.910190] CPU: 0 PID: 208 Comm: kworker/0:3 Tainted: G           OE    4.15.7 #1\n[  161.912829] RIP: 0010:async_read_work+0x246/0x2e0\n[  161.913454] RSP: 0018:ffffb3aac0657e28 EFLAGS: 00010282\n[  161.913980] RAX: 000000000000000c RBX: ffff9bd0f682c720 RCX: 0000000000000006\n[  161.914728] RDX: 0000000000000000 RSI: 0000000000000086 RDI: ffff9bd0ffc16650\n[  161.915481] RBP: ffff9bd0f689cc00 R08: 0000000000000001 R09: 000000000000024f\n[  161.916196] R10: ffffda7300da0b00 R11: 000000000000024f R12: 0000000000000002\n[  161.916959] R13: 0000000000000001 R14: ffff9bd0f689cc00 R15: 0000000000000001\n[  161.917720] FS:  0000000000000000(0000) GS:ffff9bd0ffc00000(0000) knlGS:0000000000000000\n[  161.918566] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[  161.919141] CR2: 0000000000000008 CR3: 000000002820a005 CR4: 00000000003606f0\n[  161.919896] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000\n[  161.920648] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400\n[  161.921362] Call Trace:\n[  161.921697]  process_one_work+0x147/0x3d0\n[  161.922119]  worker_thread+0x4a/0x440\n[  161.922540]  kthread+0xf8/0x130\n[  161.922864]  ? process_one_work+0x3d0/0x3d0\n[  161.923308]  ? kthread_associate_blkcg+0x90/0x90\n[  161.923827]  ret_from_fork+0x35/0x40\n[  161.924193] Code: 8b b8 58 04 00 00 48 83 c7 70 e8 d6 ee c6 e3 4c 89 f7 e8 9e e0 db e3 48 89 df e8 96 e0 db e3 48 c7 c7 f3 af 46 c0 e8 d4 e7 c7 e3 &lt;48&gt; 8b 3c 25 08 00 00 00 31 d2 be 64 00 00 00 48 8b 47 10 e8 62 \n[  161.926145] RIP: async_read_work+0x246/0x2e0  RSP: ffffb3aac0657e28\n[  161.926911] CR2: 0000000000000008\n[  161.927257] ---[ end trace 1f9420e2f5786b43 ]---\n</code></pre>\n\n<p>I have tried call iocb->ki_complete in fs(before return <code>EIOCBQUEUED</code>) and it work well.</p>\n\n<p>PS:I am trying to use workqueue to do memcpy request asynchronously, and memcpy request are passed through libaio interfaces and using libaio notification mechanism.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>struct async_work_stuct{\n    struct iov_iter *a_iter;\n    struct kiocb *a_iocb;\n    int w_nr_segs;\n    struct pinned_page *p;\n    struct work_struct awork;\n    struct task_struct *tsk;\n};\n\nstruct pinned_page{\n    struct page *pages[64];\n    int num;\n    int mapped;\n};\n</code></pre>\n\n<p>Queue the work and return <code>EIOCBQUEUED</code>:</p>\n\n<pre><code>const struct address_space_operations aops_xip = {\n  .direct_IO= my_direct_IO,\n};\nstatic ssize_t my_direct_IO(struct kiocb *iocb, struct iov_iter *iter)\n{\n...\nunsigned long nr_segs = iter-&gt;nr_segs;\nstruct pinned_page *pp = (struct pinned_page*)kzalloc(nr_segs*sizeof(struct pinned_page),GFP_KERNEL);\nstruct async_work_stuct *read_work = (struct async_work_stuct*)kzalloc(sizeof(struct async_work_stuct),GFP_KERNEL);\n\nread_work-&gt;w_nr_segs = nr_segs;\nread_work-&gt;p = pp;\nread_work-&gt;a_iter = iter;\nread_work-&gt;a_iocb = iocb;\nread_work-&gt;tsk = current;\n\nINIT_WORK(&amp;(read_work-&gt;awork), async_read_work);\n\nbak = queue_work(sb-&gt;s_dio_done_wq, &amp;(read_work-&gt;awork));\n\nret = -EIOCBQUEUED; \nreturn ret;\n}\n</code></pre>\n\n<p>Workqueue work function:</p>\n\n<pre><code>void async_read_work(struct work_struct *p_work)\n{\n    struct async_work_stuct *a_work = container_of(p_work, struct async_work_stuct, awork);\n    struct pinned_page *pp = a_work-&gt;p;\n    ...\n    kfree(pp);\n    pp = NULL;\n    kfree(a_work);\n    a_work = NULL;\n    a_work-&gt;a_iocb-&gt;ki_complete(a_work-&gt;a_iocb,100, 0);\n}\n</code></pre>\n\n<p>In my work function,I print the add of aio complete function,then kernel oops happen.</p>\n\n<pre><code>printk(\"aio_complete_addr = %u\",a_work-&gt;a_iocb-&gt;ki_complete);\n</code></pre>\n\n<p>Is that means <code>iocb</code> is initialized wrong?\nMy user process submits IO through io_submit,and <a href=\"https://elixir.bootlin.com/linux/latest/source/fs/aio.c#L1438\" rel=\"nofollow noreferrer\">here</a> the aio complete function points to <code>aio_complete_rw</code>.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1552465809, "post_id": 55137301, "comment_id": 97015049, "body": "The second <code>getchar</code> call make you skip every second character. Which might lead you to skip the end of the line. And of course skip every other digit."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1552465852, "post_id": 55137301, "comment_id": 97015077, "body": "Also note that <a href=\"https://en.cppreference.com/w/c/io/getchar\" rel=\"nofollow noreferrer\"><code>getchar</code></a> returns an <b><code>int</code></b>, which is important when you check against <code>EOF</code> (which you really should)."}, {"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "edited": false, "score": 1, "creation_date": 1552465931, "post_id": 55137301, "comment_id": 97015135, "body": "What is the weird output and what output do you expect? For now, you print every second character read on its own line and check if the printed character is a newline."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1552466100, "post_id": 55137301, "comment_id": 97015230, "body": "Also please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552475367, "post_id": 55137559, "comment_id": 97020952, "body": "When <code>scanf(&quot;%d&quot;, &amp;n)</code> encounter a line of input <code>&quot;\\n&#39;&quot;</code>, it will consume that whitespace and read more, waiting as needed."}, {"owner": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552479973, "post_id": 55137559, "comment_id": 97023880, "body": "Correct. It will only read integers ignoring any whitespace characters. It will only stop reading at non-integer non-whitespace character or end of input."}], "tags": [], "owner": {"reputation": 15176, "user_id": 390363, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/662dda87a8ad559dca5570b7786cf6fb?s=128&d=identicon&r=PG", "display_name": "aragaer", "link": "https://stackoverflow.com/users/390363/aragaer"}, "is_accepted": false, "score": -2, "last_activity_date": 1552466593, "creation_date": 1552466593, "answer_id": 55137559, "question_id": 55137301, "link": "https://stackoverflow.com/questions/55137301/scanning-all-integers-from-the-standard-input-assume-that-each-input-line-is-an/55137559#55137559", "title": "Scanning all integers from the standard input. Assume that each input line is an integer and an empty line denotes end of input", "body": "<p>The simplest way is to just read integers and stop when there is no more integers to read. <code>scanf</code> works fine:</p>\n\n<pre><code>int n;\nwhile (scanf(\"%d\", &amp;n) == 1) {\n    // do something with integer n\n}\n// last scanf call failed to find an integer, so that's probably the end of input\n</code></pre>\n\n<p>This will not work if the input is in form \"integers, empty line, more integers that should be ignored\". In that case the code should be a bit more complex.</p>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1552470975, "post_id": 55137583, "comment_id": 97018253, "body": "This still doesn&#39;t scan integers but chars"}], "tags": [], "owner": {"reputation": 45, "user_id": 7861742, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1122558827889522/picture?type=large", "display_name": "Patrick Hession", "link": "https://stackoverflow.com/users/7861742/patrick-hession"}, "is_accepted": false, "score": -3, "last_activity_date": 1552466677, "creation_date": 1552466677, "answer_id": 55137583, "question_id": 55137301, "link": "https://stackoverflow.com/questions/55137301/scanning-all-integers-from-the-standard-input-assume-that-each-input-line-is-an/55137583#55137583", "title": "Scanning all integers from the standard input. Assume that each input line is an integer and an empty line denotes end of input", "body": "<p>Here is what I think you are looking for. In your original code snippet, you were only going to be printing every second integer because of the two getchar() functions, instead of removing that will read all characters. Then including the if statement before the print statement means you won't print out a newline character when printing the results.</p>\n\n<pre><code>            while (1)\n            {\n                char ch=getchar();\n                if(ch=='\\n')\n                    break;\n                printf(\"%c\\n\",ch);\n            }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "edited": false, "score": 0, "creation_date": 1552470637, "post_id": 55138255, "comment_id": 97018020, "body": "what about negative values?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "edited": false, "score": 0, "creation_date": 1552471206, "post_id": 55138255, "comment_id": 97018388, "body": "@Mayur Good point. Forgot about that. Answer updated."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552475832, "post_id": 55138255, "comment_id": 97021231, "body": "Minor nits: OP did say &quot;integers&quot; which could include <code>long long</code> or beyond.  This code does have comer issues with <code>&quot;+234&quot; or &quot; 123&quot; or unnecessary </code>int` overflow with input like <code>&quot;-2147483648&quot;</code>."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1552471680, "last_edit_date": 1552471680, "creation_date": 1552468990, "answer_id": 55138255, "question_id": 55137301, "link": "https://stackoverflow.com/questions/55137301/scanning-all-integers-from-the-standard-input-assume-that-each-input-line-is-an/55138255#55138255", "title": "Scanning all integers from the standard input. Assume that each input line is an integer and an empty line denotes end of input", "body": "<p>I see a number of problems with your code:</p>\n\n<ol>\n<li><p>The code doesn't read integers. It reads chars and print them. However, it only prints every second char as the return value of second <code>getchar</code> isn't used.</p></li>\n<li><p>There is no error checking. </p></li>\n<li><p>The return type of <code>getchar</code> is <code>int</code> - not <code>char</code>.</p></li>\n</ol>\n\n<p>There are many ways to do what you want. It seems you want a solution using <code>getchar</code> so something like this could be a way:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n    while (1)\n    {\n        int n = 0;\n        int multiplier = 1;\n        int ch=getchar();\n        if(ch=='\\n') break;  // Empty line - stop reading integers\n        if(ch=='-')\n        {\n            // Handle negative values\n            multiplier = -1;\n            ch=getchar();\n            if(ch=='\\n') exit(1);  // Error - unexpected newline\n        }\n        do\n        {\n            if(ch==EOF) exit(1); // Input error\n            if (ch &lt; '0' || ch &gt; '9') exit(1); // Error - input is not a digit\n\n            // \"Add\" current digit to the integer\n            n = n * 10;\n            n = n + ch - '0';\n\n            ch=getchar();\n        } while (ch != '\\n');\n        n = multiplier * n;\n        printf(\"%d\\n\", n);\n    }\n    printf (\"done\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>A few comments:</p>\n\n<p>The code above is not \"production quality\" but I wanted to keep the example simple. Some of the short commings are described below.</p>\n\n<ol>\n<li><p>Just calling <code>exit(1)</code> on error is probably not what you want in a real application. At least you would print some error message first but in general you would add better error handling when dealing with user input.</p></li>\n<li><p>The calculation of the integer value does not check for integer overflow. In a real application that is something you want to add.</p></li>\n<li><p>The line <code>if(ch==EOF) exit(1);</code> isn't really needed because the next if-statement will catch that case and exit anyway. However, I added to show the difference between an input error and non-digit input.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1552471039, "post_id": 55138949, "comment_id": 97018284, "body": "Adding a small explanation would be a good idea"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1552471908, "post_id": 55138949, "comment_id": 97018839, "body": "This is a nice compact solution but it doesn&#39;t have much error checking. Input like &quot;abcd&quot; will print 0 and input like &quot;123abcd&quot; will print 123. Don&#39;t know if that&#39;s acceptable for OP."}, {"owner": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "edited": false, "score": 0, "creation_date": 1552471962, "post_id": 55138949, "comment_id": 97018874, "body": "In the question it is mentioned that &quot;Assume that each input line is an integer and an empty line&quot;"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552472481, "post_id": 55138949, "comment_id": 97019197, "body": "@Mayur I did notice that &quot;Assume ...&quot; part. I just don&#39;t like writing code with such assumption about user input. Instead of <code>atoi</code> I think I would prefer <code>if (sscanf(input, &quot;%d%n&quot;, &amp;n, &amp;cnt) != 1) exit(1);</code> and then check that all character was used, i.e. comparing <code>cnt</code> to <code>strlen</code>. Anyway - still a good compact solution so +1"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552476162, "post_id": 55138949, "comment_id": 97021438, "body": "@4386427 Comparing <code>cnt</code> to <code>strlen</code> is problematic as the <code>char</code> after the numeric input <i>may</i> be a <code>&#39;\\n&#39;</code> or 0.  A simple alternative is  <code>if (sscanf(input, &quot;%d %n&quot;, &amp;n, &amp;cnt) != 1 || input[cnt])</code>  (add space and check the last character to see if non-white-space.)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552476741, "post_id": 55138949, "comment_id": 97021772, "body": "@chux The compare would be <code>cnt == strlen -1</code> to make sure that all characters (except newline was used for the conversion)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552477167, "post_id": 55138949, "comment_id": 97022032, "body": "@4386427 <a href=\"https://stackoverflow.com/questions/55137301/scanning-all-integers-from-the-standard-input-assume-that-each-input-line-is-an/55138949?noredirect=1#comment97021772_55138949\">That</a> assumes <code>input</code> has a <code>&#39;\\n&#39;</code> - a reasonable assumption yet goes against <a href=\"https://stackoverflow.com/questions/55137301/scanning-all-integers-from-the-standard-input-assume-that-each-input-line-is-an/55138949?noredirect=1#comment97019197_55138949\">this philosophy</a>.  That is not certain with 1) long lines 2) end of <code>stdin</code> input and some other esoteric cases."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552477627, "post_id": 55138949, "comment_id": 97022333, "body": "@chux True - there should also be a check for <code>&#39;\\n&#39;</code> which can easilly be added. My point was simply that <code>atoi</code> silently accepts things that are not integers and that <code>sscanf</code> will give a way to know the number of chars used in the conversion."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552483019, "post_id": 55138949, "comment_id": 97025872, "body": "@4386427 <code>sscanf(input, &quot;%d%n&quot;, &amp;n, &amp;cnt)</code> is UB on when the converted   text input exceeds the <code>int</code> range.  Agree it is a step better than <code>atoi()</code>, but it also has its troubles too."}], "tags": [], "owner": {"reputation": 2019, "user_id": 10035556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86cea073655558939d961937095efc80?s=128&d=identicon&r=PG&f=1", "display_name": "Mayur", "link": "https://stackoverflow.com/users/10035556/mayur"}, "is_accepted": true, "score": 1, "last_activity_date": 1552475063, "last_edit_date": 1552475063, "creation_date": 1552470998, "answer_id": 55138949, "question_id": 55137301, "link": "https://stackoverflow.com/questions/55137301/scanning-all-integers-from-the-standard-input-assume-that-each-input-line-is-an/55138949#55138949", "title": "Scanning all integers from the standard input. Assume that each input line is an integer and an empty line denotes end of input", "body": "<p>As your assumptions is given lines are integer so we can use below code.<br/>\n<a href=\"https://linux.die.net/man/3/atoi\" rel=\"nofollow noreferrer\">atoi</a> function converts a <code>string</code> to <code>int</code><br/>\n<a href=\"https://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\">fgets</a> used to take string input from the user <br/></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n  char str[1024]={};\n  while( fgets(str, 1024, stdin) &amp;&amp; str[0] != 0 &amp;&amp; str[0] != '\\n' ){\n      int n = atoi(str);\n      printf(\"%d\\n\", n);\n  }\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4925987, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wSAESVBSoJQ/AAAAAAAAAAI/AAAAAAAABQc/udfCkTp02oc/photo.jpg?sz=128", "display_name": "Akhil Jain", "link": "https://stackoverflow.com/users/4925987/akhil-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "closed_date": 1552472018, "accepted_answer_id": 55138949, "answer_count": 4, "score": -2, "last_activity_date": 1552475063, "creation_date": 1552465599, "question_id": 55137301, "link": "https://stackoverflow.com/questions/55137301/scanning-all-integers-from-the-standard-input-assume-that-each-input-line-is-an", "closed_reason": "Not suitable for this site", "title": "Scanning all integers from the standard input. Assume that each input line is an integer and an empty line denotes end of input", "body": "<p>Scanning all integers from the standard input. Assume that each input line is an integer and an empty line denotes end of input.</p>\n\n<p>I need to scan integer from a line and if the entered input is empty then break.\nTried the following code but it gives weird output.</p>\n\n<pre><code>while (true)\n        {\n            char ch=getchar();\n            printf(\"%c\\n\",ch);\n\n            if(ch=='\\n')\n            {\n                break;\n\n            }\n            //printf(\"%d\\n\",myInt);\n            getchar();\n        }\n</code></pre>\n\n<p>Kindly help!\nThanks</p>\n"}, {"tags": ["android", "c", "kotlin", "java-native-interface"], "answers": [{"comments": [{"owner": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 0, "creation_date": 1552467095, "post_id": 55137467, "comment_id": 97015749, "body": "thanks for the answer. I have an access to all the native code. So I have compiled my native libraries for all platforms. I have checked that all .so files are present in every abi library. So we can be sure that all libs are compiled. May be the problem is the Android App bundle compilation? This issue is happening only on some ammount of x64 devices. On most of x64 devices everything is running okay. May be this be a problem of a specific device? At the current moment I have about 200 crashes per 10000 updates"}, {"owner": {"reputation": 14396, "user_id": 1395437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0afd3049729ecebbf134e297e278e0c1?s=128&d=identicon&r=PG", "display_name": "Daniel Zolnai", "link": "https://stackoverflow.com/users/1395437/daniel-zolnai"}, "reply_to_user": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 1, "creation_date": 1552469618, "post_id": 55137467, "comment_id": 97017312, "body": "Have you checked the .so files in the split release apks? Perhaps it could have been ignored during the release build process. It might also be false reporting, see this similar question: <a href=\"https://stackoverflow.com/questions/52595535/using-an-app-bundle-i-get-unsatisfiedlinkerror-for-1-of-users\" title=\"using an app bundle i get unsatisfiedlinkerror for 1 of users\">stackoverflow.com/questions/52595535/&hellip;</a>"}, {"owner": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 0, "creation_date": 1552471439, "post_id": 55137467, "comment_id": 97018544, "body": "I&#39;ll try to take a look at my bundle to check if all native libs are there. I haven&#39;t done this already. And I am also wondering - my be some users are able to install the bundle without Google Play. May be they are fetching apks from rooted phone and then published them somewhere and other people who are trying to install these cracked apks are running this issue?"}, {"owner": {"reputation": 14396, "user_id": 1395437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0afd3049729ecebbf134e297e278e0c1?s=128&d=identicon&r=PG", "display_name": "Daniel Zolnai", "link": "https://stackoverflow.com/users/1395437/daniel-zolnai"}, "reply_to_user": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 1, "creation_date": 1552474636, "post_id": 55137467, "comment_id": 97020556, "body": "That might be it. In Google Play crash statistics you can filter on install source (Google Play or Other), that would filter this issue out."}, {"owner": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 0, "creation_date": 1552475667, "post_id": 55137467, "comment_id": 97021138, "body": "I was hoping that this issue was running on installation not from GP. But nope. All the issues have come form the apps installed via GooglePlay"}, {"owner": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 1, "creation_date": 1552475765, "post_id": 55137467, "comment_id": 97021195, "body": "I am missing this line in my build.gradle ndk.abiFilters = &#39;armeabi-v7a&#39; &#39;arm64-v8a&#39; &#39;x86&#39; &#39;x86_64&#39;. May be the problem is in that I don&#39;t have this line in build.gradle?"}, {"owner": {"reputation": 14396, "user_id": 1395437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0afd3049729ecebbf134e297e278e0c1?s=128&d=identicon&r=PG", "display_name": "Daniel Zolnai", "link": "https://stackoverflow.com/users/1395437/daniel-zolnai"}, "reply_to_user": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 0, "creation_date": 1552481809, "post_id": 55137467, "comment_id": 97025047, "body": "It just reduces the amount of splits, since there exist no mips, and armeabi devices anymore. It is a good way to reduce the amount of apks, or save space if you build a single one. Did you check the split apks, if they contain the correct ABI .so files?"}, {"owner": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 0, "creation_date": 1552483774, "post_id": 55137467, "comment_id": 97026395, "body": "How can I fetch splitted apks from the bundle?"}, {"owner": {"reputation": 14396, "user_id": 1395437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0afd3049729ecebbf134e297e278e0c1?s=128&d=identicon&r=PG", "display_name": "Daniel Zolnai", "link": "https://stackoverflow.com/users/1395437/daniel-zolnai"}, "reply_to_user": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 1, "creation_date": 1552487209, "post_id": 55137467, "comment_id": 97028961, "body": "Have a look at bundletool from this medium post: <a href=\"https://medium.com/google-developer-experts/explor\" rel=\"nofollow noreferrer\">medium.com/google-developer-experts/explor</a>\u2026"}, {"owner": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 1, "creation_date": 1552488124, "post_id": 55137467, "comment_id": 97029658, "body": "Ok. Thanks. I&#39;ll check and later write about my success"}, {"owner": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 0, "creation_date": 1552548643, "post_id": 55137467, "comment_id": 97053349, "body": "I&#39;ve checked my bundle - all libs are there. May be the problem is in that Android OS is looking for the so in the wrong folder -/lib/arm64? Why I does not looking for it in the arm64-v8a?"}, {"owner": {"reputation": 14396, "user_id": 1395437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0afd3049729ecebbf134e297e278e0c1?s=128&d=identicon&r=PG", "display_name": "Daniel Zolnai", "link": "https://stackoverflow.com/users/1395437/daniel-zolnai"}, "reply_to_user": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "edited": false, "score": 1, "creation_date": 1552560157, "post_id": 55137467, "comment_id": 97059911, "body": "/lib/arm64 looks right, something else might be the issue. I&#39;m out of ideas, if I were you, I would try to buy or borrow a device which it crashes on, and observe the behavior with a debugger (or check the filesystem with root)"}, {"owner": {"reputation": 216, "user_id": 999716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iGbfi.jpg?s=128&g=1", "display_name": "JHawkZZ", "link": "https://stackoverflow.com/users/999716/jhawkzz"}, "edited": false, "score": 0, "creation_date": 1582345598, "post_id": 55137467, "comment_id": 106755423, "body": "Thanks for the thorough answer! This fixed the sporadic crashes I was seeing on various devices."}], "tags": [], "owner": {"reputation": 14396, "user_id": 1395437, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0afd3049729ecebbf134e297e278e0c1?s=128&d=identicon&r=PG", "display_name": "Daniel Zolnai", "link": "https://stackoverflow.com/users/1395437/daniel-zolnai"}, "is_accepted": false, "score": 8, "last_activity_date": 1552466241, "creation_date": 1552466241, "answer_id": 55137467, "question_id": 55136767, "link": "https://stackoverflow.com/questions/55136767/android-native-library-so-unsatisfied-link-error/55137467#55137467", "title": "Android native library (.so) - unsatisfied link error", "body": "<p>Your problem is not with the library code, but with the .so files themselves.\nAndroid devices have a primary ABI, the instruction set supported by the processor.\nFor example, some devices with 64-bit processors use the ABI <code>arm64-v8a</code>.</p>\n\n<p>However, a lot of libraries and apps don't support 64-bit processors yet. So usually, the newer processors also support a secondary ABI, which is a more common one. <code>arm64-v8a</code> processors usually support <code>armeabi-v7a</code> too, for example.</p>\n\n<p>When the app starts, it starts looking for the native libraries in the directories. First it checks in the primary ABI directory, <code>arm64-v8a</code> in this example. If the .so files are not there, it checks in the secondary ABI directory (<code>armeabi-v7a</code>). If still not found, you will get the error you described.</p>\n\n<p>In your case, you have the files, as you said, so that's not the problem.</p>\n\n<p>One big problem with this selection is, that it always sticks to the primary ABI, if the directory exists. This can lead to crashes if not all libraries supply all .so files for all ABIs. This is described <a href=\"https://developer.android.com/ndk/guides/abis.html#aen\" rel=\"noreferrer\">here</a>.</p>\n\n<p>Here's an example: you include 2 libraries in your app:\n1. VideoPlayerLibrary, which has .so files for all ABIs\n2. GifLibrary, which has .so files only for <code>armeabi</code> and <code>armeabi-v7a</code>.</p>\n\n<p>Now if you start the app on an <code>arm64-v8a</code> device, it will stick to it's primary ABI, because it has found files there (the .so files of VideoPlayerLibrary). But at the moment you want to play gifs, it will try to load the .so files from the <code>arm64-v8a</code> directory, but it will not find them there and it will crash as in your post with a link error.</p>\n\n<p><strong>So what can you do?</strong></p>\n\n<p>You have 2 options:</p>\n\n<ol>\n<li>If it is your own library which has the missing .so files, compile it for all ABIs. \nIf it is not your own, check if there's a newer version which has fixed this issue.</li>\n<li>Exclude the incomplete ABIs from the app. This way the newer processors will use the secondary ABI for running the app. This will result in worse performance of course, but it will not crash.\nFrom my experience, the most important ABI is <code>armeabi-v7a</code>, this should be supported by probably all Android devices.</li>\n</ol>\n"}], "owner": {"reputation": 891, "user_id": 1885632, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6541bdccc20a7b3abb93ad88312e606f?s=128&d=identicon&r=PG", "display_name": "bukka.wh", "link": "https://stackoverflow.com/users/1885632/bukka-wh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2130, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552466241, "creation_date": 1552463356, "question_id": 55136767, "link": "https://stackoverflow.com/questions/55136767/android-native-library-so-unsatisfied-link-error", "title": "Android native library (.so) - unsatisfied link error", "body": "<p>I have recently created and published an Android App bundle with compiled native libraries for all processors architectures. On most of devices everything is running ok. But on some of devices I can see this error in Crashlytics console\n<strong>Fatal Exception: java.lang.UnsatisfiedLinkError\ndalvik.system.PathClassLoader[DexPathList[[zip file \"/system/framework/org.apache.http.legacy.boot.jar\", zip file \"/data/app/com.someapp-wAu5DoLmLvM_RVnbU1qsCg==/base.apk\"],nativeLibraryDirectories=[/data/app/com.someapp-wAu5DoLmLvM_RVnbU1qsCg==/lib/arm64, /system/lib64]]] couldn't find \"somemylib.so\"</strong></p>\n\n<p>I am wondering - why this may happen. I have libs for x64 processors. This is happening only on some devices - but this crash is the most often in Crashlytics. \nAll my libs are stored inside jniLibs directory\nTHese are some pieces from my build.gradle</p>\n\n<pre><code>bundle {\n    density {\n        // Different APKs are generated for devices with different screen densities; true by default.\n        enableSplit false\n    }\n    abi {\n        // Different APKs are generated for devices with different CPU architectures; true by default.\n        enableSplit true\n    }\n    language {\n        // This is disabled so that the App Bundle does NOT split the APK for each language.\n        // We're gonna use the same APK for all languages.\n        enableSplit false\n    }\n}\nsplits {\n    abi {\n        enable true\n        reset()\n        include 'armeabi', 'mips', 'x86', 'armeabi-v7a', 'arm64-v8a', \n 'mips64', 'x86_64'\n    }\n}\nsourceSets {\n\n    main {\n        jniLibs.srcDirs = ['jniLibs']\n    }\n}\n</code></pre>\n\n<p>I have a service class inside my app which is trying to load native library when someone is starting it. My be sometimes this \"start\" call to service is executing before the OS can detect the native libs in my app? But I don't think that this is so.\nCan you help me please</p>\n"}, {"tags": ["c++", "c", "shared-libraries", "grpc", "etcd3"], "comments": [{"owner": {"reputation": 22416, "user_id": 5494370, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152989584621642/picture?type=large", "display_name": "Alan Birtles", "link": "https://stackoverflow.com/users/5494370/alan-birtles"}, "edited": false, "score": 1, "creation_date": 1552464408, "post_id": 55136665, "comment_id": 97014370, "body": "please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. the exception is probably a divide by zero but could be others too, you&#39;ll need to debug it."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1552464718, "post_id": 55136665, "comment_id": 97014518, "body": "Generally any application that uses a C++ library will need to be linked in the same way a C++ application would get linked by a C++ compiler."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1552464887, "post_id": 55136665, "comment_id": 97014589, "body": "Possibly the grpc++ wrapper has FP exception handler installed."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552465297, "post_id": 55136665, "comment_id": 97014778, "body": "Yes this is a linking issue not a compiler issue. I would be looking at whether or not the ABI is compatible or not, which spoiler alert: it&#39;s probably not. Wrappers and compilers are API level, linkers are ABI level."}], "owner": {"reputation": 19, "user_id": 5462392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44559cb6e57899e133669bdf6eb62384?s=128&d=identicon&r=PG&f=1", "display_name": "Kuldeepsinh", "link": "https://stackoverflow.com/users/5462392/kuldeepsinh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1592101574, "creation_date": 1552462850, "last_edit_date": 1552467817, "question_id": 55136665, "link": "https://stackoverflow.com/questions/55136665/c-shared-library-gives-floating-point-exception-when-linked-with-c-application", "title": "C++ Shared library gives floating point exception when linked with C application", "body": "<p><strong>Background:</strong></p>\n\n<p>A C++ library for <code>etcd client</code> having APIs to communicate with <code>etcd server</code>, to use this library in C application, we wrote C++ wrappers over this library so that it can be called by C application.</p>\n\n<p>Created a shared library using the below command:</p>\n\n<pre><code>g++-7 -ggdb -fPIC -shared -o libetcd_c++.so etcd_client_wrapper.cc etcd_client_txn_wrapper.cc etcd_client.cc etcd_client_txn.cc utils/string.cc pb/*.cc -std=c++1z -I ./pb/etcd -rdynamic -Wl,-call_shared -lglog -lprotobuf -lgrpc++ -lgrpc -Wl,-call_shared -lpthread -ldl -lc\n</code></pre>\n\n<p>placed this library to default library path <code>/usr/local/lib</code> and load the library with <code>sudo ldconfig</code>.</p>\n\n<p>Now using this <code>etcd_c++</code> library APIs, wrote a C code to insert simple key-value to <code>etcd keyspace</code>. Compiled using below command:</p>\n\n<pre><code>gcc -ggdb -o cwrap sample_wrapper.c -rdynamic -pthread -static-libstdc++ -Wl,-non_shared -lglog -lprotobuf -pthread -lz -lgrpc++ -lprotobuf -lgrpc -lz -lcares -lssl -lcrypto -lunwind -llzma -lgflags -Wl,-call_shared -lpthread -ldl -letcd_c++ -lstdc++\n</code></pre>\n\n<p>The compilation goes fine. But while executing the resulted binary, it gives floating point exception in <code>grpc++</code> library.</p>\n\n<p>Questions:</p>\n\n<ol>\n<li>What <code>floating point exception</code> has to do with the library?</li>\n<li>We thought it might be an issue with C to C++ transition, but when converted the same C code to C++ with same wrapper API. Gives the <code>floating point exception</code>.Now If we replace the wrapper API with direct <code>grpc++</code> library API, in the C++ code, it works fine. Is it a linking issue?</li>\n</ol>\n\n<p>Compiling a C++ application:</p>\n\n<pre><code>g++-7 -ggdb -o wrap example.cc -std=c++1z -rdynamic -pthread -static-libstdc++ -Wl,-non_shared -lglog -lprotobuf -pthread -lz -lgrpc++ -lprotobuf -lgrpc -lz -lcares -lssl -lcrypto -lunwind -llzma -lgflags -Wl,-call_shared -lpthread -ldl -letcd_c++\n</code></pre>\n\n<p><strong>EDIT</strong>: Some findings, <a href=\"https://bugs.launchpad.net/ubuntu/+source/grpc/+bug/1797000\" rel=\"nofollow noreferrer\">https://bugs.launchpad.net/ubuntu/+source/grpc/+bug/1797000</a></p>\n\n<p>Though We are not using <code>-Wl,-Bsymbolic-functions</code> option, but the issue is somewhat similar to above.  </p>\n"}, {"tags": ["c", "multidimensional-array", "malloc"], "comments": [{"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "edited": false, "score": 0, "creation_date": 1552461452, "post_id": 55136040, "comment_id": 97013066, "body": "There is no array in your code"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552476445, "post_id": 55136040, "comment_id": 97021610, "body": "@4386427 malloc in this code gives a chunk of memory which is incorrectly pointed at by a <code>char**</code> - a type which doesn&#39;t correspond with the size of the allocated chunk. It cannot be used as an array of pointers since it is incorrect."}, {"owner": {"reputation": 1220, "user_id": 5878272, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/14e96159153b67fab5222b7c5fa18c71?s=128&d=identicon&r=PG&f=1", "display_name": "Fredrik", "link": "https://stackoverflow.com/users/5878272/fredrik"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552496081, "post_id": 55136040, "comment_id": 97035081, "body": "@4386427 malloc does not give an array."}], "answers": [{"tags": [], "owner": {"reputation": 487, "user_id": 11132825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33a657dd7091f84e884cf5650342aa98?s=128&d=identicon&r=PG&f=1", "display_name": "Adrien", "link": "https://stackoverflow.com/users/11132825/adrien"}, "is_accepted": false, "score": 0, "last_activity_date": 1552460736, "creation_date": 1552460736, "answer_id": 55136176, "question_id": 55136040, "link": "https://stackoverflow.com/questions/55136040/segfault-on-accessing-elements-of-dynamic-2d-array/55136176#55136176", "title": "Segfault on accessing elements of dynamic 2d array", "body": "<p>The inner while loop need to end if <code>s[i]</code> is <code>NULL</code> : <code>while (s[i] != c &amp;&amp; s[i] != '\\0')</code></p>\n\n<p>You check for <code>s[i + 1]</code> in your <code>if</code> statement but you continue looping.</p>\n\n<p>Also you are allocating way more bytes than necessary, you could have a buffer of same size of your input string, and when the delimiter or NULL is found, you allocate a new row in your array of the needed size and copy the buffer into it.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552476504, "post_id": 55136273, "comment_id": 97021652, "body": "&quot;allocates memory for saving a number of pointers (i.e. strlen(s) + 2 pointers) but not any memory for saving characters&quot;. No. It allocates <code>sizeof(char) * (strlen(s) + 2)</code> bytes, which is nonsense."}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 2, "last_activity_date": 1552477032, "last_edit_date": 1552477032, "creation_date": 1552461154, "answer_id": 55136273, "question_id": 55136040, "link": "https://stackoverflow.com/questions/55136040/segfault-on-accessing-elements-of-dynamic-2d-array/55136273#55136273", "title": "Segfault on accessing elements of dynamic 2d array", "body": "<p>There are a number of problems with your code but the most important is the dynamic allocation. Your code does not allocate memory for saving an array of strings (aka an array of array of char).</p>\n\n<p>This line:</p>\n\n<pre><code>arr = malloc(sizeof(**arr) * (strlen(s) + 2));\n</code></pre>\n\n<p>allocates memory for saving a number chars (i.e. <code>strlen(s) + 2</code> chars) but that is not what you want. Especially not when <code>arr</code> is a pointer to pointer to char.</p>\n\n<p>A simple approach that you can use is to allocate an array of char pointers and then for each of these pointers allocate an array of char.</p>\n\n<p>This would be:</p>\n\n<pre><code>char** arr = malloc(sizeof(*arr) * NUMBER_OF_WORDS_IN_INPUT);\n\narr[0] = malloc(NUMBER_OF_CHARACTERS_IN_WORD0 + 1);\narr[1] = malloc(NUMBER_OF_CHARACTERS_IN_WORD1 + 1);\n...\narr[NUMBER_OF_WORDS_IN_INPUT - 1] = malloc(NUMBER_OF_CHARACTERS_IN_LAST_WORD + 1);\n</code></pre>\n\n<p>Then you can store characters into <code>arr</code> using the syntax</p>\n\n<pre><code>arr[i][j] = SOME_CHARACTER;\n</code></pre>\n\n<p><strong>without segfaults</strong>. (It is of cause required that <code>i</code> and <code>j</code> is within bounds of the allocation).</p>\n"}], "owner": {"reputation": 11, "user_id": 11195208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d936cd3a6837de10a960cae206c3fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Firebird", "link": "https://stackoverflow.com/users/11195208/firebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552477032, "creation_date": 1552460126, "question_id": 55136040, "link": "https://stackoverflow.com/questions/55136040/segfault-on-accessing-elements-of-dynamic-2d-array", "title": "Segfault on accessing elements of dynamic 2d array", "body": "<p>My goal is to create a function that converts a string into an array of \"words\" resulted from splitting an initial string by a delimiter. All words should be null-terminated. \nFor example: strtoarr(\"**hello***world*\", \"*\") should result in {\"hello\", \"world\"}. Here's my function.</p>\n\n<pre><code>char    **strtoarr(char const *s, char c)\n{\n    char    **arr;\n    size_t  i;\n    size_t  j;\n    size_t  k;\n\n    arr = malloc(sizeof(**arr) * (strlen(s) + 2));\n    if (arr == 0)\n        return (NULL);\n    i = 0;\n    k = 0;\n    while (s[i] != '\\0')\n    {\n        j = 0;\n        while (s[i] != c)\n        {\n            arr[k][j] = s[i];\n            if (s[i + 1] == c || s[i + 1] == '\\0')\n            {\n                j++;\n                arr[k][j] = '\\0';\n                k++;\n            }\n            i++;\n            j++;\n        }\n        j = 0;\n        while (s[i] == c)\n            i++;\n    }\n    arr[k] = 0;\n    return (arr);\n}\n</code></pre>\n\n<p>It works only with empty strings and segfaults with everything else. I believe the problem is here. </p>\n\n<pre><code>arr[k][j] = s[i];\n</code></pre>\n\n<p>But I don't understand what the problem is.\nThanks in advance</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1552459876, "post_id": 55135942, "comment_id": 97012360, "body": "Care to share that error? As a new user, please also take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Concerning your code, it&#39;s also customary to extract a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. BTW: C++ is more strict than C, which often lets you off with a warning. Make sure you read and understand said warning!"}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1552459972, "post_id": 55135942, "comment_id": 97012393, "body": "All of these are the same address, <code>ary1D</code>, <code>&amp;ary1D[0]</code> and <code>&amp;ary1D</code>. The difference is the <b>type</b> of the pointer. The first two are a pointer to the first element (i.e. <code>double*</code>), the last is a pointer to the array itself, i.e. <code>double (*)[4]</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 6, "creation_date": 1552460121, "post_id": 55135942, "comment_id": 97012451, "body": "Note that many of us &quot;oldies&quot; dislike the term &quot;C/C++&quot;. There is no language &quot;C/C++&quot;, only the two (very) different languages C and C++. And while some things might seem similar in both languages, there might be minute differences in the specifications that means the behavior could be vastly different."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 0, "creation_date": 1552460232, "post_id": 55135942, "comment_id": 97012496, "body": "Answer to your second question is yes, change your function signature to <code>void print1D_A(double (*ary1D)[4], int Num);</code> but really it&#39;s not a good idea."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552460464, "post_id": 55135942, "comment_id": 97012599, "body": "<i>Why</i> do you want to change the signature of the function? <i>Why</i> do you want to pass a pointer to the array? What problem is that supposed to solve? What is you <i>real</i> and <i>actual</i> problem that lead you to write this question?"}, {"owner": {"reputation": 19, "user_id": 9579225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e79cb2f495e41a2b88c0426baeb164?s=128&d=identicon&r=PG&f=1", "display_name": "Fkcm95", "link": "https://stackoverflow.com/users/9579225/fkcm95"}, "edited": false, "score": 1, "creation_date": 1552460584, "post_id": 55135942, "comment_id": 97012653, "body": "Wow, thanks! I have no problem. I want to understand, how arrays/pointers are work.. Thank you all.."}, {"owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "edited": false, "score": 1, "creation_date": 1552460704, "post_id": 55135942, "comment_id": 97012695, "body": "@Fkcm95 It&#39;s good to want to learn these things but practically pointers to arrays are very obscure, and almost never used."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 19, "user_id": 9579225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e79cb2f495e41a2b88c0426baeb164?s=128&d=identicon&r=PG&f=1", "display_name": "Fkcm95", "link": "https://stackoverflow.com/users/9579225/fkcm95"}, "edited": false, "score": 0, "creation_date": 1552460488, "post_id": 55135996, "comment_id": 97012608, "body": "@Fkcm95 You need to make it accept the type <code>double(*)[4]</code>. But then you can&#39;t pass <code>&amp;ary1D[0]</code> (or <code>ary1D</code>) as the type from that expression will no longer match."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1552459940, "creation_date": 1552459940, "answer_id": 55135996, "question_id": 55135942, "link": "https://stackoverflow.com/questions/55135942/difference-ary1d0-and-ary1d/55135996#55135996", "title": "Difference: &amp;ary1D[0] and &amp;ary1D", "body": "<p>The expression <code>&amp;ary1D[0]</code> is a pointer to the first element of <code>ary1D</code>. Its type is <code>double*</code>. This is also what plain <code>ary1D</code> <em>decays</em> to, so you could just do</p>\n\n<pre><code>print1D_A(ary1D,Num);\n</code></pre>\n\n<p>The expression <code>&amp;ary1D</code> is a pointer to the <em>array</em>. Its type is <code>double (*)[4]</code>.</p>\n\n<p>Now, both pointers are pointing to the same location, but as you can see their types are very different. That could lead to errors if a function is expecting one type and you give the other.</p>\n"}], "owner": {"reputation": 19, "user_id": 9579225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e79cb2f495e41a2b88c0426baeb164?s=128&d=identicon&r=PG&f=1", "display_name": "Fkcm95", "link": "https://stackoverflow.com/users/9579225/fkcm95"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1552468038, "answer_count": 1, "score": 0, "last_activity_date": 1552468053, "creation_date": 1552459733, "last_edit_date": 1552467811, "question_id": 55135942, "link": "https://stackoverflow.com/questions/55135942/difference-ary1d0-and-ary1d", "closed_reason": "Duplicate", "title": "Difference: &amp;ary1D[0] and &amp;ary1D", "body": "<p>I have in my main-Function an double Array: </p>\n\n<pre><code>double ary1D[4] = {1.1, 2.2, 3.3, 4.4};\n</code></pre>\n\n<p>and have a function call: </p>\n\n<pre><code>print1D_A(&amp;ary1D[0],Num);\n</code></pre>\n\n<p>my function:</p>\n\n<pre><code>void print1D_A(double *ary1D, int Num);\n</code></pre>\n\n<p>so my question is, Whats is the difference between <strong>&amp;ary1D[0]</strong> and <strong>&amp;ary1D</strong>. My compiler give me an error, if I call the function with <strong>&amp;ary1D</strong>. But the argument <strong>&amp;ary1D</strong> is the first Adress of my Array, just like <strong>&amp;ary1D[0]</strong>. </p>\n\n<p>Can I change the argumentlist of my function, that I can call it with </p>\n\n<pre><code>print1D_A(&amp;ary1D,Num);\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86-64", "volatile"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 4, "creation_date": 1552457858, "post_id": 55135478, "comment_id": 97011582, "body": "<code>while (lock)</code> doesn&#39;t care what the value of <code>lock</code> is. It only cares whether <code>lock</code> is 0 or not 0."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1552459523, "post_id": 55135478, "comment_id": 97012217, "body": "compilers dont cache, nor generally have no clue about caches.  its not a matter of caching it is a matter of whether or not the compiler is requested to perform a memory cycle to load or store the variable from/to memory before moving to the next operation."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552461386, "post_id": 55135478, "comment_id": 97013035, "body": "What other value would you use to compare against in the condition? You only use <code>while (lock)</code>, not <code>while (lock == 999)</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 3, "creation_date": 1552475342, "post_id": 55135478, "comment_id": 97020934, "body": "@old_timer: Compilers do cache. \u201cCache\u201d is not just a name for certain memory; it is a common English word meaning to store for future use. Compilers cache when they hold a value in a register for repeated use instead of reloading it from memory each time source code refers to it. That is the sense in which the OP used the word."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1552476079, "post_id": 55135478, "comment_id": 97021382, "body": "There is no point in reasoning about unoptimised code.  Always turn on optimisations before questioning what code the compiler generated."}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 5, "last_activity_date": 1552464727, "last_edit_date": 1552464727, "creation_date": 1552458024, "answer_id": 55135590, "question_id": 55135478, "link": "https://stackoverflow.com/questions/55135478/comprehending-how-volatile-keyword-and-comparison-work/55135590#55135590", "title": "comprehending how &quot;volatile&quot; keyword and comparison work", "body": "<p>It looks like you forgot to enable optimization.  <code>-O0</code> treats <em>all</em> variables (except <code>register</code> variables) <a href=\"https://stackoverflow.com/questions/53366394/why-does-clang-produce-inefficient-asm-for-this-simple-floating-point-sum-with\">pretty similarly to <code>volatile</code> for consistent debugging</a>.</p>\n\n<p>With optimization enabled, compilers can hoist non-volatile loads out of loops. <code>while(locked);</code> will compile similarly to source like</p>\n\n<pre><code>if (locked) {\n    while(1){}\n}\n</code></pre>\n\n<p>Or since <code>locked</code> has a compile-time-constant initializer, the whole function should compile to <code>jmp main</code> (an infinite loop).</p>\n\n<p><strong>See <a href=\"https://electronics.stackexchange.com/questions/387181/mcu-programming-c-o2-optimization-breaks-while-loop/387478#387478\">MCU programming - C++ O2 optimization breaks while loop</a></strong> for more details.</p>\n\n<hr>\n\n<blockquote>\n  <p>Why is <code>DWORD PTR [RSP - 8]</code> copied into EAX and again why is the comparison done between 0 and EAX?</p>\n</blockquote>\n\n<p>Some compilers are worse at folding loads into memory operands for other instructions when you use <code>volatile</code>.  I think that's why you're getting a separate <code>mov</code> load here; it's just a missed optimization.</p>\n\n<p>(Although <code>cmp [mem], imm</code> might be <em>less</em> efficient.  I forget if it can macro-fuse with a JCC or something.  With a RIP-relative addressing mode it couldn't micro-fuse the load, but a register base is ok.)</p>\n\n<hr>\n\n<p><code>cmp  EAX, 0</code> is weird, I guess clang with optimization disabled doesn't look for <code>test eax,eax</code> as a peephole optimization for comparing against zero.</p>\n\n<p><strong>As @user3386109 commented, <code>locked</code> in a boolean context is equivalent to <code>locked != 0</code> in C / C++.</strong></p>\n"}, {"comments": [{"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1552496851, "post_id": 55136362, "comment_id": 97035564, "body": "The last paragraph is wrong. x86 does have an instruction to compare immediate to memory. The reason the assembler gave an error is that an immediate needs a $ prefix."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 2, "last_activity_date": 1552462259, "last_edit_date": 1552462259, "creation_date": 1552461495, "answer_id": 55136362, "question_id": 55135478, "link": "https://stackoverflow.com/questions/55135478/comprehending-how-volatile-keyword-and-comparison-work/55136362#55136362", "title": "comprehending how &quot;volatile&quot; keyword and comparison work", "body": "<p>The compiler doesnt know about caching, it is not a caching thing, it tells the compiler that the value may change between accesses.  So to functionally implement our code it needs to perform the accesses we ask for in the order we ask them.  Cant optimize out.  </p>\n\n<pre><code>void fun1 ( void )\n{\n    /* volatile */ int lock = 999;\n    while (lock) continue;\n}\nvoid fun2 ( void )\n{\n    volatile int lock = 999;\n    while (lock) continue;\n}\nvolatile int vlock;\nint ulock;\nvoid fun3 ( void )\n{\n    while(vlock) continue;\n}\nvoid fun4 ( void )\n{\n    while(ulock) continue;\n}\nvoid fun5 ( void )\n{\n    vlock=3;\n    vlock=4;\n}\nvoid fun6 ( void )\n{\n    ulock=3;\n    ulock=4;\n}\n</code></pre>\n\n<p>I find it easier to see in arm...doesnt really matter.</p>\n\n<pre><code>Disassembly of section .text:\n\n00001000 &lt;fun1&gt;:\n    1000:   eafffffe    b   1000 &lt;fun1&gt;\n\n00001004 &lt;fun2&gt;:\n    1004:   e59f3018    ldr r3, [pc, #24]   ; 1024 &lt;fun2+0x20&gt;\n    1008:   e24dd008    sub sp, sp, #8\n    100c:   e58d3004    str r3, [sp, #4]\n    1010:   e59d3004    ldr r3, [sp, #4]\n    1014:   e3530000    cmp r3, #0\n    1018:   1afffffc    bne 1010 &lt;fun2+0xc&gt;\n    101c:   e28dd008    add sp, sp, #8\n    1020:   e12fff1e    bx  lr\n    1024:   000003e7    andeq   r0, r0, r7, ror #7\n\n00001028 &lt;fun3&gt;:\n    1028:   e59f200c    ldr r2, [pc, #12]   ; 103c &lt;fun3+0x14&gt;\n    102c:   e5923000    ldr r3, [r2]\n    1030:   e3530000    cmp r3, #0\n    1034:   012fff1e    bxeq    lr\n    1038:   eafffffb    b   102c &lt;fun3+0x4&gt;\n    103c:   00002000    \n\n00001040 &lt;fun4&gt;:\n    1040:   e59f3014    ldr r3, [pc, #20]   ; 105c &lt;fun4+0x1c&gt;\n    1044:   e5933000    ldr r3, [r3]\n    1048:   e3530000    cmp r3, #0\n    104c:   012fff1e    bxeq    lr\n    1050:   e3530000    cmp r3, #0\n    1054:   012fff1e    bxeq    lr\n    1058:   eafffffa    b   1048 &lt;fun4+0x8&gt;\n    105c:   00002004    \n\n00001060 &lt;fun5&gt;:\n    1060:   e3a01003    mov r1, #3\n    1064:   e3a02004    mov r2, #4\n    1068:   e59f3008    ldr r3, [pc, #8]    ; 1078 &lt;fun5+0x18&gt;\n    106c:   e5831000    str r1, [r3]\n    1070:   e5832000    str r2, [r3]\n    1074:   e12fff1e    bx  lr\n    1078:   00002000    \n\n0000107c &lt;fun6&gt;:\n    107c:   e3a02004    mov r2, #4\n    1080:   e59f3004    ldr r3, [pc, #4]    ; 108c &lt;fun6+0x10&gt;\n    1084:   e5832000    str r2, [r3]\n    1088:   e12fff1e    bx  lr\n    108c:   00002004    \n\nDisassembly of section .bss:\n\n00002000 &lt;vlock&gt;:\n    2000:   00000000    \n\n00002004 &lt;ulock&gt;:\n    2004:   00000000    \n</code></pre>\n\n<p>First one is the most telling.</p>\n\n<pre><code>00001000 &lt;fun1&gt;:\n    1000:   eafffffe    b   1000 &lt;fun1&gt;\n</code></pre>\n\n<p>Being a local variable that is initialized, and non volatile then the compiler can assume it wont change value between accesses so it can never change in the while loop, so this is essentially a while 1 loop.  If the initial value had been zero this would be a simple return as it can never be non-zero, being non-volatile.</p>\n\n<p>fun2 being a local variable a stack frame needs to be built then </p>\n\n<p>It does what one assumes the code was trying to do, wait for this shared variable, one that can change during the loop</p>\n\n<pre><code>    1010:   e59d3004    ldr r3, [sp, #4]\n    1014:   e3530000    cmp r3, #0\n    1018:   1afffffc    bne 1010 &lt;fun2+0xc&gt;\n</code></pre>\n\n<p>so it samples it and tests what it samples each time through the loop.</p>\n\n<p>fun3 and fun4 same deal but more realistic, as external to the function code isnt going to change lock, being non-global doesnt make much sense for your while loop.</p>\n\n<pre><code>102c:   e5923000    ldr r3, [r2]\n1030:   e3530000    cmp r3, #0\n1034:   012fff1e    bxeq    lr\n1038:   eafffffb    b   102c &lt;fun3+0x4&gt;\n</code></pre>\n\n<p>for the volatile fun3 case the variable has to be read and tested each loop</p>\n\n<pre><code>1044:   e5933000    ldr r3, [r3]\n1048:   e3530000    cmp r3, #0\n104c:   012fff1e    bxeq    lr\n1050:   e3530000    cmp r3, #0\n1054:   012fff1e    bxeq    lr\n1058:   eafffffa    b   1048 &lt;fun4+0x8&gt;\n</code></pre>\n\n<p>for the non-volatile being global it has to sample it once, very interesting what the compiler did here, have to think about why it would do that, but either way you can see that the \"loop\" retests the value read stored in a register (not cached) which will never change with a proper program.  Functionally we asked it to only read the variable once by using non-volatile then it tests that value indefinitely.</p>\n\n<p>fun5 and fun6 further demonstrate that volatile requires the compiler perform the accesses to the variable in its storage place before moving on to the next operation/access in the code.  So when volatile we are asking the compiler to perform two assignments, two stores.   When non-volatile the compiler can optimize out the first store and only do the last one as if you look at the code as a whole this function (fun6) leaves the variable set to 4, so the function leaves the variable set to 4.</p>\n\n<p>The x86 solution is equally interesting repz retq is all over it (with the compiler on my computer), not hard to find out what that is all about.</p>\n\n<p>Neither aarch64, x86, mips, riscv, msp430, pdp11 backends do the double check on fun3().  </p>\n\n<p>pdp11 is actually the easier code to read (no surprise there)</p>\n\n<pre><code>00000000 &lt;_fun1&gt;:\n   0:   01ff            br  0 &lt;_fun1&gt;\n\n00000002 &lt;_fun2&gt;:\n   2:   65c6 fffe       add $-2, sp\n   6:   15ce 03e7       mov $1747, (sp)\n   a:   1380            mov (sp), r0\n   c:   02fe            bne a &lt;_fun2+0x8&gt;\n   e:   65c6 0002       add $2, sp\n  12:   0087            rts pc\n\n00000014 &lt;_fun3&gt;:\n  14:   1dc0 0026       mov $3e &lt;_vlock&gt;, r0\n  18:   02fd            bne 14 &lt;_fun3&gt;\n  1a:   0087            rts pc\n\n0000001c &lt;_fun4&gt;:\n  1c:   1dc0 001c       mov $3c &lt;_ulock&gt;, r0\n  20:   0bc0            tst r0\n  22:   02fe            bne 20 &lt;_fun4+0x4&gt;\n  24:   0087            rts pc\n\n00000026 &lt;_fun5&gt;:\n  26:   15f7 0003 0012  mov $3, $3e &lt;_vlock&gt;\n  2c:   15f7 0004 000c  mov $4, $3e &lt;_vlock&gt;\n  32:   0087            rts pc\n\n00000034 &lt;_fun6&gt;:\n  34:   15f7 0004 0002  mov $4, $3c &lt;_ulock&gt;\n  3a:   0087            rts pc\n</code></pre>\n\n<p>(this is the not linked version)</p>\n\n<hr>\n\n<p>cmp     DWORD PTR [RSP - 8], 0 . &lt;--- Why is the comparison done with 0 whilst DWORD PTR [RSP - 8] holds 999 within ?</p>\n\n<p>while does a true false comparison meaning is it equal to zero or not equal to zero</p>\n\n<p>Why is DWORD PTR [RSP - 8] copied into EAX and again why is the comparison done between  0 and EAX?</p>\n\n<pre><code>mov -0x8(%rsp),%eax\ncmp 0,%eax\ncmp 0,-0x8(%rsp)\n\nas so.s -o so.o\nso.s: Assembler messages:\nso.s:3: Error: too many memory references for `cmp'\n</code></pre>\n\n<p>compare wants a register. So it reads into a register so it can do the compare as it cant do the compare between the immediate and the memory access in one instruction.  If they could have done it in one instruction they would have.</p>\n"}], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552464727, "creation_date": 1552457448, "question_id": 55135478, "link": "https://stackoverflow.com/questions/55135478/comprehending-how-volatile-keyword-and-comparison-work", "title": "comprehending how &quot;volatile&quot; keyword and comparison work", "body": "<p>If a variable is not specified with the keyword <code>volatile</code>, the compiler likely does caching. The variable <em>must</em> be accessed from memory always otherwise until its transaction unit ends. The point I wonder lies in assembly part. </p>\n\n<pre><code>int main() {\n    /* volatile */ int lock = 999;\n    while (lock);\n}\n</code></pre>\n\n<p>On <a href=\"https://godbolt.org/z/A00ebu\" rel=\"nofollow noreferrer\">x86-64-clang-3.0.0 compiler</a>, its assembly code is following.</p>\n\n<pre><code>main:                                   # @main\n        mov     DWORD PTR [RSP - 4], 0\n        mov     DWORD PTR [RSP - 8], 999\n\n\n.LBB0_1:                                # =&gt;This Inner Loop Header: Depth=1\n        cmp     DWORD PTR [RSP - 8], 0\n        je      .LBB0_3\n        jmp     .LBB0_1\n\n\n.LBB0_3:\n        mov     EAX, DWORD PTR [RSP - 4]\n        ret\n</code></pre>\n\n<p>When <code>volatile</code> keyword is commented in, it turns out the following.</p>\n\n<pre><code>main:                                   # @main\n        mov     DWORD PTR [RSP - 4], 0\n        mov     DWORD PTR [RSP - 8], 999\n\n\n.LBB0_1:                                # =&gt;This Inner Loop Header: Depth=1\n        mov     EAX, DWORD PTR [RSP - 8]\n        cmp     EAX, 0\n        je      .LBB0_3\n        jmp     .LBB0_1\n\n\n.LBB0_3:\n        mov     EAX, DWORD PTR [RSP - 4]\n        ret\n</code></pre>\n\n<p>The points I wonder and don't understand,</p>\n\n<ul>\n<li><code>cmp     DWORD PTR [RSP - 8], 0</code> . &lt;---\nWhy is the comparison done with <code>0</code> whilst <code>DWORD PTR [RSP - 8]</code> holds <code>999</code> within ?</li>\n<li>Why is <code>DWORD PTR [RSP - 8]</code> copied into <code>EAX</code> and again why is the comparison done between <code>0</code> and <code>EAX</code>?</li>\n</ul>\n"}, {"tags": ["c", "gcc", "x11"], "answers": [{"tags": [], "owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "is_accepted": false, "score": 2, "last_activity_date": 1552457724, "creation_date": 1552457724, "answer_id": 55135530, "question_id": 55135400, "link": "https://stackoverflow.com/questions/55135400/issue-compiling-file-with-x11/55135530#55135530", "title": "Issue compiling file with X11", "body": "<p>This command works for me:</p>\n\n<pre><code>gcc fbserver.c -lX11 -lXext -lXdamage -lXfixes -lXtst\n</code></pre>\n\n<p><code>XDamageCreate</code> requires <code>-lXdamage</code>, and <code>XFixesQueryExtension</code> requires <code>-lXfixes</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 4200697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a2df7d82db34a0399eb7c5cbb861ea?s=128&d=identicon&r=PG&f=1", "display_name": "mg1729", "link": "https://stackoverflow.com/users/4200697/mg1729"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552457724, "creation_date": 1552457039, "last_edit_date": 1552457708, "question_id": 55135400, "link": "https://stackoverflow.com/questions/55135400/issue-compiling-file-with-x11", "title": "Issue compiling file with X11", "body": "<p>I've tried to compile this X11 server file:</p>\n\n<p><a href=\"https://github.com/dnschneid/crouton/blob/master/src/fbserver.c\" rel=\"nofollow noreferrer\">https://github.com/dnschneid/crouton/blob/master/src/fbserver.c</a></p>\n\n<p>I executed 'gcc fbserver.o -lXtst -lX11', which results in the following errors:</p>\n\n<blockquote>\n  <p>/usr/bin/ld: fbserver.o: undefined reference to symbol 'XShmGetImage'\n  //usr/lib/x86_64-linux-gnu/libXext.so.6: error adding symbols: DSO\n  missing from command line collect2: error: ld returned 1 exit status</p>\n</blockquote>\n\n<p>However if I include -<code>lXext - 'gcc fbserver.o -lXext -lXtst -lX11'</code>, it doesn't compile:</p>\n\n<pre><code>fbserver.o: In function `register_damage':\nfbserver.c:(.text+0x260e): undefined reference to `XDamageCreate'\nfbserver.o: In function `init_display':\nfbserver.c:(.text+0x26d9): undefined reference to `XDamageQueryExtension'\nfbserver.c:(.text+0x2713): undefined reference to `XFixesQueryExtension'\nfbserver.c:(.text+0x2824): undefined reference to `XFixesSelectCursorInput'\nfbserver.o: In function `write_cursor':\nfbserver.c:(.text+0x3b68): undefined reference to `XFixesGetCursorImage'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>Thank you for your time</p>\n"}, {"tags": ["c++", "c", "string"], "comments": [{"owner": {"reputation": 893, "user_id": 6361694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b808f24204076dfdb2fc9afa27a8b8?s=128&d=identicon&r=PG&f=1", "display_name": "Petok Lorand", "link": "https://stackoverflow.com/users/6361694/petok-lorand"}, "edited": false, "score": 1, "creation_date": 1552456368, "post_id": 55135224, "comment_id": 97011018, "body": "<code>std::string</code> is just a wrapper around <code>char*</code>(this is of course simplified), that does automatic allocation and deallocation. You can use <code>char*</code> and do the memory management manually."}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 1, "creation_date": 1552456529, "post_id": 55135224, "comment_id": 97011071, "body": "If you use nothing but string literals like &quot;JR&quot;, you may be able to get away with a <code>const char *</code>. Have to see how you use the strings to be sure. Make sure before you go too much further that porting the C++ to C makes sense. There are a quite a few ideological differences between C and C++ that can make a direct port more work than it&#39;s worth or a pathetically inefficient C program."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 893, "user_id": 6361694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b808f24204076dfdb2fc9afa27a8b8?s=128&d=identicon&r=PG&f=1", "display_name": "Petok Lorand", "link": "https://stackoverflow.com/users/6361694/petok-lorand"}, "edited": false, "score": 0, "creation_date": 1552456647, "post_id": 55135224, "comment_id": 97011125, "body": "Wile @Lorand is right, the part (this is of course simplified) is very important. You first have to learn about pointers and memory allocation. That is a tough topic. It cannot be explained here. Lorand, with this warning added, your comment qualifies as an answer. &quot;How exactly?&quot; would be too broad and/or asking for a tutorial, i.e. off-topic."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1552456734, "post_id": 55135224, "comment_id": 97011167, "body": "@user4581301 Seconded. I even go as far a adding it again. This is not a case of an applicable &quot;two different languages&quot; criticism (though I otherwise often agree with them)."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 1, "creation_date": 1552458132, "post_id": 55135224, "comment_id": 97011687, "body": "I wonder why nobody has yet suggested the use of <code>enum</code>, which even in C++ would be a much better choice."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552461190, "post_id": 55135224, "comment_id": 97012941, "body": "@Leotix, you get this warning because <code>&#39;2&#39;</code> is a single character and an integer literal that does not have a storage location, while <code>&quot;3&quot;</code> is a string literal which can be assigned to a <code>char *</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552476262, "post_id": 55135224, "comment_id": 97021498, "body": "These topics will be explained in <i>any</i> C text book. Get yourself one and you&#39;ll be able to ask for more specific questions."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1552476370, "post_id": 55135224, "comment_id": 97021562, "body": "Completely different thing is that for a <i>deck of cards</i> you do not need <i>anything like the <code>string</code> type of C++!</i>"}], "answers": [{"comments": [{"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 2, "creation_date": 1552456738, "post_id": 55135316, "comment_id": 97011170, "body": "There may be no need to allocate storage at all. If the strings are unchanging, just have <code>const</code> pointers point to the literals."}, {"owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "reply_to_user": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "edited": false, "score": 0, "creation_date": 1552456812, "post_id": 55135316, "comment_id": 97011200, "body": "Yes. Thank You for pointing it out. There might be such case."}], "tags": [], "owner": {"reputation": 941, "user_id": 9354476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc42e9e097bc5a2fb492c1a5254d49c5?s=128&d=identicon&r=PG&f=1", "display_name": "Syed.Waris", "link": "https://stackoverflow.com/users/9354476/syed-waris"}, "is_accepted": false, "score": 1, "last_activity_date": 1552456634, "creation_date": 1552456634, "answer_id": 55135316, "question_id": 55135224, "link": "https://stackoverflow.com/questions/55135224/what-can-i-use-in-c-instead-of-string-from-c/55135316#55135316", "title": "What can I use in C instead of &quot;string&quot; from C++", "body": "<p><code>string</code> is actually a class in C++ and as others have pointed out, it is a wrapper around char array/pointer (which can be used to store a sequence of <code>chars</code>).</p>\n\n<p>In C you will have to manually use character array. You can do in 2 ways (primarily):</p>\n\n<ol>\n<li>Create a static character array (with sufficient size).</li>\n<li>Create a character array dynamically using <code>malloc</code>. But in this you will have to also free it manually, when the array is no longer needed.</li>\n</ol>\n\n<p>And of course since you are using C, you will have to explicitly/ manually, take care of array overflow conditions, overlapping, null termination etc.</p>\n"}], "owner": {"reputation": 11, "user_id": 11195020, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-p8_nnuHxpfE/AAAAAAAAAAI/AAAAAAAAAOg/fU8GreAIEo0/photo.jpg?sz=128", "display_name": "Leotix", "link": "https://stackoverflow.com/users/11195020/leotix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552456747, "creation_date": 1552456239, "last_edit_date": 1552456747, "question_id": 55135224, "link": "https://stackoverflow.com/questions/55135224/what-can-i-use-in-c-instead-of-string-from-c", "title": "What can I use in C instead of &quot;string&quot; from C++", "body": "<p>I've started doing a card game in C but I couldn't find anything instead of <code>string</code> which obviously is not used in C. Here's some code where this becomes an obstacle:</p>\n\n<pre><code>struct cards {\n    string index;\n    string colour;\n};\n\nvoid load_cards(cards deck[MAX_C])\n{\n    int i = 0;\n    for (int j = 0; j &lt; 4; j++) {\n        deck[i].index = '2';\n        deck[i += 1].index = \"3\";\n        deck[i += 1].index = \"4\";\n        deck[i += 1].index = \"5\";\n        deck[i += 1].index = \"6\";\n        deck[i += 1].index = \"7\";\n        deck[i += 1].index = \"8\";\n        deck[i += 1].index = \"9\";\n        deck[i += 1].index = \"10\";\n        deck[i += 1].index = \"W\";\n        deck[i += 1].index = \"D\";\n        deck[i += 1].index = \"K\";\n        deck[i += 1].index = \"A\";\n    }\n    for (int j = 0; j &lt; 13; j++) {\n        deck[j].colour = \"T\";\n    }\n    for (int j = 13; j &lt; 26; j++) {\n        deck[j].colour = \"k\";\n    }\n    for (int j = 26; j &lt; 39; j++) {\n        deck[j].colour = \"K\";\n    }\n    for (int j = 39; j &lt; 52; j++) {\n        deck[j].colour = \"P\";\n    }\n    for (int j = 52; j &lt; 56; j++) {\n        deck[j].colour = \"JR\";\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "windows", "ipc", "handle"], "comments": [{"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1552460416, "post_id": 55135119, "comment_id": 97012581, "body": "For kernel objects, it&#39;s straight forward for the <code>NtDuplicateObject</code> system call in the Object Manager to attach to the source and target processes to access and modify their kernel handle tables. Neither process is necessarily the calling process. The caller just needs <code>PROCESS_DUP_HANDLE</code> access on its handle for each process. Some additional IPC is required to communicate the new handle value to the target process."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 11176416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ic5VK.jpg?s=128&g=1", "display_name": "iamoumuamua", "link": "https://stackoverflow.com/users/11176416/iamoumuamua"}, "edited": false, "score": 0, "creation_date": 1552461093, "post_id": 55135914, "comment_id": 97012897, "body": "Ok, but a guy cutting me a duplicate key would not need to know my friend&#39;s address. I would find it very suspicious and strange if he asked me for it. I would want to know why he wanted that information. Is this just like yet another security step? To continue the analogy is it like the guy making the key with a fingerprint reader so that it won&#39;t open the door unless my friend is using it? If so it seems like a ridiculous level of paranoia to me."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "reply_to_user": {"reputation": 111, "user_id": 11176416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ic5VK.jpg?s=128&g=1", "display_name": "iamoumuamua", "link": "https://stackoverflow.com/users/11176416/iamoumuamua"}, "edited": false, "score": 0, "creation_date": 1552461443, "post_id": 55135914, "comment_id": 97013059, "body": "Yes, the key comes with a fingerprint reader so that only your the right person can use it. This is not so much a security measure but has practical reasons. Every process has a list of resources that are owned (or co-owned) by it but handled by the OS. A handle is often just an index into that process&#39; list. The same index specifies a different resource for a different process, hence the need to know the process for which to duplicate the handle. This is just regular process separation in a multitasking environment."}], "tags": [], "owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "is_accepted": false, "score": 2, "last_activity_date": 1552459613, "creation_date": 1552459613, "answer_id": 55135914, "question_id": 55135119, "link": "https://stackoverflow.com/questions/55135119/does-duplicatehandle-do-any-interprocess-communication-ipc-and-if-not-why-ta/55135914#55135914", "title": "Does DuplicateHandle() do any interprocess communication (IPC) and if not why target params?", "body": "<p>The third parameter <code>hTargetProcessHandle</code> is documented as</p>\n\n<pre><code>A handle to the process that is to receive the duplicated handle.\n</code></pre>\n\n<p>That means that the handle (which is just a numeric value underneath) will become usable within the target process. However, how you get this handle into the target process and in what context it is to be used there is out of the scope of that function. Also note that \"is to receive\" points in the future and it refers to the result of the call, so it must be after the call has finished.</p>\n\n<p>As an analogy, you want to allow a friend in your house. For that, you are creating a second key to your door. Just that doesn't mean that your friend can now unlock your door, because you first have to give it to them, but it's a first step.</p>\n"}], "owner": {"reputation": 111, "user_id": 11176416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ic5VK.jpg?s=128&g=1", "display_name": "iamoumuamua", "link": "https://stackoverflow.com/users/11176416/iamoumuamua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552459613, "creation_date": 1552455725, "question_id": 55135119, "link": "https://stackoverflow.com/questions/55135119/does-duplicatehandle-do-any-interprocess-communication-ipc-and-if-not-why-ta", "title": "Does DuplicateHandle() do any interprocess communication (IPC) and if not why target params?", "body": "<p>I am finding <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/handleapi/nf-handleapi-duplicatehandle\" rel=\"nofollow noreferrer\">DuplicateHandle()</a> very confusing. The third and fourth params, hTargetProcessHandle and lpTargetHandle seem to imply that this API function does some form of interprocess communication, but what I have been reading online seems to imply (without saying directly) that in fact this function cannot communicate with anything outside of the address space of its own process and that if you really do want to say copy the local process handle to another process you have to do that yourself manually.</p>\n\n<p>So can someone please please take pity on me and tell me definitively whether or not this function does any IPC itself? Also if it doesn't do any IPC then what is the point of those two parameters? How can there be a 'target' if no data is sent and the output of this function is not visible to other processes?</p>\n\n<p>At first I thought I could call GetCurrentProcess() and then use DuplicateHandle() to copy the local process handle to another process, but then I started to realize that it probably isn't that easy.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1552455860, "post_id": 55135096, "comment_id": 97010874, "body": "Please post <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> without a lot of <code>printf</code>. You have two calls of <code>scanf</code>. Which one of two does not work?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552456000, "post_id": 55135096, "comment_id": 97010914, "body": "The function <code>scanf</code> returns a value. Why do you ignore it? You should always check the return value to know if it matches your expectation.."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1552458221, "post_id": 55135096, "comment_id": 97011728, "body": "If you want to print an address, use the <code>%p</code> format and convert the pointer to a <code>void</code> pointer with a cast: <code>printf(&quot;Address of c is %p\\n&quot;, (void *)&amp;c);</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552476639, "post_id": 55135096, "comment_id": 97021722, "body": "What compiler are you using that did not warn about <code>printf(&quot;You Have Entered %i Classes!\\n&quot;, &amp;c);</code>?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552477236, "post_id": 55135096, "comment_id": 97022079, "body": "&quot;regardless of what you enter&quot; - so what <i>did</i> you enter?"}], "answers": [{"tags": [], "owner": {"reputation": 382, "user_id": 9951130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NrN7I.jpg?s=128&g=1", "display_name": "Parth Sarthi Sharma", "link": "https://stackoverflow.com/users/9951130/parth-sarthi-sharma"}, "is_accepted": true, "score": 1, "last_activity_date": 1552456232, "last_edit_date": 1552456232, "creation_date": 1552455795, "answer_id": 55135135, "question_id": 55135096, "link": "https://stackoverflow.com/questions/55135096/c-programming-scanf-assistance/55135135#55135135", "title": "C programming scanf assistance", "body": "<p>When you use <code>%i</code> with <code>scanf()</code>, it can allow you to input hexadecimal and octal numbers as well (this isn't an issue as explained <a href=\"https://stackoverflow.com/a/1893518/9951130\">here</a>).\nHowever, you shouldn't use <code>&amp;</code> while using <code>printf()</code> as it'll display the memory location of the variable instead of the value stored in it.</p>\n\n<p>Try this:</p>\n\n<pre><code>case 1 :\n         printf(\"********************************************************\\n\");\n         printf(\"** Enter Your Marks For Your Courses (Up to 10 Only): **\\n\");\n         printf(\"********************************************************\\n\");\n\n         scanf(\"%d\", &amp;c);\n         printf(\"You Have Entered %d Classes!\\n\", c);\n         break;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1552456204, "creation_date": 1552456204, "answer_id": 55135215, "question_id": 55135096, "link": "https://stackoverflow.com/questions/55135096/c-programming-scanf-assistance/55135215#55135215", "title": "C programming scanf assistance", "body": "<p><code>printf(\"You Have Entered %i Classes!\\n\", &amp;c)</code> outputs the address of the variable <code>c</code> (&amp;c takes the address), i.e. it outputs the number of the memory cell. Since you want to pass the value of the variable you should not use the operator of taking address of a variable <code>&amp;</code>.</p>\n\n<pre><code>printf(\"You Have Entered %i Classes!\\n\", c);\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11195049"}, "is_accepted": false, "score": 1, "last_activity_date": 1552458082, "last_edit_date": 1552458082, "creation_date": 1552456502, "answer_id": 55135290, "question_id": 55135096, "link": "https://stackoverflow.com/questions/55135096/c-programming-scanf-assistance/55135290#55135290", "title": "C programming scanf assistance", "body": "<p>There are two problems here.  First, you need to include the following headers:</p>\n\n<pre><code>#include &lt;stdio.h&gt;    // declares functions like printf and scanf\n#include &lt;stdlib.h&gt;   // declares functions like exit\n</code></pre>\n\n<p>If you don't include these headers, then the compiler does not know how to execute them or their exact formats.  When you attempt to compile, the warnings will not be helpful.  There are a few good websites for this; just search something like \"c exit()\" in Google and it will tell you which headers you need in the future.  When I compiled this code, I used <code>gcc main.c -Wall</code> which forces all warnings to be displayed.</p>\n\n<p>Secondly, you use the address of <code>c</code> in both cases.  When you go to print the value of <code>c</code>, you are actually printing the address of <code>c</code>, not the value.  <code>scanf()</code> takes the address(es) of the variables to store values in, but <code>printf()</code> takes the variables themselves.  The code should look more like this:</p>\n\n<pre><code>scanf(\"%i\", &amp;c);\nprintf(\"You Have Entered %i Classes!\\n\", c);\n</code></pre>\n\n<p>It is also always a good idea to initialize your variables.  This way, you know when something is assigned improperly, or not assigned at all.  I forgot to assign my variables for a while, and when compiled on another machine, it didn't work.  This is because different machines will initialize variables differently.  Just change the code to the following:</p>\n\n<pre><code>int opt = 0;\nint c = 0;\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11195042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee0b7cb28d54fec801f5dd25bb19357a?s=128&d=identicon&r=PG&f=1", "display_name": "E Yansen", "link": "https://stackoverflow.com/users/11195042/e-yansen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 55135135, "answer_count": 3, "score": -1, "last_activity_date": 1552458082, "creation_date": 1552455579, "question_id": 55135096, "link": "https://stackoverflow.com/questions/55135096/c-programming-scanf-assistance", "title": "C programming scanf assistance", "body": "<p>I am attempting to build a form/gpa calculator for class, but when entering the amount of classes using scanf, the output is 6,487,576 regardless of what I enter. </p>\n\n<pre><code>int main()\n{\n    int opt;\n    int c;\n\n\n\n\n    printf(\"*******************************\\n\");\n    printf(\"** Fanshawe Grade Calculator **\\n\");\n    printf(\"*******************************\\n\");\n\n    printf(\"Please Choose an Option:\\n\");\n    printf(\"[1] Enter Your Marks\\n\");\n    printf(\"[2] Quit\\n\");\n\n    scanf(\"%d\", &amp;opt);\n\n    switch(opt) {\n      case 1 :\n         printf(\"********************************************************\\n\");\n         printf(\"** Enter Your Marks For Your Courses (Up to 10 Only): **\\n\");\n         printf(\"********************************************************\\n\");\n\n         scanf(\"%i\", &amp;c);\n         printf(\"You Have Entered %i Classes!\\n\", &amp;c);\n\n         /*int i;\n         for(i=1;i=c;i++) {\n            printf(\"Enter Your Mark for Class #%i\\n\", &amp;i);\n         }*/\n\n         break;\n\n      case 2 :\n         printf(\"GoodBye!\");\n         exit(0);\n         break;\n   }\n    return 0;\n}\n</code></pre>\n\n<p>Help please!</p>\n"}, {"tags": ["c", "memory", "memory-alignment"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552455648, "post_id": 55134945, "comment_id": 97010798, "body": "&quot;Why can&#39;t (Can it?) read the 4 bytes(a word, assume 32bits) directly that contains b?&quot; The answer you have quoted already right above. The key is &quot;on word <b>boundaries</b>&quot;. That is not the same as &quot;in word size&quot;. I.e. those CPUs can only read word size only from exactly <code>N*wordsize</code>, not from <code>N*wordsize+2</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1552455817, "post_id": 55134945, "comment_id": 97010855, "body": "Because the hardware only allows doing a 4-byte read from addresses which are multiples of 4"}, {"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552455929, "post_id": 55134945, "comment_id": 97010892, "body": "@Yunnosch What does that mean..? &quot;on word boundaries&quot;.. Does it mean that e.g. a 32bit CPU can only reads from address 0, 4, 8, 16 and so on? address 0-3 (1 word), address 4-7(1 word)."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1552456005, "post_id": 55134945, "comment_id": 97010916, "body": "@Rick It means exactly that."}, {"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "edited": false, "score": 0, "creation_date": 1552456041, "post_id": 55134945, "comment_id": 97010925, "body": "Ok. Thank you guys... GOT IT."}, {"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1552456227, "post_id": 55134945, "comment_id": 97010976, "body": "@Broman Much thanks for your confirmation, which really relieve my doubt."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552476719, "post_id": 55134945, "comment_id": 97021760, "body": "In practice <i>all</i> the CPUs now in existence work with word boundaries. They just do these fetches internally. Also, you shouldn&#39;t confuse the architecture requirements with the requirements of the C compiler. A C compiler can require that your <code>int *</code> must point to an aligned memory address no matter what you&#39;d think you can infer from the processor data sheets."}], "answers": [{"comments": [{"owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "edited": false, "score": 0, "creation_date": 1552456572, "post_id": 55135162, "comment_id": 97011092, "body": "Thank you @Yunnosch for helping me clarify that ~~ \ud83e\udd70 . It was such a pain after I read all related posts but still didn&#39;t get it right. Feels good now~ ;)"}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 1, "last_activity_date": 1552456384, "last_edit_date": 1552456384, "creation_date": 1552455943, "answer_id": 55135162, "question_id": 55134945, "link": "https://stackoverflow.com/questions/55134945/confusion-about-a-memory-alignment-example/55135162#55135162", "title": "Confusion about a memory alignment example", "body": "<p>\"Why can't (Can it?) read the 4 bytes(a word, assume 32bits) directly that contains b?\"<br>\nThe answer you have quoted already right above. The key is \"on word <strong>boundaries</strong>\". That is not the same as \"in word size\". I.e. those CPUs can read word width only from exactly <code>N*wordwidth</code>, not from <code>N*wordwidth+2</code>.</p>\n\n<p>A wordboundary (only applicable on the mentioned platforms) is a clean multiple of the wordwidth. 0, 4, 8, 12... But not 2, 6, 10...</p>\n\n<p>Picking up your phrasing from comment, yes.<br>\nThose CPUs can only read from address 0, 4, 8, 12, 16 and so on.<br>\nE.g. one word from addresses  0-3, one word from address 4-7.\n(Note the added 12.)</p>\n"}], "owner": {"reputation": 4425, "user_id": 5983841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/GHJxG.jpg?s=128&g=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/5983841/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55135162, "answer_count": 1, "score": 1, "last_activity_date": 1552456384, "creation_date": 1552454715, "last_edit_date": 1552455415, "question_id": 55134945, "link": "https://stackoverflow.com/questions/55134945/confusion-about-a-memory-alignment-example", "title": "Confusion about a memory alignment example", "body": "<p>When reading some posts for memory alignment knowlodge, I have a question about a good answer from <a href=\"https://stackoverflow.com/questions/3994035/what-is-aligned-memory-allocation\">What is aligned memory allocation?</a>, @dan04. </p>\n\n<p>Reading the example he gives, </p>\n\n<pre><code> 0 1 2 3 4 5 6 7\n|a|a|b|b|b|b|c|d|  bytes\n|       |       |  words\n</code></pre>\n\n<blockquote>\n  <p>The problem is that on some CPU architectures, the instruction to load a 4-byte integer from memory only works on word boundaries. So your program would have to fetch each half of <code>b</code> with separate instructions.</p>\n</blockquote>\n\n<p>Why can't (Can it?) read the 4 bytes(a word, assume 32bits) directly that contains <code>b</code>?</p>\n\n<p>For example, if I want <code>b</code></p>\n\n<pre><code> 0 1 2 3 4 5 6 7\n|a|a|b|b|b|b|c|d|  bytes\n    |       |      a word(assume it's 32 bit, get b directly)\n</code></pre>\n\n<p>read 1 word starts from <code>address 2</code>.</p>\n\n<p>if I want <code>a</code></p>\n\n<pre><code> 0 1 2 3 4 5 6 7\n|a|a|b|b|b|b|c|d|  bytes\n|       |          a word\n</code></pre>\n\n<p>read 1 word starts from <code>address 0</code> and get the first 2 bytes and discard the latter 2 bytes.</p>\n\n<p>if I want <code>c</code> and <code>d</code></p>\n\n<pre><code> 0 1 2 3 4 5 6 7\n|a|a|b|b|b|b|c|d|  bytes\n        |       |  a word\n</code></pre>\n\n<p>read 1 word starts from <code>address 4</code> and get the last 2 bytes and discard the first 2 bytes.</p>\n\n<p>Then it seems alignment is not needed which is definitely incorrect..</p>\n\n<hr>\n\n<p>I must have misunderstood something or lack some other knowledge, please help correct me.. </p>\n"}, {"tags": ["c", "recursion", "printf"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 4, "creation_date": 1552453859, "post_id": 55134730, "comment_id": 97010301, "body": "Missed the last &quot;\\0&quot; of all strings, didn&#39;t you?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1552454066, "post_id": 55134730, "comment_id": 97010357, "body": "Please explain the &quot;rule&quot; behind your code. Give examples of input and expected output. Use more appropriate formatting for showing the expected output. I am unclear which part of the non-digit and non-&quot;m&quot;s are actually part of the output. <a href=\"https://stackoverflow.com/editing-help\">stackoverflow.com/editing-help</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1552454296, "post_id": 55134730, "comment_id": 97010421, "body": "On a more general level, this might be very helpful (though perceivable as a bit cynical in parts...) <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1552455398, "post_id": 55134730, "comment_id": 97010722, "body": "The length you calculate excludes the terminating null byte.  So <code>&quot;abc&quot;</code> would have length 3.  However, you forgot to add the extra null byte when allocating and when copying.  So it&#39;s not surprising that it fails."}, {"owner": {"reputation": 13, "user_id": 10302527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8ae45514cbbf67cf0dac9ea9cbf027?s=128&d=identicon&r=PG&f=1", "display_name": "Azuras_Tsar", "link": "https://stackoverflow.com/users/10302527/azuras-tsar"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1552463964, "post_id": 55134730, "comment_id": 97014161, "body": "@TomKarzes that was it, it works correctly now, thanks!"}, {"owner": {"reputation": 13, "user_id": 10302527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8ae45514cbbf67cf0dac9ea9cbf027?s=128&d=identicon&r=PG&f=1", "display_name": "Azuras_Tsar", "link": "https://stackoverflow.com/users/10302527/azuras-tsar"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552465721, "post_id": 55134730, "comment_id": 97015002, "body": "@Yunnosch thanks for your feedback, I&#39;ll try to format my code better in the future, Also appreciate the link!"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1552489773, "post_id": 55134730, "comment_id": 97030895, "body": "@TomKarzes Your comment is the more elaborate one. I intend to make an answer and will more or less use your input (because it basically is what I meant with my first comment, too). Let me know if you want to do the answer, in that case I will refrain. Should my answer be up when you notice this, still notify me. I am then open to have a race and delete mine if yours gets more upvotes."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552490294, "post_id": 55134730, "comment_id": 97031257, "body": "Why &quot;in the future&quot;. Try to <a href=\"https://stackoverflow.com/posts/55134730/edit\">edit</a> this question right away. You will anyway need some experience, better get it here before it burdens your next question. Maybe just to please me."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552510904, "post_id": 55134730, "comment_id": 97042601, "body": "@Yunnosch Thanks for checking - go ahead and post, I&#39;m a bit lazy these days..."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1552511023, "post_id": 55134730, "comment_id": 97042655, "body": "Might take until tomorrow, or until Azuras_Tsar <a href=\"https://stackoverflow.com/posts/55134730/edit\">edit</a>s to improve this question..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552526572, "post_id": 55134730, "comment_id": 97047424, "body": "OT: regarding: <code>char *comboword=malloc(sizeof(char)*length);</code>  1) the expression: <code>sizeof(char)</code> is defined in the c standard as 1.  Multiplying anything by 1 has absolutely no effect.  It also clutters the code, making it more difficult to understand, debug, etc.   Suggest removing that expression"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552526773, "post_id": 55134730, "comment_id": 97047469, "body": "is there some reason you cannot use the C library functions, like <code>strcat()</code> and <code>strlen()</code>  Note: to use those functions the code will need to have this statement: <code>#include &lt;string.h&gt;</code>"}], "owner": {"reputation": 13, "user_id": 10302527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8ae45514cbbf67cf0dac9ea9cbf027?s=128&d=identicon&r=PG&f=1", "display_name": "Azuras_Tsar", "link": "https://stackoverflow.com/users/10302527/azuras-tsar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552453397, "creation_date": 1552453397, "question_id": 55134730, "link": "https://stackoverflow.com/questions/55134730/printf-recursive-string-function-odd-behaviour", "title": "Printf Recursive String Function Odd Behaviour", "body": "<p>I have this recursive string function and a helper function for it which combines two strings(char pointers):   </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar* stringcat(char* s1, char* s2)\n{\n    int length=0;\n    int sizes[2];\n    int c=0;\n\n    while(s1[c]!='\\0')\n            ++c;\n    length=c;\n    sizes[0]=c;\n    c=0;\n    while(s2[c]!='\\0')\n            ++c;\n    length+=c;\n    sizes[1]=c;\n\n    char *comboword=malloc(sizeof(char)*length);\n\n    for(int i=0; i&lt;sizes[0]; i++)\n            comboword[i]=s1[i];\n\n    for(int j=sizes[0]; j&lt;length; j++)\n            comboword[j]=s2[j-sizes[0]];\n\nreturn comboword;\n\n}\n\nchar* mmfu(int mm)\n{\n            char* mmm=\"mm\";\n            if (mm&lt;=0)\n                    return mmm;\n            else\n                    return stringcat(mmm,mmfu(mm-1));\n}\n</code></pre>\n\n<p>I call it like this: </p>\n\n<pre><code>int main()\n{\n    int d;\n    scanf(\"%d\",&amp;d);\n\n    printf(\"%s %d\\n\",mmfu(1),d);\n}\n</code></pre>\n\n<p>For d of 1 and 0 the output is as expected, mmmm (d) and mm (d), but for anything over 1, the output is something like \u2592{\u2592 6mmm (with mmfu(3) and d=6) or \u2592{\u2592 5m for mmfu(2) and d=5. I can see theres some pattern to the odd output but I'm super confused on why its happening in the first place. Any help is appreciated. Thanks! </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 39, "user_id": 4254164, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/FBbzI.jpg?s=128&g=1", "display_name": "slim", "link": "https://stackoverflow.com/users/4254164/slim"}, "reply_to_user": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1552455349, "post_id": 55134547, "comment_id": 97010717, "body": "@Paul Rooney ,hey thanks i realize my missing parenthesis  and also the fact that I was returning on a void function i corrected that"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1552458585, "post_id": 55134547, "comment_id": 97011848, "body": "You should think about using arrays and/or functions to save writing out so much code repeatedly."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552477881, "post_id": 55134547, "comment_id": 97022490, "body": "What <i>exactly is the problem</i>?"}], "answers": [{"comments": [{"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1552452386, "post_id": 55134568, "comment_id": 97009883, "body": "Please use the &quot;add a comment&quot; link to add comments -- the &quot;Add Answer&quot; button should be used for answers to the question, only."}, {"owner": {"reputation": 39, "user_id": 4254164, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/FBbzI.jpg?s=128&g=1", "display_name": "slim", "link": "https://stackoverflow.com/users/4254164/slim"}, "edited": false, "score": 0, "creation_date": 1552452815, "post_id": 55134568, "comment_id": 97010027, "body": "main.c: In function \u2018main\u2019: main.c:8:5: warning: implicit declaration of function \u2018login_session\u2019 [-Wimplicit-function-declaration]      login_session();      ^ main.c: At top level: main.c:13:6: warning: conflicting types for \u2018login_session\u2019  void login_session(char username[10], char password[10]){       ^ main.c:8:5: note: previous implicit declaration of \u2018login_session\u2019 was here      login_session();      ^"}, {"owner": {"reputation": 142, "user_id": 9528129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TjZ9bved_PA/AAAAAAAAAAI/AAAAAAAAACo/TGFN1oC-PGU/photo.jpg?sz=128", "display_name": "Harshil Shah", "link": "https://stackoverflow.com/users/9528129/harshil-shah"}, "edited": false, "score": 0, "creation_date": 1552452903, "post_id": 55134568, "comment_id": 97010050, "body": "Yeah, there is a mistake in the return type of the function"}, {"owner": {"reputation": 142, "user_id": 9528129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TjZ9bved_PA/AAAAAAAAAAI/AAAAAAAAACo/TGFN1oC-PGU/photo.jpg?sz=128", "display_name": "Harshil Shah", "link": "https://stackoverflow.com/users/9528129/harshil-shah"}, "reply_to_user": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 0, "creation_date": 1552453143, "post_id": 55134568, "comment_id": 97010115, "body": "@JeremyFriesner, Thanks for the tip. But I knew it already. The thing is that that comment button is not there in mobile version. If it is possible to do so, Please guide me through it."}, {"owner": {"reputation": 142, "user_id": 9528129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TjZ9bved_PA/AAAAAAAAAAI/AAAAAAAAACo/TGFN1oC-PGU/photo.jpg?sz=128", "display_name": "Harshil Shah", "link": "https://stackoverflow.com/users/9528129/harshil-shah"}, "reply_to_user": {"reputation": 39, "user_id": 4254164, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/FBbzI.jpg?s=128&g=1", "display_name": "slim", "link": "https://stackoverflow.com/users/4254164/slim"}, "edited": false, "score": 0, "creation_date": 1552453333, "post_id": 55134568, "comment_id": 97010167, "body": "@slim, Please tick the answer if it worked out for you. Thanks!"}, {"owner": {"reputation": 39, "user_id": 4254164, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/FBbzI.jpg?s=128&g=1", "display_name": "slim", "link": "https://stackoverflow.com/users/4254164/slim"}, "edited": false, "score": 0, "creation_date": 1552453676, "post_id": 55134568, "comment_id": 97010262, "body": "@ jeremyFriesner , after re reading my code I realize I missed some parenthesis  I added them and the program now compiles but i have a new issue. now that the program runs it does not work . for example entering user name Wilson and the password Wilson809 it returns nothing but this message &quot;Segmentation fault &quot;"}], "tags": [], "owner": {"reputation": 142, "user_id": 9528129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TjZ9bved_PA/AAAAAAAAAAI/AAAAAAAAACo/TGFN1oC-PGU/photo.jpg?sz=128", "display_name": "Harshil Shah", "link": "https://stackoverflow.com/users/9528129/harshil-shah"}, "is_accepted": false, "score": 1, "last_activity_date": 1552452596, "last_edit_date": 1552452596, "creation_date": 1552452269, "answer_id": 55134568, "question_id": 55134547, "link": "https://stackoverflow.com/questions/55134547/i-am-trying-to-creating-a-login-system-with-c-programming-language/55134568#55134568", "title": "I am trying to creating a login system with C programming language", "body": "<p>You can't return 0 to a function which is returning void.</p>\n\n<p>Please mention the <strong>error</strong> you are getting from this code.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 4254164, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/FBbzI.jpg?s=128&g=1", "display_name": "slim", "link": "https://stackoverflow.com/users/4254164/slim"}, "is_accepted": false, "score": 0, "last_activity_date": 1552600133, "last_edit_date": 1552600133, "creation_date": 1552456612, "answer_id": 55135312, "question_id": 55134547, "link": "https://stackoverflow.com/questions/55134547/i-am-trying-to-creating-a-login-system-with-c-programming-language/55135312#55135312", "title": "I am trying to creating a login system with C programming language", "body": "<p>I solved the problem </p>\n\n<p>after I realized I return 0 to a function which is void  and sort out my parenthesis\nI realized i needed a two char array example </p>\n\n<p>instead of this :</p>\n\n<pre><code>void login_session(char username[10], char password[10]){    //ect }\n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>void login_session(){\n    char username[10];\n    char password[10];\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4254164, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/FBbzI.jpg?s=128&g=1", "display_name": "slim", "link": "https://stackoverflow.com/users/4254164/slim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1552600133, "creation_date": 1552452147, "last_edit_date": 1552456108, "question_id": 55134547, "link": "https://stackoverflow.com/questions/55134547/i-am-trying-to-creating-a-login-system-with-c-programming-language", "title": "I am trying to creating a login system with C programming language", "body": "<p>I'm trying to create a login system with the C programming language. the following code below is my attempt, can anyone point out to me  my mistake. \nthe Goal is to match the username and password in the program . for example if I were to enter  Amy as username and Amy76 as password is supposed to accept it and print login.</p>\n\n<pre><code>#include&lt;conio.h&gt;\n#include&lt;string.h&gt;\n\nint main()\n{\n\n    login_session();\n    return 0;\n}\n\n// following function accepts the login creed for teachers\nvoid login_session(char username[10], char password[10]){\n    printf(\"Enter instructor's Full Name :\\n\");\n    scanf(\"%s\", &amp;username);\n    printf(\"Enter password :\\n\");\n    scanf(\"%s\", &amp;password);\n\n    clrscr();\n\n    //conditional statements to test teachers username and password\n\n    if(strcmp(username, \"Amy\") ==0) {\n\n        if(strcmp(password,\"Amy76\") ==0){\n            printf(\"\\nwelcome. Login Sucessfully \");\n        } else {\n            printf(\"\\ninvalid. username and password does not exist\");\n        }\n\n\n    } else if (strcmp(username, \"Smith\") ==0){\n        if(strcmp(password,\"Smith345\") ==0){\n            printf(\"\\nwelcome. Login Sucessfully\");\n        } else {\n            printf(\"\\ninvalid.username and password does not exist\");\n        }\n    } else if (strcmp(username, \"Doris\") ==0) {\n        if(strcmp(password,\"Doris284\") ==0){\n            printf(\"\\nwelcome.Login Sucessfully\");\n        }else {\n            printf(\"\\ninvalid. username and password does not exist\");\n        }\n    } else if (strcmp(username,\"Wilson\") == 0) {\n        if(strcmp(password,\"Wilson809\") ==0){\n            printf(\"\\nwelcome.Login Sucessfully\");\n        }else {\n            printf(\"\\ninvalid. username and password does not exist\");\n        }\n    } \n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "string", "search"], "comments": [{"owner": {"reputation": 395, "user_id": 11164833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9cc8b40809cb899420831de0a8e25f?s=128&d=identicon&r=PG&f=1", "display_name": "wonter", "link": "https://stackoverflow.com/users/11164833/wonter"}, "edited": false, "score": 0, "creation_date": 1552449804, "post_id": 55134181, "comment_id": 97009251, "body": "So you scan %d and input a string??"}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1552449908, "post_id": 55134181, "comment_id": 97009280, "body": "I can&#39;t tell what is commented out, or what you intend this code to do... why are so many chunks of code commented out? And what is <code>if (guess ==)</code>???"}, {"owner": {"reputation": 1, "user_id": 11086778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35cc8d755df84eac8ca1268c4db5b38?s=128&d=identicon&r=PG", "display_name": "Lucas Billips", "link": "https://stackoverflow.com/users/11086778/lucas-billips"}, "edited": false, "score": 0, "creation_date": 1552449939, "post_id": 55134181, "comment_id": 97009289, "body": "No that was comment. I didn&#39;t know what %d meant so I looked it up and typed it to memorize"}, {"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1552449950, "post_id": 55134181, "comment_id": 97009292, "body": "<code>const char characters</code> should be <code>const char* characters</code>. The concept of pointers is required here."}, {"owner": {"reputation": 1, "user_id": 11086778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35cc8d755df84eac8ca1268c4db5b38?s=128&d=identicon&r=PG", "display_name": "Lucas Billips", "link": "https://stackoverflow.com/users/11086778/lucas-billips"}, "edited": false, "score": 0, "creation_date": 1552449988, "post_id": 55134181, "comment_id": 97009302, "body": "All I am asking is how to scan strings for certain letters."}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1552450053, "post_id": 55134181, "comment_id": 97009318, "body": "You would need to start with a &quot;string&quot;, which is a pointer to characters (as Susmit already noted)."}, {"owner": {"reputation": 1, "user_id": 11086778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35cc8d755df84eac8ca1268c4db5b38?s=128&d=identicon&r=PG", "display_name": "Lucas Billips", "link": "https://stackoverflow.com/users/11086778/lucas-billips"}, "edited": false, "score": 0, "creation_date": 1552450179, "post_id": 55134181, "comment_id": 97009350, "body": "To be 100% honest I do not fully understand the concept of pointers"}, {"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1552450557, "post_id": 55134181, "comment_id": 97009431, "body": "In C, there is no datatype called &quot;String&quot;. Instead, character arrays are used to store text data. A pointer, in this case, is the starting address of the array."}, {"owner": {"reputation": 2955, "user_id": 3819007, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6hvpZ.png?s=128&g=1", "display_name": "visibleman", "link": "https://stackoverflow.com/users/3819007/visibleman"}, "edited": false, "score": 1, "creation_date": 1552450574, "post_id": 55134181, "comment_id": 97009436, "body": "@LucasBillips, kudos for admitting that. Pointers really are a fundamental part of C so I&#39;d recommend you start out by reading up on them."}, {"owner": {"reputation": 3222, "user_id": 5533928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/517d5a0e08d76cd446ac7e6b156093a4?s=128&d=identicon&r=PG&f=1", "display_name": "Susmit Agrawal", "link": "https://stackoverflow.com/users/5533928/susmit-agrawal"}, "edited": false, "score": 0, "creation_date": 1552450659, "post_id": 55134181, "comment_id": 97009456, "body": "You can use this form of declaration to make it clearer: <code>const char characters[]</code>"}, {"owner": {"reputation": 395, "user_id": 11164833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee9cc8b40809cb899420831de0a8e25f?s=128&d=identicon&r=PG&f=1", "display_name": "wonter", "link": "https://stackoverflow.com/users/11164833/wonter"}, "edited": false, "score": 0, "creation_date": 1552450855, "post_id": 55134181, "comment_id": 97009522, "body": "@LucasBillips You should fix your sample code so that it can work."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552470216, "post_id": 55134181, "comment_id": 97017732, "body": "<b>&quot;How to find letters in string&quot;</b> -- <b>&quot;Which Letters?&quot;</b> All, vowels, consonants, digits, uppercase, lowercase, alpha, alphanumeric, ...?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552483406, "post_id": 55134181, "comment_id": 97026154, "body": "What bearing does the code in question have to do with finding letters?"}], "answers": [{"tags": [], "owner": {"reputation": 138, "user_id": 10911242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d36edcc94a17d299b872b1e38afecd?s=128&d=identicon&r=PG&f=1", "display_name": "risbo", "link": "https://stackoverflow.com/users/10911242/risbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1552469813, "creation_date": 1552469813, "answer_id": 55138521, "question_id": 55134181, "link": "https://stackoverflow.com/questions/55134181/search-for-letter-or-string-in-c/55138521#55138521", "title": "Search for letter or string in C", "body": "<p>Standard C library has many functions for string manipulation, such as strcpy, strncpy,strlen, strchr, strcat and so on.\nYou can find letters in a string by using 'strchr' function.\nFor example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n   const char *astring=\"Stack Owerflow\"; \n   char *ptr = strchr(astring, 'O');\n   printf(\"Found:%c on position: %d\\n\",*ptr, ptr-astring);\n}\n</code></pre>\n\n<p>/* Output:\nFound:O on position: 6\n*/</p>\n"}], "owner": {"reputation": 1, "user_id": 11086778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35cc8d755df84eac8ca1268c4db5b38?s=128&d=identicon&r=PG", "display_name": "Lucas Billips", "link": "https://stackoverflow.com/users/11086778/lucas-billips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 699, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1552469813, "creation_date": 1552449601, "last_edit_date": 1552455361, "question_id": 55134181, "link": "https://stackoverflow.com/questions/55134181/search-for-letter-or-string-in-c", "title": "Search for letter or string in C", "body": "<p>I am very new to C programming. I have extensive background in other web dev languages. I looked up simple number game online and copied and pasted. To check my understanding I commented some things as well. I tried to debug and realized that when a string is entered the entire code breaks. I just need a quick answer to something very basic: How to find letters in string.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\n/*Attempting to optimize number game in C*/\n// immediate bug: runs FOREVER if text is entered\n\n\nint main(void) {\n    srand(time(NULL)); //I do not know \n    int r = rand() % 10 + 1; //Random number\n    int correct = 0; //number correct from guess\n    int guess; // Instance of guess\n    int counter = 0; // Counter; how many tries\n    const char* characters[\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"];// this is my var/*\n    int c = 0, count[26] = { 0 }, x;\n    */\n\n    char string = [100];\n    printf(\"Guess my number! \"); // Does not need to repeat because of conditional statements below...\n\n    do { //Runs at least once... [\n        scanf(\"%d\", &amp;guess); // Takes in a number %d = int  \n/*\n        while (string[c] != '\\0') {\n            if (string[c] &gt;= 'a' &amp;&amp; string[c] &lt;= 'z') {\n                x = string[c] - 'a';\n                count[x]++\n            }\n\n            c++;\n        }\n*/\n        if (guess ==)\n        if()\n\n        if (guess == r) {  // Check if true \n            counter++; // Increment counter by 1\n            printf(\"You guessed correctly in %d tries! Congratulations!\\n\", counter); // \n            correct = 1;\n        }\n\n        if (guess &lt; r) { // check if less than\n            counter++;\n            printf(\"Your guess is too low. Guess again. \");\n        }\n\n        if (guess &gt; r) { // check if more than \n            counter++;\n            printf(\"Your guess is too high. Guess again. \");\n        }\n    } while (correct == 0); // If correct is null. ]\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "void"], "answers": [{"tags": [], "owner": {"reputation": 1805, "user_id": 6284997, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1376431542382698/picture?type=large", "display_name": "MayurK", "link": "https://stackoverflow.com/users/6284997/mayurk"}, "is_accepted": false, "score": 2, "last_activity_date": 1552448183, "creation_date": 1552448183, "answer_id": 55133980, "question_id": 55133939, "link": "https://stackoverflow.com/questions/55133939/i-have-a-warning-and-error-with-void-value-warningin-function-returning-void/55133980#55133980", "title": "I have a warning and error with void value; warning:in function returning void, error: void value not ignored", "body": "<p><code>void print_month(...)</code> means this function will return no values. But you are returning a value at the end - <code>return first_day;</code></p>\n\n<p>Change <code>void print_month(...)</code> to <code>int print_month(...)</code> to make it return an integer value.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1552448239, "creation_date": 1552448239, "answer_id": 55133989, "question_id": 55133939, "link": "https://stackoverflow.com/questions/55133939/i-have-a-warning-and-error-with-void-value-warningin-function-returning-void/55133989#55133989", "title": "I have a warning and error with void value; warning:in function returning void, error: void value not ignored", "body": "<p>The <code>print_month</code> function is declared with a return type of <code>void</code>, which means it returns no value.  That's why you get a warning when you try to return a value from the function and and warning when you try to use the function's return value.</p>\n\n<p>You want this function to return a value of type <code>int</code>, so change the return type to that:</p>\n\n<pre><code>int print_month(int month, int year, int first_day, int year_view){\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11030307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19c51c6cfa77a85cd600fe77f68d9a44?s=128&d=identicon&r=PG&f=1", "display_name": "avaaaaalyn", "link": "https://stackoverflow.com/users/11030307/avaaaaalyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552448239, "creation_date": 1552447938, "question_id": 55133939, "link": "https://stackoverflow.com/questions/55133939/i-have-a-warning-and-error-with-void-value-warningin-function-returning-void", "title": "I have a warning and error with void value; warning:in function returning void, error: void value not ignored", "body": "<p>My code is getting these warnings and I'm not sure how to fix them.\nWarning: 'return' with a value, in function returning void [enabled by default]\nError: void value not ignored as it ought to be</p>\n\n<p>Here is some of my code:</p>\n\n<pre><code>void print_month(int month, int year, int first_day, int year_view){\n  int width, row, col;\n  int days = days_per_month[month - 1];\n\n  if (month == 2){\n    days += leap_year_correction(year);\n  }\n\n  --month;\n\n  if (year_view){\n    row = (month /3) * 9 +2;\n    col = (month % 3) * 22;\n  } else{\n    row = col = 0;\n  }\n  if (year_view){\n    width = 10 + strlen(month_names[month])/2;\n    sprintf(grid[row] + col, \"%*s\", width, month_names[month]);\n  } else{\n    width = 8 + strlen(month_names[month])/2;\n    sprintf(grid[row] + col, \"%*s %d\", width, month_names[month], year);\n  }\n  sprintf(grid[row + 1] + col, \"Su Mo Tu We Th Fr Sa\");\n  sprintf(grid[row + 2] + col, \"%*s\", 3 * first_day, \"\");\n  row += 2;\n  for (int i=1; i &lt;= days; i++){\n    sprintf(grid[row] + col + 3 * first_day, \"%2d\", i);\n    if ((first_day = (first_day + 1) % 7) == 0){\n      row += 1;\n    }\n  }\n  return first_day;\n}\n</code></pre>\n\n<p>The next part is code from my main program</p>\n\n<pre><code>first_day = find_first_day(month &lt; 0 ? 1 : month, year);\n  if (month &lt; 0){\n    sprintf(grid[0] + 30, \"%d\", year);\n    for (int i=1; i &lt;= 12; i++){\n      first_day = print_month(i, year, first_day, 1);\n    }\n  } else{\n    print_month(month, year, first_day, 0);\n  }\n  print_grid(month &lt; 0);\n  return 0;\n</code></pre>\n"}, {"tags": ["c", "arrays", "dynamic", "fftw"], "comments": [{"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1552447687, "post_id": 55133651, "comment_id": 97008789, "body": "I don&#39;t see any obvious problem with the way you&#39;re handling your array. Are you sure the segfault is to do with the array?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552449540, "post_id": 55133651, "comment_id": 97009185, "body": "I don&#39;t know what <code>fftwf_plan</code> is. Could it be a typedeffed pointer? In <code>fftplan = calloc(NUMFFT,sizeof(fftwf_plan));</code> is <code>sizeof *fftplan == sizeof(fftwf_plan)</code>? I would expect so, but that is the only thing unclear about what you have posted. That and <code>fftout[lochead][i][0])</code> where are the 3 level of indirection from?"}, {"owner": {"reputation": 351, "user_id": 10443813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ee2ae00e0a906599c69e0e698035d0?s=128&d=identicon&r=PG&f=1", "display_name": "KL-Yang", "link": "https://stackoverflow.com/users/10443813/kl-yang"}, "edited": false, "score": 0, "creation_date": 1552461682, "post_id": 55133651, "comment_id": 97013159, "body": "consider fftwf_plan a pointer that sizeof(fftw_plan)==sizeof(void*), like you said, it is an opaque object. The interesting part would be how you allocate the fftin[i] and fftout[i]? It would be good to post a minimum example that can compile and execute. The NUMFFT, you used it as number of plan or number of data points for transform?"}, {"owner": {"reputation": 419, "user_id": 4548383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981c3ef52cef1b7a7574a1209da356a8?s=128&d=identicon&r=PG", "display_name": "Alan Corey", "link": "https://stackoverflow.com/users/4548383/alan-corey"}, "edited": false, "score": 0, "creation_date": 1552494012, "post_id": 55133651, "comment_id": 97033874, "body": "Well, duh, I broke it up.  I made an fftwf_plan variable, I can set that OK, it&#39;s when I try to copy that into the array that I get a segfault.;"}, {"owner": {"reputation": 419, "user_id": 4548383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981c3ef52cef1b7a7574a1209da356a8?s=128&d=identicon&r=PG", "display_name": "Alan Corey", "link": "https://stackoverflow.com/users/4548383/alan-corey"}, "edited": false, "score": 0, "creation_date": 1552494840, "post_id": 55133651, "comment_id": 97034350, "body": "#define NUMFFT 10 // # of fft plans, fft input and output arrays (it&#39;s the size of the queue, lochead is the queue position.  lochead is a local var set to the head position in the queue when the mutex is locked). fftwf_complex *fftin[NUMFFT], *fftout[NUMFFT]; then I use fftin[i] = (fftwf_complex *) fftwf_malloc(sizeof(fftwf_complex) *  fftsize);"}, {"owner": {"reputation": 419, "user_id": 4548383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981c3ef52cef1b7a7574a1209da356a8?s=128&d=identicon&r=PG", "display_name": "Alan Corey", "link": "https://stackoverflow.com/users/4548383/alan-corey"}, "edited": false, "score": 0, "creation_date": 1552831667, "post_id": 55133651, "comment_id": 97151816, "body": "This was working: //fftwf_plan fftplan[NUMFFT]; but I wanted a dynamic array so I could change the size easier than #defining NUMFFT in a header.  I don&#39;t remember exactly why now but I&#39;m trying to make the program more flexible.  FFTSIZE is now fftsize, set to the X resolution read by an ioctl FBIOGET_VSCREENINFO.  But I switched from static arrays to dynamic without changing anything in the way they&#39;re accessed.  In some cases that works right.  The compiler doesn&#39;t complain."}, {"owner": {"reputation": 419, "user_id": 4548383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981c3ef52cef1b7a7574a1209da356a8?s=128&d=identicon&r=PG", "display_name": "Alan Corey", "link": "https://stackoverflow.com/users/4548383/alan-corey"}, "edited": false, "score": 0, "creation_date": 1552832055, "post_id": 55133651, "comment_id": 97151915, "body": "<a href=\"https://en.wikipedia.org/wiki/Opaque_pointer\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Opaque_pointer</a>  &quot;However, they will not be able to de-reference such a pointer, and can only change the object&#39;s content by calling some procedure that has the missing information.&quot;  What happens if I make an array of void * and set those equal the opaque *?  I&#39;ll probably need to cast them back as I use them.  Maybe they&#39;ll need to be void **."}, {"owner": {"reputation": 419, "user_id": 4548383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981c3ef52cef1b7a7574a1209da356a8?s=128&d=identicon&r=PG", "display_name": "Alan Corey", "link": "https://stackoverflow.com/users/4548383/alan-corey"}, "edited": false, "score": 0, "creation_date": 1552833108, "post_id": 55133651, "comment_id": 97152231, "body": "Maybe this is relevant : <a href=\"https://stackoverflow.com/questions/7574350/segmentation-fault-using-fftw\" title=\"segmentation fault using fftw\">stackoverflow.com/questions/7574350/&hellip;</a>  I do have several threads.  Since this stuff is just initialization I&#39;ll try moving it to before I init the threads.  And I&#39;m not using fftw_init_threads at all.  <a href=\"http://www.fftw.org/fftw3_doc/Usage-of-Multi_002dthreaded-FFTW.html\" rel=\"nofollow noreferrer\">fftw.org/fftw3_doc/Usage-of-Multi_002dthreaded-FFTW.html</a>"}, {"owner": {"reputation": 419, "user_id": 4548383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981c3ef52cef1b7a7574a1209da356a8?s=128&d=identicon&r=PG", "display_name": "Alan Corey", "link": "https://stackoverflow.com/users/4548383/alan-corey"}, "edited": false, "score": 0, "creation_date": 1552834562, "post_id": 55133651, "comment_id": 97152742, "body": "Well, maybe not.  I also followed <a href=\"https://stackoverflow.com/questions/36790241/how-to-setup-fftw-with-threads-and-different-precisions\" title=\"how to setup fftw with threads and different precisions\">stackoverflow.com/questions/36790241/&hellip;</a> and I think I have the multi-threaded stuff right but my segfault is exactly the same: when I try to store the plan into a dynamic array of them.  There&#39;s only one thread doing FFT anyway, and it&#39;s on data in a queue protected by a mutex.  Maybe I&#39;ll just go back to a static array in this case."}], "owner": {"reputation": 419, "user_id": 4548383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981c3ef52cef1b7a7574a1209da356a8?s=128&d=identicon&r=PG", "display_name": "Alan Corey", "link": "https://stackoverflow.com/users/4548383/alan-corey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552698233, "creation_date": 1552445741, "last_edit_date": 1552698233, "question_id": 55133651, "link": "https://stackoverflow.com/questions/55133651/storing-an-array-of-fftwf-plans", "title": "Storing an array of fftwf_plans?", "body": "<p>I'm working on an SDR program, and I have queues of data coming from the RTL2832 dongle, another queue waiting to go through FFTW (in another thread), another queue waiting to be displayed in another thread.</p>\n\n<p>I was using a static array of plans but now I want to switch to a dynamically allocated one.  Like:</p>\n\n<pre><code>//fftwf_plan fftplan[NUMFFT];\nfftwf_plan *fftplan; // dynamic version\n</code></pre>\n\n<p>Then later I do</p>\n\n<pre><code>fftplan = calloc(NUMFFT,sizeof(fftwf_plan));\n</code></pre>\n\n<p>And to fill the array I do:</p>\n\n<pre><code>fftplan[i] = fftwf_plan_dft_1d(fftsize,fftin[i],fftout[i],FFTW_FORWARD,FFTW_ESTIMATE);\n</code></pre>\n\n<p>Which now segfaults when it runs and I'm kinda clueless.  I figured out the FFT  part a year or more ago, I'm not up to speed on it.  It works with a static array.  I barely understand ** and now I'm trying to fill a dynamic array with opaque pointers.  I think it's mostly a C question, not an FFT one, but I don't think I can use ** here since it's opaque.</p>\n\n<p>My data is in 2d arrays like </p>\n\n<pre><code>fftwf_complex *fftin[NUMFFT], *fftout[NUMFFT];\n</code></pre>\n\n<p>So basic AM demod is like</p>\n\n<pre><code>dpybuf[i] = sqrt(((fftout[lochead][i][0]) * (fftout[lochead][i][0])) + \\\n   ((fftout[lochead][i][1]) * (fftout[lochead][i][1])));\n</code></pre>\n\n<p>Maybe I don't need a separate plan for each bufferful of data.  lochead is the position in the circular queue, i is an individual point, [0] or [1] at the end is the real or imaginary part.</p>\n\n<pre><code>-------------- edit------------\n</code></pre>\n\n<p>In doing SDR a radio waveform is digitized by doing 2 A/D conversions 90 degrees apart.  Those are called I and Q and treated as real and imaginary numbers.  There's no actual square root of a negative number.</p>\n\n<p>OK, some more of the code, but the whole thing's a couple thousand lines in several files.</p>\n\n<pre><code>fftwf_plan *fftplan; // dynamic version [global]\n// I tried **fftplan above, it acts the same: compiles OK but segfaults\n\nfftplan = calloc(NUMFFT,sizeof(fftwf_plan));\nif (fftplan == NULL) {\n  fprintf(stderr,\"Failed to allocate fftplan[]\\n\");\n  exit(1);\n}\n\n// fft init  (NUMFFT is set at 10, the # of batches in the queue.)\nfor (i=0;i&lt;NUMFFT; i++) {\n  fftin[i] = (fftwf_complex *) fftwf_malloc(sizeof(fftwf_complex) *  fftsize);\n  if (fftin[i] == NULL) {\n    printf(\"malloc() of space for fftin failed.\\n\");\n    perror(\"malloc \");\n    exit(1);\n  }\n  fftout[i] = (fftwf_complex *) fftwf_malloc(sizeof(fftwf_complex) * fftsize);\n  if (fftout[i] == NULL) {\n    printf(\"malloc() of space for fftout failed.\\n\");\n    perror(\"malloc \");\n    fftwf_free(fftin);\n    exit(1);\n  } \naplan = fftwf_plan_dft_1d(fftsize,fftin[i],fftout[i],FFTW_FORWARD,\\\n  FFTW_ESTIMATE);\n\nprintf(\"plan %i\\n\",i);  // announce progress\nfflush(stdout);\n    fftplan[i]  = aplan; // see where it segfaults [here, storing plan 0]\n\n  }\n</code></pre>\n\n<p>fftwf is the single precision floating point version of FFTW.  I only have 8 bit samples coming from the dongle, I don't need doubles.</p>\n\n<p>fftsize is now my display X resolution, I was running 4096 points through here, now 1024</p>\n"}, {"tags": ["c", "tree", "binary-search-tree", "tree-traversal", "preorder"], "comments": [{"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1552575716, "post_id": 55133610, "comment_id": 97070764, "body": "Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>.  What have you tried? We cannot help you write something from scratch but if you are having trouble with specific parts of the code we can help you.  Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for more information"}, {"owner": {"reputation": 11, "user_id": 10650959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98481bc08fee8ab1493e222739938541?s=128&d=identicon&r=PG&f=1", "display_name": "Paras Karnawat", "link": "https://stackoverflow.com/users/10650959/paras-karnawat"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1552575816, "post_id": 55133610, "comment_id": 97070830, "body": "I&#39;m just having a problem in inserting the right child of the preorder threaded binary tree."}], "owner": {"reputation": 11, "user_id": 10650959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98481bc08fee8ab1493e222739938541?s=128&d=identicon&r=PG&f=1", "display_name": "Paras Karnawat", "link": "https://stackoverflow.com/users/10650959/paras-karnawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552574617, "creation_date": 1552445407, "last_edit_date": 1552574617, "question_id": 55133610, "link": "https://stackoverflow.com/questions/55133610/insertion-in-preorder-threaded-binary-search-tree", "title": "Insertion in preorder threaded binary search tree", "body": "<p>I am having problem in insertion of keys in preorder threaded binary tree. Can someone help me with the implementation of insertion and traversals in preorder threaded binary tree.</p>\n"}, {"tags": ["c", "stm32", "uart", "dma"], "comments": [{"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 1, "creation_date": 1552445441, "post_id": 55133545, "comment_id": 97008341, "body": "please share more code."}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "reply_to_user": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552446050, "post_id": 55133545, "comment_id": 97008470, "body": "@Medicineman25 At the moment I don&#39;t have my code in front of me. But there is nothing special about it and what bothers me is that one UARt works and the other one doesn&#39;t. The one that works is via 485 and the other one 232 via SP3232EBEY-L. As soon as I&#39;m in front of my PC I&#39;ll post the code"}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "reply_to_user": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552447655, "post_id": 55133545, "comment_id": 97008781, "body": "@Medicineman25 Ok, Fortunately I&#39;ve donde this so many times that I was able to rewrite the important right now and got the configurations I&#39;ve been using from cubeMx"}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552451458, "post_id": 55133545, "comment_id": 97009673, "body": "Awesome!! Just for future, mentioning that one is doing 485 and the other 232 is vital information."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552457119, "post_id": 55133545, "comment_id": 97011302, "body": "So the only thing &#39;glaring&#39; issue I can see there is that you have set the NVIC priority for the 2nd USART, but not the 1st. This might be causing you issues. Also, not sure what modem you are talking to, does it require assertion on RTS or CTS that aren&#39;t being made? What about your oversampling rate? Have you adjusted that?"}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552457202, "post_id": 55133545, "comment_id": 97011338, "body": "Also is it dropping bits at the USART or DMA? Might be good to pipe directly out again to a serial modem and print the output for a quick sanity check."}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "reply_to_user": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552472247, "post_id": 55133545, "comment_id": 97019056, "body": "@Medicineman25 Nice catch ... I&#39;ll try fixing that. And the DMA is dropping bits and not the UART."}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "reply_to_user": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552473249, "post_id": 55133545, "comment_id": 97019687, "body": "@Medicineman25 Went to the msp init function, added the priority and same problem."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552473624, "post_id": 55133545, "comment_id": 97019930, "body": "&quot;if(HAL_UART_Receive_DMA(&amp;huart1, rxbuffer, 256) != HAL_OK)&quot; should that be rx232buffer? It could be timing out and diverting bits to another buffer."}, {"owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "reply_to_user": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552474175, "post_id": 55133545, "comment_id": 97020292, "body": "@Medicineman25 Nope. That was a typo, I&#39;m fixing it now. I can see that I&#39;m getting the frame in the correct buffer ... my problem really is that it randomly drops the first byte(s) ... First time -&gt; full packet ... next time times ... packet - 1 byte .... packet - 4 bytes .. etc .. I&#39;ll keep on working on it but I think I&#39;ll have to change my approach"}], "owner": {"reputation": 947, "user_id": 1053944, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/363b1bb1c9cd90a0ae14ace401289dbd?s=128&d=identicon&r=PG", "display_name": "morcillo", "link": "https://stackoverflow.com/users/1053944/morcillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1056, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552526438, "creation_date": 1552444940, "last_edit_date": 1552526438, "question_id": 55133545, "link": "https://stackoverflow.com/questions/55133545/stm32-only-works-properly-the-first-time-and-then-drops-bytes", "title": "STM32 only works properly the first time and then drops bytes", "body": "<p>I am having a strange problem. I have a board with 2 UART interfaces (STM32F217) and I am using DMA to receive the data on both UARTs (USART1 and USART2).</p>\n\n<p>USART2 works perfectly. I can send and receive data through it no problem, but I am having a problem with USART1. It only works properly the first transfer. If it just worked once and then stopped then I'd be ok, since it probably means that I just need to add the function for USART1 interruption and call its IRQHandler But my problem is that the next times it receives the data, but it drops the first few bytes (randomly ... sometimes drops 2 sometimes drops up to 6 bytes and it's not like it's a fast protocol, it has a 1s timeout). </p>\n\n<p>Here is my workflow:\n- Initialize UART;</p>\n\n<ul>\n<li><p>Call Receive_DMA;</p></li>\n<li><p>Protocol has variable size, it depends on the first bytes so I configured a fixed 256 circular receive transfer (maximum size for header + data) and check how many bytes have been received so far, if the amount matches the first byte then it's ok. </p></li>\n<li><p>After error (did not receive entire packet, wrong CRC or timeout) or success then call </p>\n\n<p>HAL_UART_DMAStop(&amp;huart1);</p></li>\n</ul>\n\n<p>and then </p>\n\n<pre><code>if(HAL_UART_Receive_DMA(&amp;huart1, rx232buffer, 256) != HAL_OK) {\n    while(1);\n}\n</code></pre>\n\n<p>This is done for both UARTs and one works perfectly and the other works well the first time and then starts dropping bytes. </p>\n\n<p>Any idea of what could be the problem?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here's a version of my code. I wrote the functionality just now (inside main loop ... it's not exactly that but it works similar to that ... my code is kinda big and with many things not related to the communication so I just rewrote it like this ... as stated huart1 only works properly once and then drops bytes ... huart2 works fine .. huart1 is RS232 ... huart2 i RS485)</p>\n\n<pre><code>static void rxbuffer[256] = {0};\nstatic void rx232buffer[256] = {0};\n\nstruct header {\n    int startWord;\n    int command;\n    int size;\n};\n\nUART_HandleTypeDef huart1;\nUART_HandleTypeDef huart2;\nDMA_HandleTypeDef hdma_usart1_rx;\nDMA_HandleTypeDef hdma_usart1_tx;\nDMA_HandleTypeDef hdma_usart2_rx;\nDMA_HandleTypeDef hdma_usart2_tx;\n\nstatic void MX_DMA_Init(void)\n{\n    /* DMA controller clock enable */\n    __HAL_RCC_DMA2_CLK_ENABLE();\n    __HAL_RCC_DMA1_CLK_ENABLE();\n\n    /* DMA interrupt init */\n    /* DMA1_Stream5_IRQn interrupt configuration */\n    HAL_NVIC_SetPriority(DMA1_Stream5_IRQn, 5, 0);\n    HAL_NVIC_EnableIRQ(DMA1_Stream5_IRQn);\n    /* DMA1_Stream6_IRQn interrupt configuration */\n    HAL_NVIC_SetPriority(DMA1_Stream6_IRQn, 5, 0);\n    HAL_NVIC_EnableIRQ(DMA1_Stream6_IRQn);\n    /* DMA2_Stream2_IRQn interrupt configuration */\n    HAL_NVIC_SetPriority(DMA2_Stream2_IRQn, 5, 0);\n    HAL_NVIC_EnableIRQ(DMA2_Stream2_IRQn);\n    /* DMA2_Stream7_IRQn interrupt configuration */\n    HAL_NVIC_SetPriority(DMA2_Stream7_IRQn, 5, 0);\n    HAL_NVIC_EnableIRQ(DMA2_Stream7_IRQn);\n}\n\nstatic void MX_USART1_UART_Init(void)\n{\n    huart1.Instance = USART1;\n    huart1.Init.BaudRate = 57600;\n    huart1.Init.WordLength = UART_WORDLENGTH_8B;\n    huart1.Init.StopBits = UART_STOPBITS_1;\n    huart1.Init.Parity = UART_PARITY_NONE;\n    huart1.Init.Mode = UART_MODE_TX_RX;\n    huart1.Init.HwFlowCtl = UART_HWCONTROL_NONE;\n    huart1.Init.OverSampling = UART_OVERSAMPLING_16;\n    if (HAL_UART_Init(&amp;huart1) != HAL_OK)\n    {\n      _Error_Handler(__FILE__, __LINE__);\n    }\n\n}\n\nstatic void MX_USART2_UART_Init(void)\n{\n    huart2.Instance = USART2;\n    huart2.Init.BaudRate = 57600;\n    huart2.Init.WordLength = UART_WORDLENGTH_8B;\n    huart2.Init.StopBits = UART_STOPBITS_1;\n    huart2.Init.Parity = UART_PARITY_NONE;\n    huart2.Init.Mode = UART_MODE_TX_RX;\n    huart2.Init.HwFlowCtl = UART_HWCONTROL_NONE;\n    huart2.Init.OverSampling = UART_OVERSAMPLING_16;\n    if (HAL_UART_Init(&amp;huart2) != HAL_OK)\n     {\n      _Error_Handler(__FILE__, __LINE__);\n     }\n\n}\n\nint main(void)\n{\n    int bytecount;\n    int bytecount232;\n\n    int rxlen485;\n    int rxlen232;\n    HAL_Init();\n\n    SystemClock_Config();\n\n    MX_GPIO_Init();\n    MX_DMA_Init();\n    MX_USART1_UART_Init();\n    MX_USART2_UART_Init();\n\n    if(HAL_UART_Receive_DMA(&amp;huart2, rxbuffer, 256) != HAL_OK) {\n        while(1);\n    }\n\n    if(HAL_UART_Receive_DMA(&amp;huart1, rx232buffer, 256) != HAL_OK) {\n        while(1);\n    }\n\n    while(1) {\n        bytecount = __HAL_DMA_GET_COUNTER(&amp;hdma_usart2_rx);\n        rxlen485 = 256 - bytecount;\n        bytecount232 = __HAL_DMA_GET_COUNTER(&amp;hdma_usart1_rx);\n        rxlen232 = 256 - bytecount232;\n\n        if(rxlen485 &gt;= sizeof(struct header)) {\n            //start timer\n            struct header *pHeader = rxbuffer;\n            if(pHeader-&gt;size == rxlen485 - sizeof(struct header)) {\n                //do something\n                HAL_UART_DMAStop(&amp;huart2);\n                if(HAL_UART_Receive_DMA(&amp;huart2, rxbuffer, 256) != HAL_OK) {\n                    while(1);\n            }\n\n            if(timeout) { // purely demonstrative ... the timeout part\n                //do something\n                HAL_UART_DMAStop(&amp;huart2);\n                if(HAL_UART_Receive_DMA(&amp;huart2, rxbuffer, 256) != HAL_OK) {\n                    while(1);\n                }\n            }\n        }\n\n        if(rxlen232 &gt;= sizeof(struct header)) {\n            struct header *pHeader = rxbuffer;\n            if(pHeader-&gt;size == rxlen232 - sizeof(struct header)) {\n                //do something\n                HAL_UART_DMAStop(&amp;huart1);\n                if(HAL_UART_Receive_DMA(&amp;huart1, rx232buffer, 256) != HAL_OK) {\n                    while(1);\n                }\n\n                if(timeout) { // purely demonstrative ... the timeout part\n                    //do something\n                    HAL_UART_DMAStop(&amp;huart1);\n                    if(HAL_UART_Receive_DMA(&amp;huart1, rx232buffer, 256) != HAL_OK) {\n                        while(1);\n                    }\n                }\n            }\n        }\n    }\n}\n\nvoid HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart) {\n    __NOP();\n}\n\nvoid HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart) {\n    __NOP();\n}\n\nvoid USART2_IRQHandler(void)\n{\n  /* USER CODE BEGIN USART2_IRQn 0 */\n\n  /* USER CODE END USART2_IRQn 0 */\n  HAL_UART_IRQHandler(&amp;huart2);\n  /* USER CODE BEGIN USART2_IRQn 1 */\n\n  /* USER CODE END USART2_IRQn 1 */\n}\n\nvoid USART1_IRQHandler(void)\n{\n  /* USER CODE BEGIN USART2_IRQn 0 */\n\n  /* USER CODE END USART2_IRQn 0 */\n  HAL_UART_IRQHandler(&amp;huart1);\n  /* USER CODE BEGIN USART2_IRQn 1 */\n\n  /* USER CODE END USART2_IRQn 1 */\n}\n\n\n\n\n\n\n//----- in another file--------\nvoid HAL_UART_MspInit(UART_HandleTypeDef* huart)\n{\n\n  GPIO_InitTypeDef GPIO_InitStruct;\n  if(huart-&gt;Instance==USART1)\n  {\n  /* USER CODE BEGIN USART1_MspInit 0 */\n\n  /* USER CODE END USART1_MspInit 0 */\n    /* Peripheral clock enable */\n    __HAL_RCC_USART1_CLK_ENABLE();\n\n    /**USART1 GPIO Configuration    \n    PA9     ------&gt; USART1_TX\n    PA10     ------&gt; USART1_RX\n    PA11     ------&gt; USART1_CTS\n    PA12     ------&gt; USART1_RTS \n    */\n    GPIO_InitStruct.Pin = GPIO_PIN_9|GPIO_PIN_10;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_PULLUP;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;\n    GPIO_InitStruct.Alternate = GPIO_AF7_USART1;\n    HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);\n\n    GPIO_InitStruct.Pin = GPIO_PIN_11|GPIO_PIN_12;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_NOPULL;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;\n    GPIO_InitStruct.Alternate = GPIO_AF7_USART1;\n    HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);\n\n    /* USART1 DMA Init */\n    /* USART1_RX Init */\n    hdma_usart1_rx.Instance = DMA2_Stream2;\n    hdma_usart1_rx.Init.Channel = DMA_CHANNEL_4;\n    hdma_usart1_rx.Init.Direction = DMA_PERIPH_TO_MEMORY;\n    hdma_usart1_rx.Init.PeriphInc = DMA_PINC_DISABLE;\n    hdma_usart1_rx.Init.MemInc = DMA_MINC_ENABLE;\n    hdma_usart1_rx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;\n    hdma_usart1_rx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;\n    hdma_usart1_rx.Init.Mode = DMA_CIRCULAR;\n    hdma_usart1_rx.Init.Priority = DMA_PRIORITY_LOW;\n    hdma_usart1_rx.Init.FIFOMode = DMA_FIFOMODE_DISABLE;\n    if (HAL_DMA_Init(&amp;hdma_usart1_rx) != HAL_OK)\n    {\n      _Error_Handler(__FILE__, __LINE__);\n    }\n\n    __HAL_LINKDMA(huart,hdmarx,hdma_usart1_rx);\n\n    /* USART1_TX Init */\n    hdma_usart1_tx.Instance = DMA2_Stream7;\n    hdma_usart1_tx.Init.Channel = DMA_CHANNEL_4;\n    hdma_usart1_tx.Init.Direction = DMA_MEMORY_TO_PERIPH;\n    hdma_usart1_tx.Init.PeriphInc = DMA_PINC_DISABLE;\n    hdma_usart1_tx.Init.MemInc = DMA_MINC_ENABLE;\n    hdma_usart1_tx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;\n    hdma_usart1_tx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;\n    hdma_usart1_tx.Init.Mode = DMA_NORMAL;\n    hdma_usart1_tx.Init.Priority = DMA_PRIORITY_LOW;\n    hdma_usart1_tx.Init.FIFOMode = DMA_FIFOMODE_DISABLE;\n    if (HAL_DMA_Init(&amp;hdma_usart1_tx) != HAL_OK)\n    {\n      _Error_Handler(__FILE__, __LINE__);\n    }\n\n    __HAL_LINKDMA(huart,hdmatx,hdma_usart1_tx);\n\n  /* USER CODE BEGIN USART1_MspInit 1 */\n\n  /* USER CODE END USART1_MspInit 1 */\n  }\n  else if(huart-&gt;Instance==USART2)\n  {\n  /* USER CODE BEGIN USART2_MspInit 0 */\n\n  /* USER CODE END USART2_MspInit 0 */\n    /* Peripheral clock enable */\n    __HAL_RCC_USART2_CLK_ENABLE();\n\n    /**USART2 GPIO Configuration    \n    PD5     ------&gt; USART2_TX\n    PD6     ------&gt; USART2_RX \n    */\n    GPIO_InitStruct.Pin = GPIO_PIN_5|GPIO_PIN_6;\n    GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;\n    GPIO_InitStruct.Pull = GPIO_PULLUP;\n    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_VERY_HIGH;\n    GPIO_InitStruct.Alternate = GPIO_AF7_USART2;\n    HAL_GPIO_Init(GPIOD, &amp;GPIO_InitStruct);\n\n    /* USART2 DMA Init */\n    /* USART2_RX Init */\n    hdma_usart2_rx.Instance = DMA1_Stream5;\n    hdma_usart2_rx.Init.Channel = DMA_CHANNEL_4;\n    hdma_usart2_rx.Init.Direction = DMA_PERIPH_TO_MEMORY;\n    hdma_usart2_rx.Init.PeriphInc = DMA_PINC_DISABLE;\n    hdma_usart2_rx.Init.MemInc = DMA_MINC_ENABLE;\n    hdma_usart2_rx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;\n    hdma_usart2_rx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;\n    hdma_usart2_rx.Init.Mode = DMA_CIRCULAR;\n    hdma_usart2_rx.Init.Priority = DMA_PRIORITY_LOW;\n    hdma_usart2_rx.Init.FIFOMode = DMA_FIFOMODE_DISABLE;\n    if (HAL_DMA_Init(&amp;hdma_usart2_rx) != HAL_OK)\n    {\n      _Error_Handler(__FILE__, __LINE__);\n    }\n\n    __HAL_LINKDMA(huart,hdmarx,hdma_usart2_rx);\n\n    /* USART2_TX Init */\n    hdma_usart2_tx.Instance = DMA1_Stream6;\n    hdma_usart2_tx.Init.Channel = DMA_CHANNEL_4;\n    hdma_usart2_tx.Init.Direction = DMA_MEMORY_TO_PERIPH;\n    hdma_usart2_tx.Init.PeriphInc = DMA_PINC_DISABLE;\n    hdma_usart2_tx.Init.MemInc = DMA_MINC_ENABLE;\n    hdma_usart2_tx.Init.PeriphDataAlignment = DMA_PDATAALIGN_BYTE;\n    hdma_usart2_tx.Init.MemDataAlignment = DMA_MDATAALIGN_BYTE;\n    hdma_usart2_tx.Init.Mode = DMA_NORMAL;\n    hdma_usart2_tx.Init.Priority = DMA_PRIORITY_LOW;\n    hdma_usart2_tx.Init.FIFOMode = DMA_FIFOMODE_DISABLE;\n    if (HAL_DMA_Init(&amp;hdma_usart2_tx) != HAL_OK)\n    {\n      _Error_Handler(__FILE__, __LINE__);\n    }\n\n    __HAL_LINKDMA(huart,hdmatx,hdma_usart2_tx);\n\n    HAL_NVIC_SetPriority(USART2_IRQn, 5, 0);\n    HAL_NVIC_EnableIRQ(USART2_IRQn);\n  }\n\n}\n</code></pre>\n"}, {"tags": ["c", "gcc-warning", "gcc4.7"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1552443759, "post_id": 55133382, "comment_id": 97008016, "body": "#2 is perfectly defined."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1552475820, "post_id": 55133382, "comment_id": 97021221, "body": "@melpomene: Hmm? If a called function fails to pop enough stuff from the stack and then returns, the calling function will have a malformed stack."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1552476831, "post_id": 55133382, "comment_id": 97021835, "body": "@EricPostpischil The contents of <code>custom_printf(char* _format, ...)</code> do not pop stuff - calling code handles that.  <code>custom_printf()</code> simply examines the args and maybe not all of them."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552477514, "post_id": 55133382, "comment_id": 97022248, "body": "@chux: Whether <code>custom_printf</code> pops anything is a separate question from whether not popping enough from the stack would have undefined behavior."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1552483070, "post_id": 55133382, "comment_id": 97025909, "body": "@EricPostpischil yes, perfectly well-defined. The callee <i>cannot</i> pop stuff from stack with varargs functions. That&#39;s why the stdcall of MSVC cannot be used for varargs, and the docs say that: &quot;The __stdcall calling convention is used to call Win32 API functions. The callee cleans the stack, so the compiler makes vararg functions __cdecl. Functions that use this calling convention require a function prototype.&quot;"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552484196, "post_id": 55133382, "comment_id": 97026709, "body": "@AnttiHaapala: Again, whether <code>custom_printf</code> pops anything is a separate question from whether not popping enough from the stack would have undefined behavior. You are asserting that <code>custom_printf</code>, while using variable arguments, does not pop anything from the stack, and hence the situation of not popping enough from the stack does not occur in this case. But that has nothing to do with whether, if not enough items are popped from the stack (which might have to be in a different situation), undefined behavior would result."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1552501452, "post_id": 55133382, "comment_id": 97038038, "body": "@EricPostpischil Sounds like you are suggesting <code>foo(char *f,...) { va_list ap;  va_start(ap, f);   va_end(ap); }   f(&quot;xx&quot;,3,4,5);</code> is potential UB as <code>foo()</code> did not use the <code>3,4,5</code>.  Is that an example of the potential UB you see?  If not, could you point to one?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552504054, "post_id": 55133382, "comment_id": 97039422, "body": "@chux: No. melpomene commented that \u201c#2 is perfectly defined.\u201d That seems to refer to \u201c2. Not popping enough off the stack.\u201d I am not discussing <b>at all</b> whether not popping enough off the stack occurs in this situation or not. I am discussing whether <b>when a situation occurs where not enough is popped off the stack</b>, the resulting behavior is perfectly defined or not. That could be a caller using a declaration of <code>void foo(int, int, int)</code> but the definition is <code>void foo(int, int)</code>, and the ABI requires the called routine to pop the arguments."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1552517308, "post_id": 55133382, "comment_id": 97045032, "body": "@EricPostpischil As this issue if about &quot;variadic arguments&quot;, we need to consider <code>foo(type *bar, ...);</code> and the like.  Does you UB concern still apply there?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1552519094, "post_id": 55133382, "comment_id": 97045536, "body": "@EricPostpischil This question is about C. There is no stack."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1552520175, "post_id": 55133382, "comment_id": 97045821, "body": "@melpomene: The fact the C standard does not require a hardware-implemented stack does not mean there is no stack. And, if there is no stack, why did you say #2 is \u201cperfectly defined\u201d?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1552521105, "post_id": 55133382, "comment_id": 97046047, "body": "@EricPostpischil Even if there is a stack, you can&#39;t pop it from C. #2 is the second printf, <code>custom_printf(&quot;HI THERE&quot;, 1);</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1552522362, "post_id": 55133382, "comment_id": 97046367, "body": "@melpomene: Uh, okay, when you use \u201c#2\u201d to refer to something in text that contains a numbered listed but are not referring to an item in the list, you might want to rethink that."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 8143102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71843e230f0d76b1d30016f57daa7583?s=128&d=identicon&r=PG&f=1", "display_name": "will.mont", "link": "https://stackoverflow.com/users/8143102/will-mont"}, "edited": false, "score": 0, "creation_date": 1552448375, "post_id": 55133894, "comment_id": 97008941, "body": "Ive always heard that UB can be used to benefit the compiler. Here is a case where in some cases it hides silly errors. As a C developer should I not take advantage of UB?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 81, "user_id": 8143102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71843e230f0d76b1d30016f57daa7583?s=128&d=identicon&r=PG&f=1", "display_name": "will.mont", "link": "https://stackoverflow.com/users/8143102/will-mont"}, "edited": false, "score": 0, "creation_date": 1552448475, "post_id": 55133894, "comment_id": 97008959, "body": "@will.mont  What warnings are you rating as   &quot;silly&quot; errors&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 81, "user_id": 8143102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71843e230f0d76b1d30016f57daa7583?s=128&d=identicon&r=PG&f=1", "display_name": "will.mont", "link": "https://stackoverflow.com/users/8143102/will-mont"}, "edited": false, "score": 0, "creation_date": 1552449248, "post_id": 55133894, "comment_id": 97009127, "body": "Take advantage of UB when you can do a better job than the complier with its team of senior developers and thousands of reviews  - which is taking advantage of your code.  Remember that with each new version of the compiler you try, you will need to re-assess this gambit."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 81, "user_id": 8143102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71843e230f0d76b1d30016f57daa7583?s=128&d=identicon&r=PG&f=1", "display_name": "will.mont", "link": "https://stackoverflow.com/users/8143102/will-mont"}, "edited": false, "score": 0, "creation_date": 1552478052, "post_id": 55133894, "comment_id": 97022593, "body": "@will.mont UB may allow the compiler to do better optimization or whatever. If the result of your code is undefined, the compiler can create anything it wants. It cannot be wrong by definition. UB does not allow the developer to do any better it just gets worse code."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552483222, "post_id": 55133894, "comment_id": 97026015, "body": "And the line 34 is not UB per-se... the function is required to return. The return value is ~indeterminate. You make it sound like the omitted return is UB but not a problem ;)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552483427, "post_id": 55133894, "comment_id": 97026167, "body": "@AnttiHaapala The non-UB-ness of line 34 detailed."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1552569743, "last_edit_date": 1552569743, "creation_date": 1552447620, "answer_id": 55133894, "question_id": 55133382, "link": "https://stackoverflow.com/questions/55133382/c-printf-specifier-with-variadic-arguments-at-which-point-is-the-undefined-beha/55133894#55133894", "title": "C printf specifier with variadic arguments. At which point is the undefined behavior problematic?", "body": "<blockquote>\n  <p>At which point is the undefined behavior problematic?</p>\n</blockquote>\n\n<p><strong>All</strong> UB is problematic.</p>\n\n<p>Identifying  a particular compiler version's UB effects has some merit in problem solving.  Yet one should never rely on that UB effect to persist.</p>\n\n<p>My answer is based on C in general, not on gcc 4.7.</p>\n\n<hr>\n\n<p>Consider that objects are not necessarily passed using the same mechanism across types.  <a href=\"https://stackoverflow.com/q/55157193/2410359\">Related true example</a>: <code>float/double</code> passed in a FP stack and other types via the usual stack.  <code>printf(\"%llx\\n\", 1.234);</code> can fail badly, even though the size passed is 8 and 8 is expected, yet they are in different places.  A similar difference could occurs between pointer types and integers (although that sounds like a unicorn platform).</p>\n\n<hr>\n\n<p>Leaving UB in code in inefficient in development.<br>\nConsider if one did find some UB that worked great  in a select case, the next compilation or version may render different results.  By fixing, you   save time not trying to explained how \"this UB is OK, I know I tested it\" during a code review.  Also save time not needing  to find a way to quiet the warning of this one \"good\" UB.  The programming team that has to maintain your UB code will mutter evil things about the prior coder.</p>\n\n<hr>\n\n<p>UB Missing matching argument.</p>\n\n<pre><code>custom_printf(\"HI THERE%d\");\n&lt;source&gt;:26:5: warning: format '%d' expects a matching 'int' argument [-Wformat]\n</code></pre>\n\n<hr>\n\n<p>Not UB. Extra args are OK, yet likely is a coding mis-step - hence the warning. <a href=\"https://stackoverflow.com/questions/55133382/c-printf-specifier-with-variadic-arguments-at-which-point-is-the-undefined-beha#comment97008016_55133382\">@melpomene</a></p>\n\n<pre><code>custom_printf(\"HI THERE\", 1);\n&lt;source&gt;:27:5: warning: too many arguments for format [-Wformat-extra-args]\n</code></pre>\n\n<hr>\n\n<p>UB.  <code>int</code>and <code>void *</code> may different size, legal values and function passing mechanisms,</p>\n\n<pre><code>custom_printf(\"val: %d\", (void*)0);\n&lt;source&gt;:28:5: warning: format '%d' expects argument of type 'int', but argument 2 has type 'void *' [-Wformat]\n</code></pre>\n\n<hr>\n\n<p>UB.  same as line 28</p>\n\n<pre><code>custom_printf(\"val: %p\", 0);\n&lt;source&gt;:29:5: warning: format '%p' expects argument of type 'void *', but argument 2 has type 'int' [-Wformat]\n</code></pre>\n\n<hr>\n\n<p>UB.  <code>int</code>and <code>long long</code> may different size and function passing mechanisms,</p>\n\n<pre><code>custom_printf(\"val: %lld\", 1);\n&lt;source&gt;:30:5: warning: format '%lld' expects argument of type 'long long int', but argument 2 has type 'int' [-Wformat]\n</code></pre>\n\n<hr>\n\n<p>UB.  Types may different in size, legal values and function passing mechanisms,</p>\n\n<pre><code>custom_printf(\"val: %s\", (THING){\"A\", \"AA\", \"CCCC\"});\n&lt;source&gt;:31:5: warning: format '%s' expects argument of type 'char *', but argument 2 has type 'THING' [-Wformat]\n</code></pre>\n\n<hr>\n\n<p>UB: Invalid standard specifier <code>%0.30s</code>, anything may happen.  Well behaved on select systems that define behavior for this non-standard specifier.</p>\n\n<pre><code>custom_printf(\"val: %0.30s\",\"HI\");\n&lt;source&gt;:32:5: warning: '0' flag used with '%s' gnu_printf format [-Wformat]\n</code></pre>\n\n<hr>\n\n<p>UB like line 30</p>\n\n<pre><code>custom_printf(\"val: %d\",LLONG_MAX);\n&lt;source&gt;:33:5: warning: format '%d' expects argument of type 'int', but argument 2 has type 'long long int' [-Wformat]\n</code></pre>\n\n<hr>\n\n<p>Not UB with <code>main()</code>.  Only a UB problem with functions in general if calling code use the return value.  Yet <code>main()</code> is special in that code acts as if a <code>return 0;</code> was at the end - if that function does not end with a <code>return</code>.</p>\n\n<pre><code>&lt;source&gt;:34:1: warning: control reaches end of non-void function [-Wreturn-type]\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 8143102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71843e230f0d76b1d30016f57daa7583?s=128&d=identicon&r=PG&f=1", "display_name": "will.mont", "link": "https://stackoverflow.com/users/8143102/will-mont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552569743, "creation_date": 1552443531, "question_id": 55133382, "link": "https://stackoverflow.com/questions/55133382/c-printf-specifier-with-variadic-arguments-at-which-point-is-the-undefined-beha", "title": "C printf specifier with variadic arguments. At which point is the undefined behavior problematic?", "body": "<p><a href=\"https://godbolt.org/z/qZVO3a\" rel=\"nofollow noreferrer\">https://godbolt.org/z/qZVO3a</a></p>\n\n<p>This is a minimal reproduction of the warnings I see. Obviously UB can be bad, but I think while many of the below situations are okay, there's some really nasty uses and I need to determine which require corrective action.</p>\n\n<pre><code>#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;limits.h&gt;\n\ntypedef struct _thing {\n\n    char  first[4];\n    char  second[10];\n    char  last[111];\n}THING;\n\n\nvoid custom_printf(char* _format, ...) __attribute__((format(printf, 1,2)));\nvoid custom_printf(char* _format, ...) \n{\n    // get buffer from some source\n    char buffer[1024];\n    va_list ap;\n    va_start(ap, _format);\n    vsnprintf(buffer, 1024, _format, ap);\n    va_end(ap);\n    // use buffer for some purpose\n\n}\n\nint main(){\n\n    custom_printf(\"HI THERE%d\");\n    custom_printf(\"HI THERE\", 1);\n    custom_printf(\"val: %d\", (void*)0);\n    custom_printf(\"val: %p\", 0);\n    custom_printf(\"val: %lld\", 1);\n    custom_printf(\"val: %s\", (THING){\"A\", \"AA\", \"CCCC\"});\n    custom_printf(\"val: %0.30s\",\"HI\");\n    custom_printf(\"val: %d\",LLONG_MAX);\n}\n</code></pre>\n\n<p>The warnings see include:</p>\n\n<pre><code>\n&lt;source&gt;: In function 'main':\n\n&lt;source&gt;:26:5: warning: format '%d' expects a matching 'int' argument [-Wformat]\n\n&lt;source&gt;:27:5: warning: too many arguments for format [-Wformat-extra-args]\n\n&lt;source&gt;:28:5: warning: format '%d' expects argument of type 'int', but argument 2 has type 'void *' [-Wformat]\n\n&lt;source&gt;:29:5: warning: format '%p' expects argument of type 'void *', but argument 2 has type 'int' [-Wformat]\n\n&lt;source&gt;:30:5: warning: format '%lld' expects argument of type 'long long int', but argument 2 has type 'int' [-Wformat]\n\n&lt;source&gt;:31:5: warning: format '%s' expects argument of type 'char *', but argument 2 has type 'THING' [-Wformat]\n\n&lt;source&gt;:32:5: warning: '0' flag used with '%s' gnu_printf format [-Wformat]\n\n&lt;source&gt;:33:5: warning: format '%d' expects argument of type 'int', but argument 2 has type 'long long int' [-Wformat]\n\n&lt;source&gt;:34:1: warning: control reaches end of non-void function [-Wreturn-type]\n\nCompiler returned: 0\n</code></pre>\n\n<p>It's my understanding that the above has many flavors of UB here. After looking around I've seen that I should just fix the above. Now I want to eventually fix them all, but for now my curiousity is making me wonder which is the worst scenario. I'd assume that cases like the first where I'm not passing in enough items. </p>\n\n<p>It's my understanding that in the above I have:</p>\n\n<ol>\n<li>Popping off stack that doesn't exist</li>\n<li>Not popping enough off the stack</li>\n<li>Padding a string with leading zeros</li>\n<li>Casting integer to pointer</li>\n<li>Casting a struct that can be cased to</li>\n</ol>\n\n<p>Out of the above I'm fairly certain that anything that pops off the stack that doesn't exist will lead to the worst scenario. But I'm also wondering what the other severe cases are. </p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 2, "creation_date": 1552440416, "post_id": 55132984, "comment_id": 97007368, "body": "What are you expecting the program to do when you write to some arbitrarily selected memory location?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1552441085, "post_id": 55132984, "comment_id": 97007505, "body": "What are you expecting the program to do?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1552441149, "post_id": 55132984, "comment_id": 97007521, "body": "It probably runs like this:... <code>ip = (int*)1000; *ip = 5; (SegFault)</code>"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1552441215, "post_id": 55132984, "comment_id": 97007541, "body": "It is crashing because you&#39;re accessing memory you should not have access to."}], "answers": [{"tags": [], "owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "is_accepted": true, "score": 2, "last_activity_date": 1552443250, "creation_date": 1552443250, "answer_id": 55133345, "question_id": 55132984, "link": "https://stackoverflow.com/questions/55132984/pointer-assignment-to-r-value-in-c/55133345#55133345", "title": "Pointer assignment to r-value in c", "body": "<p>In most cases a pointer is just an address of data in memory. There are certain considerations about which addresses of memory are accessible and which are not, which addresses are are used by code and by data, ... the memory space is segmented, meaning that some address are not even available.</p>\n\n<p>you have declared a pointer <code>int *ip;</code> Then you assigned it a value of <code>1000</code>. The latter is supposed to be an address of some data in memory. Why 1000? it could be a memory address which is inaccessible or a memory address of a some other data or a memory address of code of your program. In general, unless you write an system-level software, you cannot do any assumption about hard-coded addresses in memory. You can only rely on the addresses provided by your program. So, your attempt to assign a value to the memory of address 1000 ended up in a segmentation fault, meaning this address is not available for you.</p>\n\n<p>There are several ways to use pointers correctly.</p>\n\n<p>1) use an address of an existing variable:</p>\n\n<pre><code> int var;\n int *ip = &amp;var;\n *ip = 5;\n</code></pre>\n\n<p>2) use an address of dynamically allocated memory returned to you, say by <code>malloc</code></p>\n\n<pre><code> int *ip = malloc(sizeof(int));\n *ip = 5;\n ...\n free(ip);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11194238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d027ec96ada905cfba4b72d5a6d5d2d3?s=128&d=identicon&r=PG&f=1", "display_name": "ICTer", "link": "https://stackoverflow.com/users/11194238/icter"}, "is_accepted": false, "score": 0, "last_activity_date": 1552633627, "last_edit_date": 1552633627, "creation_date": 1552547583, "answer_id": 55156820, "question_id": 55132984, "link": "https://stackoverflow.com/questions/55132984/pointer-assignment-to-r-value-in-c/55156820#55156820", "title": "Pointer assignment to r-value in c", "body": "<p>But the following assignment appears to be OK:</p>\n\n<pre><code>char *ptr;\n\nptr = \"Input a string: \";\nprintf(\"%s\", ptr);\n</code></pre>\n\n<p>There are some differences between r-value of numeric type and that of string?</p>\n\n<p>Actually I found this helpful:\n<a href=\"https://stackoverflow.com/questions/31548263/in-c-why-cant-an-integer-value-be-assigned-to-an-int-the-same-way-a-string-va\">In C, why can&#39;t an integer value be assigned to an int* the same way a string value can be assigned to a char*?</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11194238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d027ec96ada905cfba4b72d5a6d5d2d3?s=128&d=identicon&r=PG&f=1", "display_name": "ICTer", "link": "https://stackoverflow.com/users/11194238/icter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 55133345, "answer_count": 2, "score": -4, "last_activity_date": 1552633627, "creation_date": 1552440054, "question_id": 55132984, "link": "https://stackoverflow.com/questions/55132984/pointer-assignment-to-r-value-in-c", "title": "Pointer assignment to r-value in c", "body": "<p>Could anybody help to explain why running the execution file (built from the following C program using Dev-C++ 5.6.3) causes crash? There are some explanation in Pradip Dey and Ghosh Manas 2013 Computer fundamentals and programming in C that says \"Location 1000 might contain the program. Since it is a read only, the operating system will throw up a segmentation fault. What about *pi = 5? Again, it will most likely cause a segmentation fault because lower memory addresses are typically used for program code. This area is only read. It should be known in advance where this constant is located in the memory.\"</p>\n\n<p>However, to me, these explanation are difficult to understand</p>\n\n<pre><code>int main()\n{\n    int *ip;\n\n    ip = (int*)1000;\n    *ip = 5;\n}\n</code></pre>\n"}, {"tags": ["c#", "c"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1552438280, "post_id": 55132739, "comment_id": 97006952, "body": "That code is not obscure or incomplete. What specific problems are you having porting it?"}, {"owner": {"reputation": 4665, "user_id": 1447389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQhtr.jpg?s=128&g=1", "display_name": "Soleil", "link": "https://stackoverflow.com/users/1447389/soleil"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1552438489, "post_id": 55132739, "comment_id": 97006993, "body": "@KenWhite Nowhere we can see how was created <code>DeviceList</code> from <code>DeviceList[DeviceIndex].Handle</code>; I see <code>goto exit;</code> without the code corresponding."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1552438922, "post_id": 55132739, "comment_id": 97007076, "body": "The documentation for DeviceIOControl tells you what that first parameter is, and the sample code simply uses an array of handles in <code>DeviceList</code>. Is your question about getting a list of NVMe drives, or about getting the temperature? It can&#39;t be about both, because that&#39;s two separate questions."}, {"owner": {"reputation": 4665, "user_id": 1447389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQhtr.jpg?s=128&g=1", "display_name": "Soleil", "link": "https://stackoverflow.com/users/1447389/soleil"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1552439758, "post_id": 55132739, "comment_id": 97007251, "body": "It&#39;s not clear nor obvious at all how we get those handles for NVMe drives. If it is for you, please post an answer. I see I can create the handle with CreateFileA (<a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createfilea\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/api/fileapi/&hellip;</a>), but there is nothing to get NVMe handles."}], "answers": [{"tags": [], "owner": {"reputation": 4665, "user_id": 1447389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQhtr.jpg?s=128&g=1", "display_name": "Soleil", "link": "https://stackoverflow.com/users/1447389/soleil"}, "is_accepted": true, "score": 0, "last_activity_date": 1552998311, "creation_date": 1552998311, "answer_id": 55241041, "question_id": 55132739, "link": "https://stackoverflow.com/questions/55132739/how-do-i-enumerate-nvme-m2-drives-an-get-their-temperature-in-c/55241041#55241041", "title": "How do I enumerate NVMe (M2) drives an get their temperature in c#?", "body": "<p>A fast implementation (but not the simplest) is to use the nvme.h winioctl.h ntddstor.h API and interop with that in c#. Here is a complete implementation.</p>\n\n<p>Declaration side:</p>\n\n<pre><code>#include &lt;nvme.h&gt;\n#include &lt;winioctl.h&gt;\n#include &lt;ntddstor.h&gt;\n\n#ifndef Pinvoke\n#define Pinvoke extern \"C\" __declspec(dllexport)\n#endif\n\ntypedef void(__stdcall *MessageChangedCallback)(const wchar_t* string);\n\nclass __declspec(dllexport) NVmeQuery final\n{\npublic:\n    NVmeQuery(MessageChangedCallback managedDelegate);\n    ~NVmeQuery();\n    template &lt;class ... T&gt;\n    auto LogMessage(T&amp;&amp; ... args) -&gt; void;\n    auto GetTemp(const wchar_t* nvmePath) -&gt; unsigned long;\n\n    MessageChangedCallback LogMessageChangedCallback{};\n\n    PNVME_HEALTH_INFO_LOG SmartHealthInfo{};\n    PSTORAGE_PROPERTY_QUERY query{};\n    PSTORAGE_PROTOCOL_SPECIFIC_DATA protocolSpecificData{};\n    PSTORAGE_PROTOCOL_DATA_DESCRIPTOR protocolDataDescriptor{};\n};\n</code></pre>\n\n<p>Definition side:\nA function I use to retro-interop error messages to the managed side; it is critical for the understanding of what goes wrong, how/where:</p>\n\n<pre><code>template&lt;class ...T&gt;\nauto NVmeQuery::LogMessage(T&amp;&amp;... args) -&gt; void\n{\n    wchar_t updatedMessage[256];\n    swprintf_s(updatedMessage, forward&lt;T&gt;(args)...);\n    if (LogMessageChangedCallback != nullptr)\n        LogMessageChangedCallback(updatedMessage);\n}\n</code></pre>\n\n<p>The core function, which was not straightforward to design. It has 4 parts:\n 1. getting a handle to the NVMe drive\n 2. preparing the query\n 3. do the query\n 4. check and transmit results</p>\n\n<pre><code>auto NVmeQuery::GetTemp(const wchar_t* nvmePath) -&gt; unsigned long\n{\n    auto nvmeHandle = CreateFile(nvmePath, 0, 0,\n        0, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0);\n    {\n        auto lastErrorID = GetLastError();\n        if (lastErrorID != 0)\n        {\n            LPVOID errorBuffer{};\n            FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,\n                nullptr, lastErrorID, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), (LPTSTR)&amp;errorBuffer, 0, nullptr);\n            LogMessage(L\"Query: ERROR creating handle to NVMe [%s]: %d, %s\", nvmePath, lastErrorID, errorBuffer);\n        }\n    }\n\n    unsigned long bufferLength = FIELD_OFFSET(STORAGE_PROPERTY_QUERY, AdditionalParameters)\n        + sizeof(STORAGE_PROTOCOL_SPECIFIC_DATA) + NVME_MAX_LOG_SIZE;\n    void *buffer = malloc(bufferLength);\n    ZeroMemory(buffer, bufferLength);\n\n    query = (PSTORAGE_PROPERTY_QUERY)buffer;\n    protocolDataDescriptor = (PSTORAGE_PROTOCOL_DATA_DESCRIPTOR)buffer;\n    protocolSpecificData = (PSTORAGE_PROTOCOL_SPECIFIC_DATA)query-&gt;AdditionalParameters;\n\n    query-&gt;PropertyId = StorageDeviceProtocolSpecificProperty;\n    query-&gt;QueryType = PropertyStandardQuery;\n\n    protocolSpecificData-&gt;ProtocolType = ProtocolTypeNvme;\n    protocolSpecificData-&gt;DataType = NVMeDataTypeLogPage;\n    protocolSpecificData-&gt;ProtocolDataRequestValue = NVME_LOG_PAGE_HEALTH_INFO;\n    protocolSpecificData-&gt;ProtocolDataRequestSubValue = 0;\n    protocolSpecificData-&gt;ProtocolDataOffset = sizeof(STORAGE_PROTOCOL_SPECIFIC_DATA);\n    protocolSpecificData-&gt;ProtocolDataLength = sizeof(NVME_HEALTH_INFO_LOG);\n\n    unsigned long returnedLength{};\n</code></pre>\n\n<p>continuing, the actual query and then the miscellaneous checkings:</p>\n\n<pre><code>    auto result = DeviceIoControl(nvmeHandle, IOCTL_STORAGE_QUERY_PROPERTY,\n        buffer, bufferLength,\n        buffer, bufferLength,\n        &amp;returnedLength, nullptr);\n\n    if (!result || returnedLength == 0)\n    {\n        auto lastErrorID = GetLastError();\n        LPVOID errorBuffer{};\n        FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,\n            nullptr, lastErrorID, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), (LPTSTR)&amp;errorBuffer, 0, nullptr);\n        LogMessage(L\"Query: drive path: %s, nvmeHandle %lu\", nvmePath, nvmeHandle);\n        LogMessage(L\"Query: ERROR DeviceIoControl 0x%x %s\", lastErrorID, errorBuffer);\n    }\n\n    if (protocolDataDescriptor-&gt;Version != sizeof(STORAGE_PROTOCOL_DATA_DESCRIPTOR) ||\n        protocolDataDescriptor-&gt;Size != sizeof(STORAGE_PROTOCOL_DATA_DESCRIPTOR))\n    {\n        LogMessage(L\"Query: Data descriptor header not valid (size of descriptor: %llu)\", sizeof(STORAGE_PROTOCOL_DATA_DESCRIPTOR));\n        LogMessage(L\"Query: DataDesc: version %lu, size %lu\", protocolDataDescriptor-&gt;Version, protocolDataDescriptor-&gt;Size);\n    }\n\n    protocolSpecificData = &amp;protocolDataDescriptor-&gt;ProtocolSpecificData;\n    if (protocolSpecificData-&gt;ProtocolDataOffset &lt; sizeof(STORAGE_PROTOCOL_SPECIFIC_DATA) ||\n        protocolSpecificData-&gt;ProtocolDataLength &lt; sizeof(NVME_HEALTH_INFO_LOG))\n        LogMessage(L\"Query: ProtocolData Offset/Length not valid\");\n\n    SmartHealthInfo = (PNVME_HEALTH_INFO_LOG)((PCHAR)protocolSpecificData + protocolSpecificData-&gt;ProtocolDataOffset);\n    CloseHandle(nvmeHandle);\n    auto temp = ((ULONG)SmartHealthInfo-&gt;Temperature[1] &lt;&lt; 8 | SmartHealthInfo-&gt;Temperature[0]) - 273;\n    return temp;\n} // end of GetTemp\n</code></pre>\n\n<p>And for the interop:</p>\n\n<pre><code>Pinvoke auto __stdcall New(MessageChangedCallback managedDelegate) -&gt; NVmeQuery*\n{\n    return new NVmeQuery(managedDelegate);\n}\n\nPinvoke auto GetTemp(NVmeQuery* p, const wchar_t* nvmePath) -&gt; unsigned long\n{\n    return p-&gt;GetTemp(nvmePath);\n}\n</code></pre>\n\n<p>And c# side:</p>\n\n<pre><code>public static class NVMeQuery\n{\n    [DllImport(\"NVMeQuery.dll\", CallingConvention = CallingConvention.StdCall)]\n    internal static extern IntPtr New(InteropBase.AssetCallback callback);\n    [DllImport(\"NVMeQuery.dll\", CallingConvention = CallingConvention.Cdecl)]\n    internal static extern ulong GetTemp(IntPtr p, IntPtr drivePath);\n}\n\npublic class NVMeQueries : InteropBase\n{\n    public NVMeQueries()\n    {\n        _ptr = NVMeQuery.New(_onAssetErrorMessageChanged);\n    }\n\n    public ulong GetTemp() =&gt; GetTemp(@\"\\\\.\\PhysicalDrive4\");\n\n    public ulong GetTemp(string drivePath)\n    {\n        var strPtr = Marshal.StringToHGlobalAuto(drivePath);\n        var result = NVMeQuery.GetTemp(_ptr, strPtr);\n        Marshal.FreeHGlobal(strPtr);\n        return result;\n    }\n}\n</code></pre>\n\n<p>And the generic base class I use for interop:</p>\n\n<pre><code>public class InteropBase : INotifyPropertyChanged\n{\n    protected IntPtr _ptr;\n    protected readonly AssetCallback _onAssetErrorMessageChanged;\n\n    public delegate void AssetCallback(IntPtr strPtr);\n\n    public List&lt;string&gt; LogMessages { get; private set; } = new List&lt;string&gt;();\n\n    public InteropBase()\n    {\n        _onAssetErrorMessageChanged = LogUpdater;\n    }\n\n    private unsafe void LogUpdater(IntPtr strPtr)\n    {\n        var LastLogMessage = new string((char*)strPtr);\n        LogMessages.Add(LastLogMessage);\n        OnPropertyChanged(nameof(LogMessages));\n    }\n\n    public event PropertyChangedEventHandler PropertyChanged;\n\n    [NotifyPropertyChangedInvocator]\n    protected virtual void OnPropertyChanged([CallerMemberName] string propertyName = null)\n    {\n        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));\n    }\n}\n</code></pre>\n\n<p>In my case, the NVMe drive I wanted to query was the 4th physical drive. We get all of them with:</p>\n\n<pre><code>Get-WmiObject Win32_DiskDrive\n</code></pre>\n\n<p>which will give in my case:</p>\n\n<pre><code>Partitions : 4\nDeviceID   : \\\\.\\PHYSICALDRIVE4\nModel      : Samsung SSD 970 EVO Plus 1TB\nSize       : 1000202273280\nCaption    : Samsung SSD 970 EVO Plus 1TB\n</code></pre>\n\n<h2>Remarks</h2>\n\n<p>This implementation is extremely fast (less that 1ms when there is no LogMessage call); you can define and fill your own structure to get other pieces of information that would be relevant; in that case, the structure must be hold in a field in the native class (eg., <code>SmartHealthInfo</code> in this example) and the query would transmit just the pointer to this structure.</p>\n"}], "owner": {"reputation": 4665, "user_id": 1447389, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQhtr.jpg?s=128&g=1", "display_name": "Soleil", "link": "https://stackoverflow.com/users/1447389/soleil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "accepted_answer_id": 55241041, "answer_count": 1, "score": 0, "last_activity_date": 1552998311, "creation_date": 1552437902, "last_edit_date": 1552438564, "question_id": 55132739, "link": "https://stackoverflow.com/questions/55132739/how-do-i-enumerate-nvme-m2-drives-an-get-their-temperature-in-c", "title": "How do I enumerate NVMe (M2) drives an get their temperature in c#?", "body": "<p>How do I enumerate NVMe (M2) drives an get their temperature in c# ?</p>\n\n<p>It's not accessible through WMI usual queries.</p>\n\n<p>There this MSFT reference to do this in c, but it's rather obscure, code is not complete:\n<a href=\"https://docs.microsoft.com/en-us/windows/desktop/fileio/working-with-nvme-devices#temperature-queries\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/desktop/fileio/working-with-nvme-devices#temperature-queries</a></p>\n"}, {"tags": ["c", "pthreads", "semaphore"], "comments": [{"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1552434741, "post_id": 55132323, "comment_id": 97006202, "body": "Unable to reproduce. The code looks OK to me offhand."}, {"owner": {"reputation": 11771, "user_id": 1275653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb781e5bd49c5d403228b98859d8b6dd?s=128&d=identicon&r=PG", "display_name": "thb", "link": "https://stackoverflow.com/users/1275653/thb"}, "edited": false, "score": 0, "creation_date": 1552435558, "post_id": 55132323, "comment_id": 97006366, "body": "I also have not been able to reproduce, but just to eliminate one possible problem, try <code>sem_init(&amp;mutex, 0, 0);</code>. If this changes the behavior, let us know."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1552435829, "post_id": 55132323, "comment_id": 97006445, "body": "what happens if you compile with a C compiler, like gcc instead of a C++ compiler?"}, {"owner": {"reputation": 1664, "user_id": 4498684, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4e2358d03574462e1a4b1c44de24853?s=128&d=identicon&r=PG&f=1", "display_name": "TheStrangeQuark", "link": "https://stackoverflow.com/users/4498684/thestrangequark"}, "reply_to_user": {"reputation": 11771, "user_id": 1275653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb781e5bd49c5d403228b98859d8b6dd?s=128&d=identicon&r=PG", "display_name": "thb", "link": "https://stackoverflow.com/users/1275653/thb"}, "edited": false, "score": 1, "creation_date": 1552436035, "post_id": 55132323, "comment_id": 97006500, "body": "@thb Making that change gives the same results"}, {"owner": {"reputation": 1664, "user_id": 4498684, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4e2358d03574462e1a4b1c44de24853?s=128&d=identicon&r=PG&f=1", "display_name": "TheStrangeQuark", "link": "https://stackoverflow.com/users/4498684/thestrangequark"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1552436065, "post_id": 55132323, "comment_id": 97006508, "body": "@bruceg Compiling with gcc produces the same results"}, {"owner": {"reputation": 11771, "user_id": 1275653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb781e5bd49c5d403228b98859d8b6dd?s=128&d=identicon&r=PG", "display_name": "thb", "link": "https://stackoverflow.com/users/1275653/thb"}, "edited": false, "score": 0, "creation_date": 1552436499, "post_id": 55132323, "comment_id": 97006621, "body": "+1 I notice no other potential problems. Interesting. Like you, I shall be glad to read the answer when it appears."}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1552436848, "post_id": 55132323, "comment_id": 97006694, "body": "What operating system and version of gcc are you using?"}, {"owner": {"reputation": 1664, "user_id": 4498684, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4e2358d03574462e1a4b1c44de24853?s=128&d=identicon&r=PG&f=1", "display_name": "TheStrangeQuark", "link": "https://stackoverflow.com/users/4498684/thestrangequark"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1552437252, "post_id": 55132323, "comment_id": 97006779, "body": "@bruceg MacOS Mojave 10.14.2, gcc and g++ both say  <code>Configured with: --prefix=&#47;Library&#47;Developer&#47;CommandLineTools&#47;usr --with-gxx-include-dir=&#47;usr&#47;include&#47;c++&#47;4.2.1   Apple LLVM version 10.0.0 (clang-1000.10.44.4)   Target: x86_64-apple-darwin18.2.0   Thread model: posix   InstalledDir: &#47;Library&#47;Developer&#47;CommandLineTools&#47;usr&#47;bin</code>"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1552437395, "post_id": 55132323, "comment_id": 97006803, "body": "yeah... in MacOS <code>gcc</code> and <code>g++</code> are both aliases for the Mac compiler suite. I can&#39;t repro on my linux box. Hope someone else has a Mac."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1552437410, "post_id": 55132323, "comment_id": 97006807, "body": "What is <code>sem_getvalue()</code> returning in both cases?  If it&#39;s returning non-zero, what is <code>errno</code>? <code>sem_getvalue()</code> on a Mac seems to be troublesome.  See <a href=\"https://stackoverflow.com/questions/16655153/sem-getvalue-dysfunctionality-in-mac-os-x-c\" title=\"sem getvalue dysfunctionality in mac os x c\">stackoverflow.com/questions/16655153/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/23146950/c-semaphore-sem-getvalue-not-returning-what-im-expecting\" title=\"c semaphore sem getvalue not returning what im expecting\">stackoverflow.com/questions/23146950/&hellip;</a>"}, {"owner": {"reputation": 1664, "user_id": 4498684, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4e2358d03574462e1a4b1c44de24853?s=128&d=identicon&r=PG&f=1", "display_name": "TheStrangeQuark", "link": "https://stackoverflow.com/users/4498684/thestrangequark"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1552437655, "post_id": 55132323, "comment_id": 97006851, "body": "@AndrewHenle Good idea. It returned -1 and <code>errno</code> is set to 78 in both the cases. It appears this means the function isn&#39;t set. Interesting."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1552437969, "post_id": 55132323, "comment_id": 97006906, "body": "@TheStrangeQuark When compiling with gcc or clang, you should always use the <code>-Wall</code> option."}, {"owner": {"reputation": 11771, "user_id": 1275653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb781e5bd49c5d403228b98859d8b6dd?s=128&d=identicon&r=PG", "display_name": "thb", "link": "https://stackoverflow.com/users/1275653/thb"}, "edited": false, "score": 0, "creation_date": 1552438005, "post_id": 55132323, "comment_id": 97006911, "body": "For information, on my machine (Debian GNU/Linux 9, GCC 6.3, Pthreads 2.24), it returned 0 and <code>errno</code> is set to 0 in both the cases. Also for information, I am compiling with <code>-Wall</code> and, indeed, also with <code>-Wextra -Werror</code>."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1552438104, "post_id": 55132323, "comment_id": 97006920, "body": "If you actually need a mutex (not a counting semaphore), take a look at <code>pthread_mutex_create</code>, <code>pthread_mutex_lock</code> and <code>pthread_mutex_unlock</code>."}, {"owner": {"reputation": 1664, "user_id": 4498684, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4e2358d03574462e1a4b1c44de24853?s=128&d=identicon&r=PG&f=1", "display_name": "TheStrangeQuark", "link": "https://stackoverflow.com/users/4498684/thestrangequark"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1552438565, "post_id": 55132323, "comment_id": 97007012, "body": "Running this on Linux works fine. @user3386109 is correct that they are deprecated and I should not be using them. Thanks everyone"}], "answers": [{"comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1552438462, "post_id": 55132711, "comment_id": 97006991, "body": "What OP failed to notice is that <code>sem_init</code> and <code>sem_getvalue</code> are deprecated on MacOS. Compiling with <code>-Wall</code> would have made that abundantly clear.  The functions are just stubs that set <code>errno</code> and return."}], "tags": [], "owner": {"reputation": 11771, "user_id": 1275653, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb781e5bd49c5d403228b98859d8b6dd?s=128&d=identicon&r=PG", "display_name": "thb", "link": "https://stackoverflow.com/users/1275653/thb"}, "is_accepted": false, "score": 0, "last_activity_date": 1552438580, "last_edit_date": 1552438580, "creation_date": 1552437653, "answer_id": 55132711, "question_id": 55132323, "link": "https://stackoverflow.com/questions/55132323/semaphore-value-in-function-inside-thread-function-inconsistent/55132711#55132711", "title": "Semaphore value in function inside thread function inconsistent", "body": "<p>I do not know why your code fails. Unfortunately for our present purpose, your code succeeds on my machine.</p>\n\n<p>Until someone else posts a proper answer, if you would like to try a few debugging ideas with me, at your option, we can try the following.</p>\n\n<p>1.\nTry the suggestion of @AndrewHenle: \"What is <code>sem_getvalue()</code> returning in both cases? If it's returning non-zero, what is <code>errno</code>?\"</p>\n\n<p>For information, on my machine (Debian GNU/Linux 9, GCC 6.3, Pthreads 2.24), it returns zero and <code>errno</code> is also zero.</p>\n\n<p>2.\nTry changing</p>\n\n<pre><code>sem_t mutex;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>volatile unsigned char buffer_before_mutex[0x1000];\nsem_t mutex;\nvolatile unsigned char buffer_after_mutex[0x1000];\n</code></pre>\n\n<p>Reason: if something is overwriting your mutex on the stack, this might give it some empty space to overwrite instead of trashing the mutex. Even if this works (and I suspect that it won't), it will not be right; but it might afford a clue as to what is going wrong with your code.</p>\n\n<p>3.\n(My answer may have been overtaken by comments. I leave the answer here in case part of it proves useful nevertheless.)</p>\n"}], "owner": {"reputation": 1664, "user_id": 4498684, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e4e2358d03574462e1a4b1c44de24853?s=128&d=identicon&r=PG&f=1", "display_name": "TheStrangeQuark", "link": "https://stackoverflow.com/users/4498684/thestrangequark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552438580, "creation_date": 1552434328, "question_id": 55132323, "link": "https://stackoverflow.com/questions/55132323/semaphore-value-in-function-inside-thread-function-inconsistent", "title": "Semaphore value in function inside thread function inconsistent", "body": "<p>I've been learning how to use <code>pthreads</code> and mutexes, and am confused about the output of the following C code:</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid *TestThread(void *);\nvoid TestFunc();\n\nsem_t mutex;\n\nint main(int argc, char *argv[]) {\n    pthread_t tid;\n    sem_init(&amp;mutex, 1, 0);\n    pthread_create(&amp;tid, NULL, TestThread, NULL);\n    pthread_join(tid, NULL);\n}\n\nvoid *TestThread(void *arg) {\n    int val;\n    sem_getvalue(&amp;mutex, &amp;val);\n    printf(\"value of mutex in Thread function: %d\\n\", val);\n    TestFunc();\n    pthread_exit(NULL);\n}\n\nvoid TestFunc() {\n    int val;\n    sem_getvalue(&amp;mutex, &amp;val);\n    printf(\"value of mutex in function in Thread function: %d\\n\", val);\n}\n</code></pre>\n\n<p>I'm then compiling this like <code>g++ -lpthread mutexTest.c -o mutexTest</code> and running with <code>./mutexText</code>, which gives and output like</p>\n\n<pre><code>value of mutex in Thread function: 0\nvalue of mutex in function in Thread function: 1754151134\n</code></pre>\n\n<p>Why is the mutex value changing in the function that I call within the thread? Did I lose the reference to the mutex somehow?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1552434551, "post_id": 55132317, "comment_id": 97006144, "body": "&quot;For every element in the array [0..n), if the current element value is larger than [or equal, depending on exact interpretation] the previous element then the &#39;downward sequence&#39; is violated at the current element value/index.&quot; -- not quite sure why there is upward/downward/rightward code shown; although the same principal holds."}, {"owner": {"reputation": 13, "user_id": 11194072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbdf1ff9cfbc478df299d97d9c04aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Vgeorgy", "link": "https://stackoverflow.com/users/11194072/vgeorgy"}, "reply_to_user": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1552434682, "post_id": 55132317, "comment_id": 97006176, "body": "I don&#39;t have a clue how to solve this thing. But this task have to be done till tomorrow..."}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1552434719, "post_id": 55132317, "comment_id": 97006190, "body": "The above mostly does that.. it needs to have the &quot;is downward&quot; to be turned into a function.. there is lots of extra code that is muddling up the task."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1552434738, "post_id": 55132317, "comment_id": 97006200, "body": "Hi and welcome to SO. While I feel sympathy for the predicament you are in, the urgency of your problem is of no concern on this site. This is supposed to be a repository of QA that is as much as possible timeless."}, {"owner": {"reputation": 13, "user_id": 11194072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbdf1ff9cfbc478df299d97d9c04aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Vgeorgy", "link": "https://stackoverflow.com/users/11194072/vgeorgy"}, "edited": false, "score": 0, "creation_date": 1552434768, "post_id": 55132317, "comment_id": 97006205, "body": "May you help me with solving this?"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1552434934, "post_id": 55132317, "comment_id": 97006245, "body": "You need to ask a specific problem. &quot; i don&#39;t have a clue how to do it&quot; is off-topic here. Ask an on-point, on-topic problem with full description of the issue and a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and we will gladly help. This site is not for fishing in the dark."}, {"owner": {"reputation": 13, "user_id": 11194072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbdf1ff9cfbc478df299d97d9c04aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Vgeorgy", "link": "https://stackoverflow.com/users/11194072/vgeorgy"}, "edited": false, "score": 0, "creation_date": 1552435064, "post_id": 55132317, "comment_id": 97006272, "body": "Ok, I do not know how to make this function &quot;function that returns 0 if the array is a downward sequence, otherwise, the number of the first number that violates the pattern. Use this function in an application that asks the user an integer N and an array of N numbers.&quot; properly. Thats why I&#39;m here, asking for help, asking someone to show me how it have to be done."}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1552435190, "post_id": 55132317, "comment_id": 97006291, "body": "so you basically have a code that works and you want to convert it into a function? Is that correct? Is is really not clear that&#39;s what you are asking from the question. Please <a href=\"https://stackoverflow.com/posts/55132317/edit\">edit</a> your question to be more clear."}, {"owner": {"reputation": 13, "user_id": 11194072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbdf1ff9cfbc478df299d97d9c04aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Vgeorgy", "link": "https://stackoverflow.com/users/11194072/vgeorgy"}, "edited": false, "score": 0, "creation_date": 1552435375, "post_id": 55132317, "comment_id": 97006330, "body": "This code doesnt work how it have to. It have to work in way i described in the body of the question. But in my code it doesnt work in such way."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552435548, "post_id": 55132317, "comment_id": 97006362, "body": "Two points to note 1) your &quot;equal values&quot; loop should check for inequality, not equality. If at the end of the loop <code>i == Length</code> then they were all equal. 2) do not call <code>main()</code>, simply <code>return</code> back to where you called the function in <code>main().</code>"}, {"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 0, "creation_date": 1552435664, "post_id": 55132317, "comment_id": 97006389, "body": "@Vgeorgy you need to show the observable behavior of your code. Please <a href=\"https://stackoverflow.com/posts/55132317/edit\">edit</a> your question to clarify it."}, {"owner": {"reputation": 13, "user_id": 11194072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbdf1ff9cfbc478df299d97d9c04aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Vgeorgy", "link": "https://stackoverflow.com/users/11194072/vgeorgy"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552435755, "post_id": 55132317, "comment_id": 97006413, "body": "@WeatherVane , may you make it and sent me the code please? Because I&#39;m too stupid to fix it by my own. I would appreciate you)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552435947, "post_id": 55132317, "comment_id": 97006475, "body": "Just change the test from <code>==</code> to <code>!=</code> and the message. It&#39;s very much like the first two tests. Then after the loop, check the iterator to know whether the loop completed, or had a <code>break</code>. Your C book will tell you how to make a function."}, {"owner": {"reputation": 13, "user_id": 11194072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbdf1ff9cfbc478df299d97d9c04aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Vgeorgy", "link": "https://stackoverflow.com/users/11194072/vgeorgy"}, "edited": false, "score": 0, "creation_date": 1552436112, "post_id": 55132317, "comment_id": 97006525, "body": "for(i=1; i&lt;Length; i++)     if (AnotherArray[i-1]!=AnotherArray[i])     {         printf(&quot;\\t(All numbers are equal!)\\n&quot;);         break;     }              Like this?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552436266, "post_id": 55132317, "comment_id": 97006559, "body": "You have to change the message too. Plainly if you changed the test from <code>==</code> to <code>!=</code> you have to change the message too. This means adding a &quot;not&quot; into that message. <code>printf(&quot;\\t(All numbers are not equal!)\\n&quot;);</code> Note: you can&#39;t test if they are all equal by breaking the loop at the first equality. But you <i>can</i> test if they are not all equal by breaking the loop at the first inequality."}, {"owner": {"reputation": 13, "user_id": 11194072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbdf1ff9cfbc478df299d97d9c04aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Vgeorgy", "link": "https://stackoverflow.com/users/11194072/vgeorgy"}, "edited": false, "score": 0, "creation_date": 1552436370, "post_id": 55132317, "comment_id": 97006588, "body": "So as i get it in this case everything should be alright, isn&#39;t it? I&#39;m asking about it because i can&#39;t check it now. Thats why i ask for code."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1552441793, "post_id": 55132317, "comment_id": 97007671, "body": "Here is skeleton code for the function. Replace all three <code>...</code> with code. The function does not need to be bigger than that. <a href=\"https://pastebin.com/PjFJ2fnE\" rel=\"nofollow noreferrer\">pastebin.com/PjFJ2fnE</a>"}], "answers": [{"tags": [], "owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "is_accepted": true, "score": 1, "last_activity_date": 1552451349, "creation_date": 1552451349, "answer_id": 55134427, "question_id": 55132317, "link": "https://stackoverflow.com/questions/55132317/function-in-c-language-arrays/55134427#55134427", "title": "Function in C language. + Arrays", "body": "<p>I don't want to do your homework for you. However, I know that it sometimes helps to see a working example. This is a really super rudimentary example, but it should help you to understand the logic behind such a problem.</p>\n\n<p>Please study this answer, rather than just submitting it as correct. You will only gain insight by learning. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\n\nconst int asc = 1;\nconst int desc = 0;\n\nint array_asc[11] = {1,2,3,4,5,6,7,8,9,10};\nint array_desc[11] = {10,9,8,7,6,5,4,3,2,1};\nint array_rand[11] = {7,3,8,4,5,1,6,2,4,4};\n\nint order_check[2] = {0, 0};\n\nint check_order(int* array){\n\n    if(array[0] &lt; (array[1])){\n        order_check[0] = asc;\n    } else if (array[1] &lt; (array[0])){\n        order_check[0] = desc;\n    } else {\n        return 1;\n    }\n    return 0;\n}\n\nint check_array(int* array, int* check){\n\n\n    switch(check[0]){\n\n        case 1: \n        for(int i = array[0]; i &lt; array[9]; i ++){\n            if(array[i] &lt; (array[i+1])){\n                continue;\n            } else {\n                return i + 1;\n            }\n        }; break;\n\n        case 0: \n        for(int i = 0; i &lt; 9; i++){\n            if(array[i] &gt; (array[i+1])){\n                continue;\n            } else {\n                return i + 1;\n            }\n        }; break;\n    }\n    return 0;\n}\n\nint main(int argc, char** argv) {\n\n    int ret;\n\n    if(check_order(array_rand) == 0){\n        if(ret = check_array(array_rand, order_check)){\n            printf(\"Order breaks at index %d\", ret);\n        } else {\n            printf(\"Array is in perfect order\");\n        }\n    } else {\n        printf(\"Array is not in order.\\n\");\n    }    \n    return (EXIT_SUCCESS);\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11194072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbdf1ff9cfbc478df299d97d9c04aa9?s=128&d=identicon&r=PG&f=1", "display_name": "Vgeorgy", "link": "https://stackoverflow.com/users/11194072/vgeorgy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1552458616, "accepted_answer_id": 55134427, "answer_count": 1, "score": -5, "last_activity_date": 1552451349, "creation_date": 1552434292, "last_edit_date": 1552434830, "question_id": 55132317, "link": "https://stackoverflow.com/questions/55132317/function-in-c-language-arrays", "closed_reason": "Needs more focus", "title": "Function in C language. + Arrays", "body": "<p>I faced a problem which I'm not able to solve by my own.</p>\n\n<p>I have to write a function that returns 0 if the array is a downward sequence, otherwise, the number of the first number that violates the pattern. Use this function in an application that asks the user an integer N and an array of N numbers.</p>\n\n<p>But i don't have a clue how to do it!</p>\n\n<p>There is my code.</p>\n\n<pre><code>int *AnotherArray;\nint i;\nint Length;\n\nsystem(\"cls\");\nprintf(\"\\t\\t put Array volume: \");\nscanf(\"%d\", &amp;Length);\nprintf(\"\\n\\n\");\n\nAnotherArray = (int*)malloc(Length * sizeof(int));\n\nfor (i = 0; i&lt;Length; i++)\n{\n    printf(\"\\t [%d] \u0415\u043b\u0435\u043c\u0435\u043d\u0442 \u043c\u0430\u0441\u0438\u0432\u0443 = \", i);\n    scanf(\"%d\", &amp;AnotherArray[i]);\n}\nprintf(\"\\n\\n\");\n\nprintf(\"\\tYour Array: \");\n\nfor (i = 0; i&lt;Length; i++)\n{\n    printf(\"%d \", AnotherArray[i]);\n}\nfor(i=1; i&lt;Length; i++)\n\n    if(AnotherArray[i-1]&gt;AnotherArray[i])\n    {\n        printf(\"\\t(From up to down!)\\n\");\n        break;\n    }\nfor(i=1; i&lt;Length; i++)\n    if (AnotherArray[i-1]&lt;AnotherArray[i])\n    {\n\n        printf(\"\\t(From down to up!)\\n\");\n        break;\n    }\nfor(i=1; i&lt;Length; i++)\n    if (AnotherArray[i-1]==AnotherArray[i])\n    {\n        printf(\"\\t(All numbers are equal!)\\n\");\n        break;\n    }\n\nprintf(\"\\t\\t\\n downward sequence stop there: \");\nprintf(\"  %d\", AnotherArray[0]);\n\nfor (i = 0; i&lt;Length; i++)\n{\n    for (i = 0; AnotherArray[i]&gt;AnotherArray[i+1]; i++)\n    {\n        printf(\"  %d\", AnotherArray[i+1]);\n    }\n\n    printf(\"\\t\\t\\n upward sequence stop there: \");\n    printf(\"  %d\", AnotherArray[0]);\n\n    for (i = 0; i&lt;Length; i++)\n    {\n        for (i = 0; AnotherArray[i]&lt;AnotherArray[i+1]; i++)\n        {\n            printf(\"  %d\", AnotherArray[i+1]);\n        }\n        free(AnotherArray);\n        printf(\"\\n\\n\\t Press 'ENTER' to back to the menu\\n\");\n        getch();\n        {\n            main();\n        }\n        return 0;\n }\n</code></pre>\n"}, {"tags": ["c", "pointers", "doubly-linked-list"], "answers": [{"comments": [{"owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1552438367, "post_id": 55132274, "comment_id": 97006972, "body": "thanks for the reply. I understand better now why my implementation was flawed. Since your answer entails modifying presumably the main function, since I would have to create a <code>struct DLL</code> there, does that mean there is no other way to fix this code except by implementing a dummy node?"}], "tags": [], "owner": {"reputation": 2751, "user_id": 3233017, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2568656c29f0bc7e84480eb0227a304b?s=128&d=identicon&r=PG", "display_name": "Draconis", "link": "https://stackoverflow.com/users/3233017/draconis"}, "is_accepted": false, "score": 1, "last_activity_date": 1552433972, "creation_date": 1552433972, "answer_id": 55132274, "question_id": 55132208, "link": "https://stackoverflow.com/questions/55132208/problem-deleting-head-node-in-a-doubly-linked-list-in-c/55132274#55132274", "title": "Problem deleting head node in a doubly linked list in C", "body": "<p>The trick is, all the external pointers are pointing to <em>individual nodes</em>. So when you cut the head off from the rest of the list, all the pointers to <code>head</code> keep pointing to it\u2014you get the single node on its own, not the rest of the list.</p>\n\n<p>I would solve this by adding an additional struct.</p>\n\n<pre><code>typedef struct DLL{\n    struct Node * head;\n} DLL;\n</code></pre>\n\n<p>When you want to create the list, create a <code>DLL</code> pointing to the head, instead of returning the head itself. Now when you want to change the head, change the pointer inside the <code>DLL</code> struct. All the references to the <code>DLL</code> itself can stay the same, but now the <code>head</code> inside it has changed, and all those references will see the new <code>head</code> when they look for it!</p>\n"}, {"comments": [{"owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 1, "creation_date": 1552437990, "post_id": 55132307, "comment_id": 97006908, "body": "So I understand that to call the function like I did, I should not have expected there to be any change to the <code>head</code> variable in the main function, since to do so, I would have to pass a reference to <code>head</code>, which is itself a reference to the first node in the dll. Is this correct? Also, thanks for the solution, but I asked if there is a way to correct the problem I have without modifying the function headers. I guess there is no other way to solve issue without changing the signature of the functions, except  to use a dummy node?"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "reply_to_user": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1552438320, "post_id": 55132307, "comment_id": 97006961, "body": "alternatively, you could change delete_head to return a <code>Node *</code>, and have the return value be the updated value of head."}, {"owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 1, "creation_date": 1552438438, "post_id": 55132307, "comment_id": 97006989, "body": "I thought of that, but that would involve changing the signature of one of the functions, and I wondered if it was possible to fix the issue without doing that."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "edited": false, "score": 0, "creation_date": 1552446569, "post_id": 55132307, "comment_id": 97008582, "body": "@P.Gillich Yes it is possibly,  without changing, the <b>4</b> function headers. Further,  code does not need a DLL for those 4 functions as  a single link will do.  Notice the 4 functions never use the unnecessary <code>.previous</code> member."}], "tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": true, "score": 2, "last_activity_date": 1552434214, "creation_date": 1552434214, "answer_id": 55132307, "question_id": 55132208, "link": "https://stackoverflow.com/questions/55132208/problem-deleting-head-node-in-a-doubly-linked-list-in-c/55132307#55132307", "title": "Problem deleting head node in a doubly linked list in C", "body": "<p>The problem is that when you call delete_head, C parameter passing is by value, so head isn't changed on return.  You need to implement it like this:</p>\n\n<pre><code>void delete_head(Node **head){\n            Node *current = *head;\n            *head = current-&gt;next;\n            //head -&gt;previous = NULL;\n            free(current);\n}\n</code></pre>\n\n<p>And call it like this: <code>delete_head(&amp;head);</code></p>\n"}], "owner": {"reputation": 289, "user_id": 8163401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/653dbb04e4c92ad5c0db6870f801a653?s=128&d=identicon&r=PG&f=1", "display_name": "P. Gillich", "link": "https://stackoverflow.com/users/8163401/p-gillich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 55132307, "answer_count": 2, "score": 1, "last_activity_date": 1552434214, "creation_date": 1552433647, "question_id": 55132208, "link": "https://stackoverflow.com/questions/55132208/problem-deleting-head-node-in-a-doubly-linked-list-in-c", "title": "Problem deleting head node in a doubly linked list in C", "body": "<p>I'm trying to implement a doubly linked list in C. While coding it up, I ran into an issue when trying to delete the first element of the list.</p>\n\n<p>Here is is a toy example that illustrates the problem:  </p>\n\n<pre><code> #include&lt;stdio.h&gt;\n #include &lt;stdlib.h&gt;\n\n typedef struct Node{\n     struct Node * next;\n     struct Node * previous;\n     int data;\n }Node;\n\n\n Node* create_dll(int array[], int arrSize){\n     Node *current = (Node*)malloc(sizeof(Node));\n     current-&gt;next = NULL;\n     current-&gt;data = array[0];\n     for(int i = 1; i &lt; arrSize; i++){\n         Node *temp = (Node*)malloc(sizeof(Node));\n         temp-&gt;data = array[i];\n         temp-&gt;next = current;\n         current-&gt;previous  = temp;\n         current = temp;\n     }\n     current-&gt;previous = NULL; \n     return current;\n }\n void print_dll(Node *head){\n     if(head != NULL){\n         Node *current = head;\n         while(current!=NULL){\n         printf(\"%d \\t\", current -&gt;data);\n             current = current-&gt;next;\n         }\n     }\n     puts(\" \");\n }\n\n void delete_head(Node *head){\n     Node *current = head;\n     head = head-&gt;next;\n     //head -&gt;previous = NULL;\n     free(current);\n }\n void kill(Node *head){\n     Node *current = head;\n     while (current != NULL){\n         Node *previous = current;\n         current = current -&gt;next;\n         free(previous);\n     }\n }\n\n int main(){\n     int array [] = {1, 2, 3, 4, 5};\n     int arrSize = 5;\n\n     Node *head;\n\n     head = create_dll(array, 5);\n\n     print_dll(head);\n\n     delete_head(head);\n     print_dll(head);\n\n     kill(head);\n     return 0;\n\n}\n</code></pre>\n\n<p>Whenever I try to run the code in main, which creates a DLL, then prints what's in it, then attempts to delete the first node, then print the list again, I get the following result:</p>\n\n<pre><code>    5   4   3   2   1    \n    5    \n</code></pre>\n\n<p>Now, I know that one fix would be to make <code>head</code> a global variable, but that will be problematic in other sections of the code, plus I don't really want to go that route. I also don't want to modify any of the function headers, or anything in the main. </p>\n\n<p>I did get this to work by implementing the DLL with a dummy node that <code>head</code> always points to, but I\"m sure there is a simple fix to this implementation that avoids all this.</p>\n\n<p>Basically, if I can change what <code>head</code> points to in the <code>delete_head</code> function\nand have this change be reflected in the main function, that would be a solution. Otherwise, I would be happy just to understand why this code fails to do what I want.</p>\n\n<p>Any help is very much appreciated! Thanks!</p>\n"}, {"tags": ["c", "binary-tree", "realloc"], "comments": [{"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552436595, "post_id": 55132172, "comment_id": 97006639, "body": "first things first, it&#39;s better to not do this: if (root-&gt;left). Always check if a pointer == or != NULL. Also always check pointers before de-referencing them i.e. *stackSize += 1."}, {"owner": {"reputation": 4476, "user_id": 2058293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3798efb3cfd8001e14b637ea09fd2e70?s=128&d=identicon&r=PG", "display_name": "aaaaaa123456789", "link": "https://stackoverflow.com/users/2058293/aaaaaa123456789"}, "edited": false, "score": 0, "creation_date": 1552440240, "post_id": 55132172, "comment_id": 97007339, "body": "Nothing wrong with <code>if (root -&gt; left)</code>; it&#39;s perfectly well-defined in C. <code>!= NULL</code> is just noise. Checking for <code>stackSize</code> being null also seems silly here \u2014 you can assert it if you really must, but it&#39;s an obvious precondition to the function. That being said, have you tried running valgrind on this?"}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 4476, "user_id": 2058293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3798efb3cfd8001e14b637ea09fd2e70?s=128&d=identicon&r=PG", "display_name": "aaaaaa123456789", "link": "https://stackoverflow.com/users/2058293/aaaaaa123456789"}, "edited": false, "score": 0, "creation_date": 1552442711, "post_id": 55132172, "comment_id": 97007827, "body": "@aaaaaa123456789 yeh that&#39;s true, but I&#39;ve had issues with not explicitly comparing to the implementation-defined NULL."}, {"owner": {"reputation": 4476, "user_id": 2058293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3798efb3cfd8001e14b637ea09fd2e70?s=128&d=identicon&r=PG", "display_name": "aaaaaa123456789", "link": "https://stackoverflow.com/users/2058293/aaaaaa123456789"}, "reply_to_user": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1552471159, "post_id": 55132172, "comment_id": 97018357, "body": "@Medicineman25 That strongly points to a non-conformant implementation. In any standards-compliant implementation (and in fact, in literally any implementation I&#39;ve ever seen), <code>NULL</code> is defined as zero (with all of the standard&#39;s comments and caveats regarding the use of zero as a pointer value), and <code>if</code> is defined to check for non-zero, meaning that <code>if (p)</code> and <code>if (p != NULL)</code> are identical (assuming that <code>p</code> is a pointer in the first place)."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 4476, "user_id": 2058293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3798efb3cfd8001e14b637ea09fd2e70?s=128&d=identicon&r=PG", "display_name": "aaaaaa123456789", "link": "https://stackoverflow.com/users/2058293/aaaaaa123456789"}, "edited": false, "score": 0, "creation_date": 1552471518, "post_id": 55132172, "comment_id": 97018587, "body": "@aaaaaa123456789 huh... good to know!! I&#39;m just trying to remember exactly where it was I had issues. I think it was when using arm-none-eabi-gcc, but tbh I can&#39;t be sure. I&#39;ll definitely keep this in mind. Thanks for the tip :)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11194044, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NMOME8GiNH8/AAAAAAAAAAI/AAAAAAAAABs/gKJ3BB0K6y0/photo.jpg?sz=128", "display_name": "leverglowh", "link": "https://stackoverflow.com/users/11194044/leverglowh"}, "edited": false, "score": 0, "creation_date": 1552468226, "post_id": 55133271, "comment_id": 97016431, "body": "Actually it\u2019s the default test case on leetcode, in Xcode I just mallocd 3 treenodes and linked them together, pretty much as you did in your main.."}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 11, "user_id": 11194044, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NMOME8GiNH8/AAAAAAAAAAI/AAAAAAAAABs/gKJ3BB0K6y0/photo.jpg?sz=128", "display_name": "leverglowh", "link": "https://stackoverflow.com/users/11194044/leverglowh"}, "edited": false, "score": 0, "creation_date": 1552471009, "post_id": 55133271, "comment_id": 97018270, "body": "&quot;pretty much&quot; as I did or EXACTLY as I did? This could be a dangling pointer issue i.e. you haven&#39;t allocated NULL to the unused child and iterating is causing an error. I would suggest copy-pasting my code, it should compile as-is. If it&#39;s not that and you have tied up all your loose ends, and my code doesn&#39;t compile on your system then it&#39;s onto the next questions: what system is it running in where the error occurs, also what is the error? Is this compiling in XCode but then not in Linux? Have you installed all the correct tools?"}, {"owner": {"reputation": 11, "user_id": 11194044, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NMOME8GiNH8/AAAAAAAAAAI/AAAAAAAAABs/gKJ3BB0K6y0/photo.jpg?sz=128", "display_name": "leverglowh", "link": "https://stackoverflow.com/users/11194044/leverglowh"}, "edited": false, "score": 0, "creation_date": 1552556402, "post_id": 55133271, "comment_id": 97057510, "body": "<a href=\"https://leetcode.com/explore/learn/card/data-structure-tree/134/traverse-a-tree/928/\" rel=\"nofollow noreferrer\">leetcode.com/explore/learn/card/data-structure-tree/134/&hellip;</a> This is where I get the error even with your code, in my main the code works just fine"}, {"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "reply_to_user": {"reputation": 11, "user_id": 11194044, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NMOME8GiNH8/AAAAAAAAAAI/AAAAAAAAABs/gKJ3BB0K6y0/photo.jpg?sz=128", "display_name": "leverglowh", "link": "https://stackoverflow.com/users/11194044/leverglowh"}, "edited": false, "score": 0, "creation_date": 1552556892, "post_id": 55133271, "comment_id": 97057834, "body": "Ok I can&#39;t access that link. You&#39;ll need to edit your answer and provide the exact error output. Before doing that, I would suggest setting breakpoints and stepping through the code one line at a time, that way you can see exactly when the values are not being set correctly."}], "tags": [], "owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "is_accepted": false, "score": 0, "last_activity_date": 1552442584, "last_edit_date": 1592644375, "creation_date": 1552442584, "answer_id": 55133271, "question_id": 55132172, "link": "https://stackoverflow.com/questions/55132172/heap-use-after-free-on-leetcode-binary-tree-traversal/55133271#55133271", "title": "heap-use-after-free on leetcode binary tree traversal", "body": "<p>I'm not getting any error with this code</p>\n<p>Output is:</p>\n<blockquote>\n<p>ret[0] = 1</p>\n<p>ret[1] = 2</p>\n<p>ret[2] = 3</p>\n</blockquote>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct TreeNode {\n      int val;\n      struct TreeNode *left;\n      struct TreeNode *right;\n };\n\n\n\n /*\n **\n * Return an array of size *returnSize.\n * Note: The returned array must be malloced, assume caller calls free().\n */\n\nstruct TreeNode* cercaRoot(struct TreeNode* root, struct TreeNode** stack, int* stackSize){\n    if (root-&gt;left){\n\n    *stackSize += 1;\n   stack = realloc(stack, (*stackSize)*sizeof(struct TreeNode*));\n   stack[*stackSize-1] = root;\n\nreturn root-&gt;left;\n\n} else if (root-&gt;right){\n    return root-&gt;right;\n} else{\n    while(*stackSize){\n        root = stack[*stackSize-1];\n        if (root-&gt;right) {\n            *stackSize -= 1;\n            stack = realloc(stack, (*stackSize)*sizeof(struct TreeNode*));\n\n            return root-&gt;right;\n        } else {\n            *stackSize -= 1;\n            stack = realloc(stack, (*stackSize)*sizeof(struct TreeNode*));\n        }\n    }\n    return NULL;\n    }\n}\n\nint* preorderTraversal(struct TreeNode* root, int* returnSize) {\n*returnSize = 0;\nif (root==NULL) return NULL;\n\nint* array = calloc(1, sizeof(int));\narray[0]=root-&gt;val;\n*returnSize += 1;\n\nint stackSize = 0;\n\nstruct TreeNode** stack = calloc(1, sizeof(struct TreeNode*));\n\nroot = cercaRoot(root, stack, &amp;stackSize);\n\nwhile (root){\n    array = realloc(array, (*returnSize+1)*sizeof(int));\n    array[*returnSize]=root-&gt;val;\n    *returnSize+=1;\n\n    root = cercaRoot(root, stack, &amp;stackSize);\n}\n\nfree(stack);\n\nreturn array;\n\n}\n\nstruct TreeNode* nodeRoot;\n\nint main(int argc, char** argv) {\n\nint stackSize = 0;\nint returnSize = 0;\n\nnodeRoot = malloc(sizeof(nodeRoot));\n\nstruct TreeNode* nodeLeft = malloc(sizeof(nodeLeft));\nstruct TreeNode* nodeRight = malloc(sizeof(nodeRight));\n\nnodeRoot-&gt;left = nodeLeft;\nnodeRoot-&gt;right = nodeRight;\n\nnodeRoot-&gt;val = 1;\nnodeRoot-&gt;left = NULL;\nnodeRoot-&gt;right-&gt;val = 2;\nnodeRoot-&gt;right-&gt;left = malloc(sizeof(nodeLeft));\nnodeRoot-&gt;right-&gt;left-&gt;val = 3;\n\nint* ret = preorderTraversal(nodeRoot, &amp;returnSize);\n\nif(ret != NULL){\n    for(int i = 0; i &lt; 3; i++){\n        printf(&quot;ret[i] = %d\\n&quot;,ret[i]);                   \n    }\n\n}\n\nreturn (EXIT_SUCCESS);\n}\n</code></pre>\n<p>If I use sizeof(ret) in the for loop then I get:</p>\n<blockquote>\n<p>ret[0] = 1</p>\n<p>ret[1] = 2</p>\n<p>ret[2] = 3</p>\n<p>ret[3] = 0</p>\n<p>ret[4] = 0</p>\n<p>ret[5] = 0</p>\n<p>ret[6] = 33</p>\n<p>ret[7] = 0</p>\n</blockquote>\n<p>Which is expected given the number of valid nodes assigned to the array.</p>\n<p>Anyway, the logic seems fine. My first question would be how are you declaring your test case?</p>\n"}], "owner": {"reputation": 11, "user_id": 11194044, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NMOME8GiNH8/AAAAAAAAAAI/AAAAAAAAABs/gKJ3BB0K6y0/photo.jpg?sz=128", "display_name": "leverglowh", "link": "https://stackoverflow.com/users/11194044/leverglowh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 489, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552442584, "creation_date": 1552433415, "question_id": 55132172, "link": "https://stackoverflow.com/questions/55132172/heap-use-after-free-on-leetcode-binary-tree-traversal", "title": "heap-use-after-free on leetcode binary tree traversal", "body": "<p>It runs ok in my Xcode so can anyone tell me what's the problem?</p>\n\n<p>I tested and the problem is in reallocing space for stack but I don't understand the error..\nThe test case is [1,null,2,3] so 1 is root, 2 is 1's right child, 3 is 2's left child. The solution should return the array [1,2,3].</p>\n\n<pre><code> /**\n * Definition for a binary tree node.\n * struct TreeNode {\n *     int val;\n *     struct TreeNode *left;\n *     struct TreeNode *right;\n * };\n *\n **\n * Return an array of size *returnSize.\n * Note: The returned array must be malloced, assume caller calls free().\n */\n\nstruct TreeNode* cercaRoot(struct TreeNode* root, struct TreeNode** stack, int* stackSize){\n    if (root-&gt;left){\n\n    *stackSize += 1;\n    stack = realloc(stack, (*stackSize)*sizeof(struct TreeNode*));\n    stack[*stackSize-1] = root;\n\n    return root-&gt;left;\n\n    } else if (root-&gt;right){\n        return root-&gt;right;\n    } else{\n        while(*stackSize){\n            root = stack[*stackSize-1];\n            if (root-&gt;right) {\n                *stackSize -= 1;\n                stack = realloc(stack, (*stackSize)*sizeof(struct TreeNode*));\n\n                return root-&gt;right;\n            } else {\n                *stackSize -= 1;\n                stack = realloc(stack, (*stackSize)*sizeof(struct TreeNode*));\n            }\n        }\n        return NULL;\n    }\n}\n\nint* preorderTraversal(struct TreeNode* root, int* returnSize) {\n    *returnSize = 0;\n    if (root==NULL) return NULL;\n\n    int* array = calloc(1, sizeof(int));\n    array[0]=root-&gt;val;\n    *returnSize += 1;\n\n    int stackSize = 0;\n\n    struct TreeNode** stack = calloc(1, sizeof(struct TreeNode*));\n\n    root = cercaRoot(root, stack, &amp;stackSize);\n\n    while (root){\n        array = realloc(array, (*returnSize+1)*sizeof(int));\n        array[*returnSize]=root-&gt;val;\n        *returnSize+=1;\n\n        root = cercaRoot(root, stack, &amp;stackSize);\n    }\n\n    //free(stack);\n\n    return array;\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 5, "creation_date": 1552433283, "post_id": 55132116, "comment_id": 97005811, "body": "One difference is that <code>snprintf</code> always NUL-terminates the string, but <code>strncpy</code> does not always do that. Is this previous question <a href=\"https://stackoverflow.com/questions/2606539/snprintf-vs-strcpy-etc-in-c\">snprintf vs. strcpy (etc.) in C</a> relevant?"}, {"owner": {"reputation": 33597, "user_id": 2445184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/0b51ece74c2314ba345a862c4b00d804?s=128&d=identicon&r=PG", "display_name": "cmaster - reinstate monica", "link": "https://stackoverflow.com/users/2445184/cmaster-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552436696, "post_id": 55132116, "comment_id": 97006656, "body": "You should use <i>neither</i>. Not, unless you are forced to. There are better (= safer) functions to use: <code>strdup()</code>, <code>asprintf()</code>, <code>open_memstream()</code>, etc. Whenever you are writing something into a preallocated buffer, you are at the very least requiring yourself to be extremely cautious with error handling (<i>all</i> instances of insufficient space must be checked for and handled correctly). By using the functions I listed, you can just forget about that, because those functions allocate <i>sufficient</i> space themselves."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 5, "last_activity_date": 1590014149, "last_edit_date": 1590014149, "creation_date": 1552434442, "answer_id": 55132336, "question_id": 55132116, "link": "https://stackoverflow.com/questions/55132116/difference-between-strncpy-and-snprintf/55132336#55132336", "title": "Difference between strncpy and snprintf?", "body": "<p>Use <code>snprintf(dst, n, \"%s\", src)</code>.</p>\n\n<p><code>snprintf(dst, n, \"%s\", src)</code> makes certain that <code>dst</code> is <em>null character</em> terminated.  <code>strncpy(dst, src, n)</code> does not do that.</p>\n\n<p><code>strncpy(dst, src, n)</code> always does <code>n</code> copies whereas <code>snprintf(dst, n \"%s\", src)</code> does <code>min(strlen(src),n)</code> copies</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1590014446, "post_id": 55133548, "comment_id": 109524941, "body": "Interesting aspect about bounding the amount read from <code>src</code>.  Hmmmm."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1590015251, "post_id": 55133548, "comment_id": 109525174, "body": "@M.M: Is there a part of the answer you&#39;re disagreeing with based on that?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1590015716, "post_id": 55133548, "comment_id": 109525304, "body": "Never mind, I see now that by &quot;simple use of snprintf&quot; you mean the use of <code>%s</code> specifically (without precision)"}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": true, "score": 12, "last_activity_date": 1590014731, "last_edit_date": 1590014731, "creation_date": 1552444950, "answer_id": 55133548, "question_id": 55132116, "link": "https://stackoverflow.com/questions/55132116/difference-between-strncpy-and-snprintf/55133548#55133548", "title": "Difference between strncpy and snprintf?", "body": "<p><code>strncpy</code> <strong>is not a bounded <code>strcpy</code></strong>. It's a fixed-length (not bounded, fixed-length) operation targeting a destination that's not a C string (null-terminated) but a <em>null-padded</em> field, like what was used in certain kinds of data record tables in the 70s and early 80s. It has basically <strong>no modern purpose</strong> and should not be used unless you really want this behavior.</p>\n\n<p><code>snprintf</code> is the canonical C function for \"bounded <code>strcpy</code>\". On POSIX systems, <code>strnlen</code>+<code>memcpy</code> would be another good alternative, and necessary if you need to support strings longer than <code>INT_MAX</code>. If you don't have <code>strnlen</code>, you can easily make it with <code>memchr</code> and do the same.</p>\n\n<p>Note that the simple use of <code>snprintf</code> is not \"bounded\" in the sense of having a bound on how much it reads from the source; it necessarily reads the whole source string to determine the return value, which both can incur a time cost and depends on the source being a valid (terminated) string. If you want it bounded in the sense of both source and destination, you can do something like:</p>\n\n<pre><code>snprintf(dest, n, \"%.*s\", (int)n-1, src);\n</code></pre>\n\n<p>However, that's sufficiently non-idiomatic and error-prone that I would just use <code>strnlen</code> and <code>memcpy</code> instead.</p>\n"}], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 3, "accepted_answer_id": 55133548, "answer_count": 2, "score": 7, "last_activity_date": 1590014731, "creation_date": 1552433073, "last_edit_date": 1586471489, "question_id": 55132116, "link": "https://stackoverflow.com/questions/55132116/difference-between-strncpy-and-snprintf", "title": "Difference between strncpy and snprintf?", "body": "<p>What is the difference between</p>\n\n<pre><code>strncpy(dst, src, n)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>snprintf(dst, n, \"%s\", src)\n</code></pre>\n\n<p>Should I prefer one or the other when trying to do a bounded string copy? And if so, why?</p>\n"}, {"tags": ["c", "arrays", "function", "pointers", "parameters"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552433447, "post_id": 55132100, "comment_id": 97005872, "body": "Just to add, it sounds like your school is teaching you to make jagged arrays of dynamically allocated sub-arrays... not good. I&#39;m sorry."}, {"owner": {"reputation": 368, "user_id": 6366927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-756SvkMdbS8/AAAAAAAAAAI/AAAAAAAAABM/kaBaEA8arbs/photo.jpg?sz=128", "display_name": "JolonB", "link": "https://stackoverflow.com/users/6366927/jolonb"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552434499, "post_id": 55132100, "comment_id": 97006136, "body": "What should I do instead? I am being forced to use the pointers (we aren&#39;t allowed to change that), but we can make the array however we want. We haven&#39;t learnt about pointers yet, and the array needs to have a fixed size."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552435160, "post_id": 55132100, "comment_id": 97006283, "body": "Why are you being forced to use pointers if you haven&#39;t learnt about pointers yet? Sounds to me like you need to ask your teacher for clarification on their expectations."}, {"owner": {"reputation": 368, "user_id": 6366927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-756SvkMdbS8/AAAAAAAAAAI/AAAAAAAAABM/kaBaEA8arbs/photo.jpg?sz=128", "display_name": "JolonB", "link": "https://stackoverflow.com/users/6366927/jolonb"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552435370, "post_id": 55132100, "comment_id": 97006328, "body": "I was thinking that too. In the assignment, there is also a bit where we pass a 1D array (declared: <code>char arr[25]</code>) into a method and the method accepts  <code>char *arr</code>. This works perfectly find. I thought it was weird that one was working but the other wasn&#39;t, while at the same time the assignment makes no mention of them being any different."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552435572, "post_id": 55132100, "comment_id": 97006370, "body": "This is quite a subtle thing of C and C++ but there are good reasons for it. It&#39;s strange to me that you haven&#39;t been taught it yet if you are expected to write a project on it."}, {"owner": {"reputation": 368, "user_id": 6366927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-756SvkMdbS8/AAAAAAAAAAI/AAAAAAAAABM/kaBaEA8arbs/photo.jpg?sz=128", "display_name": "JolonB", "link": "https://stackoverflow.com/users/6366927/jolonb"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1552454759, "post_id": 55132100, "comment_id": 97010551, "body": "I guess I might email the lecturer in that case. I thought it was something I should&#39;ve understood, but it seems to be a lack of teaching on his behalf. Thanks"}], "owner": {"reputation": 368, "user_id": 6366927, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-756SvkMdbS8/AAAAAAAAAAI/AAAAAAAAABM/kaBaEA8arbs/photo.jpg?sz=128", "display_name": "JolonB", "link": "https://stackoverflow.com/users/6366927/jolonb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2290, "favorite_count": 0, "closed_date": 1552433193, "answer_count": 0, "score": 2, "last_activity_date": 1552433218, "creation_date": 1552432943, "last_edit_date": 1552433068, "question_id": 55132100, "link": "https://stackoverflow.com/questions/55132100/expected-char-but-argument-is-of-type-char-25", "closed_reason": "Duplicate", "title": "Expected &#39;char **&#39; but argument is of type &#39;char (*)[25]&#39;", "body": "<pre><code>void test(char **arr)\n{\n    // do something\n}\n\nint main()\n{\n    char arr[10][25];\n    test(arr);\n}\n</code></pre>\n\n<p>When I try to compile this using gcc v8.2.1, it gives me the following errors:</p>\n\n<pre><code>prog.c:8:8: warning: passing argument 1 of \u2018test\u2019 from\nincompatible pointer type [-Wincompatible-pointer-types]\n  test(arr);\n       ^~~ \nprog.c:1:19: note: expected \u2018char **\u2019 but argument is of type \u2018char (*)[25]\u2019\n  void test(char **arr)\n            ~~~~~~~^~~\n</code></pre>\n\n<p>This is for homework, so I am not allowed to change the test function to take an array (rather than a pointer to a pointer) and I need to ensure the array declared in main have those dimensions (no more and no less).</p>\n\n<p>How should I go about doing this?</p>\n"}, {"tags": ["c", "string", "uart", "microchip"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11194032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7f3dd22ce8cee501dd2ca22dd14a84?s=128&d=identicon&r=PG&f=1", "display_name": "dfetz", "link": "https://stackoverflow.com/users/11194032/dfetz"}, "edited": false, "score": 0, "creation_date": 1552491062, "post_id": 55134271, "comment_id": 97031829, "body": "I did that and it worked beautifully except it only sent hello instead of the entire string. any idea for this? Sorry, im very new at coding and got thrown into this for my senior project."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 1, "creation_date": 1552556640, "post_id": 55134271, "comment_id": 97057669, "body": "You only should write in the TX buffer when its empty. So test the buffer in advance and wait when its full."}], "tags": [], "owner": {"reputation": 10869, "user_id": 266392, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/173e2caa17a8522cae442e23e7879921?s=128&d=identicon&r=PG", "display_name": "tomlogic", "link": "https://stackoverflow.com/users/266392/tomlogic"}, "is_accepted": false, "score": 0, "last_activity_date": 1552450352, "creation_date": 1552450352, "answer_id": 55134271, "question_id": 55132062, "link": "https://stackoverflow.com/questions/55132062/microchip-dspic33fj256gp710a-from-example-code-for-comm-via-uart/55134271#55134271", "title": "Microchip dsPIC33FJ256GP710A from example code for comm via UART", "body": "<p>Well, these changes should be a good start, but I imagine there's another register you need to block on before loading the next character to <code>U2TXREG</code>.  You should try to find a serial library to use so you can just pass the string(s) you want to print, and have them go into a circular buffer that an interrupt handler pulls from when the hardware is ready for the next byte.</p>\n\n<pre><code>const char *A = \"hello how are\";\n\nif(PORTDbits.RD7 == FALSE) {\n    if( S6Flag == FALSE ) {\n        S6Flag = TRUE;\n        int len = strlen(A);\n        for(i=0; i&lt;len; i++){\n            U2TXREG = A[i];\n        }\n    }\n}\nelse {\n    S6Flag = FALSE;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1552894530, "creation_date": 1552894530, "answer_id": 55216484, "question_id": 55132062, "link": "https://stackoverflow.com/questions/55132062/microchip-dspic33fj256gp710a-from-example-code-for-comm-via-uart/55216484#55216484", "title": "Microchip dsPIC33FJ256GP710A from example code for comm via UART", "body": "<p>You only should write into the TX-Buffer, when there is at least one position empty, otherwise you will lost data:</p>\n\n<pre><code>const char *A = \"hello how are\";\n\nif(PORTDbits.RD7 == FALSE) {\n    if( S6Flag == FALSE ) {\n        S6Flag = TRUE;\n        int len = strlen(A);\n        for(i=0; i&lt;len; i++){\n            while (U2STAbits.UTXBF == 1);    //wait for an empty position in the buffer\n            U2TXREG = A[i];\n        }\n    }\n}\nelse {\n    S6Flag = FALSE;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11194032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7f3dd22ce8cee501dd2ca22dd14a84?s=128&d=identicon&r=PG&f=1", "display_name": "dfetz", "link": "https://stackoverflow.com/users/11194032/dfetz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1552894530, "creation_date": 1552432655, "last_edit_date": 1552495781, "question_id": 55132062, "link": "https://stackoverflow.com/questions/55132062/microchip-dspic33fj256gp710a-from-example-code-for-comm-via-uart", "title": "Microchip dsPIC33FJ256GP710A from example code for comm via UART", "body": "<p>I am trying to have my system send out a signal over xbee using UART and I have a good link and I am communicating. </p>\n\n<p>The code that I am using is supposed to output something whenever I press a button on the board. </p>\n\n<p>The code below is supposed to output </p>\n\n<ul>\n<li>'h' when 1 is pressed</li>\n<li>'hello how are' when 2 is pressed</li>\n<li>'3' when 3 is pressed</li>\n<li>'4' when 4 is pressed</li>\n</ul>\n\n<p>1,3,and 4 work flawlessly but when i press 2 all i get is 'o h e'. Why that is?</p>\n\n<pre><code>#include &lt;p33FJ256GP710A.h&gt;\n#include \"string.h\"\n\n_FOSCSEL(FNOSC_FRC);            // Internal FRC oscillator\n_FOSC(FCKSM_CSECMD &amp; OSCIOFNC_OFF  &amp; POSCMD_NONE);  \n                            // Clock Switching is enabled and Fail Safe \nClock Monitor is disabled\n                            // OSC2 Pin Function: OSC2 is Clock Output\n                            // Primary Oscillator Mode: XT Crystanl\n\n\n#define TRUE    1\n#define FALSE   0\n\nunsigned char S3Flag, S4Flag, S5Flag, S6Flag;\nconst char A[] = {'hello', ' ', 'how', ' ', 'are'};\nint i;\n\n\nvoid __attribute__ ((interrupt, no_auto_psv)) _U2RXInterrupt(void) {\n    LATA = U2RXREG;\n    IFS1bits.U2RXIF = 0;\n}\nvoid __attribute__ ((interrupt, no_auto_psv)) _U2TXInterrupt(void) {\n    IFS1bits.U2TXIF = 0;\n}\n\nvoid InitClock() {\n    PLLFBD = 38;    // M = 40\n    CLKDIVbits.PLLPOST = 0; // N1 = 2\n    CLKDIVbits.PLLPRE = 0;  // N2 = 2\n    OSCTUN = 0;\n    RCONbits.SWDTEN = 0;\n\n    // Clock switch to incorporate PLL\n    __builtin_write_OSCCONH(0x01);      // Initiate Clock Switch to \n                                                // FRC with PLL (NOSC=0b001)\n    __builtin_write_OSCCONL(0x01);      // Start clock switching\n    while (OSCCONbits.COSC != 0b001);   // Wait for Clock switch to occur   \n\n    while(OSCCONbits.LOCK != 1) {};\n}\n\nvoid InitUART2() {\n    // This is an EXAMPLE, so brutal typing goes into explaining all bit sets\n\n    // The HPC16 board has a DB9 connector wired to UART2, so we will\n    // be configuring this port only\n\n    // configure U2MODE\n    U2MODEbits.UARTEN = 0;  // Bit15 TX, RX DISABLED, ENABLE at end of func\n    //U2MODEbits.notimplemented;    // Bit14\n    U2MODEbits.USIDL = 0;   // Bit13 Continue in Idle\n    U2MODEbits.IREN = 0;    // Bit12 No IR translation\n    U2MODEbits.RTSMD = 0;   // Bit11 Simplex Mode\n    //U2MODEbits.notimplemented;    // Bit10\n    U2MODEbits.UEN = 0;     // Bits8,9 TX,RX enabled, CTS,RTS not\n    U2MODEbits.WAKE = 0;    // Bit7 No Wake up (since we don't sleep here)\n    U2MODEbits.LPBACK = 0;  // Bit6 No Loop Back\n    U2MODEbits.ABAUD = 0;   // Bit5 No Autobaud (would require sending '55')\n    U2MODEbits.URXINV = 0;  // Bit4 IdleState = 1  (for dsPIC)\n    U2MODEbits.BRGH = 0;    // Bit3 16 clocks per bit period\n    U2MODEbits.PDSEL = 0;   // Bits1,2 8bit, No Parity\n    U2MODEbits.STSEL = 0;   // Bit0 One Stop Bit\n\n    // Load a value into Baud Rate Generator.  Example is for 9600.\n    // See section 19.3.1 of datasheet.\n    //  U2BRG = (Fcy/(16*BaudRate))-1\n    //  U2BRG = (37M/(16*9600))-1\n    //  U2BRG = 240\n    U2BRG = 240;    // 40Mhz osc, 9600 Baud\n\n    // Load all values in for U1STA SFR\n    U2STAbits.UTXISEL1 = 0; //Bit15 Int when Char is transferred (1/2 config!)\n    U2STAbits.UTXINV = 0;   //Bit14 N/A, IRDA config\n    U2STAbits.UTXISEL0 = 0; //Bit13 Other half of Bit15\n    //U2STAbits.notimplemented = 0; //Bit12\n    U2STAbits.UTXBRK = 0;   //Bit11 Disabled\n    U2STAbits.UTXEN = 0;    //Bit10 TX pins controlled by periph\n    U2STAbits.UTXBF = 0;    //Bit9 *Read Only Bit*\n    U2STAbits.TRMT = 0; //Bit8 *Read Only bit*\n    U2STAbits.URXISEL = 0;  //Bits6,7 Int. on character recieved\n    U2STAbits.ADDEN = 0;    //Bit5 Address Detect Disabled\n    U2STAbits.RIDLE = 0;    //Bit4 *Read Only Bit*\n    U2STAbits.PERR = 0;     //Bit3 *Read Only Bit*\n    U2STAbits.FERR = 0;     //Bit2 *Read Only Bit*\n    U2STAbits.OERR = 0;     //Bit1 *Read Only Bit*\n    U2STAbits.URXDA = 0;    //Bit0 *Read Only Bit*\n\n    IPC7 = 0x4400;  // Mid Range Interrupt Priority level, no urgent reason\n\n    IFS1bits.U2TXIF = 0;    // Clear the Transmit Interrupt Flag\n    IEC1bits.U2TXIE = 1;    // Enable Transmit Interrupts\n    IFS1bits.U2RXIF = 0;    // Clear the Recieve Interrupt Flag\n    IEC1bits.U2RXIE = 1;    // Enable Recieve Interrupts\n\n    U2MODEbits.UARTEN = 1;  // And turn the peripheral on\n\n    U2STAbits.UTXEN = 1;\n    // I think I have the thing working now.\n}\n\nvoid InitPorts() {\n    // S3 (portD Pin 6, chosen as trigger for sending 'M' to UART)\n    // S6 (portD Pin 7, chosen as trigger for sending 'C' to UART)\n    // S5 (portA Pin 7, chosen as trigger for sending 'H' to UART)\n    // S4 (portD Pin 13, chosen as trigger for sending 'P' to UART)\n\n    TRISD = 0x20C0; // D6,7,13 inputs\n    AD1PCFGHbits.PCFG23 = 1;    // This is important.  RA7 is muxxed with AN23,\n        // So we need to config the pin as DIGITAL\n    TRISA = 0x0080; // only 0th bit needs be output. A7 is input\n    S3Flag = S4Flag = S5Flag = S6Flag = 0;  // Some Debounce Flags\n}\n\nvoid SoftwareDebounce() {\n    if(PORTDbits.RD6 == FALSE) {\n        if( S3Flag == FALSE ) {\n            S3Flag = TRUE;\n            U2TXREG = 'h';\n        }\n    }\n    else {\n        S3Flag = FALSE;\n    }\n    if(PORTDbits.RD7 == FALSE) {\n        if( S6Flag == FALSE ) {\n            S6Flag = TRUE;\n            for(i=0; i&lt;=4;i++){\n                U2TXREG = (\"%s\", A[i]);\n            }\n        }\n    }\n    else {\n        S6Flag = FALSE;\n    }\n    if(PORTAbits.RA7 == FALSE) {\n        if( S5Flag == FALSE ) {\n            S5Flag = TRUE;\n            U2TXREG = '3';\n        }\n    }\n    else {\n        S5Flag = FALSE;\n    }\n    if(PORTDbits.RD13 == FALSE) {\n        if( S4Flag == FALSE ) {\n            S4Flag = TRUE;\n            U2TXREG = '4';\n        }\n    }\n    else {\n        S4Flag = FALSE;\n    }\n}\nint main(void) {\n\n    InitClock();    // This is the PLL settings\n\n    InitUART2();    // Initialize UART2 for 9600,8,N,1 TX/RX\n\n    InitPorts();    // LEDs outputs, Switches Inputs\n\n    while(1) {  // The ever versatile Infinite Loop!\n        SoftwareDebounce();\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "linker"], "comments": [{"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1552426863, "post_id": 55130965, "comment_id": 97003687, "body": "Is this question about ELF and th GNU gABI? Different targets vary quite a bit in this area."}, {"owner": {"reputation": 3787, "user_id": 5437543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ad76496c936d384dac2888bae0126dde?s=128&d=identicon&r=PG&f=1", "display_name": "StoneThrow", "link": "https://stackoverflow.com/users/5437543/stonethrow"}, "reply_to_user": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1552427091, "post_id": 55130965, "comment_id": 97003778, "body": "@FlorianWeimer - sorry, I&#39;m not very familiar with those terms. I vaguely remember ELF is a &quot;format&quot; of the memory layout of an executable(?) I added the output of my &quot;<code>gcc --version</code>&quot; in case that answers your question."}], "answers": [{"comments": [{"owner": {"reputation": 3787, "user_id": 5437543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ad76496c936d384dac2888bae0126dde?s=128&d=identicon&r=PG&f=1", "display_name": "StoneThrow", "link": "https://stackoverflow.com/users/5437543/stonethrow"}, "edited": false, "score": 1, "creation_date": 1552428250, "post_id": 55131080, "comment_id": 97004236, "body": "Thank you; you&#39;ve answered my question. Do you happen to know <i>why</i> the linker works differently when linking objects vs. static libs? I.e why does linking against an object result in unconditional inclusion of all its symbols, but linking against a static lib result in per-member-object-file exclusion of unused symbols? I&#39;m just curious to understand rationale behind this behavior, if you happen to be aware of it."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 3787, "user_id": 5437543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ad76496c936d384dac2888bae0126dde?s=128&d=identicon&r=PG&f=1", "display_name": "StoneThrow", "link": "https://stackoverflow.com/users/5437543/stonethrow"}, "edited": false, "score": 0, "creation_date": 1552428691, "post_id": 55131080, "comment_id": 97004409, "body": "@StoneThrow IDK. I think it&#39;s because object files aren&#39;t guaranteed to have an index and including them unconditionally avoids the need for a second pass through each object file that wouldn&#39;t be skipped, but that&#39;s just a guess."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1552432910, "post_id": 55131080, "comment_id": 97005713, "body": "<code>--gc-sections</code> is not really &quot;per-symbol granularity&quot; of linking. Linking libraries is still on a per-object-file granularity (this can make a big difference in the presence of weak references or weak definitions with strong replacements), but <i>after the set of objects being linked is fully resolved</i>, the per-function/per-data-object section references are garbage-collected to drop the ones which are unreachable."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1552465283, "post_id": 55131080, "comment_id": 97014770, "body": "@R.. Thanks for the clarification. That part of my answer was a little sloppy. I&#39;ve edited your info in."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 8, "last_activity_date": 1552434230, "last_edit_date": 1552434230, "creation_date": 1552426989, "answer_id": 55131080, "question_id": 55130965, "link": "https://stackoverflow.com/questions/55130965/when-and-why-would-the-c-linker-exclude-unused-symbols/55131080#55131080", "title": "When and why would the C linker exclude unused symbols?", "body": "<p>It's mostly correct with the caveat that static-library linking doesn't really have per-symbol granularity. It has per-member-object-file granularity.</p>\n\n<p><strong>Example:</strong></p>\n\n<p>If the static library contains files:</p>\n\n<pre><code>a.o \n    foo\n    bar\nb.o \n    baz\n</code></pre>\n\n<p>and an undefined reference to <code>foo</code> needs to be resolved, <code>a.o</code> will be brought in, and with it the <code>bar</code> symbol as well.</p>\n\n<p>You can get the effect of per symbol granularity when you compile with  <code>-ffunction-sections</code> <code>-fdata-sections</code> and then link with <code>-Wl,--gc-sections</code> (gc stands for garbage-collect), but bear in mind that the compiler/linker options are gcc/clang-specific and that they have some minor performance/code-size cost.</p>\n\n<p><code>-ffunction-sections</code> puts each function in its own section (sort of like its own object file) and <code>-fdata-sections</code> does the same thing for externally visible global variables. <code>-Wl,--gc-sections</code> then causes a garbage collector to run after the object files are linked as usual, and the garbage collector removes all sections (=>symbols) that are unreachable.</p>\n\n<p>(<code>-ffunction-sections</code> is also useful if you want <code>size -A the_objectfile.o</code> to give you function sizes and if you also want those functions sizes to\nnot slightly fluctuate based on the position of the functions (due to alignment requirements).)</p>\n"}], "owner": {"reputation": 3787, "user_id": 5437543, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/ad76496c936d384dac2888bae0126dde?s=128&d=identicon&r=PG&f=1", "display_name": "StoneThrow", "link": "https://stackoverflow.com/users/5437543/stonethrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 3, "accepted_answer_id": 55131080, "answer_count": 1, "score": 6, "last_activity_date": 1552434230, "creation_date": 1552426442, "last_edit_date": 1552429492, "question_id": 55130965, "link": "https://stackoverflow.com/questions/55130965/when-and-why-would-the-c-linker-exclude-unused-symbols", "title": "When and why would the C linker exclude unused symbols?", "body": "<p>I'm performing some tests with <code>gcc</code> to understand the rule(s) by which it intelligently excludes unused symbols.</p>\n\n<pre><code>// main.c\n\n#include &lt;stdio.h&gt;\n\nvoid foo()\n{\n}\n\nint main( int argc, char* argv[] )\n{\n  return 0;\n}\n</code></pre>\n\n<p>.</p>\n\n<pre><code>// bar.c\n\nint bar()\n{\n  return 42;\n}\n</code></pre>\n\n<p>.</p>\n\n<pre><code>&gt; gcc --version\ngcc (GCC) 8.2.1 20181215 (Red Hat 8.2.1-6)\nCopyright (C) 2018 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n&gt;\n&gt; gcc -c bar.c\n&gt; gcc -g main.c bar.o \n&gt; nm a.out | grep \"foo\\|bar\"\n000000000040111f T bar\n0000000000401106 T foo\n</code></pre>\n\n<p>Above, I've compiled <code>bar.o</code>, and linked it with <code>a.out</code> while compiling <code>main.c</code>.<br>\nListing <code>a.out</code>'s symbols show that both unused functions - <code>foo()</code> and <code>bar()</code> - are included in the executable.</p>\n\n<pre><code>&gt; ar -r libbar.a bar.o\nar: creating libbar.a\n&gt; gcc -g main.c -L ./ -lbar\n&gt; nm a.out | grep \"foo\\|bar\"\n0000000000401106 T foo\n</code></pre>\n\n<p>Above, I've archived <code>bar.o</code> to <code>libbar.a</code>, and recreated <code>a.out</code>, this time linking with <code>libbar.a</code> instead of <code>bar.o</code>. This time around, unused function <code>foo()</code> is still present, but <code>bar()</code> is not.</p>\n\n<p>From this experiment, I might surmise the following \"rules\":</p>\n\n<ol>\n<li>Symbols linked from object files are always present in executables. (Perhaps this explains why <code>foo()</code> is always present: is there a temporary/anonymous <code>main.o</code> that's created? If so, it would include <code>foo()</code>)</li>\n<li>If an executable is linked with a <em>library</em>, <code>gcc</code> will intelligently figure out unnecessary symbols to exclude.</li>\n</ol>\n\n<p>The above are my hypotheses based on this experiment - but how correct is it? If someone is knowledgeable with the intricacies of how linking works, I'd be grateful for some background information explaining the whys and wherefores of what's going on.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 71, "user_id": 2668841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce15bb780f1903cb0afea8e527932a1d?s=128&d=identicon&r=PG&f=1", "display_name": "likes_math", "link": "https://stackoverflow.com/users/2668841/likes-math"}, "edited": false, "score": 0, "creation_date": 1552425202, "post_id": 55130721, "comment_id": 97003001, "body": "In case 6, you wrote <code>Total=; pow(num_1, num_2)</code>"}, {"owner": {"reputation": 2157, "user_id": 3865653, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Fv3Fj.jpg?s=128&g=1", "display_name": "Deanie", "link": "https://stackoverflow.com/users/3865653/deanie"}, "edited": false, "score": 0, "creation_date": 1552425242, "post_id": 55130721, "comment_id": 97003019, "body": "<code>pow(num_1, num_2);</code>"}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 3, "creation_date": 1552425481, "post_id": 55130721, "comment_id": 97003123, "body": "You didn&#39;t say in C what you want to &quot;switch&quot; on. <code>switch {</code> needs to be <code>switch (something) {</code>. It can&#39;t read your mind. :)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1552425852, "post_id": 55130721, "comment_id": 97003283, "body": "Surely your textbook / tutorial / other source material summarizes the syntax of a <code>switch</code> statement and gives at least one example.  The compiler helpfully points out the line of your code that it doesn&#39;t like, and even has something to say about what&#39;s wrong with it.  Compare."}, {"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 1, "creation_date": 1552425924, "post_id": 55130721, "comment_id": 97003311, "body": "@xing <code>n</code> in OP&#39;s code is of type <code>double</code>. You can&#39;t switch on <code>double</code>s in C"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 0, "last_activity_date": 1552431489, "last_edit_date": 1552431489, "creation_date": 1552426867, "answer_id": 55131060, "question_id": 55130721, "link": "https://stackoverflow.com/questions/55130721/do-we-have-to-add-something-after-the-switch-statement/55131060#55131060", "title": "Do we have to add something after the switch statement", "body": "<blockquote>\n  <p>... is giving me error at the switch statement saying \"expected () before {\"</p>\n</blockquote>\n\n<p>This is because the line</p>\n\n<blockquote>\n<pre><code>switch {\n</code></pre>\n</blockquote>\n\n<p>must be</p>\n\n<blockquote>\n<pre><code>switch (n) {\n</code></pre>\n</blockquote>\n\n<p>Some other remarks :</p>\n\n<p>1) In</p>\n\n<blockquote>\n<pre><code> double num_1 = 0.0;\n double num_2 = 0.0;\n double n = 0.0;\n double Total = 0.0;\n</code></pre>\n</blockquote>\n\n<p>the initializations are useless because you will (try to) reassign the variables after</p>\n\n<p>The type of <em>n</em>  should be changed to an integer because of its use</p>\n\n<p>2) In</p>\n\n<blockquote>\n<pre><code>scanf(\"%d\", &amp; num_1);\n....\nscanf(\"%d\", &amp; num_2);\n</code></pre>\n</blockquote>\n\n<p><code>%d</code> means you enter an <em>int</em> but you give a pointer to a <em>double</em>, this is invalid</p>\n\n<p>Replace <code>%d</code> by <code>%g</code> for instance</p>\n\n<p>3) In</p>\n\n<blockquote>\n<pre><code> printf(\"The add is : %d\\n\",Total);\n ...\n printf(\"The Subtract is : %d\\n\",Total);\n ...\n printf(\"The division is : %d\\n\",Total);\n ...\n printf(\"The multiplication is : %d\\n\",Total);\n ...\n printf(\"The percentage is : %d\\n\",Total);\n ...\n printf(\"The power is : %d\\n\",Total);\n</code></pre>\n</blockquote>\n\n<p>the format <code>%d</code> means you print an <em>int</em> but you give a <em>double</em>, replace <code>%d</code> by <code>%g</code> for instance</p>\n\n<p>4) In</p>\n\n<blockquote>\n<pre><code>case 6 : Total=; pow(num_1, num_2)\n</code></pre>\n</blockquote>\n\n<p>the ',' is wrongly placed, must be</p>\n\n<blockquote>\n<pre><code>case 6 : Total= pow(num_1, num_2);\n</code></pre>\n</blockquote>\n\n<p>5) you do not check if you will divide or modulo with 0</p>\n\n<p>6) you do not check your <em>scanf</em> return 1 so if a valid value was entered (and not EOF too)</p>\n\n<p>7) <code>printf(\"No Result\\n\");</code> can be replaced by <code>printf(\"Invalid command\\n\");</code> or <code>puts(\"Invalid command\");</code></p>\n"}], "owner": {"reputation": 13, "user_id": 11152111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d12d18fd212c13ae33472340d1e683?s=128&d=identicon&r=PG&f=1", "display_name": "hassan", "link": "https://stackoverflow.com/users/11152111/hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 55131060, "answer_count": 1, "score": -3, "last_activity_date": 1552431489, "creation_date": 1552425122, "last_edit_date": 1552425418, "question_id": 55130721, "link": "https://stackoverflow.com/questions/55130721/do-we-have-to-add-something-after-the-switch-statement", "title": "Do we have to add something after the switch statement", "body": "<p>I am a beginner to C language.Here is the code for my C calculator but is giving me error at the switch statement saying \"expected () before {\" at the line where switch statement starts. The code is as follows:</p>\n\n<pre><code>int main()\n{\n    double num_1 = 0.0;\n    double num_2 = 0.0;\n    double n = 0.0;\n    double Total = 0.0;\n\n    printf(\"\\nEnter 1 for add:\\n \");\n    printf(\"Enter 2 for subtract:\\n \");\n    printf(\"Enter 3 for division:\\n \");\n    printf(\"Enter 4 for multiplication:\\n \");\n    printf(\"Enter 5 for percentage:\\n \");\n    printf(\"Enter 6 for power:\\n \");\n    scanf(\"%d\", &amp; n);\n\n    printf(\"Enter first number:  \");\n    scanf(\"%d\", &amp; num_1);\n    printf(\"Enter second number:  \");\n    scanf(\"%d\", &amp; num_2);\n\n    switch {\n        case 1 : Total=num_1+num_2;\n                 printf(\"The add is : %d\\n\",Total);\n                 break;\n        case 2 : Total=num_1-num_2;\n                 printf(\"The Subtract is : %d\\n\",Total);\n                 break;\n        case 3 : Total=num_1/num_2;\n                 printf(\"The division is : %d\\n\",Total);\n                 break;\n        case 4 : Total=num_1*num_2;\n                 printf(\"The multiplication is : %d\\n\",Total);\n                 break;\n        case 5 : Total=num_1%num_2;\n                 printf(\"The percentage is : %d\\n\",Total);\n                 break;\n        case 6 : Total=; pow(num_1, num_2)\n                 printf(\"The power is : %d\\n\",Total);\n                 break;\n        default:\n                printf(\"No Result\\n\");\n                break;\n    }\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "stdio", "getchar"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1552424456, "post_id": 55130542, "comment_id": 97002716, "body": "Well, you could take it in as a string, i.e. with <code>fgets</code>, then process that character-by-character, rather than reading and processing characters at the same time."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1552424484, "post_id": 55130542, "comment_id": 97002725, "body": "To the question itself - no, there is no limit. How do you feed the input though?"}, {"owner": {"reputation": 41, "user_id": 10568197, "user_type": "registered", "profile_image": "https://graph.facebook.com/2412869982073148/picture?type=large", "display_name": "D&#225;vid \u010cano", "link": "https://stackoverflow.com/users/10568197/d%c3%a1vid-%c4%8cano"}, "edited": false, "score": 1, "creation_date": 1552424550, "post_id": 55130542, "comment_id": 97002754, "body": "I just copied the numbers and pasted them into terminal."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1552424646, "post_id": 55130542, "comment_id": 97002801, "body": "So it&#39;s your terminal fault. Better redirect from file."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1552425880, "post_id": 55130542, "comment_id": 97003292, "body": "It&#39;s probably the fault of the kernel tty driver&#39;s cooked/canonical mode, which has to impose a line length limit to avoid needing unbounded buffer space in the kernel. If the tty were in non-cooked mode, the terminal would probably not prevent you from pasting arbitrarily many characters through it. But yes, OP should use redirection here."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 2, "creation_date": 1552426775, "post_id": 55130542, "comment_id": 97003648, "body": "I bet your copy-paste stopped at 4095 characters."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552430327, "post_id": 55130542, "comment_id": 97004982, "body": "What is the result of <code>printf(&quot;%d\\n&quot;, BUFSIZ);</code>?"}], "owner": {"reputation": 41, "user_id": 10568197, "user_type": "registered", "profile_image": "https://graph.facebook.com/2412869982073148/picture?type=large", "display_name": "D&#225;vid \u010cano", "link": "https://stackoverflow.com/users/10568197/d%c3%a1vid-%c4%8cano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552424250, "creation_date": 1552424250, "question_id": 55130542, "link": "https://stackoverflow.com/questions/55130542/is-there-a-limit-to-how-many-characters-in-a-row-getchar-can-scan", "title": "Is there a limit to how many characters in a row getchar can scan?", "body": "<p>I have an assignment to make a program that calculates the iterative digital sum of an integer, eg. doing the digital sum until the result is a single digit. The catch is that the number they test for are much greater that can be stored in any int type (around 10^40000) so my idea was to do the first sum using getchar(), adding up the number digit by digit.\nMy code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    long int n=0;\n    int c;\n\n    //first sum\n    while((c=getchar())!=EOF &amp;&amp; c!='\\n'){\n        n+=(c-'0');\n    }\n\n    //iterative summing\n    long int s;\n    do{\n        s=0;\n        while(n&gt;0){\n            s+=n%10;\n            n/=10;\n        }\n        n=s;\n    }while (n&gt;=10);\n\n    printf(\"%ld\\n\",s);\n    return 0;\n}\n</code></pre>\n\n<p>It worked for relatively short numbers, however after some point, the sum would come out wrong. So I tried setting up a variable that'd get incremented with each character summed, and it would always show the number of 4095.</p>\n\n<p>So my question is, is there an 11-bit limit to how many characters you can get from stdin using getchar()? If so, is there a way to get more?</p>\n"}, {"tags": ["c", "assembly", "mips"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1552423931, "post_id": 55130455, "comment_id": 97002501, "body": "<i>I&#39;ve tried those online things but don&#39;t seem to help me learn</i> - so what do you expect to get here? By &quot;online things&quot; you mean some online c-to-mips translators?"}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1552424118, "post_id": 55130455, "comment_id": 97002577, "body": "You can have a look at how compilers translate your code into assembly. Don\u2019t forget to turn optimizations off, otherwise any compiler will optimize the heck of your code)"}, {"owner": {"reputation": 3, "user_id": 8734870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca9964eea7a06e334c9fbca74fc0d96?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel R", "link": "https://stackoverflow.com/users/8734870/daniel-r"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552424489, "post_id": 55130455, "comment_id": 97002726, "body": "@EugeneSh. Yes the c-mips. In not looking for someone to do it for me, some people are new to this (me) and so i dont think the attitude is needed. Just looking for what would be my best bet going about this"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1552456968, "post_id": 55130455, "comment_id": 97011253, "body": "Looking at compiler output is usually your best bet.  @ForceBru: There&#39;s not much to optimize here, and <code>-O0</code> code is really noisy and hard to follow (full of store/reload). <a href=\"https://godbolt.org/z/RbYSsR\" rel=\"nofollow noreferrer\">godbolt.org/z/RbYSsR</a> from gcc (for MIPS II) and clang (for MIPS32r6) are pretty reasonable.  The <code>teq</code> is a trap-on-equal to catch division by zero.  If targeting baseline MIPS I, it uses a conditional branch over a  <code>break</code> instruction."}], "answers": [{"tags": [], "owner": {"reputation": 8506, "user_id": 10808674, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j1tGB.jpg?s=128&g=1", "display_name": "Alain Merigot", "link": "https://stackoverflow.com/users/10808674/alain-merigot"}, "is_accepted": true, "score": 1, "last_activity_date": 1552428493, "creation_date": 1552428493, "answer_id": 55131381, "question_id": 55130455, "link": "https://stackoverflow.com/questions/55130455/converting-c-code-into-assembly-mips-language/55131381#55131381", "title": "Converting C Code Into Assembly Mips Language", "body": "<p>Here is how the compilers translate this kind of code.<br>\nThis is C code, but it is strictly equivalent to your original code and it is written in such a way that every C instruction can be mapped to an asm instruction. I have even written which instruction should be used. </p>\n\n<pre><code>int * pA=&amp;A[0];     // mov\nint * pB=&amp;B[0];     // mov\nint i=1;            // addi\nint n=50;           // addi\ndo{\n  // body of for loop\n  int B_1=*(pB-1) ; // lw\n  int A_1=*(pA-1) ; // lw\n  int D=B_1/A1;     // div\n  int A=*pA;        // lw\n  A += D;           // add\n  *pA = A;          // sw\n  // increment part of the loop\n  i+=1;             // addi\n  pA+=1;            // addi\n  pb+=1;            // addi\n  // test part of the loop\n  while (i&lt;N);      // blt -&gt; do\n }\n</code></pre>\n\n<p>You just have to pick a register for all the variables (for instance, choose to copy <code>pA</code> in <code>$t3</code> (or <code>r4</code> or whatever), and figure out how to translate this instruction in asm. Look at MIPS documentation and translation should be easy.</p>\n\n<p>There are though a couple of important things to know.</p>\n\n<ol>\n<li><p>Pointers are similar to memory addresses that are manipulated by the processor, except when increment (or in general pointer arithmetic) is concerned. If <code>p</code> is a pointer to an element of type <code>T</code> in C, <code>p++</code> means that <code>p</code> will point to the next element of type <code>T</code>. For adresses, the <em>size</em> of the type must be considered. If an <code>int</code> is 4 bytes, \"point to next int\" will correspond to \"add to address the size of an int\" (ie 4).</p></li>\n<li><p><code>lw</code> and <code>sw</code> use based addressing, that is they can add an immediate to an address. Pointer arithmetic is also relevant. So if <code>p</code> is an <code>int</code> pointer, and you want to implement <code>x=*(p+2)</code>, assuming <code>x</code> is in <code>$t4</code> and <code>p</code> is in <code>$t7</code>, you have to do <code>lw $t4,8($t7)</code> that means read memory at address <code>$t7+8</code> (as <code>8==2*sizeof(int)</code>. </p></li>\n</ol>\n\n<p>It should not be too difficult to write a first code. Then, you can try to optimize it. Maybe loading <code>A[i-1]</code> at every iteration is not useful, for instance? Maybe you can reduce the number of variables (registers)?</p>\n"}], "owner": {"reputation": 3, "user_id": 8734870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca9964eea7a06e334c9fbca74fc0d96?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel R", "link": "https://stackoverflow.com/users/8734870/daniel-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 55131381, "answer_count": 1, "score": 0, "last_activity_date": 1552428493, "creation_date": 1552423864, "question_id": 55130455, "link": "https://stackoverflow.com/questions/55130455/converting-c-code-into-assembly-mips-language", "title": "Converting C Code Into Assembly Mips Language", "body": "<p>Hi so I am brand new to the whole MIPS assembly code and am trying to teach myself with online help sources. I can understand some parts of it and how it works. My problem that I need to solve now is </p>\n\n<pre><code>int A[50], B[50]; \nfor (i=1; i &lt; 50; i++) { \n A[i] = A[i] + B[i-1] / A[i-1]; \n}\n</code></pre>\n\n<p>Some tips and pointers would very much be appreciated looking to expand my knowledge. I've tried those online things but don't seem to help me learn.</p>\n"}, {"tags": ["c", "performance", "stm32", "stm32ldiscovery"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552471282, "post_id": 55130404, "comment_id": 97018446, "body": "#1 here is that we don&#39;t use <code>int</code> in embedded systems, because it is signed, which we typically never want, and of unknown size, which makes it non-portable. Instead we use <code>stdint.h</code> types. <code>char</code> is even worse, since we don&#39;t even know if it is signed or not."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552471707, "post_id": 55130404, "comment_id": 97018703, "body": "#2 is reading up about how to use local variables in functions: <a href=\"https://stackoverflow.com/questions/6441218/can-a-local-variables-memory-be-accessed-outside-its-scope\">Can a local variable&#39;s memory be accessed outside its scope?</a>. (No, it cannot...)"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1552471390, "post_id": 55138129, "comment_id": 97018515, "body": "There shouldn&#39;t be any busy loops at all, neither broken ones as in the OP nor library ones. Just check SPI status flags."}, {"owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552473254, "post_id": 55138129, "comment_id": 97019692, "body": "The busy loop is between two SPI transfers. It might be needed, as some slaves have quite strange requirements."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552473331, "post_id": 55138129, "comment_id": 97019745, "body": "That ought to be clarified with comments then."}, {"owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552473392, "post_id": 55138129, "comment_id": 97019776, "body": "I agree, I&#39;ve added a bit to the answer."}, {"owner": {"reputation": 35, "user_id": 6499133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207335906815734/picture?type=large", "display_name": "Nathaniel Brochu", "link": "https://stackoverflow.com/users/6499133/nathaniel-brochu"}, "edited": false, "score": 1, "creation_date": 1552576928, "post_id": 55138129, "comment_id": 97071676, "body": "Thank you very much for these advices! I have implemented all of your recommandations, and indeed the speed increased to a very acceptable level. Also great explanation on each tips, it really helped.  For the other questions, my SPI clock is set at 2 MHz (system constraint). I measured this to be &quot;slow&quot; because it was taking around 15 secs to print 4 number on the LCD screen. It was indeed the way that I used the switch function that slowed the data."}], "tags": [], "owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "is_accepted": true, "score": 1, "last_activity_date": 1552473322, "last_edit_date": 1552473322, "creation_date": 1552468573, "answer_id": 55138129, "question_id": 55130404, "link": "https://stackoverflow.com/questions/55130404/very-slow-spi-writing-stm32/55138129#55138129", "title": "Very slow SPI writing STM32", "body": "<p>I quite like the way you split your code into three snippets. I can suggest improvements for each of them:</p>\n\n<p><strong>switch_library_number_1()</strong>:</p>\n\n<ul>\n<li>This could be just a 2D array, <code>number[][]</code>, or if <code>number_0</code>, <code>number_1</code>... are not of the same length, it could be an array of pointers to these. There would need to be checks for valid <code>num</code> and <code>offset</code>. This might be a minor speed improvement.</li>\n<li>Your <code>number_0</code>... arrays are currently on stack, and read-write. Make them <code>const</code>, so they won't use RAM.</li>\n<li>Currently you are returning a pointer to memory location on stack - this doesn't normally work, if it does it's by luck and accident. You should not access stack data when you're out of scope (function) where it's been defined. <code>static const</code> would make this safe, as it wouldn't be on stack anymore.</li>\n</ul>\n\n<p><strong>main loop</strong>:</p>\n\n<ul>\n<li>It's a bit odd to call <code>switch_library_number_1/2</code> on each loop iteration. You know your data will just be in array. This could probably be replaced by <code>write_spi(number[0][i]);</code> if <code>number</code> array is properly set up. This should get you some speed improvement, as it very much simplifies data fetching.</li>\n<li>You appear to have a busy loop. That's a tricky practice (I bet <code>100</code> is a guess, and note that compiler could optimise this loop away). If possibly use some library provided delay function or a timer to get precise delays. Is this an actual requirement of SPI slave?</li>\n</ul>\n\n<p><strong>write_spi(char data)</strong>:</p>\n\n<ul>\n<li><code>char</code> should be <code>unsigned char</code> here. <code>char</code>s might be signed or unsigned, so when you're using them as bytes (not actual string characters), you should specify signedness.</li>\n<li>You seem to wait for every byte transmission to finish, which is safe, but a bit slow. Normally this can be rewritten into a faster alternative of <code>wait_for_SPI_ready_for_TX; SPI_TX</code>, where you only wait before sending next byte. Note that you will also need to wait for byte to be transmitted fully before pulling CS back high again. This could be a big speed improvement.</li>\n</ul>\n\n<p>Some other things to consider:</p>\n\n<ul>\n<li>What's the actual SPI clock? There may be huge speed improvements if clock is increased.</li>\n<li>How did you measure this to be \"slow\"? Does it point to slow parts of code (what are those then? If not obvious from C, what are they assembled to?)</li>\n<li>Have you got an oscilloscope/logic analyser to look at actual signals on wire? This may provide useful data.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552471597, "post_id": 55138907, "comment_id": 97018631, "body": "We don&#39;t even know if the code is using manual or automatic /SS, so you are just guessing here. Also, the problem you describe is typically an issue at the receiver-side hardware rather than on the MCU side. SPI is very poorly standardized and all manner of bastard hardware exists."}, {"owner": {"reputation": 53, "user_id": 9266154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/846a39e28dc25ffc348d16aa79d74b78?s=128&d=identicon&r=PG&f=1", "display_name": "\u0130lkerK", "link": "https://stackoverflow.com/users/9266154/%c4%b0lkerk"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1552560204, "post_id": 55138907, "comment_id": 97059945, "body": "I don&#39;t understand what you ment by manual/automatic, did you mean, \u0131f the code is using kernel drivers etc ? Anyways, In my case when I observe the TX line going out from SPI Peripheral of the MCU, I observed that it was taking too much time to set CS pin to high after all the data has sent. And configuration above fixed it.Though still you might be right, I am not such an expert. But I would be glad If you could explain how the receiver side could effect the transmission side. Is it like the RX capacitance effecting the corresponding flag register resulting in more time to flag to set in ?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1552564048, "post_id": 55138907, "comment_id": 97062377, "body": "Pretty much all SPI hardware has two options: the hardware can handle /SS automatically or otherwise you can do it manually with GPIO. The receiver-side hardware has timing specs, not necessarily following any standard."}, {"owner": {"reputation": 35, "user_id": 6499133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207335906815734/picture?type=large", "display_name": "Nathaniel Brochu", "link": "https://stackoverflow.com/users/6499133/nathaniel-brochu"}, "edited": false, "score": 0, "creation_date": 1552577065, "post_id": 55138907, "comment_id": 97071768, "body": "I do control the ss manually in my code. Thanks for the solution!"}], "tags": [], "owner": {"reputation": 53, "user_id": 9266154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/846a39e28dc25ffc348d16aa79d74b78?s=128&d=identicon&r=PG&f=1", "display_name": "\u0130lkerK", "link": "https://stackoverflow.com/users/9266154/%c4%b0lkerk"}, "is_accepted": false, "score": 0, "last_activity_date": 1552470884, "creation_date": 1552470884, "answer_id": 55138907, "question_id": 55130404, "link": "https://stackoverflow.com/questions/55130404/very-slow-spi-writing-stm32/55138907#55138907", "title": "Very slow SPI writing STM32", "body": "<p>I had a similar problem with STM32F207 Series Cortex-M3 controller, when I observed the TX line through Oscillator, I saw that CHIP_SELECT disable was taking too much time to set in, after all the data has sent.I figured out it is related to flag controls So \u0131 play with the control flags a little bit, Here how it worked out just fine for me;</p>\n\n<pre><code>static void SPI_Send(uint16_t len,uint8_t* data)\n{\n   uint16_t i;\n\n   for(i = 0;i&lt;len;i++)\n   {        \n     SPI_I2S_SendData(SPI1,*(data+i));\n     while(!(SPI1-&gt;SR &amp; SPI_SR_TXE));   \n   }    \n   while(SPI1-&gt;SR &amp; SPI_SR_BSY);\n   CHIP_SEL_DISABLE;\n}\n</code></pre>\n\n<p>I believe it is slow because you are also checking the 'Receive Buffer Not Empty' where you don't need to.</p>\n"}], "owner": {"reputation": 35, "user_id": 6499133, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207335906815734/picture?type=large", "display_name": "Nathaniel Brochu", "link": "https://stackoverflow.com/users/6499133/nathaniel-brochu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 0, "accepted_answer_id": 55138129, "answer_count": 2, "score": 1, "last_activity_date": 1564833245, "creation_date": 1552423660, "last_edit_date": 1564833245, "question_id": 55130404, "link": "https://stackoverflow.com/questions/55130404/very-slow-spi-writing-stm32", "title": "Very slow SPI writing STM32", "body": "<p>I am currently writing a code to write on an LCD screen pixel by pixel. The code works fine, however the speed at which the code is processed is incredibly slow. The goal is simply to write number on the LCD screen so I am using the \"switch\" function with a \"for loop\" to read each of the bit I will activate. I am wondering if someone could tell me a way to speed up my code...</p>\n\n<p>int* switch_library_number_1(int num, int octet)\n{</p>\n\n<pre><code>switch(num)\n{\n\ncase 0 : ;\n    int number_0 [] = {0x80, 0x08,\n              0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x88,\n              0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xE0, 0x00, 0x00, 0x00, ...};\n\n        int * pNumber_0 = &amp;number_0[octet];\n\n        return pNumber_0;\n          break;\n\ncase 1 : ;\n    int number_1 [] = {0x80, 0x08,\n              0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, \n0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x88, ...};\n\n    int * pNumber_1 = &amp;number_1[octet];\n\n    return pNumber_1;\n      break;\n}\n</code></pre>\n\n<p>Then it goes up to nine like that, I don't think you need to seem all the cases. Plus even if I deleted most of them, I have 522 bytes by number. The rest of the code goes as fallow :</p>\n\n<pre><code>int main(void)\n{\nADC_Initialization();\nSPI_Initialization();\nint nombre_octet = 522;\nint premier_nombre;\nint deuxieme_nombre;\n\nwhile(1)\n{\n    GPIOA-&gt;BSRRL = CS;\n    for(int i = 0; i &lt; nombre_octet; i++)\n    {\n        write_spi(*switch_library_number_1(0, i));\n    }\n    GPIOA -&gt; BSRRH = CS;\n\n    for(int i = 0; i &lt; 100; i++)\n            {\n            }\n\n    GPIOA-&gt;BSRRL = CS;\n    for(int i = 0; i &lt; nombre_octet; i++)\n    {\n        write_spi(*switch_library_number_2(1, i));\n    }\n    GPIOA -&gt; BSRRH = CS;\n\n    }\n}\n</code></pre>\n\n<p>Finally, here is the write_SPI function, but due to it's simplicity, I don't think that it is the problem.</p>\n\n<pre><code>void write_spi(char data)\n{\n    SPI1-&gt;DR = data;\n\n    while (!(SPI1-&gt;SR &amp; SPI_I2S_FLAG_TXE));\n    while (!(SPI1-&gt;SR &amp; SPI_I2S_FLAG_RXNE));\n    while (SPI1-&gt;SR &amp; SPI_I2S_FLAG_BSY);\n}\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "multidimensional-array", "segmentation-fault"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552422991, "post_id": 55130206, "comment_id": 97002102, "body": "Remember: In C parameters are passed by value. Whatever you assign to a parameter inside a function is not visible to the caller."}], "answers": [{"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 0, "last_activity_date": 1552423086, "creation_date": 1552423086, "answer_id": 55130283, "question_id": 55130206, "link": "https://stackoverflow.com/questions/55130206/c-segmentation-fault-print-2d-array/55130283#55130283", "title": "C Segmentation fault print 2d array", "body": "<p>You need to add another level of indirection to <code>createPlayground</code>:</p>\n\n<pre><code>void createPlayground(int size, int ***array) {\n    *array = (int **)malloc(size * sizeof(int *));\n    for (int i = 0; i &lt; size; ++i) {\n        (*array)[i] = (int *)calloc(size, sizeof(int));\n    }\n}\n</code></pre>\n\n<p>Call it like so:</p>\n\n<pre><code>createPlayground(size, &amp;playground);\n</code></pre>\n\n<p>Note that <code>printPlayground</code> is fine with its current signature since it doesn't modify the pointers.</p>\n"}], "owner": {"reputation": 23, "user_id": 11193485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01a43e8d1a39613cd1d5d711650e094?s=128&d=identicon&r=PG&f=1", "display_name": "Skulm4n", "link": "https://stackoverflow.com/users/11193485/skulm4n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 55130283, "answer_count": 1, "score": 2, "last_activity_date": 1552423180, "creation_date": 1552422768, "last_edit_date": 1552423180, "question_id": 55130206, "link": "https://stackoverflow.com/questions/55130206/c-segmentation-fault-print-2d-array", "title": "C Segmentation fault print 2d array", "body": "<p>When I try to call the function <code>createPlayground</code>, which should print a 2D array in C to the console I get a Segmentation fault. I don't know what is wrong.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nvoid createPlayground(int, int **);\nvoid printPlayground(int, int **);\n\nint main() {\n    int size = 8;\n    int **playground;\n\n    createPlayground(size, playground);\n\n    printPlayground(size, playground);\n\n    return 0;\n}\n\nvoid createPlayground(int size, int **array) {\n    array = (int **) malloc(size * sizeof(int *));\n    for (int i = 0; i &lt; size; ++i) {\n    array[i] = (int *) calloc(size, sizeof(int));\n    }\n}\n\nvoid printPlayground(int size, int **array) {\n    for (int i = 0; i &lt; size; ++i) {\n        for (int j = 0; j &lt; size; ++j){\n            printf(\"%d  \", array[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "math", "char", "trace"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1552421470, "post_id": 55129878, "comment_id": 97001450, "body": "<code>romanNum[i++] = &#39;M&#39;;</code> is writing the Roman numeral <code>&#39;M&#39;</code> into the array at the currrent index <code>romanNum[i]</code> and then incrementing the index <code>i</code> ready for the next Roman numeral. The program is like a &quot;change calculator&quot; but more compilated because of the way a Roman number is constructed."}, {"owner": {"reputation": 59, "user_id": 9426531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e088b6de203b8255d4c4abafcc46802?s=128&d=identicon&r=PG&f=1", "display_name": "Su.she", "link": "https://stackoverflow.com/users/9426531/su-she"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552421912, "post_id": 55129878, "comment_id": 97001648, "body": "@WeatherVane how though? the other numbers have a composition of different roman numerals with different values. For example, 999 is CMXCIX."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552421994, "post_id": 55129878, "comment_id": 97001683, "body": "@Su.she You do know how to read Roman numbers? Or is that part of the question?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552422111, "post_id": 55129878, "comment_id": 97001739, "body": "<code>romanNum[i++] = &#39;M&#39;;</code> is the same as <code>romanNum[i] = &#39;M&#39;; i = i + 1;</code> So it saves the character M in the array at index <code>i</code> and then increments <code>i</code>"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552422310, "post_id": 55129878, "comment_id": 97001815, "body": "Maybe this can help <a href=\"https://www.rapidtables.com/convert/number/roman-numerals-converter.html?x1=&amp;x2=999\" rel=\"nofollow noreferrer\">rapidtables.com/convert/number/&hellip;</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552422901, "post_id": 55129878, "comment_id": 97002069, "body": "<b>CM</b> = 1000 - 100 = 900. <b>MC</b> = 1000 + 100 = 1100. Similarly for <b>XC</b> and <b>IX</b>."}, {"owner": {"reputation": 59, "user_id": 9426531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e088b6de203b8255d4c4abafcc46802?s=128&d=identicon&r=PG&f=1", "display_name": "Su.she", "link": "https://stackoverflow.com/users/9426531/su-she"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552423399, "post_id": 55129878, "comment_id": 97002269, "body": "@4386427 question is incomment                                                                   <code>else if(temp &gt;=500)&#47;&#47;999..500 \t\t\t{\t \t\t\t\tif(temp &lt; (500 + 4 * 100))&#47;&#47;500..899 \t\t\t\t{\t\t\t\t\t \t\t\t\t\tfor(j=0;j&lt;(temp&#47;500);j++) \t\t\t\t\t&#47;&#47;[499+1]=D &#47;&#47;[500+1]=DI &#47;&#47;[501+1]=DII &#47;&#47;[502+1]=DII &#47;&#47;[503+1]=DIV ??? how did I and V come in this loop?? I know that 500=D and 4=IV                     romanNum[i++] = &#39;D&#39;; \t\t\t\ttemp = temp - (temp&#47;500) * 500;\t&#47;&#47;0\t\t\t \t\t\t\t} \t\t\t\telse&#47;&#47;900..999 \t\t\t\t{  \t\t\t\t\tromanNum[i++] = &#39;C&#39;;  \t\t\t\t\tromanNum[i++] = &#39;M&#39;;  \t\t\t\ttemp = temp - (1000-100);  &#47;&#47;0 \t\t\t\t} \t\t\t}</code>"}, {"owner": {"reputation": 59, "user_id": 9426531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e088b6de203b8255d4c4abafcc46802?s=128&d=identicon&r=PG&f=1", "display_name": "Su.she", "link": "https://stackoverflow.com/users/9426531/su-she"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1552423646, "post_id": 55129878, "comment_id": 97002374, "body": "@4386427 Idk how to put the codes in new line in the comment section so sorry for the messy look."}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1552426684, "creation_date": 1552426684, "answer_id": 55131013, "question_id": 55129878, "link": "https://stackoverflow.com/questions/55129878/in-c-program-i-am-having-trouble-tracing-a-code-that-produces-roman-numerals-fr/55131013#55131013", "title": "In C program, I am having trouble tracing a code that produces roman numerals from 1 to 1000 using loops?", "body": "<p>This code is more complicated than it needs to be (and contains a bug), so that isn't helping.  </p>\n\n<p>It may help to walk through an example.  Let's suppose that <code>num</code> is <code>2798</code> (it won't be since <code>num</code> maxes out at <code>1000</code> in the outermost loop, but I think this value will be more illustrative).  That will correspond to a Roman numeral of <code>MMDCCXCVIII</code>:</p>\n\n<pre><code>2000 = MM\n 700 = DCC\n  90 = XC\n   8 = VIII\n</code></pre>\n\n<p>Remember that <code>4</code>s and <code>9</code>s are weird:</p>\n\n<pre><code>   4 = IV (1 from 5)\n  40 = XL (10 from 50)\n 400 = CD (100 from 500)\n\n   9 = IX (1 from 10)\n  90 = XC (10 from 100)\n 900 = CM (100 from 1000)\n</code></pre>\n\n<p>So, we start by assigning <code>2798</code> to <code>temp</code>.  First we have to figure out how many thousands (<code>'M'</code>) need to be in the output:</p>\n\n<pre><code>if(temp&gt;= 1000)//1000 (highest number)=M\n{  \n  for(j=0;j&lt;(temp/1000);j++) //0&lt;1 \n    romanNum[i++] = 'M'; //1000=M      \n\n  temp = temp - (temp/1000) * 1000; //0\n}\n</code></pre>\n\n<p><code>temp</code> is greater than or equal to <code>1000</code>, so we enter the <code>for</code> loop.  <code>temp/1000</code> gives us <code>2</code> (integer division gives an integer result), so we need to write two <code>'M'</code>s to <code>romanNum</code>:</p>\n\n<pre><code>romanNum[i++] = 'M';  // this line gets executed twice.\n</code></pre>\n\n<p>so we have</p>\n\n<pre><code>romanNum[0] == 'M'\nromanNum[1] == 'M'\n</code></pre>\n\n<p>We then subtract that <code>2000</code> from <code>2798</code>, leaving us with <code>798</code> in <code>temp</code>.  Then we check to see if that result is greater than or equal to <code>500</code> (<code>'D'</code>):</p>\n\n<pre><code>else if(temp &gt;=500)//999..500\n</code></pre>\n\n<p>It is, so then we check to see if it's less than <code>900</code>:</p>\n\n<pre><code>  if(temp &lt; (500 + 4 * 100))//500..899\n</code></pre>\n\n<p>It is, so we just need to emit a single <code>D</code>:</p>\n\n<pre><code>    for(j=0;j&lt;(temp/500);j++)        // this loop is actually a bit meaningless,\n      romanNum[i++] = 'D';           // since temp &lt; 1000 at this point\n</code></pre>\n\n<p>and subtract 500 from <code>temp</code>:</p>\n\n<pre><code>temp = temp - (temp/500) * 500;      // again, temp is &lt; 1000, so this\n                                     // could be simplified as `temp - 500`\n</code></pre>\n\n<p>If it <em>had</em> been greater than <code>900</code>, we would have had to emit a <code>CM</code> and subtract <code>900</code> from <code>temp</code>:</p>\n\n<pre><code>else//900..999\n{ \n  romanNum[i++] = 'C'; \n  romanNum[i++] = 'M'; \n  temp = temp - (1000-100);  //0\n}\n</code></pre>\n\n<p>By this point <code>temp</code> is <code>298</code> and <code>romanNum</code> is</p>\n\n<pre><code>romanNum[0] == 'M'\nromanNum[1] == 'M'\nromanNum[2] == 'D'\n</code></pre>\n\n<p>Now we have to figure out how many remaining hundreds (<code>'C'</code>) need to go into the output:</p>\n\n<pre><code>else if(temp&gt;=100) //499..100\n</code></pre>\n\n<p>If <code>temp</code> is less than <code>400</code>, then we just need to emit <code>'C'</code>:</p>\n\n<pre><code>if(temp &lt; (100 + 3 * 100))//100..399\n{\n  for(j=0;j&lt;(temp/100);j++)\n    romanNum[i++] = 'C'; //\n  temp = temp - (temp/100) * 100;\n}\n</code></pre>\n\n<p>In our case it is, so we write two <code>'C'</code>s to <code>romanNum</code> and subtract <code>200</code> from <code>temp</code>, leaving us with <code>98</code> and</p>\n\n<pre><code>romanNum[0] == 'M'\nromanNum[1] == 'M'\nromanNum[2] == 'D'\nromanNum[3] == 'C'\nromanNum[4] == 'C'\n</code></pre>\n\n<p>Otherwise, we'd have to emit a <code>CD</code> (this code emits <code>LD</code>, which is not correct):</p>\n\n<pre><code>else //400..499\n{   \n  romanNum[i++] = 'L';\n  romanNum[i++] = 'D';\n  temp = temp - (500-100);\n}\n</code></pre>\n\n<p>You <em>should</em> be able to figure out the remainder from here.  Again, <code>4</code>s and <code>9</code>s are special cases.  </p>\n\n<p>For what it's worth, this code can be made <em>much</em> simpler:</p>\n\n<pre><code>while ( temp &gt;= 1000 )\n{\n  romanNum[i++] = 'M';\n  temp -= 1000;\n}\n\nif ( temp &gt;= 900 )\n{\n  romanNum[i++] = 'C';\n  romanNum[i++] = 'M';\n  temp -= 900;\n}\n\nif ( temp &gt;= 500 )\n{\n  romanNum[i++] = 'D';\n  temp -= 500;\n}\n\nif ( temp &gt;= 400 )\n{\n  romanNum[i++] = 'C';\n  romanNum[i++] = 'D';\n  temp -= 400;\n}\n\nwhile ( temp &gt;= 100 )\n{\n  romanNum[i++] = 'C';\n  temp -= 100;\n}\n\nif ( temp &gt;= 90 )\n{\n  romanNum[i++] = 'X';\n  romanNum[i++] = 'C';\n  temp -= 90;\n}\n\nif ( temp &gt;= 50 )\n{\n  romanNum[i++] = 'L';\n  temp -= 50;\n}\n\nif ( temp &gt;= 40 )\n{\n  romanNum[i++] = 'X';\n  romanNum[i++] = 'L';\n  temp -= 40;\n}\n\nwhile ( temp &gt;= 10 )\n{\n  romanNum[i++] = 'X';\n  temp -= 10;\n}\n\nif ( temp &gt;= 9 )\n{\n  romanNum[i++] = 'I';\n  romanNum[i++] = 'X';\n  temp -= 9;\n}\n\nif ( temp &gt;= 5 )\n{\n  romanNum[i++] = 'V';\n  temp -= 5;\n}\n\nit ( temp &gt;= 4 )\n{\n  romanNum[i++] = 'I';\n  romanNum[i++] = 'V';\n  temp -= 4;\n}\n\nwhile ( temp &gt;= 1 )\n{\n  romanNum[i++] = 'I';\n  temp--;\n}\n\nromanNum[i] = 0;\nprintf( \"%s\\n\", romanNum );\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9426531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e088b6de203b8255d4c4abafcc46802?s=128&d=identicon&r=PG&f=1", "display_name": "Su.she", "link": "https://stackoverflow.com/users/9426531/su-she"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 55131013, "answer_count": 1, "score": 0, "last_activity_date": 1552426684, "creation_date": 1552421185, "question_id": 55129878, "link": "https://stackoverflow.com/questions/55129878/in-c-program-i-am-having-trouble-tracing-a-code-that-produces-roman-numerals-fr", "title": "In C program, I am having trouble tracing a code that produces roman numerals from 1 to 1000 using loops?", "body": "<p>I am trying to trace a C program that converts integer numbers to char roman numerals from 1 to 1000. I don't understand how this code is converting every single number to a roman numeral. I think romanNum[i++] increments and temp values are doing the math but I am unsure about how. I was only able to trace the range of loops. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int num;\n    for (num = 1; num &lt;= 1000 ; ++num) //1000 loop\n    {\n        int temp = num; //store single values\n        char romanNum[1000]; \n        int i = 0; //to increment romanNum[i] //inside because it's getting increment inside the loop\n        int j; //for looping separate values\n        //1000=M, 500=D, 100=C, 50=L, 10=X, 5=V, 1=I\n        while(temp&gt;0) \n        {       \n            if(temp&gt;= 1000)//1000 (highest number)=M\n            {  \n                for(j=0;j&lt;(temp/1000);j++) //0&lt;1 \n                romanNum[i++] = 'M'; //1000=M               \n            temp = temp - (temp/1000) * 1000; //0\n            }\n            else if(temp &gt;=500)//999..500\n            {   \n                if(temp &lt; (500 + 4 * 100))//500..899\n                {                   \n                    for(j=0;j&lt;(temp/500);j++)\n                    romanNum[i++] = 'D';//\n                temp = temp - (temp/500) * 500; //0         \n                }\n                else//900..999\n                { \n                    romanNum[i++] = 'C'; \n                    romanNum[i++] = 'M'; \n                temp = temp - (1000-100);  //0\n                }\n            }\n            else if(temp&gt;=100) //499..100\n            {   \n                if(temp &lt; (100 + 3 * 100))//100..399\n                {\n                    for(j=0;j&lt;(temp/100);j++)\n                    romanNum[i++] = 'C'; //\n                temp = temp - (temp/100) * 100;\n                }\n                else //400..499\n                {   \n                    romanNum[i++] = 'L';\n                    romanNum[i++] = 'D';\n                temp = temp - (500-100);\n                }\n            }\n            else if(temp &gt;=50) //99..50\n            {\n                if(temp &lt; (50 + 4 * 10))//50..89\n                {\n                    for(j=0;j&lt;(temp/50);j++)\n                    romanNum[i++] = 'L';\n                temp = temp - (temp/50) * 50;\n                }\n                else //90..99\n                {\n                    romanNum[i++] = 'X';\n                    romanNum[i++] = 'C';\n                temp = temp - (100-10);\n                }\n            }\n            else if(temp &gt;=10)//49..10\n            {\n                if(temp &lt; (10 + 3 * 10))//10..39\n                {\n                    for(j=0;j&lt;(temp/10);j++)\n                    romanNum[i++] = 'X';\n                temp = temp - (temp/10) * 10;//0\n                }\n                else//40..49\n                {\n                    romanNum[i++] = 'X';\n                    romanNum[i++] = 'L';\n                temp = temp - (50-10);\n                }\n            }\n            else if(temp &gt;=5)//9..5\n            {\n                if(temp &lt; (5 + 4 * 1))//5..8\n                {\n                    for(j=0;j&lt;(temp/5);j++)\n                    romanNum[i++] = 'V';\n                temp = temp - (temp/5) * 5;//0\n                }\n                else//9\n                {\n                    romanNum[i++] = 'I';\n                    romanNum[i++] = 'X';\n                temp = temp - (10-1);//0\n                }\n            }\n            else if(temp &gt;=1)//4..1\n            {\n                if(temp &lt; 4)//1..3\n                {               \n                    for(j=0;j&lt;(temp/1);j++)\n                    romanNum[i++] = 'I';\n                temp = temp - (temp/1) * 1;\n                }\n                else//4\n                {   \n                    romanNum[i++] = 'I';\n                    romanNum[i++] = 'V';\n                temp = temp - (5-1);//0\n                }\n            }\n        }\n        printf(\"%d \", num);//1..1000\n\n        for(j=0;j&lt;i;j++)//to print romanNum\n        {\n            printf(\"%c\",romanNum[j]);//I..M\n        }\n        printf(\"\\n\");\n    }//end of 1000 loop\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1552420854, "post_id": 55129745, "comment_id": 97001109, "body": "<code>char hexa = 0</code> does not match any <code>switch</code> <code>case</code> and so <code>int num</code> remains <i>uninitialised</i>. Edit: <code>num</code> isn&#39;t used, what is that <code>switch</code> business for?"}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 1, "creation_date": 1552420899, "post_id": 55129745, "comment_id": 97001126, "body": "How are the three digits <code>192</code> of an address like <code>192.168.0.1</code> supposed to fit into a <code>char</code>?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1552421857, "post_id": 55129745, "comment_id": 97001617, "body": "@kaya - A char can hold a value between 0 an 256 (slightly different in unsigned but the range is the same"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1552422084, "post_id": 55129745, "comment_id": 97001721, "body": "<code>int main(void)</code>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1552422248, "post_id": 55129745, "comment_id": 97001793, "body": "@WilliamPursell - Why the <code>void</code> - not required"}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1552423559, "post_id": 55129745, "comment_id": 97002334, "body": "@EdHeal <a href=\"https://stackoverflow.com/questions/41803937/func-vs-funcvoid-in-c99\">about void</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552423870, "post_id": 55129745, "comment_id": 97002474, "body": "You might try to explain the code to your pet or <a href=\"https://rubberduckdebugging.com/\" rel=\"nofollow noreferrer\">Rubber duck</a>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552423914, "post_id": 55129745, "comment_id": 97002493, "body": "What is your exact input and output? You do not check return value of <code>scanf</code>. I would assume that the value is less than it should be. This would indicate a bunch of uninitialized variables for your <code>printf</code>"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 2, "creation_date": 1552424263, "post_id": 55129745, "comment_id": 97002635, "body": "Switch statement not required. Perahps an <code>if</code> statement and <code>num  = heax - &#39;A&#39; + 10</code> would be simplier"}, {"owner": {"reputation": 21, "user_id": 10786071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9a88de2642d4c32b4d6747cb3f9c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya", "link": "https://stackoverflow.com/users/10786071/kaya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552427258, "post_id": 55129745, "comment_id": 97003861, "body": "@WeatherVane Well, I should written it but because i cant use %x to get hexadecimal input I thought it is necessary to use switch statements."}, {"owner": {"reputation": 21, "user_id": 10786071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9a88de2642d4c32b4d6747cb3f9c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya", "link": "https://stackoverflow.com/users/10786071/kaya"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552427476, "post_id": 55129745, "comment_id": 97003944, "body": "@Gerhardh I&#39;m sorry english is not my main language but I will try to give a reasonable answer because I couldn&#39;t fully understand you. The input is let&#39;s say 192.168.1.1 as scanf(&quot;%c.%c.%c.%c&quot;, &amp;a, &amp;b, &amp;c, &amp;d) so when i try to output this as printf(&quot;%c.%c.%c.%c&quot;, a, b, c, d) I get &quot;...&quot;."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552427610, "post_id": 55129745, "comment_id": 97004006, "body": "%c does not fit for &quot;192&quot;. Check return value of scanf."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552427852, "post_id": 55129745, "comment_id": 97004099, "body": "The first <code>%c</code> will read the first digit which is the <code>1</code> of <code>192</code>."}, {"owner": {"reputation": 21, "user_id": 10786071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9a88de2642d4c32b4d6747cb3f9c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya", "link": "https://stackoverflow.com/users/10786071/kaya"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552428468, "post_id": 55129745, "comment_id": 97004330, "body": "@Gerhardh Actually anything more than 9.9.9.9 outputs (55.55.55.55) outputs something like 5. . .8 as you said 192 is not fit for char so what can i use? I am specially trying to use chars to check them later on if the user inputs anything in base 16. By the way I&#39;m really sorry if I say silly things but I&#39;m completely new to these stuff and honestly this assignment is a bit too hard i think."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1552428671, "post_id": 55129745, "comment_id": 97004402, "body": "Use <code>%d.%d.%d.%d</code> and pass the addresses of 4 <code>int</code> variables. Worry about why you (think you) need <code>char</code> later. Or, input one string with <code>%s</code> and analyse it at your leisure."}, {"owner": {"reputation": 21, "user_id": 10786071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9a88de2642d4c32b4d6747cb3f9c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya", "link": "https://stackoverflow.com/users/10786071/kaya"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552429238, "post_id": 55129745, "comment_id": 97004626, "body": "@WeatherVane It makes sense to use int variables for base 10. However if the user inputs FF printf(&quot;%c.%c.%c.%c&quot;, a, b, c, d) prints out F . . .8 I can&#39;t see any solutions for :(. By the way it is forbidden to use strings either."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1552430755, "post_id": 55129745, "comment_id": 97005103, "body": "<code>%c</code> does not read either decimal or hexadecimal. It reads a single character. One <code>%c</code> - one character. As above: input one string with <code>%s</code> and analyse it at your leisure. Incidentally I am curious as to how you would decide whether, say, <code>12</code> is decimal or hexadecimal."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552452514, "post_id": 55129745, "comment_id": 97009926, "body": "@WeatherVane the base is selected before entering the IP address."}, {"owner": {"reputation": 21, "user_id": 10786071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9a88de2642d4c32b4d6747cb3f9c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya", "link": "https://stackoverflow.com/users/10786071/kaya"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552489626, "post_id": 55129745, "comment_id": 97030784, "body": "@Gerhardh Well as I said the problem is I cant use %x, it is prohibited"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1552489672, "post_id": 55129745, "comment_id": 97030821, "body": "Sorry. missed that."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1552788736, "post_id": 55129745, "comment_id": 97143452, "body": "If you cannot use %x in scanf then you&#39;ll have to read and parse the stream yourself. Get one character, if it is between &#39;0&#39; and &#39;9&#39; subtract &#39;0&#39; from it otherwise use your switch block. Set your integer to it. Get the next character. Multiply value by your base, add the integer value of your character. When you hit a dot move to the next variable."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10786071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9a88de2642d4c32b4d6747cb3f9c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya", "link": "https://stackoverflow.com/users/10786071/kaya"}, "edited": false, "score": 0, "creation_date": 1552521635, "post_id": 55152211, "comment_id": 97046186, "body": "Hey Martin, I thank you for your answer and apologize if I didn&#39;t mention this before but I can&#39;t use strings as well as define. I kinda think this hw is unnecessary but the instructor insists on these terms saying they will be helpful later on. Today when I was trying to remember the things she told us, I remembered she talked about buffer. But still can&#39;t predict how to get base 16 input without using any of these."}, {"owner": {"reputation": 795, "user_id": 3726543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8859affbf397ef24de423d42f0203356?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3726543/martin"}, "reply_to_user": {"reputation": 21, "user_id": 10786071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9a88de2642d4c32b4d6747cb3f9c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya", "link": "https://stackoverflow.com/users/10786071/kaya"}, "edited": false, "score": 0, "creation_date": 1552590435, "post_id": 55152211, "comment_id": 97079720, "body": "As you may know, in C a string is a buffer of character. Let&#39;s wait some more information from your teacher then"}], "tags": [], "owner": {"reputation": 795, "user_id": 3726543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8859affbf397ef24de423d42f0203356?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3726543/martin"}, "is_accepted": true, "score": 0, "last_activity_date": 1552516694, "creation_date": 1552516694, "answer_id": 55152211, "question_id": 55129745, "link": "https://stackoverflow.com/questions/55129745/when-using-printf-for-char-only-outputs-the-dots/55152211#55152211", "title": "When using printf for char only outputs the dots", "body": "<p>Hi and welcome to stackoverflow !</p>\n\n<p>My answer will only help you about the base 16 part because you can easily do the base 10 based on what you already achieved and some hints i'm giving to you.</p>\n\n<p><strong>Parsing using base 16</strong></p>\n\n<p>Like you mentioned, you can't use %x to retrieve the IP address so another possibility is to use strings.\nAn IP address is digits from 0 to 255 so you can expect hex characters from 0x00 to 0xFF.</p>\n\n<p>To me, the best way to achieve that is to use a <a href=\"http://www.cplusplus.com/reference/cstdio/scanf/\" rel=\"nofollow noreferrer\">scanset</a> with the scanf function:</p>\n\n<pre><code>scanf(\"%2[0-9A-F]\", str);\n</code></pre>\n\n<p>Pattern %2[0-9A-F] means scanf is expecting at most two characters that must be any digits or any capital letters between A and F (so any hex character).\nNote, str length must be 3 to store 2 characters + the null terminator <code>\\0</code>.</p>\n\n<p>Then, str buffer will be filled with ASCII characters being a hex representation of the IP address. You can use the <a href=\"http://www.cplusplus.com/reference/cstdlib/strtol/\" rel=\"nofollow noreferrer\">strtol</a> function to convert a hex-representation-string to an integer.</p>\n\n<p>The full code is below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; // strol\n\n#define DIGIT_SIZE 3 // 2 hex digit + null character\n\nint main(void) {\n\n    char d1[DIGIT_SIZE];\n    char d2[DIGIT_SIZE];\n    char d3[DIGIT_SIZE];\n    char d4[DIGIT_SIZE];\n\n    scanf(\"%2[0-9A-F].%2[0-9A-F].%2[0-9A-F].%2[0-9A-F]\", d1, d2, d3, d4);\n\n    printf(\"hex ip:[%s.%s.%s.%s]\\n\", d1, d2, d3, d4);\n\n    int i1 = (int)strtol(d1, NULL, 16);\n    int i2 = (int)strtol(d2, NULL, 16);\n    int i3 = (int)strtol(d3, NULL, 16);\n    int i4 = (int)strtol(d4, NULL, 16);\n\n    printf(\"dec ip:[%d.%d.%d.%d]\\n\", i1, i2, i3, i4);\n\n    return 0;\n}\n</code></pre>\n\n<p>Few tries on my side:</p>\n\n<pre><code>$ 8.8.8.8  \n$ hex ip:[8.8.8.8]\n$ dec ip:[8.8.8.8]\n\n$ A.B.C.D\n$ hex ip:[A.B.C.D]\n$ dec ip:[10.11.12.13]\n\n$ FF.FF.FF.FF\n$ hex ip:[FF.FF.FF.FF]\n$ dec ip:[255.255.255.255]\n\n$ 0.0.0.0\n$ hex ip:[0.0.0.0]\n$ dec ip:[0.0.0.0]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1552793034, "creation_date": 1552793034, "answer_id": 55203557, "question_id": 55129745, "link": "https://stackoverflow.com/questions/55129745/when-using-printf-for-char-only-outputs-the-dots/55203557#55203557", "title": "When using printf for char only outputs the dots", "body": "<p>There are multiple problems in your code:</p>\n\n<ul>\n<li><p>The <code>switch</code> statement is useless as <code>hexa</code> has a constant value and <code>num</code> is not used anyway.</p></li>\n<li><p>You should parse decimal numbers with <code>%d</code>, <code>%u</code> or <code>%i</code> and hexadecimal numbers with <code>%x</code>.</p></li>\n<li><p>If you insist on storing le IP selectors as bytes, you should use <code>unsigned char</code> instead of plain <code>char</code> and use <code>%hhu</code> and <code>%hhx</code> respectively.</p></li>\n<li><p>The test for number validity is incorrect, it is an error to have any number outside the range <code>0..255</code>, so <code>||</code> is required between all tests.</p></li>\n<li><p>you should print the IP components with <code>%d</code>, not <code>%c</code>: <code>%c</code> output characters, not numbers. These characters probably are not printable, so only the dots appear.</p></li>\n</ul>\n\n<p>Here is a modified version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int base, a, b, c, d, x, y, z, t, n, choice;\n\n    printf(\"Please enter the base: \");\n    if (scanf(\"%d\", &amp;base) != 1)\n        return 1;\n\n    if (base != 10 &amp;&amp; base != 16) {\n        printf(\"invalid base\\n\");\n        return 1;\n    }\n\n    printf(\"Please enter your IP address: \");\n    if (base == 10) {\n        n = scanf(\"%d.%d.%d.%d\", &amp;a, &amp;b, &amp;c, &amp;d);\n    } else {\n        n = scanf(\"%x.%x.%x.%x\", &amp;a, &amp;b, &amp;c, &amp;d);\n    }\n    if (n != 4) {\n        printf(\"invalid input\\n\");\n        return 1;\n    }\n    if (a &lt; 0 || a &gt; 255 || b &lt; 0 || b &gt; 255 || c &lt; 0 || c &gt; 255 || d &lt; 0 || d &gt; 255) {\n        printf(\"invalid IP address\\n\");\n        return 1;\n    }\n    printf(\"Please enter the sub-net mask: \");\n    if (base == 10) {\n        n = scanf(\"%d.%d.%d.%d\", &amp;x, &amp;y, &amp;z, &amp;t);\n    } else {\n        n = scanf(\"%x.%x.%x.%x\", &amp;x, &amp;y, &amp;z, &amp;t);\n    }\n    if (n != 4) {\n        printf(\"invalid input\\n\");\n        return 1;\n    }\n    if (x &lt; 0 || x &gt; 255 || y &lt; 0 || y &gt; 255 || z &lt; 0 || z &gt; 255 || t &lt; 0 || t &gt; 255) {\n        printf(\"invalid sub-net mask\\n\");\n        return 1;\n    }\n\n    if (scanf(\"%d\", &amp;choice) != 1) {\n        printf(\"invalid input\\n\");\n        return 1;\n    }\n    switch (choice) {\n      case 1:\n        printf(\"%d.%d.%d.%d\\n\", a, b, c, d);\n        break;\n      case 2:\n      case 3:\n      case 4:\n      case 5:\n      case 6:\n        break;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Note that there is a way to compact the validity test:</p>\n\n<pre><code>    if (((a | b | c | d) &amp; ~255U) {\n        printf(\"invalid IP address\\n\");\n        return 1;\n    }\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10786071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daa9a88de2642d4c32b4d6747cb3f9c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kaya", "link": "https://stackoverflow.com/users/10786071/kaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 55152211, "answer_count": 2, "score": 1, "last_activity_date": 1552793034, "creation_date": 1552420673, "last_edit_date": 1552791517, "question_id": 55129745, "link": "https://stackoverflow.com/questions/55129745/when-using-printf-for-char-only-outputs-the-dots", "title": "When using printf for char only outputs the dots", "body": "<p>I'm currently working on a homework and can't get the result I want from the code below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int base, num, x, y, z, t, choice;\n    char hexa = 0, a, b, c, d, k, l, m, n, h, g, f, v;\n\n    switch (hexa) {\n    case 'A':\n        num = 10;\n        break;\n    case 'B':\n        num = 11;\n        break;\n    case 'C':\n        num = 12;\n        break;\n    case 'D':\n        num = 13;\n        break;\n    case 'E':\n        num = 14;\n        break;\n    case 'F':\n        num = 15;\n        break;\n    }\n\n    printf(\"Please enter the base:\\n\");\n    scanf(\"%d\", &amp;base);\n\n    if (base == 10) {\n        printf(\"Please enter your ip address:\\n\");\n        scanf(\"%c.%c.%c.%c\", &amp;a, &amp;b, &amp;c, &amp;d);\n\n        //if((a&lt;0 || a&gt;255) &amp;&amp; (b&lt;0 || b&gt;255) &amp;&amp; (c&lt;0 || c&gt;255) &amp;&amp; (d&lt;0 || d&gt;255)){ //FIX THIS\n        //  printf(\"Sorry, that is not a valid address!\");}\n        printf(\"Please enter the sub-net mask\\n\"); //Skips this line\n        scanf(\"%d.%d.%d.%d\", &amp;x, &amp;y, &amp;z, &amp;t);\n    }\n    else if (base == 16) {\n        printf(\"Enter your ip address\\n\");\n        scanf(\"%c.%c.%c.%c\", &amp;k, &amp;l, &amp;m, &amp;n);\n        printf(\"Enter the subnet mask\\n\");\n        scanf(\"%c.%c.%c.%c\", &amp;h, &amp;g, &amp;f, &amp;v);\n    }\n\n    scanf(\"%d\", &amp;choice);\n\n    if (choice == 1) { //there is a part that asks which \n        printf(\"%c.%c.%c.%c\", a, b, c, d); //prints only dots\n    }\n    else if (choice == 2) {}\n    else if (choice == 3) {}\n    else if (choice == 4) {}\n    else if (choice == 5) {}\n    else if (choice == 6) {}\n\n    return 0;\n}\n</code></pre>\n\n<p>So basically I'm trying to get an IP and subnet and convert it to binary but as instructed I can't use bitwise shift and <code>%x</code> to get the IP address as base 16. The problem is when I try to print the IP address given <code>printf</code> only prints dots and nothing else. And also one of the skips the subnet mask <code>scanf</code>. I would be really glad if I can get some help from you guys as I don't have many friends to ask questions. Thanks.</p>\n\n<p><strong>EDIT</strong>: I don't know if anyone is going to face this problem but my solution was rather silly but it works. You basically take the input as <code>scanf(\"%c%c.%c%c.%c%c.%c%c%c\")</code>, the last <code>%c</code> is for the enter as char takes enter as input.</p>\n"}, {"tags": ["c", "xcode", "gcc"], "comments": [{"owner": {"reputation": 82, "user_id": 10928238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NOFchza2mDc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcacAvV_RSY1UiEv8qFqATaPGkQhZQ/mo/photo.jpg?sz=128", "display_name": "Diego ROJAS", "link": "https://stackoverflow.com/users/10928238/diego-rojas"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552420319, "post_id": 55129558, "comment_id": 97000849, "body": "By that I want to reply, I know right tho the error persists"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552420529, "post_id": 55129558, "comment_id": 97000956, "body": "You must check the return value from <code>getline</code>, as with any user input function."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1552421976, "post_id": 55129558, "comment_id": 97001676, "body": "@DiegoROJAS you missed to initialize <i>input</i> this is why you have your error,  some <i>free</i> are also missing, see my answer"}], "answers": [{"comments": [{"owner": {"reputation": 82, "user_id": 10928238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NOFchza2mDc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcacAvV_RSY1UiEv8qFqATaPGkQhZQ/mo/photo.jpg?sz=128", "display_name": "Diego ROJAS", "link": "https://stackoverflow.com/users/10928238/diego-rojas"}, "edited": false, "score": 0, "creation_date": 1552425989, "post_id": 55129767, "comment_id": 97003343, "body": "Thank you so much for your very detailed and clear answer. Do you have any idea why the program doesn&#39;t crash on windows?"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 3, "last_activity_date": 1552421745, "last_edit_date": 1552421745, "creation_date": 1552420752, "answer_id": 55129767, "question_id": 55129558, "link": "https://stackoverflow.com/questions/55129558/pointer-being-reallocd-was-not-allocated-set-a-breakpoint-in-malloc-error-brea/55129767#55129767", "title": "Pointer being realloc&#39;d was not allocated, set a breakpoint in malloc_error_break to debug", "body": "<p>In <em>main</em> :</p>\n\n<blockquote>\n<pre><code> char *input;\n ...\n getline(&amp;input, &amp;n, stdin);\n</code></pre>\n</blockquote>\n\n<p>you call <em>getline</em> without initializing <em>input</em>, if the (undefined) value is not NULL <em>getline</em> will freed it and because it is not the address of an allocated block you have your error</p>\n\n<p>you need for instance :</p>\n\n<pre><code>  input = NULL;\n  getline(&amp;input, &amp;n, stdin);\n  move = atoi(input);\n\n  if (move &gt; 3 || move &lt; 1 ) {\n       move = 1;\n  }\n  free(input);\n</code></pre>\n\n<p>You have a similar error in <em>setup</em> :</p>\n\n<blockquote>\n<pre><code>char *input;\n...\ngetline(&amp;input, &amp;n, stdin);\n...\ngetline(&amp;input, &amp;n, stdin);\n</code></pre>\n</blockquote>\n\n<p>you need to set <em>input</em> to NULL before the first call of <em>getline</em>, and you need a <em>free</em> after the last call, for instance :</p>\n\n<pre><code>char *input;\n...\ninput = NULL;\ngetline(&amp;input, &amp;n, stdin);\n...\ngetline(&amp;input, &amp;n, stdin);\n*numberOfMatchesA = atoi(input);\nfree(input);\n</code></pre>\n\n<p>Additional remarks :</p>\n\n<ul>\n<li>you miss to check the result of <em>getline</em></li>\n<li>to use <em>atoi</em> is not secure, you get 0 if the user enter something wrong, better to use <em>strtod</em> or <em>sscanf</em></li>\n<li>in <em>main</em> rather than to force 1 when the input value if not between 1 and 3  it seems better to redo the input</li>\n</ul>\n"}], "owner": {"reputation": 82, "user_id": 10928238, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-NOFchza2mDc/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcacAvV_RSY1UiEv8qFqATaPGkQhZQ/mo/photo.jpg?sz=128", "display_name": "Diego ROJAS", "link": "https://stackoverflow.com/users/10928238/diego-rojas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 1, "accepted_answer_id": 55129767, "answer_count": 1, "score": 1, "last_activity_date": 1552421745, "creation_date": 1552419877, "question_id": 55129558, "link": "https://stackoverflow.com/questions/55129558/pointer-being-reallocd-was-not-allocated-set-a-breakpoint-in-malloc-error-brea", "title": "Pointer being realloc&#39;d was not allocated, set a breakpoint in malloc_error_break to debug", "body": "<p>I've been developing this very simple C game on Windows where I've used the command <code>gcc matches.c -o ./matches</code> to compile it.\nI've imported the code on my Mac and I recompiled it using <code>gcc</code> and <code>clang</code>.\nUsing both techniques the program completely crashes sometimes closing my terminal session and outputs this.</p>\n\n<pre><code>matches(54122,0x1137715c0) malloc: *** error for object 0x7ffee9e8ba40: pointer being realloc'd was not allocated\nmatches(54122,0x1137715c0) malloc: *** set a breakpoint in malloc_error_break to debug\nAbort trap: 6\n\nBroadcast Message from _appleevents@(myname).local                                \n        (no tty) at 20:33 CET...                                               \n\nmatches(54122,0x1137715c0) malloc: *** error for object 0x7ffee9e8ba40: pointer\n being realloc'd was not allocated\n</code></pre>\n\n<p>The code was completely bug free on Windows.</p>\n\n<p>I think it has to do with xcode or something similar.\nDoes anyone know how to solve this issue?</p>\n\n<p>By the way, here's the code. The program crashes in the setup function upon <code>getline()</code> </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid show_matches(int n);\nvoid setup(int *numberOfPlayersA, int *gamemodeA, int *numberOfMatchesA);\nvoid changePlayersTurn(int *currentPlayerA, int numberOfPlayers);\nint random_move();\n\nint main(void) {\n  char *input;\n  int currentPlayer = 1;\n  size_t n = 0;\n  int numberOfPlayers = 0;\n  int gamemode = 0;\n  int numberOfMatches = 0;\n  int move = 0;\n\n  setup(&amp;numberOfPlayers, &amp;gamemode, &amp;numberOfMatches);\n  show_matches(numberOfMatches);\n\n  while (numberOfMatches &gt;= 1) {\n    printf(\"\\033[1;31m\");\n    printf(\"\\n\\nPlayer %d&gt; \", currentPlayer);\n    printf(\"\\033[0m\");\n\n    if (gamemode == 2 || currentPlayer == 1) {\n      getline(&amp;input, &amp;n, stdin);\n      move = atoi(input);\n\n      if (move &gt; 3 || move &lt; 1 ) {\n           move = 1;\n      }\n    } else {\n      int randomMove = random_move();\n      move = randomMove;\n      printf(\"%d\", randomMove);\n    }\n\n\n\n    numberOfMatches -= move;\n    show_matches(numberOfMatches);\n\n\n    if (numberOfMatches &gt;= 1) {\n      changePlayersTurn(&amp;currentPlayer, numberOfPlayers);\n    }\n  }\n\n\n  printf(\"\\n\\nPlayer %d lost\\n\\n\", currentPlayer);\n\n  return 0;\n}\n\nvoid setup(int *numberOfPlayersA, int *gamemodeA, int *numberOfMatchesA) {\n  char *input;\n  size_t n = 0;\n\n  printf(\"--The matches--\\n\\n\");\n  printf(\"Do you plan on playing against:\\n\\t1. The computer\\n\\t2. Other persons\\n\\n(1 / 2) &gt; \");\n  getline(&amp;input, &amp;n, stdin);\n  printf(\"1\");\n  *gamemodeA = atoi(input);\n  printf(\"2\");\n  if (*gamemodeA == 2) {\n    printf(\"\\n\\nPlease enter the number of players: \");\n    getline(&amp;input, &amp;n, stdin);\n    *numberOfPlayersA = atoi(input);\n  }\n  printf(\"Enter the number of matches: \");\n  getline(&amp;input, &amp;n, stdin);\n  *numberOfMatchesA = atoi(input);\n  *numberOfPlayersA = 2;\n  printf(\"4\");\n}\n\nvoid changePlayersTurn(int *currentPlayerA, int numberOfPlayers) {\n  if (*currentPlayerA == numberOfPlayers) {\n    *currentPlayerA = 1;\n  } else {\n    *currentPlayerA += 1;\n  }\n}\n\nvoid show_matches(int n) {\n  for (int i = 0; i &lt; n; i++) {\n    printf(\"|\");\n  }\n}\n\nint random_move() {\n  int num = (rand() % (3 - 1 + 1)) + 1;\n  return num;\n}\n</code></pre>\n"}, {"tags": ["c", "multidimensional-array"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1552419991, "post_id": 55129534, "comment_id": 97000685, "body": "You only have a single array in which you store the values.  You then create <code>n</code> references to the same array.  How could the values <i>possibly</i> be different?  If you want <code>n</code> different arrays of values, then you have to <i>have</i> <code>n</code> different arrays of values.  You only have one."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1552420119, "post_id": 55129534, "comment_id": 97000758, "body": "<code>float p[n][d];</code> and <code>memcpy(p[i], arr, sizeof arr);</code> or get rid of <code>arr</code> change the loop body to <code>p[i][j] = rand() % 100;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1552420635, "last_edit_date": 1552420635, "creation_date": 1552420023, "answer_id": 55129588, "question_id": 55129534, "link": "https://stackoverflow.com/questions/55129534/how-to-generate-multiple-arrays-of-random-numbers-in-c/55129588#55129588", "title": "How to generate multiple arrays of random numbers in C", "body": "<p>It is the pointer to the same array that you save into all elements of <code>p</code>, i.e. all elements point to <code>arr</code> and thereby the the values from the last loop </p>\n\n<p>You need code like:</p>\n\n<pre><code>int n=100,d=5;\nfloat arr[n][d];\n\nsrand(time(NULL));\nfor (int i = 0; i &lt; n; i++){   \n    for(int j=0; j&lt;d;j++){\n        arr[i][j] = rand()%100;\n    }\n}\n</code></pre>\n\n<p>so that you have a true array of array (aka 2D array), i.e. <code>float arr[n][d];</code></p>\n\n<p>Alternatively you can make the array <code>arr</code> using dynamic allocation - like:</p>\n\n<pre><code>int n=100,d=5;\nfloat *p[n];\nfloat* arr;\n\nsrand(time(NULL));\nfor (int i = 0; i &lt; n; i++){   \n    arr = malloc(d * sizeof *arr);  // alloc array for this loop\n    if (arr == NULL) exit(1);\n    for(int j=0; j&lt;d;j++){\n        arr[j] = rand()%100;\n    }\n    p[i] = arr;\n}\n</code></pre>\n\n<p>The second solution is best in case you have large values of <code>n</code> and <code>d</code> (i.e. to avoid stack overflow)</p>\n"}, {"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 0, "last_activity_date": 1552420762, "last_edit_date": 1552420762, "creation_date": 1552420218, "answer_id": 55129638, "question_id": 55129534, "link": "https://stackoverflow.com/questions/55129534/how-to-generate-multiple-arrays-of-random-numbers-in-c/55129638#55129638", "title": "How to generate multiple arrays of random numbers in C", "body": "<p>Seed <em>only once</em>.</p>\n\n<p>You could use a double for loop and two indices to populate your 2D array, like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint main(void) {\n    srand(time(NULL));\n    const int n = 100, d = 5;\n    float matrix[n][d];\n    for (int i = 0 ; i &lt; n ; ++i)\n      for(int j = 0; j &lt; d; ++j)\n        matrix[i][j] = rand() % 100;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 80, "user_id": 5537052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f1b2173381c35011d7350cf117988e7?s=128&d=identicon&r=PG&f=1", "display_name": "Visionary Zen", "link": "https://stackoverflow.com/users/5537052/visionary-zen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 780, "favorite_count": 0, "accepted_answer_id": 55129588, "answer_count": 2, "score": 1, "last_activity_date": 1552420762, "creation_date": 1552419780, "last_edit_date": 1552420309, "question_id": 55129534, "link": "https://stackoverflow.com/questions/55129534/how-to-generate-multiple-arrays-of-random-numbers-in-c", "title": "How to generate multiple arrays of random numbers in C", "body": "<p>I need to create an array of arrays in C where each array has random values. When I run my code however I get the same set of numbers repeated for each inner array. I've tried to seed inside my inner loop and that is not working for me. How can I generate multiple arrays with random numbers?</p>\n\n<pre><code>int n=100,d=5;\nfloat *p[n];\nfloat arr[d];\n\nsrand(time(NULL));\nfor (int i = 0; i &lt; n; i++){   \n    for(int j=0; j&lt;d;j++){\n        arr[j] = rand()%100;\n    }\n    p[i] = arr;\n}\n</code></pre>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1552419311, "post_id": 55129399, "comment_id": 97000398, "body": "Your <code>file</code> doesn&#39;t have enough space to store the string with null-terminator. UB as it is."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1552419398, "post_id": 55129399, "comment_id": 97000435, "body": "The string <code>&quot;file.txt&quot;</code> is 9 characters, not 8:  The 8 printable characters plus 1 null byte.  But rather than counting them, which as you&#39;ve seen is quite error-prone, why not just do <code>char file[] = &quot;test.txt&quot;;</code>  The compiler will then determine the size for you."}, {"owner": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 2, "creation_date": 1552419408, "post_id": 55129399, "comment_id": 97000440, "body": "<code>ch</code> is undeclared. It should be an <code>int</code>"}, {"owner": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1552419530, "post_id": 55129399, "comment_id": 97000490, "body": "@Tom Karzes, seems to be unrelated, I changed the code to char file[] = &quot;test.txt&quot;, still same issue"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 3, "creation_date": 1552419561, "post_id": 55129399, "comment_id": 97000505, "body": "<i>&quot;The code works perfectly,... the program would get stuck&quot;</i> is a bit weird version of &quot;perfect&quot; ;-)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552419609, "post_id": 55129399, "comment_id": 97000529, "body": "If your problem is not solved by the suggestions above, then post <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1552419650, "post_id": 55129399, "comment_id": 97000554, "body": "@Ach113 Probably, if the first byte after the string happened to contain zero.  But you&#39;re also not checking to see if the <code>open()</code> call succeeded, so you don&#39;t really know if it did."}, {"owner": {"reputation": 734, "user_id": 11064535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u7DNH.jpg?s=128&g=1", "display_name": "B. Shefter", "link": "https://stackoverflow.com/users/11064535/b-shefter"}, "edited": false, "score": 0, "creation_date": 1552419686, "post_id": 55129399, "comment_id": 97000563, "body": "How does your code declare <code>output</code>?"}, {"owner": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552419709, "post_id": 55129399, "comment_id": 97000570, "body": "@Eugene, I will update the post with full code"}, {"owner": {"reputation": 734, "user_id": 11064535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u7DNH.jpg?s=128&g=1", "display_name": "B. Shefter", "link": "https://stackoverflow.com/users/11064535/b-shefter"}, "edited": false, "score": 0, "creation_date": 1552419890, "post_id": 55129399, "comment_id": 97000656, "body": "How large is &quot;test.txt&quot;?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 12179, "user_id": 1480131, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WZPm4.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/1480131/pablo"}, "edited": false, "score": 0, "creation_date": 1552419929, "post_id": 55129399, "comment_id": 97000670, "body": "As @Pablo said, <code>ch</code> needs to be <code>int</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552419994, "post_id": 55129399, "comment_id": 97000690, "body": "Does <code>if (!strcmp(output, &quot;&quot;))</code> do what you want? That says &quot;if the string is empty...&quot;"}, {"owner": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552420013, "post_id": 55129399, "comment_id": 97000694, "body": "@Weather, that is for initializating the output string, that line checks that its empty, and if it is, writes string directly to output using strcpy() instead of strcat()"}, {"owner": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552420051, "post_id": 55129399, "comment_id": 97000717, "body": "@Eugene, same issue regardless of ch being int or char"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552420106, "post_id": 55129399, "comment_id": 97000755, "body": "Your <code>concatenate()</code> function builds a string from all the input words, but it only has the capacity for 99 characters, some of which will be spaces, plus a terminator.  Why concatenate at all?  Why not just print the words you&#39;ve found directly?"}, {"owner": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "reply_to_user": {"reputation": 734, "user_id": 11064535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u7DNH.jpg?s=128&g=1", "display_name": "B. Shefter", "link": "https://stackoverflow.com/users/11064535/b-shefter"}, "edited": false, "score": 0, "creation_date": 1552420284, "post_id": 55129399, "comment_id": 97000838, "body": "@B. Shefter just 38 bytes"}, {"owner": {"reputation": 734, "user_id": 11064535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u7DNH.jpg?s=128&g=1", "display_name": "B. Shefter", "link": "https://stackoverflow.com/users/11064535/b-shefter"}, "edited": false, "score": 0, "creation_date": 1552421035, "post_id": 55129399, "comment_id": 97001200, "body": "When the code gets stuck, does it get stuck before or after printing <code>output</code>?"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1552425037, "post_id": 55129399, "comment_id": 97002938, "body": "Looks like a good use of a hash table."}], "answers": [{"comments": [{"owner": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "edited": false, "score": 0, "creation_date": 1552421257, "post_id": 55129851, "comment_id": 97001341, "body": "That fixed it, interestingly I have used exact same code for traversing the file before but have never encountered this problem, thank you!"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "edited": false, "score": 1, "creation_date": 1552421323, "post_id": 55129851, "comment_id": 97001372, "body": "@Ach113 That&#39;s undefined behavior for you.  In some cases the array might happen to have all zeros to start, in some cases in may have none."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "reply_to_user": {"reputation": 734, "user_id": 11064535, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u7DNH.jpg?s=128&g=1", "display_name": "B. Shefter", "link": "https://stackoverflow.com/users/11064535/b-shefter"}, "edited": false, "score": 0, "creation_date": 1552424914, "post_id": 55129851, "comment_id": 97002898, "body": "@B.Shefter that guarantees that &#39;\\0&#39; is in the first byte, I&#39;m not sure about what the standard says will be the rest, but I assume that they are undefined?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 2, "creation_date": 1552426842, "post_id": 55129851, "comment_id": 97003678, "body": "@NeilEdelman It works.  When an initializer is present, any bytes not explicitly initialized are implicitly initialized to 0."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1552421061, "creation_date": 1552421061, "answer_id": 55129851, "question_id": 55129399, "link": "https://stackoverflow.com/questions/55129399/c-code-gets-stuck-unless-i-call-printf-function/55129851#55129851", "title": "C code gets stuck unless I call printf() function", "body": "<p>This is where you go wrong:</p>\n\n<pre><code>else //otherwise chars of a word get appended to string array\n{\n  str[i] = ch;\n  i++;\n}\n</code></pre>\n\n<p>When you first enter the main loop, <code>str</code> is uninitialized.  That means that when you append characters to <code>str[i]</code> there is no terminating null byte at the end of the string.  This causes string functions like <code>strlen</code> and <code>strcpy</code> to potentially read past the end of the array, invoking <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>You can fix this by initializing <code>str</code> to all zeros:</p>\n\n<pre><code>char str[100] = {0};\n</code></pre>\n\n<p>The <code>memset</code> call after copying the string clears it out for subsequent words.</p>\n\n<p>Also, this is not the best use of <code>goto</code>:</p>\n\n<pre><code>  for(int x=0; x&lt;j; x++)\n  {\n    //if current str is already in array, skip appending\n    if (!strcmp(str_array[x], str)) goto ELSE; \n  }\n  strcpy(str_array[j], str);\n  j++;\nELSE:\n  i=0;\n  memset(str, 0, strlen(str));\n</code></pre>\n\n<p>It would be cleaner to set a flag if your search was successful and act on that when you exit the loop:</p>\n\n<pre><code>  int found = 0;\n  for(int x=0; x&lt;j; x++)\n  {\n    //if current str is already in array, skip appending\n    if (!strcmp(str_array[x], str)) {\n        found = 1;\n        break;\n    }\n  }\n  if (found) {\n    strcpy(str_array[j], str);\n    j++;\n  }\n  i=0;\n  memset(str, 0, strlen(str));\n}\n</code></pre>\n"}], "owner": {"reputation": 1140, "user_id": 9642804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoDuW.jpg?s=128&g=1", "display_name": "Ach113", "link": "https://stackoverflow.com/users/9642804/ach113"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 55129851, "answer_count": 1, "score": 2, "last_activity_date": 1552421330, "creation_date": 1552419210, "last_edit_date": 1552420586, "question_id": 55129399, "link": "https://stackoverflow.com/questions/55129399/c-code-gets-stuck-unless-i-call-printf-function", "title": "C code gets stuck unless I call printf() function", "body": "<p>I have a code that reads text file, tokenizes words in it, then selects only unique words from text, concatenates them and prints them using puts() function.\nHere is full code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar str_array[100][100];\nchar output[100];\n\nvoid concatenate(int index)\n{\n  // compares output with empty string\n  if (!strcmp(output, \"\")) \n  {\n    strcpy(output, str_array[index]);\n  }\n\n  else //else existing string is contcatenated\n  {\n    strcat(output, \" \"); // add space\n    strcat(output, str_array[index]);\n  }\n}\n\nvoid unique_selection(char file[])\n{\n  FILE *F = fopen(file, \"r\");\n  char ch; char str[100];\n  int i=0, j=0;\n\n  while ((ch=getc(F)) != EOF) \n  {\n    // if space or newline is detected i.e. word is finished\n    if (ch == ' ' || ch == '\\n') \n    {\n      //traverse array of strings\n      for(int x=0; x&lt;j; x++)\n      {\n        //if current str is already in array, skip appending\n        if (!strcmp(str_array[x], str)) goto ELSE; \n      }\n      strcpy(str_array[j], str);\n      j++;\n    ELSE:\n      i=0;\n      memset(str, 0, strlen(str));\n    }\n    else //otherwise chars of a word get appended to string array\n    {\n      str[i] = ch;\n      i++;\n    }\n  }\n\n  for(int k=0; k&lt;j; k++)\n  {\n    concatenate(k);\n  }\n  puts(output);\n  fclose(F);\n}\n\nint main(void) {\n  char file[] = \"test.txt\";\n  //printf(\"Output:\");\n  unique_selection(file);\n  return 0;\n}\n</code></pre>\n\n<p>The code works perfectly, but I came across a weird issue, every time I tried printing the output string (using <code>puts()</code> or <code>printf(\"%s\")</code> the program would get stuck, similarly to what happens when loop is iterating forever. And weirdly this issue was fixed by putting the printf before the function call. If I remove <code>puts()</code> from function, code runs like normal even with or without the printf in <code>main()</code>. </p>\n\n<p>Why is this happening?</p>\n"}, {"tags": ["c", "pipe", "fork", "pipeline", "interprocess"], "comments": [{"owner": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1552418721, "post_id": 55129223, "comment_id": 97000108, "body": "Put a <code>break;</code> in the block after <code>if (r == 0)</code>, or more likely an <code>exit()</code>."}, {"owner": {"reputation": 23, "user_id": 11193313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c9792b072e7d09f87cb485c3317811?s=128&d=identicon&r=PG&f=1", "display_name": "Hugh N.", "link": "https://stackoverflow.com/users/11193313/hugh-n"}, "reply_to_user": {"reputation": 22422, "user_id": 634919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f4a87fe094961af20263d8e7ff445b2?s=128&d=identicon&r=PG", "display_name": "Nate Eldredge", "link": "https://stackoverflow.com/users/634919/nate-eldredge"}, "edited": false, "score": 0, "creation_date": 1552419065, "post_id": 55129223, "comment_id": 97000285, "body": "I would also like for the parent to work with the children together. For example, the child processes will constantly write random integers to their respective pipe and have the parent pick which random number is the smallest among the pipes that have something written to them. I&#39;ve searched online and people have mentioned threading but is this possible with pipe?"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1552420309, "post_id": 55129223, "comment_id": 97000845, "body": "&quot;n children, each with their own pipe&quot;.  Does the parent keep the other end of each pipe open, or is child M connected to child M+1, or ...?  Who has the other end of the pipe?  That will greatly determine the structure of the loop."}, {"owner": {"reputation": 23, "user_id": 11193313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c9792b072e7d09f87cb485c3317811?s=128&d=identicon&r=PG&f=1", "display_name": "Hugh N.", "link": "https://stackoverflow.com/users/11193313/hugh-n"}, "edited": false, "score": 0, "creation_date": 1552420418, "post_id": 55129223, "comment_id": 97000891, "body": "The parent will only be reading from the n pipes where each child will have a pipe that it only writes to. Sorry if I wasn&#39;t clear!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11193313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c9792b072e7d09f87cb485c3317811?s=128&d=identicon&r=PG&f=1", "display_name": "Hugh N.", "link": "https://stackoverflow.com/users/11193313/hugh-n"}, "edited": false, "score": 0, "creation_date": 1552420361, "post_id": 55129621, "comment_id": 97000866, "body": "Would you happen to have sample code doing what you&#39;ve described? I&#39;m not exactly sure what you mean in the last paragraph, what sort of written data are you referring to? If the children were standalone, random number generators for example and I want the parent to go through each pipe to see each child&#39;s randomly generated number and output the smallest, how would the implementation look?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 23, "user_id": 11193313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c9792b072e7d09f87cb485c3317811?s=128&d=identicon&r=PG&f=1", "display_name": "Hugh N.", "link": "https://stackoverflow.com/users/11193313/hugh-n"}, "edited": false, "score": 0, "creation_date": 1552421318, "post_id": 55129621, "comment_id": 97001368, "body": "And I saw the remainder of your comment after I&#39;d typed code and submitted my comment.  How many random numbers would each child generate?  How do you plan to send them over the pipe (binary data or printable data)?  Is the number of random numbers itself random?  In what range?  Which PRNG (pseudo-random number generator) would you use?  Is repeatability an issue?  What do you use as the seed?  Etc."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 0, "last_activity_date": 1552421164, "last_edit_date": 1552421164, "creation_date": 1552420148, "answer_id": 55129621, "question_id": 55129223, "link": "https://stackoverflow.com/questions/55129223/creating-n-children-each-with-their-own-pipe/55129621#55129621", "title": "Creating n children each with their own pipe", "body": "<p>You're going to need an array of file descriptors big enough for one pair of file descriptors for each child.</p>\n\n<p>The parent code will create the pipes.  Each child processes should close the pipes of any sibling processes.  The exact mechanics of that depend on how you create the pipes; there are multiple workable options.</p>\n\n<p>The <code>if (r == 0)</code> code will execute the child process and should ensure it exits rather than continuing the loop.</p>\n\n<p>The parent process will simply continue creating the other child processes before going into its own processing loop.</p>\n\n<p>You're going to need to decide how to determine which children have written data so that the parent can read it without blocking.  You might use <code>select()</code> or <code>poll()</code> or a variant on those, or the parent might make the read ends of the pipe non-blocking, or \u2026</p>\n\n<p>In a comment you ask \"\u2026people have mentioned threading but is this possible with pipe?\", to which the answer is \"yes, it's possible \u2014 though it isn't clear that it is necessary or desirable\".</p>\n\n<blockquote>\n  <p>Would you happen to have sample code doing what you've described?</p>\n</blockquote>\n\n<p>It's probably simpler to write than to find.  The <code>be_childish()</code> function is responsible for doing whatever a child should do.  It should not return.  If it does, that will be reported as a failure.\nYou've not said much about what the child processes do, so it's hard to fill in the gaps there.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main(void)\n{\n    enum { NUM_CHILDREN = 5 };\n    int fd[NUM_CHILDREN][2];\n\n    for (int i = 0; i &lt; NUM_CHILDREN; i++)\n    {\n        pipe(fd[i]);\n        int pid = fork();\n        if (pid &lt; 0)\n           \u2026error exit\u2026\n        if (pid == 0)\n        {\n            // Child\n            // Close sibling pipes\n            for (int j = 0; j &lt; i; j++)\n            {\n                close(fd[j][0]);\n                close(fd[j][1]);\n            }\n            close(fd[i][0]);   // Close read end of pipe\n            be_childish(fd[i][1]);\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    for (int i = 0; i &lt; NUM_CHILDREN; i++)\n        close(fd[i][1]);       // Close write end of every child's pipe\n\n    // setup complete, unless you need to make the read end of the pipes non-blocking\n    // do parental stuff, reading from the various child pipes\n\n    for (int i = 0; i &lt; NUM_CHILDREN; i++)\n        close(fd[i][0]);       // Close read end of every child's pipe\n    int corpse;\n    int status;\n    while ((corpse = wait(&amp;status)) &gt; 0)\n        printf(\"Child %d exited with status 0x%.4X\\n\", corpse, status);\n\n    return 0;\n}\n</code></pre>\n\n<p><sup><em>Beware: this code has not been near a compiler, much less run.  There are probably bugs in it.</em></sup></p>\n"}], "owner": {"reputation": 23, "user_id": 11193313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c9792b072e7d09f87cb485c3317811?s=128&d=identicon&r=PG&f=1", "display_name": "Hugh N.", "link": "https://stackoverflow.com/users/11193313/hugh-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "accepted_answer_id": 55129621, "answer_count": 1, "score": 2, "last_activity_date": 1552421164, "creation_date": 1552418460, "last_edit_date": 1552419074, "question_id": 55129223, "link": "https://stackoverflow.com/questions/55129223/creating-n-children-each-with-their-own-pipe", "title": "Creating n children each with their own pipe", "body": "<p>I'm having trouble understanding <code>pipe</code> and <code>fork</code>, at least implementing it in practice. I would like to create <code>n</code> children each with their own pipe.</p>\n\n<p>I thought of doing something like:</p>\n\n<pre><code>int main(void) {\n    int fd[2];\n    for (int i = 0; i &lt; n; i++) {\n        pipe(fd);\n        r = fork();\n\n        if (r == 0) {\n            // do child stuff\n        } else if (r &gt; 0) {\n            // do parent stuff\n        }\n    }\n}\n</code></pre>\n\n<p>But doing this would result in the children making processes of their own which isn't what I want.</p>\n\n<p>Moreover, how would you make it so that the parent and child run concurrently, where the child is constantly writing to the pipe and the parent, with access to the pipe to each child, reads from it, does something with it, then discards it so that the child can write something new to the pipe?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1552417986, "post_id": 55128926, "comment_id": 96999734, "body": "Use <code>exit(1);</code> or <code>exit(EXIT_FAILURE);</code> to exit a program after an error \u2014 not <code>exit(0)</code> which indicates &quot;everything worked&quot; (but it didn&#39;t).  The error message should also go to <code>stderr</code>, not <code>stdout</code>, and should include at least the file name (so you shouldn&#39;t use a literal string as the argument to <code>fopen()</code> because you need to reference it again in the error message).  However, that doesn&#39;t affect your main problem."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1552418064, "post_id": 55128926, "comment_id": 96999779, "body": "Error: <code>if(fp=NULL)</code> should be <code>if(fp==NULL)</code>. And you didn&#39;t read any file data. In the first nested pair of loops you need something like <code>fscanf(fp, &quot;%d&quot;, &amp;matrix[r][c]);</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1552418089, "post_id": 55128926, "comment_id": 96999795, "body": "Your first pair of nested <code>for</code> loops are processing <code>matrix</code> before it has been initialized.  Neither you nor I can predict what you&#39;ll see, but we can reliably assume it isn&#39;t what you want.  In fact, there&#39;s no code shown that reads from the file you carefully opened."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11193136"}, "edited": false, "score": 0, "creation_date": 1552418283, "post_id": 55128926, "comment_id": 96999893, "body": "when i run the code, it shows nothing."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1552418322, "post_id": 55128926, "comment_id": 96999917, "body": "Style-wise, I&#39;d suggest initializing <code>sum = 0;</code> before the loop where you increment rather than afterwards.  It is less prone to confusion in the long run, though it is safe enough here.  You could also move the declaration inside the loops: <code>int sum = 0;</code> before the inner loops.  Reducing variable scope also helps reduce bugs."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552418573, "post_id": 55128926, "comment_id": 97000040, "body": "When <b><i>I</i></b> run your code, it outputs row and column sums with strange values, not nothing."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1552418820, "post_id": 55128926, "comment_id": 97000150, "body": "Before your first loop, you need to add another pair of nested loops to read the data from the file you opened (after you&#39;ve fixed the &#39;assignment vs comparison&#39; problem).  Don&#39;t forget to check that <code>scanf()</code> returns <code>1</code> each time, indicating success (report an error on failure).  Until you do that successfully, you won&#39;t get meaningful answers."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11193136"}, "edited": false, "score": 0, "creation_date": 1552419017, "post_id": 55128926, "comment_id": 97000264, "body": "It show the sums seperately. For example, it is like Row sum 14, Row sum 18 Row sum 27... How can i print them together like Row sums 14 18 27 etc"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1552419162, "post_id": 55128926, "comment_id": 97000330, "body": "Use <code>printf(&quot;%s:&quot;, &quot;Row sums&quot;);</code> before the loop; use <code>printf(&quot; %d&quot;, sum);</code> in the loop; and use <code>putchar(&#39;\\n&#39;);</code> (or <code>puts(&quot;&quot;);</code> or <code>printf(&quot;\\n&quot;);</code>) after the loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11193136"}, "edited": false, "score": 0, "creation_date": 1552420665, "post_id": 55128926, "comment_id": 97001013, "body": "I did what you say but i guess i coulnd&#39;t do it properly. It shows the same output. I mean seperately."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1552423782, "post_id": 55128926, "comment_id": 97002436, "body": "Look up examples of <code>fscanf</code> to read from the file; don&#39;t forget to check the return value."}, {"owner": {"reputation": 1404, "user_id": 10496710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cb3d11da053d8e1e94ef99a27ca6af?s=128&d=identicon&r=PG&f=1", "display_name": "B. Go", "link": "https://stackoverflow.com/users/10496710/b-go"}, "edited": false, "score": 0, "creation_date": 1552435351, "post_id": 55128926, "comment_id": 97006318, "body": "you should also close the file when done reading it (which is not done in the code provided)"}], "owner": {"user_type": "does_not_exist", "display_name": "user11193136"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552418511, "creation_date": 1552417307, "last_edit_date": 1552418511, "question_id": 55128926, "link": "https://stackoverflow.com/questions/55128926/finding-the-sum-of-rows-and-columns-in-a-two-dimensional-array-c-using-file-po", "title": "Finding the Sum of Rows and Columns in a Two-Dimensional Array (C) using file pointers", "body": "<p>There is no row/column information since there are SIZE \u00d7 SIZE numbers in the input file.\ne.g. this what we have in the input file:</p>\n\n<pre><code>1 5 8\n6 10 2\n9 2 16\n</code></pre>\n\n<p>The code reads the data from the input file. After populating the array, I need to calculate and report the row wise and column wise sums of the matrix. For the\nexample input file above, the output should be look like:</p>\n\n<pre><code>row sums: 14 18 27\ncolumn sums: 16 17 26\n</code></pre>\n\n<p>I am new to C programming. Can someone guide me?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SIZE 3\nint main(void)\n{\n    int matrix[SIZE][SIZE];\n    int sum=0;\n    FILE *fp;\n    fp=fopen(\"input.txt\",\"r\");\n    if(fp=NULL)\n    {\n        printf(\"File could not read the file!\");\n        exit(0);\n    }\n    for(int r = 0; r &lt; SIZE; ++r)\n    {\n        for(int c = 0; c &lt; SIZE; ++c)\n        {\n            sum += matrix[r][c];\n        }\n        printf(\"Row sums: %d \\n\",sum); // printf(\"Sum for row %d = %d\\n\", r, sum);\n        sum=0;\n        printf(\"\\n\");\n    }\n\n    for(int r = 0; r &lt; SIZE; ++r)\n    {\n        for(int c = 0; c &lt; SIZE; ++c)\n        {\n            sum += matrix[c][r];\n        }\n        printf(\"Column sums: %d \\n\",sum);   //printf(\"Sum for column %d = %d\\n\", c, sum);\n        sum=0;\n        printf(\"\\n\");\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 1924, "user_id": 2669042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66a47707c3d1748c9977727ddfa4d50?s=128&d=identicon&r=PG", "display_name": "xing", "link": "https://stackoverflow.com/users/2669042/xing"}, "edited": false, "score": 1, "creation_date": 1552417572, "post_id": 55128898, "comment_id": 96999521, "body": "Adding to @xing comment, and <code>n</code> as well."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1552419021, "post_id": 55128898, "comment_id": 97000265, "body": "Your program probably crashes because <code>n</code> is zero, and gets treated as a null pointer (or an otherwise invalid pointer) and when <code>scanf()</code> tries to write via the invalid pointer, the program probably crashes instead of continuing.  Use <code>if (scanf(&quot;%d&quot;, &amp;n) != 1) { \u2026report error and exit\u2026 }</code>, where the <code>&amp;</code> is crucial."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11152111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d12d18fd212c13ae33472340d1e683?s=128&d=identicon&r=PG&f=1", "display_name": "hassan", "link": "https://stackoverflow.com/users/11152111/hassan"}, "edited": false, "score": 0, "creation_date": 1552424515, "post_id": 55129018, "comment_id": 97002734, "body": "Thanks it really did work. going forward i am almost done with my code but it gives me an error after the &quot;switch&quot; statement. The code is as follows:"}], "tags": [], "owner": {"reputation": 318, "user_id": 8795509, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-i9j6kNs3nXE/AAAAAAAAAAI/AAAAAAAAJw4/uq29m9GSfqY/photo.jpg?sz=128", "display_name": "Neeraj Bansal", "link": "https://stackoverflow.com/users/8795509/neeraj-bansal"}, "is_accepted": false, "score": 5, "last_activity_date": 1552417608, "creation_date": 1552417608, "answer_id": 55129018, "question_id": 55128898, "link": "https://stackoverflow.com/questions/55128898/output-not-showing-as-per-wanted/55129018#55129018", "title": "output not showing as per wanted", "body": "<p>Use '&amp;' in scanf for n, num1 and num2.\nScanf(\"%d\", &amp;n);</p>\n"}], "owner": {"reputation": 13, "user_id": 11152111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d12d18fd212c13ae33472340d1e683?s=128&d=identicon&r=PG&f=1", "display_name": "hassan", "link": "https://stackoverflow.com/users/11152111/hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1552417608, "creation_date": 1552417205, "question_id": 55128898, "link": "https://stackoverflow.com/questions/55128898/output-not-showing-as-per-wanted", "title": "output not showing as per wanted", "body": "<p>I am beginner to C language and I am writing a code for mathematical operations.\nThe code that i have written so far is as follows but does not ask the user for second number input.</p>\n\n<pre><code>int main()\n{\n    int num_1 = 0;\n    int num_2 = 0;\n    int n = 0;\n    int Total = 0;\n\n    printf(\"\\nEnter 1 for add:\\n \");\n    printf(\"Enter 2 for subtract:\\n \");\n    printf(\"Enter 3 for division:\\n \");\n    printf(\"Enter 4 for multiplication:\\n \");\n    printf(\"Enter 5 for percentage:\\n \");\n    printf(\"Enter 6 for power:\\n \");\n    scanf(\"%d\", n);\n\n    printf(\"Enter first number:  \");\n    scanf(\"%d\", num_1);\n    printf(\"Enter second number:  \");\n    scanf(\"%d\", num_2);\n\n\n\n\n\n\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "debugging", "gdb", "openmp"], "comments": [{"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1552417368, "post_id": 55128846, "comment_id": 96999420, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18768674/using-gdb-with-openmp\">Using GDB with OpenMP</a>"}, {"owner": {"reputation": 587, "user_id": 3123894, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f6c319e2f1348d1683aa7486b7567639?s=128&d=identicon&r=PG", "display_name": "648trindade", "link": "https://stackoverflow.com/users/3123894/648trindade"}, "reply_to_user": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1552417500, "post_id": 55128846, "comment_id": 96999487, "body": "Similar, but not the same case: in that problem the user could not see shared variables inside parallel region. In my case, I can (<code>a</code> is a shared variable)."}, {"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 1, "creation_date": 1552417550, "post_id": 55128846, "comment_id": 96999512, "body": "@648trindae: Thanks for clarifying :)"}], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 10443813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0ee2ae00e0a906599c69e0e698035d0?s=128&d=identicon&r=PG&f=1", "display_name": "KL-Yang", "link": "https://stackoverflow.com/users/10443813/kl-yang"}, "is_accepted": true, "score": 1, "last_activity_date": 1552464042, "creation_date": 1552464042, "answer_id": 55136933, "question_id": 55128846, "link": "https://stackoverflow.com/questions/55128846/how-to-print-local-variables-of-an-openmp-parallel-region-in-gdb/55136933#55136933", "title": "How to print local variables of an OpenMP parallel region in gdb?", "body": "<p>This answers nothing, just report that I cannot repeat it, the code is compiled with </p>\n\n<pre><code>gcc x.c -W -Wall -fopenmp -ggdb\n</code></pre>\n\n<p>and gdb session as the following, everything seems fine, I guess it may be related with compile flag, try add -O0 in addition to -g or -ggdb</p>\n\n<pre><code>Reading symbols from ./a.out...done.\n(gdb) break 9\nBreakpoint 1 at 0x40064d: file x.c, line 9.\n(gdb) run\nStarting program: /some/path/to/a.out \n[Thread debugging using libthread_db enabled]\nThread 3 \"a.out\" hit Breakpoint 1, main._omp_fn.0 () at x.c:9\n9           printf(\"%d\\n\",m_a); //breakpoint set here\n(gdb) info locals\nm_a = 2\na = 0\n(gdb) info threads\n  Id   Target Id         Frame \n  1    Thread 0x2aaaaaaebb40 (LWP 31287) \"a.out\" main._omp_fn.0 () at x.c:9\n  2    Thread 0x2aaaabab0700 (LWP 31516) \"a.out\" main._omp_fn.0 () at x.c:9\n* 3    Thread 0x2aaaabcb1700 (LWP 31517) \"a.out\" main._omp_fn.0 () at x.c:9\n  4    Thread 0x2aaaabeb2700 (LWP 31518) \"a.out\" main._omp_fn.0 () at x.c:9\n(gdb) thread 1\n[Switching to thread 1 (Thread 0x2aaaaaaebb40 (LWP 31287))]\n#0  main._omp_fn.0 () at x.c:9\n9           printf(\"%d\\n\",m_a); //breakpoint set here\n(gdb) info locals\nm_a = 0\na = 0\n(gdb) thread 2\n[Switching to thread 2 (Thread 0x2aaaabab0700 (LWP 31516))]\n#0  main._omp_fn.0 () at x.c:9\n9           printf(\"%d\\n\",m_a); //breakpoint set here\n(gdb) info locals\nm_a = 1\na = 0\n(gdb)\n</code></pre>\n"}], "owner": {"reputation": 587, "user_id": 3123894, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f6c319e2f1348d1683aa7486b7567639?s=128&d=identicon&r=PG", "display_name": "648trindade", "link": "https://stackoverflow.com/users/3123894/648trindade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 55136933, "answer_count": 1, "score": 1, "last_activity_date": 1552464042, "creation_date": 1552417035, "question_id": 55128846, "link": "https://stackoverflow.com/questions/55128846/how-to-print-local-variables-of-an-openmp-parallel-region-in-gdb", "title": "How to print local variables of an OpenMP parallel region in gdb?", "body": "<p>I'm stuck with debugging local variables inside an OpenMP parallel region.</p>\n\n<p>Taking this code in consideration:</p>\n\n<pre><code>#include&lt;omp.h&gt;\n#include&lt;stdio.h&gt;\n\nint main(){\n    int a = 0;\n    #pragma omp parallel shared(a)\n    {\n    int m_a = a + omp_get_thread_num();\n    printf(\"%d\\n\",m_a); //breakpoint set here\n    }\n}\n</code></pre>\n\n<p>The code runs well, but if I set a breakpoint at the line with the comment and type <code>info locals</code> on gdb, it just shows the <code>a</code> variable. Typing <code>print m_a</code> results on <code>No symbol \"m_a\" in current context.</code></p>\n"}, {"tags": ["c", "signals", "deadlock"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552416901, "post_id": 55128727, "comment_id": 96999185, "body": "Non-reentrancy is not the only potential problem with calling non-async-signal-safe functions from a signal handler.  It&#39;s at least as likely to be bitten by handlers running with very small stacks, which is often the case in practice."}, {"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552416947, "post_id": 55128727, "comment_id": 96999204, "body": "You mean because it could eventually cause a stack overflow? Could you elaborate more? (But yes I am aware there are other issues, I just want to reproduce the deadlock issue for my own learning experience)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552417124, "post_id": 55128727, "comment_id": 96999286, "body": "Yes, because the handler exhausts the available stack.  This can produce various kinds of memory fault, but also possibly just incorrect behavior.  Similarly, problems around non-reentrancy don&#39;t necessarily result in deadlock.  They might just yield wrong results."}, {"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552417218, "post_id": 55128727, "comment_id": 96999331, "body": "Right that makes sense, however I am simply not seeing (from the printfs, and from strace) a signal ever being delivered while the current signal handler is running. It appears that it always completes the signal handler before receiving another one... I would imagine a signal must be delivered while the current handler isn&#39;t complete for any such stack overflow or deadlock to occur right?"}], "answers": [{"comments": [{"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "edited": false, "score": 0, "creation_date": 1552417918, "post_id": 55129066, "comment_id": 96999699, "body": "&gt; It&#39;s therefore reasonably safe to call a reentrant function in its signal handler.  Why? Nothing anywhere has said anything about what the rest of the program is doing... Simply that you cannot call non-reentrant functions from a signal handler. Also, you may have pointed out my issue of using the same signal... Perhaps if I use two different signal handlers, will try that now."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 3, "creation_date": 1552418353, "post_id": 55129066, "comment_id": 96999935, "body": "You cannot <i>in general</i> call non-reentrant functions from a signal handler, but you can do it under special circumstances.  One of those circumstances is when you have made it <i>impossible</i> for signal handlers to interrupt the normal flow of execution at a point where it would be a problem. Making the normal flow of execution be an empty infinite loop is one way to do that. The system primitives <code>sigtimedwait</code> and <code>pselect</code> are a more flexible way to do that."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "edited": false, "score": 1, "creation_date": 1552419216, "post_id": 55129066, "comment_id": 97000348, "body": "@user6567423, the specifications reserve the possibility for implementations to break if your program does not conform.  They do not in general <i>require</i> implementations to break when a program does not conform, and in particular, they do not require that in this specific area."}, {"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1552420077, "post_id": 55129066, "comment_id": 97000736, "body": "apologies @zwol I deleted the question because I think you already answered it and I was just misreading your answer. Thanks for all the help!"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "edited": false, "score": 0, "creation_date": 1552420371, "post_id": 55129066, "comment_id": 97000872, "body": "@user6567423 No worries, glad I could help."}], "tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": false, "score": 1, "last_activity_date": 1552417836, "creation_date": 1552417836, "answer_id": 55129066, "question_id": 55128727, "link": "https://stackoverflow.com/questions/55128727/does-anybody-have-an-example-of-a-non-async-safe-signal-handler-deadlock/55129066#55129066", "title": "Does anybody have an Example of A Non-Async Safe Signal Handler Deadlock", "body": "<blockquote>\n  <p>I understand why non-reentrant functions may cause a deadlock in a signal handler, however I cannot actually trigger the issue no matter how hard I try.</p>\n</blockquote>\n\n<p>I don't understand why you would think your particular example would end in a deadlock. Your process that s being targeted with signals is not doing anything in its main loop. It's therefore reasonably safe to call a reentrant function in its signal handler.</p>\n\n<p>Furthermore, on Linux, the semantics of <code>signal</code> are effectively the same as BSD sematics. This means that, while the signal handler is running, further instances of the same signal are blocked. All of the blast of signals from your \"killer\" are handled sequentially by the \"victim\". </p>\n\n<p>The potential problems from calling non reentrant functions are more insidious than merely grinding to a halt wit a deadlock. For example, if <code>malloc</code> is interrupted by a signal while it is in the middle of manipulating its data structures, calling <code>malloc</code> in the signal handler is like calling it on a corrupt heap. It won't necessarily cause a deadlock, you may just find an unexplained segmentation violation down the line, or just corrupt data. However, I should emphasise that this is not the situation you are seeing because you only call <code>malloc</code> in your signal handler.</p>\n"}, {"comments": [{"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "edited": false, "score": 0, "creation_date": 1552418227, "post_id": 55129142, "comment_id": 96999860, "body": "So the main program (the while(1) loop) has to be executing the locking mechanism of printf/malloc when the signal is delivered? I was under the impression that the signal handler itself could be interrupted with another signal and therefore simply using malloc/printf in the signal handler alone was enough to open potential for deadlock if another signal arrives while the first handler is executing."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "edited": false, "score": 1, "creation_date": 1552418474, "post_id": 55129142, "comment_id": 96999990, "body": "<i>I was under the impression that the signal handler itself could be interrupted with another signal</i> \u2014 That&#39;s what I&#39;m talking about in the second half of my answer. Your C library happens to make that impossible when you use <code>signal</code>.  You can ensure it&#39;s impossible by using <code>sigaction</code> and not setting <code>SA_NODEFER</code>, or you can ensure it <i>is</i> possible by using <code>sigaction</code> and setting <code>SA_NODEFER</code>."}, {"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "edited": false, "score": 0, "creation_date": 1552419078, "post_id": 55129142, "comment_id": 97000290, "body": "Thanks I think you have cleared this up quite nicely, although I wish I could accept all of the answered because everybody has given me quality information."}], "tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 2, "last_activity_date": 1552420297, "last_edit_date": 1552420297, "creation_date": 1552418151, "answer_id": 55129142, "question_id": 55128727, "link": "https://stackoverflow.com/questions/55128727/does-anybody-have-an-example-of-a-non-async-safe-signal-handler-deadlock/55129142#55129142", "title": "Does anybody have an Example of A Non-Async Safe Signal Handler Deadlock", "body": "<p>You are not seeing any deadlock or other failure for two reasons.  First, and most important, your program is sitting in a spin loop waiting for signals to be delivered.</p>\n\n<pre><code>// loop and wait for signals\nwhile (1) {}\n</code></pre>\n\n<p>This means there is never anything \"interesting\" for a signal handler to interrupt.  If you changed it to something like this:</p>\n\n<pre><code>while (1) {\n  size_t n = rand();\n  char *p = malloc(n);\n  free(p);\n}\n</code></pre>\n\n<p>then you'd have a chance of your signal handler that calls <code>malloc</code> interrupting the normal flow of execution <em>inside <code>malloc</code></em>, which is one way that async signal handlers could cause a deadlock.</p>\n\n<p>The other reason is, on your system, <code>signal(SIGINT, handler)</code> is installing a handler whose execution <em>cannot be interrupted by another <code>SIGINT</code></em>.  The C standard doesn't say whether <code>signal</code> does this or not, but most modern Unixes do it that way.  You can get a signal handler whose execution <em>can</em> be interrupted by dropping down to the lower-level <code>sigaction</code>: replace your <code>signal</code> call with</p>\n\n<pre><code>struct sigaction sa;\nsa.sa_handler = inthandler;\nsa.sa_flags = SA_NODEFER | SA_RESTART;\nsigemptyset(&amp;sa.sa_mask);\nsigaction(SIGINT, &amp;sa, 0);\n</code></pre>\n\n<p>This will also enable the possibility of a signal arriving within the guts of <code>malloc</code>.</p>\n\n<p>Signals are one of the most confusing and difficult aspects of the low-level Unix API.  I encourage you to acquire a copy of W. Richard Stevens' book <a href=\"https://www.powells.com/book/-9780321637734\" rel=\"nofollow noreferrer\"><em>Advanced Programming in the Unix Environment</em></a> and read the chapters on signal handling. It's an expensive book, but you should be able to request it at your local public library.</p>\n"}, {"comments": [{"owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "edited": false, "score": 0, "creation_date": 1552419145, "post_id": 55129284, "comment_id": 97000321, "body": "Thank you very much, I am going to accept zwols answer because he clarified there is two ways I could trigger this problem, and I am actually preventing both of them from occurring based on my tests. You have opened my eyes to other information though and I thank you for that."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1552420129, "post_id": 55129284, "comment_id": 97000767, "body": "Incidentally, current versions of the Linux kernel don&#39;t provide a <code>signal</code> syscall, only <code>sigaction</code>.  I&#39;m not sure how long it&#39;s been like that."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1552419426, "last_edit_date": 1552419426, "creation_date": 1552418705, "answer_id": 55129284, "question_id": 55128727, "link": "https://stackoverflow.com/questions/55128727/does-anybody-have-an-example-of-a-non-async-safe-signal-handler-deadlock/55129284#55129284", "title": "Does anybody have an Example of A Non-Async Safe Signal Handler Deadlock", "body": "<p>The question seems to boil down to the bit at the end, about whether a signal handler can be interrupted be receipt of the same signal it is already handling.</p>\n\n<blockquote>\n  <p>Am I doing something wrong? Am I just extremely lucky? Or is maybe my\n  OS hardened against this issue (is that even possible)?</p>\n  \n  <p>I tried attaching strace to the victim and I am seeing that it always\n  reports rt_sigreturn and then a subsequent SIGINT paired together:</p>\n  \n  <p>rt_sigreturn()                          = 0\n  --- SIGINT {si_signo=SIGINT, si_code=SI_USER, si_pid=11564, si_uid=0} ---</p>\n  \n  <p>I would imagine that the \"SIGINT\" needs to be delivered before the\n  rt_sigreturn (before it exists from the signal handler) but that never\n  seems to happen, it appears as if the process is blocking the SIGINT\n  until the current signal handler has exited... (That can't be right\n  can it?)</p>\n</blockquote>\n\n<p>In fact, it is <em>entirely</em> possible that <code>SIGINT</code> is blocked while a <code>SIGINT</code> is being handled.  The Linux manual page for signal(2) features this warning at the beginning of the function description:</p>\n\n<blockquote>\n  <p>The behavior of signal() varies across UNIX versions, and has also\n         varied historically across different versions of Linux.  Avoid its\n         use: use sigaction(2) instead.</p>\n</blockquote>\n\n<p>The portability notes describe these variations on program behavior after a signal-handling function is installed via <code>signal()</code>:</p>\n\n<ul>\n<li><p>the disposition of the signal is reset to <code>SIG_DFL</code> when the handler is invoked for it.  And the signal was not blocked.  This was the original behavior of UNIX <code>signal()</code>, also implemented in System V.</p></li>\n<li><p>the disposition of the signal is unchanged when the handler is invoked for it, <strong><em>and the signal is blocked while the handler is executing</em></strong>.  This is the behavior implemented by BSD, which also causes certain system calls to be restarted if interrupted by receipt of a signal.</p></li>\n</ul>\n\n<p>You are reasonably likely to be testing on a system that exhibits the latter, because Mac OS is a BSD, and although the Linux kernel's <code>signal()</code> syscall implements System V semantics, GLIBC's <code>signal()</code> wrapper function provides BSD semantics.  Windows' implementation of signaling and signal handling is too feeble for your testing, so the only likely source of System V semantics would be a System V descendant such as Solaris or HP-UX (and I'm not certain about their behavior here).  There are other operating systems, of course, but those I've mentioned cover the vast majority of installed base of general-purpose computers.</p>\n\n<p>If you want to avoid the signal being blocked while its handler is running, then use <code>sigaction()</code> to install it, specifying the appropriate flag.  For example,</p>\n\n<pre><code>struct sigaction action = {\n    .sa_handler = inthandler,\n    .sa_flags = SA_NODEFER\n};\n\nint result = sigaction(SIGINT, &amp;action, NULL);\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 6567423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa3900c5cbb1e5aa19a8311f4114dd72?s=128&d=identicon&r=PG&f=1", "display_name": "user6567423", "link": "https://stackoverflow.com/users/6567423/user6567423"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 55129142, "answer_count": 3, "score": 0, "last_activity_date": 1552420297, "creation_date": 1552416569, "last_edit_date": 1552417454, "question_id": 55128727, "link": "https://stackoverflow.com/questions/55128727/does-anybody-have-an-example-of-a-non-async-safe-signal-handler-deadlock", "title": "Does anybody have an Example of A Non-Async Safe Signal Handler Deadlock", "body": "<p>First let me preface that <strong>I understand why</strong> non-reentrant functions may cause a deadlock in a signal handler, however I cannot actually trigger the issue no matter how hard I try.</p>\n\n<p>I have my first program running 1024 malloc and printfs each signal, and I have several other programs running with 2 threads per program firing signals at the first and even after running them for half an hour straight I see no deadlocks.</p>\n\n<p>I am compiling and running these programs on 64bit Ubuntu 14.04.5 LTS (Trusty) with gcc (Ubuntu 4.8.4-2ubuntu1~14.04.4) 4.8.4.</p>\n\n<p>The first program (the one that should deadlock is) is:</p>\n\n<pre><code>// victim.c\n#include  &lt;signal.h&gt;\n#include  &lt;unistd.h&gt;\n#include  &lt;stdlib.h&gt;\n#include  &lt;string.h&gt;\n#include  &lt;stdio.h&gt;\n// global arr to put our malloc results to avoid\n// compiler doing any funny business and optimizing\n// away the malloc calls, not sure if this is really\n// actually necessary or not\nvoid *arr[1024];\n// sigint handler to do bad stuff in a loop\nvoid inthandler(int sig)\n{\n    int i = 0;\n    for (i = 0; i &lt; 1024; ++i) {\n        // some printf\n        printf(\"Signal loop %d\\n\", i);\n        if (arr[i]) free(arr[i]);\n        arr[i] = malloc(1024);\n    }\n}\nvoid main(void)\n{\n    // clear out our arr\n    memset(arr, 0, sizeof(arr));\n    // install our sigint handler\n    signal(SIGINT, inthandler);\n    // loop and wait for signals\n    while (1) {}\n}\n</code></pre>\n\n<p>And I compile it with (O0 to be explicit that we aren't optimizing):</p>\n\n<pre><code>gcc ./victim.c -O0 -o victim\n</code></pre>\n\n<p>Then the \"killer\" ie the program sending signals which should eventually trigger a deadlock in the victim is as follows:</p>\n\n<pre><code>// killer.c\n#include &lt;signal.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n// hack to grab pid of victim\nstatic pid_t __grab_victim_pid()\n{\n    char line[1024] = {0};\n    FILE *command = NULL;\n    pid_t pid = 0;\n    printf(\"Getting pid of victim...\\n\");\n    do {\n        command = popen(\"pidof victim\", \"r\");\n        memset(line, 0, sizeof(line));\n        fgets(line, sizeof(line) - 1, command);\n        pid = strtoul(line, NULL, 10);\n        pclose(command);\n    } while (pid == 0);\n    printf(\"Grabbed pid of victim: [%u]\\n\", pid);\n    return pid;\n}\nstatic void *__loop_threadfunc(void *param)\n{\n    pid_t pid = 0;\n    size_t i = 0;\n    pid = __grab_victim_pid();\n    while (1) {\n        kill(pid, SIGINT);\n    }\n    return 0;\n}\nint main(int argc, char *argv[])\n{\n    pthread_t thread1;\n    pthread_t thread2;\n    // Spawn the threads\n    if (pthread_create(&amp;thread1, NULL, __loop_threadfunc, NULL) != 0 ||\n        pthread_create(&amp;thread2, NULL, __loop_threadfunc, NULL) != 0) {\n        fprintf(stderr, \"Failed to create a thread\\n\");\n        return 1;\n    }\n    // join the threads to wait for them\n    pthread_join(thread1, NULL);\n    pthread_join(thread2, NULL);\n    return 0;\n}\n</code></pre>\n\n<p>Compiled with:</p>\n\n<pre><code>gcc ./killer.c -O0 -o killer -lpthread\n</code></pre>\n\n<p>And then I run the victim process in one terminal, jump over to the other terminal and run several backgrounded killer processes, naturally the victim process spits out lots of lines to stdout from each signal it receives but it never appears to deadlock...</p>\n\n<p>Furthermore the lines that are spit out are always in order, that is, the \"Signal loop %d\" messages never appear to be interrupted which indicates to me that a signal is never delivered mid-execution of the active signal handler. This seems to go against what everybody is saying about signal handlers.</p>\n\n<p>Am I doing something wrong? Am I just extremely lucky? Or is maybe my OS hardened against this issue (is that even possible)? </p>\n\n<p>I tried attaching strace to the victim and I am seeing that it always reports rt_sigreturn and then a subsequent SIGINT paired together:</p>\n\n<pre><code>rt_sigreturn()                          = 0\n--- SIGINT {si_signo=SIGINT, si_code=SI_USER, si_pid=11564, si_uid=0} ---\n</code></pre>\n\n<p>I would imagine that the \"SIGINT\" needs to be delivered before the rt_sigreturn (before it exists from the signal handler) but that never seems to happen, it <strong>appears</strong> as if the process is blocking the SIGINT until the current signal handler has exited... (That can't be right can it?)</p>\n\n<p>Thanks in advance, any clarification on this would be greatly appreciated!</p>\n\n<p>Edit1: I have left 10 killer processes running on one victim process, will post results if anything happens.</p>\n\n<p>Edit2: Could it have anything to do with the fact I am running these tests on a virtual machine?</p>\n"}, {"tags": ["c", "linux-kernel", "driver", "mmap", "chardev"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552416591, "post_id": 55128648, "comment_id": 96999014, "body": "Does the driver not face the other side of the issue -- knowing when it can safely modify the contents of the mapped memory?  How does it address that, and why does that not yield a solution for the userland side as well?"}, {"owner": {"reputation": 51, "user_id": 7194920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70e4693d326b8b33c647d2bfd72b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Cijay", "link": "https://stackoverflow.com/users/7194920/cijay"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1552420144, "post_id": 55128648, "comment_id": 97000779, "body": "The mmap is a circular buffer where the driver writes data and keeps track of the write_offset. Named semaphore would have been perfect here, but there is no implementation on the kernel side."}], "owner": {"reputation": 51, "user_id": 7194920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e70e4693d326b8b33c647d2bfd72b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Cijay", "link": "https://stackoverflow.com/users/7194920/cijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552416196, "creation_date": 1552416196, "question_id": 55128648, "link": "https://stackoverflow.com/questions/55128648/replacing-chardev-by-mmap", "title": "Replacing `chardev` by `mmap`", "body": "<p>I am looking for a way to synchronize a kernel driver and some user-land code (without any copy_to_user or polling on a mmap)</p>\n\n<p><strong>More explanation</strong>:</p>\n\n<p>My user side code read some data in a shared mmap, but it needs to know when the data are ready from the driver\nI already try to use signals to schedule everything but performances are even lower than using a regular char device (with a copy_to user)</p>\n\n<p>(Working on a 4.1.15 kernel)</p>\n\n<p>Any idea ?</p>\n\n<p>[EDIT] I trying to do it with msync now</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1552416141, "post_id": 55128457, "comment_id": 96998802, "body": "Perhaps you are inverting the control data as well as the display data?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1552418099, "post_id": 55128457, "comment_id": 96999804, "body": "That&#39;s the correct way to invert the bits in a byte -- but what data are you inverting? Inverting the representation of an ASCII character doesn&#39;t give you anything meaningful; <code>char c = &#39;A&#39;; c = ~c;</code> will probably give you garbage. If you&#39;re inverting the bits in a chunk of memory that controls what pixels are displayed on a graphic display, you&#39;ll need to know just how the graphic image is represented in memory."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1552430090, "post_id": 55128457, "comment_id": 97004921, "body": "ASCII code units are not pixel bit images. They are integers. The type of inversion you describe does not apply. From a quick look at the SSD1305z datasheet, I think you have to supply your own character code to pixel map. You invert that output. (And, of course, you needn&#39;t use ASCII. \u263a\u263b)"}, {"owner": {"reputation": 228, "user_id": 157565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99253f6daff274627cbe15349e41d5e6?s=128&d=identicon&r=PG", "display_name": "JRT", "link": "https://stackoverflow.com/users/157565/jrt"}, "edited": false, "score": 0, "creation_date": 1552462696, "post_id": 55128457, "comment_id": 97013637, "body": "You need to specifiy what you mean by &quot;make the ascii letters be the oposite&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": false, "score": 2, "last_activity_date": 1552415803, "creation_date": 1552415803, "answer_id": 55128558, "question_id": 55128457, "link": "https://stackoverflow.com/questions/55128457/is-this-the-right-way-of-inverting-a-byte-bitwise-not/55128558#55128558", "title": "is this the right way of &quot;inverting&quot; a byte? (bitwise NOT )", "body": "<p>Bitwise NOT (<code>~</code>) (also known as Unary One's Complement) is the correct way to invert all bits of a value.  </p>\n\n<p>You can also invert bits by doing exclusive OR (<code>^</code>) with a value which contains <code>1</code>s in the bit position you'd like to invert.  This is particularly useful if you want to invert only a portion of the bits.</p>\n"}], "owner": {"reputation": 45, "user_id": 10446546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9e8309958ecbc6ce7a968179f795fc?s=128&d=identicon&r=PG&f=1", "display_name": "mannen", "link": "https://stackoverflow.com/users/10446546/mannen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1552417788, "creation_date": 1552415438, "last_edit_date": 1552417788, "question_id": 55128457, "link": "https://stackoverflow.com/questions/55128457/is-this-the-right-way-of-inverting-a-byte-bitwise-not", "title": "is this the right way of &quot;inverting&quot; a byte? (bitwise NOT )", "body": "<p>I have some code for display that seems to work fine. \nbut when try to invert some of the text in the display (make white pixels black and black pixels white) I get an issue. the display acts up and crashes. </p>\n\n<p>I have narrowed down the error to this inversion I do (maybe not correct word to descibe it?). When I remove it it works fine. </p>\n\n<p>I think I am doing this correctly and I don\u00b4t know why this would be the issue but seems to be...\nI do inversion like this:  (basically  bitwise NOT I guess its called)</p>\n\n<pre><code>variabel=~variabel;\n</code></pre>\n\n<p>(is this correct?!)</p>\n\n<p>so what I am trying to do here is just make the ascii letters be the oposite: \nso for example:</p>\n\n<pre><code>11001000 will be:\n00110111\n</code></pre>\n\n<p>or</p>\n\n<pre><code>10101111 would be:\n01010000\n</code></pre>\n\n<p>FYI:\nI am programing in C. Atmel studio. \natmega 4809, SSD1305z display, SPI-simular interface</p>\n"}, {"tags": ["c", "memory-management", "heap-memory", "stack-memory"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1552473576, "post_id": 55128439, "comment_id": 97019907, "body": "suggest, in the .c file that contains the struct, to have a related header file and within that .c file have functions to read each field, functions to write each field, etc and to be able to generate a new instance of the struct and return a indication of what instance of the struct to access when accessing the &#39;getter/setter&#39; functions"}], "answers": [{"comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1552429469, "post_id": 55128757, "comment_id": 97004710, "body": "This solution has alignment issues. There\u2019s no guaraneee that <code>stack_source</code> would start at an address that is suitably aligned for a <code>Stacklist_t</code>."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1552429756, "post_id": 55128757, "comment_id": 97004804, "body": "so make <code>stack_source</code> a <code>integer_t</code> and divide StackList_size by the appropriate amount."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1552430063, "post_id": 55128757, "comment_id": 97004907, "body": "<a href=\"https://stackoverflow.com/q/33020346/10396\">Technically, this isn&#39;t guaranteed to be on the stack</a>.  Technically, the C standard doesn&#39;t even mention stacks or heaps."}], "tags": [], "owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "is_accepted": true, "score": 2, "last_activity_date": 1552434436, "last_edit_date": 1552434436, "creation_date": 1552416673, "answer_id": 55128757, "question_id": 55128439, "link": "https://stackoverflow.com/questions/55128439/is-it-possible-to-allocate-structs-on-the-stack-with-its-definition-hidden-in-a/55128757#55128757", "title": "Is it possible to allocate structs on the stack with its definition hidden in a source file?", "body": "<p>You <em>can</em> do that with VLAs or <a href=\"http://man7.org/linux/man-pages/man3/alloca.3.html\" rel=\"nofollow noreferrer\"><code>alloca</code></a> in Linux:</p>\n\n<p>Library header:</p>\n\n<pre><code>struct StackList_s;\ntypedef struct StackList_s StackList_t;\nextern const size_t StackList_size;\n\n// If you're using VLAs\nextern const size_t StackList_align;\nStackList_t* stl_init_inline(char stack_source[], ...);\n</code></pre>\n\n<p>Library source:</p>\n\n<pre><code>#include \"header.h\"\n\nstruct StackList_s {\n    // ...\n};\n\nconst size_t StackList_size = sizeof(StackList_t);\n\n// If you're using VLAs\n#include &lt;stdalign.h&gt;\n#include &lt;stdint.h&gt;\n\nconst size_t StackList_align = alignof(StackList_t);\nStackList_t* stl_init_inline(char stack_source[], ...) {\n    // align the address to the nearest multiple of StackList_align\n    uintptr_t address = (uintptr_t) ((void*) stack_source);\n    if (address % StackList_align != 0) {\n        address += StackList_align - address % StackList_align;\n    }\n    StackList_t* stack = (StackList_t*) ((void*) address);\n    stl_init(stack, ...);\n    return stack;\n}\n</code></pre>\n\n<p>Main source</p>\n\n<pre><code>#include &lt;header.h&gt;\n\nStackList_t* stack = alloca(Stacklist_size);\nstl_init(stack, ...);\n\nchar stack_source[StackList_size + StackList_align - 1];  // Not compile time.\nStackList_t* stack = stl_init_inline(stack_source, ...);\n</code></pre>\n\n<p>This <em>would</em> allocate it on the stack, and you won't need to free it, but it's slower and more verbose than just <code>StackList_t stack_source;</code>. (And <code>alloca</code> is Linux only)</p>\n\n<p>For the second question, you need the full definition of a struct to get it's size. Common pitfalls include the fact that <code>sizeof(struct { int a; }) == sizeof(struct { int a; })</code> can be false. It probably won't be though, so you can do <code>#define StackList_size sizeof(struct { integer_t count; struct StackListNode_s *top; integer_t version_id; })</code> but that also leads to a lot of code duplication.</p>\n\n<p>I personally would just put the struct definition in the header file, and just declare \"don't mess with the members or my methods won't work\" in a comment somewhere (Maybe making the names start with <code>_</code> to give a hint that they are private)</p>\n"}, {"tags": [], "owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "is_accepted": false, "score": 1, "last_activity_date": 1552419167, "creation_date": 1552419167, "answer_id": 55129390, "question_id": 55128439, "link": "https://stackoverflow.com/questions/55128439/is-it-possible-to-allocate-structs-on-the-stack-with-its-definition-hidden-in-a/55129390#55129390", "title": "Is it possible to allocate structs on the stack with its definition hidden in a source file?", "body": "<p>You could do something similar to Artyer's answer without using VLA's by using a #define instead</p>\n\n<p>Header:</p>\n\n<pre><code>#define STACKLISTSIZE 32\ntypedef uint8_t stl_storage[STACKLISTSIZE];\ntypedef struct stacklist_s stacklist_t;\n\nstacklist_t* stl_create_from_stack(stl_storage b);  //user provides memory\nstacklist_t* stl_allocate(void);  //library allocates memory, user must free.\n</code></pre>\n\n<p>Source:</p>\n\n<pre><code>int myfunction()\n{\n  stl_storage x;\n  stacklist_t* sp = stl_create_from_stack(x);\n  //do something with sp.\n}\n</code></pre>\n\n<p>Make sure you have a compile-time assert that <code>sizeof(stack_s) == STACKSTRUCTSIZE</code> in the implementation file.</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 1, "last_activity_date": 1552428309, "creation_date": 1552428309, "answer_id": 55131347, "question_id": 55128439, "link": "https://stackoverflow.com/questions/55128439/is-it-possible-to-allocate-structs-on-the-stack-with-its-definition-hidden-in-a/55131347#55131347", "title": "Is it possible to allocate structs on the stack with its definition hidden in a source file?", "body": "<p>Some implementations guarantee that calls between compilation units will be processed in a fashion consistent with the platform's Application Binary Interface (ABI), without regard for what a called function is going to do with storage whose address it receives, or what a caller will have done with storage whose address it supplies, or will do with such storage once the function returns.  On such implementations, given something like:</p>\n\n<pre><code>// In header\ntypedef union FOO_PUBLIC_UNION { \n  uint64_t dat[4]; // Allocate space\n  double dummy_align1; // Force alignment\n  void *dummy_align2; // Force alignment\n} FOO;\nvoid act_on_foo(FOO_PUBLIC_UNION*);\n\n// In code\nFOO x = {0};\nact_on_foo(&amp;x);\n</code></pre>\n\n<p>in one compilation unit, and something like:</p>\n\n<pre><code>struct FOO_PRIVATE {\n  int this; float that; double whatever;\n};\n\ntypedef union FOO_PUBLIC_UNION { uint64_t dat[4]; struct FOO_PRIVATE priv; } FOOPP;\n\nvoid act_on_foo(FOO *p)\n{\n  FOOPP *pp = (FOOPP*)p;\n  pp-&gt;priv.whatever = 1234.567;\n}\n</code></pre>\n\n<p>provided that the size of <code>FOO</code> and <code>FOOPP</code> match, the behavior of calling an external function from the first compilation unit would be defined as allocating <code>sizeof(FOO)</code> bytes, zeroing them, and passing their address to <code>act_on_foo</code>, whose behavior would then be defined as acting upon the bytes to which it receives an address, without regard for how they got their values or what the caller would do with them later.</p>\n\n<p>Unfortunately, even though almost every implementation should be capable of producing behavior consistent with calling a function it knows nothing about, there is no standard way of indicating to a compiler that a particular function call should be viewed as \"opaque\".  Implementations intended for purposes where that would be useful could and typically did support such semantics with \"ordinary\" function calls whether or not the Standard required that, and such semantics would offer little value on implementations intended only for purposes where they wouldn't be useful.  Unfortunately, this has led to a Catch 22: there's no reason for the Standard to mandate things implementations would be free to do, with or without a mandate, in cases where they're useful, but some compiler writers treat the Standard's lack of a mandate as an encouragement to deny support.</p>\n"}], "owner": {"reputation": 472, "user_id": 10801822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146a7214b29438ffcb5a9ee6ce8b90ff?s=128&d=identicon&r=PG", "display_name": "LeoVen", "link": "https://stackoverflow.com/users/10801822/leoven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 55128757, "answer_count": 3, "score": 1, "last_activity_date": 1552434436, "creation_date": 1552415388, "question_id": 55128439, "link": "https://stackoverflow.com/questions/55128439/is-it-possible-to-allocate-structs-on-the-stack-with-its-definition-hidden-in-a", "title": "Is it possible to allocate structs on the stack with its definition hidden in a source file?", "body": "<p>I have the following header file:</p>\n\n<pre><code>struct StackList_s;\ntypedef struct StackList_s StackList_t;\n// From here I add in the method signatures\n</code></pre>\n\n<p>And the following source file:</p>\n\n<pre><code>struct StackList_s\n{\n    integer_t count;\n    struct StackListNode_s *top; // Here begins the linked list\n    // Some other members that store information about the stack\n    integer_t version_id;\n};\n// From here I define StackListNode_s and implement the StackList_s functions\n// Note that the user will never manipulate directly a StackListNode_s\n// There are functions that will handle the free() of each node correctly\n</code></pre>\n\n<p>I hide the struct definition in the source file so that anyone using this stack can't modify directly its members, since changing them requires some input treatment or checking for certain invalid states.</p>\n\n<p>Currently, to get a new stack you have to use the following:</p>\n\n<pre><code>// malloc(sizeof(StackList_t)) and set members to default\nStackList_t *stack = stl_new(/* Some info parameters */);\n</code></pre>\n\n<p>But I can only do this allocating a <code>StackList_t</code> in the heap. What I want to do is to have the <code>StackList_t</code> allocated on the stack and then its nodes can be allocated in the heap allong with their data and pointers to other nodes. This way I can give the user a choice, if either the struct is being used locally or if he will pass it around functions as an allocated resource.</p>\n\n<pre><code>StackList_t stack;\nstl_init(&amp;stack, /* Info parameters */); // No malloc, only setting members to 0\n</code></pre>\n\n<p>But of course I can't do this because the definition of <code>struct StackList_s</code> is in the source file. So here are my questions:</p>\n\n<ul>\n<li>Is it possible to, at the same time, not allow access to members of a struct and allocate that same struct in the stack?</li>\n<li>Is there any way to tell the compiler the size of my struct?</li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 41558, "user_id": 3204551, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/91bb06155f79d40ffecdf124deecb001?s=128&d=identicon&r=PG&f=1", "display_name": "Deduplicator", "link": "https://stackoverflow.com/users/3204551/deduplicator"}, "edited": false, "score": 4, "creation_date": 1552415053, "post_id": 55128318, "comment_id": 96998266, "body": "Nothing there has anything to do with efficiency. The only thing which plays into efficiency is signed overflow being undefined."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 1, "creation_date": 1552415236, "post_id": 55128318, "comment_id": 96998370, "body": "If your platform doesn&#39;t support unsigned byte instructions (for example) then unsigned char would be less efficient."}, {"owner": {"reputation": 3577, "user_id": 2596334, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/30ba99c74af2eff0394b66c550486f59?s=128&d=identicon&r=PG", "display_name": "Scott Solmer", "link": "https://stackoverflow.com/users/2596334/scott-solmer"}, "edited": false, "score": 0, "creation_date": 1552415483, "post_id": 55128318, "comment_id": 96998486, "body": "I feel like this question should be moved to <a href=\"https://softwareengineering.stackexchange.com/\">Software Engineering</a> See <a href=\"https://meta.stackexchange.com/a/129632/235574\">Before you choose a site\u2026</a>"}, {"owner": {"reputation": 1141, "user_id": 515212, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/th8Br.png?s=128&g=1", "display_name": "martinkunev", "link": "https://stackoverflow.com/users/515212/martinkunev"}, "reply_to_user": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1552470128, "post_id": 55128318, "comment_id": 97017667, "body": "@stark I was kind of wondering whether such a platform existed at the time the decision was made. I suppose it would need to be some platform that uses either ones&#39; complement or sign-magnitude or a platform that implements overflow as saturation."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1552483995, "post_id": 55128318, "comment_id": 97026541, "body": "<a href=\"https://www.ragestorm.net/blogs/?p=34\" rel=\"nofollow noreferrer\">ragestorm.net/blogs/?p=34</a>"}], "owner": {"reputation": 1141, "user_id": 515212, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/th8Br.png?s=128&g=1", "display_name": "martinkunev", "link": "https://stackoverflow.com/users/515212/martinkunev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1552414893, "creation_date": 1552414893, "last_edit_date": 1592644375, "question_id": 55128318, "link": "https://stackoverflow.com/questions/55128318/can-signed-char-be-more-efficient-than-unsigned-char", "title": "Can signed char be more efficient than unsigned char", "body": "<p>I am trying to figure out the rationale behind <code>char</code> being a different type from <code>signed char</code> and <code>unsigned char</code>.</p>\n<p>I found the following posts, which give some rationale but don't answer my queston:</p>\n<p><a href=\"https://stackoverflow.com/questions/4337217/difference-between-signed-unsigned-char\">Difference between signed / unsigned char</a></p>\n<blockquote>\n<p>Part of the reason there are two dialects of &quot;C&quot; (those where 'char' is signed, and those where it is unsigned) is that there are some implementations where 'char' must be unsigned, and others where it must be signed.</p>\n<ul>\n<li><p>If, in the target platform's character set, any of the characters required by standard C would map to a code higher than the maximum signed char, then 'char' must be unsigned.</p>\n</li>\n<li><p>If 'char' and 'short' are the same size, then 'char' must be signed.</p>\n</li>\n</ul>\n</blockquote>\n<p><a href=\"https://stackoverflow.com/questions/2054939/is-char-signed-or-unsigned-by-default/2054941#2054941\">Is char signed or unsigned by default?</a></p>\n<blockquote>\n<p>early in the life of C the &quot;standard&quot; was flip-flopped at least twice, and some popular early compilers ended up one way and others the other</p>\n</blockquote>\n<p>I understand that <code>unsigned char</code> may be more efficient, but are there cases where <code>signed char</code> is more efficient?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 1, "creation_date": 1552414262, "post_id": 55128115, "comment_id": 96997831, "body": "Strings in C are just character arrays. Either free (dynamically allocated) or overwrite them."}, {"owner": {"reputation": 410, "user_id": 7554912, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-mPMSLX772Cw/AAAAAAAAAAI/AAAAAAAAADM/uQ9yzgu-_Rg/photo.jpg?sz=128", "display_name": "Krishna", "link": "https://stackoverflow.com/users/7554912/krishna"}, "edited": false, "score": 0, "creation_date": 1552414494, "post_id": 55128115, "comment_id": 96997929, "body": "You can dynamically allocate the array of char like this <code>char *str = strdup(&quot;&quot;);</code> , but don&#39;t forget to free it. You can also initialize it like <code>char *str = &quot;&quot;;</code>"}, {"owner": {"reputation": 15724, "user_id": 5754656, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/7jfX3.png?s=128&g=1", "display_name": "Artyer", "link": "https://stackoverflow.com/users/5754656/artyer"}, "edited": false, "score": 0, "creation_date": 1552414558, "post_id": 55128115, "comment_id": 96997969, "body": "Something like <code>string[0] = &#39;\\0&#39;</code> or <code>realloc(string, 0)</code>?f"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1552414868, "post_id": 55128115, "comment_id": 96998149, "body": "I tried to answer based on the little information in your question. To get better answers you should add some source code to the question showing how you think it should work."}], "answers": [{"comments": [{"owner": {"reputation": 4349, "user_id": 2945815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7rIjL.jpg?s=128&g=1", "display_name": "little_birdie", "link": "https://stackoverflow.com/users/2945815/little-birdie"}, "edited": false, "score": 0, "creation_date": 1552414812, "post_id": 55128251, "comment_id": 96998115, "body": "We oldsters just do <code>*temp = 0;</code> and it always worked, but I&#39;m sure someone will tell me that there&#39;s a reason that&#39;s not ok anymore. ;)"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 4349, "user_id": 2945815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7rIjL.jpg?s=128&g=1", "display_name": "little_birdie", "link": "https://stackoverflow.com/users/2945815/little-birdie"}, "edited": false, "score": 0, "creation_date": 1552415114, "post_id": 55128251, "comment_id": 96998304, "body": "@little_birdie Of course <code>*temp</code> is the same as <code>temp[0]</code>, but assigning <code>0</code> may result in a compiler warning because <code>0</code> is not of type <code>char</code>. Although it does work I don&#39;t want to propose bad coding style."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 2, "creation_date": 1552415308, "post_id": 55128251, "comment_id": 96998411, "body": "@Bodo <code>&#39;\\0&#39;</code> is not of type <code>char</code>, either.  It is an <code>int</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1552415310, "post_id": 55128251, "comment_id": 96998413, "body": "@Bodo, in C, <code>&#39;\\0&#39;</code> is also an <code>int</code>."}, {"owner": {"reputation": 4349, "user_id": 2945815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7rIjL.jpg?s=128&g=1", "display_name": "little_birdie", "link": "https://stackoverflow.com/users/2945815/little-birdie"}, "edited": false, "score": 0, "creation_date": 1552415832, "post_id": 55128251, "comment_id": 96998637, "body": "I just tried it on gcc, t.c: <code>int main() { char s[100]; *s = 0; }</code> then <code>gcc -Wpendantic t.c</code> compiles with no warning.  So yes, <code>char</code> is still an integer type in c.  Here&#39;s a SO on that topic: <a href=\"https://stackoverflow.com/questions/11698535/is-char-a-special-type-of-integer-variable\" title=\"is char a special type of integer variable\">stackoverflow.com/questions/11698535/&hellip;</a>"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "reply_to_user": {"reputation": 4349, "user_id": 2945815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7rIjL.jpg?s=128&g=1", "display_name": "little_birdie", "link": "https://stackoverflow.com/users/2945815/little-birdie"}, "edited": false, "score": 0, "creation_date": 1552417256, "post_id": 55128251, "comment_id": 96999364, "body": "@little_birdie I don&#39;t want to discuss the types here. It seems to be OK to assign <code>0</code> to a char, but in contrast to <code>0</code> the <code>char</code> literal <code>&#39;\\0&#39;</code> makes it clear to the human reader that the code should deal with characters."}], "tags": [], "owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "is_accepted": false, "score": 3, "last_activity_date": 1552417493, "last_edit_date": 1552417493, "creation_date": 1552414678, "answer_id": 55128251, "question_id": 55128115, "link": "https://stackoverflow.com/questions/55128115/any-built-in-function-to-empty-the-string-in-c/55128251#55128251", "title": "Any built in function to empty the string in c?", "body": "<p>In C a string is an array of <code>char</code> and the end of the string is marked with a <code>NUL</code> character (aka <code>'\\0'</code>) which is nothing else than a byte of value <code>0</code>.</p>\n\n<p>If you want to have an empty string it is sufficient to do</p>\n\n<pre><code>temp[0] = '\\0';\n</code></pre>\n\n<p>or</p>\n\n<pre><code>*temp = '\\0';\n</code></pre>\n\n<p>which is the same.</p>\n\n<p>If you defined something like </p>\n\n<pre><code>char temp[100];\n</code></pre>\n\n<p>you could also do</p>\n\n<pre><code>memset(temp, '\\0', sizeof temp);\n</code></pre>\n\n<p>This will overwrite all characters, allowing you to fill in new data character by character without having to care about the terminating <code>'\\0'</code>.</p>\n\n<p>With dynamic allocation the answer will be different.</p>\n\n<p>It depends a bit on how you want to assign a new value to <code>temp</code>, but in general it is not necessary to clear the old value before assigning a new value.</p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 1, "last_activity_date": 1552415622, "creation_date": 1552415622, "answer_id": 55128511, "question_id": 55128115, "link": "https://stackoverflow.com/questions/55128115/any-built-in-function-to-empty-the-string-in-c/55128511#55128511", "title": "Any built in function to empty the string in c?", "body": "<p>In C, a string is a sequence of consecutive <code>char</code> variables that is terminated by the representation of zero as a character, <code>'\\0'</code>.</p>\n\n<p>This value acts as a sentinel for the end of the string and allows the idiomatic \"string processing\" loop below:</p>\n\n<pre><code>char *p = &lt;some string&gt;;\nwhile(*p)\n{\n    dosomething(*p);\n    p++;\n}\n</code></pre>\n\n<p>Library functions that process strings (i.e. <code>strlen</code>, <code>strcpy</code>, <code>strcat</code>, etc.) use a construct similar to the code above, and when you write your own code that processes arbitrary strings, you will find the null character check useful; even if a string is stored in a <code>char []</code> array of known length, it decays to a pointer to its first element when passed to a function, losing information about its length.</p>\n\n<p>So, if you want to blank the string, all that is needed is to set the first element of the string to <code>'\\0'</code>. If the first value in the string is the null terminator, the condition <code>*p</code> is false and the loop is never entered:</p>\n\n<pre><code>char *p = \"\\0someotherstuff\";\nprintf(\"%zu\\n\", strlen(p));\n// Output: 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 359, "user_id": 11131487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398e8aa86054b6367dcbf3d0e3a926c9?s=128&d=identicon&r=PG&f=1", "display_name": "NickDoom", "link": "https://stackoverflow.com/users/11131487/nickdoom"}, "is_accepted": false, "score": 0, "last_activity_date": 1552422261, "last_edit_date": 1552422261, "creation_date": 1552417213, "answer_id": 55128901, "question_id": 55128115, "link": "https://stackoverflow.com/questions/55128115/any-built-in-function-to-empty-the-string-in-c/55128901#55128901", "title": "Any built in function to empty the string in c?", "body": "<p>If you need to \u201esecure erase\u201d the data, <code>memset (stringname, 0, strlen(stringname));</code> will wipe the current content. But if you already blanked the string by setting the 1st character to 0, it'll not work because string length is already 0.</p>\n\n<p>For wiping password strings in structures etc., it's safer to keep the full string length and always call <code>memset (stringname, 0, fullstringlength);</code></p>\n\n<p>If you simply want to write new content to temp, you don't even need to clean it first. <code>strcpy (temp, \"the_new_content\");</code> will work. But sometimes cleaning is useful:</p>\n\n<pre><code>void AddToLog (char* news)\n{\n  strcat (temp, news); //Append new part\n  if (strlen (temp) &gt;= worth_saving) //Log is long enough\n  {\n    FlushLog(temp);  //Write it somewhere\n    temp[0]=0;      //Empty the log\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11192960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59185a195a04ba9b7a8c04780c42c4d3?s=128&d=identicon&r=PG&f=1", "display_name": "megha jain", "link": "https://stackoverflow.com/users/11192960/megha-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7138, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1552422261, "creation_date": 1552414141, "last_edit_date": 1552416571, "question_id": 55128115, "link": "https://stackoverflow.com/questions/55128115/any-built-in-function-to-empty-the-string-in-c", "title": "Any built in function to empty the string in c?", "body": "<p>I am new in programming so very less idea about the C libraries.\nProblem-I have a string <code>temp</code>, i want to empty it and store new string in <code>temp</code>.Is there any built in function in C to clear the string like <code>clear()</code> in C++?</p>\n"}, {"tags": ["python", "c", "ctypes"], "comments": [{"owner": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "edited": false, "score": 0, "creation_date": 1552416861, "post_id": 55128055, "comment_id": 96999170, "body": "In Python string are immutable, which means they can&#39;t be changed. I suggest you modify your C function to return a value."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "reply_to_user": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "edited": false, "score": 0, "creation_date": 1552416982, "post_id": 55128055, "comment_id": 96999222, "body": "@martineau OP is writing to a ctypes string buffer, not Python strings"}, {"owner": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1552419192, "post_id": 55128055, "comment_id": 97000343, "body": "@meowgoesthedog: I realize that."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 4, "last_activity_date": 1552417045, "creation_date": 1552417045, "answer_id": 55128851, "question_id": 55128055, "link": "https://stackoverflow.com/questions/55128055/how-do-i-write-to-string-buffer-from-c-in-ctypes/55128851#55128851", "title": "How do I write to string buffer from C in ctypes?", "body": "<p>The problem was actually quite simple. When you use <code>create_string_buffer</code>, it will add a null terminator to the string. This means that <code>len(stri)</code> will yield a result one bigger than <code>len(hello)</code>.</p>\n\n<p>The solution was changing</p>\n\n<pre><code>reverse(stro, stri, len(stri))\n</code></pre>\n\n<p>to</p>\n\n<pre><code>reverse(stro, stri, len(stri)-1)\n</code></pre>\n\n<p>Here is a demonstration where I changed the input string to 'Hello, World!':</p>\n\n<pre><code>$ python rev.py\n'Hello, World!'\n'!dlroW ,olleH'\n</code></pre>\n"}], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552417045, "creation_date": 1552413945, "last_edit_date": 1552416535, "question_id": 55128055, "link": "https://stackoverflow.com/questions/55128055/how-do-i-write-to-string-buffer-from-c-in-ctypes", "title": "How do I write to string buffer from C in ctypes?", "body": "<h2>The problem</h2>\n\n<p>I'm trying to use <code>ctypes</code> to use a C function in Python. The function <code>reverse</code> should write the reverse version of <code>stri</code> to <code>stro</code>.</p>\n\n<p>rev.c:</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n/* length is the length of the string EXCLUDING the \\0 terminator\n*/\nvoid reverse(char * stro, char * stri, size_t length)\n{\n    for(size_t i=0; i&lt;length; i++) stro[i]=stri[length-1-i];\n    stro[length]='\\0';\n}\n</code></pre>\n\n<p>rev.py:</p>\n\n<pre><code>from ctypes import *\n\nrevlib = cdll.LoadLibrary(\"rev.so\");\nreverse = revlib.reverse\nreverse.argtypes = [c_char_p, c_char_p, c_size_t]\n\nhello = \"HelloWorld\"\nstri = create_string_buffer(hello)\nstro = create_string_buffer(b'\\000' * (len(hello)+1))\n\nreverse(stro, stri, len(stri))\n\nprint(repr(stri.value))\nprint(repr(stro.value))\n</code></pre>\n\n<p>I compiled the c file with <code>gcc -o rev.so -shared -fPIC rev.c</code>, invoked <code>export LD_LIBRARY_PATH=.</code> and then I tried the above python script. This is the output:</p>\n\n<pre><code>$ python rev.py \n'HelloWorld'\n''\n</code></pre>\n\n<p>I expected the second line to be <code>'dlroWolleH'</code>. I avoided whitespaces just in case they could cause problems.</p>\n\n<h2>What I have tried</h2>\n\n<p>I compiled the above c function with <code>gcc rev.c -Wall -Wextra -std=c11 -pedantic</code> and it produced no warnings.</p>\n\n<p>The function seems work when I use this main function:</p>\n\n<pre><code>int main() {\n    char * str = \"Hello, World\";\n    char o[100];\n    reverse(o, str, strlen(str));\n    puts(str);\n    puts(o);\n}\n</code></pre>\n\n<p>which yields this output:</p>\n\n<pre><code>$ gcc rev.c; ./a.out \nHello, World\ndlroW ,olleH\n</code></pre>\n\n<p>Just to try to successfully write to a buffer, I tried <code>sscanf</code> like this:</p>\n\n<pre><code>libc = cdll.LoadLibrary(\"libc.so.6\")\nstri = create_string_buffer(100)\nlibc.sscanf(\"HelloWorld\", \"%s\", stri)\nprint(repr(stri.value))\n</code></pre>\n\n<p>And this prints the expected result. But my function does not seem to be able to write to the buffer.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["c", "directory", "filesystems"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1552413917, "post_id": 55127872, "comment_id": 96997669, "body": "I&#39;m no Unix expert, but the <code>dirent</code> struct has a <code>d_type</code> member. Did you check that?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1552413947, "post_id": 55127872, "comment_id": 96997684, "body": "@JohnnyMopp You do not need to be a unix expert to answer a windows question ;)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1552568469, "post_id": 55127872, "comment_id": 97065275, "body": "<code>_access(name, F_OK)</code> is a <a href=\"https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use\" rel=\"nofollow noreferrer\">TOCTOU bug</a>.  Such a check has no purpose and is not definitive - there are ways for <code>access()</code> to work and then <code>opendir()</code> fail on an actual directory.  If you need to know why <code>opendir()</code> fails, check <code>errno</code>."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9894865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652280ea79c41fd7b67d57440c99b115?s=128&d=identicon&r=PG&f=1", "display_name": "cocoz1", "link": "https://stackoverflow.com/users/9894865/cocoz1"}, "edited": false, "score": 0, "creation_date": 1552415244, "post_id": 55128049, "comment_id": 96998374, "body": "Yeah, that worked, thanks! I just appended my &quot;dirname&quot; to the found file names in the while loop and passed the modified string instead of de-&gt;d_name!"}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 1, "last_activity_date": 1552413921, "creation_date": 1552413921, "answer_id": 55128049, "question_id": 55127872, "link": "https://stackoverflow.com/questions/55127872/listing-a-directorys-content-and-checking-if-the-element-is-a-file-or-a-directo/55128049#55128049", "title": "Listing a directory&#39;s content and checking if the element is a file or a directory (C)", "body": "<p>Here, you open the directory given in your <code>opts</code> structure:</p>\n\n<pre><code>DIR *dr = opendir(opts-&gt;dirname);\n</code></pre>\n\n<p>the content of <code>opts-&gt;dirname</code> is <code>C:\\test</code>. However, here:</p>\n\n<pre><code>if ((dp = opendir(name)) != NULL) {\n</code></pre>\n\n<p>you try to open a directory entry <em>relative to your cwd</em> (which is somewhere else). Indeed already your <code>_access()</code> check fails due to that.</p>\n\n<p>Try calling</p>\n\n<pre><code>chdir(opts-&gt;dirname);\n</code></pre>\n\n<p>before your <code>while()</code> loop or build a full path in a string to pass it to <code>_access()</code> and <code>opendir()</code> in your <code>df_isdirectory()</code> function.</p>\n"}], "owner": {"reputation": 63, "user_id": 9894865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652280ea79c41fd7b67d57440c99b115?s=128&d=identicon&r=PG&f=1", "display_name": "cocoz1", "link": "https://stackoverflow.com/users/9894865/cocoz1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552413921, "creation_date": 1552413329, "question_id": 55127872, "link": "https://stackoverflow.com/questions/55127872/listing-a-directorys-content-and-checking-if-the-element-is-a-file-or-a-directo", "title": "Listing a directory&#39;s content and checking if the element is a file or a directory (C)", "body": "<p>I've been trying to find a way to map a directory's content plus a check whether the found \"element\" is either a file or a directory. </p>\n\n<p>I've tried all the \"solutions\" found here:\n<a href=\"https://stackoverflow.com/questions/12510874/how-can-i-check-if-a-directory-exists\">How can I check if a directory exists?</a>, <a href=\"https://stackoverflow.com/questions/6218325/how-do-you-check-if-a-directory-exists-on-windows-in-c\">How do you check if a directory exists on Windows in C?</a> and <a href=\"https://stackoverflow.com/questions/4553012/checking-if-a-file-is-a-directory-or-just-a-file\">Checking if a file is a directory or just a file</a></p>\n\n<p>(My post here is not a duplicate, therefore)</p>\n\n<p>Nothing was working for me. I'm on Windows 10. I'm not a fan of these windows libraries, anyway. That's why I'm looking for a way that only standard C. \nHere's my code so far:</p>\n\n<pre><code>struct dirent *de;\nDIR *dr = opendir(opts-&gt;dirname);\n\n#define DF_ISDIR 0x100\n#define DF_ISFILE 0x200\n#define DF_NOEXIST 0x400\n\n\nwhile ((de = readdir(dr)) != NULL) {\n    int exists = df_isdirectory(de-&gt;d_name);\n    printf(\"[%s]: '%s'\\n\", exists == DF_ISDIR ? \"DIR\" : exists == DF_ISFILE ? \"FILE\" : \"WHATEVER\", de-&gt;d_name);\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>int df_isdirectory(const char *name) {\nassert(name != NULL);\n\nDIR *dp = NULL;\nif (_access(name, F_OK) == 0) {\n    if ((dp = opendir(name)) != NULL) {\n        closedir(dp);\n        return DF_ISDIR; //  element is directory\n    } else {\n        return DF_ISFILE; // element is a file\n    }\n}\n\nreturn DF_NOEXIST; // element is whatever\n</code></pre>\n\n<p>}</p>\n\n<p>It gives me the folliwing output: </p>\n\n<p><a href=\"https://i.stack.imgur.com/wv1Bx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wv1Bx.png\" alt=\"enter image description here\"></a></p>\n\n<p>As we can see, the program detects that .. and . as dirs, but not a single element in my directory. Even though \"another\" and \"dfgsdgf\" ARE DIRECTORIES!</p>\n\n<p><a href=\"https://i.stack.imgur.com/SbF8s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SbF8s.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, why doesn't it consider my actual directories a directory?\nSide note: One directory (\"dfgsdgf\") is empty, the other one (\"another\") is filled with 2 files. </p>\n\n<p>After spending so much time, and trying a ton of \"working\" solutions, I am slowing getting tired of this. I want a detailed explanation WHY MY CODE DOESN'T WORK AS EXPECTED and a clear code snippet THAT WORKS 100%.</p>\n\n<p>PS: My testing dir is C:\\test<br>\nMy exe file is not located in the same directory.</p>\n\n<p>Thanks, and have a nice day!\n~Sebastian</p>\n"}, {"tags": ["c", "clang", "llvm"], "comments": [{"owner": {"reputation": 12858, "user_id": 6752050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5c4caa7ff50e6e492c3957ca20ef6c?s=128&d=identicon&r=PG&f=1", "display_name": "S.M.", "link": "https://stackoverflow.com/users/6752050/s-m"}, "edited": false, "score": 0, "creation_date": 1552413729, "post_id": 55127799, "comment_id": 96997577, "body": "If you had compiled all you files in the different subdirectories using one working directory, that normally cmake does, you would have avoided the described problem with the short file names."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1552434479, "post_id": 55127799, "comment_id": 97006131, "body": "Do you want the filename to be accessed by the pre-compiler, like <code>__FILE__</code>, or is it okay if you get it at run-time?"}, {"owner": {"reputation": 686, "user_id": 8116864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OM0Rh.jpg?s=128&g=1", "display_name": "vasilyrud", "link": "https://stackoverflow.com/users/8116864/vasilyrud"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1552435776, "post_id": 55127799, "comment_id": 97006421, "body": "@NeilEdelman Either way is fine. I think <code>__sanitizer_symbolize_pc</code> is already a run-time call, although my guess is that it uses debug symbols from compile-time."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1552506270, "post_id": 55127799, "comment_id": 97040465, "body": "MacOSX may use <a href=\"https://stackoverflow.com/questions/10365086/glibc-function-to-retrieve-current-executable-name\" title=\"glibc function to retrieve current executable name\">stackoverflow.com/questions/10365086/&hellip;</a>."}, {"owner": {"reputation": 686, "user_id": 8116864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OM0Rh.jpg?s=128&g=1", "display_name": "vasilyrud", "link": "https://stackoverflow.com/users/8116864/vasilyrud"}, "reply_to_user": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 1, "creation_date": 1552530795, "post_id": 55127799, "comment_id": 97048348, "body": "@NeilEdelman Thanks! Although it looks like the other question is for getting the executable file&#39;s name rather than the source file&#39;s name."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1552586660, "post_id": 55127799, "comment_id": 97077902, "body": "Ahh, I misunderstood the question. <code>realpath</code> is not in my MacOS, but see <a href=\"https://stackoverflow.com/questions/1055671/how-can-i-get-the-behavior-of-gnus-readlink-f-on-a-mac\" title=\"how can i get the behavior of gnus readlink f on a mac\">stackoverflow.com/questions/1055671/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 729, "user_id": 11060870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a74dd465c0373f529ebe6f9ee7592add?s=128&d=identicon&r=PG", "display_name": "ccxxshow", "link": "https://stackoverflow.com/users/11060870/ccxxshow"}, "is_accepted": false, "score": 2, "last_activity_date": 1552451249, "creation_date": 1552451249, "answer_id": 55134408, "question_id": 55127799, "link": "https://stackoverflow.com/questions/55127799/how-to-get-full-path-to-source-file-in-c/55134408#55134408", "title": "How to get full path to source file in C?", "body": "<p>can consider giving it a full path at compile time?</p>\n\n<p>like the following, call the <code>realpath</code> to take a full path</p>\n\n<pre><code>SRCS = $(wildcard *.c)\nOBJS = $(SRCS:.c=.o)\nCFLAGS = -g -Wall\nCC = clang\nBIN = test\n\n$(BIN) : $(OBJS)\n    $(CC) $^ -o $@\n\n%.o : %.c\n    $(CC) $(CFLAGS) -c $(realpath $&lt;)\n\nclean:\n    rm -f $(OBJS) $(BIN)\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 8116864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OM0Rh.jpg?s=128&g=1", "display_name": "vasilyrud", "link": "https://stackoverflow.com/users/8116864/vasilyrud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2175, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1552451249, "creation_date": 1552413073, "last_edit_date": 1552413534, "question_id": 55127799, "link": "https://stackoverflow.com/questions/55127799/how-to-get-full-path-to-source-file-in-c", "title": "How to get full path to source file in C?", "body": "<p>I know that I can do the following to print the source file from within a C program:</p>\n\n<pre><code>printf(\"__FILE__: %s\\n\", __FILE__);\n</code></pre>\n\n<p>However, this yields the \"path by which the preprocessor opened the file\", according to the <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Standard-Predefined-Macros.html\" rel=\"nofollow noreferrer\">docs</a>. In this case it gives:</p>\n\n<pre><code>__FILE__: common.c\n</code></pre>\n\n<p>I know further that I can use the following <a href=\"https://releases.llvm.org/7.0.1/tools/clang/docs/SanitizerCoverage.html\" rel=\"nofollow noreferrer\">clang feature</a> to print the source file as well:</p>\n\n<pre><code>void *pc = __builtin_return_address(0);\nchar pc_desc[1024];\n__sanitizer_symbolize_pc(pc, \"%p %F %L\", pc_desc, sizeof(pc_desc));\nprintf(\"__sanitizer_symbolize_pc: %s\\n\", pc_desc);\n</code></pre>\n\n<p>Similarly, though, it only prints the relative path:</p>\n\n<pre><code>__sanitizer_symbolize_pc: 0x10563a873 in Y common.c:4\n</code></pre>\n\n<p>This is a problem when two files have the same static function (in this case <code>Y</code>) on the same line in separate sub-directories, e.g.:</p>\n\n<pre><code>__sanitizer_symbolize_pc: 0x10563a873 in Y common.c:4\n__sanitizer_symbolize_pc: 0x10563a933 in Y common.c:4\n</code></pre>\n\n<p>Of course the code could be refactored, or the binary matched to the source code after the program runs, or the compilation process could be changed to compile the <code>common.c</code> file from a higher-up parent folder. But given this example, how does one get the full path to the source file from the C program itself?</p>\n\n<p>It seems that clang's IR has the directory info preserved <a href=\"http://llvm.org/doxygen/classllvm_1_1DIScope.html#aa15b555d1f611dd569d76097fd969da1\" rel=\"nofollow noreferrer\">in metadata</a>, but it is unclear how it is accessed. For example, the <code>common.ll</code> file contains the following line:</p>\n\n<pre><code>!1 = !DIFile(filename: \"common.c\", directory: \"/full/path/to/subdir\")\n</code></pre>\n\n<p><sub>\nI am using manually-compiled clang 7.0.1 on Mac OS.\n</sub></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1552412945, "post_id": 55127521, "comment_id": 96997161, "body": "Are you allowed to use useful functions such as <code>strstr()</code>?"}, {"owner": {"reputation": 29, "user_id": 9815123, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "networkingog", "link": "https://stackoverflow.com/users/9815123/networkingog"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1552413032, "post_id": 55127521, "comment_id": 96997208, "body": "@JonathanLeffler no :/"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1552413082, "post_id": 55127521, "comment_id": 96997232, "body": "Did you consider writing your own <code>mq_strstr()</code> to mimic the standard function?  Would that simplify your code?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9815123, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "networkingog", "link": "https://stackoverflow.com/users/9815123/networkingog"}, "edited": false, "score": 0, "creation_date": 1552413348, "post_id": 55127818, "comment_id": 96997372, "body": "so what do I do?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 29, "user_id": 9815123, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "networkingog", "link": "https://stackoverflow.com/users/9815123/networkingog"}, "edited": false, "score": 0, "creation_date": 1552413504, "post_id": 55127818, "comment_id": 96997453, "body": "@MimozaQati are you allowed to use strcmp ?"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 29, "user_id": 9815123, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "networkingog", "link": "https://stackoverflow.com/users/9815123/networkingog"}, "edited": false, "score": 0, "creation_date": 1552417003, "post_id": 55127818, "comment_id": 96999234, "body": "@MimozaQati answer edited to add a proposal more additional code to be able to run and show that works"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": false, "score": 2, "last_activity_date": 1552420104, "last_edit_date": 1552420104, "creation_date": 1552413138, "answer_id": 55127818, "question_id": 55127521, "link": "https://stackoverflow.com/questions/55127521/function-search-of-a-motive-gives-an-error-with-capital-letters/55127818#55127818", "title": "Function search of a motive gives an error with capital letters", "body": "<p>The code</p>\n\n<pre><code>   while(temp-&gt;text[i] != ptr[j] &amp;&amp; temp-&gt;text[i] != '\\0')\n    {\n        i++;\n    }\n\n    if(temp-&gt;text[i] == ptr[j])\n    {\n        while(temp-&gt;text[i] != '\\0' &amp;&amp; ptr[j] != '\\0' &amp;&amp; ptr[j] == temp-&gt;text[i])\n        {\n            j++;\n            i++;\n        }\n\n        if(ptr[j] == '\\0')\n        {\n            printf(\"%s\", temp-&gt;text);\n        }\n    }\n</code></pre>\n\n<p>fails if the first time the first character of <em>ptr</em> is present in <em>temp->text</em> is not the sequence you search</p>\n\n<p>for instance if <em>ptr</em> is \"AZE\" and <code>temp-&gt;text</code> is \"...A AZE\" your first while set <em>i</em> to 3, and after you compare \"AZE\" and \"A AZE\" and there are not equals</p>\n\n<hr>\n\n<p>Here a proposal, the code has to check if <em>motif</em> is a substring of each message's text, so the more natural is to define <em>contient</em> equivalent of <em>strstr</em> :</p>\n\n<pre><code>char * contient(const char * meule, const char * aiguille)\n{\n  /* strstr */\n  while (*meule) {\n    const char * p1 = meule;\n    const char * p2 = aiguille;\n\n    if (*p1 == *p2) {\n      do {\n        p1 += 1;\n        p2 += 1;\n\n        if (*p2 == 0)\n          return (char *) meule;\n      } while  (*p1 == *p2);\n    }\n\n    meule += 1;\n  }\n\n  return NULL;\n}\n\nvoid trouverMotif(message_t ** tete, char motif[])\n{\n  message_t *temp = *tete;\n\n  while(temp != NULL)\n  {\n    /* printf(\"%s\\n\", p); */\n\n    if (contient(temp-&gt;text, motif) != NULL)\n      printf(\"'%s' found in '%s'\\n\", motif, temp-&gt;text);\n\n    temp = temp-&gt;suivant;\n  }\n}\n</code></pre>\n\n<hr>\n\n<p>For instance if I add :</p>\n\n<pre><code>typedef struct message_t {\n  char * text;\n  struct message_t * suivant;\n}  message_t;\n\nmessage_t * mk(char * t, message_t * n)\n{\n  message_t * r = malloc(sizeof(message_t));\n\n  r-&gt;text = t;\n  r-&gt;suivant = n;\n  return r;\n}\n\nint main()\n{\n  message_t * tete = mk(\"19971230 20220512 JE SERAI INGENIEURE\",\n                        mk(\"19950511 20211230 ISI\",\n                           mk(\"19971230 20301123 INFORMATIQUE C'EST LA VIE\",\n                              mk(\"20020809 20081025 LANGAGE DE PROGRAMMATION\",\n                                 mk(\"20070905 20201104 ECOLE INGENIEUR\",\n                                    mk(\"19990102 20051025 ORDINATEUR\",\n                                       mk(\"20081212 20200312 JE SUIS \", NULL)))))));\n\n\n  trouverMotif(&amp;tete, \"INGE\");\n}\n</code></pre>\n\n<p>Compilation and execution :</p>\n\n<pre><code>pi@raspberrypi:/tmp $ ./a.out\n'INGE' found in '19971230 20220512 JE SERAI INGENIEURE\n'INGE' found in '20070905 20201104 ECOLE INGENIEUR\n</code></pre>\n\n<p>Remark : you do not need <code>trouverMotif(message_t ** tete, char motif[])</code> because you do not modify <em>tete</em>, so <code>trouverMotif(message_t * tete, char motif[])</code> is enough</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 9815123, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "networkingog", "link": "https://stackoverflow.com/users/9815123/networkingog"}, "edited": false, "score": 0, "creation_date": 1552413494, "post_id": 55127899, "comment_id": 96997448, "body": "so what do I do to avoid this? @jo-art"}], "tags": [], "owner": {"reputation": 165, "user_id": 7674036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fc24be819777721aaf238b8d369e07a?s=128&d=identicon&r=PG&f=1", "display_name": "jo-art", "link": "https://stackoverflow.com/users/7674036/jo-art"}, "is_accepted": false, "score": 1, "last_activity_date": 1552483389, "last_edit_date": 1552483389, "creation_date": 1552413406, "answer_id": 55127899, "question_id": 55127521, "link": "https://stackoverflow.com/questions/55127521/function-search-of-a-motive-gives-an-error-with-capital-letters/55127899#55127899", "title": "Function search of a motive gives an error with capital letters", "body": "<p>When you search for <code>INGE</code> in <code>JE SERAI INGENIEUR</code> the <code>i</code> in <code>SERAI</code> will match <code>I</code> in <code>INGE</code>, and advance to <code>N. When you reach</code>INGENIEUR<code>, you will no longer match the</code>I`</p>\n"}], "owner": {"reputation": 29, "user_id": 9815123, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "networkingog", "link": "https://stackoverflow.com/users/9815123/networkingog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552483389, "creation_date": 1552412044, "last_edit_date": 1552413040, "question_id": 55127521, "link": "https://stackoverflow.com/questions/55127521/function-search-of-a-motive-gives-an-error-with-capital-letters", "title": "Function search of a motive gives an error with capital letters", "body": "<p>I have implemented this function in C to find a motive in a given file. \nSo the file contains the messages as below: \nFor example <code>ISI</code>, <code>JE SERAI INGENIEURE</code> etc are messages.</p>\n\n<pre><code>19971230 20220512 JE SERAI INGENIEURE\n19950511 20211230 ISI\n19971230 20301123 INFORMATIQUE C'EST LA VIE\n20020809 20081025 LANGAGE DE PROGRAMMATION\n20070905 20201104 ECOLE INGENIEUR\n19990102 20051025 ORDINATEUR\n20081212 20200312 JE SUIS \n</code></pre>\n\n<p>Each information is put in a linked list.</p>\n\n<p>This is my code : </p>\n\n<pre><code>void trouverMotif(message_t ** tete, char motif[])\n{\n    message_t *temp = *tete;\n    char *ptr = motif;\n    int i = 0, j = 0;\n\n    while(temp != NULL)\n    {\n        printf(\"%s\\n\",temp-&gt;text);\n        i = 0;\n        j = 0;\n\n        while(temp-&gt;text[i] != ptr[j] &amp;&amp; temp-&gt;text[i] != '\\0')\n        {\n            i++;\n        }\n\n        if(temp-&gt;text[i] == ptr[j])\n        {\n            while(temp-&gt;text[i] != '\\0' &amp;&amp; ptr[j] != '\\0' &amp;&amp; ptr[j] == temp-&gt;text[i])\n            {\n                j++;\n                i++;\n            }\n\n            if(ptr[j] == '\\0')\n            {\n                printf(\"%s\", temp-&gt;text);\n            }\n        }\n        temp = temp-&gt;suivant;\n    }\n}\n</code></pre>\n\n<p>So the result that I want to have is that, if I put the motif = \"INGE\" , the result gives me the messages that contain \"INGE\", in my case; JE SERAI INGENIEURE and ECOLE INGENIEUR.</p>\n\n<p>The problem is that the result that I obtain is only ECOLE INGENIEUR and not both of them. When I change the messages to lower case letters, it gives the right result (both of them). How is this possible?</p>\n"}, {"tags": ["c", "hex", "scanf"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1552411788, "post_id": 55127405, "comment_id": 96996479, "body": "Because <code>%x</code> reads in an unsigned integer and unsigned integers are by <i>definition always non-negative</i>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552411829, "post_id": 55127405, "comment_id": 96996500, "body": "So what is it that you expect?"}, {"owner": {"reputation": 3, "user_id": 11192711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89af702e3c1f17a994107e67f7ec9e28?s=128&d=identicon&r=PG&f=1", "display_name": "Rhea", "link": "https://stackoverflow.com/users/11192711/rhea"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552411995, "post_id": 55127405, "comment_id": 96996590, "body": "If the user writes -5 I would like it to print Invalid input."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552412037, "post_id": 55127405, "comment_id": 96996619, "body": "but the result is a valid positive value <code>UINT_MAX + 1 - 5 </code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1552412070, "post_id": 55127405, "comment_id": 96996643, "body": "or do you mean that the number mustn&#39;t have a sign at all?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552412137, "post_id": 55127405, "comment_id": 96996680, "body": "It&#39;s a good point: I would expect the input to be terminated at the <code>-</code> just as it would be terminated at <code>z</code> if <code>&quot;z5&quot;</code> is input. MSVC accepts <code>&quot;-5&quot;</code> and <code>scanf</code> returns a value of <code>1</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1552412326, "post_id": 55127405, "comment_id": 96996790, "body": "You should test the return value from <code>scanf()</code> to see whether it was successful.  Nevertheless, negative values can be read.  POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/scanf.html\" rel=\"nofollow noreferrer\"><code>scanf()</code></a> says: <i><code>x</code> Matches an optionally signed hexadecimal integer, whose format is the same as expected for the subject sequence of <code>strtoul()</code> with the value 16 for the base argument. In the absence of a size modifier, the application shall ensure that the corresponding argument is a pointer to <code>unsigned</code>.</i>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1552412334, "post_id": 55127405, "comment_id": 96996797, "body": "Aside: the result is at the mercy of an uninitialised variable, and an unchecked <code>scanf</code> function return value."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1552412400, "post_id": 55127405, "comment_id": 96996839, "body": "So <code>-5</code> is a proper encoding (writing) of a hexadecimal number: the hexadecimal representation of <code>-5</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1552412565, "post_id": 55127405, "comment_id": 96996925, "body": "Two things: Always check what <a href=\"https://en.cppreference.com/w/c/io/fscanf#Return_value\" rel=\"nofollow noreferrer\"><code>scanf</code> <i>returns</i></a>. Secondly, if <code>scanf</code> fails to parse the input according to the format, it will leave the input in the buffer."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1552415095, "post_id": 55127405, "comment_id": 96998292, "body": "Rhea , What should input <code>&quot;-0&quot;</code> return? <code>&quot;Invalid input!&quot;</code> or <code>0</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1552415523, "last_edit_date": 1552415523, "creation_date": 1552414349, "answer_id": 55128169, "question_id": 55127405, "link": "https://stackoverflow.com/questions/55127405/c-read-hex-number-and-check-if-less-then-zero-scanf/55128169#55128169", "title": "C - Read hex number and check if less then zero scanf()", "body": "<blockquote>\n  <p>Is there some easy way to check if the input is less then zero </p>\n</blockquote>\n\n<p><code>\"%x\"</code> accepts input like <code>\"-123\"</code> and forms an <code>unsigned</code> positive value of <code>UINT_MAX + 1 - 123</code>.  So that alone is not enough.</p>\n\n<p>Alternatively, look for the <code>'-'</code> yourself.</p>\n\n<p>Below uses <code>\"%n\"</code> to detect if scanning succeeded past the 1 or more <code>'-'</code> (scanned with <code>\"%*[-]\"</code>).  If no leading <code>'-'</code>, nothing but leading spaces consumed and <code>n</code> remains 0.</p>\n\n<pre><code>  int n = 0;\n  scanf(\" %*[-]%n\", &amp;n);\n  if (n) {\n    printf(\"Invalid negative input!\\n\");\n  } else if (scanf(\"%x\",&amp;number) != 1) {\n    printf(\"Invalid non-hex input!\\n\");\n  } else {\n    printf(\"Success %x\\n\", number);\n  }\n</code></pre>\n\n<hr>\n\n<p>Unclear what OP wants to do should invalid input occur.</p>\n\n<hr>\n\n<p>A better approach would use <code>fgets()</code> to read a line of user input and then parse that.</p>\n\n<pre><code> char buf[80];\n if (fgets(buf, sizeof buf, stdin) {\n   unsigned int number;\n   if (strchr(buf, '-') == NULL &amp;&amp; sscanf(buf, \"%x\", &amp;number) == 1) {\n     printf(\"Success %x\\n\", number);\n   } else {\n     printf(\"Fail\\n\");\n   }\n}\n</code></pre>\n\n<p>Even better code would use <code>strtoul()</code> and not <code>sscanf()</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 11192711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89af702e3c1f17a994107e67f7ec9e28?s=128&d=identicon&r=PG&f=1", "display_name": "Rhea", "link": "https://stackoverflow.com/users/11192711/rhea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1552415523, "creation_date": 1552411589, "last_edit_date": 1552412073, "question_id": 55127405, "link": "https://stackoverflow.com/questions/55127405/c-read-hex-number-and-check-if-less-then-zero-scanf", "title": "C - Read hex number and check if less then zero scanf()", "body": "<p>I'm writing a program in C which reads a hexadecimal number with <code>scanf()</code> and I want to check if the value is valid. But if I write -5 it shows that the input is valid. Is there some easy way to check if the input is less then zero or do I have to read it as signed and then change it?</p>\n\n<pre><code>unsigned int number;\nscanf(\"%x\",&amp;number);\nif (....) {\n    printf(\"Invalid input!\\n\");\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1552411175, "post_id": 55127258, "comment_id": 96996129, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\">Why is \u201cwhile (!feof(file))\u201d always wrong?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 1, "last_activity_date": 1552412416, "last_edit_date": 1552412416, "creation_date": 1552411975, "answer_id": 55127500, "question_id": 55127258, "link": "https://stackoverflow.com/questions/55127258/my-array-does-not-appear-in-my-text-file-when-i-try-to-read-it-from-my-binary-fi/55127500#55127500", "title": "My array does not appear in my text file when i try to read it from my binary file", "body": "<p>Replace</p>\n\n<blockquote>\n<pre><code>   fread(&amp;s, sizeof(STUDENT), 1, f);\n   while (!feof(f)) {\n       ...\n       fread(&amp;s, sizeof(STUDENT), 1, f);\n   }\n</code></pre>\n</blockquote>\n\n<p>by</p>\n\n<pre><code>    while (fread(&amp;s, sizeof(STUDENT), 1, f) == sizeof(STUDENT)) {\n        ...\n    }\n</code></pre>\n\n<p>this have several advantages :</p>\n\n<ul>\n<li>as already mentioned in a remark that allows you to detect the end of the file, contrarily with <em>feof</em> ( <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\">Why is \u201cwhile (!feof(file))\u201d always wrong?</a> )</li>\n<li>you detect if your file is corrupted (too short)</li>\n<li>you write only one time the call to <em>fread</em> in your code</li>\n</ul>\n\n<p>Probably modify <code>fprintf(g, \"%s\", s.note[i]);</code> to be <code>fprintf(g, \"%s \", s.note[i]);</code> to separate the notes, and except if you really want to write a very long line add a <code>fputc('\\n', g);</code> at the end of the <em>while</em></p>\n"}], "owner": {"reputation": 135, "user_id": 11192290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tGH9zj1nnxU/AAAAAAAAAAI/AAAAAAAAALM/BSYluOgEa54/photo.jpg?sz=128", "display_name": "Andreea Elena", "link": "https://stackoverflow.com/users/11192290/andreea-elena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 55127500, "answer_count": 1, "score": -1, "last_activity_date": 1552414408, "creation_date": 1552411082, "last_edit_date": 1552414408, "question_id": 55127258, "link": "https://stackoverflow.com/questions/55127258/my-array-does-not-appear-in-my-text-file-when-i-try-to-read-it-from-my-binary-fi", "title": "My array does not appear in my text file when i try to read it from my binary file", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n\ntypedef struct {\n      char CNP[14];\n      char nume[30];\n      int an;\n      int grupa;\n      int nrDiscipline;\n      char note[20];\n} STUDENT;\n\nvoid main() {\n    FILE*f;\n    char numef[20];\n    STUDENT s;\n    printf(\"Nume fisier:\"); gets(numef);\n    f = fopen(numef, \"rb\");\n    if (!f)\n        printf(\"eroare\");\n    else {\n        FILE*g;\n        fopen_s(&amp;g,\"stud.txt\", \"w\");\n        fread(&amp;s, sizeof(STUDENT), 1, f);\n        while (!feof(f)) {\n            fprintf( g,\"%s %s %d %d %d \", s.CNP, s.nume, s.an, s.grupa, s.nrDiscipline);\n            for (int i = 0; i &lt; s.nrDiscipline; i++)\n            {\n                fprintf(g, \"%s\", s.note[i]);   \n            }\n\n            fread(&amp;s, sizeof(STUDENT), 1, f);\n        }\n        fclose(g); fclose(f);\n\n    }\n\n}\n</code></pre>\n\n<p>First I created the binary file, which went good, but then I open the text file and the array is not correct, it appears to contain some random numbers, probably some addresses. I tried everything but it doesn't work.</p>\n"}, {"tags": ["c", "visual-studio-code"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 2, "creation_date": 1552411412, "post_id": 55127041, "comment_id": 96996261, "body": "What do you mean by <i>run</i> a <code>.c</code> file? Do you mean compile or build? Or are each of your <code>.c</code> files intended to be stand-alone programs?"}, {"owner": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "edited": false, "score": 1, "creation_date": 1552411482, "post_id": 55127041, "comment_id": 96996301, "body": "Also, do you have the exact command being run? And the directory from which it is run?"}, {"owner": {"reputation": 253, "user_id": 7375520, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/36aa066451c0c79e6bf058227eaf79e7?s=128&d=identicon&r=PG&f=1", "display_name": "user7375520", "link": "https://stackoverflow.com/users/7375520/user7375520"}, "edited": false, "score": 0, "creation_date": 1552411489, "post_id": 55127041, "comment_id": 96996307, "body": "I meant compile and execute. Yes all are independent .c files."}, {"owner": {"reputation": 253, "user_id": 7375520, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/36aa066451c0c79e6bf058227eaf79e7?s=128&d=identicon&r=PG&f=1", "display_name": "user7375520", "link": "https://stackoverflow.com/users/7375520/user7375520"}, "reply_to_user": {"reputation": 1173, "user_id": 10805404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8a89f2c1ea92ac8bb7a02028c6339?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Doppler", "link": "https://stackoverflow.com/users/10805404/simon-doppler"}, "edited": false, "score": 0, "creation_date": 1552411535, "post_id": 55127041, "comment_id": 96996331, "body": "@SimonDoppler From cmd line in VS code. I can run. But want to know why (CTRL+F5) is not working."}, {"owner": {"reputation": 253, "user_id": 7375520, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/36aa066451c0c79e6bf058227eaf79e7?s=128&d=identicon&r=PG&f=1", "display_name": "user7375520", "link": "https://stackoverflow.com/users/7375520/user7375520"}, "edited": false, "score": 1, "creation_date": 1552412897, "post_id": 55127041, "comment_id": 96997130, "body": "I think it is some issue with the task.json it is picking. Always picking the same task.json even if the .c file is in a different directory and hence failing to locate the file."}], "owner": {"reputation": 253, "user_id": 7375520, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/36aa066451c0c79e6bf058227eaf79e7?s=128&d=identicon&r=PG&f=1", "display_name": "user7375520", "link": "https://stackoverflow.com/users/7375520/user7375520"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 827, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1552410287, "creation_date": 1552410287, "question_id": 55127041, "link": "https://stackoverflow.com/questions/55127041/vs-code-no-such-file-or-directory", "title": "VS Code: No such file or directory", "body": "<p>Have a nested directory structure and few C programs under each directory.\n    Directory hierarchy is below (B is inside A). However, I'm able to run 1.c and 2.c from VS code (ctrl+F5) but not 3.c and 4.c. When I run them it shows:</p>\n\n<pre><code>No such file or directory\ngcc.exe: fatal error: no input files\n\n        A\n         - 1.c\n         - 2.c\n         B\n           - 3.c\n           - 4.c\n</code></pre>\n\n<p>Can you pls suggest what am I missing in my .json files to run any program using (ctrl+F5) irrespective of it's directory location.</p>\n"}, {"tags": ["c", "bit", "lsb"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1552409618, "post_id": 55126805, "comment_id": 96995231, "body": "<i>doesn&#39;t work for me.</i> - why do you think it doesn&#39;t?"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 1, "creation_date": 1552409764, "post_id": 55126805, "comment_id": 96995306, "body": "your example suggests you want the lowest byte (<code>0x40</code>), not the lowest bits."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552409819, "post_id": 55126805, "comment_id": 96995341, "body": "Yeah.. looks like you mean &quot;two least significant hex digits&quot;. Or your example is incorrect"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1552409914, "post_id": 55126805, "comment_id": 96995399, "body": "Your edit made it even worse. You want <i>one</i> byte, and the code is not corresponding at all now."}, {"owner": {"reputation": 805, "user_id": 803700, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d70791dac0a642c7fe0c9d86219e8cd4?s=128&d=identicon&r=PG", "display_name": "c_prog_90", "link": "https://stackoverflow.com/users/803700/c-prog-90"}, "edited": false, "score": 0, "creation_date": 1552409915, "post_id": 55126805, "comment_id": 96995401, "body": "updated the question. was a typo."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1552409962, "post_id": 55126805, "comment_id": 96995428, "body": "<code>0x5040</code> is only two bytes long.  If you want the lowest two bytes, the answer is <code>0x5040</code>.  <b><i>Do you even know how Hex works??</i></b>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1552410021, "post_id": 55126805, "comment_id": 96995473, "body": "I suggest you to stop editing, think a bit and reword the question and the code completely. No rush."}, {"owner": {"reputation": 805, "user_id": 803700, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d70791dac0a642c7fe0c9d86219e8cd4?s=128&d=identicon&r=PG", "display_name": "c_prog_90", "link": "https://stackoverflow.com/users/803700/c-prog-90"}, "edited": false, "score": 0, "creation_date": 1552417505, "post_id": 55126805, "comment_id": 96999493, "body": "Sorry about the confusion. I didnt post my question correctly. thanks for fixing it."}], "answers": [{"tags": [], "owner": {"reputation": 3560, "user_id": 5550963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7jAip.png?s=128&g=1", "display_name": "CEPB", "link": "https://stackoverflow.com/users/5550963/cepb"}, "is_accepted": false, "score": 0, "last_activity_date": 1552414763, "last_edit_date": 1552414763, "creation_date": 1552409979, "answer_id": 55126930, "question_id": 55126805, "link": "https://stackoverflow.com/questions/55126805/get-lowest-bytes-from-an-uint16-t-in-c/55126930#55126930", "title": "Get lowest bytes from an uint16_t in C", "body": "<p>To preserver two least significant bytes:</p>\n\n<pre><code>X &amp; 0xffff\n</code></pre>\n\n<p>or in your manner </p>\n\n<p><code>(x &amp; (1 &lt;&lt; 16) - 1)</code></p>\n\n<p>As posted in comment this might be an issue in some cases where <code>int</code> has 16 bits, thus I prefer <code>x &amp; 0xffff</code>. There is another \"clever\" way of doing this:</p>\n\n<p><code>(X &amp; ((unsinged char) ~0)</code></p>\n\n<p>or </p>\n\n<p><code>(X &amp; ((uint8_t) ~0)</code></p>\n\n<p>This is really hard to keep up with edits and unclear question.</p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 4, "last_activity_date": 1552410164, "creation_date": 1552410164, "answer_id": 55127003, "question_id": 55126805, "link": "https://stackoverflow.com/questions/55126805/get-lowest-bytes-from-an-uint16-t-in-c/55127003#55127003", "title": "Get lowest bytes from an uint16_t in C", "body": "<p>You use bytes (plural), but a <code>uint16_t</code> is composed of two bytes, so I'm assuming you mean the least significant byte (singular).  If that's so, here is one way of obtaining it:</p>\n\n<pre><code>uint8_t lsb = ((uint8_t)(((uint32_t)(val)) &amp; 0xFF))\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 803700, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d70791dac0a642c7fe0c9d86219e8cd4?s=128&d=identicon&r=PG", "display_name": "c_prog_90", "link": "https://stackoverflow.com/users/803700/c-prog-90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 55127003, "answer_count": 2, "score": -3, "last_activity_date": 1552414763, "creation_date": 1552409561, "last_edit_date": 1552411169, "question_id": 55126805, "link": "https://stackoverflow.com/questions/55126805/get-lowest-bytes-from-an-uint16-t-in-c", "title": "Get lowest bytes from an uint16_t in C", "body": "<p>I want to get the lowest bytes of an <code>uint16_t</code> in C. </p>\n\n<p>Example:</p>\n\n<pre><code>20544 = 0x5040\n0x40 = 64\n</code></pre>\n\n<p>I tried, <code>(X &amp; ((1&lt;&lt;2) - 1))</code>. This doesn't work for me. </p>\n"}]