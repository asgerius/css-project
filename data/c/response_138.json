[{"tags": ["c", "stack-overflow", "mergesort"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 8, "creation_date": 1504133475, "post_id": 45970835, "comment_id": 78900796, "body": "Stop using recursion to merge lists; do it iteratively."}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 1, "creation_date": 1504133973, "post_id": 45970835, "comment_id": 78900929, "body": "Well, you could block it in your hosts file, you could use a parental controls app... Oh! You meant a <i>literal</i> stack overflow! Well, in that case, user2357112 is right, you&#39;ve probably hit the recursion limit. ;-)"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504134732, "post_id": 45970835, "comment_id": 78901160, "body": "Using recursion produces elegant code,, but you see first hand here its trouble and limitations. At the segfault (or any breakpoint) in <code>gdb</code> you can type <code>bt</code> (short for backtrace) and it will print out the call stack ... can&#39;t <i>quiiite</i> tell if you know this already."}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1504153889, "post_id": 45971295, "comment_id": 78905353, "body": "<i>You can also encapsulate parameters with another struct so that you don&#39;t have to pass in three pointers onto the new stack call, I.E., one parameter takes up less space than 3.</i> --- what? You do realize that you will have to make space for the struct on the caller stack?"}, {"owner": {"reputation": 484, "user_id": 4027709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle s", "link": "https://stackoverflow.com/users/4027709/kyle-s"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504244135, "post_id": 45971295, "comment_id": 78947507, "body": "Allocate in the heap is another option."}], "tags": [], "owner": {"reputation": 484, "user_id": 4027709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Kyle s", "link": "https://stackoverflow.com/users/4027709/kyle-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1504137120, "creation_date": 1504137120, "answer_id": 45971295, "question_id": 45970835, "link": "https://stackoverflow.com/questions/45970835/how-do-i-prevent-stack-overflow-when-using-merge-sort-on-large-amounts-of-data/45971295#45971295", "title": "How do I prevent stack overflow when using merge sort on large amounts of data?", "body": "<p>This simplest answer is not to use recursion. </p>\n\n<p>However, if you are dead set on using recursion you can limit what goes on the stack by moving temp variables used in the function to outside the scope of the function or declaring them <a href=\"https://stackoverflow.com/questions/572547/what-does-static-mean\">static</a> so that they can be reused rather than making room for them every time merge is called (can have adverse effects if you are interesting in multi-threaded applications). It doesn't look like you have any variables that would be safe to do this with.</p>\n\n<p>You can also encapsulate parameters with another struct so that you don't have to pass in three pointers onto the new stack call, I.E., one parameter takes up less space than 3.</p>\n\n<p>Something like:</p>\n\n<pre><code>struct IntList* Merge(struct mergeData* data)\n</code></pre>\n\n<p>There are also ways of <a href=\"https://stackoverflow.com/a/36023436/4027709\">adjusting the stack size</a> so that your application can handle the data sets you expect.</p>\n\n<p>Overall, this is a limitation of recursion. If you deal with embedded systems that have limited resources (like myself), then you usually avoid it.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 1, "last_activity_date": 1504141118, "creation_date": 1504141118, "answer_id": 45971703, "question_id": 45970835, "link": "https://stackoverflow.com/questions/45970835/how-do-i-prevent-stack-overflow-when-using-merge-sort-on-large-amounts-of-data/45971703#45971703", "title": "How do I prevent stack overflow when using merge sort on large amounts of data?", "body": "<p>If you want to use recursion, it is best to try to express it in tail-call form (so that nothing is done after the recursive call returns other than a return).  That way most compilers will optimize the tail-call into a simple jump and not use any stack space.  For your <code>Merge</code> function, it becomes something like:</p>\n\n<pre><code>void Merge(struct IntList **merged, struct IntList* Front,struct IntList* Back,enum SortBy Type)\n{\n    if(Front==NULL) {\n        *merged = Back;\n    } else if (Back==NULL) {\n        *merged = Front;\n    } else if(Type==DATA) {\n        if(Front-&gt;Value &lt;= Back-&gt;Value) {\n            *merged = Front;\n            Merge(&amp;Front-&gt;Next, Front-&gt;Next, Back, Type);\n        } else {\n            *merged = Back;\n            Merge(&amp;Back-&gt;Next, Front, Back-&gt;Next,Type);\n        }//Takes Greatest Value for Sorted List if Sorting by Value\n    } else if(Type==FREQUENCY) {\n        if(Front-&gt;Frequency &lt; Back-&gt;Frequency) {\n            *merged = Front;\n            Merge(&amp;Front-&gt;next, Front-&gt;Next, Back, Type);\n        } else {\n            *merged = Back;\n            Merge(&amp;Back-&gt;Next, Front, Back-&gt;Next, Type);\n        }//Takes Greatest Frequency for Sorted List\n    }//If Sorting by Frequency\n}\n</code></pre>\n\n<p>If your compiler doesn't support tail recursion optimization, you can do it yourself by making the body of the function a loop:</p>\n\n<pre><code>void Merge(struct IntList **merged, struct IntList* Front,struct IntList* Back,enum SortBy Type)\n{\n  while(Front || Back) {\n    if(Front==NULL) {\n        *merged = Back;\n        Back = NULL;\n    } else if (Back==NULL) {\n        *merged = Front;\n        Front = NULL\n    } else if(Type==DATA) {\n        if(Front-&gt;Value &lt;= Back-&gt;Value) {\n            *merged = Front;\n            merged = &amp;Front-&gt;Next;\n            Front = Front-&gt;Next;\n        } else {\n            *merged = Back;\n            merged = &amp;Back-&gt;Next;\n            Back = Back-&gt;Next;\n        }//Takes Greatest Value for Sorted List if Sorting by Value\n    } else if(Type==FREQUENCY) {\n        if(Front-&gt;Frequency &lt; Back-&gt;Frequency) {\n            *merged = Front;\n            merged = &amp;Front-&gt;Next;\n            Front = Front-&gt;Next;\n        } else {\n            *merged = Back;\n            merged = &amp;Back-&gt;Next;\n            Back = Back-&gt;Next;\n        }//Takes Greatest Frequency for Sorted List\n    }//If Sorting by Frequency\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7216953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54d7a2e04fe1e6bb8f461bd167c0396c?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin H", "link": "https://stackoverflow.com/users/7216953/dustin-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "accepted_answer_id": 45971703, "answer_count": 2, "score": 1, "last_activity_date": 1504141118, "creation_date": 1504133331, "last_edit_date": 1504134032, "question_id": 45970835, "link": "https://stackoverflow.com/questions/45970835/how-do-i-prevent-stack-overflow-when-using-merge-sort-on-large-amounts-of-data", "title": "How do I prevent stack overflow when using merge sort on large amounts of data?", "body": "<p>I have the following merge sort algorithm that works when I test with 100, 1000, or 10000 long linked lists. However, it returns a segmentation fault on the line containing <code>Node-&gt;Next=Merge(Front,Back-&gt;Next,Type);</code> when using 100000 or 1000000 long linked lists. This has lead me to believe it is a stack overflow rather than a segmentation fault. According to gdb at the time of the error the stack is extraordinarily full. I cannot find a way to examine exactly how many items are in the call stack to give an exact figure. Any help with reworking merge sort to handle large amounts of data would be greatly appreciated.</p>\n\n<pre><code>struct IntList\n{\nint Value;\nint Frequency;\nstruct IntList* Next;\nstruct IntList* Prev;\n};//Struct for Integer Linked List\nvoid SortList(struct IntList** Values,enum SortBy Type)\n{\n    struct IntList* Head = *Values;\n    if(Head==NULL||Head-&gt;Next==NULL)\n    {\n        return;\n    }//If Base Case\n    struct IntList* Front;\n    struct IntList* Back;\n    Split(Head,&amp;Front,&amp;Back);//Splits Linked List\n    SortList(&amp;Front,Type);\n    SortList(&amp;Back,Type);//Recursively Sorts\n    *Values=Merge(Front,Back,Type);//Merges Halves\n    return;\n}\n\nvoid Split(struct IntList* Head,struct IntList** Front,struct IntList** Back)\n{\n    struct IntList* Fast;\n    struct IntList* Slow;\n    if (Head==NULL||Head-&gt;Next==NULL)\n    {\n        *Front=Head;\n        *Back=NULL;\n    }//If Length &lt;2\n    else\n    {\n        Slow=Head;\n        Fast=Head-&gt;Next;\n    }\n    while(Fast!=NULL)\n    {\n        Fast=Fast-&gt;Next;\n        if(Fast!=NULL)\n        {\n            Fast=Fast-&gt;Next;\n            Slow=Slow-&gt;Next;\n        }\n    }//Find Midpoint\n    *Front=Head;\n    *Back=Slow-&gt;Next;\n    Slow-&gt;Next=NULL;//Breaks Link\n    return;\n}\n\n\nstruct IntList* Merge(struct IntList* Front,struct IntList* Back,enum SortBy Type)\n{\n    if(Front==NULL)\n    {\n        return Back;\n    }\n    if (Back==NULL)\n    {\n        return Front;\n    }//Base Cases\n\n    struct IntList* Node;\n    if(Type==DATA)\n    {\n        if(Front-&gt;Value &lt;= Back-&gt;Value)\n        {\n           Node=Front;\n           Node-&gt;Next=Merge(Front-&gt;Next,Back,Type);\n        }\n        else\n        {\n            Node=Back;\n            Node-&gt;Next=Merge(Front,Back-&gt;Next,Type);\n        }//Takes Greatest Value for Sorted List\n    }//If Sorting by Data\n    if(Type==FREQUENCY)\n    {\n        if(Front-&gt;Frequency &lt; Back-&gt;Frequency)\n        {\n           Node=Front;\n           Node-&gt;Next=Merge(Front-&gt;Next,Back,Type);\n        }\n        else\n        {\n            Node=Back;\n            Node-&gt;Next=Merge(Front,Back-&gt;Next,Type);\n        }//Takes Greatest Frequency for Sorted List\n    }//If Sorting by Frequency\n    return(Node);\n</code></pre>\n"}, {"tags": ["python", "c", "cython"], "comments": [{"owner": {"reputation": 38434, "user_id": 3657742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027d13e2b9077479fa7857166c272c16?s=128&d=identicon&r=PG&f=1", "display_name": "chrisb", "link": "https://stackoverflow.com/users/3657742/chrisb"}, "edited": false, "score": 0, "creation_date": 1504137099, "post_id": 45970563, "comment_id": 78901636, "body": "looks like you need a type annotation on <code>ret_val</code>?"}, {"owner": {"reputation": 35, "user_id": 1301866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037fe27e5eb9cd6259ba8cdfe0be159b?s=128&d=identicon&r=PG", "display_name": "rahvin74", "link": "https://stackoverflow.com/users/1301866/rahvin74"}, "reply_to_user": {"reputation": 38434, "user_id": 3657742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027d13e2b9077479fa7857166c272c16?s=128&d=identicon&r=PG&f=1", "display_name": "chrisb", "link": "https://stackoverflow.com/users/3657742/chrisb"}, "edited": false, "score": 0, "creation_date": 1504139883, "post_id": 45970563, "comment_id": 78902124, "body": "@chrisb, I wondered about that but I haven&#39;t been able to get it to work. Probably because I&#39;m not sure what it should look like. I&#39;ve tried         mod_one.PyRemoteDevice ret_val = mod_one.PyRemoteDevice()     with no luck. I&#39;m going to try it again though, just to make sure."}, {"owner": {"reputation": 35, "user_id": 1301866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037fe27e5eb9cd6259ba8cdfe0be159b?s=128&d=identicon&r=PG", "display_name": "rahvin74", "link": "https://stackoverflow.com/users/1301866/rahvin74"}, "reply_to_user": {"reputation": 38434, "user_id": 3657742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027d13e2b9077479fa7857166c272c16?s=128&d=identicon&r=PG&f=1", "display_name": "chrisb", "link": "https://stackoverflow.com/users/3657742/chrisb"}, "edited": false, "score": 0, "creation_date": 1504140674, "post_id": 45970563, "comment_id": 78902247, "body": "Ok, @chrisb, you are correct. As soon as I typed my last comment, I realized my mistake. I needed <code>cdef</code> in front of what I posted last, so it would be <code>cdef mod_one.PyRemoteDevice ret_val = mod_one.PyRemoteDevice()</code>. I feel a bit silly! If you make your comment into an answer, I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 38434, "user_id": 3657742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027d13e2b9077479fa7857166c272c16?s=128&d=identicon&r=PG&f=1", "display_name": "chrisb", "link": "https://stackoverflow.com/users/3657742/chrisb"}, "is_accepted": true, "score": 1, "last_activity_date": 1504140814, "creation_date": 1504140814, "answer_id": 45971671, "question_id": 45970563, "link": "https://stackoverflow.com/questions/45970563/cython-cannot-convert-pointer-to-python-object-after-module-split/45971671#45971671", "title": "Cython: Cannot Convert pointer to Python Object after module split", "body": "<p>Accessing c-level functions on extension types requires cython to know the exact type, otherwise it is treated as a generic Python object.  So a type annotation like this is needed</p>\n\n<pre><code>cdef mod_one.PyRemoteDevice ret_val = ...\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 1301866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037fe27e5eb9cd6259ba8cdfe0be159b?s=128&d=identicon&r=PG", "display_name": "rahvin74", "link": "https://stackoverflow.com/users/1301866/rahvin74"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 0, "accepted_answer_id": 45971671, "answer_count": 1, "score": 3, "last_activity_date": 1504140814, "creation_date": 1504131734, "question_id": 45970563, "link": "https://stackoverflow.com/questions/45970563/cython-cannot-convert-pointer-to-python-object-after-module-split", "title": "Cython: Cannot Convert pointer to Python Object after module split", "body": "<p><strong>The Problem:</strong></p>\n\n<pre><code>Error compiling Cython file:\n------------------------------------------------------------\n...\ncpdef Py_GetRemoteDevice(PyChannel Chan):\n    ret_val = mod_one.PyRemoteDevice()\n    cdef core.RemoteDevice  * tmp\n    with nogil:\n        tmp = core.GetRemoteDevice(Chan.__instance)\n    ret_val.__set_ptr(tmp)\n                        ^\n------------------------------------------------------------\n\ncore/mod_two.pyx:11589:25: Cannot convert 'RemoteDevice *' to Python object\n</code></pre>\n\n<p><strong>The Background:</strong>\nI have a fairly large C library I'm wrapping with Cython. Initially I \nhad everything in two files, core.pyx and core.pxd. However, the more\nof the library that was wrapped the larger the core.c file generated.\n2.5 million lines and counting. The compile time and memory usage became\ncumbersome.</p>\n\n<p>I decided to split things into multiple .pyx files. That's when things that used\nto work stopped working.</p>\n\n<p><strong>Disclaimer:</strong>\nPlease keep in mind that I've greatly simplified things for this question.\nThe wrapped library is somewhat large and proprietary.</p>\n\n<p><strong>The Details:</strong><br>\n<em>core.pxd</em> - contains all the necessary components from the C library<br>\nI'm wrapping. Also a simple Void * wrapper class declaration.</p>\n\n<pre><code>cdef class Void:\n    cdef void *__void\n    cdef __set_ptr(self, void *ptr)\n\ncdef extern from \"core.h\":\n    ctypedef unsigned char U8\n    ctypedef unsigned int U32\n\n    void OS_MemSet(U8 *dest, U8 byte, U32 len) nogil\n\ncdef extern from \"mod_one.h\":\n    cdef struct _RemoteDevice\n    ctypedef _RemoteDevice RemoteDevice\n\ncdef extern from \"mod_two.h\":\n    cdef struct _Channel\n    ctypedef _Channel Channel\n</code></pre>\n\n<p><em>core.pyx</em> - not a whole lot is needed here, really it's just the \nimplementation of the Void * wrapper.</p>\n\n<pre><code>cdef class Void:\n    cdef __set_ptr(self, void *ptr):\n        self.__void = ptr\n</code></pre>\n\n<p><em>mod_one.pxd</em> - declares the wrapper class for the RemoteDevice C struct</p>\n\n<pre><code>cimport core\n\ncdef class PyRemoteDevice:\n    cdef core.RemoteDevice *__instance\n    cdef __set_ptr(self, core.RemoteDevice *ptr)\n</code></pre>\n\n<p><em>mod_one.pyx</em> - defines the RemoteDevice wrapper class. Note the \n__set_ptr function, which is cdef'd and takes a RemoteDevice *</p>\n\n<pre><code>from cpython.mem cimport PyMem_Malloc, PyMem_Free\nimport core\ncimport core\n\ncdef class PyRemoteDevice:\n    def __cinit__(self):\n        self.__instance = &lt;core.RemoteDevice *&gt;PyMem_Malloc(sizeof(core.RemoteDevice))\n\n    def __init__(self):\n        core.OS_MemSet(&lt;core.U8 *&gt;self.__instance, &lt;core.U8&gt;0, sizeof(core.RemoteDevice))\n\n    cdef __set_ptr(self, core.RemoteDevice *ptr):\n        self.__instance = ptr\n\n    def __dealloc__(self):\n        if self.__instance is not NULL:\n            PyMem_Free(self.__instance)\n            self.__instance = NULL\n</code></pre>\n\n<p><em>mod_two.pxd</em> - declares the Channel wrapper class, which I'm only showing\nhere because it's used in the function that is causing me problems.</p>\n\n<pre><code>cimport core\ncimport mod_one\n\ncdef class PyChannel:\n    cdef core.Channel *__instance\n    cdef __set_ptr(self, core.Channel *ptr)\n</code></pre>\n\n<p><em>mod_two.pyx</em> - defines the Channel wrapper class, and declares the\nPy_GetRemoteDevice function, which wraps the GetRemoteDevice function \nfrom the C library.</p>\n\n<pre><code>from cpython.mem cimport PyMem_Malloc, PyMem_Free import core cimport core import mod_one cimport mod_one\n\ncdef class PyChannel:\n    def __cinit__(self):\n        self.__instance = &lt;core.Channel *&gt;PyMem_Malloc(sizeof(core.Channel))\n\n    def __init__(self):\n        core.OS_MemSet(&lt;core.U8 *&gt;self.__instance, &lt;core.U8&gt;0, sizeof(core.Channel))\n\n    cdef __set_ptr(self, core.Channel *ptr):\n        self.__instance = ptr\n\n    def __dealloc__(self):\n        if self.__instance is not NULL:\n            PyMem_Free(self.__instance)\n            self.__instance = NULL\n\ncpdef Py_GetRemoteDevice(PyChannel Chan):\n    ret_val = mod_one.PyRemoteDevice()\n    cdef core.RemoteDevice  * tmp\n    with nogil:\n        tmp = core.GetRemoteDevice(Chan.__instance)\n    ret_val.__set_ptr(tmp)\n    return ret_val\n</code></pre>\n\n<p>The problem I'm getting is that when Cythonizing mod_two, I get the \nfollowing error:</p>\n\n<pre><code>Error compiling Cython file:\n------------------------------------------------------------\n...\ncpdef Py_GetRemoteDevice(PyChannel Chan):\n    ret_val = mod_one.PyRemoteDevice()\n    cdef core.RemoteDevice  * tmp\n    with nogil:\n        tmp = core.GetRemoteDevice(Chan.__instance)\n    ret_val.__set_ptr(tmp)\n                        ^\n------------------------------------------------------------\n\ncore/mod_two.pyx:11589:25: Cannot convert 'RemoteDevice *' to Python object\n</code></pre>\n\n<p>I'm a bit confused, because this used to work when I had everything in one\nmodule. One difference I can see is that all my wrapper classes were wholly defined\nin core.pyx because I wasn't needing to share them between modules. Now\nI need to share them, so I've split them into .pyx and .pxd files.</p>\n\n<p>Can anyone point me in the right direction? I've scoured the Cython docs and Google\nbut so far I haven't found anything that answers my question.</p>\n\n<p>Thanks, and please let me know if any additional information is needed!</p>\n"}, {"tags": ["java", "c", "json", "weka", "json-c"], "comments": [{"owner": {"reputation": 730, "user_id": 1577605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa7cd2800abe8d984a243b6a644bbc8?s=128&d=identicon&r=PG", "display_name": "Roger Ng", "link": "https://stackoverflow.com/users/1577605/roger-ng"}, "edited": false, "score": 0, "creation_date": 1504152332, "post_id": 45970531, "comment_id": 78904866, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9998871/how-do-i-use-a-json-file-with-weka\">How do I use a JSON file with weka</a>"}, {"owner": {"reputation": 492, "user_id": 5712790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jvael.jpg?s=128&g=1", "display_name": "Haskell McRavin", "link": "https://stackoverflow.com/users/5712790/haskell-mcravin"}, "reply_to_user": {"reputation": 730, "user_id": 1577605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa7cd2800abe8d984a243b6a644bbc8?s=128&d=identicon&r=PG", "display_name": "Roger Ng", "link": "https://stackoverflow.com/users/1577605/roger-ng"}, "edited": false, "score": 0, "creation_date": 1504153942, "post_id": 45970531, "comment_id": 78905373, "body": "There&#39;s no nested data so I can see the way nested relations work on that question. That&#39;s the crux of my issue."}], "owner": {"reputation": 492, "user_id": 5712790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jvael.jpg?s=128&g=1", "display_name": "Haskell McRavin", "link": "https://stackoverflow.com/users/5712790/haskell-mcravin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504285781, "creation_date": 1504131600, "last_edit_date": 1504285781, "question_id": 45970531, "link": "https://stackoverflow.com/questions/45970531/multidimensional-json-c-file-convert-to-weka-arff", "title": "Multidimensional JSON-C file convert to WEKA ARFF", "body": "<p>Notice: I'm going to use direct string manipulation to get my data instead of JSON. I STILL WANT TO KNOW how to do this.</p>\n\n<p>I have very large datasets I'm currently trying to categorize, but the first step is getting my data into a format that I can process. </p>\n\n<p>I have an array of streams containing an array of XYZ data (an array) of variable length.\nI understand I will have to have a fixed length dataset (with sparse support for shorter datasets), and I will trim and '?' accordingly. This is ONE DATASET, NOT 21 datasets.</p>\n\n<p>The most raw form of my data is currently generating a JSON file in the format below.</p>\n\n<pre><code>{\n\"0\":\n    [[0.268869,-0.061725,1.466800],\n    [0.265376,-0.061317,1.453814],\n    [0.261664,-0.061190,1.439445],...1-n elements\n\n\"20\": [[0.268869,-0.061725,1.466800],...21 containers/training file\n    [0.265376,-0.061317,1.453814],\n    [0.261664,-0.061190,1.439445]\n</code></pre>\n\n<p>This is the general structure I would use for training data.</p>\n\n<pre><code>@relation streams\n\n@attribute 0 relational\n    @attribute f1 numeric\n    @attribute f2 numeric\n    @attribute f3 numeric\n@end 0\n@attribute 1 relational\n    @attribute f1 numeric\n    @attribute f2 numeric\n    @attribute f3 numeric\n@end 1\n@attribute 2 relational\n    @attribute f1 numeric\n    @attribute f2 numeric\n    @attribute f3 numeric\n@end 2... (we have 21 of these)\n\n@data\n\"0.268869,-0.061725,1.466800\\n0.265...\",\"0.268869,-0.0617...(sample 1)\n\"0.268869,-0.061725,1.466800\\n0.265...\",\"0.268869,-0.0617...(sample 2)\n\"0.268869,-0.061725,1.466800\\n0.265...\",\"0.268869,-0.0617...(sample 3)\n... (tons of data here)\n</code></pre>\n\n<p>The problem I'm having is that I can't export relational ARFF files into JSON so I can see the structure they would need. I'm building the data in C using JSON-C so using this library to just build the header would be cleaner (IMO) than raw string manipulation and more useful for most of my applications being that it will be in a widely supported format.</p>\n\n<p>Regarding the question <a href=\"https://stackoverflow.com/questions/9998871/how-do-i-use-a-json-file-with-weka\">How do I use a JSON file with weka</a>:\nNone of the WEKA arff files contain datasets that are multidimensional.  I've perused the arff files and converted a few over to see if I can pattern match but I'm not having much luck.</p>\n\n<p>What I did learn from those conversions is that to load the data into the WEKA GUI I need a header.\nHere is where I am now, with a very stripped down example that (understandably) fails to load.</p>\n\n<pre><code>{\n    \"header\" : {\n        \"relation\" : \"delta\"\n        \"attributes\" : [\n            {\n                \"name\": \"delta\",\n                \"type\": \"numeric\",(relational? how do I subclass here?)\n                \"class\": false,   (theres no documentation on the JSON type)\n                \"weight\" : 1.0,\n            }\n        ]\n    },\n    \"data\" : [\n        {\n            \"sparse\" : false,\n            \"weight\" : 1.0,\n            \"values\" : [\n                [\n                    [0.268869,-0.061725,1.466800],\n                    [0.265376,-0.061317,1.453814],\n                    [0.261664,-0.061190,1.439445],\n                    [0.258106,-0.061153,1.423623],\n                    [0.255281,-0.060748,1.406505],\n                    [0.253105,-0.059812,1.388318],\n                    [0.250796,-0.058583,1.369752],\n                    [0.248108,-0.057399,1.351671],\n                    [0.245563,-0.056328,1.334261],\n                    [0.243474,-0.055272,1.316677]\n                ],[\n                    [0.301861,-0.056221,1.282535],\n                    [0.302261,-0.055824,1.270375],\n                    [0.302599,-0.055763,1.256942],\n                    [0.303153,-0.055863,1.242172],\n                    [0.304334,-0.055614,1.226184],\n                    [0.305898,-0.054782,1.209144],\n                    [0.306914,-0.053585,1.191657],\n                    [0.307043,-0.052422,1.174524],\n                    [0.306837,-0.051428,1.157930],\n                    [0.306804,-0.050517,1.141103]\n                ],[\n                    [0.311746,-0.050597,0.997220],\n                    [0.316743,-0.050354,0.985238],\n                    [0.321871,-0.050400,0.972060],\n                    [0.327290,-0.050710,0.957635],\n                    [0.333158,-0.050946,0.942053],\n                    [0.339085,-0.050813,0.925458],\n                    [0.344214,-0.050331,0.908463],\n                    [0.348190,-0.049759,0.891851],\n                    [0.351326,-0.049144,0.875753],\n                    [0.354042,-0.048306,0.859365]\n                ]\n            ]\n        }\n    ]\n}\n</code></pre>\n"}, {"tags": ["c", "expression"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1504130869, "post_id": 45970363, "comment_id": 78900072, "body": "<code>++a</code> is  an expression with the <b>new</b> value of a."}, {"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1504130928, "post_id": 45970363, "comment_id": 78900082, "body": "@Schwifty Szechuan comment should be the answer, just saying."}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1504131072, "post_id": 45970363, "comment_id": 78900121, "body": "@savram Removed* it was actually incorrect :) (Also it wouldn&#39;t of answered the question, just pointing something out). <code>testArr[++a]</code> is equivalent to <code>testArr[(++a)]</code> and <code>testArr[a++]</code> is equivalent to <code>testArr[(a++)]</code>."}, {"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1504131081, "post_id": 45970363, "comment_id": 78900125, "body": "the precedence only matters if the two things apply to the same variable.  For example, in mathematics, parenthesis is higher precedence than addition but when you see (a+b) you still do the addition first.  So for ++a[i] you need to worry about precedence but for a[++i] you don&#39;t because the ++ has to be done first anyway."}, {"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "reply_to_user": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "edited": false, "score": 0, "creation_date": 1504131483, "post_id": 45970363, "comment_id": 78900241, "body": "@Schwifty Szechuan How was it incorrect? The ++ operator has higher precedence than the [] operator as you said. Not that it matters because it calculates what&#39;s inside the [] before doing the access regardless of the precedence, but still it points out that the OP&#39;s question is malformed"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 4, "creation_date": 1504131739, "post_id": 45970363, "comment_id": 78900329, "body": "You&#39;re confusing <i>precedence</i> with <i>order of evaluation</i>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1504131839, "post_id": 45970363, "comment_id": 78900365, "body": "An example where this precedence is relevant would be <code>++testArr[a]</code>  - the precedence means that this is <code>++(testArr[a])</code> and not <code>(++testArr)[a]</code>"}, {"owner": {"reputation": 2055, "user_id": 6564148, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3HL5.png?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/6564148/george"}, "reply_to_user": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1504131904, "post_id": 45970363, "comment_id": 78900384, "body": "@savram Only the suffix increment and decrement operators, and the function call operator have a higher precedence than the subscript operator. Easy to miss the difference at a glance of the <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">page</a> I linked."}, {"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1504132386, "post_id": 45970363, "comment_id": 78900512, "body": "I misread suffix/postfix for suffix/prefix lol you&#39;re right"}], "answers": [{"tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": false, "score": 1, "last_activity_date": 1504130855, "creation_date": 1504130855, "answer_id": 45970406, "question_id": 45970363, "link": "https://stackoverflow.com/questions/45970363/c-operators-precedence-array-subscript-and-prefix-increment/45970406#45970406", "title": "C operators precedence - array subscript and prefix increment", "body": "<p>When you write</p>\n\n<pre><code>testArr[++a]\n</code></pre>\n\n<p>C will look at the index in the array given by the value of the expression <code>++a</code>. Regardless of the operator precedence between <code>[]</code> and <code>++</code>, the value of the expression <code>++a</code> is one greater than the value <code>a</code> had before the expression was initially evaluated, which is why you're seeing the character at index 1 rather than the character at index 0.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1504132115, "post_id": 45970409, "comment_id": 78900438, "body": "Note that side-effects of the child expression aren&#39;t sequenced-before the parent expression or any other child expressions in this case"}, {"owner": {"reputation": 41, "user_id": 1866843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fffa3be90d5179fa7ae388694b51da1?s=128&d=identicon&r=PG", "display_name": "user1866843", "link": "https://stackoverflow.com/users/1866843/user1866843"}, "edited": false, "score": 0, "creation_date": 1504271552, "post_id": 45970409, "comment_id": 78962448, "body": "Thanks all for the answers.Vlad from Moscow answer I liked most."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 41, "user_id": 1866843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fffa3be90d5179fa7ae388694b51da1?s=128&d=identicon&r=PG", "display_name": "user1866843", "link": "https://stackoverflow.com/users/1866843/user1866843"}, "edited": false, "score": 0, "creation_date": 1504289624, "post_id": 45970409, "comment_id": 78972746, "body": "@user1866843  Then you should consider <a href=\"https://stackoverflow.com/help/accepted-answer\">accepting that answer</a>."}], "tags": [], "owner": {"reputation": 4658, "user_id": 2820379, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/2K57T.jpg?s=128&g=1", "display_name": "ben", "link": "https://stackoverflow.com/users/2820379/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1504130890, "creation_date": 1504130890, "answer_id": 45970409, "question_id": 45970363, "link": "https://stackoverflow.com/questions/45970363/c-operators-precedence-array-subscript-and-prefix-increment/45970409#45970409", "title": "C operators precedence - array subscript and prefix increment", "body": "<p>Expressions can consist of multiple operations and their operands. By using parenthesis one can define in which order these operations shall execute. Operator precedence defines the order of operations if there is no order defined already via parenthesis.</p>\n\n<p>In your case, <code>++a</code> is a <strong>child expression</strong> of the <code>[]</code> operand so no matter what you put inside <code>[]</code> it will be evaluated before evaluating the <code>[]</code> operand.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 4, "last_activity_date": 1504266141, "last_edit_date": 1504266141, "creation_date": 1504131262, "answer_id": 45970477, "question_id": 45970363, "link": "https://stackoverflow.com/questions/45970363/c-operators-precedence-array-subscript-and-prefix-increment/45970477#45970477", "title": "C operators precedence - array subscript and prefix increment", "body": "<p>The subscript operator is defined the following way</p>\n\n<pre><code>postfix-expression [ expression ]\n</code></pre>\n\n<p>So to apply the subscript operator the compiler shall calculate the expression in the square braces (along with the postfix expression) to get the value of the expression.</p>\n\n<p>From the C Standard (6.5.2.1 Array subscripting)</p>\n\n<blockquote>\n  <p>2 A postfix expression followed by an expression in square brackets []\n  is a subscripted designation of an element of an array object. <strong>The\n  definition of the subscript operator [] is that E1[E2] is identical to\n  (*((E1)+(E2)))</strong>. Because of the conversion rules that apply to the\n  binary + operator, if E1 is an array object (equivalently, a pointer\n  to the initial element of an array object) and E2 is an integer,\n  E1[E2] designates the E2-th element of E1 (counting from zero).</p>\n</blockquote>\n\n<p>To make it more clear consider a simple code snippet</p>\n\n<pre><code>int i = 0;\nint j = 1;\n\nprintf(\"element is %c\\n\",testArr[i + j]);\n</code></pre>\n\n<p>How the compiler can determine the index without calculation the expression <code>i + j</code>?</p>\n\n<p>That is the subscript operator is composed from two subexpressions that are evaluated to get their values.</p>\n\n<p>Your question is reasonable if to consider the following expression</p>\n\n<pre><code>++testArr[++a]\n</code></pre>\n\n<p>or even the following expression</p>\n\n<pre><code>++a[testArr]\n</code></pre>\n\n<p>In this case due to the operator precedence the first expression is  equivalent to</p>\n\n<pre><code>++( testArr[++a] )\n</code></pre>\n\n<p>and the second one is equivalent to</p>\n\n<pre><code>++( a[testArr] )\n</code></pre>\n\n<p>So the subscript operator including its subexpression in square braces <code>++a</code> or <code>testArr</code> evaluates first and after that the unary operator evaluates.</p>\n\n<p>On the other hand if to use the postfix increment like</p>\n\n<pre><code>a++[testArr]\n</code></pre>\n\n<p>then the expression is equivalent to</p>\n\n<pre><code>( a++[testArr] )\n</code></pre>\n\n<p>that is it is just the subscript operator that follows its own definition form</p>\n\n<pre><code>        a++        [  testArr   ]    \npostfix-expression [ expression ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 7717497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ryV7W.jpg?s=128&g=1", "display_name": "Halina V", "link": "https://stackoverflow.com/users/7717497/halina-v"}, "is_accepted": false, "score": 1, "last_activity_date": 1504152395, "creation_date": 1504152395, "answer_id": 45973074, "question_id": 45970363, "link": "https://stackoverflow.com/questions/45970363/c-operators-precedence-array-subscript-and-prefix-increment/45973074#45973074", "title": "C operators precedence - array subscript and prefix increment", "body": "<p>in plain english:\n[a++] - means [a+1] operation will be done after all other operations, \n[++a] - means [a+1] operation will be done before all other operations.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 1866843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fffa3be90d5179fa7ae388694b51da1?s=128&d=identicon&r=PG", "display_name": "user1866843", "link": "https://stackoverflow.com/users/1866843/user1866843"}, "is_accepted": false, "score": 0, "last_activity_date": 1504287716, "creation_date": 1504287716, "answer_id": 46005467, "question_id": 45970363, "link": "https://stackoverflow.com/questions/45970363/c-operators-precedence-array-subscript-and-prefix-increment/46005467#46005467", "title": "C operators precedence - array subscript and prefix increment", "body": "<p>So, from what Vlad posted, it seems that the compiler evaluates the expression:\ntestArr[++a] as *((testArr)+(++a))</p>\n\n<p>However, for multidimensional arrays, following program prints 2:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\nint a[3][3]={0,1,2,3,4,5,6,7,8};\nint index=0;\nprintf(\"element is %d\\n\",a[index++][++index]);\n}\n</code></pre>\n\n<p>If anyone can explain this, using C standard, would be even better.\nI have looked on C standard and is not mentioning anything about subscripting for multi-dimensional arrays.</p>\n"}], "owner": {"reputation": 41, "user_id": 1866843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fffa3be90d5179fa7ae388694b51da1?s=128&d=identicon&r=PG", "display_name": "user1866843", "link": "https://stackoverflow.com/users/1866843/user1866843"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 976, "favorite_count": 0, "accepted_answer_id": 45970477, "answer_count": 5, "score": 3, "last_activity_date": 1504290811, "creation_date": 1504130614, "last_edit_date": 1504290811, "question_id": 45970363, "link": "https://stackoverflow.com/questions/45970363/c-operators-precedence-array-subscript-and-prefix-increment", "title": "C operators precedence - array subscript and prefix increment", "body": "<p>Array subscript [] in C is listed as having higher precedence than prefix increment.</p>\n\n<p>Having following simple program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n   char testArr[] = \"asdfgh\";\n   int a = 0; \n   printf(\"element is %c\\n\",testArr[++a]);\n}\n</code></pre>\n\n<p>Why is s printed instead of a?\nThe way as I see things, [] should have been applied first.\nWhich means that the first element 0 of the testArr should have been displayed and not the element 1.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504120068, "post_id": 45968041, "comment_id": 78895113, "body": "I also tried with 100.0 instead of 100 but nothing..."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 6, "creation_date": 1504120098, "post_id": 45968041, "comment_id": 78895131, "body": "Read the warnings: <a href=\"http://coliru.stacked-crooked.com/a/2f51b696c1f63219\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/2f51b696c1f63219</a>"}, {"owner": {"reputation": 231, "user_id": 7404875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80971b1d5ed24a338b33e8761cf394e?s=128&d=identicon&r=PG&f=1", "display_name": "pmaxim98", "link": "https://stackoverflow.com/users/7404875/pmaxim98"}, "edited": false, "score": 2, "creation_date": 1504120215, "post_id": 45968041, "comment_id": 78895185, "body": "%lf (lowercase L) not %f"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 3, "creation_date": 1504120300, "post_id": 45968041, "comment_id": 78895235, "body": "@Pingu Please stop adding the C++ tag.  You say your are using C so there is no need for the C++ tag.  If you are actually using C++ then you should say so and remove the C tag."}, {"owner": {"reputation": 8201, "user_id": 3690024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2d5067f52318f0ed4db9eca0b2cda1?s=128&d=identicon&r=PG", "display_name": "AJNeufeld", "link": "https://stackoverflow.com/users/3690024/ajneufeld"}, "edited": false, "score": 1, "creation_date": 1504120334, "post_id": 45968041, "comment_id": 78895256, "body": "See <a href=\"https://stackoverflow.com/questions/210590/why-does-scanf-need-lf-for-doubles-when-printf-is-okay-with-just-f\">why scanf needs %lf for doubles</a>"}, {"owner": {"reputation": 2191, "user_id": 7070965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qEhQf.png?s=128&g=1", "display_name": "dtell", "link": "https://stackoverflow.com/users/7070965/dtell"}, "edited": false, "score": 0, "creation_date": 1504120418, "post_id": 45968041, "comment_id": 78895299, "body": "@tobi303 he is obviously using C and not C++ and should remove the C++ tag. To the question: Your compiler should give a warning that you use a wrong format specifier. Use <code>%lf</code> instead of <code>%f</code> and it should work."}, {"owner": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504120426, "post_id": 45968041, "comment_id": 78895301, "body": "Yes, I know this is not c++ and undersdtand the difference between those 2 languages."}, {"owner": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504120999, "post_id": 45968041, "comment_id": 78895604, "body": "I didn&#39;t know the stackflow community was so huge. Answers came instantly"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504120948, "post_id": 45968137, "comment_id": 78895572, "body": "Thank you, that solved my problem. I dont know why they didnt mentionned about the %lf neither for the %f in the guide book."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504127586, "post_id": 45968137, "comment_id": 78898815, "body": "@Pingu get a new book."}, {"owner": {"reputation": 1, "user_id": 4431172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a05df83f85c40efcf36e643be49f159?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Ke", "link": "https://stackoverflow.com/users/4431172/kevin-ke"}, "reply_to_user": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504215178, "post_id": 45968137, "comment_id": 78940964, "body": "@Pingu or you can Google it."}, {"owner": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504308719, "post_id": 45968137, "comment_id": 78979172, "body": "@KevinKe yea but how to google if you dont know the existence of %lf ...."}], "tags": [], "owner": {"reputation": 1, "user_id": 4431172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a05df83f85c40efcf36e643be49f159?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Ke", "link": "https://stackoverflow.com/users/4431172/kevin-ke"}, "is_accepted": false, "score": 0, "last_activity_date": 1504120424, "creation_date": 1504120424, "answer_id": 45968137, "question_id": 45968041, "link": "https://stackoverflow.com/questions/45968041/wrong-calculation-c-programming-beginner/45968137#45968137", "title": "Wrong Calculation ? C programming beginner", "body": "<p>You made a mistake in your scanf function.</p>\n\n<p>%f in a scanf function means your input will be put into a float variable.</p>\n\n<p>use a %lf instead.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n  double vx;\n  double vy;\n\n  printf(\"Enter the 1st number : \"); scanf(\"%lf\" , &amp;vx);\n  printf(\"Enter the 2nd number : \"); scanf(\"%lf\" , &amp;vy);\n\n  printf(\"\\a\\n\\nx is %f of y\" , vx / vy * 100);\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504121205, "post_id": 45968167, "comment_id": 78895712, "body": "Thank you, I didnt know the existence of %lf,"}, {"owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "reply_to_user": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504121371, "post_id": 45968167, "comment_id": 78895781, "body": "But there is a reason why you need <code>%lf</code> for <code>scanf</code>. You do not need it for <code>printf</code>. Read my answer."}, {"owner": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "edited": false, "score": 0, "creation_date": 1504121579, "post_id": 45968167, "comment_id": 78895907, "body": "Oh there is a page where they explain about  %lf but 5 pages after the question.... Thank you."}], "tags": [], "owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "is_accepted": true, "score": 1, "last_activity_date": 1504137213, "last_edit_date": 1504137213, "creation_date": 1504120538, "answer_id": 45968167, "question_id": 45968041, "link": "https://stackoverflow.com/questions/45968041/wrong-calculation-c-programming-beginner/45968167#45968167", "title": "Wrong Calculation ? C programming beginner", "body": "<p>Although <code>scanf</code> is a variadic function the input can not be promoted.<code>scanf</code> takes a pointer as an input, therefore you need to specify it will <code>%lf</code>. If the input was a variable, not a pointer, C would promote float to double.  In your program <code>scanf</code> function has <code>%f</code> instead of <code>%lf</code>. Below code works fine and the output is <code>64.285714</code> on MinGW.</p>\n\n<p>Also, refer to link <a href=\"https://stackoverflow.com/questions/4264127/correct-format-specifier-for-double-in-printf\">Correct format specifier for double in printf</a></p>\n\n<pre><code>int main(void)\n{\n  double vx;\n  double vy;\n\n  printf(\"Enter the 1st number : \"); scanf(\"%lf\" , &amp;vx);\n  printf(\"Enter the 2nd number : \"); scanf(\"%lf\" , &amp;vy);\n\n  printf(\"\\a\\n\\nx is %f of y\" , vx / vy * 100);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8539712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c621820ff8b25f77d8f37afa0c9b5c53?s=128&d=identicon&r=PG&f=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/8539712/pingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 0, "closed_date": 1504120703, "accepted_answer_id": 45968167, "answer_count": 2, "score": 0, "last_activity_date": 1504137213, "creation_date": 1504120008, "last_edit_date": 1504120304, "question_id": 45968041, "link": "https://stackoverflow.com/questions/45968041/wrong-calculation-c-programming-beginner", "closed_reason": "Duplicate", "title": "Wrong Calculation ? C programming beginner", "body": "<p>I'm learning c via a guide book and i am enjoying it.\nHowever, there is one question that i am stuck.</p>\n\n<p>The question is: </p>\n\n<p>\"Write a program that when writing number \"x\" and number \"y\", the program shows how much % of x is in y.\"</p>\n\n<p>\"The answer should be 64 % when x = 54 and y = 84\"</p>\n\n<p>Obviously, 54 / 84 = 0.64...  * 100, which is about 64 %.\nHowever, when I run my program it shows 84.689699.\nI tested without the \"*100\" but nothing. It shows 0.84689699...</p>\n\n<p>Is my program wrong or is it a problem of the compiler or something?\nI am a beginner and it would be very helpful if someone tells me what is wrong.</p>\n\n<p><strong>PS: I use atom.io and gcc-compiler</strong> </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n  double vx;\n  double vy;\n\n  printf(\"Enter the 1st number : \"); scanf(\"%f\" , &amp;vx);\n  printf(\"Enter the 2nd number : \"); scanf(\"%f\" , &amp;vy);\n\n  printf(\"\\a\\n\\nx is %f of y\" , vx / vy * 100);\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 4, "creation_date": 1504118377, "post_id": 45967551, "comment_id": 78894227, "body": "The first parameter to <code>sprintf()</code> should be a a <code>char*</code> pointer. Not a single character."}, {"owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 1, "creation_date": 1504118383, "post_id": 45967551, "comment_id": 78894232, "body": "Why are you using sprintf there? Don&#39;t you just want <code>plan[i][j] = x</code>? (or <code>x &amp; 255</code>)"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1504118525, "post_id": 45967551, "comment_id": 78894300, "body": "Fyi, your loops don&#39;t match your dimensions. the inner loop indexing 0..6 on a sequence that is only <code>[5]</code> will invoke <i>undefined behavior</i>, though I harbor a reasonable suspicion this isn&#39;t the <i>real</i> code."}, {"owner": {"reputation": 21, "user_id": 8539612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1487195451335455/picture?type=large", "display_name": "kathywyk", "link": "https://stackoverflow.com/users/8539612/kathywyk"}, "edited": false, "score": 0, "creation_date": 1504118548, "post_id": 45967551, "comment_id": 78894309, "body": "yes, i want plan [i][j] to save the value of x. but &#39;plan[i][j] = x&#39; is not working. cuz plan is char[][]? idk. If plan is int[][], its ok. I hvn&#39;t tried x%255."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504119344, "post_id": 45967551, "comment_id": 78894743, "body": "like <a href=\"https://ideone.com/pLYiMi\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 21, "user_id": 8539612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1487195451335455/picture?type=large", "display_name": "kathywyk", "link": "https://stackoverflow.com/users/8539612/kathywyk"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504119704, "post_id": 45967551, "comment_id": 78894938, "body": "@BLUEPIXY OMG Thanks so much!!!! Problem solved. Im a beginner in c n i hv to hand in my project after 2days. Thanks guys!!!!!"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8539612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1487195451335455/picture?type=large", "display_name": "kathywyk", "link": "https://stackoverflow.com/users/8539612/kathywyk"}, "edited": false, "score": 0, "creation_date": 1504120016, "post_id": 45967822, "comment_id": 78895099, "body": "thanks a lot. I decide to use a 3D array to store 2 digit number."}], "tags": [], "owner": {"reputation": 96, "user_id": 6281260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43d6b575f82a76bc2df75175cf5aa71?s=128&d=identicon&r=PG&f=1", "display_name": "Vikram Kumar", "link": "https://stackoverflow.com/users/6281260/vikram-kumar"}, "is_accepted": true, "score": 0, "last_activity_date": 1504120350, "last_edit_date": 1504120350, "creation_date": 1504119116, "answer_id": 45967822, "question_id": 45967551, "link": "https://stackoverflow.com/questions/45967551/how-to-create-a-grid-of-numbers-in-c/45967822#45967822", "title": "How to create a grid of numbers in C", "body": "<p>sprintf(char *str, const char *format, ...)..The first argument should be a pointer, but you are passing a character, which will give you error: invalid conversion from <code>char</code> to <code>char*</code>. Better you should use <code>&amp;plan[i][j]</code>..But it will store only one digit, to resolve this issue you may consider each element of the grid as a string.(I don't think it will be an appropriate way, But it will yield the desired output).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n    int main(){\n    int i, j, x;\n    char plan[5][6][3];\n\n    for (i=0; i&lt;5; i++)\n        for (j=0; j&lt;6; j++)\n            {\n                x = i*6+j+1;\n                sprintf(plan[i][j], \"%d\", x);\n            }\n\n\n\n    for (i=0; i&lt;5; i++)\n    {\n        for (j=0; j&lt;6; j++)\n            printf(\"%s \", plan[i][j]);\n        printf(\"\\n\")    ;\n    }\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 8539612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1487195451335455/picture?type=large", "display_name": "kathywyk", "link": "https://stackoverflow.com/users/8539612/kathywyk"}, "edited": false, "score": 0, "creation_date": 1504119345, "post_id": 45967837, "comment_id": 78894744, "body": "Yay exactly. How can i deal with it. Im crazy r8 now."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 21, "user_id": 8539612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1487195451335455/picture?type=large", "display_name": "kathywyk", "link": "https://stackoverflow.com/users/8539612/kathywyk"}, "edited": false, "score": 0, "creation_date": 1504119652, "post_id": 45967837, "comment_id": 78894910, "body": "One option would be to have a 2D array of <code>char *</code> so each location in the 2D array would lead to a string that could be large enough to hold the number you wish to put into it (plus the terminating character).   Another option could be to rethink your process and store them as <code>int</code> and use a value that is out of the range of expected values (for example a negative number) to denote an &#39;X&#39;"}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1504119157, "creation_date": 1504119157, "answer_id": 45967837, "question_id": 45967551, "link": "https://stackoverflow.com/questions/45967551/how-to-create-a-grid-of-numbers-in-c/45967837#45967837", "title": "How to create a grid of numbers in C", "body": "<p>For the question at hand, you need to get a pointer to the location you are trying to put the values.  Use <code>&amp;</code> to get the address:</p>\n\n<p><code>sprintf(&amp;plan[i][j], \"%d\", x);</code></p>\n\n<p>However once you do that, you will discover a new problem.  Your 2D array of chars will only store one character in each location.  In the case of double-digit numbers, this will be a problem.</p>\n"}, {"tags": [], "owner": {"reputation": 1101, "user_id": 7870957, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/jG6LK.jpg?s=128&g=1", "display_name": "Shivansh Jagga", "link": "https://stackoverflow.com/users/7870957/shivansh-jagga"}, "is_accepted": false, "score": 0, "last_activity_date": 1504820053, "creation_date": 1504820053, "answer_id": 46105429, "question_id": 45967551, "link": "https://stackoverflow.com/questions/45967551/how-to-create-a-grid-of-numbers-in-c/46105429#46105429", "title": "How to create a grid of numbers in C", "body": "<p>Ok this took a while :</p>\n\n<p>In your question, first big error of your code is this :\nIt should be <code>plan[5][6]</code> and not <code>plan[6][5]</code></p>\n\n<p>Instead of using a 3d array and utilizing more memory, a simple alternative would be to use the data type <code>string</code> as follows:</p>\n\n<pre><code>#include&lt;iostream&gt;\n#include &lt;stdio.h&gt;\n\nusing namespace std;\n\nint main(void)\n{\nint i, j, x;\nstring plan[5][6];\n\nx=1;//note that i increment this after every j loop is over\nfor (i=0; i&lt;5; i++){\n    for (j=0; j&lt;6; j++) {\n            char out[5];\n            sprintf(out,\"%d\",x);\n\n            plan[i][j].assign(out);\n            x+=1;//note that i increment this after every j loop is over\n        }\n}\n\nfor (i=0; i&lt;5; i++) {\n    for (j=0; j&lt;6; j++)\n        printf(\" %s \", plan[i][j].c_str());   \n    printf(\"\\n\")    ;\n}\n\n}\n</code></pre>\n\n<p>And for putting <code>x</code> as stated in your question, you can simply do. <code>plan[i][j].assign(\"x\")</code></p>\n"}], "owner": {"reputation": 21, "user_id": 8539612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1487195451335455/picture?type=large", "display_name": "kathywyk", "link": "https://stackoverflow.com/users/8539612/kathywyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 45967822, "answer_count": 3, "score": 1, "last_activity_date": 1504820053, "creation_date": 1504118075, "last_edit_date": 1592644375, "question_id": 45967551, "link": "https://stackoverflow.com/questions/45967551/how-to-create-a-grid-of-numbers-in-c", "title": "How to create a grid of numbers in C", "body": "<p>I want to create a grid of numbers from 1 to 30. And I can decide which number I would like to cross out by replacing it with an 'X'. But I can't even print out the grid in char[][].</p>\n<blockquote>\n<p>1 2 3 4 5 6</p>\n<p>7 8 9 X 11 12</p>\n<p>13 14 15 16 17 18</p>\n<p>19 20 21 22 23 24</p>\n<p>25 26 27 28 X 30</p>\n</blockquote>\n<p>the program gives me</p>\n<pre><code>123456\n678911\n111111\n111122\n222222\n</code></pre>\n<p>How do I solve this? Thanks!</p>\n<pre><code>int i, j, x;\nchar plan[6][5];\n\nfor (i=0; i&lt;5; i++)\n    for (j=0; j&lt;6; j++)\n        {\n            x = i*5+j+1;\n            sprintf(&amp;plan[i][j], &quot;%d&quot;, x);\n        }\n        \n    \n\nfor (i=0; i&lt;5; i++)\n{\n    for (j=0; j&lt;6; j++)\n        printf(&quot;%c&quot;, plan[i][j]);\n    printf(&quot;\\n&quot;)    ;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "language-lawyer"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1504115805, "post_id": 45966762, "comment_id": 78892783, "body": "Did you mean <code>(&amp;a + 1) == &amp;b)</code> and <code>(&amp;b + 1) == &amp;a)</code>?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1504116024, "post_id": 45966762, "comment_id": 78892918, "body": "@user2357112 That&#39;s correct.  The checks are to see if one element past the address of <code>a</code> is the same as the address of <code>b</code>, or if one element past the address of <code>b</code> is the same as the address of <code>a</code>.  The extra parenthesis in <code>((&amp;a)+1) == &amp;b</code> aren&#39;t strictly needed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504116755, "post_id": 45966762, "comment_id": 78893313, "body": "FWIW, my run produces <code>addr: a precedes b: 0 addr: b precedes a: 1</code> - a match.  (GNU C11 (GCC) version 5.4.0 (i686-pc-cygwin) \tcompiled by GNU C version 5.4.0, GMP version 6.1.0, MPFR version 3.1.4, MPC version 1.0.3).  IMO, your compiler is non-compliant."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504117039, "post_id": 45966762, "comment_id": 78893504, "body": "It would be interesting to see a binary dump of the values of <code>&amp;a, (&amp;b)+1</code>, not the <code>void*</code> converted values."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 1, "creation_date": 1504117137, "post_id": 45966762, "comment_id": 78893555, "body": "If I am reading the <a href=\"https://godbolt.org/g/chJKzo\" rel=\"nofollow noreferrer\">assembly for gcc 7.2 -O3</a> correctly, it seems that all the <code>&quot;something precedes something&quot;</code> instructions are all optimized away to <code>0</code> at compile time (lines 49 - 64 in the assembly)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504117482, "post_id": 45966762, "comment_id": 78893728, "body": "Suggest trying with the latest gcc <a href=\"https://gcc.gnu.org\" rel=\"nofollow noreferrer\">ref</a>.  Good luck!"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1504118521, "post_id": 45966762, "comment_id": 78894297, "body": "@Groo Interesting.  Does this suggest the check is UB?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1504119214, "post_id": 45966762, "comment_id": 78894674, "body": "I guess so, I can&#39;t say I read it from the standard. For example <a href=\"https://godbolt.org/g/2pC71E\" rel=\"nofollow noreferrer\">this simplified code for -O0</a> uses <code>lea rax, [rbp-8]</code>, <code>add rax, 4</code>, <code>lea rdx, [rbp-4]</code>, after which it seems like <code>rax</code> should be equal to <code>rdx</code>. However with <code>-O3</code> it simply optimized both checks away."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504122502, "post_id": 45966762, "comment_id": 78896335, "body": "@chux I found the same with gcc 5.4.0, although I still see that <code>0</code> is printed for all lines with optimization greater than 0."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 1, "creation_date": 1504122876, "post_id": 45966762, "comment_id": 78896512, "body": "FWIW: I changed the code to use arrays for <code>a</code> and <code>b</code>instead of of &quot;just&quot; <code>int</code>. In this way the code fulfil the bolded part of point 6 (i.e. &quot;one is a pointer to one past the end of one array object and the other is a pointer to the start of a different array object that happens to immediately follow the first array object in the address space&quot;). So the pointer <b>should</b> compare in one of the two cases. However, I also got the result that for <code>-O0</code> one compare as expected. For <code>-O1</code> (and higher) both fails to compare. I&#39;m not a language lawyer but this seems a compiler bug to me."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1504123751, "post_id": 45966762, "comment_id": 78896956, "body": "FWIW: I also tried clang 3.8.0 and it always had one match - regardless of otimization level"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1504123990, "post_id": 45966762, "comment_id": 78897079, "body": "As I read it &quot;Can an equality comparison of unrelated pointers evaluate to true?&quot; is certainly true for the case presented here.  Yet the &quot;Can an equality comparison of a pointer + 1 and its next higher adjacent pointer  evaluate to false?&quot; remains open.  This question is not so much of can <code>p+1 == q</code> (when p,q are sequential) as much as must it be true?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504124345, "post_id": 45966762, "comment_id": 78897282, "body": "@dbush BTW, thank-you for making <code>a</code> and <code>b</code> the same type.  Considering variant types opens up many more <a href=\"https://en.wikipedia.org/wiki/Rabbit_hole\" rel=\"nofollow noreferrer\">rabbit holes</a>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504124452, "post_id": 45966762, "comment_id": 78897344, "body": "@chux Clause 2 specifically disallows different types but allows different qualifiers, i.e. <code>const int *</code>, <code>int *</code>, <code>register int *</code>, etc."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504124613, "post_id": 45966762, "comment_id": 78897436, "body": "@chux I think the key phrase in addressing the question is <i>&quot;that happens to immediately follow the first array object in the address space&quot;</i> and what exactly this means."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1504128479, "post_id": 45966762, "comment_id": 78899212, "body": "I do read the outcome <b>false</b> as a compiler bug in GCC, no matter how hard I read..."}, {"owner": {"reputation": 122530, "user_id": 2756719, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b06a9c91425630fdb69e861abe483d7e?s=128&d=identicon&r=PG&f=1", "display_name": "T.C.", "link": "https://stackoverflow.com/users/2756719/t-c"}, "edited": false, "score": 2, "creation_date": 1504128550, "post_id": 45966762, "comment_id": 78899229, "body": "See the extended discussion in <a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=61502\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla/show_bug.cgi?id=61502</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504129437, "post_id": 45966762, "comment_id": 78899559, "body": "@dbush <code>a</code> and <code>b</code> are not assigned.  Does assigning them and using their values change the results?  <code>a=1; b = 2; .... return a + b;</code>?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504129540, "post_id": 45966762, "comment_id": 78899603, "body": "@chux I tried initializing them and printing the values, but no change."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1504130834, "post_id": 45966762, "comment_id": 78900065, "body": "This is duplicate of <a href=\"https://stackoverflow.com/questions/36035782/why-does-the-compiler-assume-that-these-seemingly-equal-pointers-differ/\" title=\"why does the compiler assume that these seemingly equal pointers differ\">stackoverflow.com/questions/36035782/&hellip;</a>  (related: <a href=\"https://stackoverflow.com/questions/40809553/\">stackoverflow.com/questions/40809553</a>)  - I&#39;ll close as dupe unless you still have questions not covered by that thread?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1504137004, "post_id": 45966762, "comment_id": 78901624, "body": "@M.M I don&#39;t think it qualifies as a dup.  That question seems to be primarily discussing objects in different translation units and focuses on conversion to <code>uintptr_t</code>, while this one is regarding objects in the same translation unit.  The answers there also don&#39;t reference the gcc bugzilla tickets discussing the issue."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1615846262, "post_id": 45966762, "comment_id": 117814075, "body": "BTW, in both clang and gcc, comparisons involving adjacent objects may not only yield inconsistent results, but may also cause operations which are conditionally executed to yield results whose behavior isn&#39;t even consistent with that of each individual comparison arbitrarily yielding true or false."}], "answers": [{"comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 4, "creation_date": 1504119306, "post_id": 45967792, "comment_id": 78894719, "body": "But what about point 6. in OP&#39;s question (6.5.9)? I.e. one is a pointer to <b>one past the end of one array object</b> and the other is a pointer to the <b>start of a different array object</b> that happens to immediately follow the first array object in the address space. Combined with point 7., it seems like it matches this situation."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 2, "creation_date": 1504121441, "post_id": 45967792, "comment_id": 78895826, "body": "@groo when defining <code>int a; int b;</code> nothing can be assumed about memory location of these two variables..."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1504121479, "post_id": 45967792, "comment_id": 78895850, "body": "@4386427 Part 2 of section 6.5.9 states that the two pointers must be &quot;pointers to qualified or unqualified versions of compatible types&quot;.  A pointer to an <code>int</code> and a pointer to a <code>float</code> are not compatible, however exceptions are made for <code>void *</code> and <code>NULL</code>."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1504121575, "post_id": 45967792, "comment_id": 78895905, "body": "@4386427 I suppose he would have mean &quot;of the same type&quot;."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1504162652, "post_id": 45967792, "comment_id": 78908767, "body": "@Jean-BaptisteYun&#232;s: the question is whether it&#39;s defined behavior to compare them. In this case, they are next to each other, as you can see from their dumped addresses, so it&#39;s compiler which is <i>assuming</i> they aren&#39;t."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1504163211, "post_id": 45967792, "comment_id": 78909070, "body": "@Groo Yes it is defined in this special case, misread the full question. His compiler behave strangely."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557287151, "post_id": 45967792, "comment_id": 98709394, "body": "The first snippet contains unspecified behaviour (<code>0 1</code>, <code>1 0</code> and <code>0 0</code> are all permitted). Also this doesn&#39;t answer the question, and the results may tell you something about how the objects are placed in memory (a <code>1</code> would indicate that one object immediately follows the other)."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 15, "last_activity_date": 1506346272, "last_edit_date": 1506346272, "creation_date": 1504119043, "answer_id": 45967792, "question_id": 45966762, "link": "https://stackoverflow.com/questions/45966762/can-an-equality-comparison-of-unrelated-pointers-evaluate-to-true/45967792#45967792", "title": "Can an equality comparison of unrelated pointers evaluate to true?", "body": "<pre><code>int a;\nint b;\nprintf(\"a precedes b: %d\\n\", (&amp;a + 1) == &amp;b);\nprintf(\"b precedes a: %d\\n\", (&amp;b + 1) == &amp;a);\n</code></pre>\n\n<p>is perfectly well-defined code, but probably more by luck than by judgement.</p>\n\n<p>You are allowed to take the address of a scalar and set a pointer one past that address. So <code>&amp;a + 1</code> is valid, but <code>&amp;a + 2</code> is not. You are also allowed to compare the value of a pointer of the same type with the value of any other valid pointer using <code>==</code> and <code>!=</code>, although pointer arithmetic is only valid within arrays.</p>\n\n<p>Your assertion that the address of <code>a</code> and <code>b</code> tells you about anything about how these are placed in memory is bunk. To be clear, you cannot \"reach\" <code>b</code> by pointer arithmetic on the address of <code>a</code>.</p>\n\n<p>As for</p>\n\n<pre><code>struct s {\n    int a;\n    int b;\n};\n</code></pre>\n\n<p>The standard guarantees that the address of the <code>struct</code> is the same as the address of <code>a</code>, but an arbitrary amount of padding is allowed to be inserted between <code>a</code> and <code>b</code>. Again, you can't reach the address of <code>b</code> by any pointer arithmetic on the address of <code>a</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1504131099, "post_id": 45970352, "comment_id": 78900129, "body": "This has been discussed a lot in the past, but gcc deliberately fails to comply with C11 because they deem that compliance in this case would pessimize the code (and I agree); it has been proposed for C2X that this changes to be unspecified"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1504131232, "post_id": 45970352, "comment_id": 78900168, "body": "@M.M Interesting part about gcc failing to comply.  Any reference?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1504131629, "post_id": 45970352, "comment_id": 78900281, "body": "Not offhand, no"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1506091320, "post_id": 45970352, "comment_id": 79694315, "body": "I think the Standard would allow an implementation to behave as though unrelated objects are sometimes adjacent and sometimes not, if a pointer just past the end of one object has a different representation from a pointer to the start of an adjacent object in memory.  On any commonplace hardware, however, the cost of ensuring the pointer representations are distinct would almost certainly exceed any optimization benefit achievable from such license."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 8, "last_activity_date": 1504131123, "last_edit_date": 1504131123, "creation_date": 1504130524, "answer_id": 45970352, "question_id": 45966762, "link": "https://stackoverflow.com/questions/45966762/can-an-equality-comparison-of-unrelated-pointers-evaluate-to-true/45970352#45970352", "title": "Can an equality comparison of unrelated pointers evaluate to true?", "body": "<blockquote>\n  <p>Can an equality comparison of unrelated pointers evaluate to true?</p>\n</blockquote>\n\n<p>Yes.  C specifies when this is true.</p>\n\n<blockquote>\n  <p>Two pointers compare equal if and only if ... or one is a pointer to one past the end of one array object and the other is a pointer to the start of a different array object that happens to immediately follow the first array object in the address space.  C11dr \u00a76.5.9 6</p>\n</blockquote>\n\n<p>To be clear: adjacent variables in code do not need to be adjacent in memory, yet can be.</p>\n\n<hr>\n\n<p>The below code demonstrates that it is <em>possible</em>.  It uses a memory dump of a <code>int*</code> in addition to the conventional <code>\"%p\"</code> and <code>(void*)</code>.</p>\n\n<p>Yet OP's code and output not reflect this.  Given the \"compare equal if and only if\" part of the above spec, IMO, <strong>OP's compilation is non-compliant</strong>.  Adjacent <em>in memory</em> variables <code>p,q</code> , of the same type, either <code>&amp;p+1 == &amp;q</code> or <code>&amp;p == &amp;q+1</code> must be true.</p>\n\n<p>No opinion if the objects differ in type - OP does not ask that IAC.</p>\n\n<hr>\n\n<pre><code>void print_int_ptr(const char *prefix, int *p) {\n  printf(\"%s %p\", prefix, (void *) p);\n  union {\n    int *ip;\n    unsigned char uc[sizeof (int*)];\n  } u = {p};\n  for (size_t i=0; i&lt; sizeof u; i++) {\n    printf(\" %02X\", u.uc[i]);\n  }\n  printf(\"\\n\");\n}\n\nint main(void) {\n  int b = rand();\n  int a = rand();\n  printf(\"sizeof(int) = %zu\\n\", sizeof a);\n  print_int_ptr(\"&amp;a     =\", &amp;a);\n  print_int_ptr(\"&amp;a + 1 =\", &amp;a + 1);\n  print_int_ptr(\"&amp;b     =\", &amp;b);\n  print_int_ptr(\"&amp;b + 1 =\", &amp;b + 1);\n  printf(\"&amp;a + 1 == &amp;b: %d\\n\", &amp;a + 1 == &amp;b);\n  printf(\"&amp;a == &amp;b + 1: %d\\n\", &amp;a == &amp;b + 1);\n  return a + b;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>sizeof(int) = 4\n&amp;a     = 0x28cc28 28 CC 28 00\n&amp;a + 1 = 0x28cc2c 2C CC 28 00  &lt;-- same bit pattern\n&amp;b     = 0x28cc2c 2C CC 28 00  &lt;-- same bit pattern\n&amp;b + 1 = 0x28cc30 30 CC 28 00\n&amp;a + 1 == &amp;b: 1                &lt;-- compare equal\n&amp;a == &amp;b + 1: 0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1504141930, "post_id": 45970808, "comment_id": 78902513, "body": "Interesting that <code>a+1 == b</code> may be true, yet <code>a+1 &gt;= b</code> is UB per my reading  of &#167;6.5.9 6 and &#167;6.5.8 5."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1504169050, "post_id": 45970808, "comment_id": 78912688, "body": "@Keith: &quot;maintainers who responded to these bug reports seem to be of the opinion that adjacency of two objects <i>need not be consistent</i>&quot; - if true, I would find this as yet another reason for the compiler <i>not</i> to optimize the expression away. In this case, compiler is acting like the adjacency is consistently false. Even the standard describes it as an &quot;object that <i>happens</i> to immediately follow the first array&quot;, so it&#39;s completely unrelated to the fact whether it really follows it or not."}, {"owner": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1506004090, "post_id": 45970808, "comment_id": 79653328, "body": "IMHO the standard committee brought just enough rope to hang themselves: paragraph 7 introduces this as-if rule (the same with operator <code>+</code>) but in paragraph 6 they explicitly restrict validity of the one-past-the-end rule to array objects - a wording that under the impression of paragraph 7 now should instead read &quot;is a pointer to the next valid alignment past an object&quot;. Does gcc behave the same if you use <code>int x[1]; int y[1];</code>  and <code>&amp;y[0] == &amp;x[0] + 1</code>?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1506034615, "post_id": 45970808, "comment_id": 79668652, "body": "There are many situations where it is useful to guarantee that applying the equality operator to pointers will yield an equivalence relation.  There are also some situations, however, where useful optimizations might be performed if there were a standard way to waive that guarantee with regard to comparisons involving a pointer to an object and a past-one pointer of a different, unrelated, object.  The proper way to way to facilitate such optimizations would be to add a means of waiving the guarantee when it isn&#39;t needed."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 1, "creation_date": 1506035485, "post_id": 45970808, "comment_id": 79668892, "body": "@Vroomfondel: The Standard clearly specifies that if <code>p</code> and <code>q</code> both point <i>at</i> different objects, they will compare unequal; likewise, if both point <i>just past</i> different objects.  The only defined situation where unrelated pointers would be <i>allowed</i> to compare equal is when one points <i>at</i> an object and the other points <i>just past</i> an unrelated object.  If the Standard didn&#39;t allow that, compilers would be essentially required to add padding after every object.  The only question is whether a comparison between two particular pointers might sometimes report them equal and sometimes not."}, {"owner": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1506067685, "post_id": 45970808, "comment_id": 79679311, "body": "@supercat um, no, the padding wouldn&#39;t be necessary as it could simply be defined as UB. IIRC the one-past-the-end rule was originally only defined for array objects, so a pointer past a non-array object was UB in previous standards. That made reasoning about comparison of non-array object pointers which do not point to objects, unnecessary in the first place. I can&#39;t come up with a convincing example but there must be one, otherwise the committee wouldn&#39;t have included the new wording. The unlucky thing is that they didn&#39;t adapt the wording in p.6 which I think is the reason for the gcc bug."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1506092382, "post_id": 45970808, "comment_id": 79694980, "body": "@Vroomfondel: Both the ability to process things of arbitrary type as sequences of character values, and the ability to create &quot;just-past&quot; pointers without UB have been essential features of the language since its inception, and nothing in any published rationale I&#39;ve seen even hinted at a desire to remove such features.  If <code>sizeof q</code> is 8, then code must be able to evaluate <code>((unsigned char*)&amp;q)+8</code> without UB, regardless of the type of <code>q</code>."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1506093698, "post_id": 45970808, "comment_id": 79695753, "body": "@Vroomfondel: If an implementation is not going to regard two pointers as being &quot;consistently&quot; equal, it must ensure that their representations will never be observed to be equal.  If an implementation stored pointers as a base address plus offset, that would naturally imply that a pointer just past the end of declared object <code>o</code> would have a different representation from a pointer to the start of an adjacent object (or any part of any object other than <code>o</code>, for that matter) even if such pointers were allowed to compare as equal."}, {"owner": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1506094568, "post_id": 45970808, "comment_id": 79696315, "body": "@supercat was the wording of paragraph 7 really in C90? I think we are talking past each other. All I&#39;m saying is that this gcc bug could be explained by misreading p.6 &amp; 7 due to the unclear formulation in 6, talking about array objects. p.7 says pointers <i>to</i> valid objects are like pointers <i>to</i> array objects. The nitpicking that is necessary in the standard sometimes, can lend to the conclusion that the one-past-rule of p.6 does <i>not</i> apply iff the object is <i>not</i> an array object notwithstanding the exception from p.7."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1506095595, "post_id": 45970808, "comment_id": 79696873, "body": "@Vroomfondel: C was in wide use long before the publication of C89, and the authors of C89 explicitly stated that they wanted to avoid breaking existing code.  They were far more interested in mandating behavior in cases where compilers might behave differently in the absence of a mandate, than in cases where all compilers had always behaved the same and they saw no reason to believe future compilers might do otherwise.  If it would be essentially impossible for a compiler to yield Standard-mandated behavior in some cases without yielding useful behaviors in others..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1506095927, "post_id": 45970808, "comment_id": 79697081, "body": "...waste ink ordering compiler writers to yield the latter useful behaviors, since compiler writers would do so with or without such a mandate.  Nothing in any published rationale I&#39;ve seen suggests that such omissions were supposed to be taken as invitations for &quot;clever&quot; compilers to figure out how to yield the Standard-mandated behaviors without also yielding other useful behaviors other code might rely upon.  To the contrary, the authors explicitly recognize that it would be possible to make an implementation that is simultaneously conforming but useless."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1506097417, "post_id": 45970808, "comment_id": 79697913, "body": "@supercat: Yes, yes, we know. You really should start a blog so you can just link to it rather than rewriting the same points again and again and again."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1506117150, "post_id": 45970808, "comment_id": 79706930, "body": "@KeithThompson: I was responding to Vroomfondel, who seemed to think that the ability to use the just-past rule for non-array objects wasn&#39;t part of the language prior to C99.  If just about every twentieth-century compiler treated it the same way, that would suggest to me it should have been viewed as part of the language whether or not the authors of the Standard saw fit to mention it explicitly."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 28, "last_activity_date": 1506510458, "last_edit_date": 1506510458, "creation_date": 1504133122, "answer_id": 45970808, "question_id": 45966762, "link": "https://stackoverflow.com/questions/45966762/can-an-equality-comparison-of-unrelated-pointers-evaluate-to-true/45970808#45970808", "title": "Can an equality comparison of unrelated pointers evaluate to true?", "body": "<blockquote>\n  <p>Can an equality comparison of unrelated pointers evaluate to true?</p>\n</blockquote>\n\n<p>Yes, <strong>but ...</strong></p>\n\n<pre><code>int a;\nint b;\nprintf(\"a precedes b: %d\\n\", (&amp;a + 1) == &amp;b);\nprintf(\"b precedes a: %d\\n\", (&amp;b + 1) == &amp;a);\n</code></pre>\n\n<p>There are, by my interpretation of the C standard, three possibilities:</p>\n\n<ul>\n<li>a immediately precedes b</li>\n<li>b immediately precedes a</li>\n<li>neither a nor b immediately precedes the other (there could be a gap, or another object, between them)</li>\n</ul>\n\n<p>I played around with this some time ago and concluded that GCC was performing an invalid optimization on the <code>==</code> operator for pointers, making it yield false even when the addresses are the same, so I submitted a bug report:</p>\n\n<p><a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63611\" rel=\"noreferrer\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63611</a></p>\n\n<p>That bug was closed as a duplicate of another report:</p>\n\n<p><a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=61502\" rel=\"noreferrer\">https://gcc.gnu.org/bugzilla/show_bug.cgi?id=61502</a></p>\n\n<p>The GCC maintainers who responded to these bug reports seem to be of the opinion that adjacency of two objects need not be consistent and that the comparison of their addresses might show them to be adjacent or not, within the same run of the program.  As you can see from my comments on the second Bugzilla ticket, I strongly disagree.  In my opinion, without consistent behavior of the <code>==</code> operator, the standard's requirements for adjacent objects is meaningless, and I think we have to assume that those words are not merely decorative.</p>\n\n<p>Here's a simple test program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n    int x;\n    int y;\n    printf(\"&amp;x = %p\\n&amp;y = %p\\n\", (void*)&amp;x, (void*)&amp;y);\n    if (&amp;y == &amp;x + 1) {\n        puts(\"y immediately follows x\");\n    }\n    else if (&amp;x == &amp;y + 1) {\n        puts(\"x immediately follows y\");\n    }\n    else {\n        puts(\"x and y are not adjacent\");\n    }\n}\n</code></pre>\n\n<p>When I compile it with GCC 6.2.0, the printed addresses of <code>x</code> and <code>y</code> differ by exactly 4 bytes at all optimization levels, but I get <code>y immediately follows x</code> only at <code>-O0</code>; at <code>-O1</code>, <code>-O2</code>, and <code>-O3</code> I get <code>x and y are not adjacent</code>. I believe this is incorrect behavior, but apparently, it's not going to be fixed.</p>\n\n<p>clang 3.8.1, in my opinion, behaves correctly, showing <code>x immediately follows y</code> at all optimization levels. Clang previously had a problem with this; I reported it:</p>\n\n<p><a href=\"https://bugs.llvm.org/show_bug.cgi?id=21327\" rel=\"noreferrer\">https://bugs.llvm.org/show_bug.cgi?id=21327</a></p>\n\n<p>and it was corrected.</p>\n\n<p>I suggest not relying on comparisons of addresses of possibly adjacent objects behaving consistently.</p>\n\n<p>(Note that relational operators (<code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>) on pointers to unrelated objects have undefined behavior, but equality operators (<code>==</code>, <code>!=</code>) are generally required to behave consistently.)</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 5, "last_activity_date": 1506348562, "last_edit_date": 1506348562, "creation_date": 1506036487, "answer_id": 46354659, "question_id": 45966762, "link": "https://stackoverflow.com/questions/45966762/can-an-equality-comparison-of-unrelated-pointers-evaluate-to-true/46354659#46354659", "title": "Can an equality comparison of unrelated pointers evaluate to true?", "body": "<p>The authors of the Standard weren't trying to make it \"language-lawyer-proof\", and as a consequence, it is somewhat ambiguous.  Such ambiguity will not generally be a problem when compiler writers make a bona fide effort to uphold the Principle of Least Astonishment, since there is a clear non-astonishing behavior, and any other behavior would have astonishing consequences.  On the other hand, it does mean those compiler writers who are more interested in whether optimizations can be justified under any reading of the Standard than in whether they will be compatible with existing code can find interesting opportunities to justify incompatibility.</p>\n\n<p>The Standard doesn't require that pointers' representations bear any relationship to the underlying physical architecture.  It would be perfectly legitimate for a system to represent each pointer as a combination of a handle and an offset.  A system which represented pointers in such fashion would be free to move the objects represented thereby around in physical storage as it saw fit.  On such a system, the first byte of object #57 might follow immediately after the last byte of object #23 at one moment in time, but might be at some completely unrelated location at some other moment.  I see nothing in the Standard that would prohibit such an implementation from reporting a \"just past\" pointer for object #23 as equal to a pointer to object #57 when the two objects happened to be adjacent, and as unequal when they happened not to be.</p>\n\n<p>Further, under the as-if rule, an implementation that would be justified in moving objects around in such fashion and having a quirky equality operator, as a result, would be allowed to have a quirky equality operator whether or not it physically moved objects around in storage.</p>\n\n<p>If, however, an implementation specifies how pointers are stored in RAM, and such definition would be inconsistent with the behavior described above, however, that would compel the implementation to implement the equality operator in a fashion consistent with that specification.  Any compiler that wants to have a quirky equality operator must refrain from specifying a pointer-storage format that would be inconsistent with such behavior.</p>\n\n<p>Further, the Standard would seem to imply that if code observes that if two pointers with defined values have identical representation, they must compare equal.  Reading an object using a character type and then writing that same sequence of character-type values into another object should yield an object equivalent to the original; such equivalence is a fundamental feature of the language.  If <code>p</code> is a pointer \"just past\" one object, and <code>q</code> is a pointer to another object, and their representations are copied to <code>p2</code> and <code>q2</code>, respectively, then <code>p1</code> must compare equal to <code>p</code> and <code>q2</code> to <code>q</code>.  If the decomposed character-type representations of <code>p</code> and <code>q</code> are equal, that would imply that <code>q2</code> was written with the same sequence of character-type values as <code>p1</code>, which would, in turn, imply that all four pointers must be equal.</p>\n\n<p>Consequently, while it would be allowable for a compiler to have quirky equality semantics for pointers which are never exposed to code that might observe their byte-level representation, such behavioral license would not extend to pointers which are thus exposed.  If an implementation defines a directive or setting that invites compilers to have individual comparisons arbitrarily report equal or unequal when given pointers to the end of one object and the start of another whose placement would only be observable via such comparison, the implementation wouldn't have to worry about conformance in cases where pointer representations are observed.  Otherwise, though, even in if there are cases where conforming implementations would be allowed to have quirky comparison semantics, that doesn't mean any quality implementations should do so unless invited unless a pointer just past the end of one object would naturally have a different representation from a pointer to the start of the next.</p>\n"}], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2036, "favorite_count": 10, "accepted_answer_id": 45970808, "answer_count": 4, "score": 43, "last_activity_date": 1506510458, "creation_date": 1504115171, "last_edit_date": 1504190348, "question_id": 45966762, "link": "https://stackoverflow.com/questions/45966762/can-an-equality-comparison-of-unrelated-pointers-evaluate-to-true", "title": "Can an equality comparison of unrelated pointers evaluate to true?", "body": "<p>Section 6.5.9 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"noreferrer\">C standard</a> regarding the <code>==</code> and <code>!=</code> operators states the following:</p>\n\n<blockquote>\n  <p><em>2</em> One of the following shall hold:</p>\n  \n  <ul>\n  <li>both operands have arithmetic type;</li>\n  <li><strong>both operands are pointers to qualified or unqualified versions of compatible types;</strong></li>\n  <li>one operand is a pointer to an object type and the other is a pointer to a qualified or unqualified version of void; or</li>\n  <li>one operand is a pointer and the other is a null pointer constant.</li>\n  </ul>\n  \n  <p>... </p>\n  \n  <p><em>6</em> <strong>Two pointers compare equal if and only if</strong> both are null pointers,\n  both are pointers to the same object (including a pointer to an object\n  and a subobject at its beginning) or function, both are pointers to\n  one past the last element of the same array object, or <strong>one is a\n  pointer to one past the end of one array object and the other is a\n  pointer to the start of a different array object that happens to\n  immediately follow the first array object in the address space.</strong><sup>109)</sup></p>\n  \n  <p><em>7</em> For the purposes of these operators, <strong>a pointer to an object that is\n  not an element of an array behaves the same as a pointer to the first\n  element of an array of length one with the type of the object as its\n  element type.</strong></p>\n</blockquote>\n\n<p>Footnote 109:</p>\n\n<blockquote>\n  <p>109) <strong>Two objects may be adjacent in memory</strong> because they are adjacent\n  elements of a larger array or adjacent members of a structure with no\n  padding between them, or <strong>because the implementation chose to place\n  them so, even though they are unrelated</strong>. If prior invalid pointer\n  operations (such as accesses outside array bounds) produced undefined\n  behavior, subsequent comparisons also produce undefined behavior.</p>\n</blockquote>\n\n<p>This would seem to indicate you could do the following:</p>\n\n<pre><code>int a;\nint b;\nprintf(\"a precedes b: %d\\n\", (&amp;a + 1) == &amp;b);\nprintf(\"b precedes a: %d\\n\", (&amp;b + 1) == &amp;a);\n</code></pre>\n\n<p>This should be legal since we are using an address one element past the end of an array (which in this case is a single object treated as an array of size 1) without dereferencing it.  More importantly, one of these two statements would be required to output <code>1</code> if one variable immediately followed the other in memory.</p>\n\n<p>However, testing didn't seem to pan this out.  Given the following test program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct s {\n    int a;\n    int b;\n};\n\nint main()\n{\n    int a;\n    int b;\n    int *x = &amp;a;\n    int *y = &amp;b;\n\n    printf(\"sizeof(int)=%zu\\n\", sizeof(int));\n    printf(\"&amp;a=%p\\n\", (void *)&amp;a);\n    printf(\"&amp;b=%p\\n\", (void *)&amp;b);\n    printf(\"x=%p\\n\", (void *)x);\n    printf(\"y=%p\\n\", (void *)y);\n\n    printf(\"addr: a precedes b: %d\\n\", ((&amp;a)+1) == &amp;b);\n    printf(\"addr: b precedes a: %d\\n\", &amp;a == ((&amp;b)+1));\n    printf(\"pntr: a precedes b: %d\\n\", (x+1) == y);\n    printf(\"pntr: b precedes a: %d\\n\", x == (y+1));\n\n    printf(\"  x=%p,   &amp;a=%p\\n\", (void *)(x), (void *)(&amp;a));\n    printf(\"y+1=%p, &amp;b+1=%p\\n\", (void *)(y+1), (void *)(&amp;b+1));\n\n    struct s s1;\n    x=&amp;s1.a;\n    y=&amp;s1.b;\n    printf(\"addr: s.a precedes s.b: %d\\n\", ((&amp;s1.a)+1) == &amp;s1.b);\n    printf(\"pntr: s.a precedes s.b: %d\\n\", (x+1) == y);\n    return 0;\n}\n</code></pre>\n\n<p>Compiler is gcc 4.8.5, system is CentOS 7.2 x64.</p>\n\n<p>With <code>-O0</code>, I get the following output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>sizeof(int)=4\n&amp;a=0x7ffe9498183c\n&amp;b=0x7ffe94981838\nx=0x7ffe9498183c\ny=0x7ffe94981838\naddr: a precedes b: 0\naddr: b precedes a: 0\npntr: a precedes b: 0\npntr: b precedes a: 1\n  x=0x7ffe9498183c,   &amp;a=0x7ffe9498183c\ny+1=0x7ffe9498183c, &amp;b+1=0x7ffe9498183c\naddr: s.a precedes s.b: 1\n</code></pre>\n\n<p>We can see here that an <code>int</code> is 4 bytes and that the address of <code>a</code> is 4 bytes past the address of <code>b</code>, and that <code>x</code> holds the address of <code>a</code> while <code>y</code> holds the address of <code>b</code>.  However the comparison <code>&amp;a == ((&amp;b)+1)</code> evaluates to false while the comparison <code>(x+1) == y</code> evaluates to true.  I would expect both to be true as the addresses being compared appear identical.</p>\n\n<p>With <code>-O1</code>, I get this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>sizeof(int)=4\n&amp;a=0x7ffca96e30ec\n&amp;b=0x7ffca96e30e8\nx=0x7ffca96e30ec\ny=0x7ffca96e30e8\naddr: a precedes b: 0\naddr: b precedes a: 0\npntr: a precedes b: 0\npntr: b precedes a: 0\n  x=0x7ffca96e30ec,   &amp;a=0x7ffca96e30ec\ny+1=0x7ffca96e30ec, &amp;b+1=0x7ffca96e30ec\naddr: s.a precedes s.b: 1\npntr: s.a precedes s.b: 1\n</code></pre>\n\n<p>Now both comparisons evaluate to false even though (as before) the address being compared appear to be the same.</p>\n\n<p>This seems to point to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a>, but based on how I read the above passage it seems this should be allowed.</p>\n\n<p>Note also that the comparison of the addresses of adjacent objects of the same type in a <code>struct</code> prints the expected result in all cases.</p>\n\n<p>Am I misreading something here regarding what is allowed (meaning this is UB), or is this version of gcc non-conforming in this case?</p>\n"}, {"tags": ["c", "matlab", "casting"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1504115000, "post_id": 45966436, "comment_id": 78892329, "body": "How do you know that it doesn&#39;t happen in the transmitting end?"}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 2, "creation_date": 1504115118, "post_id": 45966436, "comment_id": 78892375, "body": "Show us your MATLAB code that uses the library please."}, {"owner": {"reputation": 22012, "user_id": 194586, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/1a71658d81f8a82a8122050f21bb86d3?s=128&d=identicon&r=PG", "display_name": "Nick T", "link": "https://stackoverflow.com/users/194586/nick-t"}, "edited": false, "score": 0, "creation_date": 1504115466, "post_id": 45966436, "comment_id": 78892573, "body": "If you &quot;cast&quot; <code>int8 -1</code> into a <code>uint8</code>, does MATLAB do it like C and give you 255 or does it do some strange truncation?"}, {"owner": {"reputation": 19, "user_id": 8539374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae7cccd130ea00742beb09f07faa76e3?s=128&d=identicon&r=PG&f=1", "display_name": "G Stephens", "link": "https://stackoverflow.com/users/8539374/g-stephens"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1504116813, "post_id": 45966436, "comment_id": 78893350, "body": "@4386427 I have access to the transmitting side bytes as well - so I can inspect them to know what I&#39;m sending across the UDP socket"}, {"owner": {"reputation": 19, "user_id": 8539374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae7cccd130ea00742beb09f07faa76e3?s=128&d=identicon&r=PG&f=1", "display_name": "G Stephens", "link": "https://stackoverflow.com/users/8539374/g-stephens"}, "reply_to_user": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1504116899, "post_id": 45966436, "comment_id": 78893418, "body": "@AndreKampling I am on a different box currently with no access to that code piece. I will attempt to transfer it later"}, {"owner": {"reputation": 19, "user_id": 8539374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae7cccd130ea00742beb09f07faa76e3?s=128&d=identicon&r=PG&f=1", "display_name": "G Stephens", "link": "https://stackoverflow.com/users/8539374/g-stephens"}, "reply_to_user": {"reputation": 22012, "user_id": 194586, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/1a71658d81f8a82a8122050f21bb86d3?s=128&d=identicon&r=PG", "display_name": "Nick T", "link": "https://stackoverflow.com/users/194586/nick-t"}, "edited": false, "score": 0, "creation_date": 1504117050, "post_id": 45966436, "comment_id": 78893510, "body": "@NickT Every instance of casting I have done in MATLAB has given the expected return value - for instance, if I say four bytes should be a uint32, ex. newVar = typecast(int8(data(1:4)),&#39;uint32&#39;) it concatenates them correctly (assuming all of those bytes are in the range 0-127)."}, {"owner": {"reputation": 22012, "user_id": 194586, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/1a71658d81f8a82a8122050f21bb86d3?s=128&d=identicon&r=PG", "display_name": "Nick T", "link": "https://stackoverflow.com/users/194586/nick-t"}, "edited": false, "score": 0, "creation_date": 1504118521, "post_id": 45966436, "comment_id": 78894298, "body": "Can you look at the data right from the library before you do anything? That would at least isolate the problem to your code or the library (or how it&#39;s config&#39;d)"}], "answers": [{"comments": [{"owner": {"reputation": 1302, "user_id": 2254698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uXRZ3.jpg?s=128&g=1", "display_name": "informaton", "link": "https://stackoverflow.com/users/2254698/informaton"}, "edited": false, "score": 0, "creation_date": 1504133699, "post_id": 45970219, "comment_id": 78900866, "body": "I&#39;m glad you found a fix.  I&#39;ll remove my answer then."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1504163578, "post_id": 45970219, "comment_id": 78909271, "body": "Adding code in your question (not working) and here in your answer (working) would help other people that might have this problem too. Also think of <a href=\"https://meta.stackexchange.com/q/5234/179419\">accepting this answer</a> to show a wider community that the problem is solved."}], "tags": [], "owner": {"reputation": 19, "user_id": 8539374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae7cccd130ea00742beb09f07faa76e3?s=128&d=identicon&r=PG&f=1", "display_name": "G Stephens", "link": "https://stackoverflow.com/users/8539374/g-stephens"}, "is_accepted": true, "score": 1, "last_activity_date": 1504188756, "last_edit_date": 1504188756, "creation_date": 1504129790, "answer_id": 45970219, "question_id": 45966436, "link": "https://stackoverflow.com/questions/45966436/c-code-truncating-to-7-bits-max-value/45970219#45970219", "title": "C code truncating to 7 bits max value", "body": "<p>I figured out what was happening here. It turns out that if you are receiving values greater than 127 into MATLAB using UDP sockets (Java/MATLAB UDP implementation force-casts int8's) and don't specify the type of data you are expecting to receive, MATLAB will assume some non-descript error character. If you further try to typecast that error character, it will clamp to the highest value possible for that type.</p>\n\n<p>In my case because I was getting some data back correctly I did not realize that I wasn't correctly instructing MATLAB to receive as uint8's. Thus, it was receiving correctly for 0-127, but giving me the error character for 128-255. I then tried typecasting that error character into multiple types and found that for each cast it was displaying as the max value for that specific type. </p>\n\n<p>The fix only required me to add a 'uint8' option to my socket receive call.</p>\n\n<p>Fixed code:</p>\n\n<pre><code>data = pnet('read',number of bytes,'uint8','noblock')\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8539374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae7cccd130ea00742beb09f07faa76e3?s=128&d=identicon&r=PG&f=1", "display_name": "G Stephens", "link": "https://stackoverflow.com/users/8539374/g-stephens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 45970219, "answer_count": 1, "score": 0, "last_activity_date": 1504188756, "creation_date": 1504114037, "last_edit_date": 1504188659, "question_id": 45966436, "link": "https://stackoverflow.com/questions/45966436/c-code-truncating-to-7-bits-max-value", "title": "C code truncating to 7 bits max value", "body": "<p>I have some code that I am trying to use for network communications to pull information from c++ to MATLAB. I am using the pnet program (mex file from c) from the Mathworks open exchange: <a href=\"https://www.mathworks.com/matlabcentral/fileexchange/345-tcp-udp-ip-toolbox-2-0-6?s_tid=answers_rc2-2_p5_MLT\" rel=\"nofollow noreferrer\">https://www.mathworks.com/matlabcentral/fileexchange/345-tcp-udp-ip-toolbox-2-0-6?s_tid=answers_rc2-2_p5_MLT</a></p>\n\n<p>On my receive end I am expecting to receive int8's, which I then typecast as uint8's. As such, for each received byte I would expect 0-255 as the value.</p>\n\n<p>I noticed some discrepancies where I was receiving lots of 127s on my receive end, and found out by doing some basic debugging that for every value I send from 128-255, my receive code (immediately after the pnet receive call) is displaying 127.</p>\n\n<p>Thus, I believe something may be buggy in the pnet.c file causing the values to truncate to the 7-bit max value rather than displaying the full <code>uint8</code> range.</p>\n\n<p>Any ideas as to why this might be happening? I am primarily a matlab user and don't spend much time in data typecasting, so I feel a little out of my depth here.</p>\n\n<p>Receive code that returns bad/funny error character:</p>\n\n<pre><code>data = pnet('read',number of bytes to read,'noblock')\n</code></pre>\n"}, {"tags": ["c", "multithreading", "mpi", "fftw"], "comments": [{"owner": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 0, "creation_date": 1504114702, "post_id": 45966027, "comment_id": 78892184, "body": "How many (real - not hyperthreading) CPU cores do you actually have?"}, {"owner": {"reputation": 11, "user_id": 6788684, "user_type": "registered", "profile_image": "https://graph.facebook.com/774852782657687/picture?type=large", "display_name": "Latish Pavan", "link": "https://stackoverflow.com/users/6788684/latish-pavan"}, "reply_to_user": {"reputation": 52445, "user_id": 1253222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a62746fb04e19c1656cd1df560911f?s=128&d=identicon&r=PG", "display_name": "twalberg", "link": "https://stackoverflow.com/users/1253222/twalberg"}, "edited": false, "score": 0, "creation_date": 1504114793, "post_id": 45966027, "comment_id": 78892234, "body": "@twalberg it&#39;s four."}, {"owner": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "edited": false, "score": 2, "creation_date": 1504121437, "post_id": 45966027, "comment_id": 78895822, "body": "How long does a single thread run takes compared to 4? Have you tried running just 2 threads? The speed up vs. thread number will become a slow down for too many threads because of threading-associated overheads."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1504139341, "post_id": 45966027, "comment_id": 78902038, "body": "which MPI library and which OpenMP runtime (or compiler) are you using ?"}, {"owner": {"reputation": 11, "user_id": 6788684, "user_type": "registered", "profile_image": "https://graph.facebook.com/774852782657687/picture?type=large", "display_name": "Latish Pavan", "link": "https://stackoverflow.com/users/6788684/latish-pavan"}, "reply_to_user": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "edited": false, "score": 0, "creation_date": 1504160627, "post_id": 45966027, "comment_id": 78907744, "body": "@atru single thread program is taking 0.71s and 4 threaded program is taking 0.92s and I have tried running it with 2 threads it is also taking 0.71s same as single threaded."}, {"owner": {"reputation": 3203, "user_id": 2763915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b53d3b3f8b36383de69ab29d9633251?s=128&d=identicon&r=PG&f=1", "display_name": "atru", "link": "https://stackoverflow.com/users/2763915/atru"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1504199524, "post_id": 45966027, "comment_id": 78933666, "body": "That doesn&#39;t sound good - did you try @GillesGouaillardet solution? Especially the timing for steps 1-4."}], "answers": [{"tags": [], "owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "is_accepted": false, "score": 0, "last_activity_date": 1504139308, "creation_date": 1504139308, "answer_id": 45971525, "question_id": 45966027, "link": "https://stackoverflow.com/questions/45966027/increase-of-execution-time-while-using-multithreaded-fftw/45971525#45971525", "title": "Increase of execution time while using multithreaded FFTW", "body": "<p>That kind of behavior is typical of incorrect binding.</p>\n\n<p>Generally speaking, OpenMP threads should all be bound to cores of the same socket in order to avoid NUMA effect (which can make performance suboptimal or even worst).</p>\n\n<p>Also, make sure MPI tasks are correctly bound (one task should be bound to several cores from the same sockets, and you should use one OpenMP thread per core).</p>\n\n<p>Because of MPI, there is a risk your OpenMP threads end up doing time sharing. </p>\n\n<p>At first, i recommend you start printing both MPI and OpenMP binding.</p>\n\n<p>How to achieve that is dependent on both MPI library and OpenMP runtime. If you use Open MPI and Intel compilers, you can <code>KMP_AFFINITY=verbose mpirun --report-bindings --tag-output ...</code></p>\n\n<p>Then, as suggested earlier, i recommend you start easy and increase complexity</p>\n\n<ol>\n<li>1 MPI task and 1 OpenMP thread</li>\n<li>1 MPI task and x OpenMP threads (x is the number of cores on one socket)</li>\n<li>x MPI tasks and 1 OpenMP thread per task</li>\n<li>x MPI tasks and y OpenMP threads per task</li>\n</ol>\n\n<p>hopefully, 2. will be faster than 1. and 4 will be faster than 3.</p>\n"}], "owner": {"reputation": 11, "user_id": 6788684, "user_type": "registered", "profile_image": "https://graph.facebook.com/774852782657687/picture?type=large", "display_name": "Latish Pavan", "link": "https://stackoverflow.com/users/6788684/latish-pavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 513, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1504139308, "creation_date": 1504112506, "question_id": 45966027, "link": "https://stackoverflow.com/questions/45966027/increase-of-execution-time-while-using-multithreaded-fftw", "title": "Increase of execution time while using multithreaded FFTW", "body": "<p>I am new to FFTW library. I have successfully implemented 1D and 2D fft using FFTW library. I converted my 2D fft code into multithreaded 2D fft. But the results were completely opposite. Multithreaded 2D FFT code is taking longer time to run than serialized 2D FFT code. I am missing something somewhere. I followed all the instructions given in <a href=\"http://www.fftw.org/fftw3_doc/Usage-of-Multi_002dthreaded-FFTW.html#Usage-of-Multi_002dthreaded-FFTW\" rel=\"nofollow noreferrer\">FFTW documentation</a> to parallelize the code.</p>\n\n<p>This is my parallelized 2D FFT C program</p>\n\n<pre><code>#include &lt;mpi.h&gt;\n#include &lt;fftw3.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n\n#define N 2000\n#define M 2000\n#define index(i, j) (j + i*M)\n\nint i, j;\n\nvoid get_input(fftw_complex *in) {\n    for(i=0;i&lt;N;i++){\n        for(j=0;j&lt;M;j++){\n            in[index(i, j)][0] = sin(i + j); \n            in[index(i, j)][1] = sin(i * j);\n        }\n    }\n}\n\nvoid show_out(fftw_complex *out){\n    for(i=0;i&lt;N;i++){\n        for(j=0;j&lt;M;j++){\n            printf(\"%lf %lf \\n\", out[index(i, j)][0], out[index(i, j)][1]);\n        }\n    }\n}\n\nint main(){\n    clock_t start, end;\n    double time_taken;\n    start = clock();\n\n    int a = fftw_init_threads();\n    printf(\"%d\\n\", a);\n    fftw_complex *in, *out;\n    fftw_plan p;\n\n    in = (fftw_complex *)fftw_malloc(N * M * sizeof(fftw_complex));\n    out = (fftw_complex *)fftw_malloc(N * M * sizeof(fftw_complex));\n    get_input(in);\n\n    fftw_plan_with_nthreads(4);\n    p = fftw_plan_dft_2d(N, M, in, out, FFTW_FORWARD, FFTW_ESTIMATE);\n\n    fftw_execute(p);\n\n    /*p = fftw_plan_dft_1d(N, out, out, FFTW_BACKWARD, FFTW_ESTIMATE);\n    fftw_execute(p);\n    puts(\"In Real Domain\");\n    show_out(out);*/\n\n    fftw_destroy_plan(p);\n\n    fftw_free(in);\n    fftw_free(out);\n    fftw_cleanup_threads();\n\n    end = clock();\n    time_taken = ((double) (end - start)) / CLOCKS_PER_SEC;\n    printf(\"%g \\n\", time_taken);\n\n    return 0;\n}\n</code></pre>\n\n<p>Can someone please help me in pointing out the mistake what I am doing?</p>\n"}, {"tags": ["c", "arrays", "char", "int", "spaces"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1504110216, "post_id": 45965413, "comment_id": 78889678, "body": "When you enter the value for <code>x</code> you end with a newline. That newline will not be read by <code>scanf</code> and left in the input buffer. Then you call <code>scanf</code> to read characters until the next newline..."}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 1, "creation_date": 1504110282, "post_id": 45965413, "comment_id": 78889713, "body": "Change <code>scanf(&quot;%[^\\n]s&quot;,&amp;name);</code> to <code>scanf(&quot;%[^\\n]s&quot;,name);</code>. The address operator doesn&#39;t make sense with an array."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1504110288, "post_id": 45965413, "comment_id": 78889717, "body": "The question is tagged C++, but the code shown in C instead. The C++ equivalent would be to use <code>std::cin</code> and <code>std::cout</code> instead of <code>scanf()</code> and <code>printf()</code>."}, {"owner": {"reputation": 11, "user_id": 8539031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4488772c73af51b7aeb557611ebe6e19?s=128&d=identicon&r=PG&f=1", "display_name": "Abadprogrammer", "link": "https://stackoverflow.com/users/8539031/abadprogrammer"}, "reply_to_user": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 0, "creation_date": 1504110509, "post_id": 45965413, "comment_id": 78889865, "body": "@user0042 what good would it do to solve my problem ?"}, {"owner": {"reputation": 11, "user_id": 8539031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4488772c73af51b7aeb557611ebe6e19?s=128&d=identicon&r=PG&f=1", "display_name": "Abadprogrammer", "link": "https://stackoverflow.com/users/8539031/abadprogrammer"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1504110532, "post_id": 45965413, "comment_id": 78889881, "body": "my bad @RemyLebeau"}, {"owner": {"reputation": 7698, "user_id": 8242698, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/BjJXu.jpg?s=128&g=1", "display_name": "user0042", "link": "https://stackoverflow.com/users/8242698/user0042"}, "edited": false, "score": 2, "creation_date": 1504110583, "post_id": 45965413, "comment_id": 78889913, "body": "@Abadprogrammer It would save you from seeing results of undefined behavior."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504110928, "post_id": 45965413, "comment_id": 78890128, "body": "<code>scanf(&quot;%lld&quot;,&amp;x);</code> --&gt; <code>scanf(&quot;%llu&quot;, &amp;x);while(getchar()!=&#39;\\n&#39;);</code>, <code>scanf(&quot;%[^\\n]s&quot;,&amp;name);</code> --&gt; <code>scanf(&quot;%19[^\\n]&quot;, name);</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504111143, "post_id": 45965413, "comment_id": 78890247, "body": "@BLUEPIXY No need for the loop, just prepend the next format string with a space."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1504111225, "post_id": 45965413, "comment_id": 78890285, "body": "@Someprogrammerdude <i>a name &quot;with spaces&quot;</i> The name beginning with space is questionable. :D"}, {"owner": {"reputation": 11, "user_id": 8539031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4488772c73af51b7aeb557611ebe6e19?s=128&d=identicon&r=PG&f=1", "display_name": "Abadprogrammer", "link": "https://stackoverflow.com/users/8539031/abadprogrammer"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504111565, "post_id": 45965413, "comment_id": 78890454, "body": "so , should I clear the Input buffer before entering the name ? @Someprogrammerdude"}, {"owner": {"reputation": 11, "user_id": 8539031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4488772c73af51b7aeb557611ebe6e19?s=128&d=identicon&r=PG&f=1", "display_name": "Abadprogrammer", "link": "https://stackoverflow.com/users/8539031/abadprogrammer"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504111700, "post_id": 45965413, "comment_id": 78890517, "body": "I meant like first name and a last name as in &quot;some programmer dude&quot; @Someprogrammerdude"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1504111851, "post_id": 45965413, "comment_id": 78890606, "body": "So try <code>scanf(&quot; %19[^\\n]&quot;, name);</code> instead of <code>scanf(&quot;%[^\\n]s&quot;,&amp;name);</code> (However, &quot;some programmer dude&quot; is too long. :-)"}, {"owner": {"reputation": 11, "user_id": 8539031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4488772c73af51b7aeb557611ebe6e19?s=128&d=identicon&r=PG&f=1", "display_name": "Abadprogrammer", "link": "https://stackoverflow.com/users/8539031/abadprogrammer"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504112459, "post_id": 45965413, "comment_id": 78890907, "body": "It was a pun :( @BLUEPIXY"}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1504110841, "post_id": 45965508, "comment_id": 78890075, "body": "&#39;fflush(stdin)&#39; - UB."}, {"owner": {"reputation": 96, "user_id": 6281260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43d6b575f82a76bc2df75175cf5aa71?s=128&d=identicon&r=PG&f=1", "display_name": "Vikram Kumar", "link": "https://stackoverflow.com/users/6281260/vikram-kumar"}, "edited": false, "score": 0, "creation_date": 1504111369, "post_id": 45965508, "comment_id": 78890359, "body": "thanks for this one. I don&#39;t have so much experience in c, in starting days of learning C when i faced same problem and after searching for solutions, i got this one, so i suggested this one."}, {"owner": {"reputation": 11, "user_id": 8539031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4488772c73af51b7aeb557611ebe6e19?s=128&d=identicon&r=PG&f=1", "display_name": "Abadprogrammer", "link": "https://stackoverflow.com/users/8539031/abadprogrammer"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504112944, "post_id": 45965508, "comment_id": 78891175, "body": "I didn&#39;t get the point of undefined behaviour and it&#39;s reference to fflush ? @Martin James"}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1504113328, "post_id": 45965508, "comment_id": 78891382, "body": "You cannot legally call fflush on stdin - it invokes undefined behavior."}], "tags": [], "owner": {"reputation": 96, "user_id": 6281260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43d6b575f82a76bc2df75175cf5aa71?s=128&d=identicon&r=PG&f=1", "display_name": "Vikram Kumar", "link": "https://stackoverflow.com/users/6281260/vikram-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1504110497, "creation_date": 1504110497, "answer_id": 45965508, "question_id": 45965413, "link": "https://stackoverflow.com/questions/45965413/code-error-not-able-to-insert-characters/45965508#45965508", "title": "code error Not able to insert characters", "body": "<p>After entering the value of x, <code>scanf</code> reads the newline from the input buffer.\nYou may use <code>fflush(stdin)</code> after reading the value of x, to clear input buffer.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8509705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zPkIg.jpg?s=128&g=1", "display_name": "Siddhartha Pramanik", "link": "https://stackoverflow.com/users/8509705/siddhartha-pramanik"}, "is_accepted": false, "score": 0, "last_activity_date": 1504116620, "creation_date": 1504116620, "answer_id": 45967117, "question_id": 45965413, "link": "https://stackoverflow.com/questions/45965413/code-error-not-able-to-insert-characters/45967117#45967117", "title": "code error Not able to insert characters", "body": "<p>The reason it is not reading your input for the string is that it is taking the newline character as an input when you press <code>return/enter</code> after entering the <code>int</code> value. A simple work around is to put a space in the <code>scanf</code> specifier for the string.</p>\n\n<p><code>scanf(\" %[^\\n]\", name);</code></p>\n\n<p>This will work fine.</p>\n"}], "owner": {"reputation": 11, "user_id": 8539031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4488772c73af51b7aeb557611ebe6e19?s=128&d=identicon&r=PG&f=1", "display_name": "Abadprogrammer", "link": "https://stackoverflow.com/users/8539031/abadprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504116620, "creation_date": 1504110123, "last_edit_date": 1504110399, "question_id": 45965413, "link": "https://stackoverflow.com/questions/45965413/code-error-not-able-to-insert-characters", "title": "code error Not able to insert characters", "body": "<p>This piece of code saves a 12 digit number. And a name \"with spaces\" but whenever I run the code it takes the <code>int</code> input but skips the name part. What am I doing wrong?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint main(){\n\n    char name[20];\n    unsigned long long int x;\n    printf(\"enter x:\\n\");\n    scanf(\"%lld\",&amp;x);\n    printf(\"enter name\\n\");\n    scanf(\"%[^\\n]s\",&amp;name);\n    printf(\"name = %s\",name);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "doxygen", "anonymous-struct"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1504109966, "post_id": 45965296, "comment_id": 78889509, "body": "why do you have to use the macro? it doesn&#39;t make for very readable code"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4720322, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/03fe7766e94a48e8867764122b802ef4?s=128&d=identicon&r=PG&f=1", "display_name": "Ofri Rips", "link": "https://stackoverflow.com/users/4720322/ofri-rips"}, "edited": false, "score": 1, "creation_date": 1504110927, "post_id": 45965401, "comment_id": 78890127, "body": "OK so this was set to YES already, but I did look at that link, and adding &quot;BASIC_VAR(var1)=&quot; to PREDEFINED tag solved the problem! For some reason, setting EXPAND_ONLY_PREDEF tag to NO didn&#39;t. Anyway, Thanks!"}], "tags": [], "owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "is_accepted": false, "score": 2, "last_activity_date": 1553595141, "last_edit_date": 1553595141, "creation_date": 1504110083, "answer_id": 45965401, "question_id": 45965296, "link": "https://stackoverflow.com/questions/45965296/doxygen-warning-when-using-a-macro-inside-an-anonymous-struct/45965401#45965401", "title": "Doxygen warning when using a macro inside an anonymous struct", "body": "<p>I believe you need to set <code>MACRO_EXPANSION</code> to <code>YES</code> in the Doxyfile so that Doxygen will expand your macro. See <a href=\"http://www.doxygen.nl/manual/preprocessing.html\" rel=\"nofollow noreferrer\">http://www.doxygen.nl/manual/preprocessing.html</a></p>\n\n<p>Additionally, you may need to add your macro to the PREDEFINED tag.</p>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 4720322, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/03fe7766e94a48e8867764122b802ef4?s=128&d=identicon&r=PG&f=1", "display_name": "Ofri Rips", "link": "https://stackoverflow.com/users/4720322/ofri-rips"}, "is_accepted": false, "score": 0, "last_activity_date": 1504164501, "creation_date": 1504164501, "answer_id": 45975680, "question_id": 45965296, "link": "https://stackoverflow.com/questions/45965296/doxygen-warning-when-using-a-macro-inside-an-anonymous-struct/45975680#45975680", "title": "Doxygen warning when using a macro inside an anonymous struct", "body": "<p>The workaround that I used was to edit the Doxyfile:</p>\n\n<p>1) make sure that MACRO_EXPANSION tag is set to YES</p>\n\n<p>2) in PREDEFINED tag add the macro followed with = operator, without spaces, in my case: BASIC_VAR(var_1)=</p>\n\n<p>For some reason, setting MACRO_EXPANSION tag to YES and EXPAND_ONLY_PREDEF to NO didn't work.</p>\n"}], "owner": {"reputation": 143, "user_id": 4720322, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/03fe7766e94a48e8867764122b802ef4?s=128&d=identicon&r=PG&f=1", "display_name": "Ofri Rips", "link": "https://stackoverflow.com/users/4720322/ofri-rips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1553595141, "creation_date": 1504109776, "question_id": 45965296, "link": "https://stackoverflow.com/questions/45965296/doxygen-warning-when-using-a-macro-inside-an-anonymous-struct", "title": "Doxygen warning when using a macro inside an anonymous struct", "body": "<p>I have a struct, and by convention, I need to use a certain macro in order to declare a variable of that type:</p>\n\n<p>the struct:</p>\n\n<pre><code>struct basic_struct {\n    int a;\n    int b;\n};\n</code></pre>\n\n<p>the macro:</p>\n\n<pre><code>#define BASIC_VAR(var_name) struct basic_struct var_name\n</code></pre>\n\n<p>I encountered a problem with Doxygen when using this macro inside an anonymous struct, as follows:</p>\n\n<pre><code>struct {\n    BASIC_VAR(var_1);\n    int var_2;\n} my_struct;\n</code></pre>\n\n<p>I get the Doxygen warning:</p>\n\n<pre><code>warning: no uniquely matching class member found for BASIC_VAR(var_1)\n</code></pre>\n\n<p>when:</p>\n\n<p>1) dropping the macro</p>\n\n<pre><code>struct {\n    struct basic_struct var_1;\n    int var_2;\n} my_struct;\n</code></pre>\n\n<p>2) not using anonymous struct</p>\n\n<pre><code> struct my_struct_t {\n    BASIC_VAR(var_1);\n    int var_2;\n} my_struct;\n</code></pre>\n\n<p>I get no warnings.\nBut I have to use the macro, and I prefer to keep using the anonymous struct, there's any Doxygen command I can use to avoid this warning? </p>\n"}, {"tags": ["c", "reverse"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1504109198, "post_id": 45965086, "comment_id": 78889005, "body": "Well, if the answers wrong, then the logic is necessarily wrong as well. Have you done any debugging?"}, {"owner": {"reputation": 4031, "user_id": 7640269, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/szGUJ.png?s=128&g=1", "display_name": "danglingpointer", "link": "https://stackoverflow.com/users/7640269/danglingpointer"}, "edited": false, "score": 0, "creation_date": 1504109319, "post_id": 45965086, "comment_id": 78889091, "body": "Try to use gdb to debug your program and btw conio.h? Which compiler your using?"}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1504113473, "post_id": 45965086, "comment_id": 78891461, "body": "Much easier to do if you just read the number as a character string, and print out the characters in reverse order."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504116394, "post_id": 45965086, "comment_id": 78893144, "body": "What should happen if the user gives a 4-digit number, or a 6-digit number?  Or are you not at a point where you have to make your programs foolproof?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504119629, "post_id": 45965086, "comment_id": 78894898, "body": "&quot;giving negative numbers for other output.&quot; --&gt; post that input and the output observed."}], "answers": [{"tags": [], "owner": {"reputation": 652, "user_id": 4080489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QJ9sc.jpg?s=128&g=1", "display_name": "Aniruddh Dikhit", "link": "https://stackoverflow.com/users/4080489/aniruddh-dikhit"}, "is_accepted": false, "score": 0, "last_activity_date": 1504109869, "creation_date": 1504109869, "answer_id": 45965334, "question_id": 45965086, "link": "https://stackoverflow.com/questions/45965086/the-output-is-coming-out-wrong-inspite-of-the-correct-logic/45965334#45965334", "title": "the output is coming out wrong inspite of the correct logic", "body": "<p>There is a bit of problem with the logic here from what I can tell, instead of doing integer division of last digit with 10 do a module or simply print it as is</p>\n\n<pre><code>l5=m4/10;\n</code></pre>\n\n<p>change to</p>\n\n<pre><code>l5=m4%10;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8539032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2223bfa842347e7e280e6e1ed86ebc1b?s=128&d=identicon&r=PG&f=1", "display_name": "Shraddha", "link": "https://stackoverflow.com/users/8539032/shraddha"}, "edited": false, "score": 1, "creation_date": 1504112554, "post_id": 45965424, "comment_id": 78890963, "body": "No we aren&#39;t supposed to use loops"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1, "user_id": 8539032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2223bfa842347e7e280e6e1ed86ebc1b?s=128&d=identicon&r=PG&f=1", "display_name": "Shraddha", "link": "https://stackoverflow.com/users/8539032/shraddha"}, "edited": false, "score": 3, "creation_date": 1504116282, "post_id": 45965424, "comment_id": 78893077, "body": "@Shraddha: if there are artificial constraints on your solution like &quot;can&#39;t use loops&quot; or &quot;can&#39;t use functions declared in a specific header&quot;, you <b>must</b> say so in the question.  We can&#39;t guess (and shouldn&#39;t have to guess) what peculiar constraints are placed on your code by well-meaning teachers.  A loop is a natural way to deal with the problem."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504119703, "post_id": 45965424, "comment_id": 78894937, "body": "The loop idea is good.  Note that <code>nb *= -1;</code> (what is the minimum value for <code>nb</code>?) and <code>res * 10 + (nb % 10);</code>  (maybe 1222333999) may overflow."}], "tags": [], "owner": {"reputation": 11, "user_id": 8469094, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kgVJokzTKjI/AAAAAAAAAAI/AAAAAAAAAWA/QwUK6O809Lo/photo.jpg?sz=128", "display_name": "Samuel", "link": "https://stackoverflow.com/users/8469094/samuel"}, "is_accepted": false, "score": 0, "last_activity_date": 1504110165, "creation_date": 1504110165, "answer_id": 45965424, "question_id": 45965086, "link": "https://stackoverflow.com/questions/45965086/the-output-is-coming-out-wrong-inspite-of-the-correct-logic/45965424#45965424", "title": "the output is coming out wrong inspite of the correct logic", "body": "<p>Are you allowed to use loops? Try somthing like this maybe:</p>\n\n<pre><code>int main ()\n{\n    int nb;\n    int res = 0;\n    int if_negative = 1; \n\n    printf (\"%s\\n\", \"Enter number: \");\n    scanf (\"%d\", nb);\n    if (nb &lt; 0)                //check if negative\n    {\n        if_negative = -1;\n        nb *= -1;\n    }\n    while (nb != 0)\n    {\n        res = res * 10 + (nb % 10);   //build up the answer\n        nb /= 10;\n    }\n    res *= if_negative; \n    ****    // the rest of your code\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8539032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2223bfa842347e7e280e6e1ed86ebc1b?s=128&d=identicon&r=PG&f=1", "display_name": "Shraddha", "link": "https://stackoverflow.com/users/8539032/shraddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1504113764, "creation_date": 1504109103, "last_edit_date": 1504113764, "question_id": 45965086, "link": "https://stackoverflow.com/questions/45965086/the-output-is-coming-out-wrong-inspite-of-the-correct-logic", "title": "the output is coming out wrong inspite of the correct logic", "body": "<p>Reverse of a five digit number.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n\nint main()\n{\n    int a, l1, l2, l3, l4, l5, m1, m2, m3, m4;\n    clrscr();\n\n    printf(\"Enter a number: \");\n    scanf(\"%d\",&amp;a);\n\n    l1 = a  % 10;\n    m1 = a  / 10;\n    l2 = m1 % 10;\n    m2 = m1 / 10;\n    l3 = m2 % 10;\n    m3 = m2 / 10;\n    l4 = m3 % 10;\n    m4 = m3 / 10;\n    l5 = m4 / 10;\n\n    printf(\"\\n%d%d%d%d%d\", l1, l2, l3, l4, l5);\n    getch();\n    return 0;\n}\n</code></pre>\n\n<p>I think the logic is correct but output is only coming for the input 12345 and is giving negative numbers for other output.</p>\n"}, {"tags": ["c", "data-structures", "structure", "sparse-matrix"], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 7995882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/25c946d0c5a1c70dd072443bf662ead0?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sahu", "link": "https://stackoverflow.com/users/7995882/gaurav-sahu"}, "edited": false, "score": 0, "creation_date": 1504110916, "post_id": 45965190, "comment_id": 78890118, "body": "but when we pass array to function it is the address which is passed so basically there is no difference. and also it has  nothing to do with my problem."}, {"owner": {"reputation": 652, "user_id": 4080489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QJ9sc.jpg?s=128&g=1", "display_name": "Aniruddh Dikhit", "link": "https://stackoverflow.com/users/4080489/aniruddh-dikhit"}, "edited": false, "score": 0, "creation_date": 1504113898, "post_id": 45965190, "comment_id": 78891718, "body": "That&#39;s right. Looking at your code again I see an issue with the logic whic leads to all lower indices not getting printed once a higher index is encountered in the sequence."}, {"owner": {"reputation": 129, "user_id": 7995882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/25c946d0c5a1c70dd072443bf662ead0?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sahu", "link": "https://stackoverflow.com/users/7995882/gaurav-sahu"}, "edited": false, "score": 0, "creation_date": 1504156252, "post_id": 45965190, "comment_id": 78906043, "body": "yeah i too thinking of sorting them after user entered value and its respective index."}], "tags": [], "owner": {"reputation": 652, "user_id": 4080489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QJ9sc.jpg?s=128&g=1", "display_name": "Aniruddh Dikhit", "link": "https://stackoverflow.com/users/4080489/aniruddh-dikhit"}, "is_accepted": true, "score": 0, "last_activity_date": 1504113932, "last_edit_date": 1504113932, "creation_date": 1504109474, "answer_id": 45965190, "question_id": 45964814, "link": "https://stackoverflow.com/questions/45964814/addition-of-sparse-matrix-using-structure-in-ctriplet-form/45965190#45965190", "title": "Addition of sparse matrix using structure in c(triplet form)", "body": "<p>Updating the original answer: </p>\n\n<p>The reason out of order values are not getting printed is because when the value in triplet form points to an element further down the for loops go past all the other values that could have been printed. For example in your example the 3rd element is at row=1, col=3 however the 2nd element is at row=2,col=2. This will lead to the outer for-loop advancing down to 2nd row. At that point in time the loops will not go back and print 1st row. </p>\n\n<p>One way will be to sort based on the row and col and then print the values.</p>\n"}], "owner": {"reputation": 129, "user_id": 7995882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/25c946d0c5a1c70dd072443bf662ead0?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sahu", "link": "https://stackoverflow.com/users/7995882/gaurav-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5510, "favorite_count": 0, "accepted_answer_id": 45965190, "answer_count": 1, "score": 0, "last_activity_date": 1504119199, "creation_date": 1504108233, "last_edit_date": 1504119199, "question_id": 45964814, "link": "https://stackoverflow.com/questions/45964814/addition-of-sparse-matrix-using-structure-in-ctriplet-form", "title": "Addition of sparse matrix using structure in c(triplet form)", "body": "<p>I am currently doing a problem of addition of sparse matrices. I am making sparse matrix by using triplet form. The triplet form is made by using structure in c.</p>\n\n<pre><code>struct sparse\n{\n    int row;\n    int col;\n    int val;\n};\n</code></pre>\n\n<p>but while doing this sparse matrix problem I encountered a problem that my code only displays the correct sparse matrix when i am giving the indices of nonzero values in increasing order (eg. (0 1 3),(1 2 5),(2 2 7) etc)otherwise it is displaying incorrect matrix.for example if am giving input like (0 1 3),(2 2 7),(1 2 5) etc then it is displaying wrong matrix. How to solve this problem so that in any order of indices it will give correct output? </p>\n\n<p>I have added my input and resulting output. I have done this for two sparse matrix.</p>\n\n<p><img src=\"https://i.stack.imgur.com/ISKk1.png\" alt=\"\"> </p>\n\n<pre><code>#include&lt;iostream&gt;\n#include&lt;cstdio&gt;\nstruct sparse\n{\n    int row,col,val;\n};\nvoid readmat(sparse sp[])\n{\n    printf(\"enter total number number of rows ,column of matrix and total\n    of nonzero values in this\\n\");             \n    scanf(\"%d %d %d\",&amp;sp[0].row,&amp;sp[0].col,&amp;sp[0].val);\n    printf(\"now start entering the values by specifying index \n    position\\n\");\n    for(int i=1;i&lt;=sp[0].val;i++)\n        scanf(\"%d %d %d\",&amp;sp[i].row,&amp;sp[i].col,&amp;sp[i].val);\n}\nvoid displaymat(sparse sp[])\n{\n    int k=1;\n    for(int i=0;i&lt;sp[0].row;i++)\n    {\n        for(int j=0;j&lt;sp[0].col;j++)\n        {\n             if(k&lt;=sp[0].val&amp;&amp;i==sp[k].row&amp;&amp;j==sp[k].col)\n             {\n                 printf(\"%d\\t\",sp[k].val);\n                 k++;\n             }\n             else\n                 printf(\"0\\t\");\n         }\n         printf(\"\\n\");\n    }\n\n}\nint main()\n{\n    struct sparse sp1[10],sp2[10],sp3[10];\n    printf(\"for first matrix\\n\");\n    readmat(sp1);\n    printf(\"for second matrix\\n\");\n    readmat(sp2);\n    displaymat(sp1);\n    printf(\"\\n\\n\");\n    displaymat(sp2);\n    printf(\"\\n\\n\");\n    displaymat(sp3);\n    return 0;\n }`\n</code></pre>\n"}, {"tags": ["android", "c", "argon2-ffi"], "owner": {"reputation": 927, "user_id": 1067988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3157382dc83a3deee8b0eed89ad5b3ad?s=128&d=identicon&r=PG", "display_name": "user173488", "link": "https://stackoverflow.com/users/1067988/user173488"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504107893, "creation_date": 1504107893, "question_id": 45964710, "link": "https://stackoverflow.com/questions/45964710/argon-2-library-use-in-android", "title": "Argon 2 library use in android", "body": "<p>I dont have any knowledge of using c libraries, i need to use Argon2 library <a href=\"https://github.com/p-h-c/phc-winner-argon2\" rel=\"nofollow noreferrer\">https://github.com/p-h-c/phc-winner-argon2</a> in my android application, i read alot of articles about adding c code into android app, but i cannot find the .so file of the library, i tried opening the library in visual studio to build but no luck. i tried to use the make command in cmd windows but no luck, is it possible to add the c code directly into my android app with out the need to build, or i must build an os? i am using a mac computer for my android development.</p>\n\n<p>if possible, please guid me into doing it, note that we need to add same library to our ios app and c# website and server.</p>\n\n<p>thank you in advance</p>\n"}, {"tags": ["c++", "c", "file-handling"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 4, "creation_date": 1504110161, "post_id": 45964466, "comment_id": 78889639, "body": "I am sorry for your spacebar. Hope you get a new keyboard soon, so that you can reindent your code."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1504110601, "post_id": 45964466, "comment_id": 78889925, "body": "^^^what @AnttiHaapala says.  Good formatting and indentation is not just a trivial matter of making code look pretty.  Poor indentation leads to flow-of-control and scoping bugs and, if you are posting your code to a Q&amp;A site for help, tends to result in downvotes and closing as &#39;unclear&#39;:("}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 0, "last_activity_date": 1504107737, "last_edit_date": 1504107737, "creation_date": 1504107419, "answer_id": 45964556, "question_id": 45964466, "link": "https://stackoverflow.com/questions/45964466/file-handling-the-code-stops-running/45964556#45964556", "title": "file handling: the code stops running", "body": "<p><code>%s</code> specifier expexts the <code>char*</code> but what you are passing is <code>char (*)[30]</code>. Even if they point to same memory they are different types.</p>\n\n<p>Remove reference operator</p>\n\n<pre><code>fscanf(fp,\"%s\",treeArr[i]);\n               ^^^^^^^^^^\n</code></pre>\n\n<hr>\n\n<p>Also you should rewind/reset file pointer of <code>fp</code> file descriptor which,after loop, point to the end of file what causes that <code>fscanf</code> returns EOF.</p>\n\n<pre><code>fseek(fp, 0L, SEEK_SET);\n// Or\nrewind(fp);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 3, "last_activity_date": 1504107472, "creation_date": 1504107472, "answer_id": 45964575, "question_id": 45964466, "link": "https://stackoverflow.com/questions/45964466/file-handling-the-code-stops-running/45964575#45964575", "title": "file handling: the code stops running", "body": "<p>Problem is your file pointer <code>fp</code> is pointing to the end of file after the <code>while</code> loop (where you write into the file). So the subsequent read operations (<code>fscanf</code>) going to return <code>EOF</code> immediately.</p>\n\n<p>You can reset the file pointer to the beginning before reading the file:</p>\n\n<pre><code>fseek(fp, 0L, SEEK_SET);\n</code></pre>\n\n<p>You would have noticed this if error check your library calls (<code>fopen</code>, <code>scanf</code>, <code>fscanf</code>, etc).</p>\n"}], "owner": {"reputation": 9, "user_id": 7880241, "user_type": "registered", "profile_image": "https://graph.facebook.com/1333792900001773/picture?type=large", "display_name": "Ramyanee Kashyap", "link": "https://stackoverflow.com/users/7880241/ramyanee-kashyap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504112424, "creation_date": 1504107164, "last_edit_date": 1504112424, "question_id": 45964466, "link": "https://stackoverflow.com/questions/45964466/file-handling-the-code-stops-running", "title": "file handling: the code stops running", "body": "<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\n    FILE* fp;\n\n    fp = fopen(\"a.text\", \"w+\");\n\n    int yes = 1, count = 0;\n\n    char tree[30];\n\n    while (yes) {\n        printf(\"enter the name of the tree\\n\");\n        scanf(\"%s\", tree);\n        fprintf(fp, \"%s\\n\", tree);\n        printf(\"do you want to enter more  trees?enter 0 if no and 1 if yes\\n\");\n        scanf(\"%d\", &amp;yes);\n        count++;\n    }\n\n    char treeArr[count][30];\n    int i = 0;\n    for (i = 0; i &lt; count; i++) {\n        fscanf(fp, \"%s\", &amp;treeArr[i]);\n        printf(\"%s\", treeArr[i]);\n    }\n\n    fclose(fp);\n}\n</code></pre>\n\n<p>this part of the code is not working.</p>\n\n<pre><code>char treeArr[count][30];\nint i = 0;\nfor (i = 0; i &lt; count; i++) {\n    fscanf(fp, \"%s\", &amp;treeArr[i]);\n    printf(\"%s\", treeArr[i]);\n}\n</code></pre>\n\n<p>I need to write the names of the trees in the file and and then put it into a string array, so that i can calculate the percentage of each tree.</p>\n\n<p>this is the question. kindly provide a suitable solution.</p>\n\n<p>1.As you walk along TU campus, you see lots of trees of different species on your way.</p>\n\n<p>Horticulture Centre has prepared a list of every tree standing on the way from CSE Department to the Main Gate.</p>\n\n<p>You have to report the percentage of each tree species.</p>\n\n<p><strong>Input</strong></p>\n\n<blockquote>\n  <p>Input to your program consists of a list of the species of every tree observed by the Horticulture Department; one tree per line in .txt file. No species name exceeds 30 characters. </p>\n</blockquote>\n\n<p><strong>Output</strong></p>\n\n<blockquote>\n  <p>Print the name of each tree species available in TU (sorted in order of their percentage), followed by the percentage of the population it represents.</p>\n</blockquote>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1504106842, "post_id": 45964222, "comment_id": 78887495, "body": "Pleas post a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> because this is not enough information to help you."}, {"owner": {"reputation": 181, "user_id": 7076130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zt21W.jpg?s=128&g=1", "display_name": "Alireza Kavian", "link": "https://stackoverflow.com/users/7076130/alireza-kavian"}, "edited": false, "score": 0, "creation_date": 1504106910, "post_id": 45964222, "comment_id": 78887543, "body": "where did you initialized variable <b><code>i</code></b> ?"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504107107, "post_id": 45964222, "comment_id": 78887688, "body": "@yano on some keyboards (Italian, for example) that&#39;s not where the backtick is. Actually on some keyboards (again, Italian) there&#39;s no backtick at all."}, {"owner": {"reputation": 181, "user_id": 7076130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zt21W.jpg?s=128&g=1", "display_name": "Alireza Kavian", "link": "https://stackoverflow.com/users/7076130/alireza-kavian"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504107126, "post_id": 45964222, "comment_id": 78887698, "body": "@yano ok, thanks :)"}, {"owner": {"reputation": 491, "user_id": 8509272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/487ff5fe4697aeb326fa5092ef38f116?s=128&d=identicon&r=PG&f=1", "display_name": "savram", "link": "https://stackoverflow.com/users/8509272/savram"}, "edited": false, "score": 0, "creation_date": 1504107240, "post_id": 45964222, "comment_id": 78887773, "body": "Are you by chance trying to initialize the variable in global scope? That won&#39;t work, try it in main function. Refer to this post: <a href=\"https://stackoverflow.com/questions/3025050/error-initializer-element-is-not-constant-when-trying-to-initialize-variable-w\" title=\"error initializer element is not constant when trying to initialize variable w\">stackoverflow.com/questions/3025050/&hellip;</a>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1504107656, "post_id": 45964222, "comment_id": 78887998, "body": "Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 2, "last_activity_date": 1504107741, "last_edit_date": 1504107741, "creation_date": 1504107426, "answer_id": 45964559, "question_id": 45964222, "link": "https://stackoverflow.com/questions/45964222/initialization-from-incompatible-pointer-warning/45964559#45964559", "title": "Initialization from incompatible pointer warning", "body": "<p>There is not really enough information in your question, but this compiles fine without warnings:</p>\n\n<pre><code>typedef struct ListaPendente  // made up definition by me as you didn't provide\n{                             // the definition of ListaPendente \n  int dummy;\n} ListaPendente ;\n\ntypedef struct NodoListaReg {\n  char utente[100];           // MAX_NAME_LENGTH replaced by 100 as it is not relevant\n  int connesso;\n  ListaPendente *msgs;\n  struct NodoListaReg *next;\n} TipoListaReg;\n\nTipoListaReg *arrayReg[512];\n\nint main()\n{\n  int i = 0;\n  TipoListaReg *s = arrayReg[i];    // no warning here\n}\n</code></pre>\n\n<p>However the code won't do anything useful</p>\n"}], "owner": {"reputation": 76, "user_id": 7852041, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8b90b0d9d1a7d92ecfdca98c1bf80854?s=128&d=identicon&r=PG&f=1", "display_name": "soissy", "link": "https://stackoverflow.com/users/7852041/soissy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504167296, "creation_date": 1504106450, "last_edit_date": 1504167296, "question_id": 45964222, "link": "https://stackoverflow.com/questions/45964222/initialization-from-incompatible-pointer-warning", "title": "Initialization from incompatible pointer warning", "body": "<p>I have a warning but i can't understand why: </p>\n\n<pre><code>void stampaCon(){\npthread_mutex_lock(&amp;mutexCon);\n\n  printf(\"lista dei connesi: \\n\");\n  int i;\n    for(i=0; i&lt;=MAX_CONNECTIONS*8; i++){\n        if(arrayCon[i]!=NULL){\n            TipoListaReg *s = NULL;\n\n            s = arrayCon[i]; //gives me a warning\n\n            printf(\"utente %s\\n\", arrayCon[i]-&gt;utente);\n            while(s-&gt;next!=NULL){\n                printf(\"utente %s\\n\", s-&gt;next-&gt;utente);\n                s=s-&gt;next;\n            }\n        }\n    }\n\n    pthread_mutex_unlock(&amp;mutexCon);\n</code></pre>\n\n<p>}</p>\n\n<p>TipoListaReg structure is:</p>\n\n<pre><code>typedef struct NodoListaReg { \n  char utente[MAX_NAME_LENGTH+1];\n  int connesso; \n  ListaPendente *msgs;\n  struct NodoListaReg *next;\n} TipoListaReg;\n</code></pre>\n\n<p>and arrayReg is a global variable defined as:</p>\n\n<pre><code>TipoListaReg *arrayReg[512];\n</code></pre>\n\n<p>and this is a struct ListaPendente:</p>\n\n<pre><code>typedef struct pendenti{ \n\n  char msg[MAX_MSG_SIZE];\n  char mittente[MAX_NAME_LENGTH+1];\n  int type;\n  struct pendenti *next;\n}ListaPendente;\n</code></pre>\n\n<p>the warning is:</p>\n\n<pre><code>warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n</code></pre>\n"}, {"tags": ["c", "murmurhash"], "comments": [{"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "edited": false, "score": 2, "creation_date": 1504104721, "post_id": 45963412, "comment_id": 78885867, "body": "Are you building your program with a sanitizer like <code>-fsanitize=integer</code>?"}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1504105607, "post_id": 45963412, "comment_id": 78886612, "body": "the stars (<code>*</code>) are a great idea for marking the lines... but maybe use <code>&#47;&#47; **** line 53</code> (for example) so they are a valid C comment...?"}], "answers": [{"comments": [{"owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "edited": false, "score": 1, "creation_date": 1504106313, "post_id": 45963830, "comment_id": 78887130, "body": "Given the 32-bit constant <code>0x5bd1e995</code>, the OP wants to implement the 32-bit variant. The code seems to be copied from the <a href=\"https://sites.google.com/site/murmurhash/\" rel=\"nofollow noreferrer\">reference implementation</a> which uses <code>unsigned int</code>s."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "edited": false, "score": 0, "creation_date": 1504106896, "post_id": 45963830, "comment_id": 78887533, "body": "@nwellnhof - I hadn&#39;t noticed, thanks. I updated the answer to reflect this observation."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1504107713, "post_id": 45963830, "comment_id": 78888037, "body": "An <code>unsigned int</code> type with 8 bits would not conform to the C specification. It needs at least 16 bits."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1504107819, "post_id": 45963830, "comment_id": 78888118, "body": "@IanAbbott - oops... I meant 8 bytes (64 bits). Some machines interfaces use the larger <code>int</code> in 128 bit instruction chips. Thanks for the catch!"}, {"owner": {"reputation": 13, "user_id": 8320892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f1697d60769b63c4947552f78b7824?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Guan", "link": "https://stackoverflow.com/users/8320892/jeff-guan"}, "edited": false, "score": 0, "creation_date": 1504108730, "post_id": 45963830, "comment_id": 78888687, "body": "Thanks! Line 60 still erred so I used h*=m%2^32 to get it back in range."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "reply_to_user": {"reputation": 13, "user_id": 8320892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f1697d60769b63c4947552f78b7824?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Guan", "link": "https://stackoverflow.com/users/8320892/jeff-guan"}, "edited": false, "score": 0, "creation_date": 1504111412, "post_id": 45963830, "comment_id": 78890378, "body": "@JeffGuan - I&#39;m happy to help. as to the &quot;h*=m%2^32&quot;, I might point out @nwellnhof &#39;s answer regarding compiler flags. The unsigned overflow in the multiplication is expected and should be ignored rather than fixed. As to a fix, I would recommend <code>h = (uint32_t)( (h*m) &amp; 0xFFFFFFFF)</code> instead of a modulus operation. (I updated the answer with this tip)."}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 0, "last_activity_date": 1504111536, "last_edit_date": 1504111536, "creation_date": 1504105346, "answer_id": 45963830, "question_id": 45963412, "link": "https://stackoverflow.com/questions/45963412/murmurhash2-unsigned-int-overflow/45963830#45963830", "title": "Murmurhash2 Unsigned Int overflow", "body": "<p><code>unsigned int</code> has a system dependent number of bits.</p>\n\n<p>On most systems, this number is 32 bits (4 bytes) but some systems might use different sizes (i.e. 64bits (8 bytes) on some machines).</p>\n\n<p>However, murmur hash \"words\" are a specific size. The 64 bit variant requires a 64bit unsigned type and the 32 bit variant requires a 32bit unsigned type.</p>\n\n<p>This inconsistency can be resolved by using the <code>uint64_t</code> or <code>uint32_t</code> types defined in <code>&lt;stdint.h&gt;</code>.</p>\n\n<p>I would add that the suffix <code>UL</code> (unsigned long) should probably be added to any numerical constants you use. i.e. <code>2950274797UL * 1540483477UL</code>.</p>\n\n<p>As indicated by @nwellnhof, your code seems to use the 32 bit variant of the algorithm.</p>\n\n<p>The overflow in the multiply instruction is normal in these cases (where the result larger than the number of available bits and is truncated). This loss of data is acceptable as part of the hashing process.</p>\n\n<p>Consider informing the compiler about the expected result using:</p>\n\n<pre><code> h = (uint32_t)(((uint64_t)h * m) &amp; 0xFFFFFFFF)\n</code></pre>\n\n<p>Good Luck!</p>\n"}, {"tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": true, "score": 4, "last_activity_date": 1504107749, "last_edit_date": 1504107749, "creation_date": 1504106989, "answer_id": 45964406, "question_id": 45963412, "link": "https://stackoverflow.com/questions/45963412/murmurhash2-unsigned-int-overflow/45964406#45964406", "title": "Murmurhash2 Unsigned Int overflow", "body": "<p>It seems that you're building with the UBSan option <code>-fsanitize=unsigned-integer-overflow</code> or some other option like <code>-fsanitize=integer</code> that enables this check. <a href=\"https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html\" rel=\"nofollow noreferrer\">The documentation</a> says:</p>\n\n<blockquote>\n  <p>Note that unlike signed integer overflow, unsigned integer is not undefined behavior. However, while it has well-defined semantics, it is often unintentional, so UBSan offers to catch it.</p>\n</blockquote>\n\n<p>In the case of MurmurHash, unsigned integer overflow in multiplications is fully intentional, so you should disable the option.</p>\n\n<ul>\n<li>If you use <code>-fsanitize=unsigned-integer-overflow</code> explicitly, remove it.</li>\n<li>If it is enabled by another option, pass <code>-fno-sanitize=unsigned-integer-overflow</code>.</li>\n<li>Alternatively, annotate the function <code>MurmurHash2</code> with <code>__attribute__((no_sanitize(\"unsigned-integer-overflow\")))</code>.</li>\n</ul>\n\n<p>Another note: Your code seems to be copied from the <a href=\"https://sites.google.com/site/murmurhash/\" rel=\"nofollow noreferrer\">32-bit reference implementation of MurmurHash2</a> which assumes 32-bit <code>int</code>s. You should consider using <code>uint32_t</code> instead.</p>\n"}], "owner": {"reputation": 13, "user_id": 8320892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75f1697d60769b63c4947552f78b7824?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Guan", "link": "https://stackoverflow.com/users/8320892/jeff-guan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 45964406, "answer_count": 2, "score": 1, "last_activity_date": 1504187436, "creation_date": 1504104184, "last_edit_date": 1504187436, "question_id": 45963412, "link": "https://stackoverflow.com/questions/45963412/murmurhash2-unsigned-int-overflow", "title": "Murmurhash2 Unsigned Int overflow", "body": "<p>I'm currently trying to implement a hashtable/trie, but when I pass in parameters to murmurhash2, it gives back a number but I get run time errors of unsigned int overflow:</p>\n\n<p>test.c:53:12: runtime error: unsigned integer overflow: 24930 * 1540483477 cannot be represented in type 'unsigned int'</p>\n\n<p>test.c:60:4: runtime error: unsigned integer overflow: 2950274797 * 1540483477 cannot be represented in type 'unsigned int'\n6265</p>\n\n<p>I've put a bunch of stars(*) on the lines 53 and 60</p>\n\n<p>I'm not sure if I'm passing some parameters wrong. Any help would be greatly appreciated! </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nunsigned int MurmurHash2 ( const void * key, int len, unsigned int seed );\n\nint main(void)\n{\n   const char* s= \"aa\";\n   unsigned int number= MurmurHash2 (s, (int)strlen(s), 1) % 10000;\n   printf(\"%u\\n\", number);\n}\n\nunsigned int MurmurHash2 ( const void * key, int len, unsigned int seed )\n{\n// 'm' and 'r' are mixing constants generated offline.\n// They're not really 'magic', they just happen to work well.\n\nconst unsigned int m = 0x5bd1e995;\nconst int r = 24;\n\n// Initialize the hash to a 'random' value\n\nunsigned int h = seed ^ len;\n\n// Mix 4 bytes at a time into the hash\n\nconst unsigned char * data = (const unsigned char *)key;\n\nwhile(len &gt;= 4)\n{\n    unsigned int k = *(unsigned int *)data;\n\n    k *= m;\n    k ^= k &gt;&gt; r;\n    k *= m;\n\n    h *= m;\n    h ^= k;\n\n    data += 4;\n    len -= 4;\n}\n\n// Handle the last few bytes of the input array\n\nswitch(len)\n{\ncase 3: h ^= data[2] &lt;&lt; 16;\ncase 2: h ^= data[1] &lt;&lt; 8;\ncase 1: h ^= data[0];\n        h *= m; ************************************************\n};\n\n// Do a few final mixes of the hash to ensure the last few\n// bytes are well-incorporated.\n\nh ^= h &gt;&gt; 13;\nh *= m;   **************************************\nh ^= h &gt;&gt; 15;\n\nreturn h;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 3, "creation_date": 1504104332, "post_id": 45963408, "comment_id": 78885584, "body": "What have you tried so far? Add in a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to your question so we can see what stage your code is at and be able to give you a more useful answer"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504104616, "post_id": 45963408, "comment_id": 78885798, "body": "Kindly show your research / debugging effort so far. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1504104899, "post_id": 45963408, "comment_id": 78886012, "body": "How are you creating the string in the first place? Please post some code and explain why it doesn&#39;t work as you expect it to."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504105025, "post_id": 45963408, "comment_id": 78886124, "body": "Since you can not change a string literal, you need another area for the result you want."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1504105198, "post_id": 45963408, "comment_id": 78886284, "body": "Please don&#39;t describe your code, but show it. Also show some examples of strings before and after the &quot;appending&quot;. You can <a href=\"https://stackoverflow.com/posts/45963408/edit\">edit</a> your question."}, {"owner": {"reputation": 1, "user_id": 8348863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb618824a933d025dce9542754767717?s=128&d=identicon&r=PG&f=1", "display_name": "Roops", "link": "https://stackoverflow.com/users/8348863/roops"}, "edited": false, "score": 0, "creation_date": 1504105770, "post_id": 45963408, "comment_id": 78886745, "body": "I added code in description.. if I use inputstr variable outside the loop . It print junk character along with appended data"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1504105972, "post_id": 45963408, "comment_id": 78886898, "body": "<code>char a[2]</code> isn&#39;t big enough. You can fit one character with the <code>NUL</code> terminator in that string. Arrays do not resize automatically in <code>c</code>. If you write &quot;01ABc2&quot; to <code>a</code> you will overrun the buffer, invoking undefined behavior."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1504106095, "post_id": 45963408, "comment_id": 78886975, "body": "What is <code>Char</code>? that&#39;s not a <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> type nor are <code>Strcat</code> or <code>Strcpy</code> <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> functions, and <code>Using</code>? What is that?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504107783, "post_id": 45963408, "comment_id": 78888093, "body": "like <a href=\"https://ideone.com/bCiBaJ\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1504104371, "post_id": 45963457, "comment_id": 78885607, "body": "<code>strcat</code> adds a string on the end of a string - it doesn&#39;t add something to the beginning of it"}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1504104428, "post_id": 45963457, "comment_id": 78885639, "body": "Use <code>&quot;0&quot;</code> as destination... what&#39;s the point of this comment? I&#39;m giving the OP a search direction not the whole solution..."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1504104807, "post_id": 45963457, "comment_id": 78885943, "body": "And one should NEVER recommend <code>strcat()</code>. If you explain to someone how strings work in c, they will almost never use <code>strcat()</code>. Specially not <code>strncat()</code> which is an evil function."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 447, "user_id": 3496058, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3919012fe4657753661eb1bcfa9b3b00?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleWebDev", "link": "https://stackoverflow.com/users/3496058/humblewebdev"}, "edited": false, "score": 1, "creation_date": 1504104832, "post_id": 45963457, "comment_id": 78885958, "body": "@The Unholy Programmer writing the Read Only string literal is definitelly the right way for the UB and very likely SEGFAULT as well :)"}, {"owner": {"reputation": 447, "user_id": 3496058, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3919012fe4657753661eb1bcfa9b3b00?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleWebDev", "link": "https://stackoverflow.com/users/3496058/humblewebdev"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504104944, "post_id": 45963457, "comment_id": 78886045, "body": "@PeterJ_01 fine i admit it,  i don&#39;t know c. In the modern world we use the + operator and life is good."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 447, "user_id": 3496058, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3919012fe4657753661eb1bcfa9b3b00?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleWebDev", "link": "https://stackoverflow.com/users/3496058/humblewebdev"}, "edited": false, "score": 0, "creation_date": 1504105008, "post_id": 45963457, "comment_id": 78886105, "body": "@The Unholy Programmer <code>In the modern world we use the +</code> - so comment the modern world topics"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 447, "user_id": 3496058, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3919012fe4657753661eb1bcfa9b3b00?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleWebDev", "link": "https://stackoverflow.com/users/3496058/humblewebdev"}, "edited": false, "score": 0, "creation_date": 1504105090, "post_id": 45963457, "comment_id": 78886185, "body": "@TheUnholyProgrammer And life sucks did you mean? <code>+</code> operator is the addition operator, concatenating strings via that operator is not intuitive. Also hiding the details of how strings work, make programs very inefficient. Luckily most programming languages that use <code>+</code> as a concatenation operator will optimize the process correctly, but it&#39;s still good to understand how can a string be represented internally."}, {"owner": {"reputation": 447, "user_id": 3496058, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3919012fe4657753661eb1bcfa9b3b00?s=128&d=identicon&r=PG&f=1", "display_name": "HumbleWebDev", "link": "https://stackoverflow.com/users/3496058/humblewebdev"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504105091, "post_id": 45963457, "comment_id": 78886186, "body": "@PeterJ_01 gotchya"}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504105158, "post_id": 45963457, "comment_id": 78886244, "body": "Guys i&#39;m not writing the software for the OP. I&#39;m giving research direction. But now I&#39;m curious: @iharob-al-asimi what do you use in C that is in standard library?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504105292, "post_id": 45963457, "comment_id": 78886362, "body": "You can use <code>memcpy()</code> and take care of the lengths and the terminating <code>&#39;\\0&#39;</code>. Using <code>strcat()</code> can be very inefficient, because you would need to compute the length of the resulting string anyway and then use <code>strcat()</code> that will again compute the length for each string to append the result at the end, so knowing all the lengths and using <code>memcpy()</code> finally terminating the array with <code>&#39;\\0&#39;</code> is better."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504105635, "post_id": 45963457, "comment_id": 78886637, "body": "@Iharob Al Asimi  in this case <code>memcpy</code> will not do."}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "edited": false, "score": 0, "creation_date": 1504105642, "post_id": 45963457, "comment_id": 78886646, "body": "Are you aware that <code>strncat</code> and <code>memcpy</code> implements the SAME algorithm, with the only difference that <code>strncpy</code> handles the terminating 0 and treats pointer as char pointer while memcpy as void pointer? <a href=\"http://clc-wiki.net/wiki/C_standard_library:string.h:strncat\" rel=\"nofollow noreferrer\">clc-wiki.net/wiki/C_standard_library:string.h:strncat</a> and <a href=\"http://clc-wiki.net/wiki/C_standard_library:string.h:memcpy\" rel=\"nofollow noreferrer\">clc-wiki.net/wiki/C_standard_library:string.h:memcpy</a>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504105999, "post_id": 45963457, "comment_id": 78886917, "body": "@Matteo Ragni <code>strncpy</code> does not handle termination in all circumstances. Learn a bit before you comment"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1504106013, "post_id": 45963457, "comment_id": 78886924, "body": "&quot;Giving research direction&quot; is better suited as a comment - it doesn&#39;t make for a good answer"}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "edited": false, "score": 0, "creation_date": 1504106301, "post_id": 45963457, "comment_id": 78887124, "body": "From the standard library description: The strncat() function appends not more than n characters (a null character and characters that follow it are not appended) from the array pointed to by src to the end of the string pointed to by dest. The initial character of src overwrites the null character at the end of dest. <code>A terminating null character is always appended to the result</code>. Thus, dest should accomodate strlen(src)+n+1 characters. Source and destination may not overlap."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504107177, "post_id": 45963457, "comment_id": 78887730, "body": "@Matteo Ragni do not argue. You initially wrote about strncpy."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504117434, "post_id": 45963457, "comment_id": 78893700, "body": "@MatteoRagni: Note that <code>strncat()</code> is not the same as <code>memcpy()</code>, not even when the first pointer points to the null byte.  All else apart, <code>strncat()</code> has to check each byte it copies to see whether it is a null byte; <code>memcpy()</code> does not.  But <code>strncat()</code> is weird enough in its semantics that the only sane advice is &quot;do not use it&quot;."}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "edited": false, "score": 0, "creation_date": 1504117925, "post_id": 45963457, "comment_id": 78893965, "body": "Giving advices to avoid the string.h standard library (while keeping a standard programming context) for working with strings is ridiculous. The implementations has been reported in the previous links."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1504124113, "post_id": 45963457, "comment_id": 78897141, "body": "@MatteoRagni-- nobody said to avoid Standard library string functions; just certain ones. There are plenty of functions in the Standard library that are best avoided, many of them are only retained for the sake of compatibility with legacy code."}], "tags": [], "owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "is_accepted": false, "score": -2, "last_activity_date": 1504104949, "last_edit_date": 1504104949, "creation_date": 1504104329, "answer_id": 45963457, "question_id": 45963408, "link": "https://stackoverflow.com/questions/45963408/string-concatenation-in-c/45963457#45963457", "title": "String concatenation in c", "body": "<p>You are searching for <code>strcat</code> (or really better <code>strncat</code>) defined in <code>string.h</code></p>\n\n<p>But you have to notice:</p>\n\n<ul>\n<li><code>strcat</code> concatenates two strings, thus you need to use the string <code>\"0\"</code> as the destination</li>\n<li>if destination is not large enough, program behavior is unpredictable</li>\n<li>the destination (the first argument of <code>strcat</code> i the only one that is modified, not the second argument (that is actually a <code>const char*</code>)</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504106131, "post_id": 45964003, "comment_id": 78887003, "body": "Interesting DV. Something wrong or maybe DV are just too cheap"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504106744, "post_id": 45964003, "comment_id": 78887440, "body": "Not my downvote, but you shouldn&#39;t use pointer arithmetic but <code>[]</code> notation, and the use of <code>strncpy</code> is questionable as with that function you may end up with a non NUL terminated string.."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504106947, "post_id": 45964003, "comment_id": 78887579, "body": "@Michael Walz not in this case as the <code>dest</code> has been already moved <code>strlen(str)</code> characters right (including the terminating <code>0</code>), and <code>strncpy</code> copies only <code>strlen(str)</code> of the <code>src</code> characters to the <b>front</b> of the <code>dest</code> string. &#39;src&#39; is the string to be placed at the front of dest (maybe variable namaes are a bit confusing)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504108597, "post_id": 45964003, "comment_id": 78888600, "body": "@Michael Walz <code>but you shouldn&#39;t use pointer arithmetic but [] notation</code> ??? why not in my functions?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504109030, "post_id": 45964003, "comment_id": 78888888, "body": "It&#39;s not wrong, but it&#39;s less readable and less usual. What is more readable <code>foo[bar]</code> or <code>*(foo + bar)</code>?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504109261, "post_id": 45964003, "comment_id": 78889042, "body": "@Michael Walz this only your opinion - for me pointer notation is same readable as the table one, but I do not need to check if I can for example increment the <code>foo</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504117220, "post_id": 45964003, "comment_id": 78893600, "body": "<code>memmove(dst + srclen, dst, dstlen + 1); memmove(dst, src, srclen);</code> after the two uses of <code>strlen()</code> seems more direct than the code shown.  Using <code>strncpy()</code> works, but it would be clearer using <code>memmove()</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504119900, "post_id": 45964003, "comment_id": 78895041, "body": "@Jonathan Leffler I did mention it in my answer. But as I wrote own function will be better in this case. Why? Memmove when the areas overlap moves the memory via the temporary location, which is completely unnecessary in this case and is quite slow as well."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1504119992, "post_id": 45964003, "comment_id": 78895091, "body": "Only a stupid implementation does that. The standard requires &quot;as if&quot;, not &quot;thou shalt&quot;!"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504120505, "post_id": 45964003, "comment_id": 78895337, "body": "This is so elementary function. Writing takes 3 minutes. Is something wrong with my one? Compiles to the extremely effective code. So I do not know where the problem is. What is better in the memmove version  (except your liking of course, and potentially not educational move of the larger pieces of data, as it may theoretically break strict aliasing rules)"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -1, "last_activity_date": 1504106090, "last_edit_date": 1504106090, "creation_date": 1504105789, "answer_id": 45964003, "question_id": 45963408, "link": "https://stackoverflow.com/questions/45963408/string-concatenation-in-c/45964003#45964003", "title": "String concatenation in c", "body": "<p>you can use memmove as the areas overlap but IMO is better to write a simple routine for it:</p>\n\n<p><code>src</code> - the string to append in front of the <code>dest</code>. <code>dest</code> has to be big enough to accommodate its new characters</p>\n\n<pre><code>char *straddfront(char *dest, const char *src)\n{\n    size_t srclen = strlen(src);\n    size_t destlen = strlen(dest);\n\n    for (int i = 0; i &lt;= destlen; i++)\n        *(dest + destlen + srclen - i) = *(dest + destlen - i);\n    strncpy(dest, src, srclen);\n    return dest;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504107453, "post_id": 45964518, "comment_id": 78887887, "body": "BTW: I deleted my answer, yours is way better."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504107464, "post_id": 45964518, "comment_id": 78887896, "body": "@IharobAlAsimi: It makes sure the string in <code>target</code> is 0-terminated; just in case I forget to initialize the target array."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504107496, "post_id": 45964518, "comment_id": 78887917, "body": "Yes but you can use <code>strcpy()</code> later. Although there is no need for pointer arithmetic with <code>strcat()</code> so I see the point too. I will delete the comment."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1504107301, "creation_date": 1504107301, "answer_id": 45964518, "question_id": 45963408, "link": "https://stackoverflow.com/questions/45963408/string-concatenation-in-c/45964518#45964518", "title": "String concatenation in c", "body": "<p>First, you need to set aside a buffer large enough for your target string:</p>\n\n<pre><code>/**\n * Attempting to modify the contents of a string literal leads to undefined\n * behavior; to be safe, pointers to literals should be declared \"const\".\n * You are not going to write the modified string back to what inputstr\n * points to.\n */\nconst char *inputstr = \"1ABc2\"; \n\n/**\n * Compute the size of the target buffer, which is the length of inputstr\n * plus 1 for the leading \"0\" plus 1 for the string terminator.\n */\nsize_t targetBufferLength = strlen( inputstr ) + 2; \n\n/**\n * Allocate the target buffer.  Since targetBufferLength is a run-time\n * value, this will only work with C99 and later.  If you're using C90\n * or earlier, targetBufferLength will have to be a compile-time constant,\n * so you'll have to compute it manually and declare it as\n *\n *    char targetBuffer[7]; // 5 + 1 + 1\n *\n * or\n *\n *    #define TARGETBUFFERLENGTH 7 \n *    ...\n *    char targetBuffer[TARGETBUFFERLENGTH];\n *\n */\nchar target[targetBufferLength] = {0}; \n</code></pre>\n\n<p>Now you can write your new string to the target buffer.  You can use <code>sprintf</code>:</p>\n\n<pre><code>sprintf( target, \"%s%s\", \"0\", inputstr );\n</code></pre>\n\n<p>or you can use a combination of <code>strcpy</code> and <code>strcat</code> (or <code>strncpy</code> and <code>strncat</code> for the paranoid in the room):</p>\n\n<pre><code>strcpy( target, \"0\" ); \nstrcat( target, inputstr );\n</code></pre>\n\n<p>Be aware of the potential for buffer overflow with either method.  Make sure that your target buffer is large enough for the final string.  Using <code>strcpy</code> and <code>strcat</code> is risky, but using <code>strncpy</code> and <code>strncat</code> in their place isn't a guarantee of success either.  </p>\n\n<p>You could also allocate the buffer dynamically:</p>\n\n<pre><code>char *target = calloc( targetBufferLength, sizeof *target );\n</code></pre>\n\n<p>The advantage of this is that you can resize the buffer as necessary if it\nisn't big enough:</p>\n\n<pre><code>if ( strlen( target ) + strlen( newStr ) &gt; targetBufferLength )\n{\n  char *tmp = realloc( target, (targetBufferLength + strlen( newStr ) + 1) * sizeof *target );\n  if ( tmp )\n  {\n    target = tmp;\n    targetBufferLength += strlen( newStr ) + 1;\n    strcat( target, newStr );\n  }\n  else\n  {\n    // could not extend target buffer, don't append\n  }\n}\n</code></pre>\n\n<p>The disadvantage is that you now have memory management issues, and you have to remember to <code>free</code> the buffer when you're done with it.  </p>\n"}], "owner": {"reputation": 1, "user_id": 8348863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb618824a933d025dce9542754767717?s=128&d=identicon&r=PG&f=1", "display_name": "Roops", "link": "https://stackoverflow.com/users/8348863/roops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1504107301, "creation_date": 1504104173, "last_edit_date": 1504106251, "question_id": 45963408, "link": "https://stackoverflow.com/questions/45963408/string-concatenation-in-c", "title": "String concatenation in c", "body": "<p>I have a variable called  <code>char *inputstr</code>, if the string length given to variable is a an odd number, I need to insert a \"0\" at the beginning of the string variable <code>inputstr</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>char *inputstr = \"1ABc2\" . \n</code></pre>\n\n<p>Now I need to append \"0\" and make it \"01ABc2\".  How do I achieve this? </p>\n\n<pre><code>char a[2] = \"0\";\nchar *inputstr = \"1ABc2\";\n\nif( strlen (inputstr) % 2 == 0)\n{\n  strcat (a, inputstr);\n  strcpy (inputstr, a);\n}\n\nif( condition)\n{\n  Using inputstr variable // here string value is along with         junk characters\n} \n</code></pre>\n"}, {"tags": ["c", "toggle", "bit-shift"], "comments": [{"owner": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "edited": false, "score": 0, "creation_date": 1504103534, "post_id": 45963133, "comment_id": 78884979, "body": "Are you looking for binary and? (<code>22 &amp; 16 == 16</code>)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504103690, "post_id": 45963133, "comment_id": 78885103, "body": "So you want to keep the highest bit that is 1 and set all the other ones to zero? Examples: 1010 -&gt; 1000, 10100111 -&gt; 100000000, 111 -&gt; 100 etc. There is no such inbuilt function, but you can easily write one yourself (estimated 4-5 lines)."}, {"owner": {"reputation": 45, "user_id": 5708039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374a4995ea834057f72a7e12c25e7307?s=128&d=identicon&r=PG&f=1", "display_name": "user5708039", "link": "https://stackoverflow.com/users/5708039/user5708039"}, "reply_to_user": {"reputation": 9055, "user_id": 996081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/83817dc1e83cf8ac372b21cd5f010bc4?s=128&d=identicon&r=PG&f=1", "display_name": "cbr", "link": "https://stackoverflow.com/users/996081/cbr"}, "edited": false, "score": 0, "creation_date": 1504103758, "post_id": 45963133, "comment_id": 78885157, "body": "@cubrr If I already have value 16 then what is the use of doing AND here. example if the input is 86 then its 2nd operand I need to calculate and that is my aim."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504103823, "post_id": 45963133, "comment_id": 78885208, "body": "Maybe a duplicate of <a href=\"https://stackoverflow.com/questions/53161/find-the-highest-order-bit-in-c\" title=\"find the highest order bit in c\">stackoverflow.com/questions/53161/&hellip;</a>"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504106387, "post_id": 45963133, "comment_id": 78887184, "body": "@MichaelWalz, yeah, some answers match perfectly this question (even if the original wording of the question is different)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504106406, "post_id": 45963133, "comment_id": 78887191, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/53161/find-the-highest-order-bit-in-c\">Find the highest order bit in C</a>"}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 1, "last_activity_date": 1504103841, "creation_date": 1504103841, "answer_id": 45963285, "question_id": 45963133, "link": "https://stackoverflow.com/questions/45963133/toggle-high-bit-to-1-and-rest-bits-to-0-example-10110-to-10000/45963285#45963285", "title": "Toggle high bit to 1 and rest bits to 0 [example: 10110 to 10000]", "body": "<p>you could compute the position of the highest bit</p>\n\n<p>Once you have it, just shift left to get the proper mask value:</p>\n\n<pre><code>   unsigned int x = 22;\n   int result = 0;\n\n   if (x != 0)\n   {\n     unsigned int y = x;\n     int bit_pos=-1;\n     while (y != 0)\n     {\n       y &gt;&gt;= 1;\n       bit_pos++;\n     }\n     result = 1&lt;&lt;bit_pos;\n   }\n</code></pre>\n\n<p>this sets <code>result</code> to <code>16</code></p>\n\n<p>(there's a particular case if entered value is <code>0</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1504108465, "post_id": 45963366, "comment_id": 78888511, "body": "This doesn&#39;t work if the top bit of the input is set, e.g. <code>floor_align32pow2(0x80000000)</code> will return 0 instead of 0x80000000. You can fix it with <code>return (x &gt;&gt; 1) + (x &amp; 1);</code>."}], "tags": [], "owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "is_accepted": false, "score": 0, "last_activity_date": 1504109510, "last_edit_date": 1504109510, "creation_date": 1504104063, "answer_id": 45963366, "question_id": 45963133, "link": "https://stackoverflow.com/questions/45963133/toggle-high-bit-to-1-and-rest-bits-to-0-example-10110-to-10000/45963366#45963366", "title": "Toggle high bit to 1 and rest bits to 0 [example: 10110 to 10000]", "body": "<p>Basically, you need to floor align to the nearest power of two number. I am not sure there is a standard function for that, but try the following:</p>\n\n<pre><code>static inline uint32_t\nfloor_align32pow2(uint32_t x)\n{\n        x |= x &gt;&gt; 1;\n        x |= x &gt;&gt; 2;\n        x |= x &gt;&gt; 4;\n        x |= x &gt;&gt; 8;\n        x |= x &gt;&gt; 16;\n\n        return (x &gt;&gt; 1) + (x &amp; 1);\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5708039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374a4995ea834057f72a7e12c25e7307?s=128&d=identicon&r=PG&f=1", "display_name": "user5708039", "link": "https://stackoverflow.com/users/5708039/user5708039"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 45963285, "answer_count": 2, "score": 2, "last_activity_date": 1504109510, "creation_date": 1504103388, "last_edit_date": 1504106513, "question_id": 45963133, "link": "https://stackoverflow.com/questions/45963133/toggle-high-bit-to-1-and-rest-bits-to-0-example-10110-to-10000", "title": "Toggle high bit to 1 and rest bits to 0 [example: 10110 to 10000]", "body": "<p>I need to find out the mask value with respect to the number provided by the user.</p>\n\n<p>For example. If user provides input as </p>\n\n<blockquote>\n  <p>22 (in binary 10110)</p>\n</blockquote>\n\n<p>and then I need to find the mask value by changing the high bit of the input as <code>1</code> and rest to <code>0</code>.\nSo in this case it should be:</p>\n\n<blockquote>\n  <p>16 (in binary 10000)</p>\n</blockquote>\n\n<p>Is there any inbuilt method in <code>c</code> language to do so.</p>\n"}, {"tags": ["c", "for-loop"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1504103301, "post_id": 45962994, "comment_id": 78884808, "body": "Please show the very first lines of output, I suspect that we will see 1,2,4,8,16,32,64,128,0,0,0,0,0,..."}, {"owner": {"reputation": 3538, "user_id": 2464381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/N8MjC.png?s=128&g=1", "display_name": "shrewmouse", "link": "https://stackoverflow.com/users/2464381/shrewmouse"}, "edited": false, "score": 0, "creation_date": 1504103371, "post_id": 45962994, "comment_id": 78884866, "body": "Works fine for me"}, {"owner": {"reputation": 3538, "user_id": 2464381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/N8MjC.png?s=128&g=1", "display_name": "shrewmouse", "link": "https://stackoverflow.com/users/2464381/shrewmouse"}, "edited": false, "score": 1, "creation_date": 1504103439, "post_id": 45962994, "comment_id": 78884904, "body": "What is MAX_BIT_VALUE defined as?"}, {"owner": {"reputation": 74, "user_id": 4274749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SwiB1.jpg?s=128&g=1", "display_name": "solomonbstoner", "link": "https://stackoverflow.com/users/4274749/solomonbstoner"}, "reply_to_user": {"reputation": 3538, "user_id": 2464381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/N8MjC.png?s=128&g=1", "display_name": "shrewmouse", "link": "https://stackoverflow.com/users/2464381/shrewmouse"}, "edited": false, "score": 0, "creation_date": 1504103488, "post_id": 45962994, "comment_id": 78884935, "body": "@Shrewmouse #define MAX_BIT_VALUE 65536"}, {"owner": {"reputation": 3538, "user_id": 2464381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/N8MjC.png?s=128&g=1", "display_name": "shrewmouse", "link": "https://stackoverflow.com/users/2464381/shrewmouse"}, "edited": false, "score": 0, "creation_date": 1504103825, "post_id": 45962994, "comment_id": 78885211, "body": "See my answer, uint8_t is not big enough to store 255.  when 128*=2, i get&#39;s truncated to 0 and never leaves the for loop because 0 &lt; MAX_BIT_VALUE is always true and 0*=2 will always be 0."}, {"owner": {"reputation": 3538, "user_id": 2464381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/N8MjC.png?s=128&g=1", "display_name": "shrewmouse", "link": "https://stackoverflow.com/users/2464381/shrewmouse"}, "edited": false, "score": 0, "creation_date": 1504103902, "post_id": 45962994, "comment_id": 78885270, "body": "sorry I meant that you don&#39;t have enough bits to represent 256"}], "answers": [{"comments": [{"owner": {"reputation": 74, "user_id": 4274749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SwiB1.jpg?s=128&g=1", "display_name": "solomonbstoner", "link": "https://stackoverflow.com/users/4274749/solomonbstoner"}, "edited": false, "score": 0, "creation_date": 1504103252, "post_id": 45963045, "comment_id": 78884760, "body": "I removed the #, and the results are still the same."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1504103811, "last_edit_date": 1504103811, "creation_date": 1504103140, "answer_id": 45963045, "question_id": 45962994, "link": "https://stackoverflow.com/questions/45962994/why-does-multiplying-uint8-t-with-an-integer-result-in-a-0/45963045#45963045", "title": "Why does multiplying uint8_t with an integer result in a 0?", "body": "<p>Your code causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>The flag value <code>#</code> is not supposed to be used with <code>u</code> conversion specifier.</p>\n\n<p>Quoting <code>C11</code>,chapter \u00a77.21.6.1</p>\n\n<blockquote>\n  <p><code>#</code> The result is converted to an \u2018\u2018alternative form\u2019\u2019. For <code>o</code> conversion, it increases\n  the precision, if and only if necessary, to force the first digit of the result to be a\n  zero (if the value and precision are both 0, a single 0 is printed). For <code>x</code> (or <code>X</code>)\n  conversion, a nonzero result has <code>0x</code> (or <code>0X</code>) prefixed to it. For <code>a</code>, <code>A</code>, <code>e</code>, <code>E</code>, <code>f</code>, <code>F</code>, <code>g</code>,\n  and <code>G</code> conversions, the result of converting a floating-point number always\n  contains a decimal-point character, even if no digits follow it. (Normally, a\n  decimal-point character appears in the result of these conversions only if a digit\n  follows it.) For <code>g</code> and <code>G</code> conversions, trailing zeros are not removed from the\n  result. <strong>For other conversions, the behavior is undefined.</strong></p>\n</blockquote>\n\n<p>For fixed width integers use the format specifier MACROS as defined in <code>inttypes.h</code>, like <code>PRIu8</code> for a 8-bit unsigned integer type.</p>\n\n<hr>\n\n<p>After you fix this the next problem is, overflow of the 8-bit variable. As <a href=\"https://stackoverflow.com/a/45963180/2173917\">described in the other answer by <strong>Yunnosch</strong></a> Once <code>i</code> becomes <code>128</code>, you multiple it by 2, and store the result back in the 8-bit variable, the result is  <code>0</code>. Then, </p>\n\n<ul>\n<li>0  multiplied by anything remains 0</li>\n<li>which constitutes a forever TRUE condition in the <code>for</code> loop, <code>i &lt; MAX_BIT_VALUE</code> part.</li>\n</ul>\n\n<p>and you get the infinite loop.</p>\n"}, {"tags": [], "owner": {"reputation": 6709, "user_id": 7969900, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FRmSKJ3-SLE/AAAAAAAAAAI/AAAAAAAAR3I/9HHcvlfBbNg/photo.jpg?sz=128", "display_name": "Andriy Berestovskyy", "link": "https://stackoverflow.com/users/7969900/andriy-berestovskyy"}, "is_accepted": false, "score": 1, "last_activity_date": 1504103318, "creation_date": 1504103318, "answer_id": 45963110, "question_id": 45962994, "link": "https://stackoverflow.com/questions/45962994/why-does-multiplying-uint8-t-with-an-integer-result-in-a-0/45963110#45963110", "title": "Why does multiplying uint8_t with an integer result in a 0?", "body": "<p>Change the printf format string from:</p>\n\n<blockquote>\n  <p>printf(\"Current value of i: %#u\\n\", i);</p>\n</blockquote>\n\n<p>to</p>\n\n<blockquote>\n  <p>printf(\"Current value of i: %\"PRIu8\"\\n\", i);</p>\n</blockquote>\n\n<p>and it should be fine. The PRIu8 macro is defined in inttypes.h</p>\n"}, {"comments": [{"owner": {"reputation": 74, "user_id": 4274749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SwiB1.jpg?s=128&g=1", "display_name": "solomonbstoner", "link": "https://stackoverflow.com/users/4274749/solomonbstoner"}, "edited": false, "score": 0, "creation_date": 1504103700, "post_id": 45963180, "comment_id": 78885108, "body": "Integer overflow! Why didn&#39;t I think of that! You&#39;re a genius Yunnosch. Thank you! :D"}, {"owner": {"reputation": 74, "user_id": 4274749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SwiB1.jpg?s=128&g=1", "display_name": "solomonbstoner", "link": "https://stackoverflow.com/users/4274749/solomonbstoner"}, "edited": false, "score": 0, "creation_date": 1504103756, "post_id": 45963180, "comment_id": 78885156, "body": "I changed uint8_t to uint32_t, and it worked perfectly"}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 4, "last_activity_date": 1504103493, "creation_date": 1504103493, "answer_id": 45963180, "question_id": 45962994, "link": "https://stackoverflow.com/questions/45962994/why-does-multiplying-uint8-t-with-an-integer-result-in-a-0/45963180#45963180", "title": "Why does multiplying uint8_t with an integer result in a 0?", "body": "<p>Apart from what the other answer recommend on the printing, you have the following problem:</p>\n\n<ul>\n<li>multipy i==128 by 2</li>\n<li>result 256</li>\n<li>storing it 256 (0x100) in an unsigned 8bit results in 0,<br>\nbecause 8 bit are to narrow</li>\n<li>multiply 0 by 2</li>\n<li>result 0</li>\n<li>0 &lt; 255 -> endless loop</li>\n</ul>\n"}], "owner": {"reputation": 74, "user_id": 4274749, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SwiB1.jpg?s=128&g=1", "display_name": "solomonbstoner", "link": "https://stackoverflow.com/users/4274749/solomonbstoner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1431, "favorite_count": 0, "accepted_answer_id": 45963180, "answer_count": 3, "score": 1, "last_activity_date": 1504103938, "creation_date": 1504102985, "last_edit_date": 1504103938, "question_id": 45962994, "link": "https://stackoverflow.com/questions/45962994/why-does-multiplying-uint8-t-with-an-integer-result-in-a-0", "title": "Why does multiplying uint8_t with an integer result in a 0?", "body": "<p>I tried to code a program, but i'm having problems with 1 small segment.</p>\n\n<pre><code>for(uint8_t i = 1; i &lt; MAX_BIT_VALUE; i*=2){\n            printf(\"Current value of i: %u\\n\", i);\n}\n</code></pre>\n\n<p>When I run this segment, I get this output:</p>\n\n<blockquote>\n  <p>Current value of i: 0</p>\n  \n  <p>Current value of i: 0</p>\n  \n  <p>Current value of i: 0</p>\n  \n  <p>Current value of i: 0</p>\n</blockquote>\n\n<p>in an infinite loop. I don't understand why. <code>uint8_t</code> is an unsigned integer of 8-bits. I merely multiplied <code>i</code> which has value 1 by 2. How could it possibly become 0?</p>\n\n<p>If i changed the data type of <code>i</code> to <code>int</code> however, it works just fine:</p>\n\n<blockquote>\n  <p>Current value of i: 1</p>\n  \n  <p>Current value of i: 2</p>\n  \n  <p>Current value of i: 4</p>\n  \n  <p>Current value of i: 8</p>\n  \n  <p>Current value of i: 16</p>\n</blockquote>\n\n<p>...</p>\n\n<p>I tried to find a possible answer online, but I don't know how to phrase the problem to get an answer. Could you guys help me please?</p>\n"}, {"tags": ["c", "scanf", "newline", "enter", "hit"], "comments": [{"owner": {"reputation": 215, "user_id": 4402533, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh6.googleusercontent.com/-relZttXASy8/AAAAAAAAAAI/AAAAAAAAAAA/k2Rz4TVka3w/photo.jpg?sz=128", "display_name": "Pramod Yadav", "link": "https://stackoverflow.com/users/4402533/pramod-yadav"}, "edited": false, "score": 0, "creation_date": 1504104494, "post_id": 45962978, "comment_id": 78885696, "body": "which compiler you are using"}, {"owner": {"reputation": 29, "user_id": 7989752, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/305472693222038/picture?type=large", "display_name": "Ya\u011f\u0131z Ozan Dikba\u015f", "link": "https://stackoverflow.com/users/7989752/ya%c4%9f%c4%b1z-ozan-dikba%c5%9f"}, "reply_to_user": {"reputation": 215, "user_id": 4402533, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh6.googleusercontent.com/-relZttXASy8/AAAAAAAAAAI/AAAAAAAAAAA/k2Rz4TVka3w/photo.jpg?sz=128", "display_name": "Pramod Yadav", "link": "https://stackoverflow.com/users/4402533/pramod-yadav"}, "edited": false, "score": 0, "creation_date": 1504104532, "post_id": 45962978, "comment_id": 78885730, "body": "visual studio 2017"}, {"owner": {"reputation": 215, "user_id": 4402533, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh6.googleusercontent.com/-relZttXASy8/AAAAAAAAAAI/AAAAAAAAAAA/k2Rz4TVka3w/photo.jpg?sz=128", "display_name": "Pramod Yadav", "link": "https://stackoverflow.com/users/4402533/pramod-yadav"}, "edited": false, "score": 0, "creation_date": 1504105978, "post_id": 45962978, "comment_id": 78886902, "body": "Please visit both of these link, you will an idea how to proceed  <a href=\"https://stackoverflow.com/questions/7170021/how-could-i-achieve-gotoxy-in-gcc\" title=\"how could i achieve gotoxy in gcc\">stackoverflow.com/questions/7170021/&hellip;</a>  <a href=\"https://stackoverflow.com/questions/13706439/gotoxy-function-is-not-working-in-visual-studio\" title=\"gotoxy function is not working in visual studio\">stackoverflow.com/questions/13706439/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 232, "user_id": 3810906, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/bfQ60.jpg?s=128&g=1", "display_name": "Husso", "link": "https://stackoverflow.com/users/3810906/husso"}, "is_accepted": true, "score": 3, "last_activity_date": 1504106521, "creation_date": 1504106521, "answer_id": 45964245, "question_id": 45962978, "link": "https://stackoverflow.com/questions/45962978/scanf-without-newline-c-programming/45964245#45964245", "title": "scanf without newline (C programming)", "body": "<p>You're not using scanf() properly. The function scanf() takes in user input and then stores it in a variable, and in your case that would be the variable 'age'. After that you can place the variable age in the printf() statement like this.</p>\n\n<pre><code>scanf(\"%d\", &amp;age);\nprintf(\"I am %d years old.\", age);\n</code></pre>\n\n<p>That code will first wait for the user to enter an age then it would print the sentence:</p>\n\n<blockquote>\n  <p>I am X years old.</p>\n</blockquote>\n\n<p>The reason your screen is displaying your output on two lines is because the, \"scanf(\"%d\", &amp;age);\" requires you to hit enter after you type in a number (which creates a new line) in order for \"printf(\" years old\");\" to execute. Also, when you are hitting enter in your code, the number being stored in the variable 'age' isn't doing anything. You're just storing it for no reason.</p>\n"}], "owner": {"reputation": 29, "user_id": 7989752, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/305472693222038/picture?type=large", "display_name": "Ya\u011f\u0131z Ozan Dikba\u015f", "link": "https://stackoverflow.com/users/7989752/ya%c4%9f%c4%b1z-ozan-dikba%c5%9f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2780, "favorite_count": 0, "accepted_answer_id": 45964245, "answer_count": 1, "score": 0, "last_activity_date": 1585839740, "creation_date": 1504102934, "last_edit_date": 1585839740, "question_id": 45962978, "link": "https://stackoverflow.com/questions/45962978/scanf-without-newline-c-programming", "title": "scanf without newline (C programming)", "body": "<p>I dont want to newline after scanf.</p>\n\n<pre><code>printf(\"I am  \");\n    scanf(\"%d\", &amp;age);\n    printf(\" years old\");   \n</code></pre>\n\n<p>This output is;</p>\n\n<pre><code> I am 19\nyears old.\n</code></pre>\n\n<p>But i want to like this:</p>\n\n<pre><code>I am 19 years old.\n</code></pre>\n"}, {"tags": ["c", "ipc", "mkfifo"], "answers": [{"comments": [{"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1504103968, "post_id": 45963178, "comment_id": 78885322, "body": "i did not really read the code since the OP&#39;s only asking about the compilation error and how to get a <code>FILE *</code>. :)"}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1504104994, "post_id": 45963178, "comment_id": 78886090, "body": "@whjm I am not implying your answer was wrong. In fact your up vote is mine."}, {"owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "edited": false, "score": 0, "creation_date": 1504105258, "post_id": 45963178, "comment_id": 78886331, "body": "i also changed the subject and removed tags <code>ipc</code> and <code>mkinfo</code>. just rolled back. :)"}], "tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": false, "score": 1, "last_activity_date": 1504103487, "creation_date": 1504103487, "answer_id": 45963178, "question_id": 45962906, "link": "https://stackoverflow.com/questions/45962906/mkfifo-make-2-processes-talk-to-each-other/45963178#45963178", "title": "mkfifo make 2 processes talk to each other", "body": "<p>The answer from whjm is the cause of your error diagnostic, but I think you probably meant </p>\n\n<pre><code>fgets(buffer, BUFFER_SIZE, stdin)\n//                         ^^^^^ \n</code></pre>\n\n<p>It doesn't make sense that you would read from a pipe and then immediately write the same thing back to the pipe. Also, if you never read from <code>stdin</code>, <code>feof(stdin)</code> will never be true.</p>\n\n<p>Also, with fgets just check for a null result and then outside the loop, do the check for eof:</p>\n\n<pre><code>while (fgets(...) != NULL)\n{\n    ...\n}\nif (!feof(stdin))\n{\n    // error handling\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7617, "user_id": 2878070, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/42b5fba5761d7e519d05b642be0b2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio", "link": "https://stackoverflow.com/users/2878070/sergio"}, "is_accepted": true, "score": 0, "last_activity_date": 1504103961, "last_edit_date": 1504103961, "creation_date": 1504103579, "answer_id": 45963203, "question_id": 45962906, "link": "https://stackoverflow.com/questions/45962906/mkfifo-make-2-processes-talk-to-each-other/45963203#45963203", "title": "mkfifo make 2 processes talk to each other", "body": "<p><code>mkfifo()</code> just creates special node in filesystem. And you are free to open it in any way. Actually there are two alternatives - POSIX \"non-buffered\" I/O: <code>open()/write()/read()</code> or standard buffered I/O: <code>fopen()/fread()/fwrite()</code>. First family operates on file descriptors while second one uses so called file streams: <code>FILE</code>. You can not mix these APIs freely. Just choose one and stick to it.\nStandard I/O library offers some useful extra capabilities comparing to low-level non-buffered I/O. Like <code>fgets()</code> that you're trying to use. In this situation would be reasonable to use standard streams and replace <code>open()</code> with:</p>\n\n<pre><code>FILE* stream = fopen(FIFO_PATH, \"r+\");\n</code></pre>\n\n<p>Thus program will use <code>FILE*</code> instead of plain file descriptors. Also <code>write()</code> need to be changed to <code>fwrite()</code> immediately followed by <code>fflush()</code> to guarantee that written data are passed to FIFO.</p>\n\n<p>P.S. In case of necessity it is possible to \"wrap\" low-level descriptors returned by <code>open()</code>(or something other) with standard <code>FILE*</code>. See <a href=\"http://man7.org/linux/man-pages/man3/fdopen.3p.html\" rel=\"nofollow noreferrer\"><code>fdopen()</code></a>. But it is much like a workaround to use standard I/O API with special file objects that can not be opened with <code>fopen()</code>.</p>\n"}], "owner": {"reputation": 285, "user_id": 7449638, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c9a765971a8fb15188f388ad772d9bad?s=128&d=identicon&r=PG&f=1", "display_name": "Hana", "link": "https://stackoverflow.com/users/7449638/hana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 45963203, "answer_count": 2, "score": 0, "last_activity_date": 1504106860, "creation_date": 1504102695, "last_edit_date": 1504106860, "question_id": 45962906, "link": "https://stackoverflow.com/questions/45962906/mkfifo-make-2-processes-talk-to-each-other", "title": "mkfifo make 2 processes talk to each other", "body": "<p>I am trying to write 2 programs that will talk to each other using fifo pipe.\nI used the example <a href=\"http://beej.us/guide/bgipc/output/html/singlepage/bgipc.html#fork\" rel=\"nofollow noreferrer\">here</a> (section 5.2), but I changed the mknod there to mkfifo and tried to change gets to fgets.\nThis is the code (of one program which writes into the fifo):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt; /*mkfifo, open */\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/stat.h&gt; /* mkfifo, open */\n#include &lt;fcntl.h&gt; /*open */\n\n#define FIFO_PATH \"/home/hana/Desktop\"\n#define BUFFER_SIZE 300\n\n\n\nint main()\n{\n    char buffer[BUFFER_SIZE];\n    int fd;\n    int wStatus;\n\n    mkfifo(FIFO_PATH, 666);\n    printf(\"waiting for readers\\n\");\n    fd = open(FIFO_PATH, O_RDWR);\n\n    while (fgets(buffer, BUFFER_SIZE, fd), !feof(stdin)) \n    {\n        if ((wStatus = write(fd, buffer, strlen(buffer))) == -1)\n            perror(\"write\");\n        else\n            printf(\"speak: wrote %d bytes\\n\", wStatus);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I get a compilation error: passing argument 3 of fgets makes pointer from integer.\nSo fgets is expecting FILE* and not file descriptor.\nWhat should I do? change something so that fgets works? use another function? </p>\n\n<p>I am compiling with gcc (ansi, pedantic).</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 4, "creation_date": 1504100017, "post_id": 45961847, "comment_id": 78882117, "body": "1. Why are you trying to do this? I think that I don&#39;t really understand what is it that you actually want to achieve."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1504100027, "post_id": 45961847, "comment_id": 78882123, "body": "The major problem is that you seem to think Pascal-like string would be compatible with C strings (pointers to <code>char</code>, or arrays of <code>char</code>), which it can&#39;t really be naturally. What is the problem using Pascal-like string would solve? Why do you want to use them?"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1504100480, "post_id": 45961847, "comment_id": 78882518, "body": "At the very least, the strings should keep a NUL terminator, so reducing their max length to 254 chars. At least then you could use them as const arguments by passing  [address+1]."}, {"owner": {"reputation": 33, "user_id": 8532252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8c5c5b2fe55f13bf9f9cf5b1d49033?s=128&d=identicon&r=PG&f=1", "display_name": "Tajen", "link": "https://stackoverflow.com/users/8532252/tajen"}, "edited": false, "score": 0, "creation_date": 1504102676, "post_id": 45961847, "comment_id": 78884292, "body": "I need to communicate with a system that uses Pascal like strings, that is the only reason for using it.  It is also just for making the code easier to understand. Right now a have to have a function to initialize some variables and for const I need something like <code>const char string[30] = &quot;\\004test&quot;;</code>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1504105663, "post_id": 45961847, "comment_id": 78886657, "body": "Hmm.. I think I would have gone for a &#39;PasStr&#39; type and  &#39;CtoPasStr()&#39; and PasToCstr() style &#39;conversion&#39; functions, even if that requires malloc/free-style string memory management to avoid 1-byte overruns and the like."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8532252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8c5c5b2fe55f13bf9f9cf5b1d49033?s=128&d=identicon&r=PG&f=1", "display_name": "Tajen", "link": "https://stackoverflow.com/users/8532252/tajen"}, "edited": false, "score": 0, "creation_date": 1504103846, "post_id": 45962608, "comment_id": 78885229, "body": "Good idea. But i cannot have a <code>extern PASCAL_STRING_TYPE(30) some_string;</code> because the compiler sees it as to different declarations which it thinks are incompatible. But for statics it works as I need."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 33, "user_id": 8532252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8c5c5b2fe55f13bf9f9cf5b1d49033?s=128&d=identicon&r=PG&f=1", "display_name": "Tajen", "link": "https://stackoverflow.com/users/8532252/tajen"}, "edited": false, "score": 0, "creation_date": 1504104416, "post_id": 45962608, "comment_id": 78885629, "body": "True, but you could do <code>typedef PASCAL_STRING_TYPE(30) pstr30;</code> and <code>extern pstr30 some_string;</code>."}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 0, "last_activity_date": 1504101860, "creation_date": 1504101860, "answer_id": 45962608, "question_id": 45961847, "link": "https://stackoverflow.com/questions/45961847/c-macro-to-convert-a-string-to-a-pascal-string-type/45962608#45962608", "title": "C Macro to convert a string to a pascal string type", "body": "<p>You could split the macro into two:</p>\n\n<pre><code>#define PASCAL_STRING_TYPE(size) struct { unsigned char len; char content[(size) - 1]; }\n#define PASCAL_STRING_INIT(str) { .len = sizeof(str) - 1, .content = (str) }\n</code></pre>\n\n<p>Then use it like so:</p>\n\n<pre><code>static const PASCAL_STRING_TYPE(100) foo = PASCAL_STRING_INIT(\"foo\");\n\nstruct bar {\n   int answer;\n   PASCAL_STRING_TYPE(100) question;\n};\nstatic const struct bar quux = {\n    .answer = 42,\n    .question = PASCAL_STRING_INIT(\"The Answer\")\n};\n</code></pre>\n\n<p>(Not tested.)</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504117790, "post_id": 45966153, "comment_id": 78893884, "body": "To be useful in C, even a Pascal-type string needs to store a null terminator so it can be passed to functions that expect C strings, not Pascal strings.  Things like system calls, for example (<code>open()</code>, et al) demand it.  The majority of the C library expects C strings.  Having to copy the Pascal string to create a C string would be unnecessarily heavy-duty work.  You don&#39;t have to account for the null in the length byte (it&#39;s simply there; the length simply records the number of characters up to the null).  You do (IMNSHO) have to add it.  Knowing the length has important advantages."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504118380, "post_id": 45966153, "comment_id": 78894230, "body": "@JonathanLeffler Fair enough.  OP did comment &quot;I need to communicate with a system that uses Pascal like strings&quot; so this code does that.  I suspect OP needs some p-string constants. Had OP requested an object that worked both like a Pascal-like string and a C string, your idea is certainly valuable with the more flexible object. Note that conversion from C string to a common pascal_and_C like string incurs additional memory management issues not needed with only a pure C to/from pascal conversion."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1504162091, "post_id": 45966153, "comment_id": 78908437, "body": "I don&#39;t get the point of <code>sizeof(X)-!!sizeof(X)</code>. If <code>X</code> is a string literal, <code>sizeof(X)</code> will be at least 1 (even if <code>X</code> is <code>&quot;&quot;</code>), so <code>!!sizeof(X)</code> will always be 1. But that means that if <code>X</code> is <code>&quot;&quot;</code>, then the array will be declared as <code>s[0]</code>, which is not valid (although gcc accepts it)."}, {"owner": {"reputation": 33, "user_id": 8532252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8c5c5b2fe55f13bf9f9cf5b1d49033?s=128&d=identicon&r=PG&f=1", "display_name": "Tajen", "link": "https://stackoverflow.com/users/8532252/tajen"}, "edited": false, "score": 0, "creation_date": 1504162948, "post_id": 45966153, "comment_id": 78908924, "body": "I think it works as needed, but my compiler only support C89 and C99, and as I understand generics was introduced in C11. Correct me if i&#39;m wrong. But anyway, it does not work with my compiler."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1504184329, "post_id": 45966153, "comment_id": 78923504, "body": "@rici Agreed that <code>sizeof(X)-1</code> is sufficient.  The <code>!!sizeof(X)</code> was an effect of how code was developed."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 33, "user_id": 8532252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8c5c5b2fe55f13bf9f9cf5b1d49033?s=128&d=identicon&r=PG&f=1", "display_name": "Tajen", "link": "https://stackoverflow.com/users/8532252/tajen"}, "edited": false, "score": 0, "creation_date": 1504184455, "post_id": 45966153, "comment_id": 78923599, "body": "@Tajen Important information that would limit answers like &quot;unable to use a compiler that conforms to the current standard and need a C.xxx solution&quot; should be part of the post."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1504184256, "last_edit_date": 1504184256, "creation_date": 1504112947, "answer_id": 45966153, "question_id": 45961847, "link": "https://stackoverflow.com/questions/45961847/c-macro-to-convert-a-string-to-a-pascal-string-type/45966153#45966153", "title": "C Macro to convert a string to a pascal string type", "body": "<blockquote>\n  <p>to convert a string to a pascal string type</p>\n</blockquote>\n\n<p>To convert a <em>string literal</em>, <code>_Generic</code> and <em>compound literal</em> will get close to OP objective.</p>\n\n<p>For a better solution, more details and example use cases would help illustrate OP's goal.</p>\n\n<pre><code>#define P_STRING_CONV(X) _Generic((X)+0, \\\n  char *: &amp;((struct {char len; char s[sizeof(X)-1]; }){ (char)(sizeof(X)-1), (X) }).len \\\n  )\n\nvoid dump(const char *s) {\n  unsigned length = (unsigned char) *s++;\n  printf(\"L:%u \\\"\", length);\n  while (length--) {\n    printf(\"%c\", *s++);\n  }\n  printf(\"\\\"\\n\");\n}\n\nint main(void) {\n  dump(P_STRING_CONV(\"\"));\n  dump(P_STRING_CONV(\"A\"));\n  dump(P_STRING_CONV(\"AB\"));\n  dump(P_STRING_CONV(\"ABC\"));\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>L:0 \"\"\nL:1 \"A\"\nL:2 \"AB\"\nL:3 \"ABC\"\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://stackoverflow.com/questions/45961847/c-macro-to-convert-a-string-to-a-pascal-string-type/45966153?noredirect=1#comment78893884_45966153\">@Jonathan Leffler</a> recommended that the created pascal-like string also contain a terminating <em>null character</em>.  To do so with above code, simple change <code>sizeof(X)-1</code> into <code>sizeof(X)</code>.  Then by accessing the <code>pascal_like_string + 1</code>, code has a pointer to a valid C string.</p>\n\n<hr>\n\n<p><code>(X)+0</code> converts an array type to a pointer</p>\n\n<p><code>sizeof(X)-!!sizeof(X)</code> produces a size of the string literal, not counting its \\0.  At least 1.</p>\n\n<p><code>struct {char len; char s[sizeof(X)-!!sizeof(X)]; }</code> Is a right-sized pascal-like structure.</p>\n\n<p><code>(struct {char len; char s[sizeof(X)-!!sizeof(X)]; }){ (char)(sizeof(X)-1), (X) }</code> is a <em>compound literal</em>.</p>\n\n<hr>\n\n<p>The following will convert a C <em>string</em> to a pascal like string.  Note that as a pascal like string, there is no <code>'\\0'</code>.</p>\n\n<pre><code>#include &lt;limits.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nchar *pstring_convert(char *s) {\n  size_t len = strlen(s);\n  assert(len &lt;= UCHAR_MAX);\n  memmove(s+1, s, len);\n  s[0] = (char) (unsigned char) len;\n  return s;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8532252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc8c5c5b2fe55f13bf9f9cf5b1d49033?s=128&d=identicon&r=PG&f=1", "display_name": "Tajen", "link": "https://stackoverflow.com/users/8532252/tajen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 45962608, "answer_count": 2, "score": 1, "last_activity_date": 1504184256, "creation_date": 1504099858, "question_id": 45961847, "link": "https://stackoverflow.com/questions/45961847/c-macro-to-convert-a-string-to-a-pascal-string-type", "title": "C Macro to convert a string to a pascal string type", "body": "<p>I would like some ideas for a macro to convert a preprocessor defined string to a pascal type string and then be able to use the macro to initialize const char arrays and the like. </p>\n\n<p>Something like this would be great:</p>\n\n<pre><code>#define P_STRING_CONV(str) ...???...\n\nconst char *string = P_STRING_CONV(\"some string\");\n\nstruct\n{\n    char str[30];\n    ...\n}some_struct = {.str = P_STRING_CONV(\"some_other_string\")};\n</code></pre>\n\n<p>I already tried something like this:</p>\n\n<pre><code>#define DEFINE_PASCAL_STRING(var, str, strlen) struct {uint8_t len; char content[strlen-1];} (var) = {sizeof(str)-1, (str)}\n</code></pre>\n\n<p>(The strlen parameter could be removed, but I need a defined size.)</p>\n\n<p>That works fine, but cannot be used to initialize elements in a struct. And for const char arrays I need to cast it to some other variable.</p>\n\n<p>Any great ideas?</p>\n"}, {"tags": ["c", "linux", "setuid", "sysfs"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1504098930, "post_id": 45960961, "comment_id": 78881209, "body": "This works as expected for me.  Try checking the return value of <code>fscanf</code>, and if it equals <code>EOF</code> then call <code>perror</code> to tell you why it failed.  You should also do error checking on the <code>fopen</code> calls as well."}, {"owner": {"reputation": 692, "user_id": 2737696, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ec50c6bbe7ed72e2a56ea6f7cccee5df?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Merlini", "link": "https://stackoverflow.com/users/2737696/marco-merlini"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1504099716, "post_id": 45960961, "comment_id": 78881871, "body": "@dbush I have <code>perror</code> all over my actual code (I didn&#39;t clutter my original post with them). All calls returned success."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 0, "creation_date": 1504099795, "post_id": 45960961, "comment_id": 78881956, "body": "It&#39;s a while since I&#39;ve played with SUID-bits and the like, but would <code>seteuid()</code> (set effective user id) do what you want? With the binary&#39;s setuid bit set, I <i>think</i> you can toggle between the real (unprivileged) user and the owner (suid) user."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1504100928, "post_id": 45960961, "comment_id": 78882881, "body": "This is the sort of issue that is addressed very well in the design of <a href=\"https://en.wikipedia.org/wiki/Vsftpd\" rel=\"nofollow noreferrer\">vsftpd</a> (<a href=\"https://youtu.be/ZgtBJuqd4WU?t=5m38s\" rel=\"nofollow noreferrer\">see this video for an overview</a>). Basically, if a program has root privileges, then it shouldn&#39;t interact directly with untrusted clients at all. Instead, delegate all client interaction to separate child process with lower privileges, and use <a href=\"https://en.wikipedia.org/wiki/Inter-process_communication\" rel=\"nofollow noreferrer\">IPC</a> to convey this interaction in a carefully controlled manner."}, {"owner": {"reputation": 692, "user_id": 2737696, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ec50c6bbe7ed72e2a56ea6f7cccee5df?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Merlini", "link": "https://stackoverflow.com/users/2737696/marco-merlini"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1504102899, "post_id": 45960961, "comment_id": 78884450, "body": "@squeamishossifrage Thank you for pointing this out. This looks like a clean solution to these kinds of problems"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504103007, "post_id": 45960961, "comment_id": 78884549, "body": "Normally (with a regular disk file, for example), permissions are checked when the file is opened, and thereafter the permissions are not checked again.  That means you normally can open the file with elevated privileges, drop the privileges, and continue reading merrily.  It would be a bit surprising if a file system type didn&#39;t obey those semantics; it subverts a careful design decision in UNIX.  However, your problem is not &quot;continuous access&quot; to a file, but repeatedly opening and closing a file.  Permissions are checked by open; you need permission (elevated privileges) for each open."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1504124513, "post_id": 45960961, "comment_id": 78897381, "body": "The correct solution to the underlying problem is to set an udev rule that enables access to the gpio pseudofiles to a suitable group (<code>gpio</code> is common), and then add the users who are allowed to fiddle with the gpio pins to that group. For the rule itself, look at e.g. the final post in <a href=\"https://www.raspberrypi.org/forums/viewtopic.php?p=198148\" rel=\"nofollow noreferrer\">this discussion</a> at Raspberry Pi forums -- should be two rules, two lines; haven&#39;t tested it myself, though. This way, your program does not need to be setuid/setgid at all, nor care about the permissions."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1504138845, "post_id": 45960961, "comment_id": 78901968, "body": "Mahkoe&gt; I second NominalAnimal on that: the proper way to do what you want is not to require admin permissions, it&#39;s to fix device permissions to grant access to whom needs it."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1504141804, "post_id": 45960961, "comment_id": 78902486, "body": "@Mahkoe&gt; out of curiosity, can you run an <code>strace</code> of the non-working version and post the result somewhere? You need to attach the running process otherwise the SUID won&#39;t work: 1) add a <code>sleep(60)</code> at the start of your program. 2) run it and find its PID. 3) run <code>strace -p pid</code> in another console. When the program comes out of sleep, you should see the trace appear."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504099413, "post_id": 45961396, "comment_id": 78881635, "body": "Can you do some research, I personally don&#39;t like <i>&quot;if your system behaves like mine&quot;</i>, that&#39;s not a robust solution."}, {"owner": {"reputation": 692, "user_id": 2737696, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ec50c6bbe7ed72e2a56ea6f7cccee5df?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Merlini", "link": "https://stackoverflow.com/users/2737696/marco-merlini"}, "edited": false, "score": 0, "creation_date": 1504099586, "post_id": 45961396, "comment_id": 78881779, "body": "I can confirm that this solution works on my system! (For prosperity, note that the sysfs file handle needs to be <code>fflush()</code>ed and <code>rewind()</code>ed for your program to track the current contents of the file. Otherwise, it will buffer the old value in the file). By the way, does anyone know why permissions for streams and file handles are treated differently?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 692, "user_id": 2737696, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ec50c6bbe7ed72e2a56ea6f7cccee5df?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Merlini", "link": "https://stackoverflow.com/users/2737696/marco-merlini"}, "edited": false, "score": 0, "creation_date": 1504099749, "post_id": 45961396, "comment_id": 78881902, "body": "@Mahkoe That&#39;s the interesting question now. I suppose, that streams can close the descriptor and reopen it if needed, so it might be related to that. But I don&#39;t know if the standard requires implementations not to do this. Remember that <code>fflush()</code> is needed because streams are buffered by default whereas if you use file descriptors directly, you don&#39;t need to flush anything unless you buffer something yourself."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1504103477, "post_id": 45961396, "comment_id": 78884925, "body": "Streams or handles know nothing about permissions. Permissions are set on a <i>file</i> and govern your ability to open it (i.e. create a handle). A stream is typically a thin wrapper around a handle. Your explanation sounds rather suspicious."}, {"owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "edited": false, "score": 1, "creation_date": 1504105783, "post_id": 45961396, "comment_id": 78886761, "body": "I was interested enough in the question to spend ten minutes checking it out on my laptop. I posted what I found in the hope that it would be helpful to somebody. If anybody wants me to carry out an exhaustive survey of the differences between handles and streams across a range of platforms, compilers, and libraries, my rate for consultancy is &#163;150 per hour plus VAT :)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504108065, "post_id": 45961396, "comment_id": 78888284, "body": "There&#39;s no need to survey compilers an libraaries, it&#39;s enough to open POSIX documentation and read (or, for an expensive consultant like yourself, just recite off the top of your head :D). <code>fread</code> sets a completely different range of <code>errno</code> statuses from <code>fopen</code>. There&#39;s no way to report an error when a stream is closed and reopened out of the blue. Thus your alledged license to do so is rather unlikely."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "edited": false, "score": 0, "creation_date": 1504141366, "post_id": 45961396, "comment_id": 78902389, "body": "I will go even further: the FILE structure as defined and used internally by glibc, which is the only full, widely used implementation of libc working on Linux kernels, does not store the path used to open the file, so without going further, it&#39;s certain it cannot <code>open()</code> it again once <code>fopen</code> has returned. Whatever is happening on OP&#39;s system, the alleged explanation is simply impossible."}], "tags": [], "owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "is_accepted": true, "score": 0, "last_activity_date": 1504099440, "last_edit_date": 1504099440, "creation_date": 1504098652, "answer_id": 45961396, "question_id": 45960961, "link": "https://stackoverflow.com/questions/45960961/open-a-file-as-root-but-drop-privileges-before-reading-from-it/45961396#45961396", "title": "Open a file as root, but drop privileges before reading from it?", "body": "<p>I haven't tried this with <code>/sysfs</code>, but even with plain files my understanding is that file <em>streams</em> do not retain access permissions after a call to <code>setuid()</code>. File <em>handles</em> do, however, for reasons I don't understand. So, if your system behaves like mine (Fedora 20 on x64) you might be able to use <code>open()</code>/<code>read()</code> instead of <code>fopen()</code>/<code>fscanf()</code>. </p>\n"}], "owner": {"reputation": 692, "user_id": 2737696, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ec50c6bbe7ed72e2a56ea6f7cccee5df?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Merlini", "link": "https://stackoverflow.com/users/2737696/marco-merlini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1286, "favorite_count": 1, "accepted_answer_id": 45961396, "answer_count": 1, "score": 4, "last_activity_date": 1504099440, "creation_date": 1504097474, "question_id": 45960961, "link": "https://stackoverflow.com/questions/45960961/open-a-file-as-root-but-drop-privileges-before-reading-from-it", "title": "Open a file as root, but drop privileges before reading from it?", "body": "<h2>TL;DR</h2>\n\n<p>I am writing a C program. I need to have root privileges to <code>fopen</code> a sysfs file, and I still need root privileges in order to read from it. However, since my program will need to continuously read the sysfs file, this implies that it will need to have elevated privileges the whole time. I would like to drop root privilege as soon as possible. What's the accepted way of approaching this problem?</p>\n\n<h2>Details</h2>\n\n<p>I am writing a program that interacts with sysfs. If I was running the commands on the shell, I would use:</p>\n\n<pre><code>myuser@mymachine:~$ sudo su\nroot@mymachine:/home/myhomedir# cd /sys/class/gpio\nroot@mymachine:/sys/class/gpio# echo 971 &gt; export\nroot@mymachine:/sys/class/gpio# cat gpio971/value\n0\nroot@mymachine:/sys/class/gpio# exit\n</code></pre>\n\n<p>I need to run these commands in a C program that is callable by a non-privileged user. One way to do this is to write the program in the usual way using <code>fopen</code>, <code>fprintf</code>, <code>fscanf</code>, etc and have the user run the program through <code>sudo</code>. However, this means the user needs to be a sudoer, and the program will have root privilege the whole time.</p>\n\n<p>Another solution, which I strongly prefer (since the user will not have to be added to sudoers) is to change the program's owner to root, and set the <code>setuid</code> bit. (I learned this from <a href=\"https://www.osso.nl/blog/setuid-seteuid-uid-euid/\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>However, there's something I'm wondering about. What I would like to do is open the sysfs files while the program's <code>euid</code> is 0, but then drop all privileges right away (for safety). Then, now that the file has been opened, we simply <code>setuid()</code> to the user's UID. However, although I can't be entirely sure, this isn't working. Here is the relevant part of my code:</p>\n\n<pre><code>//At this point, due to the file permissions on the executable,\n//euid = 0 and ruid = 1000. I know the following 4 lines work.\nFILE *export = fopen(\"/sys/class/gpio/export\", \"wb\");\nfprintf(export, \"971\\n\");\nfclose(export);\n\nFILE *sw_gpio = fopen(\"/sys/class/gpio971/value\", \"rb\");\n\nsetuid(1000);\n//Now euid = 1000 and ruid = 1000\n\nint switch_val = -1;\nfscanf(sw_gpio, \"%d\", &amp;switch_val);\nprintf(\"Switch value: %d\\n\", switch_val); //-1\n//Even though the only possible values in this sysfs file are 0 and 1,\n//switch_val is still equal to -1\n\nfclose(sw_gpio);\n</code></pre>\n\n<p>So it seems that I will need to keep elevated permissions to be able to read from <code>/sys/class/gpio/gpio971/value</code>. But this is exactly what I <em>don't</em> want! This program will need to poll the value throughout execution of the program, and I don't want root privileges the whole time. </p>\n\n<p>Finally for the sake of completion, here are the permissions I've set on my executable:</p>\n\n<pre><code>-rwsr-xr-x 1 root myuser 10943 Jan 1 20:17 main*\n</code></pre>\n\n<p>So how does one drop root privilege, but continue to read from an access-controlled sysfs file?</p>\n"}, {"tags": ["c", "arrays", "dynamic", "dynamic-allocation"], "comments": [{"owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 0, "creation_date": 1504096451, "post_id": 45960484, "comment_id": 78879182, "body": "And the line you paste does not work? It should."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504097774, "post_id": 45960484, "comment_id": 78880186, "body": "like <a href=\"https://ideone.com/Sp6Pdo\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1504097842, "post_id": 45960484, "comment_id": 78880242, "body": "I wrote an answer, while it got closed. In short: you can use <code>char (*buffer)[numRow][20] = malloc(sizeof(char[numCol][numRow][20]));</code>."}, {"owner": {"reputation": 3831, "user_id": 1306959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9177b14b30f517bbfd8061ee7d4dc578?s=128&d=identicon&r=PG", "display_name": "Alex North-Keys", "link": "https://stackoverflow.com/users/1306959/alex-north-keys"}, "edited": false, "score": 0, "creation_date": 1504561083, "post_id": 45960484, "comment_id": 79048674, "body": "Starting with an example for a 2D (x,y) grid of ints , (1) allocate a chunk of memory for all the cells themselves as int (so sizeof(int) * x * y).  (2) Allocate a chunk of memory for pointers (int *) to every Yth cell (3) Use the address of that 2nd chunk (which is an int **) as addr[x][y].   Once that makes sense, extend to 3D, which will have a third layer of pointers and be an (int ***)."}, {"owner": {"reputation": 3831, "user_id": 1306959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9177b14b30f517bbfd8061ee7d4dc578?s=128&d=identicon&r=PG", "display_name": "Alex North-Keys", "link": "https://stackoverflow.com/users/1306959/alex-north-keys"}, "edited": false, "score": 0, "creation_date": 1504561546, "post_id": 45960484, "comment_id": 79048807, "body": "Free()ing that would take several free()s - if that bothers you, combine everything into the first malloc()ed chunk, but be careful to keep pointers and ints at proper alignments.  Malloc by default will align chunks this way, but being too clever can put your pointers at, say, not-multiple-of-8-byte alignment or something.  Much like trying to access integers at odd-addresses tending to instantly crash programs on many architectures."}], "owner": {"user_type": "does_not_exist", "display_name": "user8506163"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "closed_date": 1504096470, "answer_count": 0, "score": 1, "last_activity_date": 1504097367, "creation_date": 1504096226, "question_id": 45960484, "link": "https://stackoverflow.com/questions/45960484/dynamic-allocation-of-a-3d-array-in-c", "closed_reason": "Duplicate", "title": "Dynamic Allocation of a 3d Array in C", "body": "<p>I am trying to dynamically allocate memory for a 3d character array I am calling </p>\n\n<pre><code>buffer\n</code></pre>\n\n<p>As it is right now, my code looks like:</p>\n\n<pre><code>char buffer[50][50][20]\n</code></pre>\n\n<p>Eventually I will need to work with over thousands of spots in this array based on the number of rows and number of columns being read through a CSV file. I save those variables as:</p>\n\n<pre><code>numCol;\nnumRow;\n</code></pre>\n\n<p>My program finds these perfectly through a function and returns them back to main() where I want to use them to create my 'buffer'.</p>\n\n<p>How do I allocate space using malloc(), or other means, to create a buffer that takes the form:</p>\n\n<pre><code> char buffer[numCol][numRow][20]. \n</code></pre>\n\n<p>The 20 can stay because that is what I define as the maximum number of characters in a CSV cell. </p>\n"}, {"tags": ["c", "math"], "comments": [{"owner": {"reputation": 802, "user_id": 7141618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jfdgN.jpg?s=128&g=1", "display_name": "Louis-Roch Tessier", "link": "https://stackoverflow.com/users/7141618/louis-roch-tessier"}, "edited": false, "score": 0, "creation_date": 1504095672, "post_id": 45960102, "comment_id": 78878541, "body": "try to add more details, using spam to fill in words is a bad practice"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1504157616, "post_id": 45960102, "comment_id": 78906480, "body": "<a href=\"https://stackoverflow.com/q/9704195/995714\">Why pow(10,5) = 9,999</a>, <a href=\"https://stackoverflow.com/q/32353301/995714\">Will (int)pow(n,m) be wrong for some positive integers n,m?</a>, <a href=\"https://stackoverflow.com/q/7937286/995714\">return value of pow() gets rounded down if assigned to an integer</a>"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1520071729, "post_id": 45960102, "comment_id": 85171191, "body": "the general solution is to round the results to the nearest integer"}, {"owner": {"reputation": 325, "user_id": 8491106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eca94ca8c2dac509cc91c20958867aa?s=128&d=identicon&r=PG&f=1", "display_name": "userA789", "link": "https://stackoverflow.com/users/8491106/usera789"}, "edited": false, "score": 0, "creation_date": 1520072140, "post_id": 45960102, "comment_id": 85171296, "body": "I edit it to correct my wrong word-use."}], "answers": [{"comments": [{"owner": {"reputation": 743, "user_id": 2913477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b126939c105b8d71b18f93c6850e55f1?s=128&d=identicon&r=PG&f=1", "display_name": "MiniMax", "link": "https://stackoverflow.com/users/2913477/minimax"}, "edited": false, "score": 1, "creation_date": 1504127594, "post_id": 45960231, "comment_id": 78898817, "body": "I am interested, why then this code work in my case - Ubuntu 16.04, <code>gcc version 5.4.0</code>?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 743, "user_id": 2913477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b126939c105b8d71b18f93c6850e55f1?s=128&d=identicon&r=PG&f=1", "display_name": "MiniMax", "link": "https://stackoverflow.com/users/2913477/minimax"}, "edited": false, "score": 0, "creation_date": 1504127669, "post_id": 45960231, "comment_id": 78898861, "body": "this code works for me too (gcc 6.1). But it depends on the FPU and on the math library. It&#39;s better <i>not</i> to depend on it and use strictly integer arithmetic. thanks for your comment. I have updated the answer."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 3, "last_activity_date": 1504127731, "last_edit_date": 1504127731, "creation_date": 1504095503, "answer_id": 45960231, "question_id": 45960102, "link": "https://stackoverflow.com/questions/45960102/inaccurate-calculation-caused-by-inaccurate-data-type-use/45960231#45960231", "title": "inaccurate calculation caused by inaccurate data type use", "body": "<p><code>pow</code> (in <code>pow(tem,numl)</code>) is a floating point function. It means that it returns a <code>double</code>, bound to floating point inaccuracy and rounding (if <code>pow</code> returns <code>124.999999</code> it has no impact for floating point computation, but it does when assigned to an integer because of truncation)</p>\n\n<p>So relying on the return value of <code>pow</code> may work, or may not (depends on the values, the FPU, the compiler math libraries). And the fact that \"sometimes it issue a slightly off value\" is a giveaway for that floating point inaccuracy issue.</p>\n\n<p>Since you're working exclusively with integers, I would use integer exponentiation instead, either with a simple loop or with more complex algorithms (<a href=\"https://stackoverflow.com/questions/101439/the-most-efficient-way-to-implement-an-integer-based-power-function-powint-int\">The most efficient way to implement an integer based power function pow(int, int)</a>)</p>\n"}], "owner": {"reputation": 325, "user_id": 8491106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eca94ca8c2dac509cc91c20958867aa?s=128&d=identicon&r=PG&f=1", "display_name": "userA789", "link": "https://stackoverflow.com/users/8491106/usera789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "closed_date": 1520072052, "accepted_answer_id": 45960231, "answer_count": 1, "score": 2, "last_activity_date": 1520071096, "creation_date": 1504095094, "last_edit_date": 1520071096, "question_id": 45960102, "link": "https://stackoverflow.com/questions/45960102/inaccurate-calculation-caused-by-inaccurate-data-type-use", "closed_reason": "Duplicate", "title": "inaccurate calculation caused by inaccurate data type use", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n\nint main(){\n  int num,onum,numl=0,tem,nnum=0;    \n\n  printf(\"Enter num: \");\n  scanf(\"%d\", &amp;num);\n\n  onum =num;\n\n  while (num!=0){\n    num = num/10;\n    ++numl;\n  }\n  num = onum;\n\n  while (num!=0){\n    tem = num%10;\n\n    nnum += pow(tem,numl);\n    printf(\"%d\",nnum);\n    num /= 10    ;\n  }\n\n  if (nnum == onum){\n    printf(\"is\");\n  }\n  else{\n    printf(\"not\");\n  }\n}\n</code></pre>\n\n<p>works fine with other Narcissistic numbers .</p>\n\n<p>but when input 153 , 5**3 is mistakenly counted to 124, why?\n<a href=\"https://i.stack.imgur.com/B9O0O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B9O0O.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>This question is duplicate of <a href=\"https://stackoverflow.com/a/32356961/8491106\">many questions</a>. And the answer below is the most easy-to-understand anwer.</p>\n\n<p>In one sentence, the inaccurate calculation is caused by {inaccurate {data type usage} or {compiler} or {FPU} }.</p>\n\n<p>I <strong>avoided</strong> the error by updating my compiler to gcc 7.2 . But <strong>solving</strong> the problem needs a pow function for integer.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 6, "creation_date": 1504094402, "post_id": 45959827, "comment_id": 78877560, "body": "<code>while(temp) { temp = temp % 10; ...}</code> will never finish unless temp is divisible by 10."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1504094451, "post_id": 45959827, "comment_id": 78877584, "body": "What is this program supposed to do? <code>printf(&quot;sum is %d\\n&quot;);</code> is wrong, you probably meant <code>printf(&quot;sum is %d\\n&quot;, sum);</code>. And please format your program correctly"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1504094524, "post_id": 45959827, "comment_id": 78877644, "body": "Why do you think it is <code>scanf</code> that is causing your problem. How did you verify that it does not return after you entered the number?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1504094544, "post_id": 45959827, "comment_id": 78877664, "body": "maybe you mean <code>temp = temp &#47; 10</code>"}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1504095431, "post_id": 45959827, "comment_id": 78878338, "body": "&quot;As soon as <code>scanf</code> statement starts to execute it goes on again and again and program is stuck at entering inputs continuously&quot;-- <code>scanf()</code> is not in a loop, is only called once. It is not possible for this code to get &quot;stuck at entering inputs continuously.&quot; Is the posted code the actual code that has problems?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504096138, "post_id": 45959827, "comment_id": 78878940, "body": "How do you even know your call to <code>scanf()</code> worked?"}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 1, "last_activity_date": 1504095004, "last_edit_date": 1504095004, "creation_date": 1504094702, "answer_id": 45959975, "question_id": 45959827, "link": "https://stackoverflow.com/questions/45959827/scanf-continuously-executing-not-letting-statement-after-it-to-execute/45959975#45959975", "title": "scanf continuously executing, not letting statement after it to execute", "body": "<p>I suppose your program is supposed to compute the cross sum of the number entered.</p>\n\n<p>So you probably want this:</p>\n\n<pre><code>int main() {\n  int number, factor = 1, temp, sum = 0;\n  scanf(\"%d\", &amp;number);\n  temp = number;\n\n  while (temp) {\n    temp = temp / 10;\n    factor = factor * 10;\n  };\n  while (factor &gt; 1) {\n    factor = factor / 10;\n    sum += (number / factor);\n    number = number % factor;\n  };\n  printf(\"sum is %d\\n\", sum);\n}\n</code></pre>\n\n<p>There are two problems in your code:</p>\n\n<ol>\n<li><code>temp = temp % 10</code> ->  <code>temp = temp / 10</code>. <code>%</code> is the \"modulo\" operator, you need the \"division\" operator</li>\n<li><code>printf(\"sum is %d\\n\")</code> -> <code>printf(\"sum is %d\\n\", sum)</code></li>\n</ol>\n\n<p>So the problem was totally unrelated to <code>scanf</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 8318999, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Sk02RUNUBA/AAAAAAAAAAI/AAAAAAAAAII/O5cr1QuzI2c/photo.jpg?sz=128", "display_name": "Ryuzaki ", "link": "https://stackoverflow.com/users/8318999/ryuzaki"}, "edited": false, "score": 0, "creation_date": 1504095640, "post_id": 45960098, "comment_id": 78878513, "body": "Fixing temp/10 from %10 fixed problem but why was command line taking input continuously before fixing? Was it random behaviour due to infinite loop?"}, {"owner": {"reputation": 470, "user_id": 7158019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oDjwz.png?s=128&g=1", "display_name": "ytobi", "link": "https://stackoverflow.com/users/7158019/ytobi"}, "reply_to_user": {"reputation": 17, "user_id": 8318999, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Sk02RUNUBA/AAAAAAAAAAI/AAAAAAAAAII/O5cr1QuzI2c/photo.jpg?sz=128", "display_name": "Ryuzaki ", "link": "https://stackoverflow.com/users/8318999/ryuzaki"}, "edited": false, "score": 1, "creation_date": 1504095684, "post_id": 45960098, "comment_id": 78878553, "body": "@Ryuzaki it wasn&#39;t, you just thought it was."}, {"owner": {"reputation": 8442, "user_id": 1600649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f9d7a6e96cc2059f50999840eccbb9?s=128&d=identicon&r=PG", "display_name": "Melvyn", "link": "https://stackoverflow.com/users/1600649/melvyn"}, "reply_to_user": {"reputation": 17, "user_id": 8318999, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Sk02RUNUBA/AAAAAAAAAAI/AAAAAAAAAII/O5cr1QuzI2c/photo.jpg?sz=128", "display_name": "Ryuzaki ", "link": "https://stackoverflow.com/users/8318999/ryuzaki"}, "edited": false, "score": 1, "creation_date": 1504096075, "post_id": 45960098, "comment_id": 78878882, "body": "@Ryuzaki You can type anything during execution of any program. That doesn&#39;t mean the program is reading it. It means the shell is showing you what you type and if the program does not consume it, the shell will execute that next."}], "tags": [], "owner": {"reputation": 470, "user_id": 7158019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oDjwz.png?s=128&g=1", "display_name": "ytobi", "link": "https://stackoverflow.com/users/7158019/ytobi"}, "is_accepted": false, "score": 0, "last_activity_date": 1504095737, "last_edit_date": 1504095737, "creation_date": 1504095089, "answer_id": 45960098, "question_id": 45959827, "link": "https://stackoverflow.com/questions/45959827/scanf-continuously-executing-not-letting-statement-after-it-to-execute/45960098#45960098", "title": "scanf continuously executing, not letting statement after it to execute", "body": "<pre><code>temp = temp % 10;\n</code></pre>\n\n<p>Is the remainder when temp is divided by 10, except for numbers ending with 0 or multiple of 10, temp will never be 0 , hence <code>while( temp )</code> is an infinite loop. <code>scanf</code> read once.</p>\n"}], "owner": {"reputation": 17, "user_id": 8318999, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--Sk02RUNUBA/AAAAAAAAAAI/AAAAAAAAAII/O5cr1QuzI2c/photo.jpg?sz=128", "display_name": "Ryuzaki ", "link": "https://stackoverflow.com/users/8318999/ryuzaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 45959975, "answer_count": 2, "score": 0, "last_activity_date": 1504096178, "creation_date": 1504094280, "last_edit_date": 1504096178, "question_id": 45959827, "link": "https://stackoverflow.com/questions/45959827/scanf-continuously-executing-not-letting-statement-after-it-to-execute", "title": "scanf continuously executing, not letting statement after it to execute", "body": "<pre><code>int main() {\n  int number, factor = 1, temp, sum = 0;\n  scanf (\"%d\", &amp;number);\n  temp = number;\n\n  while(temp) {\n    temp = temp % 10;\n    factor = factor *10;\n  };\n  while(factor &gt; 1) {\n    factor = factor / 10;\n    sum += (number / factor);\n    number = number % factor;\n  };\n  printf(\"sum is %d\\n\");\n}\n</code></pre>\n\n<p>Every time I execute program, as soon as scanf statement starts to execute it goes on again and again and program is stuck at entering inputs continuously.</p>\n"}, {"tags": ["c++", "c", "linux", "gcc", "ld"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1504093460, "post_id": 45959487, "comment_id": 78876887, "body": "How do you build your program? How do you link with the library? Please edit your question to include the actual commands used."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 3, "creation_date": 1504093893, "post_id": 45959487, "comment_id": 78877173, "body": "The &quot;corrupt header&quot; looks like a normal shared library while the &quot;good header&quot; is an executable. How did you link that?"}, {"owner": {"reputation": 3634, "user_id": 783000, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4f8aa4cb9e75d158cb423b4134c46087?s=128&d=identicon&r=PG", "display_name": "Alexander Thei&#223;en", "link": "https://stackoverflow.com/users/783000/alexander-thei%c3%9fen"}, "edited": false, "score": 0, "creation_date": 1504094815, "post_id": 45959487, "comment_id": 78877868, "body": "You are so right. I accidentally linked the executable with &quot;-shared&quot; to counter another error I had. My bad :("}], "owner": {"reputation": 3634, "user_id": 783000, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/4f8aa4cb9e75d158cb423b4134c46087?s=128&d=identicon&r=PG", "display_name": "Alexander Thei&#223;en", "link": "https://stackoverflow.com/users/783000/alexander-thei%c3%9fen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504093358, "creation_date": 1504093358, "question_id": 45959487, "link": "https://stackoverflow.com/questions/45959487/linking-against-library-corrupts-elf-program-headers", "title": "Linking against library corrupts ELF program headers", "body": "<p>I am trying to link my C++ executable against a shared C library (also written by me / my colleagues). </p>\n\n<p>The C++ executable just contains a main that prints \"Hello World\" to stdout and returns 0.</p>\n\n<p>It runs fine. But as soon as I dynamic link against my C library (I am not even calling into this lib) my C++ executable fails at startup:</p>\n\n<pre><code>/opt/av-server # strace ./program \nexecve(\"./program\", [\"./program\"], [/* 10 vars */]) = 0\n--- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=NULL} ---\n+++ killed by SIGSEGV +++\nSegmentation fault\n</code></pre>\n\n<p>I did some research and found out that as soon as I link against the C library my ELF header starts looking very strange. The entry point address is suspiciously low and the addresses of the first LOAD are all zero:</p>\n\n<h2>Corrupt Header</h2>\n\n<pre><code>Elf file type is DYN (Shared object file)\nEntry point 0x6d8\nThere are 6 program headers, starting at offset 52\n\nProgram Headers:\n  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align\n  EXIDX          0x000960 0x00000960 0x00000960 0x00010 0x00010 R   0x4\n  LOAD           0x000000 0x00000000 0x00000000 0x00974 0x00974 R E 0x10000\n  LOAD           0x000ee0 0x00010ee0 0x00010ee0 0x0015c 0x00164 RW  0x10000\n  DYNAMIC        0x000ef0 0x00010ef0 0x00010ef0 0x00110 0x00110 RW  0x4\n  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RW  0x10\n  GNU_RELRO      0x000ee0 0x00010ee0 0x00010ee0 0x00120 0x00120 R   0x1\n\n Section to Segment mapping:\n  Segment Sections...\n   00     .ARM.exidx \n   01     .hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .plt .text .fini .rodata .ARM.extab .ARM.exidx .eh_frame \n   02     .init_array .fini_array .jcr .dynamic .got .data .bss \n   03     .dynamic \n   04     \n   05     .init_array .fini_array .jcr .dynamic \n</code></pre>\n\n<p>I guess this explains why the program is segfaulting: It jumps to 0 :/ As comparison this is the header that is generated when I don't link against the lib:</p>\n\n<h2>Good Header</h2>\n\n<pre><code>Elf file type is EXEC (Executable file)\nEntry point 0x10588\nThere are 9 program headers, starting at offset 52\n\nProgram Headers:\n  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align\n  EXIDX          0x0007fc 0x000107fc 0x000107fc 0x00018 0x00018 R   0x4\n  PHDR           0x000034 0x00010034 0x00010034 0x00120 0x00120 R E 0x4\n  INTERP         0x000154 0x00010154 0x00010154 0x00013 0x00013 R   0x1\n      [Requesting program interpreter: /lib/ld-linux.so.3]\n  LOAD           0x000000 0x00010000 0x00010000 0x00818 0x00818 R E 0x10000\n  LOAD           0x000ef0 0x00020ef0 0x00020ef0 0x00148 0x001dc RW  0x10000\n  DYNAMIC        0x000f00 0x00020f00 0x00020f00 0x00100 0x00100 RW  0x4\n  NOTE           0x000168 0x00010168 0x00010168 0x00020 0x00020 R   0x4\n  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RW  0x10\n  GNU_RELRO      0x000ef0 0x00020ef0 0x00020ef0 0x00110 0x00110 R   0x1\n\n Section to Segment mapping:\n  Segment Sections...\n   00     .ARM.exidx \n   01     \n   02     .interp \n   03     .interp .note.ABI-tag .hash .dynsym .dynstr .gnu.version .gnu.version_r .rel.dyn .rel.plt .init .plt .text .fini .rodata .ARM.extab .ARM.exidx .eh_frame \n   04     .init_array .fini_array .jcr .dynamic .got .data .bss \n   05     .dynamic \n   06     .note.ABI-tag \n   07     \n   08     .init_array .fini_array .jcr .dynamic \n</code></pre>\n\n<p>I understand why it must segfault. But the real question is: <strong>What inside the C library could possibly be responsible for corrupting the ELF header in that way?</strong> </p>\n\n<p>I want to know that to look for. My suspicion is that somewhere in the lib some compiler intrinsics are used that go wrong. Just a wild guess.</p>\n\n<p>I cross compile for <code>Linux bha-1CCAE370CE47 3.4.35 #1 Thu Mar 9 11:20:13 HKT 2017 armv5tejl GNU/Linux</code> with a GCC6.3. The toolchain was build with crosstool-ng. Build system is macOS.</p>\n"}, {"tags": ["c", "input", "scanf"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 3, "creation_date": 1504092763, "post_id": 45959265, "comment_id": 78876420, "body": "Basically to read one line you read character by character until you encounter a <code>\\n</code>. But <i>why</i>  do you need to use <code>read</code> ?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504092908, "post_id": 45959265, "comment_id": 78876535, "body": "<code>read(0, buf, sizeof(buf));</code> I hope you&#39;re not expecting <code>buf</code> to contain a string after that."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1504093002, "post_id": 45959265, "comment_id": 78876604, "body": "Don&#39;t use <code>recv</code> as a variable name, it confused me because <a href=\"http://man7.org/linux/man-pages/man2/recv.2.html\" rel=\"nofollow noreferrer\">recv()</a> is a POSIX function."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504093006, "post_id": 45959265, "comment_id": 78876606, "body": "The <code>m</code> prefix in the <code>&quot;%ms&quot;</code> format is an <i>extension</i>, it&#39;s not part of the <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\">standard <code>scanf</code></a>. As such you should really try to avoid it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6872156"}, "edited": false, "score": 1, "creation_date": 1504093075, "post_id": 45959265, "comment_id": 78876647, "body": "I use <code>read</code> because of implementations limits. And yes, the input is only one line and <code>read</code> would automatically stop when it reaches <code>\\n</code> - this is by design. But how should <code>read()</code> gets its parameters in case I defined <code>recv</code> as: <code>char *recv; </code>, because <code>reads</code> gets length which is unknown for me."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1504093139, "post_id": 45959265, "comment_id": 78876683, "body": "Did you conisder reading a fragment of size 128 into a 128 buffer, then find out whether there is more and read more in the next buffer?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1504093173, "post_id": 45959265, "comment_id": 78876704, "body": "If you don&#39;t know the length you might be reading, then there are two options: Either you read and allocate dynamically one character at a time, reallocating as needed; Or you have an array long enough to hold the maximum length of a line, and still read one character at a time."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 2, "creation_date": 1504093232, "post_id": 45959265, "comment_id": 78876732, "body": "BTW: <code>read()</code> returns a value. Use it!"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1504093236, "post_id": 45959265, "comment_id": 78876735, "body": "By the way, <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf</code></a> with the <code>&quot;%s&quot;</code> format stops at <i>any</i> whitespace, not just newlines. If you want to read a line and automatically allocate memory, then I suggest <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline</code></a> instead."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1504093314, "post_id": 45959265, "comment_id": 78876792, "body": "Use a buffer. Read into the buffer. If you haven&#39;t read to the end of the line, realloc the buffer to be larger, keep reading until you get a short read, or you&#39;ve read past the newline. Future reads need to remember that you could have still things to read in the buffer. This is what <code>scanf</code> and family do internally."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1504093337, "post_id": 45959265, "comment_id": 78876812, "body": "Lastly a little bit of a nitpicking... While <code>0</code> is known to be standard input, using <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"nofollow noreferrer\"><i>magic numbers</i></a> is considered bad. On a POSIX system use <code>STDIN_FILENO</code> instead."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504109057, "post_id": 45959265, "comment_id": 78888904, "body": "Is &quot;arbitrary size&quot; means the line could be any length like 100, 1 million, or 1 trillion?  To prevent hacker abuse, setting a sane upper limit is wise."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1504093298, "post_id": 45959460, "comment_id": 78876782, "body": "This is rather a comment than an answer. And he states he wants to use <code>read</code>."}], "tags": [], "owner": {"reputation": 368, "user_id": 6881977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0663020762d0aad2f05fa7d9ea13c06f?s=128&d=identicon&r=PG&f=1", "display_name": "suraj", "link": "https://stackoverflow.com/users/6881977/suraj"}, "is_accepted": false, "score": -3, "last_activity_date": 1504093629, "last_edit_date": 1504093629, "creation_date": 1504093281, "answer_id": 45959460, "question_id": 45959265, "link": "https://stackoverflow.com/questions/45959265/how-to-use-read-to-get-input-of-unknown-length-from-stdin/45959460#45959460", "title": "How to use read() to get input of unknown length from stdin", "body": "<p>one way is run a loop with getchar() function and keep rading the characters into an array. check the array size with each iteration ,Once the array is full, reallocate it to a larger size. OR use the The getline() function.\nlink for <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\">getline()</a> </p>\n\n<p>Check the below programme . </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void) {\n    char *lines = NULL;\n    size_t n = 0;\n    ssize_t res = getline(&amp;line, &amp;n, stdin);\n    free(line);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 808, "user_id": 8337524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ac561fede109198df9538fac22f346?s=128&d=identicon&r=PG&f=1", "display_name": "ninjin", "link": "https://stackoverflow.com/users/8337524/ninjin"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1504175161, "post_id": 45960168, "comment_id": 78917114, "body": "@wildplasser thank you. Trying to improve myself here on stack overflow. Is it better now?"}], "tags": [], "owner": {"reputation": 808, "user_id": 8337524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ac561fede109198df9538fac22f346?s=128&d=identicon&r=PG&f=1", "display_name": "ninjin", "link": "https://stackoverflow.com/users/8337524/ninjin"}, "is_accepted": false, "score": 1, "last_activity_date": 1504175037, "last_edit_date": 1504175037, "creation_date": 1504095317, "answer_id": 45960168, "question_id": 45959265, "link": "https://stackoverflow.com/questions/45959265/how-to-use-read-to-get-input-of-unknown-length-from-stdin/45960168#45960168", "title": "How to use read() to get input of unknown length from stdin", "body": "<p>The function <code>read</code> returns the number of read bytes. You can take advantage of this information and loop until you read 0 bytes, that is, <code>read</code> returns 0.</p>\n\n<pre><code>char buf[BUF_SIZE]; // Set BUF_SIZE to the maximum number of character you expect to read (e.g. 1000 or 10000 or more).\nint bytes_to_read, total_read_bytes, read_bytes;\n\n// Number of bytes to read at each iteration of the loop.\nbytes_to_read = 128;\n\n// The following variable counts the number of total read bytes. \ntotal_read_bytes = 0;\n\nwhile ((read_bytes = read(0, buf + total_read_bytes, bytes_to_read) != 0) {\n\n    if (read_bytes &lt; 0) {\n        // read() may return -1. You can look at the variable errno to\n        // have more details about the cause of the error.\n        return -1;\n    }\n\n    total_read_bytes += read_bytes;\n}\n</code></pre>\n\n<p>Notice that <code>read</code> does <strong>not</strong> automatically append the null terminator <code>\\0</code> to <code>buf</code>, that is, <code>buf</code> is not a string until you explicitly add <code>\\0</code> at the end of it.</p>\n\n<pre><code>...\n// Making buf a string.\nbuf[total_read_bytes] = '\\0';\n...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6872156"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 837, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1504175037, "creation_date": 1504092686, "last_edit_date": 1504093104, "question_id": 45959265, "link": "https://stackoverflow.com/questions/45959265/how-to-use-read-to-get-input-of-unknown-length-from-stdin", "title": "How to use read() to get input of unknown length from stdin", "body": "<p>Until now, whenever I wanted to get user input from <em>stdin</em> I used <code>scanf()</code> but this time I can't and <strong>have</strong> to use <code>read()</code>.</p>\n\n<p>Usually, to get input from <em>stdin</em> using <code>read</code> I use:  </p>\n\n<pre><code>char buf[128];\nread(0, buf, sizeof(buf));\n</code></pre>\n\n<p>But this time I don't have any length limit to the input and I want to allow input with arbitrary size. In the past I used <code>scanf</code> for this, like so:  </p>\n\n<pre><code>char *user_input;   \nscanf(\"%ms\", &amp;user_input);\n</code></pre>\n\n<p>How can I do this with <code>read()</code>?<br>\n<em>Note: safety isn't important here</em></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1504092347, "post_id": 45959103, "comment_id": 78876071, "body": "There&#39;s no such thing as a <i>string variable</i> btw, that&#39;s an array of <code>char</code>. Of course, C knows <i>strings</i>, but there&#39;s no <i>type</i> for them ..."}, {"owner": {"reputation": 1140, "user_id": 2908058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a7412e38307b23d1d82e5bc0de15867?s=128&d=identicon&r=PG&f=1", "display_name": "Dmytro Khmara", "link": "https://stackoverflow.com/users/2908058/dmytro-khmara"}, "edited": false, "score": 0, "creation_date": 1504092376, "post_id": 45959103, "comment_id": 78876096, "body": "Try to use: memcpy"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1504092380, "post_id": 45959103, "comment_id": 78876099, "body": "<code>char tmp[200] = &quot;C:&#47;imgsDir&quot;; strcat(tmp, imgName); strcpy(imgName, tmp);</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1504092421, "post_id": 45959103, "comment_id": 78876138, "body": "That being said, you could use <a href=\"http://man7.org/linux/man-pages/man3/memmove.3.html\" rel=\"nofollow noreferrer\"><code>memmove()</code></a> to make room at the beginning and <a href=\"http://man7.org/linux/man-pages/man3/memcpy.3.html\" rel=\"nofollow noreferrer\"><code>memcpy()</code></a> to copy your new content there."}, {"owner": {"reputation": 51, "user_id": 8062800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pezv1.jpg?s=128&g=1", "display_name": "yuexia_wrp", "link": "https://stackoverflow.com/users/8062800/yuexia-wrp"}, "edited": false, "score": 0, "creation_date": 1504092439, "post_id": 45959103, "comment_id": 78876157, "body": "Can anyone say clear about using memory method..thank you.."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1504092635, "post_id": 45959103, "comment_id": 78876316, "body": "<code>memmove(imgName + strlen(&quot;C:&#47;imgsDir&quot;), imgName, strlen(imgName) + 1); memcpy(imgName, &quot;C:&#47;imgsDir&quot;, strlen(&quot;C:&#47;imgsDir&quot;));</code>"}], "owner": {"reputation": 51, "user_id": 8062800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Pezv1.jpg?s=128&g=1", "display_name": "yuexia_wrp", "link": "https://stackoverflow.com/users/8062800/yuexia-wrp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1504092336, "answer_count": 0, "score": 0, "last_activity_date": 1504092249, "creation_date": 1504092216, "last_edit_date": 1504092249, "question_id": 45959103, "link": "https://stackoverflow.com/questions/45959103/how-to-add-string-constant-in-string-variables-head-in-c", "closed_reason": "Duplicate", "title": "How to add string constant in string variables&#39; head in C?", "body": "<p>I defined a string variable by:</p>\n\n<p><code>char imgName[200];</code></p>\n\n<p>After I assign a string to <code>imgName</code>, I want to add <code>\"C:/imgsDir\"</code> at the head of <code>imgName</code>.</p>\n\n<p>I can't determine how to do is best, and I don't want to define another string variable</p>\n"}, {"tags": ["c++", "c", "shared-libraries", "static-libraries", "buildroot"], "answers": [{"comments": [{"owner": {"reputation": 635, "user_id": 3787646, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b69f4bba40b8924b4dd789d0d3be9a53?s=128&d=identicon&r=PG&f=1", "display_name": "Multisync", "link": "https://stackoverflow.com/users/3787646/multisync"}, "edited": false, "score": 0, "creation_date": 1504170314, "post_id": 45974582, "comment_id": 78913560, "body": "Defining <code>FOO_CONF_OPTS</code> was what I had in mind as well. However, I did not know that subsequent options override preceding ones. This makes it a solution indeed!"}, {"owner": {"reputation": 3926, "user_id": 1979048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bdc6e1c216dc3cc9f7d3b54d0da412?s=128&d=identicon&r=PG", "display_name": "Jonathan Ben-Avraham", "link": "https://stackoverflow.com/users/1979048/jonathan-ben-avraham"}, "edited": false, "score": 0, "creation_date": 1586846033, "post_id": 45974582, "comment_id": 108270035, "body": "Note that most, but not all Buildroot supported packages are autoconf packages, and that most but not all autoconf packages support the &quot;--enable-static&quot; option. So YMMV regarding &quot;--enable-static&quot;. You need to look carefully at the individual package&#39;s build system."}], "tags": [], "owner": {"reputation": 2292, "user_id": 957841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef02f11ecbda985cd8136f4f68d60364?s=128&d=identicon&r=PG", "display_name": "Arnout", "link": "https://stackoverflow.com/users/957841/arnout"}, "is_accepted": true, "score": 2, "last_activity_date": 1504160563, "creation_date": 1504160563, "answer_id": 45974582, "question_id": 45958904, "link": "https://stackoverflow.com/questions/45958904/buildroot-build-only-one-package-as-both-shared-and-static-lib-all-others-shar/45974582#45974582", "title": "Buildroot: Build only one package as both shared and static lib, all others shared only", "body": "<p>Buildroot does not directly support changing options for one package only. That would simply explode the number of options.</p>\n\n<p>The easiest way to do this is to edit <code>package/foo/foo.mk</code> and add the following line to it:</p>\n\n<pre><code>FOO_CONF_OPTS += --enable-static\n</code></pre>\n\n<p>These options come after the default autoconfig options (which contain <code>--enable-shared --disable-static</code>) and will thus override them.</p>\n\n<p>If you don't want to touch the Buildroot sources, you can also do this in your <code>local.mk</code> or in a <code>BR2_EXTERNAL</code> -- see the manual for how to set these up.</p>\n\n<p>The Buildroot version number is encoded at the top of the Makefile (line 90 in current master) in the variable <code>BR2_VERSION</code>. You can also look at the top of the generated <code>.config</code> file, which contains the version extended with the git commit hash.</p>\n"}], "owner": {"reputation": 635, "user_id": 3787646, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b69f4bba40b8924b4dd789d0d3be9a53?s=128&d=identicon&r=PG&f=1", "display_name": "Multisync", "link": "https://stackoverflow.com/users/3787646/multisync"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1999, "favorite_count": 0, "accepted_answer_id": 45974582, "answer_count": 1, "score": 1, "last_activity_date": 1504160563, "creation_date": 1504091584, "last_edit_date": 1504093241, "question_id": 45958904, "link": "https://stackoverflow.com/questions/45958904/buildroot-build-only-one-package-as-both-shared-and-static-lib-all-others-shar", "title": "Buildroot: Build only one package as both shared and static lib, all others shared only", "body": "<p>buildroot offers to possibility to build</p>\n\n<ul>\n<li>only static,</li>\n<li>only shared,</li>\n<li>or both shared and static libs</li>\n</ul>\n\n<p>of the selected packages.</p>\n\n<p>The assigned configuration elements are <code>BR2_STATIC_LIBS</code>, <code>BR2_STATIC_LIBS</code>, and <code>BR2_SHARED_STATIC_LIBS</code>.</p>\n\n<h2>Question:</h2>\n\n<p>Is it possible to build both a shared and static lib for <em>one package only</em>, while building only shared libs for <em>all the other packages</em>?</p>\n\n<p>The one project which I want a static lib of would be an autotools-based package.</p>\n\n<h2>My effort:</h2>\n\n<p>I did read the manual, but to no avail. I did come up with one idea though, but I think it won't work: I could have buildroot call the <code>configure</code> script with some arguments defined by me forcing the additional creation of a static lib. However, this would collide with the arguments buildroot is providing, which are forcing <code>configure</code> to do quite the opposite. (Create shared lib only.)</p>\n\n<p>Thank you!</p>\n\n<p>Unfortunately I can't even tell which version of buildroot I am using, as I did not find a way to get buildroots version number.</p>\n"}, {"tags": ["c", "pointers", "parameter-passing", "function-call"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8537394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/976b6d78e19ceb9c26f1343db8124eff?s=128&d=identicon&r=PG&f=1", "display_name": "l1677783", "link": "https://stackoverflow.com/users/8537394/l1677783"}, "edited": false, "score": 0, "creation_date": 1504089341, "post_id": 45958096, "comment_id": 78873917, "body": "Am I not changing the adress of str1 to the adress of str3?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 21, "user_id": 8537394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/976b6d78e19ceb9c26f1343db8124eff?s=128&d=identicon&r=PG&f=1", "display_name": "l1677783", "link": "https://stackoverflow.com/users/8537394/l1677783"}, "edited": false, "score": 0, "creation_date": 1504089519, "post_id": 45958096, "comment_id": 78874026, "body": "@l1677783 str1 is a local variable within your function (function arguments behave pretty much like local variables). <code>str1 = (char *)str3</code> changes that local variable to point to str3. You are not changing the part1 variable that you have in main(). main() passes a copy of the part1 pointer to your str_join() function. (Note, a copy of the pointer, not a copy of what the pointer points to)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1504089582, "last_edit_date": 1504089582, "creation_date": 1504089185, "answer_id": 45958096, "question_id": 45958019, "link": "https://stackoverflow.com/questions/45958019/c-own-str-join-function-does-not-work/45958096#45958096", "title": "C - Own str_join function does not work", "body": "<p>In C, function arguments are passed by value. Any changes made to any parameter from inside the function is will not reflect to the caller (actual argument).</p>\n\n<p>So, in your case, <code>str1 = (char *)str3;</code>, does not do what you think it does.</p>\n\n<p>That said, wait, stop!! <code>str3</code> is a VLA and lifetime is the block scope. You cannot possibly return the address of the first element and expect that to be valid outside the scope for accessing the memory location(s). You need to allocate memory in such a way that it outlives its <em>scope</em>., You have to either</p>\n\n<ul>\n<li>use an array with <code>static</code> storage (cannot be combined with VLAs)</li>\n<li>use memory allocator function</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "is_accepted": false, "score": 0, "last_activity_date": 1504089346, "creation_date": 1504089346, "answer_id": 45958151, "question_id": 45958019, "link": "https://stackoverflow.com/questions/45958019/c-own-str-join-function-does-not-work/45958151#45958151", "title": "C - Own str_join function does not work", "body": "<p>You are not returning the pointer you think you are returning from the function.</p>\n\n<pre><code>str1 = (char *)str3;\n</code></pre>\n\n<p>You seem to assume that this changes <code>str1</code> so that it points to the (correctly) joined string <code>str3</code>, but this change is not visible outside of the function.</p>\n\n<p>You can fix this in (at least) two ways:</p>\n\n<p>1) Allocate with <code>malloc</code></p>\n\n<pre><code>char *str3 = malloc(str_size_1 + str_size_2);\n</code></pre>\n\n<p>And then return this pointer from the function (instead of void)</p>\n\n<p>or 2)</p>\n\n<p>pass a pointer to the pointer to the function, like this</p>\n\n<pre><code>void str_join(char **str1, char *str2)\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>*str1 = str3;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8509705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zPkIg.jpg?s=128&g=1", "display_name": "Siddhartha Pramanik", "link": "https://stackoverflow.com/users/8509705/siddhartha-pramanik"}, "is_accepted": false, "score": 0, "last_activity_date": 1504095826, "creation_date": 1504095826, "answer_id": 45960339, "question_id": 45958019, "link": "https://stackoverflow.com/questions/45958019/c-own-str-join-function-does-not-work/45960339#45960339", "title": "C - Own str_join function does not work", "body": "<p>The objective you wish to achieve is done with the help of call by reference method of the function calling method. But in your code, the <code>str_join</code> is a call by value function. When you change the value of <code>str1</code> it is changed just for the scope of the function. As, soon as you come out of the <code>str_join</code> scope the value of <code>str1</code> is again changed to the earlier one, becuase what you are passing to the function is not the address of <code>str1</code> but a copy of the value of <code>str1</code>. You should try this instead : </p>\n\n<pre><code>void str_join(char **str1, char **str2) \n</code></pre>\n\n<p><code>// though the str2 need not to be passed by reference you can leave it as it is now</code></p>\n\n<p>Replace the <code>str1</code> inside the function with <code>*str1</code></p>\n\n<p>Then you can call it in your main function as : <code>str_join(&amp;str1, &amp;str2)</code></p>\n\n<p>The <code>&amp;</code> sign signifies that you are passing the address of <code>str1</code> and <code>str2</code></p>\n"}, {"tags": [], "owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "is_accepted": false, "score": 0, "last_activity_date": 1504101395, "creation_date": 1504101395, "answer_id": 45962424, "question_id": 45958019, "link": "https://stackoverflow.com/questions/45958019/c-own-str-join-function-does-not-work/45962424#45962424", "title": "C - Own str_join function does not work", "body": "<p>I'm sure that there are many ways of implementing what is required here. A reasonably idiomatic way in C would be to create a new dynamically-allocated string large enough to hold both the original strings, and return that to the caller.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;malloc.h&gt;\n\nchar *str_join(char *str1, char *str2)\n  {\n  char *result = malloc (strlen (str1) + strlen (str2) + 1);\n  strcpy (result, str1);\n  strcat (result, str2);\n  return result;\n  }\n\n int main(int argc, char **argv)\n   {\n   char *part1 = \"Hello \";\n   char *part2 = \"World!\";\n   char *joined = str_join(part1, part2);\n   printf(\"%s\\n\", joined);\n   free (joined);\n   return 0;\n   }\n</code></pre>\n\n<p>The caller will have to call free() on the result. It's reasonable common practice to assume that any function that returns a \"char *\" is returning something that has to be freed, whilst a function that returns a \"const char *\" is returning something that doesn't need to be freed. A number of basic, long-standing functions in the C standard library don't follow this convention, however.</p>\n"}], "owner": {"reputation": 21, "user_id": 8537394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/976b6d78e19ceb9c26f1343db8124eff?s=128&d=identicon&r=PG&f=1", "display_name": "l1677783", "link": "https://stackoverflow.com/users/8537394/l1677783"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 4, "score": -1, "last_activity_date": 1504101395, "creation_date": 1504088964, "last_edit_date": 1504089671, "question_id": 45958019, "link": "https://stackoverflow.com/questions/45958019/c-own-str-join-function-does-not-work", "title": "C - Own str_join function does not work", "body": "<p>I wanted to make a simple <code>str_join</code> function in C (to learn a bit more about pointers and arrays), which literally joins two string together.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint str_size(char *str);\nvoid str_join(char *str1, char *str2);\n\nint main(int argc, char **argv)\n{\n    char *part1 = \"Hello \";\n    char *part2 = \"World!\";\n    str_join(part1, part2);\n    printf(\"%s\\n\", part1);\n    return 0;\n}\n\nint str_size(char *str)\n{\n    char c;\n    for(int i = 0;; i++)\n    {\n        c = str[i];\n        if(c == '\\0')\n            return i + 1;\n    }\n}\n\nvoid str_join(char *str1, char *str2)\n{\n    int str_size_1 = str_size(str1) - 1; //Last char is '\\0', don't need them 2 times\n    int str_size_2 = str_size(str2);\n    char str3[str_size_1 + str_size_2];\n    int i;\n\n    for(i = 0; i &lt; str_size_1; i++)\n        str3[i] = str1[i];\n\n    for(i = 0; i &lt; str_size_2; i++)\n        str3[i + str_size_1] = str2[i];\n\n    str1 = (char *)str3;\n}\n</code></pre>\n\n<p>It looks simple (maybe too simple).\nI excepted the output to be:</p>\n\n<pre><code>Hello World\n</code></pre>\n\n<p>but it looks like:</p>\n\n<pre><code>Hello \n</code></pre>\n\n<p>I compiled the program using following command:</p>\n\n<pre><code>gcc main.c -o main\n</code></pre>\n\n<p>And ran it:</p>\n\n<pre><code>./main\n</code></pre>\n\n<p>I don't see my failure, could someone point me to my error?\nThank you for helping me out!</p>\n"}, {"tags": ["c", "raspberry-pi", "serial-port", "ftdi", "rs485"], "comments": [{"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 1, "creation_date": 1504092664, "post_id": 45957314, "comment_id": 78876347, "body": "my first thought is that the struct needs to be zeroed out. <code>struct serial_rs485 rs485conf = {0};</code>"}, {"owner": {"reputation": 43, "user_id": 8537237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecb1d32be67b2d83bf0f0e15c09e4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Andrews", "link": "https://stackoverflow.com/users/8537237/jim-andrews"}, "reply_to_user": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1504093813, "post_id": 45957314, "comment_id": 78877133, "body": "I did that, it doesnt solve my problem. I get the same error."}, {"owner": {"reputation": 1957, "user_id": 2216148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5929fc00527aec117d07906c31f7f69c?s=128&d=identicon&r=PG", "display_name": "Rodney", "link": "https://stackoverflow.com/users/2216148/rodney"}, "edited": false, "score": 0, "creation_date": 1504095377, "post_id": 45957314, "comment_id": 78878296, "body": "Try setting the flags one at a time and see which one errors? What&#39;s with RTS? Is this wired to an output enable or something?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1504096419, "post_id": 45957314, "comment_id": 78879153, "body": "It looks like the driver that provided the <code>ttyUSB0</code> device does not support the RS485 ioctl. Can you provide the details of the device? (When an USB device is plugged in, its details are in kernel-provided directory <code>&#47;sys&#47;bus&#47;usb&#47;devices&#47;SOMETHING&#47;</code>. <code>manufacturer</code> and <code>product</code> tells which device it is. The important files are <code>idProduct</code>, <code>idVendor</code> (USB product ID and vendor ID) and <code>uevent</code> (udev details for the device)."}, {"owner": {"reputation": 43, "user_id": 8537237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecb1d32be67b2d83bf0f0e15c09e4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Andrews", "link": "https://stackoverflow.com/users/8537237/jim-andrews"}, "reply_to_user": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1504097168, "post_id": 45957314, "comment_id": 78879712, "body": "@NominalAnimal I have added the dmesg output"}, {"owner": {"reputation": 43, "user_id": 8537237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecb1d32be67b2d83bf0f0e15c09e4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Andrews", "link": "https://stackoverflow.com/users/8537237/jim-andrews"}, "reply_to_user": {"reputation": 1957, "user_id": 2216148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5929fc00527aec117d07906c31f7f69c?s=128&d=identicon&r=PG", "display_name": "Rodney", "link": "https://stackoverflow.com/users/2216148/rodney"}, "edited": false, "score": 0, "creation_date": 1504097171, "post_id": 45957314, "comment_id": 78879714, "body": "@Rodney I tried setting flags one at a time, but even without any it gives errors"}, {"owner": {"reputation": 1957, "user_id": 2216148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5929fc00527aec117d07906c31f7f69c?s=128&d=identicon&r=PG", "display_name": "Rodney", "link": "https://stackoverflow.com/users/2216148/rodney"}, "edited": false, "score": 1, "creation_date": 1504098346, "post_id": 45957314, "comment_id": 78880701, "body": "<code>struct serial_rs485</code> seems to be about using RTS pin as an output enable. According to 4.3.3 of the <a href=\"http://www.ftdichip.com/Support/Documents/DataSheets/ICs/DS_FT4232H.pdf\" rel=\"nofollow noreferrer\">datasheet</a> there is a separate output enable for RS485, so is this IOCTL required at all? RTS is not connected in this diagram"}, {"owner": {"reputation": 43, "user_id": 8537237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecb1d32be67b2d83bf0f0e15c09e4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Andrews", "link": "https://stackoverflow.com/users/8537237/jim-andrews"}, "reply_to_user": {"reputation": 1957, "user_id": 2216148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5929fc00527aec117d07906c31f7f69c?s=128&d=identicon&r=PG", "display_name": "Rodney", "link": "https://stackoverflow.com/users/2216148/rodney"}, "edited": false, "score": 0, "creation_date": 1504098636, "post_id": 45957314, "comment_id": 78880956, "body": "@Rodney I get it now. Sorry for not looking this up first. Since I am a beginner can you kindly point me to a more relevant example I can use in my case?"}, {"owner": {"reputation": 1957, "user_id": 2216148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5929fc00527aec117d07906c31f7f69c?s=128&d=identicon&r=PG", "display_name": "Rodney", "link": "https://stackoverflow.com/users/2216148/rodney"}, "edited": false, "score": 0, "creation_date": 1504098694, "post_id": 45957314, "comment_id": 78881005, "body": "OK going to amend my original answer"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8537237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecb1d32be67b2d83bf0f0e15c09e4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Andrews", "link": "https://stackoverflow.com/users/8537237/jim-andrews"}, "edited": false, "score": 0, "creation_date": 1504099143, "post_id": 45959535, "comment_id": 78881393, "body": "Thanks.  Since I am a beginner can you kindly point me to a more relevant example I can use in my case, so I may get started?"}, {"owner": {"reputation": 1957, "user_id": 2216148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5929fc00527aec117d07906c31f7f69c?s=128&d=identicon&r=PG", "display_name": "Rodney", "link": "https://stackoverflow.com/users/2216148/rodney"}, "reply_to_user": {"reputation": 43, "user_id": 8537237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecb1d32be67b2d83bf0f0e15c09e4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Andrews", "link": "https://stackoverflow.com/users/8537237/jim-andrews"}, "edited": false, "score": 0, "creation_date": 1504099289, "post_id": 45959535, "comment_id": 78881535, "body": "I think just skip the <code>struct serial_rs485</code> stuff and carry on from there?"}], "tags": [], "owner": {"reputation": 1957, "user_id": 2216148, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5929fc00527aec117d07906c31f7f69c?s=128&d=identicon&r=PG", "display_name": "Rodney", "link": "https://stackoverflow.com/users/2216148/rodney"}, "is_accepted": true, "score": 2, "last_activity_date": 1504107177, "last_edit_date": 1504107177, "creation_date": 1504093521, "answer_id": 45959535, "question_id": 45957314, "link": "https://stackoverflow.com/questions/45957314/rs485-inappropriate-ioctl-for-device/45959535#45959535", "title": "RS485: Inappropriate ioctl for device", "body": "<p>As mentioned in the comment by @Richard Chambers you are using the structure uninitialised. You should do</p>\n\n<pre><code>struct serial_rs485 rs485conf = {0};\n</code></pre>\n\n<p>However, as discussed that didn't solve the problem.</p>\n\n<p>Quoting from the Kernel document you referenced</p>\n\n<blockquote>\n  <p>Some CPUs/UARTs (e.g., Atmel AT91 or 16C950 UART) contain a built-in\n     half-duplex mode capable of automatically controlling line direction by\n     toggling RTS or DTR signals. That can be used to control external\n     half-duplex hardware like an RS485 transceiver...</p>\n</blockquote>\n\n<p>However this device has a dedicated pin called TXDEN for that. Quoting from the <a href=\"http://www.ftdichip.com/Support/Documents/DataSheets/ICs/DS_FT4232H.pdf\" rel=\"nofollow noreferrer\" title=\"data sheet\">Data sheet</a> section 4.3.3</p>\n\n<blockquote>\n  <p>With RS485, the transmitter \n  is only enabled when a character is being transmitted from the UART. The TXDEN pins on the FT4232H are \n  provided for exactly that purpose, and so the transmitter enables are wired to the TXDEN</p>\n</blockquote>\n\n<p>and you can see that the RS232 outputs RTS / DTR not connected in RS485, this is in contrast to devices where RTS becomes TXDEN which would require an intervention by the driver.</p>\n\n<p>If we pick apart <code>struct serial_rs485</code> we can see that it is mostly about controlling RTS for this purpose. Since this device has a dedicated TXDEN pin, those control fields are irrelevant.</p>\n\n<p>Another flag that is used in this structure:</p>\n\n<pre><code>  /* Set this flag if you want to receive data even whilst sending data */\nrs485conf.flags |= SER_RS485_RX_DURING_TX;\n</code></pre>\n\n<p>And yes looking at the circuit, what you put out on the line you will also receive. Looks like you cannot turn that off. RS485 is multidrop, so you should be filtering out messages that were not addressed to you anyway. The fact that some of those messages may have originated from you doesn't matter.</p>\n\n<p>Finally (and firstly) we have this</p>\n\n<pre><code>/* Enable RS485 mode: */\nrs485conf.flags |= SER_RS485_ENABLED;\n</code></pre>\n\n<p>That's really saying \"enable all the RS485-specific stuff that's controlled by this structure\". Except that we've just made all that stuff irrelevant, so enabling it has no effect.</p>\n\n<p>This is why the ioctl is not implemented for that UART.</p>\n\n<p>You have a number of options, these are just suggestions so pick what suits you</p>\n\n<ul>\n<li>Delete this section of the initializtion code as it's not needed</li>\n<li>Compile it conditionally <code>#if RS485_IOCTLS</code></li>\n<li>Run it conditionally</li>\n<li>Treat that <code>errno</code> value <code>ENOTTY</code> as indicating that, in this context the <code>ioctl</code> was not required and you can in fact proceed as if there was no error</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1593379034, "post_id": 56066933, "comment_id": 110753289, "body": "<i>&quot;... you can write your own driver based on one of those that support the RS485 mode, ...  but in my view they are wrong&quot;</i> -- Have fun trying to synchronize your userspace program with the serial device driver.  That&#39;s the rationale for <i>&quot;automatically changing RTS for RS-485 communication&quot;</i>, unburden userspace with timing and hardware manipulation that properly belong in the kernelspace."}, {"owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "reply_to_user": {"reputation": 13673, "user_id": 1599004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9d2a02744f666e97375e05fdc54255?s=128&d=identicon&r=PG", "display_name": "sawdust", "link": "https://stackoverflow.com/users/1599004/sawdust"}, "edited": false, "score": 0, "creation_date": 1593409590, "post_id": 56066933, "comment_id": 110759691, "body": "I agree the software solution proposed here is just a dirty trick to play at home. I would rather try to get a transceiver with hardware toggling or letting the kernel do it for you. But some unfortunate souls don&#39;t have any of those choices and they might not want to build the 555 circuit either."}], "tags": [], "owner": {"reputation": 2561, "user_id": 11476836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c679da3a7b9adc6f980fb698e3f46b0b?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos G.", "link": "https://stackoverflow.com/users/11476836/marcos-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1557433021, "creation_date": 1557433021, "answer_id": 56066933, "question_id": 45957314, "link": "https://stackoverflow.com/questions/45957314/rs485-inappropriate-ioctl-for-device/56066933#56066933", "title": "RS485: Inappropriate ioctl for device", "body": "<p>I think it might add some value for others facing similar issues in the future to elaborate a bit more on Rodney's answer from a hardware side.</p>\n\n<p>Although I came here looking for the answer to the thread question (why was I getting an <em>ioctl</em> error trying to activate the RS485 mode on pyserial (which I was actually calling from pyModbus) I found the answer to that question above. Plain and simple, and to provide a shorter answer than Rodney's: you can't. You won't be able to activate the RS485 mode on your FTDI because there is no function to use the RTS signal as a drive enable for your RS485 chip. </p>\n\n<p>Some devices, like those using the <em>atmel_serial</em> driver do implement this functionality, but you won't find that many. Digging into this issue you'll find people saying you can write your own driver based on one of those that support the RS485 mode (see, for instance: <a href=\"https://stackoverflow.com/questions/25250731/automatically-changing-rts-for-rs-485-communication\">automatically changing RTS for RS-485 communication</a>, but in my view they are wrong)</p>\n\n<p>Now that you have the bad news, you can ask yourself why would you need to use the RS485 mode? I imagine that, like me, you were trying to establish a half-duplex link between two devices using a two wire RS485 setup (which is surprisingly frequent in many industrial devices where you have a master-slave configuration, where you have one side sending a request for data and the other side duly responding, as you do with Modbus).</p>\n\n<p>If you are looking for a software solution you can still take the RTS signal high and low manually before starting and after finishing transmitting from each side. This solution will work for testing and just for fun in most environments (at least those I tried, it even works with Python on a Raspberry Pi using a GPIO line to control the Drive Enable/~Read Enable signals) but I would not use it if you want to get good reliability. With any non-real time OS there is no warranty you will get the correct timing and some devices are quite picky and will report a <em>timeout</em> error. If you are free to choose both sides (or all of them if you have more than two stations) of the bus you can always increase your <em>tiemout</em> everywhere and hope for the best.</p>\n\n<p>Good news is, as Rodney said, on the FTDI chip you have the TXDEN signal available on pin 13 so you can use that right away. Unfortunately, most cheap USB to serial \nadaptor PCBs don't have that signal easily accessible on the board. That's what happened to my Sparkfun board. If you are not up for the challenge of attaching a cable directly to the SMD IC you can do what I did: download mprog 3.5 from FTDI, connect to the EPROM, under I/O Controls select TXDEN instead of TXLED and click save to write the updated firmware to the chip. Then you can easily attach a cable to the LED pad and use it as your Drive Enable/~Read Enable signal (see pictures, the scope snapshot shows it works nicely).</p>\n\n<p><a href=\"https://i.stack.imgur.com/A21Fq.jpg\" rel=\"nofollow noreferrer\">Modified FTDI board with TXDEN signal on TXLED</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/otZw2.jpg\" rel=\"nofollow noreferrer\">Scope capture of the modified circuit: blue is TX, yellow TXDEN</a></p>\n\n<p>Lastly, if you are unlucky enough to run into other chips that don't have this option (TXDEN), like the PL2303 you can always go old school and build a hardware TXDEN with a 555 timer (see here: <a href=\"http://www.embeddedsys.com/subpages/resources/images/documents/microsys_art_RS485.pdf\" rel=\"nofollow noreferrer\">http://www.embeddedsys.com/subpages/resources/images/documents/microsys_art_RS485.pdf</a>). I tested this circuit and it works fine, at least at 9600 bps (note that I had to use a 39K resistor instead of a 3.9K, I think that's a typo but I might be wrong, I did not go into fine details, I just needed something quick and dirty to pair with my FTDI.</p>\n"}], "owner": {"reputation": 43, "user_id": 8537237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eecb1d32be67b2d83bf0f0e15c09e4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Andrews", "link": "https://stackoverflow.com/users/8537237/jim-andrews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5213, "favorite_count": 0, "accepted_answer_id": 45959535, "answer_count": 2, "score": 2, "last_activity_date": 1557433021, "creation_date": 1504087043, "last_edit_date": 1504097091, "question_id": 45957314, "link": "https://stackoverflow.com/questions/45957314/rs485-inappropriate-ioctl-for-device", "title": "RS485: Inappropriate ioctl for device", "body": "<p>I am using the following code to access the RS485 slave but I get the error:</p>\n\n<blockquote>\n  <p>Error reading ioctl port (25): Inappropriate ioctl for device</p>\n</blockquote>\n\n<p>My code is as follows:</p>\n\n<pre><code>#include &lt;linux/serial.h&gt;\n#include &lt;sys/ioctl.h&gt;\n\n\n    int fd = open (\"/dev/ttyUSB0\", O_RDWR);\n    if (fd &lt; 0) {\n        printf(\"Error Opening\\n\");\n        exit(0);\n    }\n\n    struct serial_rs485 rs485conf;\n\n    /* Enable RS485 mode: */\n    rs485conf.flags |= SER_RS485_ENABLED;\n\n    /* Set logical level for RTS pin equal to 1 when sending: */\n    rs485conf.flags |= SER_RS485_RTS_ON_SEND;\n\n    /* set logical level for RTS pin equal to 0 after sending: */\n    rs485conf.flags &amp;= ~(SER_RS485_RTS_AFTER_SEND);\n\n    /* Set rts delay before send, if needed: */\n    rs485conf.delay_rts_before_send = 0;\n\n    /* Set rts delay after send, if needed: */\n    rs485conf.delay_rts_after_send = 0;\n\n    /* Set this flag if you want to receive data even whilst sending data */\n    rs485conf.flags |= SER_RS485_RX_DURING_TX;\n\n    if (ioctl (fd, TIOCSRS485, &amp;rs485conf) &lt; 0) {\n        fprintf( stderr, \"Error reading ioctl port (%d): %s\\n\",  errno, strerror( errno ));\n        exit(0);\n    }\n\n    //TODO read and write\n\n    /* Close the device when finished: */\n    if (close (fd) &lt; 0) {\n        fprintf( stderr, \"Error closing device connection (%d): %s\\n\",  errno, strerror( errno ));\n    }\n</code></pre>\n\n<p>I took the source code from <a href=\"https://www.kernel.org/doc/Documentation/serial/serial-rs485.txt\" rel=\"nofollow noreferrer\">https://www.kernel.org/doc/Documentation/serial/serial-rs485.txt</a>. I am developing my application on the raspberry pi and am connected to the FTDI USB Serial device using Quad RS232-HS chip. What might be the source of the error?\\</p>\n\n<p>When USB I connect the USB device, output for </p>\n\n<blockquote>\n  <p>dmesg</p>\n</blockquote>\n\n<p>is as follow:</p>\n\n<pre><code>[16865.640038] usb 3-2: new high-speed USB device number 10 using xhci_hcd\n[16865.780365] usb 3-2: New USB device found, idVendor=0403, idProduct=6011\n[16865.780367] usb 3-2: New USB device strings: Mfr=1, Product=2, SerialNumber=0\n[16865.780369] usb 3-2: Product: Quad RS232-HS\n[16865.780370] usb 3-2: Manufacturer: FTDI\n[16866.377940] usbcore: registered new interface driver usbserial\n[16866.377969] usbcore: registered new interface driver usbserial_generic\n[16866.377994] usbserial: USB Serial support registered for generic\n[16866.384018] usbcore: registered new interface driver ftdi_sio\n[16866.384045] usbserial: USB Serial support registered for FTDI USB Serial Device\n[16866.384203] ftdi_sio 3-2:1.0: FTDI USB Serial Device converter detected\n[16866.384247] usb 3-2: Detected FT4232H\n[16866.384373] usb 3-2: FTDI USB Serial Device converter now attached to ttyUSB0\n[16866.384399] ftdi_sio 3-2:1.1: FTDI USB Serial Device converter detected\n[16866.384431] usb 3-2: Detected FT4232H\n[16866.384727] usb 3-2: FTDI USB Serial Device converter now attached to ttyUSB1\n[16866.384751] ftdi_sio 3-2:1.2: FTDI USB Serial Device converter detected\n[16866.384786] usb 3-2: Detected FT4232H\n[16866.384897] usb 3-2: FTDI USB Serial Device converter now attached to ttyUSB2\n[16866.384917] ftdi_sio 3-2:1.3: FTDI USB Serial Device converter detected\n[16866.384950] usb 3-2: Detected FT4232H\n[16866.385385] usb 3-2: FTDI USB Serial Device converter now attached to ttyUSB3\n</code></pre>\n"}, {"tags": ["c++", "c", "windows"], "comments": [{"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 3, "creation_date": 1504087509, "post_id": 45957125, "comment_id": 78872698, "body": "IMO, very few projects will be affected, because deliberately using an executable as if it were a DLL is a very strange thing to do.  This has never been supported."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1504087955, "post_id": 45957125, "comment_id": 78872991, "body": "Hmmm. This sounds like a &quot;if I hit my finger with a hammer, it hurts&quot; problem. What is the reason why anyone would build his DLLs as an EXE file instead of DLL file?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1504088494, "post_id": 45957125, "comment_id": 78873397, "body": "Agree with ^^. The conclusion &quot;many projects are now unstable&quot; has an unspoken assumption that many projects use an EXE as if it&#39;s a DLL. I don&#39;t believe that at all. And that&#39;s confirmed by the lack of reports of programs mysteriously crashing on Windows 10."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1504088781, "post_id": 45957125, "comment_id": 78873580, "body": "assume you dynamic load <i>EXE</i> and system resolve it import. but how about call some entry point, for give it opportunity initialize itself ? this impossible. no such entry point in <i>EXE</i>. as result even with resolved import <i>EXE</i> uninit. you call some <i>func</i> from it. what be if this <i>func</i> used some data, normally initialized in <i>EXE</i> entry point ? say <i>EXE</i> use static linked <i>CRT</i> and <i>func</i> call <i>malloc</i> ? <i>malloc</i> try allocate from <i>CRT</i> heap, but heap not created yet."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 2, "creation_date": 1504093394, "post_id": 45957125, "comment_id": 78876842, "body": "and if you want, you can easy convert private <i>EXE</i> to <i>DLL</i> - need 1. add flag <code>IMAGE_FILE_DLL</code> to <code>IMAGE_FILE_HEADER.Characteristics</code> 2. set <code>AddressOfEntryPoint</code> to 0 in <code>IMAGE_OPTIONAL_HEADER</code>. you can do this is some binary editor, or better write small own program for this modification. anyway after this is exist question of relocation - if no relocation in <i>PE</i> - you can not create it yourself. you can only hope that it default address range will be free when you load this <i>PE</i>. if you convert to <i>DLL</i> but this way - you load your <i>postrgres.exe</i> ok (import will be resolved)."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1504093438, "post_id": 45957125, "comment_id": 78876873, "body": "but still possible fail or crash on some exported function call, because native image entry point is not called"}, {"owner": {"reputation": 219, "user_id": 5097413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1279dbff6047ea5ac84854d3fc9a9fe0?s=128&d=identicon&r=PG&f=1", "display_name": "Edeen", "link": "https://stackoverflow.com/users/5097413/edeen"}, "edited": false, "score": 0, "creation_date": 1504104477, "post_id": 45957125, "comment_id": 78885675, "body": "The modification of the PE with this flag works fine. But I have to keep the binaries of other installed application (.exe that export functions) without any modification."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1504106360, "post_id": 45957125, "comment_id": 78887169, "body": "Hmm, I don&#39;t think that is the correct story.  Making an executable file dynamically loadable first of all requires it to be <i>relocatable</i>.  So it can be loaded at an arbitrary address, whatever happens to be available.  An EXE is traditionally built <i>without</i> relocation info.  None is needed because an EXE can always be loaded at its preferred base address, it gets loaded first.  But that has been changing, the /dynamicbase linker option is important today, ASLR is a very basic malware counter-measure.  But whatever, the boilerplate &quot;if it hurts then don&#39;t do it&quot; advice applies."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1504129456, "post_id": 45957125, "comment_id": 78899571, "body": "about <i>wshelper.dll</i> - you can look it <i>IAT</i> and view that import from <i>netsh.exe</i>. so <code>LoadLibraryW(L&quot;wshelper.dll&quot;)</code> this is indirect load <i>netsh.exe</i>. begin from win8.1 loader not resolve <i>exe</i> import, as result and crash when <i>wshelper.dll</i>  make call to <i>netsh.RegisterHelper</i> on windows 7 - import of exe resolved - so no crash. but this show that <i>wshelper.dll</i> design only be loaded to <i>netsh.exe</i> process"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1504151784, "post_id": 45957125, "comment_id": 78904733, "body": "If you can find documentation anywhere on MSDN that tells you that you are allowed to load <code>wshelper.dll</code> into your own process, then the fact that it doesn&#39;t work any more is a bug.  I suspect there is no such documentation, you&#39;re just misusing an internal DLL."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1504151867, "post_id": 45957125, "comment_id": 78904755, "body": "Also, can you point to PostgreSQL documentation that tells you to link to <code>postgres.exe</code> as if it were a library?  I suspect you were never supposed to be doing that either."}, {"owner": {"reputation": 219, "user_id": 5097413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1279dbff6047ea5ac84854d3fc9a9fe0?s=128&d=identicon&r=PG&f=1", "display_name": "Edeen", "link": "https://stackoverflow.com/users/5097413/edeen"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1504164386, "post_id": 45957125, "comment_id": 78909749, "body": "@Harry Johnston, I&#39;m not using postgres.exe as library but some extensions with command line interface do it. So if I understand well. There is a &#39;regression&#39; on windows 10, but it is to promote good practice, and all the concerned projects have to be fixed."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1504169566, "post_id": 45957125, "comment_id": 78913036, "body": "I&#39;m not sure I&#39;d call it a regression, but whatever.  Yes, if someone&#39;s project includes an executable that crashes on Windows 10 because it is linking to another executable, that&#39;s a bug in the project."}, {"owner": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1506880955, "post_id": 45957125, "comment_id": 79984631, "body": "@HarryJohnston: So using a well-known, publicly-documented (not from <code>winternl.h</code>, etc.) function from the Windows SDK is a bug in the project? That&#39;s completely unreasonable. Or perhaps the bug is even linking with a standard LIB from the Windows SDK? Who would&#39;ve thought linking with the LIBs supplied in the Windows SDK is safe or supported?"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "edited": false, "score": 0, "creation_date": 1506888540, "post_id": 45957125, "comment_id": 79987023, "body": "@conio, <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms708327(v=vs.85).aspx\" rel=\"nofollow noreferrer\">so far as I can see,</a> InitHelperDll is only documented as a callback function - it is a function for the Win32 programmer to write, not part of the SDK for the Win32 programmer to call.  I&#39;m also unaware of any LIB file containing it.  If you know otherwise, I&#39;m all ears."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "edited": false, "score": 0, "creation_date": 1506889011, "post_id": 45957125, "comment_id": 79987164, "body": "... ah, you&#39;re probably talking about MatchToken, not InitHelperDll.  Yes, looking at the documentation, I can see why someone might be misled.  I can only assume whoever wrote that <a href=\"http://lesswrong.com/lw/kg/expecting_short_inferential_distances/\" rel=\"nofollow noreferrer\">took it for granted</a> that the reader would already be familiar with basic Windows principles.  That&#39;s still carelessness on Microsoft&#39;s part.  Good point.  @conio"}, {"owner": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1506889778, "post_id": 45957125, "comment_id": 79987398, "body": "@HarryJohnston: I&#39;m not sure I understand. You say the documentation took a misleading shortcut as if there&#39;s another way someone who&#39;s familiar with basic Windows principles would realize. What&#39;s the other way? The function - as documented - is only available through the <code>netsh.exe</code> &quot;DLL&quot; or the <code>netsh.lib</code> library (which is an import lib rather than a lib with full implementation). I don&#39;t see the alternative. The documentation says as explicitly as can ebe xpected from MSDN to dynamically link with <code>netsh.exe</code>. Either it is wrong, and not just misleading, or linking to an EXE is not a bug."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "edited": false, "score": 0, "creation_date": 1506889963, "post_id": 45957125, "comment_id": 79987437, "body": "@conio, you&#39;re only supposed to be using those functions from a NetShell Helper, i.e., a DLL that <code>netsh.exe</code> has loaded.  It is a little unusual for a DLL to link back to the executable that loaded it, but it is fully supported.  I&#39;m adding a &quot;community note&quot; to the relevant documentation now."}, {"owner": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1506890644, "post_id": 45957125, "comment_id": 79987619, "body": "@HarryJohnston: Fair enough. But you probably mean de-facto supported. I&#39;m not aware an official document that says that importing from an EXE is unsupported, <i>unless</i> it&#39;s the &quot;main program&quot; (though, obviously, for technical but not-really-contractual reasons this is guaranteed to work; and maybe such a document exists, I don&#39;t know). Instead of these tricks there&#39;s another common Windows pattern which is to pass to an extension&#39;s initialization function a bunch of function pointers to said services. That&#39;s how <code>FltRegisterFilter</code> and <code>SpLsaModeInitialize</code> work, for example. No special rules."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 3413, "user_id": 306930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050d410352880572736fc85f30c170b8?s=128&d=identicon&r=PG", "display_name": "conio", "link": "https://stackoverflow.com/users/306930/conio"}, "edited": false, "score": 0, "creation_date": 1506892810, "post_id": 45957125, "comment_id": 79988160, "body": "@conio, looks like you&#39;re right, I can&#39;t find anything official, not that that&#39;s unusual. :-)  <a href=\"https://msdn.microsoft.com/en-us/library/fdy23fx6.aspx\" rel=\"nofollow noreferrer\">Mutual Imports</a> <i>sort of</i> implies that an EXE and a DLL can have mutual imports, but it&#39;s nowhere near as clear as I&#39;d prefer."}], "owner": {"reputation": 219, "user_id": 5097413, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1279dbff6047ea5ac84854d3fc9a9fe0?s=128&d=identicon&r=PG&f=1", "display_name": "Edeen", "link": "https://stackoverflow.com/users/5097413/edeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1504104602, "creation_date": 1504086510, "last_edit_date": 1592644375, "question_id": 45957125, "link": "https://stackoverflow.com/questions/45957125/dynamic-linking-to-a-exe-instead-of-dll-cause-crash-on-windows-10", "title": "Dynamic linking to a .exe instead of .dll cause crash on windows 10", "body": "<h2>Issue</h2>\n<p>Is it true that when an application is linked with an .exe (or .dll that depends on an .exe), this application will crash on windows 10 ?</p>\n<h2>Long story short</h2>\n<p>I ask this question because few days ago I had an application that had some unexpected crash on windows 10. After some investigations <a href=\"https://stackoverflow.com/users/6401656/rbmm\">RbMm</a> gives me some good explanations and reproductible examples <a href=\"https://stackoverflow.com/questions/45819855/call-of-statically-link-function-crash-everytimes-on-windows-8-10-but-not-7\">Call of statically link function crash everytimes on windows 8/10 but not 7</a>. It allows me to solve my issue but <strong>I couldn't believe there could be a so huge important breaking change and I couldn't find any article on this subject</strong>.</p>\n<h2>Details</h2>\n<p>The conclusion that <a href=\"https://stackoverflow.com/users/6401656/rbmm\">RbMm</a> found was :</p>\n<blockquote>\n<p>however the root of crash on windows 10 - because windows 10 not\nresolve PE (&quot;exe&quot;) import if this pe have no flag IMAGE_FILE_DLL. in\nother words it process this PE like LoadLibraryEx with flag\nDONT_RESOLVE_DLL_REFERENCES - does not load additional executable\nmodules that are referenced by the specified module and nor resolve\nimports. as result this PE not initialized and will crash at first\nimport function call (in your case this is strcmp).</p>\n</blockquote>\n<h2>Examples</h2>\n<p>And there is a simple way to reproduce the issue :</p>\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;Netsh.h&gt;\n#pragma comment(lib, &quot;Netsh.lib&quot;)\nvoid main(int argc, char* argv[])\n{\n    MatchToken(L&quot;*&quot;, L&quot;*&quot;);// crash here on win 10\n}\n</code></pre>\n<p>I also have created <a href=\"https://github.com/BertrandAreal/SampleCrash_LinkCrashOnWindows10.git\" rel=\"nofollow noreferrer\">a simple project</a> in order to do the trick. It build a .exe with an exported function. And another .exe that use this exported function.</p>\n<h2>Conclusion</h2>\n<p>So should I conclude that many projects are now unstable on windows 10 or did I miss some points ? (I'm sure, I did).</p>\n<h2>Edit</h2>\n<ul>\n<li>I never say it is a good practice, I am just using programs that already do this, including some Microsoft libraries (Netsh, wshelper, ...) and some useful projects (postgresql).</li>\n</ul>\n<p>You can fall in this case with common call to a library like :</p>\n<pre><code>if (HMODULE hmod = LoadLibraryW(L&quot;wshelper.dll&quot;))\n{\n    DWORD (WINAPI * InitHelperDll)(_In_ DWORD dwNetshVersion, PVOID pReserved);\n\n    if (*(void**)&amp;InitHelperDll = GetProcAddress(hmod, &quot;InitHelperDll&quot;))\n    {\n        InitHelperDll(1, 0);// crash here, internally InitHelperDll call the RegisterHelper function from Netsh.exe.\n//but again, because Netsh.exe not initialized (import not resolved) when it loads as DLL in win 10\n    }\n    FreeLibrary(hmod);\n}\n</code></pre>\n<ul>\n<li>On windows 7, When debugging the functions from the linked .exe are working fine. So I guess the IAT is initialized. It also use strcmp, so the CRT is initialized.</li>\n</ul>\n<p>Is this behaviour against specification ? unspecified ? or just luck ?\nShould I open a ticket to microsoft helpdesk ? Should I open a ticket to each project that use this behavior. Or is it a proper way to programmatically initialize IAT and CRT on windows 10 (without any modification to the .exe that export the functions) ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1504085969, "post_id": 45956899, "comment_id": 78871657, "body": "Input values? BTW - always check the value returned by <code>scanf</code>, i.e. does it return 3 in your case?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1504086075, "post_id": 45956899, "comment_id": 78871746, "body": "What is your input? What is your expected output? What is your actual output? <b><i>Copy-paste as text</i></b> into the question body. Also please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. I also recommend you take some time to read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> by Eric Lippert, and learn how to use a debugger."}, {"owner": {"reputation": 2575, "user_id": 4711812, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87100b6114369140256e64e7ebab7ec9?s=128&d=identicon&r=PG&f=1", "display_name": "muXXmit2X", "link": "https://stackoverflow.com/users/4711812/muxxmit2x"}, "edited": false, "score": 1, "creation_date": 1504086485, "post_id": 45956899, "comment_id": 78872017, "body": "A look at the the documentation of <a href=\"http://en.cppreference.com/w/c/numeric/math/sqrt\" rel=\"nofollow noreferrer\"><code>sqrt</code></a> reveals that the function returns <code>nan</code> (not a number) in cases where the square root  could not be calculated, i.e. negative numbers. So Your input values probably produce a negative number which you are trying to calculate the square root of. Though I can only guess, since you have not provided  a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> including your users input."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504087408, "post_id": 45956899, "comment_id": 78872632, "body": "Will not compile.  Always copy/paste the code you actually tested."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504087593, "post_id": 45956899, "comment_id": 78872750, "body": "Which compiler did you use for testing?  It should not generate a testable executable with the missing &#39;;&#39; typo:("}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1504086186, "post_id": 45956952, "comment_id": 78871815, "body": "For <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\"><code>printf</code></a> the formats <code>&quot;%lf&quot;</code> and <code>&quot;%f&quot;</code> does the same thing."}], "tags": [], "owner": {"reputation": 57, "user_id": 8536495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b24005368de390c1a8fdd73f3549083?s=128&d=identicon&r=PG&f=1", "display_name": "sebastian15038", "link": "https://stackoverflow.com/users/8536495/sebastian15038"}, "is_accepted": false, "score": 0, "last_activity_date": 1504086287, "last_edit_date": 1504086287, "creation_date": 1504085975, "answer_id": 45956952, "question_id": 45956899, "link": "https://stackoverflow.com/questions/45956899/output-is-coming-as-nan/45956952#45956952", "title": "Output is coming as -nan", "body": "<pre><code>double a,b,c,A,p;\n</code></pre>\n\n<p>your forgot the ; ?</p>\n\n<p>And if you want to printf a float or double you use %f not %lf</p>\n\n<pre><code> printf(\"Area of triangle is %f\",A);\n</code></pre>\n\n<p>You use %lf only for an input for a float or double, for output you use %f</p>\n\n<p>The other thing could be that the sqrt() is negative.</p>\n"}, {"comments": [{"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1504086496, "post_id": 45957076, "comment_id": 78872027, "body": "Or maybe the OP wants to use complex numbers: <a href=\"http://en.cppreference.com/w/c/numeric/complex/csqrt\" rel=\"nofollow noreferrer\"><code>csqrt()</code></a>: <a href=\"https://stackoverflow.com/a/9860772/8051589\">stackoverflow.com/a/9860772/8051589</a>. But I don&#39;t think so, however nice answer! +1"}, {"owner": {"reputation": 23, "user_id": 8537104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c112836154bf83c4b449624561627f?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/8537104/barry"}, "edited": false, "score": 0, "creation_date": 1504113012, "post_id": 45957076, "comment_id": 78891205, "body": "The &#39;fabs&#39; is not working and is generating the same answer(nan) with the negative answer."}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 23, "user_id": 8537104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c112836154bf83c4b449624561627f?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/8537104/barry"}, "edited": false, "score": 0, "creation_date": 1504113490, "post_id": 45957076, "comment_id": 78891470, "body": "@Barry - Sounds like you are using <code>fabs</code> incorrectly. Try <code>A = sqrt(fabs(p*(p-a)*(p-b)*(p-c)));</code>"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 3, "last_activity_date": 1504086977, "last_edit_date": 1504086977, "creation_date": 1504086360, "answer_id": 45957076, "question_id": 45956899, "link": "https://stackoverflow.com/questions/45956899/output-is-coming-as-nan/45957076#45957076", "title": "Output is coming as -nan", "body": "<p>For the input</p>\n\n<pre><code>1.0 2.0 5.0\n</code></pre>\n\n<p>you get</p>\n\n<pre><code>p = 4.0\np - a = 3.0\np - b = 2.0\np - c = -1.0  // notice the sign\n</code></pre>\n\n<p>so you end up with</p>\n\n<pre><code>sqrt(-24.0)  // ups... sqrt of a negative number\n</code></pre>\n\n<p>Consequently you get <code>-nan</code></p>\n\n<p>Maybe you should use <code>fabs</code> to get rid of negative values.</p>\n\n<p><strong>BTW:</strong> <code>nan</code> means \"not a number\" - see <a href=\"https://en.wikipedia.org/wiki/NaN\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/NaN</a></p>\n\n<p><strong>BTW:</strong> Always check the value returned by <code>scanf</code> to make sure it actually scanned the expected number of values, i.e.</p>\n\n<pre><code>if (scanf(\"%lf %lf %lf\",&amp;a,&amp;b,&amp;c) != 3)\n{\n    // Input failure - add error handling...\n    // For instance:\n    printf(\"Illegal input - please provide 3 double as input\\n\");\n    return -1;\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8537104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0c112836154bf83c4b449624561627f?s=128&d=identicon&r=PG&f=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/8537104/barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1504086977, "creation_date": 1504085819, "last_edit_date": 1504085989, "question_id": 45956899, "link": "https://stackoverflow.com/questions/45956899/output-is-coming-as-nan", "title": "Output is coming as -nan", "body": "<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n\nint main()\n{\n  double a,b,c,A,p,   \n  scanf(\"%lf %lf %lf\",&amp;a,&amp;b,&amp;c); //Output is put in integers\n\n  p = (a+b+c)/2;\n\n  A = sqrt(p*(p-a)*(p-b)*(p-c));\n  printf(\"Area of triangle is %lf\",A);\n  //The output is coming out to be -nan for some inputs.\n\n  return 0;         \n}\n</code></pre>\n"}, {"tags": ["c", "scope", "switch-statement"], "comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504084606, "post_id": 45956431, "comment_id": 78870698, "body": "It is UB because it will access unintialized value if expr is not 0. But in this case, no"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504084867, "post_id": 45956431, "comment_id": 78870885, "body": "OK, forgot to ask, why did you think this would be undefined behaviour? Reason?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504084962, "post_id": 45956431, "comment_id": 78870955, "body": "Using a variable before it has been initialized is undefined behaviour. The fact that it has been declared in the switch block rather than outside the switch block doesn&#39;t matter."}, {"owner": {"reputation": 4293, "user_id": 7035151, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce9aa200c854d26a2cd263f6fc8c24eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jayesh", "link": "https://stackoverflow.com/users/7035151/jayesh"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504084994, "post_id": 45956431, "comment_id": 78870971, "body": "@SouravGhosh I thought inside the switch statement, without any casses declared variable not execute."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504086022, "post_id": 45956431, "comment_id": 78871698, "body": "See <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">6.8.4.2 The switch statement p7</a>"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504086280, "post_id": 45956431, "comment_id": 78871882, "body": "@BLUEPIXY Ah, was just updating the same, to add to the answer."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 4, "last_activity_date": 1504086126, "last_edit_date": 1504086126, "creation_date": 1504084590, "answer_id": 45956490, "question_id": 45956431, "link": "https://stackoverflow.com/questions/45956431/declared-variable-within-a-switch-block/45956490#45956490", "title": "Declared variable within a switch block", "body": "<p><strong>In this case</strong>, it is not undefined behaviour.</p>\n\n<p>For <code>case 0</code> (when <code>expr == 0</code>, which is your case), <code>i</code> gets assigned a value before being <em>used</em> (value being read from).</p>\n\n<hr>\n\n<p>OK, to elaborate a bit more, for the snippet</p>\n\n<pre><code>switch (expr)\n    {\n            int i;\n\n            case 0:\n                    i = 17;\n            default:\n                    printf(\"%d\\n\", i);\n    }\n</code></pre>\n\n<p>just makes the variable <code>i</code> defined in the block scope. Even if, the code would have been written as</p>\n\n<pre><code>            int i = 0; //or any value\n</code></pre>\n\n<p>the value of <code>i</code> not initialized, it's just the identifier is visible in the scope. You must have another statement assigning value to <code>i</code> before you can make use of it.</p>\n\n<p>In this regard, the <code>C11</code> standard has a very enlightening example and description. let me quote it, from chapter \u00a76.8.4.2/P7</p>\n\n<blockquote>\n  <p>EXAMPLE In the artificial program fragment</p>\n\n<pre><code>switch (expr)\n{\nint i = 4;\nf(i);\ncase 0:\ni = 17;\n/* falls through into default code */\ndefault:\nprintf(\"%d\\n\", i);\n}\n</code></pre>\n  \n  <p><strong>the object whose identifier is ``i exists with automatic storage duration (within the block) but is never initialized,</strong> and thus if\n  the controlling expression has a nonzero value, the call to the printf\n  function will access an indeterminate value. [....]</p>\n</blockquote>\n"}], "owner": {"reputation": 4293, "user_id": 7035151, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ce9aa200c854d26a2cd263f6fc8c24eb?s=128&d=identicon&r=PG&f=1", "display_name": "Jayesh", "link": "https://stackoverflow.com/users/7035151/jayesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "closed_date": 1504084741, "answer_count": 1, "score": 1, "last_activity_date": 1504088427, "creation_date": 1504084454, "last_edit_date": 1504088427, "question_id": 45956431, "link": "https://stackoverflow.com/questions/45956431/declared-variable-within-a-switch-block", "closed_reason": "Duplicate", "title": "Declared variable within a switch block", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n        int expr = 0;\n\n        switch (expr)\n        {\n                int i;\n\n                case 0:\n                        i = 17;\n                default:\n                        printf(\"%d\\n\", i);\n        }\n        return 0;\n}\n</code></pre>\n\n<p>In the above code, variable <code>i</code> declared within the switch case block and print into default case. Use following command to compiled in GCC compiler on linux platform.</p>\n\n<pre><code>gcc -Wall switch.c \n</code></pre>\n\n<p>and it is print correct output. </p>\n\n<p>So, <strong>is it defined behavior or undefined behavior?</strong></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 5, "creation_date": 1504084466, "post_id": 45956403, "comment_id": 78870606, "body": "What&#39;s the actual question?"}, {"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1504084781, "post_id": 45956403, "comment_id": 78870826, "body": "The code won&#39;t compile due to errors (BUF_S vs BUFF_S) and there is no allocation for res so it&#39;s a bit hard to know what is the issue"}, {"owner": {"reputation": 11, "user_id": 8469094, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kgVJokzTKjI/AAAAAAAAAAI/AAAAAAAAAWA/QwUK6O809Lo/photo.jpg?sz=128", "display_name": "Samuel", "link": "https://stackoverflow.com/users/8469094/samuel"}, "edited": false, "score": 0, "creation_date": 1504085856, "post_id": 45956403, "comment_id": 78871571, "body": "The gcc compiler does not accept the read syntax. It says the the function declaration is invalid in C99."}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 0, "last_activity_date": 1504088033, "last_edit_date": 1504088033, "creation_date": 1504084978, "answer_id": 45956624, "question_id": 45956403, "link": "https://stackoverflow.com/questions/45956403/read-text-form-a-file-into-matrix-in-c-using-read/45956624#45956624", "title": "read text form a file into matrix in c using read", "body": "<p>You are returning pointer to local variable. Local variables are removed from scope (their lifetime has ended) after returning from function, so accessing this address (which doesn't  belong to you anymore) has undefined behavior.</p>\n\n<p>Also this is declaration of <em>pointer-to-array</em></p>\n\n<pre><code>char * res[BUF_S + 1];\n\n+---+          +---+\n| * |---------&gt;|   | res[0][0] (*ret)[0]\n+---+          +---+\n res           |   | res[0][1]\n               +---+\n               |   | ...\n               +---+\n               |   | res[0][BUF_S + 1 - 1]\n               +---+\n</code></pre>\n\n<p>If you apply this operation</p>\n\n<pre><code>res[ret][0] = '\\0';\n</code></pre>\n\n<p>with <code>ret != 0</code> you are invoking undefined behavior.</p>\n\n<hr>\n\n<p>You have to declare it like this (<em>pointer-to-pointer-to-char</em>)</p>\n\n<pre><code>char ** res = malloc(sizeof(char*) * X);  // Where X is number of rows\n</code></pre>\n\n<p>And every row separately</p>\n\n<pre><code>for (int i = 0; i &lt; X; i++)\n{\n    res[i] = malloc(BUF_S + 1);\n}\n</code></pre>\n\n<p>Then you can access different 'rows' (max <code>X-1</code>, <code>X</code> and more would again lead to access outside of bounds and undefined behavior).</p>\n\n<p>Then you will free memory.</p>\n"}], "owner": {"reputation": 11, "user_id": 8469094, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kgVJokzTKjI/AAAAAAAAAAI/AAAAAAAAAWA/QwUK6O809Lo/photo.jpg?sz=128", "display_name": "Samuel", "link": "https://stackoverflow.com/users/8469094/samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504088033, "creation_date": 1504084382, "last_edit_date": 1504087893, "question_id": 45956403, "link": "https://stackoverflow.com/questions/45956403/read-text-form-a-file-into-matrix-in-c-using-read", "title": "read text form a file into matrix in c using read", "body": "<p>I currently try to fix a problem I encountered during a project. I have to read the content of a file (a map) into a matrix, but the first line contains 4 separate characters:</p>\n\n<ol>\n<li>The number of rows</li>\n<li>The empty character's representative</li>\n<li>The obstacle character's representative</li>\n<li>The full character's representative. These I need to enter in an array.</li>\n</ol>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"head.h\"\n\n#define BUF_S 4096\n\nchar    **ft_build_martrix(char *str, int *pr, int *pc, char *blocks)\n{\n  int     fd;\n  int     ret;\n  int     ret2;\n  int     j;\n  char    *res[BUF_S + 1];\n\n  j = 0;\n  fd = open(str, O_RDONLY);\n  if (fd == -1)\n  {\n      ft_putstr(\"map error\");\n  }\n  ret2 = read(fd, blocks, 4); //take the first row out and put it into the array\n  ret = read(fd, res, BUFF_S); //read the file's content into the matrix\n  res[ret][0] = '\\0';\n  *pr = blocks[0] - '0'; // give the number of rows to the r variable that is declared in main and passed as argument, I think that's the equivalent of the $r in c++ ?\n  blocks[0] = blocks[1]; // delete the\n  blocks[1] = blocks[2]; // first character\n  blocks[2] = blocks[3]; // that is already in *pr\n  while (res[1][j] != '\\n')\n      j++;\n  *pc = j; // get the number of column\n  return (res);\n}\n</code></pre>\n"}, {"tags": ["c", "parameter-passing", "function-call"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1504083979, "post_id": 45956228, "comment_id": 78870220, "body": "Well, a pointer to a structure variable...should be doing it."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504084057, "post_id": 45956228, "comment_id": 78870280, "body": "<code>struct player inventory</code> --&gt; <code>struct player *inventory</code>, <code>inventory.weapons[0][TYPE] = ...</code> --&gt; <code>inventory-&gt;weapons[0][TYPE] = ...</code>. at caller side  <code>struct player inventory;</code>.. <code>weapon_equip(&amp;inventory, ...</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504084291, "post_id": 45956228, "comment_id": 78870447, "body": "Also, You should return value."}], "answers": [{"comments": [{"owner": {"reputation": 4082, "user_id": 7893951, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5eWm1.jpg?s=128&g=1", "display_name": "Akira", "link": "https://stackoverflow.com/users/7893951/akira"}, "edited": false, "score": 0, "creation_date": 1504084188, "post_id": 45956272, "comment_id": 78870374, "body": "Please expand your answer with more detailed explanation."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1504084196, "post_id": 45956272, "comment_id": 78870379, "body": "I guess its <code>stringPointer</code> general example, but dereferencing is wrong."}, {"owner": {"reputation": 23294, "user_id": 6345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1f5ce0fac6a8d23e6dced87ab200e669?s=128&d=identicon&r=PG", "display_name": "Johann Gerell", "link": "https://stackoverflow.com/users/6345/johann-gerell"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1504084243, "post_id": 45956272, "comment_id": 78870412, "body": "@DavidBowling well technically, he&#39;s not dereferencing it at all due to operator presedence, so he&#39;s really dereferencing <code>variable</code> as if it would be a pointer :)"}], "tags": [], "owner": {"reputation": 57, "user_id": 8536495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b24005368de390c1a8fdd73f3549083?s=128&d=identicon&r=PG&f=1", "display_name": "sebastian15038", "link": "https://stackoverflow.com/users/8536495/sebastian15038"}, "is_accepted": false, "score": 1, "last_activity_date": 1504084531, "last_edit_date": 1504084531, "creation_date": 1504084015, "answer_id": 45956272, "question_id": 45956228, "link": "https://stackoverflow.com/questions/45956228/how-do-i-change-struct-variables-in-a-c-function/45956272#45956272", "title": "How do I change struct variables in a C function?", "body": "<p>To access the members of a structure using a pointer to that structure, you must use the \u2192 operator as follows \u2212</p>\n\n<pre><code>structPointer-&gt;variable=5\n</code></pre>\n\n<p>Example</p>\n\n<pre><code>struct name{\nint a;\nint b;\n};\n\n\nstruct name *c; \nc-&gt;a=5;\n</code></pre>\n\n<p>or with</p>\n\n<pre><code>(*c).a=5;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "is_accepted": true, "score": 7, "last_activity_date": 1504084090, "creation_date": 1504084090, "answer_id": 45956305, "question_id": 45956228, "link": "https://stackoverflow.com/questions/45956228/how-do-i-change-struct-variables-in-a-c-function/45956305#45956305", "title": "How do I change struct variables in a C function?", "body": "<p>When you pass a struct to a function, all its values are copied (on the stack) as arguments to the function. Changes made to the struct are only visible inside the function. To change the struct outside of the function, use a pointer:</p>\n\n<pre><code>int weapon_equip(struct player *inventory, int in)\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>inventory-&gt;weapons[0][TYPE] = inventory-&gt;weapons[x][TYPE];\n</code></pre>\n\n<p>which is a prettier version of</p>\n\n<pre><code>(*inventory).weapons[0][TYPE] = (*inventory).weapons[x][TYPE];\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7821100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5607a08059d692da9d50aa8e9cb77019?s=128&d=identicon&r=PG&f=1", "display_name": "octagonlord69", "link": "https://stackoverflow.com/users/7821100/octagonlord69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15671, "favorite_count": 2, "accepted_answer_id": 45956305, "answer_count": 2, "score": 2, "last_activity_date": 1504084967, "creation_date": 1504083890, "last_edit_date": 1504084967, "question_id": 45956228, "link": "https://stackoverflow.com/questions/45956228/how-do-i-change-struct-variables-in-a-c-function", "title": "How do I change struct variables in a C function?", "body": "<p>Basically, what I am trying to do is change struct variables inside a function. Here's the code:</p>\n\n<pre><code>int weapon_equip(struct player inventory, int in) {\n    int x = in - 1, y;\n    int previous_wep[4];\n\n    //Stores the values of the previous equipped weapon.\n    for(y = 0; y &lt; 4; y++)\n        previous_wep[y] = inventory.weapons[0][y];\n\n    /* Since the equipped weapon has a first value of 0,\n    I check if the player hasn't chosen a non-existant\n    item, or that he tries to equip the weapon again.*/\n    if(inventory.weapons[x][TYPE] != NULL &amp;&amp; x &gt; 0) {\n        inventory.weapons[0][TYPE] = inventory.weapons[x][TYPE];\n        inventory.weapons[0][MATERIAL] = inventory.weapons[x][MATERIAL];\n        inventory.weapons[0][ITEM] = inventory.weapons[x][ITEM];\n        inventory.weapons[0][VALUE] = inventory.weapons[x][VALUE];\n\n        inventory.weapons[x][TYPE] = previous_wep[TYPE];\n        inventory.weapons[x][MATERIAL] = previous_wep[MATERIAL];\n        inventory.weapons[x][ITEM] = previous_wep[ITEM];\n        inventory.weapons[x][VALUE] = previous_wep[VALUE];\n    }\n}\n</code></pre>\n\n<p>Basically, what the function does is, it changes the first value of the selected weapon array into 0, making it equipped to the player. It swaps the places of the equipped weapon, with the selected weapon to equip.</p>\n\n<p>But the thing is - I have to change a lot of variables in the function, and all of them belong in a struct. I know how to change normal integers in a function(with pointers), but I have no idea how to do it with structure variables.</p>\n"}, {"tags": ["c", "floating-point", "add", "precision"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 5, "creation_date": 1504083138, "post_id": 45955966, "comment_id": 78869686, "body": "What do you mean with &quot;halt&quot;? Does it stop or does it continue to print same value?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1504083190, "post_id": 45955966, "comment_id": 78869720, "body": "Are you aware of precision limitation of floating point data types?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504083193, "post_id": 45955966, "comment_id": 78869725, "body": "You mean it &quot;halts&quot; because it adds data2 without changing data1? Are you aware of the imprecision of float? Your code is perfect to find that special value, where the data2 is so small that its affect cannot be represented in the accumulator data1."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504083435, "post_id": 45955966, "comment_id": 78869872, "body": "@SouravGhosh Please elaborate. Do not assume that &quot;not changing anymore&quot; means &quot;not changing at all&quot;, or that &quot;halt&quot; means &quot;not changing at all&quot;. The value at which changes stop occurring is likely to be higher than the init value."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1504083700, "post_id": 45955966, "comment_id": 78870036, "body": "<code>2000.0001</code> has more precision than <code>float</code> can hold (~7 digits for IEEE-754 single precision)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1504083790, "post_id": 45955966, "comment_id": 78870083, "body": "You should post the exact output of your program, not say vague things like &quot;it halt&quot; (what does this ever mean?)"}, {"owner": {"reputation": 31, "user_id": 8536858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2f4ddbb2e8ee52efb2b5a0e175ffc2?s=128&d=identicon&r=PG&f=1", "display_name": "Avinash Dane", "link": "https://stackoverflow.com/users/8536858/avinash-dane"}, "edited": false, "score": 0, "creation_date": 1504086194, "post_id": 45955966, "comment_id": 78871824, "body": "halt means it continue to print same value &quot;2048&quot;"}, {"owner": {"reputation": 31, "user_id": 8536858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2f4ddbb2e8ee52efb2b5a0e175ffc2?s=128&d=identicon&r=PG&f=1", "display_name": "Avinash Dane", "link": "https://stackoverflow.com/users/8536858/avinash-dane"}, "edited": false, "score": 0, "creation_date": 1504089258, "post_id": 45955966, "comment_id": 78873869, "body": "I have understood the root cause but can anyone tell how to avoid this in c code"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504104884, "post_id": 45955966, "comment_id": 78885999, "body": "@AvinashDane &quot; how to avoid this in c code&quot; --&gt; Step 1:  Consider 2 things: 1) With <i>floating point</i> numbers there are about as many representable <code>float</code> in the range [1.0..2.0] and ranges [1.0e-10..2.0e-10] and [1.0e+10..2.0e+10]. 2) All <code>float</code> take a a fixed about of memory, example 32 bits.  Does that make make sense to you?"}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": false, "score": 2, "last_activity_date": 1504084010, "last_edit_date": 1504084010, "creation_date": 1504083519, "answer_id": 45956108, "question_id": 45955966, "link": "https://stackoverflow.com/questions/45955966/two-floating-point-addition-is-not-changing-result/45956108#45956108", "title": "Two floating point addition is not changing result", "body": "<blockquote>\n  <p>Anyone has idea why this is happening?</p>\n</blockquote>\n\n<p>Because of floating point precision.</p>\n\n<p>Read <a href=\"https://stackoverflow.com/questions/10108053/ranges-of-floating-point-datatype-in-c\">Ranges of floating point datatype in C?</a></p>\n\n<p>Notice that:</p>\n\n<pre><code> 2000.0001\n</code></pre>\n\n<p><em>already exceeds</em> the limit a <code>float</code> can store (~7 digits for IEEE-754 single precision).</p>\n\n<hr>\n\n<p>What happens in your case is that the precision is limited, which results in the \"halting\" issue you report. In other words, after some point, the adition doesn't have any actual effect (which is reflected to the user).</p>\n\n<p>By that I mean that the new sum is <em>so close</em> to the previous sum, that their float reprecentation is the same, causing <code>data1</code> to store the same value.</p>\n\n<p>In <em>your machine</em>, this value is 2048 and all the rest additions by a small \u03b4 do not affect the float representation of <code>data1</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 8536858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2f4ddbb2e8ee52efb2b5a0e175ffc2?s=128&d=identicon&r=PG&f=1", "display_name": "Avinash Dane", "link": "https://stackoverflow.com/users/8536858/avinash-dane"}, "edited": false, "score": 0, "creation_date": 1504089193, "post_id": 45956176, "comment_id": 78873821, "body": "I have understood the root cause but can anyone tell how to avoid this in c code"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504092797, "post_id": 45956176, "comment_id": 78876449, "body": "Cannot at all, you can only use wider floats in order to get the problem later."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504092853, "post_id": 45956176, "comment_id": 78876496, "body": "You can however describe what you actually wan to achieve, in a separate question, show what you have (which is bount to be more/different than this) and ask for more specific help."}, {"owner": {"reputation": 31, "user_id": 8536858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2f4ddbb2e8ee52efb2b5a0e175ffc2?s=128&d=identicon&r=PG&f=1", "display_name": "Avinash Dane", "link": "https://stackoverflow.com/users/8536858/avinash-dane"}, "edited": false, "score": 0, "creation_date": 1504258026, "post_id": 45956176, "comment_id": 78954174, "body": "The application is the energy meter and I want to store the kWh accumulated value and for that I was using float as a data type. I know using double as a data type this problem will be solved."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 4, "last_activity_date": 1504083868, "last_edit_date": 1504083868, "creation_date": 1504083732, "answer_id": 45956176, "question_id": 45955966, "link": "https://stackoverflow.com/questions/45955966/two-floating-point-addition-is-not-changing-result/45956176#45956176", "title": "Two floating point addition is not changing result", "body": "<p>For any floating point value, in combination with a (much) smaller adding delta, there is a value from which adding the delta results in a value which is so \"similar\" to the previous one, that the representation in float is identical.</p>\n\n<p>Your code is practically tailor-made to find that value.</p>\n\n<p>So, while at first adding delta to 2000 and a few following values results in visible changes, your code will sooner or later (quite soon actually) reach the special value. Which I assume in your case is 2048.<br>\n<code>2048.0</code> and <code>2048.0001</code> have no different representation in float. Hence the adding has no effect on the variable.</p>\n"}], "owner": {"reputation": 31, "user_id": 8536858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2f4ddbb2e8ee52efb2b5a0e175ffc2?s=128&d=identicon&r=PG&f=1", "display_name": "Avinash Dane", "link": "https://stackoverflow.com/users/8536858/avinash-dane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "closed_date": 1504084685, "accepted_answer_id": 45956176, "answer_count": 2, "score": 2, "last_activity_date": 1504084875, "creation_date": 1504083069, "last_edit_date": 1504084202, "question_id": 45955966, "link": "https://stackoverflow.com/questions/45955966/two-floating-point-addition-is-not-changing-result", "closed_reason": "Duplicate", "title": "Two floating point addition is not changing result", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n\n    int loopCounter = 0;    \n    float data1,data2;\n\n    data1 = 2000.0f;\n    data2 = 0.0001f;\n\n    while(1)\n    {               \n      data1 = data1 + data2;\n      printf(\"Loop Counter %d , Data %f\\n\",loopCounter,data1);\n      loopCounter++;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I am running this code on Linux machine using the GCC compiler but if the addition of the 2 float reaches the value <code>2048.0</code> it does not change anymore.</p>\n\n<p>Does anyone have an idea why this is happening?</p>\n"}, {"tags": ["c", "arrays", "pointers", "type-conversion"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1504082467, "post_id": 45955669, "comment_id": 78869281, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20486661/pointer-arithmetic-char-a1-char-a0-4\">pointer arithmetic (char*) &amp;a&#91;1&#93; - (char *)&amp;a&#91;0&#93; == 4</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1170, "user_id": 5682416, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eca9557bc24253c2921579ad1644f234?s=128&d=identicon&r=PG&f=1", "display_name": "Hugal31", "link": "https://stackoverflow.com/users/5682416/hugal31"}, "is_accepted": true, "score": 6, "last_activity_date": 1504082784, "last_edit_date": 1504082784, "creation_date": 1504082397, "answer_id": 45955753, "question_id": 45955669, "link": "https://stackoverflow.com/questions/45955669/c-int-array-to-char-conversion/45955753#45955753", "title": "C - int array to char* conversion", "body": "<p>The size of a uint32 is 32 bits, or 4 bytes. When you do <code>(char*)array+8</code>, you cast the array into an array of char, and take the eighth character. Here, the eighth character contains the beginning of the integer <code>23</code>, which fits into a char.</p>\n"}, {"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 3, "last_activity_date": 1504082739, "last_edit_date": 1504082739, "creation_date": 1504082401, "answer_id": 45955754, "question_id": 45955669, "link": "https://stackoverflow.com/questions/45955669/c-int-array-to-char-conversion/45955754#45955754", "title": "C - int array to char* conversion", "body": "<p>If you think about it, you have casted the array to <code>char*</code>. Where sizeof char is 1B.\nWhich means usage pointer arithmetics in this case <code>+8</code> doesnt move you <code>8*sizeof(uint32_t)</code> to nineth element of array, but only 8 Bytes (<code>8*sizeof(char)</code>).</p>\n\n<p>Since <code>uint32_t</code> has 4 Bytes, you have moved to first byte of 3rd element 23.</p>\n\n<p>First you have to use pointer arithmetics on <code>uint32_t</code> array and after that cast it to char, like</p>\n\n<pre><code>*p = (char)*(array+8);  // Prints 8\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 8536495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b24005368de390c1a8fdd73f3549083?s=128&d=identicon&r=PG&f=1", "display_name": "sebastian15038", "link": "https://stackoverflow.com/users/8536495/sebastian15038"}, "is_accepted": false, "score": 4, "last_activity_date": 1504082514, "creation_date": 1504082514, "answer_id": 45955798, "question_id": 45955669, "link": "https://stackoverflow.com/questions/45955669/c-int-array-to-char-conversion/45955798#45955798", "title": "C - int array to char* conversion", "body": "<pre><code>*p = *((char*)array+8*sizeof(uint32_t)\n</code></pre>\n\n<p>to move to array[8]\nin your example you are only moving 8 bytes forward </p>\n"}], "owner": {"reputation": 141, "user_id": 8536825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/119123301ea463e9d4f1fc40e90e9795?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/8536825/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1319, "favorite_count": 0, "accepted_answer_id": 45955753, "answer_count": 3, "score": 3, "last_activity_date": 1504087226, "creation_date": 1504082161, "last_edit_date": 1504087226, "question_id": 45955669, "link": "https://stackoverflow.com/questions/45955669/c-int-array-to-char-conversion", "title": "C - int array to char* conversion", "body": "<p>I have a question to the conversion of <code>int</code> array to <code>char*</code>. The following code has the output <code>23</code>. But I don't really understand why. Can someone explain it to me?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(){\n    uint32_t x;\n    uint32_t* p = (uint32_t*) malloc(sizeof(uint32_t));    \n    uint32_t array[9] = {42, 5, 23, 82, 127, 21, 324, 3, 8};\n\n    *p = *((char*)array+8);\n    printf(\"1: %d\\n\", *p);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1504080940, "post_id": 45955230, "comment_id": 78868406, "body": "You cannot &quot;calculate&quot; CLOCKS_PER_SEC. It&#39;s a given. You should determine what you want to output if your execution time is less than.one second."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1504081075, "post_id": 45955230, "comment_id": 78868487, "body": "By the way the semantics of <code>clock</code> is non-standard on Windows, so if you want portable results you should not be using this function."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1504081119, "post_id": 45955230, "comment_id": 78868514, "body": "Did you read <a href=\"http://man7.org/linux/man-pages/man7/time.7.html\" rel=\"nofollow noreferrer\">time(7)</a>? For Linux you should!"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1504082175, "post_id": 45955230, "comment_id": 78869123, "body": "<code>clock()</code> returns <code>clock_t</code> not <code>time_t</code>."}], "answers": [{"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1504080857, "creation_date": 1504080857, "answer_id": 45955274, "question_id": 45955230, "link": "https://stackoverflow.com/questions/45955230/how-to-get-running-time-using-the-clock-function/45955274#45955274", "title": "How to get running time using the clock () function", "body": "<p>The problem is that <code>endTime</code>, <code>startTime</code> and <code>CLOCKS_PER_SEC</code> are all <em>integers</em>. You need to cast at least one of the values to a floating point type. <em>And</em> use a floating point type for destination.</p>\n\n<p>E.g.</p>\n\n<pre><code>double gap = (double) (endTime - startTime) / CLOCKS_PER_SEC;\nprintf(\"RunningTime: %f sec\", gap);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1504082842, "last_edit_date": 1504082842, "creation_date": 1504081354, "answer_id": 45955430, "question_id": 45955230, "link": "https://stackoverflow.com/questions/45955230/how-to-get-running-time-using-the-clock-function/45955430#45955430", "title": "How to get running time using the clock () function", "body": "<p><sup>(I am focusing on Linux)</sup></p>\n\n<p>Read first <a href=\"http://man7.org/linux/man-pages/man7/time.7.html\" rel=\"nofollow noreferrer\">time(7)</a>. Then read <a href=\"http://man7.org/linux/man-pages/man2/clock_gettime.2.html\" rel=\"nofollow noreferrer\">clock_gettime(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/getrusage.2.html\" rel=\"nofollow noreferrer\">getrusage(2)</a>, <a href=\"http://man7.org/linux/man-pages/man2/times.2.html\" rel=\"nofollow noreferrer\">times(2)</a>, <a href=\"http://man7.org/linux/man-pages/man3/clock.3.html\" rel=\"nofollow noreferrer\">clock(3)</a> (the notes are important).</p>\n\n<p>There are several different notions of time: real, elapsed, process CPU, thread CPU. You need to choose the right one. Notice that some functions return time in seconds and microseconds or nanoseconds (using some <code>struct</code>). You might want to convert them to a <code>double</code> (and sometimes lose precision). Notice that real wall clock time might change (e.g. <a href=\"http://man7.org/linux/man-pages/man2/adjtimex.2.html\" rel=\"nofollow noreferrer\">adjtimex(2)</a>...) in some unexpected (non-monotonic) way.</p>\n\n<p>On some cheap systems (notably 32 bits embedded Linux systems), be aware of the <a href=\"https://en.wikipedia.org/wiki/Year_2038_problem\" rel=\"nofollow noreferrer\">Y2038 problem</a></p>\n\n<blockquote>\n  <p>Can I calculate CLOCKS_PER_SEC as 1,000 as in Windows?</p>\n</blockquote>\n\n<p><code>CLOCKS_PER_SEC</code> is semantically a constant that you cannot change (even on Windows). It is provided by the system (and on POSIX is <em>required</em> to be 1000000, so on Linux <code>clock()</code> gives process CPU \u00b5s). See also <a href=\"http://man7.org/linux/man-pages/man3/sysconf.3.html\" rel=\"nofollow noreferrer\">sysconf(3)</a> for <code>_SC_CLK_TCK</code> (relevant for <a href=\"http://man7.org/linux/man-pages/man2/times.2.html\" rel=\"nofollow noreferrer\">times(2)</a>).</p>\n"}], "owner": {"reputation": 11, "user_id": 7608927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa36e3562bfaa114b7b443d427d16378?s=128&d=identicon&r=PG&f=1", "display_name": "user7608927", "link": "https://stackoverflow.com/users/7608927/user7608927"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 45955430, "answer_count": 2, "score": 0, "last_activity_date": 1504082842, "creation_date": 1504080723, "question_id": 45955230, "link": "https://stackoverflow.com/questions/45955230/how-to-get-running-time-using-the-clock-function", "title": "How to get running time using the clock () function", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\nint main()\n{\n  time_t startTime, endTime;\n  while(1)\n  {\n    startTime = clock();\n    /*\n       Some processing\n    */\n    endTime = clock();\n    gap = (int)((endTime - startTime) / (CLOCKS_PER_SEC));\n    printf(\"StartTime: %d, EndTime: %d\\n\", (int)startTime, (int)endTime);\n    printf(\"RunningTime: %d sec\", gap);\n  }\n}\n</code></pre>\n\n<p>Output:<br>\nStartTime: 1962, EndTime: 19247<br>\nRunningTime: 0 sec</p>\n\n<p>I found out that this happens because CLOCKS_PER_SEC is 1,000,000 on Ubuntu.<br>\nCan I calculate CLOCKS_PER_SEC as 1,000 as in Windows?</p>\n"}, {"tags": ["c", "string", "turbo-c"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504080632, "post_id": 45955154, "comment_id": 78868233, "body": "<code>sprintf(bin, &quot;%d&quot;, modulus);</code> You always write  from front."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504080769, "post_id": 45955154, "comment_id": 78868308, "body": "It&#39;s not trivial because it writes the digits reversed. I had posted an answer but it prints the binary string reversed, so no good. recursion or reverse the string afterwards should solve it."}, {"owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "edited": false, "score": 0, "creation_date": 1504080782, "post_id": 45955154, "comment_id": 78868319, "body": "And to not always write from the front, increment your pointer (<code>bin</code>) every time you write to it (but maintain a reference to the start of the string for the return)."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504080919, "post_id": 45955154, "comment_id": 78868391, "body": "@Jean-Fran&#231;oisFabre The expected result of OP is reversed. E.g <code>0101</code> : <code>10</code> (base 10)"}, {"owner": {"reputation": 46, "user_id": 7770265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7966d6cecc830387fad230dfa2837ed?s=128&d=identicon&r=PG&f=1", "display_name": "UbadahJ", "link": "https://stackoverflow.com/users/7770265/ubadahj"}, "edited": false, "score": 0, "creation_date": 1504081012, "post_id": 45955154, "comment_id": 78868449, "body": "I know that the answer would be reversed that is why I am taking result as a string and then reversing it to print as output."}, {"owner": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 1, "creation_date": 1504081224, "post_id": 45955154, "comment_id": 78868571, "body": "NB: You don&#39;t need to decrement an odd value before dividing. E.g. 5/2 in integer division is 2, as it rounds down"}, {"owner": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 0, "creation_date": 1504081408, "post_id": 45955154, "comment_id": 78868704, "body": "BLUEPIXY&#39;s comment contains the answer. <code>sprintf</code> overrides the string, so you start anew in each iteration. You need to find a way to concatenate the strings"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 0, "creation_date": 1504081626, "post_id": 45955154, "comment_id": 78868819, "body": "@king_nak <i>overrides</i> -&gt; <i>overwrites</i>."}], "answers": [{"tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": false, "score": 0, "last_activity_date": 1504082419, "last_edit_date": 1504082419, "creation_date": 1504080646, "answer_id": 45955211, "question_id": 45955154, "link": "https://stackoverflow.com/questions/45955154/adding-integers-as-char-to-create-a-string-in-c/45955211#45955211", "title": "Adding integers as char to create a string in C", "body": "<p>of course, you're printing on the same <code>bin</code> location, not moving your \"cursor\".</p>\n\n<p>Declare a pointer on the string and increment it after each <code>sprintf</code>, should work, since <code>sprintf</code> issues only 1 digit + null-termination char.</p>\n\n<pre><code>char bin[9];\nchar *ptr = bin;\n  while (decimal != 0) {\n    modulus = decimal % 2;\n    sprintf(ptr, \"%d\", modulus);\n    ptr++;\n</code></pre>\n\n<p>that generates the string, but reversed (because lower bits are processed first). Just print it reversed or reverse it afterwards.</p>\n\n<pre><code> int l = strlen(bin);\n for (i=0;i&lt;l;i++)\n {\n     putc(bin[l-i-1]);\n }\n putc(\"\\n\");\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 46, "user_id": 7770265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7966d6cecc830387fad230dfa2837ed?s=128&d=identicon&r=PG&f=1", "display_name": "UbadahJ", "link": "https://stackoverflow.com/users/7770265/ubadahj"}, "edited": false, "score": 0, "creation_date": 1504081143, "post_id": 45955309, "comment_id": 78868530, "body": "Isn&#39;t there anyway to create a string using integers? Your answer is what I wanted, ir is just that I wanted to learn what I have done wrong"}], "tags": [], "owner": {"reputation": 852, "user_id": 3227496, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/874115077/picture?type=large", "display_name": "Hans Petter Taugb&#248;l Kragset", "link": "https://stackoverflow.com/users/3227496/hans-petter-taugb%c3%b8l-kragset"}, "is_accepted": false, "score": 0, "last_activity_date": 1504080950, "creation_date": 1504080950, "answer_id": 45955309, "question_id": 45955154, "link": "https://stackoverflow.com/questions/45955154/adding-integers-as-char-to-create-a-string-in-c/45955309#45955309", "title": "Adding integers as char to create a string in C", "body": "<p>Here is a function that prints a decimal as binary:</p>\n\n<pre><code>void print_binary(int num)\n{\n    int pos = (sizeof(int) * 8) - 1;\n    printf(\"%10d: \", num);\n\n    for (int i = 0; i &lt; (int)(sizeof(int) * 8); i++) {\n        char c = num &amp; (1 &lt;&lt; pos) ? '1' : '0';\n        putchar(c);\n        if (!((i + 1) % 8))\n            putchar(' ');\n        pos--;\n    }\n    putchar('\\n');\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>        42: 00000000 00000000 00000000 00101010\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 46, "user_id": 7770265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7966d6cecc830387fad230dfa2837ed?s=128&d=identicon&r=PG&f=1", "display_name": "UbadahJ", "link": "https://stackoverflow.com/users/7770265/ubadahj"}, "edited": false, "score": 0, "creation_date": 1504082059, "post_id": 45955595, "comment_id": 78869052, "body": "Thanks for your answer. I actually made the same code from following the advice from the comments. However your code confirmed my code. Thanks!"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504082213, "post_id": 45955595, "comment_id": 78869148, "body": "doesn&#39;t that generate the number reversed?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504082259, "post_id": 45955595, "comment_id": 78869179, "body": "@Jean-Fran&#231;oisFabre yes it does, read the second sentence of the answer."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504082461, "post_id": 45955595, "comment_id": 78869274, "body": "ok, so I&#39;m undeleting my answer, it&#39;s simpler because it&#39;s not using temporary &amp; strcat."}, {"owner": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 0, "creation_date": 1504082926, "post_id": 45955595, "comment_id": 78869553, "body": "You could remove the <code>temp</code> and <code>strcat</code>by using <code>sprintf(bin, &quot;%s%d&quot;, bin, modulus)</code>. Then, to get the string in the correct order, just reverse the parameters: <code>sprintf(bin, &quot;%d%s&quot;, modulus, bin)</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 10619, "user_id": 345027, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de94a2d703fa12904d400de1fc86c251?s=128&d=identicon&r=PG", "display_name": "king_nak", "link": "https://stackoverflow.com/users/345027/king-nak"}, "edited": false, "score": 1, "creation_date": 1504083960, "post_id": 45955595, "comment_id": 78870204, "body": "@king_nak using <code>sprintf</code> to print a string into itself results definitely in undefined behaviour: <a href=\"https://stackoverflow.com/questions/1973572/can-the-input-and-output-strings-to-sprintf-be-the-same/\" title=\"can the input and output strings to sprintf be the same\">stackoverflow.com/questions/1973572/&hellip;</a>"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": true, "score": 0, "last_activity_date": 1504082289, "last_edit_date": 1504082289, "creation_date": 1504081932, "answer_id": 45955595, "question_id": 45955154, "link": "https://stackoverflow.com/questions/45955154/adding-integers-as-char-to-create-a-string-in-c/45955595#45955595", "title": "Adding integers as char to create a string in C", "body": "<p>This is exactly your function with slight modifications and comments.</p>\n\n<p>The binary string is still reversed though.</p>\n\n<pre><code>void binary(int decimal) {\n  int modulus;\n  char bin[9];\n  char temp[2];   // temporary string for sprintf\n\n  bin[0] = 0;     // initially binary string set to \"\" (empty string)\n\n  while (decimal != 0) {\n    modulus = decimal % 2;\n\n    sprintf(temp, \"%d\", modulus);  // print '1' or '0' to temporary string\n    strcat(bin, temp);             // concatenate temporary string to bin\n\n    if (modulus == 1) {\n      decimal--;\n    }\n    decimal = decimal / 2;\n  }\n  puts(bin);\n}\n</code></pre>\n\n<p>There are more efficient ways to achieve this, especially makeing use of the  left shift operator (<code>&lt;&lt;</code>), that way you can construct the binary string directly without needing to reverse it at the end.</p>\n"}], "owner": {"reputation": 46, "user_id": 7770265, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c7966d6cecc830387fad230dfa2837ed?s=128&d=identicon&r=PG&f=1", "display_name": "UbadahJ", "link": "https://stackoverflow.com/users/7770265/ubadahj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 45955595, "answer_count": 3, "score": 0, "last_activity_date": 1504082538, "creation_date": 1504080511, "last_edit_date": 1504082538, "question_id": 45955154, "link": "https://stackoverflow.com/questions/45955154/adding-integers-as-char-to-create-a-string-in-c", "title": "Adding integers as char to create a string in C", "body": "<p>I wanted to ask if there is a way to add integers as char values and create a string. I have written some code but only last digit is detected</p>\n\n<pre><code>void binary(int decimal) {\n  int modulus;\n  char bin[9];\n  while (decimal != 0) {\n    modulus = decimal % 2;\n    sprintf(bin, \"%d\", modulus);\n    if (modulus == 1) {\n      decimal--;\n    }\n    decimal = decimal / 2;\n  }\n  puts(bin);\n}\n</code></pre>\n\n<p>If the decimal is <code>10</code> then the holds only <code>1</code> instead <code>0101</code>. How can I fix it? I am using Turbo C++ 3.0.</p>\n"}, {"tags": ["c", "md5", "hmac", "stm32f4"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1504082528, "post_id": 45955138, "comment_id": 78869323, "body": "What do you mean by &#39;&quot;Output&quot; is still empty&#39;? Zeros? A test pattern (non-zeros written before, to be able to detect zeros being written over it) still in there? How is <code>Result</code> initialised? Not, as in the quote? Init it to something other than &quot;SUCCESS&quot;."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504082704, "post_id": 45955138, "comment_id": 78869425, "body": "You might want to create an actual <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. For the &quot;V&quot; you can assume that readers have the library available, i.e. you do not need to provide it."}, {"owner": {"reputation": 61, "user_id": 8536523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b9f6168ab6d59212c2bc460f5b3af?s=128&d=identicon&r=PG&f=1", "display_name": "Indri", "link": "https://stackoverflow.com/users/8536523/indri"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504087739, "post_id": 45955138, "comment_id": 78872855, "body": "Yes,<code>Output</code> is full of zeros (&#39;\\0&#39;). I hadn&#39;t initialised <code>Result</code> and <code>HMAC_Response</code>. Now, I have done it, with ERROR and &#39;1&#39;, but I get the same results (SUCCES and \\0). Ok, I will try with a &quot;M, C and V example&quot;"}, {"owner": {"reputation": 61, "user_id": 8536523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b9f6168ab6d59212c2bc460f5b3af?s=128&d=identicon&r=PG&f=1", "display_name": "Indri", "link": "https://stackoverflow.com/users/8536523/indri"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504248296, "post_id": 45955138, "comment_id": 78949098, "body": "It still doesn&#39;t work. I have been trying since thuedsay. Unsucessful.."}, {"owner": {"reputation": 624, "user_id": 2215092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XeaHx.png?s=128&g=1", "display_name": "hamboy75", "link": "https://stackoverflow.com/users/2215092/hamboy75"}, "edited": false, "score": 0, "creation_date": 1518777359, "post_id": 45955138, "comment_id": 84653232, "body": "Same problem here with IAR, just using HASH_MD5 (I get zeroes on HASH_MD5), did you fix it?"}], "answers": [{"tags": [], "owner": {"reputation": 624, "user_id": 2215092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XeaHx.png?s=128&g=1", "display_name": "hamboy75", "link": "https://stackoverflow.com/users/2215092/hamboy75"}, "is_accepted": false, "score": 0, "last_activity_date": 1519030031, "last_edit_date": 1519030031, "creation_date": 1518779050, "answer_id": 48825395, "question_id": 45955138, "link": "https://stackoverflow.com/questions/45955138/function-hmac-md5-return-succes-but-no-value/48825395#48825395", "title": "Function HMAC_MD5 : Return succes but no value", "body": "<p>I had the same problem that you had using STM32 Hashing hardware. After a few tries I decided to use a md5 library</p>\n\n<p>Since I'm using lwip in my project I noticed that LWIP has a md5 module inside ppp.</p>\n\n<p>Just get the files needed (md5.c, md5.h) from lwip (inside lwip /src/netif/ppp/md5.c), and copy it to your proyect.</p>\n\n<p>Change the non-working line</p>\n\n<pre><code>uint32_t dev=HASH_MD5((uint8_t *) input, strlen((char *) input), Md5);\n</code></pre>\n\n<p>for</p>\n\n<pre><code>MD5_CTX mdContext;\nMD5Init(&amp;mdContext);\nMD5Update(&amp;mdContext, input, strlen((char *) input));\nMD5Final(Md5,&amp;mdContext);\n</code></pre>\n\n<p>Edited: Since i dont use ppp in the project, i have copied the md5 file from ppp to the project and I edited it a bit, removing all include references (except md5.h and string.h) and removing conditional compilation:</p>\n\n<p>This is the stuff that I removed at the beginning</p>\n\n<pre><code>//#if PPP_SUPPORT /* don't build if not configured for use in lwipopts.h */\n\n//#if CHAP_SUPPORT || MD5_SUPPORT\n\n//#include \"ppp.h\"\n//#include \"pppdebug.h\"\n</code></pre>\n\n<p>And this at the end:</p>\n\n<pre><code>//#endif /* CHAP_SUPPORT || MD5_SUPPORT */\n\n//#endif /* PPP_SUPPORT */\n</code></pre>\n\n<p>You can download the source code for md5.c and md5.h here </p>\n\n<p><a href=\"https://github.com/goertzenator/lwip/blob/master/lwip-1.4.0/src/netif/ppp/md5.c\" rel=\"nofollow noreferrer\">https://github.com/goertzenator/lwip/blob/master/lwip-1.4.0/src/netif/ppp/md5.c</a>\n<a href=\"https://github.com/goertzenator/lwip/blob/master/lwip-1.4.0/src/netif/ppp/md5.h\" rel=\"nofollow noreferrer\">https://github.com/goertzenator/lwip/blob/master/lwip-1.4.0/src/netif/ppp/md5.h</a></p>\n"}, {"tags": [], "owner": {"reputation": 1265, "user_id": 1929164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OnEqy.jpg?s=128&g=1", "display_name": "Miloslaw Smyk", "link": "https://stackoverflow.com/users/1929164/miloslaw-smyk"}, "is_accepted": false, "score": 1, "last_activity_date": 1616822291, "last_edit_date": 1616822291, "creation_date": 1616821863, "answer_id": 66828203, "question_id": 45955138, "link": "https://stackoverflow.com/questions/45955138/function-hmac-md5-return-succes-but-no-value/66828203#66828203", "title": "Function HMAC_MD5 : Return succes but no value", "body": "<p>Let me guess. You're using STM32F405 or STM32F407, right? These parts lack the hash processor, and thus always return zeros for the digest. ST kind of documented it by opening the section on hash processor in the manual with &quot;This section applies to STM32F415/417xx and STM32F43xxx devices.&quot;, but a quick Google search demonstrates that you are not the first person that expected this sort of information to be present in a more prominent place (datasheet, family comparison doc, product selector, etc).</p>\n<p>And yes, I fully agree that an MCU with a missing hash processor should not report success on operations that use said hash processor, but that's apparently not how folks at ST roll.</p>\n<p>Anyway. You will need to upgrade to SMT32F415 (or STM32F417) to get hardware accelerated hashing. If that's not an option, well, there is always a software implementation.</p>\n"}], "owner": {"reputation": 61, "user_id": 8536523, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34b9f6168ab6d59212c2bc460f5b3af?s=128&d=identicon&r=PG&f=1", "display_name": "Indri", "link": "https://stackoverflow.com/users/8536523/indri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1616822291, "creation_date": 1504080463, "last_edit_date": 1504108304, "question_id": 45955138, "link": "https://stackoverflow.com/questions/45955138/function-hmac-md5-return-succes-but-no-value", "title": "Function HMAC_MD5 : Return succes but no value", "body": "<p>I have got some problems trying to programm the HMAC_MD5 code.</p>\n\n<p>I am working in C on a STM32F4 microprocessor.</p>\n\n<p>Here is my (updated) code:</p>\n\n<pre><code>RCC_AHB2PeriphClockCmd(RCC_AHB2Periph_HASH, ENABLE); static uint8_t \n\nstatic Challenge[16] = \"ldopwhjtsnkiaq8f\";\nstatic uint8_t Key[16] = \"abcdefghijklmnop\";\nstatic uint8_t* HMAC_Key;\nstatic uint8_t* HMAC_Input;\nstatic uint8_t HMAC_Response1[16];\nstatic uint8_t HMAC_Response2[16];\n\nint m = 0;\n\nHMAC_Input = &amp;Challenge[0];\nHMAC_Key = &amp;Key[0];\n\nErrorStatus Result = ERROR;\nfor(m=0;m&lt;16;m++){\n    HMAC_Response1[m]=1;\n    HMAC_Response2[m]=2;\n}\n\nResult = HASH_MD5(HMAC_Input, 16, HMAC_Response1);\nResult = HMAC_MD5(HMAC_Key, 16, HMAC_Input, 16, HMAC_Response2);\n</code></pre>\n\n<p>That is the official description of the HMAC_MD5 function (<a href=\"https://github.com/espruino/Espruino/blob/master/targetlibs/stm32f4/lib/stm32f4xx_hash_md5.c\" rel=\"nofollow noreferrer\">https://github.com/espruino/Espruino/blob/master/targetlibs/stm32f4/lib/stm32f4xx_hash_md5.c</a>):</p>\n\n<pre><code>/**\n    * @brief  Compute the HMAC MD5 digest.\n    * @param  Key: pointer to the Key used for HMAC.\n    * @param  Keylen: length of the Key used for HMAC.\n    * @param  Input: pointer to the Input buffer to be treated.\n    * @param  Ilen: length of the Input buffer\n    * @param  Output: the returned digest\n    * @retval An ErrorStatus enumeration value:\n    *          - SUCCESS: digest computation done\n    *          - ERROR: digest computation failed\n    */\n\nErrorStatus HMAC_MD5(uint8_t *Key, uint32_t Keylen, uint8_t *Input, \n                     uint32_t Ilen, uint8_t Output[16])\n</code></pre>\n\n<p>The function returns the value \"SUCCESS\" but the digest \"Output\" is still empty (full of '\\0').</p>\n\n<p>I don't get any warning from the compiler (Attolic TrueStudio) and I cannot change the value of the Key or of the Challenge (Concatenation), because the server is already running with older systems.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504080538, "post_id": 45955127, "comment_id": 78868167, "body": "I fear that you&#39;ll have to use shared memory for this. Memory protection, virtualization, paging... will prevent a process from accessing another process memory otherwise."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1504080550, "post_id": 45955127, "comment_id": 78868180, "body": "That&#39;s the default. Remember that Linux uses <i>virtual memory</i>. A memory address in one process doesn&#39;t have to the same in another process (even if the processes were created from the same executable). And unless they explicitly shares memory, then no other process should be able to access the memory of another process."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1504080973, "post_id": 45955127, "comment_id": 78868426, "body": "Unless you take action to permit another process to access the variable, it is unique to just the one process."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1504081150, "post_id": 45955127, "comment_id": 78868538, "body": "Can you perhaps elaborate on your question? <b><i>Why</i></b> do you wonder? What is the <i>actual</i> problem you have?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504082260, "post_id": 45955127, "comment_id": 78869180, "body": "None of what you are talking about makes any sense. As a C newbie you should not be worrying about processess or addresses or memory protection before you actually encounter a problem with any of these. If you have a problem with your C program, post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "is_accepted": false, "score": 2, "last_activity_date": 1504081736, "creation_date": 1504081736, "answer_id": 45955536, "question_id": 45955127, "link": "https://stackoverflow.com/questions/45955127/is-there-any-system-call-that-blocks-the-memory/45955536#45955536", "title": "is there any system call that blocks the memory", "body": "<p>That's precisely how operating systems with <a href=\"https://en.wikipedia.org/wiki/Memory_protection\" rel=\"nofollow noreferrer\">memory protection</a> work:</p>\n\n<blockquote>\n  <p>The main purpose of memory protection is to prevent a process from\n  accessing memory that has not been allocated to it. This prevents a\n  bug or malware within a process from affecting other processes, or the\n  operating system itself. An attempt to access unowned memory results\n  in a hardware fault, called a segmentation fault or storage violation\n  exception, generally causing abnormal termination of the offending\n  process.</p>\n</blockquote>\n\n<p>Virtually every general-purpose OS today uses memory protection, so you already have it.</p>\n"}], "owner": {"reputation": 51, "user_id": 6124372, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/09907019842c58d954a10ede277ee994?s=128&d=identicon&r=PG&f=1", "display_name": "sravanthi", "link": "https://stackoverflow.com/users/6124372/sravanthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1504110037, "answer_count": 1, "score": 0, "last_activity_date": 1504081736, "creation_date": 1504080439, "question_id": 45955127, "link": "https://stackoverflow.com/questions/45955127/is-there-any-system-call-that-blocks-the-memory", "closed_reason": "Needs details or clarity", "title": "is there any system call that blocks the memory", "body": "<p>i am newbie to c and Linux , In  my c program one.c, i have a variable x=10 stored at address some 0x34.now,i don't want any other process to access this memory location except that one.c.no other process should overwrite, or can access this location...is there any system call which supports this ?thank you in advance</p>\n"}, {"tags": ["c", "opencv"], "answers": [{"tags": [], "owner": {"reputation": 2725, "user_id": 2251058, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8ffc7bebb06ae9943708d99f3621c1b5?s=128&d=identicon&r=PG", "display_name": "Akshay Hazari", "link": "https://stackoverflow.com/users/2251058/akshay-hazari"}, "is_accepted": true, "score": 0, "last_activity_date": 1504766846, "last_edit_date": 1504766846, "creation_date": 1504082466, "answer_id": 45955773, "question_id": 45955003, "link": "https://stackoverflow.com/questions/45955003/zlib-linking-globals-named-dist-code-symbol-multiply-defined/45955773#45955773", "title": "zlib - Linking globals named &#39;_dist_code&#39;: symbol multiply defined", "body": "<p>For this error specific to zlib, similar to what they've said here <a href=\"http://www.shiva-engine.com/forum/viewtopic.php?f=76&amp;t=27858\" rel=\"nofollow noreferrer\">http://www.shiva-engine.com/forum/viewtopic.php?f=76&amp;t=27858</a> , I've found something similar working for me.</p>\n\n<p>There seem to be three files namely trees.h , trees.c and deflate.h where _dist_code is defined. </p>\n\n<p>As a temporary fix only for this case, I've just called all the variables along with this one which give a problem in <code>.h</code> files as static.</p>\n\n<pre><code>static uch ZLIB_INTERNAL _dist_code[DIST_CODE_LEN] ={\n..\n..}  \n</code></pre>\n\n<p>For more problems later I just commented all the options for sse in OpenCV CmakeLists.txt file to remove the SIMD errors.  </p>\n\n<p>Hope this helps someone. Any better solution is welcome.</p>\n"}], "owner": {"reputation": 2725, "user_id": 2251058, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/8ffc7bebb06ae9943708d99f3621c1b5?s=128&d=identicon&r=PG", "display_name": "Akshay Hazari", "link": "https://stackoverflow.com/users/2251058/akshay-hazari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 45955773, "answer_count": 1, "score": 1, "last_activity_date": 1504766846, "creation_date": 1504079998, "last_edit_date": 1504081676, "question_id": 45955003, "link": "https://stackoverflow.com/questions/45955003/zlib-linking-globals-named-dist-code-symbol-multiply-defined", "title": "zlib - Linking globals named &#39;_dist_code&#39;: symbol multiply defined", "body": "<p>I am trying to install OpenCV from a build created using crosscompilation c , c++ libraries (emscripten). </p>\n\n<p>I have come across this website which points out a similar issue with zlib while including external libs on Android.\n<a href=\"http://www.shiva-engine.com/forum/viewtopic.php?f=76&amp;t=27858\" rel=\"nofollow noreferrer\">http://www.shiva-engine.com/forum/viewtopic.php?f=76&amp;t=27858</a></p>\n\n<p>He mentions a list of conflicting symbols - </p>\n\n<pre><code>z_errmsg\nzcfree\nzcalloc\n_tr_init\n_tr_tally\n_length_code\n_dist_code\n_tr_align\n_tr_stored_block\n_tr_flush_block\ninflate_table\ninflate_copyright\n</code></pre>\n\n<p>The error mentions global variables multiply defined for the above variables.</p>\n\n<p>The link above tells me to change the variable name in .h files and calls it as a dirty hack. </p>\n\n<p>I tried to change variable name in the tree.h file. Also tried to add an <code>extern</code> before the name as per this <a href=\"https://stackoverflow.com/questions/14855915/creating-global-variables-causes-linker-error\">creating global variables causes linker error</a>. But the error simply changes to <code>Linking globals named 'my_new_variable_name'</code> or with extern it shows the same error.</p>\n\n<pre><code>const uch ZLIB_INTERNAL _dist_code[DIST_CODE_LEN] ={\n..\n..}\n</code></pre>\n\n<p>Anyone who can understand the link or how I must rename or use extern to resolve the issue and give me a direction would be immensely helpful. \nAny help is appreciated.</p>\n"}, {"tags": ["c", "linker", "posix", "dlopen"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1504079649, "post_id": 45954861, "comment_id": 78867602, "body": "<code>dlopen()</code> will not solve your problem of a fundamentally broken library ... If you can compile the code in question yourself, you should better fix it to be thread-safe :o"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504081916, "post_id": 45954861, "comment_id": 78868970, "body": "If the library is not thread-aware, you can at least replace static storage duration data with thread local data. This is a completely mechanical task that shouldn&#39;t require research effort or months to complete."}, {"owner": {"reputation": 3240, "user_id": 3031069, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/99963eedbe0698475d7443bf95edb43e?s=128&d=identicon&r=PG&f=1", "display_name": "choeger", "link": "https://stackoverflow.com/users/3031069/choeger"}, "edited": false, "score": 0, "creation_date": 1504082944, "post_id": 45954861, "comment_id": 78869564, "body": "That might be a worthwhile experiment. But for that task, I&#39;d need to know two things: 1. how to shared libraries deal with thread local storage and how do ELF object files declare them?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504085089, "post_id": 45954861, "comment_id": 78871034, "body": "TLS and shared libraries are orthogonal. You should&#39;t care about ELF, you declare your data as TLS in the C source code and rebuild."}, {"owner": {"reputation": 3240, "user_id": 3031069, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/99963eedbe0698475d7443bf95edb43e?s=128&d=identicon&r=PG&f=1", "display_name": "choeger", "link": "https://stackoverflow.com/users/3031069/choeger"}, "edited": false, "score": 0, "creation_date": 1504085833, "post_id": 45954861, "comment_id": 78871550, "body": "Except that some part of that code is not C, but (generated) X86 assembly."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504085981, "post_id": 45954861, "comment_id": 78871664, "body": "How could you possibly verify that any kludge you force into place is actually working?  Just.  Don&#39;t."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504088259, "post_id": 45954861, "comment_id": 78873229, "body": "No, you cannot mechanically modify assembly code to use TLS."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1504081634, "post_id": 45955035, "comment_id": 78868824, "body": "RTLD_LOCAL should take care of global symbols. Though I agree that getting rid of global/static data is the way to go."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504086152, "post_id": 45955035, "comment_id": 78871791, "body": "So, what&#39;s the actual POSIX definition of &quot;object file&quot;?  Just copying it to a different file with a different inode may not be sufficient.  After all, it&#39;s still the same symbols."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504088594, "post_id": 45955035, "comment_id": 78873465, "body": "@AndrewHenle POSIX is often vague on purpose because different systems behave differently. The &quot;even if different pathnames&quot; bit there implies that the deduplication will most likely happen on whatever <code>stat</code> returns. Although I do know that this is somewhere between wishful thinking  and bullshit because the ld.so I worked in dosen&#39;t do any deduplication on anything if the object loaded is with a path name (<code>dlopen</code> was standardized long after I worked in that code, I suspect the POSIX process in this case was &quot;document glibc, screw everyone else&quot;)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504088904, "post_id": 45955035, "comment_id": 78873652, "body": "@AndrewHenle POSIX says &quot;File: an object that can be written to, or read from, or both&quot;. When you write to one file and the other stays intact, they are different files."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504089218, "post_id": 45955035, "comment_id": 78873845, "body": "@n.m. That doesn&#39;t resolve whether object files with identical contents can in fact be loaded into a process&#39;s memory in any way so the multiple copies do not interfere with each other."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504089701, "post_id": 45955035, "comment_id": 78874139, "body": "@AndrewHenle in my universe I can guarantee that a copy of a file is not the same object as the original file. Can&#39;t vouch about yours though."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504090978, "post_id": 45955035, "comment_id": 78875084, "body": "@n.m. Don&#39;t be deliberately dense.  Loading an object file that has the exact same contents as another file isn&#39;t guaranteed to work just because the two identical copies happen to be independent."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504091365, "post_id": 45955035, "comment_id": 78875354, "body": "@AndrewHenle I have no idea where you are getting this from. Same ffile is same file. Different files are different files. POSIX says that the <b>same object file</b> will not be loaded twice. It does not say that <b>different files</b> with the same content will not be loaded twice. I have no reason to believe the latter possibility merits a consideration."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504091504, "post_id": 45955035, "comment_id": 78875451, "body": "@n.m. It&#39;s not an unreasonable consideration. On systems with bad relocations it might not be possible. It wasn&#39;t that long ago (in my head at least, although it has been several decades) when there were systems with shared libraries that weren&#39;t position independent."}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504091775, "post_id": 45955035, "comment_id": 78875645, "body": "@n.m. In fact, now that I think of it, it wasn&#39;t that long ago (pre-Vista) that Windows required all shared libraries to be prelinked at fixed addresses. If this process was done inside a file (don&#39;t know how Windows did this, but it&#39;s not an unreasonable implementation), two raw copies of a shared library file could conflict."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504092357, "post_id": 45955035, "comment_id": 78876076, "body": "@n.m. And even if two or more identical copies of an object file can be loaded into a process&#39;s memory, that doesn&#39;t mean the multiple copies can coexist.  The code within the object file can do things that conflict with the actions of other copies.  For example, a singleton lock, or expecting exclusive access to some resource.  And that&#39;s all assuming every bit of code in the process can distinguish between copy A of <code>someSymbol</code> and copy B of <code>someSymbol</code>. There&#39;s a lot more to deal with than just snarkily relying on &quot;different filename == different file in my universe&quot;."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504092463, "post_id": 45955035, "comment_id": 78876182, "body": "@Art The entire misunderstanding is about what Posix considers &quot;the same file&quot;, not about addresses or relocations or anything like that. Of course you can have conflicts when you prelink at fixed addresses, whether or not your files have different contents. When you try to dlopen <b>the same object file</b> twice, you get a success and the reference count is bumped. When you dlopen <b>two different files</b> with conflicting relocations, you get an error. We&#39;re not ever mentioned the latter case. We just can&#39;t seem to agree what exactly &quot;the same file&quot; is."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504093821, "post_id": 45955035, "comment_id": 78877138, "body": "@AndrewHenle We seem to be talking about entirely different things and not understanding each other. I don&#39;t think the comments section is an appropriate place to resolve this. You also seem to ascribe things to me that I have never said or implied, like different filenames == different files, which is obviously false. I have no idea how you have ever arrived at that."}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 5, "last_activity_date": 1504080114, "creation_date": 1504080114, "answer_id": 45955035, "question_id": 45954861, "link": "https://stackoverflow.com/questions/45954861/how-to-circumvent-dlopen-caching/45955035#45955035", "title": "How to circumvent dlopen() caching?", "body": "<p>POSIX says:</p>\n\n<blockquote>\n  <p>Only a single copy of an object file is brought into the address space, even if dlopen() is invoked multiple times in reference to the file, and even if different pathnames are used to reference the file.</p>\n</blockquote>\n\n<p>So the answer is \"inode\". Copying the library file \"should work\", but hard links won't. Except. Since they will expose the same global symbols and when that happens all (portability) bets are off. You're in the middle of weakly defined behavior that has evolved through bug fixes rather than good design.</p>\n\n<p>Don't dig deeper when you're in a hole. The approach to add additional horrible hacks to make a fundamentally broken library work just leads to additional breakage. Just spend a few hours to fix the library to not use globals instead of spending days to hack around dynamic linking (which will be unportable at best).</p>\n"}], "owner": {"reputation": 3240, "user_id": 3031069, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/99963eedbe0698475d7443bf95edb43e?s=128&d=identicon&r=PG&f=1", "display_name": "choeger", "link": "https://stackoverflow.com/users/3031069/choeger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "accepted_answer_id": 45955035, "answer_count": 1, "score": 1, "last_activity_date": 1504094149, "creation_date": 1504079492, "last_edit_date": 1504094149, "question_id": 45954861, "link": "https://stackoverflow.com/questions/45954861/how-to-circumvent-dlopen-caching", "title": "How to circumvent dlopen() caching?", "body": "<p>According to its <a href=\"http://man7.org/linux/man-pages/man3/dlopen.3.html\" rel=\"nofollow noreferrer\">man page</a>, <code>dlopen()</code> will not load the same library twice:</p>\n\n<blockquote>\n  <p>If the <strong>same shared object</strong> is loaded again with dlopen(), the same\n  object handle is returned.  The dynamic linker maintains reference\n  counts for object handles, so a dynamically loaded shared object is\n  not deallocated until dlclose() has been called on it as many times\n  as dlopen() has succeeded on it.  Any initialization returns (see\n  below) are called just once.  However, a subsequent dlopen() call\n  that loads the same shared object with RTLD_NOW may force symbol\n  resolution for a shared object earlier loaded with RTLD_LAZY.</p>\n</blockquote>\n\n<p>(emphasis mine).</p>\n\n<p>But what actually determines the identity of shared objects? I tried to look into the code, but did not come very far. Is it:</p>\n\n<ul>\n<li>some form of normalized path name (e.g. realpath?)</li>\n<li>the inode ?</li>\n<li>the contents of the libray?</li>\n</ul>\n\n<p>I am pretty sure that I can rule out this last point, since an actual filesystem copy yields two different handles.</p>\n\n<p>To explain the motivation behind this question: I am working with some code that has static global variables. I need multiple instances of that code to run in a thread-safe manner. My current approach is to compile and link said code into a dynamic library and load that library multiple times. With some linker magic, it appears to create several copies of the globals and resolve access in each library to its own copies. The only problem is that my prototype copies the generated library n times for n concurrent uses. This is not only somewhat ugly but I also suspect that it might break on a different platform.</p>\n\n<p>So what is the exact behaviour of <code>dlopen()</code> according to the POSIX standard?</p>\n\n<p><strong>edit:</strong> Because it came up in a comment and an answer, no refactoring the code is definitely not an option. It would involve months or even years of work and potentially sacrifice all benefits of using the code in the first place. There <strong>exists</strong> an ongoing research project that might solve this problem in a much cleaner way, but it is actual research and might fail. I need a solution now.</p>\n\n<p><strong>edit2:</strong> Because people still seem to not believe the usecase is actually valid. I am working on a pure functional language, that shall be embedded into a larger C/C++ application. Because I need a prototype with a garbage collector, a proven typechecker, and reasonable performance ASAP, I used OCaml as intermediate code. Right now, I am compiling a source module into an OCaml module, link the generated object code (including startup etc.) into a shared library <strong>with the OCaml runtime</strong> and dlopen() <strong>that</strong> shared library. Every .so has its own copy of the runtime, including several global variabels (e.g. the pointer to the young generation) and that is, or rather should be, totally fine. The library exposes exactly two functions: An initializer and a single export that does whatever the original module is intended to do. No symbols of the OCaml runtime are exported/shared. when I load the library, its internal symbols are relocated as expected, the only issue I have right now is that I actually need to copy the .so file for each instance of the job at runtime.</p>\n\n<p>Regarding thread-local-storage: That is actually an interesting idea, as the modification to the runtime is indeed rather simple. But the problem is the machine code generated by the OCaml compiler, as it cannot emit loading instructions for tls symbols (yet?). </p>\n"}, {"tags": ["c", "linker"], "comments": [{"owner": {"reputation": 738, "user_id": 3902681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000497258931/picture?type=large", "display_name": "Adrian Grzywaczewski", "link": "https://stackoverflow.com/users/3902681/adrian-grzywaczewski"}, "edited": false, "score": 1, "creation_date": 1504078916, "post_id": 45954652, "comment_id": 78867140, "body": "What is the question ?"}, {"owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1504079106, "post_id": 45954652, "comment_id": 78867264, "body": "rename your lib to libusbcan32.a, then try cc consoleDemo.c -L. -lusbcan32"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504079373, "post_id": 45954652, "comment_id": 78867420, "body": "What is the actual name of your <code>.a</code> file?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504079900, "post_id": 45954652, "comment_id": 78867752, "body": "Your library is for the wrong architecture. Get a 64-bit version (perhaps it should be calleed usbcan64.lib)"}, {"owner": {"reputation": 35, "user_id": 5791311, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1160554253969806/picture?type=large", "display_name": "Srikaran Maheshwaram", "link": "https://stackoverflow.com/users/5791311/srikaran-maheshwaram"}, "reply_to_user": {"reputation": 738, "user_id": 3902681, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000497258931/picture?type=large", "display_name": "Adrian Grzywaczewski", "link": "https://stackoverflow.com/users/3902681/adrian-grzywaczewski"}, "edited": false, "score": 0, "creation_date": 1504083906, "post_id": 45954652, "comment_id": 78870159, "body": "@AdrianGrzywaczewski my question is to how to resolve this issue."}, {"owner": {"reputation": 35, "user_id": 5791311, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1160554253969806/picture?type=large", "display_name": "Srikaran Maheshwaram", "link": "https://stackoverflow.com/users/5791311/srikaran-maheshwaram"}, "reply_to_user": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "edited": false, "score": 0, "creation_date": 1504084002, "post_id": 45954652, "comment_id": 78870236, "body": "@Pras my library name is libusbcan32.a only, while giving the lib name i gave it as usbcan32, i think that should be fine"}, {"owner": {"reputation": 35, "user_id": 5791311, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1160554253969806/picture?type=large", "display_name": "Srikaran Maheshwaram", "link": "https://stackoverflow.com/users/5791311/srikaran-maheshwaram"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504084062, "post_id": 45954652, "comment_id": 78870286, "body": "@n.m. I have tried with 64-bit version also, the same issue is there even with that"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504084156, "post_id": 45954652, "comment_id": 78870352, "body": "So you have a 64 bit version but keep trying to use a 32 bit version with a 64 bit compiler? Why?"}, {"owner": {"reputation": 35, "user_id": 5791311, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1160554253969806/picture?type=large", "display_name": "Srikaran Maheshwaram", "link": "https://stackoverflow.com/users/5791311/srikaran-maheshwaram"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504084444, "post_id": 45954652, "comment_id": 78870587, "body": "@n.m. Yeah I got what you said, but I just thought of giving a try with 32 bit version that&#39;s it."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504084907, "post_id": 45954652, "comment_id": 78870914, "body": "If you are building a 64 bit executable, a 32 bit library is irrelevant as it cannot possibly work. Please ask a question about your attempts with a 64 bit lib."}, {"owner": {"reputation": 35, "user_id": 5791311, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1160554253969806/picture?type=large", "display_name": "Srikaran Maheshwaram", "link": "https://stackoverflow.com/users/5791311/srikaran-maheshwaram"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1504085820, "post_id": 45954652, "comment_id": 78871543, "body": "@n.m. modified the question as per 64-bit version"}], "answers": [{"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1504087250, "last_edit_date": 1504087250, "creation_date": 1504086949, "answer_id": 45957286, "question_id": 45954652, "link": "https://stackoverflow.com/questions/45954652/errorcannot-find-libary-file-when-trying-to-link-the-library-file/45957286#45957286", "title": "error:cannot find libary file when trying to link the library file", "body": "<p>The first attempt is simply invalid as -l flag and the .a suffix cannot both be specified. Your second attempt exposes three kinds of problems.</p>\n\n<ol>\n<li>An incompatible version of libUSBCAN64.a laying around (probably for a wrong OS or CPU). Not a big problem, as you have the right version eventually found, but an annoying warning. Just remove the file.</li>\n<li>Undefined symbols for kbhit and getch. These are non-standard functions specific to Microsoft products. You need to either link with Microsoft libraries (this may or may not work) or (better) avoid these functions altogether and use standard C instead.</li>\n<li>Truncated relocations. This could mean that your program is too big or that you have used an inappropriate compilation flags or inline assembly. Google \"relocation truncated to fit: R_X86_64_32\" and/or post another question with this specific problem and your full source code and build commands.</li>\n</ol>\n"}], "owner": {"reputation": 35, "user_id": 5791311, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1160554253969806/picture?type=large", "display_name": "Srikaran Maheshwaram", "link": "https://stackoverflow.com/users/5791311/srikaran-maheshwaram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504087250, "creation_date": 1504078819, "last_edit_date": 1504085794, "question_id": 45954652, "link": "https://stackoverflow.com/questions/45954652/errorcannot-find-libary-file-when-trying-to-link-the-library-file", "title": "error:cannot find libary file when trying to link the library file", "body": "<p>I have gone through many questions related to linking a library to a c file in stackoverflow, I have followed the approach as follows</p>\n\n<p><strong>Note:</strong> My library file is in the same location of .c file.</p>\n\n<p>How to resolve these errors ?</p>\n\n<ol>\n<li>Using library name with extension</li>\n</ol>\n\n<p>cc consoleDemo.c -L. -lusbcan64.a</p>\n\n<p>-L{path to file containing library} -l${library name}\n<em>The following is the error of compilation</em></p>\n\n<pre><code>/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../x86_64-pc-cygwin/bin/ld: cannot find -lUSBCAN64.a\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<ol start=\"2\">\n<li>Using Library name without extension</li>\n</ol>\n\n<p>cc consoleDemo.c -L. -lusbcan64</p>\n\n<p><em>The following is the error of compilation</em></p>\n\n<pre><code>/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible ./libUSBCAN64.a when searching for -lUSBCAN64\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../x86_64-pc-cygwin/bin/ld: skipping incompatible ./libUSBCAN64.a when searching for -lUSBCAN64\n/tmp/ccTh3hGd.o:ConsoleDemo.c:(.text+0x2b9): undefined reference to `_kbhit'\n/tmp/ccTh3hGd.o:ConsoleDemo.c:(.text+0x2b9): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `_kbhit'\n/tmp/ccTh3hGd.o:ConsoleDemo.c:(.text+0x2c6): undefined reference to `_getch'\n/tmp/ccTh3hGd.o:ConsoleDemo.c:(.text+0x2c6): relocation truncated to fit: R_X86_64_PC32 against undefined symbol `_getch'\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_UcanInitHardware' defined in .idata$5 section in /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b)\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_UcanDeinitHardware' defined in .idata$5 section in /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b)\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_UcanGetModuleTime' defined in .idata$5 section in /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b)\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_UcanInitCanEx2' defined in .idata$5 section in /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b)\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_UcanResetCanEx' defined in .idata$5 section in /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b)\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_UcanReadCanMsgEx' defined in .idata$5 section in /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b)\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_UcanWriteCanMsgEx' defined in .idata$5 section in /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b)\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b):(.text+0x2): relocation truncated to fit: R_X86_64_32 against symbol `__imp_UcanGetStatusEx' defined in .idata$5 section in /usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b)\n/usr/lib/gcc/x86_64-pc-cygwin/5.4.0/../../../../lib/USBCAN64.lib(USBCAN64.dll.b):(.text+0x2): additional relocation overflows omitted from the output\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c++", "c", "dll"], "comments": [{"owner": {"reputation": 81, "user_id": 1427955, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000170512774/picture?type=large", "display_name": "Sy Yuan Li", "link": "https://stackoverflow.com/users/1427955/sy-yuan-li"}, "edited": false, "score": 0, "creation_date": 1504074868, "post_id": 45953401, "comment_id": 78864789, "body": "Since the dll is made by 3rd party, I am afraid the function in dll can&#39;t be changed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1504074919, "post_id": 45953401, "comment_id": 78864817, "body": "Then you need to write an &quot;adapter DLL&quot; <b>or</b> you have to embed this adapter in your program using this DLL."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1504074968, "post_id": 45953401, "comment_id": 78864853, "body": "Your code may be in C, but the question really is more about C++, I think"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1504074999, "post_id": 45953401, "comment_id": 78864875, "body": "@StoryTeller it&#39;s about interfacing both, one of the rare cases both tags are appropriate ..."}, {"owner": {"reputation": 81, "user_id": 1427955, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000170512774/picture?type=large", "display_name": "Sy Yuan Li", "link": "https://stackoverflow.com/users/1427955/sy-yuan-li"}, "edited": false, "score": 0, "creation_date": 1504075502, "post_id": 45953401, "comment_id": 78865186, "body": "Thanks to both of you.   :)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1504078636, "post_id": 45953401, "comment_id": 78866969, "body": "Agreeing with <a href=\"https://stackoverflow.com/questions/45953401/calling-a-function-from-a-dll-which-is-developed-in-c#comment78864875_45953401\">this comment</a> I rolled back the removal of the C tag."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": true, "score": 8, "last_activity_date": 1504074865, "creation_date": 1504074865, "answer_id": 45953510, "question_id": 45953401, "link": "https://stackoverflow.com/questions/45953401/calling-a-function-from-a-dll-which-is-developed-in-c-from-c/45953510#45953510", "title": "Calling a function from a DLL which is developed in C++ from C", "body": "<blockquote>\n  <p>Is the declaration legal?</p>\n</blockquote>\n\n<p>It is, but it doesn't declare the same function. If you need a C API, you cannot use a reference. Stick to a pointer, and make sure the function has C linkage:</p>\n\n<pre><code>extern \"C\" void Foo(int, int*) {\n   // Function body\n}\n</code></pre>\n\n<p>If you cannot modify the DLL code, you need to write a C++ wrapper for it that exposes a proper C API.</p>\n"}, {"comments": [{"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1504075496, "post_id": 45953674, "comment_id": 78865183, "body": "Wouldn&#39;t it be closer if the C++ reference was represented as a <code>const</code> pointer in C?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 1, "creation_date": 1504075604, "post_id": 45953674, "comment_id": 78865243, "body": "@cdarke I don&#39;t think this matters much. making the pointer (as opposed to the data it points to) <code>const</code> only affects the code inside the function, and it&#39;s just a wrapper anyways..."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1504075631, "post_id": 45953674, "comment_id": 78865266, "body": "@cdarke - <code>const</code> when applied to arguments in function declarations is ignored (you get the same declaration as if there was no <code>const</code>). At the definition, you can add it if you want the compiler to catch modifications. But like Felix said, I too think it&#39;s moot here."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1504078850, "post_id": 45953674, "comment_id": 78867102, "body": "Why not make the definition as accurate as possible?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1504078924, "post_id": 45953674, "comment_id": 78867151, "body": "@alk a <code>const</code> like in <code>int *const arg2</code> has no effect at all on the caller, so why bother? It&#39;s just unnecessary clutter."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 5, "last_activity_date": 1504075352, "creation_date": 1504075352, "answer_id": 45953674, "question_id": 45953401, "link": "https://stackoverflow.com/questions/45953401/calling-a-function-from-a-dll-which-is-developed-in-c-from-c/45953674#45953674", "title": "Calling a function from a DLL which is developed in C++ from C", "body": "<p>You need an adapter, consisting of a C++ translation unit and a header usable from both C and C++, like this (use better names of course):</p>\n\n<p><strong>adapter.h:</strong></p>\n\n<pre><code>#ifndef ADAPTER_H\n#define ADAPTER_H\n#endif\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nvoid adapter_Foo(int arg1, int *arg2);\n// more wrapped functions\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif\n</code></pre>\n\n<p><strong>adapter.cpp:</strong></p>\n\n<pre><code>#include \"adapter.h\"\n// includes for your C++ library here\n\nvoid adapter_Foo(int arg1, int *arg2)\n{\n    // call your C++ function, e.g.\n    Foo(arg1, *arg2);\n}\n</code></pre>\n\n<p>You can compile this adapter into a separate DLL or you can have it as a part of your main program. In your C code, just <code>#include \"adapter.h\"</code> and call <code>adapter_Foo()</code> instead of <code>Foo()</code>.</p>\n"}], "owner": {"reputation": 81, "user_id": 1427955, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000170512774/picture?type=large", "display_name": "Sy Yuan Li", "link": "https://stackoverflow.com/users/1427955/sy-yuan-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 45953510, "answer_count": 2, "score": 5, "last_activity_date": 1504078678, "creation_date": 1504074505, "last_edit_date": 1504078678, "question_id": 45953401, "link": "https://stackoverflow.com/questions/45953401/calling-a-function-from-a-dll-which-is-developed-in-c-from-c", "title": "Calling a function from a DLL which is developed in C++ from C", "body": "<p>The function in dll has the prototype below</p>\n\n<pre><code>void Foo(int arg1, int&amp; arg2);\n</code></pre>\n\n<p>The question is, how to declare the function prototype in C?</p>\n\n<p>Is the declaration legal?</p>\n\n<pre><code>void Foo(int, int*);\n</code></pre>\n"}, {"tags": ["c", "performance", "sieve-of-eratosthenes", "sieve"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504073931, "post_id": 45953174, "comment_id": 78864287, "body": "Your function is more likely to be of O(n*n) or worse. So if you go from 10 to the power of 9 to 10 to the power of 10, it has an effect on duration 10to the power of (2*10)/10 to the power of (9*2), i.e. 100, not 10. Or worse."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504074146, "post_id": 45953174, "comment_id": 78864413, "body": "Use <code>&lt;stdint.h&gt;</code> to avoid the weirdness of platform-dependent integer sizes."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504074195, "post_id": 45953174, "comment_id": 78864436, "body": "@o11c ah thanks I&#39;ll be sure to keep that in mind. I had some weirdness alright ;)"}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504074273, "post_id": 45953174, "comment_id": 78864475, "body": "@Yunnosch that makes sense. Still, its been 3.5 hours. My machine is an i7 at 3.4 ghz and 12 GB DDR3. I&#39;d say my computer is reasonably powerful and the number isn&#39;t that high. Is my implementation of the sieve flawed? Or is it something else?"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1504074502, "post_id": 45953174, "comment_id": 78864589, "body": "What compiler, what optimisation flags?"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504074605, "post_id": 45953174, "comment_id": 78864642, "body": "@AshwinGupta you can add - <code>if(i%1000000 == 0) printf(&quot;Completed till i = %lld\\n&quot;, i);</code> for regular monitoring."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1504074649, "post_id": 45953174, "comment_id": 78864670, "body": "@AshwinGupta I haven&#39;t read your code or anything, but your cpu specs don&#39;t really factor into this. It&#39;s likely to do with the speed of your code degrading rather fast as the number of primes you want to search for increases. Computers, no matter how powerful they are, can&#39;t do everything. Cryptography is an example."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504074676, "post_id": 45953174, "comment_id": 78864683, "body": "@AjayBrahmakshatriya yeah. Im using Visual Studio so I just pause every once in a while and take a look. Thanks though, this might be better."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 2, "creation_date": 1504074692, "post_id": 45953174, "comment_id": 78864694, "body": "You can do some optimisations, of course. Make a sieve for odd primes only. And start the inner loop with n = i*i because all smaller multiples of n  have already been removed. Make sure that mapBit is inlined. And compile for a 64 bit system, not 32 bits. That will make a huge difference."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504074716, "post_id": 45953174, "comment_id": 78864708, "body": "@AshwinGupta does that mean you are compiling in debug? That is bound to be very slow. Please compile with maximum optimizations."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504074765, "post_id": 45953174, "comment_id": 78864731, "body": "@AjayBrahmakshatriya I didn&#39;t know this, I will compile as &quot;Release&quot; with x86-64 (as I&#39;ve been doing)."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504074811, "post_id": 45953174, "comment_id": 78864751, "body": "@AshwinGupta yes, Release will be the suitable configuration."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504074829, "post_id": 45953174, "comment_id": 78864763, "body": "@AjayBrahmakshatriya I can&#39;t imagine that 10^9 going to 10^10 suddenly becomes really slow because it&#39;s a debug build. That would surprise me."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1504074900, "post_id": 45953174, "comment_id": 78864809, "body": "@MillieSmith good to know about the specs. I just wanted to put that out there in case it was relevant. I don&#39;t know much about this so I just try to make sure I can help people help me ;)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 0, "creation_date": 1504074919, "post_id": 45953174, "comment_id": 78864818, "body": "@MillieSmith Technically Sieve is <code>O(n*n)</code> so it is going to be 100 times slower. But still it shouldn&#39;t take so much time. Release would make 10**9 also faster."}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504074959, "post_id": 45953174, "comment_id": 78864843, "body": "@AjayBrahmakshatriya Fair enough. And sounds good Ashwin. Understood."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504075112, "post_id": 45953174, "comment_id": 78864946, "body": "@AshwinGupta you can also further optimize your body by using <code>memField[n&#47;8] |= 1 &lt;&lt; (n%8)</code>. No need to if conditions and function calls etc."}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 1, "creation_date": 1504075321, "post_id": 45953174, "comment_id": 78865082, "body": "Maybe I&#39;ve missed something, but OP doesn&#39;t seem to have made the straightforward comparison of the performance of the two codes on the same problem size.  Right now all OP can state is that the <code>long long int</code> version is taking longer to solve a larger problem, not that it is running more slowly than the other version."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1504075451, "post_id": 45953174, "comment_id": 78865155, "body": "@HighPerformanceMark this is indeed correct. But these optimization tips are helpful nonetheless."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1504075452, "post_id": 45953174, "comment_id": 78865156, "body": "Ditto from @gnasher729, you can make it more efficient by ignoring all even values, and stepping by 2 when looking for a prime, and when filling the seive stepping <code>2 * i</code>. More importantly fill the seive from <code>i * i</code> (not <code>i + i</code>)."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1504075551, "post_id": 45953174, "comment_id": 78865209, "body": "@WeatherVane yes I&#39;m going to implement that tomorrow morning before school and try. Unfortunately I&#39;m gonna have to call it a night because its midnight here. Thanks to all for your help, I will keep testing with everyone&#39;s suggestions and updating the question"}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1504075610, "post_id": 45953174, "comment_id": 78865248, "body": "@RustyX Visual Studio 2015 &quot;cl&quot;. Default &quot;Release&quot; configuration."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1504117930, "post_id": 45953174, "comment_id": 78893967, "body": "@AjayBrahmakshatriya: This sieve is absolutely <i>not</i> O (n^2). I think it&#39;s O (n log log n), practically linear."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1504118723, "post_id": 45953174, "comment_id": 78894419, "body": "@gnasher729 Yes, I agree its not <code>O(n^2)</code>. I rushed through the calculation. Anyway, the problem is clear. Thanks for pointing out."}], "answers": [{"comments": [{"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1504076464, "post_id": 45953867, "comment_id": 78865722, "body": "Something similar may need to happen in the inner loop as well for the <code>2 * i</code> expression."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1504077817, "post_id": 45953867, "comment_id": 78866500, "body": "@MichaelBurr: good point! making <code>i</code> an <code>ul_long</code> is the safer solution."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1504081162, "post_id": 45953867, "comment_id": 78868545, "body": "Hmm... there is something fishy about the algorithm. Try it for a max value of <code>541</code> (for which there are <code>100</code> primes), but the output reports <code>103</code> ? Then try with a max of <code>522</code> it now reports <code>104</code> primes... But it does work on the even <code>100</code>, <code>1000</code>, etc. numbers. (Pentium math?)"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1504081847, "post_id": 45953867, "comment_id": 78868940, "body": "@DavidC.Rankin that happens because <code>memField</code> has more than <code>max</code> bits, if <code>max</code> is not a multiple of <code>8</code> and the leftover bits are set to <code>1</code> and counted for the result."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1504082216, "post_id": 45953867, "comment_id": 78869149, "body": "Adding <code>for (ul_long i = max + 1; i &lt; blocks * 8; ++i) CLEARBIT(memField, i);</code> after <code>memset</code> solves this problem: <a href=\"https://ideone.com/K1OGX9\" rel=\"nofollow noreferrer\">ideone.com/K1OGX9</a>"}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "edited": false, "score": 0, "creation_date": 1504101760, "post_id": 45953867, "comment_id": 78883582, "body": "+1 Thanks for the answer, the i* I thing should&#39;ve been obvious! The optimization will come in handy. I will test in the afternoon and accept as long as it works!"}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1504101805, "post_id": 45953867, "comment_id": 78883614, "body": "@DavidC.Rankin yeah this is intended to work only for high powers of 10 so I chose that design. I know it&#39;s confusing sorry."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "edited": false, "score": 0, "creation_date": 1504120705, "post_id": 45953867, "comment_id": 78895436, "body": "@AshwinGupta: there was indeed a small error if max was not a multiple of 8. Thank you David for for catching it and mch for fixing it."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "edited": false, "score": 0, "creation_date": 1504120811, "post_id": 45953867, "comment_id": 78895493, "body": "@AshwinGupta: further optimisations include skipping the even bits, halfing the memory requirements and speeding up the sieve by at least a factor of 2, and computing pi(x) in smaller chunks that fit in the L3 cache."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1504121060, "post_id": 45953867, "comment_id": 78895647, "body": "@mch: thanks for the fix. The test should actually be <code>i &lt; blocks * 8ULL</code> to avoid a potential overflow if <code>sizeof(size_t) &lt; sizeof(ul_long)</code>."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "edited": false, "score": 0, "creation_date": 1504154576, "post_id": 45953867, "comment_id": 78905544, "body": "@chqrlie thanks, this worked great and thanks to everyone else who helped me also!"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 12, "last_activity_date": 1504121230, "last_edit_date": 1504121230, "creation_date": 1504076114, "answer_id": 45953867, "question_id": 45953174, "link": "https://stackoverflow.com/questions/45953174/long-long-int-makes-my-sieve-of-eratosthenes-super-slow/45953867#45953867", "title": "Long long int makes my Sieve of Eratosthenes super slow?", "body": "<p>Your program has an infinite loop in <code>for (u_int i = 2; i*i &lt; max; i++)</code>. <code>i</code> is an <code>unsigned int</code> so <code>i*i</code> wraps at 32-bit and is always less than <code>max</code>. Make <code>i</code> an <code>ul_long</code>.</p>\n\n<p>Note that you should use simpler bit pattern from 1 to 0x80 for bit 0 to 7.</p>\n\n<p>Here is a complete version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef unsigned long long ul_long;\ntypedef unsigned int u_int;\n\n#define TESTBIT(a, bit)   (a[(bit) / 8] &amp; (1 &lt;&lt; ((bit) &amp; 7)))\n#define CLEARBIT(a, bit)  (a[(bit) / 8] &amp;= ~(1 &lt;&lt; ((bit) &amp; 7)))\n\nul_long count_primes(ul_long max) {\n    size_t blocks = (max + 7) / 8;\n    unsigned char *memField = malloc(blocks);\n    if (memField == NULL) {\n        printf(\"cannot allocate memory for %llu bytes\\n\",\n               (unsigned long long)blocks);\n        return 0;\n    }\n    memset(memField, 255, blocks);\n    CLEARBIT(memField, 0);  // 0 is not prime\n    CLEARBIT(memField, 1);  // 1 is not prime\n    // clear bits after max\n    for (ul_long i = max + 1; i &lt; blocks * 8ULL; i++) {\n        CLEARBIT(memField, i);\n    }\n\n    for (ul_long i = 2; i * i &lt; max; i++) {\n        if (TESTBIT(memField, i)) {           //Check if i is prime\n            for (ul_long n = 2 * i; n &lt; max; n += i) {\n                CLEARBIT(memField, n);                   //Reset all multiples of i\n            }\n        }\n    }\n    unsigned int bitCount[256];\n    for (int i = 0; i &lt; 256; i++) {\n        bitCount[i] = (((i &gt;&gt; 0) &amp; 1) + ((i &gt;&gt; 1) &amp; 1) +\n                       ((i &gt;&gt; 2) &amp; 1) + ((i &gt;&gt; 3) &amp; 1) +\n                       ((i &gt;&gt; 4) &amp; 1) + ((i &gt;&gt; 5) &amp; 1) +\n                       ((i &gt;&gt; 6) &amp; 1) + ((i &gt;&gt; 7) &amp; 1));\n    }\n    ul_long count = 0;\n    for (size_t i = 0; i &lt; blocks; i++) {\n        count += bitCount[memField[i]];\n    }\n    printf(\"count of primes up to %llu: %llu\\n\", max, count);\n    free(memField);\n    return count;\n}\n\nint main(int argc, char *argv[]) {\n    if (argc &gt; 1) {\n        for (int i = 1; i &lt; argc; i++) {\n            count_primes(strtoull(argv[i], NULL, 0));\n        }\n    } else {\n        count_primes(10000000000);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>It completes in 10 seconds for 10^9 and 131 seconds for 10^10:</p>\n\n<pre><code>count of primes up to 1000000000: 50847534\ncount of primes up to 10000000000: 455052511\n</code></pre>\n"}], "owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 1, "accepted_answer_id": 45953867, "answer_count": 1, "score": 3, "last_activity_date": 1504121230, "creation_date": 1504073579, "last_edit_date": 1504075400, "question_id": 45953174, "link": "https://stackoverflow.com/questions/45953174/long-long-int-makes-my-sieve-of-eratosthenes-super-slow", "title": "Long long int makes my Sieve of Eratosthenes super slow?", "body": "<p>I have a program that requires me to find primes up till <code>10**10-1 (10,000,000,000)</code>. I wrote a Sieve of Eratosthenes to do this, and it worked very well (and accurately) as high as <code>10**9 (1,000,000,000)</code>. I confirmed its accuracy by having it count the number of primes it found, and it matched the value of 50,847,534 on <a href=\"https://primes.utm.edu/howmany.html\" rel=\"nofollow noreferrer\">the chart found here.</a> I used <code>unsigned int</code> as the storage type and it successfully found all the primes in approximately 30 seconds. </p>\n\n<p>However, <code>10**10</code> requires that I use a larger storage type: <code>long long int</code>. Once I switched to this, the program is running signifigantly slower (its been 3 hours plus and its still working). Here is the relevant code:</p>\n\n<pre><code>typedef unsigned long long ul_long;\ntypedef unsigned int u_int;\n\nul_long max = 10000000000;                            \nu_int blocks = 1250000000;\nchar memField[1250000000];     \n\nchar mapBit(char place) {             //convert 0-&gt;0x80, 1-&gt;0x40, 2-&gt;0x20, and so on\n    return 0x80 &gt;&gt; (place);\n}\n\nfor (u_int i = 2; i*i &lt; max; i++) {\n\n    if (memField[i / 8] &amp; activeBit) {               //Use correct memory block\n        for (ul_long n = 2 * i; n &lt; max; n += i) {\n            char secondaryBit = mapBit(n % 8);       //Determine bit position of n\n            u_int activeByte = n / 8;                //Determine correct memory block\n            if (n &lt; 8) {                             //Manual override memory block and bit for first block\n                secondaryBit = mapBit(n);\n                activeByte = 0;\n            }\n            memField[activeByte] &amp;= ~(secondaryBit);  //Set the flag to false\n        }\n    }\n    activeBit = activeBit &gt;&gt; 1;                       //Check the next\n    if (activeBit == 0x00) activeBit = 0x80;\n} \n</code></pre>\n\n<p>I figure that since <code>10**10</code> is 10x larger then <code>10**9</code> it should take 10 times the amount of time. Where is the flaw in this? Why did changing to <code>long long</code> cause such significant performance issues and how can I fix this? I recognize that the numbers get larger, so it should be somewhat slower, but only towards the end. Is there something I'm missing. </p>\n\n<p>Note: I realize <code>long int</code> <a href=\"https://en.wikibooks.org/wiki/C_Programming/limits.h\" rel=\"nofollow noreferrer\">should technically be large enough</a>  but my limits.h says it isn't even though I'm compiling 64 bit. Thats why I use <code>long long int</code> in case anyone was wondering. Also, keep in mind, I have no computer science training, just a hobbyist. </p>\n\n<p>edit: just ran it in \"Release\" as x86-64 with some of the debug statements suggested. I got the following output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0qAd0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0qAd0.png\" alt=\"enter image description here\"></a></p>\n\n<p>looks like I hit the u_int bound. I don't know why <code>i</code> is getting that large. </p>\n"}, {"tags": ["c", "buffer"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504072352, "post_id": 45952823, "comment_id": 78863632, "body": "<code>char buf[4];</code>... <code>sprintf(buf, &quot;%c%c%c&quot;, k.a, k.b, k.c);</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1504073488, "post_id": 45952823, "comment_id": 78864067, "body": "You need to allocate memory for the <code>buf</code> and also terminate it with a <code>\\0</code> if you want to use <code>%s</code> to print. Moreover it is not a good idea to assume that <code>sizeof(gvk)</code> is 3 bytes."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1504076910, "post_id": 45952823, "comment_id": 78865971, "body": "Read more about <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> and work hard to avoid it. Compile with all warnings and debug info (<code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>...). Learn to use the debugger (<code>gdb</code>) and <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504073391, "post_id": 45952905, "comment_id": 78864020, "body": "Also the string terminator if he wants to use <code>%s</code> for printing"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1504076188, "post_id": 45952905, "comment_id": 78865575, "body": "<code>sizeof(char)</code> is <i>always</i> 1 by definition"}], "tags": [], "owner": {"reputation": 30168, "user_id": 5612562, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/gzBQY.jpg?s=128&g=1", "display_name": "msc", "link": "https://stackoverflow.com/users/5612562/msc"}, "is_accepted": false, "score": 1, "last_activity_date": 1504072690, "last_edit_date": 1504072690, "creation_date": 1504072553, "answer_id": 45952905, "question_id": 45952823, "link": "https://stackoverflow.com/questions/45952823/working-with-memcpy-for-buffers/45952905#45952905", "title": "working with memcpy for buffers", "body": "<p>You have to allocate memory before using <code>buf</code> otherwise it is undefined behaviour.</p>\n\n<p>You should declare it like this(Dynamically):</p>\n\n<pre><code>char *buf = malloc(sizeof(char)*4);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 2, "last_activity_date": 1504076480, "last_edit_date": 1504076480, "creation_date": 1504074338, "answer_id": 45953358, "question_id": 45952823, "link": "https://stackoverflow.com/questions/45952823/working-with-memcpy-for-buffers/45953358#45953358", "title": "working with memcpy for buffers", "body": "<p>Collegue upper told you to allocate memory dynamically but since its much more <strong>error-prone</strong>, <strong>harder to work with</strong> (need to free memory) then with automatic arrays + <strong>you know the size in compile time</strong>, there is no reason to use dynamic allocation. I would recommend you to use automatic array instead. Also dont forget for one byte for null-terminating character.</p>\n\n<pre><code>char buf[4];\n</code></pre>\n\n<p>We are using dynamic allocation just if there is no other way. Even if you didnt know size of array in compile time, since <a href=\"/questions/tagged/c99\" class=\"post-tag\" title=\"show questions tagged &#39;c99&#39;\" rel=\"tag\">c99</a> you may use <a href=\"https://en.wikipedia.org/wiki/Variable-length_array\" rel=\"nofollow noreferrer\">VLA</a>'s.</p>\n\n<hr>\n\n<p>Also compiler <strong>may</strong> add padding between/behind struct elements. Padding <a href=\"https://en.wikipedia.org/wiki/Data_structure_alignment\" rel=\"nofollow noreferrer\">aligns</a> structure members to \"natural\" address boundaries.</p>\n\n<p>In your case it would <em>probably look like this</em></p>\n\n<pre><code>struct gvk{\n  char a ;   // 1B\n  char b ;   // 1B\n  char c ;   // 1B\n             // 1B padding\n};\n</code></pre>\n\n<p>Which means in this case it should work well, anyway you should avoid using <code>memcpy(buf, &amp;k , 3*sizeof(char));</code> on structures like this, because you might copy padding instead of real element of structure.</p>\n\n<hr>\n\n<p>Also there is no need to explicitly type <code>sizeof(char)</code> which, by standard, has size 1 (B).</p>\n"}], "owner": {"reputation": 11, "user_id": 7653253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c0b27d07d75c556bcf4491ae53b3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Vamshi_Krishna", "link": "https://stackoverflow.com/users/7653253/vamshi-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 45953358, "answer_count": 2, "score": -1, "last_activity_date": 1504076480, "creation_date": 1504072224, "question_id": 45952823, "link": "https://stackoverflow.com/questions/45952823/working-with-memcpy-for-buffers", "title": "working with memcpy for buffers", "body": "<p>I am trying to create a buffer of characters as shown:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\nstruct gvk{\n  char a ;\n  char b ;\n  char c ;\n};\n\nint main(){\n  char *buf;\n  struct gvk k = {'A','B','C'};\n\n  memcpy(buf, &amp;k , 3*sizeof(char));\n  printf(\"values in buf is %s\\n\",buf);\n}\n</code></pre>\n\n<p>But my program is exiting saying \"exited with non-zero status\"\nWhere did I do wrong?</p>\n"}, {"tags": ["c", "database", "pointers", "strtok", "strcpy"], "comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 7, "creation_date": 1504071542, "post_id": 45952651, "comment_id": 78863323, "body": "Time to learn gdb to be honest."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 1, "creation_date": 1504071709, "post_id": 45952651, "comment_id": 78863383, "body": "@MillieSmith Your comment is quite applicable. Would you like to make a note of the following links? They make comments like yours even more helpful. <a href=\"https://stackoverflow.com/questions/2069367/how-to-debug-using-gdb\" title=\"how to debug using gdb\">stackoverflow.com/questions/2069367/how-to-debug-using-gdb</a> <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a>"}, {"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504071843, "post_id": 45952651, "comment_id": 78863427, "body": "@Yunnosch Why do that myself when I have a great teammate like you ;). Maybe next time. Thanks for the links. (To be honest though our friend Neal here should be able to google gdb)."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 2, "creation_date": 1504072232, "post_id": 45952651, "comment_id": 78863586, "body": "<code>value = strtok(NULL, &quot;,&quot;);</code> perhaps you want to call on <code>rec</code> instead of <code>NULL</code> the first time. Perhaps look at the documentation for <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strtok.htm\" rel=\"nofollow noreferrer\"><code>strtok</code></a>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1504072307, "post_id": 45952651, "comment_id": 78863615, "body": "<i>simple database that reads a stdin from a bin file</i>, you want to read from a file or from <code>stdin</code> ? It is very unclear."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1504072383, "post_id": 45952651, "comment_id": 78863645, "body": "<code>fwrite(record, sizeof(struct _record),1,fp);</code> maybe you want to use <code>&amp;record</code> instead of <code>record</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504072863, "post_id": 45952651, "comment_id": 78863814, "body": "<code>fgets(rec, sizeof(rec), stdin)</code> typo as <code>fgets(buffer, sizeof(buffer), stdin)</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504073001, "post_id": 45952651, "comment_id": 78863860, "body": "You need <code>fwrite</code> each one line of input."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1504075948, "post_id": 45952651, "comment_id": 78865435, "body": "Compile with all warnings and debug info (e.g. <code>gcc -Wall -Wextra -g</code> with <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a>...) then use a debugger (e.g. <code>gdb</code>) and <a href=\"http://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a>"}], "answers": [{"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1504075744, "last_edit_date": 1504075744, "creation_date": 1504074508, "answer_id": 45953404, "question_id": 45952651, "link": "https://stackoverflow.com/questions/45952651/segmentation-fault-in-c-using-fgets-strtok-strcpy/45953404#45953404", "title": "Segmentation Fault in C using fgets(), strtok(), strcpy()", "body": "<p>There are multiple problems in your code:</p>\n\n<ul>\n<li><p>the definition of <code>fld</code> is not provided. It should be defined as a local array of 19 <code>char *</code>:</p>\n\n<pre><code>char *fld[19];\n</code></pre></li>\n<li><p>you have some cut+paste bugs: <code>value = strdup(NULL, \",\");</code> instead of <code>value = strtok(NULL, \",\");</code></p></li>\n<li><p>many lines are missing.</p></li>\n<li><p>you never test if <code>strtok()</code> returns <code>NULL</code>. Invalid input will cause undefined behavior</p></li>\n<li><p>memory for the strings is unnecessary: you can just copy the string directly into the record field.</p></li>\n<li><p>you do not check the length of the strings before copying them with <code>strcpy</code>. Invalid input may cause buffer overflows.</p></li>\n<li><p>the argument to <code>fwrite</code> should be the address of the record, not its value:</p>\n\n<pre><code>fwrite(&amp;record, sizeof(struct _record), 1, fp);\n</code></pre></li>\n<li><p>using <code>strtok()</code> (or <code>sscanf()</code> with <code>%[^,]</code> conversion specifiers) does not handle empty fields correctly: <code>strtok()</code> will consider any sequence of <code>,</code> as a single separator (<code>%[^,]</code> will not match an empty field either). I suggest using a function for this.</p></li>\n<li><p>the <code>record</code> structure should be cleared before each line to avoid storing uninitialized contents into the database file.</p></li>\n</ul>\n\n<p>To avoid some of these problems, you should raise the warning level and let the compiler produce diagnostics for common programming errors: <code>gcc -Wall -Wextra -Werror</code> or <code>clang -Weverything</code> or <code>cl /W4</code>.</p>\n\n<p>Here is an improved version:</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\nstruct _record {\n    char ID[25];\n    char lname[25]; // last name\n    char fname[25]; // first name\n    char mname[25]; // middle name\n    char suffix[25];\n    char bday[25];\n    char gender[25];\n    char SSN[25];\n    char add1[25]; //address 1\n    char add2[25]; //address 2\n    char zip[25];\n    char maiden[25];\n    char MRN[25];\n    char city[25];\n    char state[25];\n    char phone1[25];\n    char phone2[25];\n    char email[25];\n    char alias[25];\n};\n\nbool loadField(char *dest, int size, char **cursorp) {\n    bool truncated = false;\n    int i = 0;\n    char *p;\n    for (p = *cursorp; *p != '\\0' &amp;&amp; *p != '\\n'; p++) {\n        if (*p == ',') {\n            p++;  // skip the comma separator\n            break;\n        }\n        if (i + 1 &lt; size) {\n            dest[i] = *p;\n        } else {\n            truncated = 1;\n        }\n        i++;\n    }\n    // pad the field with null bytes\n    while (i &lt; size) {\n        dest[i++] = '\\0';\n    }\n    *cursorp = p;\n    if (truncated) {\n        fprintf(stderr, \"field too long: %.*s\\n\", i, *cursorp);\n        return false;\n    } else {\n        return true;\n    }\n}\n\nbool loadDatabase(const char *db_name) {\n    char buffer[1000];\n    FILE *fp;\n\n    printf(\"Loading Database...\");\n    fp = fopen(db_name, \"wb\"); //write &amp; binary option\n    if (fp == NULL) {\n        fprintf(stderr, \"error: cannot open file %s: %s\\n\", db_name, strerror(errno));\n        return false;\n    } else {\n        struct _record record;    // clear the record\n        while (fgets(buffer, sizeof(buffer), stdin) != NULL) {\n            char *cursor = buffer;\n\n            memset(&amp;record, 0, sizeof(record));    // clear the record\n            loadField(record.ID, sizeof(record.ID), &amp;cursor);\n            loadField(record.lname, sizeof(record.lname), &amp;cursor);\n            loadField(record.fname, sizeof(record.fname), &amp;cursor);\n            loadField(record.mname, sizeof(record.mname), &amp;cursor);\n            loadField(record.suffix, sizeof(record.suffix), &amp;cursor);\n            loadField(record.bday, sizeof(record.bday), &amp;cursor);\n            loadField(record.gender, sizeof(record.gender), &amp;cursor);\n            loadField(record.SSN, sizeof(record.SSN), &amp;cursor);\n            loadField(record.add1, sizeof(record.add1), &amp;cursor);\n            loadField(record.add2, sizeof(record.add2), &amp;cursor);\n            loadField(record.zip, sizeof(record.zip), &amp;cursor);\n            loadField(record.maiden, sizeof(record.maiden), &amp;cursor);\n            loadField(record.MRN, sizeof(record.MRN), &amp;cursor);\n            loadField(record.city, sizeof(record.city), &amp;cursor);\n            loadField(record.state, sizeof(record.state), &amp;cursor);\n            loadField(record.phone1, sizeof(record.phone1), &amp;cursor);\n            loadField(record.phone2, sizeof(record.phone2), &amp;cursor);\n            loadField(record.email, sizeof(record.email), &amp;cursor);\n            loadField(record.alias, sizeof(record.alias), &amp;cursor);\n            printf(\"ID: %s\\n\", record.ID);\n            if (fwrite(&amp;record, sizeof(record), 1, fp) != 1) {\n                fprintf(stderr, \"error: cannot write record: %s\\n\", strerror(errno));\n                break;\n            }\n        }\n        fclose(fp);\n    }\n    return true;\n}\n\nint main(void) {\n    if (loadDatabase(\"database.bin\"))\n        return 1;\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8535853, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DFWwLCPFmXw/AAAAAAAAAAI/AAAAAAAAANM/l_-E2tOVe1E/photo.jpg?sz=128", "display_name": "Neal Vasan", "link": "https://stackoverflow.com/users/8535853/neal-vasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562647919, "creation_date": 1504071420, "last_edit_date": 1562647919, "question_id": 45952651, "link": "https://stackoverflow.com/questions/45952651/segmentation-fault-in-c-using-fgets-strtok-strcpy", "title": "Segmentation Fault in C using fgets(), strtok(), strcpy()", "body": "<p>I am getting a seg fault from the code shown below. I am trying to create a simple database that reads a stdin from a bin file chops it up by commas, throws each value into an array and throws it in a struct. I want to do this for every line in the standard input and then write the struct to a file at the end.</p>\n\n<p>I am calling this <code>loadDatabase</code> function from <code>main</code>.</p>\n\n<p>The data looks like the following in one line and is about 14 lines long:</p>\n\n<pre><code>34156155,MILES,NORMA,TAMMY,n/a,9/16/1964,FEMALE,123-45-6789,LAGUARDIA RD,SHLT,10915,n/a,n/a,CHESTER,NY,848-896-8296,n/a,NMILES@AMGGT.COM,n/a\n</code></pre>\n\n<p>Here is my current code. Please excuse me if my C is really bad. First time...:</p>\n\n<pre><code>struct _record {\n    char ID[25];\n    char lname[25]; // last name\n    char fname[25]; // first name\n    char mname[25]; // middle name\n    char suffix[25];    \n    char bday[25];  \n    char gender[25];    \n    char SSN[25];   \n    char add1[25]; //address 1\n    char add2[25]; //address 2 \n    char zip[25];\n    char maiden[25];\n    char MRN[25];\n    char city[25];\n    char state[25];\n    char phone1[25];\n    char phone2[25];\n    char email[25];\n    char alias[25];\n};\n\nbool loadDatabase(char *db_name) {\n    printf(\"Loading Database...\");\n    char buffer[400];\n    FILE *fp;\n    int x;\n    fp = fopen(db_name, \"wb\"); //write &amp; binary option      \n    if (fp == NULL) {\n        puts(\" ERROR: FILE CANNOT BE OPENED\");\n        return false; \n    } else {\n        struct _record record; \n        while (fgets(rec, sizeof(rec), stdin) != NULL) {\n            value = strtok(NULL, \",\");\n            flds[0] = strdup(value);\n\n            //load lname\n            value = strdup(NULL, \",\");\n            flds[1] = strdup(value);\n\n            // load fname\n            value = strdup(NULL, \",\");\n            flds[2] = strdup(value);\n\n            // load mname\n            value = strtok(NULL, \"\\n\");\n            flds[3] = strdup(value);\n            // did not write the rest bc of the seg fault\n\n            strcpy(record.ID, flds[0]);\n            strcpy(record.lname, flds[1]);\n            strcpy(record.fname, flds[2]);\n            strcpy(record.mname, flds[3]);\n            strcpy(record.suffix, flds[4]);\n            strcpy(record.bday, flds[5]);  \n            strcpy(record.gender, flds[6]);  \n            strcpy(record.SSN, flds[7]);  \n            strcpy(record.add1, flds[8]);  \n            strcpy(record.add2, flds[9]); \n            strcpy(record.zip, flds[10]);\n            strcpy(record.maiden, flds[11]);\n            strcpy(record.MRN, flds[12]);\n            strcpy(record.city, flds[13]);\n            strcpy(record.state,  flds[14]);\n            strcpy(record.phone1, flds[15]);\n            strcpy(record.phone2, flds[16]);\n            strcpy(record.email, flds[17]);\n            strcpy(record.alias, flds[18]);\n        }\n        printf(\"ID: %s\", record.ID);\n        fwrite(record, sizeof(struct _record), 1, fp);\n        fclose(fp);\n    }\n    return true;\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 692, "user_id": 1529308, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/da97639e7a382f47c4356da9579ede7f?s=128&d=identicon&r=PG", "display_name": "hrust", "link": "https://stackoverflow.com/users/1529308/hrust"}, "edited": false, "score": 2, "creation_date": 1504070974, "post_id": 45952528, "comment_id": 78863105, "body": "Have you tried to debug the code?"}, {"owner": {"reputation": 436, "user_id": 2188822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb6a566e99cb342dca1f6cfc4059865?s=128&d=identicon&r=PG", "display_name": "Lemonov", "link": "https://stackoverflow.com/users/2188822/lemonov"}, "edited": false, "score": 4, "creation_date": 1504071333, "post_id": 45952528, "comment_id": 78863252, "body": "Are you sure that length of tokens is fixed to specified 20 and 30?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504071455, "post_id": 45952528, "comment_id": 78863294, "body": "Where do you check that you successfully opened the output file?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504071618, "post_id": 45952528, "comment_id": 78863346, "body": "Why not use <code>sizeof(str)</code> instead of <code>340</code> in the call to <code>fgets()</code>?  Why not use <code>sizeof(loadTest.level)</code> instead of <code>20</code> in the call to <code>strncpy()</code>?  Similarly for <code>loadTest.first</code>?  Why no check on whether the write succeeds?"}, {"owner": {"reputation": 419, "user_id": 8035425, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45b1610bc8e203db35d233a5280b9fd8?s=128&d=identicon&r=PG&f=1", "display_name": "dooder", "link": "https://stackoverflow.com/users/8035425/dooder"}, "reply_to_user": {"reputation": 436, "user_id": 2188822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb6a566e99cb342dca1f6cfc4059865?s=128&d=identicon&r=PG", "display_name": "Lemonov", "link": "https://stackoverflow.com/users/2188822/lemonov"}, "edited": false, "score": 0, "creation_date": 1504072133, "post_id": 45952528, "comment_id": 78863526, "body": "@Lemonov, yes I double checked the token lengths. yes I have tried, it just leads me to segfault after first step for some reason. I have just added those but I&#39;m still getting the error. Thanks for your help though!"}, {"owner": {"reputation": 4276, "user_id": 6281993, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb4357d151af778ed5192412a13b094c?s=128&d=identicon&r=PG&f=1", "display_name": "jophab", "link": "https://stackoverflow.com/users/6281993/jophab"}, "edited": false, "score": 0, "creation_date": 1504075181, "post_id": 45952528, "comment_id": 78864988, "body": "@dooder try <code>fwrite(&amp;loadTest, sizeof(loadTest), 1, fp);</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1504076198, "post_id": 45952528, "comment_id": 78865582, "body": "Your debugger will tell you where exactly the segfault occurs. Use it. If you don&#39;t know how to use your debugger it&#39;s probably a good occasion to start learning now. Also read this please: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. And don&#39;t use <code>strncpy</code>, the destination string may be not NUL terminated, read <a href=\"https://stackoverflow.com/questions/1453876/why-does-strncpy-not-null-terminate\">this</a>"}, {"owner": {"reputation": 473, "user_id": 4028638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d3666e4dc1f9952bc22d1d77484497f?s=128&d=identicon&r=PG&f=1", "display_name": "vadim_hr", "link": "https://stackoverflow.com/users/4028638/vadim-hr"}, "edited": false, "score": 2, "creation_date": 1504077987, "post_id": 45952528, "comment_id": 78866605, "body": "show the whole code, not just a part. what is <code>filen</code>? it is initialized? why you not check if the file is open without error? <code>if (fp == NULL) return;</code> 99% that you haven&#39;t open a file and <code>fp</code> is NULL."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 1, "creation_date": 1504080125, "post_id": 45952528, "comment_id": 78867897, "body": "Maybe there is no second <code>,</code> and <code>strtok(NULL, tok)</code> returns NULL."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1504081421, "post_id": 45952528, "comment_id": 78868710, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1504081582, "post_id": 45952528, "comment_id": 78868802, "body": "See whether output file is created and there is something inside or it is empty."}], "answers": [{"comments": [{"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1504080183, "post_id": 45954851, "comment_id": 78867935, "body": "These are improvements but don&#39;t think they will stop the seg fault. Post them like comment."}, {"owner": {"reputation": 473, "user_id": 4028638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d3666e4dc1f9952bc22d1d77484497f?s=128&d=identicon&r=PG&f=1", "display_name": "vadim_hr", "link": "https://stackoverflow.com/users/4028638/vadim-hr"}, "reply_to_user": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1504080612, "post_id": 45954851, "comment_id": 78868214, "body": "@i486 what i need to post like comment? I already added comment to the question before posting answer. I think segfault appear because the file isn&#39;t opened successfully. <code>fp</code> is NULL after <code>fopen</code>."}, {"owner": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1504081473, "post_id": 45954851, "comment_id": 78868747, "body": "You can only suspect that <code>fopen</code> is the problem. It is not 100% sure =&gt; the solution is for comment, it is not answer."}, {"owner": {"reputation": 473, "user_id": 4028638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d3666e4dc1f9952bc22d1d77484497f?s=128&d=identicon&r=PG&f=1", "display_name": "vadim_hr", "link": "https://stackoverflow.com/users/4028638/vadim-hr"}, "reply_to_user": {"reputation": 6023, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "edited": false, "score": 0, "creation_date": 1504088446, "post_id": 45954851, "comment_id": 78873363, "body": "@i486 I can&#39;t be 100% sure without see the whole code. only OP can tell why he get segfault error. thanks for your opinion, but i can&#39;t delete answer after posting."}], "tags": [], "owner": {"reputation": 473, "user_id": 4028638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d3666e4dc1f9952bc22d1d77484497f?s=128&d=identicon&r=PG&f=1", "display_name": "vadim_hr", "link": "https://stackoverflow.com/users/4028638/vadim-hr"}, "is_accepted": false, "score": -1, "last_activity_date": 1504087713, "last_edit_date": 1504087713, "creation_date": 1504079468, "answer_id": 45954851, "question_id": 45952528, "link": "https://stackoverflow.com/questions/45952528/segmentation-fault-block/45954851#45954851", "title": "Segmentation fault block", "body": "<p>Some improvements of your code </p>\n\n<ul>\n<li>check result of <code>fopen</code> before read/write to file </li>\n<li>initialize variables before using their values</li>\n<li>use <code>sizeof</code> instead of constant (as mentioned in comments)</li>\n<li><code>strtok()</code> can return <code>NULL</code> and this must be checked (see <a href=\"https://stackoverflow.com/questions/3616295/why-no-sanity-checks-in-legacy-strcpy\">here</a> why)</li>\n<li>you must use <code>strncpy()</code> carefully because of <a href=\"https://stackoverflow.com/questions/869883/why-is-strncpy-insecure\">this</a></li>\n</ul>\n\n<p>Here is corrected version of your code</p>\n\n<pre><code>FILE *fp;\n\nfp = fopen(filen, \"wb\");\n\nif (fp == NULL) \n{\n    printf(\"Error opening file: %s\", filen);\n}\nelse\n{\n\n    const char tok[2] = \",\";\n    char str[340];\n\n    while (fgets(str, sizeof(str), stdin) != NULL)\n    {\n        struct test loadTest;\n        char *level;\n        char *first;\n        memset(&amp;loadTest, 0, sizeof(loadTest)); \n        printf(\"You entered: %s\", str);\n        level = strtok(str, tok);\n        if (level == NULL)\n        {\n            continue; // bad input ?\n        }\n        first  = strtok(NULL, tok);\n        if (first == NULL)\n        {\n            continue;\n        }\n        strncpy(loadTest.level, level, sizeof(loadTest.level)-sizeof(char));\n        strncpy(loadTest.first, first, sizeof(loadTest.first)-sizeof(char));\n        fwrite(&amp;loadTest, sizeof(loadTest), 1, fp);\n    }\n\n    fclose(fp);\n}\n</code></pre>\n"}], "owner": {"reputation": 419, "user_id": 8035425, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/45b1610bc8e203db35d233a5280b9fd8?s=128&d=identicon&r=PG&f=1", "display_name": "dooder", "link": "https://stackoverflow.com/users/8035425/dooder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504087713, "creation_date": 1504070836, "question_id": 45952528, "link": "https://stackoverflow.com/questions/45952528/segmentation-fault-block", "title": "Segmentation fault block", "body": "<pre><code>FILE *fp;\n\nfp = fopen(filen, \"wb\");\n\nconst char tok[2] = \",\";\nchar str[340];\n\nwhile (fgets(str, 340, stdin) != NULL)\n{\n  struct test loadTest;\n  printf(\"You entered: %s\", str);\n  strncpy(loadTest.level, strtok(str, tok), 20);\n  strncpy(loadTest.first, strtok(NULL, tok), 30);\n  fwrite(&amp;loadTest, sizeof(struct test), 1, fp);\n}\n\nfclose(fp);\n</code></pre>\n\n<p>Hello all,</p>\n\n<p>For some reason I'm getting a segmentation fault error in my code.</p>\n\n<p>I'm almost positive the error is somewhere within the small code block above (since that's all I modified for the seg fault), but I can't seem to pinpoint it.</p>\n\n<p>I know segmentation faults have to do with accessing memory I shouldn't be accessing, but I'm not sure where I am even doing that in the code.</p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["android", "c", "linux-kernel", "embedded-linux", "android-source"], "comments": [{"owner": {"reputation": 4376, "user_id": 2850543, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2bb15c1da6de8180d9adc99954f167f7?s=128&d=identicon&r=PG&f=1", "display_name": "Millie Smith", "link": "https://stackoverflow.com/users/2850543/millie-smith"}, "edited": false, "score": 1, "creation_date": 1504070196, "post_id": 45952330, "comment_id": 78862848, "body": "I don&#39;t know the answer, but you might want to look up /dev/null. It&#39;s a well known &quot;file&quot;. <a href=\"https://en.wikipedia.org/wiki/Null_device\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Null_device</a>"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504070423, "post_id": 45952330, "comment_id": 78862932, "body": "The null device is quite a special thing. Can you give more examples?"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 8296172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20c4bf482c8113cce381bf0aff8e7402?s=128&d=identicon&r=PG&f=1", "display_name": "Raul Grigora\u0219cu", "link": "https://stackoverflow.com/users/8296172/raul-grigora%c8%99cu"}, "is_accepted": false, "score": -1, "last_activity_date": 1504071649, "creation_date": 1504071649, "answer_id": 45952688, "question_id": 45952330, "link": "https://stackoverflow.com/questions/45952330/what-is-the-purpose-of-using-double-underscore-before-the-start-and-after/45952688#45952688", "title": "What is the purpose of using double underscore ( __ ) before the start and after the end of an file name in c?", "body": "<p>As other people have pointed out this just tells it's the \"null device\", not a regular file called \"null\". <code><strong>null</strong></code> is supposed to act like an information sink, not like a normal file where you dump your data to. Hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "is_accepted": false, "score": 2, "last_activity_date": 1504073067, "creation_date": 1504073067, "answer_id": 45953032, "question_id": 45952330, "link": "https://stackoverflow.com/questions/45952330/what-is-the-purpose-of-using-double-underscore-before-the-start-and-after/45953032#45953032", "title": "What is the purpose of using double underscore ( __ ) before the start and after the end of an file name in c?", "body": "<p>I don't know the answer but I have an idea:</p>\n\n<p>The following page shows an \"strace\" output where <code>/dev/__null__</code> is used:</p>\n\n<p><a href=\"https://gist.github.com/tetsu-koba/1522515\" rel=\"nofollow noreferrer\">https://gist.github.com/tetsu-koba/1522515</a></p>\n\n<p>Under Linux device files have a 33-bit (?) number which identifies the device. (At least under old Linux versions) you could delete some file in <code>/dev</code> and you could restore it or even create it in another directory (!) when you know the 33-bit number! (So you can delete the device <code>/dev/sda2</code> and create the device (not file!) <code>/home/myuser/sda2</code> instead.)</p>\n\n<p>The trace in the link above shows the following three lines:</p>\n\n<pre><code>mknod(\"/dev/__null__\", S_IFCHR|0600, makedev(1, 3)) = 0\nopen(\"/dev/__null__\", O_RDWR|O_LARGEFILE) = 3\nunlink(\"/dev/__null__\") = 0\n</code></pre>\n\n<p>These lines will create the device file <code>/dev/__null__</code> (with the 33-bit number identifying <code>/dev/null</code>). Then it opens that file and then it removes the file again.</p>\n\n<p>Maybe this is done because the tool shall be able to run both on Linux installations where the device file \"/dev/null\" is present (in this case the file should not be overwritten) and on installations where that file is missing (in this case a replacement file must be created using the known 33-bit number).</p>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 4132380, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oDlj7Y9OHVI/AAAAAAAAAAI/AAAAAAAAABo/roJbJKN9e5M/photo.jpg?sz=128", "display_name": "Yasindu", "link": "https://stackoverflow.com/users/4132380/yasindu"}, "edited": false, "score": 0, "creation_date": 1504524005, "post_id": 45954678, "comment_id": 79031826, "body": "Thank you @Art. Yeah the both functions are the same. And I attached the file I mentioned."}], "tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": true, "score": 2, "last_activity_date": 1504078905, "creation_date": 1504078905, "answer_id": 45954678, "question_id": 45952330, "link": "https://stackoverflow.com/questions/45952330/what-is-the-purpose-of-using-double-underscore-before-the-start-and-after/45954678#45954678", "title": "What is the purpose of using double underscore ( __ ) before the start and after the end of an file name in c?", "body": "<p>There is no special purpose of using double underscore before the start, after the end or both in C. From the point of view of C the file name is just a string, the operating system is free to interpret in whatever way it chooses. From the point of view of Linux, the same applies. Underscores in file names are just characters. They are not treated differently from the letters <code>b</code> and <code>t</code>.</p>\n\n<p>If I guessed right and I'm reading <a href=\"https://android.googlesource.com/platform/system/core/+/android-4.4_r1/init/util.c#378\" rel=\"nofollow noreferrer\">the same file as you</a> (it might be a good idea to link to the source code you're reading) then it should be pretty obvious what the code does on the lines after the one you mentioned. The next lines are:</p>\n\n<pre><code>if (mknod(name, S_IFCHR | 0600, (1 &lt;&lt; 8) | 3) == 0) {\n    fd = open(name, O_RDWR);\n    unlink(name);\n</code></pre>\n\n<p>Which creates the null device which is then opened and immediately deleted again.</p>\n\n<p>I suspect this is done so that programs can run without access to the root filesystem and still be able to open the equivalent of <code>/dev/null</code>.</p>\n"}], "owner": {"reputation": 123, "user_id": 4132380, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oDlj7Y9OHVI/AAAAAAAAAAI/AAAAAAAAABo/roJbJKN9e5M/photo.jpg?sz=128", "display_name": "Yasindu", "link": "https://stackoverflow.com/users/4132380/yasindu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 1, "accepted_answer_id": 45954678, "answer_count": 3, "score": 4, "last_activity_date": 1504523727, "creation_date": 1504069868, "last_edit_date": 1504523727, "question_id": 45952330, "link": "https://stackoverflow.com/questions/45952330/what-is-the-purpose-of-using-double-underscore-before-the-start-and-after", "title": "What is the purpose of using double underscore ( __ ) before the start and after the end of an file name in c?", "body": "<p>I'm studying the android kernel as a beginner. I can read the messages thrown from the macro <code>ERROR()</code> inside the function <code>main()</code> at <code>system/core/init/init.c</code> using <code>dmesg</code> command through adb. I observed that after calling the function <code>open_devnull_stdio()</code> inside <code>main()</code>, <code>dmesg</code> no longer displays the messages thrown by <code>ERROR()</code>. </p>\n\n<p>To find the reason, I started digging into the declaration of <code>open_devnull_stdio()</code> inside <code>system/core/init/util.c</code> and I found this line I can't understand</p>\n\n<blockquote>\n  <p><code>static const char *name = \"/dev/__null__\"</code>;</p>\n</blockquote>\n\n<p>Actually there was no file named <code>__null__</code> inside <code>/dev/</code> in the device, but there was a file named <code>null</code> and I was able to grab it using <code>adb pull</code> and it was a 0 byte (empty) file.</p>\n\n<p>So why is a file name wrapped with double underscore (__) ?</p>\n\n<p>Here is the link for the <a href=\"https://www.dropbox.com/s/p4f2ryyp9f6556d/util.c?dl=0\" rel=\"nofollow noreferrer\">util.c</a></p>\n"}, {"tags": ["c", "multithreading"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1504071192, "post_id": 45952305, "comment_id": 78863198, "body": "Does calling <code>waitpid()</code>, or <code>waitid()</code> (or, on some systems, <code>wait3()</code> or <code>wait4()</code>) count as &#39;not calling <code>wait()</code>&#39;?  How inventive do you want to get?  (You could open a pipe, close the write end, and execute a read on the read end; when the child exits, the write end of the pipe will be closed, so the parent will get EOF \u2014 0 bytes read \u2014 and it knows that the child died, and all its children, etc.  That&#39;s not completely foolproof, but it depends on the context; do you know what the child processes will be doing?)"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1504072041, "post_id": 45952305, "comment_id": 78863493, "body": "There are a lot of process synchronization mechanisms.  Another option (besides having the parent block on a read) is to have the child send the parent a signal after it has written the data (just calling <code>printf</code> is not enough to guarantee that the data is written).  Or have the parent wait for some event in the filesystem which the child triggers. (eg, parent tries to open a fifo, which will block until the child opens the fifo, but this is fundamentally the same as blocking on a read)"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 1, "creation_date": 1504072619, "post_id": 45952305, "comment_id": 78863724, "body": "I&#39;m assuming doing nothing until <code>SIGCHLD</code> doesn&#39;t count, even though the <code>siginfo_t</code> has a lot of useful info."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504072701, "post_id": 45952305, "comment_id": 78863749, "body": "Note also that, in general, the <code>WNOWAIT</code> flag can often be used when you want to preserve <code>wait</code>ability."}], "answers": [{"comments": [{"owner": {"reputation": 324, "user_id": 2214712, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef1b4c9f8576a8720587e28e6abb3608?s=128&d=identicon&r=PG&f=1", "display_name": "hoholee12", "link": "https://stackoverflow.com/users/2214712/hoholee12"}, "edited": false, "score": 0, "creation_date": 1597407652, "post_id": 45952898, "comment_id": 112129863, "body": "could you explain in detail with example how to use poll() in this specific case?"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "reply_to_user": {"reputation": 324, "user_id": 2214712, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ef1b4c9f8576a8720587e28e6abb3608?s=128&d=identicon&r=PG&f=1", "display_name": "hoholee12", "link": "https://stackoverflow.com/users/2214712/hoholee12"}, "edited": false, "score": 0, "creation_date": 1597436102, "post_id": 45952898, "comment_id": 112142565, "body": "@hoholee12 er, just the same as any other time? Have you read <a href=\"https://www.man7.org/linux/man-pages/man2/poll.2.html\" rel=\"nofollow noreferrer\">the man page</a>?"}], "tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": true, "score": 1, "last_activity_date": 1504072534, "creation_date": 1504072534, "answer_id": 45952898, "question_id": 45952305, "link": "https://stackoverflow.com/questions/45952305/wait-for-child-process-without-using-wait/45952898#45952898", "title": "Wait for child process without using wait()", "body": "<p>Create a pipe in the parent. After <code>fork</code>, close the write half in the parent and the read half in the child.</p>\n\n<p>Then, <code>poll</code> for readability. Since the child never writes to it, it will wait until the child (and all grandchildren, unless you take special care) no longer exists, at which time <code>poll</code> will give a \"read with hangup\" response. (Alternatively, you could actually communicate over the pipe).</p>\n\n<p>You should read about <code>O_CLOEXEC</code>. As a general rule, that flag should always be set unless you have a good reason to clear it.</p>\n"}, {"comments": [{"owner": {"reputation": 779, "user_id": 1102945, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/578c55f38095f9be8b773b30f2d82a9c?s=128&d=identicon&r=PG", "display_name": "stephenwade", "link": "https://stackoverflow.com/users/1102945/stephenwade"}, "edited": false, "score": 0, "creation_date": 1504104219, "post_id": 45953391, "comment_id": 78885492, "body": "My thought was that since it asks &quot;Now write a program that uses <code>wait()</code> to wait for the child process to finish&quot;, it expected you to have written a program that <i>didn&#39;t</i> use <code>wait()</code> for question 3."}, {"owner": {"reputation": 779, "user_id": 1102945, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/578c55f38095f9be8b773b30f2d82a9c?s=128&d=identicon&r=PG", "display_name": "stephenwade", "link": "https://stackoverflow.com/users/1102945/stephenwade"}, "edited": false, "score": 0, "creation_date": 1504104305, "post_id": 45953391, "comment_id": 78885564, "body": "But I can see how it might not imply that, since the rest of the question is about the particular behavior of <code>wait()</code>."}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 779, "user_id": 1102945, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/578c55f38095f9be8b773b30f2d82a9c?s=128&d=identicon&r=PG", "display_name": "stephenwade", "link": "https://stackoverflow.com/users/1102945/stephenwade"}, "edited": false, "score": 0, "creation_date": 1504105108, "post_id": 45953391, "comment_id": 78886198, "body": "Exercises are not tightly linked like you think. Ex.5 doesn&#39;t suppose anything about provided solution in Ex.3. Ex.3 is about experiencing the waiting. Ex.5 is about values caught by a call to <code>wait</code> (questions are explicitly about this point)."}, {"owner": {"reputation": 4043, "user_id": 6949852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uebCh.png?s=128&g=1", "display_name": "\u9673 \u529b", "link": "https://stackoverflow.com/users/6949852/%e9%99%b3-%e5%8a%9b"}, "edited": false, "score": 0, "creation_date": 1524585294, "post_id": 45953391, "comment_id": 87028578, "body": "I have found out what author wants to express by mailing him and post it in my answer : )"}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 2, "last_activity_date": 1504074469, "creation_date": 1504074469, "answer_id": 45953391, "question_id": 45952305, "link": "https://stackoverflow.com/questions/45952305/wait-for-child-process-without-using-wait/45953391#45953391", "title": "Wait for child process without using wait()", "body": "<p>I can't see why second question would imply that answer is \"yes\" to the first.</p>\n\n<p>Yes there is plenty of solutions to obtain what asked, but of course I suspect that all are not in the \"spirit\" of the problem/question where the focus in on <code>fork/wait</code> primitives. The point is always to remember that you can't assume anything after a fork regarding the way processes ran relatively to each other.</p>\n\n<p>To ensure the child process print first you need a kind of synchronization in between both processes, and there is a lot of system primitives that have a semantic of \"communication\" between processes (for example locks, semaphores, signals, etc). I doubt one of these is to be used her, as they are generally introduced slightly later in such a course.</p>\n\n<p>Any other attempt only that will only rely on time assumption (like using <code>sleep</code> or loops to \"slow\" down the parent, etc) can lead to failure, means that you will not be able to prove that it will always succeed. Even if testing would probably show you that it seems correct, most of the runs you would try will not have the bad characteristics that lead to failure. Remember that except in realtime OSes, scheduling is almost an approximation of fair concurrency.</p>\n\n<p>NOTE:</p>\n\n<p>As Jonathan Leffler commented, I also suppose that using other <code>wait</code>-like primitives is forbidden (aka <code>wait4</code>, <code>waitpid</code>, etc) -- \"spirit\" argument.</p>\n"}, {"tags": [], "owner": {"reputation": 4043, "user_id": 6949852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uebCh.png?s=128&g=1", "display_name": "\u9673 \u529b", "link": "https://stackoverflow.com/users/6949852/%e9%99%b3-%e5%8a%9b"}, "is_accepted": false, "score": 5, "last_activity_date": 1524585005, "creation_date": 1524585005, "answer_id": 50005978, "question_id": 45952305, "link": "https://stackoverflow.com/questions/45952305/wait-for-child-process-without-using-wait/50005978#50005978", "title": "Wait for child process without using wait()", "body": "<p>I hope this answer is not late for someones. </p>\n\n<p>Minutes ago, I have emailed to Remiz(this book's author), and got such replay(extract some segments): </p>\n\n<blockquote>\n  <p>Without calling wait() is hard, and not really the main point.\n  What you did -- learning about signals on your own -- is a good sign,\n  showing you will seek out deeper knowledge. Good for you!</p>\n  \n  <p>Later, you'll be able to use a shared memory segment, and\n  either condition variables or semaphores, to solve this problem.</p>\n</blockquote>\n\n<p>He is a very responsible educator, author, and professor:P</p>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 6876860, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m8QHM2bgZFs/AAAAAAAAAAI/AAAAAAAABD4/H04KOxcMRFg/photo.jpg?sz=128", "display_name": "Deepak Pawade", "link": "https://stackoverflow.com/users/6876860/deepak-pawade"}, "is_accepted": false, "score": 0, "last_activity_date": 1599471894, "creation_date": 1599471894, "answer_id": 63775095, "question_id": 45952305, "link": "https://stackoverflow.com/questions/45952305/wait-for-child-process-without-using-wait/63775095#63775095", "title": "Wait for child process without using wait()", "body": "<p>All I did was put a for loop inside the else condition so that the parent process doesn't finish immediately and the child process prints first. But I guess that's not technically waiting for the child process and a bad workaround to get things done.\nfor(i=1000;i&gt;0;i++);\nAnd, its also not assured that the child will always print first I presume, using this (non-ethical) method.</p>\n"}], "owner": {"reputation": 779, "user_id": 1102945, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/578c55f38095f9be8b773b30f2d82a9c?s=128&d=identicon&r=PG", "display_name": "stephenwade", "link": "https://stackoverflow.com/users/1102945/stephenwade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2280, "favorite_count": 0, "accepted_answer_id": 45952898, "answer_count": 4, "score": 3, "last_activity_date": 1599471894, "creation_date": 1504069682, "question_id": 45952305, "link": "https://stackoverflow.com/questions/45952305/wait-for-child-process-without-using-wait", "title": "Wait for child process without using wait()", "body": "<p>When using <code>fork()</code>, is it possible to ensure that the child process executes before the parent without using <code>wait()</code> in the parent?</p>\n\n<hr>\n\n<p>This is related to a homework problem in the <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/cpu-api.pdf\" rel=\"nofollow noreferrer\">Process API chapter</a> of <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\">Operating Systems: Three Easy Pieces</a>, a free online operating systems book.</p>\n\n<p>The problem says:</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Write another program using <code>fork()</code>. The child process should\n  print \"hello\"; the parent process should print \"goodbye\". You should\n  try to ensure that the child process always prints first; can you do\n  this <em>without</em> calling <code>wait()</code> in the parent?</li>\n  </ol>\n</blockquote>\n\n<p>Here's my solution using <code>wait()</code>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt; // exit\n#include &lt;sys/wait.h&gt; // wait\n#include &lt;unistd.h&gt; // fork\n\nint main(void) {\n    int f = fork();\n    if (f &lt; 0) { // fork failed\n        fprintf(stderr, \"fork failed\\n\");\n        exit(1);\n    } else if (f == 0) { // child\n        printf(\"hello\\n\");\n    } else { // parent\n        wait(NULL);\n        printf(\"goodbye\\n\");\n    }\n}\n</code></pre>\n\n<p>After thinking about it, I decided the answer to the last question was \"no, you can't\", but then a later question seems to imply that you can:</p>\n\n<blockquote>\n  <ol start=\"5\">\n  <li>Now write a program that uses <code>wait()</code> to wait for the child process\n  to finish in the parent. What does <code>wait()</code> return? What happens if\n  you use <code>wait()</code> in the child?</li>\n  </ol>\n</blockquote>\n\n<p>Am I interpreting the second question wrong? If not, how do you do what the first question asks? How can I make the child print first without using <code>wait()</code> in the parent?</p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 146, "user_id": 3664882, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ccac0aa4b9ab5a232552518b648b48c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lak", "link": "https://stackoverflow.com/users/3664882/lak"}, "edited": false, "score": 0, "creation_date": 1504069483, "post_id": 45952204, "comment_id": 78862647, "body": "In the above example, it looks for first occurrence of 0, then it look for the occurrence of 1 and make a pair. and so on"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1504069519, "post_id": 45952204, "comment_id": 78862656, "body": "Your question is too broad, but can&#39;t you just loop and read every line (memoizing state from previous ones). BTW, you should consider <a href=\"http://sqlite.org/\" rel=\"nofollow noreferrer\">sqlite</a> to store that data."}, {"owner": {"reputation": 146, "user_id": 3664882, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ccac0aa4b9ab5a232552518b648b48c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lak", "link": "https://stackoverflow.com/users/3664882/lak"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1504069817, "post_id": 45952204, "comment_id": 78862730, "body": "No other algorithms can be used other than foreach loop? Since this has more than 100k records, performance is the main thing i need to consider."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1504070174, "post_id": 45952204, "comment_id": 78862834, "body": "If you need to do this just once, there is no algorithm which would help in efficiency, you have to go through all the data anyway, and getting desired output along the way is basically free already."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1504070200, "post_id": 45952204, "comment_id": 78862850, "body": "100K records is not much. Probably can be processed in a small fraction of second (perhaps a few dozen milliseconds) on a current laptop or desktop."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1504071060, "post_id": 45952204, "comment_id": 78863139, "body": "Ok. If this about using SQL on some database, add relevant tags. Also we should see your too slow code. And know what these performance requirements actually are. Because looping 100k iterations should really be very fast even on Perl."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1504071177, "post_id": 45952204, "comment_id": 78863191, "body": "Like, if you do 100k DB queries, then your problem is right there... C will not help one bit. Butbwe don&#39;t know, because you don&#39;t show your problem code."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1504072304, "post_id": 45952204, "comment_id": 78863614, "body": "There are sporadic commas in the input shown.  Is the real data as bad?  Is the name always a single word (no spaces) or can there be multiple words?  How did you manage to botch the Perl so it was too slow?"}], "answers": [{"tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 2, "last_activity_date": 1504072445, "last_edit_date": 1504072445, "creation_date": 1504069942, "answer_id": 45952353, "question_id": 45952204, "link": "https://stackoverflow.com/questions/45952204/algorithm-to-look-for-next-value-changes/45952353#45952353", "title": "Algorithm to look for next value changes", "body": "<p>Iterate over the data, keeping track of the first occurence of a 0 and 1, to make a pair.</p>\n\n<p>If you need to do that only once, then this is the way to go. Moreover 100k+ records is not that big and C can tackle that happily.</p>\n\n<p>You <em>could</em> gain some speedup by short-circuiting your if statements (for example if you already found a zero, don't search for another one, until 1 has been found, thus a pair has been made).</p>\n\n<p>Like this, in pseudocode:</p>\n\n<pre><code>string first_0 = \"\";\nfor row in table:\n  if first_0 == \"\" &amp;&amp; row.Int == 0:\n    first_0 = row.Name;\n  if first_0 != \"\" &amp;&amp; row.Int == 1:\n    print pair(first_0, row.Name);\n    first_0 = \"\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": false, "score": 0, "last_activity_date": 1504076624, "creation_date": 1504076624, "answer_id": 45954026, "question_id": 45952204, "link": "https://stackoverflow.com/questions/45952204/algorithm-to-look-for-next-value-changes/45954026#45954026", "title": "Algorithm to look for next value changes", "body": "<p>You have not provide enough details of your problem data structures, but general solution for case of many queries might look simple: </p>\n\n<p>Add additional field (or linked table) <code>nextChange</code>.<br>\nTraverse your table in reverse direction, keeping <code>lastOne</code> and <code>lastZero</code> id's (or name)</p>\n\n<pre><code> int lastValues[2];\n for i = last to first\n      currentEntry.nextChange = lastValues[1 - currentEntry.Value];\n      lastValues[currentEntry.Value] = currentEntry.id\n</code></pre>\n"}], "owner": {"reputation": 146, "user_id": 3664882, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ccac0aa4b9ab5a232552518b648b48c8?s=128&d=identicon&r=PG&f=1", "display_name": "Lak", "link": "https://stackoverflow.com/users/3664882/lak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1504077096, "accepted_answer_id": 45952353, "answer_count": 2, "score": -1, "last_activity_date": 1504076624, "creation_date": 1504068992, "last_edit_date": 1504070158, "question_id": 45952204, "link": "https://stackoverflow.com/questions/45952204/algorithm-to-look-for-next-value-changes", "closed_reason": "Needs more focus", "title": "Algorithm to look for next value changes", "body": "<p>I have a Name and Int stored in table, where in Int column has 0 or 1 as its value.</p>\n\n<pre><code>    N1, 1\n    N2, 0,\n    N3, 0\n    N4, 0,\n    N5, 1\n    N6, 0,\n    N7, 0,\n    N8, 1\n    N9 0\n    N10 0\n    N11 1\n</code></pre>\n\n<p>I need to look for next Value changes from 0 to 1.\nI need the key value pair output as (N2, N5) WHERE in N2 it had 0, then 1 was at N5. Same way (N2, N5), (N6, N8) and (N9, N11)</p>\n\n<p>Any idea how can i write algorithm efficiently for more than 100k records?</p>\n"}, {"tags": ["c", "arrays", "csv"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504070377, "post_id": 45952122, "comment_id": 78862911, "body": "1) at <code>find_col_row</code> : <code>int a[2] = {numCol, numRow};   int * pa = &amp;a[0];  return pa;</code> : It returns the address of the local auto variable.  It is invalidated outside the scope of the function. 2) <code>char c; ... while (c != EOF) {</code> : <code>char c:</code> --&gt; <code>int c:</code> For comparison with <code>EOF</code> you need to use <code>int</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504071086, "post_id": 45952122, "comment_id": 78863157, "body": "3) <code>read_csv(f, numCol, numRow, buffer);</code> doesn&#39;t match <code>char buffer[50][50][20];</code> 4) <code>i &lt; 10 ;</code> --&gt; <code>i &lt; 50 ;</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504072190, "post_id": 45952122, "comment_id": 78863558, "body": "5) <code>numRow = new_line - 1;</code> : If <code>-1</code> means that you do not include the first line as the field name of the CSV file, you must do so in <code>read_csv</code> as well."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8506163"}, "edited": false, "score": 0, "creation_date": 1504188247, "post_id": 45965198, "comment_id": 78926415, "body": "Wow, thank you so much. I was getting an error that said something about a c99 mode with the lines that read:       for(size_t r = 0; r &lt; rows; ++r){              for(size_t c = 0; c &lt; cols; ++c){  But all I needed to do was declare size_t r, c; outside of the loop and it ran just fine.   Runs perfectly. Unfortunately I have to get to work right now, but I look forward to digging into it later. I haven&#39;t scanned it yet, but what would it do if a cell were blank or just contained a space? Suppose the data was incomplete rather than a perfect MxN."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504188800, "post_id": 45965198, "comment_id": 78926823, "body": "@MDR <i>cell were blank</i> E.g like <code>,,</code> ==&gt; <code>&quot;&quot;</code>. <i>just contained a space</i> <code>&quot;  &quot;</code> ==&gt; apply <code>trim</code> ==&gt; <code>&quot;&quot;</code>. <i>incomplete rather than a perfect MxN.</i> <code>fprintf(stderr, &quot;line %zu doesn&#39;t match number of columns in %s\\n&quot;, r, filename); exit(EXIT_FAILURE);</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8506163"}, "edited": false, "score": 0, "creation_date": 1504571156, "post_id": 45965198, "comment_id": 79050778, "body": "I tried running your code through a header file and am running into an error I&#39;ve never seen before. It happens in a few places. Do you have a suggestion? ----------------------csv.h: In function \u2018csv_get_field\u2019: csv.h:15:1: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018<b>attribute</b>\u2019 before \u2018char\u2019  char *csv_trim(char *s)  ^"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504574471, "post_id": 45965198, "comment_id": 79051387, "body": "@MDR I think that there is a typo such as forgetting to write <code>;</code> in the header file."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8506163"}, "edited": false, "score": 0, "creation_date": 1504613680, "post_id": 45965198, "comment_id": 79068789, "body": "that&#39;s exactly what it was. Rookie mistake. I appreciate your help with this. I&#39;m not sure I could have written such elegant code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8506163"}, "edited": false, "score": 0, "creation_date": 1504663836, "post_id": 45965198, "comment_id": 79092236, "body": "sorry about that. Big Check Mark. (I&#39;m still getting used to the expectations of this site.)"}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": true, "score": 0, "last_activity_date": 1504109488, "creation_date": 1504109488, "answer_id": 45965198, "question_id": 45952122, "link": "https://stackoverflow.com/questions/45952122/reading-and-saving-values-from-a-csv-using-c-with-dynamic-allocation/45965198#45965198", "title": "Reading and Saving Values from a CSV using C with Dynamic Allocation", "body": "<p>try this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n\n//https://tools.ietf.org/html/rfc4180\nchar *getCSVField(FILE *fp, char separator, int *state){\n    int ch = fgetc(fp);\n\n    if(ch == EOF)\n        return NULL;\n\n    size_t size = 1, index = 0;\n    char *field = malloc(size);\n    bool quoted_in = false;\n\n    for(;ch != EOF; ch = fgetc(fp)){\n        if(ch == '\"'){\n            if(quoted_in){\n                int prefetch = fgetc(fp);\n                if(prefetch == '\"'){\n                    ch = prefetch;\n                } else {\n                    quoted_in = false;\n                    ungetc(prefetch, fp);\n                    continue;\n                }\n            } else {\n                quoted_in = true;\n                continue;\n            }\n        } else if(!quoted_in &amp;&amp; (ch == separator || ch == '\\n')){\n            break;\n        }\n        field[index++] = ch;\n        char *temp = realloc(field, ++size);\n        if(!temp){\n            perror(\"realloc:\");\n            free(field);\n            exit(EXIT_FAILURE);\n        }\n        field = temp;\n    }\n    field[index] = 0;\n    *state = ch;\n    if(quoted_in){\n        fprintf(stderr, \"The quotes is not closed.\\n\");\n        free(field);\n        return NULL;\n    }\n    return field;\n}\n\nchar ***read_csv(const char *filename, size_t *rows, size_t *cols){\n    *rows = *cols = 0;\n\n    FILE *fp = fopen(filename, \"r\");\n    if(!fp){\n        fprintf(stderr, \"%s can't open in %s\\n\", filename, __func__);\n        perror(\"fopen\");\n        return NULL;\n    }\n\n    char *field;\n    int state;\n    size_t r = 0, c = 0;\n    char ***mat = NULL;\n    void *temp;\n\n    while(field = getCSVField(fp, ',', &amp;state)){\n        if(c == 0){\n            mat = realloc(mat, (r + 1)*sizeof(*mat));\n            if(!mat){\n                fprintf(stderr, \"realloc failed in %s\\n\", __func__);\n                exit(EXIT_FAILURE);\n            }\n            mat[r] = NULL;\n        }\n        mat[r] = realloc(mat[r], (c + 1)*sizeof(**mat));\n        if(!mat[r]){\n            fprintf(stderr, \"realloc failed in %s\\n\", __func__);\n            exit(EXIT_FAILURE);\n        }\n        mat[r][c++] = field;\n        if(state == '\\n' || state == EOF){\n            if(*cols == 0){\n                *cols = c;\n            } else if(c != *cols){\n                fprintf(stderr, \"line %zu doesn't match number of columns in %s\\n\", r, filename);\n                exit(EXIT_FAILURE);\n            }\n            c  = 0;\n            *rows = ++r;\n        }\n    }\n    fclose(fp);\n\n    return mat;\n}\n\n#include &lt;ctype.h&gt;\n\nchar *trim(char *s){\n    if(!s || !*s)\n        return s;\n\n    char *from, *to;\n\n    for(from = s; *from &amp;&amp; isspace((unsigned char)*from); ++from);\n    for(to = s; *from;){\n        *to++ = *from++;\n    }\n    *to = 0;\n    while(s != to &amp;&amp; isspace((unsigned char)to[-1])){\n        *--to = 0;\n    }\n    return s;\n}\n\nint main(void){\n    size_t rows, cols;\n    char ***mat = read_csv(\"simp.csv\", &amp;rows, &amp;cols);\n    for(size_t r = 0; r &lt; rows; ++r){\n        for(size_t c = 0; c &lt; cols; ++c){\n            if(c)\n                putchar(',');\n            printf(\"%s\", trim(mat[r][c]));\n            free(mat[r][c]);\n        }\n        puts(\"\");\n        free(mat[r]);\n    }\n    free(mat);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8506163"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 1, "accepted_answer_id": 45965198, "answer_count": 1, "score": 0, "last_activity_date": 1504370999, "creation_date": 1504068599, "last_edit_date": 1504370999, "question_id": 45952122, "link": "https://stackoverflow.com/questions/45952122/reading-and-saving-values-from-a-csv-using-c-with-dynamic-allocation", "title": "Reading and Saving Values from a CSV using C with Dynamic Allocation", "body": "<p>EDITS ON THE BOTTOM (I wrote this as an edit rather than its own question because it is so related): </p>\n\n<p>I am writing a CSV reader that should save all the values as characters in a large, multidimensional array. In previous posts I have been warned about being either too vague with my condensed code, so I am going to post more of it. I want to apologize for its length, as I am still trying to gauge what an appropriate length looks like on this site. </p>\n\n<p>Eventually this program will become the headliner in a Header File I am creating to perform data analysis. Header Files I use for this program are:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n</code></pre>\n\n<p>The problem I am having is that the reader appears to work within the function called read_csv(). I know this because of the printf() statements placed within that function. When I printf() the multidimensional, character array 'buffer' in main(), the data does not appear correctly. </p>\n\n<p>In main(), the first column will print correctly, but the next three will not. Also, my goal is to be able to read any MxN CSV file with cells carrying a MAXIMUM of 20 Characters. Creating generalized code using malloc() is my next goal in this task. </p>\n\n<p>My main() is structured like:</p>\n\n<pre><code>int main(){\n\n  FILE *f;\n  char fname[20];\n  int i, j;\n\n  printf(\"enter name of csv file : \") ;\n  scanf(\"%s\",fname) ;       \n\n  f = fopen(fname, \"r\");\n\n  //find row/col\n  int find_c_r[2];\n  int * pfrc = &amp;find_c_r[0];\n  pfrc = find_col_row(f);\n  printf(\"Find_c_r[0] = %d \\t Find_c_r[1] = %d\\n\", *pfrc, *(pfrc+1));\n\n  int numCol = *pfrc;\n  int numRow = *(pfrc+1);\n\n  char buffer[50][50][20];// ideally size buffer[numCol][numRow][20]\n\n  //sets all values to NULL\n  for(j = 0 ; j &lt; 50 ; j++){\n    for(i = 0 ; i &lt; 10 ; i++){   \n      memset(buffer[i][j],'\\0', 20);\n    }\n  }\n\n  read_csv(f, numCol, numRow, buffer); \n  /////\n  printf(\"\\n\\n\");\n\n for(j = 0 ; j &lt; numRow ; j++){\n    for(i = 0 ; i &lt; numCol; i++){      \n      printf(\"[%d][%d]\",i, j);\n      printf(\"_%s_  \",buffer[i][j]);\n    } \n    printf(\"\\n\");\n  }\n\n  printf(\"END OF PROGRAM.\\n\");\n }\n</code></pre>\n\n<p>One part of this is dynamic allocation of my array 'buffer'. I'm not quite sure how to malloc() in this format. </p>\n\n<p>The first function main() calls is find_col_row(FILE *f). It is working without a problem, but folks have requested more of my code in questions. It returns a pointer to an int array which holds the number of Columns and Rows in the CSV File being read:</p>\n\n<pre><code>int * find_col_row(FILE *f){\n //Find numCol and numRow\n  int numCol, numRow;\n  char c;\n  int new_line= 0;\n  int comma = 0;\n  int z = 0;\n  numCol = 0;\n  numRow = 0;\n  while (c != EOF) {\n    c = fgetc(f) ; \n    if(c == ','){ //WORDS MUST BE SEPARATED BY COMMAS\n      comma++;\n    }\n    if(c == ';'){ //LINES MUST BE SEPARATED BY SEMI-COLONS\n      new_line++;\n      if(numCol == 0){\n         numCol = comma + 1;\n      }\n    } \n  }\n\n\n  numRow = new_line - 1;\n\n  int a[2] = {numCol, numRow};\n  int * pa = &amp;a[0];\n\n  return pa;\n}\n</code></pre>\n\n<p>The second function being called is read_csv(...). The goal of this function is to 'read' the CSV file and 'save' values of each cell in the multidimensional, character array 'buffer':</p>\n\n<pre><code>void read_csv(FILE *f, int numCol, int numRow, char buffer[numCol][numRow][20])  //cells split by ',', row split by ';'\n{\n  char fname[100];\n  int i = 0, j = 0;\n  int c = 0,n = 0, z = 0;\n\n  if (f == NULL) {\n    printf(\"can't open file, %s\\n\", fname) ;\n    exit(1) ;\n  }\n\n  n = 0 ;\n\n  fseek(f, 0, SEEK_SET); //starts reading the file from the start\n  c = fgetc(f) ;\n\n  i = 0;\n  j = 0;\n\n\n  char temp[20];\n  memset(temp, '\\0', 20);\n  int tc = 0; //temp counter\n  int mv_temp = 0; //this aids in removing the first character if == ' '\n  temp[tc] = c;\n  while (c != EOF) {\n\n    if(c == ','){\n      if(temp[0] == ' '){\n         for(mv_temp = 0 ; mv_temp &lt; tc ; mv_temp++){\n           temp[mv_temp] = temp[mv_temp + 1];\n         }\n      }\n      strncpy(buffer[i][j], temp, 20);\n      i++; \n      tc = 0;\n      memset(temp, '\\0', 20);\n    }else if(c == ';'){\n      if(temp[0] == ' '){\n         for(mv_temp = 0 ; mv_temp &lt; tc ; mv_temp++){\n           temp[mv_temp] = temp[mv_temp + 1];\n         }\n      }\n      strncpy(buffer[i][j], temp, 20);\n      j++;\n      i = 0;\n      tc = 0;\n      memset(temp, '\\0', 20);\n       c = fgetc(f);\n\n    }else{\n      temp[tc] = c;\n      tc++;\n    }\n    c = fgetc(f);    \n  }  /////while loop over\n\n\n  for(j = 0 ; j &lt; numRow ; j++){\n    for(i = 0 ; i &lt; numCol; i++){      \n      printf(\"[%d][%d]\",i, j);\n      printf(\"_%s_  \",buffer[i][j]);\n    } \n    printf(\"\\n\");\n  }\n\n}\n</code></pre>\n\n<p>Having not tried to run this program with any other CSV file, here is the CSV I use. When running the program, the first step will be to scanf() the name of the file. I call it</p>\n\n<pre><code>simp.csv\n</code></pre>\n\n<p>For reference, this data refers to basic American Football data: Formation, Formation Variation, Down, Distance. The file looks like:</p>\n\n<pre><code>OFF_FORM,FORM_VAR, DN, DIST;\nDEUCE,RIGHT, 1, 10;\nDEUCE,LEFT, 2, 7;\nTRIO,RIGHT, 3, 3;\nTREY,LEFT, 1, 10;\nTRIO,RODDY, 1, 10;\nTREY,LION, 2, 3;\nDEEP,LEFT, 1, 10;\nDEUCE,LION, 2, 15;\nDEUCE,RIGHT, 3, 4;\nDEEP,RODDY, 1, 10;\nTREY,RIGHT, 1, 10;\nTRIO,RAM, 2, 8;\nTRIO,RAM, 3, 8;\nDEEP,ROCK, 1, 10;\nDEUCE,LION, 1, 10;\nTRIO,LOUIE, 1, 10;\nTRIO,RIGHT, 2,4;\nDEUCE,RIGHT, 3, 6;\nDEUCE,LION, 4, 2;\nTREY,LION,1,10;\n</code></pre>\n\n<p>Again, I apologize for the length of the question. I hope I have enough information given to allow help to come. As a young/novice programmer, I am open to any and all feedback. If you can answer my question and point out ways to optimize my code to work more efficiently, I would greatly appreciate that feedback. </p>\n\n<p>////////////////////////////////\n////////////////////////////////</p>\n\n<p>EDITS:</p>\n\n<p>The code that @BLUEPIXY shared in their answer worked perfectly. Now, I am just trying to turn it into a basic header file and I am not sure of how to amend some of the problems I am seeing. All I did to the code was change the name of the functions and transfer them into a header file. </p>\n\n<pre><code>#ifndef bp_csv_reader\n#define bp_csv_reader    \n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;ctype.h&gt;\n\n//https://tools.ietf.org/html/rfc4180\nchar *csv_get_field(FILE *fp, char separator, int *state)\n\nchar ***csv_read(const char *filename, size_t *rows, size_t *cols)\n\nchar *csv_trim(char *s)\n\n#endif\n</code></pre>\n\n<p>csv.c looks like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include \"csv.h\"\n\n//https://tools.ietf.org/html/rfc4180\nchar *csv_get_field(FILE *fp, char separator, int *state){\n    int ch = fgetc(fp);\n\n    if(ch == EOF)\n        return NULL;\n\n    size_t size = 1, index = 0;\n    char *field = malloc(size);\n    bool quoted_in = false;\n\n    for(;ch != EOF; ch = fgetc(fp)){\n        if(ch == '\"'){\n            if(quoted_in){\n                int prefetch = fgetc(fp);\n                if(prefetch == '\"'){\n                    ch = prefetch;\n                } else {\n                    quoted_in = false;\n                    ungetc(prefetch, fp);\n                    continue;\n                }\n            } else {\n                quoted_in = true;\n                continue;\n            }\n        } else if(!quoted_in &amp;&amp; (ch == separator || ch == '\\n')){\n            break;\n        }\n        field[index++] = ch;\n        char *temp = realloc(field, ++size);\n        if(!temp){\n            perror(\"realloc:\");\n            free(field);\n            exit(EXIT_FAILURE);\n        }\n        field = temp;\n    }\n    field[index] = 0;\n    *state = ch;\n    if(quoted_in){\n        fprintf(stderr, \"The quotes is not closed.\\n\");\n        free(field);\n        return NULL;\n    }\n    return field;\n}\n\nchar ***csv_read(const char *filename, size_t *rows, size_t *cols){\n    *rows = *cols = 0;\n\n    FILE *fp = fopen(filename, \"r\");\n    if(!fp){\n        fprintf(stderr, \"%s can't open in %s\\n\", filename, __func__);\n        perror(\"fopen\");\n        return NULL;\n    }\n\n\n    char *field;\n    int state;\n    size_t r = 0, c = 0;\n    char ***mat = NULL;\n    void *temp;\n\n    while(field = csv_get_field(fp, ',', &amp;state)){\n        if(c == 0){\n            mat = realloc(mat, (r + 1)*sizeof(*mat));\n            if(!mat){\n                fprintf(stderr, \"realloc failed in %s\\n\", __func__);\n                exit(EXIT_FAILURE);\n            }\n            mat[r] = NULL;\n        }\n        mat[r] = realloc(mat[r], (c + 1)*sizeof(**mat));\n        if(!mat[r]){\n            fprintf(stderr, \"realloc failed in %s\\n\", __func__);\n            exit(EXIT_FAILURE);\n        }\n        mat[r][c++] = field;\n        if(state == '\\n' || state == EOF){\n            if(*cols == 0){\n                *cols = c;\n            } else if(c != *cols){\n                fprintf(stderr, \"line %zu doesn't match number of columns in %s\\n\", r, filename);\n                exit(EXIT_FAILURE);\n            }\n            c  = 0;\n            *rows = ++r;\n        }\n    }\n    fclose(fp);\n\n    return mat;\n}\n\n#include &lt;ctype.h&gt;\n\nchar *csv_trim(char *s){\n    if(!s || !*s)\n        return s;\n\n    char *from, *to;\n\n    for(from = s; *from &amp;&amp; isspace((unsigned char)*from); ++from);\n    for(to = s; *from;){\n        *to++ = *from++;\n    }\n    *to = 0;\n    while(s != to &amp;&amp; isspace((unsigned char)to[-1])){\n        *--to = 0;\n    }\n    return s;\n}\n</code></pre>\n\n<p>And the code calling it looks like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;csv.h&gt;\n\n\nint main(void){\n    size_t rows, cols;\n\n\n    char ***mat = csv_read(\"simp.csv\", &amp;rows, &amp;cols);\n\n    size_t r, c;\n\n    for(r = 0; r &lt; rows; ++r){\n        for(c = 0; c &lt; cols; ++c){\n            if(c)\n                putchar(',');\n            printf(\"%s\", csv_trim(mat[r][c]));\n            free(mat[r][c]);\n        }\n        puts(\"\");\n        free(mat[r]);\n    }\n    free(mat);\n    return 0;\n}\n</code></pre>\n\n<p>I am not sure why I am running into the errors I am running into. The code I got ran perfectly in its own file. The problems didn't arise until I placed them into a header file. This is how I compile int he terminal:</p>\n\n<pre><code> acom test_csv.c csv.c -I. csv.h\n</code></pre>\n\n<p>And these are the Errors I see. </p>\n\n<pre><code>In file included from test_cesv.c:5:0:\n./csv.h: In function \u2018csv_get_field\u2019:\n./csv.h:15:1: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018char\u2019\n char *csv_trim(char *s)\n ^\ntest_cesv.c:142:1: error: expected \u2018{\u2019 at end of input\n }\n ^\nIn file included from csv.c:5:0:\ncsv.h: In function \u2018csv_get_field\u2019:\ncsv.h:15:1: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018char\u2019\n char *csv_trim(char *s)\n ^\ncsv.c:55:67: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018{\u2019 token\n char ***csv_read(const char *filename, size_t *rows, size_t *cols){\n                                                                   ^\ncsv.c:105:24: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018{\u2019 token\n char *csv_trim(char *s){\n                        ^\ncsv.c:120:1: error: expected \u2018{\u2019 at end of input\n }\n ^\ncsv.h: In function \u2018csv_get_field\u2019:\ncsv.h:15:1: error: expected \u2018=\u2019, \u2018,\u2019, \u2018;\u2019, \u2018asm\u2019 or \u2018__attribute__\u2019 before \u2018char\u2019\n char *csv_trim(char *s)\n ^\n</code></pre>\n"}, {"tags": ["c", "readline"], "owner": {"reputation": 467, "user_id": 5264490, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lwpFY.png?s=128&g=1", "display_name": "Chromium", "link": "https://stackoverflow.com/users/5264490/chromium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1504068405, "creation_date": 1504068405, "question_id": 45952086, "link": "https://stackoverflow.com/questions/45952086/gnu-readline-library-bracket-matching", "title": "GNU readline library bracket matching", "body": "<p>I have been looking thru GNU manuals and googling about the readline library these days. I always wonders how to customize the behaviours of the real TUI such as auto-completion, key-bindings etc. But the main problem I'm concerning now is bracket matching, which I would be using in a lisp repl.</p>\n\n<p>However, when I google about bracket matching in the GNU readline library, the answers always includes setting the <code>blink-matching-paren</code> option in the <code>.input.rc</code> init file. Is there a programmatic way to do it, like calling a function or passing in special parameters?</p>\n\n<p>Also, I looked into lisp implementation source codes like <code>clisp</code>'s and <code><a href=\"https://github.com/hylang/hy\" rel=\"nofollow noreferrer\">Hy</a></code>'s repl system, but I found out nothing about <code>readline</code> or command line editing etc. Can anyone help me?</p>\n"}, {"tags": ["c", "microcontroller", "avr"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 3, "creation_date": 1504068159, "post_id": 45952009, "comment_id": 78862301, "body": "You need to pass <code>ptr</code> to the function."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1504068187, "post_id": 45952009, "comment_id": 78862311, "body": "arguments in <code>c</code> are pass by value. When you pass <code>.Hour</code> into <code>LCD_DisplayNumber</code>, a local copy of it is made. Any changes made to that local copy are lost when the function returns. If you want <code>s1.Hour</code> to retain its value when the function returns, you have to pass a pointer of it to <code>LCD_DisplayNumber</code> and dereference it in the function."}, {"owner": {"reputation": 6192, "user_id": 2041317, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/58b0m.png?s=128&g=1", "display_name": "cup", "link": "https://stackoverflow.com/users/2041317/cup"}, "edited": false, "score": 1, "creation_date": 1504068500, "post_id": 45952009, "comment_id": 78862386, "body": "Pass as <b>struct menu*</b> and use s1-&gt; instead of s1."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504071389, "post_id": 45952009, "comment_id": 78863273, "body": "@Yunnosch Ahh, right you are,, I honed in on the comment. Still not sure why <code>menu_key_display</code> is (was) repeated."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504071406, "post_id": 45952009, "comment_id": 78863280, "body": "@yano I think OP only describes that the non-update is visible in the line starting with <code>LCD_DisplayNumber(...</code>, the cause is elsewhere."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504071515, "post_id": 45952009, "comment_id": 78863312, "body": "@yano Double quote I guess is caused by jittery finger with ctrl-V. I double checked 100% identity before deleting."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504071858, "post_id": 45952009, "comment_id": 78863434, "body": "@Yunnosch Heh yeah I just checked right before I saw you edited it. They were identical. I guess now OP is expecting <code>menu_key_display</code> to make lasting changes on <code>s1</code> via <code>Up_Down_Keyvalue</code>. The logic of what I said is right even though I was looking at the wrong function."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504072030, "post_id": 45952009, "comment_id": 78863490, "body": "@Yano the logic is right, but trying to act on your comment will make sure that the error is not found because the cause is elsewhere. You can tell that OP is already focusing on the symptom instead of the cause, by the comments he added to the code."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504072437, "post_id": 45952009, "comment_id": 78863660, "body": "@Yunnosch Very true, but it&#39;s a comment, not an answer, and it&#39;s too late to edit now. If the OP only has enough gumption to fix the problem by reading through the 2nd comment, then I don&#39;t have a whole lot of sympathy. Somebody should write an answer I suppose."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504072816, "post_id": 45952009, "comment_id": 78863793, "body": "@yano You are somewhat right, but keep in mind that questions at StackOverflow are rarely asked by seasoned programmers (Everybody out there, I said &quot;rarely&quot;, not &quot;never&quot;, there are some great questions asked by people I bow to.)"}], "answers": [{"comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504073104, "post_id": 45952922, "comment_id": 78863898, "body": "There&#39;s not enough in the OP to know, but I&#39;d have to assume <code>Up_Down_Keyvalue</code> should be called with a pointer also. Otherwise, in the code shown, <code>menu_key_display</code> won&#39;t edit the original <code>s1</code> and we&#39;re back to the same problem."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504092732, "post_id": 45952922, "comment_id": 78876398, "body": "Good point, thank you. I fixed what is of course the point of the answer."}], "tags": [], "owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "is_accepted": true, "score": 4, "last_activity_date": 1504073429, "last_edit_date": 1504073429, "creation_date": 1504072601, "answer_id": 45952922, "question_id": 45952009, "link": "https://stackoverflow.com/questions/45952009/structure-value-is-not-updating-in-main-source-file/45952922#45952922", "title": "Structure value is not updating in main source file", "body": "<p>Compiling an answer from comments:</p>\n\n<p>The lack of updating is only <strong>visible</strong> in the lines you commented in your code, i.e. they are only the symptom.</p>\n\n<p>The <strong>cause</strong> of the problem is one line earlier:</p>\n\n<pre><code>menu_key_display (s1,menu_display);\n//                ^\n</code></pre>\n\n<p>In order to get the changes inside the function visible outside,<br>\nyou need to use \"call by reference\", which in C means \"via a pointer\".</p>\n\n<p>So, change the offending line to:</p>\n\n<pre><code>menu_key_display (ptr,menu_display);\n</code></pre>\n\n<p>That of course has to be matched by changes to lines of the called function:</p>\n\n<pre><code>void menu_key_display(struct menu *s1Ptr, const char *menu_display[])\n// ...\nUP_Down_Keyvalue(s1Ptr,2,4); // assuming this to be supposed to have the missing effect\n//                ^\n</code></pre>\n\n<p>The last use of the pointer (in contrast to \"call by value\" struct copy) needs to be reflected in the <code>UP_DownKeyvalue(...)</code> function, too, in a similar way.\nHowever, if it is a macro (which I think I implicitly assumed in the previous version of my answer), then <code>UP_Down_Keyvalue(*s1Ptr,2,4);</code> could be used without change to the macro definition.  </p>\n\n<p>Note, when working with pointer you might want to add a check to the function, to make sure that the pointer is not NULL. Call it paranoia, but paranoia is a healthy state of mind for a programmer (at least an embedded programmer). </p>\n"}], "owner": {"reputation": 15, "user_id": 6920086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1075d14f2224daf55997decb59225d2?s=128&d=identicon&r=PG&f=1", "display_name": "girikks", "link": "https://stackoverflow.com/users/6920086/girikks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 45952922, "answer_count": 1, "score": 1, "last_activity_date": 1504078992, "creation_date": 1504067887, "last_edit_date": 1504078992, "question_id": 45952009, "link": "https://stackoverflow.com/questions/45952009/structure-value-is-not-updating-in-main-source-file", "title": "Structure value is not updating in main source file", "body": "<p>part of my project some of source files are \n<code>button_key.h, button_key.h, lcd.h, mani.c</code> etc.</p>\n\n<p>Used a structre  in button_key.H and declared as </p>\n\n<pre><code>struct menu {\n             uint8_t Hour;\n             uint8_t Minute;\n             uint8_t Second;\n            };\n</code></pre>\n\n<p>In <code>main.c</code> source file </p>\n\n<pre><code>#include \"lcd.h\"\n#include \"delay.h\"\n#include \"button_key.h\"\n\n  struct menu s1= {0}; \n  struct menu *ptr; \n\nint main(void)\n{   int a;\n\n    ptr = &amp;s1;\n\n//some code//\nmenu_key_display (s1,menu_display);\nLCD_DisplayNumber(10,(*ptr).Hour,2); // here not updating the structure value as per the code in button_key.c  only show zero (0)\n  while(1);\n\n  // tried also LCD_DisplayNumber(10,s1.Hour,2); also seems same reult.\n\n}\n</code></pre>\n\n<p>And the structre is used in <code>button_key.c</code> file like  (only the part of the code)</p>\n\n<pre><code> void menu_key_display(struct menu s1,const char *menu_display[])\n {   //some cdoe here\n       case 1: // set time\n             { \n             LCD_Clear();\n             LCD_GoToLine(0);\n             LCD_DisplayString(menu_display[5]);\n             LCD_GoToLine(1);\n             LCD_DisplayString(\"  HH:MM:SS:PM/AM\");\n             UP_Down_Keyvalue(s1,2,4);            \n              break;\n\n             // some code \n }\n</code></pre>\n\n<p>The above source code made changes , the values to the menu structure members. But that changes not reflect in main.c whats the wrong with me.</p>\n"}, {"tags": ["c", "linux", "semaphore"], "comments": [{"owner": {"reputation": 195, "user_id": 4343878, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PgsNA.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/4343878/steve"}, "edited": false, "score": 0, "creation_date": 1504080437, "post_id": 45951866, "comment_id": 78868098, "body": "Is there easy way to make <code>semget</code> call return a single semaphore rather than a semaphore set?"}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 4343878, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PgsNA.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/4343878/steve"}, "edited": false, "score": 0, "creation_date": 1504080356, "post_id": 45954667, "comment_id": 78868043, "body": "Oh, maybe I not say clearly. I wan&#39;t a correct implementation."}, {"owner": {"reputation": 652, "user_id": 4080489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QJ9sc.jpg?s=128&g=1", "display_name": "Aniruddh Dikhit", "link": "https://stackoverflow.com/users/4080489/aniruddh-dikhit"}, "reply_to_user": {"reputation": 195, "user_id": 4343878, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PgsNA.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/4343878/steve"}, "edited": false, "score": 0, "creation_date": 1504107574, "post_id": 45954667, "comment_id": 78887964, "body": "Perhaps if you can re-state specific problem you are running into. What are you trying to get rid of? or what specific problem are you trying to solve."}], "tags": [], "owner": {"reputation": 652, "user_id": 4080489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QJ9sc.jpg?s=128&g=1", "display_name": "Aniruddh Dikhit", "link": "https://stackoverflow.com/users/4080489/aniruddh-dikhit"}, "is_accepted": false, "score": 0, "last_activity_date": 1504078884, "creation_date": 1504078884, "answer_id": 45954667, "question_id": 45951866, "link": "https://stackoverflow.com/questions/45951866/how-to-implement-sem-open-using-semget/45954667#45954667", "title": "How to implement sem_open using semget", "body": "<p>I am assuming you are asking about how to increase the limit on the system. In order to do that you can find current settings by running the following command on your Linux system (alternatively ipcs will work as well)</p>\n\n<pre><code># cat /proc/sys/kernel/sem\n250 32000   32  128\n</code></pre>\n\n<p>Now from the man pages we are looking at following four values from the above output</p>\n\n<blockquote>\n  <p>SEMMSL</p>\n  \n  <ul>\n  <li>Maximum number of semaphores per semid: implementation dependent (on    Linux, this limit can be read and modified via the first field\n  of    /proc/sys/kernel/sem).</li>\n  </ul>\n  \n  <p>SEMMNS</p>\n  \n  <ul>\n  <li>System wide maximum number of semaphores: policy dependent (on Linux,    this limit can be read and modified via the second field of \n  /proc/sys/kernel/sem). Values greater than SEMMSL * SEMMNI makes it<br>\n  irrelevant.</li>\n  </ul>\n  \n  <p>SEMOPM\n  - maximum number of semaphore operations that can be performed per semop(2) </p>\n  \n  <p>SEMMNI </p>\n  \n  <ul>\n  <li>System wide maximum number of semaphore sets: policy dependent (on       Linux, this limit can be read and modified via the fourth field of<br>\n  /proc/sys/kernel/sem).</li>\n  </ul>\n</blockquote>\n\n<p>Now in order to modify any one of the above kernel parameter you can run following command</p>\n\n<pre><code># printf '250\\t32000\\t50\\t150' &gt;/proc/sys/kernel/sem\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 4343878, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/PgsNA.jpg?s=128&g=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/4343878/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504078884, "creation_date": 1504066887, "last_edit_date": 1504073736, "question_id": 45951866, "link": "https://stackoverflow.com/questions/45951866/how-to-implement-sem-open-using-semget", "title": "How to implement sem_open using semget", "body": "<p>I want to implement some POSIX semaphore APIs using System V semaphore and find this blog <a href=\"https://www.ibm.com/developerworks/library/l-semaphore/index.html\" rel=\"nofollow noreferrer\">Implement POSIX Semaphore APIs using System V Semaphores APIs</a> useful.</p>\n\n<p>I use <code>semget</code>(System V) to implement <code>sem_open</code>(POSIX). As follows:</p>\n\n<pre><code>sem_t *sem_open(const char *name, int oflag, ...) {\n    creat(fname, 0444);\n    key_t key = ftok(name, 1);\n    semget(key, 1, IPC_CREAT)\n}\n</code></pre>\n\n<p>But <code>semget</code> returns the <strong>semaphore set</strong> identifier while <code>sem_open</code> return a new POSIX semaphore. The number of allowed semaphore set is quite small, so I can't create many semaphores. How can I get rid of it.</p>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1504074816, "post_id": 45951747, "comment_id": 78864756, "body": "Clip the HDC that is passed to <code>DrawFocusRect()</code>. See the various <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd183436.aspx\" rel=\"nofollow noreferrer\">clipping functions</a> for working with HDC clipping."}, {"owner": {"reputation": 446, "user_id": 4699114, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7c923110bd052844fe8983a7eeb522d8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike32ab", "link": "https://stackoverflow.com/users/4699114/mike32ab"}, "reply_to_user": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1504361185, "post_id": 45951747, "comment_id": 78989218, "body": "Thanks for the suggestion. <code>IntersectClipRect()</code> did the job"}], "owner": {"reputation": 446, "user_id": 4699114, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7c923110bd052844fe8983a7eeb522d8?s=128&d=identicon&r=PG&f=1", "display_name": "Mike32ab", "link": "https://stackoverflow.com/users/4699114/mike32ab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1504066040, "creation_date": 1504066040, "question_id": 45951747, "link": "https://stackoverflow.com/questions/45951747/how-do-you-clip-the-output-of-drawfocusrect", "title": "How do you clip the output of DrawFocusRect()?", "body": "<p>I have a child window that has the <code>CS_PARENTDC</code> class style. This child window has a few items and I need to draw a focus rect on the item the user clicks on. If the item lies outside of the child client area, the focus rect is drawn outside of the client area. If the focus rect lies outside of the child client area I could make it smaller, but then it would not have a standard look. What's the best way to clip the output of <code>DrawFocusRect()</code>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504065716, "post_id": 45951639, "comment_id": 78861675, "body": "&quot;why cant main.c know foo()?&quot; --&gt; <code>main()</code> <i>can</i> know about <code>foo()</code>.  <code>main()</code> just needs a correct declaration."}, {"owner": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504065976, "post_id": 45951639, "comment_id": 78861749, "body": "I get a build error..whats wrong in the code?"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1504070922, "post_id": 45951639, "comment_id": 78863089, "body": "How are you trying to build?  If you just compile <code>main.c</code>, it will work.  But if you try to compile <i>and</i> link to build an executable without including <code>foo.o</code>, it will fail."}], "answers": [{"comments": [{"owner": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "edited": false, "score": 0, "creation_date": 1504069961, "post_id": 45951676, "comment_id": 78862775, "body": "So there is no other way, than moving the prototype of foo() to foo.h and using foo.h in Main.c"}, {"owner": {"reputation": 115587, "user_id": 56541, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Wm7Xg.png?s=128&g=1", "display_name": "David Z", "link": "https://stackoverflow.com/users/56541/david-z"}, "reply_to_user": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "edited": false, "score": 0, "creation_date": 1504070302, "post_id": 45951676, "comment_id": 78862880, "body": "There are other ways. You could manually declare <code>foo()</code> in both files, but then you run the risk of making a mistake and having the declarations be different, in which case the linker would complain. Or you could (but you really shouldn&#39;t) rely on the default prototype that the compiler gives an undeclared function."}, {"owner": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "edited": false, "score": 0, "creation_date": 1504076043, "post_id": 45951676, "comment_id": 78865490, "body": "The code above built with warnings. I had not included the file correctly."}], "tags": [], "owner": {"reputation": 115587, "user_id": 56541, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Wm7Xg.png?s=128&g=1", "display_name": "David Z", "link": "https://stackoverflow.com/users/56541/david-z"}, "is_accepted": true, "score": 3, "last_activity_date": 1504065622, "creation_date": 1504065622, "answer_id": 45951676, "question_id": 45951639, "link": "https://stackoverflow.com/questions/45951639/extern-a-function-declared-and-defined-locally/45951676#45951676", "title": "Extern a function declared and defined locally", "body": "<p>C source files are compiled independently. E.g. when the compiler is working on <code>main.c</code>, it knows nothing about what is in <code>foo.c</code> or any other file, unless you actually reference some other file.</p>\n"}, {"comments": [{"owner": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "edited": false, "score": 0, "creation_date": 1504075648, "post_id": 45952599, "comment_id": 78865276, "body": "im using code blocks and its giving me an error"}, {"owner": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "edited": false, "score": 0, "creation_date": 1504075944, "post_id": 45952599, "comment_id": 78865431, "body": "Yes. solved. Getting warnings now. Not errors. Had not correctly included the file."}], "tags": [], "owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "is_accepted": false, "score": 0, "last_activity_date": 1504071176, "creation_date": 1504071176, "answer_id": 45952599, "question_id": 45951639, "link": "https://stackoverflow.com/questions/45951639/extern-a-function-declared-and-defined-locally/45952599#45952599", "title": "Extern a function declared and defined locally", "body": "<p>There are no major problems with your code (tough some might argue that the warnings given below are \"major\").  You're probably just not building correctly.  But you can build with:</p>\n\n<pre><code>$ gcc -c main.c\nmain.c: In function \u2018main\u2019:\nmain.c:4:5: warning: implicit declaration of function \u2018foo\u2019 [-Wimplicit-function-declaration]\n     foo();\n     ^~~\n$ gcc -c foo.c\nfoo.c: In function \u2018foo\u2019:\nfoo.c:7:6: warning: implicit declaration of function \u2018printf\u2019 [-Wimplicit-function-declaration]\n      printf(\"Hi\");\n      ^~~~~~\nfoo.c:7:6: warning: incompatible implicit declaration of built-in function \u2018printf\u2019\nfoo.c:7:6: note: include \u2018&lt;stdio.h&gt;\u2019 or provide a declaration of \u2018printf\u2019\n$ gcc main.o foo.o\n$ ./a.out\nHi$ \n</code></pre>\n"}], "owner": {"reputation": 862, "user_id": 5753034, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/813d3a6cdf75243a4f5fac45207848a2?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaGoku", "link": "https://stackoverflow.com/users/5753034/alphagoku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1504079554, "accepted_answer_id": 45951676, "answer_count": 2, "score": 0, "last_activity_date": 1504071176, "creation_date": 1504065373, "last_edit_date": 1504070763, "question_id": 45951639, "link": "https://stackoverflow.com/questions/45951639/extern-a-function-declared-and-defined-locally", "closed_reason": "Needs details or clarity", "title": "Extern a function declared and defined locally", "body": "<p>I have two <strong>c</strong> files:</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>int main()\n{\n    foo();\n    return 0;\n}\n</code></pre>\n\n<p><strong>foo.c</strong></p>\n\n<pre><code>void foo(void);\n\nvoid foo(void)\n{ \n    printf(\"Hi\");\n}\n</code></pre>\n\n<p>Since all functions are <code>extern</code> by default then why can't <strong>main.c</strong> find <code>foo()</code>?<br>\nThe function prototype -> <code>void foo(void);</code> is not declared in <strong>foo.h</strong>, It remains in <strong>foo.c</strong></p>\n\n<p>I get an error :</p>\n\n<blockquote>\n  <p><em>undefined reference to foo</em></p>\n</blockquote>\n\n<p>when compiling this code.</p>\n"}, {"tags": ["c", "include", "libraries"], "comments": [{"owner": {"reputation": 2986, "user_id": 1930814, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/k3Cu7.jpg?s=128&g=1", "display_name": "Dalton C&#233;zane", "link": "https://stackoverflow.com/users/1930814/dalton-c%c3%a9zane"}, "edited": false, "score": 0, "creation_date": 1504064017, "post_id": 45951440, "comment_id": 78861296, "body": "What library? Be more specific and detailed in your question."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1504070582, "post_id": 45951440, "comment_id": 78862982, "body": "You need to spend more than a week reading a good book about C programming."}, {"owner": {"reputation": 1, "user_id": 6684759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfa4c8f3f1fd7993e64dc52f3bb49b7?s=128&d=identicon&r=PG&f=1", "display_name": "B.MORADI", "link": "https://stackoverflow.com/users/6684759/b-moradi"}, "edited": false, "score": 0, "creation_date": 1504070651, "post_id": 45951440, "comment_id": 78863002, "body": "I Dont know why my question in edit mode is complete but in the view mode is incomplete. I just want to know what is the usage of (#include &lt;vartype&gt; ) library. I understand what is include, but i coudnt find vartype anywhere......"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6684759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfa4c8f3f1fd7993e64dc52f3bb49b7?s=128&d=identicon&r=PG&f=1", "display_name": "B.MORADI", "link": "https://stackoverflow.com/users/6684759/b-moradi"}, "edited": false, "score": 0, "creation_date": 1504070733, "post_id": 45951492, "comment_id": 78863031, "body": "I Dont know why my question in edit mode is complete but in the view mode is incomplete. I just want to know what is the usage of (#include &lt;vartype&gt; ) library. I understand what is include, but i coudnt find vartype anywhere......"}], "tags": [], "owner": {"reputation": 963, "user_id": 805796, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/351bc6b115265f0a9fbcb328c4532ced?s=128&d=identicon&r=PG", "display_name": "MCG", "link": "https://stackoverflow.com/users/805796/mcg"}, "is_accepted": false, "score": 1, "last_activity_date": 1504064255, "creation_date": 1504064255, "answer_id": 45951492, "question_id": 45951440, "link": "https://stackoverflow.com/questions/45951440/including-vartype-library-to-the-beginning-of-the-c-program/45951492#45951492", "title": "including &quot;vartype&quot; library to the beginning of the C program", "body": "<p><code>#include</code> is a preprocessor directive, not a library. You can read below Wikipedia page about it.\n<a href=\"https://en.wikipedia.org/wiki/Include_directive\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Include_directive</a></p>\n"}], "owner": {"reputation": 1, "user_id": 6684759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bfa4c8f3f1fd7993e64dc52f3bb49b7?s=128&d=identicon&r=PG&f=1", "display_name": "B.MORADI", "link": "https://stackoverflow.com/users/6684759/b-moradi"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "closed_date": 1504074335, "answer_count": 1, "score": -3, "last_activity_date": 1504072576, "creation_date": 1504063847, "last_edit_date": 1504072576, "question_id": 45951440, "link": "https://stackoverflow.com/questions/45951440/including-vartype-library-to-the-beginning-of-the-c-program", "closed_reason": "Needs more focus", "title": "including &quot;vartype&quot; library to the beginning of the C program", "body": "<p>I want to have some information about (#include)\nin the beginning of my C program.\nWhat does this library do?I have search before and found nothing.....</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 2, "creation_date": 1504064251, "post_id": 45951386, "comment_id": 78861349, "body": "Don&#39;t use macros."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504064853, "post_id": 45951386, "comment_id": 78861465, "body": "@o11c unfortunately you don&#39;t have much choices in C. You can&#39;t declare a constant for declaring array sizes"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 2, "creation_date": 1504065128, "post_id": 45951386, "comment_id": 78861523, "body": "@user7027796 that&#39;s why in most conventions you write constants in CAPS. The problem wouldn&#39;t appear if you write <code>SIZE</code>. Anyway avoid generic words like that and use descriptive names like <code>GRID_SIZE</code>. And <a href=\"https://stackoverflow.com/q/17710018/995714\">don&#39;t use <code>atoi</code></a>"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1504065199, "post_id": 45951386, "comment_id": 78861535, "body": "@L\u01b0uV\u0129nhPh&#250;c There are only 3 numbers: 0, 1, and lots."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504065424, "post_id": 45951386, "comment_id": 78861596, "body": "@o11c I don&#39;t get you. Try <code>const int SIZE = 10; int grid[SIZE][SIZE]</code>"}, {"owner": {"reputation": 37, "user_id": 7027796, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6939a91e5bd2eed54a88cc06813002d?s=128&d=identicon&r=PG&f=1", "display_name": "user7027796", "link": "https://stackoverflow.com/users/7027796/user7027796"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1504065672, "post_id": 45951386, "comment_id": 78861667, "body": "@L\u01b0uV\u0129nhPh&#250;c This is a very good suggestion."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8535607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hewMH.jpg?s=128&g=1", "display_name": "Andrey Zaytsev", "link": "https://stackoverflow.com/users/8535607/andrey-zaytsev"}, "is_accepted": false, "score": 1, "last_activity_date": 1504063933, "creation_date": 1504063933, "answer_id": 45951455, "question_id": 45951386, "link": "https://stackoverflow.com/questions/45951386/error-expected-got-10-in-c-programming/45951455#45951455", "title": "error: &#39;,&#39; expected (got &quot;10&quot;) in C programming", "body": "<p>I've just tried compiling your code, and it seems like the <code>#define size</code> macro is conflicting with the <code>int size</code> parameter in the <code>drop</code> function.</p>\n\n<p>Here is the output of <code>gcc</code> on my Mac:</p>\n\n<pre><code>temp.c:11:15: error: expected ')'\nvoid drop(int size, int x_coor, int y_coor, int grid);\n              ^\ntemp.c:8:14: note: expanded from macro 'size'\n#define size 10\n             ^\ntemp.c:11:10: note: to match this '('\nvoid drop(int size, int x_coor, int y_coor, int grid);\n              ^\n</code></pre>\n\n<p>Hopefully that fixed it! :)</p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 7027796, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6939a91e5bd2eed54a88cc06813002d?s=128&d=identicon&r=PG&f=1", "display_name": "user7027796", "link": "https://stackoverflow.com/users/7027796/user7027796"}, "edited": false, "score": 0, "creation_date": 1504064749, "post_id": 45951458, "comment_id": 78861443, "body": "Thanks for your help. I changed the naming, now it fixed, but the there is another runtime error: pointer expected."}], "tags": [], "owner": {"reputation": 3794, "user_id": 7256714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adeb98b0e8995d8576ad5f66c0f982e5?s=128&d=identicon&r=PG&f=1", "display_name": "Pras", "link": "https://stackoverflow.com/users/7256714/pras"}, "is_accepted": false, "score": 3, "last_activity_date": 1504063962, "creation_date": 1504063962, "answer_id": 45951458, "question_id": 45951386, "link": "https://stackoverflow.com/questions/45951386/error-expected-got-10-in-c-programming/45951458#45951458", "title": "error: &#39;,&#39; expected (got &quot;10&quot;) in C programming", "body": "<pre><code>void drop(int size, int x_coor, int y_coor, int grid);\n</code></pre>\n\n<p>It is getting converted to </p>\n\n<pre><code>void drop(int 10, int x_coor, int y_coor, int grid);\n</code></pre>\n\n<p>After compiler preprocessing step, as you have defined <code>#define size 10</code></p>\n\n<p>You should declare it as </p>\n\n<pre><code>void drop(int , int , int , int );\n</code></pre>\n\n<p>Or just use different name for that variable in function declaration</p>\n"}], "owner": {"reputation": 37, "user_id": 7027796, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c6939a91e5bd2eed54a88cc06813002d?s=128&d=identicon&r=PG&f=1", "display_name": "user7027796", "link": "https://stackoverflow.com/users/7027796/user7027796"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1504064881, "creation_date": 1504063411, "last_edit_date": 1504064881, "question_id": 45951386, "link": "https://stackoverflow.com/questions/45951386/error-expected-got-10-in-c-programming", "title": "error: &#39;,&#39; expected (got &quot;10&quot;) in C programming", "body": "<p>before I ask this question I have already debugged it for hours and read similar question post but I still cannot solve this problem. I checked that the error occurs when I define void drop(int size, int x_coor, int y_coor, int grid) this method.How to fix this error? </p>\n\n<p>This is the error: </p>\n\n<blockquote>\n  <p>main.c:11: error: ',' expected (got \"10\")</p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nconst int max_height = 4;\n\nint height;\n\n#define size 10\nint grid[size][size];\n\nvoid drop(int size, int x_coor, int y_coor, int grid);\nint is_stable(int grid[size][size]);\nvoid display(int grid[size][size]);\n\n/*\nFunction to print out the 23*23 grid with given number of piles\n*/\n\nvoid create_InitialGrid(int total_param, char *piles[])\n{\n    int i, j, k, assigned;\n\n    for (i = 0; i &lt; size; i++)\n    {\n        for (j = 0; j &lt; size; j++)\n        {\n            for (k = 1; k &lt; total_param; k = k + 3)\n            {\n\n                if ((atoi(piles[k]) == i) &amp;&amp; (atoi(piles[k + 1]) == j))\n                {\n                    height = atoi(piles[k + 2]);\n\n                    grid[i][j] = height; //store value into 2D array\n\n                    assigned = 1;\n                    break;\n                }\n                else\n                {\n                    assigned = 0;\n                }\n\n            }\n            if (assigned != 1)\n            {\n                height = 0;\n                grid[i][j] = height;\n            }\n\n        }\n    }\n\n}\n\n\n//Simulate a grain of sand is dropped onto the center pile of the pane\n\nvoid drop(int size, int x_coor, int y_coor, int grid)\n{\n    .........\n}\n\n/*\nDisplay the 2D array\n*/\nvoid display(int grid[size][size])\n{\n    int i, j;\n    for (i = 0; i &lt; size; i++)\n    {\n        for (j = 0; j &lt; size; j++)\n        {\n            printf(\"%d\", grid[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\n\nint main(int argc, char *argv[])\n{\n    create_InitialGrid(argc, argv);\n\n    printf(\"Initial Grid: \\n\");\n\n    display(grid);\n\n    printf(\"////////////////////// \\n\");\n    drop();\n\n    display(grid);\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "performance"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1504063723, "post_id": 45951384, "comment_id": 78861235, "body": "Your lookup-table version will be considerably faster if you use a <code>switch</code> statement as that will be compiled into a static lookup table."}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1504063790, "post_id": 45951384, "comment_id": 78861250, "body": "It&#39;s <i>possible</i> that an implementation of <code>log2(char)</code> will use a lookup-table (perhaps even in hardware) but that is not guaranteed by the C standard library specification. But division is always expensive, even for integers."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1504063928, "post_id": 45951384, "comment_id": 78861279, "body": "@Dai thanks, that is very useful info! I&#39;m about 1/4 into a run with the if-statements so I&#39;ll change those to switch once this run finishes and track time. Unfortunately runs take like 2 hours :( LOL"}, {"owner": {"reputation": 2559, "user_id": 5087125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6R64Z.jpg?s=128&g=1", "display_name": "pvg", "link": "https://stackoverflow.com/users/5087125/pvg"}, "edited": false, "score": 0, "creation_date": 1504064140, "post_id": 45951384, "comment_id": 78861326, "body": "Well, you could always measure it which is the sanest way to answer this kind of question but almost anything is going to be faster than log2 and turning a bit fiddling problem into a floating point one."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 2559, "user_id": 5087125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6R64Z.jpg?s=128&g=1", "display_name": "pvg", "link": "https://stackoverflow.com/users/5087125/pvg"}, "edited": false, "score": 0, "creation_date": 1504064258, "post_id": 45951384, "comment_id": 78861353, "body": "@pvg yes I&#39;m measuring them now, but since the program takes 2 hours to run those take a while. I was looking for a more &quot;scientific&quot; explanation that explains the underlying theory or reason why like what Dai explained about switch/lookup table. Since I teach myself I do a lot of the practical &quot;engineering&quot; tests but miss out on the actual &quot;computer science&quot;."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504064294, "post_id": 45951384, "comment_id": 78861362, "body": "The conversion to/from float is probably actually the most expensive part."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504064325, "post_id": 45951384, "comment_id": 78861368, "body": "Use this site as your reference for everything: <a href=\"http://graphics.stanford.edu/~seander/bithacks.html\" rel=\"nofollow noreferrer\">graphics.stanford.edu/~seander/bithacks.html</a>"}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504064380, "post_id": 45951384, "comment_id": 78861380, "body": "@o11c really?! Fascinating, does the conversion require movement in memory of some sort? I figured it was just changing the way C represents the number. I should probably read up on typecasting. Thanks for the link."}, {"owner": {"reputation": 2559, "user_id": 5087125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6R64Z.jpg?s=128&g=1", "display_name": "pvg", "link": "https://stackoverflow.com/users/5087125/pvg"}, "edited": false, "score": 1, "creation_date": 1504064394, "post_id": 45951384, "comment_id": 78861382, "body": "You can measure just the thing you&#39;re asking about, that&#39;s not going to take two hours. The problem itself - finding the single bit that&#39;s set in a value is well googleable, btw, lots of decent solutions. Just avoid log2 for this."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 2559, "user_id": 5087125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6R64Z.jpg?s=128&g=1", "display_name": "pvg", "link": "https://stackoverflow.com/users/5087125/pvg"}, "edited": false, "score": 0, "creation_date": 1504064450, "post_id": 45951384, "comment_id": 78861391, "body": "@pvg fair point. I&#39;ll write a sort of unit test type thing for it also. Thanks for the suggestion."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 1, "creation_date": 1504065278, "post_id": 45951384, "comment_id": 78861560, "body": "Either it&#39;s important to you. Then you write two versions and measure their speed. Or it&#39;s not important. Then its not important."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504065279, "post_id": 45951384, "comment_id": 78861561, "body": "@AshwinGupta In short, float registers and integer registers are completely separate units in the CPU, and it is always expensive to move things between units."}, {"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1504074493, "post_id": 45951384, "comment_id": 78864585, "body": "2 Hours algorithm and you bother with the speed of bit position finding? Did you actually measure whether this has any significant performance impact? If you did measure it, you should mention it in the question... otherwise people tend to assume you didn&#39;t measure."}, {"owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1504074608, "post_id": 45951384, "comment_id": 78864645, "body": "@grek40 This part of the program is totally independent of the other part in the other question. This function is run AFTER the primes are computed. I&#39;ve been testing both halves individually."}], "owner": {"reputation": 2100, "user_id": 4484072, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/6RQQD.jpg?s=128&g=1", "display_name": "Ashwin Gupta", "link": "https://stackoverflow.com/users/4484072/ashwin-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1504072490, "answer_count": 0, "score": 0, "last_activity_date": 1504063404, "creation_date": 1504063404, "question_id": 45951384, "link": "https://stackoverflow.com/questions/45951384/which-is-faster-logarithm-or-lookup-table", "closed_reason": "Duplicate", "title": "Which is faster: logarithm or lookup table?", "body": "<p>In my program I have a function that takes a byte that is always a power of two (never zero) and returns the position of the 1 (high bit) as an integer.  </p>\n\n<pre><code>e.g. f(0010 0000) -&gt;  2, f(0000 0001) -&gt; 7 \n</code></pre>\n\n<p>This C program has to run this function millions of times so I need it to be very fast. I've written two implementations for this function, and I don't really know which is faster. </p>\n\n<pre><code>int f(unsigned char bit) {\n    //ln2 is the log base e of two. Basically I'm doing 7 minus log base 2 of the input\n    return (int)(7 - round(log(bit) / ln2));\n} \n\nint f(unsigned char bit) {\n    if (bit == 0x00) /**/ return 0;\n    else if (bit == 0x01) return 7;\n    else if (bit == 0x02) return 6;\n    else if (bit == 0x04) return 5;\n    else if (bit == 0x08) return 4;\n    else if (bit == 0x10) return 3;\n    else if (bit == 0x20) return 2;\n    else if (bit == 0x40) return 1;\n    else if (bit == 0x80) return 0;\n}\n</code></pre>\n\n<p>I have no computer science education, I'm just a hobbyist so a lot of these problems are hard for me to figure out on my own. I figure that the log() function is slow, but I know that if statements take cycles and branch prediction can cause stuff to slow down. I honestly don't know if that is correct though, just guessing. </p>\n\n<p>Could anyone provide insight for me on which is faster and why? Or if you have an alternative, even better way I'm open to suggestions! Thanks!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504065540, "post_id": 45951161, "comment_id": 78861633, "body": "OK, yet the other way a round is  a problem on <i>very rare</i> machines.  De-referencing a <code>unsigned char</code> via a <code>signed char *</code> may trigger an exception.  Doubt any machine exists anymore  that  exploits that corner of C."}], "answers": [{"tags": [], "owner": {"reputation": 200780, "user_id": 116908, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d38793d7a407446999b33b81d607fd?s=128&d=identicon&r=PG", "display_name": "Carl Norum", "link": "https://stackoverflow.com/users/116908/carl-norum"}, "is_accepted": false, "score": 0, "last_activity_date": 1504061797, "creation_date": 1504061797, "answer_id": 45951170, "question_id": 45951161, "link": "https://stackoverflow.com/questions/45951161/is-it-safe-to-convert-char-to-const-unsigned-char/45951170#45951170", "title": "Is it safe to convert char * to const unsigned char *?", "body": "<p>If it's being treated as a string by that interface, there should be no problem at all. You don't even need to add the <code>const</code> in your cast if you don't want to - that part is automatic.</p>\n"}, {"tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": false, "score": 0, "last_activity_date": 1504062149, "creation_date": 1504062149, "answer_id": 45951214, "question_id": 45951161, "link": "https://stackoverflow.com/questions/45951161/is-it-safe-to-convert-char-to-const-unsigned-char/45951214#45951214", "title": "Is it safe to convert char * to const unsigned char *?", "body": "<p>Technically, it is always safe to convert pointers from one type to another (except between function pointers and data pointers, unless your implementation provides an extension that allows that). It's only the <em>dereferencing</em> that is unsafe.</p>\n\n<p>But dereferencing a pointer to any signedness of <code>char</code> is always safe (from a type aliasing perspective, at least).</p>\n"}, {"tags": [], "owner": {"reputation": 194, "user_id": 7873515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d04fbf12fb53c0ab40f84363bc063ad?s=128&d=identicon&r=PG&f=1", "display_name": "lwzhuo", "link": "https://stackoverflow.com/users/7873515/lwzhuo"}, "is_accepted": true, "score": 1, "last_activity_date": 1504065048, "creation_date": 1504065048, "answer_id": 45951590, "question_id": 45951161, "link": "https://stackoverflow.com/questions/45951161/is-it-safe-to-convert-char-to-const-unsigned-char/45951590#45951590", "title": "Is it safe to convert char * to const unsigned char *?", "body": "<p>it is safe.</p>\n\n<pre><code>char *str = \"somestring\";\n</code></pre>\n\n<p>str is a constant,you could change str point to another string:</p>\n\n<pre><code>str = \"some\";//right\n</code></pre>\n\n<p>but you can't change the string which str is pointing now</p>\n\n<pre><code>str[0]='q';//wrong\n</code></pre>\n\n<p>so it is safe to use const to convert a constant to constant</p>\n\n<p>if the asdf() only use to show the string,likes printf() or puts() ,you no need to const,because you are not change the string.</p>\n\n<p>if you use const it will be safer.when you implementing the asdf(),it will make sure you can't write the wrong code likes \"str[0]='q';\" because you can't compile it.</p>\n\n<p>if there are no const,you will find the error until you running the program.</p>\n"}, {"tags": [], "owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "is_accepted": false, "score": 0, "last_activity_date": 1504102247, "creation_date": 1504102247, "answer_id": 45962749, "question_id": 45951161, "link": "https://stackoverflow.com/questions/45951161/is-it-safe-to-convert-char-to-const-unsigned-char/45962749#45962749", "title": "Is it safe to convert char * to const unsigned char *?", "body": "<p>It probably won't break anything in the compiler if you pass a <code>char*</code> where an <code>unsigned char*</code> was expected by using a cast. The <code>const</code> part is unproblematic -- it's just indicating that the function won't modify the argument via its pointer.</p>\n\n<p>In many cases it doesn't matter whether <code>char</code> values are treated as signed or unsigned -- it's usually only a problem when performing arithmetic or comparing the sizes of values. However, if the function is expressly defined to take an <code>unsigned char*</code>, I guess there's a chance that it really requires the input data to be unsigned, for some arithmetical reason. If you're treating your character data as signed elsewhere, then it's possible that there is an incompatibility between your data and the data expected by the function.</p>\n\n<p>In many cases, however, developers write \"unsigned\" to mean \"I will not be doing arithmetic on this data\", so the signedness probably won't matter.</p>\n"}], "owner": {"reputation": 6672, "user_id": 2038901, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/88a2242eb110fda489eee0bcbde6f2bd?s=128&d=identicon&r=PG", "display_name": "Sato", "link": "https://stackoverflow.com/users/2038901/sato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 1, "accepted_answer_id": 45951590, "answer_count": 4, "score": 2, "last_activity_date": 1504102247, "creation_date": 1504061688, "question_id": 45951161, "link": "https://stackoverflow.com/questions/45951161/is-it-safe-to-convert-char-to-const-unsigned-char", "title": "Is it safe to convert char * to const unsigned char *?", "body": "<p>We are using <code>char *</code> and the lib we use is using <code>const unsigned char *</code>, so we convert to <code>const unsigned char *</code></p>\n\n<pre><code>// lib\nint asdf(const unsigned char *vv);\n\n//ours\nchar *str = \"somestring\";\nasdf((const unsigned char*)str);\n</code></pre>\n\n<p>Is it safe? any pitfall?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1504058291, "post_id": 45950601, "comment_id": 78860144, "body": "You can also use <a href=\"https://codereview.stackexchange.com/\">Code Review</a>"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1504066729, "post_id": 45950601, "comment_id": 78861937, "body": "<a href=\"https://stackoverflow.com/a/19920014/1708801\">CERT covers how to check for overflow</a> and <a href=\"https://stackoverflow.com/a/32317442/1708801\">clang and gcc have builtins that deal with overflow</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "edited": false, "score": 0, "creation_date": 1504057674, "post_id": 45950629, "comment_id": 78860036, "body": "Yes, that was my original implementation, which I tried to improve here. Thank you!!!"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 1, "last_activity_date": 1504057705, "last_edit_date": 1504057705, "creation_date": 1504057374, "answer_id": 45950629, "question_id": 45950601, "link": "https://stackoverflow.com/questions/45950601/verifying-a-test-for-multiplication-overflow/45950629#45950629", "title": "Verifying a test for multiplication-overflow", "body": "<p>No, it is not guaranteed to work correctly. For example, </p>\n\n<pre><code>0x000FFFFF * 0x000FFFFF = 0xFFFFE00001 \n</code></pre>\n\n<p>It produces <code>0xFFE00001</code> after truncation to 32 bits, which passes your test. But multiplication overflows.</p>\n\n<p>To test for overflow on multiplication you can simply check <code>z / x == y</code> provided <code>x</code> is not zero.</p>\n"}], "owner": {"reputation": 5234, "user_id": 7400903, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66a5c6bdca5a30cc6fdacd92fc5745a2?s=128&d=identicon&r=PG&f=1", "display_name": "goodvibration", "link": "https://stackoverflow.com/users/7400903/goodvibration"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 1, "accepted_answer_id": 45950629, "answer_count": 1, "score": 1, "last_activity_date": 1504057705, "creation_date": 1504057051, "question_id": 45950601, "link": "https://stackoverflow.com/questions/45950601/verifying-a-test-for-multiplication-overflow", "title": "Verifying a test for multiplication-overflow", "body": "<p>I have implemented the following function for detecting whether or not a multiplication overflows:</p>\n\n<pre><code>bool IsSafeMul(uint32_t x, uint32_t y) {\n    uint32_t z = x * y;\n    return (z &gt;= x &amp;&amp; z &gt;= y);\n}\n</code></pre>\n\n<p>I have verified it empirically, but would like to ensure that:</p>\n\n<ol>\n<li>Is it 100% guaranteed to work correctly (i.e., no false-positives and no false-negatives)?</li>\n<li>Is it 100% guaranteed to work correctly for any other <code>unsigned</code> type?</li>\n</ol>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "algorithm", "data-structures", "tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 526, "user_id": 4244956, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vGfSJ.jpg?s=128&g=1", "display_name": "LTClipp", "link": "https://stackoverflow.com/users/4244956/ltclipp"}, "edited": false, "score": 1, "creation_date": 1504056035, "post_id": 45950440, "comment_id": 78859684, "body": "We won&#39;t do your homework for you. Creating binary search trees are trivial, I suggest you use Google (or your class notes) to figure this out because this is an extremely well-documented problem."}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1504057621, "post_id": 45950440, "comment_id": 78860027, "body": "Tthis links may be help you. <a href=\"https://www.tutorialspoint.com/data_structures_algorithms/binary_search_tree.htm\" rel=\"nofollow noreferrer\">code</a>   <a href=\"https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=4&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwiG_v6j6f3VAhWDsxQKHfaJDF4QFgg5MAM&amp;url=http%3A%2F%2Fcs.txstate.edu%2F~rp44%2Fcs3358_092%2FLectures%2Fbst.ppt&amp;usg=AFQjCNFrnJ7j5ieBuZ4AhxH8PjMbEqQYTg\" rel=\"nofollow noreferrer\">slide for learn basics</a>"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1504057727, "post_id": 45950440, "comment_id": 78860045, "body": "You must show your codes, trying and possible error or misbehavior to ask others help in Stack Overflow. don&#39;t worry about down-votes. they voted down because you  ask a unclear question. Read <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to see how to ask question in SO"}], "answers": [{"tags": [], "owner": {"reputation": 3705, "user_id": 8334991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v0H6m.jpg?s=128&g=1", "display_name": "Alexandre Fenyo", "link": "https://stackoverflow.com/users/8334991/alexandre-fenyo"}, "is_accepted": false, "score": 1, "last_activity_date": 1504056028, "creation_date": 1504056028, "answer_id": 45950487, "question_id": 45950440, "link": "https://stackoverflow.com/questions/45950440/how-can-i-construct-this-tree/45950487#45950487", "title": "How can I construct this tree?", "body": "<p>Since you start with 50, it is the root, so this is the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mC5nY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mC5nY.png\" alt=\"Binary Search Tree\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 8139729, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh6.googleusercontent.com/-qnGAhEQNwO4/AAAAAAAAAAI/AAAAAAAAANw/tT_GGWAlVnE/photo.jpg?sz=128", "display_name": "Rafael Camara", "link": "https://stackoverflow.com/users/8139729/rafael-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1504056028, "creation_date": 1504055583, "question_id": 45950440, "link": "https://stackoverflow.com/questions/45950440/how-can-i-construct-this-tree", "title": "How can I construct this tree?", "body": "<p>Hey guys I'm getting a bit lost when trying to draw a BST with these keys  50 30 70 20 40 60 80 15 25 35 45 36,  they are inserted in this order, How exactly this tree looks like?</p>\n"}, {"tags": ["c++", "c", "memory", "byte", "theory"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1504055485, "post_id": 45950419, "comment_id": 78859582, "body": "It probably is because <b>unsigned</b> can&#39;t hold negative numbers."}, {"owner": {"reputation": 5950, "user_id": 3991211, "user_type": "registered", "profile_image": "https://graph.facebook.com/1042922965/picture?type=large", "display_name": "Garr Godfrey", "link": "https://stackoverflow.com/users/3991211/garr-godfrey"}, "edited": false, "score": 1, "creation_date": 1504055574, "post_id": 45950419, "comment_id": 78859597, "body": "yep, ULLONG_MIN  is 0"}, {"owner": {"reputation": 147, "user_id": 3460036, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Kbra1.gif?s=128&g=1", "display_name": "Computer", "link": "https://stackoverflow.com/users/3460036/computer"}, "edited": false, "score": 0, "creation_date": 1504055627, "post_id": 45950419, "comment_id": 78859608, "body": "Oh yes of course not, its unsigned. But it would be 0? If I were to say -(ULLONG_MAX) it gives me a 1 not 0."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1504055820, "post_id": 45950419, "comment_id": 78859640, "body": "<a href=\"https://www.youtube.com/watch?v=PPAlh_FmO4M\" rel=\"nofollow noreferrer\">youtube.com/watch?v=PPAlh_FmO4M</a> explains why it&#39;s 1."}, {"owner": {"reputation": 526, "user_id": 4244956, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vGfSJ.jpg?s=128&g=1", "display_name": "LTClipp", "link": "https://stackoverflow.com/users/4244956/ltclipp"}, "edited": false, "score": 0, "creation_date": 1504055837, "post_id": 45950419, "comment_id": 78859641, "body": "@Computer -(ULLONG_MAX) gives you 1 because of the 2&#39;s complement operation that the computer performs in order to obtain a &quot;negative&quot; version of the number. <a href=\"https://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Two%27s_complement</a>"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1504055947, "post_id": 45950419, "comment_id": 78859667, "body": "Oh and by the way, <b>signed</b> numbers use one bit for the sign, so it would be a range of <code>-2^63</code> to <code>2^63-1</code>."}, {"owner": {"reputation": 3184, "user_id": 1058916, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5f2f3475aba0c4b388692df3f5546bb9?s=128&d=identicon&r=PG", "display_name": "fefe", "link": "https://stackoverflow.com/users/1058916/fefe"}, "edited": false, "score": 0, "creation_date": 1504056736, "post_id": 45950419, "comment_id": 78859844, "body": "For -(ULLONG_MAX) you can ask a separate question. I quote from the C++ specification: &quot;The negative of an unsigned quantity is computed by subtracting its value from 2^{n}, where n is the number of bits in the promoted operand.&quot; C should be similar. The point is, <code>-</code> does not do what you expect it to do on unsigned numbers."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1504169413, "post_id": 45950419, "comment_id": 78912941, "body": "@tkausl: Sign bits are quite rare in integer representations. x86, ARM and other common architectures all use twos&#39; complement. <i>Floating point</i> numbers generally do have sign bits, though. You can generally spot the use of two&#39;s complement because the range is asymmetric. <code>-2^63 to 2^63-1</code> is a typical example of 2&#39;s complement; with a sign bit that range would have been <code>-2^63+1 to 2^63-1</code>"}, {"owner": {"reputation": 147, "user_id": 3460036, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Kbra1.gif?s=128&g=1", "display_name": "Computer", "link": "https://stackoverflow.com/users/3460036/computer"}, "edited": false, "score": 0, "creation_date": 1504405863, "post_id": 45950419, "comment_id": 78999307, "body": "Cowards, all of you."}], "answers": [{"tags": [], "owner": {"reputation": 526, "user_id": 4244956, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/vGfSJ.jpg?s=128&g=1", "display_name": "LTClipp", "link": "https://stackoverflow.com/users/4244956/ltclipp"}, "is_accepted": false, "score": 1, "last_activity_date": 1504055668, "creation_date": 1504055668, "answer_id": 45950451, "question_id": 45950419, "link": "https://stackoverflow.com/questions/45950419/limits-h-unacknowledged-values-in-c/45950451#45950451", "title": "limits.h unacknowledged values in C", "body": "<p><a href=\"http://www.cplusplus.com/reference/climits/\" rel=\"nofollow noreferrer\">ULLONG_MAX is a constant that defines the maximum value for an unsigned long long int.</a></p>\n\n<p>The minimum value of any unsigned number is by definition 0. Unsigned numbers cannot have negative values.</p>\n"}], "owner": {"reputation": 147, "user_id": 3460036, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Kbra1.gif?s=128&g=1", "display_name": "Computer", "link": "https://stackoverflow.com/users/3460036/computer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1504055668, "creation_date": 1504055347, "question_id": 45950419, "link": "https://stackoverflow.com/questions/45950419/limits-h-unacknowledged-values-in-c", "title": "limits.h unacknowledged values in C", "body": "<p>I want to discover if there is a limit value designated to <code>ULLONG_MIN</code>.</p>\n\n<p>I know there is a <code>ULLONG_MAX</code> which has the value <code>18446744073709551615</code> or <code>2^{64}-1</code>.</p>\n\n<p>Does this mean that a theoretical <code>ULLONG_MIN</code> would be equivalent to <code>-(2^{64}-1)</code>?</p>\n\n<p>I tried displaying it to the console by <code>unsigned long ULLONG_MIN = -(pow(2,64)-1);</code> and on my machine I get <code>9223372036854775808</code> which is probably half. Is it, because 64 bits cannot hold from -2^{64} to 2^{64}?</p>\n"}, {"tags": ["c", "sockets", "tcp", "client-server"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 3105318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ed026fa0bae68a8d11b4ffbd0eab03?s=128&d=identicon&r=PG&f=1", "display_name": "Zain Qazi", "link": "https://stackoverflow.com/users/3105318/zain-qazi"}, "edited": false, "score": 0, "creation_date": 1504058372, "post_id": 45950220, "comment_id": 78860161, "body": "Thank you. In addition can you please explain when enter a message like &quot;How are you&quot;, the server responds in different lines.&quot;How&quot; &quot;are&quot; and &quot;you&quot; are on three different lines"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 73, "user_id": 3105318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ed026fa0bae68a8d11b4ffbd0eab03?s=128&d=identicon&r=PG&f=1", "display_name": "Zain Qazi", "link": "https://stackoverflow.com/users/3105318/zain-qazi"}, "edited": false, "score": 0, "creation_date": 1504093139, "post_id": 45950220, "comment_id": 78876684, "body": "Because that&#39;s how it works. You need to 1. Use <code>select</code> and read until there is nothing more to read, but this is tricky. 2. Use a messaging protocol to assemble a message and reconstruct it when it reaches the other party."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1504053571, "creation_date": 1504053571, "answer_id": 45950220, "question_id": 45950202, "link": "https://stackoverflow.com/questions/45950202/c-sockets-why-is-my-server-appending-extra-characters-in-the-end/45950220#45950220", "title": "C sockets: why is my server appending extra characters in the end?", "body": "<p>You need a <em>string</em> in order to use <code>strlen()</code>. Your arrays are not strings, rely on <code>read_size</code> instead for the length of the buffer.</p>\n\n<p>Strings in <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> are just a sequence of printable characters followed by a <code>'\\0'</code>, and none of your arrays has any <code>'\\0'</code> so <code>strlen()</code> is causing undefined behavior. The <code>strlen()</code> function actually scans the <em>string</em> until it finds the <code>'\\0'</code> and in the process it counts how many characters were there.</p>\n"}, {"tags": [], "owner": {"reputation": 518, "user_id": 8433769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DpNLP.png?s=128&g=1", "display_name": "Alt Eisen", "link": "https://stackoverflow.com/users/8433769/alt-eisen"}, "is_accepted": false, "score": 0, "last_activity_date": 1504056195, "last_edit_date": 1504056195, "creation_date": 1504054250, "answer_id": 45950296, "question_id": 45950202, "link": "https://stackoverflow.com/questions/45950202/c-sockets-why-is-my-server-appending-extra-characters-in-the-end/45950296#45950296", "title": "C sockets: why is my server appending extra characters in the end?", "body": "<p>@Iharob's answer is correct. Basically, change the line:</p>\n\n<pre><code>write(client_socket_fd, buffer, strlen(buffer))\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>write(client_socket_fd, buffer, read_size)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 3105318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ed026fa0bae68a8d11b4ffbd0eab03?s=128&d=identicon&r=PG&f=1", "display_name": "Zain Qazi", "link": "https://stackoverflow.com/users/3105318/zain-qazi"}, "edited": false, "score": 0, "creation_date": 1504056529, "post_id": 45950498, "comment_id": 78859795, "body": "Thank you. I&#39;m new to this and this helped. However, when I enter a string like &quot;How are you&quot;, it displays it on different lines."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 73, "user_id": 3105318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ed026fa0bae68a8d11b4ffbd0eab03?s=128&d=identicon&r=PG&f=1", "display_name": "Zain Qazi", "link": "https://stackoverflow.com/users/3105318/zain-qazi"}, "edited": false, "score": 0, "creation_date": 1504059904, "post_id": 45950498, "comment_id": 78860456, "body": "Possibly <code>scanf()</code> is tokenizing at the spaces. It has nothing to do with the question you asked."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": -1, "last_activity_date": 1504056098, "creation_date": 1504056098, "answer_id": 45950498, "question_id": 45950202, "link": "https://stackoverflow.com/questions/45950202/c-sockets-why-is-my-server-appending-extra-characters-in-the-end/45950498#45950498", "title": "C sockets: why is my server appending extra characters in the end?", "body": "<p>It isn't. You are printing junk at the end of your buffer. You're also ignoring end of stream.</p>\n\n<pre><code>if(recv(socket_fd, server_reply, BUFSIZE,0)&lt;0) {\n    fprintf(stderr,\"failed to reply. \\n\");\n    break;\n}\nfprintf(stdout, \"Reply: %s\\n \", servreply);\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>int count;\nif((count = recv(socket_fd, server_reply, BUFSIZE,0))&lt;0) {\n    fprintf(stderr,\"failed to reply. \\n\");\n    break;\n}\nelse if (count == 0) {\n    // EOS\n    fprintf(stderr, \"peer has disconnected.\\n\");\n    break;\n} else {  \n    fprintf(stdout, \"Reply: %.*s\\n \", count, servreply);\n}\n</code></pre>\n\n<p>Your 'write back to the client' is also incorrect:</p>\n\n<pre><code>if (0 &gt; write(client_socket_fd, buffer, strlen(buffer))) {\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>if (0 &gt; write(client_socket_fd, buffer, read_size)) {\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 3105318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03ed026fa0bae68a8d11b4ffbd0eab03?s=128&d=identicon&r=PG&f=1", "display_name": "Zain Qazi", "link": "https://stackoverflow.com/users/3105318/zain-qazi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2145, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1504056195, "creation_date": 1504053405, "question_id": 45950202, "link": "https://stackoverflow.com/questions/45950202/c-sockets-why-is-my-server-appending-extra-characters-in-the-end", "title": "C sockets: why is my server appending extra characters in the end?", "body": "<p>I am writing a simple server/client socket in C. The client asks the user to input a message and the server responds by repeating the same. The problem is when I send a message from the client the server responds back by appending extra character. How do I fix this.</p>\n\n<p>This is my Client code</p>\n\n<pre><code>while(1) {\n    bzero(buffer, BUFSIZE);\n    printf(\"Enter Message: \");\n    scanf(\"%s\", buffer);\n    //send some data\n    if(send(socket_fd, buffer, strlen(buffer), 0) &lt;0) {\n        fprintf(stderr,\"sending failed\\n\");\n        return 1;\n    }\n//receive a reply from the server\nif(recv(socket_fd, server_reply, BUFSIZE,0)&lt;0)\n{\n    fprintf(stderr,\"failed to reply. \\n\");\n    break;\n}\nfprintf(stdout, \"Reply: %s\\n \", servreply);\n\n}\n</code></pre>\n\n<p>This is my server code</p>\n\n<pre><code> int read_size;\n    while((read_size = recv(client_socket_fd, buffer, BUFSIZE,0))&gt;0)\n    {\n\n        // Reply back to the client\n        if (0 &gt; write(client_socket_fd, buffer, strlen(buffer))) {\n            fprintf(stderr, \"could not write back to socket\\n\");\n        } else {\n            fprintf(stdout, \"message back to client\\n\");\n        }\n    }\n    if(read_size==0)\n    {\n        fprintf(stderr,\"disconnected.\\n\");\n        fflush(stdout);\n    }\n    else if(read_size==-1){\n        fprintf(stderr, \"error.\\n\");\n    }\n</code></pre>\n\n<p>This is the output</p>\n\n<pre><code> Enter Message: welcome\nReply: welcome\n Enter Message: hello\nReply: hellome\n Enter Message: hi\nReply: hillome\n</code></pre>\n"}, {"tags": ["c", "dev-c++"], "comments": [{"owner": {"reputation": 52633, "user_id": 3155639, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d254eedd932f950213109aa3706aba74?s=128&d=identicon&r=PG", "display_name": "Alexander O&#39;Mara", "link": "https://stackoverflow.com/users/3155639/alexander-omara"}, "edited": false, "score": 3, "creation_date": 1504049940, "post_id": 45949784, "comment_id": 78858222, "body": "Typo: <code>printf(&quot;...: %d&quot;, &amp;n);</code> should be: <code>printf(&quot;...: %d&quot;, n);</code>, <code>&amp;n</code> is the memory address of the value."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1504050022, "post_id": 45949784, "comment_id": 78858243, "body": "<i>&quot;I don&#180;t know what else to do.&quot;</i> - perhaps compile with warnings enabled..."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "edited": false, "score": 1, "creation_date": 1504050717, "post_id": 45949784, "comment_id": 78858431, "body": "That&#39;s not the case: Your program returns the value you told it to.  That it doesn&#39;t return the value you expected <i>should</i> tell you something about the error."}, {"owner": {"reputation": 1747, "user_id": 3726902, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kV59z.png?s=128&g=1", "display_name": "Miket25", "link": "https://stackoverflow.com/users/3726902/miket25"}, "edited": false, "score": 1, "creation_date": 1504052341, "post_id": 45949784, "comment_id": 78858875, "body": "I&#39;m surprise you get 6487628, <i>every time</i>"}], "answers": [{"tags": [], "owner": {"reputation": 1037, "user_id": 6342463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/STRPB.jpg?s=128&g=1", "display_name": "Jabberwock", "link": "https://stackoverflow.com/users/6342463/jabberwock"}, "is_accepted": true, "score": 4, "last_activity_date": 1504049905, "creation_date": 1504049905, "answer_id": 45949797, "question_id": 45949784, "link": "https://stackoverflow.com/questions/45949784/dev-c-keeps-returning-a-wrong-value/45949797#45949797", "title": "Dev C keeps returning a wrong value", "body": "<p>You don't want the &amp;n in the printf(), you want n.  You are displaying the memory location n is stored in</p>\n"}], "owner": {"reputation": 1, "user_id": 8535105, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PQlPD6voIoI/AAAAAAAAAAI/AAAAAAAAAPM/9hZqaIAmf5w/photo.jpg?sz=128", "display_name": "Ricardo Alcaraz", "link": "https://stackoverflow.com/users/8535105/ricardo-alcaraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 953, "favorite_count": 0, "closed_date": 1504051581, "accepted_answer_id": 45949797, "answer_count": 1, "score": -5, "last_activity_date": 1504051551, "creation_date": 1504049795, "last_edit_date": 1504051551, "question_id": 45949784, "link": "https://stackoverflow.com/questions/45949784/dev-c-keeps-returning-a-wrong-value", "closed_reason": "Not suitable for this site", "title": "Dev C keeps returning a wrong value", "body": "<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt; \nmain() \n{\n    int n; \n    printf(\"Introduce un n\u00famero entero\\n\"); \n\n    scanf(\"%d\", &amp;n); \n    printf(\"Has introducido el n\u00famero: %d\", &amp;n); \n} \n</code></pre>\n\n<p>Every time I run this C code I get 6487628 for n, I have uninstalled and installed it over and over again and it keeps doing that, I don\u00b4t know what else to do.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 2598574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdJdH.jpg?s=128&g=1", "display_name": "Mothermole1", "link": "https://stackoverflow.com/users/2598574/mothermole1"}, "edited": false, "score": 0, "creation_date": 1504584646, "post_id": 45949700, "comment_id": 79053323, "body": "Perfect! Makes sense to me. Hard to find this info due to google not pickup the parens :)"}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 10, "last_activity_date": 1504049621, "last_edit_date": 1504049621, "creation_date": 1504049148, "answer_id": 45949700, "question_id": 45949654, "link": "https://stackoverflow.com/questions/45949654/any-functional-difference-between-p-some-var-and-p-some-var/45949700#45949700", "title": "Any functional difference between (*p)-&gt;some_var and *p-&gt;some_var", "body": "<p>Those do not do the same thing at all.  Compare:</p>\n\n<pre><code>(*p)-&gt;some_var // aka (*(*p)).some_var\n</code></pre>\n\n<p>This means \"p is a pointer, which we dereference, then dereference again to access a field.\"</p>\n\n<pre><code>*p-&gt;some_var // aka *((*p).some_var)\n</code></pre>\n\n<p>This means \"p is a pointer, which we dereference to access a field, which is a pointer which we dereference.\"</p>\n"}, {"tags": [], "owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "is_accepted": false, "score": 3, "last_activity_date": 1504049547, "last_edit_date": 1504049547, "creation_date": 1504049242, "answer_id": 45949711, "question_id": 45949654, "link": "https://stackoverflow.com/questions/45949654/any-functional-difference-between-p-some-var-and-p-some-var/45949711#45949711", "title": "Any functional difference between (*p)-&gt;some_var and *p-&gt;some_var", "body": "<p>Since unary <code>*</code> has lower precedence than <code>-&gt;</code>, <code>*p-&gt;some_var</code> is interpreted as <code>*(p-&gt;some_var)</code>, which is obviously different from <code>(*p)-&gt;some_var</code>. </p>\n\n<p>The first one dereferences the <code>some_var</code> member of the struct pointed by <code>p</code> (<code>p</code> here is something like a <code>some_struct *</code>)</p>\n\n<pre><code>struct some_struct {\n    int *some_var;\n};\n\nsome_struct *p = ...;\nint v = *p-&gt;some_var;\n</code></pre>\n\n<p>The second one dereferences <code>p</code>, and accesses the <code>some_var</code> member pointed by the result (here <code>p</code> is a double pointer - <code>some_struct **</code>). </p>\n\n<pre><code>some_struct *a = ...;\nsome_struct **p = &amp;a;\nint *val_ptr = (*p)-&gt;some_var;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13033, "user_id": 4029014, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ndZhu.jpg?s=128&g=1", "display_name": "aghast", "link": "https://stackoverflow.com/users/4029014/aghast"}, "is_accepted": false, "score": 3, "last_activity_date": 1504049528, "creation_date": 1504049528, "answer_id": 45949753, "question_id": 45949654, "link": "https://stackoverflow.com/questions/45949654/any-functional-difference-between-p-some-var-and-p-some-var/45949753#45949753", "title": "Any functional difference between (*p)-&gt;some_var and *p-&gt;some_var", "body": "<p>Let's take a look at the parens and the operators:</p>\n\n<pre><code>(*p)-&gt;some_var\n</code></pre>\n\n<p>Or, put another way:</p>\n\n<pre><code>( operator* identifier ) operator-&gt; identifier \n</code></pre>\n\n<p>Now, let's look at an <a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">operator precedence table</a> and see what's what:</p>\n\n<pre><code>Precedence  Operator    Description     ...\n         1  ... -&gt; ...  Structure and union member access through pointer   \n         2  ... * ...   Indirection (dereference)\n</code></pre>\n\n<p>So right there, we've got your answer:</p>\n\n<pre><code>(operator-with-prec-2 identifier) operator-with-prec-1 identifier\n</code></pre>\n\n<p>Do the parens make a difference? Yes. If you had <code>*p-&gt;somevar</code>, it would evaluate to <code>*(p-&gt;somevar)</code> due to the precedence of the two operators. Inserting the parens causes a change to the evaluation.</p>\n\n<p>If you don't know the effect of the parens, it means you don't know the precedence and/or associativity of the operators. Print out that table and hang it on your wall - there's no shame in being a professional.</p>\n"}, {"tags": [], "owner": {"reputation": 10300, "user_id": 2469027, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b62ce55f4f1a0eff6775e7863850a912?s=128&d=identicon&r=PG", "display_name": "Edward Karak", "link": "https://stackoverflow.com/users/2469027/edward-karak"}, "is_accepted": false, "score": 2, "last_activity_date": 1504051674, "creation_date": 1504051674, "answer_id": 45950012, "question_id": 45949654, "link": "https://stackoverflow.com/questions/45949654/any-functional-difference-between-p-some-var-and-p-some-var/45950012#45950012", "title": "Any functional difference between (*p)-&gt;some_var and *p-&gt;some_var", "body": "<pre><code>(*p)-&gt;some_var\n</code></pre>\n\n<p><code>p</code> is a pointer to a structure or union. It is dereferenced, and then its field <code>some_var</code> is accessed.</p>\n\n<hr>\n\n<pre><code>*p-&gt;some_var\n</code></pre>\n\n<p><code>p</code> is a structure or union. Its field <code>some_var</code> is dereferenced.</p>\n"}], "owner": {"reputation": 217, "user_id": 2598574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdJdH.jpg?s=128&g=1", "display_name": "Mothermole1", "link": "https://stackoverflow.com/users/2598574/mothermole1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 45949700, "answer_count": 4, "score": 4, "last_activity_date": 1504051674, "creation_date": 1504048805, "question_id": 45949654, "link": "https://stackoverflow.com/questions/45949654/any-functional-difference-between-p-some-var-and-p-some-var", "title": "Any functional difference between (*p)-&gt;some_var and *p-&gt;some_var", "body": "<p>I have seen several C code examples which utilise the <strong>(*p)</strong>->some_var way of working with pointers (using parens around the pointer).</p>\n\n<p>My question is, is there any functional difference between the two methods of working with C pointers, and if so, how did this difference come about?</p>\n"}, {"tags": ["c", "arrays", "c99"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504065825, "post_id": 45949509, "comment_id": 78861706, "body": "&quot;to make the code more redable. &quot; Do you mean more readable?"}], "answers": [{"tags": [], "owner": {"reputation": 488, "user_id": 1894697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e31e63c623c67fad9d407a84729c725?s=128&d=identicon&r=PG", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/1894697/chrisb"}, "is_accepted": false, "score": 0, "last_activity_date": 1504048921, "last_edit_date": 1504048921, "creation_date": 1504048513, "answer_id": 45949618, "question_id": 45949509, "link": "https://stackoverflow.com/questions/45949509/access-2d-arrays-through-their-pointer/45949618#45949618", "title": "Access 2D arrays through their pointer", "body": "<p>In the <code>for</code> loop you assign values in the level->map, indexing looks wrong. Try:</p>\n\n<pre><code> level-&gt;map[i * level-&gt;x + e].pos.x = xpos;\n</code></pre>\n\n<p>It is <code>i * level-&gt;x + e</code> because each row <code>i</code> has level->x data, not level->y.</p>\n"}, {"comments": [{"owner": {"reputation": 250, "user_id": 1798390, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6830191bbabb663c3832cb4249de1719?s=128&d=identicon&r=PG", "display_name": "Bungow", "link": "https://stackoverflow.com/users/1798390/bungow"}, "edited": false, "score": 0, "creation_date": 1504081468, "post_id": 45949628, "comment_id": 78868743, "body": "So, it&#39;s not possible to have a pointer holding a <i>generic</i> 2D array to point diferent sizes 2D arrays withou casting right?"}, {"owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "reply_to_user": {"reputation": 250, "user_id": 1798390, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6830191bbabb663c3832cb4249de1719?s=128&d=identicon&r=PG", "display_name": "Bungow", "link": "https://stackoverflow.com/users/1798390/bungow"}, "edited": false, "score": 0, "creation_date": 1504084507, "post_id": 45949628, "comment_id": 78870629, "body": "@Bungow: Right."}], "tags": [], "owner": {"reputation": 205167, "user_id": 4323, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/qqgFU.png?s=128&g=1", "display_name": "John Zwinck", "link": "https://stackoverflow.com/users/4323/john-zwinck"}, "is_accepted": true, "score": 1, "last_activity_date": 1504048584, "creation_date": 1504048584, "answer_id": 45949628, "question_id": 45949509, "link": "https://stackoverflow.com/questions/45949509/access-2d-arrays-through-their-pointer/45949628#45949628", "title": "Access 2D arrays through their pointer", "body": "<p>Yes, you can cast the pointer to 1D array and get a pointer to 2D array.  Start with the same type as when you allocated the 2D array:</p>\n\n<pre><code>struct _mkTile(*map2d)[x] = level-&gt;map; // type mismatch, see compiler error\n</code></pre>\n\n<p>Add a cast:</p>\n\n<pre><code>struct _mkTile(*map2d)[x] = (struct _mkTile(*)[x])level-&gt;map;\n</code></pre>\n\n<p>Finally, clean it up with a typedef:</p>\n\n<pre><code>typedef struct _mkTile row_t[x];\nrow_t* map2d = (row_t*)level-&gt;map;\n</code></pre>\n"}], "owner": {"reputation": 250, "user_id": 1798390, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6830191bbabb663c3832cb4249de1719?s=128&d=identicon&r=PG", "display_name": "Bungow", "link": "https://stackoverflow.com/users/1798390/bungow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 45949628, "answer_count": 2, "score": 1, "last_activity_date": 1504104781, "creation_date": 1504047768, "last_edit_date": 1504104781, "question_id": 45949509, "link": "https://stackoverflow.com/questions/45949509/access-2d-arrays-through-their-pointer", "title": "Access 2D arrays through their pointer", "body": "<p>I'm having some problems trying to access a <em>true</em> 2D array in my program.\nI have a 1D array that emulates a 2D array to hold some level information (tile based game). When I access to some tile I do the common operations to change row/column index to liniar array:</p>\n\n<p><strong>The map is allocated in heap, and I hold a pointer to this array in the level struct</strong></p>\n\n<pre><code>size = x * y;\nlevel-&gt;map = malloc(size * sizeof(struct _mkTile));\n[...]\nfor (size_t i = 0; i &lt; level-&gt;y; i++) {\n    for (size_t e = 0; e &lt; level-&gt;x; e++) {\n        level-&gt;map[i * level-&gt;y + e].pos.x = xpos;\n        [...]\n</code></pre>\n\n<p>I do this operations a lot of times in my code, but recently I want to use a <em>true</em> 2D array to make the code more readable. I have a lot of code who relies in this 1D array so I want also to mantain this access form to the map.</p>\n\n<p>Reading trought this site I found how to allocate a 2D array:</p>\n\n<pre><code>struct _mkTile(*map)[x] = malloc(sizeof(struct _mkTile[x][y]));\n</code></pre>\n\n<p>I keep the pointer in my struct (level->map) the same, because lot of code expect a 1D array, so I do the following cast <code>level-&gt;map = (struct _mkTile *)map;</code> So far, so good. The old code works without problems.</p>\n\n<p>At this point I can access my tiles through 2D indexing using the <code>map[i][e]</code> pointer, but obiously not the <code>level-&gt;map</code>: </p>\n\n<p>So the question is, how is the proper declaration of a pointer to a 2D array (with unknow size) which allows using the 2D accessors <code>[][]</code>? Is possible to cast back the <code>level-&gt;map</code> pointer to a <em>true</em> 2D array?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1504047829, "post_id": 45949487, "comment_id": 78857685, "body": "<code>fgets()</code> takes three arguments.Period. BTW: first lookup the <i>types</i> of the argumentst that it expects."}, {"owner": {"reputation": 47629, "user_id": 900873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/704ea9ee0d9090f571599bdf5f95eb39?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/900873/kevin"}, "edited": false, "score": 0, "creation_date": 1504047883, "post_id": 45949487, "comment_id": 78857696, "body": "<a href=\"https://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\">linux.die.net/man/3/fgets</a>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1504047910, "post_id": 45949487, "comment_id": 78857698, "body": "<a href=\"https://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> takes 3 arguments. The first is the character buffer where the retrieved info should be stored, the second is the number of characters to read, the 3rd is the stream to read them from."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 3, "creation_date": 1504048001, "post_id": 45949487, "comment_id": 78857734, "body": "My theory is that the original code probably used <code>gets</code>, and was later changed to use <code>fgets</code> - but arguments weren&#39;t fixed."}, {"owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "reply_to_user": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 3, "creation_date": 1504048066, "post_id": 45949487, "comment_id": 78857752, "body": "@MatteoItalia My thoughts as well. Which doesn&#39;t speak well for the quality of the book. (OP: What edition of this book are you using?)"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 2, "creation_date": 1504048950, "post_id": 45949487, "comment_id": 78857977, "body": "Here&#39;s what seems to be the errata for that book. It does mention this issue: <a href=\"http://onjofilms.blogspot.com/2014/09/errata-for-sams-teach-yourself-c.html\" rel=\"nofollow noreferrer\">onjofilms.blogspot.com/2014/09/&hellip;</a>"}, {"owner": {"reputation": 41, "user_id": 8534903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9d78709d92e96570319699fa5f9ab8?s=128&d=identicon&r=PG", "display_name": "NoobNoob", "link": "https://stackoverflow.com/users/8534903/noobnoob"}, "edited": false, "score": 1, "creation_date": 1504049126, "post_id": 45949487, "comment_id": 78858029, "body": "I&#39;ve replaced the &quot;fgets&quot; with &quot;gets&quot; and indeed it worked! I appreciate those who were explaining fgets to me but this chapter is literally about what statements and comments are. This exercise i&#39;m sure was suppose to be a fun &quot;look you can program too!&quot; type of deal. this is the <b>seventh</b> edition of the book.I see I was downvoted, If I find more problems such as this should I avoid taking them to this forum?"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1504049180, "post_id": 45949487, "comment_id": 78858044, "body": "<code>gets</code> isn&#39;t even in the standard anymore. You&#39;re lucky it compiled."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1504050367, "post_id": 45949487, "comment_id": 78858334, "body": "@NoobNoob use Google first; if you cannot find the solution or that problem being asked then do ask. If the code is from a book, then make it clear that it is from the book, and which book and which edition. And remember to format the post right."}, {"owner": {"reputation": 927, "user_id": 466932, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/424347075f5b5405bfb7ca79a9aa264b?s=128&d=identicon&r=PG", "display_name": "Unmanned Player", "link": "https://stackoverflow.com/users/466932/unmanned-player"}, "edited": false, "score": 0, "creation_date": 1504054645, "post_id": 45949487, "comment_id": 78859405, "body": "Thumb rule: When in doubt check <code>man</code>. When seriously paranoid, check the source code. Works best. :)"}], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 6, "last_activity_date": 1504048902, "creation_date": 1504048902, "answer_id": 45949670, "question_id": 45949487, "link": "https://stackoverflow.com/questions/45949487/too-few-arguments-to-function-fgets/45949670#45949670", "title": "Too few arguments to function &#39;fgets&#39;?", "body": "<p>This is an error in the book. Like the compiler said, <code>fgets()</code> requires three arguments.</p>\n\n<p>This was probably the result of an overeager search-and-replace to substitute <code>fgets()</code> for the deprecated <code>gets()</code>. What was intended here was probably either:</p>\n\n<pre><code>gets(buffer);\n</code></pre>\n\n<p>which will produce a warning on most modern compilers, or</p>\n\n<pre><code>fgets(buffer, sizeof(buffer), stdin);\n</code></pre>\n\n<p>to pass the correct arguments to <code>fgets()</code>.</p>\n\n<p>This error is troubling, as it suggests that other parts of the book may have been written or updated carelessly. Tread carefully.</p>\n"}], "owner": {"reputation": 41, "user_id": 8534903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9d78709d92e96570319699fa5f9ab8?s=128&d=identicon&r=PG", "display_name": "NoobNoob", "link": "https://stackoverflow.com/users/8534903/noobnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1114, "favorite_count": 0, "accepted_answer_id": 45949670, "answer_count": 1, "score": 1, "last_activity_date": 1504048902, "creation_date": 1504047627, "last_edit_date": 1504048434, "question_id": 45949487, "link": "https://stackoverflow.com/questions/45949487/too-few-arguments-to-function-fgets", "title": "Too few arguments to function &#39;fgets&#39;?", "body": "<p>Literally have only been learning to program for two hours now. I am using Sams Teach Yourself C in one hour a day and I am stuck on just a seemingly simply exercise on lesson 2.</p>\n\n<blockquote>\n  <p>5. What does the following program do? (Enter, compile, and run it.)</p>\n\n<pre><code>/* ex02-05.c */\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main(void)\n{\n    char buffer[256];\n\n    printf( \"Enter your name and press &lt;Enter&gt;:\\n\");\n    fgets( buffer );\n\n    printf( \"\\nYour name has %d characters and spaces!\",\n                     strlen( buffer ));\n\n    return 0;\n}\n</code></pre>\n</blockquote>\n\n<p>So the back of the book says that the end result should allow me to enter and name and have it tell me the amount of spaces and characters. However, I am getting an error that states that there are \"too few arguments to function fgets on line 9\"?</p>\n"}, {"tags": ["ios", "c", "swift", "bridging-header"], "comments": [{"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1504047291, "post_id": 45949412, "comment_id": 78857545, "body": "Does <code>var myKey: CURRENT_DATA_KEY = nil</code> work?"}, {"owner": {"reputation": 2616, "user_id": 571905, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c4dae24671e0f9bb3e4e2f44d9d8b02a?s=128&d=identicon&r=PG", "display_name": "Buyin Brian", "link": "https://stackoverflow.com/users/571905/buyin-brian"}, "reply_to_user": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "edited": false, "score": 0, "creation_date": 1504055843, "post_id": 45949412, "comment_id": 78859643, "body": "No it doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user887210"}, "is_accepted": false, "score": 0, "last_activity_date": 1504060663, "last_edit_date": 1504060663, "creation_date": 1504057992, "answer_id": 45950701, "question_id": 45949412, "link": "https://stackoverflow.com/questions/45949412/typedef-struct-from-c-to-swift/45950701#45950701", "title": "typedef struct from C to Swift", "body": "<p>It's been a bit since I've done this but IIRC this:</p>\n\n<pre><code>typedef struct _DATA_KEY_ * CURRENT_DATA_KEY;\n-(int) initWithKey(CURRENT_DATA_KEY * key);\n</code></pre>\n\n<p>Is actually equivalent to:</p>\n\n<pre><code>-(int) initWithKey(struct _DATA_KEY_ ** key);\n</code></pre>\n\n<p>So if we look up <a href=\"https://developer.apple.com/library/content/documentation/Swift/Conceptual/BuildingCocoaApps/InteractingWithCAPIs.html#//apple_ref/doc/uid/TP40014216-CH8-ID23\" rel=\"nofollow noreferrer\">Interacting with C APIs: Pointers</a> it falls under:</p>\n\n<blockquote>\n  <p><code>Type **</code></p>\n</blockquote>\n\n<p>Which becomes:</p>\n\n<blockquote>\n  <p><code>AutoreleasingUnsafeMutablePointer&lt;Type&gt;</code></p>\n</blockquote>\n\n<p>If you know the members of the C <code>struct</code> then you may be able to treat it like a Swift <code>struct</code> and use the synthesized <code>init</code> method. So if it is defined like this:</p>\n\n<pre><code>struct _DATA_KEY_ { \n  int foo\n};\n</code></pre>\n\n<p>It becomes like this in Swift:</p>\n\n<pre><code>public struct _DATA_KEY_ { \n  var foo: Int\n  init()\n  init(foo: Int)\n}\n</code></pre>\n\n<p>And you call the init method like:</p>\n\n<pre><code>// no parameter\nlet myKey = AutoreleasingUnsafeMutablePointer&lt;_DATA_KEY_&gt;(&amp;_DATA_KEY_())\n\n// parameter\nlet myKey = AutoreleasingUnsafeMutablePointer&lt;_DATA_KEY_&gt;(&amp;_DATA_KEY_(foo: 12))\n</code></pre>\n\n<p>I have not tried this code but I've followed the advice in the Apple document before and it's worked out well.</p>\n"}], "owner": {"reputation": 2616, "user_id": 571905, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c4dae24671e0f9bb3e4e2f44d9d8b02a?s=128&d=identicon&r=PG", "display_name": "Buyin Brian", "link": "https://stackoverflow.com/users/571905/buyin-brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1216, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1504060663, "creation_date": 1504047117, "question_id": 45949412, "link": "https://stackoverflow.com/questions/45949412/typedef-struct-from-c-to-swift", "title": "typedef struct from C to Swift", "body": "<p>I'm working on a Swift app that accesses a C library.</p>\n\n<p>The .h file contains a typedef struct:</p>\n\n<pre><code>typedef struct _DATA_KEY_ * CURRENT_DATA_KEY;\n</code></pre>\n\n<p>And there a method in another class:</p>\n\n<pre><code> -(int) initWithKey(CURRENT_DATA_KEY * key);\n</code></pre>\n\n<p>I need to create a CURRENT_DATA_KEY in my code. Not sure how I can achieve that in Swift. </p>\n\n<p>There is some old Objective-C code that uses: </p>\n\n<pre><code>CURRENT_DATA_KEY key = NULL;\ninitWithKey(key)\n</code></pre>\n\n<p>I've tried:</p>\n\n<pre><code>let myKey = UnsafeMutablePointer&lt;CURRENT_DATA_KEY&gt;.allocate(capacity: 1)\n</code></pre>\n\n<p>But when I try to use it later as an argument in the function, I get the error:</p>\n\n<pre><code>Cannot convert value of type 'UnsafeMutablePointer&lt;_DATA_KEY_&gt;' (aka 'UnsafeMutablePointer(&lt;OpaquePointer&gt;)') to expected argument type 'UnsafeMutablePointer(&lt;_DATA_KEY_?&gt;!)'\n</code></pre>\n\n<p>Which looks like the function is expecting an optional value?</p>\n\n<p>I also tried:</p>\n\n<pre><code>let myKey: CURRENT_DATA_KEY? = nil\nlet myKey: CURRENT_DATA_KEY = NSNull()\n</code></pre>\n\n<p>But those get similar type errors.</p>\n\n<p>How do I create: <code>UnsafeMutablePointer(&lt;_DATA_KEY_?&gt;!)</code></p>\n"}, {"tags": ["c", "data-structures", "queue"], "comments": [{"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1504045252, "post_id": 45948932, "comment_id": 78856963, "body": "Instead of <code>queue-&gt;front = queue-&gt;front+1%queue-&gt;capacity;</code>, did you mean to put parentheses around <code>queue-&gt;front+1</code>?"}, {"owner": {"reputation": 2311, "user_id": 6032010, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cCbzrdp-8HI/AAAAAAAAAAI/AAAAAAAAAAA/g1GQeurueXA/photo.jpg?sz=128", "display_name": "SHG", "link": "https://stackoverflow.com/users/6032010/shg"}, "edited": false, "score": 0, "creation_date": 1504045701, "post_id": 45948932, "comment_id": 78857101, "body": "To make it easier to test, change your <code>display()</code> function to iterate from <code>head</code> to <code>rear</code> and not from <code>0</code> to <code>capacity</code>."}, {"owner": {"reputation": 170, "user_id": 7534825, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-kh6IplmZuL8/AAAAAAAAAAI/AAAAAAAACps/YSrmIhozjPg/photo.jpg?sz=128", "display_name": "Devjeet Mandal", "link": "https://stackoverflow.com/users/7534825/devjeet-mandal"}, "edited": false, "score": 0, "creation_date": 1504048383, "post_id": 45948932, "comment_id": 78857838, "body": "meowgoesthedog  thank you. it worked. :)"}, {"owner": {"reputation": 170, "user_id": 7534825, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-kh6IplmZuL8/AAAAAAAAAAI/AAAAAAAACps/YSrmIhozjPg/photo.jpg?sz=128", "display_name": "Devjeet Mandal", "link": "https://stackoverflow.com/users/7534825/devjeet-mandal"}, "edited": false, "score": 0, "creation_date": 1504048605, "post_id": 45948932, "comment_id": 78857899, "body": "SHG as it is a circular queue sometimes head will be greater than rear. and i was unable to come up with an idea just to show the elements and not whole queue and thus i placed 0 to suggest the place is empty. thanks for your suggestion. :)"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1504191586, "post_id": 45948932, "comment_id": 78928848, "body": "I improved your formatting a little bit, but it&#39;s difficult to say what you meant about where the problem lies. I would suggest that you indent the {1,1,1...} line 4 spaces so that the &quot;here is the problem&quot; bracket shows where the problem really lies."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1504191744, "post_id": 45948932, "comment_id": 78928950, "body": "If you &quot;really suck at explaining things,&quot; we&#39;re going to have a difficult time understanding you, and the answers you get aren&#39;t going to be very good. I suggest you get better at explaining things."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1504207497, "post_id": 45948932, "comment_id": 78937658, "body": "@meowgoesthedog: If that solves the problem, I would suggest you post it as an answer. That way it can be upvoted and marked correct."}, {"owner": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1504207933, "post_id": 45948932, "comment_id": 78937873, "body": "@JimMischel I feel like an answer to fix a simple typo wouldn&#39;t be very educational; perhaps it should be flagged as &quot;... being caused by a typo&quot; instead"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "reply_to_user": {"reputation": 13335, "user_id": 8204776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e6qyq.jpg?s=128&g=1", "display_name": "meowgoesthedog", "link": "https://stackoverflow.com/users/8204776/meowgoesthedog"}, "edited": false, "score": 0, "creation_date": 1504207999, "post_id": 45948932, "comment_id": 78937906, "body": "@meowgoesthedog: I voted to close as &quot;... being caused by a typo&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 170, "user_id": 7534825, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-kh6IplmZuL8/AAAAAAAAAAI/AAAAAAAACps/YSrmIhozjPg/photo.jpg?sz=128", "display_name": "Devjeet Mandal", "link": "https://stackoverflow.com/users/7534825/devjeet-mandal"}, "is_accepted": false, "score": 0, "last_activity_date": 1504215201, "creation_date": 1504215201, "answer_id": 45990403, "question_id": 45948932, "link": "https://stackoverflow.com/questions/45948932/queues-dequeue-enqueue-error-for-input-stream/45990403#45990403", "title": "Queues dequeue enqueue error for input stream", "body": "<p>this is the correct answer.  thanks to everyone :)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nenum boolean{\n   false,true\n};\n\nstruct ArrayQueue{\n    int rare,front;\n    int capacity;\n    int *array;\n};\n\nstruct ArrayQueue* CreateQueue(int cap)\n{\n    struct ArrayQueue* queue;\n    queue = (struct ArrayQueue*)malloc(sizeof(struct ArrayQueue));\n    queue-&gt;rare = -1;\n    queue-&gt;front = -1;\n    queue-&gt;capacity = cap;\n    queue-&gt;array = (int*)malloc(sizeof(int)*queue-&gt;capacity);\n    int i;\n    for (i=0;i&lt;queue-&gt;capacity;i++)\n        queue-&gt;array[i] = 0;\n    return(queue);\n}\n\nenum boolean isFull(struct ArrayQueue *queue)\n{\n    return((queue-&gt;rare+1)%queue-&gt;capacity == queue-&gt;front);\n}\n\nenum boolean isEmpty(struct ArrayQueue *queue)\n{\n    return(queue-&gt;front == -1);\n}\n\nint ElementsInQueue(struct ArrayQueue *queue)\n{\n    return(((queue-&gt;capacity-queue-&gt;front)+queue-&gt;rare+1)%queue-&gt;capacity);\n}\n\nvoid En_queue(struct ArrayQueue *queue,int item)\n{\n    if (isFull(queue) == false)\n    {\n        queue-&gt;rare = (queue-&gt;rare+1)%queue-&gt;capacity;\n        queue-&gt;array[queue-&gt;rare] = item;\n        if (queue-&gt;front == -1)\n            queue-&gt;front = queue-&gt;rare;\n    }\n}\n\nint De_queue(struct ArrayQueue *queue)\n{\n    int data;\n    if (isEmpty(queue) == false)\n    {\n        data = queue-&gt;array[queue-&gt;front];\n        queue-&gt;array[queue-&gt;front] = 0;\n        if (queue-&gt;front == queue-&gt;rare)\n        {\n            queue-&gt;front = -1;\n            queue-&gt;rare = -1;\n        }\n        else\n        {\n            queue-&gt;front = (queue-&gt;front+1)%queue-&gt;capacity;\n        }\n        return data;\n    }\n}\n\nvoid Display(struct ArrayQueue *queue)\n{\n    int i;\n    printf(\"\\n Displaying the queue : \\n\");\n    for (i=0;i&lt;queue-&gt;capacity;i++)\n        printf(\"%d \",queue-&gt;array[i]);\n}\n\nint main(void)\n{\n    int cap,choice,item;\n    struct ArrayQueue *queue;\n    printf(\"\\nEnter the Capacity of Queue: \");\n    scanf(\"%d\",&amp;cap);\n    queue = CreateQueue(cap);\n    while(1)\n    {\n        printf(\"\\n\\n\");\n        printf(\"\\n1.Enqueue\");\n        printf(\"\\n2.Dequeue\");\n        printf(\"\\n3.Display\");\n        printf(\"\\n4.Exit\");\n        printf(\"\\nEnter choice: \");\n        scanf(\"%d\",&amp;choice);\n        switch (choice)\n        {\n        case 1: if (isFull(queue) == true)\n                {\n                    printf(\"\\nQueue is Full..\");\n                    break;\n                }\n                else\n                {\n                   printf(\"\\nEnter a number: \");\n                   scanf(\"%d\",&amp;item);\n                   En_queue(queue,item);\n                   Display(queue);\n                }\n                break;\n        case 2: if (isEmpty(queue)== true)\n                {\n                    printf(\"\\nQueue is Empty..\");\n                    break;\n                }\n                else\n                {\n                    item = De_queue(queue);\n                    printf(\"\\nItem popped is: %d\",item);\n                    Display(queue);\n                }\n                break;\n        case 3: Display(queue);\n                break;\n        case 4: exit(0);\n                break;\n        }\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 7534825, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-kh6IplmZuL8/AAAAAAAAAAI/AAAAAAAACps/YSrmIhozjPg/photo.jpg?sz=128", "display_name": "Devjeet Mandal", "link": "https://stackoverflow.com/users/7534825/devjeet-mandal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1577258475, "creation_date": 1504044004, "last_edit_date": 1577258475, "question_id": 45948932, "link": "https://stackoverflow.com/questions/45948932/queues-dequeue-enqueue-error-for-input-stream", "title": "Queues dequeue enqueue error for input stream", "body": "<p>I am trying to work with data structure of queue which is kind of circular queue.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nenum boolean{\n   false,true\n};\n\nstruct ArrayQueue{\n    int rare,front;\n    int capacity;\n    int *array;\n};\n\nstruct ArrayQueue* CreateQueue(int cap)\n{\n    struct ArrayQueue* queue;\n    queue = (struct ArrayQueue*)malloc(sizeof(struct ArrayQueue));\n    queue-&gt;rare = -1;\n    queue-&gt;front = -1;\n    queue-&gt;capacity = cap;\n    queue-&gt;array = (int*)malloc(sizeof(int)*queue-&gt;capacity);\n    int i;\n    for (i=0;i&lt;queue-&gt;capacity;i++)\n        queue-&gt;array[i] = 0;\n    return(queue);\n}\n\nenum boolean isFull(struct ArrayQueue *queue)\n{\n    return((queue-&gt;rare+1)%queue-&gt;capacity == queue-&gt;front);\n}\n\nenum boolean isEmpty(struct ArrayQueue *queue)\n{\n    return(queue-&gt;front == -1);\n}\n\nint ElementsInQueue(struct ArrayQueue *queue)\n{\n    return(((queue-&gt;capacity-queue-&gt;front)+queue-&gt;rare+1)%queue-&gt;capacity);\n}\n\nvoid En_queue(struct ArrayQueue *queue,int item)\n{\n    if (isFull(queue) == false)\n    {\n        queue-&gt;rare = (queue-&gt;rare+1)%queue-&gt;capacity;\n        queue-&gt;array[queue-&gt;rare] = item;\n        if (queue-&gt;front == -1)\n            queue-&gt;front = queue-&gt;rare;\n    }\n}\n\nint De_queue(struct ArrayQueue *queue)\n{\n    int data;\n    if (isEmpty(queue) == false)\n    {\n        data = queue-&gt;array[queue-&gt;front];\n        queue-&gt;array[queue-&gt;front] = 0;\n        if (queue-&gt;front == queue-&gt;rare)\n        {\n            queue-&gt;front = -1;\n            queue-&gt;rare = -1;\n        }\n        else\n        {\n            queue-&gt;front = queue-&gt;front+1%queue-&gt;capacity;\n        }\n        return data;\n    }\n}\n\nvoid Display(struct ArrayQueue *queue)\n{\n    int i;\n    printf(\"\\n Displaying the queue : \\n\");\n    for (i=0;i&lt;queue-&gt;capacity;i++)\n        printf(\"%d \",queue-&gt;array[i]);\n}\n\nint main(void)\n{\n    int cap,choice,item;\n    struct ArrayQueue *queue;\n    printf(\"\\nEnter the Capacity of Queue: \");\n    scanf(\"%d\",&amp;cap);\n    queue = CreateQueue(cap);\n    while(1)\n    {\n        printf(\"\\n\\n\");\n        printf(\"\\n1.Enqueue\");\n        printf(\"\\n2.Dequeue\");\n        printf(\"\\n3.Display\");\n        printf(\"\\n4.Exit\");\n        printf(\"\\nEnter choice: \");\n        scanf(\"%d\",&amp;choice);\n        switch (choice)\n        {\n        case 1: if (isFull(queue) == true)\n                {\n                    printf(\"\\nQueue is Full..\");\n                    break;\n                }\n                else\n                {\n                   printf(\"\\nEnter a number: \");\n                   scanf(\"%d\",&amp;item);\n                   En_queue(queue,item);\n                   Display(queue);\n                }\n                break;\n        case 2: if (isEmpty(queue)== true)\n                {\n                    printf(\"\\nQueue is Empty..\");\n                    break;\n                }\n                else\n                {\n                    item = De_queue(queue);\n                    printf(\"\\nItem popped is: %d\",item);\n                    Display(queue);\n                }\n                break;\n        case 3: Display(queue);\n                break;\n        case 4: exit(0);\n                break;\n        }\n\n    }\n}\n</code></pre>\n\n<p>It looks perfect in first glance but it is having few problems.</p>\n\n<p>See the screenshots</p>\n\n<h3>after insertion</h3>\n\n<p>2nd. Deleting and inserting simultaneously\n<a href=\"https://i.stack.imgur.com/HJTP5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HJTP5.png\" alt=\"enter image description here\"></a></p>\n\n<p>3rd. the problem occurred\n<a href=\"https://i.stack.imgur.com/EpgAK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EpgAK.png\" alt=\"enter image description here\"></a></p>\n\n<p>My input stream was (according to this pattern)... </p>\n\n<ol>\n<li>Enqueue</li>\n<li>Dequeue</li>\n<li>Display</li>\n<li>Exit</li>\n</ol>\n\n<pre><code>{1,1,1,1,2,1,2,1,2,1,2,1,2,1}\n\n                        |___|\n                      here is the problem\n</code></pre>\n\n<ul>\n<li>When I entered 2 for dequeuing the queue was full, but nothing got deleted. Output was some garbage value</li>\n<li>Then I entered 1 for enqueuing the queue was full but it did not showed the queue is full; Instead it asked me to enter a number.</li>\n</ul>\n\n<p>(as I have dequeued first so i thought to enqueue an element first and then to enter the choice as 1. but again it asked me to enter a number.)</p>\n\n<p>I couldn't figure out the mistakes. forgive me for my explanation and weird vocabulary. Can you please try the code and give the input stream to figure out the problem.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["mysql", "c"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504040145, "post_id": 45948090, "comment_id": 78854910, "body": "Welcome to your new friend <a href=\"https://github.com/hholzgra/connector-c-examples/blob/master/mysql_real_escape_string.c\" rel=\"nofollow noreferrer\"><code>mysql_real_escape_string </code></a>. As a note using the C API is extremely ugly, so if you have <i>any</i> other option I&#39;d recommend that."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1504040562, "post_id": 45948090, "comment_id": 78855120, "body": "<i>How</i> are you passing the strings?  As part of an <code>insert</code> statement?  If so, use prepared statements, rather than trying to build a SQL statement dynamically.  IIRC, if you use a <a href=\"https://dev.mysql.com/doc/refman/5.5/en/c-api-prepared-statements.html\" rel=\"nofollow noreferrer\">prepared statement</a>, you should <i>not</i> escape the string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8371461"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1504040986, "post_id": 45948090, "comment_id": 78855330, "body": "Hi @JohnBode I am very new to SQL(mysql). I am totally unaware of what you are saying. But I can say I am using insert and update commands to load the data into the DB."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8371461"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504041125, "post_id": 45948090, "comment_id": 78855409, "body": "Thank you @tadman the link you mentioned is very useful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8371461"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504050711, "post_id": 45948090, "comment_id": 78858429, "body": "@tadman It is working, but mysql_real_escape_string is adding \\n to each string, so that a new line comes into picture in DB(which I don&#39;t want). How to resolve it?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1504050945, "post_id": 45948090, "comment_id": 78858493, "body": "You have a newline in your input data, obviously. Get rid of them."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8371461"}, "edited": false, "score": 0, "creation_date": 1504051257, "post_id": 45948090, "comment_id": 78858581, "body": "Okay got it. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 0, "last_activity_date": 1504044882, "creation_date": 1504044882, "answer_id": 45949076, "question_id": 45948090, "link": "https://stackoverflow.com/questions/45948090/how-can-i-pass-a-string10000-records-from-a-file-with-single-and-double-quotes/45949076#45949076", "title": "How can I pass a string(10000 records from a file) with single and double quotes to a mysql query?", "body": "<p>Your best bet is to use a <a href=\"https://dev.mysql.com/doc/refman/5.7/en/c-api-prepared-statements.html\" rel=\"nofollow noreferrer\">prepared statement</a> and then <a href=\"https://dev.mysql.com/doc/refman/5.7/en/mysql-stmt-bind-param.html\" rel=\"nofollow noreferrer\">bind</a> each input string as necessary.  This method is faster and more secure than building the entire query dynamically, <em>and</em> you don't have to escape the input string.  </p>\n\n<p>You basically set up the query <em>once</em>, then execute it repeatedly, just updating the data that's being inserted.  Quick, very dirty, <em>very</em> untested example:</p>\n\n<pre><code>/**\n * Items read from input file (assuming they're all strings; substitute\n * with your actual data items)\n */\nchar itemA[ITEM_A_LENGTH];\nunsigned long str_length_A;\nchar itemB[ITEM_B_LENGTH];\nunsigned long str_length_B;\n...    \nMYSQL *connection;\n...\nconst char *stmt_text = \"INSERT INTO table_name VALUES( ?, ?, ?, ?, ? )\"; // assumes 5 inputs\nMYSQL_STMT *stmt = mysql_stmt_init( connection );\nMYSQL_BIND insert_variables[5]; // assumes 5 inputs\n...\nint status = mysql_stmt_prepare( stmt, stmt_text, strlen( stmt_text ) );\nif ( status )\n{\n  /**\n   * Bind each input data item to the ? wildcards in the statement\n   */\n  insert_variables[0].buffer_type = MSQL_TYPE_STRING;\n  insert_variables[0].buffer = itemA;\n  insert_variables[0].buffer_length = ITEM_A_SIZE;\n  insert_variables[0].is_null = 0;\n  insert_variables[0].length = &amp;str_length_A;\n\n  /**\n   * Repeat for each input item\n   */\n}\nelse\n  // bail out here\n...\n/**\n * Read each line of input and insert into the database\n * using the prepared statement\n */\nwhile ( fscanf( input, \"%s %s %s %s %s\", itemA, itemB, itemC, itemD, itemE ) == 5 )\n{\n  str_length_A = strlen( itemA );\n  str_length_B = strlen( itemB );\n  ...\n  int rows_inserted = mysql_stmt_execute( insert_stmt );\n  if ( rows_inserted != 1 )\n  {\n    // insert failed, bail out here.\n  }\n}\n</code></pre>\n\n<p>Like I said, this method is faster (only parses the statement once) and more secure (less surface area for a SQL injection attack) than building the entire query string dynamically.  Tradeoff is that it's a bit more work.  </p>\n\n<p>I don't have a MySQL instance to test against, so I can't provide working example code.  There are examples <a href=\"https://dev.mysql.com/doc/refman/5.5/en/mysql-stmt-execute.html\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://www.kitebird.com/mysql-book/ch06-3ed.pdf\" rel=\"nofollow noreferrer\">here</a>, but I can't vouch for their quality.</p>\n\n<p>MySQL's documentation is...not awesome, so this will probably be a bit painful.  </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8371461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1504044882, "creation_date": 1504039722, "question_id": 45948090, "link": "https://stackoverflow.com/questions/45948090/how-can-i-pass-a-string10000-records-from-a-file-with-single-and-double-quotes", "title": "How can I pass a string(10000 records from a file) with single and double quotes to a mysql query?", "body": "<p>I have a file with 10000 records, I am parsing each and every line and store them in different variables. I am using C on linux(gcc) to parse the file. I have to pass these to mysql db. I have a number of strings which are having both single and double quotes. An example string is shown below.</p>\n\n<pre><code> YOUNGS BEARS RID'N FISH 6.5\"\n</code></pre>\n\n<p>How can I pass strings like this to mysql query? Thanks in advance.</p>\n"}, {"tags": ["c", "pointers", "dynamic-memory-allocation", "realloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1504039332, "post_id": 45947988, "comment_id": 78854524, "body": "<a href=\"https://stackoverflow.com/q/605845/2173917\">Please see this discussion on why not to cast the return value of malloc() and family in C..</a>"}, {"owner": {"reputation": 81, "user_id": 3677168, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jmFSd.jpg?s=128&g=1", "display_name": "ricknaght", "link": "https://stackoverflow.com/users/3677168/ricknaght"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1504039419, "post_id": 45947988, "comment_id": 78854568, "body": "That was a fast reply! I tried not casting it, however, I kept getting the same leaks and errors."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1504039493, "post_id": 45947988, "comment_id": 78854598, "body": "You should use the return value of <code>realloc</code>. You throw it away."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1504040780, "post_id": 45947988, "comment_id": 78855221, "body": "@ricknaght  Totally ignore the reference about casting the return of malloc. There is an answer of a low-qualified programmer that does not know how to write code."}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1504039670, "post_id": 45948030, "comment_id": 78854686, "body": "&quot; in case, realloc() is successful, you are trying to use an already free-d memory&quot;: not necessarily, if the system just increases the size of the block without moving the memory (which often happens). But it&#39;s roulette."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504039793, "post_id": 45948030, "comment_id": 78854747, "body": "@Jean-Fran&#231;oisFabre well, that&#39;s not guaranteed, right? better play safe. :)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504039834, "post_id": 45948030, "comment_id": 78854763, "body": "of course! but I&#39;ve seen other questions like this where OP could run his code up to some point where memory is moved. False impression that it&#39;s working!"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504039877, "post_id": 45948030, "comment_id": 78854784, "body": "@Jean-Fran&#231;oisFabre and that is precisely sir, what I want to avoid. Added a note, though.  :)"}, {"owner": {"reputation": 81, "user_id": 3677168, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jmFSd.jpg?s=128&g=1", "display_name": "ricknaght", "link": "https://stackoverflow.com/users/3677168/ricknaght"}, "edited": false, "score": 1, "creation_date": 1504046573, "post_id": 45948030, "comment_id": 78857335, "body": "That worked! As suggested, I used a temp variable, and then simply assigned it back to my newStringLine pointer. This definitely taught me a lesson! Thanks!"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1504039974, "last_edit_date": 1504039974, "creation_date": 1504039441, "answer_id": 45948030, "question_id": 45947988, "link": "https://stackoverflow.com/questions/45947988/memory-leak-with-malloc-and-fgetc/45948030#45948030", "title": "Memory leak with malloc and fgetc", "body": "<p>Your usage of <code>realloc()</code> is erroneous.</p>\n\n<p><code>realloc()</code>, if successful, frees the passed pointer and <strong>returns</strong> a new pointer with the allocated memory. You need to </p>\n\n<ul>\n<li>catch the return value of <code>realloc()</code> in a temporary pointer, </li>\n<li><p>check against NULL to ensure success and then</p>\n\n<ul>\n<li>If returned pointer is not NULL, i.e., reallocation is successful, use the new pointer.</li>\n<li>If the returned pointer is NULL, make some decisions and you can keep using the old pointer (passed as argument).</li>\n</ul></li>\n</ul>\n\n<p>Related, quoting <code>C11</code>, chapter \u00a77.22.3.5</p>\n\n<blockquote>\n  <p>The <code>realloc</code> function <strong>deallocates the old object</strong> pointed to by <code>ptr</code> <strong>and returns a\n  pointer to a new object</strong> that has the size specified by <code>size</code>. [....]</p>\n</blockquote>\n\n<p>and,</p>\n\n<blockquote>\n  <p>[...] If memory for the new object cannot be\n  allocated, the old object is not deallocated and its value is unchanged.</p>\n</blockquote>\n\n<p>Otherwise, in case, <code>realloc()</code> is successful, you are (<em>most probably</em>) trying to use an already free-d memory, which , of course, causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<hr>\n\n<p>Uh-oh, and did I mention, <a href=\"https://stackoverflow.com/q/605845/2173917\">please see this discussion on why not to cast the return value of <code>malloc()</code> and family in C</a>?</p>\n"}], "owner": {"reputation": 81, "user_id": 3677168, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/jmFSd.jpg?s=128&g=1", "display_name": "ricknaght", "link": "https://stackoverflow.com/users/3677168/ricknaght"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 45948030, "answer_count": 1, "score": 1, "last_activity_date": 1504039974, "creation_date": 1504039292, "last_edit_date": 1504039915, "question_id": 45947988, "link": "https://stackoverflow.com/questions/45947988/memory-leak-with-malloc-and-fgetc", "title": "Memory leak with malloc and fgetc", "body": "<p>I'm having some trouble reading a like from user using malloc and getchar. I get the result, however, I get memory leaks using valgrind. I am pretty clueless in this and have asked my classmates and mentors, but none seem to find out why.</p>\n\n<pre><code>char *ReadLineFile(FILE *infile){\n   int i=0;\n   char c;\n   char *newStringLine;\n   newStringLine = (char *) malloc(sizeof(char));\n   while( (c = fgetc(infile)) != '\\n' ){\n        newStringLine[i++] = c;\n        realloc(newStringLine, (sizeof(char) * (i+1)));\n   }\n   newStringLine[i] = '\\0';\n   return newStringLine;\n}\n</code></pre>\n\n<p>Valgrind gives me several errors, including Invalid write/read of 1, and invalid realloc.</p>\n"}, {"tags": ["c", "c-preprocessor"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504041047, "post_id": 45947985, "comment_id": 78855362, "body": "&quot;the following code i did not encounter any error&quot; --&gt; Code is attempting to print a <code>double</code> with <code>&quot;%d&quot;</code> --&gt; UB.  Enable all compiles warnings."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1504042180, "post_id": 45947985, "comment_id": 78855876, "body": "Note that the C standard (and I believe the POSIX standard) require that headers they define must be included at file scope and not within the scope of an external declaration (function, or in the middle of a variable declaration).   You may use <code>#include</code> with your own headers wherever you like; the onus is on you to make it work correctly. If your header includes a system header, you&#39;ll have to obey the file scope rules after all.  Note that although the includes are normally at the top of the file, that isn&#39;t a requirement."}, {"owner": {"reputation": 113, "user_id": 4983231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N7Cvp.jpg?s=128&g=1", "display_name": "john", "link": "https://stackoverflow.com/users/4983231/john"}, "edited": false, "score": 0, "creation_date": 1613382942, "post_id": 45947985, "comment_id": 117048603, "body": "If you fix the code as <code>#define PI 3.14  printf(&quot;%f&quot;,PI);</code> , the question remains why does the order matter. Then it is a procedural issue."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 8366023, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1627943480551794/picture?type=large", "display_name": "Girish Arora", "link": "https://stackoverflow.com/users/8366023/girish-arora"}, "edited": false, "score": 0, "creation_date": 1504039877, "post_id": 45948057, "comment_id": 78854781, "body": "Unfortunately #include is not working everywhere..Why so? I took a simple example.. Say int main(void) { #include&lt;math.h&gt; } and i got 6 errors in turbo c compiler mostly of undefined symbols"}, {"owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "reply_to_user": {"reputation": 67, "user_id": 8366023, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1627943480551794/picture?type=large", "display_name": "Girish Arora", "link": "https://stackoverflow.com/users/8366023/girish-arora"}, "edited": false, "score": 3, "creation_date": 1504040367, "post_id": 45948057, "comment_id": 78855030, "body": "<code>#include</code> does indeed work everywhere... but what it does is copy-and-paste the contents of the included file into the spot where you put the <code>#include</code> directive. So if you stick it inside <code>main</code>, it will dutifully put the contents of <code>math.h</code> inside your <code>main</code> function, which probably won&#39;t compile. But if you had a file containing code that would compile inside a <code>main</code> function and you <code>#include</code>d that, it would work fine (not that I&#39;d recommend actually doing that)."}, {"owner": {"reputation": 80303, "user_id": 196561, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6836267883ea7234253b2100f222dbbc?s=128&d=identicon&r=PG", "display_name": "osgx", "link": "https://stackoverflow.com/users/196561/osgx"}, "edited": false, "score": 0, "creation_date": 1504046681, "post_id": 45948057, "comment_id": 78857368, "body": "@CharlesSrstka, #include does work in many places; it is header which was written to be included into global scope. There is software with <code>#define some_macro some value</code> and #include &quot;special.c&quot;; sometimes arrays are filled with included files."}], "tags": [], "owner": {"reputation": 15118, "user_id": 7258538, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102111546405895/picture?type=large", "display_name": "Charles Srstka", "link": "https://stackoverflow.com/users/7258538/charles-srstka"}, "is_accepted": false, "score": 1, "last_activity_date": 1504039552, "creation_date": 1504039552, "answer_id": 45948057, "question_id": 45947985, "link": "https://stackoverflow.com/questions/45947985/can-i-write-preprocessor-directives-anywhere-in-my-c-program/45948057#45948057", "title": "Can i write preprocessor directives anywhere in my c program?", "body": "<p>Preprocessor directives work pretty much anywhere. Of course, you can make your code confusing pretty easily if you abuse this.</p>\n"}, {"comments": [{"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1504041110, "post_id": 45948084, "comment_id": 78855399, "body": "<code>_Pragma</code> is a pre-processor operator, not a directive, and acts like <code>#pragma</code> except the operator version can be used anywhere you might use a macro."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1504045853, "last_edit_date": 1504045853, "creation_date": 1504039691, "answer_id": 45948084, "question_id": 45947985, "link": "https://stackoverflow.com/questions/45947985/can-i-write-preprocessor-directives-anywhere-in-my-c-program/45948084#45948084", "title": "Can i write preprocessor directives anywhere in my c program?", "body": "<p>The pre-processor does its work before the compiler performs the source code translation into object code. Pre-processing is mostly a string replacement task, so it can be placed just about anywhere in your code. Of course, if the resulting expansion is syntactically incorrect, the expanded source code will fail to compile.</p>\n\n<p>A commonly tolerated practice is to embed conditional compilation directives inside a function to allow the function to use platform specific APIs.</p>\n\n<pre><code>void some_wrapper_function () {\n#if defined(UNIX)\n    some_unix_specific_function();\n#elif defined(WIN32)\n    some_win32_specific_function();\n#else\n    #error \"Compiled on an unsupported platform\"\n#endif\n}\n</code></pre>\n\n<p>By their nature, the directives themselves normally have to be defined at the beginning of the line, and not somewhere in the middle of source line. But, defined macros can of course appear anywhere in the source, and will be replaced according to the substitution rules defined by your directives.</p>\n"}, {"tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": true, "score": 5, "last_activity_date": 1504040889, "last_edit_date": 1504040889, "creation_date": 1504040582, "answer_id": 45948287, "question_id": 45947985, "link": "https://stackoverflow.com/questions/45947985/can-i-write-preprocessor-directives-anywhere-in-my-c-program/45948287#45948287", "title": "Can i write preprocessor directives anywhere in my c program?", "body": "<p>The only place you can't put a preprocessor directive is in a macro expansion. The sole exception is <code>#pragma</code>, which can also be written <code>_Pragma()</code>.</p>\n\n<p>This has nothing to do with \"procedural\", but due to the fact that C is defined in terms of 8 translation phases, each of which is \"as-if\" fully-completed before the next phase. For more details, see the C11 standard, section 5.1.1.2.</p>\n\n<hr>\n\n<p>One example of when it is <em>useful</em> to use preprocessor directives after the start of a file is for the <a href=\"https://en.wikipedia.org/wiki/X_Macro\" rel=\"noreferrer\">\"X Macro\" technique</a> (which many people only know as \"those <code>.def</code> files\").</p>\n"}, {"tags": [], "owner": {"reputation": 3725, "user_id": 8471208, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zX6iRd9pmRI/AAAAAAAAAAI/AAAAAAAAAgE/F3-J9H4ZCno/photo.jpg?sz=128", "display_name": "Kevin Boone", "link": "https://stackoverflow.com/users/8471208/kevin-boone"}, "is_accepted": false, "score": 1, "last_activity_date": 1504102726, "creation_date": 1504102726, "answer_id": 45962919, "question_id": 45947985, "link": "https://stackoverflow.com/questions/45947985/can-i-write-preprocessor-directives-anywhere-in-my-c-program/45962919#45962919", "title": "Can i write preprocessor directives anywhere in my c program?", "body": "<p>The trick here is to realize that # directives have traditionally been interpreted by a pre-processor, that runs before any compilation. The pre-processor would produce a new source file, which was then compiled. I don't think any modern compiler works that way by default, but the same principles apply. </p>\n\n<p>So when you say </p>\n\n<pre><code>#include \"foo.h\"\n</code></pre>\n\n<p>you're saying \"insert the entire contents of foo.h into my source code starting at this line.\"</p>\n\n<p>You can use this directive pretty much anywhere in a source file, but it's rarely useful (and not often readable) to use it anywhere other than at the start of the source. </p>\n"}], "owner": {"reputation": 67, "user_id": 8366023, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1627943480551794/picture?type=large", "display_name": "Girish Arora", "link": "https://stackoverflow.com/users/8366023/girish-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2758, "favorite_count": 1, "accepted_answer_id": 45948287, "answer_count": 4, "score": 3, "last_activity_date": 1504102726, "creation_date": 1504039277, "question_id": 45947985, "link": "https://stackoverflow.com/questions/45947985/can-i-write-preprocessor-directives-anywhere-in-my-c-program", "title": "Can i write preprocessor directives anywhere in my c program?", "body": "<p>Is it mandatory to write #include at the top of the program and outside the main function? </p>\n\n<p>I tried using #define preprocessor inside the main function and it worked fine with only one exception..that being  the constant which i defined using the define directive can be used only after the line #define  \nFor instance say <code>printf(\"%d\",PI); #define PI 3.14</code>will give error \"Undefined symbol PI\". But in the following code i did not encounter any error </p>\n\n<pre><code>#define PI 3.14 \nprintf(\"%d\",PI);\n</code></pre>\n\n<p>Is this because C is a procedural language and procedural languages implements top down approach? </p>\n\n<p>Also i would like to know that can we  use  only #define inside the main function or other preprocessor directives too?  If we can use then which ones? \nOr is it the other way around, instead of #include we can use all the preprocessor directives in the main function? </p>\n"}, {"tags": ["c", "r", "r-package"], "comments": [{"owner": {"reputation": 1840, "user_id": 1917721, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/TgopK.png?s=128&g=1", "display_name": "HFBrowning", "link": "https://stackoverflow.com/users/1917721/hfbrowning"}, "edited": false, "score": 1, "creation_date": 1504038027, "post_id": 45947615, "comment_id": 78853880, "body": "Your question is a lot to address (you&#39;ve tried many different things) - but a few things I noticed. The first is that according to the <a href=\"https://www.rdocumentation.org/packages/inline/versions/0.3.14/topics/cfunction\" rel=\"nofollow noreferrer\">documentation</a> you need to strip out all of the header information in the body (so just reading in that github source is not going to work). I also think this is relevant: &quot;To declare multiple functions in the same library one can use <code>setCMethod</code> supplying lists of signatures and implementations. In this case, provide as many method names in <code>f</code> as you define methods.&quot;"}, {"owner": {"reputation": 11, "user_id": 8364369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iXIGgmwYY44/AAAAAAAAAAI/AAAAAAAABU8/rdD2ktggKQg/photo.jpg?sz=128", "display_name": "vinx", "link": "https://stackoverflow.com/users/8364369/vinx"}, "reply_to_user": {"reputation": 1840, "user_id": 1917721, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/TgopK.png?s=128&g=1", "display_name": "HFBrowning", "link": "https://stackoverflow.com/users/1917721/hfbrowning"}, "edited": false, "score": 0, "creation_date": 1504039014, "post_id": 45947615, "comment_id": 78854377, "body": "I forgot to describe that, sorry. I removed the headers of the c code and manually added them as the includes argument of inline::cfunction. I will try to break the code into multiple functions and use setCmethod, thank you."}, {"owner": {"reputation": 1840, "user_id": 1917721, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/TgopK.png?s=128&g=1", "display_name": "HFBrowning", "link": "https://stackoverflow.com/users/1917721/hfbrowning"}, "edited": false, "score": 0, "creation_date": 1504039237, "post_id": 45947615, "comment_id": 78854484, "body": "Good luck! It does seem like a complicated task - I&#39;m not sure how you address the need to sometimes have multiple intermediary functions to power a single end function. To address the question in your title though  - if you look at <a href=\"https://stackoverflow.com/questions/28026818/how-to-call-c-function-from-r\">this thread</a> and the comment on the answer, it appears you do not need to invoke <code>main()</code> to use your function"}, {"owner": {"reputation": 5010, "user_id": 3150445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bfca2588483eadf6695a120cbcef1f8?s=128&d=identicon&r=PG&f=1", "display_name": "jwdonahue", "link": "https://stackoverflow.com/users/3150445/jwdonahue"}, "edited": false, "score": 0, "creation_date": 1518832160, "post_id": 45947615, "comment_id": 84679059, "body": "The <code>main()</code> function is special in C.  It&#39;s the program entry point for the language and should only be called from the C-runtime initialization code which contains the entry point for the executable.  How often will your R program call into this code?  If only once, then just run the program from R.  In C we call that a <code>system()</code> or <code>exec()</code> call, R must have an equivalent."}], "owner": {"reputation": 11, "user_id": 8364369, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iXIGgmwYY44/AAAAAAAAAAI/AAAAAAAABU8/rdD2ktggKQg/photo.jpg?sz=128", "display_name": "vinx", "link": "https://stackoverflow.com/users/8364369/vinx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504045611, "creation_date": 1504037451, "last_edit_date": 1504045611, "question_id": 45947615, "link": "https://stackoverflow.com/questions/45947615/how-to-call-the-main-function-of-a-c-code-using-r", "title": "How to call the main function of a c code using R?", "body": "<p>I'm trying to create an R package that uses this code:\n<a href=\"https://github.com/amamory/seriation/blob/master/cfm-seriation.c\" rel=\"nofollow noreferrer\">c code</a></p>\n\n<p>I searched how to do this and tried the following ways:</p>\n\n<p>1 - Using the inline package.</p>\n\n<pre><code># orderer ####\n\n#' Orderer\n#'\n#' @export\n\norderer &lt;- function(associationPreprocessed){\n  if(!is.character(associationPreprocessed)){\n    stop(\"Error, the argument 'associationPreprocessed' must be of type 'character'\")\n  }\n  code &lt;- paste0(readLines(\"src/cfm-seriation.c\"), collapse = \"\\n\")\n  cfm &lt;- inline::cfunction(signature(argc = \"integer\", argv = \"character\"),\n                           body = code,\n                           language = \"C\", convention = \".C\",\n                           libargs = c(\"-lm\", \"-lpthread\", \"-lrt\"),\n                           includes = c(\"#include &lt;stdio.h&gt;\", \"#include &lt;time.h&gt;\",\n                                        \"#include &lt;math.h&gt;\", \"#include &lt;stdlib.h&gt;\",\n                                        \"#include &lt;string.h&gt;\"))\n  cfm(1L, paste0(\"f=\", associationPreprocessed))\n  return (NULL)\n}\n</code></pre>\n\n<p>I stripped out all the header information of the c code to use this code snippet.</p>\n\n<p>The idea was to pass the path for the data, <a href=\"https://github.com/amamory/seriation/blob/master/data/Escherichia_coli.dat\" rel=\"nofollow noreferrer\">Escherichia coli</a>, using the argument <code>associationPreprocessed</code>.</p>\n\n<p>2 - Using the <code>.C()</code> function to call <code>main</code>, with the <code>useDynLib(pkg)</code> to dynamically load the <code>.so</code> lib. Similar to the example of <a href=\"https://stackoverflow.com/questions/28026818/how-to-call-c-function-from-r\">this thread</a>.</p>\n\n<p>I believe I got closer to achieving what I expected using the <code>inline::cfuntion()</code>, but I still haven't figured out how to do what I want.</p>\n\n<p>All the examples that I've seen use a simple c code, with only one function.</p>\n"}, {"tags": ["c", "file", "udp", "stm32"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504038529, "post_id": 45947524, "comment_id": 78854129, "body": "Could you please clarify?  You have a controller, and you want to transfer some strings from there to your PC, using UDP protocol, and then save them to a file, is that right?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1504042721, "post_id": 45947524, "comment_id": 78856055, "body": "<a href=\"https://stackoverflow.com/questions/11573974/write-to-txt-file\">stackoverflow.com/questions/11573974/write-to-txt-file</a>"}, {"owner": {"reputation": 823, "user_id": 1850429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aeac2c1534ffc9cd94072b3196838b9?s=128&d=identicon&r=PG", "display_name": "Jeroen3", "link": "https://stackoverflow.com/users/1850429/jeroen3"}, "edited": false, "score": 0, "creation_date": 1504073882, "post_id": 45947524, "comment_id": 78864269, "body": "You have to write an application. Look at python and see what you can do."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 2, "last_activity_date": 1504051264, "creation_date": 1504051264, "answer_id": 45949964, "question_id": 45947524, "link": "https://stackoverflow.com/questions/45947524/save-data-from-udp-into-a-file/45949964#45949964", "title": "Save Data from UDP into a file", "body": "<p>My suggestion:  connect the STM.. and the PC via a RS-232 bus.\nThen have the STM.. send the strings over the bus to the PC.</p>\n\n<p>Have the PC read the RS-232 bus and write the resulting data to some file.</p>\n\n<p>if it were me, I would implement some protocol so the STM.. can tell the PC how many bytes are in each string to be saved and have the STM.. append some checksum so the PC can validate the string.</p>\n\n<p>Suggest the PC reply with a ACK or NAK so the STM.. knows if the transfer of the string was successful (or not)</p>\n\n<p>Do note that the RS-232 bus will be MUCH slower than the UDP communications, so some strings may be lost as the PC cannot keep up with the rate the data is coming into the STM..</p>\n\n<p>Given the UDP is not a guaranteed communication protocol, I would expect the losses would be acceptable.</p>\n"}], "owner": {"reputation": 17, "user_id": 8427229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59900ec5d1abf5fa44d9cf6b550b35b1?s=128&d=identicon&r=PG&f=1", "display_name": "amiroruji72", "link": "https://stackoverflow.com/users/8427229/amiroruji72"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 45949964, "answer_count": 1, "score": 0, "last_activity_date": 1504051264, "creation_date": 1504037146, "question_id": 45947524, "link": "https://stackoverflow.com/questions/45947524/save-data-from-udp-into-a-file", "title": "Save Data from UDP into a file", "body": "<p>I am working on stm32f107VCx microprocessor.</p>\n\n<p>my compiler is keil and I am using spl (standard peripheral library).</p>\n\n<p>I can send and recieve data with UDP protocol but I dont know how to save this strings that I have given from UDP.\nActually I want to save this strings into a file in my PC.</p>\n"}, {"tags": ["c", "unix", "input", "termios"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 1, "creation_date": 1504036343, "post_id": 45947269, "comment_id": 78852990, "body": "Related: <a href=\"https://stackoverflow.com/q/7767702/2404501\">stackoverflow.com/q/7767702/2404501</a>"}, {"owner": {"reputation": 432, "user_id": 7245173, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-gktj-toDgUk/AAAAAAAAAAI/AAAAAAAAAj0/4ZKPOh6tRbc/photo.jpg?sz=128", "display_name": "Emil Terman", "link": "https://stackoverflow.com/users/7245173/emil-terman"}, "reply_to_user": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1504036733, "post_id": 45947269, "comment_id": 78853211, "body": "@ThomasDickey that link does not have a solution for my case. It says to use readline library. But I&#39;m not allowed to use something like that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 1, "creation_date": 1504036799, "post_id": 45947269, "comment_id": 78853245, "body": "In short, to make your program work in ALL terminals, you need to accept that some terminals (including, I think, the classic VT220 that most of them are emulating) don&#39;t provide any way to detect modifier key + function key combinations. Make sure all your application&#39;s features are accessible without going through such obscure key combinations."}, {"owner": {"reputation": 432, "user_id": 7245173, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-gktj-toDgUk/AAAAAAAAAAI/AAAAAAAAAj0/4ZKPOh6tRbc/photo.jpg?sz=128", "display_name": "Emil Terman", "link": "https://stackoverflow.com/users/7245173/emil-terman"}, "edited": false, "score": 0, "creation_date": 1504036886, "post_id": 45947269, "comment_id": 78853291, "body": "@WumpusQ.Wumbley okay... I thought there was a way"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 0, "creation_date": 1504037147, "post_id": 45947269, "comment_id": 78853438, "body": "For any specific terminal emulator, there might be a way to turn on xterm-like functionality. If not, you can submit bug reports asking for it. But it&#39;s up to the terminal emulator to make this possible by sending <i>some</i> distinct escape sequence."}], "owner": {"reputation": 432, "user_id": 7245173, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-gktj-toDgUk/AAAAAAAAAAI/AAAAAAAAAj0/4ZKPOh6tRbc/photo.jpg?sz=128", "display_name": "Emil Terman", "link": "https://stackoverflow.com/users/7245173/emil-terman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 1, "closed_date": 1504094331, "answer_count": 0, "score": 0, "last_activity_date": 1504036211, "creation_date": 1504036115, "last_edit_date": 1504036211, "question_id": 45947269, "link": "https://stackoverflow.com/questions/45947269/read-raw-keyboard-input-using-read-and-termios", "closed_reason": "Duplicate", "title": "Read raw keyboard input using read() and termios", "body": "<p>I'm writing a minimalistic shell for university and I stumbled on a problem: I can't read ctrl-arow_up and ctrl-arow_down on all terminals.</p>\n\n<p>I tried <code>cat -e</code> then pressed those keys in Guake termnial - nothing happened. But when I tried the same in xterm or default ubuntu Terminal, it worked (it showed \"^[[1;5A\" and \"^[[1;5B\").</p>\n\n<p>How do I make it work in all terminals? Or how do I disable shell key preprocessing?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 3, "creation_date": 1504035035, "post_id": 45946957, "comment_id": 78852375, "body": "Increment operator requires an lvalue as its operand, i.e. it requires a <i>variable</i> that you want to update. What were you trying to say by applying <code>++</code> to <code>i + j</code>? What exactly did you try to increment?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1504035056, "post_id": 45946957, "comment_id": 78852389, "body": "You cannot pre-increment <code>(i+j)</code> but you can add <code>1</code> to their sum, such as <code>1+(i+j)</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1504035156, "post_id": 45946957, "comment_id": 78852440, "body": "The compiler gets angry because you tried <code>++(1)</code>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504035294, "post_id": 45946957, "comment_id": 78852488, "body": "If &#39;++(i+j)&#39; was allowed, what value would you expect &#39;i&#39; to have afterwards?  What value would you expect &#39;j&#39; to have afterwards?"}], "answers": [{"tags": [], "owner": {"reputation": 3894, "user_id": 1121568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13eedc2642303b1a2251a4da7f157e?s=128&d=identicon&r=PG", "display_name": "Steven Schobert", "link": "https://stackoverflow.com/users/1121568/steven-schobert"}, "is_accepted": false, "score": 3, "last_activity_date": 1504056360, "last_edit_date": 1504056360, "creation_date": 1504035206, "answer_id": 45947035, "question_id": 45946957, "link": "https://stackoverflow.com/questions/45946957/why-it-throws-an-error-lvalue-is-required/45947035#45947035", "title": "Why It throws an error lvalue is required?", "body": "<p>You are trying to increment an integer value that isn't assigned to a variable.</p>\n\n<p>Taking your code, this is approximately what the computer will try to do:</p>\n\n<pre><code>printf(\"%d\",++(i+j));\n\n// expanded step 1\nprintf(\"%d\",++(0+1));\n\n// expanded step 2\nprintf(\"%d\",++(1));\n</code></pre>\n\n<p>As you can see in the last version, you are trying to call <code>++1</code>, which is invalid.</p>\n\n<p>In order to increment a value using <code>++</code>, the operand must have integral, floating, or pointer type and must be a modifiable l-value expression (an expression without the const attribute):</p>\n\n<pre><code>int x = i+j;\nprintf(\"%d\",++x);\n</code></pre>\n\n<p>Alternatively, you can use the addition operator:</p>\n\n<pre><code>printf(\"%d\",i+j+1);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 1, "creation_date": 1504035585, "post_id": 45947052, "comment_id": 78852622, "body": "Re &quot;<i>In C you cannot apply an unary operator too a number</i>&quot;, Not true: <code>!0</code>, <code>~0</code>"}], "tags": [], "owner": {"reputation": 104, "user_id": 3312059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1649b1b1d7c6cc5c2d2032b086456095?s=128&d=identicon&r=PG", "display_name": "dsapandora", "link": "https://stackoverflow.com/users/3312059/dsapandora"}, "is_accepted": false, "score": 0, "last_activity_date": 1504035692, "last_edit_date": 1504035692, "creation_date": 1504035277, "answer_id": 45947052, "question_id": 45946957, "link": "https://stackoverflow.com/questions/45946957/why-it-throws-an-error-lvalue-is-required/45947052#45947052", "title": "Why It throws an error lvalue is required?", "body": "<p>In C you cannot apply an unary operator too a number. When the value between the parentesis is evaluated first... before use the unary operation. assing the result to a variable. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main(){\n    int i=0,j=1, other_value=0;\n    other_value = i+j;\n    printf(\"%d\",++(other_value));\n    return 0;\n}\n</code></pre>\n\n<p>Your previus code will work will get the error</p>\n\n<pre><code>error: lvalue required as increment operand\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1504035327, "creation_date": 1504035327, "answer_id": 45947069, "question_id": 45946957, "link": "https://stackoverflow.com/questions/45946957/why-it-throws-an-error-lvalue-is-required/45947069#45947069", "title": "Why It throws an error lvalue is required?", "body": "<p>You cant increment the result.</p>\n\n<p>Instead:</p>\n\n<pre><code>   printf(\"%d\",i + j + 1);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62, "user_id": 1218591, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/K3Kli.jpg?s=128&g=1", "display_name": "Shalabh Saxena", "link": "https://stackoverflow.com/users/1218591/shalabh-saxena"}, "is_accepted": false, "score": 0, "last_activity_date": 1504035928, "creation_date": 1504035928, "answer_id": 45947218, "question_id": 45946957, "link": "https://stackoverflow.com/questions/45946957/why-it-throws-an-error-lvalue-is-required/45947218#45947218", "title": "Why It throws an error lvalue is required?", "body": "<p>An \"lvalue\" is a value that can be the target of an assignment. The \"l\" stands for \"left\", as in the left hand side of the equals sign. An rvalue is the right hand value and produces a value, and cannot be assigned to directly. If you are getting \"lvalue required\" you have an expression that produces an rvalue when an lvalue is required.</p>\n\n<p>in your case when compiler manipulate the expression then it will result to invalid expression which is ++1</p>\n\n<p>try below:</p>\n\n<p>printf(\"%d\",i+j+1);</p>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 3414978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6599c349c347f7257f71cbbd3d4131d4?s=128&d=identicon&r=PG&f=1", "display_name": "Ankur Agrawal", "link": "https://stackoverflow.com/users/3414978/ankur-agrawal"}, "is_accepted": false, "score": 0, "last_activity_date": 1504036227, "creation_date": 1504036227, "answer_id": 45947291, "question_id": 45946957, "link": "https://stackoverflow.com/questions/45946957/why-it-throws-an-error-lvalue-is-required/45947291#45947291", "title": "Why It throws an error lvalue is required?", "body": "<p>The expression <code>++(i+j)</code> is not assignable. Here, the expression <code>(i+j)</code> will get evaluated first. For the <code>++</code> operator, the operand must have integral, floating, or pointer type and must be a modifiable l-value expression. Since the result from <code>i+j</code> is a constant value, so you get the error <code>lvalue required as increment operand</code>. You can choose to modify this expression as <code>i+j+1</code>. </p>\n"}], "owner": {"reputation": 1, "user_id": 5079630, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3oMtEtti1Zs/AAAAAAAAAAI/AAAAAAAAA2U/PxF0wq5UjM4/photo.jpg?sz=128", "display_name": "Priyank Agrawal", "link": "https://stackoverflow.com/users/5079630/priyank-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 1, "answer_count": 5, "score": -3, "last_activity_date": 1504056360, "creation_date": 1504034878, "last_edit_date": 1504035075, "question_id": 45946957, "link": "https://stackoverflow.com/questions/45946957/why-it-throws-an-error-lvalue-is-required", "title": "Why It throws an error lvalue is required?", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main(){\n    int i=0,j=1;\n    printf(\"%d\",++(i+j));\n    return 0;\n}\n</code></pre>\n\n<p>In this code I have used the increment operator but i don't know why it throws an error. </p>\n\n<p>It throws the error:</p>\n\n<blockquote>\n  <p>lvalue is required.</p>\n</blockquote>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 1, "creation_date": 1504038041, "post_id": 45946865, "comment_id": 78853885, "body": "To downvoters: if you downvote you should explain why, else it&#39;s pointless. The question is quite understandable and even has a MCVE so I really don&#39;t see a reason for downvote."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 14021, "user_id": 7571258, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/fBP6e.png?s=128&g=1", "display_name": "zett42", "link": "https://stackoverflow.com/users/7571258/zett42"}, "edited": false, "score": 0, "creation_date": 1504087406, "post_id": 45946865, "comment_id": 78872628, "body": "@zett42: This question is asking about problems caused by randomly changing code, the OP doesn&#39;t understand. This is hardly useful to the general public, that tends to want to solve real problems, rather than artificial ones. The useful question the OP <i>should</i> have asked instead: <i>&quot;What is the purpose of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644934.aspx\" rel=\"nofollow noreferrer\">DispatchMessage</a>?&quot;</i> As asked, this question isn&#39;t useful."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504087692, "post_id": 45946865, "comment_id": 78872825, "body": "randomly changing code I don&amp;amp;#39;t understand? I was confused about how NCHITTEST was sent to the window. It turns out to be seen by the window proc, but not the thread message queue; it is useful to understand how this occurs(some messages like WM_PAINT, and WM_MOUSEMOVE get seen by the thread message queue, while NCHITTEST is not). I don&#39;t understand your concern."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1504092461, "post_id": 45946865, "comment_id": 78876180, "body": "It stands to reason, that you do not understand the consequences of registering a window procedure, because you do not understand <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644927.aspx#routing\" rel=\"nofollow noreferrer\">message routing</a> in a Windows application. All of this is documented and readily available. A question asking how to best fight the system is not generally useful."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504092699, "post_id": 45946865, "comment_id": 78876379, "body": "I understand the consequences of registering a window procedure. I didn&#39;t understand the concept of queued and non queued messages. It makes perfect sense now."}], "answers": [{"comments": [{"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504066528, "post_id": 45947361, "comment_id": 78861876, "body": "I understand that I can easily do this in a callback. I was just curious if there was a way to handle NCHITTEST in this way. It appears that even with the callback, to my surprise, the loop itself never receives WM_NCHITTEST message. It seems like WndProc gets the message before the message loop does, so I was thinking about it backwards. This kind of also explains why if STATIC windows don&#39;t get many of the events other windows do, its&#39; default proc consumes them before the loop gets to see them, my window is just generous enough to pass them over for the loop to see."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504066706, "post_id": 45947361, "comment_id": 78861925, "body": "I&#39;m still not sure why my proc never passes NCHITTEST for the loop to see, is there really no way to expose it? Why is MOUSEMOVE seen by the loop, but NCHITTEST isn&#39;t?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 1, "creation_date": 1504074282, "post_id": 45947361, "comment_id": 78864483, "body": "@Dmitry: As I explained in my answer, <code>WM_NCHITTEST</code> is NOT a queued message, it does not go through the message queue, so a message loop will never see it. <code>WM_MOUSMOVE</code>, on the other hand, IS a queued message, so it goes through the message queue and will be seen by a message loop. Please read the links in my answer, they explain this difference. Things the OS (or other sender) depends on a reply to are NOT queued. Notifications and other things not dependant on a reply are usually queued instead."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504074505, "post_id": 45947361, "comment_id": 78864592, "body": "oh so some messages are queued while others are sent directly via CallWindowProc rather than SendMessage?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 1, "creation_date": 1504074945, "post_id": 45947361, "comment_id": 78864833, "body": "@Dmitry: you are mixing apples and oranges. <code>SendMessage()</code> and <code>CallWindowProc()</code> are very different things for different purposes. Seems you need to do some research on how Windows&#39; messaging systems actually work, what the different component are, and what roles they serve. MSDN has very detailed documentation on this subject."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504459167, "post_id": 45947361, "comment_id": 79011339, "body": "would it be fair to say that the main job of WndProc is to handle non queued messages, as these are  the ones that you can&#39;t override without subclassing the window?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504470786, "post_id": 45947361, "comment_id": 79014996, "body": "@Dmitry the main job of a <code>WndProc</code> is to handle ALL messages for a window, whether they are queued or not. Queued messages arrive in the message queue and get dispatched to appropriate windows. Non-queued messages get sent directly to appropriate windows. Either way, all messages for a given window go through the window&#39;s <code>WndProc</code> for processing."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504489307, "post_id": 45947361, "comment_id": 79018590, "body": "An interesting observation is that without DispatchMessage, SendMessage message is always seen by the thread&#39;s message queue, but never the WndProc(kinda like X11&#39;s event loop); whereas PostMessage is always seen by WndProc but never seen by thread message queue. What&#39;s strange is that if WndProc doesn&#39;t call DefWindowProc, thread&#39;s message queue still sees the WM_PAINT message. WM_NCHITTEST is received by WndProc before thread, WM_NCLBUTTONDOWN is seen by thread before WndProc, and depriving this message(161) prevents wndproc from responding to mouse beyond WM_NCHITTEST. very confusing."}, {"owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504489384, "post_id": 45947361, "comment_id": 79018607, "body": "it seems like all messages other than WM_NCHITTEST get handled by the loop which dispatches them to the correct WndProc via a HWND -&gt; WNDPROC map, which seems to contradict all messages being seen by WndProc before the loop."}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "edited": false, "score": 0, "creation_date": 1504489700, "post_id": 45947361, "comment_id": 79018657, "body": "@Dmitry: <code>SendMessage()</code> messages are NEVER seen by a message loop, but <code>(Peek|Get)Message()</code> will dispatch them to the <code>WndProc</code> if they are sent from another thread. <code>PostMessage()</code> messages require the message loop to call <code>DispatchMessage()</code> in order for them to reach the <code>WndProc</code>. <code>WM_PAINT</code> is generated by <code>(Peek|Get)Message()</code> only when there are no other messages in the message queue. All of this is documented on MSDN."}], "tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": true, "score": 4, "last_activity_date": 1504037201, "last_edit_date": 1504037201, "creation_date": 1504036490, "answer_id": 45947361, "question_id": 45946865, "link": "https://stackoverflow.com/questions/45946865/how-to-handle-wm-nchittest-in-a-naked-event-loop/45947361#45947361", "title": "how to handle WM_NCHITTEST in a naked event loop?", "body": "<h2>You can't.</h2>\n\n<p>The code you have shown will NEVER work, because <code>(Get|Peek)Message()</code> returns only <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644927.aspx#quequed_messages\" rel=\"nofollow noreferrer\"><strong>QUEUED</strong></a> messages.  You cannot reply to a queued message, because the sender is not waiting for a reply, it put the message in the queue and moved on to other things.  Only <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644927.aspx#nonqueued_messages\" rel=\"nofollow noreferrer\"><strong>NON-QUEUED</strong></a> messages that are sent with the <code>SendMessage...()</code> family of functions can be replied to.  <code>(Get|Peek)Message()</code> will NEVER return a sent message, but will internally dispatch it to the target window's message procedure (only messages sent from another thread will be dispatched, messages sent to a window by the same thread that owns the window will bypass the message queue completely).</p>\n\n<p><code>WM_PAINT</code> is a queued message, so your event loop sees it.  But <code>WM_NCHITTEST</code> is not queued, so your message loop will NEVER see it directly, it can only be seen in a message procedure.</p>\n\n<p>What you have shown is NOT the right way to handle a Windows UI message loop.  Since you are creating a UI window, you MUST provide it with a message procedure (if not by <code>RegisterClass/Ex()</code>, then by <code>SetWindowLong/Ptr(GWL_WNDPROC)</code> or <code>SetWindowSubclass()</code>).  But DO NOT use <code>DefWindowProc()</code> for that procedure if you need to process messages manually.  Provide your own message procedure that calls <code>DefWindowProc()</code> (or <code>CallWindowProc()</code> in the case of <code>GWL_WNDPROC</code>, or <code>DefSubclassProc()</code> in the case of <code>SetWindowSubclass()</code>) for any unhandled messages, eg:</p>\n\n<pre><code>LRESULT WINAPI MyWndProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)\n{\n    switch (uMsg) {\n        case WM_PAINT: {\n            PAINTSTRUCT ps;\n            HDC hdc = BeginPaint(hwnd, &amp;ps);\n\n            SelectObject(hdc, GetStockObject(BLACK_BRUSH));\n            Rectangle(hdc, 0, 0, 320, 200);\n\n            EndPaint(hwnd, &amp;ps);\n            return 0;\n        }\n\n        case WM_NCHITTEST: {\n            LRESULT hit = DefWindowProc(hwnd, uMsg, wParam, lParam);\n            if (hit == HTCLIENT) {\n                hit = HTCAPTION;\n            }\n            return hit;\n        }\n    }\n\n    return DefWindowProc(hwnd, uMsg, wParam, lParam);\n}\n\nint main(int argc, char **argv)\n{\n    /* anonymous scope: register window class */\n    {\n        WNDCLASSEXW wcx;\n        wcx.cbSize = sizeof(wcx);\n        wcx.style = CS_HREDRAW | CS_VREDRAW;\n        wcx.lpfnWndProc = MyWndProc; // &lt;--\n        wcx.cbClsExtra = sizeof(void *);\n        wcx.cbWndExtra = sizeof(void *);\n        wcx.hInstance = (HINSTANCE)GetModuleHandle(NULL);\n        wcx.hIcon = LoadIcon(NULL, IDI_APPLICATION);\n        wcx.hCursor = LoadCursor(NULL, IDC_ARROW);\n        wcx.hbrBackground = (HBRUSH)COLOR_WINDOWFRAME;\n        wcx.lpszMenuName = NULL;\n        wcx.lpszClassName = L\"MyWindow\";\n        wcx.hIconSm = wcx.hIcon;\n        RegisterClassExW(&amp;wcx);\n    }\n\n    global.desktop = GetDesktopWindow();\n\n    global.window = CreateWindowExW (\n        0,\n        L\"MyWindow\",\n        NULL,\n        WS_POPUPWINDOW | WS_VISIBLE,\n        0,\n        0,\n        320,\n        200,\n        global.desktop,\n        NULL,\n        (HINSTANCE)GetModuleHandle(NULL),\n        NULL\n    );\n\n    /* anonymous scope, event loop */\n    {\n        MSG msg;\n\n        while (GetMessage(&amp;msg, NULL, 0, 0) &gt; 0) {\n            TranslateMessage(&amp;msg);\n            DispatchMessage(&amp;msg);\n        }    \n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 4398, "user_id": 2012715, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0a04a0851dba37de648917cf0abea9b8?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2012715/dmitry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 45947361, "answer_count": 1, "score": 0, "last_activity_date": 1504037201, "creation_date": 1504034550, "last_edit_date": 1504035237, "question_id": 45946865, "link": "https://stackoverflow.com/questions/45946865/how-to-handle-wm-nchittest-in-a-naked-event-loop", "title": "how to handle WM_NCHITTEST in a naked event loop?", "body": "<p>I'm playing with Windows API trying to understand how it behaves, and I realized that I can remove WNDPROC altogether and handle things with a naked event loop, like this:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\nstatic struct {\n    HWND desktop;\n    HWND window;\n} global;\n\nint main(int argc, char **argv)\n{\n    /* anonymous scope: register window class */\n    {\n        WNDCLASSEXW wcx;\n        wcx.cbSize = sizeof(wcx);\n        wcx.style = CS_HREDRAW | CS_VREDRAW;\n        wcx.lpfnWndProc = DefWindowProc;\n        wcx.cbClsExtra = sizeof(void *);\n        wcx.cbWndExtra = sizeof(void *);\n        wcx.hInstance = (HINSTANCE)GetModuleHandle(NULL);\n        wcx.hIcon = LoadIcon(NULL, IDI_APPLICATION);\n        wcx.hCursor = LoadCursor(NULL, IDC_ARROW);\n        wcx.hbrBackground = (HBRUSH)COLOR_WINDOWFRAME;\n        wcx.lpszMenuName = NULL;\n        wcx.lpszClassName = L\"MyWindow\";\n        wcx.hIconSm = wcx.hIcon;\n        RegisterClassExW(&amp;wcx);\n    }\n\n    global.desktop = GetDesktopWindow();\n\n    global.window = CreateWindowExW (\n        0,\n        L\"MyWindow\",\n        NULL,\n        WS_POPUPWINDOW | WS_VISIBLE,\n        0,\n        0,\n        320,\n        200,\n        global.desktop,\n        NULL,\n        (HINSTANCE)GetModuleHandle(NULL),\n        NULL\n    );\n\n    /* anonymous scope, event loop */\n    {\n        MSG msg;\n\n        while (GetMessage(&amp;msg, NULL, 0, 0) &gt; 0) {\n            TranslateMessage(&amp;msg);\n\n            if(msg.hwnd == global.window) {\n                if (msg.message == WM_PAINT) {\n                    PAINTSTRUCT ps;\n                    HDC hdc;\n\n                    hdc = BeginPaint(msg.hwnd, &amp;ps);\n\n                    SelectObject(hdc, GetStockObject(BLACK_BRUSH));\n                    Rectangle(hdc, 0, 0, 320, 200);\n\n                    EndPaint(msg.hwnd, &amp;ps);\n                } else {\n                    DispatchMessage(&amp;msg);\n                }\n            } else {\n                DispatchMessage(&amp;msg);\n            }\n        }    \n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<p>I wanted to go one step further and try making this window moveable using <a href=\"https://stackoverflow.com/a/7773941/2012715\">this</a> technique, and got confused because I can't \"return\" from a message loop in the way i'm used to(the statement <code>return hit;</code>) does not make sense in this context.</p>\n\n<p>Here is how I started, and got confused:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\nstatic struct {\n    HWND desktop;\n    HWND window;\n} global;\n\nint main(int argc, char **argv)\n{\n    /* anonymous scope: register window class */\n    {\n        WNDCLASSEXW wcx;\n        wcx.cbSize = sizeof(wcx);\n        wcx.style = CS_HREDRAW | CS_VREDRAW;\n        wcx.lpfnWndProc = DefWindowProc;\n        wcx.cbClsExtra = sizeof(void *);\n        wcx.cbWndExtra = sizeof(void *);\n        wcx.hInstance = (HINSTANCE)GetModuleHandle(NULL);\n        wcx.hIcon = LoadIcon(NULL, IDI_APPLICATION);\n        wcx.hCursor = LoadCursor(NULL, IDC_ARROW);\n        wcx.hbrBackground = (HBRUSH)COLOR_WINDOWFRAME;\n        wcx.lpszMenuName = NULL;\n        wcx.lpszClassName = L\"MyWindow\";\n        wcx.hIconSm = wcx.hIcon;\n        RegisterClassExW(&amp;wcx);\n    }\n\n    global.desktop = GetDesktopWindow();\n\n    global.window = CreateWindowExW (\n        0,\n        L\"MyWindow\",\n        NULL,\n        WS_POPUPWINDOW | WS_VISIBLE,\n        0,\n        0,\n        320,\n        200,\n        global.desktop,\n        NULL,\n        (HINSTANCE)GetModuleHandle(NULL),\n        NULL\n    );\n\n    /* anonymous scope, event loop */\n    {\n        MSG msg;\n\n        while (GetMessage(&amp;msg, NULL, 0, 0) &gt; 0) {\n            TranslateMessage(&amp;msg);\n\n            if(msg.hwnd == global.window) {\n                if (msg.message == WM_PAINT) {\n                    PAINTSTRUCT ps;\n                    HDC hdc;\n\n                    hdc = BeginPaint(msg.hwnd, &amp;ps);\n\n                    SelectObject(hdc, GetStockObject(BLACK_BRUSH));\n                    Rectangle(hdc, 0, 0, 320, 200);\n\n                    EndPaint(msg.hwnd, &amp;ps);\n                } else if (msg.message == WM_NCHITTEST) {\n                    LRESULT hit = DefWindowProc(msg.hwnd, msg.message, msg.wParam, msg.lParam);\n                    if (hit == HTCLIENT) {\n                        hit = HTCAPTION;\n                    }\n                    // return hit; // makes no sense here\n                } else {\n                    DispatchMessage(&amp;msg);\n                }\n            } else {\n                DispatchMessage(&amp;msg);\n            }\n        }    \n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<p>How can I simulate returning \"hit\" from the WM_NCHITTEST condition so that it moves the window like in the solution here: <a href=\"https://stackoverflow.com/a/7773941/2012715\">https://stackoverflow.com/a/7773941/2012715</a> ?</p>\n\n<p>PS: I know that it's better to use a map(like std::unordered_map) rather than a long if/switch for scalability and readability, but I wanted to keep the example more direct.</p>\n"}, {"tags": ["c", "gcc", "gcc4.9"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1504033567, "post_id": 45946548, "comment_id": 78851612, "body": "sounds like a gcc bug. googling: <a href=\"https://sourceforge.net/p/covered/bugs/171/\" rel=\"nofollow noreferrer\">sourceforge.net/p/covered/bugs/171</a>"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504033917, "post_id": 45946548, "comment_id": 78851800, "body": "Nobody should be using <code>-fno-omit-frame-pointer</code>, CFI directives do unwinding better."}], "answers": [{"comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504041007, "post_id": 45946792, "comment_id": 78855342, "body": "Doesn&#39;t that mean you should be using a different constraint mode?"}, {"owner": {"reputation": 6309, "user_id": 717822, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e6a550ddff2d2288933bfd21d49a14?s=128&d=identicon&r=PG", "display_name": "perror", "link": "https://stackoverflow.com/users/717822/perror"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1504042593, "post_id": 45946792, "comment_id": 78856021, "body": "Well, my first guess is that the default architecture will correct the problem by itself... but it is just a guess."}], "tags": [], "owner": {"reputation": 6309, "user_id": 717822, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7e6a550ddff2d2288933bfd21d49a14?s=128&d=identicon&r=PG", "display_name": "perror", "link": "https://stackoverflow.com/users/717822/perror"}, "is_accepted": false, "score": 0, "last_activity_date": 1504034264, "creation_date": 1504034264, "answer_id": 45946792, "question_id": 45946548, "link": "https://stackoverflow.com/questions/45946548/gcc-error-extended-registers-have-no-high-halves/45946792#45946792", "title": "GCC Error: extended registers have no high halves", "body": "<p>It seems that this error has been added in this <a href=\"https://gcc.gnu.org/ml/gcc-patches/2001-03/msg00471.html\" rel=\"nofollow noreferrer\">patch</a>:</p>\n\n<pre><code>+   /* Irritantingly AMD extended registers use different naming convention\n+      from the normal registers.  */\n+   if (REX_INT_REG_P (x))\n+   {\n+       switch (code)\n+     {\n+     case 5:\n+       error (\"Extended registers have no high halves\\n\");\n+       break;\n+     case 1:\n+       fprintf (file, \"r%ib\", REGNO (x) - FIRST_REX_INT_REG + 8);\n+       break;\n+     case 2:\n+       fprintf (file, \"r%iw\", REGNO (x) - FIRST_REX_INT_REG + 8);\n+       break;\n+     case 4:\n+       fprintf (file, \"r%id\", REGNO (x) - FIRST_REX_INT_REG + 8);\n+       break;\n+     case 8:\n+       fprintf (file, \"r%i\", REGNO (x) - FIRST_REX_INT_REG + 8);\n+       break;\n+     default:\n+       error (\"Unsupported operand size for extended register.\\n\");\n+       break;\n+      }\n+       return;\n+   }\n</code></pre>\n\n<p>Try to recompile without the option <code>-march=x86-64</code>.</p>\n"}], "owner": {"reputation": 475, "user_id": 361190, "user_type": "registered", "accept_rate": 31, "profile_image": "https://i.stack.imgur.com/Alc9X.jpg?s=128&g=1", "display_name": "MGH", "link": "https://stackoverflow.com/users/361190/mgh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1504034470, "creation_date": 1504033276, "last_edit_date": 1504034470, "question_id": 45946548, "link": "https://stackoverflow.com/questions/45946548/gcc-error-extended-registers-have-no-high-halves", "title": "GCC Error: extended registers have no high halves", "body": "<p>I am trying to compile a 64bit C library using <code>gcc-4.9.1.</code> While compiling with <code>-O2</code>, I am getting the following error at different places. <code>-O0</code> compilation works fine.</p>\n\n<pre><code>Error:\nerror: extended registers have no high halves\n</code></pre>\n\n<p>Any idea why this error message is coming and how to fix it. The line number it points to is the end of the function.</p>\n\n<p>The compiler options are :</p>\n\n<pre><code> -march=x86-64 -fno-omit-frame-pointer -m64 -Wno-pointer-sign\n -Wno-error=address -ggdb -gdwarf-2 -g2 -feliminate-unused-debug-types \n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1504033370, "post_id": 45946544, "comment_id": 78851516, "body": "Perhaps first explain why you thought the result would be &quot;100,90,80,70,60,50,40,30,20,10&quot; with code changing <code>ara[]</code> with  <code>ara[i]=ara[j];</code>?  Perhaps try this with <code>int ara[] ={1,2,3,4}</code>?"}, {"owner": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504033462, "post_id": 45946544, "comment_id": 78851563, "body": "@chux I totally missread the question, I thought OP said that was the result and they were expecting it to be the actual result, I thought, <i>&quot;That makes no sense&quot;</i>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 3, "creation_date": 1504033525, "post_id": 45946544, "comment_id": 78851590, "body": "Step through the code with your debugger, watching the values at each step.  All will become clear."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504033579, "post_id": 45946544, "comment_id": 78851622, "body": "<code>int ara_r[10];</code>..<code>ara_r[i]=ara[j];printf(&quot;%d\\n&quot;,ara_r[i]);</code>"}, {"owner": {"reputation": 31, "user_id": 8534263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11zW.jpg?s=128&g=1", "display_name": "afredy Hasan", "link": "https://stackoverflow.com/users/8534263/afredy-hasan"}, "edited": false, "score": 0, "creation_date": 1504033631, "post_id": 45946544, "comment_id": 78851654, "body": "sir because I was thinking that ara[j]=100 which is going to ara[i] which is index[0]...Then I am reducing the j and increasing the i..so ara[j]=90 will go to the ara[i] which is index[1].And I am printing the index[i] values.Was there any logical problem sir?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504033782, "post_id": 45946544, "comment_id": 78851737, "body": "Consider that <code>arr[0]=10</code> happened first in initialization and then <code>arr[0]</code> was assigned the value 100 with <code>ara[i]=ara[j];</code>.  That <code>10</code> is lost.  it is no longer in the array.  So code will not print out <code>.... 40,30,20,10</code>.  At the end of the first loop iteration, the array is 100, 20, 30, ..., 90, 100. After the 2nd it is 100, 90, 30, ..., 90, 100. (the 20 is lost)"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504033945, "post_id": 45946544, "comment_id": 78851818, "body": "maybe You want like <a href=\"https://ideone.com/hLOVrr\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 31, "user_id": 8534263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11zW.jpg?s=128&g=1", "display_name": "afredy Hasan", "link": "https://stackoverflow.com/users/8534263/afredy-hasan"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504034226, "post_id": 45946544, "comment_id": 78851961, "body": "@chux sir,I got it.Now it make sense.Thanks a lot sir."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 6281260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d43d6b575f82a76bc2df75175cf5aa71?s=128&d=identicon&r=PG&f=1", "display_name": "Vikram Kumar", "link": "https://stackoverflow.com/users/6281260/vikram-kumar"}, "is_accepted": false, "score": 3, "last_activity_date": 1504035628, "last_edit_date": 1504035628, "creation_date": 1504034148, "answer_id": 45946756, "question_id": 45946544, "link": "https://stackoverflow.com/questions/45946544/unexpected-result-while-working-with-array/45946756#45946756", "title": "unexpected result while working with array", "body": "<p>After printing value 60, i.e. half of the array when you try to access elements further, actually you will access those elements which are of the locations after mid of the array. because you are assigning them using ara[i] = ara[j]..so you will end up with repetition after half of array.\nAs:-</p>\n\n<pre><code>ara[0] = ara[9]\nara[1] = ara[8]\nara[2] = ara[7]\nara[3] = ara[6]\nara[4] = ara[5]\nara[5] = ara[4]\n</code></pre>\n\n<p>The simplest solution may be creating a temporary array:-</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n main(){\n  int ara[] ={10,20,30,40,50,60,70,80,90,100},i,temp[10],j; \n  for(i = 9, j = 0; i &gt;= 0; i--, j++){ \n      temp[j]=ara[i];\n   } \n  for(i = 0; i &lt; 10; i++){\n      printf(\"%d\\n\", temp[i]);\n  }\n</code></pre>\n\n<p>}</p>\n"}, {"tags": [], "owner": {"reputation": 7123, "user_id": 6519111, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/mc6YV.jpg?s=128&g=1", "display_name": "Ashkan Sirous", "link": "https://stackoverflow.com/users/6519111/ashkan-sirous"}, "is_accepted": false, "score": 1, "last_activity_date": 1504034698, "creation_date": 1504034698, "answer_id": 45946913, "question_id": 45946544, "link": "https://stackoverflow.com/questions/45946544/unexpected-result-while-working-with-array/45946913#45946913", "title": "unexpected result while working with array", "body": "<p>What you are doing in this code?</p>\n\n<blockquote>\n  <p>reversing an array</p>\n</blockquote>\n\n<p>Why are you printing 100,90,80,70,60,50,60,70,...</p>\n\n<blockquote>\n  <p>because when you reach the 6th one (ara[4]), you've already swapped it with 4th one (ara[6])</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1504035072, "creation_date": 1504035072, "answer_id": 45947006, "question_id": 45946544, "link": "https://stackoverflow.com/questions/45946544/unexpected-result-while-working-with-array/45947006#45947006", "title": "unexpected result while working with array", "body": "<p>You need to save in the temporary variable the value which is written first</p>\n\n<p>Some examples</p>\n\n<pre><code>char *reverse(char *str)\n{\n    char tmp;\n    int len;\n\n    if (str != NULL)\n    {\n        len = strlen(str);\n        for (int i = 0; i &lt; len / 2; i++)\n        {\n            tmp = *(str + i);\n            *(str + i) = *(str + len - i - 1);\n            *(str + len - i - 1) = tmp;\n\n        }\n    }\n    return str;\n}\n\nint *reverseints(int *data, size_t size)\n{\n    int tmp;\n\n    if (data != NULL)\n    {\n        for (int i = 0; i &lt; size / 2; i++)\n        {\n            tmp = *(data + i);\n            *(data + i) = *(data + size - i - 1);\n            *(data + size - i - 1) = tmp;\n\n        }\n    }\n    return data;\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8534263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O11zW.jpg?s=128&g=1", "display_name": "afredy Hasan", "link": "https://stackoverflow.com/users/8534263/afredy-hasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1504035628, "creation_date": 1504033266, "question_id": 45946544, "link": "https://stackoverflow.com/questions/45946544/unexpected-result-while-working-with-array", "title": "unexpected result while working with array", "body": "<p>sir i am a new programmer.So i am facing some new problems which I really need to solve. Like I write a code</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n main(){\n  int ara[] ={10,20,30,40,50,60,70,80,90,100},i,temp,j; \n  for(i=0,j=9;i&lt;10;i++,j--){ \n      ara[i]=ara[j];\n      printf(\"%d\\n\",ara[i]); } \n    }\n</code></pre>\n\n<p>I thought the result would be 100,90,80,70,60,50,40,30,20,10 but the result is not like this...Would anyone please tell me why the result shows 100,90,80,70,60,60,70,80,90,100</p>\n"}, {"tags": ["c", "type-conversion"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 4, "creation_date": 1504030685, "post_id": 45945838, "comment_id": 78850085, "body": "<code>printf(&quot;SI = %d&quot;, si);</code> but <code>si</code> is a <code>float</code>: change to <code>%f</code>"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 3, "creation_date": 1504030702, "post_id": 45945838, "comment_id": 78850093, "body": "<code>%d</code> is for <b>integers</b>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1504030738, "post_id": 45945838, "comment_id": 78850118, "body": "Why do you think <code>si</code> is <code>0</code>?"}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "edited": false, "score": 0, "creation_date": 1504030955, "post_id": 45945838, "comment_id": 78850235, "body": "It should print the 4 bytes of float si by interpreting them as  an integer. If you want it to print 100 (or 99) then you can typecast <code>si</code> as <code>int</code> in the print statement."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1504031361, "post_id": 45945838, "comment_id": 78850428, "body": "good c beginners book needed. <b>this topic is the multiple duplicate</b>"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1504031679, "post_id": 45945838, "comment_id": 78850609, "body": "Printf isn&#39;t that smart. You&#39;ll have to do the <code>(int)si</code> cast yourself."}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "edited": false, "score": 0, "creation_date": 1504031320, "post_id": 45945878, "comment_id": 78850405, "body": "any idea why is he getting 0 instead of expected garbage value?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "edited": false, "score": 1, "creation_date": 1504033067, "post_id": 45945878, "comment_id": 78851350, "body": "@VikasYadav Consider: I send you a <code>float</code> and put it in the <code>float</code> box.  You look in the <code>int</code> box and see ... nothing  .... and print that. Perhaps a 0 left over from before, maybe not, maybe the boxes overlap?  It is <i>undefined behavior</i>."}], "tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 2, "last_activity_date": 1504031166, "last_edit_date": 1504031166, "creation_date": 1504030780, "answer_id": 45945878, "question_id": 45945838, "link": "https://stackoverflow.com/questions/45945838/what-should-be-the-value-of-si/45945878#45945878", "title": "What should be the value of si?", "body": "<p>You are passing value in floating point representation while you used <code>%d</code> specifier which forces printf to expect an <code>int</code>.</p>\n\n<p>There is no 'automatic cast' when you pass variables to a variandic function like printf, the values are passed into the function as the datatype they actually are (or upgraded to a larger compatible type in some cases) because <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> is weakly typed language.</p>\n\n<p>If you pass type with <strong>incompatible internal representation</strong> you will get garbage output.</p>\n\n<p>Change </p>\n\n<pre><code>printf(\"SI = %d\", si);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>printf(\"SI = %f\", si);\n</code></pre>\n\n<p>or (if you would like to get integral value of expression)</p>\n\n<pre><code>printf(\"SI = %d\", (int)si);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8349165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8adea1666ba6d16cfa0863d92ca027c?s=128&d=identicon&r=PG&f=1", "display_name": "user8349165", "link": "https://stackoverflow.com/users/8349165/user8349165"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1504031166, "creation_date": 1504030628, "question_id": 45945838, "link": "https://stackoverflow.com/questions/45945838/what-should-be-the-value-of-si", "title": "What should be the value of si?", "body": "<p>I am trying to workout the output of the below given c program but unable to figure out.</p>\n\n<p>Why is si = 0?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(void){\n\n    float p = 1000;\n    float r = 5;\n    float t = 2;\n\n    float si = p * r * t / 100;\n\n    printf(\"SI = %d\", si);\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "language-lawyer", "c11"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504031502, "post_id": 45945623, "comment_id": 78850512, "body": "@Grzegorz Szpetkowski You should ask yourself - what is the point of it. Why to invoke the UB?"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504031642, "post_id": 45945623, "comment_id": 78850585, "body": "@PeterJ_01: It may be useful to know for working with legacy code, which suprisingly compiles or not on different compilers."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504031714, "post_id": 45945623, "comment_id": 78850632, "body": "@Grzegorz Szpetkowski such a code requires rewriting in the correct manner"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 4, "creation_date": 1504032250, "post_id": 45945623, "comment_id": 78850928, "body": "@PeterJ_01: Code base may be large and sometimes it is not practical (in terms of business value and staff-months) to rewrite it, especially when it is already working for customers. This is especially true for mission-critical software like software for submarines or nuclear plants."}], "answers": [{"comments": [{"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1504030962, "post_id": 45945862, "comment_id": 78850240, "body": "AFAIR it works that way in second direction, when old-style declaration prepends normal definition. For example, <code>int foo()</code> and then <code>int foo(int a) {}</code> is fine, as declaration without prototype effectively turns-off further type checking."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1504031017, "post_id": 45945862, "comment_id": 78850274, "body": "@GrzegorzSzpetkowski Yes, but that&#39;s not the way to be used for <i>variadic</i> notation, you know. :)"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1504031385, "post_id": 45945862, "comment_id": 78850444, "body": "violating a <i>shall</i> is not enough to require the diagnostic, you have to precise 6.7p4 is in a constraint section"}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1513768089, "post_id": 45945862, "comment_id": 82775888, "body": "I finally marked this answer as accepted, The reason is that declarations are not compatible (as defined in 6.7.6.3/15). More specifically, the following does not hold: <i>&quot;If one type has a parameter type list and the other type is specified by a function definition that contains a (possibly empty) identifier list, both shall agree  in  the  number  of  parameters&quot;</i>. Note that <code>void foo() {}</code> does constitute a function type, that does not include a prototype, and the 6.7.6.3/15 does not require from examined function types to include such as a prototype."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1504031398, "last_edit_date": 1504031398, "creation_date": 1504030714, "answer_id": 45945862, "question_id": 45945623, "link": "https://stackoverflow.com/questions/45945623/why-does-mismatched-prototype-and-definition-with-empty-argument-list-give-diffe/45945862#45945862", "title": "Why does mismatched prototype and definition with empty argument list give different results in GCC and Clang?", "body": "<p><del>I do not have a quote from a standard</del> (<em>edit: Refer <code>C11</code>, chapter  6.7.6.3/P14</em>), but as per my understanding, <code>gcc</code> is right to shout, as you're contradicting yourself.</p>\n\n<p>You <em>promised</em> that in the function definition, in the declaration-list, you will have two parameters of type <code>int</code>, but they are not there. In case of a function definition, and empty list means that function should take no parameter. So there is a constraint violation and <code>gcc</code> is right to complain.</p>\n\n<p>It seems this is a problem in <a href=\"http://clang-developers.42468.n3.nabble.com/gcc-compatibility-error-number-of-arguments-doesn-t-match-prototype-td3834935.html\" rel=\"nofollow noreferrer\">clang</a> that is does not produce a warning at least.</p>\n\n<hr>\n\n<p>Quotes:</p>\n\n<p>Chapter \u00a76.7, P4 (<strong><em>Constraints</em></strong>)</p>\n\n<blockquote>\n  <p>All declarations in the same scope that refer to the same object or function shall specify compatible types.</p>\n</blockquote>\n\n<p>then, chapter \u00a76.7.6.3, P14,</p>\n\n<blockquote>\n  <p>An identifier list declares only the identifiers of the parameters of the function. An empty\n  list in a function declarator that is part of a definition of that function specifies that the\n  function has no parameters. The empty list in a function declarator that is not part of a\n  definition of that function specifies that no information about the number or types of the\n  parameters is supplied.</p>\n</blockquote>\n\n<p>So, this constitutes a constraint violation and warrant a diagnostic to be emitted.</p>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1504031048, "post_id": 45945867, "comment_id": 78850292, "body": "C99 had the same wording (in 6.7.5.3/14)."}], "tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 11, "last_activity_date": 1504055829, "last_edit_date": 1504055829, "creation_date": 1504030741, "answer_id": 45945867, "question_id": 45945623, "link": "https://stackoverflow.com/questions/45945623/why-does-mismatched-prototype-and-definition-with-empty-argument-list-give-diffe/45945867#45945867", "title": "Why does mismatched prototype and definition with empty argument list give different results in GCC and Clang?", "body": "<p><sub>Disclaimer: I am not a <a href=\"/questions/tagged/language-lawyer\" class=\"post-tag\" title=\"show questions tagged &#39;language-lawyer&#39;\" rel=\"tag\">language-lawyer</a>, but I play one on <a href=\"/questions/tagged/stackoverflow\" class=\"post-tag\" title=\"show questions tagged &#39;stackoverflow&#39;\" rel=\"tag\">stackoverflow</a>.</sub></p>\n\n<p><s>If the compiler does not issue a diagnostic, it would be non-conforming, and could be considered a bug if the compiler claims to be conforming.\n</s></p>\n\n<p>C.2011&sect;6.7.6.3&para;14 (emphasis mine):</p>\n\n<blockquote>\n  <p>An identifier list declares only the identifiers of the parameters of the function. <strong>An empty\n  list in a function declarator that is part of a definition of that function specifies that the\n  function has no parameters.</strong> The empty list in a function declarator that is not part of a\n  definition of that function specifies that no information about the number or types of the\n  parameters is supplied.</p>\n</blockquote>\n\n<p>Thus, the definition of <code>foo</code> specifies no parameters, while the declaration of <code>foo</code> earlier specified two parameters.</p>\n\n<p>C.2011&sect;6.7.6.3&para;15:</p>\n\n<blockquote>\n  <p>For two function types to be compatible, both shall specify compatible return types.<sup>146)</sup>\n  Moreover, the parameter type lists, <strong>if both are present</strong>, shall agree in the number of\n  parameters and in use of the ellipsis terminator; corresponding parameters shall have\n  compatible types.<br>\n  <sub>146) If both function types are \u2018\u2018old style\u2019\u2019, parameter types are not compared.</sub></p>\n</blockquote>\n\n<p><s>Thus, the two declarators of <code>foo</code> are not compatible.</s><br>\nDang! From <a href=\"https://stackoverflow.com/questions/45945623/why-does-mismatched-prototype-and-definition-with-empty-argument-list-give-diffe#comment78858817_45945886\">@hvd's comment</a>:</p>\n\n<blockquote>\n  <p><sup> \n  It's well-established that <code>void foo()</code> does not provide a prototype, even in a definition. <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_317.htm\" rel=\"nofollow noreferrer\">There was a DR that answered this explicitly.</a> The type of <code>foo</code> in that definition is <code>void foo()</code>, not <code>void foo(void)</code>, and <code>void foo()</code> and <code>void foo(int, int)</code> are compatible types. This answer is incorrect.</sup></p>\n</blockquote>\n\n<p>The emphasized part of the text above from the standard is the loophole that allows for the disagreement in number of arguments, but compatible types. Although the function definition specifies a function that takes no arguments, since the parameter type list is actually missing, there is actually no incompatibility between the type of <code>foo</code> in its function prototype and the type of <code>foo</code> in the function definition.</p>\n\n<p>Thus, clang 4.0 seems to have it right, since there is no constraint violation.</p>\n\n<blockquote>\n  <p><sub>My original argument becomes invalid, so editing out that part of my original answer.</sub></p>\n</blockquote>\n\n<hr>\n\n<p>In comments you actually presented the following example:</p>\n\n<pre><code>void foo () {}\n\nint main () { foo(1, 2); return 0; }\n</code></pre>\n\n<p>And asked why the compiler does not complain for this case. This is actually addressed <a href=\"https://stackoverflow.com/q/12643202/315052\">here</a>, but in a nutshell: C.2011 still accepts K&amp;R C function definition syntax. So, while <code>void foo() {}</code> is a definition that takes no arguments, the prototype that is used for argument validation is the same as <code>void foo();</code>, because the empty argument list is parsed as K&amp;R. The modern C syntax to force proper argument checking would be to use <code>void foo(void) {}</code> instead.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 1, "creation_date": 1504052125, "post_id": 45945886, "comment_id": 78858817, "body": "It&#39;s well-established that <code>void foo()</code> does not provide a prototype, even in a definition. <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_317.htm\" rel=\"nofollow noreferrer\">There was a DR that answered this explicitly.</a> The type of <code>foo</code> in that definition is <code>void foo()</code>, not <code>void foo(void)</code>, and <code>void foo()</code> and <code>void foo(int, int)</code> are compatible types. This answer is incorrect."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1504052664, "post_id": 45945886, "comment_id": 78858953, "body": "@hvd: Except there is a declaration with prototype above <code>main</code> for <code>void foo(int, int)</code>. It is the definition of <code>foo</code> that gives an empty argument list. Doesn&#39;t this mean the prototype and definition disagree?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1504052894, "post_id": 45945886, "comment_id": 78858988, "body": "@jxh Yes, the prototype and the definition indeed disagree. It wouldn&#39;t surprise me if that means the code has undefined behaviour. But that&#39;s not what this answer says. This answer says the definition specifies a <i>type</i> not compatible with the earlier declaration, and because of that, a constraint is violated. The type is compatible though."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1504053043, "post_id": 45945886, "comment_id": 78859023, "body": "@hvd: You are a <i>real</i> language lawyer!"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1504053492, "post_id": 45945886, "comment_id": 78859115, "body": "@hvd: Although the standard specifies an empty argument list in the function definition specifies the function has no parameters, you claim that the type of such a function is still one that can takes an unspecified number of parameters. And, you back up this claim by referencing a defect report."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1504081781, "post_id": 45945886, "comment_id": 78868913, "body": "@hvd I agree. I forgot this DR (even if I used it in some of my past SO answers...). I suggest you to write your own answer to this question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 0, "creation_date": 1504087354, "post_id": 45945886, "comment_id": 78872612, "body": "@ouah Thanks, had considered it, but I was already happy with jxh&#39;s edits, will reconsider if I find something to add to that."}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1504112791, "post_id": 45945886, "comment_id": 78891095, "body": "@hvd: Subclause 6.7.6.3/15 contains following sentence: &quot;If one type has a <i>parameter type list</i> and the other type is specified by a function definition that contains a <i>(possibly empty)</i> identifier list, both shall agree in the <i>number of parameters</i> (...)&quot;. It seems, that this is very the same case as presented in question&#39;s code snippet and this implies that both types not compatible, thus constaint is violated (as by 6.7/p4). Do you agree?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1504113700, "post_id": 45945886, "comment_id": 78891610, "body": "@GrzegorzSzpetkowski That&#39;s not a constraint, so a violation is undefined behaviour and a diagnostic is allowed but not required. But good find, it means clang is not wrong for accepting it <i>and</i> GCC is not wrong for rejecting it."}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1504118314, "post_id": 45945886, "comment_id": 78894193, "body": "@hvd: But there is generic constraint in 6.7/p4, that reads &quot;All <i>declarations</i> in the same scope that refer to the same object or function shall specify compatible types.&quot;. Note that it does not say anything about prototype and I think it&#39;s valid to say that old-style definition is also a kind of declaration. The subclause 6.7.6.3/15 defines what function types are compatible and by my previous comment, <code>void foo(int a, int b);</code> and <code>void foo()</code> are not compatible, hence the generic constraint is violated (is it?). Where do you see flaw in my intepretation?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 0, "creation_date": 1504119011, "post_id": 45945886, "comment_id": 78894583, "body": "@GrzegorzSzpetkowski: The idea is that <code>void foo()</code> is not a prototype, it is a function declaration, <i>i.e.</i>, there is a function named <code>foo</code> that returns <code>void</code>. This is not incompatible with the prototype <code>void foo(int, int)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 1, "creation_date": 1504119156, "post_id": 45945886, "comment_id": 78894659, "body": "@GrzegorzSzpetkowski What jxh said. Try <code>void foo(int a, int b); void foo();</code>. But actually, I&#39;m getting unsure now. Although 6.7.6.3p15 has a &quot;shall&quot; outside of a constraint, it starts off as &quot;For two function types to be compatible, both shall specify compatible return types. Moreover, ...&quot; before it gets to your &quot;both shall agree in the number of parameters&quot;, and it could mean that it&#39;s intended to imply that although <code>void foo();</code> and <code>void foo() {}</code> both give <code>foo</code> type <code>void()</code>, only the former is compatible with <code>void foo(int, int);</code>. Making the original answer correct after all."}, {"owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1504120164, "post_id": 45945886, "comment_id": 78895167, "body": "@jxh: The 6.7.6.3/15 requires that second type is a definition (citing: &quot;and the other type is specified by a function definition that contains a (possibly empty) identifier list&quot;). For instance, take <code>void foo(int, int)</code> and <code>void foo() {}</code>. In my opinion: 1) <code>void foo() {}</code> constitutes a function type with empty argument list 2) this type is not compatible with <code>void foo(int, int)</code> declaration because number of parameters does not agree 3) such incompability invokes constraint  6.7p4."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "edited": false, "score": 1, "creation_date": 1504120293, "post_id": 45945886, "comment_id": 78895229, "body": "@GrzegorzSzpetkowski: It is not clear to me that the entirety of 6.7.6.3/15  is required for compatibility. One could read only the first two sentences speaking to compatibility. The rest of the paragraph are merely more semantics. But, I am still not a language lawyer."}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 15, "last_activity_date": 1504081994, "last_edit_date": 1504081994, "creation_date": 1504030838, "answer_id": 45945886, "question_id": 45945623, "link": "https://stackoverflow.com/questions/45945623/why-does-mismatched-prototype-and-definition-with-empty-argument-list-give-diffe/45945886#45945886", "title": "Why does mismatched prototype and definition with empty argument list give different results in GCC and Clang?", "body": "<blockquote>\n  <p>(C11, 6.7p4 Constraints) \"All declarations in the same scope that refer to the same object or function shall specify compatible types\"</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>(C11, 6.7.6.3p14) \"An identifier list declares only the identifiers of the parameters of the function. An empty list in a function declarator that is part of a definition of that function specifies that the function has no parameters. [...]\"</p>\n</blockquote>\n\n<p>My opinion is constraint of 6.7p4 is violated and diagnostic has to be issued.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>as pointed out by <a href=\"https://stackoverflow.com/users/743382/hvd\">@hvd</a> it is actually not correct. 6.7.6.3p14 does not mean <code>void foo() {}</code> provides a prototype for <code>foo</code> as per <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_317.htm\" rel=\"nofollow noreferrer\">DR#317</a>. In that sense, the 6.7p4 constraint is not violated and so clang is right not to complain. </p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504031164, "post_id": 45945947, "comment_id": 78850343, "body": "and some comments - this topic is live online for 15 years probably that void <code>foo(int) and then void foo(){...}</code> is correct and void foo(double)` and then void foo(){...}` is incorrect. But I am not the language lawyer"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 1, "creation_date": 1504031213, "post_id": 45945947, "comment_id": 78850365, "body": "Undefined behavior does not require a diagnostic per se, so this would imply clang is correct."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 1, "creation_date": 1504031379, "post_id": 45945947, "comment_id": 78850441, "body": "@ouah: It would imply that clang is not incorrect. It would be friendlier if it issued a diagnostic."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504031443, "post_id": 45945947, "comment_id": 78850476, "body": "@PeterJ_01: I&#39;m reasonably sure that both are incorrect (undefined behavior)."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1504031470, "post_id": 45945947, "comment_id": 78850492, "body": "@KeithThompson my point here is 6.7p4 enforces the diagnostic contrary to friendlier 6.2.7"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1504031645, "post_id": 45945947, "comment_id": 78850589, "body": "@Keith Thompson even if both are correct I would never do it this way. The question IMO is ridiculous. It should be called: how to push myself into a difficult to debug problems"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504031757, "post_id": 45945947, "comment_id": 78850660, "body": "@PeterJ_01 the question is not ridiculous because if the conclusion is clang has to issue the diagnostic, it means there is a bug in clang"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504031886, "post_id": 45945947, "comment_id": 78850728, "body": "no it is not a bug. Compilers do not have to report UBs. But this is an example of totally silly one - and gcc is right in this case. Someone who writes function in the manner foo() {} should reconsider his approach"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504032179, "post_id": 45945947, "comment_id": 78850892, "body": "@PeterJ_01 but they have to report constraint violation. See my answer."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 1, "creation_date": 1504033279, "post_id": 45945947, "comment_id": 78851458, "body": "Sourav&#39;s  reference to 6.7 P4 is more specific (declarations in the same scope) and so it is that one that counts. The code has a constraint violation and so a diagnostic <i>must</i> be emitted."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 7, "last_activity_date": 1504031069, "creation_date": 1504031069, "answer_id": 45945947, "question_id": 45945623, "link": "https://stackoverflow.com/questions/45945623/why-does-mismatched-prototype-and-definition-with-empty-argument-list-give-diffe/45945947#45945947", "title": "Why does mismatched prototype and definition with empty argument list give different results in GCC and Clang?", "body": "<p>From the C Standard (6.7.6.3 Function declarators (including prototypes))</p>\n\n<blockquote>\n  <p>15 For two function types to be compatible, both shall specify\n  compatible return types.146) Moreover, ... If one type has a parameter\n  type list and the other type is specified by a function definition\n  that contains a (possibly empty) identifier list, both shall agree in\n  the number of parameters, and the type of each prototype parameter\n  shall be compatible with the type that results from the application of\n  the default argument promotions to the type of the corresponding\n  identifier. (In the determination of type compatibility and of a\n  composite type, each parameter declared with function or array type is\n  taken as having the adjusted type and each parameter declared with\n  qualified type is taken as having the unqualified version of its\n  declared type.)</p>\n</blockquote>\n\n<p>And (6.2.7 Compatible type and composite type)</p>\n\n<blockquote>\n  <p>2 All declarations that refer to the same object or function shall\n  have compatible type; otherwise, <strong>the behavior is undefined</strong></p>\n</blockquote>\n\n<p>Thus the shown program in the question has undefined behavior. The compiler may issue a diagnostic message as GCC did.</p>\n"}], "owner": {"reputation": 34922, "user_id": 586873, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/11ba1f932f0af556969448ffba230d9a?s=128&d=identicon&r=PG", "display_name": "Grzegorz Szpetkowski", "link": "https://stackoverflow.com/users/586873/grzegorz-szpetkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1522, "favorite_count": 1, "accepted_answer_id": 45945862, "answer_count": 4, "score": 17, "last_activity_date": 1504081994, "creation_date": 1504029660, "last_edit_date": 1504032516, "question_id": 45945623, "link": "https://stackoverflow.com/questions/45945623/why-does-mismatched-prototype-and-definition-with-empty-argument-list-give-diffe", "title": "Why does mismatched prototype and definition with empty argument list give different results in GCC and Clang?", "body": "<p>Given (simplified) code snippet:</p>\n\n<pre><code>void foo(int a, int b); // declaration with prototype\n\nint main(void)\n{\n    foo(1, 5); // type-checked call (i.e. because of previous prototype)\n    return 0;\n}\n\nvoid foo() // old-style definition (with empty argument list)\n{\n\n}\n</code></pre>\n\n<p>and command-line options (though, as I checked they are not important):</p>\n\n<pre><code>-x c -std=c11 -pedantic -Wall\n</code></pre>\n\n<p>gcc 7.2 fails to compile it with following error message:</p>\n\n<blockquote>\n  <p>error: number of arguments doesn't match prototype</p>\n</blockquote>\n\n<p>while clang 4.0 translates it without any complaints.</p>\n\n<p>Which implementation is correct according to C Standard? Is it valid that old-style definition \"cancels\" previous prototype?</p>\n"}, {"tags": ["c", "wchar-t", "specifier"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504027777, "post_id": 45944875, "comment_id": 78848480, "body": "What is the <code>ls</code> doing in <code>&quot;%7[^\\n]ls&quot;</code>?  Try <code>while (wscanf(L&quot;%7[^\\n]&quot;, str) == 1)</code>  and then you need some code to consume the <code>&#39;\\n&#39;</code>."}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504027923, "post_id": 45944875, "comment_id": 78848554, "body": "@chux That all format specifiers have the same meaning as in scanf; therefore, %lc shall be used to read a wide character (and not %c), as well as %ls shall be used for wide strings (and not %s). Source: <a href=\"http://www.cplusplus.com/reference/cwchar/wscanf/\" rel=\"nofollow noreferrer\">C++ Ref</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504028052, "post_id": 45944875, "comment_id": 78848626, "body": "The reference does not suggest appending <code>ls</code> after <code>&quot;%[something]&quot;</code>  <code>&quot;%[...]&quot;</code> and <code>&quot;%s&quot;</code> are different specifiers."}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504028168, "post_id": 45944875, "comment_id": 78848700, "body": "@chux <code>[^characters]</code> is called a specifier, and according to that webpage, appending <code>[^\\n]</code> before <code>ls</code> shall have the same meaning as in <code>scanf</code>. <code>scanf(&quot;%[^\\n]s&quot;, str);</code> is a well-known solution to cope with reserving whitespaces, so <code>wscanf</code> should also work as expected."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504028356, "post_id": 45944875, "comment_id": 78848824, "body": "Try <code>while (wscanf(L&quot;%7[^\\n]&quot;, str) != EOF)  { wscanf(L&quot;%*1[\\n]&quot;); if (ferror(stdin)  ...</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1504028407, "post_id": 45944875, "comment_id": 78848849, "body": "<code>scanf(&quot;%[^\\n]s&quot;, str);</code> is a well known and <i>incorrect</i> solution.  The <code>s</code> is not needed, buffer over-run and <code>\\n</code> is never consumed, which leads to problems here."}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504028553, "post_id": 45944875, "comment_id": 78848934, "body": "@chux That doesn&#39;t work. <code>scanf(&quot;%*[^\\n]s&quot;, len - 1, str);</code> is better to avoid memory corruption. You can specify the maximum length that <code>scanf</code> is able to read."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504028634, "post_id": 45944875, "comment_id": 78848977, "body": "<code>scanf(&quot;%*[^\\n]s&quot;, len - 1, str);</code> confuses the <code>printf</code> and <code>scanf</code> specifiers.  With <code>scanf()</code> , <code>*</code> directs to not save.  The C spec calls it the &quot;assignment-suppressing character&quot;"}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504028797, "post_id": 45944875, "comment_id": 78849067, "body": "@chux The problem is that <code>wscanf</code> is one of the proper way to read wide characters. <code>fread</code> is safer, but I don&#39;t want to cope with the unicode format. Do you have any proper way to read wide characters and also not ignore whitespaces?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504028970, "post_id": 45944875, "comment_id": 78849167, "body": "Yes <a href=\"https://stackoverflow.com/questions/45944875/dont-ignore-whitespaces-when-using-wscanf-for-utf-8?noredirect=1#comment78848824_45944875\">this is close</a> as long as no lines are blank.  Or better, use <code>fgetws()</code>."}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504029242, "post_id": 45944875, "comment_id": 78849347, "body": "@chux The <a href=\"http://imgur.com/a/jRG1g\" rel=\"nofollow noreferrer\">result</a> is garbled after applying your suggestions even if no lines are blank."}, {"owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504029749, "post_id": 45944875, "comment_id": 78849635, "body": "@chux Great. <code>fgetws</code> works. Thanks a lot."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1504032011, "post_id": 45944875, "comment_id": 78850797, "body": "@KevinDong - do notice that <code>fgetws</code> might <b>not</b> use UTF-8 (on linux it often does use UTF-8, see the <a href=\"https://stackoverflow.com/questions/30479607/explain-the-effects-of-export-lang-lc-ctype-lc-all\"><code>LC_CTYPE</code></a> environment variable). On the other hand, UTF-8 characters use variable length (between 1 and 4 bytes) and white space is encoded the same as ASCII (1 byte, same ASCII value), so you should be able to safely ignore encoding when processing for white space."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1504032473, "last_edit_date": 1504032473, "creation_date": 1504032057, "answer_id": 45946193, "question_id": 45944875, "link": "https://stackoverflow.com/questions/45944875/dont-ignore-whitespaces-when-using-wscanf-for-utf-8/45946193#45946193", "title": "Don&#39;t ignore whitespaces when using wscanf for UTF-8", "body": "<blockquote>\n  <p>Don't ignore whitespaces ...<br>\n  ... trying to read wide characters into an array of wchar_t</p>\n</blockquote>\n\n<p>To read a line of <em>text</em> (all characters, and white-spaces up to <code>'\\n'</code>) into a wide character <em>string</em>, use <code>fgetws()</code>;</p>\n\n<pre><code>#define STR_SIZE 8\nwchar_t str[STR_SIZE];\n\nwhile (fgetws(str, STR_SIZE, str)) {\n  // lop off the potential \\n if desired\n  size_t len = wcslen(str);\n  if (len &gt; 0 &amp;&amp; str[len-1] == L'\\n') {\n    str[--len] = L'\\0';\n  }\n  ...\n}\n</code></pre>\n"}], "owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 45946193, "answer_count": 1, "score": 1, "last_activity_date": 1504032473, "creation_date": 1504027199, "last_edit_date": 1504027533, "question_id": 45944875, "link": "https://stackoverflow.com/questions/45944875/dont-ignore-whitespaces-when-using-wscanf-for-utf-8", "title": "Don&#39;t ignore whitespaces when using wscanf for UTF-8", "body": "<p>I am trying to read wide charaters into an array of <code>wchar_t</code> from stdin. However, the negated scanset specifier (<code>[^characters]</code>) for <code>ls</code> does not work preperly as  expected.</p>\n\n<p>The goal is that I want every whitespace read into <code>str</code> instead of being ignored. Hence, <code>[^\\n]</code> is what I've tried, but with no luck, the result is frustrating and keeps printing garbled text to stdout. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;wchar.h&gt;\n#include &lt;wctype.h&gt;\n#include &lt;locale.h&gt;\n\nint main(void)\n{\n    wchar_t str[8];\n\n    if (setlocale(LC_ALL, \"en_US.UTF-8\") == NULL)  {\n        fprintf(stderr, \"Failed to set locale LC_ALL = en_US.UTF-8.\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    // correct (but not what I want)\n    // whitespaces and EOLs are ignored\n    // while (wscanf(L\"%7ls\", str) != EOF)  {\n    //     wprintf(L\"%ls\", str);\n    // }\n\n    // incorrect\n    // whitespaces (except EOLs) are properly read into str (what I want)\n    // input: \u4e0d\u8981\u5ffd\u7565\u767d\u7a7a\u683c (for instance)\n    // output: endless loop (garbled text)\n    while (wscanf(L\"%7[^\\n]ls\", str) != EOF)  {\n        if (ferror(stdin) &amp;&amp; errno == EILSEQ)  {\n            fprintf(stderr, \"Encountered an invalid wide character.\\n\");\n            exit(EXIT_FAILURE);\n        }\n        wprintf(L\"%ls\", str);\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "printf", "c-preprocessor", "variadic-macros"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1504026630, "post_id": 45944705, "comment_id": 78847885, "body": "For starters, why not just <code>printf(&quot;%u ms &quot; fmt, p_time_now, __VA_ARGS__);</code>?"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1504026756, "post_id": 45944705, "comment_id": 78847961, "body": "Yeah, deleted comment.  I see what you are doing. The &quot;atomic&quot; printf statement made me raise an eyebrow.  That means something different to me :)"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1504027058, "post_id": 45944705, "comment_id": 78848084, "body": "@MichaelDorgan: Sure, it&#39;ll take a bit longer until the OP will realize that no such thing exists."}, {"owner": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504027096, "post_id": 45944705, "comment_id": 78848104, "body": "Hold on, I added an extra comma. Testing now"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1504027379, "post_id": 45944705, "comment_id": 78848256, "body": "@&#216;yvindTeig: <a href=\"https://wandbox.org/permlink/50Kdj0Jwgib6QgHV\" rel=\"nofollow noreferrer\">works for me</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504027446, "post_id": 45944705, "comment_id": 78848299, "body": "@&#216;yvindTeig Did you code a <code>,</code> between <code>&quot;%u ms &quot;</code> and <code>fmt</code>?"}, {"owner": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504027627, "post_id": 45944705, "comment_id": 78848385, "body": "THANKS A LOT! It works and is atomic! I didn&#39;t see that combination. What&#39;s the explanation behind not any comma before fmt?"}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1504027752, "post_id": 45944705, "comment_id": 78848457, "body": "why to you need <code>do{...}while(0)</code> there? <code>{...}</code> would be sufficient."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "edited": false, "score": 0, "creation_date": 1504028535, "post_id": 45944705, "comment_id": 78848917, "body": "@&#216;yvindTeig when you put two string literals back-to-back, the compiler combines them during the pre-processor pass. this is called string concatenation. more details <a href=\"https://stackoverflow.com/a/12120988/3961271\">here</a>."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "reply_to_user": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1504028680, "post_id": 45944705, "comment_id": 78849006, "body": "@Serge do..while wrapped around a multi-statement pre-processor macro is considered best practice. if you just used braces, you would need to omit the semicolon when invoking the macro which leads to inconsistent style."}], "answers": [{"comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1504027011, "post_id": 45944772, "comment_id": 78848063, "body": "I&#39;d also remove the <code>p_time_now</code> temp var - it doesn&#39;t do anything and could cause warnings if printf() were ever redefined on a release build."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504027387, "post_id": 45944772, "comment_id": 78848262, "body": "String concatenation and token pasting won&#39;t work if the passed-in format isn&#39;t a string literal."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1504027456, "post_id": 45944772, "comment_id": 78848304, "body": "@AndrewHenle: That&#39;s true, but format strings should probably never ever be anything other than literals."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1504027462, "post_id": 45944772, "comment_id": 78848308, "body": "@AndrewHenle that&#39;s why my answer says &quot;This only works if you call the macro with a string literal as the format string.&quot;"}, {"owner": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504028892, "post_id": 45944772, "comment_id": 78849121, "body": "Yes, I konw that. But it&#39;s ok to use debug_tcprintf (&quot;%s&quot;, &quot;Hello World\\n&quot;); once I got used to it."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "reply_to_user": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504029002, "post_id": 45944772, "comment_id": 78849186, "body": "@&#216;yvindTeig that isn&#39;t necessary, that&#39;s what the token pasting (the <code>##</code> operator) is for. you can simply call <code>debug_tcprintf (&quot;Hello World\\n&quot;);</code>."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "reply_to_user": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504029116, "post_id": 45944772, "comment_id": 78849262, "body": "@&#216;yvindTeig the token pasting accounts for the possibility of the macro being called with or without the additional variadic arguments."}, {"owner": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504029329, "post_id": 45944772, "comment_id": 78849391, "body": "The XC compiler causes &quot;warning: Less than necessary 2 argument(s) in macro call &quot;debug_tprintf2(&quot;Hello world\\n&quot;)&quot;&quot; if I do the single &quot;Hello World&quot;"}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "reply_to_user": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504029392, "post_id": 45944772, "comment_id": 78849435, "body": "@&#216;yvindTeig ah, in that case, it is possible that your compiler doesn&#39;t fully implement token pasting."}, {"owner": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504029465, "post_id": 45944772, "comment_id": 78849482, "body": "Interesting. I&#39;ll take this to theXCore Exchange group and ask there. Back later"}, {"owner": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504033530, "post_id": 45944772, "comment_id": 78851591, "body": "The XC compiler (in an .xc file) does not accept the ##__VA_ARGS__ and issues error: Not a valid preprocessing token &quot;,&quot;init]\\n&quot;&quot; That&#39;s why I didn&#39;t include it initially. However, when it compiles C (in a .c file) it is being accepted. So to make it general I&#39;d have to take the lower route."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1504042365, "post_id": 45944772, "comment_id": 78855937, "body": "There&#39;s a problem with <code>__VA_ARGS__</code>: You always get the comma before, even if you have <i>no</i> variable arguments. There are currently no portable ways to have an optional comma."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1504061938, "post_id": 45944772, "comment_id": 78860838, "body": "@WoodrowBarlow FYI, in a standard C Preprocessor, the macro <code>debug_tcprintf(fmt, ...)</code> requires <i>two arguments</i>; <code>...</code> requires <i>at least one</i> argument.  Furthermore, in a standard C Preprocessor, <code>, ## __VA_ARGS__</code> usually isn&#39;t valid as the paste usually doesn&#39;t result in a valid token.  What you&#39;re actually using is a gnu cpp <i>extension</i> that allows one less argument to be taken, and a special meaning to be given to <code>, ## __VA_ARGS__</code> that in such calls results in the comma being removed."}, {"owner": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "edited": false, "score": 0, "creation_date": 1504092427, "post_id": 45944772, "comment_id": 78876149, "body": "Thanks to all of you!"}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1504108043, "post_id": 45944772, "comment_id": 78888266, "body": "@KerrekSB &quot;There are currently no portable ways to have an optional comma.&quot;  That&#39;s not quite true.  You can: (a) define the macro as <code>debug_tcprintf(...)</code>, detect whether there&#39;s one or more than one arguments (up to some n), in the former case use the one without a comma, and in the latter case use the rest with a comma; that approach requires multiple macros.  Or (b) you can just use <code>debug_tcprintf(fmt, extra)</code>, <i>use</i> it like <code>debug_tcprintf(&quot;%d%s&quot;,(,a,b))</code> or <code>debug_tcprintf(&quot;---&quot;,())</code>, and use supporting macros to expand <code>extra</code>."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1504108468, "post_id": 45944772, "comment_id": 78888512, "body": "...here it&#39;s probably not worth it; simply using an idiom <code>debug_tcprintf(&quot;---&quot;,0)</code> would pass an extra argument in that&#39;s ignored, but that&#39;s safe."}], "tags": [], "owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "is_accepted": true, "score": 2, "last_activity_date": 1504131943, "last_edit_date": 1504131943, "creation_date": 1504026810, "answer_id": 45944772, "question_id": 45944705, "link": "https://stackoverflow.com/questions/45944705/how-do-i-use-variadic-arguments-with-printf-in-a-macro/45944772#45944772", "title": "How do I use variadic arguments with printf in a macro?", "body": "<p>You need to use string concatenation and <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Concatenation.html\" rel=\"nofollow noreferrer\">token pasting</a>. Notice in the snippet below there is no comma after the first string literal -- this is intentional.</p>\n\n<pre><code>#define debug_tcprintf(fmt, ...) do { \\\n    if (DEBUG_PRINT_HTTPD) { \\\n        unsigned p_time_now = get_time_now (); \\\n        printf (\"%u ms \" fmt, p_time_now, ##__VA_ARGS__); \\\n    } \\\n} while (0)\n</code></pre>\n\n<p>The string concatenation allows you to prepend the <code>\"%u ms \"</code> portion onto the supplied format string. Token pasting (the <code>##</code> operator) accounts for the possibility of your macro being invoked with or without additional variadic arguments (beyond just the format string).</p>\n\n<p>This only works if you call the macro with a string literal as the format string.</p>\n\n<hr>\n\n<p>Addendum: The way token-pasting is used in this example is actually a gcc extension to the standard C pre-processor. If you are not using the gcc compiler, you may need to omit the <code>##</code> operator. The downside to this is that you then cannot call your macro with only one argument; for example, <code>debug_tcprintf (\"hello world\")</code> will not work. A simple workaround is to use <code>debug_tcprintf (\"%s\", \"hello world\")</code> in such a scenario.</p>\n"}], "owner": {"reputation": 111, "user_id": 4041462, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-twN9vEnkMuY/AAAAAAAAAAI/AAAAAAAAANM/Miz3besBfao/photo.jpg?sz=128", "display_name": "&#216;yvind Teig", "link": "https://stackoverflow.com/users/4041462/%c3%98yvind-teig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 1, "accepted_answer_id": 45944772, "answer_count": 1, "score": 6, "last_activity_date": 1504131943, "creation_date": 1504026489, "last_edit_date": 1504037560, "question_id": 45944705, "link": "https://stackoverflow.com/questions/45944705/how-do-i-use-variadic-arguments-with-printf-in-a-macro", "title": "How do I use variadic arguments with printf in a macro?", "body": "<p>I have found no way to merge the first printf into the second:</p>\n\n<pre><code>unsigned get_time_now(void) {return 1;}\n#define DEBUG_PRINT 1\n#define debug_tcprintf(fmt, ...) do { \\\n            if (DEBUG_PRINT) { \\\n                unsigned p_time_now = get_time_now(); \\\n                printf (\"%u ms \", p_time_now); \\\n                printf(fmt, __VA_ARGS__); \\\n            } \\\n        } while (0)\n</code></pre>\n\n<p>I need to get this done to get an atomic debug_tcprintf. The macro above has been taken from <a href=\"https://stackoverflow.com/questions/1644868/c-define-macro-for-debug-printing\">this Stack Overflow question</a>. </p>\n\n<p>I am doing code in XC that runs on an XMOS multi-logical-core processor. It compiles XC, C and C++, but the code example is from a C code part. It is similar for XC except that it has a timer defined in the language.</p>\n\n<p>If it's not possible to merge the two in one printf, an option may perhaps be to create a string and use sprintf instead? I'd rather not, since such an array might easily overflow.</p>\n"}, {"tags": ["c", "string", "struct", "strcpy"], "answers": [{"comments": [{"owner": {"reputation": 2461, "user_id": 2405914, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/VoFWS.jpg?s=128&g=1", "display_name": "Leonardo Alves Machado", "link": "https://stackoverflow.com/users/2405914/leonardo-alves-machado"}, "reply_to_user": {"reputation": 21, "user_id": 8178598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/714528aec201eae1f5e26c7b867ddbdb?s=128&d=identicon&r=PG&f=1", "display_name": "Speck", "link": "https://stackoverflow.com/users/8178598/speck"}, "edited": false, "score": 0, "creation_date": 1504026404, "post_id": 45944114, "comment_id": 78847772, "body": "@Speck if this is the answer you were expecting, you should accept it."}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": true, "score": 1, "last_activity_date": 1504024184, "creation_date": 1504024184, "answer_id": 45944114, "question_id": 45944059, "link": "https://stackoverflow.com/questions/45944059/copying-a-string-in-an-array-element-of-a-struct/45944114#45944114", "title": "copying a string in an array element of a struct", "body": "<p>You're writing past the end of your sons array;</p>\n\n<p>Should be <code>for (i = 0; i &lt; 1024; i++) {</code> since there are only 1024 elements in the array 0...1023.</p>\n"}], "owner": {"reputation": 21, "user_id": 8178598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/714528aec201eae1f5e26c7b867ddbdb?s=128&d=identicon&r=PG&f=1", "display_name": "Speck", "link": "https://stackoverflow.com/users/8178598/speck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 45944114, "answer_count": 1, "score": -1, "last_activity_date": 1504024184, "creation_date": 1504023962, "question_id": 45944059, "link": "https://stackoverflow.com/questions/45944059/copying-a-string-in-an-array-element-of-a-struct", "title": "copying a string in an array element of a struct", "body": "<p>I have the following problem: I made this node structure</p>\n\n<pre><code>typedef struct NODE{\n    struct NODE *sons[1024];             //this array will be used to store  children pointers\n    char name[255];\n    int leaf;                   \n\n}NODE;\n</code></pre>\n\n<p>and this function to create a new node with a given name. The problem is that the first printf shows the right name, the second one doesn't. It seems like the for loop erases the name and I can't explain myself why... </p>\n\n<pre><code>NODE *AllocateNewNode( char *inputname) {\n    NODE *newnode;\n    newnode = (NODE *)malloc(sizeof(NODE));\n\n\n\n    memset(newnode-&gt;name, '\\0', sizeof(newnode-&gt;name));\n\n\n    strcpy(newnode-&gt;name, inputname);    \n\n    printf(\"node %s created\\n\", newnode-&gt;name);   //right name in the output\n\n\n    int i = 0;\n    for (i = 0; i &lt;= 1024; i++) {\n\n        newnode-&gt;sons[i] = NULL;\n    }\n\n    newnode-&gt;leaf = 1;\n\n\n    printf(\"node %s created\\n\", newnode-&gt;name);        //no name in the output\n\n    return newnode;\n}\n</code></pre>\n"}, {"tags": ["c", "opengl", "sdl-2"], "comments": [{"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 3, "creation_date": 1504023142, "post_id": 45943700, "comment_id": 78845934, "body": "Why are you calling <code>SDL_CreateWindow()</code> <i>before</i> <code>SDL_Init()</code>?"}, {"owner": {"reputation": 1778, "user_id": 2440728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1fWyQ.jpg?s=128&g=1", "display_name": "VuVirt", "link": "https://stackoverflow.com/users/2440728/vuvirt"}, "edited": false, "score": 0, "creation_date": 1504025181, "post_id": 45943700, "comment_id": 78847167, "body": "Are your video card drivers downloaded from the vendor&#39;s site (NVidia, AMD) and up to date? You cannot use hardware OpenGL acceleration with the generic MS drivers."}, {"owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "edited": false, "score": 0, "creation_date": 1504028209, "post_id": 45943700, "comment_id": 78848723, "body": "What happens when you use <code>SDL_GetNumRenderDrivers()</code> and <code>SDL_GetRendererInfo()</code> just before <code>SDL_CreateRenderer()</code> to dump the <code>SDL_RendererInfo::name</code> value for each renderer driver?"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 3926213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef9a8052b9ea5ee5a8ec064e77b4d928?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/3926213/garrett"}, "is_accepted": false, "score": 0, "last_activity_date": 1504037309, "last_edit_date": 1504037309, "creation_date": 1504032752, "answer_id": 45946397, "question_id": 45943700, "link": "https://stackoverflow.com/questions/45943700/couldnt-find-matching-render-driver-from-sdl-createrenderer/45946397#45946397", "title": "&quot;Couldn&#39;t find matching render driver!&quot; from SDL_CreateRenderer()?", "body": "<p>So I did something dumb with my code! Of course &lt;_&lt;</p>\n\n<p>I changed my <code>InitSDL_Environment()</code> function around, and it worked. I moved the <code>SDL_CreateWindow</code> function down below the <code>SDL_Init(SDL_INIT_VIDEO)</code> portion. So Initialize SDL Video, <strong>then</strong> create the window. Awesome!</p>\n\n<pre><code>// Initialize SDL resources\nint InitSDL_Environment(){\n    // Video Engine\n    if(SDL_Init(SDL_INIT_VIDEO) &lt; 0){\n        printf( \"SDL Video Engine could not be initialized! SDL Error: %s\\n\", SDL_GetError() );\n        return 0;\n    }\n    // Image Formats\n    int imgFlags = IMG_INIT_PNG;\n    if(!(IMG_Init(imgFlags) &amp; imgFlags)){\n        printf(\"SDL Image Formats could not be initialized! SDL_image Error: %s\\n\", IMG_GetError());\n        return 0;\n    }\n    // Window\n    Window = SDL_CreateWindow(\"UML Prototype\", SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, SCREEN_WIDTH, SCREEN_HEIGHT, SDL_WINDOW_SHOWN);\n    if(Window == NULL){\n        printf( \"Window could not be created! SDL_Error: %s\\n\", SDL_GetError() );\n        SDL_Quit();\n        return 0;\n    }\n    // Graphics Renderer\n    Graphic_Renderer = SDL_CreateRenderer(Window, -1, SDL_RENDERER_ACCELERATED);\n    if(Graphic_Renderer == NULL){\n        printf(\"Graphics renderer could not be created! SDL Error: %s\\n\", SDL_GetError());\n        return 0;\n    }\n    SDL_SetRenderDrawColor(Graphic_Renderer, 0xFF, 0xFF, 0xFF, 0xFF);\n    // Return Success\n    return 1;\n}\n</code></pre>\n\n<p>The comments brought up three main points:</p>\n\n<ol>\n<li>SDL Textures require computers to have a graphics card &amp; up-to-date drivers for them, which may need to be updated manually.</li>\n<li>SDL Video needs to be initialized before a window can be created</li>\n<li>The functions <code>SDL_GetNumRenderDrivers()</code> and <code>SDL_GetRendererInfo()</code> can be used to find out information about available cards and trouble-shoot this error.</li>\n</ol>\n\n<p>Thanks commentators! This was a huge help.</p>\n"}], "owner": {"reputation": 23, "user_id": 3926213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef9a8052b9ea5ee5a8ec064e77b4d928?s=128&d=identicon&r=PG&f=1", "display_name": "Garrett", "link": "https://stackoverflow.com/users/3926213/garrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504037309, "creation_date": 1504022779, "last_edit_date": 1504028092, "question_id": 45943700, "link": "https://stackoverflow.com/questions/45943700/couldnt-find-matching-render-driver-from-sdl-createrenderer", "title": "&quot;Couldn&#39;t find matching render driver!&quot; from SDL_CreateRenderer()?", "body": "<p>I came across this error when running my SDL program. It compiled just fine, but the window opened up for a brief moment then closed.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>//Using SDL and standard IO\n#include &lt;SDL.h&gt;\n#include &lt;SDL_image.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n// SDL Main Resources\nconst int SCREEN_WIDTH = 640;\nconst int SCREEN_HEIGHT = 480;\nSDL_Window* Window = NULL;\nSDL_Texture* Canvas = NULL;\nSDL_Renderer* Graphic_Renderer = NULL;\nSDL_Event Event;\n\n// Initialize SDL resources\nint InitSDL_Environment(){\n    // Window\n    Window = SDL_CreateWindow(\"UML Prototype\", SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, SCREEN_WIDTH, SCREEN_HEIGHT, SDL_WINDOW_SHOWN);\n    if(Window == NULL){\n        printf( \"Window could not be created! SDL_Error: %s\\n\", SDL_GetError() );\n        SDL_Quit();\n        return 0;\n    }\n    // Video Engine\n    if(SDL_Init(SDL_INIT_VIDEO) &lt; 0){\n        printf( \"SDL Video Engine could not be initialized! SDL Error: %s\\n\", SDL_GetError() );\n        return 0;\n    }\n    // Image Formats\n    int imgFlags = IMG_INIT_PNG;\n    if(!(IMG_Init(imgFlags) &amp; imgFlags)){\n        printf(\"SDL Image Formats could not be initialized! SDL_image Error: %s\\n\", IMG_GetError());\n        return 0;\n    }\n    // Graphics Renderer\n    Graphic_Renderer = SDL_CreateRenderer(Window, -1, SDL_RENDERER_ACCELERATED);\n    if(Graphic_Renderer == NULL){\n        printf(\"Graphics renderer could not be created! SDL Error: %s\\n\", SDL_GetError());\n        return 0;\n    }\n    SDL_SetRenderDrawColor(Graphic_Renderer, 0xFF, 0xFF, 0xFF, 0xFF);\n    // Return Success\n    return 1;\n}\n\n// Load image from file\nSDL_Texture* SDL_LoadTexture(char* src){\n    SDL_Texture* texture = NULL;\n    SDL_Surface* loadData = IMG_Load(src);\n    if(!loadData){\n        printf(\"Image \\\"%s\\\" could not be loaded! SDL_image ERROR: %s\\n\", src, IMG_GetError());\n        return NULL;\n    }\n    texture = SDL_CreateTextureFromSurface(Graphic_Renderer, loadData);\n    if(!texture){\n        printf(\"Image \\\"%s!\\\" could not be processed! SDL Error: %s\\n\", src, SDL_GetError());\n    }\n    SDL_FreeSurface(loadData);\n    return texture;\n}\n\nint main( int argc, char* args[] )\n{   \n    // Load SDL Resources\n    if(!InitSDL_Environment()){return 1;}\n    SDL_Texture* image = SDL_LoadTexture(\"Duck.png\");\n    if(image == NULL){\n        printf(\"Image could not be found! SDL_Error: $s\\n\", SDL_GetError());\n        return 2;\n    }\n    SDL_Rect sign;\n    sign.x = 40;\n    sign.y = 31;\n    sign.w = 300;\n    sign.h = 300;\n\n    // Main loop\n    for(;;){\n        // Update screen\n        SDL_RenderClear(Graphic_Renderer);\n        SDL_RenderCopy(Graphic_Renderer, image, NULL, NULL);\n        SDL_RenderPresent(Graphic_Renderer);\n\n        // Event handling\n        SDL_PollEvent(&amp;Event);\n        if(Event.type == SDL_QUIT){\n            SDL_DestroyWindow(Window);\n            SDL_Quit();\n            return 0;\n        }\n    }\n}\n</code></pre>\n\n<p>When I adjusted the batch file to post program errors to the console window, it read <code>Graphics renderer could not be created! SDL Error: Couldn't find matching render driver</code>, pointing right to the <code>Graphic_Renderer = SDL_CreateRenderer...</code> line in my <code>InitSDL_Environment()</code> function.</p>\n\n<p>As you can see, the first bit of that error is my own making, and the last bit was generated by <code>SDL_GetError()</code>, so it's an issue that SDL recognizes.</p>\n\n<p>I found <a href=\"https://forums.libsdl.org/viewtopic.php?p=37966\" rel=\"nofollow noreferrer\">this forum post</a> about the same basic issue where everyone suggested downloading OpenGL libraries. From there, I searched and found <a href=\"https://www.opengl.org/sdk/libs/\" rel=\"nofollow noreferrer\">this link</a>.  No links on that page seemed to lead to anything I could download, and it became progressively ambiguous what OpenGL libraries to download, search for, or if it will even solve the issue. That forum post is four years old after all.</p>\n\n<p>If it's an OpenGL problem with the SDL libraries, where exactly would I get the OpenGL libraries, and which ones should I download?  Did I just do something dumb with my code?</p>\n"}, {"tags": ["c", "raspbian", "raspberry-pi3", "netbeans-8", "dbus"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 1315288, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e514c1498d9e57a75b881aafc3671d62?s=128&d=identicon&r=PG", "display_name": "Dan_R", "link": "https://stackoverflow.com/users/1315288/dan-r"}, "edited": false, "score": 0, "creation_date": 1504126811, "post_id": 45944050, "comment_id": 78898501, "body": "Thanks for your reply. I have followed Gilles&#39; answer in the link you have provided. and also installed XQuartz on the client mac. Please see the  updates in my main question. How may i set the $DISPLAY environment correctly in my NetBeans project so that each time netbeans makes an SSH connection to the remote Pi, it correctly sets a DISPLAY? Many thanks."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 171, "user_id": 1315288, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e514c1498d9e57a75b881aafc3671d62?s=128&d=identicon&r=PG", "display_name": "Dan_R", "link": "https://stackoverflow.com/users/1315288/dan-r"}, "edited": false, "score": 0, "creation_date": 1504127352, "post_id": 45944050, "comment_id": 78898715, "body": "@Dan_R If you have a new question please ask a new question."}, {"owner": {"reputation": 171, "user_id": 1315288, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e514c1498d9e57a75b881aafc3671d62?s=128&d=identicon&r=PG", "display_name": "Dan_R", "link": "https://stackoverflow.com/users/1315288/dan-r"}, "edited": false, "score": 0, "creation_date": 1504553486, "post_id": 45944050, "comment_id": 79046398, "body": "Apologies, you are correct... I have raised a new question here: [link] (<a href=\"https://stackoverflow.com/q/46043094/1315288\">stackoverflow.com/q/46043094/1315288</a>)"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1504024328, "last_edit_date": 1504024328, "creation_date": 1504023938, "answer_id": 45944050, "question_id": 45943505, "link": "https://stackoverflow.com/questions/45943505/unable-to-autolaunch-a-dbus-daemon-without-a-display-for-x11-netbeans-pi-as-r/45944050#45944050", "title": "Unable to autolaunch a dbus-daemon without a $DISPLAY for X11. NetBeans. Pi as remote host", "body": "<p>Autolaunch of dbus-daemon only works when under an X11 session. It is otherwise disabled because there's no way for different applications to establish a common instance of the dbus daemon.</p>\n\n<p>If you want to run a dbus daemon on your pi box independently of X11, you probably should configure it to launch the dbus daemon on startup, and export the bus address in \nDBUS_SESSION_BUS_ADDRESS environment variable.</p>\n\n<p>For more info see <a href=\"https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=690530\" rel=\"nofollow noreferrer\">https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=690530</a></p>\n\n<p>If on the other hand you want to use your remote X session, you need to fix your misconfigured X11 forwarding such that the DISPLAY environment variable is set correctly when you ssh into the Pi. See e.g <a href=\"https://unix.stackexchange.com/questions/12755/how-to-forward-x-over-ssh-to-run-graphics-applications-remotely\">https://unix.stackexchange.com/questions/12755/how-to-forward-x-over-ssh-to-run-graphics-applications-remotely</a> .</p>\n"}], "owner": {"reputation": 171, "user_id": 1315288, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e514c1498d9e57a75b881aafc3671d62?s=128&d=identicon&r=PG", "display_name": "Dan_R", "link": "https://stackoverflow.com/users/1315288/dan-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37825, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1604517995, "creation_date": 1504022093, "last_edit_date": 1604517995, "question_id": 45943505, "link": "https://stackoverflow.com/questions/45943505/unable-to-autolaunch-a-dbus-daemon-without-a-display-for-x11-netbeans-pi-as-r", "title": "Unable to autolaunch a dbus-daemon without a $DISPLAY for X11. NetBeans. Pi as remote host", "body": "<p>I am trying to run the following example code using my NetBeans IDE:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;dbus/dbus.h&gt;\n \nint main() {\n    DBusConnection *connection = NULL;\n    DBusError error;\n    char buffer[1024];\n \n    dbus_error_init(&amp;error);\n    connection = dbus_bus_get(DBUS_BUS_SESSION, &amp;error);\n    if (dbus_error_is_set(&amp;error)) {\n        fprintf(stderr, &quot;%s&quot;, error.message);\n        abort();\n    }\n \n    puts(&quot;This is my unique name&quot;);\n    puts(dbus_bus_get_unique_name(connection));\n    fgets(buffer, sizeof(buffer), stdin);\n     \n    return 0;\n}\n</code></pre>\n<p>From an excellent tutorial:\n<a href=\"https://leonardoce.wordpress.com/2015/03/11/dbus-tutorial-using-the-low-level-api/\" rel=\"nofollow noreferrer\">DBUS TUTORIAL USING THE LOW-LEVEL API</a></p>\n<p>I have my headless Pi setup for SSH and have installed all the necessary libraries for dbus development.</p>\n<p>however, when running the program in Netbeans I receive the following error</p>\n<p>Unable to autolaunch a dbus-daemon without a $DISPLAY for X11</p>\n<p><code>/usr/bin/dbus-launch</code> terminated abnormally with the following error: Autolaunch error: X11 initialization failed.</p>\n<p>note that i have X11 forwarding enabled in my remote host properties on Netbeans</p>\n<p>I can see that, if I SSH into the Pi myself and</p>\n<pre><code>echo $DISPLAY\n</code></pre>\n<p>this returns nothing, empty.</p>\n<p>So far, I have tried:</p>\n<pre><code>in /etc/ssh/sshd_config \nX11Forwarding yes\nX11DisplayOffset 10\nX11UseLocalhost no\nAllowTcpForwarding yes\n</code></pre>\n<p>did not work.</p>\n<p>I tried setting a run environment variable to</p>\n<pre><code>DISPLAY export DISPLAY=$HOSTNAME:0.0\n\n0x212d0 &quot;org.freedesktop.DBus.Error.Spawn.ExecFailed&quot;\n0x21fe8 &quot;/usr/bin/dbus-launch terminated abnormally with the following error: Autolaunch error: X11 initialization failed.\\\\n&quot;\n</code></pre>\n<p>didn\u2019t work.</p>\n<p>and tried</p>\n<pre><code>In /etc/ssh/ssh_config\nForwardX11 yes\n</code></pre>\n<p>did not work.</p>\n<p>Is it a case of getting my Pi setup for X11 or configuring my Netbeans environment to run the program with certain parameters?</p>\n<p><strong>update 30 Aug 2017:</strong></p>\n<p>I did a fresh install of Debian and followed Gilles' answer:</p>\n<p><a href=\"https://unix.stackexchange.com/questions/12755/how-to-forward-x-over-ssh-to-run-graphics-applications-remotely\">https://unix.stackexchange.com/questions/12755/how-to-forward-x-over-ssh-to-run-graphics-applications-remotely</a> ...</p>\n<p>I can confirm:</p>\n<pre><code>in /etc/ssh/sshd_config\nX11Forwarding yes\nX11DisplayOffset 10\n</code></pre>\n<p>xauth is installed on the remote Pi.</p>\n<p>I have installed XQuartz on my client mac. Upon <code>ssh -X pi@IPaddress</code>, xquartz opens and if I <code>echo $DISPLAY</code> on the remote Pi I get <code>localhost:12.0</code> ... the number changes with each terminal.</p>\n<p>Currently, if have incorrectly set the project environment in Netbeans with:</p>\n<pre><code>DISPLAY=localhost:11.0\n</code></pre>\n<p><em>(this is wrong because the number changes with each ssh connection to the remote Pi).</em></p>\n<p>So when I try to run the program, NetBeans will hang and I can't debug either.</p>\n<p>My question at this stage is, how do I set the <code>$DISPLAY</code> Environment correctly for NetBeans so that each time it makes an SSH connection to the remote Pi and requests X11 forwarding, it has the correct <code>$DISPLAY</code>?</p>\n"}, {"tags": ["c", "variables", "cs50"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1504022169, "post_id": 45943501, "comment_id": 78845297, "body": "But you don&#39;t <i>have</i> any global variables? All variables you have are <i>local</i> inside the <code>main</code> function. Perhaps you should <a href=\"http://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">get some good beginners books</a> instead of using the often derided CS50 course."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1504022171, "post_id": 45943501, "comment_id": 78845300, "body": "did you try using a debugger?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504022173, "post_id": 45943501, "comment_id": 78845303, "body": "<code>do { printf(&quot;O hai! How much change is owed?\\n&quot;); moneytotf=get_float(); } while (moneytot&lt;0);</code> never changes <code>moneytot</code>"}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 0, "creation_date": 1504022257, "post_id": 45943501, "comment_id": 78845349, "body": "Use a debugger, or if that&#39;s intimidating, add printf&#39;s in your code so you can see the progress as it runs."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504022268, "post_id": 45943501, "comment_id": 78845355, "body": "@chux Good then that the condition is what it is, so it&#39;s not actually looping."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504022367, "post_id": 45943501, "comment_id": 78845422, "body": "This initialization: &#39;int moneytot= moneytotf*100;&#39; seems a bit pointless?"}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 0, "creation_date": 1504022402, "post_id": 45943501, "comment_id": 78845454, "body": "Just add printf&#39;s throughout your code to print the values of various variables at certain spots, and examine the output to make sure it goes through each step you expect and the variables have the values you expect at each step."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504022511, "post_id": 45943501, "comment_id": 78845524, "body": "<code>moneytotf=get_float();</code> --&gt; <code>moneytotf=get_float(); moneytot = lround(moneytotf*100.0);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504022447, "post_id": 45943586, "comment_id": 78845481, "body": "That confused me too!"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 2, "last_activity_date": 1504022350, "creation_date": 1504022350, "answer_id": 45943586, "question_id": 45943501, "link": "https://stackoverflow.com/questions/45943501/global-variables-not-updating-in-c/45943586#45943586", "title": "Global variables not updating in C", "body": "<p>I suspect that you think that</p>\n\n<pre><code>float moneytotf=0.0;\nint moneytot= moneytotf*100;\n</code></pre>\n\n<p>means</p>\n\n<p>\"moneytot should always contain moneytotf times 100\"</p>\n\n<p>It doesnt mean that - it means</p>\n\n<p>\"set moneytot to whatever moneytotf 's value is right now\"</p>\n\n<p>Ie 0. You never set it to any other value. You need to assign it after you read moneytotf</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8533488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d84ccd3ecd848783e1b64c6cf1906a?s=128&d=identicon&r=PG&f=1", "display_name": "user8533488", "link": "https://stackoverflow.com/users/8533488/user8533488"}, "edited": false, "score": 0, "creation_date": 1504114211, "post_id": 45943684, "comment_id": 78891880, "body": "Thanks for the help."}, {"owner": {"reputation": 11, "user_id": 8533488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d84ccd3ecd848783e1b64c6cf1906a?s=128&d=identicon&r=PG&f=1", "display_name": "user8533488", "link": "https://stackoverflow.com/users/8533488/user8533488"}, "edited": false, "score": 0, "creation_date": 1504114749, "post_id": 45943684, "comment_id": 78892210, "body": "Whoops tried editing but just found out it had a 5 min limit. I can see where things went wrong now, I assumed that updating the &quot;moneytotf&quot; value (with Getfloat() )would retroactively update moneytot because I had set it equal to moneytotf*100, but I see now that it doesn&#39;t go back and update it (is there any way to set it up to do so?).  Also with the float/int, is there a way to convert the floats easily into integers? I heard you can declare the variable and define it later, but everytime I try to compile it says I can&#39;t do that. Is it not possible?"}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "reply_to_user": {"reputation": 11, "user_id": 8533488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d84ccd3ecd848783e1b64c6cf1906a?s=128&d=identicon&r=PG&f=1", "display_name": "user8533488", "link": "https://stackoverflow.com/users/8533488/user8533488"}, "edited": false, "score": 0, "creation_date": 1504115714, "post_id": 45943684, "comment_id": 78892720, "body": "No never. The language is imperative. One instruction at the time change the state of the variable. So if the value of moneytotf changes, moneytot does not if not explicitly written in a instruction."}, {"owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "reply_to_user": {"reputation": 11, "user_id": 8533488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d84ccd3ecd848783e1b64c6cf1906a?s=128&d=identicon&r=PG&f=1", "display_name": "user8533488", "link": "https://stackoverflow.com/users/8533488/user8533488"}, "edited": false, "score": 0, "creation_date": 1504115900, "post_id": 45943684, "comment_id": 78892842, "body": "The correct way to transform a float in an integer is by using the functions <code>round</code>/<code>floor</code>/<code>ceil</code>. Even if you can cast a float/double to an int and in the majority of the cases you get a valid result, it may not work for some cases. The fact that you can declare and than define means that you can write (some time ago you were forced to) something like <code>int v; v = 10;</code>. <code>int v;</code> is the variable declaration, while <code>v = 10;</code> is the variable definition. before the variable definition you may don&#39;t know what <code>v</code> contains."}], "tags": [], "owner": {"reputation": 2611, "user_id": 2319299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ad0ca993033b3191db773253a5a7cd6?s=128&d=identicon&r=PG", "display_name": "Matteo Ragni", "link": "https://stackoverflow.com/users/2319299/matteo-ragni"}, "is_accepted": false, "score": 0, "last_activity_date": 1504022715, "creation_date": 1504022715, "answer_id": 45943684, "question_id": 45943501, "link": "https://stackoverflow.com/questions/45943501/global-variables-not-updating-in-c/45943684#45943684", "title": "Global variables not updating in C", "body": "<p>There is no issue with global variables, but simple mistakes in the code</p>\n\n<pre><code>#include &lt;cs50.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void) {\n  float moneytotf = 0.0;\n  int moneytot = moneytotf * 100; // moneytotf is a float and you are using\n                                  // it to assign to an integer. BTW moneytot is\n                                  // still 0. Maybe it is better to write:\n  // int moneytot = -1;  ??\n  int qtr = 0;\n  int dime = 0;\n  int nickel = 0;\n  int penny = 0;\n  int change;\n  do {\n    printf(\"O hai! How much change is owed?\\n\");\n    moneytotf = get_float(); // You are changing moneytotf and NOT moneytot\n  } while (moneytot &lt; 0); // but this condition operates on moneytot that is 0,\n                          // so it runs only once\n\n  if (moneytot % 25 == 0) {\n    qtr = moneytot / 25; // qtr is always 0\n  } else {\n    // This code never runs as for now\n  }\n  int sum = qtr + dime + nickel + penny; // all the others are zero by default\n  printf(\"%i\\n\", sum); // it will always print 0\\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 0, "last_activity_date": 1504022929, "creation_date": 1504022929, "answer_id": 45943734, "question_id": 45943501, "link": "https://stackoverflow.com/questions/45943501/global-variables-not-updating-in-c/45943734#45943734", "title": "Global variables not updating in C", "body": "<p>You are asking the wrong question.  You do not have any global variables; all of yours are inside the scope of the main function.</p>\n\n<p>Your most immediate issue is that you take in a value to <code>moneytotf</code> and seemingly expect that it will automatically change <code>moneytot</code>, however that is something you need to explicitly do in the code.</p>\n"}], "owner": {"reputation": 11, "user_id": 8533488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7d84ccd3ecd848783e1b64c6cf1906a?s=128&d=identicon&r=PG&f=1", "display_name": "user8533488", "link": "https://stackoverflow.com/users/8533488/user8533488"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1291, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1504311744, "creation_date": 1504022089, "last_edit_date": 1504311744, "question_id": 45943501, "link": "https://stackoverflow.com/questions/45943501/global-variables-not-updating-in-c", "title": "Global variables not updating in C", "body": "<p>Been working on the homework assignment for the edxCS50 course, and still pretty new at C and programming so I was pretty proud to finally get this to compile. But the final result seems like I'm missing something somewhere</p>\n\n<p>The point of the code is to take the user inputted money, and spit out the minimum amount of coins necessary to make that money. The idea was to first convert everything to integers so I could use modulo. If the amount entered was divisible by 25, then that's the end of it and it would divide by 25 to get amount of quarters needed. If not then it would find out how many quarters there are, find the remainder, use it as the remaining change, and rinse and repeat until you get to pennies. At the end it's supposed to add up the amount of coins and spit it out.</p>\n\n<p>The problem is every single time I run it, the end sum results in a big fat \"0\"  . I'm pretty sure it's because the variables remain at the starting value of 0  but I can't figure out why it's not changing the variable values as the code is being run.                     </p>\n\n<p>First time posting here so feel free to correct me if I'm not specific enough or missing info in this post</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;cs50.h&gt;\n\nint main(void)\n\n{float moneytotf=0.0;\nint moneytot= moneytotf*100;\nint qtr=0;\nint dime=0;\nint nickel=0;\nint penny=0;\nint change;\ndo\n{\nprintf(\"O hai! How much change is owed?\\n\");\nmoneytotf=get_float();\n}\nwhile (moneytot&lt;0);\n\nif (moneytot%25==0)\n{qtr=moneytot/25;}\nelse\n    {if (moneytot/25&lt;1)\n    {qtr=0;}\n    else\n    {\n        qtr=(moneytot-moneytot%25)/25;\n        change=moneytot%25;\n        if (change%10==0)\n        {dime=change/10;}\n        else\n            {if (change/10&lt;1)\n            {dime=0;}\n            else\n                {dime=((change-change%10)/10);\n                change=change%10;\n                if (change%5&lt;1)\n                {\n                    nickel=0;\n                }\n                else\n                    {\n                        if ((change-5)&lt;1)\n                        {nickel=0;}\n                        else\n                            {nickel=((change-change%5)/5);\n                            change=change%5;\n                            if (change==0)\n                            {\n                                penny=0;\n                            }\n                            else\n                                {penny=change;}\n                            }\n                    }\n\n                }\n\n    }\n\n\n    }\n}\nint sum = qtr+dime+nickel+penny;\nprintf(\"%i\\n\", sum);\n}\n</code></pre>\n"}, {"tags": ["c", "stm32", "flash-memory"], "comments": [{"owner": {"reputation": 379, "user_id": 4156890, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb2a85293501c684164b543a01027def?s=128&d=identicon&r=PG&f=1", "display_name": "RishabhHardas", "link": "https://stackoverflow.com/users/4156890/rishabhhardas"}, "edited": false, "score": 0, "creation_date": 1504078897, "post_id": 45943394, "comment_id": 78867131, "body": "Which microcontroller are you using ? and why are you clearing all the flags? and what is the size of your program ?"}, {"owner": {"reputation": 43, "user_id": 8169128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E3Fkp1tEL1I/AAAAAAAAAAI/AAAAAAAAABI/WcnGIX1U6eE/photo.jpg?sz=128", "display_name": "sean green", "link": "https://stackoverflow.com/users/8169128/sean-green"}, "reply_to_user": {"reputation": 379, "user_id": 4156890, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb2a85293501c684164b543a01027def?s=128&d=identicon&r=PG&f=1", "display_name": "RishabhHardas", "link": "https://stackoverflow.com/users/4156890/rishabhhardas"}, "edited": false, "score": 0, "creation_date": 1504097532, "post_id": 45943394, "comment_id": 78879974, "body": "stm32f205, I&#39;m clearing flags based on the examples I have seen. My current program size is 0x08000000 to 0x080083df"}, {"owner": {"reputation": 2597, "user_id": 4755321, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e93c2832d8928731e8e5d2f6d665c4a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek \u015alimok", "link": "https://stackoverflow.com/users/4755321/jacek-%c5%9alimok"}, "edited": false, "score": 0, "creation_date": 1504160121, "post_id": 45943394, "comment_id": 78907509, "body": "Repeating this may be hard for us. What I would recommend it debug it by stepping into the function and seeing which step exactly fails and why: invalid varaible value, checking some register flag. If it&#39;s the second one, should give you more information on why this happens."}, {"owner": {"reputation": 43, "user_id": 8169128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E3Fkp1tEL1I/AAAAAAAAAAI/AAAAAAAAABI/WcnGIX1U6eE/photo.jpg?sz=128", "display_name": "sean green", "link": "https://stackoverflow.com/users/8169128/sean-green"}, "edited": false, "score": 0, "creation_date": 1504178980, "post_id": 45943394, "comment_id": 78919689, "body": "These HAL_FLASH_Program functions are not steppable. Trying to step in just make it step over the function. Maybe this is my issue?"}, {"owner": {"reputation": 43, "user_id": 8169128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E3Fkp1tEL1I/AAAAAAAAAAI/AAAAAAAAABI/WcnGIX1U6eE/photo.jpg?sz=128", "display_name": "sean green", "link": "https://stackoverflow.com/users/8169128/sean-green"}, "edited": false, "score": 0, "creation_date": 1504179831, "post_id": 45943394, "comment_id": 78920313, "body": "ok, the KEIL IDE needed device-&gt;flash to be added. After that it works."}, {"owner": {"reputation": 43, "user_id": 8169128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E3Fkp1tEL1I/AAAAAAAAAAI/AAAAAAAAABI/WcnGIX1U6eE/photo.jpg?sz=128", "display_name": "sean green", "link": "https://stackoverflow.com/users/8169128/sean-green"}, "edited": false, "score": 0, "creation_date": 1504180176, "post_id": 45943394, "comment_id": 78920566, "body": "Well it does not get an error that is, returns 0. Still does not write to flash."}, {"owner": {"reputation": 43, "user_id": 8169128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E3Fkp1tEL1I/AAAAAAAAAAI/AAAAAAAAABI/WcnGIX1U6eE/photo.jpg?sz=128", "display_name": "sean green", "link": "https://stackoverflow.com/users/8169128/sean-green"}, "edited": false, "score": 0, "creation_date": 1504183743, "post_id": 45943394, "comment_id": 78923033, "body": "Other issue on my side, dumb user error."}], "owner": {"reputation": 43, "user_id": 8169128, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-E3Fkp1tEL1I/AAAAAAAAAAI/AAAAAAAAABI/WcnGIX1U6eE/photo.jpg?sz=128", "display_name": "sean green", "link": "https://stackoverflow.com/users/8169128/sean-green"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1504056660, "creation_date": 1504021692, "last_edit_date": 1504056660, "question_id": 45943394, "link": "https://stackoverflow.com/questions/45943394/stm32f2xx-hal-flash-program-returning-nonsense", "title": "stm32f2xx HAL_FLASH_Program returning nonsense", "body": "<p>I'm trying to write to flash but the return error is not  in the acceptable range. </p>\n\n<p>example:</p>\n\n<pre><code>uint32_t Address = 0x0800C000;\nuint8_t Data = 0x01;\n\nHAL_FLASH_Unlock();\n__HAL_FLASH_CLEAR_FLAG(FLASH_FLAG_EOP | FLASH_FLAG_OPERR | FLASH_FLAG_WRPERR | FLASH_FLAG_PGAERR | FLASH_FLAG_PGPERR | FLASH_FLAG_PGSERR);\nFLASH_Erase_Sector(FLASH_SECTOR_3, VOLTAGE_RANGE_3); //sector3 0x800C000 0x800CFFF\nprintf(\"---%u\\n\", HAL_FLASH_Program(FLASH_TYPEPROGRAM_BYTE, Address, Data));\n\nif ( HAL_FLASH_Program(FLASH_TYPEPROGRAM_BYTE, Address, Data)==HAL_OK       ) printf(\"---%u\\n\", 0);\nif ( HAL_FLASH_Program(FLASH_TYPEPROGRAM_BYTE, Address, Data)==HAL_ERROR    ) printf(\"---%u\\n\", 1);\nif ( HAL_FLASH_Program(FLASH_TYPEPROGRAM_BYTE, Address, Data)==HAL_BUSY     ) printf(\"---%u\\n\", 2);\nif ( HAL_FLASH_Program(FLASH_TYPEPROGRAM_BYTE, Address, Data)==HAL_TIMEOUT  ) printf(\"---%u\\n\", 3);\nif ( HAL_FLASH_Program(FLASH_TYPEPROGRAM_BYTE, Address, Data) &gt; 0x03)  printf(\"---none\\n\");\n\nHAL_FLASH_Lock();\n</code></pre>\n\n<p>Pardon the sloppy code but its for testing. I always get a return of > 3. If traced it is 1073888268 but the struct says</p>\n\n<pre><code>typedef enum \n{\n  HAL_OK       = 0x00,\n  HAL_ERROR    = 0x01,\n  HAL_BUSY     = 0x02,\n  HAL_TIMEOUT  = 0x03\n} HHAL_StatusTypeDef;\n</code></pre>\n\n<p>How can this be?</p>\n"}, {"tags": ["c", "pthreads", "signals", "posix"], "comments": [{"owner": {"reputation": 15041, "user_id": 1455016, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae8ab91a64f21f0e65b69a0bf1ca4904?s=128&d=identicon&r=PG", "display_name": "tbodt", "link": "https://stackoverflow.com/users/1455016/tbodt"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1504036756, "post_id": 45943240, "comment_id": 78853225, "body": "@alk The man page for pthread_cond_wait and pthread_cond_timedwait says &quot;These functions shall not return an error code of [EINTR].&quot;"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1504123776, "post_id": 45943240, "comment_id": 78896966, "body": "It looks like you might need to use a helper thread (for catching the signal, or waiting on the condition variable). Actually, to close all races, you might have to use two helper threads and a semaphore, with the original thread waiting on the semaphore."}], "answers": [{"comments": [{"owner": {"reputation": 15041, "user_id": 1455016, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae8ab91a64f21f0e65b69a0bf1ca4904?s=128&d=identicon&r=PG", "display_name": "tbodt", "link": "https://stackoverflow.com/users/1455016/tbodt"}, "edited": false, "score": 0, "creation_date": 1504106864, "post_id": 45953929, "comment_id": 78887513, "body": "The thread could be potentially be waiting on any condition variable in the program, so I can&#39;t just signal the condition variable the thread is waiting on from the signal handler. I could use a wrapper function around pthread_cond_wait that saves the condition in a thread-local for the signal handler, but that&#39;s hard to protect against race conditions, e.g. if the signal arrives and the handler runs pthread_cond_broadcast between storing the thread local and starting the wait."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 15041, "user_id": 1455016, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae8ab91a64f21f0e65b69a0bf1ca4904?s=128&d=identicon&r=PG", "display_name": "tbodt", "link": "https://stackoverflow.com/users/1455016/tbodt"}, "edited": false, "score": 0, "creation_date": 1504123464, "post_id": 45953929, "comment_id": 78896827, "body": "@tbodt: POSIX says <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_cond_signal.html\" rel=\"nofollow noreferrer\"><code>pthread_cond_signal()</code> is unsafe in a signal handler</a> anyway."}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "edited": false, "score": 0, "creation_date": 1504166174, "post_id": 45953929, "comment_id": 78910880, "body": "It should always be clear which condition variables your threads could be waiting on.  If there are several possibilities, you can signal them all (condition variables can wake up spuriously anyway, so it&#39;s always safe to signal them unnecessarily).  (Also, the idea here is not to call <code>pthread_cond_broadcast()</code> from a signal handler, but from a signal-handling-thread that is running in ordinary thread context, after <code>sigwaitinfo()</code> has returned and dequeued a signal)."}], "tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": false, "score": 1, "last_activity_date": 1504076293, "creation_date": 1504076293, "answer_id": 45953929, "question_id": 45943240, "link": "https://stackoverflow.com/questions/45943240/how-do-i-wait-for-a-pthread-condition-variable-or-a-signal/45953929#45953929", "title": "How do I wait for a pthread condition variable or a signal?", "body": "<p>A reliable way to handle signals in a pthreads program is to mask all the signals you wish to handle in every thread, and create a dedicated signal handling thread that loops around calling <code>sigwaitinfo()</code> (or <code>sigtimedwait()</code>).</p>\n\n<p>The signal handling thread can then use ordinary mutex-protected shared variables and <code>pthread_cond_signal()</code> / <code>pthread_cond_broadcast()</code> wakeups to inform other threads about the signals received.</p>\n\n<p>In your example, the dedicated signal handling thread could set a (mutex-protected) flag indicating that <code>SIGUSR1</code> has been received, then signal the condition variable that your thread is waiting on.  The waiting thread just needs to check the signal flags in addition to its other shared state in the loop around <code>pthread_cond_wait()</code>.</p>\n"}], "owner": {"reputation": 15041, "user_id": 1455016, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/ae8ab91a64f21f0e65b69a0bf1ca4904?s=128&d=identicon&r=PG", "display_name": "tbodt", "link": "https://stackoverflow.com/users/1455016/tbodt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1504076293, "creation_date": 1504021201, "question_id": 45943240, "link": "https://stackoverflow.com/questions/45943240/how-do-i-wait-for-a-pthread-condition-variable-or-a-signal", "title": "How do I wait for a pthread condition variable or a signal?", "body": "<p>I want to wait for a pthread condition variable, but when I get a SIGUSR1 (or any other signal) I want to stop waiting and detect that it stopped waiting because of a signal, not because of a pthread_cond_signal or spurious wakeup. How can I do this?</p>\n"}, {"tags": ["c", "linux", "bash", "arm"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1504021241, "post_id": 45943197, "comment_id": 78844713, "body": "Please make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Even if you cannot reproduce the timing on readers machines, the context gets clearer if you provide the code."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1504021432, "post_id": 45943197, "comment_id": 78844820, "body": "What is <code>foo()</code>? is it implemented in <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> both scenarios, or <a href=\"https://stackoverflow.com/questions/tagged/bash\">bash</a> in the second? You can if you want implement a function in c that does something really slow compared to &quot;<i>the same function</i>&quot; in say ... <a href=\"https://stackoverflow.com/questions/tagged/python\">python</a>. But the code should be posted in order to know better."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504022569, "post_id": 45943197, "comment_id": 78845566, "body": "Did you send export this function as an &quot;loadable built-in&quot; (whatever the name of it is).?"}, {"owner": {"reputation": 3923, "user_id": 900394, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/wAnlv.jpg?s=128&g=1", "display_name": "Alaa M.", "link": "https://stackoverflow.com/users/900394/alaa-m"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504073028, "post_id": 45943197, "comment_id": 78863867, "body": "@IharobAlAsimi - <code>foo()</code> is implemented in <code>C</code> in both scenarios. I will post some code."}, {"owner": {"reputation": 3923, "user_id": 900394, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/wAnlv.jpg?s=128&g=1", "display_name": "Alaa M.", "link": "https://stackoverflow.com/users/900394/alaa-m"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1504073052, "post_id": 45943197, "comment_id": 78863880, "body": "@PeterJ_01 - I&#39;m not sure what you mean by &quot;loadable built-in&quot;, but googling that leads to problems in <b>script</b> being slow. My problem is the opposite... Or did you mean anything else?"}, {"owner": {"reputation": 3923, "user_id": 900394, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/wAnlv.jpg?s=128&g=1", "display_name": "Alaa M.", "link": "https://stackoverflow.com/users/900394/alaa-m"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1504073060, "post_id": 45943197, "comment_id": 78863883, "body": "@Yunnosch - MCV coming up..."}, {"owner": {"reputation": 16645, "user_id": 402322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GWEWt.gif?s=128&g=1", "display_name": "ceving", "link": "https://stackoverflow.com/users/402322/ceving"}, "edited": false, "score": 1, "creation_date": 1504078357, "post_id": 45943197, "comment_id": 78866822, "body": "If the second call runs faster than the first one, the second probably benefits from some kind of caching."}, {"owner": {"reputation": 3923, "user_id": 900394, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/wAnlv.jpg?s=128&g=1", "display_name": "Alaa M.", "link": "https://stackoverflow.com/users/900394/alaa-m"}, "reply_to_user": {"reputation": 16645, "user_id": 402322, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GWEWt.gif?s=128&g=1", "display_name": "ceving", "link": "https://stackoverflow.com/users/402322/ceving"}, "edited": false, "score": 0, "creation_date": 1504079444, "post_id": 45943197, "comment_id": 78867479, "body": "@ceving - You&#39;re right. I flipped the calls and now &quot;via script&quot; runs slower. But that&#39;s not the case in my original code. OK I will dig deeper then..."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1504021449, "post_id": 45943312, "comment_id": 78844831, "body": "There is no way to give an answer without even knowing what <code>foo()</code> is."}], "tags": [], "owner": {"reputation": 21, "user_id": 8530554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90742439806cdc3dcd5a62e2f631886?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Rajapakse ", "link": "https://stackoverflow.com/users/8530554/sean-rajapakse"}, "is_accepted": false, "score": 0, "last_activity_date": 1504021422, "creation_date": 1504021422, "answer_id": 45943312, "question_id": 45943197, "link": "https://stackoverflow.com/questions/45943197/calling-a-function-directly-takes-more-time-than-calling-it-by-a-bash-script/45943312#45943312", "title": "Calling a function directly takes more time than calling it by a bash script", "body": "<p>Could it be that the resources applied for your program is shared when you call foo  but dedicated when you call the .sh file form the system. So one program running and calling library function(foo) as apposed to one program starting a new one with .sh file. Could be OS and thread related issue.</p>\n"}], "owner": {"reputation": 3923, "user_id": 900394, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/wAnlv.jpg?s=128&g=1", "display_name": "Alaa M.", "link": "https://stackoverflow.com/users/900394/alaa-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504080008, "creation_date": 1504021096, "last_edit_date": 1504080008, "question_id": 45943197, "link": "https://stackoverflow.com/questions/45943197/calling-a-function-directly-takes-more-time-than-calling-it-by-a-bash-script", "title": "Calling a function directly takes more time than calling it by a bash script", "body": "<p>I'm having a strange problem in the running time of a function. Consider these 2 scenarios:</p>\n\n<ul>\n<li><p>I have a library <code>libfoo.so</code>, which has a function <code>foo()</code></p>\n\n<ol>\n<li>App (a <code>C</code> program) calls <code>foo()</code> - takes <strong>X</strong> time</li>\n<li>Same app calls a <strong>script</strong> (<code>script.sh</code>) that calls the same <code>foo()</code> - takes <strong>X/2</strong> time</li>\n</ol></li>\n</ul>\n\n<p>I call the script by <code>system(\"script.sh\")</code> .</p>\n\n<p>What I mean by \"running time\" is the operations <strong>inside</strong> <code>foo()</code> (for example if <code>foo()</code> runs some loop then it would be slower in scenario 1).</p>\n\n<p>Why does having the script in the middle takes half the time than calling <code>foo()</code> directly? Is there a way to bypass this script and have <strong>X/2</strong> time?</p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>I wrote a sample code, but I can't reproduce the timings. The script still runs faster, but only by 1%.</p>\n\n<pre><code>//libfoo.h\nvoid foo();\n</code></pre>\n\n<p>-</p>\n\n<pre><code>//libfoo.c\n#include \"libfoo.h\"\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n\nvoid foo()\n{\n    clock_t t;\n    t = clock();\n\n    for(unsigned int i=0; i&lt;1000000000; i++);\n\n    t = clock() - t;\n    double total_time = ((double)t)/CLOCKS_PER_SEC;\n\n    printf(\"foo() total time: %f seconds\\n\", total_time);\n}\n</code></pre>\n\n<p>-</p>\n\n<pre><code>//script.sh\n./main_for_script\n</code></pre>\n\n<p>-</p>\n\n<pre><code>//main_for_script\n#include \"libfoo.h\"\n\nint main()\n{\n    foo();\n\n    return 0;\n}\n</code></pre>\n\n<p>-</p>\n\n<pre><code>//main.c\n#include \"libfoo.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n    printf(\"Calling foo() directly...\\n\");\n    foo();\n    printf(\"Calling foo() via script...\\n\");\n    system(\"./script.sh\");\n    return 0;\n}\n</code></pre>\n\n<p>-</p>\n\n<pre><code>//compilation\n$CC -c -fpic libfoo.c\n$CC -shared -o libfoo.so libfoo.o\n$CC -L. -o main main.c -lfoo\n$CC -L. -o main_for_script main_for_script.c -lfoo\n</code></pre>\n\n<p>-</p>\n\n<pre><code>//Running command\nroot@imx6:/stackoverflow# ./main\nCalling foo() directly...\nfoo() total time: 8.794843 seconds\nCalling foo() via script...\nfoo() total time: 8.713951 seconds\n</code></pre>\n"}, {"tags": ["c", "if-statement"], "comments": [{"owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1504020583, "post_id": 45942992, "comment_id": 78844333, "body": "I&#39;m voting to close this question as off-topic because it&#39;s better suited for <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "reply_to_user": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1504020633, "post_id": 45942992, "comment_id": 78844363, "body": "Sure. Thanks for suggestion, I will post it there."}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 2, "creation_date": 1504020713, "post_id": 45942992, "comment_id": 78844405, "body": "Are you certain that <code>count = 4*(count&gt; 4) + count*(count&lt;= 4);</code> does not result in branches to handle the <code>count&gt; 4</code> and <code>count&lt;= 4</code>?"}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "edited": false, "score": 0, "creation_date": 1504020766, "post_id": 45942992, "comment_id": 78844446, "body": "I am not certain, that is why this question, let me know your thoughts."}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 0, "creation_date": 1504020792, "post_id": 45942992, "comment_id": 78844457, "body": "You don&#39;t have to wonder; you can just check the assembly that results from that expression."}, {"owner": {"reputation": 920, "user_id": 8108125, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d73c63113cdabd2357f32a9808bd0559?s=128&d=identicon&r=PG&f=1", "display_name": "Cpp plus 1", "link": "https://stackoverflow.com/users/8108125/cpp-plus-1"}, "reply_to_user": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 1, "creation_date": 1504020851, "post_id": 45942992, "comment_id": 78844494, "body": "@mustaccio This doesn&#39;t seem like it should belong in code review, since the person who asked the question already wrote the code for both examples and is merely asking which one is faster."}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 1, "creation_date": 1504020931, "post_id": 45942992, "comment_id": 78844541, "body": "As far as whether it would be &quot;better&quot; (assuming it doesn&#39;t require branching to handle the <code>&gt;</code> and <code>&lt;=</code> conditions), that may depend on the architecture. On architectures where multiplies are expensive (e.g. some embedded platforms), the branched implementation would likely be faster."}, {"owner": {"reputation": 115587, "user_id": 56541, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/Wm7Xg.png?s=128&g=1", "display_name": "David Z", "link": "https://stackoverflow.com/users/56541/david-z"}, "reply_to_user": {"reputation": 920, "user_id": 8108125, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d73c63113cdabd2357f32a9808bd0559?s=128&d=identicon&r=PG&f=1", "display_name": "Cpp plus 1", "link": "https://stackoverflow.com/users/8108125/cpp-plus-1"}, "edited": false, "score": 0, "creation_date": 1504021101, "post_id": 45942992, "comment_id": 78844640, "body": "I agree with @Cppplus1 that this seems perfectly on topic here, and better suited for this site than for <a href=\"https://codereview.stackexchange.com\">Code Review</a>. People there expect to be able to offer general feedback on any aspect of the code, not just performance."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1504021104, "post_id": 45942992, "comment_id": 78844641, "body": "<code>count = 4*(count&gt; 4) + count*(count&lt;= 4);</code> --&gt; Maybe save a cycle, earn low review marks.  <code>if(count &gt; 4) count = 4;</code> Oh happy day! - focus on significant time issues."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1504021450, "post_id": 45942992, "comment_id": 78844832, "body": "See <a href=\"http://www.geeksforgeeks.org/compute-the-minimum-or-maximum-max-of-two-integers-without-branching/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/&hellip;</a> although I&#39;m sure this is not where any performance bottleneck lies, so best keep things readable."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1504022992, "post_id": 45942992, "comment_id": 78845827, "body": "You should test if this does really result in a performance improvement. It doesn&#39;t look as is this a bottleneck. If there is any improvement or not also depends on the target system."}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "edited": false, "score": 0, "creation_date": 1504023573, "post_id": 45942992, "comment_id": 78846203, "body": "What about, in general, impact of a missed branch prediction in case of if statement in this case? Would not that cause branched instructions perform worse?"}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "edited": false, "score": 0, "creation_date": 1504024109, "post_id": 45942992, "comment_id": 78846532, "body": "Please also note the EDIT to the OP above."}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 0, "creation_date": 1504024571, "post_id": 45942992, "comment_id": 78846812, "body": "I doubt that the assembly snippets you added fully implement the logic of the indicated C statements, at least not the 2nd one. Those assembly lines may be PART of the logic, but not all of it. To make it easier to see, implement the lines as separate simple functions, and examine the assembly of each entire function. That won&#39;t necessarily result in an instruction sequence that&#39;s identical to what you would see with the inline statements, but it would give you a better idea of the full scope of the assembly required for each."}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 0, "creation_date": 1504024629, "post_id": 45942992, "comment_id": 78846854, "body": "BTW, you may have to place those functions in separate compilation units (.c files), or else disable inlining in the compiler options, otherwise the compiler may just inline those super-simple functions, defeating your purpose."}, {"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1504025723, "post_id": 45942992, "comment_id": 78847439, "body": "On the second part of the question: The order of iteration looks backward to me. I&#39;m guessing that you will get better improvements by rethinking the algorithm than by optimizing for assembly generation.  You could add some more context and make that a separate question - maybe for codereview.soe"}, {"owner": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 1, "creation_date": 1504026655, "post_id": 45942992, "comment_id": 78847906, "body": "If 64bit ints are available, you can avoid (most of) the loops by storing all 52 cards in a single 64 bits bitmask. (or a mask per player + one for the table or dealer)"}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "reply_to_user": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 0, "creation_date": 1504028438, "post_id": 45942992, "comment_id": 78848861, "body": "@joop i m trying to stay compatible with 32-bit"}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "reply_to_user": {"reputation": 3854, "user_id": 2235885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d0d6a08639ef79ef960a52bd013e02?s=128&d=identicon&r=PG", "display_name": "joop", "link": "https://stackoverflow.com/users/2235885/joop"}, "edited": false, "score": 1, "creation_date": 1504034984, "post_id": 45942992, "comment_id": 78852351, "body": "@joop - That is an awesome idea. Vikas, consider that... it may mean a good bit of rework, but it could eliminate a ton of loops. As far as staying compatible with 32-bit goes, even most 32-bit platforms support <code>uint64_t</code>; the compiler manufactures it from two adjacent 32-bit integers and as far as your program logic is concerned, it&#39;s no different from a 64-bit integer on a 64-bit platform. The cards of each suit can be represented by 13 bits each, with (if applicable) extra bits representing jokers. Or if you&#39;d rather, use <code>uint16_t</code>&#39;s, one for each suit. Better yet, make a union...."}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 1, "creation_date": 1504035099, "post_id": 45942992, "comment_id": 78852411, "body": "<code>typedef union { uint16_t suit[4]; uint64_t allCards; };</code> and maybe you could refer to either all cards of a given suit, or all cards of the deck all at once, whichever seems best for a given situation."}, {"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "reply_to_user": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 0, "creation_date": 1504043907, "post_id": 45942992, "comment_id": 78856521, "body": "Thanks @phonetagger and joop, i was able to use this idea."}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "edited": false, "score": 0, "creation_date": 1504043646, "post_id": 45947234, "comment_id": 78856409, "body": "Thanks @PeterJ_01 for illustration. Surprising to me, foo1 has no jump instruction, so apparently ternary operator is not implemented like if-then-else! So, is it correct to say that foo1 is the best way to go here?"}, {"owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "edited": false, "score": 0, "creation_date": 1504064659, "post_id": 45947234, "comment_id": 78861433, "body": "Ternary operation is a short hand notation for if/then/else with count being explicitly assigned a value on all branches. It is no silver bullet that removes jumps, even when one lucky compiler generated different code with it. Better use function min and when desperate, tune that based on the platform."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 1, "last_activity_date": 1504035968, "creation_date": 1504035968, "answer_id": 45947234, "question_id": 45942992, "link": "https://stackoverflow.com/questions/45942992/reviewing-if-conditional-code-to-save-cpu-cycles/45947234#45947234", "title": "Reviewing IF conditional code to save CPU cycles", "body": "<p>Those micro optimistion do not have too much sense but of you want to compare (you will see the difference between your one and mine - switch on optimisation - compiler is really good in it):</p>\n\n<pre><code>int count;\n\n void foo()\n {\n       count = 4*(count&gt; 4) + count*(count &lt;= 4);\n }\n\n void foo1()\n {\n       count = count &gt; 4 ? 4 : count;\n }\n\n  void foo4()\n {\n       if(count&gt; 4) count = 4;\n }\n\nfoo:\n  mov edx, DWORD PTR count[rip]\n  xor ecx, ecx\n  cmp edx, 4\n  setle al\n  setg cl\n  movzx eax, al\n  imul eax, edx\n  lea eax, [rax+rcx*4]\n  mov DWORD PTR count[rip], eax\n  ret\nfoo1:\n  cmp DWORD PTR count[rip], 4\n  mov eax, 4\n  cmovle eax, DWORD PTR count[rip]\n  mov DWORD PTR count[rip], eax\n  ret\nfoo4:\n  cmp DWORD PTR count[rip], 4\n  jle .L6\n  mov DWORD PTR count[rip], 4\n.L6:\n  rep ret\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15724, "user_id": 1716339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/835fc3719b0118c68c4d202b3e5cbf18?s=128&d=identicon&r=PG", "display_name": "Aki Suihkonen", "link": "https://stackoverflow.com/users/1716339/aki-suihkonen"}, "is_accepted": false, "score": 1, "last_activity_date": 1504065629, "creation_date": 1504065629, "answer_id": 45951677, "question_id": 45942992, "link": "https://stackoverflow.com/questions/45942992/reviewing-if-conditional-code-to-save-cpu-cycles/45951677#45951677", "title": "Reviewing IF conditional code to save CPU cycles", "body": "<p>The answer to the second loop must be something like:</p>\n\n<pre><code>     pushcards(player, popcards(dealer));\n</code></pre>\n"}], "owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 45947234, "answer_count": 2, "score": 4, "last_activity_date": 1504065629, "creation_date": 1504020483, "last_edit_date": 1504044190, "question_id": 45942992, "link": "https://stackoverflow.com/questions/45942992/reviewing-if-conditional-code-to-save-cpu-cycles", "title": "Reviewing IF conditional code to save CPU cycles", "body": "<p>I am reviewing the usage of <em>if</em> condition in my program, in there, I have lines like the following:</p>\n\n<pre><code>if(count &gt; 4) count = 4;\n</code></pre>\n\n<p>Would it be a good idea to write the above <em>if</em> conditional statement as the following non-branched one?</p>\n\n<pre><code>count = 4*(count&gt; 4) + count*(count&lt;= 4);\n</code></pre>\n\n<p>I also have the following snippet there:</p>\n\n<pre><code>for (j=0, i=0; j&lt;NCARD_PER_SUIT &amp;&amp; i&lt;CARDS_PER_PLAYER+CARDS_ON_BOARD; ++j) {\n    if (card_cfg.hearts &amp; cfg_mask[j]) {\n        player_hand[i].card.face = j;\n        player_hand[i++].card.suit = HEART;\n    }\n    if (card_cfg.spades &amp; cfg_mask[j]) {\n        player_hand[i].card.face = j;\n        player_hand[i++].card.suit = SPADE;\n    }\n    if (card_cfg.clubs &amp; cfg_mask[j]) {\n        player_hand[i].card.face = j;\n        player_hand[i++].card.suit = CLUB;\n    }\n    if (card_cfg.diamonds &amp; cfg_mask[j]) {\n        player_hand[i].card.face = j;\n        player_hand[i++].card.suit = DIAMOND;\n    }\n}\n</code></pre>\n\n<p>and wondering if there is good (non-branched) way to write the above, any suggestions?</p>\n\n<p>EDIT: Based on some feedback below, i compared the assembly instructions (using MSVS2015 for Windows 10) and got the following:</p>\n\n<pre><code>; 718  :     count = 4*(count&gt; 4) + count*(count&lt;= 4);\n\nxor ebx, ebx\ncmp edx, 4\nsetle   bl\nxor ecx, ecx\nimul    ebx, edx\ncmp edx, 4\nmov edx, 4\ncmovg   ecx, edx\nadd ebx, ecx\n</code></pre>\n\n<p>And if revert back to if statement, i get the following, where no jump instruction and total number of instructions 2/3rd compare to the above:</p>\n\n<pre><code>; 718  :     if( count &gt;4) count = 4;\n\nmov eax, DWORD PTR _i$6$[ebp]\ncmp edx, edi\nmov ebx, DWORD PTR _player$GSCopy$1$[ebp]\ncmovg   edx, edi\nmov edi, DWORD PTR _count$1$[ebp]\nmov DWORD PTR _count$4$[ebp], edx\n</code></pre>\n\n<p>EDIT #2: Based on the tip from the comments below, i went ahead and created a </p>\n\n<pre><code>union \ntypedef union {\n    struct cfg {\n        unsigned short hearts;  \n        unsigned short spades;\n        unsigned short clubs;\n        unsigned short diamonds;\n    } suit;\n    unsigned long long allsuits;\n} card_cfg_t;\n</code></pre>\n\n<p>And with help of this union, i was able to rewrite the second snippet of OP as follows, which seem sot save a lot (20% in my case) if I build it for 64-bit machine and takes more time (extra 40%) if i build it for 32-bit machine:</p>\n\n<pre><code>for (j=0, i=0; j&lt;NCARD_PER_SUIT &amp;&amp; i&lt;CARDS_PER_PLAYER+CARDS_ON_BOARD; ++j) {\n    for (int k=0; k&lt;4; ++k) {\n        present = (int)((card_cfg.allsuits &amp; (cfg_mask[j] &lt;&lt; 16*k)) != 0);\n        player_hand[i].card.face = j*present;\n        player_hand[i].card.suit = k;\n        i = i + present;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "perl", "xs"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 3, "creation_date": 1504020074, "post_id": 45942716, "comment_id": 78843982, "body": "1) We can&#39;t really say what&#39;s wrong, without the XS code to look at. There&#39;s nothing wrong per se about the unpack. 2) That post is pretty bad advice IMO, and if you&#39;re trying to follow it straightforwardly for return values, you&#39;re probably making memory management mistakes. I would really suggest doing things the normal way, on the stack."}, {"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 1, "creation_date": 1504020418, "post_id": 45942716, "comment_id": 78844235, "body": "The post calls a C function from perl that takes <code>char *</code> as an argument, which works well enough. The reverse -- passing <code>char *</code> from C to Perl -- is trickier because Perl will stop reading when it encounters a NULL (<code>\\0</code>) in the C output."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "edited": false, "score": 2, "creation_date": 1504022004, "post_id": 45942716, "comment_id": 78845170, "body": "We can&#39;t tell what you mistake you&#39;ve made because you didn&#39;t show your code. Please provide a minimal, runnable demonstration of the problem."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 0, "creation_date": 1504022973, "post_id": 45942716, "comment_id": 78845807, "body": "@mob, Re &quot;<i>is trickier because Perl will stop reading when it encounters a NULL (\\0) in the C output.</i>&quot;, No. It reads as many as you specify. <code>newSVpv((char*)array, num_ele*sizeof(array[0]))</code>"}, {"owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 1, "creation_date": 1504023621, "post_id": 45942716, "comment_id": 78846242, "body": "I&#39;m saying that for an XS function like <code>char* foobar() { return &quot;foo\\0bar\\0&quot; }</code>, a Perl call to <code>foobar()</code> will receive the string <code>foo</code>."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "edited": false, "score": 0, "creation_date": 1504030149, "post_id": 45942716, "comment_id": 78849834, "body": "@mob, Well yeah, but you shouldn&#39;t <i>ever</i> use <code>char*</code> as the type of arguments or return value in XS. (Well, you could use it if you can guarantee ASCII, but that&#39;s it.) So, I repeat, there&#39;s no problems with NULs in XS. Quite the opposite, XS is actually capable of handling NULs in strings; it&#39;s C that can&#39;t."}], "answers": [{"tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 4, "last_activity_date": 1504023443, "creation_date": 1504023443, "answer_id": 45943891, "question_id": 45942716, "link": "https://stackoverflow.com/questions/45942716/perl-c-xs-unpack-float-array/45943891#45943891", "title": "Perl, C, XS - unpack float array", "body": "<pre><code>use strict;\nuse warnings;\nuse feature qw( say );\n\nuse Inline C =&gt; &lt;&lt;'__EOS__';\n\n#include &lt;stdio.h&gt;\n\nSV* test(SV* sv) {\n   float* array;\n   size_t num_eles;\n   {\n      STRLEN len;\n      char* s = SvPVbyte(sv, len);\n      num_eles = len/sizeof(float);\n\n      /* We can't just cast s because we could */\n      /* run afoul of alignment restrictions. */\n      array = malloc(len);\n      memcpy(array, s, len);\n   }\n\n   {\n      size_t i;\n      for (i=0; i&lt;num_eles; ++i) {\n         printf(\"%zu %.6f\\n\", i, (double)(array[i]));\n      }\n   }\n\n   {\n      SV* return_sv = newSVpv((char*)array, num_eles*sizeof(float));\n      free(array);\n      return return_sv;  /* The typemap will mortalize. */\n   }\n}\n\n__EOS__\n\nmy @a = (1.2, 1.3, 1.4);\nsay sprintf \"%u %.6f\", $_, $a[$_] for 0..$#a;\nmy $a = pack('f*', @a);\nmy $b = test($a);\nmy @b = unpack('f*', $b);\nsay sprintf \"%u %.6f\", $_, $b[$_] for 0..$#b;\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7174381, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/56e8d49cc03f1b0f1e422018e712e73e?s=128&d=identicon&r=PG&f=1", "display_name": "Jen Mer", "link": "https://stackoverflow.com/users/7174381/jen-mer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1504023443, "creation_date": 1504019660, "question_id": 45942716, "link": "https://stackoverflow.com/questions/45942716/perl-c-xs-unpack-float-array", "title": "Perl, C, XS - unpack float array", "body": "<p>I have Perl Code and C Code and I am calling C functions in my Perl Code.\nI have passed a float array from Perl to C by packing it (like this <a href=\"http://www.perlmonks.org/?node_id=39697\" rel=\"nofollow noreferrer\">http://www.perlmonks.org/?node_id=39697</a>) and it works nicely!</p>\n\n<pre><code>my $p_angle = pack(\"f*\", @angle);\n</code></pre>\n\n<p>But now I am trying to return that array from my C function to Perl and I want to be able to do stuff with it, e.g read values, print...</p>\n\n<p>I have tried to unpack it with </p>\n\n<pre><code>my @array = unpack(\"f*\", $entropy);\n</code></pre>\n\n<p>but that does not work at all, I always see the same not reasonable values when I print the @array.</p>\n\n<p>So I guess I am doing it wrong, does anybody know how to unpack the array properly?</p>\n"}, {"tags": ["c", "complex-numbers"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1504019581, "post_id": 45942669, "comment_id": 78843637, "body": "Don&#39;t use <code>long double</code> if the function returns <code>double</code> and moreover, don&#39;t use <code>&quot;%lf&quot;</code> for a <code>float</code> or a <code>double</code>, just use <code>&quot;%f&quot;</code>. Also, use <code>M_PI</code> a predefined macro for the value of PI"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 4, "creation_date": 1504019787, "post_id": 45942669, "comment_id": 78843783, "body": "Use <code>cexp</code> instead of <code>exp</code>."}, {"owner": {"reputation": 357, "user_id": 8533342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d07d16fa9af4e63171351a48c909a9?s=128&d=identicon&r=PG&f=1", "display_name": "john doe", "link": "https://stackoverflow.com/users/8533342/john-doe"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504019814, "post_id": 45942669, "comment_id": 78843799, "body": "@IharobAlAsimi I used <code>%f</code> and <code>const double PI = acos(-1);</code> , but output is  still 1.0000000 0.0000000"}, {"owner": {"reputation": 357, "user_id": 8533342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d07d16fa9af4e63171351a48c909a9?s=128&d=identicon&r=PG&f=1", "display_name": "john doe", "link": "https://stackoverflow.com/users/8533342/john-doe"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1504019874, "post_id": 45942669, "comment_id": 78843839, "body": "@BLUEPIXY - woah, that totally worked, what&#39;s the difference between the two?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504019875, "post_id": 45942669, "comment_id": 78843841, "body": "@johndoe Do what BLUEPIXY said. Also, <code>M_PI</code> is a predefined macro with a <code>double</code> value of <i>PI</i>."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1504019889, "post_id": 45942669, "comment_id": 78843850, "body": "<code>cexp()</code> is for complex numbers?"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1504020051, "post_id": 45942669, "comment_id": 78843961, "body": "@IharobAlAsimi - <code>M_PI</code> is not a standard macro; perhaps your platform provides it as a (non-standard) extension?  It&#39;s not available for portable code."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1504020184, "post_id": 45942669, "comment_id": 78844066, "body": "Disappointing that <code>gcc-7 -std=c11 -Wall -Wextra -Wpedantic</code> doesn&#39;t give any diagnostic for the attempt to call <code>exp(double complex)</code>.  :-("}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1504020267, "post_id": 45942669, "comment_id": 78844120, "body": "<a href=\"http://en.cppreference.com/w/c/numeric/complex/cexp\" rel=\"nofollow noreferrer\">double complex cexp( double complex z )</a> , <a href=\"http://en.cppreference.com/w/c/numeric/math/exp\" rel=\"nofollow noreferrer\">double      exp( double arg )</a>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504020675, "post_id": 45942938, "comment_id": 78844381, "body": "Similar issue with <code>const long double PI = acos(-1);</code> where <code>acosl()</code> is expected to form a <code>long double</code> \u03c0."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504021061, "post_id": 45942938, "comment_id": 78844618, "body": "That line already gives me <code>warning: initializer element is not a constant expression [-Wpedantic]</code>, and the result of <code>exp()</code> is narrowed to <code>double complex</code>, so the inconsistencies are everywhere - that&#39;s why I didn&#39;t attempt a full replacement program."}], "tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": true, "score": 1, "last_activity_date": 1504020327, "creation_date": 1504020327, "answer_id": 45942938, "question_id": 45942669, "link": "https://stackoverflow.com/questions/45942669/why-does-expi%cf%80-return-1-instead-of-1/45942938#45942938", "title": "Why does exp(i\u03c0) return 1 instead of -1?", "body": "<p>The code misspelt <code>cexp</code> or <code>cexpl</code> as <code>exp</code>.</p>\n\n<p>In C, these functions are declared as</p>\n\n<pre><code>long double complex cexpl(long double complex z);\ndouble complex cexp(double complex z);\ndouble exp(double arg);\n</code></pre>\n\n<p>In <strong>C++</strong>, all of the above (and more) are available as <code>std::exp()</code>.  But <strong>C</strong> doesn't support overloading, so it's your responsibility as a programmer to choose the one that's appropriate for your arguments, otherwise you'll find that the input value is converted (using a narrowing conversion, if necessary).  This means that the imaginary part of <code>z</code> is lost, leaving <code>exp(0)</code> in your code.</p>\n"}], "owner": {"reputation": 357, "user_id": 8533342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12d07d16fa9af4e63171351a48c909a9?s=128&d=identicon&r=PG&f=1", "display_name": "john doe", "link": "https://stackoverflow.com/users/8533342/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 45942938, "answer_count": 1, "score": 1, "last_activity_date": 1504021329, "creation_date": 1504019525, "last_edit_date": 1504021329, "question_id": 45942669, "link": "https://stackoverflow.com/questions/45942669/why-does-expi%cf%80-return-1-instead-of-1", "title": "Why does exp(i\u03c0) return 1 instead of -1?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;complex.h&gt;\n#include &lt;math.h&gt;\n\nconst long double PI = acos(-1);\nint main() {\n    double complex z = exp(PI*I);\n    printf(\"%lf %lf\", crealf(z), cimagf(z));\n\n    return 0;\n}\n</code></pre>\n\n<p>We know that <code>exp((pi)(i))</code> should be <code>cos(pi) + i*sin(pi) = -1</code>, then why is the output 1 when I run this program?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1504019810, "post_id": 45942619, "comment_id": 78843797, "body": "As you interate through the chars, they are in the set of [&#39; &#39;, &#39;\\t&#39;, &#39;.&#39;, &#39;,&#39; and &#39;;&#39;], or they are not.  Also, you are either currently &#39;in a word&#39; or &#39;not in a word&#39;, and that state can be changed by the char you are inspecting.  If the state changes to &#39;in a word&#39;, increment your word count."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1504020092, "post_id": 45942619, "comment_id": 78843998, "body": "Of course you don&#39;t get the desired output, because your program does basically nothing."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "edited": false, "score": 0, "creation_date": 1504020218, "post_id": 45942619, "comment_id": 78844086, "body": "I&#39;m voting to close this question as off-topic because the OP has done nothing to satisfy the requirements of the assignment."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1504020550, "post_id": 45942619, "comment_id": 78844307, "body": "The assignment sucks anyway.  I mean, I would immediately want to initialize a static const array of those &#39;not in a word&#39; chars, (with a NUL terminator), so it can be seached through to decide whether any given char is part of a word or not:(  Without arrays, it means a case switch or if/else ladder:("}, {"owner": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1504021363, "post_id": 45942619, "comment_id": 78844780, "body": "@MartinJames  As far as the &quot;it is possible to solve this question without arrays&quot; comment in the problem goes, I&#39;m assuming it says that to discourage students from first reading the input into an array and then parsing it. I don&#39;t think it&#39;s trying to discourage students from using arrays to implement the input stream parsing logic."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 7117, "user_id": 1245420, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c5a428623702851ce5f462822483fc6c?s=128&d=identicon&r=PG", "display_name": "phonetagger", "link": "https://stackoverflow.com/users/1245420/phonetagger"}, "edited": false, "score": 0, "creation_date": 1504021879, "post_id": 45942619, "comment_id": 78845073, "body": "@phonetagger you&#39;re probably right, but the prof/TA/OP should be clear on the matter.  Searching an array is neater and cleaner than alternatives, and could be made more flexible, eg. by loading the &#39;non-word&#39; array from a file."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 0, "last_activity_date": 1504021785, "creation_date": 1504021785, "answer_id": 45943420, "question_id": 45942619, "link": "https://stackoverflow.com/questions/45942619/i-am-not-getting-the-desired-output-as-required/45943420#45943420", "title": "I am not getting the desired output as required", "body": "<p>This is a simple application of four elements.</p>\n\n<ol>\n<li>while()</li>\n<li>getchar()</li>\n<li>switch()</li>\n<li>printf()</li>\n</ol>\n\n<p>the following code shows one way to implement the function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;  // getchar(), EOF, printf()\n\nint main( void )\n{\n    int wordCount = 0;\n    int ch;\n    int inWord = 0;\n\n    while( (ch = getchar()) != EOF )\n    {\n        switch( ch )\n        {\n            case ' ':\n            case '\\t':\n            case '.':\n            case ',':\n            case ';':\n                inWord = 0;\n                break;\n\n            default:\n                if ( !inWord )\n                {\n                    wordCount++;\n                    inWord = 1;\n                }\n                break;\n        } // end switch\n    } // end while\n\n    printf( \"\\n%d\\n\", wordCount );\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1504022994, "post_id": 45943447, "comment_id": 78845829, "body": "Good answer: Counting the &quot;edge&quot; is the best idea as it handles the first and last word well with their optional leading/tailing delimiters."}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 1, "last_activity_date": 1504021870, "creation_date": 1504021870, "answer_id": 45943447, "question_id": 45942619, "link": "https://stackoverflow.com/questions/45942619/i-am-not-getting-the-desired-output-as-required/45943447#45943447", "title": "I am not getting the desired output as required", "body": "<pre><code>[one of delimiters]...[one of delimiters][not one of delimiters]... \n                                        ^^ count this edge.\n</code></pre>\n\n<p>like this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nbool IsDelimiter(char ch, const char *delimiters){\n    while(*delimiters)\n        if(*delimiters++ == ch)\n            return true;\n    return false;\n}\n\nint main(void){\n    bool prev_is_delmiter = true;\n    int ch, wc = 0;\n\n    while((ch = getchar()) != EOF &amp;&amp; ch != '\\n'){\n        bool current_is_delmiter = IsDelimiter(ch, \" \\t,.;\");\n        if(prev_is_delmiter &amp;&amp; !current_is_delmiter){\n            ++wc;\n        }\n        prev_is_delmiter = current_is_delmiter;\n    }\n    printf(\"%d\\n\", wc);\n}\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8525112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d07944ac5cbd15b8ae661818d663ca?s=128&d=identicon&r=PG&f=1", "display_name": "akash11", "link": "https://stackoverflow.com/users/8525112/akash11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 45943420, "answer_count": 2, "score": 0, "last_activity_date": 1504021870, "creation_date": 1504019407, "last_edit_date": 1504020036, "question_id": 45942619, "link": "https://stackoverflow.com/questions/45942619/i-am-not-getting-the-desired-output-as-required", "title": "I am not getting the desired output as required", "body": "<p>The output of this program is to get the number of words in a sentence irrespective of number of whitespaces or any of the symbols as mentioned in the question.</p>\n\n<p><strong>Here's the question:</strong></p>\n\n<p>A line of English text will be given, where words are separated by one\nof the following symbols:</p>\n\n<p>' ', '\\t', '.', ',' and ';'</p>\n\n<p>Each word may be separated from the next and the previous by one or\nmore of the following symbols. You have to count the number of words\nin the sentence.</p>\n\n<p>Note that to read the input, you have to read until the EOF symbol is\nread, as in the following example.</p>\n\n<pre><code>int main()\n{\n    int c;\n\n    c = getchar();\n    while ( c != EOF ) {\n       c = getchar();\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Note: it is possible to solve this question without arrays, so the\nmaximum length of the line is not important.</p>\n\n<h2>Input</h2>\n\n<p>A line of English text with words separated from one another by one or\nmore occurrences of the symbols</p>\n\n<p>' ', '\\t', '.', ',' and ';'</p>\n\n<h2>Output</h2>\n\n<p>The number of words in the line.</p>\n\n<h2>Sample Input</h2>\n\n<pre><code>This is a sentence, it has words separated by spaces and fullstops.\n</code></pre>\n\n<h2>Sample Output</h2>\n\n<pre><code>12\n</code></pre>\n\n<p>I know I have to use the format given in the question, but I didn't know how to use it.</p>\n\n<p>I only know the program to find number of words in a sentence when the words are separated by only single space or a single \\t. But, I didn't get any idea to solve this question.</p>\n"}]